var zk=Object.defineProperty;var Kk=Object.getOwnPropertyDescriptor;var ne=(r,e,t,n)=>{for(var i=n>1?void 0:n?Kk(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&zk(e,t,i),i},M=(r,e)=>(t,n)=>e(t,n,r);function LE(r,e){let t=Gk(r,e);if(t!==-1)return r[t]}function Gk(r,e,t=r.length-1){for(let n=t;n>=0;n--){let i=r[n];if(e(i))return n}return-1}function ny(r,e){let t=vu(r,e);return t===-1?void 0:r[t]}function vu(r,e,t=0,n=r.length){let i=t,o=n;for(;i<o;){let s=Math.floor((i+o)/2);e(r[s])?i=s+1:o=s}return i-1}function zp(r,e,t=0,n=r.length){let i=t,o=n;for(;i<o;){let s=Math.floor((i+o)/2);e(r[s])?o=s:i=s+1}return i}function jk(r,e){if(r.length===0)return;let t=r[0];for(let n=1;n<r.length;n++){let i=r[n];e(i,t)>0&&(t=i)}return t}function kE(r,e){if(r.length===0)return;let t=r[0];for(let n=1;n<r.length;n++){let i=r[n];e(i,t)>=0&&(t=i)}return t}function RE(r,e){return jk(r,(t,n)=>-e(t,n))}var iy=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?xr.isErrorNoTelemetry(e)?new xr(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},DE=new iy;function ol(r){DE.onUnexpectedError(r)}function Le(r){PE(r)||DE.onUnexpectedError(r)}var ry="Canceled";function PE(r){return r instanceof kn?!0:r instanceof Error&&r.name===ry&&r.message===ry}var kn=class extends Error{constructor(){super(ry),this.name=this.message}};function sl(r){return r?new Error(`Illegal argument: ${r}`):new Error("Illegal argument")}function ME(r){return r?new Error(`Illegal state: ${r}`):new Error("Illegal state")}var Kp=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var xr=class r extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof r)return e;let t=new r;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Re=class r extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,r.prototype)}};function Dn(r,e=0){return r[r.length-(1+e)]}function Pn(r,e,t=(n,i)=>n===i){if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;for(let n=0,i=r.length;n<i;n++)if(!t(r[n],e[n]))return!1;return!0}function $n(r){return r.filter(e=>!!e)}function Fo(r,e=t=>t){let t=new Set;return r.filter(n=>{let i=e(n);return t.has(i)?!1:(t.add(i),!0)})}function Gp(r,e){return r.push(e),()=>$k(r,e)}function $k(r,e){let t=r.indexOf(e);if(t>-1)return r.splice(t,1),e}function Er(r,e,t){let n=r.slice(0,e),i=r.slice(e);return n.concat(t,i)}function oy(r,e){for(let t of e)r.push(t)}var OE;(a=>{function r(l){return l<0}a.isLessThan=r;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function n(l){return l===0}a.isNeitherLessOrGreaterThan=n,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(OE||={});function Rs(r,e){return(t,n)=>e(r(t),r(n))}var Rn=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},ro=class r{constructor(e){this.iterate=e}static empty=new r(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new r(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new r(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(i=>((n||OE.isGreaterThan(e(i,t)))&&(n=!1,t=i),!0)),t}};function sy(){return globalThis._VSCODE_NLS_MESSAGES}function yu(){return globalThis._VSCODE_NLS_LANGUAGE}var Yk=yu()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function jp(r,e){let t;return e.length===0?t=r:t=r.replace(/\{(\d+)\}/g,(n,i)=>{let o=i[0],s=e[o],a=n;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),Yk&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function m(r,e,...t){return jp(typeof r=="number"?NE(r,e):e,t)}function NE(r,e){let t=sy()?.[r];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${r} !!!`)}return t}function Ds(r,e,...t){let n;typeof r=="number"?n=NE(r,e):n=e;let i=jp(n,t);return{value:i,original:e===n?i:jp(e,t)}}var al="en",Cu=!1,Su=!1,Iu=!1,Qk=!1,BE=!1,ly=!1,Zk=!1,dy=!1,Xk=!1,VE=!1,qp,$p=al,AE=al,Jk,oo,so=globalThis,fi;typeof so.vscode<"u"&&typeof so.vscode.process<"u"?fi=so.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(fi=process);var UE=typeof fi?.versions?.electron=="string",eR=UE&&fi?.type==="renderer";if(typeof fi=="object"){Cu=fi.platform==="win32",Su=fi.platform==="darwin",Iu=fi.platform==="linux",Qk=Iu&&!!fi.env.SNAP&&!!fi.env.SNAP_REVISION,Zk=UE,Xk=!!fi.env.CI||!!fi.env.BUILD_ARTIFACTSTAGINGDIRECTORY,qp=al,$p=al;let r=fi.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r);qp=e.userLocale,AE=e.osLocale,$p=e.resolvedLanguage||al,Jk=e.languagePack?.translationsConfigFile}catch{}BE=!0}else typeof navigator=="object"&&!eR?(oo=navigator.userAgent,Cu=oo.indexOf("Windows")>=0,Su=oo.indexOf("Macintosh")>=0,dy=(oo.indexOf("Macintosh")>=0||oo.indexOf("iPad")>=0||oo.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Iu=oo.indexOf("Linux")>=0,VE=oo?.indexOf("Mobi")>=0,ly=!0,$p=yu()||al,qp=navigator.language.toLowerCase(),AE=qp):console.error("Unable to resolve platform.");var ay=0;Su?ay=1:Cu?ay=3:Iu&&(ay=2);var Fe=Cu,Me=Su,pt=Iu;var ao=BE;var qi=ly,tR=ly&&typeof so.importScripts=="function",HE=tR?so.origin:void 0,Yp=dy,zE=VE;var wr=oo,Wo=$p,nR;(n=>{function r(){return Wo}n.value=r;function e(){return Wo.length===2?Wo==="en":Wo.length>=3?Wo[0]==="e"&&Wo[1]==="n"&&Wo[2]==="-":!1}n.isDefaultVariant=e;function t(){return Wo==="en"}n.isDefault=t})(nR||={});var iR=typeof so.postMessage=="function"&&!so.importScripts,Qp=(()=>{if(iR){let r=[];so.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=r.length;n<i;n++){let o=r[n];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(n,1),o.callback();return}}});let e=0;return t=>{let n=++e;r.push({id:n,callback:t}),so.postMessage({vscodeScheduleAsyncWork:n},"*")}}return r=>setTimeout(r)})();var Tr=Su||dy?2:Cu?1:3,FE=!0,WE=!1;function KE(){if(!WE){WE=!0;let r=new Uint8Array(2);r[0]=1,r[1]=2,FE=new Uint16Array(r.buffer)[0]===513}return FE}var uy=!!(wr&&wr.indexOf("Chrome")>=0),GE=!!(wr&&wr.indexOf("Firefox")>=0),jE=!!(!uy&&wr&&wr.indexOf("Safari")>=0),qE=!!(wr&&wr.indexOf("Edg/")>=0),$E=!!(wr&&wr.indexOf("Android")>=0);var Ps,cy=globalThis.vscode;if(typeof cy<"u"&&typeof cy.process<"u"){let r=cy.process;Ps={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Ps={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Ps={get platform(){return Fe?"win32":Me?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var _u=Ps.cwd,YE=Ps.env,QE=Ps.platform,aF=Ps.arch;var oR=65,sR=97,aR=90,lR=122,Uo=46,an=47,Yn=92,Bo=58,dR=63,Zp=class extends Error{code;constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let o=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${o} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function uR(r,e){if(r===null||typeof r!="object")throw new Zp(e,"Object",r)}function kt(r,e){if(typeof r!="string")throw new Zp(e,"string",r)}var Qn=QE==="win32";function Ae(r){return r===an||r===Yn}function py(r){return r===an}function Vo(r){return r>=oR&&r<=aR||r>=sR&&r<=lR}function Xp(r,e,t,n){let i="",o=0,s=-1,a=0,l=0;for(let d=0;d<=r.length;++d){if(d<r.length)l=r.charCodeAt(d);else{if(n(l))break;l=an}if(n(l)){if(!(s===d-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==Uo||i.charCodeAt(i.length-2)!==Uo){if(i.length>2){let u=i.lastIndexOf(t);u===-1?(i="",o=0):(i=i.slice(0,u),o=i.length-1-i.lastIndexOf(t)),s=d,a=0;continue}else if(i.length!==0){i="",o=0,s=d,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",o=2)}else i.length>0?i+=`${t}${r.slice(s+1,d)}`:i=r.slice(s+1,d),o=d-s-1;s=d,a=0}else l===Uo&&a!==-1?++a:a=-1}return i}function cR(r){return r?`${r[0]==="."?"":"."}${r}`:""}function ZE(r,e){uR(e,"pathObject");let t=e.dir||e.root,n=e.base||`${e.name||""}${cR(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${r}${n}`:n}var ft={resolve(...r){let e="",t="",n=!1;for(let i=r.length-1;i>=-1;i--){let o;if(i>=0){if(o=r[i],kt(o,`paths[${i}]`),o.length===0)continue}else e.length===0?o=_u():(o=YE[`=${e}`]||_u(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Yn)&&(o=`${e}\\`));let s=o.length,a=0,l="",d=!1,u=o.charCodeAt(0);if(s===1)Ae(u)&&(a=1,d=!0);else if(Ae(u))if(d=!0,Ae(o.charCodeAt(1))){let c=2,p=c;for(;c<s&&!Ae(o.charCodeAt(c));)c++;if(c<s&&c!==p){let h=o.slice(p,c);for(p=c;c<s&&Ae(o.charCodeAt(c));)c++;if(c<s&&c!==p){for(p=c;c<s&&!Ae(o.charCodeAt(c));)c++;(c===s||c!==p)&&(l=`\\\\${h}\\${o.slice(p,c)}`,a=c)}}}else a=1;else Vo(u)&&o.charCodeAt(1)===Bo&&(l=o.slice(0,2),a=2,s>2&&Ae(o.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,n=d,d&&e.length>0)break}return t=Xp(t,!n,"\\",Ae),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){kt(r,"path");let e=r.length;if(e===0)return".";let t=0,n,i=!1,o=r.charCodeAt(0);if(e===1)return py(o)?"\\":r;if(Ae(o))if(i=!0,Ae(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Ae(r.charCodeAt(a));)a++;if(a<e&&a!==l){let d=r.slice(l,a);for(l=a;a<e&&Ae(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Ae(r.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${r.slice(l)}\\`;a!==l&&(n=`\\\\${d}\\${r.slice(l,a)}`,t=a)}}}else t=1;else Vo(o)&&r.charCodeAt(1)===Bo&&(n=r.slice(0,2),t=2,e>2&&Ae(r.charCodeAt(2))&&(i=!0,t=3));let s=t<e?Xp(r.slice(t),!i,"\\",Ae):"";return s.length===0&&!i&&(s="."),s.length>0&&Ae(r.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(r){kt(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return Ae(t)||e>2&&Vo(t)&&r.charCodeAt(1)===Bo&&Ae(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];kt(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&Ae(t.charCodeAt(0))){++i;let o=t.length;o>1&&Ae(t.charCodeAt(1))&&(++i,o>2&&(Ae(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&Ae(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return ft.normalize(e)},relative(r,e){if(kt(r,"from"),kt(e,"to"),r===e)return"";let t=ft.resolve(r),n=ft.resolve(e);if(t===n||(r=t.toLowerCase(),e=n.toLowerCase(),r===e))return"";let i=0;for(;i<r.length&&r.charCodeAt(i)===Yn;)i++;let o=r.length;for(;o-1>i&&r.charCodeAt(o-1)===Yn;)o--;let s=o-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Yn;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Yn;)l--;let d=l-a,u=s<d?s:d,c=-1,p=0;for(;p<u;p++){let g=r.charCodeAt(i+p);if(g!==e.charCodeAt(a+p))break;g===Yn&&(c=p)}if(p!==u){if(c===-1)return n}else{if(d>u){if(e.charCodeAt(a+p)===Yn)return n.slice(a+p+1);if(p===2)return n.slice(a+p)}s>u&&(r.charCodeAt(i+p)===Yn?c=p:p===2&&(c=3)),c===-1&&(c=0)}let h="";for(p=i+c+1;p<=o;++p)(p===o||r.charCodeAt(p)===Yn)&&(h+=h.length===0?"..":"\\..");return a+=c,h.length>0?`${h}${n.slice(a,l)}`:(n.charCodeAt(a)===Yn&&++a,n.slice(a,l))},toNamespacedPath(r){if(typeof r!="string"||r.length===0)return r;let e=ft.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Yn){if(e.charCodeAt(1)===Yn){let t=e.charCodeAt(2);if(t!==dR&&t!==Uo)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Vo(e.charCodeAt(0))&&e.charCodeAt(1)===Bo&&e.charCodeAt(2)===Yn)return`\\\\?\\${e}`;return r},dirname(r){kt(r,"path");let e=r.length;if(e===0)return".";let t=-1,n=0,i=r.charCodeAt(0);if(e===1)return Ae(i)?r:".";if(Ae(i)){if(t=n=1,Ae(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Ae(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Ae(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Ae(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=n=a+1)}}}}else Vo(i)&&r.charCodeAt(1)===Bo&&(t=e>2&&Ae(r.charCodeAt(2))?3:2,n=t);let o=-1,s=!0;for(let a=e-1;a>=n;--a)if(Ae(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&kt(e,"suffix"),kt(r,"path");let t=0,n=-1,i=!0,o;if(r.length>=2&&Vo(r.charCodeAt(0))&&r.charCodeAt(1)===Bo&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(Ae(l)){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=t;--o)if(Ae(r.charCodeAt(o))){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){kt(r,"path");let e=0,t=-1,n=0,i=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===Bo&&Vo(r.charCodeAt(0))&&(e=n=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(Ae(l)){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===Uo?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":r.slice(t,i)},format:ZE.bind(null,"\\"),parse(r){kt(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,n=0,i=r.charCodeAt(0);if(t===1)return Ae(i)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Ae(i)){if(n=1,Ae(r.charCodeAt(1))){let c=2,p=c;for(;c<t&&!Ae(r.charCodeAt(c));)c++;if(c<t&&c!==p){for(p=c;c<t&&Ae(r.charCodeAt(c));)c++;if(c<t&&c!==p){for(p=c;c<t&&!Ae(r.charCodeAt(c));)c++;c===t?n=c:c!==p&&(n=c+1)}}}}else if(Vo(i)&&r.charCodeAt(1)===Bo){if(t<=2)return e.root=e.dir=r,e;if(n=2,Ae(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;n=3}}n>0&&(e.root=r.slice(0,n));let o=-1,s=n,a=-1,l=!0,d=r.length-1,u=0;for(;d>=n;--d){if(i=r.charCodeAt(d),Ae(i)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),i===Uo?o===-1?o=d:u!==1&&(u=1):o!==-1&&(u=-1)}return a!==-1&&(o===-1||u===0||u===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==n?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},pR=(()=>{if(Qn){let r=/\\/g;return()=>{let e=_u().replace(r,"/");return e.slice(e.indexOf("/"))}}return()=>_u()})(),Oe={resolve(...r){let e="",t=!1;for(let n=r.length-1;n>=-1&&!t;n--){let i=n>=0?r[n]:pR();kt(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===an)}return e=Xp(e,!t,"/",py),t?`/${e}`:e.length>0?e:"."},normalize(r){if(kt(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===an,t=r.charCodeAt(r.length-1)===an;return r=Xp(r,!e,"/",py),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return kt(r,"path"),r.length>0&&r.charCodeAt(0)===an},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let n=r[t];kt(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":Oe.normalize(e)},relative(r,e){if(kt(r,"from"),kt(e,"to"),r===e||(r=Oe.resolve(r),e=Oe.resolve(e),r===e))return"";let t=1,n=r.length,i=n-t,o=1,s=e.length-o,a=i<s?i:s,l=-1,d=0;for(;d<a;d++){let c=r.charCodeAt(t+d);if(c!==e.charCodeAt(o+d))break;c===an&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(o+d)===an)return e.slice(o+d+1);if(d===0)return e.slice(o+d)}else i>a&&(r.charCodeAt(t+d)===an?l=d:d===0&&(l=0));let u="";for(d=t+l+1;d<=n;++d)(d===n||r.charCodeAt(d)===an)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(kt(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===an,t=-1,n=!0;for(let i=r.length-1;i>=1;--i)if(r.charCodeAt(i)===an){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&kt(e,"ext"),kt(r,"path");let t=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===an){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===an){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){kt(r,"path");let e=-1,t=0,n=-1,i=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===an){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===Uo?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===t+1?"":r.slice(e,n)},format:ZE.bind(null,"/"),parse(r){kt(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===an,n;t?(e.root="/",n=1):n=0;let i=-1,o=0,s=-1,a=!0,l=r.length-1,d=0;for(;l>=n;--l){let u=r.charCodeAt(l);if(u===an){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),u===Uo?i===-1?i=l:d!==1&&(d=1):i!==-1&&(d=-1)}if(s!==-1){let u=o===0&&t?1:o;i===-1||d===0||d===1&&i===s-1&&i===o+1?e.base=e.name=r.slice(u,s):(e.name=r.slice(u,i),e.base=r.slice(u,s),e.ext=r.slice(i,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Oe.win32=ft.win32=ft;Oe.posix=ft.posix=Oe;var Ms=Qn?ft.normalize:Oe.normalize,ll=Qn?ft.isAbsolute:Oe.isAbsolute,hy=Qn?ft.join:Oe.join,XE=Qn?ft.resolve:Oe.resolve,JE=Qn?ft.relative:Oe.relative,ew=Qn?ft.dirname:Oe.dirname,Jp=Qn?ft.basename:Oe.basename,Os=Qn?ft.extname:Oe.extname,lF=Qn?ft.format:Oe.format,dF=Qn?ft.parse:Oe.parse,uF=Qn?ft.toNamespacedPath:Oe.toNamespacedPath,Mn=Qn?ft.sep:Oe.sep,cF=Qn?ft.delimiter:Oe.delimiter;var mR=/^\w[\w\d+.-]*$/,gR=/^\//,fR=/^\/\//;function bR(r,e){if(!r.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${r.authority}", path: "${r.path}", query: "${r.query}", fragment: "${r.fragment}"}`);if(r.scheme&&!mR.test(r.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(r.path){if(r.authority){if(!gR.test(r.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(fR.test(r.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function vR(r,e){return!r&&!e?"file":r}function yR(r,e){switch(r){case"https":case"http":case"file":e?e[0]!==$i&&(e=$i+e):e=$i;break}return e}var ht="",$i="/",IR=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,ae=class r{static isUri(e){return e instanceof r?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,n,i,o,s=!1){typeof e=="object"?(this.scheme=e.scheme||ht,this.authority=e.authority||ht,this.path=e.path||ht,this.query=e.query||ht,this.fragment=e.fragment||ht):(this.scheme=vR(e,s),this.authority=t||ht,this.path=yR(this.scheme,n||ht),this.query=i||ht,this.fragment=o||ht,bR(this,s))}get fsPath(){return xu(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:o,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=ht),n===void 0?n=this.authority:n===null&&(n=ht),i===void 0?i=this.path:i===null&&(i=ht),o===void 0?o=this.query:o===null&&(o=ht),s===void 0?s=this.fragment:s===null&&(s=ht),t===this.scheme&&n===this.authority&&i===this.path&&o===this.query&&s===this.fragment?this:new Ho(t,n,i,o,s)}static parse(e,t=!1){let n=IR.exec(e);return n?new Ho(n[2]||ht,eh(n[4]||ht),eh(n[5]||ht),eh(n[7]||ht),eh(n[9]||ht),t):new Ho(ht,ht,ht,ht,ht)}static file(e){let t=ht;if(Fe&&(e=e.replace(/\\/g,$i)),e[0]===$i&&e[1]===$i){let n=e.indexOf($i,2);n===-1?(t=e.substring(2),e=$i):(t=e.substring(2,n),e=e.substring(n)||$i)}return new Ho("file",t,e,ht,ht)}static from(e,t){return new Ho(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return Fe&&e.scheme==="file"?n=r.file(ft.join(xu(e,!0),...t)).path:n=Oe.join(e.path,...t),e.with({path:n})}toString(e=!1){return gy(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof r)return e;{let t=new Ho(e);return t._formatted=e.external??null,t._fsPath=e._sep===iw?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var iw=Fe?1:void 0,Ho=class extends ae{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=xu(this,!1)),this._fsPath}toString(e=!1){return e?gy(this,!0):(this._formatted||(this._formatted=gy(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=iw),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},rw={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function tw(r,e,t){let n,i=-1;for(let o=0;o<r.length;o++){let s=r.charCodeAt(o);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)i!==-1&&(n+=encodeURIComponent(r.substring(i,o)),i=-1),n!==void 0&&(n+=r.charAt(o));else{n===void 0&&(n=r.substr(0,o));let a=rw[s];a!==void 0?(i!==-1&&(n+=encodeURIComponent(r.substring(i,o)),i=-1),n+=a):i===-1&&(i=o)}}return i!==-1&&(n+=encodeURIComponent(r.substring(i))),n!==void 0?n:r}function CR(r){let e;for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);n===35||n===63?(e===void 0&&(e=r.substr(0,t)),e+=rw[n]):e!==void 0&&(e+=r[t])}return e!==void 0?e:r}function xu(r,e){let t;return r.authority&&r.path.length>1&&r.scheme==="file"?t=`//${r.authority}${r.path}`:r.path.charCodeAt(0)===47&&(r.path.charCodeAt(1)>=65&&r.path.charCodeAt(1)<=90||r.path.charCodeAt(1)>=97&&r.path.charCodeAt(1)<=122)&&r.path.charCodeAt(2)===58?e?t=r.path.substr(1):t=r.path[1].toLowerCase()+r.path.substr(2):t=r.path,Fe&&(t=t.replace(/\//g,"\\")),t}function gy(r,e){let t=e?CR:tw,n="",{scheme:i,authority:o,path:s,query:a,fragment:l}=r;if(i&&(n+=i,n+=":"),(o||i==="file")&&(n+=$i,n+=$i),o){let d=o.indexOf("@");if(d!==-1){let u=o.substr(0,d);o=o.substr(d+1),d=u.lastIndexOf(":"),d===-1?n+=t(u,!1,!1):(n+=t(u.substr(0,d),!1,!1),n+=":",n+=t(u.substr(d+1),!1,!0)),n+="@"}o=o.toLowerCase(),d=o.lastIndexOf(":"),d===-1?n+=t(o,!1,!0):(n+=t(o.substr(0,d),!1,!0),n+=o.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}n+=t(s,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:tw(l,!1,!1)),n}function ow(r){try{return decodeURIComponent(r)}catch{return r.length>3?r.substr(0,3)+ow(r.substr(3)):r}}var nw=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function eh(r){return r.match(nw)?r.replace(nw,e=>ow(e)):r}var fy=class{constructor(e,t){this.uri=e;this.value=t}};function SR(r){return Array.isArray(r)}var hn=class r{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof r)this.map=new Map(e.map),this.toKey=t??r.defaultToKey;else if(SR(e)){this.map=new Map,this.toKey=t??r.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??r.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new fy(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},th=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new hn(e):(this._map=new hn(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var by=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},vy=class extends by{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},ki=class extends vy{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}};function zo(r,e){let t=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=r.apply(t,arguments)}finally{e()}else i=r.apply(t,arguments);return i}}var bi;(S=>{function r(x){return x&&typeof x=="object"&&typeof x[Symbol.iterator]=="function"}S.is=r;let e=Object.freeze([]);function t(){return e}S.empty=t;function*n(x){yield x}S.single=n;function i(x){return r(x)?x:n(x)}S.wrap=i;function o(x){return x||e}S.from=o;function*s(x){for(let T=x.length-1;T>=0;T--)yield x[T]}S.reverse=s;function a(x){return!x||x[Symbol.iterator]().next().done===!0}S.isEmpty=a;function l(x){return x[Symbol.iterator]().next().value}S.first=l;function d(x,T){let R=0;for(let P of x)if(T(P,R++))return!0;return!1}S.some=d;function u(x,T){for(let R of x)if(T(R))return R}S.find=u;function*c(x,T){for(let R of x)T(R)&&(yield R)}S.filter=c;function*p(x,T){let R=0;for(let P of x)yield T(P,R++)}S.map=p;function*h(x,T){let R=0;for(let P of x)yield*T(P,R++)}S.flatMap=h;function*g(...x){for(let T of x)yield*T}S.concat=g;function f(x,T,R){let P=R;for(let O of x)P=T(P,O);return P}S.reduce=f;function*v(x,T,R=x.length){for(T<0&&(T+=x.length),R<0?R+=x.length:R>x.length&&(R=x.length);T<R;T++)yield x[T]}S.slice=v;function y(x,T=Number.POSITIVE_INFINITY){let R=[];if(T===0)return[R,x];let P=x[Symbol.iterator]();for(let O=0;O<T;O++){let k=P.next();if(k.done)return[R,S.empty()];R.push(k.value)}return[R,{[Symbol.iterator](){return P}}]}S.consume=y;async function I(x){let T=[];for await(let R of x)T.push(R);return Promise.resolve(T)}S.asyncToArray=I})(bi||={});var _R=!1,Ns=null;function xR(r){Ns=r}if(_R){let r="__is_disposable_tracked__";xR(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[r]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==B.None)try{e[r]=!0}catch{}}markAsDisposed(e){if(e&&e!==B.None)try{e[r]=!0}catch{}}markAsSingleton(e){}})}function As(r){return Ns?.trackDisposable(r),r}function Fs(r){Ns?.markAsDisposed(r)}function Eu(r,e){Ns?.setParent(r,e)}function ER(r,e){if(Ns)for(let t of r)Ns.setParent(t,e)}function Ko(r){return Ns?.markAsSingleton(r),r}function Sn(r){if(bi.is(r)){let e=[];for(let t of r)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}function Go(...r){let e=ve(()=>Sn(r));return ER(r,e),e}function ve(r){let e=As({dispose:zo(()=>{Fs(e),r()})});return e}var We=class r{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){As(this)}dispose(){this._isDisposed||(Fs(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Sn(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return Eu(e,this),this._isDisposed?r.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),Eu(e,null))}},B=class{static None=Object.freeze({dispose(){}});_store=new We;constructor(){As(this),Eu(this._store,this)}dispose(){Fs(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Zn=class{_value;_isDisposed=!1;constructor(){As(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&Eu(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Fs(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&Eu(e,null),e}};var Lr=class{_store=new Map;_isDisposed=!1;constructor(){As(this)}dispose(){Fs(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Sn(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var sw=Object.freeze(function(r,e){let t=setTimeout(r.bind(e),0);return{dispose(){clearTimeout(t)}}}),Mt;(n=>{function r(i){return i===n.None||i===n.Cancelled||i instanceof dl?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=r,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ke.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:sw})})(Mt||={});var dl=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?sw:(this._emitter||(this._emitter=new L),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Ri=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new dl),this._token}cancel(){this._token?this._token instanceof dl&&this._token.cancel():this._token=Mt.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof dl&&this._token.dispose():this._token=Mt.None}};var bt=class r{static Undefined=new r(void 0);element;next;prev;constructor(e){this.element=e,this.next=r.Undefined,this.prev=r.Undefined}},mn=class{_first=bt.Undefined;_last=bt.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===bt.Undefined}clear(){let e=this._first;for(;e!==bt.Undefined;){let t=e.next;e.prev=bt.Undefined,e.next=bt.Undefined,e=t}this._first=bt.Undefined,this._last=bt.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new bt(e);if(this._first===bt.Undefined)this._first=n,this._last=n;else if(t){let o=this._last;this._last=n,n.prev=o,o.next=n}else{let o=this._first;this._first=n,n.next=o,o.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==bt.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==bt.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==bt.Undefined&&e.next!==bt.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===bt.Undefined&&e.next===bt.Undefined?(this._first=bt.Undefined,this._last=bt.Undefined):e.next===bt.Undefined?(this._last=this._last.prev,this._last.next=bt.Undefined):e.prev===bt.Undefined&&(this._first=this._first.next,this._first.prev=bt.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==bt.Undefined;)yield e.element,e=e.next}};var Ws=(r,e)=>r===e;var Yi=class{constructor(e,t,n){this.owner=e;this.debugNameSource=t;this.referenceFn=n}getDebugName(e){return uw(e,this)}},aw=new Map,yy=new WeakMap;function uw(r,e){let t=yy.get(r);if(t)return t;let n=wR(r,e);if(n){let i=aw.get(n)??0;i++,aw.set(n,i);let o=i===1?n:`${n}#${i}`;return yy.set(r,o),o}}function wR(r,e){let t=yy.get(r);if(t)return t;let n=e.owner?LR(e.owner)+".":"",i,o=e.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(i=o(),i!==void 0)return n+i}else return n+o;let s=e.referenceFn;if(s!==void 0&&(i=nh(s),i!==void 0))return n+i;if(e.owner!==void 0){let a=TR(e.owner,r);if(a!==void 0)return n+a}}function TR(r,e){for(let t in r)if(r[t]===e)return t}var lw=new Map,dw=new WeakMap;function LR(r){let e=dw.get(r);if(e)return e;let t=kR(r),n=lw.get(t)??0;n++,lw.set(t,n);let i=n===1?t:`${t}#${n}`;return dw.set(r,i),i}function kR(r){let e=r.constructor;return e?e.name:"Object"}function nh(r){let e=r.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}function ih(r,e){if(!r)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function rh(r,e="Unreachable"){throw new Error(e)}function ul(r){if(!r()){debugger;r(),Le(new Re("Assertion Failed"))}}function wu(r){return new oh(new Yi(void 0,void 0,r),r,void 0,void 0)}var oh=class{constructor(e,t,n,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=n;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),vi()?.handleAutorunCreated(this),this._runIfNeeded(),As(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),Fs(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){vi()?.handleAutorunTriggered(this);let n=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}catch(i){ol(i)}}}finally{t||vi()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}ul(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(n){ol(n)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=oh)(wu||={});function Iy(r,e){return new sh(new Yi(r.owner,r.debugName,r.debugReferenceFn),e,void 0,void 0,r.onLastObserverRemoved,r.equalsFn??Ws)}cw(Iy);var sh=class extends Bs{constructor(t,n,i,o,s=void 0,a){super();this._debugNameData=t;this._computeFn=n;this.createChangeSummary=i;this._handleChange=o;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),vi()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let n=this.state!==0,i=this.value;this.state=3;let o=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}o=n&&!this._equalityComparator(i,this.value),vi()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:o,hadValue:n})}catch(s){ol(s)}if(o)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this)}ul(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(t,n){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:n,didChange:s=>s===t},this.changeSummary):!0}catch(s){ol(s)}let o=this.state===3;if(i&&(this.state===1||o)&&(this.state=2,o))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let n=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),n}addObserver(t){let n=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),n&&t.endUpdate(this)}};function Cy(...r){let e,t,n;return r.length===3?[e,t,n]=r:[t,n]=r,new jo(new Yi(e,void 0,n),t,n,()=>jo.globalTransaction,Ws)}var jo=class extends Bs{constructor(t,n,i,o,s){super();this._debugNameData=t;this.event=n;this._getValue=i;this._getTransaction=o;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let n=this._getValue(t),i=this.value,o=!this.hasValue||!this._equalityComparator(i,n),s=!1;o&&(this.value=n,this.hasValue&&(s=!0,Sy(this._getTransaction(),a=>{vi()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:o,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||vi()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:o,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=jo;function e(n,i){let o=!1;jo.globalTransaction===void 0&&(jo.globalTransaction=n,o=!0);try{i()}finally{o&&(jo.globalTransaction=void 0)}}t.batchEventsGlobally=e})(Cy||={});function hw(r){let e=new ah(!1,void 0);return r.addObserver(e),ve(()=>{r.removeObserver(e)})}fw(hw);function mw(r,e){let t=new ah(!0,e);return r.addObserver(t),e?e(r.get()):r.reportChanges(),ve(()=>{r.removeObserver(t)})}gw(mw);var ah=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};var vw;function yw(r){vw=r}function vi(){return vw}var uh=class{indentation=0;textToConsoleArgs(e){return MR([cl(AR("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[cl(" "),Qi(Lu(e.oldValue,70),{color:"red",strikeThrough:!0}),cl(" "),Qi(Lu(e.newValue,60),{color:"green"})]:[cl(" (unchanged)")]:[cl(" "),Qi(Lu(e.newValue,60),{color:"green"}),cl(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([Tu("observable value changed"),Qi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Qi(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleDerivedRecomputed(e,t){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([Tu("derived recomputed"),Qi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([Tu("observable from event triggered"),Qi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([Tu("autorun"),Qi(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([Tu("transaction"),Qi(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function MR(r){let e=new Array,t=[],n="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(n+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}i(r);let o=[n,...e];return o.push(...t),o}function cl(r){return Qi(r,{color:"black"})}function Tu(r){return Qi(FR(`${r}: `,10),{color:"black",bold:!0})}function Qi(r,e={color:"black"}){function t(i){return Object.entries(i).reduce((o,[s,a])=>`${o}${s}:${a};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:r,style:t(n)}}function Lu(r,e){switch(typeof r){case"number":return""+r;case"string":return r.length+2<=e?`"${r}"`:`"${r.substr(0,e-7)}"+...`;case"boolean":return r?"true":"false";case"undefined":return"undefined";case"object":return r===null?"null":Array.isArray(r)?OR(r,e):NR(r,e);case"symbol":return r.toString();case"function":return`[[Function${r.name?" "+r.name:""}]]`;default:return""+r}}function OR(r,e){let t="[ ",n=!0;for(let i of r){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${Lu(i,e-t.length)}`}return t+=" ]",t}function NR(r,e){let t="{ ",n=!0;for(let[i,o]of Object.entries(r)){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${i}: ${Lu(o,e-t.length)}`}return t+=" }",t}function AR(r,e){let t="";for(let n=1;n<=e;n++)t+=r;return t}function FR(r,e){for(;r.length<e;)r+=" ";return r}var Iw;function gw(r){Iw=r}var Cw;function fw(r){Cw=r}var _y;function cw(r){_y=r}var lh=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,i=t===void 0?e:t;return _y({owner:n,debugName:()=>{let o=nh(i);if(o!==void 0)return o;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:i},o=>i(this.read(o),o))}flatten(){return _y({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(Iw(this,t)),this}keepObserved(e){return e.add(Cw(this)),this}get debugValue(){return this.get()}},Bs=class extends lh{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function dh(r,e){let t=new ch(r,e);try{r(t)}finally{t.finish()}}function Sy(r,e,t){r?e(r):dh(e,t)}var ch=class{constructor(e,t){this._fn=e;this._getDebugName=t;vi()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():nh(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:i}=e[t];n.endUpdate(i)}this.updatingObservers=null,vi()?.handleEndTransaction()}};var WR=!1;WR&&yw(new uh);var BR=globalThis.performance&&typeof globalThis.performance.now=="function",Vs=class r{_startTime;_stopTime;_now;static create(e){return new r(e)}constructor(e){this._now=BR&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var Sw=Symbol("MicrotaskDelay");var VR=!1,_w=!1,UR=!1,Ke;(ee=>{ee.None=()=>B.None;function e(K){if(UR){let{onDidAddListener:V}=K,Y=ku.create(),j=0;K.onDidAddListener=()=>{++j===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),Y.print()),V?.()}}}function t(K,V){return h(K,()=>{},0,void 0,!0,void 0,V)}ee.defer=t;function n(K){return(V,Y=null,j)=>{let U=!1,te;return te=K(re=>{if(!U)return te?te.dispose():U=!0,V.call(Y,re)},null,j),U&&te.dispose(),te}}ee.once=n;function i(K,V){return ee.once(ee.filter(K,V))}ee.onceIf=i;function o(K,V,Y){return c((j,U=null,te)=>K(re=>j.call(U,V(re)),null,te),Y)}ee.map=o;function s(K,V,Y){return c((j,U=null,te)=>K(re=>{V(re),j.call(U,re)},null,te),Y)}ee.forEach=s;function a(K,V,Y){return c((j,U=null,te)=>K(re=>V(re)&&j.call(U,re),null,te),Y)}ee.filter=a;function l(K){return K}ee.signal=l;function d(...K){return(V,Y=null,j)=>{let U=Go(...K.map(te=>te(re=>V.call(Y,re))));return p(U,j)}}ee.any=d;function u(K,V,Y,j){let U=Y;return o(K,te=>(U=V(U,te),U),j)}ee.reduce=u;function c(K,V){let Y,j={onWillAddFirstListener(){Y=K(U.fire,U)},onDidRemoveLastListener(){Y?.dispose()}};V||e(j);let U=new L(j);return V?.add(U),U.event}function p(K,V){return V instanceof Array?V.push(K):V&&V.add(K),K}function h(K,V,Y=100,j=!1,U=!1,te,re){let Ue,Te,de,pn=0,rn,gi={leakWarningThreshold:te,onWillAddFirstListener(){Ue=K(Ja=>{pn++,Te=V(Te,Ja),j&&!de&&(Gi.fire(Te),Te=void 0),rn=()=>{let Ti=Te;Te=void 0,de=void 0,(!j||pn>1)&&Gi.fire(Ti),pn=0},typeof Y=="number"?(clearTimeout(de),de=setTimeout(rn,Y)):de===void 0&&(de=0,queueMicrotask(rn))})},onWillRemoveListener(){U&&pn>0&&rn?.()},onDidRemoveLastListener(){rn=void 0,Ue.dispose()}};re||e(gi);let Gi=new L(gi);return re?.add(Gi),Gi.event}ee.debounce=h;function g(K,V=0,Y){return ee.debounce(K,(j,U)=>j?(j.push(U),j):[U],V,void 0,!0,void 0,Y)}ee.accumulate=g;function f(K,V=(j,U)=>j===U,Y){let j=!0,U;return a(K,te=>{let re=j||!V(te,U);return j=!1,U=te,re},Y)}ee.latch=f;function v(K,V,Y){return[ee.filter(K,V,Y),ee.filter(K,j=>!V(j),Y)]}ee.split=v;function y(K,V=!1,Y=[],j){let U=Y.slice(),te=K(Te=>{U?U.push(Te):Ue.fire(Te)});j&&j.add(te);let re=()=>{U?.forEach(Te=>Ue.fire(Te)),U=null},Ue=new L({onWillAddFirstListener(){te||(te=K(Te=>Ue.fire(Te)),j&&j.add(te))},onDidAddFirstListener(){U&&(V?setTimeout(re):re())},onDidRemoveLastListener(){te&&te.dispose(),te=null}});return j&&j.add(Ue),Ue.event}ee.buffer=y;function I(K,V){return(j,U,te)=>{let re=V(new x);return K(function(Ue){let Te=re.evaluate(Ue);Te!==S&&j.call(U,Te)},void 0,te)}}ee.chain=I;let S=Symbol("HaltChainable");class x{steps=[];map(V){return this.steps.push(V),this}forEach(V){return this.steps.push(Y=>(V(Y),Y)),this}filter(V){return this.steps.push(Y=>V(Y)?Y:S),this}reduce(V,Y){let j=Y;return this.steps.push(U=>(j=V(j,U),j)),this}latch(V=(Y,j)=>Y===j){let Y=!0,j;return this.steps.push(U=>{let te=Y||!V(U,j);return Y=!1,j=U,te?U:S}),this}evaluate(V){for(let Y of this.steps)if(V=Y(V),V===S)break;return V}}function T(K,V,Y=j=>j){let j=(...Ue)=>re.fire(Y(...Ue)),U=()=>K.on(V,j),te=()=>K.removeListener(V,j),re=new L({onWillAddFirstListener:U,onDidRemoveLastListener:te});return re.event}ee.fromNodeEventEmitter=T;function R(K,V,Y=j=>j){let j=(...Ue)=>re.fire(Y(...Ue)),U=()=>K.addEventListener(V,j),te=()=>K.removeEventListener(V,j),re=new L({onWillAddFirstListener:U,onDidRemoveLastListener:te});return re.event}ee.fromDOMEventEmitter=R;function P(K){return new Promise(V=>n(K)(V))}ee.toPromise=P;function O(K){let V=new L;return K.then(Y=>{V.fire(Y)},()=>{V.fire(void 0)}).finally(()=>{V.dispose()}),V.event}ee.fromPromise=O;function k(K,V){return K(Y=>V.fire(Y))}ee.forward=k;function F(K,V,Y){return V(Y),K(j=>V(j))}ee.runAndSubscribe=F;class W{constructor(V,Y){this._observable=V;let j={onWillAddFirstListener:()=>{V.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{V.removeObserver(this)}};Y||e(j),this.emitter=new L(j),Y&&Y.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(V){this._counter++}handlePossibleChange(V){}handleChange(V,Y){this._hasChanged=!0}endUpdate(V){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function H(K,V){return new W(K,V).emitter.event}ee.fromObservable=H;function $(K){return(V,Y,j)=>{let U=0,te=!1,re={beginUpdate(){U++},endUpdate(){U--,U===0&&(K.reportChanges(),te&&(te=!1,V.call(Y)))},handlePossibleChange(){},handleChange(){te=!0}};K.addObserver(re),K.reportChanges();let Ue={dispose(){K.removeObserver(re)}};return j instanceof We?j.add(Ue):Array.isArray(j)&&j.push(Ue),Ue}}ee.fromObservableLight=$})(Ke||={});var xy=class r{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${r._idPool++}`,r.all.add(this)}start(e){this._stopWatch=new Vs,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},xw=-1;var Ey=class r{constructor(e,t,n=(r._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[o,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(o);let l=new wy(a,o);this._errorHandler(l)}return()=>{let o=this._stacks.get(e.value)||0;this._stacks.set(e.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,i]of this._stacks)(!e||t<i)&&(e=[n,i],t=i);return e}},ku=class r{constructor(e){this.value=e}static create(){let e=new Error;return new r(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},wy=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},Ty=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},HR=0,pl=class{constructor(e){this.value=e}stack;id=HR++},zR=2,Ew=(r,e)=>{if(r instanceof pl)e(r);else for(let t=0;t<r.length;t++){let n=r[t];n&&e(n)}},ph;if(VR){let r=[];setInterval(()=>{r.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(r.join(`
`)),r.length=0)},3e3),ph=new FinalizationRegistry(e=>{typeof e=="string"&&r.push(e)})}var L=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=xw>0||this._options?.leakWarningThreshold?new Ey(e?.onListenerError??Le,this._options?.leakWarningThreshold??xw):void 0,this._perfMon=this._options?._profName?new xy(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(_w){let e=this._listeners;queueMicrotask(()=>{Ew(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],u=new Ty(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||Le)(u),B.None}if(this._disposed)return B.None;t&&(e=e.bind(t));let i=new pl(e),o,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=ku.create(),o=this._leakageMon.check(i.stack,this._size+1)),_w&&(i.stack=s??ku.create()),this._listeners?this._listeners instanceof pl?(this._deliveryQueue??=new hh,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=ve(()=>{ph?.unregister(a),o?.(),this._removeListener(i)});if(n instanceof We?n.add(a):Array.isArray(n)&&n.push(a),ph){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);ph.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*zR<=t.length){let o=0;for(let s=0;s<t.length;s++)t[s]?t[o++]=t[s]:i&&(this._deliveryQueue.end--,o<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=o}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||Le;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof pl)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},ww=()=>new hh,hh=class{i=-1;end=0;current;value;enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},hl=class extends L{_asyncDeliveryQueue;async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new mn),Ew(this._listeners,i=>this._asyncDeliveryQueue.push([i.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[i,o]=this._asyncDeliveryQueue.shift(),s=[],a={...o,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,i)),s.push(l)}};try{i(a)}catch(l){Le(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&Le(d.reason)})}}};var mh=class extends L{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}};function Ct(r){return typeof r=="string"}function Ot(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function lo(r){return typeof r=="number"&&!isNaN(r)}function gh(r){return r===!0||r===!1}function On(r){return typeof r>"u"}function Ly(r){return!Di(r)}function Di(r){return On(r)||r===null}function kr(r){if(Di(r))throw new Error("Assertion Failed: argument is undefined or null");return r}var GR=Object.prototype.hasOwnProperty;function Tw(r){if(!Ot(r))return!1;for(let e in r)if(GR.call(r,e))return!1;return!0}function Lw(r){return typeof r=="function"}function kw(r,e){let t=Math.min(r.length,e.length);for(let n=0;n<t;n++)jR(r[n],e[n])}function jR(r,e){if(Ct(e)){if(typeof r!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Lw(e)){try{if(r instanceof e)return}catch{}if(!Di(r)&&r.constructor===e||e.length===1&&e.call(void 0,r)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var ky=Object.create(null);function b(r,e){if(Ct(e)){let t=ky[e];if(t===void 0)throw new Error(`${r} references an unknown codicon: ${e}`);e=t}return ky[r]=e,{id:r}}function Rw(){return ky}var Dw={add:b("add",6e4),plus:b("plus",6e4),gistNew:b("gist-new",6e4),repoCreate:b("repo-create",6e4),lightbulb:b("lightbulb",60001),lightBulb:b("light-bulb",60001),repo:b("repo",60002),repoDelete:b("repo-delete",60002),gistFork:b("gist-fork",60003),repoForked:b("repo-forked",60003),gitPullRequest:b("git-pull-request",60004),gitPullRequestAbandoned:b("git-pull-request-abandoned",60004),recordKeys:b("record-keys",60005),keyboard:b("keyboard",60005),tag:b("tag",60006),gitPullRequestLabel:b("git-pull-request-label",60006),tagAdd:b("tag-add",60006),tagRemove:b("tag-remove",60006),person:b("person",60007),personFollow:b("person-follow",60007),personOutline:b("person-outline",60007),personFilled:b("person-filled",60007),gitBranch:b("git-branch",60008),gitBranchCreate:b("git-branch-create",60008),gitBranchDelete:b("git-branch-delete",60008),sourceControl:b("source-control",60008),mirror:b("mirror",60009),mirrorPublic:b("mirror-public",60009),star:b("star",60010),starAdd:b("star-add",60010),starDelete:b("star-delete",60010),starEmpty:b("star-empty",60010),comment:b("comment",60011),commentAdd:b("comment-add",60011),alert:b("alert",60012),warning:b("warning",60012),search:b("search",60013),searchSave:b("search-save",60013),logOut:b("log-out",60014),signOut:b("sign-out",60014),logIn:b("log-in",60015),signIn:b("sign-in",60015),eye:b("eye",60016),eyeUnwatch:b("eye-unwatch",60016),eyeWatch:b("eye-watch",60016),circleFilled:b("circle-filled",60017),primitiveDot:b("primitive-dot",60017),closeDirty:b("close-dirty",60017),debugBreakpoint:b("debug-breakpoint",60017),debugBreakpointDisabled:b("debug-breakpoint-disabled",60017),debugHint:b("debug-hint",60017),terminalDecorationSuccess:b("terminal-decoration-success",60017),primitiveSquare:b("primitive-square",60018),edit:b("edit",60019),pencil:b("pencil",60019),info:b("info",60020),issueOpened:b("issue-opened",60020),gistPrivate:b("gist-private",60021),gitForkPrivate:b("git-fork-private",60021),lock:b("lock",60021),mirrorPrivate:b("mirror-private",60021),close:b("close",60022),removeClose:b("remove-close",60022),x:b("x",60022),repoSync:b("repo-sync",60023),sync:b("sync",60023),clone:b("clone",60024),desktopDownload:b("desktop-download",60024),beaker:b("beaker",60025),microscope:b("microscope",60025),vm:b("vm",60026),deviceDesktop:b("device-desktop",60026),file:b("file",60027),fileText:b("file-text",60027),more:b("more",60028),ellipsis:b("ellipsis",60028),kebabHorizontal:b("kebab-horizontal",60028),mailReply:b("mail-reply",60029),reply:b("reply",60029),organization:b("organization",60030),organizationFilled:b("organization-filled",60030),organizationOutline:b("organization-outline",60030),newFile:b("new-file",60031),fileAdd:b("file-add",60031),newFolder:b("new-folder",60032),fileDirectoryCreate:b("file-directory-create",60032),trash:b("trash",60033),trashcan:b("trashcan",60033),history:b("history",60034),clock:b("clock",60034),folder:b("folder",60035),fileDirectory:b("file-directory",60035),symbolFolder:b("symbol-folder",60035),logoGithub:b("logo-github",60036),markGithub:b("mark-github",60036),github:b("github",60036),terminal:b("terminal",60037),console:b("console",60037),repl:b("repl",60037),zap:b("zap",60038),symbolEvent:b("symbol-event",60038),error:b("error",60039),stop:b("stop",60039),variable:b("variable",60040),symbolVariable:b("symbol-variable",60040),array:b("array",60042),symbolArray:b("symbol-array",60042),symbolModule:b("symbol-module",60043),symbolPackage:b("symbol-package",60043),symbolNamespace:b("symbol-namespace",60043),symbolObject:b("symbol-object",60043),symbolMethod:b("symbol-method",60044),symbolFunction:b("symbol-function",60044),symbolConstructor:b("symbol-constructor",60044),symbolBoolean:b("symbol-boolean",60047),symbolNull:b("symbol-null",60047),symbolNumeric:b("symbol-numeric",60048),symbolNumber:b("symbol-number",60048),symbolStructure:b("symbol-structure",60049),symbolStruct:b("symbol-struct",60049),symbolParameter:b("symbol-parameter",60050),symbolTypeParameter:b("symbol-type-parameter",60050),symbolKey:b("symbol-key",60051),symbolText:b("symbol-text",60051),symbolReference:b("symbol-reference",60052),goToFile:b("go-to-file",60052),symbolEnum:b("symbol-enum",60053),symbolValue:b("symbol-value",60053),symbolRuler:b("symbol-ruler",60054),symbolUnit:b("symbol-unit",60054),activateBreakpoints:b("activate-breakpoints",60055),archive:b("archive",60056),arrowBoth:b("arrow-both",60057),arrowDown:b("arrow-down",60058),arrowLeft:b("arrow-left",60059),arrowRight:b("arrow-right",60060),arrowSmallDown:b("arrow-small-down",60061),arrowSmallLeft:b("arrow-small-left",60062),arrowSmallRight:b("arrow-small-right",60063),arrowSmallUp:b("arrow-small-up",60064),arrowUp:b("arrow-up",60065),bell:b("bell",60066),bold:b("bold",60067),book:b("book",60068),bookmark:b("bookmark",60069),debugBreakpointConditionalUnverified:b("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:b("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:b("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:b("debug-breakpoint-data-unverified",60072),debugBreakpointData:b("debug-breakpoint-data",60073),debugBreakpointDataDisabled:b("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:b("debug-breakpoint-log-unverified",60074),debugBreakpointLog:b("debug-breakpoint-log",60075),debugBreakpointLogDisabled:b("debug-breakpoint-log-disabled",60075),briefcase:b("briefcase",60076),broadcast:b("broadcast",60077),browser:b("browser",60078),bug:b("bug",60079),calendar:b("calendar",60080),caseSensitive:b("case-sensitive",60081),check:b("check",60082),checklist:b("checklist",60083),chevronDown:b("chevron-down",60084),chevronLeft:b("chevron-left",60085),chevronRight:b("chevron-right",60086),chevronUp:b("chevron-up",60087),chromeClose:b("chrome-close",60088),chromeMaximize:b("chrome-maximize",60089),chromeMinimize:b("chrome-minimize",60090),chromeRestore:b("chrome-restore",60091),circleOutline:b("circle-outline",60092),circle:b("circle",60092),debugBreakpointUnverified:b("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:b("terminal-decoration-incomplete",60092),circleSlash:b("circle-slash",60093),circuitBoard:b("circuit-board",60094),clearAll:b("clear-all",60095),clippy:b("clippy",60096),closeAll:b("close-all",60097),cloudDownload:b("cloud-download",60098),cloudUpload:b("cloud-upload",60099),code:b("code",60100),collapseAll:b("collapse-all",60101),colorMode:b("color-mode",60102),commentDiscussion:b("comment-discussion",60103),creditCard:b("credit-card",60105),dash:b("dash",60108),dashboard:b("dashboard",60109),database:b("database",60110),debugContinue:b("debug-continue",60111),debugDisconnect:b("debug-disconnect",60112),debugPause:b("debug-pause",60113),debugRestart:b("debug-restart",60114),debugStart:b("debug-start",60115),debugStepInto:b("debug-step-into",60116),debugStepOut:b("debug-step-out",60117),debugStepOver:b("debug-step-over",60118),debugStop:b("debug-stop",60119),debug:b("debug",60120),deviceCameraVideo:b("device-camera-video",60121),deviceCamera:b("device-camera",60122),deviceMobile:b("device-mobile",60123),diffAdded:b("diff-added",60124),diffIgnored:b("diff-ignored",60125),diffModified:b("diff-modified",60126),diffRemoved:b("diff-removed",60127),diffRenamed:b("diff-renamed",60128),diff:b("diff",60129),diffSidebyside:b("diff-sidebyside",60129),discard:b("discard",60130),editorLayout:b("editor-layout",60131),emptyWindow:b("empty-window",60132),exclude:b("exclude",60133),extensions:b("extensions",60134),eyeClosed:b("eye-closed",60135),fileBinary:b("file-binary",60136),fileCode:b("file-code",60137),fileMedia:b("file-media",60138),filePdf:b("file-pdf",60139),fileSubmodule:b("file-submodule",60140),fileSymlinkDirectory:b("file-symlink-directory",60141),fileSymlinkFile:b("file-symlink-file",60142),fileZip:b("file-zip",60143),files:b("files",60144),filter:b("filter",60145),flame:b("flame",60146),foldDown:b("fold-down",60147),foldUp:b("fold-up",60148),fold:b("fold",60149),folderActive:b("folder-active",60150),folderOpened:b("folder-opened",60151),gear:b("gear",60152),gift:b("gift",60153),gistSecret:b("gist-secret",60154),gist:b("gist",60155),gitCommit:b("git-commit",60156),gitCompare:b("git-compare",60157),compareChanges:b("compare-changes",60157),gitMerge:b("git-merge",60158),githubAction:b("github-action",60159),githubAlt:b("github-alt",60160),globe:b("globe",60161),grabber:b("grabber",60162),graph:b("graph",60163),gripper:b("gripper",60164),heart:b("heart",60165),home:b("home",60166),horizontalRule:b("horizontal-rule",60167),hubot:b("hubot",60168),inbox:b("inbox",60169),issueReopened:b("issue-reopened",60171),issues:b("issues",60172),italic:b("italic",60173),jersey:b("jersey",60174),json:b("json",60175),kebabVertical:b("kebab-vertical",60176),key:b("key",60177),law:b("law",60178),lightbulbAutofix:b("lightbulb-autofix",60179),linkExternal:b("link-external",60180),link:b("link",60181),listOrdered:b("list-ordered",60182),listUnordered:b("list-unordered",60183),liveShare:b("live-share",60184),loading:b("loading",60185),location:b("location",60186),mailRead:b("mail-read",60187),mail:b("mail",60188),markdown:b("markdown",60189),megaphone:b("megaphone",60190),mention:b("mention",60191),milestone:b("milestone",60192),gitPullRequestMilestone:b("git-pull-request-milestone",60192),mortarBoard:b("mortar-board",60193),move:b("move",60194),multipleWindows:b("multiple-windows",60195),mute:b("mute",60196),noNewline:b("no-newline",60197),note:b("note",60198),octoface:b("octoface",60199),openPreview:b("open-preview",60200),package:b("package",60201),paintcan:b("paintcan",60202),pin:b("pin",60203),play:b("play",60204),run:b("run",60204),plug:b("plug",60205),preserveCase:b("preserve-case",60206),preview:b("preview",60207),project:b("project",60208),pulse:b("pulse",60209),question:b("question",60210),quote:b("quote",60211),radioTower:b("radio-tower",60212),reactions:b("reactions",60213),references:b("references",60214),refresh:b("refresh",60215),regex:b("regex",60216),remoteExplorer:b("remote-explorer",60217),remote:b("remote",60218),remove:b("remove",60219),replaceAll:b("replace-all",60220),replace:b("replace",60221),repoClone:b("repo-clone",60222),repoForcePush:b("repo-force-push",60223),repoPull:b("repo-pull",60224),repoPush:b("repo-push",60225),report:b("report",60226),requestChanges:b("request-changes",60227),rocket:b("rocket",60228),rootFolderOpened:b("root-folder-opened",60229),rootFolder:b("root-folder",60230),rss:b("rss",60231),ruby:b("ruby",60232),saveAll:b("save-all",60233),saveAs:b("save-as",60234),save:b("save",60235),screenFull:b("screen-full",60236),screenNormal:b("screen-normal",60237),searchStop:b("search-stop",60238),server:b("server",60240),settingsGear:b("settings-gear",60241),settings:b("settings",60242),shield:b("shield",60243),smiley:b("smiley",60244),sortPrecedence:b("sort-precedence",60245),splitHorizontal:b("split-horizontal",60246),splitVertical:b("split-vertical",60247),squirrel:b("squirrel",60248),starFull:b("star-full",60249),starHalf:b("star-half",60250),symbolClass:b("symbol-class",60251),symbolColor:b("symbol-color",60252),symbolConstant:b("symbol-constant",60253),symbolEnumMember:b("symbol-enum-member",60254),symbolField:b("symbol-field",60255),symbolFile:b("symbol-file",60256),symbolInterface:b("symbol-interface",60257),symbolKeyword:b("symbol-keyword",60258),symbolMisc:b("symbol-misc",60259),symbolOperator:b("symbol-operator",60260),symbolProperty:b("symbol-property",60261),wrench:b("wrench",60261),wrenchSubaction:b("wrench-subaction",60261),symbolSnippet:b("symbol-snippet",60262),tasklist:b("tasklist",60263),telescope:b("telescope",60264),textSize:b("text-size",60265),threeBars:b("three-bars",60266),thumbsdown:b("thumbsdown",60267),thumbsup:b("thumbsup",60268),tools:b("tools",60269),triangleDown:b("triangle-down",60270),triangleLeft:b("triangle-left",60271),triangleRight:b("triangle-right",60272),triangleUp:b("triangle-up",60273),twitter:b("twitter",60274),unfold:b("unfold",60275),unlock:b("unlock",60276),unmute:b("unmute",60277),unverified:b("unverified",60278),verified:b("verified",60279),versions:b("versions",60280),vmActive:b("vm-active",60281),vmOutline:b("vm-outline",60282),vmRunning:b("vm-running",60283),watch:b("watch",60284),whitespace:b("whitespace",60285),wholeWord:b("whole-word",60286),window:b("window",60287),wordWrap:b("word-wrap",60288),zoomIn:b("zoom-in",60289),zoomOut:b("zoom-out",60290),listFilter:b("list-filter",60291),listFlat:b("list-flat",60292),listSelection:b("list-selection",60293),selection:b("selection",60293),listTree:b("list-tree",60294),debugBreakpointFunctionUnverified:b("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:b("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:b("debug-breakpoint-function-disabled",60296),debugStackframeActive:b("debug-stackframe-active",60297),circleSmallFilled:b("circle-small-filled",60298),debugStackframeDot:b("debug-stackframe-dot",60298),terminalDecorationMark:b("terminal-decoration-mark",60298),debugStackframe:b("debug-stackframe",60299),debugStackframeFocused:b("debug-stackframe-focused",60299),debugBreakpointUnsupported:b("debug-breakpoint-unsupported",60300),symbolString:b("symbol-string",60301),debugReverseContinue:b("debug-reverse-continue",60302),debugStepBack:b("debug-step-back",60303),debugRestartFrame:b("debug-restart-frame",60304),debugAlt:b("debug-alt",60305),callIncoming:b("call-incoming",60306),callOutgoing:b("call-outgoing",60307),menu:b("menu",60308),expandAll:b("expand-all",60309),feedback:b("feedback",60310),gitPullRequestReviewer:b("git-pull-request-reviewer",60310),groupByRefType:b("group-by-ref-type",60311),ungroupByRefType:b("ungroup-by-ref-type",60312),account:b("account",60313),gitPullRequestAssignee:b("git-pull-request-assignee",60313),bellDot:b("bell-dot",60314),debugConsole:b("debug-console",60315),library:b("library",60316),output:b("output",60317),runAll:b("run-all",60318),syncIgnored:b("sync-ignored",60319),pinned:b("pinned",60320),githubInverted:b("github-inverted",60321),serverProcess:b("server-process",60322),serverEnvironment:b("server-environment",60323),pass:b("pass",60324),issueClosed:b("issue-closed",60324),stopCircle:b("stop-circle",60325),playCircle:b("play-circle",60326),record:b("record",60327),debugAltSmall:b("debug-alt-small",60328),vmConnect:b("vm-connect",60329),cloud:b("cloud",60330),merge:b("merge",60331),export:b("export",60332),graphLeft:b("graph-left",60333),magnet:b("magnet",60334),notebook:b("notebook",60335),redo:b("redo",60336),checkAll:b("check-all",60337),pinnedDirty:b("pinned-dirty",60338),passFilled:b("pass-filled",60339),circleLargeFilled:b("circle-large-filled",60340),circleLarge:b("circle-large",60341),circleLargeOutline:b("circle-large-outline",60341),combine:b("combine",60342),gather:b("gather",60342),table:b("table",60343),variableGroup:b("variable-group",60344),typeHierarchy:b("type-hierarchy",60345),typeHierarchySub:b("type-hierarchy-sub",60346),typeHierarchySuper:b("type-hierarchy-super",60347),gitPullRequestCreate:b("git-pull-request-create",60348),runAbove:b("run-above",60349),runBelow:b("run-below",60350),notebookTemplate:b("notebook-template",60351),debugRerun:b("debug-rerun",60352),workspaceTrusted:b("workspace-trusted",60353),workspaceUntrusted:b("workspace-untrusted",60354),workspaceUnknown:b("workspace-unknown",60355),terminalCmd:b("terminal-cmd",60356),terminalDebian:b("terminal-debian",60357),terminalLinux:b("terminal-linux",60358),terminalPowershell:b("terminal-powershell",60359),terminalTmux:b("terminal-tmux",60360),terminalUbuntu:b("terminal-ubuntu",60361),terminalBash:b("terminal-bash",60362),arrowSwap:b("arrow-swap",60363),copy:b("copy",60364),personAdd:b("person-add",60365),filterFilled:b("filter-filled",60366),wand:b("wand",60367),debugLineByLine:b("debug-line-by-line",60368),inspect:b("inspect",60369),layers:b("layers",60370),layersDot:b("layers-dot",60371),layersActive:b("layers-active",60372),compass:b("compass",60373),compassDot:b("compass-dot",60374),compassActive:b("compass-active",60375),azure:b("azure",60376),issueDraft:b("issue-draft",60377),gitPullRequestClosed:b("git-pull-request-closed",60378),gitPullRequestDraft:b("git-pull-request-draft",60379),debugAll:b("debug-all",60380),debugCoverage:b("debug-coverage",60381),runErrors:b("run-errors",60382),folderLibrary:b("folder-library",60383),debugContinueSmall:b("debug-continue-small",60384),beakerStop:b("beaker-stop",60385),graphLine:b("graph-line",60386),graphScatter:b("graph-scatter",60387),pieChart:b("pie-chart",60388),bracket:b("bracket",60175),bracketDot:b("bracket-dot",60389),bracketError:b("bracket-error",60390),lockSmall:b("lock-small",60391),azureDevops:b("azure-devops",60392),verifiedFilled:b("verified-filled",60393),newline:b("newline",60394),layout:b("layout",60395),layoutActivitybarLeft:b("layout-activitybar-left",60396),layoutActivitybarRight:b("layout-activitybar-right",60397),layoutPanelLeft:b("layout-panel-left",60398),layoutPanelCenter:b("layout-panel-center",60399),layoutPanelJustify:b("layout-panel-justify",60400),layoutPanelRight:b("layout-panel-right",60401),layoutPanel:b("layout-panel",60402),layoutSidebarLeft:b("layout-sidebar-left",60403),layoutSidebarRight:b("layout-sidebar-right",60404),layoutStatusbar:b("layout-statusbar",60405),layoutMenubar:b("layout-menubar",60406),layoutCentered:b("layout-centered",60407),target:b("target",60408),indent:b("indent",60409),recordSmall:b("record-small",60410),errorSmall:b("error-small",60411),terminalDecorationError:b("terminal-decoration-error",60411),arrowCircleDown:b("arrow-circle-down",60412),arrowCircleLeft:b("arrow-circle-left",60413),arrowCircleRight:b("arrow-circle-right",60414),arrowCircleUp:b("arrow-circle-up",60415),layoutSidebarRightOff:b("layout-sidebar-right-off",60416),layoutPanelOff:b("layout-panel-off",60417),layoutSidebarLeftOff:b("layout-sidebar-left-off",60418),blank:b("blank",60419),heartFilled:b("heart-filled",60420),map:b("map",60421),mapHorizontal:b("map-horizontal",60421),foldHorizontal:b("fold-horizontal",60421),mapFilled:b("map-filled",60422),mapHorizontalFilled:b("map-horizontal-filled",60422),foldHorizontalFilled:b("fold-horizontal-filled",60422),circleSmall:b("circle-small",60423),bellSlash:b("bell-slash",60424),bellSlashDot:b("bell-slash-dot",60425),commentUnresolved:b("comment-unresolved",60426),gitPullRequestGoToChanges:b("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:b("git-pull-request-new-changes",60428),searchFuzzy:b("search-fuzzy",60429),commentDraft:b("comment-draft",60430),send:b("send",60431),sparkle:b("sparkle",60432),insert:b("insert",60433),mic:b("mic",60434),thumbsdownFilled:b("thumbsdown-filled",60435),thumbsupFilled:b("thumbsup-filled",60436),coffee:b("coffee",60437),snake:b("snake",60438),game:b("game",60439),vr:b("vr",60440),chip:b("chip",60441),piano:b("piano",60442),music:b("music",60443),micFilled:b("mic-filled",60444),repoFetch:b("repo-fetch",60445),copilot:b("copilot",60446),lightbulbSparkle:b("lightbulb-sparkle",60447),robot:b("robot",60448),sparkleFilled:b("sparkle-filled",60449),diffSingle:b("diff-single",60450),diffMultiple:b("diff-multiple",60451),surroundWith:b("surround-with",60452),share:b("share",60453),gitStash:b("git-stash",60454),gitStashApply:b("git-stash-apply",60455),gitStashPop:b("git-stash-pop",60456),vscode:b("vscode",60457),vscodeInsiders:b("vscode-insiders",60458),codeOss:b("code-oss",60459),runCoverage:b("run-coverage",60460),runAllCoverage:b("run-all-coverage",60461),coverage:b("coverage",60462),githubProject:b("github-project",60463),mapVertical:b("map-vertical",60464),foldVertical:b("fold-vertical",60464),mapVerticalFilled:b("map-vertical-filled",60465),foldVerticalFilled:b("fold-vertical-filled",60465),goToSearch:b("go-to-search",60466),percentage:b("percentage",60467),sortPercentage:b("sort-percentage",60467),attach:b("attach",60468)};var qR={dialogError:b("dialog-error","error"),dialogWarning:b("dialog-warning","warning"),dialogInfo:b("dialog-info","info"),dialogClose:b("dialog-close","close"),treeItemExpanded:b("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:b("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:b("tree-filter-on-type-off","list-selection"),treeFilterClear:b("tree-filter-clear","close"),treeItemLoading:b("tree-item-loading","loading"),menuSelection:b("menu-selection","check"),menuSubmenu:b("menu-submenu","chevron-right"),menuBarMore:b("menubar-more","more"),scrollbarButtonLeft:b("scrollbar-button-left","triangle-left"),scrollbarButtonRight:b("scrollbar-button-right","triangle-right"),scrollbarButtonUp:b("scrollbar-button-up","triangle-up"),scrollbarButtonDown:b("scrollbar-button-down","triangle-down"),toolBarMore:b("toolbar-more","more"),quickInputBack:b("quick-input-back","arrow-left"),dropDownButton:b("drop-down-button",60084),symbolCustomColor:b("symbol-customcolor",60252),exportIcon:b("export",60332),workspaceUnspecified:b("workspace-unspecified",60355),newLine:b("newline",60394),thumbsDownFilled:b("thumbsdown-filled",60435),thumbsUpFilled:b("thumbsup-filled",60436),gitFetch:b("git-fetch",60445),lightbulbSparkleAutofix:b("lightbulb-sparkle-autofix",60447),debugBreakpointPending:b("debug-breakpoint-pending",60377)},se={...Dw,...qR};var Pw;(e=>{function r(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=r})(Pw||={});var Nt;(f=>{f.iconNameSegment="[A-Za-z0-9]+",f.iconNameExpression="[A-Za-z0-9-]+",f.iconModifierExpression="~[A-Za-z]+",f.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${f.iconNameExpression})(${f.iconModifierExpression})?$`);function o(v){let y=i.exec(v.id);if(!y)return o(se.error);let[,I,S]=y,x=["codicon","codicon-"+I];return S&&x.push("codicon-modifier-"+S.substring(1)),x}f.asClassNameArray=o;function s(v){return o(v).join(" ")}f.asClassName=s;function a(v){return"."+o(v).join(".")}f.asCSSSelector=a;function l(v){return v&&typeof v=="object"&&typeof v.id=="string"&&(typeof v.color>"u"||Pw.isThemeColor(v.color))}f.isThemeIcon=l;let d=new RegExp(`^\\$\\((${f.iconNameExpression}(?:${f.iconModifierExpression})?)\\)$`);function u(v){let y=d.exec(v);if(!y)return;let[,I]=y;return{id:I}}f.fromString=u;function c(v){return{id:v}}f.fromId=c;function p(v,y){let I=v.id,S=I.lastIndexOf("~");return S!==-1&&(I=I.substring(0,S)),y&&(I=`${I}~${y}`),{id:I}}f.modify=p;function h(v){let y=v.id.lastIndexOf("~");if(y!==-1)return v.id.substring(y+1)}f.getModifier=h;function g(v,y){return v.id===y.id&&v.color?.id===y.color?.id}f.isEqual=g})(Nt||={});var UB=new Uint32Array(10);var HB=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),zB=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),KB=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),GB=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function Mw(r){return r}var fh=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=Mw):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Ru=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=Mw):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let n=this._fn(e);return this._map.set(e,n),this._map2.set(t,n),n}};var Nn=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Us(r){return r<0?0:r>255?255:r|0}function Aw(r){return!r||typeof r!="string"?!0:r.trim().length===0}var $R=/{(\d+)}/g;function Fw(r,...e){return e.length===0?r:r.replace($R,function(t,n){let i=parseInt(n,10);return isNaN(i)||i<0||i>=e.length?t:e[i]})}function Ww(r){return r.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function Xn(r){return r.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function Du(r,e=" "){let t=vh(r,e);return Dy(t,e)}function vh(r,e){if(!r||!e)return r;let t=e.length;if(t===0||r.length===0)return r;let n=0;for(;r.indexOf(e,n)===n;)n=n+t;return r.substring(n)}function Dy(r,e){if(!r||!e)return r;let t=e.length,n=r.length;if(t===0||n===0)return r;let i=n,o=-1;for(;o=r.lastIndexOf(e,i-1),!(o===-1||o+t!==i);){if(o===0)return"";i=o}return r.substring(0,i)}function yh(r,e,t={}){if(!r)throw new Error("Cannot create regex from empty string");e||(r=Xn(r)),t.wholeWord&&(/\B/.test(r.charAt(0))||(r="\\b"+r),/\B/.test(r.charAt(r.length-1))||(r=r+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(r,n)}function Pu(r){return r.split(/\r\n|\r|\n/)}function gt(r){for(let e=0,t=r.length;e<t;e++){let n=r.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function At(r,e=0,t=r.length){for(let n=e;n<t;n++){let i=r.charCodeAt(n);if(i!==32&&i!==9)return r.substring(e,n)}return r.substring(e,t)}function yi(r,e=r.length-1){for(let t=e;t>=0;t--){let n=r.charCodeAt(t);if(n!==32&&n!==9)return t}return-1}function Py(r,e){return r<e?-1:r>e?1:0}function Bw(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),d=e.charCodeAt(i);if(l<d)return-1;if(l>d)return 1}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function My(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),d=e.charCodeAt(i);if(l===d)continue;if(l>=128||d>=128)return Bw(r.toLowerCase(),e.toLowerCase(),t,n,i,o);Hs(l)&&(l-=32),Hs(d)&&(d-=32);let u=l-d;if(u!==0)return u}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function Mu(r){return r>=48&&r<=57}function Hs(r){return r>=97&&r<=122}function Rr(r){return r>=65&&r<=90}function mt(r,e){return r.length===e.length&&My(r,e)===0}function Dr(r,e){let t=e.length;return e.length>r.length?!1:My(r,e,0,t)===0}function Ou(r,e){let t=Math.min(r.length,e.length),n;for(n=0;n<t;n++)if(r.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function Nu(r,e){let t=Math.min(r.length,e.length),n,i=r.length-1,o=e.length-1;for(n=0;n<t;n++)if(r.charCodeAt(i-n)!==e.charCodeAt(o-n))return n;return t}function lt(r){return 55296<=r&&r<=56319}function qo(r){return 56320<=r&&r<=57343}function Ih(r,e){return(r-55296<<10)+(e-56320)+65536}function gl(r,e,t){let n=r.charCodeAt(t);if(lt(n)&&t+1<e){let i=r.charCodeAt(t+1);if(qo(i))return Ih(n,i)}return n}function YR(r,e){let t=r.charCodeAt(e-1);if(qo(t)&&e>1){let n=r.charCodeAt(e-2);if(lt(n))return Ih(n,t)}return t}var zs=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=YR(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=gl(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},Ks=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new zs(e,t)}nextGraphemeLength(){let e=bh.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let o=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(Ow(i,s)){t.setOffset(o);break}i=s}return t.offset-n}prevGraphemeLength(){let e=bh.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let o=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(Ow(s,i)){t.setOffset(o);break}i=s}return n-t.offset}eol(){return this._iterator.eol()}};function Au(r,e){return new Ks(r,e).nextGraphemeLength()}function Oy(r,e){return new Ks(r,e).prevGraphemeLength()}function Ch(r,e){e>0&&qo(r.charCodeAt(e))&&e--;let t=e+Au(r,e);return[t-Oy(r,t),t]}var Ry;function QR(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function uo(r){return Ry||(Ry=QR()),Ry.test(r)}var ZR=/^[\t\n\r\x20-\x7E]*$/;function Sh(r){return ZR.test(r)}var Ny=/[\u2028\u2029]/;function _h(r){return Ny.test(r)}function Ii(r){return r>=11904&&r<=55215||r>=63744&&r<=64255||r>=65281&&r<=65374}function xh(r){return r>=127462&&r<=127487||r===8986||r===8987||r===9200||r===9203||r>=9728&&r<=10175||r===11088||r===11093||r>=127744&&r<=128591||r>=128640&&r<=128764||r>=128992&&r<=129008||r>=129280&&r<=129535||r>=129648&&r<=129782}var Vw=String.fromCharCode(65279);function Uw(r){return!!(r&&r.length>0&&r.charCodeAt(0)===65279)}function Eh(r){let e=26;return r=r%(2*e),r<e?String.fromCharCode(97+r):String.fromCharCode(65+r-e)}function Ow(r,e){return r===0?e!==5&&e!==7:r===2&&e===3?!1:r===4||r===2||r===3||e===4||e===2||e===3?!0:!(r===8&&(e===8||e===9||e===11||e===12)||(r===11||r===9)&&(e===9||e===10)||(r===12||r===10)&&e===10||e===5||e===13||e===7||r===1||r===13&&e===14||r===6&&e===6)}var bh=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_data;constructor(){this._data=XR()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,n=t.length/3,i=1;for(;i<=n;)if(e<t[3*i])i=2*i;else if(e>t[3*i+1])i=2*i+1;else return t[3*i+2];return 0}};function XR(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function Hw(r,e){if(r===0)return 0;let t=JR(r,e);if(t!==void 0)return t;let n=new zs(e,r);return n.prevCodePoint(),n.offset}function JR(r,e){let t=new zs(e,r),n=t.prevCodePoint();for(;eD(n)||n===65039||n===8419;){if(t.offset===0)return;n=t.prevCodePoint()}if(!xh(n))return;let i=t.offset;return i>0&&t.prevCodePoint()===8205&&(i=t.offset),i}function eD(r){return 127995<=r&&r<=127999}var Nw=class r{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new Nn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new fh({getCacheKey:JSON.stringify},e=>{function t(u){let c=new Map;for(let p=0;p<u.length;p+=2)c.set(u[p],u[p+1]);return c}function n(u,c){let p=new Map(u);for(let[h,g]of c)p.set(h,g);return p}function i(u,c){if(!u)return c;let p=new Map;for(let[h,g]of u)c.has(h)&&p.set(h,g);return p}let o=this.ambiguousCharacterData.value,s=e.filter(u=>!u.startsWith("_")&&u in o);s.length===0&&(s=["_default"]);let a;for(let u of s){let c=t(o[u]);a=i(a,c)}let l=t(o._common),d=n(l,a);return new r(d)});static getInstance(e){return r.cache.get(Array.from(e))}static _locales=new Nn(()=>Object.keys(r.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return r._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};function zw(...r){return function(e,t){for(let n=0,i=r.length;n<i;n++){let o=r[n](e,t);if(o)return o}return null}}var d4=Kw.bind(void 0,!1),Wy=Kw.bind(void 0,!0);function Kw(r,e,t){if(!t||t.length<e.length)return null;let n;return r?n=Dr(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function tD(r,e){let t=e.toLowerCase().indexOf(r.toLowerCase());return t===-1?null:[{start:t,end:t+r.length}]}function nD(r,e){return Ay(r.toLowerCase(),e.toLowerCase(),0,0)}function Ay(r,e,t,n){if(t===r.length)return[];if(n===e.length)return null;if(r[t]===e[n]){let i=null;return(i=Ay(r,e,t+1,n+1))?jw({start:n,end:n+1},i):null}return Ay(r,e,t,n+1)}function By(r){return 97<=r&&r<=122}function Fu(r){return 65<=r&&r<=90}function Vy(r){return 48<=r&&r<=57}function iD(r){return r===32||r===9||r===10||r===13}var rD=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(r=>rD.add(r.charCodeAt(0)));function Gw(r){return By(r)||Fu(r)||Vy(r)}function jw(r,e){return e.length===0?e=[r]:r.end===e[0].start?e[0].start=r.start:e.unshift(r),e}function qw(r,e){for(let t=e;t<r.length;t++){let n=r.charCodeAt(t);if(Fu(n)||Vy(n)||t>0&&!Gw(r.charCodeAt(t-1)))return t}return r.length}function Fy(r,e,t,n){if(t===r.length)return[];if(n===e.length)return null;if(r[t]!==e[n].toLowerCase())return null;{let i=null,o=n+1;for(i=Fy(r,e,t+1,n+1);!i&&(o=qw(e,o))<e.length;)i=Fy(r,e,t+1,o),o++;return i===null?null:jw({start:n,end:n+1},i)}}function oD(r){let e=0,t=0,n=0,i=0,o=0;for(let u=0;u<r.length;u++)o=r.charCodeAt(u),Fu(o)&&e++,By(o)&&t++,Gw(o)&&n++,Vy(o)&&i++;let s=e/r.length,a=t/r.length,l=n/r.length,d=i/r.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function sD(r){let{upperPercent:e,lowerPercent:t}=r;return t===0&&e>.6}function aD(r){let{upperPercent:e,lowerPercent:t,alphaPercent:n,numericPercent:i}=r;return t>.2&&e<.8&&n>.6&&i<.2}function lD(r){let e=0,t=0,n=0,i=0;for(let o=0;o<r.length;o++)n=r.charCodeAt(o),Fu(n)&&e++,By(n)&&t++,iD(n)&&i++;return(e===0||t===0)&&i===0?r.length<=30:e<=5}function $w(r,e){if(!e||(e=e.trim(),e.length===0)||!lD(r))return null;e.length>60&&(e=e.substring(0,60));let t=oD(e);if(!aD(t)){if(!sD(t))return null;e=e.toLowerCase()}let n=null,i=0;for(r=r.toLowerCase();i<e.length&&(n=Fy(r,e,0,i))===null;)i=qw(e,i+1);return n}var u4=zw(Wy,$w,tD),c4=zw(Wy,$w,nD),p4=new ki(1e4);var wh=128;function Uy(){let r=[],e=[];for(let t=0;t<=wh;t++)e[t]=0;for(let t=0;t<=wh;t++)r.push(e.slice(0));return r}function Yw(r){let e=[];for(let t=0;t<=r;t++)e[t]=0;return e}var h4=Yw(2*wh),m4=Yw(2*wh),g4=Uy(),f4=Uy(),b4=Uy();var dD;(t=>{t.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}t.isDefault=e})(dD||={});var Hy=new RegExp(`\\$\\(${Nt.iconNameExpression}(?:${Nt.iconModifierExpression})?\\)`,"g"),x4=new RegExp(`(\\\\)?${Hy.source}`,"g");var E4=new RegExp(`\\\\${Hy.source}`,"g");var w4=new RegExp(`(\\s)?(\\\\)?${Hy.source}(\\s)?`,"g");var T4=new RegExp(`\\$\\(${Nt.iconNameCharacter}+\\)`,"g");function $o(r){return r===47||r===92}function Wu(r){return r.replace(/[\\/]/g,Oe.sep)}function Qw(r){return r.indexOf("/")===-1&&(r=Wu(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function zy(r,e=Oe.sep){if(!r)return"";let t=r.length,n=r.charCodeAt(0);if($o(n)){if($o(r.charCodeAt(1))&&!$o(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!$o(r.charCodeAt(o));o++);if(s!==o&&!$o(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if($o(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(Zw(n)&&r.charCodeAt(1)===58)return $o(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let i=r.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if($o(r.charCodeAt(i)))return r.slice(0,i+1)}return""}var uD=/[\\/:\*\?"<>\|]/g,cD=/[/]/g,pD=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function Th(r,e=Fe){let t=e?uD:cD;return!(!r||r.length===0||/^\s+$/.test(r)||(t.lastIndex=0,t.test(r))||e&&pD.test(r)||r==="."||r===".."||e&&r[r.length-1]==="."||e&&r.length!==r.trim().length||r.length>255)}function Bu(r,e,t,n=Mn){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!Dr(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,r.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),r.indexOf(e)===0}function Zw(r){return r>=65&&r<=90||r>=97&&r<=122}function Ky(r,e=Fe){return e?Zw(r.charCodeAt(0))&&r.charCodeAt(1)===58:!1}function Xw(r,e=Fe){return Ky(r,e)?r[0]:void 0}var J;(de=>(de.inMemory="inmemory",de.vscode="vscode",de.internal="private",de.walkThrough="walkThrough",de.walkThroughSnippet="walkThroughSnippet",de.http="http",de.https="https",de.file="file",de.mailto="mailto",de.untitled="untitled",de.data="data",de.command="command",de.vscodeRemote="vscode-remote",de.vscodeRemoteResource="vscode-remote-resource",de.vscodeManagedRemoteResource="vscode-managed-remote-resource",de.vscodeUserData="vscode-userdata",de.vscodeCustomEditor="vscode-custom-editor",de.vscodeNotebookCell="vscode-notebook-cell",de.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",de.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",de.vscodeNotebookCellOutput="vscode-notebook-cell-output",de.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",de.vscodeNotebookMetadata="vscode-notebook-metadata",de.vscodeInteractiveInput="vscode-interactive-input",de.vscodeSettings="vscode-settings",de.vscodeWorkspaceTrust="vscode-workspace-trust",de.vscodeTerminal="vscode-terminal",de.vscodeChatCodeBlock="vscode-chat-code-block",de.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",de.vscodeChatSesssion="vscode-chat-editor",de.webviewPanel="webview-panel",de.vscodeWebview="vscode-webview",de.extension="extension",de.vscodeFileResource="vscode-file",de.tmp="tmp",de.vsls="vsls",de.vscodeSourceControl="vscode-scm",de.commentsInput="comment",de.codeSetting="code-setting",de.outputChannel="output"))(J||={});var mD="tkn",Gy=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=gD(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return Oe.join(this._serverRootPath,J.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Le(a),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let i=this._ports[t],o=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof o=="string"&&(s+=`&${mD}=${encodeURIComponent(o)}`),ae.from({scheme:qi?this._preferredWebSchema:J.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:s})}},Lh=new Gy;function gD(r,e){return Oe.join(e??"/",`${r.quality??"oss"}-${r.commit??"dev"}`)}var qy="vscode-app",jy=class r{static FALLBACK_AUTHORITY=qy;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===J.vscodeRemote?Lh.rewrite(e):e.scheme===J.file&&(ao||HE===`${J.vscodeFileResource}://${r.FALLBACK_AUTHORITY}`)?e.with({scheme:J.vscodeFileResource,authority:e.authority||r.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===J.vscodeFileResource?e.with({scheme:J.file,authority:e.authority!==r.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(ae.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return ae.joinPath(ae.parse(n,!0),e);let i=hy(n,e);return ae.file(i)}return ae.parse(t.toUrl(e))}},Jw=new jy,fD;(o=>{let r=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);o.CoopAndCoep=Object.freeze(r.get("3"));let t="vscode-coi";function n(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:ae.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return r.get(l)}o.getHeadersFromQuery=n;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}o.addSearchParam=i})(fD||={});function co(r){return xu(r,!0)}var Vu=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:Py(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===J.file)return Bu(co(e),co(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if($y(e.authority,t.authority))return Bu(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return ae.joinPath(e,...t)}basenameOrAuthority(e){return st(e)||e.authority}basename(e){return Oe.basename(e.path)}extname(e){return Oe.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===J.file?t=ae.file(ew(co(e))).path:(t=Oe.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===J.file?t=ae.file(Ms(co(e))).path:t=Oe.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!$y(e.authority,t.authority))return;if(e.scheme===J.file){let o=JE(co(e),co(t));return Fe?Wu(o):o}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(n.length,i.length);o<s&&!(n.charCodeAt(o)!==i.charCodeAt(o)&&n.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);n=i.substr(0,o)+n.substr(o)}return Oe.relative(n,i)}resolvePath(e,t){if(e.scheme===J.file){let n=ae.file(XE(co(e),t));return e.with({authority:n.authority,path:n.path})}return t=Qw(t),e.with({path:Oe.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&mt(e,t)}hasTrailingPathSeparator(e,t=Mn){if(e.scheme===J.file){let n=co(e);return n.length>zy(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Mn){return Uu(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Mn){let n=!1;if(e.scheme===J.file){let i=co(e);n=i!==void 0&&i.length===zy(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!Uu(e,t)?e.with({path:e.path+"/"}):e}},je=new Vu(()=>!1),eT=new Vu(r=>r.scheme===J.file?!pt:!0),Yo=new Vu(r=>!0),fl=je.isEqual.bind(je),H4=je.isEqualOrParent.bind(je),z4=je.getComparisonKey.bind(je),bD=je.basenameOrAuthority.bind(je),st=je.basename.bind(je),js=je.extname.bind(je),Yt=je.dirname.bind(je),zt=je.joinPath.bind(je),K4=je.normalizePath.bind(je),kh=je.relativePath.bind(je),G4=je.resolvePath.bind(je),j4=je.isAbsolutePath.bind(je),$y=je.isEqualAuthority.bind(je),Uu=je.hasTrailingPathSeparator.bind(je),Rh=je.removeTrailingPathSeparator.bind(je),po=je.addTrailingPathSeparator.bind(je);var bl;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(u=>{let[c,p]=u.split(":");c&&p&&a.set(c,p)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(o.META_DATA_MIME,d),a}o.parseMetaData=i})(bl||={});function Dh(r,e,t){if(e){let n=r.path;return n&&n[0]!==Oe.sep&&(n=Oe.sep+n),r.with({scheme:t,authority:e,path:n})}return r.with({scheme:t})}var Ph=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(Ph||{});(a=>{let r="error",e="warning",t="warn",n="info",i="ignore";function o(l){return l?mt(r,l)?3:mt(e,l)||mt(t,l)?2:mt(n,l)?1:0:0}a.fromValue=o;function s(l){switch(l){case 3:return r;case 2:return e;case 1:return n;default:return i}}a.toString=s})(Ph||={});var gn=Ph;var Hu=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};var Mh=class{_entries=new Map;constructor(...e){for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var Qo;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(o){return o[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n})(Qo||={});var St=G("instantiationService");function vD(r,e,t){e[Qo.DI_TARGET]===e?e[Qo.DI_DEPENDENCIES].push({id:r,index:t}):(e[Qo.DI_DEPENDENCIES]=[{id:r,index:t}],e[Qo.DI_TARGET]=e)}function G(r){if(Qo.serviceIds.has(r))return Qo.serviceIds.get(r);let e=function(t,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");vD(e,t,i)};return e.toString=()=>r,Qo.serviceIds.set(r,e),e}var yD=G("telemetryService"),gV=G("customEndpointTelemetryService");function Yy(r,e=Fe){return Ky(r,e)?r.charAt(0).toUpperCase()+r.slice(1):r}var PV=G("productService");function vl(r){if(!r||typeof r!="object"||r instanceof RegExp)return r;let e=Array.isArray(r)?[]:{};return Object.entries(r).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?vl(n):n}),e}function Qy(r,e,t=!0){return Ot(r)?(Ot(e)&&Object.keys(e).forEach(n=>{n in r?t&&(Ot(r[n])&&Ot(e[n])?Qy(r[n],e[n],t):r[n]=e[n]):r[n]=e[n]}),r):e}function Ci(r,e){if(r===e)return!0;if(r==null||e===null||e===void 0||typeof r!=typeof e||typeof r!="object"||Array.isArray(r)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(r)){if(r.length!==e.length)return!1;for(t=0;t<r.length;t++)if(!Ci(r[t],e[t]))return!1}else{let i=[];for(n in r)i.push(n);i.sort();let o=[];for(n in e)o.push(n);if(o.sort(),!Ci(i,o))return!1;for(t=0;t<i.length;t++)if(!Ci(r[i[t]],e[i[t]]))return!1}return!0}var Ah=G("dialogService");var qs=G("fileDialogService");var Nh=10;function nT(r){let e=[];return e.push(...r.slice(0,Nh).map(t=>typeof t=="string"?t:st(t))),r.length>Nh&&(r.length-Nh===1?e.push(m("moreFile","...1 additional file not shown")):e.push(m("moreFiles","...{0} additional files not shown",r.length-Nh))),e.push(""),e.join(`
`)}var ID=[];function Jn(r,e,t){e instanceof Hu||(e=new Hu(e,[],!!t)),ID.push([r,e])}var Ku={exports:{}};(function(){function e(o){let s=[];typeof o=="number"&&s.push("code/timeOrigin",o);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let u=0;u<s.length;u+=2)d.push({name:s[u],startTime:s[u+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(o){performance.mark(o)},getMarks(){let o=performance.timeOrigin;typeof o!="number"&&(o=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(o)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(o+a.startTime)});return s}};if(typeof process=="object"){let o=performance?.timeOrigin;return e(o)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function n(o){return o.MonacoPerformanceMarks||(o.MonacoPerformanceMarks=t()),o.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof Ku=="object"&&typeof Ku.exports=="object"?Ku.exports=n(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=n(i))})();var iT=Ku.exports.mark,l5=Ku.exports.getMarks;var $s=G("environmentService"),x5=$s;var Pr=G("contextService");function Fh(r){let e=r;return typeof e?.id=="string"&&ae.isUri(e.uri)}function Wh(r){let e=r;return typeof e?.id=="string"&&ae.isUri(e.configPath)}var Bh="code-workspace",W5=`.${Bh}`,B5=[{name:m("codeWorkspace","Code Workspace"),extensions:[Bh]}];function _D(r,e){return eT.isEqualOrParent(r,e.untitledWorkspacesHome)}function Zy(r){let e;return ae.isUri(r)?e=r:e=r.configuration,e?.scheme===J.tmp}function oT(r,e){return!_D(r,e)&&!Zy(r)}var ln=G("configurationService");function sT(r){return r.replace(/[\[\]]/g,"")}function Vh(r,e){return new Xy(r,e)}var Xy=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?Le(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){let i=n.indexOf(t);i>=0&&n.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(n=>n())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function Jy(r,e,t){r.on("error",n=>{t?.isCancellationRequested||e.onError(n)}),r.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),r.on("data",n=>{t?.isCancellationRequested||e.onData(n)})}function aT(r,e){let t=Vh(e);return t.end(r),t}function lT(r){let e=!1;return{read:()=>e?null:(e=!0,r)}}var Uh=typeof Buffer<"u",ED=new Nn(()=>new Uint8Array(256)),eI,tI,dt=class r{static alloc(e){return Uh?new r(Buffer.allocUnsafe(e)):new r(new Uint8Array(e))}static wrap(e){return Uh&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new r(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&Uh?new r(Buffer.from(e)):(eI||(eI=new TextEncoder),new r(eI.encode(e)))}static fromByteArray(e){let t=r.alloc(e.length);for(let n=0,i=e.length;n<i;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let o=0,s=e.length;o<s;o++)t+=e[o].byteLength}let n=r.alloc(t),i=0;for(let o=0,s=e.length;o<s;o++){let a=e[o];n.set(a,i),i+=a.byteLength}return n}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=r.alloc(this.byteLength);return e.set(this),e}toString(){return Uh?this.buffer.toString():(tI||(tI=new TextDecoder),tI.decode(this.buffer))}slice(e,t){return new r(this.buffer.subarray(e,t))}set(e,t){if(e instanceof r)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Kt(this.buffer,e)}writeUInt32BE(e,t){Gt(this.buffer,e,t)}readUInt32LE(e){return TD(this.buffer,e)}writeUInt32LE(e,t){LD(this.buffer,e,t)}readUInt8(e){return Hh(this.buffer,e)}writeUInt8(e,t){zh(this.buffer,e,t)}indexOf(e,t=0){return wD(this.buffer,e instanceof r?e.buffer:e,t)}};function wD(r,e,t=0){let n=e.byteLength,i=r.byteLength;if(n===0)return 0;if(n===1)return r.indexOf(e[0]);if(n>i-t)return-1;let o=ED.value;o.fill(e.length);for(let d=0;d<e.length;d++)o[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<i;)if(r[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,o[r[s]]),a=e.length-1;return l}function dT(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0}function uT(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255}function Kt(r,e){return r[e]*2**24+r[e+1]*2**16+r[e+2]*2**8+r[e+3]}function Gt(r,e,t){r[t+3]=e,e=e>>>8,r[t+2]=e,e=e>>>8,r[t+1]=e,e=e>>>8,r[t]=e}function TD(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0|r[e+2]<<16>>>0|r[e+3]<<24>>>0}function LD(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255,e=e>>>8,r[t+2]=e&255,e=e>>>8,r[t+3]=e&255}function Hh(r,e){return r[e]}function zh(r,e,t){r[t]=e}function cT(r){return lT(r)}function pT(r){return aT(r,e=>dt.concat(e))}function Yh(r){return!!r&&typeof r.then=="function"}function Ys(r){let e=new Ri,t=r(e.token),n=new Promise((i,o)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),o(new kn)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),i(a)},a=>{s.dispose(),e.dispose(),o(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,o){return n.then(i,o)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}function ju(r,e,t){return new Promise((n,i)=>{let o=e.onCancellationRequested(()=>{o.dispose(),n(t)});r.then(n,i).finally(()=>o.dispose())})}function mT(){let r,e;return{promise:new Promise((n,i)=>{r=n,e=i}),resolve:r,reject:e}}var iI=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(i=>{this.activePromise=null,t(i)},i=>{this.activePromise=null,n(i)})})}dispose(){this.isDisposed=!0}};var kD=(r,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},RD=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},Kh=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===Sw?RD(n):kD(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new kn),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Gh=class{delayer;throttler;constructor(e){this.delayer=new Kh(e),this.throttler=new iI}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}};function Zo(r,e){return e?new Promise((t,n)=>{let i=setTimeout(()=>{o.dispose(),t()},r),o=e.onCancellationRequested(()=>{clearTimeout(i),o.dispose(),n(new kn)})}):Ys(t=>Zo(r,t))}var Zi=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new Re("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Re("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},jh=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new Re("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{e()},t);this.disposable=ve(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},dn=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var rI,yl;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?yl=(r,e)=>{Qp(()=>{if(t)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:yl=(r,e,t)=>{let n=r.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,r.cancelIdleCallback(n))}}},rI=r=>yl(globalThis,r)})();var qh=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=yl(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},Gu=class extends qh{constructor(e){super(globalThis,e)}};var $h=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,n){return this._running={taskId:e,cancel:()=>n?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:n,reject:i}=mT();this._queued={run:e,promise:t,promiseResolve:n,promiseReject:i}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var Il=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new kn)}},ho;(t=>{async function r(n){let i,o=await Promise.all(n.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return o}t.settled=r;function e(n){return new Promise(async(i,o)=>{try{await n(i,o)}catch(s){o(s)}})}t.withAsyncBody=e})(ho||={});var hT=class r{static fromArray(e){return new r(t=>{t.emitMany(e)})}static fromPromise(e){return new r(async t=>{t.emitMany(await e)})}static fromPromises(e){return new r(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new r(async t=>{await Promise.all(e.map(async n=>{for await(let i of n)t.emitOne(i)}))})}static EMPTY=r.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new L,queueMicrotask(async()=>{let n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await Ke.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new r(async n=>{for await(let i of e)n.emitOne(t(i))})}map(e){return r.map(this,e)}static filter(e,t){return new r(async n=>{for await(let i of e)t(i)&&n.emitOne(i)})}filter(e){return r.filter(this,e)}static coalesce(e){return r.filter(e,t=>!!t)}coalesce(){return r.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return r.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var Qh="**",gT="/",Zh="[/\\\\]",Xh="[^/\\\\]",DD=/\//g;function fT(r,e){switch(r){case 0:return"";case 1:return`${Xh}*?`;default:return`(?:${Zh}|${Xh}+${Zh}${e?`|${Zh}${Xh}+`:""})*?`}}function bT(r,e){if(!r)return[];let t=[],n=!1,i=!1,o="";for(let s of r){switch(s){case e:if(!n&&!i){t.push(o),o="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}o+=s}return o&&t.push(o),t}function ST(r){if(!r)return"";let e="",t=bT(r,gT);if(t.every(n=>n===Qh))e=".*";else{let n=!1;t.forEach((i,o)=>{if(i===Qh){if(n)return;e+=fT(2,o===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let u of i){if(u!=="}"&&s){a+=u;continue}if(l&&(u!=="]"||!d)){let c;u==="-"?c=u:(u==="^"||u==="!")&&!d?c="^":u===gT?c="":c=Xn(u),d+=c;continue}switch(u){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${bT(a,",").map(h=>ST(h)).join("|")})`;e+=p,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=Xh;continue;case"*":e+=fT(1);continue;default:e+=Xn(u)}}o<t.length-1&&(t[o+1]!==Qh||o+2<t.length)&&(e+=Zh)}n=i===Qh})}return e}var PD=/^\*\*\/\*\.[\w\.-]+$/,MD=/^\*\*\/([\w\.-]+)\/?$/,OD=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,ND=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,AD=/^\*\*((\/[\w\.-]+)+)\/?$/,FD=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,vT=new ki(1e4),yT=function(){return!1},Mr=function(){return null};function sI(r,e){if(!r)return Mr;let t;typeof r!="string"?t=r.pattern:t=r,t=t.trim();let n=`${t}_${!!e.trimForExclusions}`,i=vT.get(n);if(i)return IT(i,r);let o;return PD.test(t)?i=WD(t.substr(4),t):(o=MD.exec(oI(t,e)))?i=BD(o[1],t):(e.trimForExclusions?ND:OD).test(t)?i=VD(t,e):(o=AD.exec(oI(t,e)))?i=CT(o[1].substr(1),t,!0):(o=FD.exec(oI(t,e)))?i=CT(o[1],t,!1):i=UD(t),vT.set(n,i),IT(i,r)}function IT(r,e){if(typeof e=="string")return r;let t=function(n,i){return Bu(n,e.base,!pt)?r(vh(n.substr(e.base.length),Mn),i):null};return t.allBasenames=r.allBasenames,t.allPaths=r.allPaths,t.basenames=r.basenames,t.patterns=r.patterns,t}function oI(r,e){return e.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function WD(r,e){return function(t,n){return typeof t=="string"&&t.endsWith(r)?e:null}}function BD(r,e){let t=`/${r}`,n=`\\${r}`,i=function(s,a){return typeof s!="string"?null:a?a===r?e:null:s===r||s.endsWith(t)||s.endsWith(n)?e:null},o=[r];return i.basenames=o,i.patterns=[e],i.allBasenames=o,i}function VD(r,e){let t=_T(r.slice(1,-1).split(",").map(a=>sI(a,e)).filter(a=>a!==Mr),r),n=t.length;if(!n)return Mr;if(n===1)return t[0];let i=function(a,l){for(let d=0,u=t.length;d<u;d++)if(t[d](a,l))return r;return null},o=t.find(a=>!!a.allBasenames);o&&(i.allBasenames=o.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function CT(r,e,t){let n=Mn===Oe.sep,i=n?r:r.replace(DD,Mn),o=Mn+i,s=Oe.sep+r,a;return t?a=function(l,d){return typeof l=="string"&&(l===i||l.endsWith(o)||!n&&(l===r||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===i||!n&&l===r)?e:null},a.allPaths=[(t?"*/":"./")+r],a}function UD(r){try{let e=new RegExp(`^${ST(r)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?r:null}}catch{return Mr}}function aI(r,e={}){if(!r)return yT;if(typeof r=="string"||HD(r)){let t=sI(r,e);if(t===Mr)return yT;let n=function(i,o){return!!t(i,o)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return zD(r,e)}function HD(r){let e=r;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function zD(r,e){let t=_T(Object.getOwnPropertyNames(r).map(a=>KD(a,r[a],e)).filter(a=>a!==Mr)),n=t.length;if(!n)return Mr;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];let a=function(u,c){let p;for(let h=0,g=t.length;h<g;h++){let f=t[h](u,c);if(typeof f=="string")return f;Yh(f)&&(p||(p=[]),p.push(f))}return p?(async()=>{for(let h of p){let g=await h;if(typeof g=="string")return g}return null})():null},l=t.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((u,c)=>c.allPaths?u.concat(c.allPaths):u,[]);return d.length&&(a.allPaths=d),a}let i=function(a,l,d){let u,c;for(let p=0,h=t.length;p<h;p++){let g=t[p];g.requiresSiblings&&d&&(l||(l=Jp(a)),u||(u=l.substr(0,l.length-Os(a).length)));let f=g(a,l,u,d);if(typeof f=="string")return f;Yh(f)&&(c||(c=[]),c.push(f))}return c?(async()=>{for(let p of c){let h=await p;if(typeof h=="string")return h}return null})():null},o=t.find(a=>!!a.allBasenames);o&&(i.allBasenames=o.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function KD(r,e,t){if(e===!1)return Mr;let n=sI(r,t);if(n===Mr)return Mr;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let o=(s,a,l,d)=>{if(!d||!n(s,a))return null;let u=i.replace("$(basename)",()=>l),c=d(u);return Yh(c)?c.then(p=>p?r:null):c?r:null};return o.requiresSiblings=!0,o}}return n}function _T(r,e){let t=r.filter(a=>!!a.basenames);if(t.length<2)return r;let n=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),i;if(e){i=[];for(let a=0,l=n.length;a<l;a++)i.push(e)}else i=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let o=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){let c=a.charCodeAt(u-1);if(c===47||c===92)break}l=a.substr(u)}let d=n.indexOf(l);return d!==-1?i[d]:null};o.basenames=n,o.patterns=i,o.allBasenames=n;let s=r.filter(a=>!a.basenames);return s.push(o),s}var An=G("fileService");function xT(r){return!!(r.capabilities&2048)}var Jh=class r extends Error{constructor(t,n){super(t);this.code=n}static create(t,n){let i=new r(t.toString(),n);return GD(i,n),i}};function GD(r,e){return r.name=e?`${e} (FileSystemError)`:"FileSystemError",r}function jD(r){if(!r)return"Unknown";if(r instanceof Jh)return r.code;let e=/^(.+) \(FileSystemError\)$/.exec(r.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function ET(r){if(r instanceof qu)return r.fileOperationResult;switch(jD(r)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var qu=class extends Error{constructor(t,n,i){super(t);this.fileOperationResult=n;this.options=i}};var em=class extends qu{constructor(t,n,i){super(t,2,i);this.stat=n}};var Xi={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},Cl={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"};var wT="files.readonlyInclude",TT="files.readonlyExclude";var $u="";var tm=class r{static KB=1024;static MB=r.KB*r.KB;static GB=r.MB*r.KB;static TB=r.GB*r.KB;static formatSize(e){return lo(e)||(e=0),e<r.KB?m("sizeB","{0}B",e.toFixed(0)):e<r.MB?m("sizeKB","{0}KB",(e/r.KB).toFixed(2)):e<r.GB?m("sizeMB","{0}MB",(e/r.MB).toFixed(2)):e<r.TB?m("sizeGB","{0}GB",(e/r.GB).toFixed(2)):m("sizeTB","{0}TB",(e/r.TB).toFixed(2))}};function mo(r){return{id:r.id,label:r.label,tooltip:r.tooltip??r.label,class:r.class,enabled:r.enabled??!0,checked:r.checked,run:async(...e)=>r.run(...e)}}function lI(r,e){return e&&(r.stack||r.stacktrace)?m("stackTrace.format","{0}: {1}",kT(r),LT(r.stack)||LT(r.stacktrace)):kT(r)}function LT(r){return Array.isArray(r)?r.join(`
`):r}function kT(r){return r.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${r.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof r.code=="string"&&typeof r.errno=="number"&&typeof r.syscall=="string"?m("nodeExceptionMessage","A system error occurred ({0})",r.message):r.message||m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function Yu(r=null,e=!1){if(!r)return m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(r)){let t=$n(r),n=Yu(t[0],e);return t.length>1?m("error.moreErrors","{0} ({1} errors in total)",n,t.length):n}if(Ct(r))return r;if(r.detail){let t=r.detail;if(t.error)return lI(t.error,e);if(t.exception)return lI(t.exception,e)}return r.stack?lI(r,e):r.message?r.message:m("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function dI(r){let e=r;return e instanceof Error&&Array.isArray(e.actions)}function Ji(r){return cI(r,0)}function cI(r,e){switch(typeof r){case"object":return r===null?go(349,e):Array.isArray(r)?$D(r,e):YD(r,e);case"string":return pI(r,e);case"boolean":return qD(r,e);case"number":return go(r,e);case"undefined":return go(937,e);default:return go(617,e)}}function go(r,e){return(e<<5)-e+r|0}function qD(r,e){return go(r?433:863,e)}function pI(r,e){e=go(149417,e);for(let t=0,n=r.length;t<n;t++)e=go(r.charCodeAt(t),e);return e}function $D(r,e){return e=go(104579,e),r.reduce((t,n)=>cI(n,t),e)}function YD(r,e){return e=go(181387,e),Object.keys(r).sort().reduce((t,n)=>(t=pI(n,t),cI(r[n],t)),e)}function uI(r,e,t=32){let n=t-e,i=~((1<<n)-1);return(r<<e|(i&r)>>>n)>>>0}function RT(r,e=0,t=r.byteLength,n=0){for(let i=0;i<t;i++)r[e+i]=n}function QD(r,e,t="0"){for(;r.length<e;)r=t+r;return r}function Qu(r,e=32){return r instanceof ArrayBuffer?Array.from(new Uint8Array(r)).map(t=>t.toString(16).padStart(2,"0")).join(""):QD((r>>>0).toString(16),e/4)}var DT=class r{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,i=this._buffLen,o=this._leftoverHighSurrogate,s,a;for(o!==0?(s=o,a=-1,o=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(lt(s))if(a+1<t){let d=e.charCodeAt(a+1);qo(d)?(a++,l=Ih(s,d)):l=65533}else{o=s;break}else qo(s)&&(l=65533);if(i=this._push(n,i,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=o}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Qu(this._h0)+Qu(this._h1)+Qu(this._h2)+Qu(this._h3)+Qu(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,RT(this._buff,this._buffLen),this._buffLen>56&&(this._step(),RT(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=r._bigBlock32,t=this._buffDV;for(let c=0;c<64;c+=4)e.setUint32(c,t.getUint32(c,!1),!1);for(let c=64;c<320;c+=4)e.setUint32(c,uI(e.getUint32(c-12,!1)^e.getUint32(c-32,!1)^e.getUint32(c-56,!1)^e.getUint32(c-64,!1),1),!1);let n=this._h0,i=this._h1,o=this._h2,s=this._h3,a=this._h4,l,d,u;for(let c=0;c<80;c++)c<20?(l=i&o|~i&s,d=1518500249):c<40?(l=i^o^s,d=1859775393):c<60?(l=i&o|i&s|o&s,d=2400959708):(l=i^o^s,d=3395469782),u=uI(n,5)+l+a+d+e.getUint32(c*4,!1)&4294967295,a=s,s=o,o=uI(i,30),i=n,n=u;this._h0=this._h0+n&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function hI(...r){switch(r.length){case 1:return m("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",r[0]);case 2:return m("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",r[0],r[1]);case 3:return m("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",r[0],r[1],r[2]);default:return}}var ZD=m("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),XD=m("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),Xo=class r{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw ME(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(hI("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(hI("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(hI("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),n=r._keywords.get(t);n?this._addToken(n):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(ZD);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(XD);return}let o=this._input.charCodeAt(e);if(t)t=!1;else if(o===47&&!n){e++;break}else o===91?n=!0:o===92?t=!0:o===93&&(n=!1);e++}for(;e<this._input.length&&r._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var Qt=new Map;Qt.set("false",!1);Qt.set("true",!0);Qt.set("isMac",Me);Qt.set("isLinux",pt);Qt.set("isWindows",Fe);Qt.set("isWeb",qi);Qt.set("isMacNative",Me&&!qi);Qt.set("isEdge",qE);Qt.set("isFirefox",GE);Qt.set("isChrome",uy);Qt.set("isSafari",jE);var JD=Object.prototype.hasOwnProperty;var eP={regexParsingWithErrorRecovery:!0},tP=m("contextkey.parser.error.emptyString","Empty context key expression"),nP=m("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),iP=m("contextkey.parser.error.noInAfterNot","'in' after 'not'."),PT=m("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),rP=m("contextkey.parser.error.unexpectedToken","Unexpected token"),oP=m("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),sP=m("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),aP=m("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),mI=class r{constructor(e=eP){this._config=e}static _parseError=new Error;_scanner=new Xo;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:tP,offset:0,lexeme:"",additionalInfo:nP});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let n=this._peek(),i=n.type===17?oP:void 0;throw this._parsingErrors.push({message:rP,offset:n.offset,lexeme:Xo.getLexeme(n),additionalInfo:i}),r._parseError}return t}catch(t){if(t!==r._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:vt.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:vt.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),fn.INSTANCE;case 12:return this._advance(),_n.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,PT),t?.negate()}case 17:return this._advance(),Zs.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),vt.true();case 12:return this._advance(),vt.false();case 0:{this._advance();let t=this._expr();return this._consume(1,PT),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let o=i.lexeme,s=o.lastIndexOf("/"),a=s===o.length-1?void 0:this._removeFlagsGY(o.substring(s+1)),l;try{l=new RegExp(o.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return rc.create(t,l)}switch(i.type){case 10:case 19:{let o=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<i.lexeme.length;p++)i.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;o.push(Xo.getLexeme(s)),this._advance(),s=this._peek()}let l=o.join(""),d=l.lastIndexOf("/"),u=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),c;try{c=new RegExp(l.substring(1,d),u)}catch{throw this._errExpectedButGot("REGEX",i)}return vt.regex(t,c)}case 18:{let o=i.lexeme;this._advance();let s=null;if(!Aw(o)){let a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){let d=o.slice(a+1,l),u=o[l+1]==="i"?"i":"";try{s=new RegExp(d,u)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return rc.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,iP);let i=this._value();return vt.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return vt.equals(t,i);switch(i){case"true":return vt.has(t);case"false":return vt.not(t);default:return vt.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return vt.notEquals(t,i);switch(i){case"true":return vt.not(t);case"false":return vt.has(t);default:return vt.notEquals(t,i)}}case 5:return this._advance(),nc.create(t,this._value());case 6:return this._advance(),ic.create(t,this._value());case 7:return this._advance(),ec.create(t,this._value());case 8:return this._advance(),tc.create(t,this._value());case 13:return this._advance(),vt.in(t,this._value());default:return vt.has(t)}}case 20:throw this._parsingErrors.push({message:sP,offset:e.offset,lexeme:"",additionalInfo:aP}),r._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){let i=m("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Xo.getLexeme(t)),o=t.offset,s=Xo.getLexeme(t);return this._parsingErrors.push({message:i,offset:o,lexeme:s,additionalInfo:n}),r._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},vt=class{static false(){return fn.INSTANCE}static true(){return _n.INSTANCE}static has(e){return Qs.create(e)}static equals(e,t){return Xu.create(e,t)}static notEquals(e,t){return Ju.create(e,t)}static regex(e,t){return rc.create(e,t)}static in(e,t){return nm.create(e,t)}static notIn(e,t){return im.create(e,t)}static not(e){return Zs.create(e)}static and(...e){return rm.create(e,null,!0)}static or(...e){return oc.create(e,null,!0)}static greater(e,t){return ec.create(e,t)}static greaterEquals(e,t){return tc.create(e,t)}static smaller(e,t){return nc.create(e,t)}static smallerEquals(e,t){return ic.create(e,t)}static _parser=new mI({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function Zu(r,e){return r.cmp(e)}var fn=class r{static INSTANCE=new r;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return _n.INSTANCE}},_n=class r{static INSTANCE=new r;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return fn.INSTANCE}},Qs=class r{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Qt.get(e);return typeof n=="boolean"?n?_n.INSTANCE:fn.INSTANCE:new r(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:NT(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Qt.get(this.key);return typeof e=="boolean"?e?_n.INSTANCE:fn.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=Zs.create(this.key,this)),this.negated}},Xu=class r{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?Qs.create(e,n):Zs.create(e,n);let i=Qt.get(e);return typeof i=="boolean"?t===(i?"true":"false")?_n.INSTANCE:fn.INSTANCE:new r(e,t,n)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:Xs(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Qt.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?_n.INSTANCE:fn.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Ju.create(this.key,this.value,this)),this.negated}},nm=class r{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new r(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:Xs(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?JD.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=im.create(this.key,this.valueKey)),this.negated}},im=class r{constructor(e,t){this.key=e;this.valueKey=t;this._negated=nm.create(e,t)}static create(e,t){return new r(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},Ju=class r{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?Zs.create(e,n):Qs.create(e,n);let i=Qt.get(e);return typeof i=="boolean"?t===(i?"true":"false")?fn.INSTANCE:_n.INSTANCE:new r(e,t,n)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:Xs(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Qt.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?fn.INSTANCE:_n.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Xu.create(this.key,this.value,this)),this.negated}},Zs=class r{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Qt.get(e);return typeof n=="boolean"?n?fn.INSTANCE:_n.INSTANCE:new r(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:NT(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Qt.get(this.key);return typeof e=="boolean"?e?fn.INSTANCE:_n.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Qs.create(this.key,this)),this.negated}};function om(r,e){if(typeof r=="string"){let t=parseFloat(r);isNaN(t)||(r=t)}return typeof r=="string"||typeof r=="number"?e(r):fn.INSTANCE}var ec=class r{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return om(t,i=>new r(e,i,n))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:Xs(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=ic.create(this.key,this.value,this)),this.negated}},tc=class r{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return om(t,i=>new r(e,i,n))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:Xs(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=nc.create(this.key,this.value,this)),this.negated}},nc=class r{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return om(t,i=>new r(e,i,n))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:Xs(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=tc.create(this.key,this.value,this)),this.negated}},ic=class r{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return om(t,i=>new r(e,i,n))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:Xs(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ec.create(this.key,this.value,this)),this.negated}},rc=class r{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new r(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=gI.create(this)),this.negated}},gI=class r{constructor(e){this._actual=e}static create(e){return new r(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new r(this._actual.map(e))}negate(){return this._actual}};function OT(r){let e=null;for(let t=0,n=r.length;t<n;t++){let i=r[t].substituteConstants();if(r[t]!==i&&e===null){e=[];for(let o=0;o<t;o++)e[o]=r[o]}e!==null&&(e[t]=i)}return e===null?r:e}var rm=class r{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return r._normalizeArr(e,t,n)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Zu(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=OT(this.expr);return e===this.expr?this:r.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){let i=[],o=!1;for(let s of e)if(s){if(s.type===1){o=!0;continue}if(s.type===0)return fn.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&o)return _n.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Zu);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,d=oc.create(s.expr.map(u=>r.create([u,a],null,n)),null,l);d&&(i.push(d),i.sort(Zu))}if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return fn.INSTANCE;if(i.length===1)return i[0]}return new r(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new r(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=oc.create(e,this,!0)}return this.negated}},oc=class r{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return r._normalizeArr(e,t,n)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=Zu(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=OT(this.expr);return e===this.expr?this:r.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let i=[],o=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return _n.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&o)return fn.INSTANCE;i.sort(Zu)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return _n.INSTANCE;if(i.length===1)return i[0]}return new r(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new r(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),n=e.shift(),i=[];for(let o of MT(t))for(let s of MT(n))i.push(rm.create([o,s],null,!1));e.unshift(r.create(i,null,!1))}this.negated=r.create(e,this,!0)}return this.negated}},fe=class r extends Qs{static _info=[];static all(){return r._info.values()}_defaultValue;constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?r._info.push({...n,key:e}):n!==!0&&r._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return Xu.create(this.key,e)}notEqualsTo(e){return Ju.create(this.key,e)}},ei=G("contextKeyService");function NT(r,e){return r<e?-1:r>e?1:0}function Xs(r,e,t,n){return r<t?-1:r>t?1:e<n?-1:e>n?1:0}function MT(r){return r.type===9?r.expr:[r]}var WU=Object.freeze({View:Ds("view","View"),Help:Ds("help","Help"),Test:Ds("test","Test"),File:Ds("file","File"),Preferences:Ds("preferences","Preferences"),Developer:Ds({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});function AT(r){let e=!1,t=new Map,n=new Map;if(lP(r,u=>{if(r===u)return!0;let c=JSON.stringify(u);if(c.length<30)return!0;let p=t.get(c);if(!p){let h={schemas:[u]};return t.set(c,h),n.set(u,h),!0}return p.schemas.push(u),n.set(u,p),e=!0,!1}),t.clear(),!e)return JSON.stringify(r);let o="$defs";for(;r.hasOwnProperty(o);)o+="_";let s=[];function a(u){return JSON.stringify(u,(c,p)=>{if(p!==u){let h=n.get(p);if(h&&h.schemas.length>1)return h.id||(h.id=`_${s.length}`,s.push(h.schemas[0])),{$ref:`#/${o}/${h.id}`}}return p})}let l=a(r),d=[];for(let u=0;u<s.length;u++)d.push(`"_${u}":${a(s[u])}`);return d.length?`${l.substring(0,l.length-1)},"${o}":{${d.join(",")}}}`:l}function Sl(r){return typeof r=="object"&&r!==null}function lP(r,e){if(!r||typeof r!="object")return;let t=(...l)=>{for(let d of l)Sl(d)&&s.push(d)},n=(...l)=>{for(let d of l)if(Sl(d))for(let u in d){let c=d[u];Sl(c)&&s.push(c)}},i=(...l)=>{for(let d of l)if(Array.isArray(d))for(let u of d)Sl(u)&&s.push(u)},o=l=>{if(Array.isArray(l))for(let d of l)Sl(d)&&s.push(d);else Sl(l)&&s.push(l)},s=[r],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),o(a.items)),a=s.pop()}var fo=G("commandService"),Js=new class{_commands=new Map;_onDidRegisterCommand=new L;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(r,e){if(!r)throw new Error("invalid command");if(typeof r=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:r,handler:e})}if(r.metadata&&Array.isArray(r.metadata.args)){let s=[];for(let l of r.metadata.args)s.push(l.constraint);let a=r.handler;r.handler=function(l,...d){return kw(d,s),a(l,...d)}}let{id:t}=r,n=this._commands.get(t);n||(n=new mn,this._commands.set(t,n));let i=n.unshift(r),o=ve(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),o}registerCommandAlias(r,e){return Js.registerCommand(r,(t,...n)=>t.get(fo).executeCommand(e,...n))}getCommand(r){let e=this._commands.get(r);if(!(!e||e.isEmpty()))return bi.first(e)}getCommands(){let r=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&r.set(e,t)}return r}};Js.registerCommand("noop",()=>{});var ti=G("logService"),M9=G("loggerService");function dP(r){switch(r){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var O9=new fe("logLevel",dP(3));var H9=G("policy");function es(r,e){let t=Math.pow(10,e);return Math.round(r*t)/t}var xe=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,n,i=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,n))|0,this.a=es(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},Jo=class r{_hslaBrand=void 0;h;s;l;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=es(Math.max(Math.min(1,t),0),3),this.l=es(Math.max(Math.min(1,n),0),3),this.a=es(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,o=e.a,s=Math.max(t,n,i),a=Math.min(t,n,i),l=0,d=0,u=(a+s)/2,c=s-a;if(c>0){switch(d=Math.min(u<=.5?c/(2*u):c/(2-2*u),1),s){case t:l=(n-i)/c+(n<i?6:0);break;case n:l=(i-t)/c+2;break;case i:l=(t-n)/c+4;break}l*=60,l=Math.round(l)}return new r(l,d,u,o)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){let t=e.h/360,{s:n,l:i,a:o}=e,s,a,l;if(n===0)s=a=l=i;else{let d=i<.5?i*(1+n):i+n-i*n,u=2*i-d;s=r._hue2rgb(u,d,t+1/3),a=r._hue2rgb(u,d,t),l=r._hue2rgb(u,d,t-1/3)}return new xe(Math.round(s*255),Math.round(a*255),Math.round(l*255),o)}},_l=class r{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=es(Math.max(Math.min(1,t),0),3),this.v=es(Math.max(Math.min(1,n),0),3),this.a=es(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,o=Math.max(t,n,i),s=Math.min(t,n,i),a=o-s,l=o===0?0:a/o,d;return a===0?d=0:o===t?d=((n-i)/a%6+6)%6:o===n?d=(i-t)/a+2:d=(t-n)/a+4,new r(Math.round(d*60),l,o,e.a)}static toRGBA(e){let{h:t,s:n,v:i,a:o}=e,s=i*n,a=s*(1-Math.abs(t/60%2-1)),l=i-s,[d,u,c]=[0,0,0];return t<60?(d=s,u=a):t<120?(d=a,u=s):t<180?(u=s,c=a):t<240?(u=a,c=s):t<300?(d=a,c=s):t<=360&&(d=s,c=a),d=Math.round((d+l)*255),u=Math.round((u+l)*255),c=Math.round((c+l)*255),new xe(d,u,c,o)}},A=class r{static fromHex(e){return r.Format.CSS.parseHex(e)||r.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:Jo.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:_l.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof xe)this.rgba=e;else if(e instanceof Jo)this._hsla=e,this.rgba=Jo.toRGBA(e);else if(e instanceof _l)this._hsva=e,this.rgba=_l.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&xe.equals(this.rgba,e.rgba)&&Jo.equals(this.hsla,e.hsla)&&_l.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=r._relativeLuminanceForComponent(this.rgba.r),t=r._relativeLuminanceForComponent(this.rgba.g),n=r._relativeLuminanceForComponent(this.rgba.b),i=.2126*e+.7152*t+.0722*n;return es(i,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n}isDarkerThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t<n}lighten(e){return new r(new Jo(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new r(new Jo(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:n,b:i,a:o}=this.rgba;return new r(new xe(t,n,i,o*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new r(new xe(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,n=this.rgba.a,i=t.a,o=n+i*(1-n);if(o<1e-6)return r.transparent;let s=this.rgba.r*n/o+t.r*i*(1-n)/o,a=this.rgba.g*n/o+t.g*i*(1-n)/o,l=this.rgba.b*n/o+t.b*i*(1-n)/o;return new r(new xe(s,a,l,o))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:n,b:i,a:o}=this.rgba;return new r(new xe(e.rgba.r-o*(e.rgba.r-t),e.rgba.g-o*(e.rgba.g-n),e.rgba.b-o*(e.rgba.b-i),1))}flatten(...e){let t=e.reduceRight((n,i)=>r._flatten(i,n));return r._flatten(this,t)}static _flatten(e,t){let n=1-e.rgba.a;return new r(new xe(n*t.rgba.r+e.rgba.a*e.rgba.r,n*t.rgba.g+e.rgba.a*e.rgba.g,n*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=r.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),o=t.getRelativeLuminance();return n=n*(o-i)/o,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),o=t.getRelativeLuminance();return n=n*(i-o)/i,e.darken(n)}static white=new r(new xe(255,255,255,1));static black=new r(new xe(0,0,0,1));static red=new r(new xe(255,0,0,1));static blue=new r(new xe(0,0,255,1));static green=new r(new xe(0,255,0,1));static cyan=new r(new xe(0,255,255,1));static lightgrey=new r(new xe(211,211,211,1));static transparent=new r(new xe(0,0,0,0))};(e=>{let r;(n=>{let t;(g=>{function i(f){return f.rgba.a===1?`rgb(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b})`:e.Format.CSS.formatRGBA(f)}g.formatRGB=i;function o(f){return`rgba(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b}, ${+f.rgba.a.toFixed(2)})`}g.formatRGBA=o;function s(f){return f.hsla.a===1?`hsl(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(f)}g.formatHSL=s;function a(f){return`hsla(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%, ${f.hsla.a.toFixed(2)})`}g.formatHSLA=a;function l(f){let v=f.toString(16);return v.length!==2?"0"+v:v}function d(f){return`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}`}g.formatHex=d;function u(f,v=!1){return v&&f.rgba.a===1?e.Format.CSS.formatHex(f):`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}${l(Math.round(f.rgba.a*255))}`}g.formatHexA=u;function c(f){return f.isOpaque()?e.Format.CSS.formatHex(f):e.Format.CSS.formatRGBA(f)}g.format=c;function p(f){let v=f.length;if(v===0||f.charCodeAt(0)!==35)return null;if(v===7){let y=16*h(f.charCodeAt(1))+h(f.charCodeAt(2)),I=16*h(f.charCodeAt(3))+h(f.charCodeAt(4)),S=16*h(f.charCodeAt(5))+h(f.charCodeAt(6));return new e(new xe(y,I,S,1))}if(v===9){let y=16*h(f.charCodeAt(1))+h(f.charCodeAt(2)),I=16*h(f.charCodeAt(3))+h(f.charCodeAt(4)),S=16*h(f.charCodeAt(5))+h(f.charCodeAt(6)),x=16*h(f.charCodeAt(7))+h(f.charCodeAt(8));return new e(new xe(y,I,S,x/255))}if(v===4){let y=h(f.charCodeAt(1)),I=h(f.charCodeAt(2)),S=h(f.charCodeAt(3));return new e(new xe(16*y+y,16*I+I,16*S+S))}if(v===5){let y=h(f.charCodeAt(1)),I=h(f.charCodeAt(2)),S=h(f.charCodeAt(3)),x=h(f.charCodeAt(4));return new e(new xe(16*y+y,16*I+I,16*S+S,(16*x+x)/255))}return null}g.parseHex=p;function h(f){switch(f){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=n.CSS||={})})(r=e.Format||={})})(A||={});var fI=class{data=new Map;add(e,t){ih(Ct(e)),ih(Ot(t)),ih(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},Xe=new fI;var ea={JSONContribution:"base.contributions.json"};function uP(r){return r.length>0&&r.charAt(r.length-1)==="#"?r.substring(0,r.length-1):r}var bI=class{schemasById;_onDidChangeSchema=new L;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[uP(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?AT(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},cP=new bI;Xe.add(ea.JSONContribution,cP);function pP(r){return r!==null&&typeof r=="object"&&"light"in r&&"dark"in r}var hP={ColorContribution:"base.contributions.colors"},mP="default",vI=class{_onDidChangeSchema=new L;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let n=e.getColor(t);n&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${n.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,n,i=!1,o){let s={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:o};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(a.deprecationMessage=o),i&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=m("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:n,oneOf:[a,{type:"string",const:mP,description:m("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let n=this.colorsById[e];if(n?.defaults){let i=pP(n.defaults)?n.defaults[t.type]:n.defaults;return er(i,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,n)=>{let i=t.indexOf(".")===-1?0:1,o=n.indexOf(".")===-1?0:1;return i!==o?i-o:t.localeCompare(n)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},am=new vI;Xe.add(hP.ColorContribution,am);function C(r,e,t,n,i){return am.registerColor(r,e,t,n,i)}function gP(r,e){switch(r.op){case 0:return er(r.value,e)?.darken(r.factor);case 1:return er(r.value,e)?.lighten(r.factor);case 2:return er(r.value,e)?.transparent(r.factor);case 3:{let t=er(r.background,e);return t?er(r.value,e)?.makeOpaque(t):er(r.value,e)}case 4:for(let t of r.values){let n=er(t,e);if(n)return n}return;case 6:return er(e.defines(r.if)?r.then:r.else,e);case 5:{let t=er(r.value,e);if(!t)return;let n=er(r.background,e);return n?t.isDarkerThan(n)?A.getLighterColor(t,n,r.factor).transparent(r.transparency):A.getDarkerColor(t,n,r.factor).transparent(r.transparency):t.transparent(r.factor*r.transparency)}default:throw rh(r)}}function Or(r,e){return{op:0,value:r,factor:e}}function ni(r,e){return{op:1,value:r,factor:e}}function be(r,e){return{op:2,value:r,factor:e}}function yI(...r){return{op:4,values:r}}function WT(r,e,t){return{op:6,if:r,then:e,else:t}}function II(r,e,t,n){return{op:5,value:r,background:e,factor:t,transparency:n}}function er(r,e){if(r!==null){if(typeof r=="string")return r[0]==="#"?A.fromHex(r):e.getColor(r);if(r instanceof A)return r;if(typeof r=="object")return gP(r,e)}}var BT="vscode://schemas/workbench-colors",VT=Xe.as(ea.JSONContribution);VT.registerSchema(BT,am.getColorSchema());var FT=new dn(()=>VT.notifySchemaChanged(BT),200);am.onDidChangeSchema(()=>{FT.isScheduled()||FT.schedule()});var Ne=C("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},m("foreground","Overall foreground color. This color is only used if not overridden by a component.")),p8=C("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},m("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),h8=C("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},m("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),m8=C("descriptionForeground",{light:"#717171",dark:be(Ne,.7),hcDark:be(Ne,.7),hcLight:be(Ne,.7)},m("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),sc=C("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},m("iconForeground","The default color for icons in the workbench.")),Pi=C("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},m("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),ke=C("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},m("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),yt=C("contrastActiveBorder",{light:null,dark:null,hcDark:Pi,hcLight:Pi},m("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),g8=C("selection.background",null,m("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),f8=C("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},m("textLinkForeground","Foreground color for links in text.")),b8=C("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},m("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),v8=C("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:A.black,hcLight:"#292929"},m("textSeparatorForeground","Color for text separators.")),y8=C("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},m("textPreformatForeground","Foreground color for preformatted text segments.")),I8=C("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},m("textPreformatBackground","Background color for preformatted text segments.")),C8=C("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},m("textBlockQuoteBackground","Background color for block quotes in text.")),S8=C("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:A.white,hcLight:"#292929"},m("textBlockQuoteBorder","Border color for block quotes in text.")),_8=C("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:A.black,hcLight:"#F2F2F2"},m("textCodeBlockBackground","Background color for code blocks in text."));var L8=C("sash.hoverBorder",Pi,m("sashActiveBorder","Border color of active sashes.")),lm=C("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:A.black,hcLight:"#0F4A85"},m("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),k8=C("badge.foreground",{dark:A.white,light:"#333",hcDark:A.white,hcLight:A.white},m("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),UT=C("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},m("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),HT=C("scrollbarSlider.background",{dark:A.fromHex("#797979").transparent(.4),light:A.fromHex("#646464").transparent(.4),hcDark:be(ke,.6),hcLight:be(ke,.4)},m("scrollbarSliderBackground","Scrollbar slider background color.")),zT=C("scrollbarSlider.hoverBackground",{dark:A.fromHex("#646464").transparent(.7),light:A.fromHex("#646464").transparent(.7),hcDark:be(ke,.8),hcLight:be(ke,.8)},m("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),KT=C("scrollbarSlider.activeBackground",{dark:A.fromHex("#BFBFBF").transparent(.4),light:A.fromHex("#000000").transparent(.6),hcDark:ke,hcLight:ke},m("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),R8=C("progressBar.background",{dark:A.fromHex("#0E70C0"),light:A.fromHex("#0E70C0"),hcDark:ke,hcLight:ke},m("progressBarBackground","Background color of the progress bar that can show for long running operations."));var ta=C("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:A.black,hcLight:A.white},m("editorBackground","Editor background color.")),XT=C("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:A.white,hcLight:Ne},m("editorForeground","Editor default foreground color.")),A8=C("editorStickyScroll.background",ta,m("editorStickyScrollBackground","Background color of sticky scroll in the editor")),F8=C("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:A.fromHex("#0F4A85").transparent(.1)},m("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),W8=C("editorStickyScroll.border",{dark:null,light:null,hcDark:ke,hcLight:ke},m("editorStickyScrollBorder","Border color of sticky scroll in the editor")),B8=C("editorStickyScroll.shadow",UT,m("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),ii=C("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:A.white},m("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),ac=C("editorWidget.foreground",Ne,m("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),fP=C("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:ke,hcLight:ke},m("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),V8=C("editorWidget.resizeBorder",null,m("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),U8=C("editorError.background",null,m("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),lc=C("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},m("editorError.foreground","Foreground color of error squigglies in the editor.")),H8=C("editorError.border",{dark:null,light:null,hcDark:A.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},m("errorBorder","If set, color of double underlines for errors in the editor.")),JT=C("editorWarning.background",null,m("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Mi=C("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},m("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),Tl=C("editorWarning.border",{dark:null,light:null,hcDark:A.fromHex("#FFCC00").transparent(.8),hcLight:A.fromHex("#FFCC00").transparent(.8)},m("warningBorder","If set, color of double underlines for warnings in the editor.")),z8=C("editorInfo.background",null,m("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),tr=C("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},m("editorInfo.foreground","Foreground color of info squigglies in the editor.")),Ll=C("editorInfo.border",{dark:null,light:null,hcDark:A.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},m("infoBorder","If set, color of double underlines for infos in the editor.")),e1=C("editorHint.foreground",{dark:A.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},m("editorHint.foreground","Foreground color of hint squigglies in the editor.")),K8=C("editorHint.border",{dark:null,light:null,hcDark:A.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},m("hintBorder","If set, color of double underlines for hints in the editor.")),G8=C("editorLink.activeForeground",{dark:"#4E94CE",light:A.blue,hcDark:A.cyan,hcLight:"#292929"},m("activeLinkForeground","Color of active links.")),xl=C("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},m("editorSelectionBackground","Color of the editor selection.")),t1=C("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:A.white},m("editorSelectionForeground","Color of the selected text for high contrast.")),j8=C("editor.inactiveSelectionBackground",{light:be(xl,.5),dark:be(xl,.5),hcDark:be(xl,.7),hcLight:be(xl,.5)},m("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),q8=C("editor.selectionHighlightBackground",{light:II(xl,ta,.3,.6),dark:II(xl,ta,.3,.6),hcDark:null,hcLight:null},m("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),$8=C("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:yt,hcLight:yt},m("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),Y8=C("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},m("editorFindMatch","Color of the current search match.")),Q8=C("editor.findMatchForeground",null,m("editorFindMatchForeground","Text color of the current search match.")),nr=C("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},m("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),Z8=C("editor.findMatchHighlightForeground",null,m("findMatchHighlightForeground","Foreground color of the other search matches."),!0),X8=C("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},m("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),J8=C("editor.findMatchBorder",{light:null,dark:null,hcDark:yt,hcLight:yt},m("editorFindMatchBorder","Border color of the current search match.")),ts=C("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:yt,hcLight:yt},m("findMatchHighlightBorder","Border color of the other search matches.")),eH=C("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:be(yt,.4),hcLight:be(yt,.4)},m("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),tH=C("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},m("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),GT=C("editorHoverWidget.background",ii,m("hoverBackground","Background color of the editor hover.")),nH=C("editorHoverWidget.foreground",ac,m("hoverForeground","Foreground color of the editor hover.")),iH=C("editorHoverWidget.border",fP,m("hoverBorder","Border color of the editor hover.")),rH=C("editorHoverWidget.statusBarBackground",{dark:ni(GT,.2),light:Or(GT,.05),hcDark:ii,hcLight:ii},m("statusBarBackground","Background color of the editor hover status bar.")),n1=C("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:A.white,hcLight:A.black},m("editorInlayHintForeground","Foreground color of inline hints")),i1=C("editorInlayHint.background",{dark:be(lm,.1),light:be(lm,.1),hcDark:be(A.white,.1),hcLight:be(lm,.1)},m("editorInlayHintBackground","Background color of inline hints")),oH=C("editorInlayHint.typeForeground",n1,m("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),sH=C("editorInlayHint.typeBackground",i1,m("editorInlayHintBackgroundTypes","Background color of inline hints for types")),aH=C("editorInlayHint.parameterForeground",n1,m("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),lH=C("editorInlayHint.parameterBackground",i1,m("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),bP=C("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},m("editorLightBulbForeground","The color used for the lightbulb actions icon.")),dH=C("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),uH=C("editorLightBulbAi.foreground",bP,m("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),cH=C("editor.snippetTabstopHighlightBackground",{dark:new A(new xe(124,124,124,.3)),light:new A(new xe(10,50,100,.2)),hcDark:new A(new xe(124,124,124,.3)),hcLight:new A(new xe(10,50,100,.2))},m("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),pH=C("editor.snippetTabstopHighlightBorder",null,m("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),hH=C("editor.snippetFinalTabstopHighlightBackground",null,m("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),mH=C("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new A(new xe(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},m("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),jT=new A(new xe(155,185,85,.2)),qT=new A(new xe(255,0,0,.2)),gH=C("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},m("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),fH=C("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},m("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),bH=C("diffEditor.insertedLineBackground",{dark:jT,light:jT,hcDark:null,hcLight:null},m("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),vH=C("diffEditor.removedLineBackground",{dark:qT,light:qT,hcDark:null,hcLight:null},m("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),yH=C("diffEditorGutter.insertedLineBackground",null,m("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),IH=C("diffEditorGutter.removedLineBackground",null,m("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),CH=C("diffEditorOverview.insertedForeground",null,m("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),SH=C("diffEditorOverview.removedForeground",null,m("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),_H=C("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},m("diffEditorInsertedOutline","Outline color for the text that got inserted.")),xH=C("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},m("diffEditorRemovedOutline","Outline color for text that got removed.")),EH=C("diffEditor.border",{dark:null,light:null,hcDark:ke,hcLight:ke},m("diffEditorBorder","Border color between the two text editors.")),wH=C("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},m("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),TH=C("diffEditor.unchangedRegionBackground","sideBar.background",m("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),LH=C("diffEditor.unchangedRegionForeground","foreground",m("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),kH=C("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},m("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),r1=C("widget.shadow",{dark:be(A.black,.36),light:be(A.black,.16),hcDark:null,hcLight:null},m("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),RH=C("widget.border",{dark:null,light:null,hcDark:ke,hcLight:ke},m("widgetBorder","Border color of widgets such as find/replace inside the editor.")),$T=C("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},m("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),DH=C("toolbar.hoverOutline",{dark:null,light:null,hcDark:yt,hcLight:yt},m("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),PH=C("toolbar.activeBackground",{dark:ni($T,.1),light:Or($T,.1),hcDark:null,hcLight:null},m("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),MH=C("breadcrumb.foreground",be(Ne,.8),m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),OH=C("breadcrumb.background",ta,m("breadcrumbsBackground","Background color of breadcrumb items.")),NH=C("breadcrumb.focusForeground",{light:Or(Ne,.2),dark:ni(Ne,.1),hcDark:ni(Ne,.1),hcLight:ni(Ne,.1)},m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),AH=C("breadcrumb.activeSelectionForeground",{light:Or(Ne,.2),dark:ni(Ne,.1),hcDark:ni(Ne,.1),hcLight:ni(Ne,.1)},m("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),FH=C("breadcrumbPicker.background",ii,m("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),o1=.5,YT=A.fromHex("#40C8AE").transparent(o1),QT=A.fromHex("#40A6FF").transparent(o1),ZT=A.fromHex("#606060").transparent(.4),xI=.4,El=1,CI=C("merge.currentHeaderBackground",{dark:YT,light:YT,hcDark:null,hcLight:null},m("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),WH=C("merge.currentContentBackground",be(CI,xI),m("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),SI=C("merge.incomingHeaderBackground",{dark:QT,light:QT,hcDark:null,hcLight:null},m("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),BH=C("merge.incomingContentBackground",be(SI,xI),m("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),_I=C("merge.commonHeaderBackground",{dark:ZT,light:ZT,hcDark:null,hcLight:null},m("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),VH=C("merge.commonContentBackground",be(_I,xI),m("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),wl=C("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},m("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),UH=C("editorOverviewRuler.currentContentForeground",{dark:be(CI,El),light:be(CI,El),hcDark:wl,hcLight:wl},m("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),HH=C("editorOverviewRuler.incomingContentForeground",{dark:be(SI,El),light:be(SI,El),hcDark:wl,hcLight:wl},m("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),zH=C("editorOverviewRuler.commonContentForeground",{dark:be(_I,El),light:be(_I,El),hcDark:wl,hcLight:wl},m("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),KH=C("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},m("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),GH=C("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",m("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),jH=C("problemsErrorIcon.foreground",lc,m("problemsErrorIconForeground","The color used for the problems error icon.")),qH=C("problemsWarningIcon.foreground",Mi,m("problemsWarningIconForeground","The color used for the problems warning icon.")),$H=C("problemsInfoIcon.foreground",tr,m("problemsInfoIconForeground","The color used for the problems info icon."));var s1=C("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},m("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),e6=C("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),EI=C("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),t6=C("minimap.infoHighlight",{dark:tr,light:tr,hcDark:Ll,hcLight:Ll},m("minimapInfo","Minimap marker color for infos.")),n6=C("minimap.warningHighlight",{dark:Mi,light:Mi,hcDark:Tl,hcLight:Tl},m("overviewRuleWarning","Minimap marker color for warnings.")),i6=C("minimap.errorHighlight",{dark:new A(new xe(255,18,18,.7)),light:new A(new xe(255,18,18,.7)),hcDark:new A(new xe(255,50,50,1)),hcLight:"#B5200D"},m("minimapError","Minimap marker color for errors.")),a1=C("minimap.background",null,m("minimapBackground","Minimap background color.")),l1=C("minimap.foregroundOpacity",A.fromHex("#000f"),m("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),r6=C("minimapSlider.background",be(HT,.5),m("minimapSliderBackground","Minimap slider background color.")),o6=C("minimapSlider.hoverBackground",be(zT,.5),m("minimapSliderHoverBackground","Minimap slider background color when hovering.")),s6=C("minimapSlider.activeBackground",be(KT,.5),m("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var p6=C("charts.foreground",Ne,m("chartsForeground","The foreground color used in charts.")),h6=C("charts.lines",be(Ne,.5),m("chartsLines","The color used for horizontal lines in charts.")),m6=C("charts.red",lc,m("chartsRed","The red color used in chart visualizations.")),g6=C("charts.blue",tr,m("chartsBlue","The blue color used in chart visualizations.")),f6=C("charts.yellow",Mi,m("chartsYellow","The yellow color used in chart visualizations.")),b6=C("charts.orange",s1,m("chartsOrange","The orange color used in chart visualizations.")),v6=C("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},m("chartsGreen","The green color used in chart visualizations.")),y6=C("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},m("chartsPurple","The purple color used in chart visualizations."));var E6=C("input.background",{dark:"#3C3C3C",light:A.white,hcDark:A.black,hcLight:A.white},m("inputBoxBackground","Input box background.")),w6=C("input.foreground",Ne,m("inputBoxForeground","Input box foreground.")),T6=C("input.border",{dark:null,light:null,hcDark:ke,hcLight:ke},m("inputBoxBorder","Input box border.")),vP=C("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:ke,hcLight:ke},m("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),yP=C("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},m("inputOption.hoverBackground","Background color of activated options in input fields.")),IP=C("inputOption.activeBackground",{dark:be(Pi,.4),light:be(Pi,.2),hcDark:A.transparent,hcLight:A.transparent},m("inputOption.activeBackground","Background hover color of options in input fields.")),CP=C("inputOption.activeForeground",{dark:A.white,light:A.black,hcDark:Ne,hcLight:Ne},m("inputOption.activeForeground","Foreground color of activated options in input fields.")),L6=C("input.placeholderForeground",{light:be(Ne,.5),dark:be(Ne,.5),hcDark:be(Ne,.7),hcLight:be(Ne,.7)},m("inputPlaceholderForeground","Input box foreground color for placeholder text.")),k6=C("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:A.black,hcLight:A.white},m("inputValidationInfoBackground","Input validation background color for information severity.")),R6=C("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:Ne},m("inputValidationInfoForeground","Input validation foreground color for information severity.")),D6=C("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:ke,hcLight:ke},m("inputValidationInfoBorder","Input validation border color for information severity.")),P6=C("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:A.black,hcLight:A.white},m("inputValidationWarningBackground","Input validation background color for warning severity.")),M6=C("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:Ne},m("inputValidationWarningForeground","Input validation foreground color for warning severity.")),O6=C("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:ke,hcLight:ke},m("inputValidationWarningBorder","Input validation border color for warning severity.")),N6=C("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:A.black,hcLight:A.white},m("inputValidationErrorBackground","Input validation background color for error severity.")),A6=C("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:Ne},m("inputValidationErrorForeground","Input validation foreground color for error severity.")),F6=C("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:ke,hcLight:ke},m("inputValidationErrorBorder","Input validation border color for error severity.")),cm=C("dropdown.background",{dark:"#3C3C3C",light:A.white,hcDark:A.black,hcLight:A.white},m("dropdownBackground","Dropdown background.")),W6=C("dropdown.listBackground",{dark:null,light:null,hcDark:A.black,hcLight:A.white},m("dropdownListBackground","Dropdown list background.")),wI=C("dropdown.foreground",{dark:"#F0F0F0",light:Ne,hcDark:A.white,hcLight:Ne},m("dropdownForeground","Dropdown foreground.")),SP=C("dropdown.border",{dark:cm,light:"#CECECE",hcDark:ke,hcLight:ke},m("dropdownBorder","Dropdown border.")),_P=C("button.foreground",A.white,m("buttonForeground","Button foreground color.")),B6=C("button.separator",be(_P,.4),m("buttonSeparator","Button separator color.")),dm=C("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},m("buttonBackground","Button background color.")),V6=C("button.hoverBackground",{dark:ni(dm,.2),light:Or(dm,.2),hcDark:dm,hcLight:dm},m("buttonHoverBackground","Button background color when hovering.")),U6=C("button.border",ke,m("buttonBorder","Button border color.")),H6=C("button.secondaryForeground",{dark:A.white,light:A.white,hcDark:A.white,hcLight:Ne},m("buttonSecondaryForeground","Secondary button foreground color.")),d1=C("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:A.white},m("buttonSecondaryBackground","Secondary button background color.")),z6=C("button.secondaryHoverBackground",{dark:ni(d1,.2),light:Or(d1,.2),hcDark:null,hcLight:null},m("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),um=C("radio.activeForeground",CP,m("radioActiveForeground","Foreground color of active radio option.")),K6=C("radio.activeBackground",IP,m("radioBackground","Background color of active radio option.")),G6=C("radio.activeBorder",vP,m("radioActiveBorder","Border color of the active radio option.")),j6=C("radio.inactiveForeground",null,m("radioInactiveForeground","Foreground color of inactive radio option.")),q6=C("radio.inactiveBackground",null,m("radioInactiveBackground","Background color of inactive radio option.")),$6=C("radio.inactiveBorder",{light:be(um,.2),dark:be(um,.2),hcDark:be(um,.4),hcLight:be(um,.2)},m("radioInactiveBorder","Border color of the inactive radio option.")),Y6=C("radio.inactiveHoverBackground",yP,m("radioHoverBackground","Background color of inactive active radio option when hovering.")),Q6=C("checkbox.background",cm,m("checkbox.background","Background color of checkbox widget.")),Z6=C("checkbox.selectBackground",ii,m("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),X6=C("checkbox.foreground",wI,m("checkbox.foreground","Foreground color of checkbox widget.")),J6=C("checkbox.border",SP,m("checkbox.border","Border color of checkbox widget.")),e3=C("checkbox.selectBorder",sc,m("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),t3=C("keybindingLabel.background",{dark:new A(new xe(128,128,128,.17)),light:new A(new xe(221,221,221,.4)),hcDark:A.transparent,hcLight:A.transparent},m("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),n3=C("keybindingLabel.foreground",{dark:A.fromHex("#CCCCCC"),light:A.fromHex("#555555"),hcDark:A.white,hcLight:Ne},m("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),i3=C("keybindingLabel.border",{dark:new A(new xe(51,51,51,.6)),light:new A(new xe(204,204,204,.4)),hcDark:new A(new xe(111,195,223)),hcLight:ke},m("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),r3=C("keybindingLabel.bottomBorder",{dark:new A(new xe(68,68,68,.6)),light:new A(new xe(187,187,187,.4)),hcDark:new A(new xe(111,195,223)),hcLight:Ne},m("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var u3=C("list.focusBackground",null,m("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),c3=C("list.focusForeground",null,m("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),p3=C("list.focusOutline",{dark:Pi,light:Pi,hcDark:yt,hcLight:yt},m("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),h3=C("list.focusAndSelectionOutline",null,m("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),na=C("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:A.fromHex("#0F4A85").transparent(.1)},m("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),dc=C("list.activeSelectionForeground",{dark:A.white,light:A.white,hcDark:null,hcLight:null},m("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),u1=C("list.activeSelectionIconForeground",null,m("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),m3=C("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:A.fromHex("#0F4A85").transparent(.1)},m("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),g3=C("list.inactiveSelectionForeground",null,m("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),f3=C("list.inactiveSelectionIconForeground",null,m("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),b3=C("list.inactiveFocusBackground",null,m("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),v3=C("list.inactiveFocusOutline",null,m("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),y3=C("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:A.white.transparent(.1),hcLight:A.fromHex("#0F4A85").transparent(.1)},m("listHoverBackground","List/Tree background when hovering over items using the mouse.")),I3=C("list.hoverForeground",null,m("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),C3=C("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},m("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),S3=C("list.dropBetweenBackground",{dark:sc,light:sc,hcDark:null,hcLight:null},m("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),pm=C("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Pi,hcLight:Pi},m("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),_3=C("list.focusHighlightForeground",{dark:pm,light:WT(na,pm,"#BBE7FF"),hcDark:pm,hcLight:pm},m("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),x3=C("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},m("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),E3=C("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},m("listErrorForeground","Foreground color of list items containing errors.")),w3=C("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},m("listWarningForeground","Foreground color of list items containing warnings.")),T3=C("listFilterWidget.background",{light:Or(ii,0),dark:ni(ii,0),hcDark:ii,hcLight:ii},m("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),L3=C("listFilterWidget.outline",{dark:A.transparent,light:A.transparent,hcDark:"#f38518",hcLight:"#007ACC"},m("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),k3=C("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:ke,hcLight:ke},m("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),R3=C("listFilterWidget.shadow",r1,m("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),D3=C("list.filterMatchBackground",{dark:nr,light:nr,hcDark:null,hcLight:null},m("listFilterMatchHighlight","Background color of the filtered match.")),P3=C("list.filterMatchBorder",{dark:ts,light:ts,hcDark:ke,hcLight:yt},m("listFilterMatchHighlightBorder","Border color of the filtered match.")),M3=C("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},m("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),xP=C("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},m("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),O3=C("tree.inactiveIndentGuidesStroke",be(xP,.4),m("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),N3=C("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},m("tableColumnsBorder","Table border color between columns.")),A3=C("tree.tableOddRowsBackground",{dark:be(Ne,.04),light:be(Ne,.04),hcDark:null,hcLight:null},m("tableOddRowsBackgroundColor","Background color for odd table rows.")),F3=C("editorActionList.background",ii,m("editorActionListBackground","Action List background color.")),W3=C("editorActionList.foreground",ac,m("editorActionListForeground","Action List foreground color.")),B3=C("editorActionList.focusForeground",dc,m("editorActionListFocusForeground","Action List foreground color for the focused item.")),V3=C("editorActionList.focusBackground",na,m("editorActionListFocusBackground","Action List background color for the focused item."));var j3=C("menu.border",{dark:null,light:null,hcDark:ke,hcLight:ke},m("menuBorder","Border color of menus.")),q3=C("menu.foreground",wI,m("menuForeground","Foreground color of menu items.")),$3=C("menu.background",cm,m("menuBackground","Background color of menu items.")),Y3=C("menu.selectionForeground",dc,m("menuSelectionForeground","Foreground color of the selected menu item in menus.")),Q3=C("menu.selectionBackground",na,m("menuSelectionBackground","Background color of the selected menu item in menus.")),Z3=C("menu.selectionBorder",{dark:null,light:null,hcDark:yt,hcLight:yt},m("menuSelectionBorder","Border color of the selected menu item in menus.")),X3=C("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:ke,hcLight:ke},m("menuSeparatorBackground","Color of a separator menu item in menus."));var rz=C("quickInput.background",ii,m("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),oz=C("quickInput.foreground",ac,m("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),sz=C("quickInputTitle.background",{dark:new A(new xe(255,255,255,.105)),light:new A(new xe(0,0,0,.06)),hcDark:"#000000",hcLight:A.white},m("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),az=C("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:A.white,hcLight:"#0F4A85"},m("pickerGroupForeground","Quick picker color for grouping labels.")),lz=C("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:A.white,hcLight:"#0F4A85"},m("pickerGroupBorder","Quick picker color for grouping borders.")),c1=C("quickInput.list.focusBackground",null,"",void 0,m("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),dz=C("quickInputList.focusForeground",dc,m("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),uz=C("quickInputList.focusIconForeground",u1,m("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),cz=C("quickInputList.focusBackground",{dark:yI(c1,na),light:yI(c1,na),hcDark:null,hcLight:null},m("quickInput.listFocusBackground","Quick picker background color for the focused item."));var fz=C("search.resultsInfoForeground",{light:Ne,dark:be(Ne,.65),hcDark:Ne,hcLight:Ne},m("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),bz=C("searchEditor.findMatchBackground",{light:be(nr,.66),dark:be(nr,.66),hcDark:nr,hcLight:nr},m("searchEditor.queryMatch","Color of the Search Editor query matches.")),vz=C("searchEditor.findMatchBorder",{light:be(ts,.66),dark:be(ts,.66),hcDark:ts,hcLight:ts},m("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var EP={IconContribution:"base.contributions.icons"},wP;(e=>{function r(t,n){let i=t.defaults;for(;Nt.isThemeIcon(i);){let o=kl.getIcon(i.id);if(!o)return;i=o.defaults}return i}e.getDefinition=r})(wP||={});var TP;(t=>{function r(n){return{weight:n.weight,style:n.style,src:n.src.map(i=>({format:i.format,location:i.location.toString()}))}}t.toJSONObject=r;function e(n){let i=o=>Ct(o)?o:void 0;if(n&&Array.isArray(n.src)&&n.src.every(o=>Ct(o.format)&&Ct(o.location)))return{weight:i(n.weight),style:i(n.style),src:n.src.map(o=>({format:o.format,location:ae.parse(o.location)}))}}t.fromJSONObject=e})(TP||={});var TI=class{_onDidChange=new L;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:m("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:m("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${Nt.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){let o=this.iconsById[e];if(o){if(n&&!o.description){o.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return o}let s={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return i&&(a.deprecationMessage=i),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(o,s)=>o.id.localeCompare(s.id),t=o=>{for(;Nt.isThemeIcon(o.defaults);)o=this.iconsById[o.defaults.id];return`codicon codicon-${o?o.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let i=Object.keys(this.iconsById).map(o=>this.iconsById[o]);for(let o of i.filter(s=>!!s.description).sort(e))n.push(`|<i class="${t(o)}"></i>|${o.id}|${Nt.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(let o of i.filter(s=>!Nt.isThemeIcon(s.defaults)).sort(e))n.push(`|<i class="${t(o)}"></i>|${o.id}|`);return n.join(`
`)}},kl=new TI;Xe.add(EP.IconContribution,kl);function LI(r,e,t,n){return kl.registerIcon(r,e,t,n)}function LP(){let r=Rw();for(let e in r){let t="\\"+r[e].toString(16);kl.registerIcon(e,{fontCharacter:t})}}LP();var h1="vscode://schemas/icons",m1=Xe.as(ea.JSONContribution);m1.registerSchema(h1,kl.getIconSchema());var p1=new dn(()=>m1.notifySchemaChanged(h1),200);kl.onDidChange(()=>{p1.isScheduled()||p1.schedule()});var qz=LI("widget-close",se.close,m("widgetClose","Icon for the close action in widgets.")),$z=LI("goto-previous-location",se.arrowUp,m("previousChangeIcon","Icon for goto previous editor location.")),Yz=LI("goto-next-location",se.arrowDown,m("nextChangeIcon","Icon for goto next editor location.")),Qz=Nt.modify(se.sync,"spin"),Zz=Nt.modify(se.loading,"spin");function ns(r){return r==="hcDark"||r==="hcLight"}var hm=G("themeService");var bK=se.file,vK=se.folder;function uc(r){switch(r){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var kP={ThemingContribution:"base.contributions.theming"},kI=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new L}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),ve(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},g1=new kI;Xe.add(kP.ThemingContribution,g1);function xn(r){return g1.onColorThemeChange(r)}var Rl=G("IUriIdentityService");var ia=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?r=crypto.getRandomValues.bind(crypto):r=function(n){for(let i=0;i<n.length;i++)n[i]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){r(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,o="";return o+=t[e[i++]],o+=t[e[i++]],o+=t[e[i++]],o+=t[e[i++]],o+="-",o+=t[e[i++]],o+=t[e[i++]],o+="-",o+=t[e[i++]],o+=t[e[i++]],o+="-",o+=t[e[i++]],o+=t[e[i++]],o+="-",o+=t[e[i++]],o+=t[e[i++]],o+=t[e[i++]],o+=t[e[i++]],o+=t[e[i++]],o+=t[e[i++]],o}}();var YK=G("IUserDataProfilesService");function mm(r,e,t,n,i,o){return{id:r,name:e,location:t,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:o&&i?.useDefaultFlags?.globalState?o.globalStorageHome:zt(t,"globalStorage"),settingsResource:o&&i?.useDefaultFlags?.settings?o.settingsResource:zt(t,"settings.json"),keybindingsResource:o&&i?.useDefaultFlags?.keybindings?o.keybindingsResource:zt(t,"keybindings.json"),tasksResource:o&&i?.useDefaultFlags?.tasks?o.tasksResource:zt(t,"tasks.json"),snippetsHome:o&&i?.useDefaultFlags?.snippets?o.snippetsHome:zt(t,"snippets"),extensionsResource:o&&i?.useDefaultFlags?.extensions?o.extensionsResource:zt(t,"extensions.json"),cacheHome:zt(n,r),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var gm=class extends B{constructor(t,n,i,o){super();this.environmentService=t;this.fileService=n;this.uriIdentityService=i;this.logService=o;this.profilesHome=zt(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=zt(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new L);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new L);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new L);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new L);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new hn,workspaces:new hn,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),n=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!Ct(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}n.push(mm(st(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let i=new hn,o=new Map;if(n.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=ae.parse(a),u=n.find(c=>c.id===l);u&&i.set(d,u)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=n.find(u=>u.id===l);d&&o.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:n,workspaces:i,emptyWindows:o}}return this._profilesObject}createDefaultProfile(){let t=mm("__default__profile__",m("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let n="Temp",i=new RegExp(`${Xn(n)}\\s(\\d+)`),o=0;for(let a of this.profiles){let l=i.exec(a.name),d=l?parseInt(l[1]):0;o=d>o?d:o}let s=`${n} ${o+1}`;return this.createProfile(Ji(ia()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,n,i){return this.createProfile(Ji(ia()).toString(16),t,n,i)}async createProfile(t,n,i,o){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,n,i);return o&&await this.setProfileForWorkspace(o,s),s}async doCreateProfile(t,n,i){if(!Ct(n)||!n)throw new Error("Name of the profile is mandatory and must be of type `string`");let o=this.profileCreationPromises.get(n);return o||(o=(async()=>{try{if(this.profiles.find(d=>d.name===n||d.id===t))throw new Error(`Profile with ${n} name already exists`);let a=mm(t,n,zt(this.profilesHome,t),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await ho.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(n)}})(),this.profileCreationPromises.set(n,o)),o}async updateProfile(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(o=>o.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);return i=mm(i.id,n.name??i.name,i.location,this.profilesCacheHome,{shortName:n.shortName??i.shortName,icon:n.icon===null?void 0:n.icon??i.icon,transient:n.transient??i.isTransient,useDefaultFlags:n.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let n=this.profiles.find(o=>o.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:n,join(o){i.push(o)}});try{await Promise.allSettled(i)}catch(o){this.logService.error(o)}for(let o of[...this.profilesObject.emptyWindows.keys()])n.id===this.profilesObject.emptyWindows.get(o)?.id&&this.profilesObject.emptyWindows.delete(o);for(let o of[...this.profilesObject.workspaces.keys()])n.id===this.profilesObject.workspaces.get(o)?.id&&this.profilesObject.workspaces.delete(o);this.updateStoredProfileAssociations(),this.updateProfiles([],[n],[]);try{await this.fileService.del(n.cacheHome,{recursive:!0})}catch(o){ET(o)!==1&&this.logService.error(o)}}async setProfileForWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(o=>o.id===n.id);if(!i)throw new Error(`Profile '${n.name}' does not exist`);this.updateWorkspaceAssociation(t,i)}unsetWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,n)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(n=>n.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(n=>!this.isProfileAssociatedToWorkspace(n));await Promise.allSettled(t.map(n=>this.removeProfile(n)))}getProfileForWorkspace(t){let n=this.getWorkspace(t),i=ae.isUri(n)?this.profilesObject.workspaces.get(n):this.profilesObject.emptyWindows.get(n);return i||(Fh(t)?this.transientProfilesObject.folders.get(t.uri):Wh(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return Fh(t)?t.uri:Wh(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.profilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.folders.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location)))}updateProfiles(t,n,i){let o=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of o){if(l.isDefault||n.some(u=>l.id===u.id))continue;l=i.find(u=>l.id===u.id)??l;let d=a.find(u=>l.id===u.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[u,c]of this.transientProfilesObject.emptyWindows.entries())if(l.id===c.id){this.updateWorkspaceAssociation({id:u},l);break}for(let[u,c]of this.transientProfilesObject.workspaces.entries())if(l.id===c.id){this.updateWorkspaceAssociation({id:"",configPath:u},l);break}for(let[u,c]of this.transientProfilesObject.folders.entries())if(l.id===c.id){this.updateWorkspaceAssociation({id:"",uri:u},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,n,i)}triggerProfilesChanges(t,n,i){this._onDidChangeProfiles.fire({added:t,removed:n,updated:i,all:this.profiles})}updateWorkspaceAssociation(t,n,i){if(i=n?.isTransient?!0:i,i)Fh(t)?(this.transientProfilesObject.folders.delete(t.uri),n&&this.transientProfilesObject.folders.set(t.uri,n)):Wh(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),n&&this.transientProfilesObject.workspaces.set(t.configPath,n)):(this.transientProfilesObject.emptyWindows.delete(t.id),n&&this.transientProfilesObject.emptyWindows.set(t.id,n));else{this.updateWorkspaceAssociation(t,void 0,!0);let o=this.getWorkspace(t);ae.isUri(o)?(this.profilesObject.workspaces.delete(o),n&&this.profilesObject.workspaces.set(o,n)):(this.profilesObject.emptyWindows.delete(o),n&&this.profilesObject.emptyWindows.set(o,n)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[i,o]of this.profilesObject.workspaces.entries())t[i.toString()]=o.id;let n={};for(let[i,o]of this.profilesObject.emptyWindows.entries())n[i.toString()]=o.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:n}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let n={},i=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=ae.parse(a);n[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let o={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=ae.parse(a);o[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:n,emptyWindows:o}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};gm=ne([M(0,$s),M(1,An),M(2,Rl),M(3,ti)],gm);function b1(r){return!!r.workspaceUri}function v1(r){return!!r.fileUri}var DI=class r{constructor(e,t,n,i,o,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,n=n|0,i=i|0,o=o|0,s=s|0,a=a|0),this.rawScrollLeft=i,this.rawScrollTop=a,t<0&&(t=0),i+t>n&&(i=n-t),i<0&&(i=0),o<0&&(o=0),a+o>s&&(a=s-o),a<0&&(a=0),this.width=t,this.scrollWidth=n,this.scrollLeft=i,this.height=o,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new r(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new r(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,o=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:o,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},cc=class extends B{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new L);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new DI(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let n=this._state.withScrollDimensions(e,t);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;t?i=new bm(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(e);this._smoothScrolling=bm.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}},fm=class{scrollLeft;scrollTop;isDone;constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}};function RI(r,e){let t=e-r;return function(n){return r+t*PP(n)}}function RP(r,e,t){return function(n){return n<t?r(n/t):e((n-t)/(1-t))}}var bm=class r{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let o,s;return e<t?(o=e+.75*n,s=t-.75*n):(o=e-.75*n,s=t+.75*n),RP(RI(e,o),RI(s,t),.33)}return RI(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let n=this.scrollLeft(t),i=this.scrollTop(t);return new fm(n,i,!1)}return new fm(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return r.start(e,t,n)}static start(e,t,n){n=n+10;let i=Date.now()-10;return new r(e,t,i,n)}};function DP(r){return Math.pow(r,3)}function PP(r){return 1-DP(1-r)}var Nr=new class{_zoomLevel=0;_onDidChangeZoomLevel=new L;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(r){r=Math.min(Math.max(-5,r),20),this._zoomLevel!==r&&(this._zoomLevel=r,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var MP=Me?1.5:1.35,PI=8,pc=class r{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,n){let i=e.get(50),o=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),u=e.get(65);return r._create(i,o,s,a,l,d,u,t,n)}static createFromRawSettings(e,t,n=!1){let i=Ar.fontFamily.validate(e.fontFamily),o=Ar.fontWeight.validate(e.fontWeight),s=Ar.fontSize.validate(e.fontSize),a=Ar.fontLigatures2.validate(e.fontLigatures),l=Ar.fontVariations.validate(e.fontVariations),d=Ar.lineHeight.validate(e.lineHeight),u=Ar.letterSpacing.validate(e.letterSpacing);return r._create(i,o,s,a,l,d,u,t,n)}static _create(e,t,n,i,o,s,a,l,d){s===0?s=MP*n:s<PI&&(s=s*n),s=Math.round(s),s<PI&&(s=PI);let u=1+(d?0:Nr.getZoomLevel()*.1);return n*=u,s*=u,o===Pl.TRANSLATE&&(t==="normal"||t==="bold"?o=Pl.OFF:(o=`'wght' ${parseInt(t,10)}`,t="normal")),new r({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:n,fontFeatureSettings:i,fontVariationSettings:o,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=Fn.fontFamily,t=r._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},MI=2,Dl=class extends pc{_editorStylingBrand=void 0;version=MI;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};var Fr={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var OI="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function OP(r=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of OI)r.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var NI=OP();function hc(r){let e=NI;if(r&&r instanceof RegExp)if(r.global)e=r;else{let t="g";r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.unicode&&(t+="u"),e=new RegExp(r.source,t)}return e.lastIndex=0,e}var y1=new mn;y1.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function vm(r,e,t,n,i){if(e=hc(e),i||(i=bi.first(y1)),t.length>i.maxLen){let d=r-i.maxLen/2;return d<0?d=0:n+=d,t=t.substring(d,r+i.maxLen/2),vm(r,e,t,n,i)}let o=Date.now(),s=r-1-n,a=-1,l=null;for(let d=1;!(Date.now()-o>=i.timeBudget);d++){let u=s-i.windowSize*d;e.lastIndex=Math.max(0,u);let c=NP(e,t,s,a);if(!c&&l||(l=c,u<=0))break;a=u}if(l){let d={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function NP(r,e,t,n){let i;for(;i=r.exec(e);){let o=i.index||0;if(o<=t&&r.lastIndex>=t)return i;if(n>0&&o>n)return null}return null}var ri=G("accessibilityService");var XG=new fe("accessibilityModeEnabled",!1);var gc={Configuration:"base.contributions.configuration"};var ym={properties:{},patternProperties:{}},Im={properties:{},patternProperties:{}},Cm={properties:{},patternProperties:{}},Sm={properties:{},patternProperties:{}},_m={properties:{},patternProperties:{}},mc={properties:{},patternProperties:{}},ra="vscode://schemas/settings/resourceLanguage";var xm=Xe.as(ea.JSONContribution),AI=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new L;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new L;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:m("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},xm.registerSchema(ra,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),xm.registerSchema(ra,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),xm.registerSchema(ra,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),xm.registerSchema(ra,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:i,source:o}of e)for(let s in i){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:o}),Ml.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,o),n.push(...AP(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let u=this.configurationProperties[s];u&&(this.updatePropertyDefaultValue(s,u),this.updateSchema(s,u))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let n of e){let i=this.registeredConfigurationDefaults.indexOf(n);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:n,source:i}of e)for(let o in n){let s=this.configurationDefaultsOverrides.get(o);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===n[o]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(o),Ml.test(o)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(o,d.value,d.source,l);l&&!Tw(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(o,l,i)):(this.configurationDefaultsOverrides.delete(o),delete this.configurationProperties[o],delete this.defaultLanguageConfigurationOverridesNode.properties[o])}else{let l;for(let u of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(o,u.value,u.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[o];d&&(this.updatePropertyDefaultValue(o,d),this.updateSchema(o,d))}t.add(o)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let i={type:"object",default:t.value,description:m("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",sT(e)),$ref:ra,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,i){let o=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(Ot(l)&&(On(o[a])||Ot(o[a]))){if(o[a]={...o[a]??{},...l},n)for(let u in l)s.set(`${a}.${u}`,n)}else o[a]=l,n?s.set(a,n):s.delete(a)}return{value:o,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,i){let o=this.configurationProperties[e],s=i?.value??o?.defaultDefaultValue,a=n;if(Ot(t)&&(o!==void 0&&o.type==="object"||o===void 0&&(On(s)||Ot(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)n&&a.set(`${e}.${d}`,n);t={...Ot(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(i=>{this.validateAndRegisterProperties(i,t,i.extensionInfo,i.restrictedProperties,void 0,n),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(e,t){let n=i=>{if(i.properties)for(let o in i.properties){t.add(o);let s=this.configurationProperties[o];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[o],this.removeFromSchema(o,i.properties[o])}i.allOf?.forEach(o=>n(o))};for(let i of e){n(i);let o=this.configurationContributors.indexOf(i);o!==-1&&this.configurationContributors.splice(o,1)}}validateAndRegisterProperties(e,t=!0,n,i,o=3,s){o=Di(e.scope)?o:e.scope;let a=e.properties;if(a)for(let d in a){let u=a[d];if(t&&WP(d,u)){delete a[d];continue}if(u.source=n,u.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,u),Ml.test(d)?u.scope=void 0:(u.scope=Di(u.scope)?o:u.scope,u.restricted=Di(u.restricted)?!!i?.includes(d):u.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,n,i,o,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=n=>{let i=n.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);n.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(ym.properties[e]=t,t.scope){case 1:Im.properties[e]=t;break;case 2:Cm.properties[e]=t;break;case 6:Sm.properties[e]=t;break;case 3:_m.properties[e]=t;break;case 4:mc.properties[e]=t;break;case 5:mc.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete ym.properties[e],t.scope){case 1:delete Im.properties[e];break;case 2:delete Cm.properties[e];break;case 6:delete Sm.properties[e];break;case 3:delete _m.properties[e];break;case 4:case 5:delete mc.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:"object",description:m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:ra};this.updatePropertyDefaultValue(t,n),ym.properties[t]=n,Im.properties[t]=n,Cm.properties[t]=n,Sm.properties[t]=n,_m.properties[t]=n,mc.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:"object",description:m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:ra};ym.patternProperties[oa]=e,Im.patternProperties[oa]=e,Cm.patternProperties[oa]=e,Sm.patternProperties[oa]=e,_m.patternProperties[oa]=e,mc.patternProperties[oa]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,i,o;n&&(!t.disallowConfigurationDefault||!n.source)&&(i=n.value,o=n.source),On(i)&&(i=t.defaultDefaultValue,o=void 0),On(i)&&(i=FP(t.type)),t.default=i,t.defaultValueSource=o}},C1="\\[([^\\]]+)\\]",I1=new RegExp(C1,"g"),oa=`^(${C1})+$`,Ml=new RegExp(oa);function AP(r){let e=[];if(Ml.test(r)){let t=I1.exec(r);for(;t?.length;){let n=t[1].trim();n&&e.push(n),t=I1.exec(r)}}return Fo(e)}function FP(r){switch(Array.isArray(r)?r[0]:r){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var Em=new AI;Xe.add(gc.Configuration,Em);function WP(r,e){return r.trim()?Ml.test(r)?m("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",r):Em.getConfigurationProperties()[r]!==void 0?m("config.property.duplicate","Cannot register '{0}'. This property is already registered.",r):e.policy?.name&&Em.getPolicyConfigurations().get(e.policy?.name)!==void 0?m("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",r,e.policy?.name,Em.getPolicyConfigurations().get(e.policy?.name)):null:m("config.property.empty","Cannot register an empty property")}var rr=8,wm=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},fc=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Ge=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return Lm(e,t)}compute(e,t,n){return n}},Nl=class{constructor(e,t){this.newValue=e;this.didChange=t}};function Lm(r,e){if(typeof r!="object"||typeof e!="object"||!r||!e)return new Nl(e,r!==e);if(Array.isArray(r)||Array.isArray(e)){let n=Array.isArray(r)&&Array.isArray(e)&&Pn(r,e);return new Nl(e,!n)}let t=!1;for(let n in e)if(e.hasOwnProperty(n)){let i=Lm(r[n],e[n]);i.didChange&&(r[n]=i.newValue,t=!0)}return new Nl(r,t)}var aa=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return Lm(e,t)}validate(e){return this.defaultValue}},is=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return Lm(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}};function ie(r,e){return typeof r>"u"?e:r==="false"?!1:!!r}var Ee=class extends is{constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return ie(e,this.defaultValue)}};function BP(r,e,t,n){if(typeof r>"u")return e;let i=parseInt(r,10);return isNaN(i)?e:(i=Math.max(t,i),i=Math.min(n,i),i|0)}var ze=class r extends is{static clampedInt(e,t,n,i){return BP(e,t,n,i)}minimum;maximum;constructor(e,t,n,i,o,s=void 0){typeof s<"u"&&(s.type="integer",s.default=n,s.minimum=i,s.maximum=o),super(e,t,n,s),this.minimum=i,this.maximum=o}validate(e){return r.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};var Oi=class r extends is{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let n=parseFloat(e);return isNaN(n)?t:n}validationFn;constructor(e,t,n,i,o){typeof o<"u"&&(o.type="number",o.default=n),super(e,t,n,o),this.validationFn=i}validate(e){return this.validationFn(r.float(e,this.defaultValue))}},un=class r extends is{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return r.string(e,this.defaultValue)}};function ut(r,e,t,n){return typeof r!="string"?e:n&&r in n?n[r]:t.indexOf(r)===-1?e:r}var Je=class extends is{_allowedValues;constructor(e,t,n,i,o=void 0){typeof o<"u"&&(o.type="string",o.enum=i,o.default=n),super(e,t,n,o),this._allowedValues=i}validate(e){return ut(e,this.defaultValue,this._allowedValues)}},Ol=class extends Ge{_allowedValues;_convert;constructor(e,t,n,i,o,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=o,a.default=i),super(e,t,n,a),this._allowedValues=o,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function VP(r){switch(r){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var FI=class extends Ge{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[m("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),m("accessibilitySupport.on","Optimize for usage with a Screen Reader."),m("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:m("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return n===0?e.accessibilitySupport:n}},WI=class extends Ge{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:m("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:m("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:ie(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ie(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function UP(r){switch(r){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function HP(r){switch(r){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var BI=class extends aa{constructor(){super(144)}compute(e,t,n){let i=["monaco-editor"];return t.get(40)&&i.push(t.get(40)),e.extraEditorClassName&&i.push(e.extraEditorClassName),t.get(75)==="default"?i.push("mouse-default"):t.get(75)==="copy"&&i.push("mouse-copy"),t.get(113)&&i.push("showUnused"),t.get(142)&&i.push("showDeprecated"),i.join(" ")}},VI=class extends Ee{constructor(){super(38,"emptySelectionClipboard",!0,{description:m("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}},UI=class extends Ge{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:m("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[m("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),m("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),m("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:m("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[m("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),m("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),m("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:m("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:m("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Me},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:m("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:m("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:ie(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":ut(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":ut(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ie(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ie(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ie(t.loop,this.defaultValue.loop)}}},la=class r extends Ge{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",r.OFF,{anyOf:[{type:"boolean",description:m("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:m("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:m("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?r.OFF:e==="true"?r.ON:e:e?r.ON:r.OFF}},Pl=class r extends Ge{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",r.OFF,{anyOf:[{type:"boolean",description:m("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:m("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:m("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?r.OFF:e==="true"?r.TRANSLATE:e:e?r.TRANSLATE:r.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},HI=class extends aa{constructor(){super(51)}compute(e,t,n){return e.fontInfo}},zI=class extends is{constructor(){super(53,"fontSize",Fn.fontSize,{type:"number",minimum:6,maximum:100,default:Fn.fontSize,description:m("fontSize","Controls the font size in pixels.")})}validate(e){let t=Oi.float(e,this.defaultValue);return t===0?Fn.fontSize:Oi.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},KI=class r extends Ge{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",Fn.fontWeight,{anyOf:[{type:"number",minimum:r.MINIMUM_VALUE,maximum:r.MAXIMUM_VALUE,errorMessage:m("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:r.SUGGESTION_VALUES}],default:Fn.fontWeight,description:m("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(ze.clampedInt(e,Fn.fontWeight,r.MINIMUM_VALUE,r.MAXIMUM_VALUE))}},GI=class extends Ge{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[m("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),m("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),m("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:m("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:m("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:m("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:m("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:m("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:m("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:m("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:m("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:m("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:m("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:m("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:ut(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??ut(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??ut(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??ut(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??ut(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??ut(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??ut(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:un.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:un.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:un.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:un.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:un.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:un.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},jI=class extends Ge{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:m("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:m("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:m("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:m("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:m("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),delay:ze.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:ie(t.sticky,this.defaultValue.sticky),hidingDelay:ze.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ie(t.above,this.defaultValue.above)}}};var bc=class r extends aa{constructor(){super(147)}compute(e,t,n){return r.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),i=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(i=Math.max(i,t-1));let o=(n+e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/o);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:i,desiredRatio:o,minimapLineCount:s}}static _computeMinimapLayout(e,t){let n=e.outerWidth,i=e.outerHeight,o=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,c=e.minimap.renderCharacters,p=o>=2?Math.round(e.minimap.scale*2):e.minimap.scale,h=e.minimap.maxColumn,g=e.minimap.size,f=e.minimap.side,v=e.verticalScrollbarWidth,y=e.viewLineCount,I=e.remainingWidth,S=e.isViewportWrapping,x=c?2:3,T=Math.floor(o*i),R=T/o,P=!1,O=!1,k=x*p,F=p/o,W=1;if(g==="fill"||g==="fit"){let{typicalViewportLineCount:j,extraLinesBeforeFirstLine:U,extraLinesBeyondLastLine:te,desiredRatio:re,minimapLineCount:Ue}=r.computeContainedMinimapLineCount({viewLineCount:y,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:i,lineHeight:l,pixelRatio:o});if(y/Ue>1)P=!0,O=!0,p=1,k=1,F=p/o;else{let de=!1,pn=p+1;if(g==="fit"){let rn=Math.ceil((U+y+te)*k);S&&a&&I<=t.stableFitRemainingWidth?(de=!0,pn=t.stableFitMaxMinimapScale):de=rn>T}if(g==="fill"||de){P=!0;let rn=p;k=Math.min(l*o,Math.max(1,Math.floor(1/re))),S&&a&&I<=t.stableFitRemainingWidth&&(pn=t.stableFitMaxMinimapScale),p=Math.min(pn,Math.max(1,Math.floor(k/x))),p>rn&&(W=Math.min(2,p/rn)),F=p/o/W,T=Math.ceil(Math.max(j,U+y+te)*k),S?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=I,t.stableFitMaxMinimapScale=p):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let H=Math.floor(h*F),$=Math.min(H,Math.max(0,Math.floor((I-v-2)*F/(d+F)))+rr),ee=Math.floor(o*$),K=ee/o;ee=Math.floor(ee*W);let V=c?1:2,Y=f==="left"?0:n-$-v;return{renderMinimap:V,minimapLeft:Y,minimapWidth:$,minimapHeightIsEditorHeight:P,minimapIsSampling:O,minimapScale:p,minimapLineHeight:k,minimapCanvasInnerWidth:ee,minimapCanvasInnerHeight:T,minimapCanvasOuterWidth:K,minimapCanvasOuterHeight:R}}static computeLayout(e,t){let n=t.outerWidth|0,i=t.outerHeight|0,o=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,u=t.viewLineCount,c=e.get(139),p=c==="inherit"?e.get(138):c,h=p==="inherit"?e.get(134):p,g=e.get(137),f=t.isDominatedByLongLines,v=e.get(58),y=e.get(69).renderType!==0,I=e.get(70),S=e.get(107),x=e.get(85),T=e.get(74),R=e.get(105),P=R.verticalScrollbarSize,O=R.verticalHasArrows,k=R.arrowSize,F=R.horizontalScrollbarSize,W=e.get(44),H=e.get(112)!=="never",$=e.get(67);W&&H&&($+=16);let ee=0;if(y){let Gi=Math.max(s,I);ee=Math.round(Gi*l)}let K=0;v&&(K=o*t.glyphMarginDecorationLaneCount);let V=0,Y=V+K,j=Y+ee,U=j+$,te=n-K-ee-$,re=!1,Ue=!1,Te=-1;p==="inherit"&&f?(re=!0,Ue=!0):h==="on"||h==="bounded"?Ue=!0:h==="wordWrapColumn"&&(Te=g);let de=r._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:o,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:S,paddingTop:x.top,paddingBottom:x.bottom,minimap:T,verticalScrollbarWidth:P,viewLineCount:u,remainingWidth:te,isViewportWrapping:Ue},t.memory||new fc);de.renderMinimap!==0&&de.minimapLeft===0&&(V+=de.minimapWidth,Y+=de.minimapWidth,j+=de.minimapWidth,U+=de.minimapWidth);let pn=te-de.minimapWidth,rn=Math.max(1,Math.floor((pn-P-2)/a)),gi=O?k:0;return Ue&&(Te=Math.max(1,rn),h==="bounded"&&(Te=Math.min(Te,g))),{width:n,height:i,glyphMarginLeft:V,glyphMarginWidth:K,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:Y,lineNumbersWidth:ee,decorationsLeft:j,decorationsWidth:$,contentLeft:U,contentWidth:pn,minimap:de,viewportColumn:rn,isWordWrapMinified:re,isViewportWrapping:Ue,wrappingColumn:Te,verticalScrollbarWidth:P,horizontalScrollbarHeight:F,overviewRuler:{top:gi,width:P,height:i-2*gi,right:0}}}},qI=class extends Ge{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[m("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),m("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:m("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return ut(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(2)===2?"advanced":n}};var $I=class extends Ge{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[m("editor.lightbulb.enabled.off","Disable the code action menu."),m("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),m("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:m("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:ut(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},YI=class extends Ge{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:m("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:m("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:m("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:m("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),maxLineCount:ze.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:ut(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ie(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},QI=class extends Ge{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:m("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[m("editor.inlayHints.on","Inlay hints are enabled"),m("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Me?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Me?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:m("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:m("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:m("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:m("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:ut(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:ze.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:un.string(t.fontFamily,this.defaultValue.fontFamily),padding:ie(t.padding,this.defaultValue.padding),maximumLength:ze.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},ZI=class extends Ge{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):ze.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?ze.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},XI=class extends Oi{constructor(){super(68,"lineHeight",Fn.lineHeight,e=>Oi.clamp(e,0,150),{markdownDescription:m("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}},JI=class extends Ge{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:m("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:m("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[m("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),m("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),m("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:m("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:m("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:m("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:m("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:m("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:m("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:m("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:m("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:m("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:m("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),autohide:ie(t.autohide,this.defaultValue.autohide),size:ut(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:ut(t.side,this.defaultValue.side,["right","left"]),showSlider:ut(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ie(t.renderCharacters,this.defaultValue.renderCharacters),scale:ze.clampedInt(t.scale,1,1,3),maxColumn:ze.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ie(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ie(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:Oi.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:Oi.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function zP(r){return r==="ctrlCmd"?Me?"metaKey":"ctrlKey":"altKey"}var eC=class extends Ge{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:ze.clampedInt(t.top,0,0,1e3),bottom:ze.clampedInt(t.bottom,0,0,1e3)}}},tC=class extends Ge{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:m("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:m("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),cycle:ie(t.cycle,this.defaultValue.cycle)}}},nC=class extends aa{constructor(){super(145)}compute(e,t,n){return e.pixelRatio}},iC=class extends Ge{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},rC=class extends Ge{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[m("on","Quick suggestions show inside the suggest widget"),m("inline","Quick suggestions show as ghost text"),m("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:m("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:m("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:m("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:m("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:n,strings:i}=e,o=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=ut(t,this.defaultValue.other,o),typeof n=="boolean"?a=n?"on":"off":a=ut(n,this.defaultValue.comments,o),typeof i=="boolean"?l=i?"on":"off":l=ut(i,this.defaultValue.strings,o),{other:s,comments:a,strings:l}}};var oC=class extends Ge{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[m("lineNumbers.off","Line numbers are not rendered."),m("lineNumbers.on","Line numbers are rendered as absolute number."),m("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),m("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:m("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,n=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:n}}};function da(r){let e=r.get(100);return e==="editable"?r.get(93):e!=="on"}var sC=class extends Ge{constructor(){let e=[],t={type:"number",description:m("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:m("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:m("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="number")t.push({column:ze.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){let i=n;t.push({column:ze.clampedInt(i.column,0,0,1e4),color:i.color})}return t.sort((n,i)=>n.column-i.column),t}return this.defaultValue}},aC=class extends Ge{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function S1(r,e){if(typeof r!="string")return e;switch(r){case"hidden":return 2;case"visible":return 3;default:return 1}}var lC=class extends Ge{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),m("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),m("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),m("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),m("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:m("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:m("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:m("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:m("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,n=ze.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=ze.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:ze.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:S1(t.vertical,this.defaultValue.vertical),horizontal:S1(t.horizontal,this.defaultValue.horizontal),useShadows:ie(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:ie(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ie(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ie(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ie(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:ze.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:ze.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:ie(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ie(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},ir="inUntrustedWorkspace",sa={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},dC=class extends Ge{constructor(){let e={nonBasicASCII:ir,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:ir,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[sa.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ir],default:e.nonBasicASCII,description:m("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[sa.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:m("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[sa.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:m("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[sa.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ir],default:e.includeComments,description:m("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[sa.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,ir],default:e.includeStrings,description:m("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[sa.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:m("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[sa.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:m("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(Ci(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(Ci(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let i=super.applyUpdate(e,t);return n?new Nl(i.newValue,!0):i}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:Al(t.nonBasicASCII,ir,[!0,!1,ir]),invisibleCharacters:ie(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ie(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:Al(t.includeComments,ir,[!0,!1,ir]),includeStrings:Al(t.includeStrings,ir,[!0,!1,ir]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let n={};for(let[i,o]of Object.entries(e))o===!0&&(n[i]=!0);return n}},uC=class extends Ge{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:m("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),m("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),m("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:m("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:m("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:m("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:m("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),mode:ut(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:ut(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ie(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ie(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:un.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:ie(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},cC=class extends Ge{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:m("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),m("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),m("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:m("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:m("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),showToolbar:ut(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:un.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:ie(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},pC=class extends Ge{constructor(){let e={enabled:Fr.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Fr.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:m("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ie(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},hC=class extends Ge{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairs.true","Enables bracket pair guides."),m("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),m("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:m("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),m("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),m("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:m("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:m("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:m("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[m("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),m("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),m("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:m("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:Al(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:Al(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:ie(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ie(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:Al(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function Al(r,e,t){let n=t.indexOf(r);return n===-1?e:t[n]}var mC=class extends Ge{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[m("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),m("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:m("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:m("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:m("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:m("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[m("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),m("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:m("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:m("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:m("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:m("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:m("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:m("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:m("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:m("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:ut(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ie(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ie(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ie(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ie(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:ut(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ie(t.showIcons,this.defaultValue.showIcons),showStatusBar:ie(t.showStatusBar,this.defaultValue.showStatusBar),preview:ie(t.preview,this.defaultValue.preview),previewMode:ut(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ie(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ie(t.showMethods,this.defaultValue.showMethods),showFunctions:ie(t.showFunctions,this.defaultValue.showFunctions),showConstructors:ie(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:ie(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ie(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ie(t.showFields,this.defaultValue.showFields),showVariables:ie(t.showVariables,this.defaultValue.showVariables),showClasses:ie(t.showClasses,this.defaultValue.showClasses),showStructs:ie(t.showStructs,this.defaultValue.showStructs),showInterfaces:ie(t.showInterfaces,this.defaultValue.showInterfaces),showModules:ie(t.showModules,this.defaultValue.showModules),showProperties:ie(t.showProperties,this.defaultValue.showProperties),showEvents:ie(t.showEvents,this.defaultValue.showEvents),showOperators:ie(t.showOperators,this.defaultValue.showOperators),showUnits:ie(t.showUnits,this.defaultValue.showUnits),showValues:ie(t.showValues,this.defaultValue.showValues),showConstants:ie(t.showConstants,this.defaultValue.showConstants),showEnums:ie(t.showEnums,this.defaultValue.showEnums),showEnumMembers:ie(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ie(t.showKeywords,this.defaultValue.showKeywords),showWords:ie(t.showWords,this.defaultValue.showWords),showColors:ie(t.showColors,this.defaultValue.showColors),showFiles:ie(t.showFiles,this.defaultValue.showFiles),showReferences:ie(t.showReferences,this.defaultValue.showReferences),showFolders:ie(t.showFolders,this.defaultValue.showFolders),showTypeParameters:ie(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ie(t.showSnippets,this.defaultValue.showSnippets),showUsers:ie(t.showUsers,this.defaultValue.showUsers),showIssues:ie(t.showIssues,this.defaultValue.showIssues)}}},gC=class extends Ge{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:m("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:m("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:ie(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ie(e.selectSubwords,this.defaultValue.selectSubwords)}}},fC=class extends Ge{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:m("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:m("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}};var bC=class extends Ge{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[m("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),m("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),m("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),m("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:m("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,n){return t.get(2)===2?0:n}},vC=class extends aa{constructor(){super(148)}compute(e,t,n){let i=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}},yC=class extends Ge{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:m("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[m("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),m("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),showDropSelector:ut(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},IC=class extends Ge{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:m("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[m("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),m("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),showPasteSelector:ut(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},KP="Consolas, 'Courier New', monospace",GP="Menlo, Monaco, 'Courier New', monospace",jP="'Droid Sans Mono', 'monospace', monospace",Fn={fontFamily:Me?GP:pt?jP:KP,fontWeight:"normal",fontSize:Me?12:14,lineHeight:0,letterSpacing:0},Fl=[];function N(r){return Fl[r.id]=r,r}var Ar={acceptSuggestionOnCommitCharacter:N(new Ee(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:m("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:N(new Je(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",m("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:m("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:N(new FI),accessibilityPageSize:N(new ze(3,"accessibilityPageSize",10,1,1073741824,{description:m("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:N(new un(4,"ariaLabel",m("editorViewAccessibleLabel","Editor content"))),ariaRequired:N(new Ee(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:N(new Ee(8,"screenReaderAnnounceInlineSuggestion",!0,{description:m("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:N(new Je(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),m("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:m("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:N(new Je(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),m("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:m("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:N(new Je(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:N(new Je(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:N(new Je(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),m("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:m("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:N(new Ol(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],VP,{enumDescriptions:[m("editor.autoIndent.none","The editor will not insert indentation automatically."),m("editor.autoIndent.keep","The editor will keep the current line's indentation."),m("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),m("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),m("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:m("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:N(new Ee(13,"automaticLayout",!1)),autoSurround:N(new Je(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[m("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),m("editor.autoSurround.quotes","Surround with quotes but not brackets."),m("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:m("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:N(new pC),bracketPairGuides:N(new hC),stickyTabStops:N(new Ee(118,"stickyTabStops",!1,{description:m("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:N(new Ee(17,"codeLens",!0,{description:m("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:N(new un(18,"codeLensFontFamily","",{description:m("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:N(new ze(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:m("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:N(new Ee(20,"colorDecorators",!0,{description:m("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:N(new Je(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[m("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),m("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),m("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:m("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:N(new ze(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:m("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:N(new Ee(22,"columnSelection",!1,{description:m("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:N(new WI),contextmenu:N(new Ee(24,"contextmenu",!0)),copyWithSyntaxHighlighting:N(new Ee(25,"copyWithSyntaxHighlighting",!0,{description:m("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:N(new Ol(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],UP,{description:m("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:N(new Je(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[m("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),m("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),m("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:m("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:N(new Ol(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],HP,{description:m("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:N(new ze(29,"cursorSurroundingLines",0,0,1073741824,{description:m("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:N(new Je(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[m("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),m("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:m("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:N(new ze(31,"cursorWidth",0,0,1073741824,{markdownDescription:m("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:N(new Ee(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:N(new Ee(33,"disableMonospaceOptimizations",!1)),domReadOnly:N(new Ee(34,"domReadOnly",!1)),dragAndDrop:N(new Ee(35,"dragAndDrop",!0,{description:m("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:N(new VI),dropIntoEditor:N(new yC),experimentalEditContextEnabled:N(new Ee(37,"experimentalEditContextEnabled",!1,{description:m("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:N(new YI),experimentalWhitespaceRendering:N(new Je(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[m("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),m("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),m("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:m("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:N(new un(40,"extraEditorClassName","")),fastScrollSensitivity:N(new Oi(41,"fastScrollSensitivity",5,r=>r<=0?5:r,{markdownDescription:m("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:N(new UI),fixedOverflowWidgets:N(new Ee(43,"fixedOverflowWidgets",!1)),folding:N(new Ee(44,"folding",!0,{description:m("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:N(new Je(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[m("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),m("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:m("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:N(new Ee(46,"foldingHighlight",!0,{description:m("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:N(new Ee(47,"foldingImportsByDefault",!1,{description:m("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:N(new ze(48,"foldingMaximumRegions",5e3,10,65e3,{description:m("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:N(new Ee(49,"unfoldOnClickAfterEndOfLine",!1,{description:m("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:N(new un(50,"fontFamily",Fn.fontFamily,{description:m("fontFamily","Controls the font family.")})),fontInfo:N(new HI),fontLigatures2:N(new la),fontSize:N(new zI),fontWeight:N(new KI),fontVariations:N(new Pl),formatOnPaste:N(new Ee(56,"formatOnPaste",!1,{description:m("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:N(new Ee(57,"formatOnType",!1,{description:m("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:N(new Ee(58,"glyphMargin",!0,{description:m("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:N(new GI),hideCursorInOverviewRuler:N(new Ee(60,"hideCursorInOverviewRuler",!1,{description:m("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:N(new jI),inDiffEditor:N(new Ee(62,"inDiffEditor",!1)),letterSpacing:N(new Oi(65,"letterSpacing",Fn.letterSpacing,r=>Oi.clamp(r,-5,20),{description:m("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:N(new $I),lineDecorationsWidth:N(new ZI),lineHeight:N(new XI),lineNumbers:N(new oC),lineNumbersMinChars:N(new ze(70,"lineNumbersMinChars",5,1,300)),linkedEditing:N(new Ee(71,"linkedEditing",!1,{description:m("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:N(new Ee(72,"links",!0,{description:m("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:N(new Je(73,"matchBrackets","always",["always","near","never"],{description:m("matchBrackets","Highlight matching brackets.")})),minimap:N(new JI),mouseStyle:N(new Je(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:N(new Oi(76,"mouseWheelScrollSensitivity",1,r=>r===0?1:r,{markdownDescription:m("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:N(new Ee(77,"mouseWheelZoom",!1,{markdownDescription:Me?m("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):m("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:N(new Ee(78,"multiCursorMergeOverlapping",!0,{description:m("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:N(new Ol(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],zP,{markdownEnumDescriptions:[m("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:m({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:N(new Je(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[m("multiCursorPaste.spread","Each cursor pastes a single line of the text."),m("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:m("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:N(new ze(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:m("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:N(new Je(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[m("occurrencesHighlight.off","Does not highlight occurrences."),m("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),m("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:m("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:N(new Ee(83,"overviewRulerBorder",!0,{description:m("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:N(new ze(84,"overviewRulerLanes",3,0,3)),padding:N(new eC),pasteAs:N(new IC),parameterHints:N(new tC),peekWidgetDefaultFocus:N(new Je(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[m("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),m("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:m("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:N(new iC),definitionLinkOpensInPeek:N(new Ee(90,"definitionLinkOpensInPeek",!1,{description:m("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:N(new rC),quickSuggestionsDelay:N(new ze(92,"quickSuggestionsDelay",10,0,1073741824,{description:m("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:N(new Ee(93,"readOnly",!1)),readOnlyMessage:N(new aC),renameOnType:N(new Ee(95,"renameOnType",!1,{description:m("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:m("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:N(new Ee(96,"renderControlCharacters",!0,{description:m("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:N(new Je(97,"renderFinalNewline",pt?"dimmed":"on",["off","on","dimmed"],{description:m("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:N(new Je(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",m("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:m("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:N(new Ee(99,"renderLineHighlightOnlyWhenFocus",!1,{description:m("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:N(new Je(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:N(new Je(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",m("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),m("renderWhitespace.selection","Render whitespace characters only on selected text."),m("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:m("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:N(new ze(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:N(new Ee(103,"roundedSelection",!0,{description:m("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:N(new sC),scrollbar:N(new lC),scrollBeyondLastColumn:N(new ze(106,"scrollBeyondLastColumn",4,0,1073741824,{description:m("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:N(new Ee(107,"scrollBeyondLastLine",!0,{description:m("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:N(new Ee(108,"scrollPredominantAxis",!0,{description:m("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:N(new Ee(109,"selectionClipboard",!0,{description:m("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:pt})),selectionHighlight:N(new Ee(110,"selectionHighlight",!0,{description:m("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:N(new Ee(111,"selectOnLineNumbers",!0)),showFoldingControls:N(new Je(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[m("showFoldingControls.always","Always show the folding controls."),m("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),m("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:m("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:N(new Ee(113,"showUnused",!0,{description:m("showUnused","Controls fading out of unused code.")})),showDeprecated:N(new Ee(142,"showDeprecated",!0,{description:m("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:N(new QI),snippetSuggestions:N(new Je(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[m("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),m("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),m("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),m("snippetSuggestions.none","Do not show snippet suggestions.")],description:m("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:N(new gC),smoothScrolling:N(new Ee(116,"smoothScrolling",!1,{description:m("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:N(new ze(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:N(new mC),inlineSuggest:N(new uC),inlineEdit:N(new cC),inlineCompletionsAccessibilityVerbose:N(new Ee(151,"inlineCompletionsAccessibilityVerbose",!1,{description:m("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:N(new ze(121,"suggestFontSize",0,0,1e3,{markdownDescription:m("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:N(new ze(122,"suggestLineHeight",0,0,1e3,{markdownDescription:m("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:N(new Ee(123,"suggestOnTriggerCharacters",!0,{description:m("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:N(new Je(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[m("suggestSelection.first","Always select the first suggestion."),m("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),m("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:m("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:N(new Je(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[m("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),m("tabCompletion.off","Disable tab completions."),m("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:m("tabCompletion","Enables tab completions.")})),tabIndex:N(new ze(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:N(new dC),unusualLineTerminators:N(new Je(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[m("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),m("unusualLineTerminators.off","Unusual line terminators are ignored."),m("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:m("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:N(new Ee(129,"useShadowDOM",!0)),useTabStops:N(new Ee(130,"useTabStops",!0,{description:m("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:N(new Je(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[m("wordBreak.normal","Use the default line break rule."),m("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:m("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:N(new fC),wordSeparators:N(new un(133,"wordSeparators",OI,{description:m("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:N(new Je(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[m("wordWrap.off","Lines will never wrap."),m("wordWrap.on","Lines will wrap at the viewport width."),m({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),m({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:m({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:N(new un(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:N(new un(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:N(new ze(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:m({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:N(new Je(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:N(new Je(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:N(new BI),defaultColorDecorators:N(new Ee(149,"defaultColorDecorators",!1,{markdownDescription:m("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:N(new nC),tabFocusMode:N(new Ee(146,"tabFocusMode",!1,{markdownDescription:m("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:N(new bc),wrappingInfo:N(new vC),wrappingIndent:N(new bC),wrappingStrategy:N(new qI)};var w=class r{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new r(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return r.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return r.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return r.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,i=t.lineNumber|0;if(n===i){let o=e.column|0,s=t.column|0;return o-s}return n-i}clone(){return new r(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new r(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var _=class r{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return r.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return r.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return r.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return r.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return r.plusRange(this,e)}static plusRange(e,t){let n,i,o,s;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(o=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(o=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(o=e.endLineNumber,s=e.endColumn),new r(n,i,o,s)}intersectRanges(e){return r.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,o=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,u=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),o>d?(o=d,s=u):o===d&&(s=Math.min(s,u)),n>o||n===o&&i>s?null:new r(n,i,o,s)}equalsRange(e){return r.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return r.getEndPosition(this)}static getEndPosition(e){return new w(e.endLineNumber,e.endColumn)}getStartPosition(){return r.getStartPosition(this)}static getStartPosition(e){return new w(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new r(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new r(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return r.collapseToStart(this)}static collapseToStart(e){return new r(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return r.collapseToEnd(this)}static collapseToEnd(e){return new r(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new r(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new r(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new r(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let o=e.startLineNumber|0,s=t.startLineNumber|0;if(o===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,u=t.endLineNumber|0;if(d===u){let c=e.endColumn|0,p=t.endColumn|0;return c-p}return d-u}return a-l}return o-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var ye=class r extends _{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return r.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new r(this.startLineNumber,this.startColumn,e,t):new r(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new w(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new w(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new r(e,t,this.endLineNumber,this.endColumn):new r(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new r(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new r(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new r(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new r(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,i,o){return o===0?new r(e,t,n,i):new r(n,i,e,t)}};var CC;function _1(){return CC||(CC=new TextDecoder("UTF-16LE")),CC}var SC;function qP(){return SC||(SC=new TextDecoder("UTF-16BE")),SC}var _C;function xC(){return _C||(_C=KE()?_1():qP()),_C}function x1(r,e,t){let n=new Uint16Array(r.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?$P(r,e,t):_1().decode(n)}function $P(r,e,t){let n=[],i=0;for(let o=0;o<t;o++){let s=dT(r,e);e+=2,n[i++]=String.fromCharCode(s)}return n.join("")}var ua=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return xC().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||lt(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}};function km(r){return r.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var oi=class r{constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${km(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${km(this.oldText)}")`:`(replace@${this.oldPosition} "${km(this.oldText)}" with "${km(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let i=t.length;Gt(e,i,n),n+=4;for(let o=0;o<i;o++)uT(e,t.charCodeAt(o),n),n+=2;return n}static _readString(e,t){let n=Kt(e,t);return t+=4,x1(e,t,n)}writeSize(){return 8+r._writeStringSize(this.oldText)+r._writeStringSize(this.newText)}write(e,t){return Gt(e,this.oldPosition,t),t+=4,Gt(e,this.newPosition,t),t+=4,t=r._writeString(e,this.oldText,t),t=r._writeString(e,this.newText,t),t}static read(e,t,n){let i=Kt(e,t);t+=4;let o=Kt(e,t);t+=4;let s=r._readString(e,t);t+=r._writeStringSize(s);let a=r._readString(e,t);return t+=r._writeStringSize(a),n.push(new r(i,s,o,a)),t}};function E1(r,e){return r===null||r.length===0?e:new EC(r,e).compress()}var EC=class r{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(n===null){this._acceptCurr(i),i=this._getCurr(++t);continue}if(i===null){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){let[d,u]=r._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(d),i=u;continue}if(n.newPosition<i.oldPosition){let[d,u]=r._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(d),n=u;continue}let a,l;if(i.oldEnd===n.newEnd)a=n,l=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){let[d,u]=r._splitPrev(n,i.oldLength);a=d,l=i,n=u,i=this._getCurr(++t)}else{let[d,u]=r._splitCurr(i,n.newLength);a=n,l=d,n=this._getPrev(++e),i=u}this._result[this._resultLen++]=new oi(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let o=r._merge(this._result);return r._removeNoOps(o)}_acceptCurr(e){this._result[this._resultLen++]=r._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=r._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new oi(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new oi(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new oi(e.oldPosition,e.oldText,e.newPosition,n),new oi(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new oi(e.oldPosition,n,e.newPosition,e.newText),new oi(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],n=0,i=e[0];for(let o=1;o<e.length;o++){let s=e[o];i.oldEnd===s.oldPosition?i=new oi(i.oldPosition,i.oldText+s.oldText,i.newPosition,i.newText+s.newText):(t[n++]=i,i=s)}return t[n++]=i,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let o=e[i];o.oldText!==o.newText&&(t[n++]=o)}return t}};var Wl=class r{_asciiMap;_map;_defaultValue;constructor(e){let t=Us(e);this._defaultValue=t,this._asciiMap=r._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=Us(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var wC=class extends Wl{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,i=e.length;n<i;n++)this.set(e.charCodeAt(n),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t)break;n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}},w1=new ki(10);function Wr(r,e){let t=`${r}/${e.join(",")}`,n=w1.get(t);return n||(n=new wC(r,e),w1.set(t,n)),n}var QP=Object.freeze({create:r=>Fo(r.map(e=>e.toString())).join(`\r
`),split:r=>r.split(`\r
`),parse:r=>QP.split(r).filter(e=>!e.startsWith("#"))});var T1=class r{constructor(e){this.value=e}static sep=".";static None=new r("@@none@@");static Empty=new r("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+r.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new r((this.value?[this.value,...e]:e).join(r.sep))}};var si=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let n="mtk"+this.getForeground(e),i=this.getFontStyle(e);return i&1&&(n+=" mtki"),i&2&&(n+=" mtkb"),i&4&&(n+=" mtku"),i&8&&(n+=" mtks"),n}static getInlineStyleFromMetadata(e,t){let n=this.getForeground(e),i=this.getFontStyle(e),o=`color: ${t[n]};`;i&1&&(o+="font-style: italic;"),i&2&&(o+="font-weight: bold;");let s="";return i&4&&(s+=" underline"),i&8&&(s+=" line-through"),s&&(o+=`text-decoration:${s};`),o}static getPresentationFromMetadata(e){let t=this.getForeground(e),n=this.getFontStyle(e);return{foreground:t,italic:!!(n&1),bold:!!(n&2),underline:!!(n&4),strikethrough:!!(n&8)}}};var yc=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new L;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),ve(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new TC(this,e,t);return this._factories.set(e,n),ve(()=>{let i=this._factories.get(e);!i||i!==n||(this._factories.delete(e),i.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},TC=class extends B{constructor(t,n,i){super();this._registry=t;this._languageId=n;this._factory=i}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};function Wn(r){let e=0,t=0,n=0,i=0;for(let o=0,s=r.length;o<s;o++){let a=r.charCodeAt(o);a===13?(e===0&&(t=o),e++,o+1<s&&r.charCodeAt(o+1)===10?(i|=2,o++):i|=3,n=o+1):a===10&&(i|=1,e===0&&(t=o),e++,n=o+1)}return e===0&&(t=r.length),[e,t,r.length-n,i]}var it=class r{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new Re(`Invalid range: ${this.toString()}`)}static addRange(e,t){let n=0;for(;n<t.length&&t[n].endExclusive<e.start;)n++;let i=n;for(;i<t.length&&t[i].start<=e.endExclusive;)i++;if(n===i)t.splice(n,0,e);else{let o=Math.min(e.start,t[n].start),s=Math.max(e.endExclusive,t[i-1].endExclusive);t.splice(n,i-n,new r(o,s))}}static tryCreate(e,t){if(!(e>t))return new r(e,t)}static ofLength(e){return new r(0,e)}static ofStartAndLength(e,t){return new r(e,e+t)}static emptyAt(e){return new r(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new r(this.start+e,this.endExclusive+e)}deltaStart(e){return new r(this.start+e,this.endExclusive)}deltaEnd(e){return new r(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new r(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(t<=n)return new r(t,n)}intersectionLength(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-t)}intersects(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<n}intersectsOrTouches(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Re(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Re(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let n=this.start;n<this.endExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}};var LC=class r{constructor(e){this._tokenInfo=e}static create(e){return new r(e)}forEach(e){let t=0;for(let n of this._tokenInfo){let i=new it(t,t+n.length);e(i,n),t+=n.length}}slice(e){let t=[],n=0;for(let i of this._tokenInfo){let o=n,s=o+i.length;if(s>e.start){if(o>=e.endExclusive)break;let a=Math.max(0,e.start-o),l=Math.max(0,s-e.endExclusive);t.push(new Rm(i.length-a-l,i.metadata))}n+=i.length}return r.create(t)}},Rm=class{constructor(e,t){this.length=e;this.metadata=t}},Dm=class{_tokens=[];add(e,t){this._tokens.push(new Rm(e,t))}build(){return LC.create(this._tokens)}};var _t=class r{static createEmpty(e,t){let n=r.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new r(i,e,t)}static createFromTextAndMetadata(e,t){let n=0,i="",o=new Array;for(let{text:s,metadata:a}of e)o.push(n+s.length,a),n+=s.length,i+=s;return new r(new Uint32Array(o),i,t)}static convertToEndOffset(e,t){let i=(e.length>>>1)-1;for(let o=0;o<i;o++)e[o<<1]=e[o+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){let o=n+Math.floor((i-n)/2),s=e[o<<1];if(s===t)return o+1;s<t?n=o+1:s>t&&(i=o)}return n}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,n){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof r?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let i=t<<1,o=i+(n<<1);for(let s=i;s<o;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],n=si.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return si.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return si.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return si.getClassNameFromMetadata(t)}getInlineStyle(e,t){let n=this._tokens[(e<<1)+1];return si.getInlineStyleFromMetadata(n,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return si.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return r.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new kC(this,e,t,n)}withInserted(e){if(e.length===0)return this;let t=0,n=0,i="",o=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=n<e.length?e[n]:null;if(a!==-1&&(l===null||a<=l.offset)){i+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];o.push(i.length,d),t++,s=a}else if(l){if(l.offset>s){i+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];o.push(i.length,d),s=l.offset}i+=l.text,o.push(i.length,l.tokenMetadata),n++}else break}return new r(new Uint32Array(o),i,this.languageIdCodec)}getTokensInRange(e){let t=new Dm,n=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let o=n;o<=i;o++){let a=new it(this.getStartOffset(o),this.getEndOffset(o)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(o))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}},kC=class r{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let o=this._firstTokenIndex,s=e.getCount();o<s&&!(e.getStartOffset(o)>=n);o++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof r?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),i=this._source.getEndOffset(t),o=this._source.getTokenText(t);return n<this._startOffset&&(o=o.substring(this._startOffset-n)),i>this._endOffset&&(o=o.substring(0,o.length-(i-this._endOffset))),o}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};var Br=new Uint32Array(0).buffer,jt=class r{static deleteBeginning(e,t){return e===null||e===Br?e:r.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===Br)return e;let n=Vr(e),i=n[n.length-2];return r.delete(e,t,i)}static delete(e,t,n){if(e===null||e===Br||t===n)return e;let i=Vr(e),o=i.length>>>1;if(t===0&&i[i.length-2]===n)return Br;let s=_t.findIndexInTokensArray(i,t),a=s>0?i[s-1<<1]:0,l=i[s<<1];if(n<l){let h=n-t;for(let g=s;g<o;g++)i[g<<1]-=h;return e}let d,u;a!==t?(i[s<<1]=t,d=s+1<<1,u=t):(d=s<<1,u=a);let c=n-t;for(let h=s+1;h<o;h++){let g=i[h<<1]-c;g>u&&(i[d++]=g,i[d++]=i[(h<<1)+1],u=g)}if(d===i.length)return e;let p=new Uint32Array(d);return p.set(i.subarray(0,d),0),p.buffer}static append(e,t){if(t===Br)return e;if(e===Br)return t;if(e===null)return e;if(t===null)return null;let n=Vr(e),i=Vr(t),o=i.length>>>1,s=new Uint32Array(n.length+i.length);s.set(n,0);let a=n.length,l=n[n.length-2];for(let d=0;d<o;d++)s[a++]=i[d<<1]+l,s[a++]=i[(d<<1)+1];return s.buffer}static insert(e,t,n){if(e===null||e===Br)return e;let i=Vr(e),o=i.length>>>1,s=_t.findIndexInTokensArray(i,t);s>0&&i[s-1<<1]===t&&s--;for(let a=s;a<o;a++)i[a<<1]+=n;return e}};function Vr(r){return r instanceof Uint32Array?r:new Uint32Array(r)}var bn=class r{static fromRange(e){return new r(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new r(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new r(e.startLineNumber,t.startLineNumber),new r(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new r(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new r(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new Pm(e[0].slice());for(let n=1;n<e.length;n++)t=t.getUnion(new Pm(e[n].slice()));return t.ranges}static join(e){if(e.length===0)throw new Re("lineRanges cannot be empty");let t=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)t=Math.min(t,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new r(t,n)}static ofLength(e,t){return new r(e,e+t)}static deserialize(e){return new r(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new Re(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new r(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new r(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new r(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=n)return new r(t,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new _(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new _(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new it(this.startLineNumber-1,this.endLineNumberExclusive-1)}},Pm=class r{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=zp(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=vu(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)this._normalizedRanges.splice(t,0,e);else if(t===n-1){let i=this._normalizedRanges[t];this._normalizedRanges[t]=i.join(e)}else{let i=this._normalizedRanges[t].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(t,n-t,i)}}contains(e){let t=ny(this._normalizedRanges,n=>n.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=ny(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],n=0,i=0,o=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let s=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let a=this._normalizedRanges[n],l=e._normalizedRanges[i];a.startLineNumber<l.startLineNumber?(s=a,n++):(s=l,i++)}else n<this._normalizedRanges.length?(s=this._normalizedRanges[n],n++):(s=e._normalizedRanges[i],i++);o===null?o=s:o.endLineNumberExclusive>=s.startLineNumber?o=new bn(o.startLineNumber,Math.max(o.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(o),o=s)}return o!==null&&t.push(o),new r(t)}subtractFrom(e){let t=zp(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),n=vu(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)return new r([e]);let i=[],o=e.startLineNumber;for(let s=t;s<n;s++){let a=this._normalizedRanges[s];a.startLineNumber>o&&i.push(new bn(o,a.startLineNumber)),o=a.endLineNumberExclusive}return o<e.endLineNumberExclusive&&i.push(new bn(o,e.endLineNumberExclusive)),new r(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let o=this._normalizedRanges[n],s=e._normalizedRanges[i],a=o.intersect(s);a&&!a.isEmpty&&t.push(a),o.endLineNumberExclusive<s.endLineNumberExclusive?n++:i++}return new r(t)}getWithDelta(e){return new r(this._normalizedRanges.map(t=>t.delta(e)))}};var Ic=class r{static deserialize(e,t,n){let i=new Uint32Array(e.buffer),o=Kt(e,t);t+=4;let s=Kt(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=Kt(e,t);t+=4,a.push(i.subarray(t/4,t/4+d/4)),t+=d}return n.push(new r(o,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new bn(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){Gt(e,this._startLineNumber,t),t+=4,Gt(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let i=this._tokens[n];if(!(i instanceof Uint32Array))throw new Error("Not supported!");Gt(e,i.byteLength,t),t+=4,e.set(new Uint8Array(i.buffer),t),t+=i.byteLength}return t}applyEdit(e,t){let[n,i]=Wn(t);this._acceptDeleteRange(e),this._acceptInsertText(new w(e.startLineNumber,e.startColumn),n,i)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let i=n-t;this._startLineNumber-=i;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=jt.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=jt.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let i=jt.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=jt.append(this._tokens[t],i),this._tokens.splice(t+1,n-t)}else this._tokens[t]=jt.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let i=-t;this._startLineNumber-=i,this._tokens[n]=jt.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-this._startLineNumber;if(i<0){this._startLineNumber+=t;return}if(!(i>=this._tokens.length)){if(t===0){this._tokens[i]=jt.insert(this._tokens[i],e.column-1,n);return}this._tokens[i]=jt.deleteEnding(this._tokens[i],e.column-1),this._tokens[i]=jt.insert(this._tokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._tokens=Er(this._tokens,e,n)}};var b$=G("IBuiltinExtensionsScannerService");var Cc=(i=>(i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error",i))(Cc||{});(o=>{function r(s,a){return a-s}o.compare=r;let e=Object.create(null);e[8]=m("sev.error","Error"),e[4]=m("sev.warning","Warning"),e[2]=m("sev.info","Info");function t(s){return e[s]||""}o.toString=t;function n(s){switch(s){case gn.Error:return 8;case gn.Warning:return 4;case gn.Info:return 2;case gn.Ignore:return 1}}o.fromSeverity=n;function i(s){switch(s){case 8:return gn.Error;case 4:return gn.Warning;case 2:return gn.Info;case 1:return gn.Ignore}}o.toSeverity=i})(Cc||={});var ZP;(n=>{let r="";function e(i){return t(i,!0)}n.makeKey=e;function t(i,o){let s=[r];return i.source?s.push(i.source.replace("\xA6","\\\xA6")):s.push(r),i.code?typeof i.code=="string"?s.push(i.code.replace("\xA6","\\\xA6")):s.push(i.code.value.replace("\xA6","\\\xA6")):s.push(r),i.severity!==void 0&&i.severity!==null?s.push(Cc.toString(i.severity)):s.push(r),i.message&&o?s.push(i.message.replace("\xA6","\\\xA6")):s.push(r),i.startLineNumber!==void 0&&i.startLineNumber!==null?s.push(i.startLineNumber.toString()):s.push(r),i.startColumn!==void 0&&i.startColumn!==null?s.push(i.startColumn.toString()):s.push(r),i.endLineNumber!==void 0&&i.endLineNumber!==null?s.push(i.endLineNumber.toString()):s.push(r),i.endColumn!==void 0&&i.endColumn!==null?s.push(i.endColumn.toString()):s.push(r),s.push(r),s.join("\xA6")}n.makeKeyOptionalMessage=t})(ZP||={});var k1=G("markerService");var Mm=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var XP;(i=>{let r=new Map;r.set(0,se.symbolMethod),r.set(1,se.symbolFunction),r.set(2,se.symbolConstructor),r.set(3,se.symbolField),r.set(4,se.symbolVariable),r.set(5,se.symbolClass),r.set(6,se.symbolStruct),r.set(7,se.symbolInterface),r.set(8,se.symbolModule),r.set(9,se.symbolProperty),r.set(10,se.symbolEvent),r.set(11,se.symbolOperator),r.set(12,se.symbolUnit),r.set(13,se.symbolValue),r.set(15,se.symbolEnum),r.set(14,se.symbolConstant),r.set(15,se.symbolEnum),r.set(16,se.symbolEnumMember),r.set(17,se.symbolKeyword),r.set(27,se.symbolSnippet),r.set(18,se.symbolText),r.set(19,se.symbolColor),r.set(20,se.symbolFile),r.set(21,se.symbolReference),r.set(22,se.symbolCustomColor),r.set(23,se.symbolFolder),r.set(24,se.symbolTypeParameter),r.set(25,se.account),r.set(26,se.issues);function e(o){let s=r.get(o);return s||(console.info("No codicon found for CompletionItemKind "+o),s=se.symbolProperty),s}i.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function n(o,s){let a=t.get(o);return typeof a>"u"&&!s&&(a=9),a}i.fromString=n})(XP||={});var bY={17:m("Array","array"),16:m("Boolean","boolean"),4:m("Class","class"),13:m("Constant","constant"),8:m("Constructor","constructor"),9:m("Enum","enumeration"),21:m("EnumMember","enumeration member"),23:m("Event","event"),7:m("Field","field"),0:m("File","file"),11:m("Function","function"),10:m("Interface","interface"),19:m("Key","key"),5:m("Method","method"),1:m("Module","module"),2:m("Namespace","namespace"),20:m("Null","null"),15:m("Number","number"),18:m("Object","object"),24:m("Operator","operator"),3:m("Package","package"),6:m("Property","property"),14:m("String","string"),22:m("Struct","struct"),25:m("TypeParameter","type parameter"),12:m("Variable","variable")};var JP;(t=>{let r=new Map;r.set(0,se.symbolFile),r.set(1,se.symbolModule),r.set(2,se.symbolNamespace),r.set(3,se.symbolPackage),r.set(4,se.symbolClass),r.set(5,se.symbolMethod),r.set(6,se.symbolProperty),r.set(7,se.symbolField),r.set(8,se.symbolConstructor),r.set(9,se.symbolEnum),r.set(10,se.symbolInterface),r.set(11,se.symbolFunction),r.set(12,se.symbolVariable),r.set(13,se.symbolConstant),r.set(14,se.symbolString),r.set(15,se.symbolNumber),r.set(16,se.symbolBoolean),r.set(17,se.symbolArray),r.set(18,se.symbolObject),r.set(19,se.symbolKey),r.set(20,se.symbolNull),r.set(21,se.symbolEnumMember),r.set(22,se.symbolStruct),r.set(23,se.symbolEvent),r.set(24,se.symbolOperator),r.set(25,se.symbolTypeParameter);function e(n){let i=r.get(n);return i||(console.info("No codicon found for SymbolKind "+n),i=se.symbolProperty),i}t.toIcon=e})(JP||={});var R1=class r{constructor(e){this.value=e}static Comment=new r("comment");static Imports=new r("imports");static Region=new r("region");static fromValue(e){switch(e){case"comment":return r.Comment;case"imports":return r.Imports;case"region":return r.Region}return new r(e)}};var eM;(e=>{function r(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=r})(eM||={});var ai=new yc,Sc=new yc;var li=G("languageService");function Ur(r,e){let t=r.getCount(),n=r.findTokenIndexAtOffset(e),i=r.getLanguageId(n),o=n;for(;o+1<t&&r.getLanguageId(o+1)===i;)o++;let s=n;for(;s>0&&r.getLanguageId(s-1)===i;)s--;return new DC(r,i,s,o+1,r.getStartOffset(s),r.getEndOffset(o))}var DC=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,n,i,o,s){this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=o,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},D1=(e=>(e[e.value=3]="value",e))(D1||{});function Ni(r){return(r&D1.value)!==0}var Bl=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let n=e.findTokenIndexAtOffset(t-2),i=e.getStandardTokenType(n);return this.isOK(i)}_findNeutralCharacterInRange(e,t){for(let n=e;n<=t;n++){let i=String.fromCharCode(n);if(!this.open.includes(i)&&!this.close.includes(i))return i}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},Om=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)_c(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),_c(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),_c(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),_c(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&_c(this.autoClosingPairsCloseSingleChar,t.close,t)}};function _c(r,e,t){r.has(e)?r.get(e).push(t):r.set(e,[t])}var PC=class r{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,n,i,o,s){this.languageId=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=o,this.reversedRegex=s,this._openSet=r._toSet(this.open),this._closeSet=r._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let n of e)t.add(n);return t}};function tM(r){let e=r.length;r=r.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let n=(s,a)=>{let[l,d]=s,[u,c]=a;return l===u||l===c||d===u||d===c},i=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let u=0;u<e;u++)t[u]===d&&(t[u]=l)};for(let s=0;s<e;s++){let a=r[s];for(let l=s+1;l<e;l++){let d=r[l];n(a,d)&&i(t[s],t[l])}}let o=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[u,c]=r[d];a.push(u),l.push(c)}a.length>0&&o.push({open:a,close:l})}return o}var Nm=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let n=tM(t);this.brackets=n.map((i,o)=>new PC(e,o,i.open,i.close,nM(i.open,i.close,n,o),iM(i.open,i.close,n,o))),this.forwardRegex=rM(this.brackets),this.reversedRegex=oM(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let i of this.brackets){for(let o of i.open)this.textIsBracket[o]=i,this.textIsOpenBracket[o]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,o.length);for(let o of i.close)this.textIsBracket[o]=i,this.textIsOpenBracket[o]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,o.length)}}};function P1(r,e,t,n){for(let i=0,o=e.length;i<o;i++){if(i===t)continue;let s=e[i];for(let a of s.open)a.indexOf(r)>=0&&n.push(a);for(let a of s.close)a.indexOf(r)>=0&&n.push(a)}}function M1(r,e){return r.length-e.length}function Am(r){if(r.length<=1)return r;let e=[],t=new Set;for(let n of r)t.has(n)||(e.push(n),t.add(n));return e}function nM(r,e,t,n){let i=[];i=i.concat(r),i=i.concat(e);for(let o=0,s=i.length;o<s;o++)P1(i[o],t,n,i);return i=Am(i),i.sort(M1),i.reverse(),Vl(i)}function iM(r,e,t,n){let i=[];i=i.concat(r),i=i.concat(e);for(let o=0,s=i.length;o<s;o++)P1(i[o],t,n,i);return i=Am(i),i.sort(M1),i.reverse(),Vl(i.map(MC))}function rM(r){let e=[];for(let t of r){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=Am(e),Vl(e)}function oM(r){let e=[];for(let t of r){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=Am(e),Vl(e.map(MC))}function sM(r){let e=/^[\w ]+$/.test(r);return r=Xn(r),e?`\\b${r}\\b`:r}function Vl(r,e){let t=`(${r.map(sM).join(")|(")})`;return yh(t,!0,e)}var MC=function(){function r(n){let i=new Uint16Array(n.length),o=0;for(let s=n.length-1;s>=0;s--)i[o++]=n.charCodeAt(s);return xC().decode(i)}let e=null,t=null;return function(i){return e!==i&&(e=i,t=r(e)),t}}(),En=class{static _findPrevBracketInText(e,t,n,i){let o=n.match(e);if(!o)return null;let s=n.length-(o.index||0),a=o[0].length,l=i+s;return new _(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,n,i,o){let a=MC(n).substring(n.length-o,n.length-i);return this._findPrevBracketInText(e,t,a,i)}static findNextBracketInText(e,t,n,i){let o=n.match(e);if(!o)return null;let s=o.index||0,a=o[0].length;if(a===0)return null;let l=i+s;return new _(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,n,i,o){let s=n.substring(i,o);return this.findNextBracketInText(e,t,s,i)}};var Fm=class{constructor(e,t){this.languageId=e;let n=t.brackets?O1(t.brackets):[],i=new Ru(a=>{let l=new Set;return{info:new OC(this,a,l),closing:l}}),o=new Ru(a=>{let l=new Set,d=new Set;return{info:new NC(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of n){let d=i.get(a),u=o.get(l);d.closing.add(u.info),u.opening.add(d.info)}let s=t.colorizedBracketPairs?O1(t.colorizedBracketPairs):n.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=i.get(a),u=o.get(l);d.closing.add(u.info),u.openingColorized.add(d.info),u.opening.add(d.info)}this._openingBrackets=new Map([...i.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...o.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return Vl(t,e)}};function O1(r){return r.filter(([e,t])=>e!==""&&t!=="")}var Wm=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},OC=class extends Wm{constructor(t,n,i){super(t,n);this.openedBrackets=i}isOpeningBracket=!0},NC=class extends Wm{constructor(t,n,i,o){super(t,n);this.openingBrackets=i;this.openingColorizedBrackets=o}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var Ye=class r{static _nextVisibleColumn(e,t,n){return e===9?r.nextRenderTabStop(t,n):Ii(e)||xh(e)?t+2:t+1}static visibleColumnFromColumn(e,t,n){let i=Math.min(t-1,e.length),o=e.substring(0,i),s=new Ks(o),a=0;for(;!s.eol();){let l=gl(o,i,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,n)}return a}static toStatusbarColumn(e,t,n){let i=e.substring(0,Math.min(t-1,e.length)),o=new zs(i),s=0;for(;!o.eol();)o.nextCodePoint()===9?s=r.nextRenderTabStop(s,n):s=s+1;return s+1}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;let i=e.length,o=new Ks(e),s=0,a=1;for(;!o.eol();){let l=gl(e,i,o.offset);o.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,n),u=o.offset+1;if(d>=t){let c=t-s;return d-t<c?u:a}s=d,a=u}return i+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};var Ul=class r{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new r(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?r.zero:e.lineCount===t.lineCount?new r(0,t.columnCount-e.columnCount):new r(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new r(0,t.column-e.column):new r(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return r.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,n=0;for(let i of e)i===`
`?(t++,n=0):n++;return new r(t,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new r(this.lineCount,this.columnCount+e.columnCount):new r(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new _(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new _(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new _(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new w(e.lineNumber,e.column+this.columnCount):new w(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function N1(r,e,t,n){return r!==t?rt(t-r,n):rt(0,n-e)}var Ft=0;function Hl(r){return r===0}var di=2**26;function rt(r,e){return r*di+e}function vn(r){let e=r,t=Math.floor(e/di),n=e-t*di;return new Ul(t,n)}function A1(r){return Math.floor(r/di)}function et(r,e){let t=r+e;return e>=di&&(t=t-r%di),t}function F1(r,e){return r.reduce((t,n)=>et(t,e(n)),Ft)}function AC(r,e){return r===e}function pa(r,e){let t=r,n=e;if(n-t<=0)return Ft;let o=Math.floor(t/di),s=Math.floor(n/di),a=n-s*di;if(o===s){let l=t-o*di;return rt(0,a-l)}else return rt(s-o,a)}function vo(r,e){return r<e}function rs(r,e){return r<=e}function zl(r,e){return r>=e}function os(r){return rt(r.lineNumber-1,r.column-1)}function ss(r,e){let t=r,n=Math.floor(t/di),i=t-n*di,o=e,s=Math.floor(o/di),a=o-s*di;return new _(n+1,i+1,s+1,a+1)}function W1(r){let e=Pu(r);return rt(e.length-1,e[e.length-1].length)}var Bm=[],Zt=class r{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let n=r.cache[e];return n||(n=new r(e,t),r.cache[e]=n),n}return new r(e,t)}static empty=r.create(0,Bm);static getEmpty(){return this.empty}add(e,t){let n=t.getKey(e),i=n>>5;if(i===0){let s=1<<n|this.items;return s===this.items?this:r.create(s,this.additionalItems)}i--;let o=this.additionalItems.slice(0);for(;o.length<i;)o.push(0);return o[i]|=1<<(n&31),r.create(this.items,o)}has(e,t){let n=t.getKey(e),i=n>>5;return i===0?(this.items&1<<n)!==0:(i--,((this.additionalItems[i]||0)&1<<(n&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===Bm&&e.additionalItems===Bm)return t===this.items?this:t===e.items?e:r.create(t,Bm);let n=[];for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){let o=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(o|s)}return r.create(t,n)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},FC={getKey(r){return r}},Vm=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,n])=>n===e)?.[0]}reverseLookupSet(e){let t=[];for(let[n]of this.items)e.has(n,this)&&t.push(n);return t}keys(){return this.items.keys()}};var Um=class r{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new Bl(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new Bl({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new Bl({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var Hm=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let n of t.close){let i=n.charAt(n.length-1);e.push(i)}return Fo(e)}onElectricCharacter(e,t,n){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let i=t.findTokenIndexAtOffset(n-1);if(Ni(t.getStandardTokenType(i)))return null;let o=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,n-1)+e,a=En.findPrevBracketInRange(o,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let u=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(u)?{matchOpenBracket:l}:null}};function zm(r){return r.global&&(r.lastIndex=0),!0}var Km=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&zm(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&zm(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&zm(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&zm(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var Gm=class r{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let n=r._createOpenBracketRegExp(t[0]),i=r._createCloseBracketRegExp(t[1]);n&&i&&this._brackets.push({open:t[0],openRegExp:n,close:t[1],closeRegExp:i})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let o=0,s=this._regExpRules.length;o<s;o++){let a=this._regExpRules[o];if([{reg:a.beforeText,text:n},{reg:a.afterText,text:i},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&n.length>0&&i.length>0)for(let o=0,s=this._brackets.length;o<s;o++){let a=this._brackets[o];if(a.openRegExp.test(n)&&a.closeRegExp.test(i))return{indentAction:2}}if(e>=2&&n.length>0){for(let o=0,s=this._brackets.length;o<s;o++)if(this._brackets[o].openRegExp.test(n))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=Xn(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",r._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Xn(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,r._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return Le(t),null}}};var ha=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),aM={".css":"text/css",".csv":"text/csv",".htm":"text/html",".html":"text/html",".ics":"text/calendar",".js":"text/javascript",".mjs":"text/javascript",".txt":"text/plain",".xml":"text/xml"},lM={".aac":"audio/x-aac",".avi":"video/x-msvideo",".bmp":"image/bmp",".flv":"video/x-flv",".gif":"image/gif",".ico":"image/x-icon",".jpe":"image/jpg",".jpeg":"image/jpg",".jpg":"image/jpg",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3a":"audio/mpeg",".mid":"audio/midi",".midi":"audio/midi",".mk3d":"video/x-matroska",".mks":"video/x-matroska",".mkv":"video/x-matroska",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp2a":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4a":"audio/mp4",".mp4v":"video/mp4",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpg4":"video/mp4",".mpga":"audio/mpeg",".oga":"audio/ogg",".ogg":"audio/ogg",".opus":"audio/opus",".ogv":"video/ogg",".png":"image/png",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".spx":"audio/ogg",".svg":"image/svg+xml",".tga":"image/x-tga",".tif":"image/tiff",".tiff":"image/tiff",".wav":"audio/x-wav",".webm":"video/webm",".webp":"image/webp",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".woff":"application/font-woff"};function V1(r){let e=Os(r),t=aM[e.toLowerCase()];return t!==void 0?t:dM(r)}function dM(r){let e=Os(r);return lM[e.toLowerCase()]}var uM={ModesRegistry:"editor.modesRegistry"},BC=class{_languages;_onDidChangeLanguages=new L;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},U1=new BC;Xe.add(uM.ModesRegistry,U1);var or="plaintext",VC=".txt";U1.registerLanguage({id:or,extensions:[VC],aliases:[m("plainText.alias","Plain Text"),"text"],mimetypes:[ha.text]});Xe.as(gc.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var Ec=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},sr=G("languageConfigurationService"),xc=class extends B{constructor(t,n){super();this.configurationService=t;this.languageService=n;let i=new Set(Object.values(UC));this._register(this.configurationService.onDidChangeConfiguration(o=>{let s=o.change.keys.some(l=>i.has(l)),a=o.change.overrides.filter(([l,d])=>d.some(u=>i.has(u))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new Ec(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new Ec(l)))})),this._register(this._registry.onDidChange(o=>{this.configurations.delete(o.languageId),this.onDidChangeEmitter.fire(new Ec(o.languageId))}))}_serviceBrand;_registry=this._register(new zC);onDidChangeEmitter=this._register(new L);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,n,i){return this._registry.register(t,n,i)}getLanguageConfiguration(t){let n=this.configurations.get(t);return n||(n=cM(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,n)),n}};xc=ne([M(0,ln),M(1,li)],xc);function cM(r,e,t,n){let i=e.getLanguageConfiguration(r);if(!i){if(!n.isRegisteredLanguageId(r))return new Kl(r,{});i=new Kl(r,{})}let o=pM(i.languageId,t),s=z1([i.underlyingConfig,o]);return new Kl(i.languageId,s)}var UC={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function pM(r,e){let t=e.getValue(UC.brackets,{overrideIdentifier:r}),n=e.getValue(UC.colorizedBracketPairs,{overrideIdentifier:r});return{brackets:H1(t),colorizedBracketPairs:H1(n)}}function H1(r){if(Array.isArray(r))return r.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function $m(r,e,t){let n=r.getLineContent(e),i=At(n);return i.length>t-1&&(i=i.substring(0,t-1)),i}var HC=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let n=new jm(e,t,++this._order);return this._entries.push(n),this._resolved=null,ve(()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===n){this._entries.splice(i,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new Kl(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(jm.cmp),z1(this._entries.map(e=>e.configuration)))}};function z1(r){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of r)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var jm=class{constructor(e,t,n){this.configuration=e;this.priority=t;this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},qm=class{constructor(e){this.languageId=e}},zC=class extends B{_entries=new Map;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(or,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,n=0){let i=this._entries.get(e);i||(i=new HC(e),this._entries.set(e,i));let o=i.register(t,n);return this._onDidChange.fire(new qm(e)),ve(()=>{o.dispose(),this._onDidChange.fire(new qm(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},Kl=class r{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Gm(this.underlyingConfig):null,this.comments=r._handleComments(this.underlyingConfig),this.characterPair=new Um(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||NI,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Km(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new Fm(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return hc(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new Nm(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new Hm(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}getAutoClosingPairs(){return new Om(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[i,o]=t.blockComment;n.blockCommentStartToken=i,n.blockCommentEndToken=o}return n}};Jn(sr,xc,1);var KC=class r{constructor(e){this.map=e}static createFromLanguage(e,t){function n(o){return t.getKey(`${o.languageId}:::${o.bracketText}`)}let i=new Map;for(let o of e.bracketsNew.openingBrackets){let s=rt(0,o.bracketText.length),a=n(o),l=Zt.getEmpty().add(a,FC);i.set(o.bracketText,new ar(s,1,a,l,wc.create(s,o,l)))}for(let o of e.bracketsNew.closingBrackets){let s=rt(0,o.bracketText.length),a=Zt.getEmpty(),l=o.getOpeningBrackets();for(let d of l)a=a.add(n(d),FC);i.set(o.bracketText,new ar(s,2,n(l[0]),a,wc.create(s,o,a)))}return new r(i)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>hM(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,n]of this.map)if(n.kind===2&&n.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function hM(r){let e=Xn(r);return/^[\w ]+/.test(r)&&(e=`\\b${e}`),/[\w ]+$/.test(r)&&(e=`${e}\\b`),e}var Ym=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=KC.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var ar=class{constructor(e,t,n,i,o){this.length=e;this.kind=t;this.bracketId=n;this.bracketIds=i;this.astNode=o}},Qm=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new GC(this.textModel,this.bracketTokens);_offset=Ft;get offset(){return this._offset}get length(){return rt(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=et(this._offset,e);let t=vn(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=et(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},GC=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let o=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=o.length,o}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,n=0;for(;;){let o=this.lineTokens,s=o.getCount(),a=null;if(this.lineTokenOffset<s){let l=o.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===o.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=si.getTokenType(l)===0,u=si.containsBalancedBrackets(l),c=o.getEndOffset(this.lineTokenOffset);if(u&&d&&this.lineCharOffset<c){let p=o.getLanguageId(this.lineTokenOffset),h=this.line.substring(this.lineCharOffset,c),g=this.bracketTokens.getSingleLanguageBracketTokens(p),f=g.regExpGlobal;if(f){f.lastIndex=0;let v=f.exec(h);v&&(a=g.getToken(v[0]),a&&(this.lineCharOffset+=v.index))}}if(n+=c-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=c}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3))break;if(n>1500)break}let i=N1(e,t,this.lineIdx,this.lineCharOffset);return new ar(i,0,-1,Zt.getEmpty(),new lr(i))}},Zm=class{constructor(e,t){this.text=e;let n=t.getRegExpStr(),i=n?new RegExp(n+`|
`,"gi"):null,o=[],s,a=0,l=0,d=0,u=0,c=[];for(let g=0;g<60;g++)c.push(new ar(rt(0,g),0,-1,Zt.getEmpty(),new lr(rt(0,g))));let p=[];for(let g=0;g<60;g++)p.push(new ar(rt(1,g),0,-1,Zt.getEmpty(),new lr(rt(1,g))));if(i)for(i.lastIndex=0;(s=i.exec(e))!==null;){let g=s.index,f=s[0];if(f===`
`)a++,l=g+1;else{if(d!==g){let v;if(u===a){let y=g-d;if(y<c.length)v=c[y];else{let I=rt(0,y);v=new ar(I,0,-1,Zt.getEmpty(),new lr(I))}}else{let y=a-u,I=g-l;if(y===1&&I<p.length)v=p[I];else{let S=rt(y,I);v=new ar(S,0,-1,Zt.getEmpty(),new lr(S))}}o.push(v)}o.push(t.getToken(f)),d=g+f.length,u=a}}let h=e.length;if(d!==h){let g=u===a?rt(0,h-d):rt(a-u,h-l);o.push(new ar(g,0,-1,Zt.getEmpty(),new lr(g)))}this.length=rt(a,h-l),this.tokens=o}_offset=Ft;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new Kp}getText(){return this.text}};var Tc=class{_length;get length(){return this._length}constructor(e){this._length=e}},Lc=class r extends Tc{constructor(t,n,i,o,s){super(t);this.openingBracket=n;this.child=i;this.closingBracket=o;this.missingOpeningBracketIds=s}static create(t,n,i){let o=t.length;return n&&(o=et(o,n.length)),i&&(o=et(o,i.length)),new r(o,t,n,i,n?n.missingOpeningBracketIds:Zt.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return r.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new r(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,n){return this.child?this.child.computeMinIndentation(et(t,this.openingBracket.length),n):Number.MAX_SAFE_INTEGER}},ui=class r extends Tc{constructor(t,n,i){super(t);this.listHeight=n;this._missingOpeningBracketIds=i}static create23(t,n,i,o=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");if(s=et(s,n.length),a=a.merge(n.missingOpeningBracketIds),i){if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=et(s,i.length),a=a.merge(i.missingOpeningBracketIds)}return o?new jC(s,t.listHeight+1,t,n,i,a):new kc(s,t.listHeight+1,t,n,i,a)}static create(t,n=!1){if(t.length===0)return this.getEmpty();{let i=t[0].length,o=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)i=et(i,t[s].length),o=o.merge(t[s].missingOpeningBracketIds);return n?new Xm(i,t[0].listHeight+1,t,o):new Rc(i,t[0].listHeight+1,t,o)}}static getEmpty(){return new Xm(Ft,0,[],Zt.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let n=this.getChild(t-1),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(t-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let n=this.getChild(0),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let n=this;for(;n.kind===4;){let i=n.childrenLength;if(i===0)throw new Re;n=n.getChild(i-1)}return n.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,n=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let o=1;o<t;o++){let s=this.getChild(o);n=et(n,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=n,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let n of this.children){let i=n.flattenLists();i.kind===4?t.push(...i.children):t.push(i)}return r.create(t)}computeMinIndentation(t,n){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,o=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(i=Math.min(i,a.computeMinIndentation(o,n)),o=et(o,a.length))}return this.cachedMinIndentation=i,i}},kc=class r extends ui{constructor(t,n,i,o,s,a){super(t,n,a);this._item1=i;this._item2=o;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,n){switch(t){case 0:this._item1=n;return;case 1:this._item2=n;return;case 2:this._item3=n;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new r(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},jC=class extends kc{toMutable(){return new kc(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},Rc=class r extends ui{constructor(t,n,i,o){super(t,n,o);this._children=i}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,n){this._children[t]=n}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let n=0;n<this._children.length;n++)t[n]=this._children[n].deepClone();return new r(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},Xm=class extends Rc{toMutable(){return new Rc(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},gM=[],Dc=class extends Tc{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return gM}flattenLists(){return this}deepClone(){return this}},lr=class extends Dc{get kind(){return 0}get missingOpeningBracketIds(){return Zt.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let n=vn(e),i=(n.columnCount===0?n.lineCount:n.lineCount+1)+1,o=A1(et(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=i;a<=o;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let u=Ye.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,u)}return s}},wc=class r extends Dc{constructor(t,n,i){super(t);this.bracketInfo=n;this.bracketIds=i}static create(t,n,i){return new r(t,n,i)}get kind(){return 1}get missingOpeningBracketIds(){return Zt.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,n){return Number.MAX_SAFE_INTEGER}},Jm=class extends Dc{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var Pc=class{constructor(e,t,n,i){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=n;this.isInvalid=i}},qC=class{constructor(e,t,n,i,o,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=n;this.nestingLevel=i;this.nestingLevelOfEqualBracketType=o;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},eg=class extends qC{constructor(t,n,i,o,s,a,l){super(t,n,i,o,s,a);this.minVisibleColumnIndentation=l}};var tg=class{changeType=1},Bn=class r{constructor(e,t,n,i,o){this.ownerId=e;this.lineNumber=t;this.column=n;this.options=i;this.order=o}static applyInjectedText(e,t){if(!t||t.length===0)return e;let n="",i=0;for(let o of t)n+=e.substring(i,o.column-1),i=o.column-1,n+=o.options.content;return n+=e.substring(i),n}static fromDecorations(e){let t=[];for(let n of e)n.options.before&&n.options.before.content.length>0&&t.push(new r(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new r(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((n,i)=>n.lineNumber===i.lineNumber?n.column===i.column?n.order-i.order:n.column-i.column:n.lineNumber-i.lineNumber),t}withText(e){return new r(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},Mc=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,n){this.lineNumber=e,this.detail=t,this.injectedText=n}},ng=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},ig=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,n,i){this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}},rg=class{changeType=5},ma=class r{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.versionId,o=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new r(n,i,o,s)}},jl=class{changes;constructor(e){this.changes=e}},as=class r{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=ma.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=r._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new r(t,n)}static _mergeChangeEvents(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.eol,o=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:n,eol:i,isEolChange:d,versionId:o,isUndoing:s,isRedoing:a,isFlush:l}}};var Ai=class{constructor(e,t,n,i,o,s){this.visibleColumn=e;this.column=t;this.className=n;this.horizontalLine=i;this.forWrappedLinesAfterColumn=o;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},yo=class{constructor(e,t){this.top=e;this.endColumn=t}};var og=class r{constructor(e){this.edits=e;let t=-1;for(let n of e){if(!(n.replaceRange.start>=t))throw new Re(`Edits must be disjoint and sorted. Found ${n} after ${t}`);t=n.replaceRange.endExclusive}}static empty=new r([]);static fromJson(e){return new r(e.map(dr.fromJson))}static replace(e,t){return new r([new dr(e,t)])}static insert(e,t){return r.replace(it.emptyAt(e),t)}normalize(){let e=[],t;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(t&&t.replaceRange.endExclusive===n.replaceRange.start?t=new dr(t.replaceRange.join(n.replaceRange),t.newText+n.newText):(t&&e.push(t),t=n));return t&&e.push(t),new r(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],n=0;for(let i of this.edits)t.push(e.substring(n,i.replaceRange.start)),t.push(i.newText),n=i.replaceRange.endExclusive;return t.push(e.substring(n)),t.join("")}compose(e){return bM(this,e)}inverse(e){let t=[],n=0;for(let i of this.edits)t.push(new dr(it.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new r(t)}getNewTextRanges(){let e=[],t=0;for(let n of this.edits)e.push(it.ofStartAndLength(n.replaceRange.start+t,n.newText.length)),t+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],n=0,i=0,o=0;for(;i<this.edits.length||n<e.edits.length;){let s=e.edits[n],a=this.edits[i];if(a)s?a.replaceRange.intersects(s.replaceRange)?i++:a.replaceRange.start<s.replaceRange.start?(t.push(new dr(a.replaceRange.delta(o),a.newText)),i++):(n++,o+=s.newText.length-s.replaceRange.length):(t.push(new dr(a.replaceRange.delta(o),a.newText)),i++);else break}return new r(t)}applyToOffset(e){let t=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+t;t+=n.newText.length-n.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new it(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-t){if(e-t<n.replaceRange.start+i)return n.replaceRange.start;t+=i-n.replaceRange.length}else break}return e-t}},dr=class r{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new r(it.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new r(it.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function bM(r,e){if(r=r.normalize(),e=e.normalize(),r.isEmpty)return e;if(e.isEmpty)return r;let t=[...r.edits],n=[],i=0;for(let o of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+i+d.newText.length>=o.replaceRange.start)break;t.shift(),n.push(d),i+=d.newText.length-d.replaceRange.length}let s=i,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+i>o.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),i+=d.newText.length-d.replaceRange.length}if(!a)n.push(new dr(o.replaceRange.delta(-i),o.newText));else{let d="",u=o.replaceRange.start-(a.replaceRange.start+s);u>0&&(d=a.newText.slice(0,u));let c=l.replaceRange.endExclusive+i-o.replaceRange.endExclusive;if(c>0){let g=new dr(it.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-c));t.unshift(g),i-=g.newText.length-g.replaceRange.length}let p=d+o.newText,h=new it(Math.min(a.replaceRange.start,o.replaceRange.start-s),o.replaceRange.endExclusive-i);n.push(new dr(h,p))}}for(;;){let o=t.shift();if(!o)break;n.push(o)}return new og(n).normalize()}var j1=G("undoRedoService");var K1=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r},G1=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r};var ql=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Ci(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},ls=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function q1(r){return r&&typeof r.read=="function"}var $l=class{constructor(e,t,n,i,o,s){this.identifier=e;this.range=t;this.text=n;this.forceMoveMarkers=i;this.isAutoWhitespaceEdit=o;this._isTracked=s}},sg=class{regex;wordSeparators;simpleSearch;constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},ag=class{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}};var $C={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var yM=G("textModelService");var $1="";var Yl=class extends B{_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var ga=G("modelService");var lg=G("ILanguageDetectionService"),QC="languageDetection";var ds=class extends Yl{constructor(t,n,i,o,s){super();this.modelService=t;this.languageService=n;this.languageDetectionService=i;this.accessibilityService=o;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new Zn);autoDetectLanguageThrottler=this._register(new Gh(ds.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let n=this.modelService.getModel(t);if(!n)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(n)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,n){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,n)}setLanguageIdInternal(t,n){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),n))}installModelListeners(t){let n=this._register(t.onDidChangeLanguage(i=>{i.source!==QC&&(this._hasLanguageSetExplicitly=!0,n.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??or))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),n=this.getLanguageId();if(t&&t!==n&&!this.isDisposed()){this.setLanguageIdInternal(t,QC);let i=this.languageService.getLanguageName(t);this.accessibilityService.alert(m("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",i??t))}}createTextEditorModel(t,n,i){let o=this.getFirstLineText(t),s=this.getOrCreateLanguage(n,this.languageService,i,o);return this.doCreateTextEditorModel(t,s,n)}doCreateTextEditorModel(t,n,i){let o=i&&this.modelService.getModel(i);return o?this.updateTextEditorModel(t,n.languageId):(o=this.modelService.createModel(t,n,i),this.createdEditorModel=!0,this.registerModelDisposeListener(o)),this.textEditorModelHandle=o.uri,o}getFirstLineText(t){let n=t;return typeof n.getFirstLineText=="function"?n.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,n,i,o){return!i||i===or?n.createByFilepathOrFirstLine(t??null,o):n.createById(i)}updateTextEditorModel(t,n){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),n&&n!==or&&this.textEditorModel.getLanguageId()!==n&&this.textEditorModel.setLanguage(this.languageService.createById(n)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};ds=ne([M(0,ga),M(1,li),M(2,lg),M(3,ri)],ds);var dg=G("workingCopyBackupService");var ug=G("textResourceConfigurationService"),Sne=G("textResourcePropertiesService");function IM(r,e,t){let n=0;for(let o=0;o<r.length;o++)r.charAt(o)==="	"?n=Ye.nextIndentTabStop(n,e):n++;let i="";if(!t){let o=Math.floor(n/e);n=n%e;for(let s=0;s<o;s++)i+="	"}for(let o=0;o<n;o++)i+=" ";return i}function cg(r,e,t){let n=gt(r);return n===-1&&(n=r.length),IM(r.substring(0,n),e,t)+r.substring(n)}var fa=class r{constructor(e,t,n){this.startOffset=e;this.endOffset=t;this.newLength=n}static fromModelContentChanges(e){return e.map(n=>{let i=_.lift(n.range);return new r(os(i.getStartPosition()),os(i.getEndPosition()),W1(n.text))}).reverse()}toString(){return`[${vn(this.startOffset)}...${vn(this.endOffset)}) -> ${vn(this.newLength)}`}},pg=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>ZC.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):null;return n===null?null:pa(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?rt(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):rt(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=vn(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?rt(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):rt(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(rs(n,e)){this.nextEditIdx++;let i=vn(n),o=vn(this.translateOldToCur(t.endOffsetBeforeObj)),s=i.lineCount-o.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=i.columnCount-o.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},ZC=class r{static from(e){return new r(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,n){this.endOffsetBeforeObj=vn(t),this.endOffsetAfterObj=vn(et(e,n)),this.offsetObj=vn(e)}};function Z1(r){if(r.length===0)return null;if(r.length===1)return r[0];let e=0;function t(){if(e>=r.length)return null;let s=e,a=r[s].listHeight;for(e++;e<r.length&&r[e].listHeight===a;)e++;return e-s>=2?JC(s===0&&e===r.length?r:r.slice(s,e),!1):r[s]}let n=t(),i=t();if(!i)return n;for(let s=t();s;s=t())Y1(n,i)<=Y1(i,s)?(n=XC(n,i),i=s):i=XC(i,s);return XC(n,i)}function JC(r,e=!1){if(r.length===0)return null;if(r.length===1)return r[0];let t=r.length;for(;t>3;){let n=t>>1;for(let i=0;i<n;i++){let o=i<<1;r[i]=ui.create23(r[o],r[o+1],o+3===t?r[o+2]:null,e)}t=n}return ui.create23(r[0],r[1],t>=3?r[2]:null,e)}function Y1(r,e){return Math.abs(r.listHeight-e.listHeight)}function XC(r,e){return r.listHeight===e.listHeight?ui.create23(r,e,null,!1):r.listHeight>e.listHeight?CM(r,e):SM(e,r)}function CM(r,e){r=r.toMutable();let t=r,n=[],i;for(;;){if(e.listHeight===t.listHeight){i=e;break}if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeLastElementMutable()}for(let o=n.length-1;o>=0;o--){let s=n[o];i?s.childrenLength>=3?i=ui.create23(s.unappendChild(),i,null,!1):(s.appendChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?ui.create23(r,i,null,!1):r}function SM(r,e){r=r.toMutable();let t=r,n=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeFirstElementMutable()}let i=e;for(let o=n.length-1;o>=0;o--){let s=n[o];i?s.childrenLength>=3?i=ui.create23(i,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?ui.create23(i,r,null,!1):r}var hg=class{nextNodes;offsets;idxs;lastOffset=Ft;constructor(e){this.nextNodes=[e],this.offsets=[Ft],this.idxs=[]}readLongestNodeAt(e,t){if(vo(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let n=Oc(this.nextNodes);if(!n)return;let i=Oc(this.offsets);if(vo(e,i))return;if(vo(i,e))if(et(i,n.length)<=e)this.nextNodeAfterCurrent();else{let o=eS(n);o!==-1?(this.nextNodes.push(n.getChild(o)),this.offsets.push(i),this.idxs.push(o)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{let o=eS(n);if(o===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(n.getChild(o)),this.offsets.push(i),this.idxs.push(o)}}}}nextNodeAfterCurrent(){for(;;){let e=Oc(this.offsets),t=Oc(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let n=Oc(this.nextNodes),i=eS(n,this.idxs[this.idxs.length-1]);if(i!==-1){this.nextNodes.push(n.getChild(i)),this.offsets.push(et(e,t.length)),this.idxs[this.idxs.length-1]=i;break}else this.idxs.pop()}}};function eS(r,e=-1){for(;;){if(e++,e>=r.childrenLength)return-1;if(r.getChild(e))return e}}function Oc(r){return r.length>0?r[r.length-1]:void 0}function nS(r,e,t,n){return new tS(r,e,t,n).parseDocument()}var tS=class{constructor(e,t,n,i){this.tokenizer=e;this.createImmutableLists=i;if(n&&i)throw new Error("Not supported");this.oldNodeReader=n?new hg(n):void 0,this.positionMapper=new pg(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Zt.getEmpty(),0);return e||(e=ui.getEmpty()),e}parseList(e,t){let n=[];for(;;){let o=this.tryReadChildFromCache(e);if(!o){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;o=this.parseChild(e,t+1)}o.kind===4&&o.childrenLength===0||n.push(o)}return this.oldNodeReader?Z1(n):JC(n,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!Hl(t)){let n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),i=>t!==null&&!vo(i.length,t)?!1:i.canBeReused(e));if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}}parseChild(e,t){this._itemsConstructed++;let n=this.tokenizer.read();switch(n.kind){case 2:return new Jm(n.bracketIds,n.length);case 0:return n.astNode;case 1:{if(t>300)return new lr(n.length);let i=e.merge(n.bracketIds),o=this.parseList(i,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===n.bracketId||s.bracketIds.intersects(n.bracketIds))?(this.tokenizer.read(),Lc.create(n.astNode,o,s.astNode)):Lc.create(n.astNode,o,null)}default:throw new Error("unexpected")}}};function iS(r,e){if(r.length===0)return e;if(e.length===0)return r;let t=new Rn(X1(r)),n=X1(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=t.dequeue();function o(d){if(d===void 0){let c=t.takeWhile(p=>!0)||[];return i&&c.unshift(i),c}let u=[];for(;i&&!Hl(d);){let[c,p]=i.splitAt(d);u.push(c),d=pa(c.lengthAfter,d),i=p??t.dequeue()}return Hl(d)||u.push(new Nc(!1,d,d)),u}let s=[];function a(d,u,c){if(s.length>0&&AC(s[s.length-1].endOffset,d)){let p=s[s.length-1];s[s.length-1]=new fa(p.startOffset,u,et(p.newLength,c))}else s.push({startOffset:d,endOffset:u,newLength:c})}let l=Ft;for(let d of n){let u=o(d.lengthBefore);if(d.modified){let c=F1(u,h=>h.lengthBefore),p=et(l,c);a(l,p,d.lengthAfter),l=p}else for(let c of u){let p=l;l=et(l,c.lengthBefore),c.modified&&a(p,l,c.lengthAfter)}}return s}var Nc=class r{constructor(e,t,n){this.modified=e;this.lengthBefore=t;this.lengthAfter=n}splitAt(e){let t=pa(e,this.lengthAfter);return AC(t,Ft)?[this,void 0]:this.modified?[new r(this.modified,this.lengthBefore,e),new r(this.modified,Ft,t)]:[new r(this.modified,e,e),new r(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${vn(this.lengthBefore)} -> ${vn(this.lengthAfter)}`}};function X1(r){let e=[],t=Ft;for(let n of r){let i=pa(t,n.startOffset);Hl(i)||e.push(new Nc(!1,i,i));let o=pa(n.startOffset,n.endOffset);e.push(new Nc(!0,o,n.newLength)),t=n.endOffset}return e}var mg=class extends B{constructor(t,n){super();this.textModel=t;this.getLanguageConfiguration=n;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),o=new Zm(this.textModel.getValue(),i);this.initialAstWithoutTokens=nS(o,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new L;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new Vm;brackets=new Ym(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let n=t.map(i=>new fa(rt(i.fromLineNumber-1,0),rt(i.toLineNumber,0),rt(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(n,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let n=fa.fromModelContentChanges(t.changes);this.handleEdits(n,!1)}handleEdits(t,n){let i=iS(this.queuedTextEdits,t);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!n&&(this.queuedTextEditsForInitialAstWithoutTokens=iS(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,n,i){let s=n,a=new Qm(this.textModel,this.brackets);return nS(a,t,s,i)}getBracketsInRange(t,n){this.flushQueue();let i=rt(t.startLineNumber-1,t.startColumn-1),o=rt(t.endLineNumber-1,t.endColumn-1);return new ro(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;rS(a,Ft,a.length,i,o,s,0,0,new Map,n)})}getBracketPairsInRange(t,n){this.flushQueue();let i=os(t.getStartPosition()),o=os(t.getEndPosition());return new ro(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new oS(s,n,this.textModel);sS(a,Ft,a.length,i,o,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return t0(n,Ft,n.length,os(t))}getFirstBracketBefore(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return e0(n,Ft,n.length,os(t))}};function e0(r,e,t,n){if(r.kind===4||r.kind===2){let i=[];for(let o of r.children)t=et(e,o.length),i.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let o=i.length-1;o>=0;o--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=i[o];if(vo(s,n)){let l=e0(r.children[o],s,a,n);if(l)return l}}return null}else{if(r.kind===3)return null;if(r.kind===1){let i=ss(e,t);return{bracketInfo:r.bracketInfo,range:i}}}return null}function t0(r,e,t,n){if(r.kind===4||r.kind===2){for(let i of r.children){if(t=et(e,i.length),vo(n,t)){let o=t0(i,e,t,n);if(o)return o}e=t}return null}else{if(r.kind===3)return null;if(r.kind===1){let i=ss(e,t);return{bracketInfo:r.bracketInfo,range:i}}}return null}function rS(r,e,t,n,i,o,s,a,l,d,u=!1){if(s>200)return!0;e:for(;;)switch(r.kind){case 4:{let c=r.childrenLength;for(let p=0;p<c;p++){let h=r.getChild(p);if(h){if(t=et(e,h.length),rs(e,i)&&zl(t,n)){if(zl(t,i)){r=h;continue e}if(!rS(h,e,t,n,i,o,s,0,l,d))return!1}e=t}}return!0}case 2:{let c=!d||!r.closingBracket||r.closingBracket.bracketInfo.closesColorized(r.openingBracket.bracketInfo),p=0;if(l){let g=l.get(r.openingBracket.text);g===void 0&&(g=0),p=g,c&&(g++,l.set(r.openingBracket.text,g))}let h=r.childrenLength;for(let g=0;g<h;g++){let f=r.getChild(g);if(f){if(t=et(e,f.length),rs(e,i)&&zl(t,n)){if(zl(t,i)&&f.kind!==1){r=f,c?(s++,a=p+1):a=p;continue e}if((c||f.kind!==1||!r.closingBracket)&&!rS(f,e,t,n,i,o,c?s+1:s,c?p+1:p,l,d,!r.closingBracket))return!1}e=t}}return l?.set(r.openingBracket.text,p),!0}case 3:{let c=ss(e,t);return o(new Pc(c,s-1,0,!0))}case 1:{let c=ss(e,t);return o(new Pc(c,s-1,a-1,u))}case 0:return!0}}var oS=class{constructor(e,t,n){this.push=e;this.includeMinIndentation=t;this.textModel=n}};function sS(r,e,t,n,i,o,s,a){if(s>200)return!0;let l=!0;if(r.kind===2){let d=0;if(a){let p=a.get(r.openingBracket.text);p===void 0&&(p=0),d=p,p++,a.set(r.openingBracket.text,p)}let u=et(e,r.openingBracket.length),c=-1;if(o.includeMinIndentation&&(c=r.computeMinIndentation(e,o.textModel)),l=o.push(new eg(ss(e,t),ss(e,u),r.closingBracket?ss(et(u,r.child?.length||Ft),t):void 0,s,d,r,c)),e=u,l&&r.child){let p=r.child;if(t=et(e,p.length),rs(e,i)&&zl(t,n)&&(l=sS(p,e,t,n,i,o,s+1,a),!l))return!1}a?.set(r.openingBracket.text,d)}else{let d=e;for(let u of r.children){let c=d;if(d=et(d,u.length),rs(c,i)&&rs(n,d)&&(l=sS(u,c,d,n,i,o,s,a),!l))return!1}}return l}var fg=class extends B{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}bracketPairsTree=this._register(new Zn);onDidChangeEmitter=new L;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new We;this.bracketPairsTree.value=_M(t.add(new mg(this.textModel,n=>this.languageConfigurationService.getLanguageConfiguration(n))),t),t.add(this.bracketPairsTree.value.object.onDidChange(n=>this.onDidChangeEmitter.fire(n))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||ro.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||ro.empty}getBracketsInRange(t,n=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,n)||ro.empty}findMatchingBracketUp(t,n,i){let o=this.textModel.validatePosition(n),s=this.textModel.getLanguageIdAtPosition(o.lineNumber,o.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(_.fromPositions(n,n)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?gg(this._findMatchingBracketUp(d,o,aS(i))):null}}matchBracket(t,n){if(this.canBuildAST){let i=this.getBracketPairsInRange(_.fromPositions(t,t)).filter(o=>o.closingBracketRange!==void 0&&(o.openingBracketRange.containsPosition(t)||o.closingBracketRange.containsPosition(t))).findLastMaxBy(Rs(o=>o.openingBracketRange.containsPosition(t)?o.openingBracketRange:o.closingBracketRange,_.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{let i=aS(n);return this._matchBracket(this.textModel.validatePosition(t),i)}}_establishBracketSearchOffsets(t,n,i,o){let s=n.getCount(),a=n.getLanguageId(o),l=Math.max(0,t.column-1-i.maxBracketLength);for(let u=o-1;u>=0;u--){let c=n.getEndOffset(u);if(c<=l)break;if(Ni(n.getStandardTokenType(u))||n.getLanguageId(u)!==a){l=c;break}}let d=Math.min(n.getLineContent().length,t.column-1+i.maxBracketLength);for(let u=o+1;u<s;u++){let c=n.getStartOffset(u);if(c>=d)break;if(Ni(n.getStandardTokenType(u))||n.getLanguageId(u)!==a){d=c;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,n){let i=t.lineNumber,o=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),a=o.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(a)).brackets;if(l&&!Ni(o.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:u}=this._establishBracketSearchOffsets(t,o,l,a),c=null;for(;;){let p=En.findNextBracketInRange(l.forwardRegex,i,s,d,u);if(!p)break;if(p.startColumn<=t.column&&t.column<=p.endColumn){let h=s.substring(p.startColumn-1,p.endColumn-1).toLowerCase(),g=this._matchFoundBracket(p,l.textIsBracket[h],l.textIsOpenBracket[h],n);if(g){if(g instanceof Io)return null;c=g}}d=p.endColumn-1}if(c)return c}if(a>0&&o.getStartOffset(a)===t.column-1){let d=a-1,u=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(d)).brackets;if(u&&!Ni(o.getStandardTokenType(d))){let{searchStartOffset:c,searchEndOffset:p}=this._establishBracketSearchOffsets(t,o,u,d),h=En.findPrevBracketInRange(u.reversedRegex,i,s,c,p);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn){let g=s.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),f=this._matchFoundBracket(h,u.textIsBracket[g],u.textIsOpenBracket[g],n);if(f)return f instanceof Io?null:f}}}return null}_matchFoundBracket(t,n,i,o){if(!n)return null;let s=i?this._findMatchingBracketDown(n,t.getEndPosition(),o):this._findMatchingBracketUp(n,t.getStartPosition(),o);return s?s instanceof Io?s:[t,s]:null}_findMatchingBracketUp(t,n,i){let o=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(u,c,p,h)=>{for(;;){if(i&&++l%100===0&&!i())return Io.INSTANCE;let g=En.findPrevBracketInRange(s,u,c,p,h);if(!g)break;let f=c.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(f)?a++:t.isClose(f)&&a--,a===0)return g;h=g.startColumn-1}return null};for(let u=n.lineNumber;u>=1;u--){let c=this.textModel.tokenization.getLineTokens(u),p=c.getCount(),h=this.textModel.getLineContent(u),g=p-1,f=h.length,v=h.length;u===n.lineNumber&&(g=c.findTokenIndexAtOffset(n.column-1),f=n.column-1,v=n.column-1);let y=!0;for(;g>=0;g--){let I=c.getLanguageId(g)===o&&!Ni(c.getStandardTokenType(g));if(I)y?f=c.getStartOffset(g):(f=c.getStartOffset(g),v=c.getEndOffset(g));else if(y&&f!==v){let S=d(u,h,f,v);if(S)return S}y=I}if(y&&f!==v){let I=d(u,h,f,v);if(I)return I}}return null}_findMatchingBracketDown(t,n,i){let o=t.languageId,s=t.forwardRegex,a=1,l=0,d=(c,p,h,g)=>{for(;;){if(i&&++l%100===0&&!i())return Io.INSTANCE;let f=En.findNextBracketInRange(s,c,p,h,g);if(!f)break;let v=p.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(v)?a++:t.isClose(v)&&a--,a===0)return f;h=f.endColumn-1}return null},u=this.textModel.getLineCount();for(let c=n.lineNumber;c<=u;c++){let p=this.textModel.tokenization.getLineTokens(c),h=p.getCount(),g=this.textModel.getLineContent(c),f=0,v=0,y=0;c===n.lineNumber&&(f=p.findTokenIndexAtOffset(n.column-1),v=n.column-1,y=n.column-1);let I=!0;for(;f<h;f++){let S=p.getLanguageId(f)===o&&!Ni(p.getStandardTokenType(f));if(S)I||(v=p.getStartOffset(f)),y=p.getEndOffset(f);else if(I&&v!==y){let x=d(c,g,v,y);if(x)return x}I=S}if(I&&v!==y){let S=d(c,g,v,y);if(S)return S}}return null}findPrevBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(n)||null;let i=null,o=null,s=null;for(let a=n.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),u=this.textModel.getLineContent(a),c=d-1,p=u.length,h=u.length;if(a===n.lineNumber){c=l.findTokenIndexAtOffset(n.column-1),p=n.column-1,h=n.column-1;let f=l.getLanguageId(c);i!==f&&(i=f,o=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let g=!0;for(;c>=0;c--){let f=l.getLanguageId(c);if(i!==f){if(o&&s&&g&&p!==h){let y=En.findPrevBracketInRange(o.reversedRegex,a,u,p,h);if(y)return this._toFoundBracket(s,y);g=!1}i=f,o=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}let v=!!o&&!Ni(l.getStandardTokenType(c));if(v)g?p=l.getStartOffset(c):(p=l.getStartOffset(c),h=l.getEndOffset(c));else if(s&&o&&g&&p!==h){let y=En.findPrevBracketInRange(o.reversedRegex,a,u,p,h);if(y)return this._toFoundBracket(s,y)}g=v}if(s&&o&&g&&p!==h){let f=En.findPrevBracketInRange(o.reversedRegex,a,u,p,h);if(f)return this._toFoundBracket(s,f)}}return null}findNextBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(n)||null;let i=this.textModel.getLineCount(),o=null,s=null,a=null;for(let l=n.lineNumber;l<=i;l++){let d=this.textModel.tokenization.getLineTokens(l),u=d.getCount(),c=this.textModel.getLineContent(l),p=0,h=0,g=0;if(l===n.lineNumber){p=d.findTokenIndexAtOffset(n.column-1),h=n.column-1,g=n.column-1;let v=d.getLanguageId(p);o!==v&&(o=v,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew)}let f=!0;for(;p<u;p++){let v=d.getLanguageId(p);if(o!==v){if(a&&s&&f&&h!==g){let I=En.findNextBracketInRange(s.forwardRegex,l,c,h,g);if(I)return this._toFoundBracket(a,I);f=!1}o=v,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew}let y=!!s&&!Ni(d.getStandardTokenType(p));if(y)f||(h=d.getStartOffset(p)),g=d.getEndOffset(p);else if(a&&s&&f&&h!==g){let I=En.findNextBracketInRange(s.forwardRegex,l,c,h,g);if(I)return this._toFoundBracket(a,I)}f=y}if(a&&s&&f&&h!==g){let v=En.findNextBracketInRange(s.forwardRegex,l,c,h,g);if(v)return this._toFoundBracket(a,v)}}return null}findEnclosingBrackets(t,n){let i=this.textModel.validatePosition(t);if(this.canBuildAST){let g=_.fromPositions(i),f=this.getBracketPairsInRange(_.fromPositions(i,i)).findLast(v=>v.closingBracketRange!==void 0&&v.range.strictContainsRange(g));return f?[f.openingBracketRange,f.closingBracketRange]:null}let o=aS(n),s=this.textModel.getLineCount(),a=new Map,l=[],d=(g,f)=>{if(!a.has(g)){let v=[];for(let y=0,I=f?f.brackets.length:0;y<I;y++)v[y]=0;a.set(g,v)}l=a.get(g)},u=0,c=(g,f,v,y,I)=>{for(;;){if(o&&++u%100===0&&!o())return Io.INSTANCE;let S=En.findNextBracketInRange(g.forwardRegex,f,v,y,I);if(!S)break;let x=v.substring(S.startColumn-1,S.endColumn-1).toLowerCase(),T=g.textIsBracket[x];if(T&&(T.isOpen(x)?l[T.index]++:T.isClose(x)&&l[T.index]--,l[T.index]===-1))return this._matchFoundBracket(S,T,!1,o);y=S.endColumn-1}return null},p=null,h=null;for(let g=i.lineNumber;g<=s;g++){let f=this.textModel.tokenization.getLineTokens(g),v=f.getCount(),y=this.textModel.getLineContent(g),I=0,S=0,x=0;if(g===i.lineNumber){I=f.findTokenIndexAtOffset(i.column-1),S=i.column-1,x=i.column-1;let R=f.getLanguageId(I);p!==R&&(p=R,h=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,h))}let T=!0;for(;I<v;I++){let R=f.getLanguageId(I);if(p!==R){if(h&&T&&S!==x){let O=c(h,g,y,S,x);if(O)return gg(O);T=!1}p=R,h=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,h)}let P=!!h&&!Ni(f.getStandardTokenType(I));if(P)T||(S=f.getStartOffset(I)),x=f.getEndOffset(I);else if(h&&T&&S!==x){let O=c(h,g,y,S,x);if(O)return gg(O)}T=P}if(h&&T&&S!==x){let R=c(h,g,y,S,x);if(R)return gg(R)}}return null}_toFoundBracket(t,n){if(!n)return null;let i=this.textModel.getValueInRange(n);i=i.toLowerCase();let o=t.getBracketInfo(i);return o?{range:n,bracketInfo:o}:null}};function _M(r,e){return{object:r,dispose:()=>e?.dispose()}}function aS(r){if(typeof r>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=r}}var Io=class r{static INSTANCE=new r;_searchCanceledBrand=void 0;constructor(){}};function gg(r){return r instanceof Io?null:r}var lS=C("editor.lineHighlightBackground",null,m("lineHighlight","Background color for the highlight of line at the cursor position.")),dS=C("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:ke},m("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),kre=C("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},m("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),Rre=C("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:yt,hcLight:yt},m("rangeHighlightBorder","Background color of the border around highlighted ranges.")),Dre=C("editor.symbolHighlightBackground",{dark:nr,light:nr,hcDark:null,hcLight:null},m("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),Pre=C("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:yt,hcLight:yt},m("symbolHighlightBorder","Background color of the border around highlighted symbols.")),Ql=C("editorCursor.foreground",{dark:"#AEAFAD",light:A.black,hcDark:A.white,hcLight:"#0F4A85"},m("caret","Color of the editor cursor.")),bg=C("editorCursor.background",null,m("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),vg=C("editorMultiCursor.primary.foreground",Ql,m("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),n0=C("editorMultiCursor.primary.background",bg,m("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),yg=C("editorMultiCursor.secondary.foreground",Ql,m("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),i0=C("editorMultiCursor.secondary.background",bg,m("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),Ig=C("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},m("editorWhitespaces","Color of whitespace characters in the editor.")),r0=C("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:A.white,hcLight:"#292929"},m("editorLineNumbers","Color of editor line numbers.")),xM=C("editorIndentGuide.background",Ig,m("editorIndentGuides","Color of the editor indentation guides."),!1,m("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),EM=C("editorIndentGuide.activeBackground",Ig,m("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,m("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),o0=C("editorIndentGuide.background1",xM,m("editorIndentGuides1","Color of the editor indentation guides (1).")),s0=C("editorIndentGuide.background2","#00000000",m("editorIndentGuides2","Color of the editor indentation guides (2).")),a0=C("editorIndentGuide.background3","#00000000",m("editorIndentGuides3","Color of the editor indentation guides (3).")),l0=C("editorIndentGuide.background4","#00000000",m("editorIndentGuides4","Color of the editor indentation guides (4).")),d0=C("editorIndentGuide.background5","#00000000",m("editorIndentGuides5","Color of the editor indentation guides (5).")),u0=C("editorIndentGuide.background6","#00000000",m("editorIndentGuides6","Color of the editor indentation guides (6).")),c0=C("editorIndentGuide.activeBackground1",EM,m("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),p0=C("editorIndentGuide.activeBackground2","#00000000",m("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),h0=C("editorIndentGuide.activeBackground3","#00000000",m("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),m0=C("editorIndentGuide.activeBackground4","#00000000",m("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),g0=C("editorIndentGuide.activeBackground5","#00000000",m("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),f0=C("editorIndentGuide.activeBackground6","#00000000",m("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),wM=C("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:yt,hcLight:yt},m("editorActiveLineNumber","Color of editor active line number"),!1,m("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),Mre=C("editorLineNumber.activeForeground",wM,m("editorActiveLineNumber","Color of editor active line number")),b0=C("editorLineNumber.dimmedForeground",null,m("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),Ore=C("editorRuler.foreground",{dark:"#5A5A5A",light:A.lightgrey,hcDark:A.white,hcLight:"#292929"},m("editorRuler","Color of the editor rulers.")),Nre=C("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},m("editorCodeLensForeground","Foreground color of editor CodeLens")),Are=C("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},m("editorBracketMatchBackground","Background color behind matching brackets")),Fre=C("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:ke,hcLight:ke},m("editorBracketMatchBorder","Color for matching brackets boxes")),v0=C("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},m("editorOverviewRulerBorder","Color of the overview ruler border.")),y0=C("editorOverviewRuler.background",null,m("editorOverviewRulerBackground","Background color of the editor overview ruler.")),Wre=C("editorGutter.background",ta,m("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),Bre=C("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:A.fromHex("#fff").transparent(.8),hcLight:ke},m("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),I0=C("editorUnnecessaryCode.opacity",{dark:A.fromHex("#000a"),light:A.fromHex("#0007"),hcDark:null,hcLight:null},m("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),Vre=C("editorGhostText.border",{dark:null,light:null,hcDark:A.fromHex("#fff").transparent(.8),hcLight:A.fromHex("#292929").transparent(.8)},m("editorGhostTextBorder","Border color of ghost text in the editor.")),Ure=C("editorGhostText.foreground",{dark:A.fromHex("#ffffff56"),light:A.fromHex("#0007"),hcDark:null,hcLight:null},m("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),Hre=C("editorGhostText.background",null,m("editorGhostTextBackground","Background color of the ghost text in the editor.")),TM=new A(new xe(0,122,204,.6)),zre=C("editorOverviewRuler.rangeHighlightForeground",TM,m("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Kre=C("editorOverviewRuler.errorForeground",{dark:new A(new xe(255,18,18,.7)),light:new A(new xe(255,18,18,.7)),hcDark:new A(new xe(255,50,50,1)),hcLight:"#B5200D"},m("overviewRuleError","Overview ruler marker color for errors.")),Gre=C("editorOverviewRuler.warningForeground",{dark:Mi,light:Mi,hcDark:Tl,hcLight:Tl},m("overviewRuleWarning","Overview ruler marker color for warnings.")),jre=C("editorOverviewRuler.infoForeground",{dark:tr,light:tr,hcDark:Ll,hcLight:Ll},m("overviewRuleInfo","Overview ruler marker color for infos.")),Cg=C("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},m("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),Sg=C("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},m("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),_g=C("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},m("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),xg=C("editorBracketHighlight.foreground4","#00000000",m("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),Eg=C("editorBracketHighlight.foreground5","#00000000",m("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),wg=C("editorBracketHighlight.foreground6","#00000000",m("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),C0=C("editorBracketHighlight.unexpectedBracket.foreground",{dark:new A(new xe(255,18,18,.8)),light:new A(new xe(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},m("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),S0=C("editorBracketPairGuide.background1","#00000000",m("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),_0=C("editorBracketPairGuide.background2","#00000000",m("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),x0=C("editorBracketPairGuide.background3","#00000000",m("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),E0=C("editorBracketPairGuide.background4","#00000000",m("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),w0=C("editorBracketPairGuide.background5","#00000000",m("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),T0=C("editorBracketPairGuide.background6","#00000000",m("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),L0=C("editorBracketPairGuide.activeBackground1","#00000000",m("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),k0=C("editorBracketPairGuide.activeBackground2","#00000000",m("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),R0=C("editorBracketPairGuide.activeBackground3","#00000000",m("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),D0=C("editorBracketPairGuide.activeBackground4","#00000000",m("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),P0=C("editorBracketPairGuide.activeBackground5","#00000000",m("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),M0=C("editorBracketPairGuide.activeBackground6","#00000000",m("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),qre=C("editorUnicodeHighlight.border",Mi,m("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),$re=C("editorUnicodeHighlight.background",JT,m("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));xn((r,e)=>{let t=r.getColor(ta),n=r.getColor(lS),i=n&&!n.isTransparent()?n:t;i&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${i}; }`)});var Tg=class extends B{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(n=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new Lg;onDidChangeEmitter=new L;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,n,i,o){return o?[]:n===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,n){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new _(1,1,this.textModel.getLineCount(),1),t,n):[]}},Lg=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};xn((r,e)=>{let t=[Cg,Sg,_g,xg,Eg,wg],n=new Lg;e.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${r.getColor(C0)}; }`);let i=t.map(o=>r.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){let s=i[o%i.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(o)} { color: ${s}; }`)}});function Zl(r){return r.toString()}var Vn=class r{constructor(e,t,n,i,o,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=n;this.afterEOL=i;this.beforeCursorState=o;this.afterCursorState=s;this.changes=a}static create(e,t){let n=e.getAlternativeVersionId(),i=pS(e);return new r(n,n,i,i,t,t,[])}append(e,t,n,i,o){t.length>0&&(this.changes=E1(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=o}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,n){if(Gt(e,t?t.length:0,n),n+=4,t)for(let i of t)Gt(e,i.selectionStartLineNumber,n),n+=4,Gt(e,i.selectionStartColumn,n),n+=4,Gt(e,i.positionLineNumber,n),n+=4,Gt(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){let i=Kt(e,t);t+=4;for(let o=0;o<i;o++){let s=Kt(e,t);t+=4;let a=Kt(e,t);t+=4;let l=Kt(e,t);t+=4;let d=Kt(e,t);t+=4,n.push(new ye(s,a,l,d))}return t}serialize(){let e=10+r._writeSelectionsSize(this.beforeCursorState)+r._writeSelectionsSize(this.afterCursorState)+4;for(let i of this.changes)e+=i.writeSize();let t=new Uint8Array(e),n=0;Gt(t,this.beforeVersionId,n),n+=4,Gt(t,this.afterVersionId,n),n+=4,zh(t,this.beforeEOL,n),n+=1,zh(t,this.afterEOL,n),n+=1,n=r._writeSelections(t,this.beforeCursorState,n),n=r._writeSelections(t,this.afterCursorState,n),Gt(t,this.changes.length,n),n+=4;for(let i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){let t=new Uint8Array(e),n=0,i=Kt(t,n);n+=4;let o=Kt(t,n);n+=4;let s=Hh(t,n);n+=1;let a=Hh(t,n);n+=1;let l=[];n=r._readSelections(t,n,l);let d=[];n=r._readSelections(t,n,d);let u=Kt(t,n);n+=4;let c=[];for(let p=0;p<u;p++)n=oi.read(t,n,c);return new r(i,o,s,a,l,d,c)}},kg=class{constructor(e,t,n,i){this.label=e;this.code=t;this.model=n,this._data=Vn.create(n,i)}model;_data;get type(){return 0}get resource(){return ae.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof Vn?this._data:Vn.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(ae.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Vn}append(e,t,n,i,o){this._data instanceof Vn&&this._data.append(e,t,n,i,o)}close(){this._data instanceof Vn&&(this._data=this._data.serialize())}open(){this._data instanceof Vn||(this._data=Vn.deserialize(this._data))}undo(){if(ae.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Vn&&(this._data=this._data.serialize());let e=Vn.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(ae.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Vn&&(this._data=this._data.serialize());let e=Vn.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Vn&&(this._data=this._data.serialize()),this._data.byteLength+168}},cS=class{constructor(e,t,n){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=n.slice(0),this._editStackElementsMap=new Map;for(let i of this._editStackElementsArr){let o=Zl(i.resource);this._editStackElementsMap.set(o,i)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)ae.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=Zl(e);return this._editStackElementsMap.has(t)}setModel(e){let t=Zl(ae.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=Zl(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,n,i,o){let s=Zl(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=Zl(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${st(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function pS(r){return r.getEOL()===`
`?0:1}function uS(r){return r?r instanceof kg||r instanceof cS:!1}var Rg=class r{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);uS(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);uS(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let n=this._undoRedoService.getLastElement(this._model.uri);if(uS(n)&&n.canAppend(this._model))return n;let i=new kg(m("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(i,t),i}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],pS(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n,i){let o=this._getOrCreateEditStackElement(e,i),s=this._model.applyEdits(t,!0),a=r._computeCursorState(n,s),l=s.map((d,u)=>({index:u,textChange:d.textChange}));return l.sort((d,u)=>d.textChange.oldPosition===u.textChange.oldPosition?d.index-u.index:d.textChange.oldPosition-u.textChange.oldPosition),o.append(this._model,l.map(d=>d.textChange),pS(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return Le(n),null}}};var Xl=class extends B{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function O0(r,e){let t=0,n=0,i=r.length;for(;n<i;){let o=r.charCodeAt(n);if(o===32)t++;else if(o===9)t=t-t%e+e;else break;n++}return n===i?-1:t}var Dg=class extends Xl{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return O0(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,n,i){this.assertNotDisposed();let o=this.textModel.getLineCount();if(t<1||t>o)throw new Re("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,u=-2,c=-1,p=O=>{if(l!==-1&&(l===-2||l>O-1)){l=-1,d=-1;for(let k=O-2;k>=0;k--){let F=this._computeIndentLevel(k);if(F>=0){l=k,d=F;break}}}if(u===-2){u=-1,c=-1;for(let k=O;k<o;k++){let F=this._computeIndentLevel(k);if(F>=0){u=k,c=F;break}}}},h=-2,g=-1,f=-2,v=-1,y=O=>{if(h===-2){h=-1,g=-1;for(let k=O-2;k>=0;k--){let F=this._computeIndentLevel(k);if(F>=0){h=k,g=F;break}}}if(f!==-1&&(f===-2||f<O-1)){f=-1,v=-1;for(let k=O;k<o;k++){let F=this._computeIndentLevel(k);if(F>=0){f=k,v=F;break}}}},I=0,S=!0,x=0,T=!0,R=0,P=0;for(let O=0;S||T;O++){let k=t-O,F=t+O;O>1&&(k<1||k<n)&&(S=!1),O>1&&(F>o||F>i)&&(T=!1),O>5e4&&(S=!1,T=!1);let W=-1;if(S&&k>=1){let $=this._computeIndentLevel(k-1);$>=0?(u=k-1,c=$,W=Math.ceil($/this.textModel.getOptions().indentSize)):(p(k),W=this._getIndentLevelForWhitespaceLine(a,d,c))}let H=-1;if(T&&F<=o){let $=this._computeIndentLevel(F-1);$>=0?(h=F-1,g=$,H=Math.ceil($/this.textModel.getOptions().indentSize)):(y(F),H=this._getIndentLevelForWhitespaceLine(a,g,v))}if(O===0){P=W;continue}if(O===1){if(F<=o&&H>=0&&P+1===H){S=!1,I=F,x=F,R=H;continue}if(k>=1&&W>=0&&W-1===P){T=!1,I=k,x=k,R=W;continue}if(I=t,x=t,R=P,R===0)return{startLineNumber:I,endLineNumber:x,indent:R}}S&&(W>=R?I=k:S=!1),T&&(H>=R?x=F:T=!1)}return{startLineNumber:I,endLineNumber:x,indent:R}}getLinesBracketGuides(t,n,i,o){let s=[];for(let p=t;p<=n;p++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new _(t,1,n,this.textModel.getLineMaxColumn(n))).toArray(),d;if(i&&l.length>0){let p=(t<=i.lineNumber&&i.lineNumber<=n?l:this.textModel.bracketPairs.getBracketPairsInRange(_.fromPositions(i)).toArray()).filter(h=>_.strictContainsPosition(h.range,i));d=LE(p,h=>a||h.range.startLineNumber!==h.range.endLineNumber)?.range}let u=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,c=new Ac;for(let p of l){if(!p.closingBracketRange)continue;let h=d&&p.range.equalsRange(d);if(!h&&!o.includeInactive)continue;let g=c.getInlineClassName(p.nestingLevel,p.nestingLevelOfEqualBracketType,u)+(o.highlightActive&&h?" "+c.activeClassName:""),f=p.openingBracketRange.getStartPosition(),v=p.closingBracketRange.getStartPosition(),y=o.horizontalGuides===2||o.horizontalGuides===1&&h;if(p.range.startLineNumber===p.range.endLineNumber){a&&y&&s[p.range.startLineNumber-t].push(new Ai(-1,p.openingBracketRange.getEndPosition().column,g,new yo(!1,v.column),-1,-1));continue}let I=this.getVisibleColumnFromPosition(v),S=this.getVisibleColumnFromPosition(p.openingBracketRange.getStartPosition()),x=Math.min(S,I,p.minVisibleColumnIndentation+1),T=!1;gt(this.textModel.getLineContent(p.closingBracketRange.startLineNumber))<p.closingBracketRange.startColumn-1&&(T=!0);let O=Math.max(f.lineNumber,t),k=Math.min(v.lineNumber,n),F=T?1:0;for(let W=O;W<k+F;W++)s[W-t].push(new Ai(x,-1,g,null,W===f.lineNumber?f.column:-1,W===v.lineNumber?v.column:-1));y&&(f.lineNumber>=t&&S>x&&s[f.lineNumber-t].push(new Ai(x,-1,g,new yo(!1,f.column),-1,-1)),v.lineNumber<=n&&I>x&&s[v.lineNumber-t].push(new Ai(x,-1,g,new yo(!T,v.column),-1,-1)))}for(let p of s)p.sort((h,g)=>h.visibleColumn-g.visibleColumn);return s}getVisibleColumnFromPosition(t){return Ye.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,n){this.assertNotDisposed();let i=this.textModel.getLineCount();if(t<1||t>i)throw new Error("Illegal value for startLineNumber");if(n<1||n>i)throw new Error("Illegal value for endLineNumber");let o=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(n-t+1),d=-2,u=-1,c=-2,p=-1;for(let h=t;h<=n;h++){let g=h-t,f=this._computeIndentLevel(h-1);if(f>=0){d=h-1,u=f,l[g]=Math.ceil(f/o.indentSize);continue}if(d===-2){d=-1,u=-1;for(let v=h-2;v>=0;v--){let y=this._computeIndentLevel(v);if(y>=0){d=v,u=y;break}}}if(c!==-1&&(c===-2||c<h-1)){c=-1,p=-1;for(let v=h;v<i;v++){let y=this._computeIndentLevel(v);if(y>=0){c=v,p=y;break}}}l[g]=this._getIndentLevelForWhitespaceLine(a,u,p)}return l}_getIndentLevelForWhitespaceLine(t,n,i){let o=this.textModel.getOptions();return n===-1||i===-1?0:n<i?1+Math.floor(n/o.indentSize):n===i||t?Math.ceil(i/o.indentSize):1+Math.floor(i/o.indentSize)}},Ac=class{activeClassName="indent-active";getInlineClassName(e,t,n){return this.getInlineClassNameOfLevel(n?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var hS=class{spacesDiff=0;looksLikeAlignment=!1};function RM(r,e,t,n,i){i.spacesDiff=0,i.looksLikeAlignment=!1;let o;for(o=0;o<e&&o<n;o++){let p=r.charCodeAt(o),h=t.charCodeAt(o);if(p!==h)break}let s=0,a=0;for(let p=o;p<e;p++)r.charCodeAt(p)===32?s++:a++;let l=0,d=0;for(let p=o;p<n;p++)t.charCodeAt(p)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let u=Math.abs(a-d),c=Math.abs(s-l);if(u===0){i.spacesDiff=c,c>0&&0<=l-1&&l-1<r.length&&l<t.length&&t.charCodeAt(l)!==32&&r.charCodeAt(l-1)===32&&r.charCodeAt(r.length-1)===44&&(i.looksLikeAlignment=!0);return}if(c%u===0){i.spacesDiff=c/u;return}}function mS(r,e,t){let n=Math.min(r.getLineCount(),1e4),i=0,o=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,u=[0,0,0,0,0,0,0,0,0],c=new hS;for(let g=1;g<=n;g++){let f=r.getLineLength(g),v=r.getLineContent(g),y=f<=65536,I=!1,S=0,x=0,T=0;for(let P=0,O=f;P<O;P++){let k=y?v.charCodeAt(P):r.getLineCharCode(g,P);if(k===9)T++;else if(k===32)x++;else{I=!0,S=P;break}}if(!I||(T>0?i++:x>1&&o++,RM(s,a,v,S,c),c.looksLikeAlignment&&!(t&&e===c.spacesDiff)))continue;let R=c.spacesDiff;R<=d&&u[R]++,s=v,a=S}let p=t;i!==o&&(p=i<o);let h=e;if(p){let g=p?0:.1*n;l.forEach(f=>{let v=u[f];v>g&&(g=v,h=f)}),h===4&&u[4]>0&&u[2]>0&&u[2]>=u[4]/2&&(h=2)}return{insertSpaces:p,tabSize:h}}function wn(r){return(r.metadata&1)>>>0}function Qe(r,e){r.metadata=r.metadata&254|e<<0}function qt(r){return(r.metadata&2)>>>1===1}function qe(r,e){r.metadata=r.metadata&253|(e?1:0)<<1}function H0(r){return(r.metadata&4)>>>2===1}function N0(r,e){r.metadata=r.metadata&251|(e?1:0)<<2}function z0(r){return(r.metadata&64)>>>6===1}function A0(r,e){r.metadata=r.metadata&191|(e?1:0)<<6}function DM(r){return(r.metadata&24)>>>3}function F0(r,e){r.metadata=r.metadata&231|e<<3}function PM(r){return(r.metadata&32)>>>5===1}function W0(r,e){r.metadata=r.metadata&223|(e?1:0)<<5}var Bc=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,Qe(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,N0(this,!1),A0(this,!1),F0(this,1),W0(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,qe(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;N0(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),A0(this,this.options.glyphMarginClassName!==null),F0(this,this.options.stickiness),W0(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},Ce=new Bc(null,0,0);Ce.parent=Ce;Ce.left=Ce;Ce.right=Ce;Qe(Ce,0);var ed=class{root;requestNormalizeDelta;constructor(){this.root=Ce,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,o,s){return this.root===Ce?[]:BM(this,e,t,n,i,o,s)}search(e,t,n,i){return this.root===Ce?[]:B0(this,e,t,n,i)}collectNodesFromOwner(e){return FM(this,e)}collectNodesPostOrder(){return WM(this)}insert(e){V0(this,e),this._normalizeDeltaIfNecessary()}delete(e){U0(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let n=e,i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;let o=n.start+i,s=n.end+i;n.setCachedOffsets(o,s,t)}acceptReplace(e,t,n,i){let o=NM(this,e,e+t);for(let s=0,a=o.length;s<a;s++){let l=o[s];U0(this,l)}this._normalizeDeltaIfNecessary(),AM(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,a=o.length;s<a;s++){let l=o[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,OM(l,e,e+t,n,i),l.maxEnd=l.end,V0(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return B0(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,MM(this))}};function MM(r){let e=r.root,t=0;for(;e!==Ce;){if(e.left!==Ce&&!qt(e.left)){e=e.left;continue}if(e.right!==Ce&&!qt(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Co(e),qe(e,!0),qe(e.left,!1),qe(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}qe(r.root,!1)}function Jl(r,e,t,n){return r<t?!0:r>t||n===1?!1:n===2?!0:e}function OM(r,e,t,n,i){let o=DM(r),s=o===0||o===2,a=o===1||o===2,l=t-e,d=n,u=Math.min(l,d),c=r.start,p=!1,h=r.end,g=!1;e<=c&&h<=t&&PM(r)&&(r.start=e,p=!0,r.end=e,g=!0);{let v=i?1:l>0?2:0;!p&&Jl(c,s,e,v)&&(p=!0),!g&&Jl(h,a,e,v)&&(g=!0)}if(u>0&&!i){let v=l>d?2:0;!p&&Jl(c,s,e+u,v)&&(p=!0),!g&&Jl(h,a,e+u,v)&&(g=!0)}{let v=i?1:0;!p&&Jl(c,s,t,v)&&(r.start=e+d,p=!0),!g&&Jl(h,a,t,v)&&(r.end=e+d,g=!0)}let f=d-l;p||(r.start=Math.max(0,c+f)),g||(r.end=Math.max(0,h+f)),r.start>r.end&&(r.end=r.start)}function NM(r,e,t){let n=r.root,i=0,o=0,s=0,a=0,l=[],d=0;for(;n!==Ce;){if(qt(n)){qe(n.left,!1),qe(n.right,!1),n===n.parent.right&&(i-=n.parent.delta),n=n.parent;continue}if(!qt(n.left)){if(o=i+n.maxEnd,o<e){qe(n,!0);continue}if(n.left!==Ce){n=n.left;continue}}if(s=i+n.start,s>t){qe(n,!0);continue}if(a=i+n.end,a>=e&&(n.setCachedOffsets(s,a,0),l[d++]=n),qe(n,!0),n.right!==Ce&&!qt(n.right)){i+=n.delta,n=n.right;continue}}return qe(r.root,!1),l}function AM(r,e,t,n){let i=r.root,o=0,s=0,a=0,l=n-(t-e);for(;i!==Ce;){if(qt(i)){qe(i.left,!1),qe(i.right,!1),i===i.parent.right&&(o-=i.parent.delta),Co(i),i=i.parent;continue}if(!qt(i.left)){if(s=o+i.maxEnd,s<e){qe(i,!0);continue}if(i.left!==Ce){i=i.left;continue}}if(a=o+i.start,a>t){i.start+=l,i.end+=l,i.delta+=l,(i.delta<-1073741824||i.delta>1073741824)&&(r.requestNormalizeDelta=!0),qe(i,!0);continue}if(qe(i,!0),i.right!==Ce&&!qt(i.right)){o+=i.delta,i=i.right;continue}}qe(r.root,!1)}function FM(r,e){let t=r.root,n=[],i=0;for(;t!==Ce;){if(qt(t)){qe(t.left,!1),qe(t.right,!1),t=t.parent;continue}if(t.left!==Ce&&!qt(t.left)){t=t.left;continue}if(t.ownerId===e&&(n[i++]=t),qe(t,!0),t.right!==Ce&&!qt(t.right)){t=t.right;continue}}return qe(r.root,!1),n}function WM(r){let e=r.root,t=[],n=0;for(;e!==Ce;){if(qt(e)){qe(e.left,!1),qe(e.right,!1),e=e.parent;continue}if(e.left!==Ce&&!qt(e.left)){e=e.left;continue}if(e.right!==Ce&&!qt(e.right)){e=e.right;continue}t[n++]=e,qe(e,!0)}return qe(r.root,!1),t}function B0(r,e,t,n,i){let o=r.root,s=0,a=0,l=0,d=[],u=0;for(;o!==Ce;){if(qt(o)){qe(o.left,!1),qe(o.right,!1),o===o.parent.right&&(s-=o.parent.delta),o=o.parent;continue}if(o.left!==Ce&&!qt(o.left)){o=o.left;continue}a=s+o.start,l=s+o.end,o.setCachedOffsets(a,l,n);let c=!0;if(e&&o.ownerId&&o.ownerId!==e&&(c=!1),t&&H0(o)&&(c=!1),i&&!z0(o)&&(c=!1),c&&(d[u++]=o),qe(o,!0),o.right!==Ce&&!qt(o.right)){s+=o.delta,o=o.right;continue}}return qe(r.root,!1),d}function BM(r,e,t,n,i,o,s){let a=r.root,l=0,d=0,u=0,c=0,p=[],h=0;for(;a!==Ce;){if(qt(a)){qe(a.left,!1),qe(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!qt(a.left)){if(d=l+a.maxEnd,d<e){qe(a,!0);continue}if(a.left!==Ce){a=a.left;continue}}if(u=l+a.start,u>t){qe(a,!0);continue}if(c=l+a.end,c>=e){a.setCachedOffsets(u,c,o);let g=!0;n&&a.ownerId&&a.ownerId!==n&&(g=!1),i&&H0(a)&&(g=!1),s&&!z0(a)&&(g=!1),g&&(p[h++]=a)}if(qe(a,!0),a.right!==Ce&&!qt(a.right)){l+=a.delta,a=a.right;continue}}return qe(r.root,!1),p}function V0(r,e){if(r.root===Ce)return e.parent=Ce,e.left=Ce,e.right=Ce,Qe(e,0),r.root=e,r.root;VM(r,e),us(e.parent);let t=e;for(;t!==r.root&&wn(t.parent)===1;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;wn(n)===1?(Qe(t.parent,0),Qe(n,0),Qe(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Fc(r,t)),Qe(t.parent,0),Qe(t.parent.parent,1),Wc(r,t.parent.parent))}else{let n=t.parent.parent.left;wn(n)===1?(Qe(t.parent,0),Qe(n,0),Qe(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,Wc(r,t)),Qe(t.parent,0),Qe(t.parent.parent,1),Fc(r,t.parent.parent))}return Qe(r.root,0),e}function VM(r,e){let t=0,n=r.root,i=e.start,o=e.end;for(;;)if(HM(i,o,n.start+t,n.end+t)<0)if(n.left===Ce){e.start-=t,e.end-=t,e.maxEnd-=t,n.left=e;break}else n=n.left;else if(n.right===Ce){e.start-=t+n.delta,e.end-=t+n.delta,e.maxEnd-=t+n.delta,n.right=e;break}else t+=n.delta,n=n.right;e.parent=n,e.left=Ce,e.right=Ce,Qe(e,1)}function U0(r,e){let t,n;if(e.left===Ce?(t=e.right,n=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Ce?(t=e.left,n=e):(n=UM(e.right),t=n.right,t.start+=n.delta,t.end+=n.delta,t.delta+=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),n.start+=e.delta,n.end+=e.delta,n.delta=e.delta,(n.delta<-1073741824||n.delta>1073741824)&&(r.requestNormalizeDelta=!0)),n===r.root){r.root=t,Qe(t,0),e.detach(),gS(),Co(t),r.root.parent=Ce;return}let i=wn(n)===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?t.parent=n.parent:(n.parent===e?t.parent=n:t.parent=n.parent,n.left=e.left,n.right=e.right,n.parent=e.parent,Qe(n,wn(e)),e===r.root?r.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Ce&&(n.left.parent=n),n.right!==Ce&&(n.right.parent=n)),e.detach(),i){us(t.parent),n!==e&&(us(n),us(n.parent)),gS();return}us(t),us(t.parent),n!==e&&(us(n),us(n.parent));let o;for(;t!==r.root&&wn(t)===0;)t===t.parent.left?(o=t.parent.right,wn(o)===1&&(Qe(o,0),Qe(t.parent,1),Fc(r,t.parent),o=t.parent.right),wn(o.left)===0&&wn(o.right)===0?(Qe(o,1),t=t.parent):(wn(o.right)===0&&(Qe(o.left,0),Qe(o,1),Wc(r,o),o=t.parent.right),Qe(o,wn(t.parent)),Qe(t.parent,0),Qe(o.right,0),Fc(r,t.parent),t=r.root)):(o=t.parent.left,wn(o)===1&&(Qe(o,0),Qe(t.parent,1),Wc(r,t.parent),o=t.parent.left),wn(o.left)===0&&wn(o.right)===0?(Qe(o,1),t=t.parent):(wn(o.left)===0&&(Qe(o.right,0),Qe(o,1),Fc(r,o),o=t.parent.left),Qe(o,wn(t.parent)),Qe(t.parent,0),Qe(o.left,0),Wc(r,t.parent),t=r.root));Qe(t,0),gS()}function UM(r){for(;r.left!==Ce;)r=r.left;return r}function gS(){Ce.parent=Ce,Ce.delta=0,Ce.start=0,Ce.end=0}function Fc(r,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Ce&&(t.left.parent=e),t.parent=e.parent,e.parent===Ce?r.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Co(e),Co(t)}function Wc(r,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Ce&&(t.right.parent=e),t.parent=e.parent,e.parent===Ce?r.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Co(e),Co(t)}function K0(r){let e=r.end;if(r.left!==Ce){let t=r.left.maxEnd;t>e&&(e=t)}if(r.right!==Ce){let t=r.right.maxEnd+r.delta;t>e&&(e=t)}return e}function Co(r){r.maxEnd=K0(r)}function us(r){for(;r!==Ce;){let e=K0(r);if(r.maxEnd===e)return;r.maxEnd=e,r=r.parent}}function HM(r,e,t,n){return r===t?e-n:r-t}var td=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==ue)return Mg(this.right);let e=this;for(;e.parent!==ue&&e.parent.left!==e;)e=e.parent;return e.parent===ue?ue:e.parent}prev(){if(this.left!==ue)return bS(this.left);let e=this;for(;e.parent!==ue&&e.parent.right!==e;)e=e.parent;return e.parent===ue?ue:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var ue=new td(null,0);ue.parent=ue;ue.left=ue;ue.right=ue;ue.color=0;function Mg(r){for(;r.left!==ue;)r=r.left;return r}function bS(r){for(;r.right!==ue;)r=r.right;return r}function vS(r){return r===ue?0:r.size_left+r.piece.length+vS(r.right)}function yS(r){return r===ue?0:r.lf_left+r.piece.lineFeedCnt+yS(r.right)}function fS(){ue.parent=ue}function Uc(r,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==ue&&(t.left.parent=e),t.parent=e.parent,e.parent===ue?r.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Hc(r,e){let t=e.left;e.left=t.right,t.right!==ue&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===ue?r.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function zc(r,e){let t,n;if(e.left===ue?(n=e,t=n.right):e.right===ue?(n=e,t=n.left):(n=Mg(e.right),t=n.right),n===r.root){r.root=t,t.color=0,e.detach(),fS(),r.root.parent=ue;return}let i=n.color===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,Vc(r,t)):(n.parent===e?t.parent=n:t.parent=n.parent,Vc(r,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===r.root?r.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==ue&&(n.left.parent=n),n.right!==ue&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,Vc(r,n)),e.detach(),t.parent.left===t){let s=vS(t),a=yS(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,Hr(r,t.parent,l,d)}}if(Vc(r,t.parent),i){fS();return}let o;for(;t!==r.root&&t.color===0;)t===t.parent.left?(o=t.parent.right,o.color===1&&(o.color=0,t.parent.color=1,Uc(r,t.parent),o=t.parent.right),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.right.color===0&&(o.left.color=0,o.color=1,Hc(r,o),o=t.parent.right),o.color=t.parent.color,t.parent.color=0,o.right.color=0,Uc(r,t.parent),t=r.root)):(o=t.parent.left,o.color===1&&(o.color=0,t.parent.color=1,Hc(r,t.parent),o=t.parent.left),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.left.color===0&&(o.right.color=0,o.color=1,Uc(r,o),o=t.parent.left),o.color=t.parent.color,t.parent.color=0,o.left.color=0,Hc(r,t.parent),t=r.root));t.color=0,fS()}function IS(r,e){for(Vc(r,e);e!==r.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Uc(r,e)),e.parent.color=0,e.parent.parent.color=1,Hc(r,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Hc(r,e)),e.parent.color=0,e.parent.parent.color=1,Uc(r,e.parent.parent))}r.root.color=0}function Hr(r,e,t,n){for(;e!==r.root&&e!==ue;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function Vc(r,e){let t=0,n=0;if(e!==r.root){for(;e!==r.root&&e===e.parent.right;)e=e.parent;if(e!==r.root)for(e=e.parent,t=vS(e.left)-e.size_left,n=yS(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==r.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}var zM=999,So=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=KM(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=yh(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new sg(t,this.wordSeparators?Wr(this.wordSeparators,[]):null,n?this.searchString:null)}};function KM(r){if(!r||r.length===0)return!1;for(let e=0,t=r.length;e<t;e++){let n=r.charCodeAt(e);if(n===10)return!0;if(n===92){if(e++,e>=t)break;let i=r.charCodeAt(e);if(i===110||i===114||i===87)return!0}}return!1}function cs(r,e,t){if(!t)return new ls(r,null);let n=[];for(let i=0,o=e.length;i<o;i++)n[i]=e[i];return new ls(r,n)}var Og=class{_lineFeedsOffsets;constructor(e){let t=[],n=0;for(let i=0,o=e.length;i<o;i++)e.charCodeAt(i)===10&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,n=0,i=t.length-1;if(i===-1||e<=t[0])return 0;for(;n<i;){let o=n+((i-n)/2>>0);t[o]>=e?i=o-1:t[o+1]>=e?(n=o,i=o):n=o+1}return n+1}},ba=class{static findMatches(e,t,n,i,o){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,n,new ps(s.wordSeparators,s.regex),i,o):this._doFindMatchesLineByLine(e,n,s,i,o):[]}static _getMultilineMatchRange(e,t,n,i,o,s){let a,l=0;i?(l=i.findLineFeedCountBeforeOffset(o),a=t+o+l):a=t+o;let d;if(i){let h=i.findLineFeedCountBeforeOffset(o+s.length)-l;d=a+s.length+h}else d=a+s.length;let u=e.getPositionAt(a),c=e.getPositionAt(d);return new _(u.lineNumber,u.column,c.lineNumber,c.column)}static _doFindMatchesMultiline(e,t,n,i,o){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new Og(a):null,d=[],u=0,c;for(n.reset(0);c=n.next(a);)if(d[u++]=cs(this._getMultilineMatchRange(e,s,a,l,c.index,c[0]),c,i),u>=o)return d;return d}static _doFindMatchesLineByLine(e,t,n,i,o){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(n,d,t.startLineNumber,t.startColumn-1,a,s,i,o),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(n,l,t.startLineNumber,t.startColumn-1,a,s,i,o);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<o;d++)a=this._findMatchesInLine(n,e.getLineContent(d),d,0,a,s,i,o);if(a<o){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(n,d,t.endLineNumber,0,a,s,i,o)}return s}static _findMatchesInLine(e,t,n,i,o,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let p=e.simpleSearch,h=p.length,g=t.length,f=-h;for(;(f=t.indexOf(p,f+h))!==-1;)if((!d||Ng(d,t,g,f,h))&&(s[o++]=new ls(new _(n,f+1+i,n,f+1+h+i),null),o>=l))return o;return o}let u=new ps(e.wordSeparators,e.regex),c;u.reset(0);do if(c=u.next(t),c&&(s[o++]=cs(new _(n,c.index+1+i,n,c.index+1+c[0].length+i),c,a),o>=l))return o;while(c);return o}static findNextMatch(e,t,n,i){let o=t.parseSearchRequest();if(!o)return null;let s=new ps(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(e,n,s,i):this._doFindNextMatchLineByLine(e,n,s,i)}static _doFindNextMatchMultiline(e,t,n,i){let o=new w(t.lineNumber,1),s=e.getOffsetAt(o),a=e.getLineCount(),l=e.getValueInRange(new _(o.lineNumber,o.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new Og(l):null;n.reset(t.column-1);let u=n.next(l);return u?cs(this._getMultilineMatchRange(e,s,l,d,u.index,u[0]),u,i):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new w(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){let o=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(n,a,s,t.column,i);if(l)return l;for(let d=1;d<=o;d++){let u=(s+d-1)%o,c=e.getLineContent(u+1),p=this._findFirstMatchInLine(n,c,u+1,1,i);if(p)return p}return null}static _findFirstMatchInLine(e,t,n,i,o){e.reset(i-1);let s=e.next(t);return s?cs(new _(n,s.index+1,n,s.index+1+s[0].length),s,o):null}static findPreviousMatch(e,t,n,i){let o=t.parseSearchRequest();if(!o)return null;let s=new ps(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(e,n,s,i):this._doFindPreviousMatchLineByLine(e,n,s,i)}static _doFindPreviousMatchMultiline(e,t,n,i){let o=this._doFindMatchesMultiline(e,new _(1,1,t.lineNumber,t.column),n,i,10*zM);if(o.length>0)return o[o.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new w(s,e.getLineMaxColumn(s)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){let o=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(n,a,s,i);if(l)return l;for(let d=1;d<=o;d++){let u=(o+s-d-1)%o,c=e.getLineContent(u+1),p=this._findLastMatchInLine(n,c,u+1,i);if(p)return p}return null}static _findLastMatchInLine(e,t,n,i){let o=null,s;for(e.reset(0);s=e.next(t);)o=cs(new _(n,s.index+1,n,s.index+1+s[0].length),s,i);return o}};function GM(r,e,t,n,i){if(n===0)return!0;let o=e.charCodeAt(n-1);if(r.get(o)!==0||o===13||o===10)return!0;if(i>0){let s=e.charCodeAt(n);if(r.get(s)!==0)return!0}return!1}function jM(r,e,t,n,i){if(n+i===t)return!0;let o=e.charCodeAt(n+i);if(r.get(o)!==0||o===13||o===10)return!0;if(i>0){let s=e.charCodeAt(n+i-1);if(r.get(s)!==0)return!0}return!1}function Ng(r,e,t,n,i){return GM(r,e,t,n,i)&&jM(r,e,t,n,i)}var ps=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let i=n.index,o=n[0].length;if(i===this._prevMatchStartIndex&&o===this._prevMatchLength){if(o===0){gl(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=o,!this._wordSeparators||Ng(this._wordSeparators,e,t,i,o))return n}while(n);return null}};var _o=65535;function G0(r){let e;return r[r.length-1]<65536?e=new Uint16Array(r.length):e=new Uint32Array(r.length),e.set(r,0),e}var SS=class{constructor(e,t,n,i,o){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=o}};function zr(r,e=!0){let t=[0],n=1;for(let i=0,o=r.length;i<o;i++){let s=r.charCodeAt(i);s===13?i+1<o&&r.charCodeAt(i+1)===10?(t[n++]=i+2,i++):t[n++]=i+1:s===10&&(t[n++]=i+1)}return e?G0(t):t}function j0(r,e){r.length=0,r[0]=0;let t=1,n=0,i=0,o=0,s=!0;for(let l=0,d=e.length;l<d;l++){let u=e.charCodeAt(l);u===13?l+1<d&&e.charCodeAt(l+1)===10?(o++,r[t++]=l+2,l++):(n++,r[t++]=l+1):u===10?(i++,r[t++]=l+1):s&&u!==9&&(u<32||u>126)&&(s=!1)}let a=new SS(G0(r),n,i,o,s);return r.length=0,a}var yn=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,n,i,o){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=o}},Kr=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},_S=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==ue&&e.iterate(e.root,n=>(n!==ue&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},xS=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let o=n[i];if(o.node.parent===null||o.nodeStartOffset>=e){n[i]=null,t=!0;continue}}if(t){let i=[];for(let o of n)o!==null&&i.push(o);this._cache=i}}},Ag=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new Kr("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=ue,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let o=0,s=e.length;o<s;o++)if(e[o].buffer.length>0){e[o].lineStarts||(e[o].lineStarts=zr(e[o].buffer));let a=new yn(o+1,{line:0,column:0},{line:e[o].lineStarts.length-1,column:e[o].buffer.length-e[o].lineStarts[e[o].lineStarts.length-1]},e[o].lineStarts.length-1,e[o].buffer.length);this._buffers.push(e[o]),i=this.rbInsertRight(i,a)}this._searchCache=new xS(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=_o,n=t-Math.floor(t/3),i=n*2,o="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),u=d.length;if(s<=n||s+u<i)return o+=d,s+=u,!0;let c=o.replace(/\r\n|\r|\n/g,e);return a.push(new Kr(c,zr(c))),o=d,s=u,!0}),s>0){let l=o.replace(/\r\n|\r|\n/g,e);a.push(new Kr(l,zr(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new _S(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,i=>{if(i===ue)return!0;let o=this.getNodeContent(i),s=o.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,o===d})}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==ue;)if(i.left!==ue&&i.lf_left+1>=e)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let o=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=o+t-1}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==ue;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let o=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+o.index,o.index===0){let s=this.getOffsetAt(n+1,1),a=i-s;return new w(n+1,a+1)}return new w(n+1,o.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===ue){let o=this.getOffsetAt(n+1,1),s=i-e-o;return new w(n+1,s+1)}else t=t.right;return new w(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),o=this.getValueInRange2(n,i);return t?t!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,t):o}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,o=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),s=i.substring(o+e.remainder,o+n.piece.length);for(n=n.next();n!==ue;){let a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,n.piece.length);n=n.next()}return s}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,o=>{if(o===ue)return!0;let s=o.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,u=s.start.line,c=s.end.line,p=d[u]+s.start.column;if(i&&(l.charCodeAt(p)===10&&(p++,a--),e[t++]=n,n="",i=!1,a===0))return!0;if(u===c)return!this._EOLNormalized&&l.charCodeAt(p+a-1)===13?(i=!0,n+=l.substr(p,a-1)):n+=l.substr(p,a),!0;n+=this._EOLNormalized?l.substring(p,Math.max(p,d[u+1]-this._EOLLength)):l.substring(p,d[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let h=u+1;h<c;h++)n=this._EOLNormalized?l.substring(d[h],d[h+1]-this._EOLLength):l.substring(d[h],d[h+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(d[c]+s.end.column-1)===13?(i=!0,s.end.column===0?t--:n=l.substr(d[c],s.end.column-1)):n=l.substr(d[c],s.end.column),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{let t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let n=t.node.next();if(!n||n===ue)return"";let i=this._buffers[n.piece.bufferIndex],o=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(o,o+n.piece.length)}else{let n=this._buffers[t.node.piece.bufferIndex],i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),o=i+t.remainder,s=i+t.node.piece.length;return n.buffer.substring(o,s)}}findMatchesInNode(e,t,n,i,o,s,a,l,d,u,c){let p=this._buffers[e.piece.bufferIndex],h=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,o),f=this.offsetInBuffer(e.piece.bufferIndex,s),v,y={line:0,column:0},I,S;t._wordSeparators?(I=p.buffer.substring(g,f),S=x=>x+g,t.reset(0)):(I=p.buffer,S=x=>x,t.reset(g));do if(v=t.next(I),v){if(S(v.index)>=f)return u;this.positionInBuffer(e,S(v.index)-h,y);let x=this.getLineFeedCnt(e.piece.bufferIndex,o,y),T=y.line===o.line?y.column-o.column+i:y.column+1,R=T+v[0].length;if(c[u++]=cs(new _(n+x,T,n+x,R),v,l),S(v.index)+v[0].length>=f||u>=d)return u}while(v);return u}findMatchesLineByLine(e,t,n,i){let o=[],s=0,a=new ps(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let u=this.positionInBuffer(l.node,l.remainder),c=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,u,c,t,n,i,s,o),o;let p=e.startLineNumber,h=l.node;for(;h!==d.node;){let f=this.getLineFeedCnt(h.piece.bufferIndex,u,h.piece.end);if(f>=1){let y=this._buffers[h.piece.bufferIndex].lineStarts,I=this.offsetInBuffer(h.piece.bufferIndex,h.piece.start),S=y[u.line+f],x=p===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(h,a,p,x,u,this.positionInBuffer(h,S-I),t,n,i,s,o),s>=i)return o;p+=f}let v=p===e.startLineNumber?e.startColumn-1:0;if(p===e.endLineNumber){let y=this.getLineContent(p).substring(v,e.endColumn-1);return s=this._findMatchesInLine(t,a,y,e.endLineNumber,v,s,o,n,i),o}if(s=this._findMatchesInLine(t,a,this.getLineContent(p).substr(v),p,v,s,o,n,i),s>=i)return o;p++,l=this.nodeAt2(p,1),h=l.node,u=this.positionInBuffer(l.node,l.remainder)}if(p===e.endLineNumber){let f=p===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(p).substring(f,e.endColumn-1);return s=this._findMatchesInLine(t,a,v,e.endLineNumber,f,s,o,n,i),o}let g=p===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,p,g,u,c,t,n,i,s,o),o}_findMatchesInLine(e,t,n,i,o,s,a,l,d){let u=e.wordSeparators;if(!l&&e.simpleSearch){let p=e.simpleSearch,h=p.length,g=n.length,f=-h;for(;(f=n.indexOf(p,f+h))!==-1;)if((!u||Ng(u,n,g,f,h))&&(a[s++]=new ls(new _(i,f+1+o,i,f+1+h+o),null),s>=d))return s;return s}let c;t.reset(0);do if(c=t.next(n),c&&(a[s++]=cs(new _(i,c.index+1+o,i,c.index+1+c[0].length+o),c,l),s>=d))return s;while(c);return s}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==ue){let{node:i,remainder:o,nodeStartOffset:s}=this.nodeAt(e),a=i.piece,l=a.bufferIndex,d=this.positionInBuffer(i,o);if(i.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<_o){this.appendToNode(i,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(s+i.piece.length>e){let u=[],c=new yn(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(i,o)===10){let f={line:c.start.line+1,column:0};c=new yn(c.bufferIndex,f,c.end,this.getLineFeedCnt(c.bufferIndex,f,c.end),c.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(i,o-1)===13){let f=this.positionInBuffer(i,o-1);this.deleteNodeTail(i,f),t="\r"+t,i.piece.length===0&&u.push(i)}else this.deleteNodeTail(i,d);else this.deleteNodeTail(i,d);let p=this.createNewPieces(t);c.length>0&&this.rbInsertRight(i,c);let h=i;for(let g=0;g<p.length;g++)h=this.rbInsertRight(h,p[g]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,i)}else{let i=this.createNewPieces(t),o=this.rbInsertLeft(null,i[0]);for(let s=1;s<i.length;s++)o=this.rbInsertRight(o,i[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===ue)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),o=n.node,s=i.node;if(o===s){let p=this.positionInBuffer(o,n.remainder),h=this.positionInBuffer(o,i.remainder);if(n.nodeStartOffset===e){if(t===o.piece.length){let g=o.next();zc(this,o),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(o,h),this._searchCache.validate(e),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(n.nodeStartOffset+o.piece.length===e+t){this.deleteNodeTail(o,p),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,p,h),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(o,n.remainder);this.deleteNodeTail(o,l),this._searchCache.validate(e),o.piece.length===0&&a.push(o);let d=this.positionInBuffer(s,i.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let u=o.next();for(let p=u;p!==ue&&p!==s;p=p.next())a.push(p);let c=o.piece.length===0?o.prev():o;this.deleteNodes(a),this.validateCRLFWithNextNode(c),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new yn(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,Hr(this,t,-1,-1),t.piece.length===0&&n.push(t)}let i=this.createNewPieces(e),o=this.rbInsertLeft(t,i[i.length-1]);for(let s=i.length-2;s>=0;s--)o=this.rbInsertLeft(o,i[s]);this.validateCRLFWithPrevNode(o),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),o=i;for(let s=1;s<n.length;s++)o=this.rbInsertRight(o,n[s]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,o=e.piece.bufferIndex,s=this._buffers[o].lineStarts,l=s[i.start.line]+i.start.column+t,d=i.start.line,u=i.end.line,c=0,p=0,h=0;for(;d<=u&&(c=d+(u-d)/2|0,h=s[c],c!==u);)if(p=s[c+1],l<h)u=c-1;else if(l>=p)d=c+1;else break;return n?(n.line=c,n.column=l-h,null):{line:c,column:l-h}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let o=i[n.line+1],s=i[n.line]+n.column;if(o>s+1)return n.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)zc(this,e[t])}createNewPieces(e){if(e.length>_o){let u=[];for(;e.length>_o;){let p=e.charCodeAt(_o-1),h;p===13||p>=55296&&p<=56319?(h=e.substring(0,_o-1),e=e.substring(_o-1)):(h=e.substring(0,_o),e=e.substring(_o));let g=zr(h);u.push(new yn(this._buffers.length,{line:0,column:0},{line:g.length-1,column:h.length-g[g.length-1]},g.length-1,h.length)),this._buffers.push(new Kr(h,g))}let c=zr(e);return u.push(new yn(this._buffers.length,{line:0,column:0},{line:c.length-1,column:e.length-c[c.length-1]},c.length-1,e.length)),this._buffers.push(new Kr(e,c)),u}let t=this._buffers[0].buffer.length,n=zr(e,!1),i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let u=0;u<n.length;u++)n[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<n.length;u++)n[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let o=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=o-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new yn(0,i,l,this.getLineFeedCnt(0,i,l),o-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,i="",o=this._searchCache.get2(e);if(o){n=o.node;let s=this.getAccumulatedValue(n,e-o.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(o.nodeStartLineNumber+n.piece.lineFeedCnt===e)i=a.substring(l+s,l+n.piece.length);else{let d=this.getAccumulatedValue(n,e-o.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;n!==ue;)if(n.left!==ue&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this.getAccumulatedValue(n,e-n.lf_left-1),u=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-n.lf_left)}),u.substring(c+l,c+d-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=d.substring(u+l,u+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==ue;){let s=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=s.substring(l,l+a-t),i}else{let a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=s.substr(a,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==ue;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),o=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(s!==o)return{index:s,remainder:0}}return{index:o,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,o=n.start.line+t+1;return o>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[o]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,i=n.lineFeedCnt,o=this.offsetInBuffer(n.bufferIndex,n.end),s=t,a=this.offsetInBuffer(n.bufferIndex,s),l=this.getLineFeedCnt(n.bufferIndex,n.start,s),d=l-i,u=a-o,c=n.length+u;e.piece=new yn(n.bufferIndex,n.start,s,l,c),Hr(this,e,u,d)}deleteNodeHead(e,t){let n=e.piece,i=n.lineFeedCnt,o=this.offsetInBuffer(n.bufferIndex,n.start),s=t,a=this.getLineFeedCnt(n.bufferIndex,s,n.end),l=this.offsetInBuffer(n.bufferIndex,s),d=a-i,u=o-l,c=n.length+u;e.piece=new yn(n.bufferIndex,s,n.end,a,c),Hr(this,e,u,d)}shrinkNode(e,t,n){let i=e.piece,o=i.start,s=i.end,a=i.length,l=i.lineFeedCnt,d=t,u=this.getLineFeedCnt(i.bufferIndex,i.start,d),c=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,o);e.piece=new yn(i.bufferIndex,i.start,d,u,c),Hr(this,e,c-a,u-l);let p=new yn(i.bufferIndex,n,s,this.getLineFeedCnt(i.bufferIndex,n,s),this.offsetInBuffer(i.bufferIndex,s)-this.offsetInBuffer(i.bufferIndex,n)),h=this.rbInsertRight(e,p);this.validateCRLFWithPrevNode(h)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let o=zr(t,!1);for(let h=0;h<o.length;h++)o[h]+=i;if(n){let h=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-h}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,u=e.piece.lineFeedCnt,c=this.getLineFeedCnt(0,e.piece.start,l),p=c-u;e.piece=new yn(e.piece.bufferIndex,e.piece.start,l,c,d),this._lastChangeBufferPos=l,Hr(this,e,t.length,p)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==ue;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){i+=t.size_left;let o={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(o),o}else e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==ue;)if(n.left!==ue&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let o=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(o+t-1,s),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let o=this.getAccumulatedValue(n,e-n.lf_left-2);if(o+t-1<=n.piece.length)return{node:n,remainder:o+t-1,nodeStartOffset:i};t-=n.piece.length-o;break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==ue;){if(n.piece.lineFeedCnt>0){let o=this.getAccumulatedValue(n,0),s=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,o),nodeStartOffset:s}}else if(n.piece.length>=t-1){let o=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:o}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===ue||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,o=n[i]+t.start.column;return i===n.length-1||n[i+1]>o+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===ue||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],i=this._buffers[e.piece.bufferIndex].lineStarts,o;e.piece.end.column===0?o={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}:o={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new yn(e.piece.bufferIndex,e.piece.start,o,a,s),Hr(this,e,-1,-1),e.piece.length===0&&n.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new yn(t.piece.bufferIndex,l,t.piece.end,u,d),Hr(this,t,-1,-1),t.piece.length===0&&n.push(t);let c=this.createNewPieces(`\r
`);this.rbInsertRight(e,c[0]);for(let p=0;p<n.length;p++)zc(this,n[p])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)zc(this,n);else{let i=n.piece,o={line:i.start.line+1,column:0},s=i.length-1,a=this.getLineFeedCnt(i.bufferIndex,o,i.end);n.piece=new yn(i.bufferIndex,o,i.end,a,s),Hr(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===ue)return t(ue);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===ue)return"";let t=this._buffers[e.piece.bufferIndex],n=e.piece,i=this.offsetInBuffer(n.bufferIndex,n.start),o=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(i,o)}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new td(t,1);if(n.left=ue,n.right=ue,n.parent=ue,n.size_left=0,n.lf_left=0,this.root===ue)this.root=n,n.color=0;else if(e.right===ue)e.right=n,n.parent=e;else{let o=Mg(e.right);o.left=n,n.parent=o}return IS(this,n),n}rbInsertLeft(e,t){let n=new td(t,1);if(n.left=ue,n.right=ue,n.parent=ue,n.size_left=0,n.lf_left=0,this.root===ue)this.root=n,n.color=0;else if(e.left===ue)e.left=n,n.parent=e;else{let i=bS(e.left);i.right=n,n.parent=i}return IS(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}};var nd=class r extends B{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,n,i,o,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=o,this._pieceTree=new Ag(e,n,a)}equals(e){return!(e instanceof r)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,i=this.getPositionAt(e),o=this.getPositionAt(n);return new _(i.lineNumber,i.column,o.lineNumber,o.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn),o=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;o=l*d}return i-n+o}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0,i=e.startLineNumber,o=e.endLineNumber;for(let s=i;s<=o;s++){let a=this.getLineContent(s),l=s===i?e.startColumn-1:0,d=s===o?e.endColumn-1:a.length;for(let u=l;u<d;u++)lt(a.charCodeAt(u))?(n=n+1,u=u+1):n=n+1}return n+=this._getEndOfLine(t).length*(o-i),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=gt(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=yi(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let f=0;f<e.length;f++){let v=e[f];a&&v._isTracked&&(a=!1);let y=v.range;if(v.text){let R=!0;s||(R=!Sh(v.text),s=R),!i&&R&&(i=uo(v.text)),!o&&R&&(o=_h(v.text))}let I="",S=0,x=0,T=0;if(v.text){let R;[S,x,T,R]=Wn(v.text);let P=this.getEOL(),O=P===`\r
`?2:1;R===0||R===O?I=v.text:I=v.text.replace(/\r\n|\r|\n/g,P)}l[f]={sortIndex:f,identifier:v.identifier||null,range:y,rangeOffset:this.getOffsetAt(y.startLineNumber,y.startColumn),rangeLength:this.getValueLengthInRange(y),text:I,eolCount:S,firstLineLength:x,lastLineLength:T,forceMoveMarkers:!!v.forceMoveMarkers,isAutoWhitespaceEdit:v.isAutoWhitespaceEdit||!1}}l.sort(r._sortOpsAscending);let d=!1;for(let f=0,v=l.length-1;f<v;f++){let y=l[f].range.getEndPosition(),I=l[f+1].range.getStartPosition();if(I.isBeforeOrEqual(y)){if(I.isBefore(y))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let u=n||t?r._getInverseEditRanges(l):[],c=[];if(t)for(let f=0;f<l.length;f++){let v=l[f],y=u[f];if(v.isAutoWhitespaceEdit&&v.range.isEmpty())for(let I=y.startLineNumber;I<=y.endLineNumber;I++){let S="";I===y.startLineNumber&&(S=this.getLineContent(v.range.startLineNumber),gt(S)!==-1)||c.push({lineNumber:I,oldContent:S})}}let p=null;if(n){let f=0;p=[];for(let v=0;v<l.length;v++){let y=l[v],I=u[v],S=this.getValueInRange(y.range),x=y.rangeOffset+f;f+=y.text.length-S.length,p[v]={sortIndex:y.sortIndex,identifier:y.identifier,range:I,text:S,textChange:new oi(y.rangeOffset,S,x,y.text)}}d||p.sort((v,y)=>v.sortIndex-y.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=s;let h=this._doApplyEdits(l),g=null;if(t&&c.length>0){c.sort((f,v)=>v.lineNumber-f.lineNumber),g=[];for(let f=0,v=c.length;f<v;f++){let y=c[f].lineNumber;if(f>0&&c[f-1].lineNumber===y)continue;let I=c[f].oldContent,S=this.getLineContent(y);S.length===0||S===I||gt(S)!==-1||g.push(y)}}return this._onDidChangeContent.fire(),new ag(p,h,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,i=e[e.length-1].range,o=new _(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn),s=n.startLineNumber,a=n.startColumn,l=[];for(let h=0,g=e.length;h<g;h++){let f=e[h],v=f.range;t=t||f.forceMoveMarkers,l.push(this.getValueInRange(new _(s,a,v.startLineNumber,v.startColumn))),f.text.length>0&&l.push(f.text),s=v.endLineNumber,a=v.endColumn}let d=l.join(""),[u,c,p]=Wn(d);return{sortIndex:0,identifier:e[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:d,eolCount:u,firstLineLength:c,lastLineLength:p,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(r._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n],o=i.range.startLineNumber,s=i.range.startColumn,a=i.range.endLineNumber,l=i.range.endColumn;if(o===a&&s===l&&i.text.length===0)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);let d=new _(o,s,a,l);t.push({range:d,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,i=e.startColumn,[o,s,a]=Wn(t),l;if(t.length>0){let d=o+1;d===1?l=new _(n,i,n,i+s):l=new _(n,i,n+d-1,a+1)}else l=new _(n,i,n,i);return l}static _getInverseEditRanges(e){let t=[],n=0,i=0,o=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,u;o?o.range.endLineNumber===l.range.startLineNumber?(d=n,u=i+(l.range.startColumn-o.range.endColumn)):(d=n+(l.range.startLineNumber-o.range.endLineNumber),u=l.range.startColumn):(d=l.range.startLineNumber,u=l.range.startColumn);let c;if(l.text.length>0){let p=l.eolCount+1;p===1?c=new _(d,u,d,u+l.firstLineLength):c=new _(d,u,d+p-1,l.lastLineLength+1)}else c=new _(d,u,d,u);n=c.endLineNumber,i=c.endColumn,t.push(c),o=l}return t}static _sortOpsAscending(e,t){let n=_.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=_.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}};var ES=class{constructor(e,t,n,i,o,s,a,l,d){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=o;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let o=0,s=n.length;o<s;o++){let a=n[o].buffer.replace(/\r\n|\r|\n/g,t),l=zr(a);n[o]=new Kr(a,l)}let i=new nd(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},id=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&Uw(e)&&(this.BOM=Vw,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=j0(this._tmpLineStarts,e);this.chunks.push(new Kr(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=uo(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=_h(e)))}finish(e=!0){return this._finish(),new ES(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=zr(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var q0=new class{clone(){return this}equals(r){return this===r}};function wS(r,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(r<<0|0|0|32768|2<<24)>>>0,new Mm(t,e===null?q0:e)}var Fg=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(t===0){this.insert(e,n);return}else if(n===0){this.delete(e,t);return}let i=this._store.slice(0,e),o=this._store.slice(e+t),s=$M(n,this._default);this._store=i.concat(s,o)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let n=[];for(let i=0;i<t;i++)n[i]=this._default;this._store=Er(this._store,e,n)}};function $M(r,e){let t=[];for(let n=0;n<r;n++)t[n]=e;return t}var ya=class{static deserialize(e){let t=0,n=Kt(e,t);t+=4;let i=[];for(let o=0;o<n;o++)t=Ic.deserialize(e,t,i);return i}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e){n.appendLineTokens(t);return}}this._tokens.push(new Ic(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;Gt(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}};var TS=class{constructor(e,t){this.tokenizationSupport=t;this.store=new od(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},Wg=class extends TS{constructor(t,n,i,o){super(t,n);this._textModel=i;this._languageIdCodec=o}updateTokensUntilLine(t,n){let i=this._textModel.getLanguageId();for(;;){let o=this.getFirstInvalidLine();if(!o||o.lineNumber>n)break;let s=this._textModel.getLineContent(o.lineNumber),a=rd(this._languageIdCodec,i,this.tokenizationSupport,s,!0,o.startState);t.add(o.lineNumber,a.tokens),this.store.setEndState(o.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,n){let i=this.getStartState(t.lineNumber);if(!i)return 0;let o=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+n+s.substring(t.column-1),l=rd(this._languageIdCodec,o,this.tokenizationSupport,a,!0,i),d=new _t(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let u=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(u)}tokenizeLineWithEdit(t,n){let i=this.getStartState(t);if(!i)return{mainLineTokens:null,additionalLines:null};let o=this._textModel.getLineContent(t),s=n.lineEdit.apply(o),a=this._textModel.getLanguageIdAtPosition(t,0),l=rd(this._languageIdCodec,a,this.tokenizationSupport,s,!0,i),d=null;if(n.additionalLines){d=[];let c=l.endState;for(let p of n.additionalLines){let h=rd(this._languageIdCodec,a,this.tokenizationSupport,p,!0,c);d.push(new _t(h.tokens,p,this._languageIdCodec)),c=h.endState}}return{mainLineTokens:new _t(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n}isCheapToTokenize(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n||t===n&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,n,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,i),{heuristicTokens:!1};let o=this.guessStartState(n),s=this._textModel.getLanguageId();for(let a=n;a<=i;a++){let l=this._textModel.getLineContent(a),d=rd(this._languageIdCodec,s,this.tokenizationSupport,l,!0,o);t.add(a,d.tokens),o=d.endState}return{heuristicTokens:!0}}guessStartState(t){let n=this._textModel.getLineFirstNonWhitespaceColumn(t),i=[],o=null;for(let l=t-1;n>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<n&&(i.push(this._textModel.getLineContent(l)),n=d,o=this.getStartState(l),o))break}o||(o=this.tokenizationSupport.getInitialState()),i.reverse();let s=this._textModel.getLanguageId(),a=o;for(let l of i)a=rd(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},od=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new it(1,e+1))}_tokenizationStateStore=new LS;_invalidEndStatesLineNumbers=new kS;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new Re("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new it(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new it(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[n]=Wn(t.text);this.acceptChange(new bn(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new it(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let n=this.getStartState(t,e);if(!n)throw new Re("Start state must be defined");return{lineNumber:t,startState:n}}},LS=class{_lineEndStates=new Fg(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return n&&n.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[n]=Wn(t.text);this.acceptChange(new bn(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}},kS=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new it(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(n=>n.contains(e));if(t!==-1){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new it(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new it(n.start,e):this._ranges.splice(t,1,new it(n.start,e),new it(e+1,n.endExclusive))}}addRange(e){it.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let i=n;for(;!(i>=this._ranges.length||e.endExclusive<this._ranges[i].start);)i++;let o=t-e.length;for(let s=i;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(o);if(n===i){let s=new it(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let s=Math.min(e.start,this._ranges[n].start),a=Math.max(e.endExclusive,this._ranges[i-1].endExclusive),l=new it(s,a+o);l.isEmpty?this._ranges.splice(n,i-n):this._ranges.splice(n,i-n,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function rd(r,e,t,n,i,o){let s=null;if(t)try{s=t.tokenizeEncoded(n,i,o.clone())}catch(a){Le(a)}return s||(s=wS(r.encodeLanguageId(e),o)),_t.convertToEndOffset(s.tokens,n.length),s}var Bg=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,rI(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?Qp(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new ya,n=Vs.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new bn(e,t))}};var Vg=class{_onDidChangeVisibleRanges=new L;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new RS(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},RS=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let n=e.map(i=>new bn(i.startLineNumber,i.endLineNumber+1));this.handleStateChange({visibleLineRanges:n,stabilized:t})}},Ug=class extends B{constructor(t){super();this._refreshTokens=t}runner=this._register(new dn(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){Pn(this._computedLineRanges,this._lineRanges,(t,n)=>t.equals(n))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},sd=class extends B{constructor(t,n,i){super();this._languageIdCodec=t;this._textModel=n;this.getLanguageId=i}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new L);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new L);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var $0=G("treeSitterParserService");var Kc=class extends sd{constructor(t,n,i,o){super(n,i,o);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=Sc.get(t))}getLineTokens(t){let n=this._textModel.getLineContent(t);if(this._tokenizationSupport){let i=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(i)return new _t(i,n,this._languageIdCodec)}return _t.createEmpty(n,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,n,i){return 0}tokenizeLineWithEdit(t,n){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var Gc=class r{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),i!==null&&i!==Br)return new _t(Vr(i),n,this._languageIdCodec);let o=new Uint32Array(2);return o[0]=n.length,o[1]=Y0(this._languageIdCodec.encodeLanguageId(e)),new _t(o,n,this._languageIdCodec)}static _massageTokens(e,t,n){let i=n?Vr(n):null;if(t===0){let o=!1;if(i&&i.length>1&&(o=si.getLanguageId(i[1])!==e),!o)return Br}if(!i||i.length===0){let o=new Uint32Array(2);return o[0]=t,o[1]=Y0(e),o.buffer}return i[i.length-2]=t,i.byteOffset===0&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=Er(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,o){let s=r._massageTokens(this._languageIdCodec.encodeLanguageId(e),n,i);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,o?!r._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let n=Vr(e),i=Vr(t);if(n.length!==i.length)return!1;for(let o=0,s=n.length;o<s;o++)if(n[o]!==i[o])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new w(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=jt.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=jt.deleteEnding(this._lineTokens[t],e.startColumn-1);let n=e.endLineNumber-1,i=null;n<this._len&&(i=jt.deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=jt.append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-1;if(!(i>=this._len)){if(t===0){this._lineTokens[i]=jt.insert(this._lineTokens[i],e.column-1,n);return}this._lineTokens[i]=jt.deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=jt.insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let n=[];for(let i=0,o=e.length;i<o;i++){let s=e[i],a=0,l=0,d=!1;for(let u=s.startLineNumber;u<=s.endLineNumber;u++)d?(this.setTokens(t.getLanguageId(),u-1,t.getLineLength(u),s.getLineTokens(u),!1),l=u):this.setTokens(t.getLanguageId(),u-1,t.getLineLength(u),s.getLineTokens(u),!0)&&(d=!0,a=u,l=u);d&&n.push({fromLineNumber:a,toLineNumber:l})}return{changes:n}}};function Y0(r){return(r<<0|0|0|32768|2<<24|1024)>>>0}var Hg=class r{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){let o=t[0].getRange(),s=t[t.length-1].getRange();if(!o||!s)return e;n=e.plusRange(o).plusRange(s)}let i=null;for(let o=0,s=this._pieces.length;o<s;o++){let a=this._pieces[o];if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:o};break}if(a.removeTokens(n),a.isEmpty()){this._pieces.splice(o,1),o--,s--;continue}if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:o};continue}let[l,d]=a.split(n);if(l.isEmpty()){i=i||{index:o};continue}d.isEmpty()||(this._pieces.splice(o,1,l,d),o++,s++,i=i||{index:o})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=Er(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let n=this._pieces;if(n.length===0)return t;let i=r._findFirstPieceWithLine(n,e),o=n[i].getLineTokens(e);if(!o)return t;let s=t.getCount(),a=o.getCount(),l=0,d=[],u=0,c=0,p=(h,g)=>{h!==c&&(c=h,d[u++]=h,d[u++]=g)};for(let h=0;h<a;h++){let g=o.getStartCharacter(h),f=o.getEndCharacter(h),v=o.getMetadata(h),y=((v&1?2048:0)|(v&2?4096:0)|(v&4?8192:0)|(v&8?16384:0)|(v&16?16744448:0)|(v&32?4278190080:0))>>>0,I=~y>>>0;for(;l<s&&t.getEndOffset(l)<=g;)p(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<g&&p(g,t.getMetadata(l));l<s&&t.getEndOffset(l)<f;)p(t.getEndOffset(l),t.getMetadata(l)&I|v&y),l++;if(l<s)p(f,t.getMetadata(l)&I|v&y),t.getEndOffset(l)===f&&l++;else{let S=Math.min(Math.max(0,l-1),s-1);p(f,t.getMetadata(S)&I|v&y)}}for(;l<s;)p(t.getEndOffset(l),t.getMetadata(l)),l++;return new _t(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let o=n+Math.floor((i-n)/2);if(e[o].endLineNumber<t)n=o+1;else if(e[o].startLineNumber>t)i=o-1;else{for(;o>n&&e[o-1].startLineNumber<=t&&t<=e[o-1].endLineNumber;)o--;return o}}return n}acceptEdit(e,t,n,i,o){for(let s of this._pieces)s.acceptEdit(e,t,n,i,o)}};var xo=class extends Xl{constructor(t,n,i,o,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=n;this._languageId=i;this._attachedViews=o;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(Ke.filter(Sc.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new Hg(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new L);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new L);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new L);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new We);createGrammarTokens(){return this._register(new zg(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new Kc(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let n=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),n&&this._tokens.resetTokenization()}createPreferredTokenProvider(){Sc.get(this._languageId)?this._tokens instanceof Kc||this.createTokens(!0):this._tokens instanceof zg||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let n of t.changes){let[i,o,s]=Wn(n.text);this._semanticTokens.acceptEdit(n.range,i,o,s,n.text.length>0?n.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let n=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,n)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new Re("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,n,i){return this._tokens.getTokenTypeIfInsertingCharacter(t,n,i)}tokenizeLineWithEdit(t,n){return this._tokens.tokenizeLineWithEdit(t,n)}setSemanticTokens(t,n){this._semanticTokens.set(t,n),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,n){if(this.hasCompleteSemanticTokens())return;let i=this._textModel.validateRange(this._semanticTokens.setPartial(t,n));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let n=this._textModel.validatePosition(t),i=this._textModel.getLineContent(n.lineNumber),o=this.getLineTokens(n.lineNumber),s=o.findTokenIndexAtOffset(n.column-1),[a,l]=xo._findLanguageBoundaries(o,s),d=vm(n.column,this.getLanguageConfiguration(o.getLanguageId(s)).getWordDefinition(),i.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===n.column-1){let[u,c]=xo._findLanguageBoundaries(o,s-1),p=vm(n.column,this.getLanguageConfiguration(o.getLanguageId(s-1)).getWordDefinition(),i.substring(u,c),u);if(p&&p.startColumn<=t.column&&t.column<=p.endColumn)return p}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,n){let i=t.getLanguageId(n),o=0;for(let a=n;a>=0&&t.getLanguageId(a)===i;a--)o=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=n,l=t.getCount();a<l&&t.getLanguageId(a)===i;a++)s=t.getEndOffset(a);return[o,s]}getWordUntilPosition(t){let n=this.getWordAtPosition(t);return n?{word:n.word.substr(0,t.column-n.startColumn),startColumn:n.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,n){let i=this._textModel.validatePosition(new w(t,n)),o=this.getLineTokens(i.lineNumber);return o.getLanguageId(o.findTokenIndexAtOffset(i.column-1))}setLanguageId(t,n="api"){if(this._languageId===t)return;let i={oldLanguage:this._languageId,newLanguage:t,source:n};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};xo=ne([M(4,li),M(5,sr),M(6,$0)],xo);var zg=class extends sd{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new Zn);_tokens=new Gc(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new Zn);_attachedViewStates=this._register(new Lr);constructor(e,t,n,i){super(e,t,n),this._register(ai.onDidChange(o=>{let s=this.getLanguageId();o.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(i.onDidChangeVisibleRanges(({view:o,state:s})=>{if(s){let a=this._attachedViewStates.get(o);a||(a=new Ug(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(o,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(o)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new od(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let o=ai.get(this.getLanguageId());if(!o)return[null,null];let s;try{s=o.getInitialState()}catch(a){return Le(a),[null,null]}return[o,s]},[n,i]=t();if(n&&i?this._tokenizer=new Wg(this._textModel.getLineCount(),n,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let o={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};n&&n.createBackgroundTokenizer&&!n.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new Bg(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),n?.backgroundTokenizerShouldOnlyVerifyTokens&&n.createBackgroundTokenizer?(this._debugBackgroundTokens=new Gc(this._languageIdCodec),this._debugBackgroundStates=new od(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[n,i]=Wn(t.text);this._tokens.acceptEdit(t.range,n,i),this._debugBackgroundTokens?.acceptEdit(t.range,n,i)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=bn.joinMany([...this._attachedViewStates].map(([t,n])=>n.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let n=new ya,{heuristicTokens:i}=this._tokenizer.tokenizeHeuristically(n,e,t),o=this.setTokens(n.finalize());if(i)for(let s of o.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new ya;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let i=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!n.equals(i)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return n}getTokenTypeIfInsertingCharacter(e,t,n){if(!this._tokenizer)return 0;let i=this._textModel.validatePosition(new w(e,t));return this.forceTokenization(i.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function BS(r){let e=new id;return e.acceptChunk(r),e.finish()}function J0(r){return new Promise((e,t)=>{let n=new id,i=!1;Jy(r,{onData:o=>{n.acceptChunk(typeof o=="string"?o:o.toString())},onError:o=>{i||(i=!0,t(o))},onEnd:()=>{i||(i=!0,e(n.finish()))}})})}function YM(r){let e=new id,t;for(;typeof(t=r.read())=="string";)e.acceptChunk(t);return e.finish()}function Q0(r,e){let t;return typeof r=="string"?t=BS(r):q1(r)?t=YM(r):t=r,t.create(e)}var Kg=0,QM=999,ZM=1e4,PS=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(i===null)return this._eos=!0,t===0?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=64*1024)return e.join("")}while(!0)}},jc=()=>{throw new Error("Invalid change accessor")};var jr=class extends B{constructor(t,n,i,o=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;Kg++,this.id="$model"+Kg,this.isForSimpleWidget=i.isForSimpleWidget,typeof o>"u"||o===null?this._associatedResource=ae.parse("inmemory://model/"+Kg):this._associatedResource=o,this._attachedEditorCount=0;let{textBuffer:u,disposable:c}=Q0(t,i.defaultEOL);this._buffer=u,this._bufferDisposable=c,this._options=jr.resolveOptions(this._buffer,i);let p=typeof n=="string"?n:n.languageId;typeof n!="string"&&(this._languageSelectionListener.value=n.onDidChange(()=>this._setLanguage(n.languageId))),this._bracketPairs=this._register(new fg(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new Dg(this,this._languageConfigurationService)),this._decorationProvider=this._register(new Tg(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(xo,this,this._bracketPairs,p,this._attachedViews);let h=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new _(1,1,h,this._buffer.getLineLength(h)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>jr.LARGE_FILE_SIZE_THRESHOLD||h>jr.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>jr.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=g>jr._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Eh(Kg),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new jg,this._commandManager=new Rg(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(f=>{this._bracketPairs.handleLanguageConfigurationServiceChange(f),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(f)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Fr.tabSize,indentSize:Fr.indentSize,insertSpaces:Fr.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Fr.trimAutoWhitespace,largeFileOptimizations:Fr.largeFileOptimizations,bracketPairColorizationOptions:Fr.bracketPairColorizationOptions};static resolveOptions(t,n){if(n.detectIndentation){let i=mS(t,n.tabSize,n.insertSpaces);return new ql({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:n.trimAutoWhitespace,defaultEOL:n.defaultEOL,bracketPairColorizationOptions:n.bracketPairColorizationOptions})}return new ql(n)}_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new AS(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new L);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new L);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new L);_eventEmitter=this._register(new FS);onDidChangeContent(t){return this._eventEmitter.slowEvent(n=>t(n.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return Go(this._eventEmitter.fastEvent(n=>t(n)),this._onDidChangeInjectedText.event(n=>t(n)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new Zn);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new Vg;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new nd([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=B.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new Re("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,n){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(n),this._bracketPairs.handleDidChangeContent(n),this._eventEmitter.fire(new as(t,n)))}setValue(t){if(this._assertNotDisposed(),t==null)throw sl();let{textBuffer:n,disposable:i}=Q0(t,this._options.defaultEOL);this._setValueFromTextBuffer(n,i)}_createContentChanged2(t,n,i,o,s,a,l,d){return{changes:[{range:t,rangeOffset:n,rangeLength:i,text:o}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,n){this._assertNotDisposed();let i=this.getFullModelRange(),o=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=n,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new jg,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new ma([new tg],this._versionId,!1,!1),this._createContentChanged2(new _(1,1,s,a),0,o,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let n=t===1?`\r
`:`
`;if(this._buffer.getEOL()===n)return;let i=this.getFullModelRange(),o=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(n),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new ma([new rg],this._versionId,!1,!1),this._createContentChanged2(new _(1,1,s,a),0,o,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),n=this._decorationsTree.collectNodesPostOrder();for(let i=0,o=n.length;i<o;i++){let s=n[i],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),u=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=u,s.cachedVersionId=t,s.start=d-l,s.end=u-l,Co(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,n=0,i=this._buffer.getLineCount();for(let o=1;o<=i;o++){let s=this._buffer.getLineLength(o);s>=ZM?n+=s:t+=s}return n>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let n=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,i=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,o=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new ql({tabSize:n,indentSize:i,insertSpaces:o,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,n){this._assertNotDisposed();let i=mS(this._buffer,n,t);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),cg(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let n=this.findMatches(Ny.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,n.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let n=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(n.lineNumber,n.column)}getPositionAt(t){this._assertNotDisposed();let n=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(n)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,n=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Re("Operation would exceed heap memory limits");let i=this.getFullModelRange(),o=this.getValueInRange(i,t);return n?this._buffer.getBOM()+o:o}createSnapshot(t=!1){return new PS(this._buffer.createSnapshot(t))}getValueLength(t,n=!1){this._assertNotDisposed();let i=this.getFullModelRange(),o=this.getValueLengthInRange(i,t);return n?this._buffer.getBOM().length+o:o}getValueInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),n)}getValueLengthInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),n)}getCharacterCountInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),n)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Re("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Re("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new Re("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Re("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Re("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new Re("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let n=this._buffer.getLineCount(),i=t.startLineNumber,o=t.startColumn,s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=Math.floor(typeof o=="number"&&!isNaN(o)?o:1);if(s<1)s=1,a=1;else if(s>n)s=n,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let p=this.getLineMaxColumn(s);a>=p&&(a=p)}let l=t.endLineNumber,d=t.endColumn,u=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),c=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(u<1)u=1,c=1;else if(u>n)u=n,c=this.getLineMaxColumn(u);else if(c<=1)c=1;else{let p=this.getLineMaxColumn(u);c>=p&&(c=p)}return i===s&&o===a&&l===u&&d===c&&t instanceof _&&!(t instanceof ye)?t:new _(s,a,u,c)}_isValidPosition(t,n,i){if(typeof t!="number"||typeof n!="number"||isNaN(t)||isNaN(n)||t<1||n<1||(t|0)!==t||(n|0)!==n)return!1;let o=this._buffer.getLineCount();if(t>o)return!1;if(n===1)return!0;let s=this.getLineMaxColumn(t);if(n>s)return!1;if(i===1){let a=this._buffer.getLineCharCode(t,n-2);if(lt(a))return!1}return!0}_validatePosition(t,n,i){let o=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=this._buffer.getLineCount();if(o<1)return new w(1,1);if(o>a)return new w(a,this.getLineMaxColumn(a));if(s<=1)return new w(o,1);let l=this.getLineMaxColumn(o);if(s>=l)return new w(o,l);if(i===1){let d=this._buffer.getLineCharCode(o,s-2);if(lt(d))return new w(o,s-1)}return new w(o,s)}validatePosition(t){let n=1;return this._assertNotDisposed(),t instanceof w&&this._isValidPosition(t.lineNumber,t.column,n)?t:this._validatePosition(t.lineNumber,t.column,n)}_isValidRange(t,n){let i=t.startLineNumber,o=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(i,o,0)||!this._isValidPosition(s,a,0))return!1;if(n===1){let l=o>1?this._buffer.getLineCharCode(i,o-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,u=lt(l),c=lt(d);return!u&&!c}return!0}validateRange(t){let n=1;if(this._assertNotDisposed(),t instanceof _&&!(t instanceof ye)&&this._isValidRange(t,n))return t;let i=this._validatePosition(t.startLineNumber,t.startColumn,0),o=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,a=i.column,l=o.lineNumber,d=o.column;if(n===1){let u=a>1?this._buffer.getLineCharCode(s,a-2):0,c=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,p=lt(u),h=lt(c);return!p&&!h?new _(s,a,l,d):s===l&&a===d?new _(s,a-1,l,d-1):p&&h?new _(s,a-1,l,d+1):p?new _(s,a-1,l,d):new _(s,a,l,d+1)}return new _(s,a,l,d)}modifyPosition(t,n){this._assertNotDisposed();let i=this.getOffsetAt(t)+n;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new _(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,n,i,o){return this._buffer.findMatchesLineByLine(t,n,i,o)}findMatches(t,n,i,o,s,a,l=QM){this._assertNotDisposed();let d=null;n!==null&&(Array.isArray(n)||(n=[n]),n.every(p=>_.isIRange(p))&&(d=n.map(p=>this.validateRange(p)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((p,h)=>p.startLineNumber-h.startLineNumber||p.startColumn-h.startColumn);let u=[];u.push(d.reduce((p,h)=>_.areIntersecting(p,h)?p.plusRange(h):(u.push(p),h)));let c;if(!i&&t.indexOf(`
`)<0){let h=new So(t,i,o,s).parseSearchRequest();if(!h)return[];c=g=>this.findMatchesLineByLine(g,h,a,l)}else c=p=>ba.findMatches(this,new So(t,i,o,s),p,a,l);return u.map(c).reduce((p,h)=>p.concat(h),[])}findNextMatch(t,n,i,o,s,a){this._assertNotDisposed();let l=this.validatePosition(n);if(!i&&t.indexOf(`
`)<0){let u=new So(t,i,o,s).parseSearchRequest();if(!u)return null;let c=this.getLineCount(),p=new _(l.lineNumber,l.column,c,this.getLineMaxColumn(c)),h=this.findMatchesLineByLine(p,u,a,1);return ba.findNextMatch(this,new So(t,i,o,s),l,a),h.length>0||(p=new _(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),h=this.findMatchesLineByLine(p,u,a,1),h.length>0)?h[0]:null}return ba.findNextMatch(this,new So(t,i,o,s),l,a)}findPreviousMatch(t,n,i,o,s,a){this._assertNotDisposed();let l=this.validatePosition(n);return ba.findPreviousMatch(this,new So(t,i,o,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof $l?t:new $l(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let n=[];for(let i=0,o=t.length;i<o;i++)n[i]=this._validateEditOperation(t[i]);return n}pushEditOperations(t,n,i,o){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(n),i,o)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,n,i,o){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=n.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let u=t[l],c=!1;for(let p=0,h=s.length;p<h;p++){let g=s[p].range,f=g.startLineNumber>u.endLineNumber,v=u.startLineNumber>g.endLineNumber;if(!f&&!v){c=!0;break}}if(!c){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let u=this._trimAutoWhitespaceLines[l],c=this.getLineMaxColumn(u),p=!0;for(let h=0,g=s.length;h<g;h++){let f=s[h].range,v=s[h].text;if(!(u<f.startLineNumber||u>f.endLineNumber)&&!(u===f.startLineNumber&&f.startColumn===c&&f.isEmpty()&&v&&v.length>0&&v.charAt(0)===`
`)&&!(u===f.startLineNumber&&f.startColumn===1&&f.isEmpty()&&v&&v.length>0&&v.charAt(v.length-1)===`
`)){p=!1;break}}if(p){let h=new _(u,1,u,c);n.push(new $l(null,h,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,n,i,o)}_applyUndo(t,n,i,o){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new _(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,n,!0,!1,i,o)}_applyRedo(t,n,i,o){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new _(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,n,!1,!0,i,o)}_applyUndoRedoEdits(t,n,i,o,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=o,this.applyEdits(t,!1),this.setEOL(n),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,n=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let i=this._validateEditOperations(t);return this._doApplyEdits(i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,n){let i=this._buffer.getLineCount(),o=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,n),s=this._buffer.getLineCount(),a=o.changes;if(this._trimAutoWhitespaceLines=o.trimAutoWhitespaceLineNumbers,a.length!==0){for(let u=0,c=a.length;u<c;u++){let p=a[u];this._decorationsTree.acceptReplace(p.rangeOffset,p.rangeLength,p.text.length,p.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=i;for(let u=0,c=a.length;u<c;u++){let p=a[u],[h]=Wn(p.text);this._onDidChangeDecorations.fire();let g=p.range.startLineNumber,f=p.range.endLineNumber,v=f-g,y=h,I=Math.min(v,y),S=y-v,x=s-d-S+g,T=x,R=x+y,P=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new w(T,1)),this.getOffsetAt(new w(R,this.getLineMaxColumn(R))),0),O=Bn.fromDecorations(P),k=new Rn(O);for(let F=I;F>=0;F--){let W=g+F,H=x+F;k.takeFromEndWhile(ee=>ee.lineNumber>H);let $=k.takeFromEndWhile(ee=>ee.lineNumber===H);l.push(new Mc(W,this.getLineContent(H),$))}if(I<v){let F=g+I;l.push(new ng(F+1,f))}if(I<y){let F=new Rn(O),W=g+I,H=y-I,$=s-d-H+W+1,ee=[],K=[];for(let V=0;V<H;V++){let Y=$+V;K[V]=this.getLineContent(Y),F.takeWhile(j=>j.lineNumber<Y),ee[V]=F.takeWhile(j=>j.lineNumber===Y)}l.push(new ig(W+1,g+y,K,ee))}d+=S}this._emitContentChangedEvent(new ma(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return o.reverseEdits===null?void 0:o.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let i=Array.from(t).map(o=>new Mc(o,this.getLineContent(o),this._getInjectedTextInLine(o)));this._onDidChangeInjectedText.fire(new jl(i))}changeDecorations(t,n=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(n,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,n){let i={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,X0(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},o=null;try{o=n(i)}catch(s){Le(s)}return i.addDecoration=jc,i.changeDecoration=jc,i.changeDecorationOptions=jc,i.removeDecoration=jc,i.deltaDecorations=jc,o}deltaDecorations(t,n,i=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&n.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Le(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,t,n)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,n,i){let o=t?this._decorations[t]:null;if(!o)return n?this._deltaDecorationsImpl(0,[],[{range:n,options:Z0[i]}],!0)[0]:null;if(!n)return this._decorationsTree.delete(o),delete this._decorations[o.id],null;let s=this._validateRangeRelaxedNoAllocations(n),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(o),o.reset(this.getVersionId(),a,l,s),o.setOptions(Z0[i]),this._decorationsTree.insert(o),o.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let n=this._decorationsTree.collectNodesFromOwner(t);for(let i=0,o=n.length;i<o;i++){let s=n[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let n=this._decorations[t];return n?n.options:null}getDecorationRange(t){let n=this._decorations[t];return n?this._decorationsTree.getNodeRange(this,n):null}getLineDecorations(t,n=0,i=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,n,i)}getLinesDecorations(t,n,i=0,o=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,n)),u=this.getLineMaxColumn(d),c=new _(l,1,d,u),p=this._getDecorationsInRange(c,i,o,s);return oy(p,this._decorationProvider.getDecorationsInRange(c,i,o)),p}getDecorationsInRange(t,n=0,i=!1,o=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,n,i,s);return oy(l,this._decorationProvider.getDecorationsInRange(a,n,i,o)),l}getOverviewRulerDecorations(t=0,n=!1){return this._decorationsTree.getAll(this,t,n,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let n=this._buffer.getOffsetAt(t,1),i=n+this._buffer.getLineLength(t),o=this._decorationsTree.getInjectedTextInInterval(this,n,i,0);return Bn.fromDecorations(o).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,n=!1){let i=this._decorationsTree.getAll(this,t,n,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(t,n)),i}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,n,i,o){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,n,i,o)}getRangeAt(t,n){return this._buffer.getRangeAt(t,n-t)}_changeDecorationImpl(t,n){let i=this._decorations[t];if(!i)return;if(i.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let o=this._validateRangeRelaxedNoAllocations(n),s=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,a,o),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber)}_changeDecorationOptionsImpl(t,n){let i=this._decorations[t];if(!i)return;let o=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(n.overviewRuler&&n.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(n),i.options.after||n.after){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(i.options.before||n.before){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=o!==s,l=JM(n)!==Gg(i);a||l?(this._decorationsTree.delete(i),i.setOptions(n),this._decorationsTree.insert(i)):i.setOptions(n)}_deltaDecorationsImpl(t,n,i,o=!1){let s=this.getVersionId(),a=n.length,l=0,d=i.length,u=0;this._onDidChangeDecorations.beginDeferredEmit();try{let c=new Array(d);for(;l<a||u<d;){let p=null;if(l<a){do p=this._decorations[n[l++]];while(!p&&l<a);if(p){if(p.options.after){let h=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.endLineNumber)}if(p.options.before){let h=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.startLineNumber)}this._decorationsTree.delete(p),o||this._onDidChangeDecorations.checkAffectedAndFire(p.options)}}if(u<d){if(!p){let I=++this._lastDecorationId,S=`${this._instanceId};${I}`;p=new Bc(S,0,0),this._decorations[S]=p}let h=i[u],g=this._validateRangeRelaxedNoAllocations(h.range),f=X0(h.options),v=this._buffer.getOffsetAt(g.startLineNumber,g.startColumn),y=this._buffer.getOffsetAt(g.endLineNumber,g.endColumn);p.ownerId=t,p.reset(s,v,y,g),p.setOptions(f),p.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.endLineNumber),p.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.startLineNumber),o||this._onDidChangeDecorations.checkAffectedAndFire(f),this._decorationsTree.insert(p),c[u]=p.id,u++}else p&&delete this._decorations[p.id]}return c}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,n){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,n)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,n)),this._setLanguage(t.languageId,n))}_setLanguage(t,n){this.tokenization.setLanguageId(t,n),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,n){return this.tokenization.getLanguageIdAtPosition(t,n)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,n){return t}getLineIndentColumn(t){return XM(this.getLineContent(t))+1}};jr=ne([M(4,j1),M(5,li),M(6,sr),M(7,St)],jr);function XM(r){let e=0;for(let t of r)if(t===" "||t==="	")e++;else break;return e}function DS(r){return!!(r.options.overviewRuler&&r.options.overviewRuler.color)}function JM(r){return!!r.after||!!r.before}function Gg(r){return!!r.options.after||!!r.options.before}var jg=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new ed,this._decorationsTree1=new ed,this._injectedTextDecorationsTree=new ed}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let n of t)n.range===null&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,o,s){let a=e.getVersionId(),l=this._intervalSearch(t,n,i,o,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,n,i,o,s){let a=this._decorationsTree0.intervalSearch(e,t,n,i,o,s),l=this._decorationsTree1.intervalSearch(e,t,n,i,o,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,o,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,n,i){let o=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,o,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n,!1);return this._ensureNodesHaveRanges(e,i).filter(o=>o.options.showIfCollapsed||!o.range.isEmpty())}getAll(e,t,n,i,o){let s=e.getVersionId(),a=this._search(t,n,i,s,o);return this._ensureNodesHaveRanges(e,a)}_search(e,t,n,i,o){if(n)return this._decorationsTree1.search(e,t,i,o);{let s=this._decorationsTree0.search(e,t,i,o),a=this._decorationsTree1.search(e,t,i,o),l=this._injectedTextDecorationsTree.search(e,t,i,o);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){Gg(e)?this._injectedTextDecorationsTree.insert(e):DS(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){Gg(e)?this._injectedTextDecorationsTree.delete(e):DS(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){Gg(e)?this._injectedTextDecorationsTree.resolveNode(e,t):DS(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}};function Gr(r){return r.replace(/[^a-z0-9\-_]/gi," ")}var qg=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},MS=class extends qg{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}},OS=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},NS=class extends qg{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?A.fromHex(e):t.getColor(e.id)}},$g=class r{static from(e){return e instanceof r?e:new r(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},Un=class r{static EMPTY;static register(e){return new r(e)}static createDynamic(e){return new r(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?Gr(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?Gr(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new MS(e.overviewRuler):null,this.minimap=e.minimap?new NS(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new OS(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?Gr(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?Gr(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?Gr(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?Ww(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?Gr(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?Gr(e.marginClassName):null,this.inlineClassName=e.inlineClassName?Gr(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?Gr(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?Gr(e.afterContentClassName):null,this.after=e.after?$g.from(e.after):null,this.before=e.before?$g.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};Un.EMPTY=Un.register({description:"empty"});var Z0=[Un.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),Un.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),Un.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),Un.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function X0(r){return r instanceof Un?r:Un.createDynamic(r)}var AS=class extends B{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new L);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},FS=class extends B{_fastEmitter=this._register(new L);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new L);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var Ia=G("workingCopyService"),VS=class extends B{_onDidRegister=this._register(new L);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new L);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new hn;mapWorkingCopyToListeners=this._register(new Lr);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let n=new We;return n.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),n.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),n.add(e.onDidSave(i=>this._onDidSave.fire({workingCopy:e,...i}))),this.mapWorkingCopyToListeners.set(e,n),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),ve(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return ae.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let n=this.mapResourceToWorkingCopies.get(e);if(n){if(typeof t=="string")return n.get(t)?.isDirty()??!1;for(let[,i]of n)if(i.isDirty())return!0}return!1}};Jn(Ia,VS,1);var ad=G("labelService");var Eo=class extends qc{_onDidChangeDirty=this._register(new L);_onDidChangeLabel=this._register(new L);_onDidChangeCapabilities=this._register(new L);_onWillDispose=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(ci(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:fl(this.resource,ld.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var pi=class extends Eo{constructor(t,n,i,o,s){super();this.preferredName=t;this.preferredDescription=n;this.secondary=i;this.primary=o;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return pi.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(Ke.once(Ke.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():m("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let n=this.getPreferredDescription();return n||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let n;this.hasIdenticalSides?n=this.primary.getTitle(t)??this.getName():n=super.getTitle(t);let i=this.getPreferredTitle();return i&&(n=`${i} (${n})`),n}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,n){let i=await this.primary.save(t,n);return this.saveResultToEditor(i)}async saveAs(t,n){let i=await this.primary.saveAs(t,n);return this.saveResultToEditor(i)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof Eo)return new pi(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!wo(t)&&!dd(t)&&!hs(t)&&!ms(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,n){return this.primary.revert(t,n)}async rename(t,n){if(!this.hasIdenticalSides)return;let i=await this.primary.rename(t,n);if(i){if(ci(i.editor))return{editor:new pi(this.preferredName,this.preferredDescription,i.editor,i.editor,this.editorService),options:{...i.options,viewState:Yg(this,t,this.editorService)}};if(eL(i.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:i.editor,secondary:i.editor,options:{...i.options,viewState:Yg(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let n=this.primary.toUntyped(t),i=this.secondary.toUntyped(t);if(n&&i&&!wo(n)&&!wo(i)&&!dd(n)&&!dd(i)&&!hs(n)&&!hs(i)&&!ms(n)&&!ms(i)){let o={label:this.preferredName,description:this.preferredDescription,primary:n,secondary:i};return typeof t?.preserveViewState=="number"&&(o.options={viewState:Yg(this,t.preserveViewState,this.editorService)}),o}}matches(t){return this===t?!0:US(t)||wo(t)?!1:t instanceof pi?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):hs(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};pi=ne([M(4,Fi)],pi);var HS={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function tO(r){let e=r;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}var qr=class extends B{constructor(t,n,i){super();this.instantiationService=n;this.configurationService=i;tO(t)?this._id=this.deserialize(t):this._id=qr.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new L({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,n){let i=t===0?this.mru.slice(0):this.editors.slice(0);return n?.excludeSticky?t===0?i.filter(o=>!this.isSticky(o)):i.slice(this.sticky+1):i}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,n){let i=n?.sticky||typeof n?.index=="number"&&this.isSticky(n.index),o=n?.pinned||n?.sticky,s=!!n?.transient,a=n?.active||!this.activeEditor||!o&&this.preview===this.activeEditor,l=this.findEditor(t,n);if(l){let[d,u]=l;return this.doSetTransient(d,u,s===!1?!1:this.isTransient(d)),o&&this.doPin(d,u),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),n&&typeof n.index=="number"&&this.moveEditor(d,n.index),i&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,u=this.indexOf(this.active),c;if(n&&typeof n.index=="number"?c=n.index:this.editorOpenPositioning===HS.FIRST?(c=0,!i&&this.isSticky(c)&&(c=this.sticky+1)):this.editorOpenPositioning===HS.LAST?c=this.editors.length:(this.editorOpenPositioning===HS.LEFT?u===0||!this.editors.length?c=0:c=u:c=u+1,!i&&this.isSticky(c)&&(c=this.sticky+1)),i&&(this.sticky++,this.isSticky(c)||(c=this.sticky)),(o||!this.preview)&&this.splice(c,!1,d),s&&this.doSetTransient(d,c,!0),!o){if(this.preview){let h=this.indexOf(this.preview);c>h&&c--,this.replaceEditor(this.preview,d,c,!a)}this.preview=d}this.registerEditorListeners(d);let p={kind:5,editor:d,editorIndex:c};return this._onDidModelChange.fire(p),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let n=new We;this.editorListeners.add(n),n.add(Ke.once(t.onWillDispose)(()=>{let i=this.editors.indexOf(t);if(i>=0){let o={kind:15,editor:t,editorIndex:i};this._onDidModelChange.fire(o)}})),n.add(t.onDidChangeDirty(()=>{let i={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeLabel(()=>{let i={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeCapabilities(()=>{let i={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(this.onDidModelChange(i=>{i.kind===6&&i.editor?.matches(t)&&(Sn(n),this.editorListeners.delete(n))}))}replaceEditor(t,n,i,o=!0){let s=this.doCloseEditor(t,1,o);if(this.splice(i,!1,n),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,n=0,i=!0){let o=this.doCloseEditor(t,n,i);if(o){let s={kind:6,...o};return this._onDidModelChange.fire(s),o}}doCloseEditor(t,n,i){let o=this.indexOf(t);if(o===-1)return;let s=this.editors[o],a=this.isSticky(o),l=this.active===s;if(i&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:o===this.editors.length-1?d=this.editors[o-1]:d=this.editors[o+1];let u=this.selection.filter(c=>c!==s&&c!==d);this.doSetSelection(d,this.editors.indexOf(d),u)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(u=>u!==s&&u!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(o,!0),{editor:s,sticky:a,editorIndex:o,context:n}}moveEditor(t,n){n>=this.editors.length?n=this.editors.length-1:n<0&&(n=0);let i=this.indexOf(t);if(i<0||n===i)return;let o=this.editors[i],s=this.sticky;this.isSticky(i)&&n>this.sticky?this.sticky--:!this.isSticky(i)&&n<=this.sticky&&this.sticky++,this.editors.splice(i,1),this.editors.splice(n,0,o);let a={kind:7,editor:o,oldEditorIndex:i,editorIndex:n};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:o,editorIndex:n};this._onDidModelChange.fire(l)}return o}setActive(t){let n;return t?n=this.setEditorActive(t):this.setGroupActive(),n}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let n=this.findEditor(t);if(!n)return;let[i,o]=n;return this.doSetSelection(i,o,[]),i}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.doIsSelected(n)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,n){let i=this.findEditor(t);if(!i)return;let[o,s]=i,a=new Set;for(let l of n){let d=this.findEditor(l);if(!d)return;let[u]=d;u!==o&&a.add(u)}this.doSetSelection(o,s,Array.from(a))}doSetSelection(t,n,i){let o=this.activeEditor,s=this.selection,a;t?a=[t,...i]:a=[],this.selection=a;let l=t&&typeof n=="number"&&o!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let u={kind:8,editor:t,editorIndex:n};this._onDidModelChange.fire(u)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let n=this.findEditor(t);if(!n)return;let[i,o]=n;return this.doPin(i,o),i}doPin(t,n){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let i={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(i)}unpin(t){let n=this.findEditor(t);if(!n)return;let[i,o]=n;return this.doUnpin(i,o),i}doUnpin(t,n){if(!this.isPinned(t))return;let i=this.preview;this.preview=t;let o={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(o),i&&this.closeEditor(i,3)}isPinned(t){let n;return typeof t=="number"?n=this.editors[t]:n=t,!this.matches(this.preview,n)}stick(t){let n=this.findEditor(t);if(!n)return;let[i,o]=n;return this.doStick(i,o),i}doStick(t,n){if(this.isSticky(n))return;this.pin(t);let i=this.sticky+1;this.moveEditor(t,i),this.sticky++;let o={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(o)}unstick(t){let n=this.findEditor(t);if(!n)return;let[i,o]=n;return this.doUnstick(i,o),i}doUnstick(t,n){if(!this.isSticky(n))return;let i=this.sticky;this.moveEditor(t,i),this.sticky--;let o={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(o)}isSticky(t){if(this.sticky<0)return!1;let n;return typeof t=="number"?n=t:n=this.indexOf(t),n<0?!1:n<=this.sticky}setTransient(t,n){if(!n&&this.transient.size===0)return;let i=this.findEditor(t);if(!i)return;let[o,s]=i;return this.doSetTransient(o,s,n),o}doSetTransient(t,n,i){if(i){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let o={kind:12,editor:t,editorIndex:n};this._onDidModelChange.fire(o)}isTransient(t){if(this.transient.size===0)return!1;let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.transient.has(n)}splice(t,n,i){let o=this.editors[t];if(n&&this.isSticky(t)&&this.sticky--,i?this.editors.splice(t,n?1:0,i):this.editors.splice(t,n?1:0),!n&&i)this.mru.length===0?this.mru.push(i):this.mru.splice(1,0,i);else{let s=this.indexOf(o,this.mru);n&&!i?this.mru.splice(s,1):n&&i&&this.mru.splice(s,1,i)}}indexOf(t,n=this.editors,i){let o=-1;if(!t)return o;for(let s=0;s<n.length;s++){let a=n[s];if(this.matches(a,t,i))if(i?.supportSideBySide&&a instanceof pi&&!(t instanceof pi))o=s;else{o=s;break}}return o}findEditor(t,n){let i=this.indexOf(t,this.editors,n);if(i!==-1)return[this.editors[i],i]}isFirst(t,n=this.editors){return this.matches(n[0],t)}isLast(t,n=this.editors){return this.matches(n[n.length-1],t)}contains(t,n){return this.indexOf(t,this.editors,n)!==-1}matches(t,n,i){if(!t||!n)return!1;if(i?.supportSideBySide&&t instanceof pi&&!(n instanceof pi))switch(i.supportSideBySide){case 4:if(this.matches(t.primary,n,i)||this.matches(t.secondary,n,i))return!0;break;case 3:if(this.matches(t.primary,n,i)&&this.matches(t.secondary,n,i))return!0;break}let o=t===n;return i?.strictEquals?o:o||t.matches(n)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(qr,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let n of t.editors)t.registerEditorListeners(n);return t}serialize(){let t=Xe.as($c.EditorFactory),n=[],i=[],o,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],u=!1,c=t.getEditorSerializer(d);if(c){let p=c.canSerialize(d)?c.serialize(d):void 0;typeof p=="string"?(u=!0,i.push({id:d.typeId,value:p}),n.push(d),this.preview===d&&(o=n.length-1)):u=!1}!u&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,n)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:i,mru:a,preview:o,sticky:s>=0?s:void 0}}deserialize(t){let n=Xe.as($c.EditorFactory);return typeof t.id=="number"?(this._id=t.id,qr.IDS=Math.max(t.id+1,qr.IDS)):this._id=qr.IDS++,t.locked&&(this.locked=!0),this.editors=$n(t.editors.map((i,o)=>{let s,a=n.getEditorSerializer(i.id);if(a){let l=a.deserialize(this.instantiationService,i.value);l instanceof Eo&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&o<=t.sticky&&t.sticky--,s})),this.mru=$n(t.mru.map(i=>this.editors[i])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){Sn(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};qr=ne([M(1,St),M(2,ln)],qr);var Yc=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},Qg=new Yc,zS=new Yc,KS=new Yc,jS=new Array(230),rO={},oO=[],sO=Object.create(null),aO=Object.create(null);var tL=[],GS=[];for(let r=0;r<=193;r++)tL[r]=-1;for(let r=0;r<=132;r++)GS[r]=-1;(function(){let r="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",r,r],[1,1,"Hyper",0,r,0,r,r,r],[1,2,"Super",0,r,0,r,r,r],[1,3,"Fn",0,r,0,r,r,r],[1,4,"FnLock",0,r,0,r,r,r],[1,5,"Suspend",0,r,0,r,r,r],[1,6,"Resume",0,r,0,r,r,r],[1,7,"Turbo",0,r,0,r,r,r],[1,8,"Sleep",0,r,0,"VK_SLEEP",r,r],[1,9,"WakeUp",0,r,0,r,r,r],[0,10,"KeyA",31,"A",65,"VK_A",r,r],[0,11,"KeyB",32,"B",66,"VK_B",r,r],[0,12,"KeyC",33,"C",67,"VK_C",r,r],[0,13,"KeyD",34,"D",68,"VK_D",r,r],[0,14,"KeyE",35,"E",69,"VK_E",r,r],[0,15,"KeyF",36,"F",70,"VK_F",r,r],[0,16,"KeyG",37,"G",71,"VK_G",r,r],[0,17,"KeyH",38,"H",72,"VK_H",r,r],[0,18,"KeyI",39,"I",73,"VK_I",r,r],[0,19,"KeyJ",40,"J",74,"VK_J",r,r],[0,20,"KeyK",41,"K",75,"VK_K",r,r],[0,21,"KeyL",42,"L",76,"VK_L",r,r],[0,22,"KeyM",43,"M",77,"VK_M",r,r],[0,23,"KeyN",44,"N",78,"VK_N",r,r],[0,24,"KeyO",45,"O",79,"VK_O",r,r],[0,25,"KeyP",46,"P",80,"VK_P",r,r],[0,26,"KeyQ",47,"Q",81,"VK_Q",r,r],[0,27,"KeyR",48,"R",82,"VK_R",r,r],[0,28,"KeyS",49,"S",83,"VK_S",r,r],[0,29,"KeyT",50,"T",84,"VK_T",r,r],[0,30,"KeyU",51,"U",85,"VK_U",r,r],[0,31,"KeyV",52,"V",86,"VK_V",r,r],[0,32,"KeyW",53,"W",87,"VK_W",r,r],[0,33,"KeyX",54,"X",88,"VK_X",r,r],[0,34,"KeyY",55,"Y",89,"VK_Y",r,r],[0,35,"KeyZ",56,"Z",90,"VK_Z",r,r],[0,36,"Digit1",22,"1",49,"VK_1",r,r],[0,37,"Digit2",23,"2",50,"VK_2",r,r],[0,38,"Digit3",24,"3",51,"VK_3",r,r],[0,39,"Digit4",25,"4",52,"VK_4",r,r],[0,40,"Digit5",26,"5",53,"VK_5",r,r],[0,41,"Digit6",27,"6",54,"VK_6",r,r],[0,42,"Digit7",28,"7",55,"VK_7",r,r],[0,43,"Digit8",29,"8",56,"VK_8",r,r],[0,44,"Digit9",30,"9",57,"VK_9",r,r],[0,45,"Digit0",21,"0",48,"VK_0",r,r],[1,46,"Enter",3,"Enter",13,"VK_RETURN",r,r],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",r,r],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",r,r],[1,49,"Tab",2,"Tab",9,"VK_TAB",r,r],[1,50,"Space",10,"Space",32,"VK_SPACE",r,r],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,r,0,r,r,r],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",r,r],[1,64,"F1",59,"F1",112,"VK_F1",r,r],[1,65,"F2",60,"F2",113,"VK_F2",r,r],[1,66,"F3",61,"F3",114,"VK_F3",r,r],[1,67,"F4",62,"F4",115,"VK_F4",r,r],[1,68,"F5",63,"F5",116,"VK_F5",r,r],[1,69,"F6",64,"F6",117,"VK_F6",r,r],[1,70,"F7",65,"F7",118,"VK_F7",r,r],[1,71,"F8",66,"F8",119,"VK_F8",r,r],[1,72,"F9",67,"F9",120,"VK_F9",r,r],[1,73,"F10",68,"F10",121,"VK_F10",r,r],[1,74,"F11",69,"F11",122,"VK_F11",r,r],[1,75,"F12",70,"F12",123,"VK_F12",r,r],[1,76,"PrintScreen",0,r,0,r,r,r],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",r,r],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",r,r],[1,79,"Insert",19,"Insert",45,"VK_INSERT",r,r],[1,80,"Home",14,"Home",36,"VK_HOME",r,r],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",r,r],[1,82,"Delete",20,"Delete",46,"VK_DELETE",r,r],[1,83,"End",13,"End",35,"VK_END",r,r],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",r,r],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",r],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",r],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",r],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",r],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",r,r],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",r,r],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",r,r],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",r,r],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",r,r],[1,94,"NumpadEnter",3,r,0,r,r,r],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",r,r],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",r,r],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",r,r],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",r,r],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",r,r],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",r,r],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",r,r],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",r,r],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",r,r],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",r,r],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",r,r],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",r,r],[1,107,"ContextMenu",58,"ContextMenu",93,r,r,r],[1,108,"Power",0,r,0,r,r,r],[1,109,"NumpadEqual",0,r,0,r,r,r],[1,110,"F13",71,"F13",124,"VK_F13",r,r],[1,111,"F14",72,"F14",125,"VK_F14",r,r],[1,112,"F15",73,"F15",126,"VK_F15",r,r],[1,113,"F16",74,"F16",127,"VK_F16",r,r],[1,114,"F17",75,"F17",128,"VK_F17",r,r],[1,115,"F18",76,"F18",129,"VK_F18",r,r],[1,116,"F19",77,"F19",130,"VK_F19",r,r],[1,117,"F20",78,"F20",131,"VK_F20",r,r],[1,118,"F21",79,"F21",132,"VK_F21",r,r],[1,119,"F22",80,"F22",133,"VK_F22",r,r],[1,120,"F23",81,"F23",134,"VK_F23",r,r],[1,121,"F24",82,"F24",135,"VK_F24",r,r],[1,122,"Open",0,r,0,r,r,r],[1,123,"Help",0,r,0,r,r,r],[1,124,"Select",0,r,0,r,r,r],[1,125,"Again",0,r,0,r,r,r],[1,126,"Undo",0,r,0,r,r,r],[1,127,"Cut",0,r,0,r,r,r],[1,128,"Copy",0,r,0,r,r,r],[1,129,"Paste",0,r,0,r,r,r],[1,130,"Find",0,r,0,r,r,r],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",r,r],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",r,r],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",r,r],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",r,r],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",r,r],[1,136,"KanaMode",0,r,0,r,r,r],[0,137,"IntlYen",0,r,0,r,r,r],[1,138,"Convert",0,r,0,r,r,r],[1,139,"NonConvert",0,r,0,r,r,r],[1,140,"Lang1",0,r,0,r,r,r],[1,141,"Lang2",0,r,0,r,r,r],[1,142,"Lang3",0,r,0,r,r,r],[1,143,"Lang4",0,r,0,r,r,r],[1,144,"Lang5",0,r,0,r,r,r],[1,145,"Abort",0,r,0,r,r,r],[1,146,"Props",0,r,0,r,r,r],[1,147,"NumpadParenLeft",0,r,0,r,r,r],[1,148,"NumpadParenRight",0,r,0,r,r,r],[1,149,"NumpadBackspace",0,r,0,r,r,r],[1,150,"NumpadMemoryStore",0,r,0,r,r,r],[1,151,"NumpadMemoryRecall",0,r,0,r,r,r],[1,152,"NumpadMemoryClear",0,r,0,r,r,r],[1,153,"NumpadMemoryAdd",0,r,0,r,r,r],[1,154,"NumpadMemorySubtract",0,r,0,r,r,r],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",r,r],[1,156,"NumpadClearEntry",0,r,0,r,r,r],[1,0,r,5,"Ctrl",17,"VK_CONTROL",r,r],[1,0,r,4,"Shift",16,"VK_SHIFT",r,r],[1,0,r,6,"Alt",18,"VK_MENU",r,r],[1,0,r,57,"Meta",91,"VK_COMMAND",r,r],[1,157,"ControlLeft",5,r,0,"VK_LCONTROL",r,r],[1,158,"ShiftLeft",4,r,0,"VK_LSHIFT",r,r],[1,159,"AltLeft",6,r,0,"VK_LMENU",r,r],[1,160,"MetaLeft",57,r,0,"VK_LWIN",r,r],[1,161,"ControlRight",5,r,0,"VK_RCONTROL",r,r],[1,162,"ShiftRight",4,r,0,"VK_RSHIFT",r,r],[1,163,"AltRight",6,r,0,"VK_RMENU",r,r],[1,164,"MetaRight",57,r,0,"VK_RWIN",r,r],[1,165,"BrightnessUp",0,r,0,r,r,r],[1,166,"BrightnessDown",0,r,0,r,r,r],[1,167,"MediaPlay",0,r,0,r,r,r],[1,168,"MediaRecord",0,r,0,r,r,r],[1,169,"MediaFastForward",0,r,0,r,r,r],[1,170,"MediaRewind",0,r,0,r,r,r],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",r,r],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",r,r],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",r,r],[1,174,"Eject",0,r,0,r,r,r],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",r,r],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",r,r],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",r,r],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",r,r],[1,179,"LaunchApp1",0,r,0,"VK_MEDIA_LAUNCH_APP1",r,r],[1,180,"SelectTask",0,r,0,r,r,r],[1,181,"LaunchScreenSaver",0,r,0,r,r,r],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",r,r],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",r,r],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",r,r],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",r,r],[1,186,"BrowserStop",0,r,0,"VK_BROWSER_STOP",r,r],[1,187,"BrowserRefresh",0,r,0,"VK_BROWSER_REFRESH",r,r],[1,188,"BrowserFavorites",0,r,0,"VK_BROWSER_FAVORITES",r,r],[1,189,"ZoomToggle",0,r,0,r,r,r],[1,190,"MailReply",0,r,0,r,r,r],[1,191,"MailForward",0,r,0,r,r,r],[1,192,"MailSend",0,r,0,r,r,r],[1,0,r,114,"KeyInComposition",229,r,r,r],[1,0,r,116,"ABNT_C2",194,"VK_ABNT_C2",r,r],[1,0,r,96,"OEM_8",223,"VK_OEM_8",r,r],[1,0,r,0,r,0,"VK_KANA",r,r],[1,0,r,0,r,0,"VK_HANGUL",r,r],[1,0,r,0,r,0,"VK_JUNJA",r,r],[1,0,r,0,r,0,"VK_FINAL",r,r],[1,0,r,0,r,0,"VK_HANJA",r,r],[1,0,r,0,r,0,"VK_KANJI",r,r],[1,0,r,0,r,0,"VK_CONVERT",r,r],[1,0,r,0,r,0,"VK_NONCONVERT",r,r],[1,0,r,0,r,0,"VK_ACCEPT",r,r],[1,0,r,0,r,0,"VK_MODECHANGE",r,r],[1,0,r,0,r,0,"VK_SELECT",r,r],[1,0,r,0,r,0,"VK_PRINT",r,r],[1,0,r,0,r,0,"VK_EXECUTE",r,r],[1,0,r,0,r,0,"VK_SNAPSHOT",r,r],[1,0,r,0,r,0,"VK_HELP",r,r],[1,0,r,0,r,0,"VK_APPS",r,r],[1,0,r,0,r,0,"VK_PROCESSKEY",r,r],[1,0,r,0,r,0,"VK_PACKET",r,r],[1,0,r,0,r,0,"VK_DBE_SBCSCHAR",r,r],[1,0,r,0,r,0,"VK_DBE_DBCSCHAR",r,r],[1,0,r,0,r,0,"VK_ATTN",r,r],[1,0,r,0,r,0,"VK_CRSEL",r,r],[1,0,r,0,r,0,"VK_EXSEL",r,r],[1,0,r,0,r,0,"VK_EREOF",r,r],[1,0,r,0,r,0,"VK_PLAY",r,r],[1,0,r,0,r,0,"VK_ZOOM",r,r],[1,0,r,0,r,0,"VK_NONAME",r,r],[1,0,r,0,r,0,"VK_PA1",r,r],[1,0,r,0,r,0,"VK_OEM_CLEAR",r,r]],t=[],n=[];for(let i of e){let[o,s,a,l,d,u,c,p,h]=i;if(n[s]||(n[s]=!0,oO[s]=a,sO[a]=s,aO[a.toLowerCase()]=s,o&&(tL[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(GS[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);Qg.define(l,d),zS.define(l,p||d),KS.define(l,h||p||d)}u&&(jS[u]=l),c&&(rO[c]=l)}GS[3]=46})();var qS;(s=>{function r(a){return Qg.keyCodeToStr(a)}s.toString=r;function e(a){return Qg.strToKeyCode(a)}s.fromString=e;function t(a){return zS.keyCodeToStr(a)}s.toUserSettingsUS=t;function n(a){return KS.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function i(a){return zS.strToKeyCode(a)||KS.strToKeyCode(a)}s.fromUserSettings=i;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Qg.keyCodeToStr(a)}s.toElectronAccelerator=o})(qS||={});function $S(r,e){if(typeof r=="number"){if(r===0)return null;let t=(r&65535)>>>0,n=(r&4294901760)>>>16;return n!==0?new ud([Zg(t,e),Zg(n,e)]):new ud([Zg(t,e)])}else{let t=[];for(let n=0;n<r.length;n++)t.push(Zg(r[n],e));return new ud(t)}}function Zg(r,e){let t=!!(r&2048),n=!!(r&256),i=e===2?n:t,o=!!(r&1024),s=!!(r&512),a=e===2?t:n,l=r&255;return new Qc(i,o,s,a,l)}var Qc=class r{constructor(e,t,n,i,o){this.ctrlKey=e;this.shiftKey=t;this.altKey=n;this.metaKey=i;this.keyCode=o}equals(e){return e instanceof r&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",n=this.altKey?"1":"0",i=this.metaKey?"1":"0";return`K${e}${t}${n}${i}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new ud([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var ud=class{chords;constructor(e){if(e.length===0)throw sl("chords");this.chords=e}getHashCode(){let e="";for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};var YS=class r{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new mn,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Tr===1){if(e&&e.win)return e.win}else if(Tr===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=r.bindToCurrentPlatform(e),n=new We;if(t&&t.primary){let i=$S(t.primary,Tr);i&&n.add(this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let i=0,o=t.secondary.length;i<o;i++){let s=t.secondary[i],a=$S(s,Tr);a&&n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-i-1,e.when))}return n}setExtensionKeybindings(e){let t=[],n=0;for(let i of e)i.keybinding&&(t[n++]={keybinding:i.keybinding,command:i.id,commandArgs:i.args,when:i.when,weight1:i.weight,weight2:0,extensionId:i.extensionId||null,isBuiltinExtension:i.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return Go(this.registerKeybindingRule(e),Js.registerCommand(e))}_registerDefaultKeybinding(e,t,n,i,o,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:s,weight1:i,weight2:o,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,ve(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(dO)),this._cachedMergedKeybindings.slice(0)}},pd=new YS,lO={EditorModes:"platform.keybindingsRegistry"};Xe.add(lO.EditorModes,pd);function dO(r,e){if(r.weight1!==e.weight1)return r.weight1-e.weight1;if(r.command&&e.command){if(r.command<e.command)return-1;if(r.command>e.command)return 1}return r.weight2-e.weight2}function uO(r){return r.command!==void 0}var Hn=class r{static _instances=new Map;static CommandPalette=new r("CommandPalette");static DebugBreakpointsContext=new r("DebugBreakpointsContext");static DebugCallStackContext=new r("DebugCallStackContext");static DebugConsoleContext=new r("DebugConsoleContext");static DebugVariablesContext=new r("DebugVariablesContext");static NotebookVariablesContext=new r("NotebookVariablesContext");static DebugHoverContext=new r("DebugHoverContext");static DebugWatchContext=new r("DebugWatchContext");static DebugToolBar=new r("DebugToolBar");static DebugToolBarStop=new r("DebugToolBarStop");static DebugCallStackToolbar=new r("DebugCallStackToolbar");static DebugCreateConfiguration=new r("DebugCreateConfiguration");static EditorContext=new r("EditorContext");static SimpleEditorContext=new r("SimpleEditorContext");static EditorContent=new r("EditorContent");static EditorLineNumberContext=new r("EditorLineNumberContext");static EditorContextCopy=new r("EditorContextCopy");static EditorContextPeek=new r("EditorContextPeek");static EditorContextShare=new r("EditorContextShare");static EditorTitle=new r("EditorTitle");static EditorTitleRun=new r("EditorTitleRun");static EditorTitleContext=new r("EditorTitleContext");static EditorTitleContextShare=new r("EditorTitleContextShare");static EmptyEditorGroup=new r("EmptyEditorGroup");static EmptyEditorGroupContext=new r("EmptyEditorGroupContext");static EditorTabsBarContext=new r("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new r("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new r("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new r("EditorActionsPositionSubmenu");static ExplorerContext=new r("ExplorerContext");static ExplorerContextShare=new r("ExplorerContextShare");static ExtensionContext=new r("ExtensionContext");static ExtensionEditorContextMenu=new r("ExtensionEditorContextMenu");static GlobalActivity=new r("GlobalActivity");static CommandCenter=new r("CommandCenter");static CommandCenterCenter=new r("CommandCenterCenter");static LayoutControlMenuSubmenu=new r("LayoutControlMenuSubmenu");static LayoutControlMenu=new r("LayoutControlMenu");static MenubarMainMenu=new r("MenubarMainMenu");static MenubarAppearanceMenu=new r("MenubarAppearanceMenu");static MenubarDebugMenu=new r("MenubarDebugMenu");static MenubarEditMenu=new r("MenubarEditMenu");static MenubarCopy=new r("MenubarCopy");static MenubarFileMenu=new r("MenubarFileMenu");static MenubarGoMenu=new r("MenubarGoMenu");static MenubarHelpMenu=new r("MenubarHelpMenu");static MenubarLayoutMenu=new r("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new r("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new r("PanelAlignmentMenu");static PanelPositionMenu=new r("PanelPositionMenu");static ActivityBarPositionMenu=new r("ActivityBarPositionMenu");static MenubarPreferencesMenu=new r("MenubarPreferencesMenu");static MenubarRecentMenu=new r("MenubarRecentMenu");static MenubarSelectionMenu=new r("MenubarSelectionMenu");static MenubarShare=new r("MenubarShare");static MenubarSwitchEditorMenu=new r("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new r("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new r("MenubarTerminalMenu");static MenubarViewMenu=new r("MenubarViewMenu");static MenubarHomeMenu=new r("MenubarHomeMenu");static OpenEditorsContext=new r("OpenEditorsContext");static OpenEditorsContextShare=new r("OpenEditorsContextShare");static ProblemsPanelContext=new r("ProblemsPanelContext");static SCMInputBox=new r("SCMInputBox");static SCMChangesContext=new r("SCMChangesContext");static SCMChangeContext=new r("SCMChangeContext");static SCMResourceContext=new r("SCMResourceContext");static SCMResourceContextShare=new r("SCMResourceContextShare");static SCMResourceFolderContext=new r("SCMResourceFolderContext");static SCMResourceGroupContext=new r("SCMResourceGroupContext");static SCMSourceControl=new r("SCMSourceControl");static SCMSourceControlInline=new r("SCMSourceControlInline");static SCMSourceControlTitle=new r("SCMSourceControlTitle");static SCMHistoryTitle=new r("SCMHistoryTitle");static SCMTitle=new r("SCMTitle");static SearchContext=new r("SearchContext");static SearchActionMenu=new r("SearchActionContext");static StatusBarWindowIndicatorMenu=new r("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new r("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new r("StickyScrollContext");static TestItem=new r("TestItem");static TestItemGutter=new r("TestItemGutter");static TestProfilesContext=new r("TestProfilesContext");static TestMessageContext=new r("TestMessageContext");static TestMessageContent=new r("TestMessageContent");static TestPeekElement=new r("TestPeekElement");static TestPeekTitle=new r("TestPeekTitle");static TestCallStack=new r("TestCallStack");static TouchBarContext=new r("TouchBarContext");static TitleBarContext=new r("TitleBarContext");static TitleBarTitleContext=new r("TitleBarTitleContext");static TunnelContext=new r("TunnelContext");static TunnelPrivacy=new r("TunnelPrivacy");static TunnelProtocol=new r("TunnelProtocol");static TunnelPortInline=new r("TunnelInline");static TunnelTitle=new r("TunnelTitle");static TunnelLocalAddressInline=new r("TunnelLocalAddressInline");static TunnelOriginInline=new r("TunnelOriginInline");static ViewItemContext=new r("ViewItemContext");static ViewContainerTitle=new r("ViewContainerTitle");static ViewContainerTitleContext=new r("ViewContainerTitleContext");static ViewTitle=new r("ViewTitle");static ViewTitleContext=new r("ViewTitleContext");static CommentEditorActions=new r("CommentEditorActions");static CommentThreadTitle=new r("CommentThreadTitle");static CommentThreadActions=new r("CommentThreadActions");static CommentThreadAdditionalActions=new r("CommentThreadAdditionalActions");static CommentThreadTitleContext=new r("CommentThreadTitleContext");static CommentThreadCommentContext=new r("CommentThreadCommentContext");static CommentTitle=new r("CommentTitle");static CommentActions=new r("CommentActions");static CommentsViewThreadActions=new r("CommentsViewThreadActions");static InteractiveToolbar=new r("InteractiveToolbar");static InteractiveCellTitle=new r("InteractiveCellTitle");static InteractiveCellDelete=new r("InteractiveCellDelete");static InteractiveCellExecute=new r("InteractiveCellExecute");static InteractiveInputExecute=new r("InteractiveInputExecute");static InteractiveInputConfig=new r("InteractiveInputConfig");static ReplInputExecute=new r("ReplInputExecute");static IssueReporter=new r("IssueReporter");static NotebookToolbar=new r("NotebookToolbar");static NotebookStickyScrollContext=new r("NotebookStickyScrollContext");static NotebookCellTitle=new r("NotebookCellTitle");static NotebookCellDelete=new r("NotebookCellDelete");static NotebookCellInsert=new r("NotebookCellInsert");static NotebookCellBetween=new r("NotebookCellBetween");static NotebookCellListTop=new r("NotebookCellTop");static NotebookCellExecute=new r("NotebookCellExecute");static NotebookCellExecuteGoTo=new r("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new r("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new r("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new r("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new r("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new r("NotebookOutputToolbar");static NotebookOutlineFilter=new r("NotebookOutlineFilter");static NotebookOutlineActionMenu=new r("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new r("NotebookEditorLayoutConfigure");static NotebookKernelSource=new r("NotebookKernelSource");static BulkEditTitle=new r("BulkEditTitle");static BulkEditContext=new r("BulkEditContext");static TimelineItemContext=new r("TimelineItemContext");static TimelineTitle=new r("TimelineTitle");static TimelineTitleContext=new r("TimelineTitleContext");static TimelineFilterSubMenu=new r("TimelineFilterSubMenu");static AccountsContext=new r("AccountsContext");static SidebarTitle=new r("SidebarTitle");static PanelTitle=new r("PanelTitle");static AuxiliaryBarTitle=new r("AuxiliaryBarTitle");static AuxiliaryBarHeader=new r("AuxiliaryBarHeader");static TerminalInstanceContext=new r("TerminalInstanceContext");static TerminalEditorInstanceContext=new r("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new r("TerminalNewDropdownContext");static TerminalTabContext=new r("TerminalTabContext");static TerminalTabEmptyAreaContext=new r("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new r("TerminalStickyScrollContext");static WebviewContext=new r("WebviewContext");static InlineCompletionsActions=new r("InlineCompletionsActions");static InlineEditsActions=new r("InlineEditsActions");static InlineEditActions=new r("InlineEditActions");static NewFile=new r("NewFile");static MergeInput1Toolbar=new r("MergeToolbar1Toolbar");static MergeInput2Toolbar=new r("MergeToolbar2Toolbar");static MergeBaseToolbar=new r("MergeBaseToolbar");static MergeInputResultToolbar=new r("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new r("InlineSuggestionToolbar");static InlineEditToolbar=new r("InlineEditToolbar");static ChatContext=new r("ChatContext");static ChatCodeBlock=new r("ChatCodeblock");static ChatCompareBlock=new r("ChatCompareBlock");static ChatMessageTitle=new r("ChatMessageTitle");static ChatExecute=new r("ChatExecute");static ChatExecuteSecondary=new r("ChatExecuteSecondary");static ChatInputSide=new r("ChatInputSide");static AccessibleView=new r("AccessibleView");static MultiDiffEditorFileToolbar=new r("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new r("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new r("DiffEditorSelectionToolbar");static for(e){return r._instances.get(e)??new r(e)}id;constructor(e){if(r._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);r._instances.set(e,this),this.id=e}},sme=G("menuService"),Ca=class r{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new r(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let n of e)n instanceof r&&t.add(n.id);return t}has},nL=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new mh({merge:Ca.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(r){return this._commands.set(r.id,r),this._onDidChangeMenu.fire(Ca.for(Hn.CommandPalette)),ve(()=>{this._commands.delete(r.id)&&this._onDidChangeMenu.fire(Ca.for(Hn.CommandPalette))})}getCommand(r){return this._commands.get(r)}getCommands(){let r=new Map;return this._commands.forEach((e,t)=>r.set(t,e)),r}appendMenuItem(r,e){let t=this._menuItems.get(r);t||(t=new mn,this._menuItems.set(r,t));let n=t.push(e);return this._onDidChangeMenu.fire(Ca.for(r)),ve(()=>{n(),this._onDidChangeMenu.fire(Ca.for(r))})}appendMenuItems(r){let e=new We;for(let{id:t,item:n}of r)e.add(this.appendMenuItem(t,n));return e}getMenuItems(r){let e;return this._menuItems.has(r)?e=[...this._menuItems.get(r)]:e=[],r===Hn.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(r){let e=new Set;for(let t of r)uO(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,n)=>{e.has(n)||r.push({command:t})})}};var Sa=class{constructor(e,t,n,i,o,s,a){this.hideActions=i;this.menuKeybinding=o;this._commandService=a;this.id=e.id,this.label=Sa.label(e,n),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&Nt.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=Nt.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new Sa(t,void 0,n,i,void 0,s,a):void 0,this._options=n,this.class=l&&Nt.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};Sa=ne([M(5,ei),M(6,fo)],Sa);var Jme=G("editorGroupsService");var Fi=G("editorService");var QS=class{constructor(e,t,n){this.id=e;this.dependencies=t;this.callback=n}};var iL=class r{static INSTANCE=new r;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,n)=>{typeof e!="string"&&(n=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(n=t,t=null),this._defineCalls.push(new QS(e,t,n))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${J.vscodeFileResource}://${qy}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=ia();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let n={},i=[],o=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?i.push(n):o.push(s);if(o.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${o.join(", ")}`);return typeof t.callback=="function"?t.callback(...i)??n:t.callback}_rendererLoadScript(e){return new Promise((t,n)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let o=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{o(),t(this._defineCalls.pop())},a=l=>{o(),n(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),i.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,n=(await import("vm")).default,i=(await import("module")).default,o=ae.parse(e).fsPath,s=t.readFileSync(o).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new n.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var XS="utf8";var hfe=512*8,mfe=512*128;var ZS={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},gfe=(()=>{let r={};for(let e in ZS)ZS[e].guessableName&&(r[e]=ZS[e]);return r})();var ur=class extends ds{constructor(t,n,i,o,s,a,l,d,u,c,p,h,g,f,v){super(l,a,f,v);this.resource=t;this.hasAssociatedFilePath=n;this.initialValue=i;this.preferredLanguageId=o;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=u;this.workingCopyService=c;this.textFileService=p;this.labelService=h;this.editorService=g;this._register(this.workingCopyService.registerWorkingCopy(this)),o&&this.setLanguageId(o),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new L);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new L);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new L);onDidRevert=this._onDidRevert.event;typeId=$1;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,n){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let i=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==i&&typeof i=="string"&&(this.configuredEncoding=i,n&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let i=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==i&&(i==="content"||i==="name")&&(this.configuredLabelFormat=i,n&&this._onDidChangeName.fire())}}setLanguageId(t,n){let i=t===ur.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=i,i&&super.setLanguageId(i,n)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let n=this.getEncoding();this.preferredEncoding=t,n!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let n=await this.textFileService.save(this.resource,t);return n&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!n}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(BS(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let n;return this.isResolved()?n=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:XS}):typeof this.initialValue=="string"&&(n=cT(dt.fromString(this.initialValue))),{content:n}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,n=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let o,s=await this.workingCopyBackupService.resolve(this);s?(o=s.value,n=!0):o=pT(dt.fromString(this.initialValue||""));let a=await J0(await this.textFileService.getDecodedStream(this.resource,o,{encoding:XS}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let i=kr(this.textEditorModel);return this.installModelListeners(i),t&&((n||this.initialValue)&&this.updateNameFromFirstLine(i),this.setDirty(this.hasAssociatedFilePath||!!n||!!this.initialValue),(n||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,n){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),n.changes.some(i=>(i.range.startLineNumber===1||i.range.endLineNumber===1)&&i.range.startColumn<=ur.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let n,i=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:ur.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");i=i.substr(0,Ch(i,ur.FIRST_LINE_NAME_MAX_LENGTH)[0]),i&&hc().exec(i)&&(n=i),n!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=n,this._onDidChangeName.fire())}isReadonly(){return!1}};ur=ne([M(5,li),M(6,ga),M(7,dg),M(8,ug),M(9,Ia),M(10,oL),M(11,ad),M(12,Fi),M(13,lg),M(14,ri)],ur);var hO=G("untitledTextEditorService"),_a=class extends B{constructor(t,n){super();this.instantiationService=t;this.configurationService=n}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new L);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new L);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new L);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new hn;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let n=this.doCreateOrGet(t);return await n.resolve(),n}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let n=this.massageOptions(t);return n.untitledResource&&this.mapResourceToModel.has(n.untitledResource)?this.mapResourceToModel.get(n.untitledResource):this.doCreate(n)}massageOptions(t){let n=Object.create(null);if(t.associatedResource?(n.untitledResource=ae.from({scheme:J.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),n.associatedResource=t.associatedResource):t.untitledResource?.scheme===J.untitled&&(n.untitledResource=t.untitledResource),t.languageId)n.languageId=t.languageId;else if(!n.associatedResource){let i=this.configurationService.getValue();i.files?.defaultLanguage&&(n.languageId=i.files.defaultLanguage)}return n.encoding=t.encoding,n.initialValue=t.initialValue,n}doCreate(t){let n=t.untitledResource;if(!n){let o=1;do n=ae.from({scheme:J.untitled,path:`Untitled-${o}`}),o++;while(this.mapResourceToModel.has(n))}let i=this._register(this.instantiationService.createInstance(ur,n,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(i),i}registerModel(t){let n=new We;n.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),n.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),n.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),n.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),Ke.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),n.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===J.untitled&&t.path.length>1&&!_a.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await Ke.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};_a=ne([M(0,St),M(1,ln)],_a);Jn(hO,_a,1);var Xg=gn,gs=G("notificationService");var JS=G("progressService");var Fbe=Object.freeze({total(){},worked(){},done(){}}),sL=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var Jg=class extends B{deferred=new Il;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(ve(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};Jg=ne([M(1,JS)],Jg);var Wbe=G("editorProgressService");var hd=class extends B{constructor(t,n){super();this.logService=t;this.configurationService=n}participants=new mn;addFileOperationParticipant(t){let n=this.participants.push(t);return ve(()=>n())}async participate(t,n,i,o){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,n,i,s,o)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};hd=ne([M(0,ti),M(1,ln)],hd);var zn=class extends B{constructor(t,n,i,o){super();this.getExpression=t;this.shouldUpdate=n;this.contextService=i;this.configurationService=o;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new L);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let n=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),u=this.mapFolderToConfiguredExpression.get(l);d?(!u||!Ci(u.expression,d.expression))&&(n=!0,this.mapFolderToParsedExpression.set(l,aI(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):u&&(n=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let i=new th(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==zn.NO_FOLDER&&(i.has(ae.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),n=!0));let o=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(zn.NO_FOLDER);o?(!s||!Ci(s.expression,o.expression))&&(n=!0,this.mapFolderToParsedExpression.set(zn.NO_FOLDER,aI(o.expression)),this.mapFolderToConfiguredExpression.set(zn.NO_FOLDER,o)):s&&(n=!0,this.mapFolderToParsedExpression.delete(zn.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(zn.NO_FOLDER)),t&&n&&this._onExpressionChange.fire()}doGetExpression(t){let n=this.getExpression(t);if(!n)return;let i=Object.keys(n);if(i.length===0)return;let o=!1,s=Object.create(null);for(let a of i){o||(o=ll(a));let l=a,d=Xw(l,!0);if(d){let u=d.toLowerCase();d!==d.toLowerCase()&&(l=`${u}${l.substring(1)}`)}s[l]=n[a]}return{expression:s,hasAbsolutePath:o}}matches(t,n){if(this.mapFolderToParsedExpression.size===0)return!1;let i=this.contextService.getWorkspaceFolder(t),o,s;if(i&&this.mapFolderToParsedExpression.has(i.uri.toString())?(o=this.mapFolderToParsedExpression.get(i.uri.toString()),s=this.mapFolderToConfiguredExpression.get(i.uri.toString())):(o=this.mapFolderToParsedExpression.get(zn.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(zn.NO_FOLDER)),!o)return!1;let a;return i?a=kh(i.uri,t):a=this.uriToPath(t),typeof a=="string"&&o(a,void 0,n)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!o(this.uriToPath(t),void 0,n):!1}uriToPath(t){return t.scheme===J.file?t.fsPath:t.path}};zn=ne([M(2,Pr),M(3,ln)],zn);var mO=new fe("autoSaveAfterShortDelayContext",!1,!0);var e_=G("filesConfigurationService"),Kn=class extends B{constructor(t,n,i,o,s,a,l,d){super();this.contextKeyService=t;this.configurationService=n;this.contextService=i;this.environmentService=o;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let u=n.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,u.files),this.currentFilesAssociationConfiguration=u?.files?.associations,this.currentHotExitConfiguration=u?.files?.hotExit||Cl.ON_EXIT,this.onFilesConfigurationChange(u,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=qi?Xi.AFTER_DELAY:Xi.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:m("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:m({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:m({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:m({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:m("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new L);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new L);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new L);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new L);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new ki(1e3);autoSaveDisabledOverrides=new hn;autoSaveAfterShortDelayContext=mO.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new Gu(()=>this.createReadonlyMatcher(wT)));readonlyExcludeMatcher=this._register(new Gu(()=>this.createReadonlyMatcher(TT)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new hn(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let n=this._register(new zn(i=>this.configurationService.getValue(t,{resource:i}),i=>i.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(n.onExpressionChange(()=>this._onDidChangeReadonly.fire())),n}isReadonly(t,n){let i=this.fileService.getProvider(t.scheme);if(i&&xT(i))return i.readOnlyMessage??Kn.READONLY_MESSAGES.providerReadonly;let o=this.sessionReadonlyOverrides.get(t);return typeof o=="boolean"?o===!0?Kn.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:Kn.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&n?.locked?Kn.READONLY_MESSAGES.fileLocked:n?.readonly?Kn.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,n){if(n==="toggle"){let i;try{i=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}n=!this.isReadonly(t,i)}n==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,n),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,n){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),n&&this._onDidChangeAutoSaveConfiguration.fire();let i=t?.files?.associations;Ci(this.currentFilesAssociationConfiguration,i)||(this.currentFilesAssociationConfiguration=i,n&&this._onDidChangeFilesAssociation.fire());let o=t?.files?.hotExit;o===Cl.OFF||o===Cl.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=o:this.currentHotExitConfiguration=Cl.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,n&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let n=this.toResource(t);if(n){let i=this.autoSaveConfigurationCache.get(n);return i||(i=this.computeAutoSaveConfiguration(n,this.textResourceConfigurationService.getValue(n,"files")),this.autoSaveConfigurationCache.set(n,i)),i}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,n){let i,o,s,a,l,d;switch(n?.autoSave??Kn.DEFAULT_AUTO_SAVE_MODE){case Xi.AFTER_DELAY:{i="afterDelay",o=typeof n?.autoSaveDelay=="number"&&n.autoSaveDelay>=0?n.autoSaveDelay:Kn.DEFAULT_AUTO_SAVE_DELAY,d=o<=Kn.DEFAULT_AUTO_SAVE_DELAY;break}case Xi.ON_FOCUS_CHANGE:i="onFocusChange";break;case Xi.ON_WINDOW_CHANGE:i="onWindowChange";break}return n?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),n?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:i,autoSaveDelay:o,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof Eo?ld.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let n=this.toResource(t);return this.getAutoSaveConfiguration(n).isShortAutoSaveDelay?!n||!this.autoSaveDisabledOverrides.has(n):!1}getAutoSaveMode(t,n){let i=this.toResource(t);if(i&&this.autoSaveDisabledOverrides.has(i))return{mode:0,reason:4};let o=this.getAutoSaveConfiguration(i);if(typeof o.autoSave>"u")return{mode:0,reason:1};if(typeof n=="number"&&(o.autoSave==="afterDelay"&&n!==2||o.autoSave==="onFocusChange"&&n!==3&&n!==4||o.autoSave==="onWindowChange"&&n!==4))return{mode:0,reason:1};if(i){if(o.autoSaveWorkspaceFilesOnly&&o.isOutOfWorkspace)return{mode:0,reason:2};if(o.autoSaveWhenNoErrors&&this.markerService.read({resource:i,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(o.autoSave){case"afterDelay":return typeof o.autoSaveDelay=="number"&&o.autoSaveDelay<=Kn.DEFAULT_AUTO_SAVE_DELAY?{mode:o.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),n;return[Xi.AFTER_DELAY,Xi.ON_FOCUS_CHANGE,Xi.ON_WINDOW_CHANGE].some(i=>i===t)?n=Xi.OFF:n=Xi.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",n)}disableAutoSave(t){let n=this.toResource(t);if(!n)return B.None;let i=this.autoSaveDisabledOverrides.get(n)??0;return this.autoSaveDisabledOverrides.set(n,i+1),i===0&&this._onDidChangeAutoSaveDisabled.fire(n),ve(()=>{let o=this.autoSaveDisabledOverrides.get(n)??0;o<=1?(this.autoSaveDisabledOverrides.delete(n),this._onDidChangeAutoSaveDisabled.fire(n)):this.autoSaveDisabledOverrides.set(n,o-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==Cl.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,n){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:n})!=="overwriteFileOnDisk"}};Kn=ne([M(0,ei),M(1,ln),M(2,Pr),M(3,$s),M(4,Rl),M(5,An),M(6,k1),M(7,ug)],Kn);Jn(e_,Kn,0);var t_=G("workingCopyEditorService"),Zc=class extends B{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new L);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),ve(()=>this.handlers.delete(t))}findEditor(t){for(let n of this.editorService.getEditors(0))if(this.isOpen(t,n.editor))return n}isOpen(t,n){for(let i of this.handlers)if(i.isOpen(t,n))return!0;return!1}};Zc=ne([M(0,Fi)],Zc);Jn(t_,Zc,1);var lL=G("elevatedFileService");var md=class extends B{constructor(t,n){super();this.resource=t;this.fileService=n;this._register(this.fileService.onDidFilesChange(i=>this.onDidFilesChange(i)))}_onDidChangeOrphaned=this._register(new L);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let n=!1,i;if(this.orphaned?t.contains(this.resource,1)&&(i=!1,n=!0):t.contains(this.resource,2)&&(i=!0,n=!0),n&&this.orphaned!==i){let o=!1;i&&(await Zo(100,Mt.None),this.isDisposed()?o=!0:o=!await this.fileService.exists(this.resource)),this.orphaned!==o&&!this.isDisposed()&&this.setOrphaned(o)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};md=ne([M(1,An)],md);var xa=class extends md{constructor(t,n,i,o,s,a,l,d,u,c,p,h,g,f,v,y){super(n,a);this.typeId=t;this.name=i;this.modelFactory=o;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=u;this.workingCopyBackupService=c;this.notificationService=h;this.workingCopyEditorService=g;this.editorService=f;this.elevatedFileService=v;this.progressService=y;this._register(p.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new L);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new L);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new L);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new L);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let n=this.dirty;this.doSetDirty(t),t!==n&&this._onDidChangeDirty.fire()}doSetDirty(t){let n=this.dirty,i=this.inConflictMode,o=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=n,this.inConflictMode=i,this.inErrorMode=o,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let n,i,o,s;try{let a=await this.fileService.stat(this.resource);n=a.mtime,i=a.ctime,o=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){n=Date.now(),i=Date.now(),o=0,s=$u,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:n,ctime:i,size:o,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:$u,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let n=t?.forceReadFromFile,i;n?i=$u:this.lastResolvedFileStat&&(i=this.lastResolvedFileStat.etag);let o=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:i,limits:t?.limits});if(this.setOrphaned(!1),o!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof em&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!n)return;throw s}}async resolveFromContent(t,n){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!n),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,Mt.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,Mt.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n.isUndoing||n.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,n){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),n&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let i=this.dirty;this.setDirty(!1),i&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let n;this.lastResolvedFileStat&&(n={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let i;return this.isResolved()&&(i=await ju(this.model.snapshot(2,t),t)),{meta:n,content:i}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new $h;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let n=this.versionId;if(this.trace(`doSave(${n}) - enter with versionId ${n}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${n}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(n))return this.trace(`doSave(${n}) - exit - found a running save for versionId ${n}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${n}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${n}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let i=new Ri;return this.progressService.withProgress({title:m("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},o=>this.doSaveSequential(n,t,o,i),()=>{i.cancel()}).finally(()=>{i.dispose()})}doSaveSequential(t,n,i,o){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!n.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(n.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<xa.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await Zo(xa.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!o.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:n.reason??1,savedFrom:n.from},i,o.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(o.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,i.report({message:m("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=kr(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:n.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?$u:s.etag,unlock:n.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,o.token)}catch(u){if(o.token.isCancellationRequested)return;throw u}else{let u=await ju(a.model.snapshot(1,o.token),o.token);if(o.token.isCancellationRequested)return;o.dispose(),n?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,kr(u),l):d=await this.fileService.writeFile(s.resource,kr(u),l)}this.handleSaveSuccess(d,t,n)}catch(l){this.handleSaveError(l,t,n)}})(),()=>o.cancel())})(),()=>o.cancel())}handleSaveSuccess(t,n,i){this.updateLastResolvedFileStat(t),n===this.versionId?(this.trace(`handleSaveSuccess(${n}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${n}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:i.reason,stat:t,source:i.source})}handleSaveError(t,n,i){if((i.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${n}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),i.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,i),this._onDidSaveError.fire()}doHandleSaveError(t,n){let i=t,o=[],s;if(i.fileOperationResult===3)s=m("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),o.push(mo({id:"fileWorkingCopy.overwrite",label:m("overwrite","Overwrite"),run:()=>this.save({...n,ignoreModifiedSince:!0,reason:1})})),o.push(mo({id:"fileWorkingCopy.revert",label:m("revert","Revert"),run:()=>this.revert()}));else{let d=i.fileOperationResult===5,u=d&&i.options?.unlock,c=i.fileOperationResult===6,p=this.elevatedFileService.isSupported(this.resource);dI(t)&&o.push(...t.actions),p&&(c||u)?o.push(mo({id:"fileWorkingCopy.saveElevated",label:u?Fe?m("overwriteElevated","Overwrite as Admin..."):m("overwriteElevatedSudo","Overwrite as Sudo..."):Fe?m("saveElevated","Retry as Admin..."):m("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...n,writeElevated:!0,writeUnlock:u,reason:1})}})):d?o.push(mo({id:"fileWorkingCopy.unlock",label:m("overwrite","Overwrite"),run:()=>this.save({...n,writeUnlock:!0,reason:1})})):o.push(mo({id:"fileWorkingCopy.retry",label:m("retry","Retry"),run:()=>this.save({...n,reason:1})})),o.push(mo({id:"fileWorkingCopy.saveAs",label:m("saveAs","Save As..."),run:async()=>{let h=this.workingCopyEditorService.findEditor(this);h&&((await this.editorService.save(h,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,n))}})),o.push(mo({id:"fileWorkingCopy.revert",label:m("revert","Revert"),run:()=>this.revert()})),d?u&&p?s=Fe?m("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):m("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=m("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):p&&c?s=Fe?m("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):m("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=m({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,Yu(t,!1))}let a=this.notificationService.notify({id:`${Ji(this.resource.toString())}`,severity:Xg.Error,message:s,actions:{primary:o}}),l=this._register(Ke.once(Ke.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(Ke.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let n=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==n&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let n=this.dirty,i=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw i(),s}this._onDidRevert.fire(),n&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};xa=ne([M(5,An),M(6,ti),M(7,n_),M(8,e_),M(9,dg),M(10,Ia),M(11,gs),M(12,t_),M(13,Fi),M(14,lL),M(15,JS)],xa);var gd=class extends B{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let n=Gp(this.saveParticipants,t);return ve(()=>n())}async participate(t,n,i,o){t.model?.pushStackElement();for(let s of this.saveParticipants){if(o.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,n,i,o);await ju(a,o)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};gd=ne([M(0,ti)],gd);var n_=G("workingCopyFileService"),Xc=class extends B{constructor(t,n,i,o){super();this.fileService=t;this.workingCopyService=n;this.instantiationService=i;this.uriIdentityService=o;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new hl);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new hl);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new hl);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,n,i){return this.doCreateFileOrFolder(t,!0,n,i)}createFolder(t,n,i){return this.doCreateFileOrFolder(t,!1,n,i)}async doCreateFileOrFolder(t,n,i,o){if(t.length===0)return[];if(n){let u=(await ho.settled(t.map(c=>this.fileService.canCreateFile(c.resource,{overwrite:c.overwrite})))).find(c=>c instanceof Error);if(u instanceof Error)throw u}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,o,i);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,Mt.None);let l;try{n?l=await ho.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await ho.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,Mt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,Mt.None),l}async move(t,n,i){return this.doMoveOrCopy(t,!0,n,i)}async copy(t,n,i){return this.doMoveOrCopy(t,!1,n,i)}async doMoveOrCopy(t,n,i,o){let s=[];for(let{file:{source:d,target:u},overwrite:c}of t){let p=await(n?this.fileService.canMove(d,u,c):this.fileService.canCopy(d,u,c));if(p instanceof Error)throw p}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,n?2:3,o,i);let l={correlationId:this.correlationIds++,operation:n?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,Mt.None);try{for(let{file:{source:d,target:u},overwrite:c}of t){if(!this.uriIdentityService.extUri.isEqual(d,u)){let p=n?[...this.getDirty(d),...this.getDirty(u)]:this.getDirty(u);await ho.settled(p.map(h=>h.revert({soft:!0})))}n?s.push(await this.fileService.move(d,u,c)):s.push(await this.fileService.copy(d,u,c))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,Mt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,Mt.None),s}async delete(t,n,i){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let o=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(o,1,i,n);let s={correlationId:this.correlationIds++,operation:1,files:o};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,Mt.None);for(let a of t){let l=this.getDirty(a.resource);await ho.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,Mt.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,Mt.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(hd));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,n,i,o){return this.fileOperationParticipants.participate(t,n,i,o)}saveParticipants=this._register(this.instantiationService.createInstance(gd));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,n,i,o){return this.saveParticipants.participate(t,n,i,o)}workingCopyProviders=[];registerWorkingCopyProvider(t){let n=Gp(this.workingCopyProviders,t);return ve(n)}getDirty(t){let n=new Set;for(let i of this.workingCopyProviders)for(let o of i(t))o.isDirty()&&n.add(o);return Array.from(n)}};Xc=ne([M(0,An),M(1,Ia),M(2,St),M(3,Rl)],Xc);Jn(n_,Xc,1);var oL=G("textFileService");var gO;(e=>e.DEFAULT={allowTrailingComma:!0})(gO||={});var fs=G("keybindingService");var i_=".vscode",vO="settings",B_e=`${i_}/${vO}.json`;var V_e=[1],U_e=[2,3,4,5,6],yO=[3,4,5],H_e=[1,...yO],z_e=[2,3,4,5,6],IO=[3,4,5,6],CO=[4,5,6],ef="tasks",dL="launch",uL=Object.create(null);uL[ef]=`${i_}/${ef}.json`;uL[dL]=`${i_}/${dL}.json`;var SO=Object.create(null);SO[ef]=`${ef}.json`;var K_e=ln;var r_=class extends Yl{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,n)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(n).order).forEach(t=>{let n=this._currentResultGroups.get(t);n.result.filterMatches=n.result.filterMatches.filter(i=>!e.has(i.setting.key)),n.result.filterMatches.forEach(i=>e.add(i.setting.key))})}filterSettings(e,t,n){let i=this.filterGroups,o=[];for(let s of i){let a=t(s);for(let l of s.sections)for(let d of l.settings){let u=n(d,s);(a||u)&&o.push({setting:d,matches:u&&u.matches,matchType:u?.matchType??0,score:u?.score??0})}}return o}getPreference(e){for(let t of this.settingsGroups)for(let n of t.sections)for(let i of n.settings)if(e===i.key)return i}collectMetadata(e){let t=Object.create(null),n=!1;return e.forEach(i=>{i.result.metadata&&(t[i.id]=i.result.metadata,n=!0)}),n?t:null}get filterGroups(){return this.settingsGroups}};var tf=class extends r_{constructor(t,n){super();this._defaultSettings=t;this._register(n.onDidChangeConfiguration(i=>{i.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(Xe.as(gc.Configuration).onDidSchemaChange(i=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new L);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,n){return[]}update(){throw new Error("Not supported")}};tf=ne([M(1,ln)],tf);function _O(r){return"// "+m("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+r.getDefaultKeybindingsContent()}var nf=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=_O(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};nf=ne([M(1,fs)],nf);var PEe=G("preferencesService");var $c={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},xO={id:"default",displayName:m("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:m("builtinProviderDisplayName","Built-in")};function Yg(r,e,t){for(let n of t.visibleEditorPanes)if(n.group.id===e&&r.matches(n.input))return n.getViewState()}function eL(r){if(ci(r))return!1;let e=r;return ae.isUri(e?.resource)}function wo(r){if(ci(r))return!1;let e=r;return e?.original!==void 0&&e.modified!==void 0}function dd(r){if(ci(r))return!1;let e=r;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function hs(r){if(ci(r)||wo(r))return!1;let e=r;return e?.primary!==void 0&&e.secondary!==void 0}function ms(r){if(ci(r))return!1;let e=r;return ae.isUri(e?.base?.resource)&&ae.isUri(e?.input1?.resource)&&ae.isUri(e?.input2?.resource)&&ae.isUri(e?.result?.resource)}var o_=class{mapIdToSaveSource=new Map;registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},Wwe=new o_;var qc=class extends B{};function ci(r){return r instanceof qc}function wO(r){let e=r;return ae.isUri(e?.preferredResource)}function TO(r){let e=r;return ci(e?.primary)&&ci(e?.secondary)}function US(r){let e=r;return ci(e?.modified)&&ci(e?.original)}var s_=class{getOriginalUri(e,t){if(!e)return;if(ms(e))return ld.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:o}=this.getSideEditors(e);if(i&&o){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(o,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(i,{filterByScheme:t.filterByScheme})??this.getOriginalUri(o,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:o}}if(wo(e)||dd(e)||hs(e)||ms(e))return;let n=wO(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return TO(e)||hs(e)?{primary:e.primary,secondary:e.secondary}:US(e)||wo(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(ms(e))return ld.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:o}=this.getSideEditors(e);if(i&&o){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(o,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(i,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(o,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:o}}if(wo(e)||dd(e)||hs(e)||ms(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(n=>e.scheme===n))return e}else if(t===e.scheme)return e}};var ld=new s_;var a_=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(St);for(let[n,i]of this.editorSerializerConstructors)this.createEditorSerializer(n,i,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let i=n.createInstance(t);this.editorSerializerInstances.set(e,i)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return kr(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),ve(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};Xe.add($c.EditorFactory,new a_);var cL=G("historyService");var fd=$s;var LO={Quickaccess:"workbench.contributions.quickaccess"},l_=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,n)=>n.prefix.length-t.prefix.length),ve(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return $n([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(n=>e.startsWith(n.prefix))||void 0||this.defaultProvider}clear(){let e=[...this.providers],t=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=e,this.defaultProvider=t}}};Xe.add(LO.Quickaccess,new l_);var vTe=new Nn(()=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}}),yTe=new Nn(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),ITe=new Nn(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));var OTe=Object.freeze({score:0}),NTe=1<<18,ATe=1<<17;var d_=class{constructor(e){this.options=e}getItemLabel(e){return e.label}getItemDescription(e){if(!this.options?.skipDescription)return e.description}getItemPath(e){if(!this.options?.skipPath)return e.resource?.scheme===J.file?e.resource.fsPath:e.resource?.path}},s1e=new d_,pL=G("quickInputService");var RO=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function u_(r,e,t,n,i){if(Nt.isThemeIcon(i))return[`codicon-${i.id}`,"predefined-file-icon"];if(ae.isUri(i))return[];let o=n===2?["rootfolder-icon"]:n===1?["folder-icon"]:["file-icon"];if(t){let s;if(t.scheme===J.data)s=bl.parseMetaData(t).get(bl.META_DATA_LABEL);else{let a=t.path.match(RO);a?(s=rf(a[2].toLowerCase()),a[1]&&o.push(`${rf(a[1].toLowerCase())}-name-dir-icon`)):s=rf(t.authority.toLowerCase())}if(n===2)o.push(`${s}-root-name-folder-icon`);else if(n===1)o.push(`${s}-name-folder-icon`);else{if(s){if(o.push(`${s}-name-file-icon`),o.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)o.push(`${l.slice(d).join(".")}-ext-file-icon`)}o.push("ext-file-icon")}let a=DO(r,e,t);a&&o.push(`${rf(a)}-lang-file-icon`)}}return o}function DO(r,e,t){if(!t)return null;let n=null;if(t.scheme===J.data){let o=bl.parseMetaData(t).get(bl.META_DATA_MIME);o&&(n=e.getLanguageIdByMimeType(o))}else{let i=r.getModel(t);i&&(n=i.getLanguageId())}return n&&n!==or?n:e.guessLanguageIdByFilepathOrFirstLine(t)}function rf(r){return r.replace(/[\s]/g,"/")}function Si(r,e,t){let n=null,i=null;if(typeof t.value=="function"?(n="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(n="get",i=t.get),!i)throw new Error("not supported");let o=`$memoize$${e}`;t[n]=function(...s){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[o]}}function Jc(r,e=0){if(!r||e>200)return r;if(typeof r=="object"){switch(r.$mid){case 1:return ae.revive(r);case 2:return new RegExp(r.source,r.flags);case 17:return new Date(r.source)}if(r instanceof dt||r instanceof Uint8Array)return r;if(Array.isArray(r))for(let t=0;t<r.length;++t)r[t]=Jc(r[t],e+1);else for(let t in r)Object.hasOwnProperty.call(r,t)&&(r[t]=Jc(r[t],e+1))}return r}function hL(r){switch(r){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function mL(r){switch(r){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function bd(r){let e=0;for(let t=0;;t+=7){let n=r.read(1);if(e|=(n.buffer[0]&127)<<t,!(n.buffer[0]&128))return e}}var PO=bs(0);function vd(r,e){if(e===0){r.write(PO);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let n=dt.alloc(t);for(let i=0;e!==0;i++)n.buffer[i]=e&127,e=e>>>7,e>0&&(n.buffer[i]|=128);r.write(n)}var p_=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},h_=class{buffers=[];get buffer(){return dt.concat(this.buffers)}write(e){this.buffers.push(e)}};function bs(r){let e=dt.alloc(1);return e.writeUInt8(r,0),e}var Ea={Undefined:bs(0),String:bs(1),Buffer:bs(2),VSBuffer:bs(3),Array:bs(4),Object:bs(5),Uint:bs(6)},MO=typeof Buffer<"u";function m_(r,e){if(typeof e>"u")r.write(Ea.Undefined);else if(typeof e=="string"){let t=dt.fromString(e);r.write(Ea.String),vd(r,t.byteLength),r.write(t)}else if(MO&&Buffer.isBuffer(e)){let t=dt.wrap(e);r.write(Ea.Buffer),vd(r,t.byteLength),r.write(t)}else if(e instanceof dt)r.write(Ea.VSBuffer),vd(r,e.byteLength),r.write(e);else if(Array.isArray(e)){r.write(Ea.Array),vd(r,e.length);for(let t of e)m_(r,t)}else if(typeof e=="number"&&(e|0)===e)r.write(Ea.Uint),vd(r,e);else{let t=dt.fromString(JSON.stringify(e));r.write(Ea.Object),vd(r,t.byteLength),r.write(t)}}function g_(r){switch(r.read(1).readUInt8(0)){case 0:return;case 1:return r.read(bd(r)).toString();case 2:return r.read(bd(r)).buffer;case 3:return r.read(bd(r));case 4:{let t=bd(r),n=[];for(let i=0;i<t;i++)n.push(g_(r));return n}case 5:return JSON.parse(r.read(bd(r)).toString());case 6:return bd(r)}}var c_=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(n=>this.onBuffer(n)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new L;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(n,i,o){return t.isDisposed?Promise.reject(new kn):t.requestPromise(e,n,i,o)},listen(n,i){return t.isDisposed?Ke.None:t.requestEvent(e,n,i)}}}requestPromise(e,t,n,i=Mt.None){let o=this.lastRequestId++,a={id:o,type:100,channelName:e,name:t,arg:n};if(i.isCancellationRequested)return Promise.reject(new kn);let l;return new Promise((u,c)=>{if(i.isCancellationRequested)return c(new kn);let p=()=>{let v=y=>{switch(y.type){case 201:this.handlers.delete(o),u(y.data);break;case 202:{this.handlers.delete(o);let I=new Error(y.data.message);I.stack=Array.isArray(y.data.stack)?y.data.stack.join(`
`):y.data.stack,I.name=y.data.name,c(I);break}case 203:this.handlers.delete(o),c(y.data);break}};this.handlers.set(o,v),this.sendRequest(a)},h=null;this.state===1?p():(h=Ys(v=>this.whenInitialized()),h.then(()=>{h=null,p()}));let g=()=>{h?(h.cancel(),h=null):this.sendRequest({id:o,type:101}),c(new kn)},f=i.onCancellationRequested(g);l=Go(ve(g),f),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,n){let i=this.lastRequestId++,s={id:i,type:102,channelName:e,name:t,arg:n},a=null,l=new L({onWillAddFirstListener:()=>{a=Ys(u=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),d=u=>l.fire(u.data);return this.handlers.set(i,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${hL(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,hL(e.type));return}}}send(e,t=void 0){let n=new h_;return m_(n,e),m_(n,t),this.sendBuffer(n.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new p_(e),n=g_(t),i=g_(t),o=n[0];switch(o){case 200:return this.logger?.logIncoming(e.byteLength,0,0,mL(o)),this.onResponse({type:n[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,n[1],0,mL(o),i),this.onResponse({type:n[0],id:n[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return Ke.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),Sn(this.activeRequests.values()),this.activeRequests.clear()}};ne([Si],c_.prototype,"onDidInitializePromise",1);var OO;(i=>{function r(o,s,a){let l=o,d=a&&a.disableMarshalling,u=new Map;for(let c in l)t(c)&&u.set(c,Ke.buffer(l[c],!0,void 0,s));return new class{listen(c,p,h){let g=u.get(p);if(g)return g;let f=l[p];if(typeof f=="function"){if(n(p))return f.call(l,h);if(t(p))return u.set(p,Ke.buffer(l[p],!0,void 0,s)),u.get(p)}throw new xr(`Event not found: ${p}`)}call(c,p,h){let g=l[p];if(typeof g=="function"){if(!d&&Array.isArray(h))for(let v=0;v<h.length;v++)h[v]=Jc(h[v]);let f=g.apply(l,h);return f instanceof Promise||(f=Promise.resolve(f)),f}throw new xr(`Method not found: ${p}`)}}}i.fromService=r;function e(o,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):n(d)?function(u){return o.listen(d,u)}:t(d)?o.listen(d):async function(...u){let c;s&&!Di(s.context)?c=[s.context,...u]:c=u;let p=await o.call(d,c);return a?p:Jc(p)};throw new xr(`Property not found: ${String(d)}`)}})}i.toService=e;function t(o){return o[0]==="o"&&o[1]==="n"&&Rr(o.charCodeAt(2))}function n(o){return/^onDynamic/.test(o)&&Rr(o.charCodeAt(9))}})(OO||={});var NO="diagnosticsService",d0e=G(NO);var AO;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,n=0;function i(a,l){if(!t.has(a)){let d=String(++n);t.set(a,d)}return t.get(a)}function o(a,l,d,u){}s.traceSocketEvent=o})(AO||={});var T0e=G("remoteAuthorityResolverService");var W0e=G("remoteSocketFactoryService");var FO="signService",U0e=G(FO);var vLe=30*1e3;var of=G("remoteAgentService"),WLe=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(r){let e=1/0;for(let n=0;n<this.maxSampleCount;n++){let i=await r.getRoundTripTime();if(i===void 0)return;e=Math.min(e,i/2),await Zo(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((n,i)=>n+i,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((n,i)=>n+i,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};function gL(r){return r.scheme!==J.file&&r.scheme!==J.vscodeRemote}function WO(r){if(r.folders.length)return r.folders.every(e=>gL(e.uri))?r.folders[0].uri:void 0;if(r.configuration&&gL(r.configuration))return r.configuration}function fL(r){return WO(r)?.scheme}var sf=G("pathService"),yd=class{constructor(e,t,n,i){this.localUserHome=e;this.remoteAgentService=t;this.environmentService=n;this.contextService=i;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||Tr)(),this.resolveUserHome=(async()=>{let o=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=o?.userHome??e})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(e,t,n){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(i=>this.doHasValidBasename(e,i,t)):this.doHasValidBasename(e,t,n)}doHasValidBasename(e,t,n){return e.scheme===J.file||e.scheme===J.vscodeRemote?Th(n??st(e),t===1):!0}get defaultUriScheme(){return yd.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return J.vscodeRemote;let n=fL(t.getWorkspace());if(n)return n;let i=t.getWorkspace().folders[0];if(i)return i.uri.scheme;let o=t.getWorkspace().configuration;return o?o.scheme:J.file}userHome(e){return e?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?ft:Oe)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){let i=e.indexOf("/",2);i===-1?(t=e.substring(2),e="/"):(t=e.substring(2,i),e=e.substring(i)||"/")}return ae.from({scheme:J.file,authority:t,path:e,query:"",fragment:""})}};yd=ne([M(1,of),M(2,fd),M(3,Pr)],yd);function bL(r,e){let t=r;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var xt=window;var ep=class r{static INSTANCE=new r;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new L;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(n,e),this._onDidChangeZoomLevel.fire(n)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new L;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToFullScreen.set(n,e),this._onDidChangeFullscreen.fire(n)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function BO(r,e,t){typeof e=="string"&&(e=r.matchMedia(e)),e.addEventListener("change",t)}var cke=ep.INSTANCE.onDidChangeZoomLevel;function vL(r){return ep.INSTANCE.getZoomFactor(r)}var pke=ep.INSTANCE.onDidChangeFullscreen,Id=navigator.userAgent,Xt=Id.indexOf("Firefox")>=0,cr=Id.indexOf("AppleWebKit")>=0,vs=Id.indexOf("Chrome")>=0,_i=!vs&&Id.indexOf("Safari")>=0,yL=!vs&&!_i&&cr,hke=Id.indexOf("Electron/")>=0,f_=Id.indexOf("Android")>=0,af=!1;if(typeof xt.matchMedia=="function"){let r=xt.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=xt.matchMedia("(display-mode: fullscreen)");af=r.matches,BO(xt,r,({matches:t})=>{af&&e.matches||(af=t)})}function IL(){return af}var b_={clipboard:{writeText:ao||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:ao||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:ao||IL()?0:navigator.keyboard||_i?1:2,touch:"ontouchstart"in xt||navigator.maxTouchPoints>0,pointerEvents:xt.PointerEvent&&("ontouchstart"in xt||navigator.maxTouchPoints>0)};function VO(r){if(r.charCode){let t=String.fromCharCode(r.charCode).toUpperCase();return qS.fromString(t)}let e=r.keyCode;if(e===3)return 7;if(Xt)switch(e){case 59:return 85;case 60:if(pt)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Me)return 57;break}else if(cr){if(Me&&e===93)return 57;if(!Me&&e===92)return 57}return jS[e]||0}var UO=Me?256:2048,HO=512,zO=1024,KO=Me?2048:256;var xi=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=VO(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=UO),this.altKey&&(t|=HO),this.shiftKey&&(t|=zO),this.metaKey&&(t|=KO),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new Qc(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var SL=new WeakMap;function GO(r){if(!r.parent||r.parent===r)return null;try{let e=r.location,t=r.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return r.parent}var lf=class{static getSameOriginWindowChain(e){let t=SL.get(e);if(!t){t=[],SL.set(e,t);let n=e,i;do i=GO(n),i?t.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):t.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,o=this.getSameOriginWindowChain(e);for(let s of o){let a=s.window.deref();if(n+=a?.scrollY??0,i+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}}};var pr=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=lf.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Ei=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,n=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t;let i=!1;if(vs){let o=navigator.userAgent.match(/Chrome\/(\d+)/);i=(o?parseInt(o[1]):123)<=122}if(e){let o=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof o.wheelDeltaY<"u")i?this.deltaY=o.wheelDeltaY/(120*a):this.deltaY=o.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Xt&&!Me?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof o.wheelDeltaX<"u")_i&&Fe?this.deltaX=-(o.wheelDeltaX/120):i?this.deltaX=o.wheelDeltaX/(120*a):this.deltaX=o.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?Xt&&!Me?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(i?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var{entries:RL,setPrototypeOf:_L,isFrozen:jO,getPrototypeOf:qO,getOwnPropertyDescriptor:$O}=Object,{freeze:Gn,seal:mr,create:YO}=Object,{apply:__,construct:x_}=typeof Reflect<"u"&&Reflect;__||(__=function(e,t,n){return e.apply(t,n)});Gn||(Gn=function(e){return e});mr||(mr=function(e){return e});x_||(x_=function(e,t){return new e(...t)});var QO=Wi(Array.prototype.forEach),xL=Wi(Array.prototype.pop),tp=Wi(Array.prototype.push),cf=Wi(String.prototype.toLowerCase),v_=Wi(String.prototype.toString),ZO=Wi(String.prototype.match),hr=Wi(String.prototype.replace),XO=Wi(String.prototype.indexOf),JO=Wi(String.prototype.trim),wi=Wi(RegExp.prototype.test),np=eN(TypeError);function Wi(r){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return __(r,e,n)}}function eN(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return x_(r,t)}}function Ve(r,e,t){var n;t=(n=t)!==null&&n!==void 0?n:cf,_L&&_L(r,null);let i=e.length;for(;i--;){let o=e[i];if(typeof o=="string"){let s=t(o);s!==o&&(jO(e)||(e[i]=s),o=s)}r[o]=!0}return r}function Cd(r){let e=YO(null);for(let[t,n]of RL(r))e[t]=n;return e}function df(r,e){for(;r!==null;){let n=$O(r,e);if(n){if(n.get)return Wi(n.get);if(typeof n.value=="function")return Wi(n.value)}r=qO(r)}function t(n){return console.warn("fallback value for",n),null}return t}var EL=Gn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),y_=Gn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),I_=Gn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),tN=Gn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),C_=Gn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),nN=Gn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),wL=Gn(["#text"]),TL=Gn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),S_=Gn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),LL=Gn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),uf=Gn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),iN=mr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rN=mr(/<%[\w\W]*|[\w\W]*%>/gm),oN=mr(/\${[\w\W]*}/gm),sN=mr(/^data-[\-\w.\u00B7-\uFFFF]/),aN=mr(/^aria-[\-\w]+$/),DL=mr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),lN=mr(/^(?:\w+script|data):/i),dN=mr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),PL=mr(/^html$/i),kL=Object.freeze({__proto__:null,MUSTACHE_EXPR:iN,ERB_EXPR:rN,TMPLIT_EXPR:oN,DATA_ATTR:sN,ARIA_ATTR:aN,IS_ALLOWED_URI:DL,IS_SCRIPT_OR_DATA:lN,ATTR_WHITESPACE:dN,DOCTYPE_NAME:PL}),uN=()=>typeof window>"u"?null:window,cN=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));let o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function ML(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:uN(),e=Se=>ML(Se);if(e.version="3.0.5",e.removed=[],!r||!r.document||r.document.nodeType!==9)return e.isSupported=!1,e;let t=r.document,n=t.currentScript,{document:i}=r,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:u=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:c,DOMParser:p,trustedTypes:h}=r,g=l.prototype,f=df(g,"cloneNode"),v=df(g,"nextSibling"),y=df(g,"childNodes"),I=df(g,"parentNode");if(typeof s=="function"){let Se=i.createElement("template");Se.content&&Se.content.ownerDocument&&(i=Se.content.ownerDocument)}let S,x="",{implementation:T,createNodeIterator:R,createDocumentFragment:P,getElementsByTagName:O}=i,{importNode:k}=t,F={};e.isSupported=typeof RL=="function"&&typeof I=="function"&&T&&T.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:W,ERB_EXPR:H,TMPLIT_EXPR:$,DATA_ATTR:ee,ARIA_ATTR:K,IS_SCRIPT_OR_DATA:V,ATTR_WHITESPACE:Y}=kL,{IS_ALLOWED_URI:j}=kL,U=null,te=Ve({},[...EL,...y_,...I_,...C_,...wL]),re=null,Ue=Ve({},[...TL,...S_,...LL,...uf]),Te=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),de=null,pn=null,rn=!0,gi=!0,Gi=!1,Ja=!0,Ti=!1,to=!1,gu=!1,el=!1,In=!1,tl=!1,nl=!1,Fp=!0,Wp=!1,me="user-content-",Bp=!0,il=!1,ws={},no=null,Qv=Ve({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Zv=null,Xv=Ve({},["audio","video","img","source","image","track"]),rl=null,Jv=Ve({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fu="http://www.w3.org/1998/Math/MathML",Ts="http://www.w3.org/2000/svg",Sr="http://www.w3.org/1999/xhtml",Ls=Sr,Vp=!1,Up=null,yE=Ve({},[fu,Ts,Sr],v_),Ao,IE=["application/xhtml+xml","text/html"],ce="text/html",q,E=null,z=i.createElement("form"),Q=function(D){return D instanceof RegExp||D instanceof Function},we=function(D){if(!(E&&E===D)){if((!D||typeof D!="object")&&(D={}),D=Cd(D),Ao=IE.indexOf(D.PARSER_MEDIA_TYPE)===-1?Ao=ce:Ao=D.PARSER_MEDIA_TYPE,q=Ao==="application/xhtml+xml"?v_:cf,U="ALLOWED_TAGS"in D?Ve({},D.ALLOWED_TAGS,q):te,re="ALLOWED_ATTR"in D?Ve({},D.ALLOWED_ATTR,q):Ue,Up="ALLOWED_NAMESPACES"in D?Ve({},D.ALLOWED_NAMESPACES,v_):yE,rl="ADD_URI_SAFE_ATTR"in D?Ve(Cd(Jv),D.ADD_URI_SAFE_ATTR,q):Jv,Zv="ADD_DATA_URI_TAGS"in D?Ve(Cd(Xv),D.ADD_DATA_URI_TAGS,q):Xv,no="FORBID_CONTENTS"in D?Ve({},D.FORBID_CONTENTS,q):Qv,de="FORBID_TAGS"in D?Ve({},D.FORBID_TAGS,q):{},pn="FORBID_ATTR"in D?Ve({},D.FORBID_ATTR,q):{},ws="USE_PROFILES"in D?D.USE_PROFILES:!1,rn=D.ALLOW_ARIA_ATTR!==!1,gi=D.ALLOW_DATA_ATTR!==!1,Gi=D.ALLOW_UNKNOWN_PROTOCOLS||!1,Ja=D.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ti=D.SAFE_FOR_TEMPLATES||!1,to=D.WHOLE_DOCUMENT||!1,In=D.RETURN_DOM||!1,tl=D.RETURN_DOM_FRAGMENT||!1,nl=D.RETURN_TRUSTED_TYPE||!1,el=D.FORCE_BODY||!1,Fp=D.SANITIZE_DOM!==!1,Wp=D.SANITIZE_NAMED_PROPS||!1,Bp=D.KEEP_CONTENT!==!1,il=D.IN_PLACE||!1,j=D.ALLOWED_URI_REGEXP||DL,Ls=D.NAMESPACE||Sr,Te=D.CUSTOM_ELEMENT_HANDLING||{},D.CUSTOM_ELEMENT_HANDLING&&Q(D.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Te.tagNameCheck=D.CUSTOM_ELEMENT_HANDLING.tagNameCheck),D.CUSTOM_ELEMENT_HANDLING&&Q(D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Te.attributeNameCheck=D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),D.CUSTOM_ELEMENT_HANDLING&&typeof D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Te.allowCustomizedBuiltInElements=D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ti&&(gi=!1),tl&&(In=!0),ws&&(U=Ve({},[...wL]),re=[],ws.html===!0&&(Ve(U,EL),Ve(re,TL)),ws.svg===!0&&(Ve(U,y_),Ve(re,S_),Ve(re,uf)),ws.svgFilters===!0&&(Ve(U,I_),Ve(re,S_),Ve(re,uf)),ws.mathMl===!0&&(Ve(U,C_),Ve(re,LL),Ve(re,uf))),D.ADD_TAGS&&(U===te&&(U=Cd(U)),Ve(U,D.ADD_TAGS,q)),D.ADD_ATTR&&(re===Ue&&(re=Cd(re)),Ve(re,D.ADD_ATTR,q)),D.ADD_URI_SAFE_ATTR&&Ve(rl,D.ADD_URI_SAFE_ATTR,q),D.FORBID_CONTENTS&&(no===Qv&&(no=Cd(no)),Ve(no,D.FORBID_CONTENTS,q)),Bp&&(U["#text"]=!0),to&&Ve(U,["html","head","body"]),U.table&&(Ve(U,["tbody"]),delete de.tbody),D.TRUSTED_TYPES_POLICY){if(typeof D.TRUSTED_TYPES_POLICY.createHTML!="function")throw np('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof D.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw np('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=D.TRUSTED_TYPES_POLICY,x=S.createHTML("")}else S===void 0&&(S=cN(h,n)),S!==null&&typeof x=="string"&&(x=S.createHTML(""));Gn&&Gn(D),E=D}},$e=Ve({},["mi","mo","mn","ms","mtext"]),on=Ve({},["foreignobject","desc","title","annotation-xml"]),Cn=Ve({},["title","style","font","a","script"]),Ln=Ve({},y_);Ve(Ln,I_),Ve(Ln,tN);let bu=Ve({},C_);Ve(bu,nN);let Vk=function(D){let Z=I(D);(!Z||!Z.tagName)&&(Z={namespaceURI:Ls,tagName:"template"});let le=cf(D.tagName),at=cf(Z.tagName);return Up[D.namespaceURI]?D.namespaceURI===Ts?Z.namespaceURI===Sr?le==="svg":Z.namespaceURI===fu?le==="svg"&&(at==="annotation-xml"||$e[at]):!!Ln[le]:D.namespaceURI===fu?Z.namespaceURI===Sr?le==="math":Z.namespaceURI===Ts?le==="math"&&on[at]:!!bu[le]:D.namespaceURI===Sr?Z.namespaceURI===Ts&&!on[at]||Z.namespaceURI===fu&&!$e[at]?!1:!bu[le]&&(Cn[le]||!Ln[le]):!!(Ao==="application/xhtml+xml"&&Up[D.namespaceURI]):!1},ks=function(D){tp(e.removed,{element:D});try{D.parentNode.removeChild(D)}catch{D.remove()}},ey=function(D,Z){try{tp(e.removed,{attribute:Z.getAttributeNode(D),from:Z})}catch{tp(e.removed,{attribute:null,from:Z})}if(Z.removeAttribute(D),D==="is"&&!re[D])if(In||tl)try{ks(Z)}catch{}else try{Z.setAttribute(D,"")}catch{}},CE=function(D){let Z,le;if(el)D="<remove></remove>"+D;else{let Li=ZO(D,/^[\r\n\t ]+/);le=Li&&Li[0]}Ao==="application/xhtml+xml"&&Ls===Sr&&(D='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+D+"</body></html>");let at=S?S.createHTML(D):D;if(Ls===Sr)try{Z=new p().parseFromString(at,Ao)}catch{}if(!Z||!Z.documentElement){Z=T.createDocument(Ls,"template",null);try{Z.documentElement.innerHTML=Vp?x:at}catch{}}let sn=Z.body||Z.documentElement;return D&&le&&sn.insertBefore(i.createTextNode(le),sn.childNodes[0]||null),Ls===Sr?O.call(Z,to?"html":"body")[0]:to?Z.documentElement:sn},SE=function(D){return R.call(D.ownerDocument||D,D,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},Uk=function(D){return D instanceof c&&(typeof D.nodeName!="string"||typeof D.textContent!="string"||typeof D.removeChild!="function"||!(D.attributes instanceof u)||typeof D.removeAttribute!="function"||typeof D.setAttribute!="function"||typeof D.namespaceURI!="string"||typeof D.insertBefore!="function"||typeof D.hasChildNodes!="function")},Hp=function(D){return typeof a=="object"?D instanceof a:D&&typeof D=="object"&&typeof D.nodeType=="number"&&typeof D.nodeName=="string"},io=function(D,Z,le){F[D]&&QO(F[D],at=>{at.call(e,Z,le,E)})},_E=function(D){let Z;if(io("beforeSanitizeElements",D,null),Uk(D))return ks(D),!0;let le=q(D.nodeName);if(io("uponSanitizeElement",D,{tagName:le,allowedTags:U}),D.hasChildNodes()&&!Hp(D.firstElementChild)&&(!Hp(D.content)||!Hp(D.content.firstElementChild))&&wi(/<[/\w]/g,D.innerHTML)&&wi(/<[/\w]/g,D.textContent))return ks(D),!0;if(!U[le]||de[le]){if(!de[le]&&EE(le)&&(Te.tagNameCheck instanceof RegExp&&wi(Te.tagNameCheck,le)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(le)))return!1;if(Bp&&!no[le]){let at=I(D)||D.parentNode,sn=y(D)||D.childNodes;if(sn&&at){let Li=sn.length;for(let Lt=Li-1;Lt>=0;--Lt)at.insertBefore(f(sn[Lt],!0),v(D))}}return ks(D),!0}return D instanceof l&&!Vk(D)||(le==="noscript"||le==="noembed"||le==="noframes")&&wi(/<\/no(script|embed|frames)/i,D.innerHTML)?(ks(D),!0):(Ti&&D.nodeType===3&&(Z=D.textContent,Z=hr(Z,W," "),Z=hr(Z,H," "),Z=hr(Z,$," "),D.textContent!==Z&&(tp(e.removed,{element:D.cloneNode()}),D.textContent=Z)),io("afterSanitizeElements",D,null),!1)},xE=function(D,Z,le){if(Fp&&(Z==="id"||Z==="name")&&(le in i||le in z))return!1;if(!(gi&&!pn[Z]&&wi(ee,Z))){if(!(rn&&wi(K,Z))){if(!re[Z]||pn[Z]){if(!(EE(D)&&(Te.tagNameCheck instanceof RegExp&&wi(Te.tagNameCheck,D)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(D))&&(Te.attributeNameCheck instanceof RegExp&&wi(Te.attributeNameCheck,Z)||Te.attributeNameCheck instanceof Function&&Te.attributeNameCheck(Z))||Z==="is"&&Te.allowCustomizedBuiltInElements&&(Te.tagNameCheck instanceof RegExp&&wi(Te.tagNameCheck,le)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(le))))return!1}else if(!rl[Z]){if(!wi(j,hr(le,Y,""))){if(!((Z==="src"||Z==="xlink:href"||Z==="href")&&D!=="script"&&XO(le,"data:")===0&&Zv[D])){if(!(Gi&&!wi(V,hr(le,Y,"")))){if(le)return!1}}}}}}return!0},EE=function(D){return D.indexOf("-")>0},wE=function(D){let Z,le,at,sn;io("beforeSanitizeAttributes",D,null);let{attributes:Li}=D;if(!Li)return;let Lt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re};for(sn=Li.length;sn--;){Z=Li[sn];let{name:_r,namespaceURI:ty}=Z;if(le=_r==="value"?Z.value:JO(Z.value),at=q(_r),Lt.attrName=at,Lt.attrValue=le,Lt.keepAttr=!0,Lt.forceKeepAttr=void 0,io("uponSanitizeAttribute",D,Lt),le=Lt.attrValue,Lt.forceKeepAttr||(ey(_r,D),!Lt.keepAttr))continue;if(!Ja&&wi(/\/>/i,le)){ey(_r,D);continue}Ti&&(le=hr(le,W," "),le=hr(le,H," "),le=hr(le,$," "));let TE=q(D.nodeName);if(xE(TE,at,le)){if(Wp&&(at==="id"||at==="name")&&(ey(_r,D),le=me+le),S&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!ty)switch(h.getAttributeType(TE,at)){case"TrustedHTML":{le=S.createHTML(le);break}case"TrustedScriptURL":{le=S.createScriptURL(le);break}}try{ty?D.setAttributeNS(ty,_r,le):D.setAttribute(_r,le),xL(e.removed)}catch{}}}io("afterSanitizeAttributes",D,null)},Hk=function Se(D){let Z,le=SE(D);for(io("beforeSanitizeShadowDOM",D,null);Z=le.nextNode();)io("uponSanitizeShadowNode",Z,null),!_E(Z)&&(Z.content instanceof o&&Se(Z.content),wE(Z));io("afterSanitizeShadowDOM",D,null)};return e.sanitize=function(Se){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Z,le,at,sn;if(Vp=!Se,Vp&&(Se="<!-->"),typeof Se!="string"&&!Hp(Se))if(typeof Se.toString=="function"){if(Se=Se.toString(),typeof Se!="string")throw np("dirty is not a string, aborting")}else throw np("toString is not a function");if(!e.isSupported)return Se;if(gu||we(D),e.removed=[],typeof Se=="string"&&(il=!1),il){if(Se.nodeName){let _r=q(Se.nodeName);if(!U[_r]||de[_r])throw np("root node is forbidden and cannot be sanitized in-place")}}else if(Se instanceof a)Z=CE("<!---->"),le=Z.ownerDocument.importNode(Se,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?Z=le:Z.appendChild(le);else{if(!In&&!Ti&&!to&&Se.indexOf("<")===-1)return S&&nl?S.createHTML(Se):Se;if(Z=CE(Se),!Z)return In?null:nl?x:""}Z&&el&&ks(Z.firstChild);let Li=SE(il?Se:Z);for(;at=Li.nextNode();)_E(at)||(at.content instanceof o&&Hk(at.content),wE(at));if(il)return Se;if(In){if(tl)for(sn=P.call(Z.ownerDocument);Z.firstChild;)sn.appendChild(Z.firstChild);else sn=Z;return(re.shadowroot||re.shadowrootmode)&&(sn=k.call(t,sn,!0)),sn}let Lt=to?Z.outerHTML:Z.innerHTML;return to&&U["!doctype"]&&Z.ownerDocument&&Z.ownerDocument.doctype&&Z.ownerDocument.doctype.name&&wi(PL,Z.ownerDocument.doctype.name)&&(Lt="<!DOCTYPE "+Z.ownerDocument.doctype.name+`>
`+Lt),Ti&&(Lt=hr(Lt,W," "),Lt=hr(Lt,H," "),Lt=hr(Lt,$," ")),S&&nl?S.createHTML(Lt):Lt},e.setConfig=function(Se){we(Se),gu=!0},e.clearConfig=function(){E=null,gu=!1},e.isValidAttribute=function(Se,D,Z){E||we({});let le=q(Se),at=q(D);return xE(le,at,Z)},e.addHook=function(Se,D){typeof D=="function"&&(F[Se]=F[Se]||[],tp(F[Se],D))},e.removeHook=function(Se){if(F[Se])return xL(F[Se])},e.removeHooks=function(Se){F[Se]&&(F[Se]=[])},e.removeAllHooks=function(){F={}},e}var $r=ML();var Ske=$r.version,_ke=$r.isSupported,pN=$r.sanitize,xke=$r.setConfig,Eke=$r.clearConfig,wke=$r.isValidAttribute,hN=$r.addHook,mN=$r.removeHook,Tke=$r.removeHooks,Lke=$r.removeAllHooks;var{registerWindow:$ke,getWindow:_e,getDocument:Yke,getWindows:fN,getWindowsCount:bN,getWindowId:Sd,getWindowById:T_,hasWindow:Qke,onDidRegisterWindow:NL,onWillUnregisterWindow:Zke,onDidUnregisterWindow:AL}=function(){let r=new Map;bL(xt,1);let e={window:xt,disposables:new We};r.set(xt.vscodeWindowId,e);let t=new L,n=new L,i=new L;function o(s,a){return(typeof s=="number"?r.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:i.event,onDidUnregisterWindow:n.event,registerWindow(s){if(r.has(s.vscodeWindowId))return B.None;let a=new We,l={window:s,disposables:a.add(new We)};return r.set(s.vscodeWindowId,l),a.add(ve(()=>{r.delete(s.vscodeWindowId),n.fire(s)})),a.add(oe(s,De.BEFORE_UNLOAD,()=>{i.fire(s)})),t.fire(l),a},getWindows(){return r.values()},getWindowsCount(){return r.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return r.has(s)},getWindowById:o,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:xt},getDocument(s){return _e(s).document}}}();function hf(r){for(;r.firstChild;)r.firstChild.remove()}var E_=class{_handler;_node;_type;_options;constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function oe(r,e,t,n){return new E_(r,e,t,n)}function vN(r,e){return function(t){return e(new pr(r,t))}}function yN(r){return function(e){return r(new xi(e))}}var To=function(e,t,n,i){let o=n;return t==="click"||t==="mousedown"||t==="contextmenu"?o=vN(_e(e),n):(t==="keydown"||t==="keypress"||t==="keyup")&&(o=yN(n)),oe(e,t,o,i)};function rp(r,e,t){return yl(r,e,t)}var L_,Bi;var _d=class extends jh{defaultTarget;constructor(e){super(),this.defaultTarget=e&&_e(e)}cancelAndSet(e,t,n){return super.cancelAndSet(e,t,n??this.defaultTarget)}},ip=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Le(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let r=new Map,e=new Map,t=new Map,n=new Map,i=o=>{t.set(o,!1);let s=r.get(o)??[];for(e.set(o,s),r.set(o,[]),n.set(o,!0);s.length>0;)s.sort(ip.sort),s.shift().execute();n.set(o,!1)};Bi=(o,s,a=0)=>{let l=Sd(o),d=new ip(s,a),u=r.get(l);return u||(u=[],r.set(l,u)),u.push(d),t.get(l)||(t.set(l,!0),o.requestAnimationFrame(()=>i(l))),d},L_=(o,s,a)=>{let l=Sd(o);if(n.get(l)){let d=new ip(s,a),u=e.get(l);return u||(u=[],e.set(l,u)),u.push(d),d}else return Bi(o,s,a)}})();function k_(r,e){let t=_e(r),n=t.document;if(r!==n.body)return new wa(r.clientWidth,r.clientHeight);if(Yp&&t?.visualViewport)return new wa(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new wa(t.innerWidth,t.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new wa(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new wa(n.documentElement.clientWidth,n.documentElement.clientHeight);if(e)return k_(e);throw new Error("Unable to figure out browser width and height")}var wa=class r{constructor(e,t){this.width=e;this.height=t}static None=new r(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new r(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof r?e:new r(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function gr(r){let e=r.getBoundingClientRect(),t=_e(r);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function OL(r,e){return!!e?.contains(r)}function IN(r){return r&&!!r.host&&!!r.mode}function Is(r){for(;r.parentNode;){if(r===r.ownerDocument?.body)return null;r=r.parentNode}return IN(r)?r:null}function La(){let r=op().activeElement;for(;r?.shadowRoot;)r=r.shadowRoot.activeElement;return r}function op(){return bN()<=1?xt.document:Array.from(fN()).map(({window:e})=>e.document).find(e=>e.hasFocus())??xt.document}function Yr(){return op().defaultView?.window??xt}var Xke=new class{mutationObservers=new Map;observe(r,e,t){let n=this.mutationObservers.get(r);n||(n=new Map,this.mutationObservers.set(r,n));let i=Ji(t),o=n.get(i);if(o)o.users+=1;else{let s=new L,a=new MutationObserver(d=>s.fire(d));a.observe(r,t);let l=o={users:1,observer:a,onDidMutate:s.event};e.add(ve(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),n?.delete(i),n?.size===0&&this.mutationObservers.delete(r))})),n.set(i,o)}return o.onDidMutate}};function Ta(r){return r instanceof HTMLElement||r instanceof _e(r).HTMLElement}function FL(r){return r instanceof KeyboardEvent||r instanceof _e(r).KeyboardEvent}var De={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:cr?"webkitAnimationStart":"animationstart",ANIMATION_END:cr?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:cr?"webkitAnimationIteration":"animationiteration"};function WL(r){let e=[];for(let t=0;r&&r.nodeType===r.ELEMENT_NODE;t++)e[t]=r.scrollTop,r=r.parentNode;return e}function BL(r,e){for(let t=0;r&&r.nodeType===r.ELEMENT_NODE;t++)r.scrollTop!==e[t]&&(r.scrollTop=e[t]),r=r.parentNode}var w_=class r extends B{_onDidFocus=this._register(new L);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new L);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(Ta(e)){let t=Is(e),n=t?t.activeElement:e.ownerDocument.activeElement;return OL(n,e)}else{let t=e;return OL(t.document.activeElement,t.document)}}constructor(e){super();let t=r.hasFocusWithin(e),n=!1,i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},o=()=>{t&&(n=!0,(Ta(e)?_e(e):e).setTimeout(()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{r.hasFocusWithin(e)!==t&&(t?o():i())},this._register(oe(e,De.FOCUS,i,!0)),this._register(oe(e,De.BLUR,o,!0)),Ta(e)&&(this._register(oe(e,De.FOCUS_IN,()=>this._refreshStateHandler())),this._register(oe(e,De.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function R_(r){return new w_(r)}var CN=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function VL(r,e,t,...n){let i=CN.exec(e);if(!i)throw new Error("Bad use of emmet");let o=i[1]||"div",s;return r!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(r,o):s=document.createElement(o),i[3]&&(s.id=i[3]),i[4]&&(s.className=i[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...n),s}function UL(r,e,...t){return VL("http://www.w3.org/1999/xhtml",r,e,...t)}UL.SVG=function(r,e,...t){return VL("http://www.w3.org/2000/svg",r,e,...t)};function D_(r,e){let t=r.devicePixelRatio*e;return Math.max(1,Math.floor(t))/r.devicePixelRatio}Lh.setPreferredWebSchema(/^https:/.test(xt.location.href)?"https":"http");function HL(r,e){let t;if(ae.isUri(r))t=r.toString(!0);else{let o=new Blob([r]);t=URL.createObjectURL(o),setTimeout(()=>URL.revokeObjectURL(t))}let n=Yr(),i=document.createElement("a");n.document.body.appendChild(i),i.download=e,i.href=t,i.click(),setTimeout(()=>i.remove())}function zL(){return new Promise(r=>{let e=Yr(),t=document.createElement("input");e.document.body.appendChild(t),t.type="file",t.multiple=!0,Ke.once(Ke.fromDOMEventEmitter(t,"input"))(()=>{r(t.files??void 0)}),t.click(),setTimeout(()=>t.remove())})}var Jke=[J.http,J.https,J.command],eRe=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),tRe=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});var pf=class extends B{constructor(t,n){super();this.element=t;this.callbacks=n;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(oe(this.element,De.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(oe(this.element,De.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(oe(this.element,De.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(oe(this.element,De.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(oe(this.element,De.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(oe(this.element,De.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(oe(this.element,De.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}};function KL(r){return r.tagName.toLowerCase()==="input"||r.tagName.toLowerCase()==="textarea"||Ta(r)&&!!r.editContext}var GL;(n=>{n.ID="workbench.action.files.openLocalFile",n.LABEL=m("openLocalFile","Open Local File...");function t(){return i=>i.get(qs).pickFileAndOpen({forceNewWindow:!1,availableFileSystems:[J.file]})}n.handler=t})(GL||={});var jL;(n=>{n.ID="workbench.action.files.saveLocalFile",n.LABEL=m("saveLocalFile","Save Local File...");function t(){return i=>{let o=i.get(Fi),s=o.activeEditorPane;return s?o.save({groupId:s.group.id,editor:s.input},{saveAs:!0,availableFileSystems:[J.file],reason:1}):Promise.resolve(void 0)}}n.handler=t})(jL||={});var qL;(n=>{n.ID="workbench.action.files.openLocalFolder",n.LABEL=m("openLocalFolder","Open Local Folder...");function t(){return i=>i.get(qs).pickFolderAndOpen({forceNewWindow:!1,availableFileSystems:[J.file]})}n.handler=t})(qL||={});var $L;(n=>{n.ID="workbench.action.files.openLocalFileFolder",n.LABEL=m("openLocalFileFolder","Open Local...");function t(){return i=>i.get(qs).pickFileFolderAndOpen({forceNewWindow:!1,availableFileSystems:[J.file]})}n.handler=t})($L||={});var SN=new fe("remoteFileDialogVisible",!1),xd=class extends B{constructor(t,n,i,o,s,a,l,d,u,c,p,h,g,f){super();this.fileService=t;this.quickInputService=n;this.labelService=i;this.workspaceContextService=o;this.notificationService=s;this.fileDialogService=a;this.modelService=l;this.languageService=d;this.environmentService=u;this.remoteAgentService=c;this.pathService=p;this.keybindingService=h;this.accessibilityService=f;this.remoteAuthority=this.environmentService.remoteAuthority,this.contextKey=SN.bindTo(g),this.scheme=this.pathService.defaultUriScheme}options;currentFolder;filePickBox;hidden=!1;allowFileSelection=!0;allowFolderSelection=!1;remoteAuthority;requiresTrailing=!1;trailing;scheme;contextKey;userEnteredPathSegment="";autoCompletePathSegment="";activeItem;userHome;trueHome;isWindows=!1;badPath;remoteAgentEnvironment;separator="/";onBusyChangeEmitter=this._register(new L);updatingPromise;set busy(t){this.filePickBox.busy!==t&&(this.filePickBox.busy=t,this.onBusyChangeEmitter.fire(t))}get busy(){return this.filePickBox.busy}async showOpenDialog(t={}){this.scheme=this.getScheme(t.availableFileSystems,t.defaultUri),this.userHome=await this.getUserHome(),this.trueHome=await this.getUserHome(!0);let n=this.getOptions(t);return n?(this.options=n,this.pickResource()):Promise.resolve(void 0)}async showSaveDialog(t){this.scheme=this.getScheme(t.availableFileSystems,t.defaultUri),this.userHome=await this.getUserHome(),this.trueHome=await this.getUserHome(!0),this.requiresTrailing=!0;let n=this.getOptions(t,!0);return n?(this.options=n,this.options.canSelectFolders=!0,this.options.canSelectFiles=!0,new Promise(i=>{this.pickResource(!0).then(o=>{i(o)})})):Promise.resolve(void 0)}getOptions(t,n=!1){let i,o;if(t.defaultUri&&(i=this.scheme===t.defaultUri.scheme?t.defaultUri:void 0,o=n?st(t.defaultUri):void 0),i||(i=this.userHome,o&&(i=zt(i,o))),this.scheme!==J.file&&!this.fileService.hasProvider(i)){this.notificationService.info(m("remoteFileDialog.notConnectedToRemote","File system provider for {0} is not available.",i.toString()));return}let s=vl(t);return s.defaultUri=i,s}remoteUriFrom(t,n){t.startsWith("\\\\")||(t=t.replace(/\\/g,"/"));let i=this.scheme===J.file?ae.file(t):ae.from({scheme:this.scheme,path:t,query:n?.query,fragment:n?.fragment}),o=i.scheme===J.file?void 0:this.remoteAuthority??n?.authority;return Dh(i,o,o?this.pathService.defaultUriScheme:i.scheme)}getScheme(t,n){return t&&t.length>0?n&&t.indexOf(n.scheme)>=0?n.scheme:t[0]:n?n.scheme:J.file}async getRemoteAgentEnvironment(){return this.remoteAgentEnvironment===void 0&&(this.remoteAgentEnvironment=await this.remoteAgentService.getEnvironment()),this.remoteAgentEnvironment}getUserHome(t=!1){return t?this.pathService.userHome({preferLocal:this.scheme===J.file}):this.fileDialogService.preferredHome(this.scheme)}async pickResource(t=!1){this.allowFolderSelection=!!this.options.canSelectFolders,this.allowFileSelection=!!this.options.canSelectFiles,this.separator=this.labelService.getSeparator(this.scheme,this.remoteAuthority),this.hidden=!1,this.isWindows=await this.checkIsWindowsOS();let n=this.options.defaultUri?this.options.defaultUri:this.workspaceContextService.getWorkspace().folders[0].uri,i,o=js(n);if(this.options.defaultUri){try{i=await this.fileService.stat(this.options.defaultUri)}catch{}(!i||!i.isDirectory)&&(n=Yt(this.options.defaultUri),this.trailing=st(this.options.defaultUri))}return new Promise(s=>{if(this.filePickBox=this._register(this.quickInputService.createQuickPick()),this.busy=!0,this.filePickBox.matchOnLabel=!1,this.filePickBox.sortByLabel=!1,this.filePickBox.ignoreFocusOut=!0,this.filePickBox.ok=!0,this.scheme!==J.file&&this.options&&this.options.availableFileSystems&&this.options.availableFileSystems.length>1&&this.options.availableFileSystems.indexOf(J.file)>-1){this.filePickBox.customButton=!0,this.filePickBox.customLabel=m("remoteFileDialog.local","Show Local");let c;t?c=jL:c=this.allowFileSelection?this.allowFolderSelection?$L:GL:qL;let p=this.keybindingService.lookupKeybinding(c.ID);if(p){let h=p.getLabel();h&&(this.filePickBox.customHover=Fw("{0} ({1})",c.LABEL,h))}}let a=0,l=!1;this.currentFolder=Yt(n),this.userEnteredPathSegment="",this.autoCompletePathSegment="",this.filePickBox.title=this.options.title,this.filePickBox.value=this.pathFromUri(this.currentFolder,!0),this.filePickBox.valueSelection=[this.filePickBox.value.length,this.filePickBox.value.length];let d=c=>{c&&(c=po(c,this.separator),c=Rh(c)),s(c),this.contextKey.set(!1),this.dispose()};this._register(this.filePickBox.onDidCustom(()=>{if(!(l||this.busy))return l=!0,a++,this.options.availableFileSystems&&this.options.availableFileSystems.length>1&&(this.options.availableFileSystems=this.options.availableFileSystems.slice(1)),this.filePickBox.hide(),t?this.fileDialogService.showSaveDialog(this.options).then(c=>{d(c)}):this.fileDialogService.showOpenDialog(this.options).then(c=>{d(c?c[0]:void 0)})}));let u=()=>{if(this.busy){this.onBusyChangeEmitter.event(c=>{c||u()});return}else if(l)return;l=!0,a++,this.onDidAccept().then(c=>{c?(this.filePickBox.hide(),d(c)):this.hidden?d(void 0):(a--,l=!1)})};this._register(this.filePickBox.onDidAccept(c=>{u()})),this._register(this.filePickBox.onDidChangeActive(c=>{if(l=!1,c.length===1&&this.isSelectionChangeFromUser()){this.filePickBox.validationMessage=void 0;let p=this.constructFullUserPath();mt(this.filePickBox.value.substring(0,p.length),p)||(this.filePickBox.valueSelection=[0,this.filePickBox.value.length],this.insertText(p,p)),this.setAutoComplete(p,this.userEnteredPathSegment,c[0],!0)}})),this._register(this.filePickBox.onDidChangeValue(async c=>this.handleValueChange(c))),this._register(this.filePickBox.onDidHide(()=>{this.hidden=!0,a===0&&d(void 0)})),this.filePickBox.show(),this.contextKey.set(!0),this.updateItems(n,!0,this.trailing).then(()=>{this.trailing?this.filePickBox.valueSelection=[this.filePickBox.value.length-this.trailing.length,this.filePickBox.value.length-o.length]:this.filePickBox.valueSelection=[this.filePickBox.value.length,this.filePickBox.value.length],this.busy=!1})})}dispose(){super.dispose()}async handleValueChange(t){try{if(this.isValueChangeFromUser())if(!mt(t,this.constructFullUserPath())&&!this.isBadSubpath(t)){this.filePickBox.validationMessage=void 0;let n=this.filePickBoxValue(),i=3;Yo.isEqual(this.currentFolder,n)||(i=await this.tryUpdateItems(t,n)),(i===3||i===1)&&this.setActiveItems(t)}else this.filePickBox.activeItems=[],this.userEnteredPathSegment=""}catch{}}isBadSubpath(t){return this.badPath&&t.length>this.badPath.length&&mt(t.substring(0,this.badPath.length),this.badPath)}isValueChangeFromUser(){return!mt(this.filePickBox.value,this.pathAppend(this.currentFolder,this.userEnteredPathSegment+this.autoCompletePathSegment))}isSelectionChangeFromUser(){return this.activeItem!==(this.filePickBox.activeItems?this.filePickBox.activeItems[0]:void 0)}constructFullUserPath(){let t=this.pathFromUri(this.currentFolder);return mt(this.filePickBox.value.substr(0,this.userEnteredPathSegment.length),this.userEnteredPathSegment)?mt(this.filePickBox.value.substr(0,t.length),t)?t:this.userEnteredPathSegment:this.pathAppend(this.currentFolder,this.userEnteredPathSegment)}filePickBoxValue(){let t=this.remoteUriFrom(this.filePickBox.value.trimRight(),this.currentFolder),n=this.pathFromUri(this.currentFolder);if(mt(this.filePickBox.value,n))return this.currentFolder;let i=this.remoteUriFrom(n,this.currentFolder),o=kh(i,t),s=this.filePickBox.value.length>1&&n.length>1?mt(this.filePickBox.value.substr(0,2),n.substr(0,2)):!1;if(o&&s){let a=zt(this.currentFolder,o),l=st(t);return(l==="."||l==="..")&&(a=this.remoteUriFrom(this.pathAppend(a,l),this.currentFolder)),Uu(t)?po(a):a}else return t}async onDidAccept(){if(this.busy=!0,this.filePickBox.activeItems.length===1){let n=this.filePickBox.selectedItems[0];if(n.isFolder){if(this.trailing)await this.updateItems(n.uri,!0,this.trailing);else{let i=this.pathFromUri(n.uri);Dr(i,this.filePickBox.value)&&mt(n.label,st(n.uri))?(this.filePickBox.valueSelection=[this.pathFromUri(this.currentFolder).length,this.filePickBox.value.length],this.insertText(i,this.basenameWithTrailingSlash(n.uri))):n.label===".."&&Dr(this.filePickBox.value,i)?(this.filePickBox.valueSelection=[i.length,this.filePickBox.value.length],this.insertText(i,"")):await this.updateItems(n.uri,!0)}this.filePickBox.busy=!1;return}}else if(await this.tryUpdateItems(this.filePickBox.value,this.filePickBoxValue())!==3){this.filePickBox.busy=!1;return}let t;if(this.filePickBox.activeItems.length===0?t=this.filePickBoxValue():this.filePickBox.activeItems.length===1&&(t=this.filePickBox.selectedItems[0].uri),t&&(t=this.addPostfix(t)),await this.validate(t))return this.busy=!1,t;this.busy=!1}root(t){let n=t,i=Yt(t);for(;!fl(n,i);)n=i,i=Yt(i);return i}tildaReplace(t){let n=this.trueHome;return t.length>0&&t[0]==="~"?zt(n,t.substring(1)):this.remoteUriFrom(t)}tryAddTrailingSeparatorToDirectory(t,n){return n.isDirectory&&!this.endsWithSlash(t.path)?po(t):t}async tryUpdateItems(t,n){if(t.length>0&&t[0]==="~"){let i=this.tildaReplace(t);return await this.updateItems(i,!0)?1:0}else{if(t==="\\")return n=this.root(this.currentFolder),t=this.pathFromUri(n),await this.updateItems(n,!0)?1:0;{let i=Yo.isEqual(this.currentFolder,n),o=Yo.isEqual(this.currentFolder,Yt(n)),s=Yo.isEqualOrParent(this.currentFolder,Yt(n)),a=!s&&!o;if(!i&&(this.endsWithSlash(t)||s||a)){let l;try{l=await this.fileService.stat(n)}catch{}if(l&&l.isDirectory&&st(n)!=="."&&this.endsWithSlash(t))return n=this.tryAddTrailingSeparatorToDirectory(n,l),await this.updateItems(n)?1:0;if(this.endsWithSlash(t))return this.filePickBox.validationMessage=m("remoteFileDialog.badPath","The path does not exist."),this.badPath=t,4;{let d=Yt(n),u=Rh(po(this.currentFolder)),c=Rh(po(d));if(!Yo.isEqual(u,c)&&(!/^[a-zA-Z]:$/.test(this.filePickBox.value)||!mt(this.pathFromUri(this.currentFolder).substring(0,this.filePickBox.value.length),this.filePickBox.value))){let p;try{p=await this.fileService.stat(d)}catch{}if(p&&p.isDirectory)return this.badPath=void 0,d=this.tryAddTrailingSeparatorToDirectory(d,p),await this.updateItems(d,!1,st(n))?1:0}}}}}return this.badPath=void 0,3}tryUpdateTrailing(t){let n=js(t);this.trailing&&n&&(this.trailing=st(t))}setActiveItems(t){t=this.pathFromUri(this.tildaReplace(t));let n=this.remoteUriFrom(t),i=st(n),o=this.constructFullUserPath();if(mt(o,t.substring(0,o.length))||mt(t,o.substring(0,t.length))){let a=!1;for(let l=0;l<this.filePickBox.items.length;l++){let d=this.filePickBox.items[l];if(this.setAutoComplete(t,i,d)){a=!0;break}}if(!a){let l=i.length>=2?o.substring(o.length-i.length+2):"";this.userEnteredPathSegment=l===i?i:"",this.autoCompletePathSegment="",this.filePickBox.activeItems=[],this.tryUpdateTrailing(n)}}else this.userEnteredPathSegment=i,this.autoCompletePathSegment="",this.filePickBox.activeItems=[],this.tryUpdateTrailing(n)}setAutoComplete(t,n,i,o=!1){if(this.busy)return this.userEnteredPathSegment=n,this.autoCompletePathSegment="",!1;let s=i.label;return s===".."?(this.userEnteredPathSegment="",this.autoCompletePathSegment="",this.activeItem=i,o&&op().execCommand("insertText",!1,""),!1):!o&&s.length>=n.length&&mt(s.substr(0,n.length),n)?(this.userEnteredPathSegment=n,this.activeItem=i,this.autoCompletePathSegment="",i.isFolder||!this.trailing?this.filePickBox.activeItems=[i]:this.filePickBox.activeItems=[],!0):o&&!mt(this.basenameWithTrailingSlash(i.uri),this.userEnteredPathSegment+this.autoCompletePathSegment)?(this.userEnteredPathSegment="",this.accessibilityService.isScreenReaderOptimized()||(this.autoCompletePathSegment=this.trimTrailingSlash(s)),this.activeItem=i,this.accessibilityService.isScreenReaderOptimized()||(this.filePickBox.valueSelection=[this.pathFromUri(this.currentFolder,!0).length,this.filePickBox.value.length],this.insertText(this.pathAppend(this.currentFolder,this.autoCompletePathSegment),this.autoCompletePathSegment),this.filePickBox.valueSelection=[this.filePickBox.value.length-this.autoCompletePathSegment.length,this.filePickBox.value.length]),!0):(this.userEnteredPathSegment=n,this.autoCompletePathSegment="",!1)}insertText(t,n){this.filePickBox.inputHasFocus()?(op().execCommand("insertText",!1,n),this.filePickBox.value!==t&&(this.filePickBox.value=t,this.handleValueChange(t))):(this.filePickBox.value=t,this.handleValueChange(t))}addPostfix(t){let n=t;if(this.requiresTrailing&&this.options.filters&&this.options.filters.length>0&&!Uu(t)){let i=!1,o=js(t).substr(1);for(let s=0;s<this.options.filters.length;s++){for(let a=0;a<this.options.filters[s].extensions.length;a++)if(this.options.filters[s].extensions[a]==="*"||this.options.filters[s].extensions[a]===o){i=!0;break}if(i)break}i||(n=zt(Yt(t),st(t)+"."+this.options.filters[0].extensions[0]))}return n}trimTrailingSlash(t){return t.length>1&&this.endsWithSlash(t)?t.substr(0,t.length-1):t}yesNoPrompt(t,n){let i=new We,o=i.add(this.quickInputService.createQuickPick());o.title=n,o.ignoreFocusOut=!0,o.ok=!0,o.customButton=!0,o.customLabel=m("remoteFileDialog.cancel","Cancel"),o.value=this.pathFromUri(t);let s=!1;return new Promise(a=>{i.add(o.onDidAccept(()=>{s=!0,o.hide(),a(!0)})),i.add(o.onDidHide(()=>{s||a(!1),this.filePickBox.show(),this.hidden=!1,i.dispose()})),i.add(o.onDidChangeValue(()=>{o.hide()})),i.add(o.onDidCustom(()=>{o.hide()})),o.show()})}async validate(t){if(t===void 0)return this.filePickBox.validationMessage=m("remoteFileDialog.invalidPath","Please enter a valid path."),Promise.resolve(!1);let n,i;try{i=await this.fileService.stat(Yt(t)),n=await this.fileService.stat(t)}catch{}if(this.requiresTrailing){if(n&&n.isDirectory)return this.filePickBox.validationMessage=m("remoteFileDialog.validateFolder","The folder already exists. Please use a new file name."),Promise.resolve(!1);if(n){let o=m("remoteFileDialog.validateExisting","{0} already exists. Are you sure you want to overwrite it?",st(t));return this.yesNoPrompt(t,o)}else if(Th(st(t),this.isWindows))if(i)if(i.isDirectory){if(i.readonly)return this.filePickBox.validationMessage=m("remoteFileDialog.validateReadonlyFolder","This folder cannot be used as a save destination. Please choose another folder"),Promise.resolve(!1)}else return this.filePickBox.validationMessage=m("remoteFileDialog.validateNonexistentDir","Please enter a path that exists."),Promise.resolve(!1);else{let o=m("remoteFileDialog.validateCreateDirectory","The folder {0} does not exist. Would you like to create it?",st(Yt(t)));return this.yesNoPrompt(t,o)}else return this.filePickBox.validationMessage=m("remoteFileDialog.validateBadFilename","Please enter a valid file name."),Promise.resolve(!1)}else if(n){if(t.path==="/"&&this.isWindows)return this.filePickBox.validationMessage=m("remoteFileDialog.windowsDriveLetter","Please start the path with a drive letter."),Promise.resolve(!1);if(n.isDirectory&&!this.allowFolderSelection)return this.filePickBox.validationMessage=m("remoteFileDialog.validateFileOnly","Please select a file."),Promise.resolve(!1);if(!n.isDirectory&&!this.allowFileSelection)return this.filePickBox.validationMessage=m("remoteFileDialog.validateFolderOnly","Please select a folder."),Promise.resolve(!1)}else return this.filePickBox.validationMessage=m("remoteFileDialog.validateNonexistentDir","Please enter a path that exists."),Promise.resolve(!1);return Promise.resolve(!0)}async updateItems(t,n=!1,i){this.busy=!0,this.autoCompletePathSegment="";let o=!!i,s=!1,a=Ys(async l=>{let d;try{d=await this.fileService.resolve(t),d.isDirectory||(i=st(t),t=Yt(t),d=void 0,s=!0)}catch{}let u=i?this.pathAppend(t,i):this.pathFromUri(t,!0);return this.currentFolder=this.endsWithSlash(t.path)?t:po(t,this.separator),this.userEnteredPathSegment=i||"",this.createItems(d,this.currentFolder,l).then(c=>l.isCancellationRequested?(this.busy=!1,!1):(this.filePickBox.itemActivation=0,this.filePickBox.items=c,!mt(this.filePickBox.value,u)&&n&&(this.filePickBox.valueSelection=[0,this.filePickBox.value.length],this.insertText(u,u)),n&&i&&o?this.filePickBox.valueSelection=[this.filePickBox.value.length-i.length,this.filePickBox.value.length-i.length]:i||(this.filePickBox.valueSelection=[this.filePickBox.value.length,this.filePickBox.value.length]),this.busy=!1,this.updatingPromise=void 0,s))});return this.updatingPromise!==void 0&&this.updatingPromise.cancel(),this.updatingPromise=a,a}pathFromUri(t,n=!1){let i=Yy(t.fsPath,this.isWindows).replace(/\n/g,"");return this.separator==="/"?i=i.replace(/\\/g,this.separator):i=i.replace(/\//g,this.separator),n&&!this.endsWithSlash(i)&&(i=i+this.separator),i}pathAppend(t,n){return n===".."||n==="."?this.pathFromUri(t,!0)+n:this.pathFromUri(zt(t,n))}async checkIsWindowsOS(){let t=Fe,n=await this.getRemoteAgentEnvironment();return n&&(t=n.os===1),t}endsWithSlash(t){return/[\/\\]$/.test(t)}basenameWithTrailingSlash(t){let n=this.pathFromUri(t,!0),i=this.pathFromUri(Yt(t),!0);return n.substring(i.length)}async createBackItem(t){let n=this.currentFolder.with({scheme:J.file,authority:""}),i=Yt(n);if(!fl(n,i)){let o=Yt(t);if(await this.fileService.exists(o))return{label:"..",uri:po(o,this.separator),isFolder:!0}}}async createItems(t,n,i){let o=[],s=await this.createBackItem(n);try{t||(t=await this.fileService.resolve(n));let l=t.children?await Promise.all(t.children.map(d=>this.createItem(d,n,i))):[];for(let d of l)d&&o.push(d)}catch(l){console.log(l)}if(i.isCancellationRequested)return[];let a=o.sort((l,d)=>{if(l.isFolder!==d.isFolder)return l.isFolder?-1:1;let u=this.endsWithSlash(l.label)?l.label.substr(0,l.label.length-1):l.label,c=this.endsWithSlash(d.label)?d.label.substr(0,d.label.length-1):d.label;return u.localeCompare(c)});return s&&a.unshift(s),a}filterFile(t){if(this.options.filters){for(let n=0;n<this.options.filters.length;n++)for(let i=0;i<this.options.filters[n].extensions.length;i++){let o=this.options.filters[n].extensions[i];if(o==="*"||t.path.endsWith("."+o))return!0}return!1}return!0}async createItem(t,n,i){if(i.isCancellationRequested)return;let o=zt(n,t.name);if(t.isDirectory){let s=st(o);return o=po(o,this.separator),{label:s,uri:o,isFolder:!0,iconClasses:u_(this.modelService,this.languageService,o||void 0,1)}}else if(!t.isDirectory&&this.allowFileSelection&&this.filterFile(o))return{label:t.name,uri:o,isFolder:!1,iconClasses:u_(this.modelService,this.languageService,o||void 0)}}};xd=ne([M(0,An),M(1,pL),M(2,ad),M(3,Pr),M(4,gs),M(5,qs),M(6,ga),M(7,li),M(8,fd),M(9,of),M(10,sf),M(11,fs),M(12,ei),M(13,ri)],xd);var YL=G("workspacesService");var QL=G("openerService");var ZL=G("hostService");var Et;(o=>(o.Tap="-monaco-gesturetap",o.Change="-monaco-gesturechange",o.Start="-monaco-gesturestart",o.End="-monaco-gesturesend",o.Contextmenu="-monaco-gesturecontextmenu"))(Et||={});var cn=class cn extends B{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new mn;ignoreTargets=new mn;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Ke.runAndSubscribe(NL,({window:e,disposables:t})=>{t.add(oe(e.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),t.add(oe(e.document,"touchend",n=>this.onTouchEnd(e,n))),t.add(oe(e.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:xt,disposables:this._store}))}static addTarget(e){if(!cn.isTouchDevice())return B.None;cn.INSTANCE||(cn.INSTANCE=Ko(new cn));let t=cn.INSTANCE.targets.push(e);return ve(t)}static ignoreTarget(e){if(!cn.isTouchDevice())return B.None;cn.INSTANCE||(cn.INSTANCE=Ko(new cn));let t=cn.INSTANCE.ignoreTargets.push(e);return ve(t)}static isTouchDevice(){return"ontouchstart"in xt||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let o=e.targetTouches.item(n);this.activeTouches[o.identifier]={id:o.identifier,initialTarget:o.target,initialTimeStamp:t,initialPageX:o.pageX,initialPageY:o.pageY,rollingTimestamps:[t],rollingPageX:[o.pageX],rollingPageY:[o.pageY]};let s=this.newGestureEvent(Et.Start,o.target);s.pageX=o.pageX,s.pageY=o.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let n=Date.now(),i=Object.keys(this.activeTouches).length;for(let o=0,s=t.changedTouches.length;o<s;o++){let a=t.changedTouches.item(o);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<cn.HOLD_DELAY&&Math.abs(l.initialPageX-Dn(l.rollingPageX))<30&&Math.abs(l.initialPageY-Dn(l.rollingPageY))<30){let u=this.newGestureEvent(Et.Tap,l.initialTarget);u.pageX=Dn(l.rollingPageX),u.pageY=Dn(l.rollingPageY),this.dispatchEvent(u)}else if(d>=cn.HOLD_DELAY&&Math.abs(l.initialPageX-Dn(l.rollingPageX))<30&&Math.abs(l.initialPageY-Dn(l.rollingPageY))<30){let u=this.newGestureEvent(Et.Contextmenu,l.initialTarget);u.pageX=Dn(l.rollingPageX),u.pageY=Dn(l.rollingPageY),this.dispatchEvent(u)}else if(i===1){let u=Dn(l.rollingPageX),c=Dn(l.rollingPageY),p=Dn(l.rollingTimestamps)-l.rollingTimestamps[0],h=u-l.rollingPageX[0],g=c-l.rollingPageY[0],f=[...this.targets].filter(v=>l.initialTarget instanceof Node&&v.contains(l.initialTarget));this.inertia(e,f,n,Math.abs(h)/p,h>0?1:-1,u,Math.abs(g)/p,g>0?1:-1,c)}this.dispatchEvent(this.newGestureEvent(Et.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===Et.Tap){let t=new Date().getTime(),n=0;t-this._lastSetTapCountTime>cn.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=t,e.tapCount=n}else(e.type===Et.Change||e.type===Et.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(e.initialTarget))return;let t=[];for(let n of this.targets)if(n.contains(e.initialTarget)){let i=0,o=e.initialTarget;for(;o&&o!==n;)i++,o=o.parentElement;t.push([i,n])}t.sort((n,i)=>n[0]-i[0]);for(let[n,i]of t)i.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,n,i,o,s,a,l,d){this.handle=Bi(e,()=>{let u=Date.now(),c=u-n,p=0,h=0,g=!0;i+=cn.SCROLL_FRICTION*c,a+=cn.SCROLL_FRICTION*c,i>0&&(g=!1,p=o*i*c),a>0&&(g=!1,h=l*a*c);let f=this.newGestureEvent(Et.Change);f.translationX=p,f.translationY=h,t.forEach(v=>v.dispatchEvent(f)),g||this.inertia(e,t,u,i,o,s+p,a,l,d+h)})}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let o=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("end of an UNKNOWN touch",o);continue}let s=this.activeTouches[o.identifier],a=this.newGestureEvent(Et.Change,s.initialTarget);a.translationX=o.pageX-Dn(s.rollingPageX),a.translationY=o.pageY-Dn(s.rollingPageY),a.pageX=o.pageX,a.pageY=o.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(o.pageX),s.rollingPageY.push(o.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};ne([Si],cn,"isTouchDevice",1);var Qr=cn;var Wt=class{emitter;get event(){return this.emitter.event}constructor(e,t,n){let i=o=>this.emitter.fire(o);this.emitter=new L({onWillAddFirstListener:()=>e.addEventListener(t,i,n),onDidRemoveLastListener:()=>e.removeEventListener(t,i,n)})}dispose(){this.emitter.dispose()}};var GPe=new L;var jPe=new L;var mf=class{constructor(e){this.el=e}disposables=new We;get onPointerMove(){return this.disposables.add(new Wt(_e(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Wt(_e(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};ne([Si],mf.prototype,"onPointerMove",1),ne([Si],mf.prototype,"onPointerUp",1);var gf=class{constructor(e){this.el=e}disposables=new We;get onPointerMove(){return this.disposables.add(new Wt(this.el,Et.Change)).event}get onPointerUp(){return this.disposables.add(new Wt(this.el,Et.End)).event}dispose(){this.disposables.dispose()}};ne([Si],gf.prototype,"onPointerMove",1),ne([Si],gf.prototype,"onPointerUp",1);var ff=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};ne([Si],ff.prototype,"onPointerMove",1),ne([Si],ff.prototype,"onPointerUp",1);var bf=class extends B{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},n=!1,i=!1,o=()=>{if(n&&!i)try{n=!1,i=!0,t()}finally{Bi(_e(this._referenceDomElement),()=>{i=!1,o()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,n=!0,o()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this._referenceDomElement&&(n=this._referenceDomElement.clientWidth,i=this._referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),(this._width!==n||this._height!==i)&&(this._width=n,this._height=i,e&&this._onDidChange.fire())}};var P_=class extends B{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},M_=class extends B{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new P_(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),n=e.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i}},O_=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=Sd(e),n=this.mapWindowIdToPixelRatioMonitor.get(t);return n||(n=Ko(new M_(e)),this.mapWindowIdToPixelRatioMonitor.set(t,n),Ko(Ke.once(AL)(({vscodeWindowId:i})=>{i===t&&(n?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),n}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},Ed=new O_;var ka=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=hi(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=hi(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=hi(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=hi(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=hi(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=hi(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=hi(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=hi(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=hi(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=hi(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=hi(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=hi(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=hi(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=hi(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function hi(r){return typeof r=="number"?`${r}px`:r}function pe(r){return new ka(r)}function wt(r,e){r instanceof ka?(r.setFontFamily(e.getMassagedFontFamily()),r.setFontWeight(e.fontWeight),r.setFontSize(e.fontSize),r.setFontFeatureSettings(e.fontFeatureSettings),r.setFontVariationSettings(e.fontVariationSettings),r.setLineHeight(e.lineHeight),r.setLetterSpacing(e.letterSpacing)):(r.style.fontFamily=e.getMassagedFontFamily(),r.style.fontWeight=e.fontWeight,r.style.fontSize=e.fontSize+"px",r.style.fontFeatureSettings=e.fontFeatureSettings,r.style.fontVariationSettings=e.fontVariationSettings,r.style.lineHeight=e.lineHeight+"px",r.style.letterSpacing=e.letterSpacing+"px")}var vf=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},N_=class r{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");wt(t,this._bareFontInfo),e.appendChild(t);let n=document.createElement("div");wt(n,this._bareFontInfo),n.style.fontWeight="bold",e.appendChild(n);let i=document.createElement("div");wt(i,this._bareFontInfo),i.style.fontStyle="italic",e.appendChild(i);let o=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=n),s.type===1&&(a=i),a.appendChild(document.createElement("br"));let l=document.createElement("span");r._render(l,s),a.appendChild(l),o.push(l)}this._container=e,this._testElements=o}static _render(e,t){if(t.chr===" "){let n="\xA0";for(let i=0;i<8;i++)n+=n;e.innerText=n}else{let n=t.chr;for(let i=0;i<8;i++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let n=this._requests[e],i=this._testElements[e];n.fulfill(i.offsetWidth/256)}}};function XL(r,e,t){new N_(e,t).read(r)}var A_=class extends B{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=Sd(e),n=this._cache.get(t);return n||(n=new F_,this._cache.set(t,n)),n}_writeToCache(e,t,n){this._ensureCache(e).put(t,n),!n.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),n=t.getValues(),i=!1;for(let o of n)o.isTrusted||(i=!0,t.remove(o));i&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(n=>n.isTrusted)}restoreFontInfo(e,t){for(let n of t){if(n.version!==MI)continue;let i=new Dl(n,!1);this._writeToCache(e,i,i)}}readFontInfo(e,t){let n=this._ensureCache(e);if(!n.has(t)){let i=this._actualReadFontInfo(e,t);(i.typicalHalfwidthCharacterWidth<=2||i.typicalFullwidthCharacterWidth<=2||i.spaceWidth<=2||i.maxDigitWidth<=2)&&(i=new Dl({pixelRatio:Ed.getInstance(e).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:i.isMonospace,typicalHalfwidthCharacterWidth:Math.max(i.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(i.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:i.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(i.spaceWidth,5),middotWidth:Math.max(i.middotWidth,5),wsmiddotWidth:Math.max(i.wsmiddotWidth,5),maxDigitWidth:Math.max(i.maxDigitWidth,5)},!1)),this._writeToCache(e,t,i)}return n.get(t)}_createRequest(e,t,n,i){let o=new vf(e,t);return n.push(o),i?.push(o),o}_actualReadFontInfo(e,t){let n=[],i=[],o=this._createRequest("n",0,n,i),s=this._createRequest("\uFF4D",0,n,null),a=this._createRequest(" ",0,n,i),l=this._createRequest("0",0,n,i),d=this._createRequest("1",0,n,i),u=this._createRequest("2",0,n,i),c=this._createRequest("3",0,n,i),p=this._createRequest("4",0,n,i),h=this._createRequest("5",0,n,i),g=this._createRequest("6",0,n,i),f=this._createRequest("7",0,n,i),v=this._createRequest("8",0,n,i),y=this._createRequest("9",0,n,i),I=this._createRequest("\u2192",0,n,i),S=this._createRequest("\uFFEB",0,n,null),x=this._createRequest("\xB7",0,n,i),T=this._createRequest("\u2E31",0,n,null),R="|/-_ilm%";for(let W=0,H=R.length;W<H;W++)this._createRequest(R.charAt(W),0,n,i),this._createRequest(R.charAt(W),1,n,i),this._createRequest(R.charAt(W),2,n,i);XL(e,t,n);let P=Math.max(l.width,d.width,u.width,c.width,p.width,h.width,g.width,f.width,v.width,y.width),O=t.fontFeatureSettings===la.OFF,k=i[0].width;for(let W=1,H=i.length;O&&W<H;W++){let $=k-i[W].width;if($<-.001||$>.001){O=!1;break}}let F=!0;return O&&S.width!==k&&(F=!1),S.width>I.width&&(F=!1),new Dl({pixelRatio:Ed.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:O,typicalHalfwidthCharacterWidth:o.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:F,spaceWidth:a.width,middotWidth:x.width,wsmiddotWidth:T.width,maxDigitWidth:P},!0)}},F_=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},W_=new A_;var sp=class r{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=r._read(e,this.key),n=o=>r._read(e,o),i=(o,s)=>r._write(e,o,s);this.migrate(t,n,i)}static _read(e,t){if(typeof e>"u")return;let n=t.indexOf(".");if(n>=0){let i=t.substring(0,n);return this._read(e[i],t.substring(n+1))}return e[t]}static _write(e,t,n){let i=t.indexOf(".");if(i>=0){let o=t.substring(0,i);e[o]=e[o]||{},this._write(e[o],t.substring(i+1),n);return}e[t]=n}};function fr(r,e){sp.items.push(new sp(r,e))}function jn(r,e){fr(r,(t,n,i)=>{if(typeof t<"u"){for(let[o,s]of e)if(t===o){i(r,s);return}}})}function JL(r){sp.items.forEach(e=>e.apply(r))}jn("wordWrap",[[!0,"on"],[!1,"off"]]);jn("lineNumbers",[[!0,"on"],[!1,"off"]]);jn("cursorBlinking",[["visible","solid"]]);jn("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);jn("renderLineHighlight",[[!0,"line"],[!1,"none"]]);jn("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);jn("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);jn("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);jn("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);jn("autoIndent",[[!1,"advanced"],[!0,"full"]]);jn("matchBrackets",[[!0,"always"],[!1,"never"]]);jn("renderFinalNewline",[[!0,"on"],[!1,"off"]]);jn("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);jn("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);jn("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);fr("autoClosingBrackets",(r,e,t)=>{r===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});fr("renderIndentGuides",(r,e,t)=>{typeof r<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!r))});fr("highlightActiveIndentGuide",(r,e,t)=>{typeof r<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!r))});var EN={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};fr("suggest.filteredTypes",(r,e,t)=>{if(r&&typeof r=="object"){for(let n of Object.entries(EN))r[n[0]]===!1&&typeof e(`suggest.${n[1]}`)>"u"&&t(`suggest.${n[1]}`,!1);t("suggest.filteredTypes",void 0)}});fr("quickSuggestions",(r,e,t)=>{if(typeof r=="boolean"){let n=r?"on":"off";t("quickSuggestions",{comments:n,strings:n,other:n})}});fr("experimental.stickyScroll.enabled",(r,e,t)=>{typeof r=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",r))});fr("experimental.stickyScroll.maxLineCount",(r,e,t)=>{typeof r=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",r))});fr("codeActionsOnSave",(r,e,t)=>{if(r&&typeof r=="object"){let n=!1,i={};for(let o of Object.entries(r))typeof o[1]=="boolean"?(n=!0,i[o[0]]=o[1]?"explicit":"never"):i[o[0]]=o[1];n&&t("codeActionsOnSave",i)}});fr("codeActionWidget.includeNearbyQuickfixes",(r,e,t)=>{typeof r=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",r))});fr("lightbulb.enabled",(r,e,t)=>{typeof r=="boolean"&&t("lightbulb.enabled",r?void 0:"off")});var B_=class{_tabFocus=!1;_onDidChangeTabFocus=new L;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},wd=new B_;var Td=class extends B{constructor(t,n,i,o,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=n,this._containerObserver=this._register(new bf(o,i.dimension)),this._targetWindowId=_e(o).vscodeWindowId,this._rawOptions=ek(i),this._validatedOptions=Ra.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Nr.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(wd.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(W_.onDidChange(()=>this._recomputeOptions())),this._register(Ed.getInstance(_e(o)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new L);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new fc;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),n=Ra.checkEquals(this.options,t);n!==null&&(this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n))}_computeOptions(){let t=this._readEnvConfiguration(),n=pc.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(n),o={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:wd.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Ra.computeOptions(this._validatedOptions,o)}_readEnvConfiguration(){return{extraEditorClassName:TN(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:cr||Xt,pixelRatio:Ed.getInstance(T_(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return W_.readFontInfo(T_(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let n=ek(t);Ra.applyUpdate(this._rawOptions,n)&&(this._validatedOptions=Ra.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let n=wN(t);this._lineNumbersDigitCount!==n&&(this._lineNumbersDigitCount=n,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};Td=ne([M(4,ri)],Td);function wN(r){let e=0;for(;r;)r=Math.floor(r/10),e++;return e||1}function TN(){let r="";return!_i&&!yL&&(r+="no-user-select "),_i&&(r+="no-minimap-shadow ",r+="enable-user-select "),Me&&(r+="mac "),r}var V_=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},U_=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},Ra=class r{static validateOptions(e){let t=new V_;for(let n of Fl){let i=n.name==="_never_"?void 0:e[n.name];t._write(n.id,n.validate(i))}return t}static computeOptions(e,t){let n=new U_;for(let i of Fl)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?Pn(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!r._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){let n=[],i=!1;for(let o of Fl){let s=!r._deepEquals(e._read(o.id),t._read(o.id));n[o.id]=s,s&&(i=!0)}return i?new wm(n):null}static applyUpdate(e,t){let n=!1;for(let i of Fl)if(t.hasOwnProperty(i.name)){let o=i.applyUpdate(e[i.name],t[i.name]);e[i.name]=o.newValue,n=n||o.didChange}return n}};function ek(r){let e=vl(r);return JL(e),e}var Lo=class{constructor(e,t,n,i,o){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=n;this.breakOffsetsVisibleColumn=i;this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let o=0;o<this.injectionOffsets.length&&i>this.injectionOffsets[o];o++)i<this.injectionOffsets[o]+this.injectionOptions[o].content.length?i=this.injectionOffsets[o]:i-=this.injectionOptions[o].content.length;return i}translateToOutputPosition(e,t=2){let n=e;if(this.injectionOffsets!==null)for(let i=0;i<this.injectionOffsets.length&&!(e<this.injectionOffsets[i]||t!==1&&e===this.injectionOffsets[i]);i++)n+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(n,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let n=0,i=this.breakOffsets.length-1,o=0,s=0;for(;n<=i;){o=n+(i-n)/2|0;let l=this.breakOffsets[o];if(s=o>0?this.breakOffsets[o-1]:0,t===0)if(e<=s)i=o-1;else if(e>l)n=o+1;else break;else if(e<s)i=o-1;else if(e>=l)n=o+1;else break}let a=e-s;return o>0&&(a+=this.wrappedTextIndentLength),new Ld(o,a)}normalizeOutputPosition(e,t,n){if(this.injectionOffsets!==null){let i=this.outputPositionToOffsetInInputWithInjections(e,t),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(i,n);if(o!==i)return this.offsetInInputWithInjectionsToOutputPosition(o,n)}if(n===0){if(e>0&&t===this.getMinOutputOffset(e))return new Ld(e-1,this.getMaxOutputOffset(e-1))}else if(n===1){let i=this.getOutputLineCount()-1;if(e<i&&t===this.getMaxOutputOffset(e))return new Ld(e+1,this.getMinOutputOffset(e+1))}return new Ld(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let n=this.getInjectedTextAtOffset(e);if(!n)return e;if(t===2){if(e===n.offsetInInputWithInjections+n.length&&tk(this.injectionOptions[n.injectedTextIndex].cursorStops))return n.offsetInInputWithInjections+n.length;{let i=n.offsetInInputWithInjections;if(nk(this.injectionOptions[n.injectedTextIndex].cursorStops))return i;let o=n.injectedTextIndex-1;for(;o>=0&&this.injectionOffsets[o]===this.injectionOffsets[n.injectedTextIndex]&&!(tk(this.injectionOptions[o].cursorStops)||(i-=this.injectionOptions[o].content.length,nk(this.injectionOptions[o].cursorStops)));)o--;return i}}else if(t===1||t===4){let i=n.offsetInInputWithInjections+n.length,o=n.injectedTextIndex;for(;o+1<this.injectionOffsets.length&&this.injectionOffsets[o+1]===this.injectionOffsets[o];)i+=this.injectionOptions[o+1].content.length,o++;return i}else if(t===0||t===3){let i=n.offsetInInputWithInjections,o=n.injectedTextIndex;for(;o-1>=0&&this.injectionOffsets[o-1]===this.injectionOffsets[o];)i-=this.injectionOptions[o-1].content.length,o--;return i}rh(t)}getInjectedText(e,t){let n=this.outputPositionToOffsetInInputWithInjections(e,t),i=this.getInjectedTextAtOffset(n);return i?{options:this.injectionOptions[i.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,n=this.injectionOptions;if(t!==null){let i=0;for(let o=0;o<t.length;o++){let s=n[o].content.length,a=t[o]+i,l=t[o]+i+s;if(a>e)break;if(e<=l)return{injectedTextIndex:o,offsetInInputWithInjections:a,length:s};i+=s}}}};function tk(r){return r==null?!0:r===1||r===0}function nk(r){return r==null?!0:r===2||r===0}var Ld=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new w(e+this.outputLineIndex,this.outputOffset+1)}};var kN=()=>!0,RN=()=>!1,DN=r=>r===" "||r==="	",ko=class{constructor(e,t,n,i){this.languageConfigurationService=i;this._languageId=e;let o=n.options,s=o.get(147),a=o.get(51);this.readOnly=o.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=o.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=o.get(130),this.wordSeparators=o.get(133),this.emptySelectionClipboard=o.get(38),this.copyWithSyntaxHighlighting=o.get(25),this.multiCursorMergeOverlapping=o.get(78),this.multiCursorPaste=o.get(80),this.multiCursorLimit=o.get(81),this.autoClosingBrackets=o.get(6),this.autoClosingComments=o.get(7),this.autoClosingQuotes=o.get(11),this.autoClosingDelete=o.get(9),this.autoClosingOvertype=o.get(10),this.autoSurround=o.get(14),this.autoIndent=o.get(12),this.wordSegmenterLocales=o.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let u of l)this.surroundingPairs[u.open]=u.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,n){let i=Ur(t,n-1),o=this.languageConfigurationService.getLanguageConfiguration(i.languageId).electricCharacter;return o?o.onElectricCharacter(e,i,n-i.firstCharOffset):null}normalizeIndentation(e){return cg(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,n){switch(t){case"beforeWhitespace":return DN;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,n);case"always":return kN;case"never":return RN}}_getLanguageDefinedShouldAutoClose(e,t){let n=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return i=>n.indexOf(i)!==-1}visibleColumnFromColumn(e,t){return Ye.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,n){let i=Ye.columnFromVisibleColumn(e.getLineContent(t),n,this.tabSize),o=e.getLineMinColumn(t);if(i<o)return o;let s=e.getLineMaxColumn(t);return i>s?s:i}},Ie=class r{_cursorStateBrand=void 0;static fromModelState(e){return new H_(e)}static fromViewState(e){return new z_(e)}static fromModelSelection(e){let t=ye.liftSelection(e),n=new Tt(_.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return r.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},H_=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},z_=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var Tt=class r{constructor(e,t,n,i,o){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=n;this.position=i;this.leftoverVisibleColumns=o;this.selection=r._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new r(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new w(t,n),i):new r(new _(t,n,t,n),0,i,new w(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?ye.fromPositions(e.getStartPosition(),t):ye.fromPositions(e.getEndPosition(),t)}},Rt=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,n){this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}};function br(r){return r==="'"||r==='"'||r==="`"}var yf=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var If=class{type=0;constructor(){}},Cf=class{type=1;constructor(){}},Sf=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},_f=class{constructor(e,t,n){this.selections=e;this.modelSelections=t;this.reason=n}type=3},Zr=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},Pa=class{type=5;constructor(){}},xf=class{type=6;isFocused;constructor(e){this.isFocused=e}},Ef=class{type=7},Ma=class{type=8;constructor(){}},ap=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},kd=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},Rd=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var Ro=class{constructor(e,t,n,i,o,s,a){this.source=e;this.minimalReveal=t;this.range=n;this.selections=i;this.verticalType=o;this.revealHorizontal=s;this.scrollType=a}type=12},wf=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},Tf=class{constructor(e){this.theme=e}type=14},Lf=class{type=15;ranges;constructor(e){this.ranges=e}},kf=class{type=16;constructor(){}},Rf=class{type=17;constructor(){}};var Vi=class extends B{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let o=e[n];switch(o.type){case 0:this.onCompositionStart(o)&&(t=!0);break;case 1:this.onCompositionEnd(o)&&(t=!0);break;case 2:this.onConfigurationChanged(o)&&(t=!0);break;case 3:this.onCursorStateChanged(o)&&(t=!0);break;case 4:this.onDecorationsChanged(o)&&(t=!0);break;case 5:this.onFlushed(o)&&(t=!0);break;case 6:this.onFocusChanged(o)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(o)&&(t=!0);break;case 8:this.onLineMappingChanged(o)&&(t=!0);break;case 9:this.onLinesChanged(o)&&(t=!0);break;case 10:this.onLinesDeleted(o)&&(t=!0);break;case 11:this.onLinesInserted(o)&&(t=!0);break;case 12:this.onRevealRangeRequest(o)&&(t=!0);break;case 13:this.onScrollChanged(o)&&(t=!0);break;case 15:this.onTokensChanged(o)&&(t=!0);break;case 14:this.onThemeChanged(o)&&(t=!0);break;case 16:this.onTokensColorsChanged(o)&&(t=!0);break;case 17:this.onZonesChanged(o)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(o)}}t&&(this._shouldRender=!0)}};var lp=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,n,i){this.top=e|0,this.left=t|0,this.width=n|0,this.height=i|0}},Df=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},Oa=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,n,i,o,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=o,this.tokens=s,this.inlineDecorations=a}},Pf=class r{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,n,i,o,s,a,l,d,u){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r.isBasicASCII(n,s),this.containsRTL=r.containsRTL(n,this.isBasicASCII,o),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=u}static isBasicASCII(e,t){return t?Sh(e):!0}static containsRTL(e,t,n){return!t&&n?uo(e):!1}};var Na=class{constructor(e,t,n){this.range=e;this.inlineClassName=t;this.type=n}},Mf=class{constructor(e,t,n,i){this.startOffset=e;this.endOffset=t;this.inlineClassName=n;this.inlineClassNameAffectsLetterSpacing=i}toInlineDecoration(e){return new Na(new _(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},Pd=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},Aa=class r{constructor(e,t,n){this.color=e;this.zIndex=t;this.data=n}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&Pn(e.data,t.data)}static equalsArr(e,t){return Pn(e,t,r.equals)}};var Of=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,n){this.from=e|0,this.to=t|0,this.colorId=n|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},K_=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,n,i){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=n,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},Nf=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(K_.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=Math.floor(this._outerHeight),o=n/i,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let u=this._zones[l];if(!e){let x=u.getColorZones();if(x){a.push(x);continue}}let c=this._getVerticalOffsetForLine(u.startLineNumber),p=u.heightInLines===0?this._getVerticalOffsetForLine(u.endLineNumber)+t:c+u.heightInLines*t,h=Math.floor(o*c),g=Math.floor(o*p),f=Math.floor((h+g)/2),v=g-f;v<s&&(v=s),f-v<0&&(f=v),f+v>n&&(f=n-v);let y=u.color,I=this._color2Id[y];I||(I=++this._lastAssignedId,this._color2Id[y]=I,this._id2Color[I]=y);let S=new Of(f-v,f+v,I);u.setColorZone(S),a.push(S)}return this._colorZonesInvalid=!1,a.sort(Of.compare),a}};var Ui=G("codeEditorService");var Md=class{constructor(e,t,n,i,o,s,a,l,d,u,c,p,h,g,f,v,y){this.hostService=e;this.contextService=t;this.historyService=n;this.environmentService=i;this.instantiationService=o;this.configurationService=s;this.fileService=a;this.openerService=l;this.dialogService=d;this.languageService=u;this.workspacesService=c;this.labelService=p;this.pathService=h;this.commandService=g;this.editorService=f;this.codeEditorService=v;this.logService=y}async defaultFilePath(e=this.getSchemeFilterForWindow(),t=this.getAuthorityFilterForWindow()){let n=this.historyService.getLastActiveFile(e,t);return n?n=Yt(n):n=this.historyService.getLastActiveWorkspaceRoot(e,t),n||(n=await this.preferredHome(e)),n}async defaultFolderPath(e=this.getSchemeFilterForWindow(),t=this.getAuthorityFilterForWindow()){let n=this.historyService.getLastActiveWorkspaceRoot(e,t);return n||(n=this.historyService.getLastActiveFile(e,t)),n?Yt(n):this.preferredHome(e)}async preferredHome(e=this.getSchemeFilterForWindow()){let t=e===J.file,n=this.configurationService.inspect("files.dialog.defaultPath"),i=t?n.userLocalValue:n.userRemoteValue;if(i&&(t?ll(i):(await this.pathService.path).isAbsolute(i))){let s=t?Ms(i):(await this.pathService.path).normalize(i),a=Dh(await this.pathService.fileURI(s),this.environmentService.remoteAuthority,this.pathService.defaultUriScheme);if(await this.fileService.exists(a))return a}return this.pathService.userHome({preferLocal:t})}async defaultWorkspacePath(e=this.getSchemeFilterForWindow()){let t;if(this.contextService.getWorkbenchState()===3){let n=this.contextService.getWorkspace().configuration;n?.scheme===e&&oT(n,this.environmentService)&&!Zy(n)&&(t=Yt(n))}return t||(t=await this.defaultFilePath(e)),t}async showSaveConfirm(e){return this.skipDialogs()?(this.logService.trace("FileDialogService: refused to show save confirmation dialog in tests."),1):this.doShowSaveConfirm(e)}skipDialogs(){return this.environmentService.isExtensionDevelopment&&this.environmentService.extensionTestsLocationURI?!0:!!this.environmentService.enableSmokeTestDriver}async doShowSaveConfirm(e){if(e.length===0)return 1;let t,n=m("saveChangesDetail","Your changes will be lost if you don't save them.");e.length===1?t=m("saveChangesMessage","Do you want to save the changes you made to {0}?",typeof e[0]=="string"?e[0]:st(e[0])):(t=m("saveChangesMessages","Do you want to save the changes to the following {0} files?",e.length),n=nT(e)+`
`+n);let{result:i}=await this.dialogService.prompt({type:gn.Warning,message:t,detail:n,buttons:[{label:e.length>1?m({key:"saveAll",comment:["&& denotes a mnemonic"]},"&&Save All"):m({key:"save",comment:["&& denotes a mnemonic"]},"&&Save"),run:()=>0},{label:m({key:"dontSave",comment:["&& denotes a mnemonic"]},"Do&&n't Save"),run:()=>1}],cancelButton:{run:()=>2}});return i}addFileSchemaIfNeeded(e,t){return e===J.untitled?[J.file]:e!==J.file?[e,J.file]:[e]}async pickFileFolderAndOpenSimplified(e,t,n){let i=m("openFileOrFolder.title","Open File or Folder"),o=this.addFileSchemaIfNeeded(e),s=await this.pickResource({canSelectFiles:!0,canSelectFolders:!0,canSelectMany:!1,defaultUri:t.defaultUri,title:i,availableFileSystems:o});if(s){let a=await this.fileService.stat(s),l=a.isDirectory?{folderUri:s}:{fileUri:s};!b1(l)&&v1(l)&&this.addFileToRecentlyOpened(l.fileUri),a.isDirectory||t.forceNewWindow||n?await this.hostService.openWindow([l],{forceNewWindow:t.forceNewWindow,remoteAuthority:t.remoteAuthority}):await this.editorService.openEditors([{resource:s,options:{source:1,pinned:!0}}],void 0,{validateTrust:!0})}}async pickFileAndOpenSimplified(e,t,n){let i=m("openFile.title","Open File"),o=this.addFileSchemaIfNeeded(e),s=await this.pickResource({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,defaultUri:t.defaultUri,title:i,availableFileSystems:o});s&&(this.addFileToRecentlyOpened(s),t.forceNewWindow||n?await this.hostService.openWindow([{fileUri:s}],{forceNewWindow:t.forceNewWindow,remoteAuthority:t.remoteAuthority}):await this.editorService.openEditors([{resource:s,options:{source:1,pinned:!0}}],void 0,{validateTrust:!0}))}addFileToRecentlyOpened(e){this.workspacesService.addRecentlyOpened([{fileUri:e,label:this.labelService.getUriLabel(e)}])}async pickFolderAndOpenSimplified(e,t){let n=m("openFolder.title","Open Folder"),i=this.addFileSchemaIfNeeded(e,!0),o=await this.pickResource({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,defaultUri:t.defaultUri,title:n,availableFileSystems:i});if(o)return this.hostService.openWindow([{folderUri:o}],{forceNewWindow:t.forceNewWindow,remoteAuthority:t.remoteAuthority})}async pickWorkspaceAndOpenSimplified(e,t){let n=m("openWorkspace.title","Open Workspace from File"),i=[{name:m("filterName.workspace","Workspace"),extensions:[Bh]}],o=this.addFileSchemaIfNeeded(e,!0),s=await this.pickResource({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,defaultUri:t.defaultUri,title:n,filters:i,availableFileSystems:o});if(s)return this.hostService.openWindow([{workspaceUri:s}],{forceNewWindow:t.forceNewWindow,remoteAuthority:t.remoteAuthority})}async pickFileToSaveSimplified(e,t){t.availableFileSystems||(t.availableFileSystems=this.addFileSchemaIfNeeded(e)),t.title=m("saveFileAs.title","Save As");let n=await this.saveRemoteResource(t);return n&&this.addFileToRecentlyOpened(n),n}async showSaveDialogSimplified(e,t){return t.availableFileSystems||(t.availableFileSystems=this.addFileSchemaIfNeeded(e)),this.saveRemoteResource(t)}async showOpenDialogSimplified(e,t){t.availableFileSystems||(t.availableFileSystems=this.addFileSchemaIfNeeded(e,t.canSelectFolders));let n=await this.pickResource(t);return n?[n]:void 0}getSimpleFileDialog(){return this.instantiationService.createInstance(xd)}pickResource(e){return this.getSimpleFileDialog().showOpenDialog(e)}saveRemoteResource(e){return this.getSimpleFileDialog().showSaveDialog(e)}getSchemeFilterForWindow(e){return e??this.pathService.defaultUriScheme}getAuthorityFilterForWindow(){return this.environmentService.remoteAuthority}getFileSystemSchema(e){return e.availableFileSystems&&e.availableFileSystems[0]||this.getSchemeFilterForWindow(e.defaultUri?.scheme)}getWorkspaceAvailableFileSystems(e){if(e.availableFileSystems&&e.availableFileSystems.length>0)return e.availableFileSystems;let t=[J.file];return this.environmentService.remoteAuthority&&t.unshift(J.vscodeRemote),t}getPickFileToSaveDialogOptions(e,t){let n={defaultUri:e,title:m("saveAsTitle","Save As"),availableFileSystems:t},i=e?js(e):void 0,o,s=this.languageService.getSortedRegisteredLanguageNames(),a=$n(s.map(({languageName:l,languageId:d})=>{let u=this.languageService.getExtensions(d);if(!u.length)return null;let c={name:l,extensions:Fo(u).slice(0,10).map(h=>Du(h,"."))},p=i||VC;if(!o&&u.includes(p)){o=c;let h=Du(p,".");return c.extensions.includes(h)||c.extensions.unshift(h),null}return c}));return!o&&i&&(o={name:Du(i,".").toUpperCase(),extensions:[Du(i,".")]}),n.filters=$n([{name:m("allFiles","All Files"),extensions:["*"]},o,...a,{name:m("noExt","No Extension"),extensions:[""]}]),n}};Md=ne([M(0,ZL),M(1,Pr),M(2,cL),M(3,fd),M(4,St),M(5,ln),M(6,An),M(7,QL),M(8,Ah),M(9,li),M(10,YL),M(11,ad),M(12,sf),M(13,fo),M(14,Fi),M(15,Ui),M(16,ti)],Md);var Hi;(i=>{function r(o){return typeof o?.showDirectoryPicker=="function"}i.supported=r;function e(o){let s=o;return s?typeof s.kind=="string"&&typeof s.queryPermission=="function"&&typeof s.requestPermission=="function":!1}i.isFileSystemHandle=e;function t(o){return o.kind==="file"}i.isFileSystemFileHandle=t;function n(o){return o.kind==="directory"}i.isFileSystemDirectoryHandle=n})(Hi||={});var PN={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:ha.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};async function rk(r,e){let t=r.get(Ah),n=[];for(let i=0;i<e.length;i++){let o=e.item(i);if(o){if(o.size>100*tm.MB){t.warn(m("fileTooLarge","File is too large to open as untitled editor. Please upload it first into the file explorer and then try again."));continue}let s=new Il;n.push(s);let a=new FileReader;a.onerror=()=>s.complete(void 0),a.onabort=()=>s.complete(void 0),a.onload=async l=>{let d=o.name,u=l.target?.result??void 0;if(typeof d!="string"||typeof u>"u"){s.complete(void 0);return}s.complete({resource:ae.from({scheme:J.untitled,path:d}),contents:typeof u=="string"?dt.fromString(u):dt.wrap(new Uint8Array(u))})},a.readAsArrayBuffer(o)}}return $n(await Promise.all(n.map(i=>i.p)))}var G_=class{_contributions=new Map;register(e){if(this._contributions.has(e.dataFormatKey))throw new Error(`A drag and drop contributiont with key '${e.dataFormatKey}' was already registered.`);this._contributions.set(e.dataFormatKey,e)}getAll(){return this._contributions.values()}},MN={DragAndDropContribution:"workbench.contributions.dragAndDrop"};Xe.add(MN.DragAndDropContribution,new G_);var ik=class r{static INSTANCE=new r;data;proto;constructor(){}static getInstance(){return r.INSTANCE}hasData(e){return e&&e===this.proto}clearData(e){this.hasData(e)&&(this.proto=void 0,this.data=void 0)}getData(e){if(this.hasData(e))return this.data}setData(e,t){t&&(this.data=e,this.proto=t)}};var ok=G("markerDecorationsService");var Fa=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let n=t.kbExpr;this.precondition&&(n?n=vt.and(n,this.precondition):n=this.precondition);let i={id:this.id,weight:t.weight,args:t.args,when:n,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};pd.registerKeybindingRule(i)}}Js.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){nL.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},dp=class extends Fa{_implementations=[];addImplementation(e,t,n,i){return this._implementations.push({priority:e,name:t,implementation:n,when:i}),this._implementations.sort((o,s)=>s.priority-o.priority),{dispose:()=>{for(let o=0;o<this._implementations.length;o++)if(this._implementations[o].implementation===n){this._implementations.splice(o,1);return}}}}runCommand(e,t){let n=e.get(ti),i=e.get(ei);n.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let o of this._implementations){if(o.when){let a=i.getContext(La());if(!o.when.evaluate(a))continue}let s=o.implementation(e,t);if(s)return n.trace(`Command '${this.id}' was handled by '${o.name}'.`),typeof s=="boolean"?void 0:s}n.trace(`The Command '${this.id}' was not handled by any implementation.`)}},Af=class extends Fa{constructor(t,n){super(n);this.command=t}runCommand(t,n){return this.command.runCommand(t,n)}},up=class r extends Fa{static bindToContribution(e){return class extends r{_callback;constructor(n){super(n),this._callback=n.handler}runEditorCommand(n,i,o){let s=e(i);s&&this._callback(s,o)}}}static runEditorCommand(e,t,n,i){let o=e.get(Ui),s=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(ei).contextMatchesRules(n??void 0))return i(a,s,t)})}runCommand(e,t){return r.runEditorCommand(e,t,this.precondition,(n,i,o)=>this.runEditorCommand(n,i,o))}};function ge(r){return Xr.INSTANCE.registerEditorCommand(r),r}function sk(r,e,t){Xr.INSTANCE.registerEditorContribution(r,e,t)}var cp;(o=>{function r(s){return Xr.INSTANCE.getEditorCommand(s)}o.getEditorCommand=r;function e(){return Xr.INSTANCE.getEditorActions()}o.getEditorActions=e;function t(){return Xr.INSTANCE.getEditorContributions()}o.getEditorContributions=t;function n(s){return Xr.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}o.getSomeEditorContributions=n;function i(){return Xr.INSTANCE.getDiffEditorContributions()}o.getDiffEditorContributions=i})(cp||={});var NN={EditorCommonContributions:"editor.contributions"},Xr=class r{static INSTANCE=new r;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,n){this.editorContributions.push({id:e,ctor:t,instantiation:n})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};Xe.add(NN.EditorCommonContributions,Xr.INSTANCE);function pp(r){return r.register(),r}var j_=pp(new dp({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Hn.MenubarEditMenu,group:"1_do",title:m({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:Hn.CommandPalette,group:"",title:m("undo","Undo"),order:1}]}));pp(new Af(j_,{id:"default:undo",precondition:void 0}));var q_=pp(new dp({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Hn.MenubarEditMenu,group:"1_do",title:m({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:Hn.CommandPalette,group:"",title:m("redo","Redo"),order:1}]}));pp(new Af(q_,{id:"default:redo",precondition:void 0}));var ak=pp(new dp({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Hn.MenubarSelectionMenu,group:"1_basic",title:m({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:Hn.CommandPalette,group:"",title:m("selectAll","Select All"),order:1}]}));var Od=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};Od=ne([M(1,ok)],Od);sk(Od.ID,Od,0);var Do;(P=>{let r={total:0,min:Number.MAX_VALUE,max:0},e={...r},t={...r},n={...r},i=0,o;(W=>(W[W.Before=0]="Before",W[W.InProgress=1]="InProgress",W[W.Finished=2]="Finished"))(o||={});let s={keydown:0,input:0,render:0};function a(){y(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}P.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,v()}P.onBeforeInput=d;function u(){s.input===0&&d(),queueMicrotask(c)}P.onInput=u;function c(){s.input===1&&(performance.mark("input/end"),s.input=2)}function p(){y()}P.onKeyUp=p;function h(){y()}P.onSelectionChange=h;function g(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(f),v())}P.onRenderStart=g;function f(){s.render===1&&(performance.mark("render/end"),s.render=2)}function v(){setTimeout(y)}function y(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),I("keydown",r),I("input",e),I("render",t),I("inputlatency",n),i++,S())}function I(O,k){let F=performance.getEntriesByName(O)[0].duration;k.total+=F,k.min=Math.min(k.min,F),k.max=Math.max(k.max,F)}function S(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function x(){if(i===0)return;let O={keydown:T(r),input:T(e),render:T(t),total:T(n),sampleCount:i};return R(r),R(e),R(t),R(n),i=0,O}P.getAndClearMeasurements=x;function T(O){return{average:O.total/i,max:O.max,min:O.min}}function R(O){O.total=0,O.min=Number.MAX_VALUE,O.max=0}})(Do||={});var Jr=class{_hooks=new We;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,n,i,o){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=o;let s=e;try{e.setPointerCapture(t),this._hooks.add(ve(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=_e(e)}this._hooks.add(oe(s,De.POINTER_MOVE,a=>{if(a.buttons!==n){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(oe(s,De.POINTER_UP,a=>this.stopMonitoring(!0)))}};var Cs=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new hp(this.x-e.scrollX,this.y-e.scrollY)}},hp=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new Cs(this.clientX+e.scrollX,this.clientY+e.scrollY)}},$_=class{constructor(e,t,n,i){this.x=e;this.y=t;this.width=n;this.height=i}_editorPagePositionBrand=void 0},Y_=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function Vf(r){let e=gr(r);return new $_(e.left,e.top,e.width,e.height)}function Uf(r,e,t){let n=e.width/r.offsetWidth,i=e.height/r.offsetHeight,o=(t.x-e.x)/n,s=(t.y-e.y)/i;return new Y_(o,s)}var zi=class extends pr{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,n){super(_e(n),e),this.isFromPointerCapture=t,this.pos=new Cs(this.posx,this.posy),this.editorPos=Vf(n),this.relativePos=Uf(n,this.editorPos,this.pos)}},Ff=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new zi(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return oe(e,"contextmenu",n=>{t(this._create(n))})}onMouseUp(e,t){return oe(e,"mouseup",n=>{t(this._create(n))})}onMouseDown(e,t){return oe(e,De.MOUSE_DOWN,n=>{t(this._create(n))})}onPointerDown(e,t){return oe(e,De.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onMouseLeave(e,t){return oe(e,De.MOUSE_LEAVE,n=>{t(this._create(n))})}onMouseMove(e,t){return oe(e,"mousemove",n=>t(this._create(n)))}},Wf=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new zi(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return oe(e,"pointerup",n=>{t(this._create(n))})}onPointerDown(e,t){return oe(e,De.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onPointerLeave(e,t){return oe(e,De.POINTER_LEAVE,n=>{t(this._create(n))})}onPointerMove(e,t){return oe(e,"pointermove",n=>t(this._create(n)))}},Bf=class extends B{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new Jr),this._keydownListener=null}startMonitoring(e,t,n,i,o){this._keydownListener=To(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,n,s=>{i(new zi(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),o(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var Hf=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,n,i){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new _(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var Q_=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},zf=class extends Q_{_renderingContextBrand=void 0;_viewLines;constructor(e,t,n){super(e,t),this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},Kf=class{constructor(e,t,n,i){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=n;this.continuesOnNextLine=i}static firstLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber<t.lineNumber)&&(t=n);return t}static lastLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber>t.lineNumber)&&(t=n);return t}},Nd=class r{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let o=e[n];t[n]=new r(o.left,o.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},vr=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},Gf=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},mp=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var jf=class{configuration;viewModel;viewLayout;theme;constructor(e,t,n){this.configuration=e,this.theme=new yf(t),this.viewModel=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var tt=class extends Vi{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Bt=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;let o=new Uint8Array(i);for(let s=0;s<i;s++)o[s]=n[i-s-1];return o}};function qf(r,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(r,e)}catch(n){Le(n);return}try{return globalThis.trustedTypes?.createPolicy(r,e)}catch(n){Le(n);return}}var gp=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Re("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>i)return null;let o=0,s=0;for(let l=n;l<=i;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(o=d,s=1):s++)}if(e<n){let l=0;t<n?l=t-e+1:l=n-e,this._rendLineNumberStart-=l}return this._lines.splice(o,s)}onLinesChanged(e,t){let n=e+t-1;if(this.getCount()===0)return!1;let i=this.getStartLineNumber(),o=this.getEndLineNumber(),s=!1;for(let a=e;a<=n;a++)a>=i&&a<=o&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let n=t-e+1,i=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>o)return null;if(n+e>o)return this._lines.splice(e-this._rendLineNumberStart,o-e+1);let s=[];for(let c=0;c<n;c++)s[c]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-n),u=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=l.concat(s).concat(d),u}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),n=this.getEndLineNumber(),i=!1;for(let o=0,s=e.length;o<s;o++){let a=e[o];if(a.toLineNumber<t||a.fromLineNumber>n)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(n,a.toLineNumber);for(let u=l;u<=d;u++){let c=u-this._rendLineNumberStart;this._lines[c].onTokensChanged(),i=!0}}return i}},Ad=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new gp(this._lineFactory);_createDomNode(){let e=pe(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),n=new Z_(this.domNode.domNode,this._lineFactory,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},o=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}},Z_=class r{constructor(e,t,n){this._domNode=e;this._lineFactory=t;this._viewportData=n}static _ttPolicy=qf("editorViewLayer",{createHTML:e=>e});render(e,t,n,i){let o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<t||n<o.rendLineNumberStart){o.rendLineNumberStart=t,o.linesLength=n-t+1,o.lines=[];for(let s=t;s<=n;s++)o.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(o,!0,i),o}if(this._renderUntouchedLines(o,Math.max(t-o.rendLineNumberStart,0),Math.min(n-o.rendLineNumberStart,o.linesLength-1),i,t),o.rendLineNumberStart>t){let s=t,a=Math.min(n,o.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(o,s,a,i,t),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart<t){let s=Math.min(o.linesLength,t-o.rendLineNumberStart);s>0&&(this._removeLinesBefore(o,s),o.linesLength-=s)}if(o.rendLineNumberStart=t,o.rendLineNumberStart+o.linesLength-1<n){let s=o.rendLineNumberStart+o.linesLength,a=n;s<=a&&(this._insertLinesAfter(o,s,a,i,t),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart+o.linesLength-1>n){let s=Math.max(0,n-o.rendLineNumberStart+1),l=o.linesLength-1-s+1;l>0&&(this._removeLinesAfter(o,l),o.linesLength-=l)}return this._finishRendering(o,!1,i),o}_renderUntouchedLines(e,t,n,i,o){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=n;l++){let d=s+l;a[l].layoutLine(d,i[d-o],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,n,i,o){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++)e.lines[n].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,o){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let n=e.linesLength-t;for(let i=0;i<t;i++)e.lines[n+i].getDomNode()?.remove();e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){r._ttPolicy&&(n=r._ttPolicy.createHTML(n));let o=this._domNode.lastChild;t||!o?this._domNode.innerHTML=n:o.insertAdjacentHTML("afterend",n);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];i[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,n){let i=document.createElement("div");r._ttPolicy&&(t=r._ttPolicy.createHTML(t)),i.innerHTML=t;for(let o=0;o<e.linesLength;o++){let s=e.lines[o];if(n[o]){let a=i.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new ua(1e5);_finishRendering(e,t,n){let i=r._sb,o=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{i.reset();let d=!1;for(let u=0;u<o;u++){let c=s[u];l[u]=!1,!(c.getDomNode()||!c.renderLine(u+a,n[u],this._viewportData.lineHeight,this._viewportData,i))&&(l[u]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,i.build(),l)}{i.reset();let d=!1,u=[];for(let c=0;c<o;c++){let p=s[c];u[c]=!1,!(l[c]||!p.renderLine(c+a,n[c],this._viewportData.lineHeight,this._viewportData,i))&&(u[c]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,i.build(),u)}}};var Fd=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var Wa=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,o){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(n,i),s.getClientRects()}catch{return null}finally{this._detachRange(s,o)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(vr.compare);let t=[],n=0,i=e[0];for(let o=1,s=e.length;o<s;o++){let a=e[o];i.left+i.width+.9>=a.left?i.width=Math.max(i.width,a.left+a.width-i.left):(t[n++]=i,i=a)}return t[n++]=i,t}static _createHorizontalRangesFromClientRects(e,t,n){if(!e||e.length===0)return null;let i=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];i[o]=new vr(Math.max(0,(a.left-t)/n),a.width/n)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,n,i,o,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),i=Math.min(l,Math.max(0,i)),t===i&&n===o&&n===0&&!e.children[t].firstChild){let p=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}t!==i&&i>0&&o===0&&(i--,o=1073741824);let d=e.children[t].firstChild,u=e.children[i].firstChild;if((!d||!u)&&(!d&&n===0&&t>0&&(d=e.children[t-1].firstChild,n=1073741824),!u&&o===0&&i>0&&(u=e.children[i-1].firstChild,o=1073741824)),!d||!u)return null;n=Math.min(d.textContent.length,Math.max(0,n)),o=Math.min(u.textContent.length,Math.max(0,o));let c=this._readClientRects(d,n,u,o,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(c,s.clientRectDeltaLeft,s.clientRectScale)}};var It=class{constructor(e,t,n,i){this.endIndex=e;this.type=t;this.metadata=n;this.containsRTL=i}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var Po=class r{constructor(e,t,n,i){this.startColumn=e;this.endColumn=t;this.className=n;this.type=i}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let n=e.length,i=t.length;if(n!==i)return!1;for(let o=0;o<n;o++)if(!r._equals(e[o],t[o]))return!1;return!0}static extractWrapped(e,t,n){if(e.length===0)return e;let i=t+1,o=n+1,s=n-t,a=[],l=0;for(let d of e)d.endColumn<=i||d.startColumn>=o||(a[l++]=new r(Math.max(1,d.startColumn-i+1),Math.min(s+1,d.endColumn-i+1),d.className,d.type));return a}static filter(e,t,n,i){if(e.length===0)return[];let o=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],u=d.range;if(u.endLineNumber<t||u.startLineNumber>t||u.isEmpty()&&(d.type===0||d.type===3))continue;let c=u.startLineNumber===t?u.startColumn:n,p=u.endLineNumber===t?u.endColumn:i;o[s++]=new r(c,p,d.inlineClassName,d.type)}return o}static _typeCompare(e,t){let n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let n=r._typeCompare(e.type,t.type);return n!==0?n:e.className!==t.className?e.className<t.className?-1:1:0}},$f=class{startOffset;endOffset;className;metadata;constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}},X_=class r{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;n.push(new $f(t,this.stopOffsets[i],this.classNames.join(" "),r._metadata(this.metadata))),t=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&t<e&&(n.push(new $f(t,e-1,this.classNames.join(" "),r._metadata(this.metadata))),t=e),t}insert(e,t,n){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}},Yf=class{static normalize(e,t){if(t.length===0)return[];let n=[],i=new X_,o=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,u=l.endColumn,c=l.className,p=l.type===1?2:l.type===2?4:0;if(d>1){let f=e.charCodeAt(d-2);lt(f)&&d--}if(u>1){let f=e.charCodeAt(u-2);lt(f)&&u--}let h=d-1,g=u-2;o=i.consumeLowerThan(h,o,n),i.count===0&&(o=h),i.insert(g,c,p)}return i.consumeLowerThan(1073741824,o,n),n}};var Wd=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},Qf=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,n,i,o,s,a,l,d,u,c,p,h,g,f,v,y,I,S){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=o,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(Po.compare),this.tabSize=u,this.startVisibleColumn=c,this.spaceWidth=p,this.stopRenderingLineAfter=f,this.renderWhitespace=v==="all"?4:v==="boundary"?1:v==="selection"?2:v==="trailing"?3:0,this.renderControlCharacters=y,this.fontLigatures=I,this.selectionsOnLine=S&&S.sort((R,P)=>R.startOffset<P.startOffset?-1:1);let x=Math.abs(g-p),T=Math.abs(h-p);x<T?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=h,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&Po.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var fp=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},bp=class r{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,n,i){let o=(t<<16|n<<0)>>>0;this._data[e-1]=o,this._horizontalOffset[e-1]=i}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),n=r.getPartIndex(t),i=r.getCharIndex(t);return new fp(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(this.length===0)return 0;let i=(e<<16|n<<0)>>>0,o=0,s=this.length-1;for(;o+1<s;){let f=o+s>>>1,v=this._data[f];if(v===i)return f;v>i?s=f:o=f}if(o===s)return o;let a=this._data[o],l=this._data[s];if(a===i)return o;if(l===i)return s;let d=r.getPartIndex(a),u=r.getCharIndex(a),c=r.getPartIndex(l),p;d!==c?p=t:p=r.getCharIndex(l);let h=n-u,g=p-n;return h<=g?o:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let n=this._data[t],i=r.getPartIndex(n),o=r.getCharIndex(n),s=this._horizontalOffset[t];e.push([i,o,s])}return e}};var vp=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,n){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}};function lk(r,e){if(r.lineContent.length===0){if(r.lineDecorations.length>0){e.appendString("<span>");let t=0,n=0,i=0;for(let s of r.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(i|=1,t++),s.type===2&&(i|=2,n++));e.appendString("</span>");let o=new bp(1,t+n);return o.setColumnInfo(1,t,0,0),new vp(o,!1,i)}return e.appendString("<span><span></span></span>"),new vp(new bp(0,0),!1,0)}return KN(WN(r),e)}var ex=class{constructor(e,t,n,i,o,s,a,l,d,u,c,p,h,g,f,v){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=n;this.len=i;this.isOverflowing=o;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=u;this.startVisibleColumn=c;this.containsRTL=p;this.spaceWidth=h;this.renderSpaceCharCode=g;this.renderWhitespace=f;this.renderControlCharacters=v}};function WN(r){let e=r.lineContent,t,n,i;r.stopRenderingLineAfter!==-1&&r.stopRenderingLineAfter<e.length?(t=!0,n=e.length-r.stopRenderingLineAfter,i=r.stopRenderingLineAfter):(t=!1,n=0,i=e.length);let o=BN(e,r.containsRTL,r.lineTokens,r.fauxIndentLength,i);r.renderControlCharacters&&!r.isBasicASCII&&(o=UN(e,o)),(r.renderWhitespace===4||r.renderWhitespace===1||r.renderWhitespace===2&&r.selectionsOnLine||r.renderWhitespace===3&&!r.continuesWithWrappedLine)&&(o=HN(r,e,i,o));let s=0;if(r.lineDecorations.length>0){for(let a=0,l=r.lineDecorations.length;a<l;a++){let d=r.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}o=zN(e,i,o,r.lineDecorations)}return r.containsRTL||(o=VN(e,o,!r.isBasicASCII||r.fontLigatures)),new ex(r.useMonospaceOptimizations,r.canUseHalfwidthRightwardsArrow,e,i,t,n,o,s,r.fauxIndentLength,r.tabSize,r.startVisibleColumn,r.containsRTL,r.spaceWidth,r.renderSpaceCharCode,r.renderWhitespace,r.renderControlCharacters)}function BN(r,e,t,n,i){let o=[],s=0;n>0&&(o[s++]=new It(n,"",0,!1));let a=n;for(let l=0,d=t.getCount();l<d;l++){let u=t.getEndOffset(l);if(u<=n)continue;let c=t.getClassName(l);if(u>=i){let h=e?uo(r.substring(a,i)):!1;o[s++]=new It(i,c,0,h);break}let p=e?uo(r.substring(a,u)):!1;o[s++]=new It(u,c,0,p),a=u}return o}function VN(r,e,t){let n=0,i=[],o=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(n+50<d){let u=l.type,c=l.metadata,p=l.containsRTL,h=-1,g=n;for(let f=n;f<d;f++)r.charCodeAt(f)===32&&(h=f),h!==-1&&f-g>=50&&(i[o++]=new It(h+1,u,c,p),g=h+1,h=-1);g!==d&&(i[o++]=new It(d,u,c,p))}else i[o++]=l;n=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,u=d-n;if(u>50){let c=l.type,p=l.metadata,h=l.containsRTL,g=Math.ceil(u/50);for(let f=1;f<g;f++){let v=n+f*50;i[o++]=new It(v,c,p,h)}i[o++]=new It(d,c,p,h)}else i[o++]=l;n=d}return i}function dk(r){return r<32?r!==9:r===127||r>=8234&&r<=8238||r>=8294&&r<=8297||r>=8206&&r<=8207||r===1564}function UN(r,e){let t=[],n=new It(0,"",0,!1),i=0;for(let o of e){let s=o.endIndex;for(;i<s;i++){let a=r.charCodeAt(i);dk(a)&&(i>n.endIndex&&(n=new It(i,o.type,o.metadata,o.containsRTL),t.push(n)),n=new It(i+1,"mtkcontrol",o.metadata,!1),t.push(n))}i>n.endIndex&&(n=new It(s,o.type,o.metadata,o.containsRTL),t.push(n))}return t}function HN(r,e,t,n){let i=r.continuesWithWrappedLine,o=r.fauxIndentLength,s=r.tabSize,a=r.startVisibleColumn,l=r.useMonospaceOptimizations,d=r.selectionsOnLine,u=r.renderWhitespace===1,c=r.renderWhitespace===3,p=r.renderSpaceWidth!==r.spaceWidth,h=[],g=0,f=0,v=n[f].type,y=n[f].containsRTL,I=n[f].endIndex,S=n.length,x=!1,T=gt(e),R;T===-1?(x=!0,T=t,R=t):R=yi(e);let P=!1,O=0,k=d&&d[O],F=a%s;for(let H=o;H<t;H++){let $=e.charCodeAt(H);k&&H>=k.endOffset&&(O++,k=d&&d[O]);let ee;if(H<T||H>R)ee=!0;else if($===9)ee=!0;else if($===32)if(u)if(P)ee=!0;else{let K=H+1<t?e.charCodeAt(H+1):0;ee=K===32||K===9}else ee=!0;else ee=!1;if(ee&&d&&(ee=!!k&&k.startOffset<=H&&k.endOffset>H),ee&&c&&(ee=x||H>R),ee&&y&&H>=T&&H<=R&&(ee=!1),P){if(!ee||!l&&F>=s){if(p){let K=g>0?h[g-1].endIndex:o;for(let V=K+1;V<=H;V++)h[g++]=new It(V,"mtkw",1,!1)}else h[g++]=new It(H,"mtkw",1,!1);F=F%s}}else(H===I||ee&&H>o)&&(h[g++]=new It(H,v,0,y),F=F%s);for($===9?F=s:Ii($)?F+=2:F++,P=ee;H===I&&(f++,f<S);)v=n[f].type,y=n[f].containsRTL,I=n[f].endIndex}let W=!1;if(P)if(i&&u){let H=t>0?e.charCodeAt(t-1):0,$=t>1?e.charCodeAt(t-2):0;H===32&&$!==32&&$!==9||(W=!0)}else W=!0;if(W)if(p){let H=g>0?h[g-1].endIndex:o;for(let $=H+1;$<=t;$++)h[g++]=new It($,"mtkw",1,!1)}else h[g++]=new It(t,"mtkw",1,!1);else h[g++]=new It(t,v,0,y);return h}function zN(r,e,t,n){n.sort(Po.compare);let i=Yf.normalize(r,n),o=i.length,s=0,a=[],l=0,d=0;for(let c=0,p=t.length;c<p;c++){let h=t[c],g=h.endIndex,f=h.type,v=h.metadata,y=h.containsRTL;for(;s<o&&i[s].startOffset<g;){let I=i[s];if(I.startOffset>d&&(d=I.startOffset,a[l++]=new It(d,f,v,y)),I.endOffset+1<=g)d=I.endOffset+1,a[l++]=new It(d,f+" "+I.className,v|I.metadata,y),s++;else{d=g,a[l++]=new It(d,f+" "+I.className,v|I.metadata,y);break}}g>d&&(d=g,a[l++]=new It(d,f,v,y))}let u=t[t.length-1].endIndex;if(s<o&&i[s].startOffset===u)for(;s<o&&i[s].startOffset===u;){let c=i[s];a[l++]=new It(d,c.className,c.metadata,!1),s++}return a}function KN(r,e){let t=r.fontIsMonospace,n=r.canUseHalfwidthRightwardsArrow,i=r.containsForeignElements,o=r.lineContent,s=r.len,a=r.isOverflowing,l=r.overflowingCharCount,d=r.parts,u=r.fauxIndentLength,c=r.tabSize,p=r.startVisibleColumn,h=r.containsRTL,g=r.spaceWidth,f=r.renderSpaceCharCode,v=r.renderWhitespace,y=r.renderControlCharacters,I=new bp(s+1,d.length),S=!1,x=0,T=p,R=0,P=0,O=0;h?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let k=0,F=d.length;k<F;k++){let W=d[k],H=W.endIndex,$=W.type,ee=W.containsRTL,K=v!==0&&W.isWhitespace(),V=K&&!t&&($==="mtkw"||!i),Y=x===H&&W.isPseudoAfter();if(R=0,e.appendString("<span "),ee&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(V?"mtkz":$),e.appendASCIICharCode(34),K){let j=0;{let U=x,te=T;for(;U<H;U++){let Ue=(o.charCodeAt(U)===9?c-te%c:1)|0;j+=Ue,U>=u&&(te+=Ue)}}for(V&&(e.appendString(' style="width:'),e.appendString(String(g*j)),e.appendString('px"')),e.appendASCIICharCode(62);x<H;x++){I.setColumnInfo(x+1,k-O,R,P),O=0;let U=o.charCodeAt(x),te,re;if(U===9){te=c-T%c|0,re=te,!n||re>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let Ue=2;Ue<=re;Ue++)e.appendCharCode(160)}else te=2,re=1,e.appendCharCode(f),e.appendCharCode(8204);R+=te,P+=re,x>=u&&(T+=re)}}else for(e.appendASCIICharCode(62);x<H;x++){I.setColumnInfo(x+1,k-O,R,P),O=0;let j=o.charCodeAt(x),U=1,te=1;switch(j){case 9:U=c-T%c,te=U;for(let re=1;re<=U;re++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:y?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Ii(j)&&te++,y&&j<32?e.appendCharCode(9216+j):y&&j===127?e.appendCharCode(9249):y&&dk(j)?(e.appendString("[U+"),e.appendString(GN(j)),e.appendString("]"),U=8,te=U):e.appendCharCode(j)}R+=U,P+=te,x>=u&&(T+=te)}Y?O++:O=0,x>=s&&!S&&W.isPseudoAfter()&&(S=!0,I.setColumnInfo(x+1,k,R,P)),e.appendString("</span>")}return S||I.setColumnInfo(s+1,d.length-1,R,P),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(m("showMore","Show more ({0})",jN(l))),e.appendString("</span>")),e.appendString("</span>"),new vp(I,h,i)}function GN(r){return r.toString(16).toUpperCase().padStart(4,"0")}function jN(r){return r<1024?m("overflow.chars","{0} chars",r):r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/1024/1024).toFixed(1)} MB`}var qN=function(){return ao?!0:!(pt||Xt||_i)}(),Vd=!0,yp=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let n=e.options,i=n.get(51);n.get(39)==="off"?this.renderWhitespace=n.get(101):this.renderWhitespace="none",this.renderControlCharacters=n.get(96),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(33),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(68),this.stopRenderingLineAfter=n.get(119),this.fontLigatures=n.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},yr=class r{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=pe(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return ns(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,n,i,o){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=i.getViewLineRenderingData(e),a=this._options,l=Po.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(ns(a.themeType)||this._options.renderWhitespace==="selection"){let h=i.selections;for(let g of h){if(g.endLineNumber<e||g.startLineNumber>e)continue;let f=g.startLineNumber===e?g.startColumn:s.minColumn,v=g.endLineNumber===e?g.endColumn:s.maxColumn;f<v&&(ns(a.themeType)&&l.push(new Po(f,v,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new Wd(f-1,v-1))))}}let u=new Qf(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==la.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(u))return!1;o.appendString('<div style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(n)),o.appendString('px;" class="'),o.appendString(r.CLASS_NAME),o.appendString('">');let c=lk(u,o);o.appendString("</div>");let p=null;return Vd&&qN&&s.isBasicASCII&&a.useMonospaceOptimizations&&c.containsForeignElements===0&&(p=new Bd(this._renderedViewLine?this._renderedViewLine.domNode:null,u,c.characterMapping)),p||(p=uk(this._renderedViewLine?this._renderedViewLine.domNode:null,u,c.characterMapping,c.containsRTL,c.containsForeignElements)),this._renderedViewLine=p,!0}layoutLine(e,t,n){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(n))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof Bd:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof Bd?this._renderedViewLine.monospaceAssumptionsAreValid():Vd}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof Bd&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n,i){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),n=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,n));let o=this._renderedViewLine.input.stopRenderingLineAfter;if(o!==-1&&t>o+1&&n>o+1)return new mp(!0,[new vr(this.getWidth(i),0)]);o!==-1&&t>o+1&&(t=o+1),o!==-1&&n>o+1&&(n=o+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,n,i);return s&&s.length>0?new mp(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var Bd=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,n){this.domNode=e,this.input=t;let i=Math.floor(t.lineContent.length/300);if(i>0){this._keyColumnPixelOffsetCache=new Float32Array(i);for(let o=0;o<i;o++)this._keyColumnPixelOffsetCache[o]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return Vd;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),Vd=!1)}return Vd}toSlowRenderedLine(){return uk(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n,i){let o=this._getColumnPixelOffset(e,t,i),s=this._getColumnPixelOffset(e,n,i);return[new vr(o,s-o)]}_getColumnPixelOffset(e,t,n){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let i=Math.floor((t-1)/300)-1,o=(i+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[i],s===-1&&(s=this._actualReadPixelOffset(e,o,n),this._keyColumnPixelOffsetCache[i]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(o),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,n){if(!this.domNode)return-1;let i=this._characterMapping.getDomPosition(t),o=Wa.readHorizontalRanges(this._getReadingTarget(this.domNode),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n);return!o||o.length===0?-1:o[0].left}getColumnOfNodeOffset(e,t){return ck(this._characterMapping,e,t)}},Zf=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,n,i,o){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=o,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,n,i){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let o=this._readPixelOffset(this.domNode,e,t,i);if(o===-1)return null;let s=this._readPixelOffset(this.domNode,e,n,i);return s===-1?null:[new vr(o,s-o)]}return this._readVisibleRangesForRange(this.domNode,e,t,n,i)}_readVisibleRangesForRange(e,t,n,i,o){if(n===i){let s=this._readPixelOffset(e,t,n,o);return s===-1?null:[new vr(s,0)]}else return this._readRawVisibleRangesForRange(e,n,i,o)}_readPixelOffset(e,t,n,i){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(i);let o=this._getReadingTarget(e);return o.firstChild?(i.markDidDomLayout(),o.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let o=this._pixelOffsetCache[n];if(o!==-1)return o;let s=this._actualReadPixelOffset(e,t,n,i);return this._pixelOffsetCache[n]=s,s}return this._actualReadPixelOffset(e,t,n,i)}_actualReadPixelOffset(e,t,n,i){if(this._characterMapping.length===0){let l=Wa.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,i);return!l||l.length===0?-1:l[0].left}if(n===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(i);let o=this._characterMapping.getDomPosition(n),s=Wa.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,o.partIndex,o.charIndex,i);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(n),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,n,i){if(t===1&&n===this._characterMapping.length)return[new vr(0,this.getWidth(i))];let o=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(n);return Wa.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,s.partIndex,s.charIndex,i)}getColumnOfNodeOffset(e,t){return ck(this._characterMapping,e,t)}},tx=class extends Zf{_readVisibleRangesForRange(e,t,n,i,o){let s=super._readVisibleRangesForRange(e,t,n,i,o);if(!s||s.length===0||n===i||n===1&&i===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,i,o);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},uk=function(){return cr?$N:YN}();function $N(r,e,t,n,i){return new tx(r,e,t,n,i)}function YN(r,e,t,n,i){return new Zf(r,e,t,n,i)}function ck(r,e,t){let n=e.textContent.length,i=-1;for(;e;)e=e.previousSibling,i++;return r.getColumn(new fp(i,t),n)}var Mo="monaco-mouse-cursor-text";var Xf=class{constructor(e,t,n,i,o,s,a){this.top=e;this.left=t;this.paddingLeft=n;this.width=i;this.height=o;this.textContent=s;this.textContentClassName=a}};var Ip=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let n=this._context.configuration.options,i=n.get(51);this._cursorStyle=n.get(28),this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(n.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=pe(document.createElement("div")),this._domNode.setClassName(`cursor ${Mo}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),wt(this._domNode,i),this._domNode.setDisplay("none"),this._position=new w(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),wt(this._domNode,n),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,n=this._context.viewModel.getLineContent(e),[i,o]=Ch(n,t-1);return[new w(e,i+1),n.substring(i,o)]}_prepareRender(e){let t="",n="",[i,o]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let p=e.visibleRangeForPosition(i);if(!p||p.outsideRenderedLine)return null;let h=_e(this._domNode.domNode),g;this._cursorStyle===1?(g=D_(h,this._lineCursorWidth>0?this._lineCursorWidth:2),g>2&&(t=o,n=this._getTokenClassName(i))):g=D_(h,1);let f=p.left,v=0;g>=2&&f>=1&&(v=1,f-=v);let y=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new Xf(y,f,v,g,this._lineHeight,t,n)}let s=e.linesVisibleRangesForRange(new _(i.lineNumber,i.column,i.lineNumber,i.column+o.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=o==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=o,n=this._getTokenClassName(i));let u=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,c=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(u+=this._lineHeight-2,c=2),new Xf(u,l.left,0,d,c,t,n)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),n=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(n)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${Mo} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var Ba=class r{static whitespaceVisibleColumn(e,t,n){let i=e.length,o=0,s=-1,a=-1;for(let l=0;l<i;l++){if(l===t)return[s,a,o];switch(o%n===0&&(s=l,a=o),e.charCodeAt(l)){case 32:o+=1;break;case 9:o=Ye.nextRenderTabStop(o,n);break;default:return[-1,-1,-1]}}return t===i?[s,a,o]:[-1,-1,-1]}static atomicPosition(e,t,n,i){let o=e.length,[s,a,l]=r.whitespaceVisibleColumn(e,t,n);if(l===-1)return-1;let d;switch(i){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%n===0)return t;d=l%n<=n/2;break}if(d){if(s===-1)return-1;let p=a;for(let h=s;h<o;++h){if(p===a+n)return s;switch(e.charCodeAt(h)){case 32:p+=1;break;case 9:p=Ye.nextRenderTabStop(p,n);break;default:return-1}}return p===a+n?s:-1}let u=Ye.nextRenderTabStop(l,n),c=l;for(let p=t;p<o;p++){if(c===u)return p;switch(e.charCodeAt(p)){case 32:c+=1;break;case 9:c=Ye.nextRenderTabStop(c,n);break;default:return-1}}return c===u?o:-1}};var eo=class{constructor(e=null){this.hitTarget=e}type=0},Jf=class{constructor(e,t,n){this.position=e;this.spanNode=t;this.injectedText=n}type=1;get hitTarget(){return this.spanNode}},Ud;(e=>{function r(t,n,i){let o=t.getPositionFromDOMInfo(n,i);return o?new Jf(o,n,null):new eo(n)}e.createFromDOMInfo=r})(Ud||={});var eb=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},Vt=class{static _deduceRage(e,t=null){return!t&&e?new _(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,n){return{type:0,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,n,i,o,s){return{type:e,element:t,mouseColumn:n,position:i,range:o,detail:s}}static createViewZone(e,t,n,i,o){return{type:e,element:t,mouseColumn:n,position:i,range:this._deduceRage(i),detail:o}}static createContentText(e,t,n,i,o){return{type:6,element:e,mouseColumn:t,position:n,range:this._deduceRage(n,i),detail:o}}static createContentEmpty(e,t,n,i){return{type:7,element:e,mouseColumn:t,position:n,range:this._deduceRage(n),detail:i}}static createContentWidget(e,t,n){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createScrollbar(e,t,n){return{type:11,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createOverlayWidget(e,t,n){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createOutsideEditor(e,t,n,i){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:n,outsideDistance:i}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},en=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},Hd=class r{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,n){this.viewModel=e.viewModel;let i=e.configuration.options;this.layoutInfo=i.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(68),this.stickyTabStops=i.get(118),this.typicalHalfwidthCharacterWidth=i.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return r.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){let i=n.verticalOffset+n.height/2,o=e.viewModel.getLineCount(),s=null,a,l=null;return n.afterLineNumber!==o&&(l=new w(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new w(n.afterLineNumber,e.viewModel.getLineMaxColumn(n.afterLineNumber))),l===null?a=s:s===null?a=l:t<i?a=s:a=l,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let i=this._context.viewModel.getLineCount(),o=this._context.viewModel.getLineMaxColumn(i);return{range:new _(i,o,i,o),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.viewModel.getLineMaxColumn(t);return{range:new _(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return r._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},ix=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,n,i){this.editorPos=t,this.pos=n,this.relativePos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,zd._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},rx=class extends ix{_ctx;_eventTarget;hitTestResult=new Nn(()=>zd.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Bt.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,n,i,o){super(e,t,n,i),this._ctx=e,this._eventTarget=o;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Ye.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Vt.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Vt.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,n,i){return Vt.createMargin(e,this.target,this._getMouseColumn(t),t,n,i)}fulfillViewZone(e,t,n){return Vt.createViewZone(e,this.target,this._getMouseColumn(t),t,n)}fulfillContentText(e,t,n){return Vt.createContentText(this.target,this._getMouseColumn(e),e,t,n)}fulfillContentEmpty(e,t){return Vt.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Vt.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Vt.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Vt.createOverlayWidget(this.target,this._getMouseColumn(),e)}},pk={isAfterLines:!0};function nx(r){return{isAfterLines:!1,horizontalDistanceToText:r}}var zd=class r{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,n=Bt.collect(t,this._viewHelper.viewDomNode);return!!(en.isChildOfContentWidgets(n)||en.isChildOfOverflowingContentWidgets(n)||en.isChildOfOverlayWidgets(n)||en.isChildOfOverflowingOverlayWidgets(n))}createMouseTarget(e,t,n,i,o){let s=new Hd(this._context,this._viewHelper,e),a=new rx(s,t,n,i,o);try{let l=r._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=r._snapToSoftTabBoundary(l.position,s.viewModel),u=_.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,u,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let n=t,i=null;return!en.isChildOfOverflowGuard(t.targetPath)&&!en.isChildOfOverflowingContentWidgets(t.targetPath)&&!en.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(i=i||t.fulfillUnknown()),i=i||r._hitTestContentWidget(e,n),i=i||r._hitTestOverlayWidget(e,n),i=i||r._hitTestMinimap(e,n),i=i||r._hitTestScrollbarSlider(e,n),i=i||r._hitTestViewZone(e,n),i=i||r._hitTestMargin(e,n),i=i||r._hitTestViewCursor(e,n),i=i||r._hitTestTextArea(e,n),i=i||r._hitTestViewLines(e,n),i=i||r._hitTestScrollbar(e,n),i||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(en.isChildOfContentWidgets(t.targetPath)||en.isChildOfOverflowingContentWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillContentWidget(n):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(en.isChildOfOverlayWidgets(t.targetPath)||en.isChildOfOverflowingOverlayWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillOverlayWidget(n):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let n=e.lastRenderData.lastViewCursorsRenderData;for(let i of n)if(t.target===i.domNode)return t.fulfillContentText(i.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,o=t.mouseVerticalOffset;for(let s of n){if(i<s.contentLeft||i>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=o&&o<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){let i=t.isInContentArea?8:5;return t.fulfillViewZone(i,n.position,n)}return null}static _hitTestTextArea(e,t){return en.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition(),o=Math.abs(t.relativePos.x),s={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:o};if(o-=e.layoutInfo.glyphMarginLeft,o<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(n.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(o/e.lineHeight)],t.fulfillMargin(2,i,n.range,s)}return o-=e.layoutInfo.glyphMarginWidth,o<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,i,n.range,s):(o-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,i,n.range,s))}return null}static _hitTestViewLines(e,t){if(!en.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new w(1,1),pk);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let i=e.viewModel.getLineCount(),o=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new w(i,o),pk)}if(en.isStrictChildOfViewLines(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(i)===0){let s=e.getLineWidth(i),a=nx(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new w(i,1),a)}let o=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=o){let s=nx(t.mouseContentHorizontalOffset-o),a=new w(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(a,s)}}let n=t.hitTestResult.value;return n.type===1?r.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(en.isChildOfMinimap(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new w(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(en.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),o=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new w(i,o))}}return null}static _hitTestScrollbar(e,t){if(en.isChildOfScrollableElement(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new w(n,i))}return null}getMouseColumn(e){let t=this._context.configuration.options,n=t.get(147),i=this._context.viewLayout.getCurrentScrollLeft()+e.x-n.contentLeft;return r._getMouseColumn(i,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i,o){let s=i.lineNumber,a=i.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let y=nx(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(i,y)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(i);let u=d.left;if(Math.abs(t.mouseContentHorizontalOffset-u)<1)return t.fulfillContentText(i,null,{mightBeForeignElement:!!o,injectedText:o});let c=[];if(c.push({offset:d.left,column:a}),a>1){let y=e.visibleRangeForPosition(s,a-1);y&&c.push({offset:y.left,column:a-1})}let p=e.viewModel.getLineMaxColumn(s);if(a<p){let y=e.visibleRangeForPosition(s,a+1);y&&c.push({offset:y.left,column:a+1})}c.sort((y,I)=>y.offset-I.offset);let h=t.pos.toClientCoordinates(_e(e.viewDomNode)),g=n.getBoundingClientRect(),f=g.left<=h.clientX&&h.clientX<=g.right,v=null;for(let y=1;y<c.length;y++){let I=c[y-1],S=c[y];if(I.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=S.offset){v=new _(s,I.column,s,S.column);let x=Math.abs(I.offset-t.mouseContentHorizontalOffset),T=Math.abs(S.offset-t.mouseContentHorizontalOffset);i=x<T?new w(s,I.column):new w(s,S.column);break}}return t.fulfillContentText(i,v,{mightBeForeignElement:!f||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(e,t){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n),o=i+e.lineHeight;if(!(n===e.viewModel.getLineCount()&&t.mouseVerticalOffset>o)){let a=Math.floor((i+o)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new Cs(t.pos.x,l),u=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(_e(e.viewDomNode)));if(u.type===1)return u}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(_e(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let n=Is(e.viewDomNode),i;if(n?typeof n.caretRangeFromPoint>"u"?i=XN(n,t.clientX,t.clientY):i=n.caretRangeFromPoint(t.clientX,t.clientY):i=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new eo;let o=i.startContainer;if(o.nodeType===o.TEXT_NODE){let s=o.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===yr.CLASS_NAME?Ud.createFromDOMInfo(e,s,i.startOffset):new eo(o.parentNode)}else if(o.nodeType===o.ELEMENT_NODE){let s=o.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===yr.CLASS_NAME?Ud.createFromDOMInfo(e,o,o.textContent.length):new eo(o)}return new eo}static _doHitTestWithCaretPositionFromPoint(e,t){let n=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){let i=n.offsetNode.parentNode,o=i?i.parentNode:null,s=o?o.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===yr.CLASS_NAME?Ud.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new eo(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){let i=n.offsetNode.parentNode,o=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,s=i?i.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(o===yr.CLASS_NAME){let l=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(l)return Ud.createFromDOMInfo(e,l,0)}else if(a===yr.CLASS_NAME)return Ud.createFromDOMInfo(e,n.offsetNode,0)}return new eo(n.offsetNode)}static _snapToSoftTabBoundary(e,t){let n=t.getLineContent(e.lineNumber),{tabSize:i}=t.model.getOptions(),o=Ba.atomicPosition(n,e.column-1,i,2);return o!==-1?new w(e.lineNumber,o+1):e}static doHitTest(e,t){let n=new eo;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?n=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(_e(e.viewDomNode)))),n.type===1){let i=e.viewModel.getInjectedTextAt(n.position),o=e.viewModel.normalizePosition(n.position,2);(i||!o.equals(n.position))&&(n=new Jf(o,n.spanNode,i))}return n}};function XN(r,e,t){let n=document.createRange(),i=r.elementFromPoint(e,t);if(i!==null){for(;i&&i.firstChild&&i.firstChild.nodeType!==i.firstChild.TEXT_NODE&&i.lastChild&&i.lastChild.firstChild;)i=i.lastChild;let o=i.getBoundingClientRect(),s=_e(i),a=s.getComputedStyle(i,null).getPropertyValue("font-style"),l=s.getComputedStyle(i,null).getPropertyValue("font-variant"),d=s.getComputedStyle(i,null).getPropertyValue("font-weight"),u=s.getComputedStyle(i,null).getPropertyValue("font-size"),c=s.getComputedStyle(i,null).getPropertyValue("line-height"),p=s.getComputedStyle(i,null).getPropertyValue("font-family"),h=`${a} ${l} ${d} ${u}/${c} ${p}`,g=i.innerText,f=o.left,v=0,y;if(e>o.left+o.width)v=g.length;else{let I=ox.getInstance();for(let S=0;S<g.length+1;S++){if(y=I.getCharWidth(g.charAt(S),h)/2,f+=y,e<f){v=S;break}f+=y}}n.setStart(i.firstChild,v),n.setEnd(i.firstChild,v)}return n}var ox=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let n=e+t;if(this._cache[n])return this._cache[n];let i=this._canvas.getContext("2d");i.font=t;let s=i.measureText(e).width;return this._cache[n]=s,s}};var hk=2e4,JN;var ax,mk;function fk(r){JN&&(ax.textContent!==r?(hf(mk),gk(ax,r)):(hf(ax),gk(mk,r)))}function gk(r,e){hf(r),e.length>hk&&(e=e.substr(0,hk)),r.textContent=e,r.style.visibility="hidden",r.style.visibility="visible"}var Ss=class r{static columnSelect(e,t,n,i,o,s){let a=Math.abs(o-n)+1,l=n>o,d=i>s,u=i<s,c=[];for(let p=0;p<a;p++){let h=n+(l?-p:p),g=e.columnFromVisibleColumn(t,h,i),f=e.columnFromVisibleColumn(t,h,s),v=e.visibleColumnFromColumn(t,new w(h,g)),y=e.visibleColumnFromColumn(t,new w(h,f));u&&(v>s||y<i)||d&&(y>i||v<s)||c.push(new Tt(new _(h,g,h,g),0,0,new w(h,f),0))}if(c.length===0)for(let p=0;p<a;p++){let h=n+(l?-p:p),g=t.getLineMaxColumn(h);c.push(new Tt(new _(h,g,h,g),0,0,new w(h,g),0))}return{viewStates:c,reversed:l,fromLineNumber:n,fromVisualColumn:i,toLineNumber:o,toVisualColumn:s}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,r.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0,o=Math.min(n.fromViewLineNumber,n.toViewLineNumber),s=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let l=o;l<=s;l++){let d=t.getLineMaxColumn(l),u=e.visibleColumnFromColumn(t,new w(l,d));i=Math.max(i,u)}let a=n.toViewVisualColumn;return a<i&&a++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,a)}static columnSelectUp(e,t,n,i){let o=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-o);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){let o=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+o);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}};var tn=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return ye.fromPositions(i.getEndPosition())}};var Ua=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return ye.fromPositions(i.getStartPosition())}},Ha=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,n,i,o=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=o}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return ye.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},nb=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var Cp=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,n){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}},ct=class r{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-Oy(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let n=t.lineNumber-1;return new w(n,e.getLineMaxColumn(n))}else return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let i=e.getLineMinColumn(t.lineNumber),o=e.getLineContent(t.lineNumber),s=Ba.atomicPosition(o,t.column-1,n,0);if(s!==-1&&s+1>=i)return new w(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,n){let i=e.stickyTabStops?r.leftPositionAtomicSoftTabs(t,n,e.tabSize):r.leftPosition(t,n);return new Cp(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,o){let s,a;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,a=n.selection.startColumn;else{let l=n.position.delta(void 0,-(o-1)),d=t.normalizePosition(r.clipPositionColumn(l,t),0),u=r.left(e,t,d);s=u.lineNumber,a=u.column}return n.move(i,s,a,0)}static clipPositionColumn(e,t){return new w(e.lineNumber,r.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n=n+Au(e.getLineContent(t),n-1):t<e.getLineCount()&&(t=t+1,n=e.getLineMinColumn(t)),new w(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,o){if(n<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=Ba.atomicPosition(s,n-1,i,1);if(a!==-1)return new w(t,a+1)}return this.rightPosition(e,t,n)}static right(e,t,n){let i=e.stickyTabStops?r.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):r.rightPosition(t,n.lineNumber,n.column);return new Cp(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,o){let s,a;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,a=n.selection.endColumn;else{let l=n.position.delta(void 0,o-1),d=t.normalizePosition(r.clipPositionColumn(l,t),1),u=r.right(e,t,d);s=u.lineNumber,a=u.column}return n.move(i,s,a,0)}static vertical(e,t,n,i,o,s,a,l){let d=Ye.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+o,u=t.getLineCount(),c=n===1&&i===1,p=n===u&&i===t.getLineMaxColumn(n),h=s<n?c:p;if(n=s,n<1?(n=1,a?i=t.getLineMinColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):n>u?(n=u,a?i=t.getLineMaxColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):i=e.columnFromVisibleColumn(t,n,d),h?o=0:o=d-Ye.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),l!==void 0){let g=new w(n,i),f=t.normalizePosition(g,l);o=o+(i-f.column),n=f.lineNumber,i=f.column}return new Cp(n,i,o)}static down(e,t,n,i,o,s,a){return this.vertical(e,t,n,i,o,n+s,a,4)}static moveDown(e,t,n,i,o){let s,a;n.hasSelection()&&!i?(s=n.selection.endLineNumber,a=n.selection.endColumn):(s=n.position.lineNumber,a=n.position.column);let l=0,d;do if(d=r.down(e,t,s+l,a,n.leftoverVisibleColumns,o,!0),t.normalizePosition(new w(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return n.move(i,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,o=r.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=r.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Tt(new _(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new w(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,n,i,o,s,a){return this.vertical(e,t,n,i,o,n-s,a,3)}static moveUp(e,t,n,i,o){let s,a;n.hasSelection()&&!i?(s=n.selection.startLineNumber,a=n.selection.startColumn):(s=n.position.lineNumber,a=n.position.column);let l=r.up(e,t,s,a,n.leftoverVisibleColumns,o,!0);return n.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,o=r.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=r.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new Tt(new _(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new w(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,n,i){let o=n.position.lineNumber;for(;o>1&&this._isBlankLine(t,o);)o--;for(;o>1&&!this._isBlankLine(t,o);)o--;return n.move(i,o,t.getLineMinColumn(o),0)}static moveToNextBlankLine(e,t,n,i){let o=t.getLineCount(),s=n.position.lineNumber;for(;s<o&&this._isBlankLine(t,s);)s++;for(;s<o&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let o=n.position.lineNumber,s=t.getLineMinColumn(o),a=t.getLineFirstNonWhitespaceColumn(o)||s,l;return n.position.column===a?l=s:l=a,n.move(i,o,l,0)}static moveToEndOfLine(e,t,n,i,o){let s=n.position.lineNumber,a=t.getLineMaxColumn(s);return n.move(i,s,a,o?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let o=t.getLineCount(),s=t.getLineMaxColumn(o);return n.move(i,o,s,0)}};var Oo=class r{static deleteRight(e,t,n,i){let o=[],s=e!==3;for(let a=0,l=i.length;a<l;a++){let d=i[a],u=d;if(u.isEmpty()){let c=d.getPosition(),p=ct.right(t,n,c);u=new _(p.lineNumber,p.column,c.lineNumber,c.column)}if(u.isEmpty()){o[a]=null;continue}u.startLineNumber!==u.endLineNumber&&(s=!0),o[a]=new tn(u,"")}return[s,o]}static isAutoClosingPairDelete(e,t,n,i,o,s,a){if(t==="never"&&n==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let u=s[l],c=u.getPosition();if(!u.isEmpty())return!1;let p=o.getLineContent(c.lineNumber);if(c.column<2||c.column>=p.length+1)return!1;let h=p.charAt(c.column-2),g=i.get(h);if(!g)return!1;if(br(h)){if(n==="never")return!1}else if(t==="never")return!1;let f=p.charAt(c.column-1),v=!1;for(let y of g)y.open===h&&y.close===f&&(v=!0);if(!v)return!1;if(e==="auto"){let y=!1;for(let I=0,S=a.length;I<S;I++){let x=a[I];if(c.lineNumber===x.startLineNumber&&c.column===x.startColumn){y=!0;break}}if(!y)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let o=0,s=n.length;o<s;o++){let a=n[o].getPosition(),l=new _(a.lineNumber,a.column-1,a.lineNumber,a.column+1);i[o]=new tn(l,"")}return[!0,i]}static deleteLeft(e,t,n,i,o){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,o))return this._runAutoClosingPairDelete(t,n,i);let s=[],a=e!==2;for(let l=0,d=i.length;l<d;l++){let u=r.getDeleteRange(i[l],n,t);if(u.isEmpty()){s[l]=null;continue}u.startLineNumber!==u.endLineNumber&&(a=!0),s[l]=new tn(u,"")}return[a,s]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;let i=e.getPosition();if(n.useTabStops&&i.column>1){let o=t.getLineContent(i.lineNumber),s=gt(o),a=s===-1?o.length+1:s+1;if(i.column<=a){let l=n.visibleColumnFromColumn(t,i),d=Ye.prevIndentTabStop(l,n.indentSize),u=n.columnFromVisibleColumn(t,i.lineNumber,d);return new _(i.lineNumber,u,i.lineNumber,i.column)}}return _.fromPositions(r.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let n=Hw(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}else if(e.lineNumber>1){let n=e.lineNumber-1;return new w(n,t.getLineMaxColumn(n))}else return e}static cut(e,t,n){let i=[],o=null;n.sort((s,a)=>w.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=n.length;s<a;s++){let l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),u,c,p,h;d.lineNumber<t.getLineCount()?(u=d.lineNumber,c=1,p=d.lineNumber+1,h=1):d.lineNumber>1&&o?.endLineNumber!==d.lineNumber?(u=d.lineNumber-1,c=t.getLineMaxColumn(d.lineNumber-1),p=d.lineNumber,h=t.getLineMaxColumn(d.lineNumber)):(u=d.lineNumber,c=1,p=d.lineNumber,h=t.getLineMaxColumn(d.lineNumber));let g=new _(u,c,p,h);o=g,g.isEmpty()?i[s]=null:i[s]=new tn(g,"")}else i[s]=null;else i[s]=new tn(l,"")}return new Rt(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var Kd=class r{static _createWord(e,t,n,i,o){return{start:i,end:o,wordType:t,nextCharClass:n}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0,o=t.findPrevIntlWordBeforeOrAtOffset(e,n.column-2);for(let s=n.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(o&&s===o.index)return this._createIntlWord(o,l);if(l===0){if(i===2)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=1}else if(l===2){if(i===1)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=2}else if(l===1&&i!==0)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1))}return i!==0?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let o=t.findNextIntlWordAtOrAfterOffset(e,i),s=e.length;for(let a=i;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(o&&a===o.index+o.segment.length||d===1||n===1&&d===2||n===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,o=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,n.column-1);for(let a=n.column-1;a<o;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(i===2)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=1}else if(d===2){if(i===1)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=2}else if(d===1&&i!==0)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a)}return i!==0?this._createWord(e,i,1,this._findStartOfWord(e,t,i,o-1),o):null}static _findStartOfWord(e,t,n,i){let o=t.findPrevIntlWordBeforeOrAtOffset(e,i);for(let s=i;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(o&&s===o.index)return s;if(l===1||n===1&&l===2||n===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,n,i,o){let s=n.lineNumber,a=n.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=r._findPreviousWordOnLine(e,t,new w(s,a));if(i===0)return new w(s,l?l.start+1:1);if(i===1)return!o&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findPreviousWordOnLine(e,t,new w(s,l.start+1))),new w(s,l?l.start+1:1);if(i===3){for(;l&&l.wordType===2;)l=r._findPreviousWordOnLine(e,t,new w(s,l.start+1));return new w(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=r._findPreviousWordOnLine(e,t,new w(s,l.start+1))),new w(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===1)return n>1?new w(n-1,e.getLineMaxColumn(n-1)):t;let o=e.getLineContent(n);for(let s=t.column-1;s>1;s--){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a===95&&l!==95)return new w(n,s);if(a===45&&l!==45)return new w(n,s);if((Hs(a)||Mu(a))&&Rr(l))return new w(n,s);if(Rr(a)&&Rr(l)&&s+1<i){let d=o.charCodeAt(s);if(Hs(d)||Mu(d))return new w(n,s)}}return new w(n,1)}static moveWordRight(e,t,n,i){let o=n.lineNumber,s=n.column,a=!1;s===t.getLineMaxColumn(o)&&o<t.getLineCount()&&(a=!0,o=o+1,s=1);let l=r._findNextWordOnLine(e,t,new w(o,s));if(i===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findNextWordOnLine(e,t,new w(o,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(o);else if(i===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=r._findNextWordOnLine(e,t,new w(o,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(o)}else l&&!a&&s>=l.start+1&&(l=r._findNextWordOnLine(e,t,new w(o,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(o);return new w(o,s)}static _moveWordPartRight(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new w(n+1,1):t;let o=e.getLineContent(n);for(let s=t.column+1;s<i;s++){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a!==95&&l===95)return new w(n,s);if(a!==45&&l===45)return new w(n,s);if((Hs(a)||Mu(a))&&Rr(l))return new w(n,s);if(Rr(a)&&Rr(l)&&s+1<i){let d=o.charCodeAt(s);if(Hs(d)||Mu(d))return new w(n,s)}}return new w(n,i)}static _deleteWordLeftWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-2,o=yi(n,i);return o+1<i?new _(t.lineNumber,o+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let n=e.wordSeparators,i=e.model,o=e.selection,s=e.whitespaceHeuristics;if(!o.isEmpty())return o;if(Oo.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let c=e.selection.getPosition();return new _(c.lineNumber,c.column-1,c.lineNumber,c.column+1)}let a=new w(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let c=this._deleteWordLeftWhitespace(i,a);if(c)return c}let u=r._findPreviousWordOnLine(n,i,a);return t===0?u?d=u.start+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l)):(u&&d<=u.end+1&&(u=r._findPreviousWordOnLine(n,i,new w(l,u.start+1))),u?d=u.end+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l))),new _(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;let i=new w(n.positionLineNumber,n.positionColumn),o=this._deleteInsideWordWhitespace(t,i);return o||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){let n=e.charCodeAt(t);return n===32||n===9}static _deleteInsideWordWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=n.length;if(i===0)return null;let o=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,o))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;o>0&&this._charAtIsWhitespace(n,o-1);)o--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new _(t.lineNumber,o+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){let i=t.getLineContent(n.lineNumber),o=i.length;if(o===0)return n.lineNumber>1?new _(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new _(n.lineNumber,1,n.lineNumber+1,1):new _(n.lineNumber,1,n.lineNumber,1);let s=c=>c.start+1<=n.column&&n.column<=c.end+1,a=(c,p)=>(c=Math.min(c,n.column),p=Math.max(p,n.column),new _(n.lineNumber,c,n.lineNumber,p)),l=c=>{let p=c.start+1,h=c.end+1,g=!1;for(;h-1<o&&this._charAtIsWhitespace(i,h-1);)g=!0,h++;if(!g)for(;p>1&&this._charAtIsWhitespace(i,p-2);)p--;return a(p,h)},d=r._findPreviousWordOnLine(e,t,n);if(d&&s(d))return l(d);let u=r._findNextWordOnLine(e,t,n);return u&&s(u)?l(u):d&&u?a(d.end+1,u.start+1):d?a(d.start+1,d.end+1):u?a(u.start+1,u.end+1):a(1,o+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=r._moveWordPartLeft(e,n);return new _(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let o=e.charAt(i);if(o!==" "&&o!=="	")return i}return n}static _deleteWordRightWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-1,o=this._findFirstNonWhitespaceChar(n,i);return i+1<o?new _(t.lineNumber,t.column,t.lineNumber,o+1):null}static deleteWordRight(e,t){let n=e.wordSeparators,i=e.model,o=e.selection,s=e.whitespaceHeuristics;if(!o.isEmpty())return o;let a=new w(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column,u=i.getLineCount(),c=i.getLineMaxColumn(l);if(l===u&&d===c)return null;if(s){let h=this._deleteWordRightWhitespace(i,a);if(h)return h}let p=r._findNextWordOnLine(n,i,a);return t===2?p?d=p.end+1:d<c||l===u?d=c:(l++,p=r._findNextWordOnLine(n,i,new w(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l)):(p&&d>=p.start+1&&(p=r._findNextWordOnLine(n,i,new w(l,p.end+1))),p?d=p.start+1:d<c||l===u?d=c:(l++,p=r._findNextWordOnLine(n,i,new w(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l))),new _(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=r._moveWordPartRight(e,n);return new _(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){let i=new _(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n,i){let o=Wr(t,n),s=r._findPreviousWordOnLine(o,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return r._createWordAtPosition(e,i.lineNumber,s);let a=r._findNextWordOnLine(o,e,i);return a&&a.wordType===1&&a.start<=i.column-1&&i.column-1<=a.end?r._createWordAtPosition(e,i.lineNumber,a):null}static word(e,t,n,i,o){let s=Wr(e.wordSeparators,e.wordSegmenterLocales),a=r._findPreviousWordOnLine(s,t,o),l=r._findNextWordOnLine(s,t,o);if(!i){let h,g;return a&&a.wordType===1&&a.start<=o.column-1&&o.column-1<=a.end?(h=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=o.column-1&&o.column-1<=l.end?(h=l.start+1,g=l.end+1):(a?h=a.end+1:h=1,l?g=l.start+1:g=t.getLineMaxColumn(o.lineNumber)),new Tt(new _(o.lineNumber,h,o.lineNumber,g),1,0,new w(o.lineNumber,g),0)}let d,u;a&&a.wordType===1&&a.start<o.column-1&&o.column-1<a.end?(d=a.start+1,u=a.end+1):l&&l.wordType===1&&l.start<o.column-1&&o.column-1<l.end?(d=l.start+1,u=l.end+1):(d=o.column,u=o.column);let c=o.lineNumber,p;if(n.selectionStart.containsPosition(o))p=n.selectionStart.endColumn;else if(o.isBeforeOrEqual(n.selectionStart.getStartPosition())){p=d;let h=new w(c,p);n.selectionStart.containsPosition(h)&&(p=n.selectionStart.endColumn)}else{p=u;let h=new w(c,p);n.selectionStart.containsPosition(h)&&(p=n.selectionStart.startColumn)}return n.move(!0,c,p,0)}};var Ut=class{static addCursorDown(e,t,n){let i=[],o=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[o++]=new Ie(l.modelState,l.viewState),n?i[o++]=Ie.fromModelState(ct.translateDown(e.cursorConfig,e.model,l.modelState)):i[o++]=Ie.fromViewState(ct.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],o=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[o++]=new Ie(l.modelState,l.viewState),n?i[o++]=Ie.fromModelState(ct.translateUp(e.cursorConfig,e.model,l.modelState)):i[o++]=Ie.fromViewState(ct.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];i[o]=this._moveToLineStart(e,a,n)}return i}static _moveToLineStart(e,t,n){let i=t.viewState.position.column,o=t.modelState.position.column,s=i===o,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(i===l)?this._moveToLineStartByView(e,t,n):this._moveToLineStartByModel(e,t,n)}static _moveToLineStartByView(e,t,n){return Ie.fromViewState(ct.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return Ie.fromModelState(ct.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=this._moveToLineEnd(e,l,n,i)}return o}static _moveToLineEnd(e,t,n,i){let o=t.viewState.position,s=e.getLineMaxColumn(o.lineNumber),a=o.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),u=s-o.column===d-l.column;return a||u?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return Ie.fromViewState(ct.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return Ie.fromModelState(ct.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,o=t.length;i<o;i++){let s=t[i],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,u;d===l?u=e.model.getLineMaxColumn(l):(d++,u=1),n[i]=Ie.fromModelState(new Tt(new _(a,1,a,1),0,0,new w(d,u),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];i[o]=Ie.fromModelState(ct.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];i[o]=Ie.fromModelState(ct.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){let n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return Ie.fromModelState(new Tt(new _(1,1,1,1),0,0,new w(n,i),0))}static line(e,t,n,i,o){let s=e.model.validatePosition(i),a=o?e.coordinatesConverter.validateViewPosition(new w(o.lineNumber,o.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!n){let d=e.model.getLineCount(),u=s.lineNumber+1,c=1;return u>d&&(u=d,c=e.model.getLineMaxColumn(u)),Ie.fromModelState(new Tt(new _(s.lineNumber,1,u,c),2,0,new w(u,c),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Ie.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),u=a.lineNumber+1,c=1;return u>d&&(u=d,c=e.getLineMaxColumn(u)),Ie.fromViewState(t.viewState.move(!0,u,c,0))}else{let d=t.modelState.selectionStart.getEndPosition();return Ie.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,n,i){let o=e.model.validatePosition(i);return Ie.fromModelState(Kd.word(e.cursorConfig,e.model,t.modelState,n,o))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new Ie(t.modelState,t.viewState);let n=t.viewState.position.lineNumber,i=t.viewState.position.column;return Ie.fromViewState(new Tt(new _(n,i,n,i),0,0,new w(n,i),0))}static moveTo(e,t,n,i,o){if(n){if(t.modelState.selectionStartKind===1)return this.word(e,t,n,i);if(t.modelState.selectionStartKind===2)return this.line(e,t,n,i,o)}let s=e.model.validatePosition(i),a=o?e.coordinatesConverter.validateViewPosition(new w(o.lineNumber,o.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return Ie.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,o,s){switch(n){case he.Direction.Left:return s===he.Unit.HalfLine?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,o);case he.Direction.Right:return s===he.Unit.HalfLine?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,o);case he.Direction.Up:return s===he.Unit.WrappedLine?this._moveUpByViewLines(e,t,i,o):this._moveUpByModelLines(e,t,i,o);case he.Direction.Down:return s===he.Unit.WrappedLine?this._moveDownByViewLines(e,t,i,o):this._moveDownByModelLines(e,t,i,o);case he.Direction.PrevBlankLine:return s===he.Unit.WrappedLine?t.map(a=>Ie.fromViewState(ct.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ie.fromModelState(ct.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,i)));case he.Direction.NextBlankLine:return s===he.Unit.WrappedLine?t.map(a=>Ie.fromViewState(ct.moveToNextBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ie.fromModelState(ct.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,i)));case he.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,i);case he.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case he.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,i);case he.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,i);case he.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,o){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case he.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,o),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case he.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,o),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case he.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case he.Direction.ViewPortIfOutside:{let l=[];for(let d=0,u=t.length;d<u;d++){let c=t[d];l[d]=this.findPositionInViewportIfOutside(e,c,s,i)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let o=t.viewState.position.lineNumber;if(n.startLineNumber<=o&&o<=n.endLineNumber-1)return new Ie(t.modelState,t.viewState);{let s;o>n.endLineNumber-1?s=n.endLineNumber-1:o<n.startLineNumber?s=n.startLineNumber:s=o;let a=ct.vertical(e.cursorConfig,e,o,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return Ie.fromViewState(t.viewState.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(o=>Ie.fromViewState(ct.moveLeft(e.cursorConfig,e,o.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[o]=Ie.fromViewState(ct.moveLeft(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveRight(e,t,n,i){return t.map(o=>Ie.fromViewState(ct.moveRight(e.cursorConfig,e,o.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[o]=Ie.fromViewState(ct.moveRight(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveDownByViewLines(e,t,n,i){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=Ie.fromViewState(ct.moveDown(e.cursorConfig,e,l.viewState,n,i))}return o}static _moveDownByModelLines(e,t,n,i){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=Ie.fromModelState(ct.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return o}static _moveUpByViewLines(e,t,n,i){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=Ie.fromViewState(ct.moveUp(e.cursorConfig,e,l.viewState,n,i))}return o}static _moveUpByModelLines(e,t,n,i){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=Ie.fromModelState(ct.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return o}static _moveToViewPosition(e,t,n,i,o){return Ie.fromViewState(t.viewState.move(n,i,o,0))}static _moveToModelPosition(e,t,n,i,o){return Ie.fromModelState(t.modelState.move(n,i,o,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);i[o]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);i[o]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);i[o]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);i[o]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);i[o]=this._moveToViewPosition(e,a,n,l,d)}return i}},he;(a=>{let r=function(l){if(!Ot(l))return!1;let d=l;return!(!Ct(d.to)||!On(d.select)&&!gh(d.select)||!On(d.by)&&!Ct(d.by)||!On(d.value)&&!lo(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function i(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let u=0;switch(l.by){case a.RawUnit.Line:u=1;break;case a.RawUnit.WrappedLine:u=2;break;case a.RawUnit.Character:u=3;break;case a.RawUnit.HalfLine:u=4;break}return{direction:d,unit:u,select:!!l.select,value:l.value||1}}a.parse=i;let o;(P=>(P[P.Left=0]="Left",P[P.Right=1]="Right",P[P.Up=2]="Up",P[P.Down=3]="Down",P[P.PrevBlankLine=4]="PrevBlankLine",P[P.NextBlankLine=5]="NextBlankLine",P[P.WrappedLineStart=6]="WrappedLineStart",P[P.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",P[P.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",P[P.WrappedLineEnd=9]="WrappedLineEnd",P[P.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",P[P.ViewPortTop=11]="ViewPortTop",P[P.ViewPortCenter=12]="ViewPortCenter",P[P.ViewPortBottom=13]="ViewPortBottom",P[P.ViewPortIfOutside=14]="ViewPortIfOutside"))(o=a.Direction||={});let s;(h=>(h[h.None=0]="None",h[h.Line=1]="Line",h[h.WrappedLine=2]="WrappedLine",h[h.Character=3]="Character",h[h.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(he||={});function eA(r,e,t){let n=r.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let i,o=-1;for(i=e-1;i>=1;i--){if(r.tokenization.getLanguageIdAtPosition(i,0)!==n)return o;let s=r.getLineContent(i);if(t.shouldIgnore(i)||/^\s+$/.test(s)||s===""){o=i;continue}return i}}return-1}function Sp(r,e,t,n=!0,i){if(r<4)return null;let o=i.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!o)return null;let s=new rb(e,o,i);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=eA(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:At(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:At(l),action:null,line:a}}else{if(a===1)return{indentation:At(e.getLineContent(a)),action:null,line:a};let l=a-1,d=o.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let u=0;for(let c=l-1;c>0;c--)if(!s.shouldIndentNextLine(c)){u=c;break}return{indentation:At(e.getLineContent(u+1)),action:null,line:u+1}}if(n)return{indentation:At(e.getLineContent(a)),action:null,line:a};for(let u=a;u>0;u--){if(s.shouldIncrease(u))return{indentation:At(e.getLineContent(u)),action:1,line:u};if(s.shouldIndentNextLine(u)){let c=0;for(let p=u-1;p>0;p--)if(!s.shouldIndentNextLine(u)){c=p;break}return{indentation:At(e.getLineContent(c+1)),action:null,line:c+1}}else if(s.shouldDecrease(u))return{indentation:At(e.getLineContent(u)),action:null,line:u}}return{indentation:At(e.getLineContent(1)),action:null,line:1}}}function vk(r,e,t,n,i){if(r<4)return null;let o=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(o).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new za(e,i).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,u=l.beforeRangeProcessedTokens,c=At(u.getLineContent()),p=tA(e,t.startLineNumber,u),h=ob(e,t.getStartPosition()),g=e.getLineContent(t.startLineNumber),f=At(g),v=Sp(r,p,t.startLineNumber+1,void 0,i);if(!v){let I=h?f:c;return{beforeEnter:I,afterEnter:I}}let y=h?f:v.indentation;return v.action===1&&(y=n.shiftIndent(y)),s.shouldDecrease(d.getLineContent())&&(y=n.unshiftIndent(y)),{beforeEnter:h?f:c,afterEnter:y}}function yk(r,e,t,n,i,o){let s=r.autoIndent;if(s<4||ob(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=o.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let c=new za(e,o).getProcessedTokenContextAroundRange(t),p=c.beforeRangeProcessedTokens.getLineContent(),h=c.afterRangeProcessedTokens.getLineContent(),g=p+h,f=p+n+h;if(!d.shouldDecrease(g)&&d.shouldDecrease(f)){let y=Sp(s,e,t.startLineNumber,!1,o);if(!y)return null;let I=y.indentation;return y.action!==1&&(I=i.unshiftIndent(I)),I}let v=t.startLineNumber-1;if(v>0){let y=e.getLineContent(v);if(d.shouldIndentNextLine(y)&&d.shouldIncrease(f)){let S=Sp(s,e,t.startLineNumber,!1,o)?.indentation;if(S!==void 0){let x=e.getLineContent(t.startLineNumber),T=At(x),P=i.shiftIndent(S)===T,O=/^\s*$/.test(g),k=r.autoClosingPairs.autoClosingPairsOpenByEnd.get(n),W=k&&k.length>0&&O;if(P&&W)return S}}}return null}function tA(r,e,t){return{tokenization:{getLineTokens:i=>i===e?t:r.tokenization.getLineTokens(i),getLanguageId:()=>r.getLanguageId(),getLanguageIdAtPosition:(i,o)=>r.getLanguageIdAtPosition(i,o)},getLineContent:i=>i===e?t.getLineContent():r.getLineContent(i)}}var rb=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,n){this._indentRulesSupport=t,this._indentationLineProcessor=new sb(e,n)}shouldIncrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(n)}shouldDecrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(n)}shouldIgnore(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(n)}shouldIndentNextLine(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(n)}},za=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new sb(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),n=this._getProcessedTokensAfterRange(e),i=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:n,previousLineProcessedTokens:i}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),n=Ur(t,e.startColumn-1),i;if(ob(this.model,e.getStartPosition())){let s=e.startColumn-1-n.firstCharOffset,a=n.firstCharOffset,l=a+s;i=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;i=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(i)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let n=this.model.tokenization.getLineTokens(t.lineNumber),i=Ur(n,t.column-1),o=t.column-1-i.firstCharOffset,s=i.firstCharOffset+o,a=i.firstCharOffset+i.getLineLength(),l=n.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=h=>{this.model.tokenization.forceTokenization(h);let g=this.model.tokenization.getLineTokens(h),f=this.model.getLineMaxColumn(h)-1;return Ur(g,f)};this.model.tokenization.forceTokenization(e.startLineNumber);let n=this.model.tokenization.getLineTokens(e.startLineNumber),i=Ur(n,e.startColumn-1),o=_t.createEmpty("",i.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(i.firstCharOffset===0))return o;let d=t(s);if(!(i.languageId===d.languageId))return o;let c=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(c)}},sb=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let n=(s,a)=>{let l=At(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let i=this.model.tokenization.getLineTokens(e),o=this.getProcessedTokens(i).getLineContent();return t!==void 0&&(o=n(o,t)),o}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,n=e.getLanguageId(0),o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),u=e.getTokenText(l);t(d)&&(u=u.replace(o,""));let c=e.getMetadata(l);s.push({text:u,metadata:c})}),_t.createFromTextAndMetadata(s,e.languageIdCodec)}};function ob(r,e){r.tokenization.forceTokenization(e.lineNumber);let t=r.tokenization.getLineTokens(e.lineNumber),n=Ur(t,e.column-1),i=n.firstCharOffset===0,o=t.getLanguageId(0)===n.languageId;return!i&&!o}function _p(r,e,t,n){e.tokenization.forceTokenization(t.startLineNumber);let i=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),o=n.getLanguageConfiguration(i);if(!o)return null;let a=new za(e,n).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),u=a.afterRangeProcessedTokens.getLineContent(),c=o.onEnter(r,l,d,u);if(!c)return null;let p=c.indentAction,h=c.appendText,g=c.removeText||0;h?p===1&&(h="	"+h):p===1||p===2?h="	":h="";let f=$m(e,t.startLineNumber,t.startColumn);return g&&(f=f.substring(0,f.length-g)),{indentAction:p,appendText:h,removeText:g,indentation:f}}var lx=Object.create(null);function Ka(r,e){if(e<=0)return"";lx[r]||(lx[r]=["",r]);let t=lx[r];for(let n=t.length;n<=e;n++)t[n]=t[n-1]+r;return t[e]}var mi=class{constructor(e,t,n){this._languageConfigurationService=n;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,o){let s=Ye.visibleColumnFromColumn(e,t,n);if(o){let a=Ka(" ",i),d=Ye.prevIndentTabStop(s,i)/i;return Ka(a,d)}else{let a="	",d=Ye.prevRenderTabStop(s,n)/n;return Ka(a,d)}}static shiftIndent(e,t,n,i,o){let s=Ye.visibleColumnFromColumn(e,t,n);if(o){let a=Ka(" ",i),d=Ye.nextIndentTabStop(s,i)/i;return Ka(a,d)}else{let a="	",d=Ye.nextRenderTabStop(s,n)/n;return Ka(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){let n=this._selection.startLineNumber,i=this._selection.endLineNumber;this._selection.endColumn===1&&n!==i&&(i=i-1);let{tabSize:o,indentSize:s,insertSpaces:a}=this._opts,l=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,u=0;for(let c=n;c<=i;c++,d=u){u=0;let p=e.getLineContent(c),h=gt(p);if(this._opts.isUnshift&&(p.length===0||h===0)||!l&&!this._opts.isUnshift&&p.length===0)continue;if(h===-1&&(h=p.length),c>1&&Ye.visibleColumnFromColumn(p,h+1,o)%s!==0&&e.tokenization.isCheapToTokenize(c-1)){let v=_p(this._opts.autoIndent,e,new _(c-1,e.getLineMaxColumn(c-1),c-1,e.getLineMaxColumn(c-1)),this._languageConfigurationService);if(v){if(u=d,v.appendText)for(let y=0,I=v.appendText.length;y<I&&u<s&&v.appendText.charCodeAt(y)===32;y++)u++;v.removeText&&(u=Math.max(0,u-v.removeText));for(let y=0;y<u&&!(h===0||p.charCodeAt(h-1)!==32);y++)h--}}if(this._opts.isUnshift&&h===0)continue;let g;this._opts.isUnshift?g=mi.unshiftIndent(p,h+1,o,s,a):g=mi.shiftIndent(p,h+1,o,s,a),this._addEditOperation(t,new _(c,1,c,h+1),g),c===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=h+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(n)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?Ka(" ",s):"	";for(let u=n;u<=i;u++){let c=e.getLineContent(u),p=gt(c);if(!(this._opts.isUnshift&&(c.length===0||p===0))&&!(!l&&!this._opts.isUnshift&&c.length===0)&&(p===-1&&(p=c.length),!(this._opts.isUnshift&&p===0)))if(this._opts.isUnshift){p=Math.min(p,s);for(let h=0;h<p;h++)if(c.charCodeAt(h)===9){p=h+1;break}this._addEditOperation(t,new _(u,1,u,p+1),"")}else this._addEditOperation(t,new _(u,1,u,1),d),u===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let i=t.getInverseEditOperations()[0];return new ye(i.range.endLineNumber,i.range.endColumn,i.range.endLineNumber,i.range.endColumn)}let n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let i=this._selection.startColumn;return n.startColumn<=i?n:n.getDirection()===0?new ye(n.startLineNumber,i,n.endLineNumber,n.endColumn):new ye(n.endLineNumber,n.endColumn,n.startLineNumber,i)}return n}};mi=ne([M(2,sr)],mi);var ab=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new _(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new _(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,o=n[1].range;return new ye(i.endLineNumber,i.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}},lb=class{constructor(e,t,n){this._position=e;this._text=t;this._charAfter=n}getEditOperations(e,t){t.addTrackedEditOperation(new _(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return new ye(i.endLineNumber,i.startColumn,i.endLineNumber,i.endColumn-this._charAfter.length)}};var db=class{static getEdits(e,t,n,i,o){if(!o&&this._isAutoIndentType(e,t,n)){let s=[];for(let l of n){let d=this._findActualIndentationForSelection(e,t,l,i);if(d===null)return;s.push({selection:l,indentation:d})}let a=Gd.getAutoClosingPairClose(e,t,n,i,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,i,a)}}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,o=n.length;i<o;i++)if(!t.tokenization.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,n,i){let o=yk(e,t,n,i,{shiftIndent:a=>xp(e,a),unshiftIndent:a=>$d(e,a)},e.languageConfigurationService);if(o===null)return null;let s=$m(t,n.startLineNumber,n.startColumn);return o===e.normalizeIndentation(s)?null:o}static _getIndentationAndAutoClosingPairEdits(e,t,n,i,o){let s=n.map(({selection:l,indentation:d})=>{if(o!==null){let u=this._getEditFromIndentationAndSelection(e,t,d,l,i,!1);return new ux(u,l,i,o)}else{let u=this._getEditFromIndentationAndSelection(e,t,d,l,i,!0);return Ga(u.range,u.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Rt(4,s,a)}static _getEditFromIndentationAndSelection(e,t,n,i,o,s=!0){let a=i.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(n);if(l!==0){let c=t.getLineContent(a);d+=c.substring(l-1,i.startColumn-1)}return d+=s?o:"",{range:new _(a,1,i.endLineNumber,i.endColumn),text:d}}},ub=class{static getEdits(e,t,n,i,o,s){if(Sk(t,n,i,o,s))return this._runAutoClosingOvertype(e,i,s)}static _runAutoClosingOvertype(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let l=t[o].getPosition(),d=new _(l.lineNumber,l.column,l.lineNumber,l.column+1);i[o]=new tn(d,n)}return new Rt(4,i,{shouldPushStackElementBefore:yb(e,4),shouldPushStackElementAfter:!1})}},cb=class{static getEdits(e,t,n,i,o){if(Sk(e,t,n,i,o)){let s=n.map(a=>new tn(new _(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Rt(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},Gd=class{static getEdits(e,t,n,i,o,s){if(!s){let a=this.getAutoClosingPairClose(e,t,n,i,o);if(a!==null)return this._runAutoClosingOpenCharType(n,i,o,a)}}static _runAutoClosingOpenCharType(e,t,n,i){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=new dx(l,t,!n,i)}return new Rt(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,n,i,o){for(let g of n)if(!g.isEmpty())return null;let s=n.map(g=>{let f=g.getPosition();return o?{lineNumber:f.lineNumber,beforeColumn:f.column-i.length,afterColumn:f.column}:{lineNumber:f.lineNumber,beforeColumn:f.column,afterColumn:f.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(g=>new w(g.lineNumber,g.beforeColumn)),i);if(!a)return null;let l,d;if(br(i)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let c=this._findContainedAutoClosingPair(e,a),p=c?c.close:"",h=!0;for(let g of s){let{lineNumber:f,beforeColumn:v,afterColumn:y}=g,I=t.getLineContent(f),S=I.substring(0,v-1),x=I.substring(y-1);if(x.startsWith(p)||(h=!1),x.length>0){let O=x.charAt(0);if(!this._isBeforeClosingBrace(e,x)&&!d(O))return null}if(a.open.length===1&&(i==="'"||i==='"')&&l!=="always"){let O=Wr(e.wordSeparators,[]);if(S.length>0){let k=S.charCodeAt(S.length-1);if(O.get(k)===0)return null}}if(!t.tokenization.isCheapToTokenize(f))return null;t.tokenization.forceTokenization(f);let T=t.tokenization.getLineTokens(f),R=Ur(T,v-1);if(!a.shouldAutoClose(R,v-R.firstCharOffset))return null;let P=a.findNeutralCharacter();if(P){let O=t.tokenization.getTokenTypeIfInsertingCharacter(f,v,P);if(!a.isOK(O))return null}}return h?a.close.substring(0,a.close.length-p.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[],o=null;for(let s of i)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!o||s.open.length>o.open.length)&&(o=s);return o}static _findAutoClosingPairOpen(e,t,n,i){let o=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!o)return null;let s=null;for(let a of o)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of n)if(t.getValueInRange(new _(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+i!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],o=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(l=>t.startsWith(l.open)),a=o.some(l=>t.startsWith(l.close));return!s&&a}},pb=class{static getEdits(e,t,n,i,o){if(!o&&this._isSurroundSelectionType(e,t,n,i))return this._runSurroundSelectionType(e,n,i)}static _runSurroundSelectionType(e,t,n){let i=[];for(let o=0,s=t.length;o<s;o++){let a=t[o],l=e.surroundingPairs[n];i[o]=new ab(a,n,l)}return new Rt(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,n,i){if(!px(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;let o=br(i);for(let s of n){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),u=l===s.startLineNumber?s.startColumn-1:0,c=l===s.endLineNumber?s.endColumn-1:d.length,p=d.substring(u,c);if(/[^ \t]/.test(p)){a=!1;break}}if(a)return!1;if(o&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(br(l))return!1}}return!0}},hb=class{static getEdits(e,t,n,i,o,s){if(!s&&this._isTypeInterceptorElectricChar(t,n,i)){let a=this._typeInterceptorElectricChar(e,t,n,i[0],o);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,n){return!!(n.length===1&&t.tokenization.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,o){if(!t.electricChars.hasOwnProperty(o)||!i.isEmpty())return null;let s=i.getPosition();n.tokenization.forceTokenization(s.lineNumber);let a=n.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(o,a,s.column)}catch(d){return Le(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+o).lastIndexOf(l.matchOpenBracket)+1,u=n.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(u){if(u.startLineNumber===s.lineNumber)return null;let c=n.getLineContent(u.startLineNumber),p=At(c),h=t.normalizeIndentation(p),g=n.getLineContent(s.lineNumber),f=n.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,v=g.substring(f-1,s.column-1),y=h+v+o,I=new _(s.lineNumber,1,s.lineNumber,s.column),S=new tn(I,y);return new Rt(cx(y,e),[S],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},mb=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new tn(t[s],n);let o=cx(n,e);return new Rt(o,i,{shouldPushStackElementBefore:yb(e,o),shouldPushStackElementAfter:!1})}},jd=class{static getEdits(e,t,n,i,o){if(!o&&i===`
`){let s=[];for(let a=0,l=n.length;a<l;a++)s[a]=this._enter(e,t,!1,n[a]);return new Rt(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,n,i){if(e.autoIndent===0)return Ga(i,`
`,n);if(!t.tokenization.isCheapToTokenize(i.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(i.startLineNumber),d=At(l).substring(0,i.startColumn-1);return Ga(i,`
`+e.normalizeIndentation(d),n)}let o=_p(e.autoIndent,t,i,e.languageConfigurationService);if(o){if(o.indentAction===0)return Ga(i,`
`+e.normalizeIndentation(o.indentation+o.appendText),n);if(o.indentAction===1)return Ga(i,`
`+e.normalizeIndentation(o.indentation+o.appendText),n);if(o.indentAction===2){let l=e.normalizeIndentation(o.indentation),d=e.normalizeIndentation(o.indentation+o.appendText),u=`
`+d+`
`+l;return n?new Ua(i,u,!0):new Ha(i,u,-1,d.length-l.length,!0)}else if(o.indentAction===3){let l=$d(e,o.indentation);return Ga(i,`
`+e.normalizeIndentation(l+o.appendText),n)}}let s=t.getLineContent(i.startLineNumber),a=At(s).substring(0,i.startColumn-1);if(e.autoIndent>=4){let l=vk(e.autoIndent,t,i,{unshiftIndent:d=>$d(e,d),shiftIndent:d=>xp(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,i.getEndPosition()),u=i.endColumn,c=t.getLineContent(i.endLineNumber),p=gt(c);if(p>=0?i=i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,p+1)):i=i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new Ua(i,`
`+e.normalizeIndentation(l.afterEnter),!0);{let h=0;return u<=p+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),h=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new Ha(i,`
`+e.normalizeIndentation(l.afterEnter),0,h,!0)}}}return Ga(i,`
`+e.normalizeIndentation(a),n)}static lineInsertBefore(e,t,n){if(t===null||n===null)return[];let i=[];for(let o=0,s=n.length;o<s;o++){let a=n[o].positionLineNumber;if(a===1)i[o]=new Ua(new _(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);i[o]=this._enter(e,t,!1,new _(a,l,a,l))}}return i}static lineInsertAfter(e,t,n){if(t===null||n===null)return[];let i=[];for(let o=0,s=n.length;o<s;o++){let a=n[o].positionLineNumber,l=t.getLineMaxColumn(a);i[o]=this._enter(e,t,!1,new _(a,l,a,l))}return i}static lineBreakInsert(e,t,n){let i=[];for(let o=0,s=n.length;o<s;o++)i[o]=this._enter(e,t,!0,n[o]);return i}},gb=class{static getEdits(e,t,n,i,o,s){let a=this._distributePasteToCursors(e,n,i,o,s);return a?(n=n.sort(_.compareRangesUsingStarts),this._distributedPaste(e,t,n,a)):this._simplePaste(e,t,n,i,o)}static _distributePasteToCursors(e,t,n,i,o){if(i||t.length===1)return null;if(o&&o.length===t.length)return o;if(e.multiCursorPaste==="spread"){n.charCodeAt(n.length-1)===10&&(n=n.substring(0,n.length-1)),n.charCodeAt(n.length-1)===13&&(n=n.substring(0,n.length-1));let s=Pu(n);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,n,i){let o=[];for(let s=0,a=n.length;s<a;s++)o[s]=new tn(n[s],i[s]);return new Rt(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,o){let s=[];for(let a=0,l=n.length;a<l;a++){let d=n[a],u=d.getPosition();if(o&&!d.isEmpty()&&(o=!1),o&&i.indexOf(`
`)!==i.length-1&&(o=!1),o){let c=new _(u.lineNumber,1,u.lineNumber,1);s[a]=new nb(c,i,d,!0)}else s[a]=new tn(d,i)}return new Rt(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},fb=class{static getEdits(e,t,n,i,o,s,a,l){let d=i.map(u=>this._compositionType(n,u,o,s,a,l));return new Rt(4,d,{shouldPushStackElementBefore:yb(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,o,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-i),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+o),u=new _(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(u)===n&&s===0?null:new Ha(u,n,0,s)}},bb=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new tn(t[s],n);let o=cx(n,e);return new Rt(o,i,{shouldPushStackElementBefore:yb(e,o),shouldPushStackElementAfter:!1})}},vb=class{static getCommands(e,t,n){let i=[];for(let o=0,s=n.length;o<s;o++){let a=n[o];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let u=e.normalizeIndentation(d);if(!l.startsWith(u)){i[o]=new tn(new _(a.startLineNumber,1,a.startLineNumber,l.length+1),u,!0);continue}}i[o]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){i[o]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[o]=new mi(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return i}static _goodIndentForLine(e,t,n){let i=null,o="",s=Sp(e.autoIndent,t,n,!1,e.languageConfigurationService);if(s)i=s.action,o=s.indentation;else if(n>1){let a;for(a=n-1;a>=1;a--){let u=t.getLineContent(a);if(yi(u)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=_p(e.autoIndent,t,new _(a,l,a,l),e.languageConfigurationService);d&&(o=d.indentation+d.appendText)}return i&&(i===1&&(o=xp(e,o)),i===3&&(o=$d(e,o)),o=e.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(e,t,n,i){let o="",s=n.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let u=0;u<d;u++)o+=" "}else o="	";return new tn(n,o,i)}},qd=class extends Ha{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,n,i,o,s){super(e,t,n,i),this._openCharacter=o,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,n){return this.closeCharacterRange=new _(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new _(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,n)}},dx=class extends qd{constructor(e,t,n,i){let o=(n?t:"")+i,s=0,a=-i.length;super(e,o,s,a,t,i)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,i,t)}},ux=class extends qd{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,n,i){let o=n+i,s=0,a=n.length;super(t,o,s,a,n,i),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:o}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length!==2)throw new Error("There should be two inverse edit operations!");let i=n[0].range,o=n[1].range,s=i.plusRange(o);return this._computeCursorStateWithRange(e,s,t)}};function cx(r,e){return r===" "?e===5||e===6?6:5:4}function yb(r,e){return Ck(r)&&!Ck(e)?!0:r===5?!1:Ik(r)!==Ik(e)}function Ik(r){return r===6||r===5?"space":r}function Ck(r){return r===4||r===5||r===6}function Sk(r,e,t,n,i){if(r.autoClosingOvertype==="never"||!r.autoClosingPairs.autoClosingPairsCloseSingleChar.has(i))return!1;for(let o=0,s=t.length;o<s;o++){let a=t[o];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==i)return!1;let c=br(i);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&c)return!1;if(r.autoClosingOvertype==="auto"){let h=!1;for(let g=0,f=n.length;g<f;g++){let v=n[g];if(l.lineNumber===v.startLineNumber&&l.column===v.startColumn){h=!0;break}}if(!h)return!1}}return!0}function Ga(r,e,t){return t?new Ua(r,e,!0):new tn(r,e,!0)}function xp(r,e,t){return t=t||1,mi.shiftIndent(e,e.length+t,r.tabSize,r.indentSize,r.insertSpaces)}function $d(r,e,t){return t=t||1,mi.unshiftIndent(e,e.length+t,r.tabSize,r.indentSize,r.insertSpaces)}function px(r,e){return br(e)?r.autoSurround==="quotes"||r.autoSurround==="languageDefined":r.autoSurround==="brackets"||r.autoSurround==="languageDefined"}var Ir=class{static indent(e,t,n){if(t===null||n===null)return[];let i=[];for(let o=0,s=n.length;o<s;o++)i[o]=new mi(n[o],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static outdent(e,t,n){let i=[];for(let o=0,s=n.length;o<s;o++)i[o]=new mi(n[o],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static shiftIndent(e,t,n){return xp(e,t,n)}static unshiftIndent(e,t,n){return $d(e,t,n)}static paste(e,t,n,i,o,s){return gb.getEdits(e,t,n,i,o,s)}static tab(e,t,n){return vb.getCommands(e,t,n)}static compositionType(e,t,n,i,o,s,a,l){return fb.getEdits(e,t,n,i,o,s,a,l)}static compositionEndWithInterceptors(e,t,n,i,o,s){if(!i)return null;let a=null;for(let p of i)if(a===null)a=p.insertedText;else if(a!==p.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let p of i)if(p.deletedText.length!==0){d=!0;break}if(d){if(!px(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let p=br(l);for(let f of i)if(f.deletedSelectionStart!==0||f.deletedSelectionEnd!==f.deletedText.length||/^[ \t]+$/.test(f.deletedText)||p&&br(f.deletedText))return null;let h=[];for(let f of o){if(!f.isEmpty())return null;h.push(f.getPosition())}if(h.length!==i.length)return null;let g=[];for(let f=0,v=h.length;f<v;f++)g.push(new lb(h[f],i[f].deletedText,t.surroundingPairs[l]));return new Rt(4,g,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let u=cb.getEdits(t,n,o,s,l);if(u!==void 0)return u;let c=Gd.getEdits(t,n,o,l,!0,!1);return c!==void 0?c:null}static typeWithInterceptors(e,t,n,i,o,s,a){let l=jd.getEdits(n,i,o,a,e);if(l!==void 0)return l;let d=db.getEdits(n,i,o,a,e);if(d!==void 0)return d;let u=ub.getEdits(t,n,i,o,s,a);if(u!==void 0)return u;let c=Gd.getEdits(n,i,o,a,!1,e);if(c!==void 0)return c;let p=pb.getEdits(n,i,o,a,e);if(p!==void 0)return p;let h=hb.getEdits(t,n,i,o,a,e);return h!==void 0?h:mb.getEdits(t,o,a)}static typeWithoutInterceptors(e,t,n,i,o){return bb.getEdits(e,i,o)}},Ib=class{constructor(e,t,n,i,o,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=n;this.insertedText=i;this.insertedSelectionStart=o;this.insertedSelectionEnd=s}};var X;(me=>(me.editorSimpleInput=new fe("editorSimpleInput",!1,!0),me.editorTextFocus=new fe("editorTextFocus",!1,m("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),me.focus=new fe("editorFocus",!1,m("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),me.textInputFocus=new fe("textInputFocus",!1,m("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),me.readOnly=new fe("editorReadonly",!1,m("editorReadonly","Whether the editor is read-only")),me.inDiffEditor=new fe("inDiffEditor",!1,m("inDiffEditor","Whether the context is a diff editor")),me.isEmbeddedDiffEditor=new fe("isEmbeddedDiffEditor",!1,m("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),me.multiDiffEditorAllCollapsed=new fe("multiDiffEditorAllCollapsed",void 0,m("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),me.hasChanges=new fe("diffEditorHasChanges",!1,m("diffEditorHasChanges","Whether the diff editor has changes")),me.comparingMovedCode=new fe("comparingMovedCode",!1,m("comparingMovedCode","Whether a moved code block is selected for comparison")),me.accessibleDiffViewerVisible=new fe("accessibleDiffViewerVisible",!1,m("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),me.diffEditorRenderSideBySideInlineBreakpointReached=new fe("diffEditorRenderSideBySideInlineBreakpointReached",!1,m("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),me.diffEditorInlineMode=new fe("diffEditorInlineMode",!1,m("diffEditorInlineMode","Whether inline mode is active")),me.diffEditorOriginalWritable=new fe("diffEditorOriginalWritable",!1,m("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),me.diffEditorModifiedWritable=new fe("diffEditorModifiedWritable",!1,m("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),me.diffEditorOriginalUri=new fe("diffEditorOriginalUri","",m("diffEditorOriginalUri","The uri of the original document")),me.diffEditorModifiedUri=new fe("diffEditorModifiedUri","",m("diffEditorModifiedUri","The uri of the modified document")),me.columnSelection=new fe("editorColumnSelection",!1,m("editorColumnSelection","Whether `editor.columnSelection` is enabled")),me.writable=me.readOnly.toNegated(),me.hasNonEmptySelection=new fe("editorHasSelection",!1,m("editorHasSelection","Whether the editor has text selected")),me.hasOnlyEmptySelection=me.hasNonEmptySelection.toNegated(),me.hasMultipleSelections=new fe("editorHasMultipleSelections",!1,m("editorHasMultipleSelections","Whether the editor has multiple selections")),me.hasSingleSelection=me.hasMultipleSelections.toNegated(),me.tabMovesFocus=new fe("editorTabMovesFocus",!1,m("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),me.tabDoesNotMoveFocus=me.tabMovesFocus.toNegated(),me.isInEmbeddedEditor=new fe("isInEmbeddedEditor",!1,!0),me.canUndo=new fe("canUndo",!1,!0),me.canRedo=new fe("canRedo",!1,!0),me.hoverVisible=new fe("editorHoverVisible",!1,m("editorHoverVisible","Whether the editor hover is visible")),me.hoverFocused=new fe("editorHoverFocused",!1,m("editorHoverFocused","Whether the editor hover is focused")),me.stickyScrollFocused=new fe("stickyScrollFocused",!1,m("stickyScrollFocused","Whether the sticky scroll is focused")),me.stickyScrollVisible=new fe("stickyScrollVisible",!1,m("stickyScrollVisible","Whether the sticky scroll is visible")),me.standaloneColorPickerVisible=new fe("standaloneColorPickerVisible",!1,m("standaloneColorPickerVisible","Whether the standalone color picker is visible")),me.standaloneColorPickerFocused=new fe("standaloneColorPickerFocused",!1,m("standaloneColorPickerFocused","Whether the standalone color picker is focused")),me.inCompositeEditor=new fe("inCompositeEditor",void 0,m("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),me.notInCompositeEditor=me.inCompositeEditor.toNegated(),me.languageId=new fe("editorLangId","",m("editorLangId","The language identifier of the editor")),me.hasCompletionItemProvider=new fe("editorHasCompletionItemProvider",!1,m("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),me.hasCodeActionsProvider=new fe("editorHasCodeActionsProvider",!1,m("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),me.hasCodeLensProvider=new fe("editorHasCodeLensProvider",!1,m("editorHasCodeLensProvider","Whether the editor has a code lens provider")),me.hasDefinitionProvider=new fe("editorHasDefinitionProvider",!1,m("editorHasDefinitionProvider","Whether the editor has a definition provider")),me.hasDeclarationProvider=new fe("editorHasDeclarationProvider",!1,m("editorHasDeclarationProvider","Whether the editor has a declaration provider")),me.hasImplementationProvider=new fe("editorHasImplementationProvider",!1,m("editorHasImplementationProvider","Whether the editor has an implementation provider")),me.hasTypeDefinitionProvider=new fe("editorHasTypeDefinitionProvider",!1,m("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),me.hasHoverProvider=new fe("editorHasHoverProvider",!1,m("editorHasHoverProvider","Whether the editor has a hover provider")),me.hasDocumentHighlightProvider=new fe("editorHasDocumentHighlightProvider",!1,m("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),me.hasDocumentSymbolProvider=new fe("editorHasDocumentSymbolProvider",!1,m("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),me.hasReferenceProvider=new fe("editorHasReferenceProvider",!1,m("editorHasReferenceProvider","Whether the editor has a reference provider")),me.hasRenameProvider=new fe("editorHasRenameProvider",!1,m("editorHasRenameProvider","Whether the editor has a rename provider")),me.hasSignatureHelpProvider=new fe("editorHasSignatureHelpProvider",!1,m("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),me.hasInlayHintsProvider=new fe("editorHasInlayHintsProvider",!1,m("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),me.hasDocumentFormattingProvider=new fe("editorHasDocumentFormattingProvider",!1,m("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),me.hasDocumentSelectionFormattingProvider=new fe("editorHasDocumentSelectionFormattingProvider",!1,m("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),me.hasMultipleDocumentFormattingProvider=new fe("editorHasMultipleDocumentFormattingProvider",!1,m("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),me.hasMultipleDocumentSelectionFormattingProvider=new fe("editorHasMultipleDocumentSelectionFormattingProvider",!1,m("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(X||={});var Pe=0,ot=class extends up{runEditorCommand(e,t,n){let i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}},nn;(a=>{let r=function(l){if(!Ot(l))return!1;let d=l;return!(!Ct(d.to)||!On(d.by)&&!Ct(d.by)||!On(d.value)&&!lo(d.value)||!On(d.revealCursor)&&!gh(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function i(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let u;switch(l.by){case a.RawUnit.Line:u=1;break;case a.RawUnit.WrappedLine:u=2;break;case a.RawUnit.Page:u=3;break;case a.RawUnit.HalfPage:u=4;break;case a.RawUnit.Editor:u=5;break;case a.RawUnit.Column:u=6;break;default:u=2}let c=Math.floor(l.value||1),p=!!l.revealCursor;return{direction:d,unit:u,value:c,revealCursor:p,select:!!l.select}}a.parse=i;let o;(p=>(p[p.Up=1]="Up",p[p.Right=2]="Right",p[p.Down=3]="Down",p[p.Left=4]="Left"))(o=a.Direction||={});let s;(g=>(g[g.Line=1]="Line",g[g.WrappedLine=2]="WrappedLine",g[g.Page=3]="Page",g[g.HalfPage=4]="HalfPage",g[g.Editor=5]="Editor",g[g.Column=6]="Column"))(s=a.Unit||={})})(nn||={});var Ep;(n=>{let r=function(i){if(!Ot(i))return!1;let o=i;return!(!lo(o.lineNumber)&&!Ct(o.lineNumber)||!On(o.at)&&!Ct(o.at))};n.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:r,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Ep||={});var wp=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,n)=>{let i=t.get(Ui).getFocusedCodeEditor();return i&&i.hasTextFocus()?this._runEditorCommand(t,i,n):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,n)=>{let i=La();return i&&KL(i)?(this.runDOMCommand(i),!0):!1}),e.addImplementation(0,"generic-dom",(t,n)=>{let i=t.get(Ui).getActiveCodeEditor();return i?(i.focus(),this._runEditorCommand(t,i,n)):!1})}_runEditorCommand(e,t,n){let i=this.runEditorCommand(e,t,n);return i||!0}};var Dt;(ce=>{class r extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){if(!z.position)return;E.model.pushStackElement(),E.setCursorStates(z.source,3,[Ut.moveTo(E,E.getPrimaryCursorState(),this._inSelectionMode,z.position,z.viewPosition)])&&z.revealType!==2&&E.revealAllCursors(z.source,!0,!0)}}ce.MoveTo=ge(new r({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),ce.MoveToSelect=ge(new r({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends ot{runCoreEditorCommand(E,z){E.model.pushStackElement();let Q=this._getColumnSelectResult(E,E.getPrimaryCursorState(),E.getCursorColumnSelectData(),z);Q!==null&&(E.setCursorStates(z.source,3,Q.viewStates.map(we=>Ie.fromViewState(we))),E.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:Q.fromLineNumber,fromViewVisualColumn:Q.fromVisualColumn,toViewLineNumber:Q.toLineNumber,toViewVisualColumn:Q.toVisualColumn}),Q.reversed?E.revealTopMostCursor(z.source):E.revealBottomMostCursor(z.source))}}ce.ColumnSelect=ge(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(q,E,z,Q){if(typeof Q.position>"u"||typeof Q.viewPosition>"u"||typeof Q.mouseColumn>"u")return null;let we=q.model.validatePosition(Q.position),$e=q.coordinatesConverter.validateViewPosition(new w(Q.viewPosition.lineNumber,Q.viewPosition.column),we),on=Q.doColumnSelect?z.fromViewLineNumber:$e.lineNumber,Cn=Q.doColumnSelect?z.fromViewVisualColumn:Q.mouseColumn-1;return Ss.columnSelect(q.cursorConfig,q,on,Cn,$e.lineNumber,Q.mouseColumn-1)}}),ce.CursorColumnSelectLeft=ge(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(q,E,z,Q){return Ss.columnSelectLeft(q.cursorConfig,q,z)}}),ce.CursorColumnSelectRight=ge(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(q,E,z,Q){return Ss.columnSelectRight(q.cursorConfig,q,z)}});class a extends n{_isPaged;constructor(E){super(E),this._isPaged=E.isPaged}_getColumnSelectResult(E,z,Q,we){return Ss.columnSelectUp(E.cursorConfig,E,Q,this._isPaged)}}ce.CursorColumnSelectUp=ge(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3600,linux:{primary:0}}})),ce.CursorColumnSelectPageUp=ge(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3595,linux:{primary:0}}}));class u extends n{_isPaged;constructor(E){super(E),this._isPaged=E.isPaged}_getColumnSelectResult(E,z,Q,we){return Ss.columnSelectDown(E.cursorConfig,E,Q,this._isPaged)}}ce.CursorColumnSelectDown=ge(new u({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3602,linux:{primary:0}}})),ce.CursorColumnSelectPageDown=ge(new u({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3596,linux:{primary:0}}}));class h extends ot{constructor(){super({id:"cursorMove",precondition:void 0,metadata:he.metadata})}runCoreEditorCommand(E,z){let Q=he.parse(z);Q&&this._runCursorMove(E,z.source,Q)}_runCursorMove(E,z,Q){E.model.pushStackElement(),E.setCursorStates(z,3,h._move(E,E.getCursorStates(),Q)),E.revealAllCursors(z,!0)}static _move(E,z,Q){let we=Q.select,$e=Q.value;switch(Q.direction){case he.Direction.Left:case he.Direction.Right:case he.Direction.Up:case he.Direction.Down:case he.Direction.PrevBlankLine:case he.Direction.NextBlankLine:case he.Direction.WrappedLineStart:case he.Direction.WrappedLineFirstNonWhitespaceCharacter:case he.Direction.WrappedLineColumnCenter:case he.Direction.WrappedLineEnd:case he.Direction.WrappedLineLastNonWhitespaceCharacter:return Ut.simpleMove(E,z,Q.direction,we,$e,Q.unit);case he.Direction.ViewPortTop:case he.Direction.ViewPortBottom:case he.Direction.ViewPortCenter:case he.Direction.ViewPortIfOutside:return Ut.viewportMove(E,z,Q.direction,we,$e);default:return null}}}ce.CursorMoveImpl=h,ce.CursorMove=ge(new h);let f;(E=>E[E.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(f||={});class v extends ot{_staticArgs;constructor(E){super(E),this._staticArgs=E.args}runCoreEditorCommand(E,z){let Q=this._staticArgs;this._staticArgs.value===-1&&(Q={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:z.pageSize||E.cursorConfig.pageSize}),E.model.pushStackElement(),E.setCursorStates(z.source,3,Ut.simpleMove(E,E.getCursorStates(),Q.direction,Q.select,Q.value,Q.unit)),E.revealAllCursors(z.source,!0)}}ce.CursorLeft=ge(new v({args:{direction:he.Direction.Left,unit:he.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),ce.CursorLeftSelect=ge(new v({args:{direction:he.Direction.Left,unit:he.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1039}})),ce.CursorRight=ge(new v({args:{direction:he.Direction.Right,unit:he.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),ce.CursorRightSelect=ge(new v({args:{direction:he.Direction.Right,unit:he.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1041}})),ce.CursorUp=ge(new v({args:{direction:he.Direction.Up,unit:he.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),ce.CursorUpSelect=ge(new v({args:{direction:he.Direction.Up,unit:he.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),ce.CursorPageUp=ge(new v({args:{direction:he.Direction.Up,unit:he.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:11}})),ce.CursorPageUpSelect=ge(new v({args:{direction:he.Direction.Up,unit:he.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1035}})),ce.CursorDown=ge(new v({args:{direction:he.Direction.Down,unit:he.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),ce.CursorDownSelect=ge(new v({args:{direction:he.Direction.Down,unit:he.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),ce.CursorPageDown=ge(new v({args:{direction:he.Direction.Down,unit:he.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:12}})),ce.CursorPageDownSelect=ge(new v({args:{direction:he.Direction.Down,unit:he.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1036}})),ce.CreateCursor=ge(new class extends ot{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(q,E){if(!E.position)return;let z;E.wholeLine?z=Ut.line(q,q.getPrimaryCursorState(),!1,E.position,E.viewPosition):z=Ut.moveTo(q,q.getPrimaryCursorState(),!1,E.position,E.viewPosition);let Q=q.getCursorStates();if(Q.length>1){let we=z.modelState?z.modelState.position:null,$e=z.viewState?z.viewState.position:null;for(let on=0,Cn=Q.length;on<Cn;on++){let Ln=Q[on];if(!(we&&!Ln.modelState.selection.containsPosition(we))&&!($e&&!Ln.viewState.selection.containsPosition($e))){Q.splice(on,1),q.model.pushStackElement(),q.setCursorStates(E.source,3,Q);return}}}Q.push(z),q.model.pushStackElement(),q.setCursorStates(E.source,3,Q)}}),ce.LastCursorMoveToSelect=ge(new class extends ot{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(q,E){if(!E.position)return;let z=q.getLastAddedCursorIndex(),Q=q.getCursorStates(),we=Q.slice(0);we[z]=Ut.moveTo(q,Q[z],!0,E.position,E.viewPosition),q.model.pushStackElement(),q.setCursorStates(E.source,3,we)}});class K extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){E.model.pushStackElement(),E.setCursorStates(z.source,3,Ut.moveToBeginningOfLine(E,E.getCursorStates(),this._inSelectionMode)),E.revealAllCursors(z.source,!0)}}ce.CursorHome=ge(new K({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),ce.CursorHomeSelect=ge(new K({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class j extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){E.model.pushStackElement(),E.setCursorStates(z.source,3,this._exec(E.getCursorStates())),E.revealAllCursors(z.source,!0)}_exec(E){let z=[];for(let Q=0,we=E.length;Q<we;Q++){let $e=E[Q],on=$e.modelState.position.lineNumber;z[Q]=Ie.fromModelState($e.modelState.move(this._inSelectionMode,on,1,0))}return z}}ce.CursorLineStart=ge(new j({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:0,mac:{primary:287}}})),ce.CursorLineStartSelect=ge(new j({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:0,mac:{primary:1311}}}));class re extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){E.model.pushStackElement(),E.setCursorStates(z.source,3,Ut.moveToEndOfLine(E,E.getCursorStates(),this._inSelectionMode,z.sticky||!1)),E.revealAllCursors(z.source,!0)}}ce.CursorEnd=ge(new re({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Pe,kbExpr:X.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),ce.CursorEndSelect=ge(new re({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Pe,kbExpr:X.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class de extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){E.model.pushStackElement(),E.setCursorStates(z.source,3,this._exec(E,E.getCursorStates())),E.revealAllCursors(z.source,!0)}_exec(E,z){let Q=[];for(let we=0,$e=z.length;we<$e;we++){let on=z[we],Cn=on.modelState.position.lineNumber,Ln=E.model.getLineMaxColumn(Cn);Q[we]=Ie.fromModelState(on.modelState.move(this._inSelectionMode,Cn,Ln,0))}return Q}}ce.CursorLineEnd=ge(new de({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:0,mac:{primary:291}}})),ce.CursorLineEndSelect=ge(new de({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:0,mac:{primary:1315}}}));class gi extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){E.model.pushStackElement(),E.setCursorStates(z.source,3,Ut.moveToBeginningOfBuffer(E,E.getCursorStates(),this._inSelectionMode)),E.revealAllCursors(z.source,!0)}}ce.CursorTop=ge(new gi({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:2062,mac:{primary:2064}}})),ce.CursorTopSelect=ge(new gi({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3086,mac:{primary:3088}}}));class Ti extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){E.model.pushStackElement(),E.setCursorStates(z.source,3,Ut.moveToEndOfBuffer(E,E.getCursorStates(),this._inSelectionMode)),E.revealAllCursors(z.source,!0)}}ce.CursorBottom=ge(new Ti({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:2061,mac:{primary:2066}}})),ce.CursorBottomSelect=ge(new Ti({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:3085,mac:{primary:3090}}}));class el extends ot{constructor(){super({id:"editorScroll",precondition:void 0,metadata:nn.metadata})}determineScrollMethod(E){let z=[6],Q=[1,2,3,4,5,6],we=[4,2],$e=[1,3];return z.includes(E.unit)&&we.includes(E.direction)?this._runHorizontalEditorScroll.bind(this):Q.includes(E.unit)&&$e.includes(E.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(E,z){let Q=nn.parse(z);if(!Q)return;let we=this.determineScrollMethod(Q);we&&we(E,z.source,Q)}_runVerticalEditorScroll(E,z,Q){let we=this._computeDesiredScrollTop(E,Q);if(Q.revealCursor){let $e=E.getCompletelyVisibleViewRangeAtScrollTop(we);E.setCursorStates(z,3,[Ut.findPositionInViewportIfOutside(E,E.getPrimaryCursorState(),$e,Q.select)])}E.viewLayout.setScrollPosition({scrollTop:we},0)}_computeDesiredScrollTop(E,z){if(z.unit===1){let $e=E.viewLayout.getFutureViewport(),on=E.getCompletelyVisibleViewRangeAtScrollTop($e.top),Cn=E.coordinatesConverter.convertViewRangeToModelRange(on),Ln;z.direction===1?Ln=Math.max(1,Cn.startLineNumber-z.value):Ln=Math.min(E.model.getLineCount(),Cn.startLineNumber+z.value);let bu=E.coordinatesConverter.convertModelPositionToViewPosition(new w(Ln,1));return E.viewLayout.getVerticalOffsetForLineNumber(bu.lineNumber)}if(z.unit===5){let $e=0;return z.direction===3&&($e=E.model.getLineCount()-E.cursorConfig.pageSize),E.viewLayout.getVerticalOffsetForLineNumber($e)}let Q;z.unit===3?Q=E.cursorConfig.pageSize*z.value:z.unit===4?Q=Math.round(E.cursorConfig.pageSize/2)*z.value:Q=z.value;let we=(z.direction===1?-1:1)*Q;return E.viewLayout.getCurrentScrollTop()+we*E.cursorConfig.lineHeight}_runHorizontalEditorScroll(E,z,Q){let we=this._computeDesiredScrollLeft(E,Q);E.viewLayout.setScrollPosition({scrollLeft:we},0)}_computeDesiredScrollLeft(E,z){let Q=(z.direction===4?-1:1)*z.value;return E.viewLayout.getCurrentScrollLeft()+Q*E.cursorConfig.typicalHalfwidthCharacterWidth}}ce.EditorScrollImpl=el,ce.EditorScroll=ge(new el),ce.ScrollLineUp=ge(new class extends ot{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Up,by:nn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:E.source})}}),ce.ScrollPageUp=ge(new class extends ot{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Up,by:nn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:E.source})}}),ce.ScrollEditorTop=ge(new class extends ot{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Up,by:nn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:E.source})}}),ce.ScrollLineDown=ge(new class extends ot{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Down,by:nn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:E.source})}}),ce.ScrollPageDown=ge(new class extends ot{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Down,by:nn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:E.source})}}),ce.ScrollEditorBottom=ge(new class extends ot{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Down,by:nn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:E.source})}}),ce.ScrollLeft=ge(new class extends ot{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Left,by:nn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:E.source})}}),ce.ScrollRight=ge(new class extends ot{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus}})}runCoreEditorCommand(q,E){ce.EditorScroll.runCoreEditorCommand(q,{to:nn.RawDirection.Right,by:nn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:E.source})}});class no extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){z.position&&(E.model.pushStackElement(),E.setCursorStates(z.source,3,[Ut.word(E,E.getPrimaryCursorState(),this._inSelectionMode,z.position)]),z.revealType!==2&&E.revealAllCursors(z.source,!0,!0))}}ce.WordSelect=ge(new no({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),ce.WordSelectDrag=ge(new no({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),ce.LastCursorWordSelect=ge(new class extends ot{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(q,E){if(!E.position)return;let z=q.getLastAddedCursorIndex(),Q=q.getCursorStates(),we=Q.slice(0),$e=Q[z];we[z]=Ut.word(q,$e,$e.modelState.hasSelection(),E.position),q.model.pushStackElement(),q.setCursorStates(E.source,3,we)}});class rl extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){z.position&&(E.model.pushStackElement(),E.setCursorStates(z.source,3,[Ut.line(E,E.getPrimaryCursorState(),this._inSelectionMode,z.position,z.viewPosition)]),z.revealType!==2&&E.revealAllCursors(z.source,!1,!0))}}ce.LineSelect=ge(new rl({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),ce.LineSelectDrag=ge(new rl({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class Ts extends ot{_inSelectionMode;constructor(E){super(E),this._inSelectionMode=E.inSelectionMode}runCoreEditorCommand(E,z){if(!z.position)return;let Q=E.getLastAddedCursorIndex(),we=E.getCursorStates(),$e=we.slice(0);$e[Q]=Ut.line(E,we[Q],this._inSelectionMode,z.position,z.viewPosition),E.model.pushStackElement(),E.setCursorStates(z.source,3,$e)}}ce.LastCursorLineSelect=ge(new Ts({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),ce.LastCursorLineSelectDrag=ge(new Ts({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),ce.CancelSelection=ge(new class extends ot{constructor(){super({id:"cancelSelection",precondition:X.hasNonEmptySelection,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(q,E){q.model.pushStackElement(),q.setCursorStates(E.source,3,[Ut.cancelSelection(q,q.getPrimaryCursorState())]),q.revealAllCursors(E.source,!0)}}),ce.RemoveSecondaryCursors=ge(new class extends ot{constructor(){super({id:"removeSecondaryCursors",precondition:X.hasMultipleSelections,kbOpts:{weight:Pe+1,kbExpr:X.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(q,E){q.model.pushStackElement(),q.setCursorStates(E.source,3,[q.getPrimaryCursorState()]),q.revealAllCursors(E.source,!0),fk(m("removedCursor","Removed secondary cursors"))}}),ce.RevealLine=ge(new class extends ot{constructor(){super({id:"revealLine",precondition:void 0,metadata:Ep.metadata})}runCoreEditorCommand(q,E){let z=E,Q=z.lineNumber||0,we=typeof Q=="number"?Q+1:parseInt(Q)+1;we<1&&(we=1);let $e=q.model.getLineCount();we>$e&&(we=$e);let on=new _(we,1,we,q.model.getLineMaxColumn(we)),Cn=0;if(z.at)switch(z.at){case Ep.RawAtArgument.Top:Cn=3;break;case Ep.RawAtArgument.Center:Cn=1;break;case Ep.RawAtArgument.Bottom:Cn=4;break;default:break}let Ln=q.coordinatesConverter.convertModelRangeToViewRange(on);q.revealRange(E.source,!1,Ln,Cn,0)}}),ce.SelectAll=new class extends wp{constructor(){super(ak)}runDOMCommand(q){Xt&&(q.focus(),q.select()),q.ownerDocument.execCommand("selectAll")}runEditorCommand(q,E,z){let Q=E._getViewModel();Q&&this.runCoreEditorCommand(Q,z)}runCoreEditorCommand(q,E){q.model.pushStackElement(),q.setCursorStates("keyboard",3,[Ut.selectAll(q,q.getPrimaryCursorState())])}},ce.SetSelection=ge(new class extends ot{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(q,E){E.selection&&(q.model.pushStackElement(),q.setCursorStates(E.source,3,[Ie.fromModelSelection(E.selection)]))}})})(Dt||={});var iA=vt.and(X.textInputFocus,X.columnSelection);function Qd(r,e){pd.registerKeybindingRule({id:r,primary:e,when:iA,weight:Pe+1})}Qd(Dt.CursorColumnSelectLeft.id,1039);Qd(Dt.CursorColumnSelectRight.id,1041);Qd(Dt.CursorColumnSelectUp.id,1040);Qd(Dt.CursorColumnSelectPageUp.id,1035);Qd(Dt.CursorColumnSelectDown.id,1042);Qd(Dt.CursorColumnSelectPageDown.id,1036);function _k(r){return r.register(),r}var rA;(l=>{class r extends up{runEditorCommand(u,c,p){let h=c._getViewModel();h&&this.runCoreEditingCommand(c,h,p||{})}}l.CoreEditingCommand=r,l.LineBreakInsert=ge(new class extends r{constructor(){super({id:"lineBreakInsert",precondition:X.writable,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,u,c){d.pushUndoStop(),d.executeCommands(this.id,jd.lineBreakInsert(u.cursorConfig,u.model,u.getCursorStates().map(p=>p.modelState.selection)))}}),l.Outdent=ge(new class extends r{constructor(){super({id:"outdent",precondition:X.writable,kbOpts:{weight:Pe,kbExpr:vt.and(X.editorTextFocus,X.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,u,c){d.pushUndoStop(),d.executeCommands(this.id,Ir.outdent(u.cursorConfig,u.model,u.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.Tab=ge(new class extends r{constructor(){super({id:"tab",precondition:X.writable,kbOpts:{weight:Pe,kbExpr:vt.and(X.editorTextFocus,X.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,u,c){d.pushUndoStop(),d.executeCommands(this.id,Ir.tab(u.cursorConfig,u.model,u.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=ge(new class extends r{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,u,c){let[p,h]=Oo.deleteLeft(u.getPrevEditOperationType(),u.cursorConfig,u.model,u.getCursorStates().map(g=>g.modelState.selection),u.getCursorAutoClosedCharacters());p&&d.pushUndoStop(),d.executeCommands(this.id,h),u.setPrevEditOperationType(2)}}),l.DeleteRight=ge(new class extends r{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:Pe,kbExpr:X.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,u,c){let[p,h]=Oo.deleteRight(u.getPrevEditOperationType(),u.cursorConfig,u.model,u.getCursorStates().map(g=>g.modelState.selection));p&&d.pushUndoStop(),d.executeCommands(this.id,h),u.setPrevEditOperationType(3)}}),l.Undo=new class extends wp{constructor(){super(j_)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,u,c){if(!(!u.hasModel()||u.getOption(93)===!0))return u.getModel().undo()}},l.Redo=new class extends wp{constructor(){super(q_)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,u,c){if(!(!u.hasModel()||u.getOption(93)===!0))return u.getModel().redo()}}})(rA||={});var Cb=class extends Fa{_handlerId;constructor(e,t,n){super({id:e,precondition:void 0,metadata:n}),this._handlerId=t}runCommand(e,t){let n=e.get(Ui).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}};function ja(r,e){_k(new Cb("default:"+r,r)),_k(new Cb(r,r,e))}ja("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});ja("replacePreviousChar");ja("compositionType");ja("compositionStart");ja("compositionEnd");ja("paste");ja("cut");var Zd=class r{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return r.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let n={...e};return n.position&&(n.position=t.convertViewPositionToModelPosition(n.position)),n.range&&(n.range=t.convertViewRangeToModelRange(n.range)),(n.type===5||n.type===8)&&(n.detail=this.convertViewToModelViewZoneData(n.detail,t)),n}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new w(e.afterLineNumber,1)).lineNumber}}};var Sb=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Dt.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new w(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,n=pt&&t.get(109),i=t.get(22);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Dt.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Dt.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,n){e=this._validateViewColumn(e),Dt.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),Dt.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Dt.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Dt.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Dt.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Dt.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Dt.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Dt.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Dt.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Dt.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Dt.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var _s=class extends B{onclick(e,t){this._register(oe(e,De.CLICK,n=>t(new pr(_e(e),n))))}onmousedown(e,t){this._register(oe(e,De.MOUSE_DOWN,n=>t(new pr(_e(e),n))))}onmouseover(e,t){this._register(oe(e,De.MOUSE_OVER,n=>t(new pr(_e(e),n))))}onmouseleave(e,t){this._register(oe(e,De.MOUSE_LEAVE,n=>t(new pr(_e(e),n))))}onkeydown(e,t){this._register(oe(e,De.KEY_DOWN,n=>t(new xi(n))))}onkeyup(e,t){this._register(oe(e,De.KEY_UP,n=>t(new xi(n))))}oninput(e,t){this._register(oe(e,De.INPUT,t))}onblur(e,t){this._register(oe(e,De.BLUR,t))}onfocus(e,t){this._register(oe(e,De.FOCUS,t))}onchange(e,t){this._register(oe(e,De.CHANGE,t))}ignoreGesture(e){return Qr.ignoreTarget(e)}};var xs=11,_b=class extends _s{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Nt.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=xs+"px",this.domNode.style.height=xs+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new Jr),this._register(To(this.bgDomNode,De.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(To(this.domNode,De.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new _d),this._pointerdownScheduleRepeatTimer=this._register(new Zi)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,_e(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var Xd=class r{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,n,i,o,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=o,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new r(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,o){let s=Math.max(0,n-e),a=Math.max(0,s-2*t),l=i>0&&i>n;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(n*a/i))),u=(a-d)/(i-n),c=o*u;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:u,computedSliderPosition:Math.round(c)}}_refreshComputedValues(){let e=r._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var xb=class extends B{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Zi)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var oA=140,Jd=class extends _s{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new xb(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Jr),this._shouldRender=!0,this.domNode=pe(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(oe(this.domNode.domNode,De.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new _b(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=pe(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(oe(this.slider.domNode,De.POINTER_DOWN,o=>{o.button===0&&(o.preventDefault(),this._sliderPointerDown(o))})),this.onclick(this.slider.domNode,o=>{o.leftButton&&o.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderPointerPosition(e);n<=o&&o<=i?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,n;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,n=e.offsetY;else{let o=gr(this.domNode.domNode);t=e.pageX-o.left,n=e.pageY-o.top}let i=this._pointerDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),n=this._sliderOrthogonalPointerPosition(e),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>{let s=this._sliderOrthogonalPointerPosition(o),a=Math.abs(s-n);if(Fe&&a>oA){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let d=this._sliderPointerPosition(o)-t;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var Eb=class extends Jd{constructor(e,t,n){let i=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Xd(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,i.width,i.scrollWidth,o.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-xs)/2,a=(t.horizontalScrollbarSize-xs)/2;this._createArrow({className:"scra",icon:se.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Ei(null,1,0))}),this._createArrow({className:"scra",icon:se.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Ei(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var wb=class extends Jd{constructor(e,t,n){let i=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Xd(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,o.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-xs)/2,a=(t.verticalScrollbarSize-xs)/2;this._createArrow({className:"scra",icon:se.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Ei(null,0,1))}),this._createArrow({className:"scra",icon:se.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Ei(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var sA=500,xk=50,Ek=!0,hx=class{timestamp;deltaX;deltaY;score;constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}},Lp=class r{static INSTANCE=new r;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,n=1,i=this._rear;do{let o=i===this._front?e:Math.pow(2,-n);if(e-=o,t+=this._memory[i].score*o,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(vs){let t=_e(e.browserEvent),n=vL(t);this.accept(Date.now(),e.deltaX*n,e.deltaY*n)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,n){let i=null,o=new hx(e,t,n);this._front===-1&&this._rear===-1?(this._memory[0]=o,this._front=0,this._rear=0):(i=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=o),o.score=this._computeScore(o,i)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(n+=.25),t){let i=Math.abs(e.deltaX),o=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(i,s),1),d=Math.max(Math.min(o,a),1),u=Math.max(i,s),c=Math.max(o,a);u%l===0&&c%d===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},mx=class extends _s{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new L);onScroll=this._onScroll.event;_onWillScroll=this._register(new L);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,n){super(),e.style.overflow="hidden",this._options=aA(t),this._scrollable=n,this._register(this._scrollable.onScroll(o=>{this._onWillScroll.fire(o),this._onDidScroll(o),this._onScroll.fire(o)}));let i={onMouseWheel:o=>this._onMouseWheel(o),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new wb(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new Eb(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=pe(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=pe(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=pe(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,o=>this._onMouseOver(o)),this.onmouseleave(this._listenOnDomNode,o=>this._onMouseLeave(o)),this._hideTimeout=this._register(new Zi),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=Sn(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Me&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Ei(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Sn(this._mouseWheelToDispose),e)){let n=i=>{this._onMouseWheel(new Ei(i))};this._mouseWheelToDispose.push(oe(this._listenOnDomNode,De.MOUSE_WHEEL,n,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=Lp.INSTANCE;Ek&&t.acceptStandardWheelEvent(e);let n=!1;if(e.deltaY||e.deltaX){let o=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+o===0?s=o=0:Math.abs(o)>=Math.abs(s)?s=0:o=0),this._options.flipAxes&&([o,s]=[s,o]);let a=!Me&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=o,o=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(o){let u=xk*o,c=l.scrollTop-(u<0?Math.floor(u):Math.ceil(u));this._verticalScrollbar.writeScrollPosition(d,c)}if(s){let u=xk*s,c=l.scrollLeft-(u<0?Math.floor(u):Math.ceil(u));this._horizontalScrollbar.writeScrollPosition(d,c)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(Ek&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",o=t?" top":"",s=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${o}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),sA)}};var Tb=class extends mx{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function aA(r){let e={lazyRender:typeof r.lazyRender<"u"?r.lazyRender:!1,className:typeof r.className<"u"?r.className:"",useShadows:typeof r.useShadows<"u"?r.useShadows:!0,handleMouseWheel:typeof r.handleMouseWheel<"u"?r.handleMouseWheel:!0,flipAxes:typeof r.flipAxes<"u"?r.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof r.consumeMouseWheelIfScrollbarIsNeeded<"u"?r.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof r.alwaysConsumeMouseWheel<"u"?r.alwaysConsumeMouseWheel:!1,scrollYToX:typeof r.scrollYToX<"u"?r.scrollYToX:!1,mouseWheelScrollSensitivity:typeof r.mouseWheelScrollSensitivity<"u"?r.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof r.fastScrollSensitivity<"u"?r.fastScrollSensitivity:5,scrollPredominantAxis:typeof r.scrollPredominantAxis<"u"?r.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof r.mouseWheelSmoothScroll<"u"?r.mouseWheelSmoothScroll:!0,arrowSize:typeof r.arrowSize<"u"?r.arrowSize:11,listenOnDomNode:typeof r.listenOnDomNode<"u"?r.listenOnDomNode:null,horizontal:typeof r.horizontal<"u"?r.horizontal:1,horizontalScrollbarSize:typeof r.horizontalScrollbarSize<"u"?r.horizontalScrollbarSize:10,horizontalSliderSize:typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:0,horizontalHasArrows:typeof r.horizontalHasArrows<"u"?r.horizontalHasArrows:!1,vertical:typeof r.vertical<"u"?r.vertical:1,verticalScrollbarSize:typeof r.verticalScrollbarSize<"u"?r.verticalScrollbarSize:10,verticalHasArrows:typeof r.verticalHasArrows<"u"?r.verticalHasArrows:!1,verticalSliderSize:typeof r.verticalSliderSize<"u"?r.verticalSliderSize:0,scrollByPage:typeof r.scrollByPage<"u"?r.scrollByPage:!1};return e.horizontalSliderSize=typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof r.verticalSliderSize<"u"?r.verticalSliderSize:e.verticalScrollbarSize,Me&&(e.className+=" mac"),e}var eu=class extends Vi{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new zd(this._context,n),this._mouseDownOperation=this._register(new gx(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let i=new Ff(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(i.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=oe(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new zi(a,!1,this.viewHelper.viewDomNode))}))})),this._register(i.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let o=0;this._register(i.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{o=a})),this._register(oe(this.viewHelper.viewDomNode,De.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(i.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,o))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=Lp.INSTANCE,t=0,n=Nr.getZoomLevel(),i=!1,o=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Ei(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let u=Nr.getZoomLevel(),c=d.deltaY>0?1:-1;Nr.setZoomLevel(u+c),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(n=Nr.getZoomLevel(),i=a(l),o=0),t=Date.now(),o+=d.deltaY,i&&(Nr.setZoomLevel(n+o/5),d.preventDefault(),d.stopPropagation())};this._register(oe(this.viewHelper.viewDomNode,De.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return Me?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let i=new hp(e,t).toPageCoordinates(_e(this.viewHelper.viewDomNode)),o=Vf(this.viewHelper.viewDomNode);if(i.y<o.y||i.y>o.y+o.height||i.x<o.x||i.x>o.x+o.width)return null;let s=Uf(this.viewHelper.viewDomNode,o,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),o,i,s,null)}_createMouseTarget(e,t){let n=e.target;if(!this.viewHelper.viewDomNode.contains(n)){let i=Is(this.viewHelper.viewDomNode);i&&(n=i.elementsFromPoint(e.posx,e.posy).find(o=>this.viewHelper.viewDomNode.contains(o)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?n:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let n=this._createMouseTarget(e,!0),i=n.type===6||n.type===7,o=n.type===2||n.type===3||n.type===4,s=n.type===3,a=this._context.configuration.options.get(111),l=n.type===8||n.type===5,d=n.type===9,u=e.leftButton||e.middleButton;Me&&e.leftButton&&e.ctrlKey&&(u=!1);let c=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(u&&(i||s&&a))c(),this._mouseDownOperation.start(n.type,e,t);else if(o)e.preventDefault();else if(l){let p=n.detail;u&&this.viewHelper.shouldSuppressMouseDownOnViewZone(p.viewZoneId)&&(c(),this._mouseDownOperation.start(n.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(n.detail)&&(c(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:n})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},gx=class extends B{constructor(t,n,i,o,s,a){super();this._context=t;this._viewController=n;this._viewHelper=i;this._mouseTargetFactory=o;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new Bf(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new fx(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,u)=>this._dispatchMouse(l,d,u))),this._mouseState=new vx,this._currentSelection=new ye(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let n=this._findMousePosition(t,!1);n&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:n}):n.type===13&&(n.outsidePosition==="above"||n.outsidePosition==="below")?this._topBottomDragScrolling.start(n,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(n,!0,1)))}start(t,n,i){this._lastMouseEvent=n,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(n),this._mouseState.setModifiers(n);let o=this._findMousePosition(n,!0);if(!o||!o.position)return;this._mouseState.trySetCount(n.detail,o.position),n.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&n.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&o.type===6&&o.position&&this._currentSelection.containsPosition(o.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);FL(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(o,n.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let n=t.editorPos,i=this._context.viewModel,o=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<n.y){let l=n.y-t.posy,d=Math.max(o.getCurrentScrollTop()-l,0),u=Hd.getZoneAtCoord(this._context,d);if(u){let p=this._helpPositionJumpOverViewZone(u);if(p)return Vt.createOutsideEditor(s,p,"above",l)}let c=o.getLineNumberAtVerticalOffset(d);return Vt.createOutsideEditor(s,new w(c,1),"above",l)}if(t.posy>n.y+n.height){let l=t.posy-n.y-n.height,d=o.getCurrentScrollTop()+t.relativePos.y,u=Hd.getZoneAtCoord(this._context,d);if(u){let p=this._helpPositionJumpOverViewZone(u);if(p)return Vt.createOutsideEditor(s,p,"below",l)}let c=o.getLineNumberAtVerticalOffset(d);return Vt.createOutsideEditor(s,new w(c,i.getLineMaxColumn(c)),"below",l)}let a=o.getLineNumberAtVerticalOffset(o.getCurrentScrollTop()+t.relativePos.y);if(t.posx<n.x){let l=n.x-t.posx;return Vt.createOutsideEditor(s,new w(a,1),"left",l)}if(t.posx>n.x+n.width){let l=t.posx-n.x-n.width;return Vt.createOutsideEditor(s,new w(a,i.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,n){let i=this._getPositionOutsideEditor(t);if(i)return i;let o=this._createMouseTarget(t,n);if(!o.position)return null;if(o.type===8||o.type===5){let a=this._helpPositionJumpOverViewZone(o.detail);if(a)return Vt.createViewZone(o.type,o.element,o.mouseColumn,a,o.detail)}return o}_helpPositionJumpOverViewZone(t){let n=new w(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=t.positionBefore,o=t.positionAfter;return i&&o?i.isBefore(n)?i:o:null}_dispatchMouse(t,n,i){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:n,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},fx=class extends B{constructor(t,n,i,o){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=o;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,n){this._operation?this._operation.setPosition(t,n):this._operation=new bx(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,n)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},bx=class extends B{constructor(t,n,i,o,s,a){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=o;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=Bi(_e(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,n){this._position=t,this._mouseEvent=n}_tick(){let t=Date.now(),n=t-this._lastTime;return this._lastTime=t,n}_getScrollSpeed(){let t=this._context.configuration.options.get(68),n=this._context.configuration.options.get(147).height/t,i=this._position.outsideDistance/t;return i<=1.5?Math.max(30,n*(1+i)):i<=3?Math.max(60,n*(2+i)):Math.max(200,n*(7+i))}_execute(){let t=this._context.configuration.options.get(68),n=this._getScrollSpeed(),i=this._tick(),o=n*(i/1e3)*t,s=this._position.outsidePosition==="above"?-o:o;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let u=Vf(this._viewHelper.viewDomNode),c=this._context.configuration.options.get(147).horizontalScrollbarHeight,p=new Cs(this._mouseEvent.pos.x,u.y+u.height-c-.1),h=Uf(this._viewHelper.viewDomNode,u,p);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),u,p,h,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Vt.createOutsideEditor(this._position.mouseColumn,new w(l,1),"above",this._position.outsideDistance):d=Vt.createOutsideEditor(this._position.mouseColumn,new w(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=Bi(_e(d.element),()=>this._execute())}},vx=class r{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let n=new Date().getTime();n-this._lastSetMouseDownCountTime>r.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function Lb(r,e,t,n){let i=r.getPlainTextToCopy(e,t,Fe),o=r.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(i)?i:null,l=Array.isArray(i)?i.join(o):i,d,u=null;if(dA.forceCopyWithSyntaxHighlighting||n&&l.length<65536){let p=r.getRichTextToCopy(e,t);p&&(d=p.html,u=p.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:u}}var qa=class r{static INSTANCE=new r;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},dA={forceCopyWithSyntaxHighlighting:!1};var tu=class r{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let n=e*t,i=n+1,o=n+t;return new _(i,1,o+1,1)}static fromEditorSelection(e,t,n,i){let s=r._getPageOfLine(t.startLineNumber,n),a=r._getRangeForPage(s,n),l=r._getPageOfLine(t.endLineNumber,n),d=r._getRangeForPage(l,n),u=a.intersectRanges(new _(1,1,t.startLineNumber,t.startColumn));if(i&&e.getValueLengthInRange(u,1)>500){let y=e.modifyPosition(u.getEndPosition(),-500);u=_.fromPositions(y,u.getEndPosition())}let c=e.getValueInRange(u,1),p=e.getLineCount(),h=e.getLineMaxColumn(p),g=d.intersectRanges(new _(t.endLineNumber,t.endColumn,p,h));if(i&&e.getValueLengthInRange(g,1)>500){let y=e.modifyPosition(g.getStartPosition(),500);g=_.fromPositions(g.getStartPosition(),y)}let f=e.getValueInRange(g,1),v;if(s===l||s+1===l)v=e.getValueInRange(t,1);else{let y=a.intersectRanges(t),I=d.intersectRanges(t);v=e.getValueInRange(y,1)+"\u2026"+e.getValueInRange(I,1)}return i&&v.length>2*500&&(v=v.substring(0,500)+"\u2026"+v.substring(v.length-500,v.length)),{value:c+v+f,selection:t,selectionStart:c.length,selectionEnd:c.length+v.length,newlineCountBeforeSelection:u.endLineNumber-u.startLineNumber}}};function kp(r,e){if(r.get(2)===1){let n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),i=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),o=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=m("accessibilityModeOff","The editor is not accessible at this time.");return n?m("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,n):i?m("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,i):o?m("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,o):s}return r.get(4)}function Rp(r){let e=0,t=-1;do{if(t=r.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var qn=!1,Ht=class r{constructor(e,t,n,i,o){this.value=e;this.selectionStart=t;this.selectionEnd=n;this.selection=i;this.newlineCountBeforeSelection=o}static EMPTY=new r("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let n=e.getValue(),i=e.getSelectionStart(),o=e.getSelectionEnd(),s;if(t){let a=n.substring(0,i),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new r(n,i,o,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new r(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,n){qn&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let i=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,i,-1)}if(e>=this.selectionEnd){let i=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,o=-1;for(;(o=t.indexOf(`
`,o+1))!==-1;)i++;return[e,n*t.length,i]}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};qn&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let i=Math.min(Ou(e.value,t.value),e.selectionStart,t.selectionStart),o=Math.min(Nu(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(i,e.value.length-o),a=t.value.substring(i,t.value.length-o),l=e.selectionStart-i,d=e.selectionEnd-i,u=t.selectionStart-i,c=t.selectionEnd-i;if(qn&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${u}, selectionEnd: ${c}`)),u===c){let h=e.selectionStart-i;return qn&&console.log(`REMOVE PREVIOUS: ${h} chars`),{text:a,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}let p=d-l;return{text:a,replacePrevCharCnt:p,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(qn&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let n=Math.min(Ou(e.value,t.value),e.selectionEnd),i=Math.min(Nu(e.value,t.value),e.value.length-e.selectionEnd),o=e.value.substring(n,e.value.length-i),s=t.value.substring(n,t.value.length-i),a=e.selectionStart-n,l=e.selectionEnd-n,d=t.selectionStart-n,u=t.selectionEnd-n;return qn&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${o}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${u}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:o.length-l,positionDelta:u-s.length}}static fromScreenReaderContentState(e){return new r(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var Rb;(e=>e.Tap="-monaco-textarea-synthetic-tap")(Rb||={});var yx=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},nu=class extends B{constructor(t,n,i,o,s,a){super();this._host=t;this._textArea=n;this._OS=i;this._browser=o;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new dn(()=>this._onCut.fire(),0)),this._textAreaState=Ht.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(Ke.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new dn(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let u=new xi(d);(u.keyCode===114||this._currentComposition&&u.keyCode===1)&&u.stopPropagation(),u.equals(9)&&u.preventDefault(),l=u,this._onKeyDown.fire(u)})),this._register(this._textArea.onKeyUp(d=>{let u=new xi(d);this._onKeyUp.fire(u)})),this._register(this._textArea.onCompositionStart(d=>{qn&&console.log("[compositionstart]",d);let u=new yx;if(this._currentComposition){this._currentComposition=u;return}if(this._currentComposition=u,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){qn&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),u.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{qn&&console.log("[compositionupdate]",d);let u=this._currentComposition;if(!u)return;if(this._browser.isAndroid){let p=Ht.readFromTextArea(this._textArea,this._textAreaState),h=Ht.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(h),this._onCompositionUpdate.fire(d);return}let c=u.handleCompositionUpdate(d.data);this._textAreaState=Ht.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(c),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{qn&&console.log("[compositionend]",d);let u=this._currentComposition;if(!u)return;if(this._currentComposition=null,this._browser.isAndroid){let p=Ht.readFromTextArea(this._textArea,this._textAreaState),h=Ht.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(h),this._onCompositionEnd.fire();return}let c=u.handleCompositionUpdate(d.data);this._textAreaState=Ht.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(c),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(qn&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let u=Ht.readFromTextArea(this._textArea,this._textAreaState),c=Ht.deduceInput(this._textAreaState,u,this._OS===2);c.replacePrevCharCnt===0&&c.text.length===1&&(lt(c.text.charCodeAt(0))||c.text.charCodeAt(0)===127)||(this._textAreaState=u,(c.text!==""||c.replacePrevCharCnt!==0||c.replaceNextCharCnt!==0||c.positionDelta!==0)&&this._onType.fire(c))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[u,c]=wk.getTextData(d.clipboardData);u&&(c=c||qa.INSTANCE.get(u),this._onPaste.fire({text:u,metadata:c}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new dn(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new L);onFocus=this._onFocus.event;_onBlur=this._register(new L);onBlur=this._onBlur.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new L);onKeyUp=this._onKeyUp.event;_onCut=this._register(new L);onCut=this._onCut.event;_onPaste=this._register(new L);onPaste=this._onPaste.event;_onType=this._register(new L);onType=this._onType.event;_onCompositionStart=this._register(new L);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new L);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new L);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new L);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new Zn);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=Ht.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return oe(this._textArea.ownerDocument,"selectionchange",n=>{if(Do.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let i=Date.now(),o=i-t;if(t=i,o<5)return;let s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let u=this._textAreaState.deduceEditorPosition(l),c=this._host.deduceModelPosition(u[0],u[1],u[2]),p=this._textAreaState.deduceEditorPosition(d),h=this._host.deduceModelPosition(p[0],p[1],p[2]),g=new ye(c.lineNumber,c.column,h.lineNumber,h.column);this._onSelectionChangeRequest.fire(g)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,n){this._hasFocus||(n=n.collapseSelection()),n.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=n}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let n=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:n.isFromEmptySelection,multicursorText:n.multicursorText,mode:n.mode};qa.INSTANCE.set(this._browser.isFirefox?n.text.replace(/\r\n/g,`
`):n.text,i),t.preventDefault(),t.clipboardData&&wk.setTextData(t.clipboardData,n.text,n.html,i)}};nu=ne([M(4,ri),M(5,ti)],nu);var wk={getTextData(r){let e=r.getData(ha.text),t=null,n=r.getData("vscode-editor-data");if(typeof n=="string")try{t=JSON.parse(n),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&r.files.length>0?[Array.prototype.slice.call(r.files,0).map(o=>o.name).join(`
`),null]:[e,t]},setTextData(r,e,t,n){r.setData(ha.text,e),typeof t=="string"&&r.setData("text/html",t),r.setData("vscode-editor-data",JSON.stringify(n))}},kb=class extends B{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>Do.onKeyDown())),this._register(this.onBeforeInput(()=>Do.onBeforeInput())),this._register(this.onInput(()=>Do.onInput())),this._register(this.onKeyUp(()=>Do.onKeyUp())),this._register(oe(this._actual,Rb.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new Wt(this._actual,"keydown")).event;onKeyPress=this._register(new Wt(this._actual,"keypress")).event;onKeyUp=this._register(new Wt(this._actual,"keyup")).event;onCompositionStart=this._register(new Wt(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new Wt(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new Wt(this._actual,"compositionend")).event;onBeforeInput=this._register(new Wt(this._actual,"beforeinput")).event;onInput=this._register(new Wt(this._actual,"input")).event;onCut=this._register(new Wt(this._actual,"cut")).event;onCopy=this._register(new Wt(this._actual,"copy")).event;onPaste=this._register(new Wt(this._actual,"paste")).event;onFocus=this._register(new Wt(this._actual,"focus")).event;onBlur=this._register(new Wt(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new L);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=Is(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?La()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,n){let i=this._actual;i.value!==n&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=n)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,n,i){let o=this._actual,s=null,a=Is(o);a?s=a.activeElement:s=La();let l=_e(s),d=s===o,u=o.selectionStart,c=o.selectionEnd;if(d&&u===n&&c===i){Xt&&l.parent!==l&&o.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),o.setSelectionRange(n,i),Xt&&l.parent!==l&&o.focus();return}try{let p=WL(o);this.setIgnoreSelectionChangeTime("setSelectionRange"),o.focus(),o.setSelectionRange(n,i),BL(o,p)}catch{}}};var Ix=class extends eu{_lastPointerType;constructor(e,t,n){super(e,t,n),this._register(Qr.addTarget(this.viewHelper.linesContentDomNode)),this._register(oe(this.viewHelper.linesContentDomNode,Et.Tap,o=>this.onTap(o))),this._register(oe(this.viewHelper.linesContentDomNode,Et.Change,o=>this.onChange(o))),this._register(oe(this.viewHelper.linesContentDomNode,Et.Contextmenu,o=>this._onContextMenu(new zi(o,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(oe(this.viewHelper.linesContentDomNode,"pointerdown",o=>{let s=o.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let i=new Wf(this.viewHelper.viewDomNode);this._register(i.onPointerMove(this.viewHelper.viewDomNode,o=>this._onMouseMove(o))),this._register(i.onPointerUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(o,s)=>this._onMouseDown(o,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let n=this._createMouseTarget(new zi(e,!1,this.viewHelper.viewDomNode),!1);n.position&&this.viewController.dispatchMouse({position:n.position,mouseColumn:n.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:n.type===6&&n.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},Cx=class extends eu{constructor(e,t,n){super(e,t,n),this._register(Qr.addTarget(this.viewHelper.linesContentDomNode)),this._register(oe(this.viewHelper.linesContentDomNode,Et.Tap,i=>this.onTap(i))),this._register(oe(this.viewHelper.linesContentDomNode,Et.Change,i=>this.onChange(i))),this._register(oe(this.viewHelper.linesContentDomNode,Et.Contextmenu,i=>this._onContextMenu(new zi(i,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new zi(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let n=document.createEvent("CustomEvent");n.initEvent(Rb.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(n),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},Db=class extends B{handler;constructor(e,t,n){super(),(Yp||$E&&zE)&&b_.pointerEvents?this.handler=this._register(new Ix(e,t,n)):xt.TouchEvent?this.handler=this._register(new Cx(e,t,n)):this.handler=this._register(new eu(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var Tn=class extends Vi{};var Pb=class extends tt{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new Ad({createLine:()=>new Sx(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let n=this._context.configuration.options.get(51);wt(this.domNode,n),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let n=this._context.configuration.options.get(51);return wt(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(n=>n.shouldRender());for(let n=0,i=t.length;n<i;n++){let o=t[n];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},Sx=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=pe(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,n,i,o){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,o.appendString('<div style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(n)),o.appendString('px;">'),o.appendString(s),o.appendString("</div>"),!0)}layoutLine(e,t,n){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(n))}},Mb=class extends Pb{_contentWidth;constructor(e){super(e);let n=this._context.configuration.options.get(147);this._contentWidth=n.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._contentWidth=n.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},Ob=class extends Pb{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),wt(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;wt(this.domNode,t.get(51));let n=t.get(147);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var Nb=class extends tt{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=pe(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,n=this._context.configuration.options.get(147),i=n.contentWidth-n.verticalScrollbarWidth;this.contentWidth!==i&&(this.contentWidth=i,e=!0);let o=n.contentLeft;return this.contentLeft!==o&&(this.contentLeft=o,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,n=e.getDecorationsInViewport();for(let i of n){if(!i.options.blockClassName)continue;let o=this.blocks[t];o||(o=this.blocks[t]=pe(document.createElement("div")),this.domNode.appendChild(o));let s,a;i.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!0),a=i.range.isEmpty()&&!i.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0));let[l,d,u,c]=i.options.blockPadding??[0,0,0,0];o.setClassName("blockDecorations-block "+i.options.blockClassName),o.setLeft(this.contentLeft-c),o.setWidth(this.contentWidth+c+d),o.setTop(s-e.scrollTop-l),o.setHeight(a-s+l+u),t++}for(let i=t;i<this.blocks.length;i++)this.blocks[i].domNode.remove();this.blocks.length=t}};var Ab=class extends tt{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=pe(document.createElement("div")),Bt.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=pe(document.createElement("div")),Bt.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new xx(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n,i,o){this._widgets[e.getId()].setPosition(t,n,i,o),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t];delete this._widgets[t];let i=n.domNode.domNode;i.remove(),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].render(e)}},xx=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new $a(null,null);_secondaryAnchor=new $a(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=pe(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let i=this._context.configuration.options,o=i.get(147);this._fixedOverflowWidgets=i.get(43),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._lineHeight=i.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let n=t.get(147);this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,n){this._affinity=e,this._primaryAnchor=i(t,this._context.viewModel,this._affinity),this._secondaryAnchor=i(n,this._context.viewModel,this._affinity);function i(o,s,a){if(!o)return new $a(null,null);let l=s.model.validatePosition(o);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new $a(o,d)}return new $a(o,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,n,i){this._setPosition(i,e,t),this._preference=n,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,n,i){let o=e.top,s=o,a=e.top+e.height,l=i.viewportHeight-a,d=o-n,u=s>=n,c=a,p=l>=n,h=e.left;return h+t>i.scrollLeft+i.viewportWidth&&(h=i.scrollLeft+i.viewportWidth-t),h<i.scrollLeft&&(h=i.scrollLeft),{fitsAbove:u,aboveTop:d,fitsBelow:p,belowTop:c,left:h}}_layoutHorizontalSegmentInPage(e,t,n,i){let a=Math.max(15,t.left-i),l=Math.min(t.left+t.width+i,e.width-15),u=this._viewDomNode.domNode.ownerDocument.defaultView,c=t.left+n-(u?.scrollX??0);if(c+i>l){let p=c-(l-i);c-=p,n-=p}if(c<a){let p=c-a;c-=p,n-=p}return[n,c]}_layoutBoxInPage(e,t,n,i){let o=e.top-n,s=e.top+e.height,a=gr(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,u=a.top+o-(d?.scrollY??0),c=a.top+s-(d?.scrollY??0),p=k_(l.body),[h,g]=this._layoutHorizontalSegmentInPage(p,a,e.left-i.scrollLeft+this._contentLeft,t),f=22,v=22,y=u>=f,I=c+n<=p.height-v;return this._fixedOverflowWidgets?{fitsAbove:y,aboveTop:Math.max(u,f),fitsBelow:I,belowTop:c,left:g}:{fitsAbove:y,aboveTop:o,fitsBelow:I,belowTop:s,left:h}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new Ya(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=o(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),n=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,i=o(n,this._affinity,this._lineHeight);return{primary:t,secondary:i};function o(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let u=s.column===1&&a===3?0:d.left,c=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new Fb(c,u,l)}}_reduceAnchorCoordinates(e,t,n){if(!t)return e;let i=this._context.configuration.options.get(51),o=t.left;return o<e.left?o=Math.max(o,e.left-n+i.typicalFullwidthCharacterWidth):o=Math.min(o,e.left+n-i.typicalFullwidthCharacterWidth),new Fb(e.top,o,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:n}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=_x(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let i=this._reduceAnchorCoordinates(t,n,this._cachedDomNodeOffsetWidth),o;this.allowEditorOverflow?o=this._layoutBoxInPage(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):o=this._layoutBoxInViewport(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!o)return null;if(s===2||o.fitsAbove)return{kind:"inViewport",coordinate:new Ya(o.aboveTop,o.left),position:1}}else if(a===2){if(!o)return null;if(s===2||o.fitsBelow)return{kind:"inViewport",coordinate:new Ya(o.belowTop,o.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new Ya(i.top,i.left)),position:0}:{kind:"inViewport",coordinate:new Ya(i.top,i.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&_x(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&_x(this._actual.afterRender,this._actual,this._renderData.position)}},$a=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},Ya=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},Fb=class{constructor(e,t,n){this.top=e;this.left=t;this.height=n}_anchorCoordinateBrand=void 0};function _x(r,e,...t){try{return r.call(e,...t)}catch{return null}}var Wb=class extends Tn{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,n=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new ye(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let o of this._selections)t.add(o.positionLineNumber);let n=Array.from(t);n.sort((o,s)=>o-s),Pn(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);let i=this._selections.every(o=>o.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=[];for(let s=t;s<=n;s++){let a=s-t;i[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new w(a,1)).lineNumber,u=l.convertModelPositionToViewPosition(new w(d,1)).lineNumber,c=l.convertModelPositionToViewPosition(new w(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,p=Math.max(u,t),h=Math.min(c,n);for(let g=p;g<=h;g++){let f=g-t;i[f]=s}}}let o=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>n)continue;let a=s-t;i[a]=o}this._renderData=i}render(e,t){if(!this._renderData)return"";let n=t-e;return n>=this._renderData.length?"":this._renderData[n]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},Bb=class extends Wb{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},Vb=class extends Wb{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};xn((r,e)=>{let t=r.getColor(lS);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||r.defines(dS)){let n=r.getColor(dS);n&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${n}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${n}; }`),ns(r.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var Ub=class extends Tn{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let l=0,d=t.length;l<d;l++){let u=t[l];u.options.className&&(n[i++]=u)}n=n.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let u=l.options.className,c=d.options.className;return u<c?-1:u>c?1:_.compareRangesUsingStarts(l.range,d.range)});let o=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=o;l<=s;l++){let d=l-o;a[d]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,n){let i=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',u=Math.max(l.range.startLineNumber,i),c=Math.min(l.range.endLineNumber,o);for(let p=u;p<=c;p++){let h=p-i;n[h]+=d}}}_renderNormalDecorations(e,t,n){let i=e.visibleRange.startLineNumber,o=null,s=!1,a=null,l=!1;for(let d=0,u=t.length;d<u;d++){let c=t[d];if(c.options.isWholeLine)continue;let p=c.options.className,h=!!c.options.showIfCollapsed,g=c.range;if(h&&g.endColumn===1&&g.endLineNumber!==g.startLineNumber&&(g=new _(g.startLineNumber,g.startColumn,g.endLineNumber-1,this._context.viewModel.getLineMaxColumn(g.endLineNumber-1))),o===p&&s===h&&_.areIntersectingOrTouching(a,g)){a=_.plusRange(a,g);continue}o!==null&&this._renderNormalDecoration(e,a,o,l,s,i,n),o=p,s=h,a=g,l=c.options.shouldFillLineOnLineBreak??!1}o!==null&&this._renderNormalDecoration(e,a,o,l,s,i,n)}_renderNormalDecoration(e,t,n,i,o,s,a){let l=e.linesVisibleRangesForRange(t,n==="findMatch");if(l)for(let d=0,u=l.length;d<u;d++){let c=l[d];if(c.outsideRenderedLine)continue;let p=c.lineNumber-s;if(o&&c.ranges.length===1){let h=c.ranges[0];if(h.width<this._typicalHalfwidthCharacterWidth){let g=Math.round(h.left+h.width/2),f=Math.max(0,Math.round(g-this._typicalHalfwidthCharacterWidth/2));c.ranges[0]=new Nd(f,this._typicalHalfwidthCharacterWidth)}}for(let h=0,g=c.ranges.length;h<g;h++){let f=i&&c.continuesOnNextLine&&g===1,v=c.ranges[h],y='<div class="cdr '+n+'" style="left:'+String(v.left)+"px;width:"+(f?"100%;":String(v.width)+"px;")+'"></div>';a[p]+=y}}}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};var Hb=class extends tt{scrollbar;scrollbarDomNode;constructor(e,t,n,i){super(e);let o=this._context.configuration.options,s=o.get(105),a=o.get(76),l=o.get(41),d=o.get(108),u={listenOnDomNode:n.domNode,className:"editor-scrollable "+uc(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new Tb(t.domNode,u,this._context.viewLayout.getScrollable())),Bt.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=pe(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let c=(p,h,g)=>{let f={};if(h){let v=p.scrollTop;v&&(f.scrollTop=this._context.viewLayout.getCurrentScrollTop()+v,p.scrollTop=0)}if(g){let v=p.scrollLeft;v&&(f.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+v,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(f,1)};this._register(oe(n.domNode,"scroll",p=>c(n.domNode,!0,!0))),this._register(oe(t.domNode,"scroll",p=>c(t.domNode,!0,!1))),this._register(oe(i.domNode,"scroll",p=>c(i.domNode,!0,!1))),this._register(oe(this.scrollbarDomNode.domNode,"scroll",p=>c(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,n=t.get(105),i=t.get(76),o=t.get(41),s=t.get(108),a={vertical:n.vertical,horizontal:n.horizontal,verticalScrollbarSize:n.verticalScrollbarSize,horizontalScrollbarSize:n.horizontalScrollbarSize,scrollByPage:n.scrollByPage,handleMouseWheel:n.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:o,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+uc(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var Qa=class{constructor(e,t,n,i,o){this.startLineNumber=e;this.endLineNumber=t;this.className=n;this.tooltip=i;this.zIndex=o??0}_decorationToRenderBrand=void 0;zIndex},Ex=class{constructor(e,t,n){this.className=e;this.zIndex=t;this.tooltip=n}},wx=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},iu=class extends Tn{_render(e,t,n){let i=[];for(let a=e;a<=t;a++){let l=a-e;i[l]=new wx}if(n.length===0)return i;n.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let o=null,s=0;for(let a=0,l=n.length;a<l;a++){let d=n[a],u=d.className,c=d.zIndex,p=Math.max(d.startLineNumber,e)-e,h=Math.min(d.endLineNumber,t)-e;o===u?(p=Math.max(s+1,p),s=Math.max(s,h)):(o=u,s=h);for(let g=p;g<=s;g++)i[g].add(new Ex(u,c,d.tooltip))}return i}},zb=class extends tt{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,n=t.get(147);this.domNode=pe(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=pe(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let n=this._widgets[e.getId()];return n.preference.lane===t.lane&&n.preference.zIndex===t.zIndex&&_.equalsRange(n.preference.range,t.range)?!1:(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,o=e.getDecorationsInViewport();for(let s of o){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,n),d=Math.min(s.range.endLineNumber,i),u=s.options.glyphMargin?.position??2,c=s.options.zIndex??0;for(let p=l;p<=d;p++){let h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new w(p,0)),g=this._context.viewModel.glyphLanes.getLanesAtLine(h.lineNumber).indexOf(u);t.push(new Tx(p,g,c,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let o of Object.values(this._widgets)){let s=o.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(_.lift(s));if(!a||!l||l<n||a>i)continue;let d=Math.max(a,n),u=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new w(d,0)),c=this._context.viewModel.glyphLanes.getLanesAtLine(u.lineNumber).indexOf(o.preference.lane);t.push(new Lx(d,c,o.preference.zIndex,o))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((n,i)=>n.lineNumber===i.lineNumber?n.laneIndex===i.laneIndex?n.zIndex===i.zIndex?i.type===n.type?n.type===0&&i.type===0?n.className<i.className?-1:1:0:i.type-n.type:i.zIndex-n.zIndex:n.laneIndex-i.laneIndex:n.lineNumber-i.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let i of Object.values(this._widgets))i.renderInfo=null;let t=new Rn(this._collectSortedGlyphRenderRequests(e)),n=[];for(;t.length>0;){let i=t.peek();if(!i)break;let o=t.takeWhile(a=>a.lineNumber===i.lineNumber&&a.laneIndex===i.laneIndex);if(!o||o.length===0)break;let s=o[0];if(s.type===0){let a=[];for(let l of o){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}n.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=n}render(e){if(!this._glyphMargin){for(let n of Object.values(this._widgets))n.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let n of Object.values(this._widgets))if(!n.renderInfo)n.domNode.setDisplay("none");else{let i=e.viewportData.relativeVerticalOffset[n.renderInfo.lineNumber-e.viewportData.startLineNumber],o=this._glyphMarginLeft+n.renderInfo.laneIndex*this._lineHeight;n.domNode.setDisplay("block"),n.domNode.setTop(i),n.domNode.setLeft(o),n.domNode.setWidth(t),n.domNode.setHeight(this._lineHeight)}for(let n=0;n<this._decorationGlyphsToRender.length;n++){let i=this._decorationGlyphsToRender[n],o=e.viewportData.relativeVerticalOffset[i.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.laneIndex*this._lineHeight,a;n<this._managedDomNodes.length?a=this._managedDomNodes[n]:(a=pe(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+i.combinedClassName),a.setPosition("absolute"),a.setTop(o),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var Tx=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.className=i}type=0;accept(e){return new kx(this.lineNumber,this.laneIndex,e)}},Lx=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.widget=i}type=1},kx=class{constructor(e,t,n){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=n}};var Kb=class extends Tn{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,n=t.get(148),i=t.get(51);this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(148),i=t.get(51);return this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let n=e.selections[0].getPosition();return this._primaryPosition?.equals(n)?!1:(this._primaryPosition=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=e.scrollWidth,o=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(n+1,this._context.viewModel.getLineCount()),o),a=[];for(let l=t;l<=n;l++){let d=l-t,u=s[d],c="",p=e.visibleRangeForPosition(new w(l,1))?.left??0;for(let h of u){let g=h.column===-1?p+(h.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new w(l,h.column)).left;if(g>i||this._maxIndentLeft>0&&g>this._maxIndentLeft)break;let f=h.horizontalLine?h.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",v=h.horizontalLine?(e.visibleRangeForPosition(new w(l,h.horizontalLine.endColumn))?.left??g+this._spaceWidth)-g:this._spaceWidth;c+=`<div class="core-guide ${h.className} ${f}" style="left:${g}px;width:${v}px"></div>`}a[d]=c}this._renderResult=a}getGuidesByLine(e,t,n){let i=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,n,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&n){let c=this._context.viewModel.getActiveIndentGuide(n.lineNumber,e,t);s=c.startLineNumber,a=c.endLineNumber,l=c.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),u=[];for(let c=e;c<=t;c++){let p=new Array;u.push(p);let h=i?i[c-e]:[],g=new Rn(h),f=o?o[c-e]:0;for(let v=1;v<=f;v++){let y=(v-1)*d+1,I=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||h.length===0)&&s<=c&&c<=a&&v===l;p.push(...g.takeWhile(x=>x.visibleColumn<y)||[]);let S=g.peek();(!S||S.visibleColumn!==y||S.horizontalLine)&&p.push(new Ai(y,-1,`core-guide-indent lvl-${(v-1)%30}`+(I?" indent-active":""),null,-1,-1))}p.push(...g.takeWhile(v=>!0)||[])}return u}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};function ru(r){if(!(r&&r.isTransparent()))return r}xn((r,e)=>{let t=[{bracketColor:Cg,guideColor:S0,guideColorActive:L0},{bracketColor:Sg,guideColor:_0,guideColorActive:k0},{bracketColor:_g,guideColor:x0,guideColorActive:R0},{bracketColor:xg,guideColor:E0,guideColorActive:D0},{bracketColor:Eg,guideColor:w0,guideColorActive:P0},{bracketColor:wg,guideColor:T0,guideColorActive:M0}],n=new Ac,i=[{indentColor:o0,indentColorActive:c0},{indentColor:s0,indentColorActive:p0},{indentColor:a0,indentColorActive:h0},{indentColor:l0,indentColorActive:m0},{indentColor:d0,indentColorActive:g0},{indentColor:u0,indentColorActive:f0}],o=t.map(a=>{let l=r.getColor(a.bracketColor),d=r.getColor(a.guideColor),u=r.getColor(a.guideColorActive),c=ru(ru(d)??l?.transparent(.3)),p=ru(ru(u)??l);if(!(!c||!p))return{guideColor:c,guideColorActive:p}}).filter(Ly),s=i.map(a=>{let l=r.getColor(a.indentColor),d=r.getColor(a.indentColorActive),u=ru(l),c=ru(d);if(!(!u||!c))return{indentColor:u,indentColorActive:c}}).filter(Ly);if(o.length>0){for(let a=0;a<30;a++){let l=o[a%o.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${n.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${n.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${n.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var ou=class r extends Tn{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new w(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let n=e.get(147);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new w(e,1));if(t.column!==1)return"";let n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(this._renderLineNumbers===2){let i=Math.abs(this._lastCursorModelPosition.lineNumber-n);return i===0?'<span class="relative-current-line-number">'+n+"</span>":String(i)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===n||n%10===0)return String(n);let i=this._context.viewModel.getLineCount();return n===i?String(n):""}return String(n)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=pt?this._lineHeight%2===0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,o=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);o.sort((d,u)=>_.compareRangesUsingEnds(d.range,u.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=n;d<=i;d++){let u=d-n,c=this._getLineRenderLineNumber(d),p="";for(;s<o.length&&o[s].range.endLineNumber<d;)s++;for(let h=s;h<o.length;h++){let{range:g,options:f}=o[h];g.startLineNumber<=d&&(p+=" "+f.lineNumberClassName)}if(!c&&!p){l[u]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(c=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeLineNumber&&(p+=" active-line-number"),l[u]=`<div class="${r.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${c}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};xn((r,e)=>{let t=r.getColor(r0),n=r.getColor(b0);n?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${n}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var Rx=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new _(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},Dx=class{constructor(e,t,n,i,o,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=n;this.endColumn=i;this.startScrollTop=o;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},Px=class{constructor(e,t,n,i,o){this.minimalReveal=e;this.selections=t;this.startScrollTop=n;this.stopScrollTop=i;this.scrollType=o;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let u=t[l];s=Math.min(s,u.startLineNumber),a=Math.max(a,u.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},Gb=class r extends tt{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let n=this._context.configuration,i=this._context.configuration.options,o=i.get(51),s=i.get(148);this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(102),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._viewLineOptions=new yp(n,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Ad({createLine:()=>new yr(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Bt.write(this.domNode,8),this.domNode.setClassName(`view-lines ${Mo}`),wt(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new dn(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new dn(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new Rx,this._horizontalRevealRequest=null,this._stickyScrollEnabled=i.get(117).enabled,this._maxNumberStickyLines=i.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,n=t.get(51),i=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,wt(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new yp(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let o=n;o<=i;o++)this._visibleLines.getVisibleLine(o).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=!1;for(let o=t;o<=n;o++)i=this._visibleLines.getVisibleLine(o).onSelectionChanged()||i;return i}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new Dx(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new Px(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let o=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(n,o),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let n=this._getViewLineDomNode(e);if(n===null)return null;let i=this._getLineNumberFor(n);if(i===-1||i<1||i>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(i)===1)return new w(i,1);let o=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(i<o||i>s)return null;let a=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(i);return a<l&&(a=l),new w(i,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===yr.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){let o=this._visibleLines.getVisibleLine(i);if(e===o.getDomNode())return i}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();if(e<t||e>n)return-1;let i=new Fd(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getWidth(i);return this._updateLineWidthsSlowIfDomDidLayout(i),o}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let n=e.endLineNumber,i=_.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let o=[],s=0,a=new Fd(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new w(i.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),u=this._visibleLines.getEndLineNumber();for(let c=i.startLineNumber;c<=i.endLineNumber;c++){if(c<d||c>u)continue;let p=c===i.startLineNumber?i.startColumn:1,h=c!==i.endLineNumber,g=h?this._context.viewModel.getLineMaxColumn(c):i.endColumn,f=this._visibleLines.getVisibleLine(c).getVisibleRangesForRange(c,p,g,a);if(f){if(t&&c<n){let v=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new w(c+1,1)).lineNumber,v!==l&&(f.ranges[f.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}o[s++]=new Kf(f.outsideRenderedLine,c,Nd.from(f.ranges),h)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:o}_visibleRangesForLineRange(e,t,n){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let i=new Fd(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,n,i);return this._updateLineWidthsSlowIfDomDidLayout(i),o}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new Gf(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=1,o=!0;for(let s=t;s<=n;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){o=!1;continue}i=Math.max(i,a.getWidth(null))}return o&&t===1&&n===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),o}_checkMonospaceFontAssumptions(){let e=-1,t=-1,n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let o=n;o<=i;o++){let s=this._visibleLines.getVisibleLine(o);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=o)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let o=n;o<=i;o++)this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let n=this._horizontalRevealRequest;if(e.startLineNumber<=n.minLineNumber&&n.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let i=this._computeScrollLeftToReveal(n);i&&(this._isViewportWrapping||this._ensureMaxLineWidth(i.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:i.scrollLeft},n.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),pt&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let o=n;o<=i;o++)if(this._visibleLines.getVisibleLine(o).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,o,s){let a=e.top,l=e.height,d=a+l,u,c,p;if(o&&o.length>0){let y=o[0].startLineNumber,I=o[0].endLineNumber;for(let S=1,x=o.length;S<x;S++){let T=o[S];y=Math.min(y,T.startLineNumber),I=Math.max(I,T.endLineNumber)}u=!1,c=this._context.viewLayout.getVerticalOffsetForLineNumber(y),p=this._context.viewLayout.getVerticalOffsetForLineNumber(I)+this._lineHeight}else if(i)u=!0,c=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),p=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;let h=(t==="mouse"||n)&&this._cursorSurroundingLinesStyle==="default",g=0,f=0;if(h)n||(g=this._lineHeight);else{let y=l/this._lineHeight,I=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),S=Math.min(y/2,I);g=S*this._lineHeight,f=Math.max(0,S-1)*this._lineHeight}n||(s===0||s===4)&&(f+=this._lineHeight),c-=g,p+=f;let v;if(p-c>l){if(!u)return-1;v=c}else if(s===5||s===6)if(s===6&&a<=c&&p<=d)v=a;else{let y=Math.max(5*this._lineHeight,l*.2),I=c-y,S=p-l;v=Math.max(S,I)}else if(s===1||s===2)if(s===2&&a<=c&&p<=d)v=a;else{let y=(c+p)/2;v=Math.max(0,y-l/2)}else v=this._computeMinimumScrolling(a,d,c,p,s===3,s===4);return v}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),n=this._context.configuration.options.get(147),i=t.left,o=i+t.width-n.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let u of d.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let u=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!u)return null;for(let c of u.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}return e.minimalReveal||(s=Math.max(0,s-r.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,o,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,n,i,o,s){e=e|0,t=t|0,n=n|0,i=i|0,o=!!o,s=!!s;let a=t-e;if(i-n<a){if(o)return n;if(s)return Math.max(0,i-a);if(n<e)return n;if(i>t)return Math.max(0,i-a)}else return n;return e}};var jb=class extends iu{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let n=this._context.configuration.options.get(147);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(n[i++]=new Qa(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let u=a.options.firstLineDecorationClassName;u&&(n[i++]=new Qa(a.range.startLineNumber,a.range.startLineNumber,u,a.options.linesDecorationsTooltip??null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),o=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+o+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=n;d++){let u=d-t,c=i[u].getDecorations(),p="";for(let h of c){let g='<div class="cldr '+h.className;h.tooltip!==null&&(g+='" title="'+h.tooltip),g+=a,p+=g}l[u]=p}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var su=class r extends tt{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=pe(document.createElement("div")),this._domNode.setClassName(r.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=pe(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(r.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}};var qb=class extends iu{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let o=0,s=t.length;o<s;o++){let a=t[o],l=a.options.marginClassName,d=a.options.zIndex;l&&(n[i++]=new Qa(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),o=[];for(let s=t;s<=n;s++){let a=s-t,l=i[a].getDecorations(),d="";for(let u of l)d+='<div class="cmdr '+u.className+'" style=""></div>';o[a]=d}this._renderResult=o}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Cr=class r{_rgba8Brand=void 0;static Empty=new r(0,0,0,0);r;g;b;a;constructor(e,t,n,i){this.r=r._clamp(e),this.g=r._clamp(t),this.b=r._clamp(n),this.a=r._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var Tk=(()=>{let r=[];for(let e=32;e<=126;e++)r.push(e);return r.push(65533),r})(),Lk=(r,e)=>(r-=32,r<0||r>96?e<=2?(r+96)%96:95:r);var Dp=class r{constructor(e,t){this.scale=t;this.charDataNormal=r.soften(e,12/15),this.charDataLight=r.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,o=e.length;i<o;i++)n[i]=Us(e[i]*t);return n}renderChar(e,t,n,i,o,s,a,l,d,u,c){let p=1*this.scale,h=2*this.scale,g=c?1:h;if(t+p>e.width||n+g>e.height){console.warn("bad render request outside image data");return}let f=u?this.charDataLight:this.charDataNormal,v=Lk(i,d),y=e.width*4,I=a.r,S=a.g,x=a.b,T=o.r-I,R=o.g-S,P=o.b-x,O=Math.max(s,l),k=e.data,F=v*p*h,W=n*y+t*4;for(let H=0;H<g;H++){let $=W;for(let ee=0;ee<p;ee++){let K=f[F++]/255*(s/255);k[$++]=I+T*K,k[$++]=S+R*K,k[$++]=x+P*K,k[$++]=O}W+=y}}blockRenderChar(e,t,n,i,o,s,a,l){let d=1*this.scale,u=2*this.scale,c=l?1:u;if(t+d>e.width||n+c>e.height){console.warn("bad render request outside image data");return}let p=e.width*4,h=.5*(o/255),g=s.r,f=s.g,v=s.b,y=i.r-g,I=i.g-f,S=i.b-v,x=g+y*h,T=f+I*h,R=v+S*h,P=Math.max(o,a),O=e.data,k=n*p+t*4;for(let F=0;F<c;F++){let W=k;for(let H=0;H<d;H++)O[W++]=x,O[W++]=T,O[W++]=R,O[W++]=P;k+=p}}};var au=class r extends B{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=Ko(new r)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new L;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(ai.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=ai.getColorMap();if(!e){this._colors=[Cr.Empty],this._backgroundIsLight=!0;return}this._colors=[Cr.Empty];for(let n=1;n<e.length;n++){let i=e[n].rgba;this._colors[n]=new Cr(i.r,i.g,i.b,Math.round(i.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var Rk={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},Dk=r=>{let e=new Uint8ClampedArray(r.length/2);for(let t=0;t<r.length;t+=2)e[t>>1]=Rk[r[t]]<<4|Rk[r[t+1]]&15;return e},Mx={1:zo(()=>Dk("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:zo(()=>Dk("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var $b=class r{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return Mx[e]?n=new Dp(Mx[e](),e):n=r.createFromSampleData(r.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(let o of Tk)n.fillText(String.fromCharCode(o),i,16/2),i+=10;return n.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let n=16*10*4*96;if(e.length!==n)throw new Error("Unexpected source in MinimapCharRenderer");let i=r._downsample(e,t);return new Dp(i,t)}static _downsampleChar(e,t,n,i,o){let s=1*o,a=2*o,l=i,d=0;for(let u=0;u<a;u++){let c=u/a*16,p=(u+1)/a*16;for(let h=0;h<s;h++){let g=h/s*10,f=(h+1)/s*10,v=0,y=0;for(let S=c;S<p;S++){let x=t+Math.floor(S)*3840,T=1-(S-Math.floor(S));for(let R=g;R<f;R++){let P=1-(R-Math.floor(R)),O=x+Math.floor(R)*4,k=P*T;y+=k,v+=e[O]*e[O+3]/255*k}}let I=v/y;d=Math.max(d,I),n[l++]=Us(I)}}return d}static _downsample(e,t){let n=2*t*1*t,i=n*96,o=new Uint8ClampedArray(i),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,o,s,t)),s+=n,a+=10*4;if(l>0){let d=255/l;for(let u=0;u<i;u++)o[u]*=d}return o}};var Pk=Fe?'"Segoe WPC", "Segoe UI", sans-serif':Me?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var cA=140,pA=2,Yb=class r{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,n){let i=e.options,o=i.get(145),s=i.get(147),a=s.minimap,l=i.get(51),d=i.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(107),this.paddingTop=i.get(85).top,this.paddingBottom=i.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=Pk,this.sectionHeaderFontSize=d.sectionHeaderFontSize*o,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=r._getSectionHeaderColor(t,n.getColor(1)),this.charRenderer=zo(()=>$b.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=n.getColor(2),this.backgroundColor=r._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=r._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let n=e.getColor(a1);return n?new Cr(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(l1);return t?Cr._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let n=e.getColor(XT);return n?new Cr(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},Ox=class r{constructor(e,t,n,i,o,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=n;this._computedSliderRatio=i;this.sliderTop=o;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumber,e.endLineNumber);return t>n?null:[t,n]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,n,i,o,s,a,l,d,u,c){let p=e.pixelRatio,h=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/h),f=e.lineHeight;if(e.minimapHeightIsEditorHeight){let R=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(R+=Math.max(0,o-e.lineHeight-e.paddingBottom));let P=Math.max(1,Math.floor(o*o/R)),O=Math.max(0,e.minimapHeight-P),k=O/(u-o),F=d*k,W=O>0,H=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),$=Math.floor(e.paddingTop/e.lineHeight);return new r(d,u,W,k,F,P,$,1,Math.min(a,H))}let v;if(s&&n!==a){let R=n-t+1;v=Math.floor(R*h/p)}else{let R=o/f;v=Math.floor(R*h/p)}let y=Math.floor(e.paddingTop/f),I=Math.floor(e.paddingBottom/f);if(e.scrollBeyondLastLine){let R=o/f;I=Math.max(I,R-1)}let S;if(I>0){let R=o/f;S=(y+a+I-R-1)*h/p}else S=Math.max(0,(y+a)*h/p-v);S=Math.min(e.minimapHeight-v,S);let x=S/(u-o),T=d*x;if(g>=y+a+I){let R=S>0;return new r(d,u,R,x,T,v,y,1,a)}else{let R;t>1?R=t+y:R=Math.max(1,d/f);let P,O=Math.max(1,Math.floor(R-T*p/h));O<y?(P=y-O+1,O=1):(P=0,O=Math.max(1,O-y)),c&&c.scrollHeight===u&&(c.scrollTop>d&&(O=Math.min(O,c.startLineNumber),P=Math.max(P,c.topPaddingLineCount)),c.scrollTop<d&&(O=Math.max(O,c.startLineNumber),P=Math.min(P,c.topPaddingLineCount)));let k=Math.min(a,O-P+g-1),F=(d-i)/f,W;return d>=e.paddingTop?W=(t-O+P+F)*h/p:W=d/e.paddingTop*(P+F)*h/p,new r(d,u,!0,x,W,v,P,O,k)}}},Qb=class r{static INVALID=new r(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},Zb=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new gp({createLine:()=>Qb.INVALID}),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;let n=this._renderedLines._get().lines;for(let i=0,o=n.length;i<o;i++)if(n[i].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},Nx=class r{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,n,i){this._backgroundFillData=r._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){let i=n.r,o=n.g,s=n.b,a=n.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let u=0;u<t;u++)for(let c=0;c<e;c++)l[d]=i,l[d+1]=o,l[d+2]=s,l[d+3]=a,d+=4;return l}},Xb=class r{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,n){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:i}=bc.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),o=t/i,s=o/2;if(!n||n.minimapLines.length===0){let v=[];if(v[0]=1,i>1){for(let y=0,I=i-1;y<I;y++)v[y]=Math.round(y*o+s);v[i-1]=t}return[new r(o,v),[]]}let a=n.minimapLines,l=a.length,d=[],u=0,c=0,p=1,h=10,g=[],f=null;for(let v=0;v<i;v++){let y=Math.max(p,Math.round(v*o)),I=Math.max(y,Math.round((v+1)*o));for(;u<l&&a[u]<y;){if(g.length<h){let x=u+1+c;f&&f.type==="deleted"&&f._oldIndex===u-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:u,deleteFromLineNumber:x,deleteToLineNumber:x},g.push(f)),c--}u++}let S;if(u<l&&a[u]<=I)S=a[u],u++;else if(v===0?S=1:v+1===i?S=t:S=Math.round(v*o+s),g.length<h){let x=u+1+c;f&&f.type==="inserted"&&f._i===v-1?f.insertToLineNumber++:(f={type:"inserted",_i:v,insertFromLineNumber:x,insertToLineNumber:x},g.push(f)),c++}d[v]=S,p=S}if(g.length<h)for(;u<l;){let v=u+1+c;f&&f.type==="deleted"&&f._oldIndex===u-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:u,deleteFromLineNumber:v,deleteToLineNumber:v},g.push(f)),c--,u++}else g=[{type:"flush"}];return[new r(o,d),g]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){let o=this.minimapLines[n];if(o<e||o>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,n=this.minimapLines.length,i=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<e.fromLineNumber);o--)this.minimapLines[o]<=e.toLineNumber?(this.minimapLines[o]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,o),i=Math.max(i,o)):this.minimapLines[o]-=t;return[n,i]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}},Jb=class extends tt{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new ki(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=au.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Yb(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=Xb.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new Ax(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new Yb(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let n of e.ranges){let i=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);i&&t.push({fromLineNumber:i[0],toLineNumber:i[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));let i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,n]=Xb.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let o=0,s=t-e+1;o<s;o++)n[o]?i[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+o-1]):i[o]=null;return i}return this._context.viewModel.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new ye(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n=this._getMinimapDecorationsInViewport(e,t).filter(i=>!i.options.minimap?.sectionHeaderStyle);if(this._samplingState){let i=[];for(let o of n){if(!o.options.minimap)continue;let s=o.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);i.push(new Pd(new _(a,s.startColumn,l,s.endColumn),o.options))}return i}return n}getSectionHeaderDecorationsInViewport(e,t){let n=this.options.minimapLineHeight,o=this.options.sectionHeaderFontSize/n;return e=Math.floor(Math.max(1,e-o)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){let i=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];n=new _(i,1,o,this._context.viewModel.getLineMaxColumn(o))}else n=new _(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(n)}getSectionHeaderText(e,t){let n=e.options.minimap?.sectionHeaderText;if(!n)return null;let i=this._sectionHeaderCache.get(n);if(i)return i;let o=t(n);return this._sectionHeaderCache.set(n,o),o}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new _(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},Ax=class r extends B{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(EI),this._domNode=pe(document.createElement("div")),Bt.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=pe(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=pe(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=pe(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=pe(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=pe(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=To(this._domNode.domNode,De.POINTER_DOWN,n=>{if(n.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(n.button===0&&this._lastRenderData){let d=gr(this._slider.domNode),u=d.top+d.height/2;this._startSliderDragging(n,u,this._lastRenderData.renderedLayout)}return}let o=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*n.offsetY,l=Math.floor(s/o)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new Jr,this._sliderPointerDownListener=To(this._slider.domNode,De.POINTER_DOWN,n=>{n.preventDefault(),n.stopPropagation(),n.button===0&&this._lastRenderData&&this._startSliderDragging(n,n.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Qr.addTarget(this._domNode.domNode),this._sliderTouchStartListener=oe(this._domNode.domNode,Et.Start,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(n))},{passive:!1}),this._sliderTouchMoveListener=oe(this._domNode.domNode,Et.Change,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(n)},{passive:!1}),this._sliderTouchEndListener=To(this._domNode.domNode,Et.End,n=>{n.preventDefault(),n.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,n){if(!e.target||!(e.target instanceof Element))return;let i=e.pageX;this._slider.toggleClassName("active",!0);let o=(s,a)=>{let l=gr(this._domNode.domNode),d=Math.min(Math.abs(a-i),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(Fe&&d>cA){this._model.setScrollTop(n.scrollTop);return}let u=s-t;this._model.setScrollTop(n.getDesiredScrollTopFromDelta(u))};e.pageY!==t&&o(e.pageY,i),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>o(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new Nx(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(EI),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let n=Ox.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(n.sliderNeeded?"block":"none"),this._slider.setTop(n.sliderTop),this._slider.setHeight(n.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(n.sliderHeight),this.renderDecorations(n),this._lastRenderData=this.renderLines(n)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(_.compareRangesUsingStarts);let n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);n.sort((p,h)=>(p.options.zIndex||0)-(h.options.zIndex||0));let{canvasInnerWidth:i,canvasInnerHeight:o}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,i,o);let u=new ev(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,u,e,s),this._renderDecorationsLineHighlights(d,n,u,e,s);let c=new ev(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,c,e,s,l,a,i),this._renderDecorationsHighlights(d,n,c,e,s,l,a,i),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,n,i,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=i.intersectWithViewport(l);if(!d)continue;let[u,c]=d;for(let g=u;g<=c;g++)n.set(g,!0);let p=i.getYForLineNumber(u,o),h=i.getYForLineNumber(c,o);a>=p||(a>s&&e.fillRect(rr,s,e.canvas.width,a-s),s=p),a=h}a>s&&e.fillRect(rr,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,n,i,o){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let u=i.intersectWithViewport(l.range);if(!u)continue;let[c,p]=u,h=d.getColor(this._theme.value);if(!h||h.isTransparent())continue;let g=s.get(h.toString());g||(g=h.transparent(.5).toString(),s.set(h.toString(),g)),e.fillStyle=g;for(let f=c;f<=p;f++){if(n.has(f))continue;n.set(f,!0);let v=i.getYForLineNumber(c,o);e.fillRect(rr,v,e.canvas.width,o)}}}_renderSelectionsHighlights(e,t,n,i,o,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let u=i.intersectWithViewport(d);if(!u)continue;let[c,p]=u;for(let h=c;h<=p;h++)this.renderDecorationOnLine(e,n,d,this._selectionColor,i,h,o,o,s,a,l)}}_renderDecorationsHighlights(e,t,n,i,o,s,a,l){for(let d of t){let u=d.options.minimap;if(!u)continue;let c=i.intersectWithViewport(d.range);if(!c)continue;let[p,h]=c,g=u.getColor(this._theme.value);if(!(!g||g.isTransparent()))for(let f=p;f<=h;f++)switch(u.position){case 1:this.renderDecorationOnLine(e,n,d.range,g,i,f,o,o,s,a,l);continue;case 2:{let v=i.getYForLineNumber(f,o);this.renderDecoration(e,g,2,v,pA,o);continue}}}}renderDecorationOnLine(e,t,n,i,o,s,a,l,d,u,c){let p=o.getYForLineNumber(s,l);if(p+a<0||p>this._model.options.canvasInnerHeight)return;let{startLineNumber:h,endLineNumber:g}=n,f=h===s?n.startColumn:1,v=g===s?n.endColumn:this._model.getLineMaxColumn(s),y=this.getXOffsetForPosition(t,s,f,d,u,c),I=this.getXOffsetForPosition(t,s,v,d,u,c);this.renderDecoration(e,i,y,p,I-y,a)}getXOffsetForPosition(e,t,n,i,o,s){if(n===1)return rr;if((n-1)*o>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[rr];let u=rr;for(let c=1;c<d.length+1;c++){let p=d.charCodeAt(c-1),h=p===9?i*o:Ii(p)?2*o:o,g=u+h;if(g>=s){l[c]=s;break}l[c]=g,u=g}e.set(t,l)}return n-1<l.length?l[n-1]:s}renderDecoration(e,t,n,i,o,s){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,o,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,n=this._model.options.sectionHeaderFontSize,i=this._model.options.sectionHeaderLetterSpacing,o=n*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,u=`rgb(${d.r} ${d.g} ${d.b})`,c=u,p=this._decorationsCanvas.domNode.getContext("2d");p.letterSpacing=i+"px",p.font="500 "+n+"px "+this._model.options.sectionHeaderFontFamily,p.strokeStyle=c,p.lineWidth=.2;let h=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);h.sort((f,v)=>f.range.startLineNumber-v.range.startLineNumber);let g=r._fitSectionHeader.bind(null,p,s-rr);for(let f of h){let v=e.getYForLineNumber(f.range.startLineNumber,t)+n,y=v-n,I=y+2,S=this._model.getSectionHeaderText(f,g);r._renderSectionLabel(p,S,f.options.minimap?.sectionHeaderStyle===2,l,u,s,y,o,v,I)}}static _fitSectionHeader(e,t,n){if(!n)return n;let i="\u2026",o=e.measureText(n).width,s=e.measureText(i).width;if(o<=t||o<=s)return n;let a=n.length,l=o/n.length,d=Math.floor((t-s)/l)-1,u=Math.ceil(d/2);for(;u>0&&/\s/.test(n[u-1]);)--u;return n.substring(0,u)+i+n.substring(a-(d-u))}static _renderSectionLabel(e,t,n,i,o,s,a,l,d,u){t&&(e.fillStyle=i,e.fillRect(0,a,s,l),e.fillStyle=o,e.fillText(t,rr,d)),n&&(e.beginPath(),e.moveTo(0,u),e.lineTo(s,u),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let K=this._lastRenderData._get();return new Zb(e,K.imageData,K.lines)}let o=this._getBuffer();if(!o)return null;let[s,a,l]=r._renderUntouchedLines(o,e.topPaddingLineCount,t,n,i,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,n,l),u=this._model.getOptions().tabSize,c=this._model.options.defaultBackgroundColor,p=this._model.options.backgroundColor,h=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,f=g.backgroundIsLight(),v=this._model.options.renderMinimap,y=this._model.options.charRenderer(),I=this._model.options.fontScale,S=this._model.options.minimapCharWidth,T=(v===1?2:3)*I,R=i>T?Math.floor((i-T)/2):0,P=p.a/255,O=new Cr(Math.round((p.r-c.r)*P+c.r),Math.round((p.g-c.g)*P+c.g),Math.round((p.b-c.b)*P+c.b),255),k=e.topPaddingLineCount*i,F=[];for(let K=0,V=n-t+1;K<V;K++)l[K]&&r._renderLine(o,O,p.a,f,v,S,g,h,y,k,R,u,d[K],I,i),F[K]=new Qb(k),k+=i;let W=s===-1?0:s,$=(a===-1?o.height:a)-W;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,W,o.width,$),new Zb(e,o,F)}static _renderUntouchedLines(e,t,n,i,o,s){let a=[];if(!s){for(let k=0,F=i-n+1;k<F;k++)a[k]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,u=l.rendLineNumberStart,c=l.lines,p=c.length,h=e.width,g=e.data,f=(i-n+1)*o*h*4,v=-1,y=-1,I=-1,S=-1,x=-1,T=-1,R=t*o;for(let k=n;k<=i;k++){let F=k-n,W=k-u,H=W>=0&&W<p?c[W].dy:-1;if(H===-1){a[F]=!0,R+=o;continue}let $=H*h*4,ee=(H+o)*h*4,K=R*h*4,V=(R+o)*h*4;S===$&&T===K?(S=ee,T=V):(I!==-1&&(g.set(d.subarray(I,S),x),v===-1&&I===0&&I===x&&(v=S),y===-1&&S===f&&I===x&&(y=I)),I=$,S=ee,x=K,T=V),a[F]=!1,R+=o}I!==-1&&(g.set(d.subarray(I,S),x),v===-1&&I===0&&I===x&&(v=S),y===-1&&S===f&&I===x&&(y=I));let P=v===-1?-1:v/(h*4),O=y===-1?-1:y/(h*4);return[P,O,a]}static _renderLine(e,t,n,i,o,s,a,l,d,u,c,p,h,g,f){let v=h.content,y=h.tokens,I=e.width-s,S=f===1,x=rr,T=0,R=0;for(let P=0,O=y.getCount();P<O;P++){let k=y.getEndOffset(P),F=y.getForeground(P),W=a.getColor(F);for(;T<k;T++){if(x>I)return;let H=v.charCodeAt(T);if(H===9){let $=p-(T+R)%p;R+=$-1,x+=$*s}else if(H===32)x+=s;else{let $=Ii(H)?2:1;for(let ee=0;ee<$;ee++)if(o===2?d.blockRenderChar(e,x,u+c,W,l,t,n,S):d.renderChar(e,x,u+c,H,W,l,t,n,g,i,S),x+=s,x>I)return}}}}},ev=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,n){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=n,this._values=[];for(let i=0,o=this._endLineNumber-this._startLineNumber+1;i<o;i++)this._values[i]=n}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var tv=class extends tt{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let i=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=pe(document.createElement("div")),Bt.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=pe(document.createElement("div")),Bt.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,!0}addWidget(e){let t=pe(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let n=this._widgets[e.getId()],i=t?t.preference:null,o=t?.stackOridinal;return n.preference===i&&n.stack===o?(this._updateMaxMinWidth(),!1):(n.preference=i,n.stack=o,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){let o=t[n],a=this._widgets[o].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let n=e.domNode;if(e.preference===null){n.setTop("");return}let i=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let o=n.domNode.clientHeight;n.setTop(this._editorHeight-o-2*this._horizontalScrollbarHeight)}else n.setTop(0);e.stack!==void 0?(n.setTop(t[e.preference]),t[e.preference]+=n.domNode.clientWidth):n.setRight(i)}else if(e.preference===2)n.domNode.style.right="50%",e.stack!==void 0?(n.setTop(t[2]),t[2]+=n.domNode.clientHeight):n.setTop(0);else{let{top:o,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;n.setTop(o+l.top),n.setLeft(s+l.left),n.setPosition("fixed")}else n.setTop(o),n.setLeft(s),n.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=gr(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),n=Array.from({length:3},()=>0);t.sort((i,o)=>(this._widgets[i].stack||0)-(this._widgets[o].stack||0));for(let i=0,o=t.length;i<o;i++){let s=t[i];this._renderWidget(this._widgets[s],n)}}};var Fx=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let n=e.options;this.lineHeight=n.get(68),this.pixelRatio=n.get(145),this.overviewRulerLanes=n.get(84),this.renderBorder=n.get(83);let i=t.getColor(v0);this.borderColor=i?i.toString():null,this.hideCursor=n.get(60);let o=t.getColor(Ql);this.cursorColorSingle=o?o.transparent(.7).toString():null;let s=t.getColor(vg);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(yg);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=n.get(74),d=l.enabled,u=l.side,c=t.getColor(y0),p=ai.getDefaultBackground();c?this.backgroundColor=c:d&&u==="right"?this.backgroundColor=p:this.backgroundColor=null;let g=n.get(147).overviewRuler;this.top=g.top,this.right=g.right,this.domWidth=g.width,this.domHeight=g.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[f,v]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=f,this.w=v}_initLanes(e,t,n){let i=t-e;if(n>=3){let o=Math.floor(i/3),s=Math.floor(i/3),a=i-o-s,l=e,d=l+o,u=l+o+a;return[[0,l,d,l,u,l,d,l],[0,o,a,o+a,s,o+a+s,a+s,o+a+s]]}else if(n===2){let o=Math.floor(i/2),s=i-o,a=e,l=a+o;return[[0,a,a,a,l,a,a,a],[0,o,o,o,s,o+s,o+s,o+s]]}else{let o=e,s=i;return[[0,o,o,o,o,o,o,o],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&A.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var nv=class extends tt{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=pe(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=ai.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new w(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new Fx(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++){let i=this._settings.cursorColorSingle;n>1&&(i=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:i})}return this._cursorPositions.sort((t,n)=>w.compare(t.position,n.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?A.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Aa.compareByRenderingProps),this._actualShouldRender===1&&!Aa.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!Pn(this._renderedCursorPositions,this._cursorPositions,(g,f)=>g.position.lineNumber===f.position.lineNumber&&g.color===f.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let n=this._settings.canvasWidth,i=this._settings.canvasHeight,o=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=i/a,d=6*this._settings.pixelRatio|0,u=d/2|0,c=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(c.fillStyle=A.Format.CSS.formatHexA(e),c.fillRect(0,0,n,i)):(c.clearRect(0,0,n,i),c.fillStyle=A.Format.CSS.formatHexA(e),c.fillRect(0,0,n,i)):c.clearRect(0,0,n,i);let p=this._settings.x,h=this._settings.w;for(let g of t){let f=g.color,v=g.data;c.fillStyle=f;let y=0,I=0,S=0;for(let x=0,T=v.length/3;x<T;x++){let R=v[3*x],P=v[3*x+1],O=v[3*x+2],k=s.getVerticalOffsetForLineNumber(P)*l|0,F=(s.getVerticalOffsetForLineNumber(O)+o)*l|0;if(F-k<d){let H=(k+F)/2|0;H<u?H=u:H+u>i&&(H=i-u),k=H-u,F=H+u}k>S+1||R!==y?(x!==0&&c.fillRect(p[y],I,h[y],S-I),y=R,I=k,S=F):F>S&&(S=F)}c.fillRect(p[y],I,h[y],S-I)}if(!this._settings.hideCursor){let g=2*this._settings.pixelRatio|0,f=g/2|0,v=this._settings.x[7],y=this._settings.w[7],I=-100,S=-100,x=null;for(let T=0,R=this._cursorPositions.length;T<R;T++){let P=this._cursorPositions[T].color;if(!P)continue;let O=this._cursorPositions[T].position,k=s.getVerticalOffsetForLineNumber(O.lineNumber)*l|0;k<f?k=f:k+f>i&&(k=i-f);let F=k-f,W=F+g;F>S+1||P!==x?(T!==0&&x&&c.fillRect(v,I,y,S-I),I=F,S=W):W>S&&(S=W),x=P,c.fillStyle=P}x&&c.fillRect(v,I,y,S-I)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(c.beginPath(),c.lineWidth=1,c.strokeStyle=this._settings.borderColor,c.moveTo(0,0),c.lineTo(0,i),c.moveTo(1,0),c.lineTo(n,0),c.stroke())}};var iv=class extends Vi{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let n=this._context.configuration.options;this._domNode=pe(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new Nf(i=>this._context.viewLayout.getVerticalOffsetForLineNumber(i)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(68)),this._zoneManager.setPixelRatio(n.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(o,n,i,e),!0}_renderOneLane(e,t,n,i){let o=0,s=0,a=0;for(let l of t){let d=l.colorId,u=l.from,c=l.to;d!==o?(e.fillRect(0,s,i,a-s),o=d,e.fillStyle=n[o],s=u,a=c):a>=u?a=Math.max(a,c):(e.fillRect(0,s,i,a-s),s=u,a=c)}e.fillRect(0,s,i,a-s)}};var rv=class extends tt{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=pe(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:i}=this._context.viewModel.model.getOptions(),o=i,s=t-e;for(;s>0;){let a=pe(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(o),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let n=e-t;for(;n>0;){let i=this._renderedRulers.pop();this.domNode.removeChild(i),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){let i=this._renderedRulers[t],o=this._rulers[t];i.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}};var ov=class extends tt{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let n=this._context.configuration.options.get(105);this._useShadows=n.useShadows,this._domNode=pe(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let n=this._context.configuration.options.get(105);return this._useShadows=n.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var Wx=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},Bx=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function hA(r){return new Wx(r)}function mA(r){return new Bx(r.lineNumber,r.ranges.map(hA))}var av=class r extends Tn{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,n){let i=this._typicalHalfwidthCharacterWidth/4,o=null,s=null;if(n&&n.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!o&&d<n.length;d++)n[d].lineNumber===a&&(o=n[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=n.length-1;!s&&d>=0;d--)n[d].lineNumber===l&&(s=n[d].ranges[0]);o&&!o.startStyle&&(o=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],u=d.left,c=d.left+d.width,p={top:0,bottom:0},h={top:0,bottom:0};if(a>0){let g=t[a-1].ranges[0].left,f=t[a-1].ranges[0].left+t[a-1].ranges[0].width;sv(u-g)<i?p.top=2:u>g&&(p.top=1),sv(c-f)<i?h.top=2:g<c&&c<f&&(h.top=1)}else o&&(p.top=o.startStyle.top,h.top=o.endStyle.top);if(a+1<l){let g=t[a+1].ranges[0].left,f=t[a+1].ranges[0].left+t[a+1].ranges[0].width;sv(u-g)<i?p.bottom=2:g<u&&u<f&&(p.bottom=1),sv(c-f)<i?h.bottom=2:c<f&&(h.bottom=1)}else s&&(p.bottom=s.startStyle.bottom,h.bottom=s.endStyle.bottom);d.startStyle=p,d.endStyle=h}}_getVisibleRangesWithStyle(e,t,n){let o=(t.linesVisibleRangesForRange(e,!0)||[]).map(mA);return!this._visibleRangesHaveGaps(o)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,o,n),o}_createSelectionPiece(e,t,n,i,o){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+i.toString()+"px;width:"+o.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(i.length===0)return;let o=!!i[0].ranges[0].startStyle,s=i[0].lineNumber,a=i[i.length-1].lineNumber;for(let l=0,d=i.length;l<d;l++){let u=i[l],c=u.lineNumber,p=c-t,h=n&&c===s?1:0,g=n&&c!==s&&c===a?1:0,f="",v="";for(let y=0,I=u.ranges.length;y<I;y++){let S=u.ranges[y];if(o){let T=S.startStyle,R=S.endStyle;if(T.top===1||T.bottom===1){f+=this._createSelectionPiece(h,g,r.SELECTION_CLASS_NAME,S.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH);let P=r.EDITOR_BACKGROUND_CLASS_NAME;T.top===1&&(P+=" "+r.SELECTION_TOP_RIGHT),T.bottom===1&&(P+=" "+r.SELECTION_BOTTOM_RIGHT),f+=this._createSelectionPiece(h,g,P,S.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH)}if(R.top===1||R.bottom===1){f+=this._createSelectionPiece(h,g,r.SELECTION_CLASS_NAME,S.left+S.width,r.ROUNDED_PIECE_WIDTH);let P=r.EDITOR_BACKGROUND_CLASS_NAME;R.top===1&&(P+=" "+r.SELECTION_TOP_LEFT),R.bottom===1&&(P+=" "+r.SELECTION_BOTTOM_LEFT),f+=this._createSelectionPiece(h,g,P,S.left+S.width,r.ROUNDED_PIECE_WIDTH)}}let x=r.SELECTION_CLASS_NAME;if(o){let T=S.startStyle,R=S.endStyle;T.top===0&&(x+=" "+r.SELECTION_TOP_LEFT),T.bottom===0&&(x+=" "+r.SELECTION_BOTTOM_LEFT),R.top===0&&(x+=" "+r.SELECTION_TOP_RIGHT),R.bottom===0&&(x+=" "+r.SELECTION_BOTTOM_RIGHT)}v+=this._createSelectionPiece(h,g,x,S.left,S.width)}e[p][0]+=f,e[p][1]+=v}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let s=n;s<=i;s++){let a=s-n;t[a]=["",""]}let o=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){o[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);o[s]=d,this._actualRenderOneSelection(t,n,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};xn((r,e)=>{let t=r.getColor(t1);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function sv(r){return r<0?-r:r}var lv=class r extends tt{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new Ip(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=pe(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Zi,this._cursorFlatBlinkInterval=new _d,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,n){let i=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&n!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let o=t.length-this._secondaryCursors.length;for(let s=0;s<o;s++){let a=new Ip(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let o=this._secondaryCursors.length-t.length;for(let s=0;s<o;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let o=0;o<t.length;o++)this._secondaryCursors[o].onCursorPositionChanged(t[o],i)}onCursorStateChanged(e){let t=[];for(let i=0,o=e.selections.length;i<o;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=n=>{for(let i=0,o=e.ranges.length;i<o;i++)if(e.ranges[i].fromLineNumber<=n.lineNumber&&n.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,n=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!n&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},r.BLINK_INTERVAL,_e(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},r.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0,i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let o=0,s=this._secondaryCursors.length;o<s;o++){let a=this._secondaryCursors[o].render(e);a&&(t[n++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};xn((r,e)=>{let t=[{class:".cursor",foreground:Ql,background:bg},{class:".cursor-primary",foreground:vg,background:n0},{class:".cursor-secondary",foreground:yg,background:i0}];for(let n of t){let i=r.getColor(n.foreground);if(i){let o=r.getColor(n.background);o||(o=i.opposite()),e.addRule(`.monaco-editor .cursors-layer ${n.class} { background-color: ${i}; border-color: ${i}; color: ${o}; }`),ns(r.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${n.class} { border-left: 1px solid ${o}; border-right: 1px solid ${o}; }`)}}});var Vx=()=>{throw new Error("Invalid change accessor")},dv=class extends tt{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=pe(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=pe(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let i of e)t.set(i.id,i);let n=!1;return this._context.viewModel.changeWhitespace(i=>{let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],u=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=u.isInHiddenArea;let c=t.get(l);c&&(c.afterLineNumber!==u.afterViewLineNumber||c.height!==u.heightInPx)&&(i.changeOneWhitespace(l,u.afterViewLineNumber,u.heightInPx),this._safeCallOnComputedHeight(d.delegate,u.heightInPx),n=!0)}}),n}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new w(s,this._context.viewModel.model.getLineMaxColumn(s))}let n;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let i=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),o=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(n);return{isInHiddenArea:!o,afterViewLineNumber:i.lineNumber,heightInPx:o?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(n=>{let i={addZone:o=>(t=!0,this._addZone(n,o)),removeZone:o=>{o&&(t=this._removeZone(n,o)||t)},layoutZone:o=>{o&&(t=this._layoutZone(n,o)||t)}};gA(e,i),i.addZone=Vx,i.removeZone=Vx,i.layoutZone=Vx}),t}_addZone(e,t){let n=this._computeWhitespaceProps(t),o={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isInHiddenArea:n.isInHiddenArea,isVisible:!1,domNode:pe(t.domNode),marginDomNode:t.marginDomNode?pe(t.marginDomNode):null};return this._safeCallOnComputedHeight(o.delegate,n.heightInPx),o.domNode.setPosition("absolute"),o.domNode.domNode.style.width="100%",o.domNode.setDisplay("none"),o.domNode.setAttribute("monaco-view-zone",o.whitespaceId),this.domNode.appendChild(o.domNode),o.marginDomNode&&(o.marginDomNode.setPosition("absolute"),o.marginDomNode.domNode.style.width="100%",o.marginDomNode.setDisplay("none"),o.marginDomNode.setAttribute("monaco-view-zone",o.whitespaceId),this.marginDomNode.appendChild(o.marginDomNode)),this._zones[o.whitespaceId]=o,this.setShouldRender(),o.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.remove(),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return n.isInHiddenArea=i.isInHiddenArea,e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(n){Le(n)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(n){Le(n)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,n={},i=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(n[s.id]=s,i=!0);let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],u=0,c=0,p="none";n.hasOwnProperty(l)?(u=n[l].verticalOffset-e.bigNumbersDelta,c=n[l].height,p="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(n[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(u),d.domNode.setHeight(c),d.domNode.setDisplay(p),d.marginDomNode&&(d.marginDomNode.setTop(u),d.marginDomNode.setHeight(c),d.marginDomNode.setDisplay(p))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function gA(r,e){try{return r(e)}catch(t){Le(t)}}var uv=class extends Tn{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new cv(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new cv(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber-t+1,o=new Array(i);for(let a=0;a<i;a++)o[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,o);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],u=null;if(this._options.renderWhitespace==="selection"){let c=this._selection;for(let p of c){if(p.endLineNumber<a||p.startLineNumber>a)continue;let h=p.startLineNumber===a?p.startColumn:d.minColumn,g=p.endLineNumber===a?p.endColumn:d.maxColumn;h<g&&(u||(u=[]),u.push(new Wd(h-1,g-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,u,d)}}_applyRenderWhitespace(e,t,n,i){if(this._options.renderWhitespace==="selection"&&!n||this._options.renderWhitespace==="trailing"&&i.continuesWithWrappedLine)return"";let o=this._context.theme.getColor(Ig),s=this._options.renderWithSVG,a=i.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=i.continuesWithWrappedLine,u=i.minColumn-1,c=this._options.renderWhitespace==="boundary",p=this._options.renderWhitespace==="trailing",h=this._options.lineHeight,g=this._options.middotWidth,f=this._options.wsmiddotWidth,v=this._options.spaceWidth,y=Math.abs(f-v),I=Math.abs(g-v),S=y<I?11825:183,x=this._options.canUseHalfwidthRightwardsArrow,T="",R=!1,P=gt(a),O;P===-1?(R=!0,P=l,O=l):O=yi(a);let k=0,F=n&&n[k],W=0;for(let H=u;H<l;H++){let $=a.charCodeAt(H);if(F&&H>=F.endOffset&&(k++,F=n&&n[k]),$!==9&&$!==32||p&&!R&&H<=O)continue;if(c&&H>=P&&H<=O&&$===32){let K=H-1>=0?a.charCodeAt(H-1):0,V=H+1<l?a.charCodeAt(H+1):0;if(K!==32&&V!==32)continue}if(c&&d&&H===l-1){let K=H-1>=0?a.charCodeAt(H-1):0;if($===32&&K!==32&&K!==9)continue}if(n&&(!F||F.startOffset>H||F.endOffset<=H))continue;let ee=e.visibleRangeForPosition(new w(t,H+1));ee&&(s?(W=Math.max(W,ee.left),$===9?T+=this._renderArrow(h,v,ee.left):T+=`<circle cx="${(ee.left+v/2).toFixed(2)}" cy="${(h/2).toFixed(2)}" r="${(v/7).toFixed(2)}" />`):$===9?T+=`<div class="mwh" style="left:${ee.left}px;height:${h}px;">${x?"\uFFEB":"\u2192"}</div>`:T+=`<div class="mwh" style="left:${ee.left}px;height:${h}px;">${String.fromCharCode(S)}</div>`)}return s?(W=Math.round(W+v),`<svg style="bottom:0;position:absolute;width:${W}px;height:${h}px" viewBox="0 0 ${W} ${h}" xmlns="http://www.w3.org/2000/svg" fill="${o}">`+T+"</svg>"):T}_renderArrow(e,t,n){let i=t/7,o=t,s=e/2,a=n,l={x:0,y:i/2},d={x:100/125*o,y:l.y},u={x:d.x-.2*d.x,y:d.y+.2*d.x},c={x:u.x+.1*d.x,y:u.y+.1*d.x},p={x:c.x+.35*d.x,y:c.y-.35*d.x},h={x:p.x,y:-p.y},g={x:c.x,y:-c.y},f={x:u.x,y:-u.y},v={x:d.x,y:-d.y},y={x:l.x,y:-l.y};return`<path d="M ${[l,d,u,c,p,h,g,f,v,y].map(x=>`${(a+x.x).toFixed(2)} ${(s+x.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}},cv=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,n=t.get(51),i=t.get(39);i==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):i==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var lu=class extends tt{};var Ux=class{_onDidChange=new L;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},Hx=new Ux;var Kx=class{constructor(e,t,n,i,o){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=n;this.widthOfHiddenLineTextBefore=i;this.distanceToModelLineEnd=o}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new w(this.modelLineNumber,this.distanceToModelLineStart+1),n=new w(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},zx=Xt,du=class extends lu{constructor(t,n,i,o,s){super(t);this._keybindingService=o;this._instantiationService=s;this._viewController=n,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new ye(1,1,1,1)],this._modelSelections=[new ye(1,1,1,1)],this._lastRenderPosition=null,this.textArea=pe(document.createElement("textarea")),Bt.write(this.textArea,7),this.textArea.setClassName(`inputarea ${Mo}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",kp(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",m("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=pe(document.createElement("div")),this.textAreaCover.setPosition("absolute");let u={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:h=>this._context.viewModel.getLineMaxColumn(h),getValueInRange:(h,g)=>this._context.viewModel.getValueInRange(h,g),getValueLengthInRange:(h,g)=>this._context.viewModel.getValueLengthInRange(h,g),modifyPosition:(h,g)=>this._context.viewModel.modifyPosition(h,g)},c={getDataToCopy:()=>Lb(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let g=this._selections[0];if(Me&&g.isEmpty()){let v=g.getStartPosition(),y=this._getWordBeforePosition(v);if(y.length===0&&(y=this._getCharacterBeforePosition(v)),y.length>0)return new Ht(y,y.length,y.length,_.fromPositions(v),0)}if(Me&&!g.isEmpty()&&u.getValueLengthInRange(g,0)<500){let v=u.getValueInRange(g,0);return new Ht(v,0,v.length,g,0)}if(_i&&!g.isEmpty()){let v="vscode-placeholder";return new Ht(v,0,v.length,null,void 0)}return Ht.EMPTY}if(f_){let g=this._selections[0];if(g.isEmpty()){let f=g.getStartPosition(),[v,y]=this._getAndroidWordAtPosition(f);if(v.length>0)return new Ht(v,y,y,_.fromPositions(f),0)}return Ht.EMPTY}let h=tu.fromEditorSelection(u,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return Ht.fromScreenReaderContentState(h)},deduceModelPosition:(h,g,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(h,g,f)},p=this._register(new kb(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(nu,c,p,Tr,{isAndroid:f_,isChrome:vs,isFirefox:Xt,isSafari:_i})),this._register(this._textAreaInput.onKeyDown(h=>{this._viewController.emitKeyDown(h)})),this._register(this._textAreaInput.onKeyUp(h=>{this._viewController.emitKeyUp(h)})),this._register(this._textAreaInput.onPaste(h=>{let g=!1,f=null,v=null;h.metadata&&(g=this._emptySelectionClipboard&&!!h.metadata.isFromEmptySelection,f=typeof h.metadata.multicursorText<"u"?h.metadata.multicursorText:null,v=h.metadata.mode),this._viewController.paste(h.text,g,f,v)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(h=>{h.replacePrevCharCnt||h.replaceNextCharCnt||h.positionDelta?(qn&&console.log(` => compositionType: <<${h.text}>>, ${h.replacePrevCharCnt}, ${h.replaceNextCharCnt}, ${h.positionDelta}`),this._viewController.compositionType(h.text,h.replacePrevCharCnt,h.replaceNextCharCnt,h.positionDelta)):(qn&&console.log(` => type: <<${h.text}>>`),this._viewController.type(h.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(h=>{this._viewController.setSelection(h)})),this._register(this._textAreaInput.onCompositionStart(h=>{let g=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:v,widthOfHiddenTextBefore:y}=(()=>{let S=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),x=S.lastIndexOf(`
`),T=S.substring(x+1),R=T.lastIndexOf("	"),P=T.length-R-1,O=f.getStartPosition(),k=Math.min(O.column-1,P),F=O.column-1-k,W=T.substring(0,T.length-k),{tabSize:H}=this._context.viewModel.model.getOptions(),$=fA(this.textArea.domNode.ownerDocument,W,this._fontInfo,H);return{distanceToModelLineStart:F,widthOfHiddenTextBefore:$}})(),{distanceToModelLineEnd:I}=(()=>{let S=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),x=S.indexOf(`
`),T=x===-1?S:S.substring(0,x),R=T.indexOf("	"),P=R===-1?T.length:T.length-R-1,O=f.getEndPosition(),k=Math.min(this._context.viewModel.model.getLineMaxColumn(O.lineNumber)-O.column,P);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(O.lineNumber)-O.column-k}})();this._context.viewModel.revealRange("keyboard",!0,_.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new Kx(this._context,f.startLineNumber,v,y,I),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${Mo} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(h=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${Mo}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(Hx.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let n='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(t.lineNumber),o=Wr(n,[]),s=!0,a=t.column,l=!0,d=t.column,u=0;for(;u<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let c=i.charCodeAt(a-2);o.get(c)!==0?s=!1:a--}if(l&&d>i.length&&(l=!1),l){let c=i.charCodeAt(d-1);o.get(c)!==0?l=!1:d++}u++}return[i.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let n=this._context.viewModel.getLineContent(t.lineNumber),i=Wr(this._context.configuration.options.get(133),[]),o=t.column,s=0;for(;o>1;){let a=n.charCodeAt(o-2);if(i.get(a)!==0||s>50)return n.substring(o-1,t.column-1);s++,o--}return n.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!lt(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let n=t.get(3);this._accessibilitySupport===2&&n===Ar.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=n;let o=t.get(147).wrappingColumn;if(o!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(o*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=zx?0:1}onConfigurationChanged(t){let n=this._context.configuration.options,i=n.get(147);this._setAccessibilityOptions(n),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=n.get(51),this._lineHeight=n.get(68),this._emptySelectionClipboard=n.get(38),this._copyWithSyntaxHighlighting=n.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:o}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${o*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",kp(n,this._keybindingService)),this.textArea.setAttribute("aria-required",n.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(n.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!Hx.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new w(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new w(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let i=this._visibleTextArea.visibleTextareaStart,o=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&i&&o&&o.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=Rp(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),u=this._visibleTextArea.widthOfHiddenLineTextBefore,c=this._contentLeft+i.left-this._scrollLeft,p=o.left-i.left+1;if(c<this._contentLeft){let I=this._contentLeft-c;c+=I,u+=I,p-=I}p>this._contentWidth&&(p=this._contentWidth);let h=this._context.viewModel.getViewLineData(s.lineNumber),g=h.tokens.findTokenIndexAtOffset(s.column-1),f=h.tokens.findTokenIndexAtOffset(a.column-1),v=g===f,y=this._visibleTextArea.definePresentation(v?h.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=u,this._doRender({lastRenderPosition:null,top:l,left:c,width:p,height:this._lineHeight,useCover:!1,color:(ai.getColorMap()||[])[y.foreground],italic:y.italic,bold:y.bold,underline:y.underline,strikethrough:y.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(n<0||n>this._contentHeight){this._renderAtTopLeft();return}if(Me||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??Rp(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:zx?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:zx?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let n=this.textArea,i=this.textAreaCover;wt(n,this._fontInfo),n.setTop(t.top),n.setLeft(t.left),n.setWidth(t.width),n.setHeight(t.height),n.setColor(t.color?A.Format.CSS.formatHex(t.color):""),n.setFontStyle(t.italic?"italic":""),t.bold&&n.setFontWeight("bold"),n.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);let o=this._context.configuration.options;o.get(58)?i.setClassName("monaco-editor-background textAreaCover "+su.OUTER_CLASS_NAME):o.get(69).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+ou.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};du=ne([M(3,fs),M(4,St)],du);function fA(r,e,t,n){if(e.length===0)return 0;let i=r.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";let o=r.createElement("span");wt(o,t),o.style.whiteSpace="pre",o.style.tabSize=`${n*t.spaceWidth}px`,o.append(e),i.appendChild(o),r.body.appendChild(i);let s=o.offsetWidth;return i.remove(),s}var Mk=G("clipboardService");var pv=class extends B{constructor(t,n){super();this._domNode=t;this._onFocusChange=n;this._register(oe(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(oe(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function uu(r,e,t,n){return r.addEventListener(e,t,n),{dispose(){r.removeEventListener(e,t)}}}var cu=class{constructor(e,t,n){this._domNode=e;this._context=t;this._keybindingService=n;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new ye(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",kp(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,n=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*n}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new ye(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;wt(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),n=this._context.viewLayout.getCurrentScrollTop(),i=t-n;this._domNode.setTop(i),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let o=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=Rp(o);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:n=>this._context.viewModel.getLineMaxColumn(n),getValueInRange:(n,i)=>this._context.viewModel.getValueInRange(n,i),getValueLengthInRange:(n,i)=>this._context.viewModel.getValueLengthInRange(n,i),modifyPosition:(n,i)=>this._context.viewModel.modifyPosition(n,i)};return tu.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let i=Yr().document.getSelection();if(!i)return;let o=this._domNode.domNode.firstChild;if(!o)return;let s=Yr().document.activeElement,a=new globalThis.Range;a.setStart(o,e),a.setEnd(o,t),i.removeAllRanges(),i.addRange(a),Ta(s)&&s.focus()}};cu=ne([M(2,fs)],cu);var pu=class extends lu{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new ye(1,1,1,1);_textStartPositionWithinEditor=new w(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,n,i){super(e),this.domNode=new ka(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new pv(this.domNode.domNode,o=>this._context.viewModel.setHasFocus(o))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=n.createInstance(cu,this.domNode,e),this._register(oe(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(i))),this._register(oe(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(i),t.cut()})),this._register(oe(this.domNode.domNode,"keyup",o=>t.emitKeyUp(new xi(o)))),this._register(oe(this.domNode.domNode,"keydown",async o=>{let s=new xi(o);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register(uu(this._editContext,"textformatupdate",o=>this._handleTextFormatUpdate(o))),this._register(uu(this._editContext,"characterboundsupdate",o=>this._updateCharacterBounds())),this._register(uu(this._editContext,"textupdate",o=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=_.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,o),this._screenReaderSupport.writeScreenReaderContent()})),this._register(uu(this._editContext,"compositionstart",o=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=_.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(uu(this._editContext,"compositionend",o=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new ye(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let n=this._context.viewModel.model,i=n.getOffsetAt(this._textStartPositionWithinEditor),o=n.getOffsetAt(this._primarySelection.getEndPosition()),s=n.getOffsetAt(this._primarySelection.getStartPosition()),a=o-i,l=s-i,d=0,u=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(u=l-t.updateRangeStart);let c="";l<t.updateRangeStart&&(c+=this._editContext.text.substring(l,t.updateRangeStart)),c+=t.text,a>t.updateRangeEnd&&(c+=this._editContext.text.substring(t.updateRangeEnd,a));let p={text:c,replacePrevCharCnt:u,replaceNextCharCnt:d,positionDelta:0};this._onType(e,p);let h=l-u+c.length;this._updateCursorStatesAfterType(h,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,n){let i=t-e,o=n-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let u=d.lineNumber,c=d.column;return new ye(u,c+i,u,c+o)}).map(d=>Ie.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let n=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),i=new _(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,n),o=this._context.viewModel.model.getValueInRange(i,0),s=i.getStartPosition();return{text:o,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),n=this._textStartPositionWithinEditor,i=[];t.forEach(o=>{let s=this._context.viewModel.model,a=s.getOffsetAt(n),l=s.getPositionAt(a+o.rangeStart),d=s.getPositionAt(a+o.rangeEnd),u=_.fromPositions(l,d),c=["edit-context-format-decoration",`underline-style-${o.underlineStyle.toLowerCase()}`,`underline-thickness-${o.underlineThickness.toLowerCase()}`];i.push({range:u,options:{description:"textFormatDecoration",inlineClassName:c.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,i)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),o=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=i.top+o-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=i.left+n,u;if(this._primarySelection.isEmpty()){if(this._renderingContext){let h=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];h.length>0&&(d+=Math.min(...h.map(g=>Math.min(...g.ranges.map(f=>f.left)))))}u=e.get(51).typicalHalfwidthCharacterWidth/2}else u=i.width-n;let c=new DOMRect(d,a,u,l),p=c;this._editContext.updateControlBounds(p),this._editContext.updateSelectionBounds(c)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),o=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(o.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=i.top+s-a,d=[];if(this._renderingContext){let g=this._renderingContext.linesVisibleRangesForRange(o,!0)??[];for(let f of g)for(let v of f.ranges)d.push(new DOMRect(i.left+n+v.left,l,v.width,t))}let u=this._context.viewModel.model,c=u.getOffsetAt(this._textStartPositionWithinEditor),h=u.getOffsetAt(o.getStartPosition())-c;this._editContext.updateCharacterBounds(h,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,n=t.get(38),i=t.get(25),o=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=Lb(this._context.viewModel,o,n,i),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};qa.INSTANCE.set(Xt?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};pu=ne([M(2,St),M(3,Mk)],pu);var hu=class extends Vi{constructor(t,n,i,o,s,a,l){super();this._instantiationService=l;this._selections=[new ye(1,1,1,1)],this._renderAnimationFrame=null;let d=new Sb(n,o,s,t);this._context=new jf(n,i,o),this._context.addEventHandler(this),this._viewParts=[];let u=this._context.configuration.options.get(37);this._editContext=u?this._instantiationService.createInstance(pu,this._context,d):this._instantiationService.createInstance(du,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=pe(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=pe(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=pe(document.createElement("div")),Bt.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new Hb(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new Gb(this._context,this._linesContent),this._viewZones=new dv(this._context),this._viewParts.push(this._viewZones);let c=new nv(this._context);this._viewParts.push(c);let p=new ov(this._context);this._viewParts.push(p);let h=new Mb(this._context);this._viewParts.push(h),h.addDynamicOverlay(new Bb(this._context)),h.addDynamicOverlay(new av(this._context)),h.addDynamicOverlay(new Kb(this._context)),h.addDynamicOverlay(new Ub(this._context)),h.addDynamicOverlay(new uv(this._context));let g=new Ob(this._context);this._viewParts.push(g),g.addDynamicOverlay(new Vb(this._context)),g.addDynamicOverlay(new qb(this._context)),g.addDynamicOverlay(new jb(this._context)),g.addDynamicOverlay(new ou(this._context)),this._glyphMarginWidgets=new zb(this._context),this._viewParts.push(this._glyphMarginWidgets);let f=new su(this._context);f.getDomNode().appendChild(this._viewZones.marginDomNode),f.getDomNode().appendChild(g.getDomNode()),f.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(f),this._contentWidgets=new Ab(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new lv(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new tv(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let v=new rv(this._context);this._viewParts.push(v);let y=new Nb(this._context);this._viewParts.push(y);let I=new Jb(this._context);if(this._viewParts.push(I),c){let S=this._scrollbar.getOverviewRulerLayoutInfo();S.parent.insertBefore(c.getDomNode(),S.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(v.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(f.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(I.getDomNode()),this._overflowGuardContainer.appendChild(y.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new Db(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,n=this._context.viewModel.glyphLanes,i=[],o=0;i=i.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return o=Math.max(o,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return o=Math.max(o,a.endLineNumber),{range:a,lane:s.preference.lane}})),i.sort((s,a)=>_.compareRangesUsingStarts(s.range,a.range)),n.reset(o);for(let s of i)n.push(s.lane,s.range,s.persist);return n}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],n=this._editContext.getLastRenderData();return new eb(t,n)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,n)),visibleRangeForPosition:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new w(t,n))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let n=this._context.configuration.options.get(147);this.domNode.setWidth(n.width),this.domNode.setHeight(n.height),this._overflowGuardContainer.setWidth(n.width),this._overflowGuardContainer.setHeight(n.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+uc(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new Re;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=Gx.INSTANCE.scheduleCoordinatedRendering({window:_e(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new Re;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new Re;return t.renderText()},prepareRender:(n,i)=>{if(this._store.isDisposed)throw new Re;return t.prepareRender(n,i)},render:(n,i)=>{if(this._store.isDisposed)throw new Re;return t.render(n,i)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();Es(()=>t.prepareRenderText());let n=Es(()=>t.renderText());if(n){let[i,o]=n;Es(()=>t.prepareRender(i,o)),Es(()=>t.render(i,o))}}_getViewPartsToRender(){let t=[],n=0;for(let i of this._viewParts)i.shouldRender()&&(t[n++]=i);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}Do.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let n=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(n.startLineNumber,n.endLineNumber,n.centeredLineNumber);let i=new Hf(this._selections,n,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new zf(this._context.viewLayout,i,this._viewLines)]},prepareRender:(t,n)=>{for(let i of t)i.prepareRender(n)},render:(t,n)=>{for(let i of t)i.render(n),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,n){let i=this._context.viewModel.model.validatePosition({lineNumber:t,column:n}),o=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new w(o.lineNumber,o.column));return s?s.left:-1}getTargetAtClientPoint(t,n){let i=this._pointerHandler.getTargetAtClientPoint(t,n);return i?Zd.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new iv(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,n){if(n){this._viewLines.forceShouldRender();for(let i of this._viewParts)i.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let n=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,n)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};hu=ne([M(6,St)],hu);function Es(r){try{return r()}catch(e){return Le(e),null}}var Gx=class r{static INSTANCE=new r;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[n,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,L_(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let n of e)Es(()=>n.prepareRenderText());let t=[];for(let n=0,i=e.length;n<i;n++){let o=e[n];t[n]=Es(()=>o.renderText())}for(let n=0,i=e.length;n<i;n++){let o=e[n],s=t[n];if(!s)continue;let[a,l]=s;Es(()=>o.prepareRender(a,l))}for(let n=0,i=e.length;n<i;n++){let o=e[n],s=t[n];if(!s)continue;let[a,l]=s;Es(()=>o.render(a,l))}}};var vA=qf("domLineBreaksComputer",{createHTML:r=>r}),hv=class r{constructor(e){this.targetWindow=e}static create(e){return new r(new WeakRef(e))}createLineBreaksComputer(e,t,n,i,o){let s=[],a=[];return{addRequest:(l,d,u)=>{s.push(l),a.push(d)},finalize:()=>yA(kr(this.targetWindow.deref()),s,e,t,n,i,o,a)}}};function yA(r,e,t,n,i,o,s,a){function l(k){let F=a[k];if(F){let W=Bn.applyInjectedText(e[k],F),H=F.map(ee=>ee.options),$=F.map(ee=>ee.column-1);return new Lo($,H,[W.length],[],0)}else return null}if(i===-1){let k=[];for(let F=0,W=e.length;F<W;F++)k[F]=l(F);return k}let d=Math.round(i*t.typicalHalfwidthCharacterWidth),u=o===3?2:o===2?1:0,c=Math.round(n*u),p=Math.ceil(t.spaceWidth*c),h=document.createElement("div");wt(h,t);let g=new ua(1e4),f=[],v=[],y=[],I=[],S=[];for(let k=0;k<e.length;k++){let F=Bn.applyInjectedText(e[k],a[k]),W=0,H=0,$=d;if(o!==0)if(W=gt(F),W===-1)W=0;else{for(let Y=0;Y<W;Y++){let j=F.charCodeAt(Y)===9?n-H%n:1;H+=j}let V=Math.ceil(t.spaceWidth*H);V+t.typicalFullwidthCharacterWidth>d?(W=0,H=0):$=d-V}let ee=F.substr(W),K=IA(ee,H,n,$,g,p);f[k]=W,v[k]=H,y[k]=ee,I[k]=K[0],S[k]=K[1]}let x=g.build(),T=vA?.createHTML(x)??x;h.innerHTML=T,h.style.position="absolute",h.style.top="10000",s==="keepAll"?(h.style.wordBreak="keep-all",h.style.overflowWrap="anywhere"):(h.style.wordBreak="inherit",h.style.overflowWrap="break-word"),r.document.body.appendChild(h);let R=document.createRange(),P=Array.prototype.slice.call(h.children,0),O=[];for(let k=0;k<e.length;k++){let F=P[k],W=CA(R,F,y[k],I[k]);if(W===null){O[k]=l(k);continue}let H=f[k],$=v[k]+c,ee=S[k],K=[];for(let U=0,te=W.length;U<te;U++)K[U]=ee[W[U]];if(H!==0)for(let U=0,te=W.length;U<te;U++)W[U]+=H;let V,Y,j=a[k];j?(V=j.map(U=>U.options),Y=j.map(U=>U.column-1)):(V=null,Y=null),O[k]=new Lo(Y,V,W,K,$)}return h.remove(),O}function IA(r,e,t,n,i,o){if(o!==0){let p=String(o);i.appendString('<div style="text-indent: -'),i.appendString(p),i.appendString("px; padding-left: "),i.appendString(p),i.appendString("px; box-sizing: border-box; width:")}else i.appendString('<div style="width:');i.appendString(String(n)),i.appendString('px;">');let s=r.length,a=e,l=0,d=[],u=[],c=0<s?r.charCodeAt(0):0;i.appendString("<span>");for(let p=0;p<s;p++){p!==0&&p%16384===0&&i.appendString("</span><span>"),d[p]=l,u[p]=a;let h=c;c=p+1<s?r.charCodeAt(p+1):0;let g=1,f=1;switch(h){case 9:g=t-a%t,f=g;for(let v=1;v<=g;v++)v<g?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 32:c===32?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Ii(h)&&f++,h<32?i.appendCharCode(9216+h):i.appendCharCode(h)}l+=g,a+=f}return i.appendString("</span>"),d[r.length]=l,u[r.length]=a,i.appendString("</div>"),[d,u]}function CA(r,e,t,n){if(t.length<=1)return null;let i=Array.prototype.slice.call(e.children,0),o=[];try{qx(r,i,n,0,null,t.length-1,null,o)}catch(s){return console.log(s),null}return o.length===0?null:(o.push(t.length),o)}function qx(r,e,t,n,i,o,s,a){if(n===o||(i=i||jx(r,e,t[n],t[n+1]),s=s||jx(r,e,t[o],t[o+1]),Math.abs(i[0].top-s[0].top)<=.1))return;if(n+1===o){a.push(o);return}let l=n+(o-n)/2|0,d=jx(r,e,t[l],t[l+1]);qx(r,e,t,n,i,l,d,a),qx(r,e,t,l,d,o,s,a)}function jx(r,e,t,n){return r.setStart(e[t/16384|0].firstChild,t%16384),r.setEnd(e[n/16384|0].firstChild,n%16384),r.getClientRects()}var mv=class extends B{_editor=null;_instantiationService=null;_instances=this._register(new Lr);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,n){this._editor=e,this._instantiationService=n;for(let i of t){if(this._pending.has(i.id)){Le(new Error(`Cannot have two contributions with the same id ${i.id}`));continue}this._pending.set(i.id,i)}this._instantiateSome(0),this._register(rp(_e(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(rp(_e(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(rp(_e(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,n]of this._instances)typeof n.saveViewState=="function"&&(e[t]=n.saveViewState());return e}restoreViewState(e){for(let[t,n]of this._instances)typeof n.restoreViewState=="function"&&n.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return rp(_e(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let n of t)this._instantiateById(n.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,n]of this._pending)n.instantiation===e&&t.push(n);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let n=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,n),typeof n.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(n){Le(n)}}}};var gv=class{constructor(e,t,n,i,o,s,a){this.id=e;this.label=t;this.alias=n;this.metadata=i;this._precondition=o;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var fv=G("ILanguageFeaturesService");var bv=class r{static create(e){return new r(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new $x(e,t)}createLineBreaksComputer(e,t,n,i,o){let s=[],a=[],l=[];return{addRequest:(d,u,c)=>{s.push(d),a.push(u),l.push(c)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,u=[];for(let c=0,p=s.length;c<p;c++){let h=a[c],g=l[c];g&&!g.injectionOptions&&!h?u[c]=SA(this.classifier,g,s[c],t,n,d,i,o):u[c]=_A(this.classifier,s[c],h,t,n,d,i,o)}return Yx.length=0,Qx.length=0,u}}}};var $x=class extends Wl{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},Yx=[],Qx=[];function SA(r,e,t,n,i,o,s,a){if(i===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",u=e.breakOffsets,c=e.breakOffsetsVisibleColumn,p=Nk(t,n,i,o,s),h=i-p,g=Yx,f=Qx,v=0,y=0,I=0,S=i,x=u.length,T=0;if(T>=0){let R=Math.abs(c[T]-S);for(;T+1<x;){let P=Math.abs(c[T+1]-S);if(P>=R)break;R=P,T++}}for(;T<x;){let R=T<0?0:u[T],P=T<0?0:c[T];y>R&&(R=y,P=I);let O=0,k=0,F=0,W=0;if(P<=S){let $=P,ee=R===0?0:t.charCodeAt(R-1),K=R===0?0:r.get(ee),V=!0;for(let Y=R;Y<l;Y++){let j=Y,U=t.charCodeAt(Y),te,re;if(lt(U)?(Y++,te=0,re=2):(te=r.get(U),re=Pp(U,$,n,o)),j>y&&Zx(ee,K,U,te,d)&&(O=j,k=$),$+=re,$>S){j>y?(F=j,W=$-re):(F=Y+1,W=$),$-k>h&&(O=0),V=!1;break}ee=U,K=te}if(V){v>0&&(g[v]=u[u.length-1],f[v]=c[u.length-1],v++);break}}if(O===0){let $=P,ee=t.charCodeAt(R),K=r.get(ee),V=!1;for(let Y=R-1;Y>=y;Y--){let j=Y+1,U=t.charCodeAt(Y);if(U===9){V=!0;break}let te,re;if(qo(U)?(Y--,te=0,re=2):(te=r.get(U),re=Ii(U)?o:1),$<=S){if(F===0&&(F=j,W=$),$<=S-h)break;if(Zx(U,te,ee,K,d)){O=j,k=$;break}}$-=re,ee=U,K=te}if(O!==0){let Y=h-(W-k);if(Y<=n){let j=t.charCodeAt(F),U;lt(j)?U=2:U=Pp(j,W,n,o),Y-U<0&&(O=0)}}if(V){T--;continue}}if(O===0&&(O=F,k=W),O<=y){let $=t.charCodeAt(y);lt($)?(O=y+2,k=I+2):(O=y+1,k=I+Pp($,I,n,o))}for(y=O,g[v]=O,I=k,f[v]=k,v++,S=k+h;T<0||T<x&&c[T]<k;)T++;let H=Math.abs(c[T]-S);for(;T+1<x;){let $=Math.abs(c[T+1]-S);if($>=H)break;H=$,T++}}return v===0?null:(g.length=v,f.length=v,Yx=e.breakOffsets,Qx=e.breakOffsetsVisibleColumn,e.breakOffsets=g,e.breakOffsetsVisibleColumn=f,e.wrappedTextIndentLength=p,e)}function _A(r,e,t,n,i,o,s,a){let l=Bn.applyInjectedText(e,t),d,u;if(t&&t.length>0?(d=t.map(k=>k.options),u=t.map(k=>k.column-1)):(d=null,u=null),i===-1)return d?new Lo(u,d,[l.length],[],0):null;let c=l.length;if(c<=1)return d?new Lo(u,d,[l.length],[],0):null;let p=a==="keepAll",h=Nk(l,n,i,o,s),g=i-h,f=[],v=[],y=0,I=0,S=0,x=i,T=l.charCodeAt(0),R=r.get(T),P=Pp(T,0,n,o),O=1;lt(T)&&(P+=1,T=l.charCodeAt(1),R=r.get(T),O++);for(let k=O;k<c;k++){let F=k,W=l.charCodeAt(k),H,$;lt(W)?(k++,H=0,$=2):(H=r.get(W),$=Pp(W,P,n,o)),Zx(T,R,W,H,p)&&(I=F,S=P),P+=$,P>x&&((I===0||P-S>g)&&(I=F,S=P-$),f[y]=I,v[y]=S,y++,x=S+g,I=0),T=W,R=H}return y===0&&(!t||t.length===0)?null:(f[y]=c,v[y]=P,new Lo(u,d,f,v,h))}function Pp(r,e,t,n){return r===9?t-e%t:Ii(r)||r<32?n:1}function Ok(r,e){return e-r%e}function Zx(r,e,t,n,i){return t!==32&&(e===2&&n!==2||e!==1&&n===1||!i&&e===3&&n!==2||!i&&n===3&&e!==1)}function Nk(r,e,t,n,i){let o=0;if(i!==0){let s=gt(r);if(s!==-1){for(let l=0;l<s;l++){let d=r.charCodeAt(l)===9?Ok(o,e):1;o+=d}let a=i===3?2:i===2?1:0;for(let l=0;l<a;l++){let d=Ok(o,e);o+=d}o+n>t&&(o=0)}}return o}var Mp=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,n,i){this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}};var Op=class r{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Tt(new _(1,1,1,1),0,0,new w(1,1),0),new Tt(new _(1,1,1,1),0,0,new w(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Ie(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?ye.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):ye.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){let n=t.position,i=t.selectionStart.getStartPosition(),o=t.selectionStart.getEndPosition(),s=e.normalizePosition(n,2),a=this._validatePositionWithCache(e,i,n,s),l=this._validatePositionWithCache(e,o,i,a);return n.equals(s)&&i.equals(a)&&o.equals(l)?t:new Tt(_.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+i.column-a.column,s,t.leftoverVisibleColumns+n.column-s.column)}_setState(e,t,n){if(n&&(n=r._validateViewState(e.viewModel,n)),t){let i=e.model.validateRange(t.selectionStart),o=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new Tt(i,t.selectionStartKind,o,s,a)}else{if(!n)return;let i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),o=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new Tt(i,n.selectionStartKind,n.selectionStartLeftoverVisibleColumns,o,n.leftoverVisibleColumns)}if(n){let i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),o=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new Tt(i,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,o,t.leftoverVisibleColumns)}else{let i=e.coordinatesConverter.convertModelPositionToViewPosition(new w(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),o=e.coordinatesConverter.convertModelPositionToViewPosition(new w(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new _(i.lineNumber,i.column,o.lineNumber,o.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new Tt(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}};var Np=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new Op(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return RE(this.cursors,Rs(e=>e.viewState.position,w.compare)).viewState.position}getBottomMostViewPosition(){return kE(this.cursors,Rs(e=>e.viewState.position,w.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(Ie.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,n=e.length;if(t<n){let i=n-t;for(let o=0;o<i;o++)this._addSecondaryCursor()}else if(t>n){let i=t-n;for(let o=0;o<i;o++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<n;i++)this.cursors[i+1].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Op(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(Rs(n=>n.selection,_.compareRangesUsingStarts));for(let n=0;n<t.length-1;n++){let i=t[n],o=t[n+1],s=i.selection,a=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=i.index<o.index?n:n+1,u=i.index<o.index?n+1:n,c=t[u].index,p=t[d].index,h=t[u].selection,g=t[d].selection;if(!h.equalsSelection(g)){let f=h.plusRange(g),v=h.selectionStartLineNumber===h.startLineNumber&&h.selectionStartColumn===h.startColumn,y=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn,I;c===this.lastAddedCursorIndex?(I=v,this.lastAddedCursorIndex=p):I=y;let S;I?S=new ye(f.startLineNumber,f.startColumn,f.endLineNumber,f.endColumn):S=new ye(f.endLineNumber,f.endColumn,f.startLineNumber,f.startColumn),t[d].selection=S;let x=Ie.fromModelSelection(S);e[p].setState(this.context,x.modelState,x.viewState)}for(let f of t)f.index>c&&f.index--;e.splice(c,1),t.splice(u,1),this._removeSecondaryCursor(c-1),n--}}}};var vv=class extends B{_onEvent=this._register(new L);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++){let i=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(i){this._outgoingEvents[t]=i;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new Xx),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let n of t)n.handleEvents(e)}}},Xx=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var yv=class r{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,n,i){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new r(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},Iv=class r{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new r(this.oldHasFocus,e.hasFocus)}},Cv=class r{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,n,i,o,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=o,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new r(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},Sv=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},_v=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},xv=class r{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,n,i,o,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=o,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n=e.length,i=t.length;if(n!==i)return!1;for(let o=0;o<n;o++)if(!e[o].equalsSelection(t[o]))return!1;return!0}isNoOp(){return r._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new r(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},Ev=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},wv=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},Tv=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},Lv=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},kv=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},Rv=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},Dv=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var Pv=class extends B{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new Mp(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new Np(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=Sn(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new Mp(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let o=!1,s=this.context.cursorConfig.multiCursorLimit;i!==null&&i.length>s&&(i=i.slice(0,s),o=!0);let a=Ap.from(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,a,o)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,n,i,o,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=_.fromPositions(a[0],a[0]),e.emitViewEvent(new Ro(t,n,l,d,i,o,s))}revealPrimary(e,t,n,i,o,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new Ro(t,n,null,l,i,o,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){let o=t[n];e.push({inSelectionMode:!o.isEmpty(),selectionStart:{lineNumber:o.selectionStartLineNumber,column:o.selectionStartColumn},position:{lineNumber:o.positionLineNumber,column:o.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,o=t.length;i<o;i++){let s=t[i],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,u=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(u=s.selectionStart.column),n.push({selectionStartLineNumber:d,selectionStartColumn:u,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,Ie.fromModelSelections(n)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof jl){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let n=t.rawContentChangedEvent;if(this._knownModelVersionId=n.versionId,this._isHandling)return;let i=n.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new Np(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&n.resultingSelection&&n.resultingSelection.length>0){let o=Ie.fromModelSelections(n.resultingSelection);this.setStates(e,"modelChange",n.isUndoing?5:n.isRedoing?6:2,o)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let o=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,Ie.fromModelSelections(o))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,n,i){this.setStates(e,t,i,Ie.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let a=0,l=e.length;a<l;a++)n.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let o=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new Mv(this._model,o,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=Jx.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let o=0;o<e.commands.length;o++){let s=e.commands[o];s instanceof qd&&s.enclosingRange&&s.closeCharacterRange&&(n.push(s.closeCharacterRange),i.push(s.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,o){let s=Ap.from(this._model,this);if(s.equals(i))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new _f(l,a,n)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((d,u)=>!d.modelState.equals(i.cursorState[u].modelState))){let d=i?i.cursorState.map(c=>c.modelState.selection):null,u=i?i.modelVersionId:0;e.emitOutgoingEvent(new xv(d,a,u,s.modelVersionId,t||"keyboard",n,o))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){let o=e[n];if(!o.text||o.text.indexOf(`
`)>=0)return null;let s=o.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,u=o.text.length-s[2].length-1,c=o.text.lastIndexOf(d,u-1);if(c===-1)return null;t.push([c,u])}return t}executeEdits(e,t,n,i){let o=null;t==="snippet"&&(o=this._findAutoClosingPairs(n)),o&&(n[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),n,d=>{if(o)for(let c=0,p=o.length;c<p;c++){let[h,g]=o[c],f=d[c],v=f.range.startLineNumber,y=f.range.startColumn-1+h,I=f.range.startColumn-1+g;s.push(new _(v,I+1,v,I+2)),a.push(new _(v,y+1,v,I+2))}let u=i(d);return u&&(this._isHandling=!0),u});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;let o=Ap.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){Le(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,o,!1)&&this.revealAll(t,n,!1,0,!0,0)}getAutoClosedCharacters(){return Mv.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new tE(this._model,this.getSelections())}endComposition(e,t){let n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Ir.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,n){this._executeEdit(()=>{if(n==="keyboard"){let i=t.length,o=0;for(;o<i;){let s=Au(t,o),a=t.substr(o,s);this._executeEditOperation(Ir.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),o+=s}}else this._executeEditOperation(Ir.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,o,s){if(t.length===0&&n===0&&i===0){if(o!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new ye(d.lineNumber,d.column+o,d.lineNumber,d.column+o)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Ir.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,o))},e,s)}paste(e,t,n,i,o){this._executeEdit(()=>{this._executeEditOperation(Ir.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,o,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(Oo.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Rt(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new Rt(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}},Ap=class r{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new r(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},Mv=class{static getAllAutoClosedCharacters(e){let t=[];for(let n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){let i=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(i&&(t.push(i),i.startLineNumber!==i.endLineNumber))return!1}t.sort(_.compareRangesUsingStarts),e.sort(_.compareRangesUsingStarts);for(let n=0;n<e.length;n++)if(n>=t.length||!t[n].strictContainsRange(e[n]))return!1;return!0}},Jx=class{static executeCommands(e,t,n){let i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(i,n);for(let s=0,a=i.trackedRanges.length;s<a;s++)i.model._setTrackedRange(i.trackedRanges[s],null,0);return o}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let n=this._getEditOperations(e,t);if(n.operations.length===0)return null;let i=n.operations,o=this._getLoserCursorMap(i);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,u=i.length;d<u;d++)o.hasOwnProperty(i[d].identifier.major.toString())||s.push(i[d]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let u=[];for(let h=0;h<e.selectionsBefore.length;h++)u[h]=[];for(let h of d)h.identifier&&u[h.identifier.major].push(h);let c=(h,g)=>h.identifier.minor-g.identifier.minor,p=[];for(let h=0;h<e.selectionsBefore.length;h++)u[h].length>0?(u[h].sort(c),p[h]=t[h].computeCursorState(e.model,{getInverseEditOperations:()=>u[h],getTrackedSelection:g=>{let f=parseInt(g,10),v=e.model._getTrackedRange(e.trackedRanges[f]);return e.trackedRangesDirection[f]===0?new ye(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn):new ye(v.endLineNumber,v.endColumn,v.startLineNumber,v.startColumn)}})):p[h]=e.selectionsBefore[h];return p});a||(a=e.selectionsBefore);let l=[];for(let d in o)o.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,u)=>u-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let o=0,s=t.length;o<s;o++){let a=t[o];if(a){let l=this._getEditOperationsFromCommand(e,o,a);n=n.concat(l.operations),i=i||l.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],o=0,s=(c,p,h=!1)=>{_.isEmpty(c)&&p===""||i.push({identifier:{major:t,minor:o++},range:c,text:p,forceMoveMarkers:h,isAutoWhitespaceEdit:n.insertsAutoWhitespace})},a=!1,u={addEditOperation:s,addTrackedEditOperation:(c,p,h)=>{a=!0,s(c,p,h)},trackSelection:(c,p)=>{let h=ye.liftSelection(c),g;if(h.isEmpty())if(typeof p=="boolean")p?g=2:g=3;else{let y=e.model.getLineMaxColumn(h.startLineNumber);h.startColumn===y?g=2:g=3}else g=1;let f=e.trackedRanges.length,v=e.model._setTrackedRange(null,h,g);return e.trackedRanges[f]=v,e.trackedRangesDirection[f]=h.getDirection(),f.toString()}};try{n.getEditOperations(e.model,u)}catch(c){return Le(c),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((n,i)=>-_.compareRangesUsingEnds(n.range,i.range));let t={};for(let n=1;n<e.length;n++){let i=e[n-1],o=e[n];if(_.getStartPosition(i.range).isBefore(_.getEndPosition(o.range))){let s;i.identifier.major>o.identifier.major?s=i.identifier.major:s=o.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<n&&n--,a--);n>0&&n--}}return t}},eE=class{constructor(e,t,n){this.text=e;this.startSelection=t;this.endSelection=n}},tE=class r{_original;static _capture(e,t){let n=[];for(let i of t){if(i.startLineNumber!==i.endLineNumber)return null;n.push(new eE(e.getLineContent(i.startLineNumber),i.startColumn-1,i.endColumn-1))}return n}constructor(e,t){this._original=r._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let n=r._capture(e,t);if(!n||this._original.length!==n.length)return null;let i=[];for(let o=0,s=this._original.length;o<s;o++)i.push(r._deduceOutcome(this._original[o],n[o]));return i}static _deduceOutcome(e,t){let n=Math.min(e.startSelection,t.startSelection,Ou(e.text,t.text)),i=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,Nu(e.text,t.text)),o=e.text.substring(n,e.text.length-i),s=t.text.substring(n,t.text.length-i);return new Ib(o,e.startSelection-n,e.endSelection-n,s,t.startSelection-n,t.endSelection-n)}};function Ak(r,e,t,n,i,o,s){let a="<div>",l=n,d=0,u=!0;for(let c=0,p=e.getCount();c<p;c++){let h=e.getEndOffset(c);if(h<=n)continue;let g="";for(;l<h&&l<i;l++){let f=r.charCodeAt(l);switch(f){case 9:{let v=o-(l+d)%o;for(d+=v-1;v>0;)s&&u?(g+="&#160;",u=!1):(g+=" ",u=!0),v--;break}case 60:g+="&lt;",u=!1;break;case 62:g+="&gt;",u=!1;break;case 38:g+="&amp;",u=!1;break;case 0:g+="&#00;",u=!1;break;case 65279:case 8232:case 8233:case 133:g+="\uFFFD",u=!1;break;case 13:g+="&#8203",u=!1;break;case 32:s&&u?(g+="&#160;",u=!1):(g+=" ",u=!0);break;default:g+=String.fromCharCode(f),u=!1}}if(a+=`<span style="${e.getInlineStyle(c,t)}">${g}</span>`,h>i||l>=i)break}return a+="</div>",a}var nE=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}},iE=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,n,i,o){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=o,this.prefixSum=0}},Ov=class r{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,n,i){this._instanceId=Eh(++r.INSTANCE_COUNT),this._pendingChanges=new nE,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,o=e.length;for(;i<o;){let s=i+o>>>1;t===e[s].afterLineNumber?n<e[s].ordinal?o=s:i=s+1:t<e[s].afterLineNumber?o=s:i=s+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(i,o,s,a)=>{t=!0,i=i|0,o=o|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new iE(l,i,o,s,a)),l},changeOneWhitespace:(i,o,s)=>{t=!0,o=o|0,s=s|0,this._pendingChanges.change({id:i,newAfterLineNumber:o,newHeight:s})},removeWhitespace:i=>{t=!0,this._pendingChanges.remove({id:i})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of n){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let i=new Set;for(let l of n)i.add(l.id);let o=new Map;for(let l of t)o.set(l.id,l);let s=l=>{let d=[];for(let u of l)if(!i.has(u.id)){if(o.has(u.id)){let c=o.get(u.id);u.afterLineNumber=c.newAfterLineNumber,u.height=c.newHeight}d.push(u)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=r.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){let i=this._findWhitespaceIndex(e);if(i!==-1&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){let o=this._arr[i];this._removeWhitespace(i),o.afterLineNumber=t,this._insertWhitespace(o)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let o=this._arr[n].afterLineNumber;e<=o&&o<=t?this._arr[n].afterLineNumber=e-1:o>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let o=this._arr[n].afterLineNumber;e<=o&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,n=0,i=t.length-1;for(;n<=i;){let s=(i-n|0)/2|0,a=n+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;n=a+1|0}else i=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let n=this._findLastWhitespaceBeforeLineNumber(e)+1;return n<this._arr.length?n:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n;e>1?n=this._lineHeight*(e-1):n=0;let i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return n+i+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n=this._lineHeight*e,i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return n+i+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,n=this._lineHeight,i=1,o=t;for(;i<o;){let s=(i+o)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+n)i=s+1;else{if(e>=a)return s;o=s}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this._lineHeight,i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,o=this.getVerticalOffsetForLineNumber(i)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(i)|0,l=this.getWhitespacesCount()|0,d,u;a===-1?(a=l,u=s+1,d=0):(u=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let c=o,p=c,h=5e5,g=0;o>=h&&(g=Math.floor(o/h)*h,g=Math.floor(g/n)*n,p-=g);let f=[],v=e+(t-e)/2,y=-1;for(let T=i;T<=s;T++){if(y===-1){let R=c,P=c+n;(R<=v&&v<P||R>v)&&(y=T)}for(c+=n,f[T-i]=p,p+=n;u===T;)p+=d,c+=d,a++,a>=l?u=s+1:(u=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(c>=t){s=T;break}}y===-1&&(y=s);let I=this.getVerticalOffsetForLineNumber(s)|0,S=i,x=s;return S<x&&o<e&&S++,S<x&&I+n>t&&x--,{bigNumbersDelta:g,startLineNumber:i,endLineNumber:s,relativeVerticalOffset:f,centeredLineNumber:y,completelyVisibleStartLineNumber:S,completelyVisibleEndLineNumber:x,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),n;t>=1?n=this._lineHeight*t:n=0;let i;return e>0?i=this.getWhitespacesAccumulatedHeight(e-1):i=0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;let i=this.getVerticalOffsetForWhitespaceIndex(n),o=this.getHeightForWhitespaceIndex(n);if(e>=i+o)return-1;for(;t<n;){let s=Math.floor((t+n)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;n=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;let i=this.getHeightForWhitespaceIndex(t),o=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:o,afterLineNumber:s,verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let o=[];for(let s=n;s<=i;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;o.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return o}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var EA=125,Za=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,n,i){e=e|0,t=t|0,n=n|0,i=i|0,e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),i<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},rE=class extends B{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new L);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new Za(0,0,0,0),this._scrollable=this._register(new cc({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new yv(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},Nv=class extends B{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,n){super(),this._configuration=e;let i=this._configuration.options,o=i.get(147),s=i.get(85);this._linesLayout=new Ov(t,i.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new rE(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Za(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?EA:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let n=t.get(85);this._linesLayout.setPadding(n.top,n.bottom)}if(e.hasChanged(147)){let n=t.get(147),i=n.contentWidth,o=n.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new Za(i,s.contentWidth,o,this._getContentHeight(i,o,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let i=this._configuration.options.get(105);return i.horizontal===2||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,n){let i=this._configuration.options,o=this._linesLayout.getLinesTotalHeight();return i.get(107)?o+=Math.max(0,t-i.get(68)-i.get(85).bottom):i.get(105).ignoreHorizontalScrollbarInContentHeight||(o+=this._getHorizontalScrollbarHeight(e,n)),o}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new Za(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new lp(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new lp(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,n=e.get(148),i=e.get(51),o=e.get(147);if(n.isViewportWrapping){let s=e.get(74);return t>o.contentWidth+i.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+o.verticalScrollbarWidth:t}else{let s=e.get(106)*i.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+o.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Za(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),i=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n);return{scrollTop:t,scrollTopWithoutViewZones:t-i,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}};function Wv(r,e){return r===null?e?Av.INSTANCE:Fv.INSTANCE:new sE(r,e)}var sE=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,n){this._assertVisible();let i=n>0?this._projectionData.breakOffsets[n-1]:0,o=this._projectionData.breakOffsets[n],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,u)=>new Bn(0,0,d+1,this._projectionData.injectionOptions[u],0));s=Bn.applyInjectedText(e.getLineContent(t),a).substring(i,o)}else s=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:o+1});return n>0&&(s=Fk(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,n){return this._assertVisible(),this._projectionData.getLineLength(n)}getViewLineMinColumn(e,t,n){return this._assertVisible(),this._projectionData.getMinOutputOffset(n)+1}getViewLineMaxColumn(e,t,n){return this._assertVisible(),this._projectionData.getMaxOutputOffset(n)+1}getViewLineData(e,t,n){let i=new Array;return this.getViewLinesData(e,t,n,1,0,[!0],i),i[0]}getViewLinesData(e,t,n,i,o,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,u=l.injectionOptions,c=null;if(d){c=[];let h=0,g=0;for(let f=0;f<l.getOutputLineCount();f++){let v=new Array;c[f]=v;let y=f>0?l.breakOffsets[f-1]:0,I=l.breakOffsets[f];for(;g<d.length;){let S=u[g].content.length,x=d[g]+h,T=x+S;if(x>I)break;if(y<T){let R=u[g];if(R.inlineClassName){let P=f>0?l.wrappedTextIndentLength:0,O=P+Math.max(x-y,0),k=P+Math.min(T-y,I-y);O!==k&&v.push(new Mf(O,k,R.inlineClassName,R.inlineClassNameAffectsLetterSpacing))}}if(T<=I)h+=S,g++;else break}}}let p;if(d){let h=[];for(let g=0;g<d.length;g++){let f=d[g],v=u[g].tokens;v?v.forEach((y,I)=>{h.push({offset:f,text:y.substring(u[g].content),tokenMetadata:I.metadata})}):h.push({offset:f,text:u[g].content,tokenMetadata:_t.defaultTokenMetadata})}p=e.tokenization.getLineTokens(t).withInserted(h)}else p=e.tokenization.getLineTokens(t);for(let h=n;h<n+i;h++){let g=o+h-n;if(!s[g]){a[g]=null;continue}a[g]=this._getViewLineData(p,c?c[h]:null,h)}}_getViewLineData(e,t,n){this._assertVisible();let i=this._projectionData,o=n>0?i.wrappedTextIndentLength:0,s=n>0?i.breakOffsets[n-1]:0,a=i.breakOffsets[n],l=e.sliceAndInflate(s,a,o),d=l.getLineContent();n>0&&(d=Fk(i.wrappedTextIndentLength)+d);let u=this._projectionData.getMinOutputOffset(n)+1,c=d.length+1,p=n+1<this.getViewLineCount(),h=n===0?0:i.breakOffsetsVisibleColumn[n-1];return new Oa(d,p,u,c,h,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,n=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,n).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let n=this._projectionData.translateToOutputPosition(t-1);return e+n.outputLineIndex}normalizePosition(e,t,n){let i=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,n).toPosition(i)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},Av=class r{static INSTANCE=new r;constructor(){}isVisible(){return!0}setVisible(e){return e?this:Fv.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.tokenization.getLineTokens(t),o=i.getLineContent();return new Oa(o,!1,1,o.length+1,0,i.inflate(),null)}getViewLinesData(e,t,n,i,o,s,a){if(!s[o]){a[o]=null;return}a[o]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new w(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n){return t}getInjectedTextAt(e,t){return null}},Fv=class r{static INSTANCE=new r;constructor(){}isVisible(){return!1}setVisible(e){return e?Av.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,o,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},oE=[""];function Fk(r){if(r>=oE.length)for(let e=1;e<=r;e++)oE[e]=wA(e);return oE[r]}function wA(r){return new Array(r+1).join(" ")}var Bv=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],n=t>0?this._prefixSum[t-1]:0;return new aE(t,e-n)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=Er(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let n=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+n;for(let o=0;o<n;o++)this._indexBySum[i+o]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},aE=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var Vv=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,n,i,o,s,a,l,d,u){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=o,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=u,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new lE(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),o=n.length,s=this.createLineBreaksComputer(),a=new Rn(Bn.fromDecorations(i));for(let f=0;f<o;f++){let v=a.takeWhile(y=>y.lineNumber===f+1);s.addRequest(n[f],v,t?t[f]:null)}let l=s.finalize(),d=[],u=this.hiddenAreasDecorationIds.map(f=>this.model.getDecorationRange(f)).sort(_.compareRangesUsingStarts),c=1,p=0,h=-1,g=h+1<u.length?p+1:o+2;for(let f=0;f<o;f++){let v=f+1;v===g&&(h++,c=u[h].startLineNumber,p=u[h].endLineNumber,g=h+1<u.length?p+1:o+2);let y=v>=c&&v<=p,I=Wv(l[f],!y);d[f]=I.getViewLineCount(),this.modelLineProjections[f]=I}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new Bv(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(p=>this.model.validateRange(p)),n=TA(t),i=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(_.compareRangesUsingStarts);if(n.length===i.length){let p=!1;for(let h=0;h<n.length;h++)if(!n[h].equalsRange(i[h])){p=!0;break}if(!p)return!1}let o=n.map(p=>({range:p,options:Un.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,o);let s=n,a=1,l=0,d=-1,u=d+1<s.length?l+1:this.modelLineProjections.length+2,c=!1;for(let p=0;p<this.modelLineProjections.length;p++){let h=p+1;h===u&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,u=d+1<s.length?l+1:this.modelLineProjections.length+2);let g=!1;if(h>=a&&h<=l?this.modelLineProjections[p].isVisible()&&(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!1),g=!0):(c=!0,this.modelLineProjections[p].isVisible()||(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!0),g=!0)),g){let f=this.modelLineProjections[p].getViewLineCount();this.projectedModelLineLineCounts.setValue(p,f)}}return c||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i,o){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===n,d=this.wrappingIndent===i,u=this.wordBreak===o;if(s&&a&&l&&d&&u)return!1;let c=s&&a&&!l&&d&&u;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i,this.wordBreak=o;let p=null;if(c){p=[];for(let h=0,g=this.modelLineProjections.length;h<g;h++)p[h]=this.modelLineProjections[h].getProjectionData()}return this._constructLines(!1,p),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections.splice(t-1,n-t+1),this.projectedModelLineLineCounts.removeValues(t-1,n-t+1),new kd(i,o)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;let o=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let u=0,c=i.length;u<c;u++){let p=Wv(i[u],!o);l.push(p);let h=p.getViewLineCount();a+=h,d[u]=h}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new Rd(s,s+a-1)}onModelLineChanged(e,t,n){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,o=this.modelLineProjections[i].getViewLineCount(),s=this.modelLineProjections[i].isVisible(),a=Wv(n,s);this.modelLineProjections[i]=a;let l=this.modelLineProjections[i].getViewLineCount(),d=!1,u=0,c=-1,p=0,h=-1,g=0,f=-1;o>l?(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,c=u+l-1,g=c+1,f=g+(o-l)-1,d=!0):o<l?(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,c=u+o-1,p=c+1,h=p+(l-o)-1,d=!0):(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,c=u+l-1),this.projectedModelLineLineCounts.setValue(i,l);let v=u<=c?new ap(u,c-u+1):null,y=p<=h?new Rd(p,h):null,I=g<=f?new kd(g,f):null;return[d,v,y,I]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),o=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),a=this.model.guides.getActiveIndentGuide(i.lineNumber,o.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),n=t.index,i=t.remainder;return new Uv(n+1,i)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new w(e.modelLineNumber,i)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new w(e.modelLineNumber,i)}getViewLineInfosGroupedByModelRanges(e,t){let n=this.getViewLineInfo(e),i=this.getViewLineInfo(t),o=new Array,s=this.getModelStartPositionOfViewLine(n),a=new Array;for(let l=n.modelLineNumber;l<=i.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let u=l===n.modelLineNumber?n.modelLineWrappedLineIdx:0,c=l===i.modelLineNumber?i.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let p=u;p<c;p++)a.push(new Uv(l,p))}if(!d.isVisible()&&s){let u=new w(l-1,this.model.getLineMaxColumn(l-1)+1),c=_.fromPositions(s,u);o.push(new Hv(c,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new w(l,1))}if(s){let l=_.fromPositions(s,this.getModelEndPositionOfViewLine(i));o.push(new Hv(l,a))}return o}getViewLinesBracketGuides(e,t,n,i){let o=n?this.convertViewPositionToModelPosition(n.lineNumber,n.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,o,i);for(let u of a.viewLines){let p=d[u.modelLineNumber-l].map(h=>{if(h.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,h.forWrappedLinesAfterColumn).lineNumber>=u.modelLineWrappedLineIdx||h.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,h.forWrappedLinesBeforeOrAtColumn).lineNumber<u.modelLineWrappedLineIdx)return;if(!h.horizontalLine)return h;let g=-1;if(h.column!==-1){let y=this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,h.column);if(y.lineNumber===u.modelLineWrappedLineIdx)g=y.column;else if(y.lineNumber<u.modelLineWrappedLineIdx)g=this.getMinColumnOfViewLine(u);else if(y.lineNumber>u.modelLineWrappedLineIdx)return}let f=this.convertModelPositionToViewPosition(u.modelLineNumber,h.horizontalLine.endColumn),v=this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,h.horizontalLine.endColumn);return v.lineNumber===u.modelLineWrappedLineIdx?new Ai(h.visibleColumn,g,h.className,new yo(h.horizontalLine.top,f.column),-1,-1):v.lineNumber<u.modelLineWrappedLineIdx||h.visibleColumn!==-1?void 0:new Ai(h.visibleColumn,g,h.className,new yo(h.horizontalLine.top,this.getMaxColumnOfViewLine(u)),-1,-1)});s.push(p.filter(h=>!!h))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),o=[],s=[],a=[],l=n.lineNumber-1,d=i.lineNumber-1,u=null;for(let g=l;g<=d;g++){let f=this.modelLineProjections[g];if(f.isVisible()){let v=f.getViewLineNumberOfModelPosition(0,g===l?n.column:1),y=f.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),I=y-v+1,S=0;I>1&&f.getViewLineMinColumn(this.model,g+1,y)===1&&(S=v===0?1:2),s.push(I),a.push(S),u===null&&(u=new w(g+1,0))}else u!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(u.lineNumber,g)),u=null)}u!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(u.lineNumber,i.lineNumber)),u=null);let c=t-e+1,p=new Array(c),h=0;for(let g=0,f=o.length;g<f;g++){let v=o[g],y=Math.min(c-h,s[g]),I=a[g],S;I===2?S=0:I===1?S=1:S=y;for(let x=0;x<y;x++)x===S&&(v=0),p[h++]=v}return p}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),o=e,s=i.index,a=i.remainder,l=[];for(let d=s,u=this.model.getLineCount();d<u;d++){let c=this.modelLineProjections[d];if(!c.isVisible())continue;let p=d===s?a:0,h=c.getViewLineCount()-p,g=!1;if(o+h>t&&(g=!0,h=t-o+1),c.getViewLinesData(this.model,d+1,p,h,o-e,n,l),o+=h,g)break}return l}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),o=i.index,s=i.remainder,a=this.modelLineProjections[o],l=a.getViewLineMinColumn(this.model,o+1,s),d=a.getViewLineMaxColumn(this.model,o+1,s);t<l&&(t=l),t>d&&(t=d);let u=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new w(o+1,u)).equals(n)?new w(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){let n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new _(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){let n=this.getViewLineInfo(e),i=this.modelLineProjections[n.modelLineNumber-1].getModelColumnOfViewPosition(n.modelLineWrappedLineIdx,t);return this.model.validatePosition(new w(n.modelLineNumber,i))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new _(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t,n=2,i=!1,o=!1){let s=this.model.validatePosition(new w(e,t)),a=s.lineNumber,l=s.column,d=a-1,u=!1;if(o)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,u=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,u=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new w(i?0:1,1);let c=1+this.projectedModelLineLineCounts.getPrefixSum(d),p;return u?o?p=this.modelLineProjections[d].getViewPositionOfModelPosition(c,1,n):p=this.modelLineProjections[d].getViewPositionOfModelPosition(c,this.model.getLineMaxColumn(d+1),n):p=this.modelLineProjections[a-1].getViewPositionOfModelPosition(c,l,n),p}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return _.fromPositions(n)}else{let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new _(n.lineNumber,n.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let n=e-1;if(this.modelLineProjections[n].isVisible()){let o=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(o,t)}for(;n>0&&!this.modelLineProjections[n].isVisible();)n--;if(n===0&&!this.modelLineProjections[n].isVisible())return 1;let i=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getDecorationsInRange(e,t,n,i,o){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new _(s.lineNumber,1,a.lineNumber,a.column),t,n,i,o);let l=[],d=s.lineNumber-1,u=a.lineNumber-1,c=null;for(let f=d;f<=u;f++)if(this.modelLineProjections[f].isVisible())c===null&&(c=new w(f+1,f===d?s.column:1));else if(c!==null){let y=this.model.getLineMaxColumn(f);l=l.concat(this.model.getDecorationsInRange(new _(c.lineNumber,c.column,f,y),t,n,i)),c=null}c!==null&&(l=l.concat(this.model.getDecorationsInRange(new _(c.lineNumber,c.column,a.lineNumber,a.column),t,n,i)),c=null),l.sort((f,v)=>{let y=_.compareRangesUsingStarts(f.range,v.range);return y===0?f.id<v.id?-1:f.id>v.id?1:0:y});let p=[],h=0,g=null;for(let f of l){let v=f.id;g!==v&&(g=v,p[h++]=f)}return p}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let n=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[n.modelLineNumber-1].normalizePosition(n.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function TA(r){if(r.length===0)return[];let e=r.slice();e.sort(_.compareRangesUsingStarts);let t=[],n=e[0].startLineNumber,i=e[0].endLineNumber;for(let o=1,s=e.length;o<s;o++){let a=e[o];a.startLineNumber>i+1?(t.push(new _(n,1,i,1)),n=a.startLineNumber,i=a.endLineNumber):a.endLineNumber>i&&(i=a.endLineNumber)}return t.push(new _(n,1,i,1)),t}var Uv=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},Hv=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},lE=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,n,i){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,n,i)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var zv=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new dE(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new kd(t,n)}onModelLinesInserted(e,t,n,i){return new Rd(t,n)}onModelLineChanged(e,t,n){return[!1,new ap(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,n){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let n=t-e+1,i=new Array(n);for(let o=0;o<n;o++)i[o]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),n=t.getLineContent();return new Oa(n,!1,1,n.length+1,0,t.inflate(),null)}getViewLinesData(e,t,n){let i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let o=[];for(let s=e;s<=t;s++){let a=s-e;o[a]=n[a]?this.getViewLineData(s):null}return o}getDecorationsInRange(e,t,n,i,o){return this.model.getDecorationsInRange(e,t,n,i,o)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},dE=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var Kv=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,n,i,o){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,n=this._decorationsCache[t];if(!n){let i=e.range,o=e.options,s;if(o.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new w(i.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new w(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)),1);s=new _(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(i,1);n=new Pd(s,o),this._decorationsCache[t]=n}return n}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,n=!1){let i=new _(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(i,t,n).inlineDecorations[0]}_getDecorationsInRange(e,t,n){let i=this._linesCollection.getDecorationsInRange(e,this.editorId,da(this.configuration.options),t,n),o=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let u=o;u<=s;u++)d[u-o]=[];for(let u=0,c=i.length;u<c;u++){let p=i[u],h=p.options;if(!LA(this.model,p))continue;let g=this._getOrCreateViewModelDecoration(p),f=g.range;if(a[l++]=g,h.inlineClassName){let v=new Na(f,h.inlineClassName,h.inlineClassNameAffectsLetterSpacing?3:0),y=Math.max(o,f.startLineNumber),I=Math.min(s,f.endLineNumber);for(let S=y;S<=I;S++)d[S-o].push(v)}if(h.beforeContentClassName&&o<=f.startLineNumber&&f.startLineNumber<=s){let v=new Na(new _(f.startLineNumber,f.startColumn,f.startLineNumber,f.startColumn),h.beforeContentClassName,1);d[f.startLineNumber-o].push(v)}if(h.afterContentClassName&&o<=f.endLineNumber&&f.endLineNumber<=s){let v=new Na(new _(f.endLineNumber,f.endColumn,f.endLineNumber,f.endColumn),h.afterContentClassName,2);d[f.endLineNumber-o].push(v)}}return{decorations:a,inlineDecorations:d}}};function LA(r,e){return!(e.options.hideInCommentTokens&&kA(r,e)||e.options.hideInStringTokens&&RA(r,e))}function kA(r,e){return Wk(r,e.range,t=>t===1)}function RA(r,e){return Wk(r,e.range,t=>t===2)}function Wk(r,e,t){for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let i=r.tokenization.getLineTokens(n),o=n===e.startLineNumber,s=n===e.endLineNumber,a=o?i.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<i.getCount()&&!(s&&i.getStartOffset(a)>e.endColumn-1);){if(!t(i.getStandardTokenType(a)))return!1;a++}}return!0}var Xa=3,Gv=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*Xa/8))}reset(e){let t=Math.ceil((e+1)*Xa/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,n){n&&(this.persist|=1<<e-1);for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let o=Xa*i+(e-1);this.lanes[o>>>3]|=1<<o%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(i))}}getLanesAtLine(e){let t=[],n=Xa*e;for(let i=0;i<Xa;i++)(this.persist&1<<i||this.lanes[n>>>3]&1<<n%8)&&t.push(i+1),n++;return t.length?t:[2]}countAtLine(e){let t=Xa*e,n=0;for(let i=0;i<Xa;i++)(this.persist&1<<i||this.lanes[t>>>3]&1<<t%8)&&n++,t++;return n}};var DA=!0,jv=class extends B{constructor(t,n,i,o,s,a,l,d,u,c){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=u;this._transactionalTarget=c;if(this._editorId=t,this._configuration=n,this.model=i,this._eventDispatcher=new vv,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new ko(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new dn(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=uE.create(this.model),this.glyphLanes=new Gv(0),DA&&this.model.isTooLargeForTokenization())this._lines=new zv(this.model);else{let p=this._configuration.options,h=p.get(51),g=p.get(141),f=p.get(148),v=p.get(140),y=p.get(131);this._lines=new Vv(this._editorId,this.model,o,s,h,this.model.getOptions().tabSize,g,f.wrappingColumn,v,y)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new Pv(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new Nv(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(p=>{p.scrollTopChanged&&this._handleVisibleLinesChanged(),p.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new wf(p)),this._eventDispatcher.emitOutgoingEvent(new Cv(p.oldScrollWidth,p.oldScrollLeft,p.oldScrollHeight,p.oldScrollTop,p.scrollWidth,p.scrollLeft,p.scrollHeight,p.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(p=>{this._eventDispatcher.emitOutgoingEvent(p)})),this._decorations=new Kv(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(p=>{try{let h=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(h,p)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(au.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new kf)})),this._register(this._themeService.onDidColorThemeChange(p=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new Tf(p))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),n=new _(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(n)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new xf(t)),this._eventDispatcher.emitOutgoingEvent(new Iv(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new If)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new Cf)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new w(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),n=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new qv(n,this._viewportStart.startLineDelta)}return new qv(null,0)}_onConfigurationChanged(t,n){let i=this._captureStableViewport(),o=this._configuration.options,s=o.get(51),a=o.get(141),l=o.get(148),d=o.get(140),u=o.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,u)&&(t.emitViewEvent(new Pa),t.emitViewEvent(new Ma),t.emitViewEvent(new Zr(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),n.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new Zr(null))),n.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new Zr(null))),t.emitViewEvent(new Sf(n)),this.viewLayout.onConfigurationChanged(n),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),ko.shouldRecreate(n)&&(this.cursorConfig=new ko(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let i=this._eventDispatcher.beginEmitViewEvents(),o=!1,s=!1,a=t instanceof as?t.rawContentChangedEvent.changes:t.changes,l=t instanceof as?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let p of a)switch(p.changeType){case 4:{for(let h=0;h<p.detail.length;h++){let g=p.detail[h],f=p.injectedTexts[h];f&&(f=f.filter(v=>!v.ownerId||v.ownerId===this._editorId)),d.addRequest(g,f,null)}break}case 2:{let h=null;p.injectedText&&(h=p.injectedText.filter(g=>!g.ownerId||g.ownerId===this._editorId)),d.addRequest(p.detail,h,null);break}}let u=d.finalize(),c=new Rn(u);for(let p of a)switch(p.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new Pa),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),o=!0;break}case 3:{let h=this._lines.onModelLinesDeleted(l,p.fromLineNumber,p.toLineNumber);h!==null&&(i.emitViewEvent(h),this.viewLayout.onLinesDeleted(h.fromLineNumber,h.toLineNumber)),o=!0;break}case 4:{let h=c.takeCount(p.detail.length),g=this._lines.onModelLinesInserted(l,p.fromLineNumber,p.toLineNumber,h);g!==null&&(i.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),o=!0;break}case 2:{let h=c.dequeue(),[g,f,v,y]=this._lines.onModelLineChanged(l,p.lineNumber,h);s=g,f&&i.emitViewEvent(f),v&&(i.emitViewEvent(v),this.viewLayout.onLinesInserted(v.fromLineNumber,v.toLineNumber)),y&&(i.emitViewEvent(y),this.viewLayout.onLinesDeleted(y.fromLineNumber,y.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!o&&s&&(i.emitViewEvent(new Ma),i.emitViewEvent(new Zr(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){let i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){let o=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let i=this._eventDispatcher.beginEmitViewEvents();t instanceof as&&i.emitOutgoingEvent(new kv(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let n=[];for(let i=0,o=t.ranges.length;i<o;i++){let s=t.ranges[i],a=this.coordinatesConverter.convertModelPositionToViewPosition(new w(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new w(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;n[i]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new Lf(n)),this._eventDispatcher.emitOutgoingEvent(new Dv(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new Ef),this.cursorConfig=new ko(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new Lv(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new ko(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new Tv(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new Pa),n.emitViewEvent(new Ma),n.emitViewEvent(new Zr(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new ko(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new Rv(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Zr(t)),this._eventDispatcher.emitOutgoingEvent(new wv(t))}))}hiddenAreasModel=new pE;previousHiddenAreas=[];setHiddenAreas(t,n){this.hiddenAreasModel.setHiddenAreas(n,t);let i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;let o=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(a.emitViewEvent(new Pa),a.emitViewEvent(new Ma),a.emitViewEvent(new Zr(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=o.viewportStartModelPosition?.lineNumber;l&&i.some(u=>u.startLineNumber<=l&&l<=u.endLineNumber)||o.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new _v)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),n=this._configuration.options.get(68),i=Math.max(20,Math.round(t.height/n)),o=this.viewLayout.getLinesViewportData(),s=Math.max(1,o.completelyVisibleStartLineNumber-i),a=Math.min(this.getLineCount(),o.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new _(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let n=this.coordinatesConverter.convertViewRangeToModelRange(t),i=this._lines.getHiddenAreas();if(i.length===0)return[n];let o=[],s=0,a=n.startLineNumber,l=n.startColumn,d=n.endLineNumber,u=n.endColumn;for(let c=0,p=i.length;c<p;c++){let h=i[c].startLineNumber,g=i[c].endLineNumber;g<a||h>d||(a<h&&(o[s++]=new _(a,l,h-1,this.model.getLineMaxColumn(h-1))),a=g+1,l=1)}return(a<d||a===d&&l<u)&&(o[s++]=new _(a,l,d,u)),o}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new _(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(t){let n=this.viewLayout.getLinesViewportDataAtScrollTop(t),i=n.completelyVisibleStartLineNumber,o=n.completelyVisibleEndLineNumber;return new _(i,this.getLineMinColumn(i),o,this.getLineMaxColumn(o))}saveState(){let t=this.viewLayout.saveState(),n=t.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(n),o=this.coordinatesConverter.convertViewPositionToModelPosition(new w(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-n;return{scrollLeft:t.scrollLeft,firstPosition:o,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let n=this.model.validatePosition(t.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(n),o=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:o}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,n,i){this._viewportStart.update(this,t)}getActiveIndentGuide(t,n,i){return this._lines.getActiveIndentGuide(t,n,i)}getLinesIndentGuides(t,n){return this._lines.getViewLinesIndentGuides(t,n)}getBracketGuidesInRangeByLine(t,n,i,o){return this._lines.getViewLinesBracketGuides(t,n,i,o)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let n=gt(this.getLineContent(t));return n===-1?0:n+1}getLineLastNonWhitespaceColumn(t){let n=yi(this.getLineContent(t));return n===-1?0:n+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,n){let o=this._decorations.getDecorationsViewportData(t).inlineDecorations[n-t.startLineNumber];return this._getViewLineRenderingData(n,o)}getViewLineRenderingData(t){let n=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,n)}_getViewLineRenderingData(t,n){let i=this.model.mightContainRTL(),o=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(n=[...n,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new Pf(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,i,o,a.tokens,n,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,n,i){let o=this._lines.getViewLinesData(t,n,i);return new Df(this.getTabSize(),o)}getAllOverviewRulerDecorations(t){let n=this.model.getOverviewRulerDecorations(this._editorId,da(this._configuration.options)),i=new cE;for(let o of n){let s=o.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.startLineNumber,o.range.startColumn),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.endLineNumber,o.range.endColumn);i.accept(d,s.zIndex,u,c,l)}return i.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let n of t)n.options.overviewRuler?.invalidateCachedColor(),n.options.minimap?.invalidateCachedColor()}getValueInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(i,n)}getValueLengthInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(i,n)}modifyPosition(t,n){let i=this.coordinatesConverter.convertViewPositionToModelPosition(t),o=this.model.modifyPosition(i,n);return this.coordinatesConverter.convertModelPositionToViewPosition(o)}deduceModelPositionRelativeToViewPosition(t,n,i){let o=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(n<0?n-=i:n+=i);let a=this.model.getOffsetAt(o)+n;return this.model.getPositionAt(a)}getPlainTextToCopy(t,n,i){let o=i?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(_.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!n)return"";let d=t.map(c=>c.startLineNumber),u="";for(let c=0;c<d.length;c++)c>0&&d[c-1]===d[c]||(u+=this.model.getLineContent(d[c])+o);return u}if(s&&n){let d=[],u=0;for(let c of t){let p=c.startLineNumber;c.isEmpty()?p!==u&&d.push(this.model.getLineContent(p)):d.push(this.model.getValueInRange(c,i?2:0)),u=p}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,i?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,n){let i=this.model.getLanguageId();if(i===or||t.length!==1)return null;let o=t[0];if(o.isEmpty()){if(!n)return null;let c=o.startLineNumber;o=new _(c,this.model.getLineMinColumn(c),c,this.model.getLineMaxColumn(c))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===Fn.fontFamily,u;return d?u=Fn.fontFamily:(u=s.fontFamily,u=u.replace(/"/g,"'"),/[,']/.test(u)||/[+ ]/.test(u)&&(u=`'${u}'`),u=`${u}, ${Fn.fontFamily}`),{mode:i,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${u};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(o,a)+"</div>"}}_getHTMLToCopy(t,n){let i=t.startLineNumber,o=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let u=i;u<=s;u++){let c=this.model.tokenization.getLineTokens(u),p=c.getLineContent(),h=u===i?o-1:0,g=u===s?a-1:p.length;p===""?d+="<br>":d+=Ak(p,c.inflate(),n,h,g,l,Fe)}return d}_getColorMap(){let t=ai.getColorMap(),n=["#000000"];if(t)for(let i=1,o=t.length;i<o;i++)n[i]=A.Format.CSS.formatHex(t[i]);return n}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,n,i){return this._withViewEventsCollector(o=>this._cursor.setStates(o,t,n,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,n,i=0){this._withViewEventsCollector(o=>this._cursor.setSelections(o,t,n,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(n=>this._cursor.restoreState(n,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new Ev);return}this._withViewEventsCollector(t)}executeEdits(t,n,i){this._executeCursorEdit(o=>this._cursor.executeEdits(o,t,n,i))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(n=>this._cursor.endComposition(n,t))}type(t,n){this._executeCursorEdit(i=>this._cursor.type(i,t,n))}compositionType(t,n,i,o,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,n,i,o,s))}paste(t,n,i,o){this._executeCursorEdit(s=>this._cursor.paste(s,t,n,i,o))}cut(t){this._executeCursorEdit(n=>this._cursor.cut(n,t))}executeCommand(t,n){this._executeCursorEdit(i=>this._cursor.executeCommand(i,t,n))}executeCommands(t,n){this._executeCursorEdit(i=>this._cursor.executeCommands(i,t,n))}revealAllCursors(t,n,i=!1){this._withViewEventsCollector(o=>this._cursor.revealAll(o,t,i,0,n,0))}revealPrimaryCursor(t,n,i=!1){this._withViewEventsCollector(o=>this._cursor.revealPrimary(o,t,i,0,n,0))}revealTopMostCursor(t){let n=this._cursor.getTopMostViewPosition(),i=new _(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(o=>o.emitViewEvent(new Ro(t,!1,i,null,0,!0,0)))}revealBottomMostCursor(t){let n=this._cursor.getBottomMostViewPosition(),i=new _(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(o=>o.emitViewEvent(new Ro(t,!1,i,null,0,!0,0)))}revealRange(t,n,i,o,s){this._withViewEventsCollector(a=>a.emitViewEvent(new Ro(t,!1,i,null,o,n,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new Rf),this._eventDispatcher.emitOutgoingEvent(new Sv))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let n=this._eventDispatcher.beginEmitViewEvents();return t(n)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,n){return this._lines.normalizePosition(t,n)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},uE=class r{constructor(e,t,n,i,o){this._model=e;this._viewLineNumber=t;this._isValid=n;this._modelTrackedRange=i;this._startLineDelta=o}static create(e){let t=e._setTrackedRange(null,new _(1,1,1,1),1);return new r(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let n=e.coordinatesConverter.convertViewPositionToModelPosition(new w(t,e.getLineMinColumn(t))),i=e.model._setTrackedRange(this._modelTrackedRange,new _(n.lineNumber,n.column,n.lineNumber,n.column),1),o=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=i,this._startLineDelta=s-o}invalidate(){this._isValid=!1}},cE=class{_asMap=Object.create(null);asArray=[];accept(e,t,n,i,o){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===o&&d+1>=n){i>d&&(a[a.length-1]=i);return}a.push(o,n,i)}else{let a=new Aa(e,t,[o,n,i]);this._asMap[e]=a,this.asArray.push(a)}}},pE=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let n=this.hiddenAreas.get(e);n&&Bk(n,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,n)=>PA(t,n),[]);return Bk(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function PA(r,e){let t=[],n=0,i=0;for(;n<r.length&&i<e.length;){let o=r[n],s=e[i];if(o.endLineNumber<s.startLineNumber-1)t.push(r[n++]);else if(s.endLineNumber<o.startLineNumber-1)t.push(e[i++]);else{let a=Math.min(o.startLineNumber,s.startLineNumber),l=Math.max(o.endLineNumber,s.endLineNumber);t.push(new _(a,1,l,1)),n++,i++}}for(;n<r.length;)t.push(r[n++]);for(;i<e.length;)t.push(e[i++]);return t}function Bk(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].equalsRange(e[t]))return!1;return!0}var qv=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let n=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),i=t.getVerticalOffsetForLineNumber(n.lineNumber);t.setScrollPosition({scrollTop:i+this.startLineDelta},1)}};var Ki=class extends B{constructor(t,n,i,o,s,a,l,d,u,c,p,h){super();this.languageConfigurationService=p;s.willCreateCodeEditor();let g={...n};this._domElement=t,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++MA,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?Hn.SimpleEditorContext:Hn.EditorContext),g,c)),this._register(this._configuration.onDidChange(y=>{this._onDidChangeConfiguration.fire(y);let I=this._configuration.options;if(y.hasChanged(147)){let S=I.get(147);this._onDidLayoutChange.fire(S)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=u,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new gE(this,this._contextKeyService)),this._register(new fE(this,this._contextKeyService,h)),this._instantiationService=this._register(o.createChild(new Mh([ei,this._contextKeyService]))),this._modelData=null,this._focusTracker=new bE(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let f;Array.isArray(i.contributions)?f=i.contributions:f=cp.getEditorContributions(),this._contributions.initialize(this,f,this._instantiationService);for(let y of cp.getEditorActions()){if(this._actions.has(y.id)){Le(new Error(`Cannot have two actions with the same id ${y.id}`));continue}let I=new gv(y.id,y.label,y.alias,y.metadata,y.precondition??void 0,S=>this._instantiationService.invokeFunction(x=>Promise.resolve(y.runEditorCommand(x,this,S))),this._contextKeyService);this._actions.set(I.id,I)}let v=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new pf(this._domElement,{onDragOver:y=>{if(!v())return;let I=this.getTargetAtClientPoint(y.clientX,y.clientY);I?.position&&this.showDropIndicatorAt(I.position)},onDrop:async y=>{if(!v()||(this.removeDropIndicator(),!y.dataTransfer))return;let I=this.getTargetAtClientPoint(y.clientX,y.clientY);I?.position&&this._onDropIntoEditor.fire({position:I.position,event:y})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=Un.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=ww();_contributions=this._register(new mv);_onDidDispose=this._register(new L);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new L({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new $t(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new $v({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new $v({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new $t(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new $t(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new $t(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new $t(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new $t(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new $t(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new $t(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new $t(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new $t(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new $t(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new $t(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new $t(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new $t(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new $t(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new $t(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new $t(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new $t(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new L);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new L);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,n,i,o){return new Td(t,n,i,this._domElement,o)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return $C.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?Kd.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let n=!!(t&&t.preserveBOM),i=0;return t&&t.lineEnding&&t.lineEnding===`
`?i=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,n)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let n=t;if(this._modelData===null&&n===null||this._modelData&&this._modelData.model===n)return;let i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:n?.uri||null};this._onWillChangeModel.fire(i);let o=this.hasTextFocus(),s=this._detachModel();this._attachModel(n),o&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let n=this._decorationTypeSubtypes[t];for(let i in n)this._removeDecorationType(t+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,n,i,o){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,o)}getTopForLineNumber(t,n=!1){return this._modelData?Ki._getVerticalOffsetForPosition(this._modelData,t,1,n):-1}getTopForPosition(t,n){return this._modelData?Ki._getVerticalOffsetForPosition(this._modelData,t,n,!1):-1}static _getVerticalOffsetForPosition(t,n,i,o=!1){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,o)}getBottomForLineNumber(t,n=!1){if(!this._modelData)return-1;let i=this._modelData.model.getLineMaxColumn(t);return Ki._getVerticalOffsetAfterPosition(this._modelData,t,i,n)}setHiddenAreas(t,n){this._modelData?.viewModel.setHiddenAreas(t.map(i=>_.lift(i)),n)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Ye.visibleColumnFromColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Ye.toStatusbarColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,n="api"){if(this._modelData){if(!w.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,n,i,o){if(!this._modelData)return;if(!_.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,a,n,o)}revealLine(t,n=0){this._revealLine(t,0,n)}revealLineInCenter(t,n=0){this._revealLine(t,1,n)}revealLineInCenterIfOutsideViewport(t,n=0){this._revealLine(t,2,n)}revealLineNearTop(t,n=0){this._revealLine(t,5,n)}_revealLine(t,n,i){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new _(t,1,t,1),n,!1,i)}revealPosition(t,n=0){this._revealPosition(t,0,!0,n)}revealPositionInCenter(t,n=0){this._revealPosition(t,1,!0,n)}revealPositionInCenterIfOutsideViewport(t,n=0){this._revealPosition(t,2,!0,n)}revealPositionNearTop(t,n=0){this._revealPosition(t,5,!0,n)}_revealPosition(t,n,i,o){if(!w.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new _(t.lineNumber,t.column,t.lineNumber,t.column),n,i,o)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,n="api"){let i=ye.isISelection(t),o=_.isIRange(t);if(!i&&!o)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(t,n);else if(o){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,n)}}_setSelectionImpl(t,n){if(!this._modelData)return;let i=new ye(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(n,[i])}revealLines(t,n,i=0){this._revealLines(t,n,0,i)}revealLinesInCenter(t,n,i=0){this._revealLines(t,n,1,i)}revealLinesInCenterIfOutsideViewport(t,n,i=0){this._revealLines(t,n,2,i)}revealLinesNearTop(t,n,i=0){this._revealLines(t,n,5,i)}_revealLines(t,n,i,o){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid arguments");this._sendRevealRange(new _(t,1,n,1),i,!1,o)}revealRange(t,n=0,i=!1,o=!0){this._revealRange(t,i?1:0,o,n)}revealRangeInCenter(t,n=0){this._revealRange(t,1,!0,n)}revealRangeInCenterIfOutsideViewport(t,n=0){this._revealRange(t,2,!0,n)}revealRangeNearTop(t,n=0){this._revealRange(t,5,!0,n)}revealRangeNearTopIfOutsideViewport(t,n=0){this._revealRange(t,6,!0,n)}revealRangeAtTop(t,n=0){this._revealRange(t,3,!0,n)}_revealRange(t,n,i,o){if(!_.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(_.lift(t),n,i,o)}setSelections(t,n="api",i=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let o=0,s=t.length;o<s;o++)if(!ye.isISelection(t[o]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,t,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},n)}}setScrollTop(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},n)}}setScrollPosition(t,n=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,n)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),n=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:n,viewState:i,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let n=t;if(n&&n.cursorState&&n.viewState){let i=n.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(n.contributionsState||{});let o=this._modelData.viewModel.reduceRestoreState(n.viewState);this._modelData.view.restoreState(o)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(n=>n.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,n,i){i=i||{};try{switch(this._beginUpdate(),n){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=i;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=i;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=i;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=i;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let o=this.getAction(n);if(o){Promise.resolve(o.run(i)).then(void 0,Le);return}if(!this._modelData||this._triggerEditorCommand(t,n,i))return;this._triggerCommand(n,i)}finally{this._endUpdate()}}_triggerCommand(t,n){this._commandService.executeCommand(t,n)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,n){!this._modelData||n.length===0||(t==="keyboard"&&this._onWillType.fire(n),this._modelData.viewModel.type(n,t),t==="keyboard"&&this._onDidType.fire(n))}_compositionType(t,n,i,o,s){this._modelData&&this._modelData.viewModel.compositionType(n,i,o,s,t)}_paste(t,n,i,o,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(n,i,o,t);let u=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new _(d.lineNumber,d.column,u.lineNumber,u.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,n,i){let o=cp.getEditorCommand(n);return o?(i=i||{},i.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(o.runEditorCommand(s,this,i)).then(void 0,Le)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,n,i){if(!this._modelData||this._configuration.options.get(93))return!1;let o;return i?Array.isArray(i)?o=()=>i:o=i:o=()=>null,this._modelData.viewModel.executeEdits(t,n,o),!0}executeCommand(t,n){this._modelData&&this._modelData.viewModel.executeCommand(n,t)}executeCommands(t,n){this._modelData&&this._modelData.viewModel.executeCommands(n,t)}createDecorationsCollection(t){return new vE(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,da(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,da(this._configuration.options)):null}deltaDecorations(t,n){return this._modelData?t.length===0&&n.length===0?t:this._modelData.model.deltaDecorations(t,n,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(n=>{n.deltaDecorations(t,[])})}setDecorationsByType(t,n,i){let o={},s=this._decorationTypeSubtypes[n]||{};this._decorationTypeSubtypes[n]=o;let a=[];for(let d of i){let u=n;if(d.renderOptions){let p=Ji(d.renderOptions).toString(16);u=n+"-"+p,!s[p]&&!o[p]&&this._registerDecorationType(t,u,d.renderOptions,n),o[p]=!0}let c=this._resolveDecorationOptions(u,!!d.hoverMessage);d.hoverMessage&&(c.hoverMessage=d.hoverMessage),a.push({range:d.range,options:c})}for(let d in s)o[d]||this._removeDecorationType(n+"-"+d);let l=this._decorationTypeKeysToIds[n]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[n]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,n){let i=this._decorationTypeSubtypes[t]||{};for(let l in i)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let o=Un.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(n.length);for(let l=0,d=n.length;l<d;l++)s[l]={range:n[l],options:o};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let n=this._decorationTypeKeysToIds[t];n&&this.changeDecorations(i=>i.deltaDecorations(n,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,n=!1){this._configuration.observeContainer(t),n||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let n={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(n)}layoutContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];delete this._contentWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(t){let n={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(n)}layoutOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];delete this._overlayWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(t){let n={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(n)}layoutGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];delete this._glyphMarginWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,n){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,n)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let n=this._modelData.model.validatePosition(t),i=this._configuration.options,o=i.get(147),s=Ki._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+o.glyphMarginWidth+o.lineNumbersWidth+o.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:i.get(68)}}getOffsetForColumn(t,n){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,n)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){wt(t,this._configuration.options.get(51))}setBanner(t,n){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?n:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let n=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let i=t.onBeforeAttached(),o=new jv(this._id,this._configuration,t,hv.create(_e(this._domElement)),bv.create(this._configuration.options),l=>Bi(_e(this._domElement),l),this.languageConfigurationService,this._themeService,i,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});n.push(t.onWillDispose(()=>this.setModel(null))),n.push(o.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let p=this.getOption(81),h=m("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",p);this._notificationService.prompt(Xg.Warning,h,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:m("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let p=0,h=l.selections.length;p<h;p++)d[p]=l.selections[p].getPosition();let u={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(u);let c={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(c);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(o);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,u=l.length;d<u;d++){let c=l[d];s.addContentWidget(this._contentWidgets[c])}l=Object.keys(this._overlayWidgets);for(let d=0,u=l.length;d<u;d++){let c=l[d];s.addOverlayWidget(this._overlayWidgets[c])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,u=l.length;d<u;d++){let c=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[c])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new mE(t,o,s,a,n,i)}_createView(t){let n;this.isSimpleWidget?n={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:n={paste:(s,a,l,d)=>{let u={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",u)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let u={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",u)}else{let u={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",u)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let i=new Zd(t.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new hu(n,this._configuration,this._themeService.getColorTheme(),t,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,n=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),n&&this._domElement.contains(n)&&n.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,n,i,o){this._codeEditorService.registerDecorationType(t,n,i,o,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,n){return this._codeEditorService.resolveDecorationOptions(t,n)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let n=[{range:new _(t.lineNumber,t.column,t.lineNumber,t.column),options:Ki.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(n),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,n){this._contextKeyService.createKey(t,n)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};Ki=ne([M(3,St),M(4,Ui),M(5,fo),M(6,ei),M(7,hm),M(8,gs),M(9,ri),M(10,sr),M(11,fv)],Ki);var MA=0,mE=class{constructor(e,t,n,i,o,s){this.model=e;this.viewModel=t;this.view=n;this.hasRealView=i;this.listenersToRemove=o;this.attachedView=s}dispose(){Sn(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var $v=class extends B{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new L(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new L(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let n=t?2:1;this._value!==n&&(this._value=n,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},$t=class extends L{constructor(t,n){super({deliveryQueue:n});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},gE=class extends B{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=X.editorSimpleInput.bindTo(t),this._editorFocus=X.focus.bindTo(t),this._textInputFocus=X.textInputFocus.bindTo(t),this._editorTextFocus=X.editorTextFocus.bindTo(t),this._tabMovesFocus=X.tabMovesFocus.bindTo(t),this._editorReadonly=X.readOnly.bindTo(t),this._inDiffEditor=X.inDiffEditor.bindTo(t),this._editorColumnSelection=X.columnSelection.bindTo(t),this._hasMultipleSelections=X.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=X.hasNonEmptySelection.bindTo(t),this._canUndo=X.canUndo.bindTo(t),this._canRedo=X.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(wd.onDidChangeTabFocus(n=>this._tabMovesFocus.set(n))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(wd.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},fE=class extends B{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._languageFeaturesService=i;this._langId=X.languageId.bindTo(n),this._hasCompletionItemProvider=X.hasCompletionItemProvider.bindTo(n),this._hasCodeActionsProvider=X.hasCodeActionsProvider.bindTo(n),this._hasCodeLensProvider=X.hasCodeLensProvider.bindTo(n),this._hasDefinitionProvider=X.hasDefinitionProvider.bindTo(n),this._hasDeclarationProvider=X.hasDeclarationProvider.bindTo(n),this._hasImplementationProvider=X.hasImplementationProvider.bindTo(n),this._hasTypeDefinitionProvider=X.hasTypeDefinitionProvider.bindTo(n),this._hasHoverProvider=X.hasHoverProvider.bindTo(n),this._hasDocumentHighlightProvider=X.hasDocumentHighlightProvider.bindTo(n),this._hasDocumentSymbolProvider=X.hasDocumentSymbolProvider.bindTo(n),this._hasReferenceProvider=X.hasReferenceProvider.bindTo(n),this._hasRenameProvider=X.hasRenameProvider.bindTo(n),this._hasSignatureHelpProvider=X.hasSignatureHelpProvider.bindTo(n),this._hasInlayHintsProvider=X.hasInlayHintsProvider.bindTo(n),this._hasDocumentFormattingProvider=X.hasDocumentFormattingProvider.bindTo(n),this._hasDocumentSelectionFormattingProvider=X.hasDocumentSelectionFormattingProvider.bindTo(n),this._hasMultipleDocumentFormattingProvider=X.hasMultipleDocumentFormattingProvider.bindTo(n),this._hasMultipleDocumentSelectionFormattingProvider=X.hasMultipleDocumentSelectionFormattingProvider.bindTo(n),this._isInEmbeddedEditor=X.isInEmbeddedEditor.bindTo(n);let o=()=>this._update();this._register(t.onDidChangeModel(o)),this._register(t.onDidChangeModelLanguage(o)),this._register(i.completionProvider.onDidChange(o)),this._register(i.codeActionProvider.onDidChange(o)),this._register(i.codeLensProvider.onDidChange(o)),this._register(i.definitionProvider.onDidChange(o)),this._register(i.declarationProvider.onDidChange(o)),this._register(i.implementationProvider.onDidChange(o)),this._register(i.typeDefinitionProvider.onDidChange(o)),this._register(i.hoverProvider.onDidChange(o)),this._register(i.documentHighlightProvider.onDidChange(o)),this._register(i.documentSymbolProvider.onDidChange(o)),this._register(i.referenceProvider.onDidChange(o)),this._register(i.renameProvider.onDidChange(o)),this._register(i.documentFormattingEditProvider.onDidChange(o)),this._register(i.documentRangeFormattingEditProvider.onDidChange(o)),this._register(i.signatureHelpProvider.onDidChange(o)),this._register(i.inlayHintsProvider.onDidChange(o)),o()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===J.walkThroughSnippet||t.uri.scheme===J.vscodeChatCodeBlock)})}},bE=class extends B{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new L);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(R_(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(R_(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},vE=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,n){return this._editor.onDidChangeModelDecorations(i=>{this._isChangingDecorations||e.call(t,i)},n)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let n of this._decorationIds){let i=e.getDecorationRange(n);i&&t.push(i)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(n=>{t=n.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},OA=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),NA=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function hE(r){return OA+encodeURIComponent(r.toString())+NA}var AA=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),FA=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function WA(r){return AA+encodeURIComponent(r.toString())+FA}xn((r,e)=>{let t=r.getColor(lc);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${hE(t)}") repeat-x bottom left; }`);let n=r.getColor(Mi);n&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${hE(n)}") repeat-x bottom left; }`);let i=r.getColor(tr);i&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${hE(i)}") repeat-x bottom left; }`);let o=r.getColor(e1);o&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${WA(o)}") no-repeat bottom left; }`);let s=r.getColor(I0);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});var mu=class extends Ki{_parentEditor;_overwriteOptions;constructor(e,t,n,i,o,s,a,l,d,u,c,p,h){super(e,{...i.getRawOptions(),overflowWidgetsDomNode:i.getOverflowWidgetsDomNode()},n,o,s,a,l,d,u,c,p,h),this._parentEditor=i,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(i.onDidChangeConfiguration(g=>this._onParentConfigurationChanged(g)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){Qy(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};mu=ne([M(4,St),M(5,Ui),M(6,fo),M(7,ei),M(8,hm),M(9,gs),M(10,ri),M(11,sr),M(12,fv)],mu);var Yv=class extends Md{get fileSystemProvider(){return this.fileService.getProvider(J.file)}async pickFileFolderAndOpen(e){let t=this.getFileSystemSchema(e);if(e.defaultUri||(e.defaultUri=await this.defaultFilePath(t)),this.shouldUseSimplified(t))return super.pickFileFolderAndOpenSimplified(t,e,!1);throw new Error(m("pickFolderAndOpen","Can't open folders, try adding a folder to the workspace instead."))}addFileSchemaIfNeeded(e,t){return e===J.untitled?[J.file]:e!==J.file&&(!t||e!==J.vscodeRemote)?[e,J.file]:[e]}async pickFileAndOpen(e){let t=this.getFileSystemSchema(e);if(e.defaultUri||(e.defaultUri=await this.defaultFilePath(t)),this.shouldUseSimplified(t))return super.pickFileAndOpenSimplified(t,e,!1);let n=Yr();if(!Hi.supported(n))return this.showUnsupportedBrowserWarning("open");let i;try{[i]=await n.showOpenFilePicker({multiple:!1})}catch{return}if(!Hi.isFileSystemFileHandle(i))return;let o=await this.fileSystemProvider.registerFileHandle(i);this.addFileToRecentlyOpened(o),await this.openerService.open(o,{fromUserGesture:!0,editorOptions:{pinned:!0}})}async pickFolderAndOpen(e){let t=this.getFileSystemSchema(e);if(e.defaultUri||(e.defaultUri=await this.defaultFolderPath(t)),this.shouldUseSimplified(t))return super.pickFolderAndOpenSimplified(t,e);throw new Error(m("pickFolderAndOpen","Can't open folders, try adding a folder to the workspace instead."))}async pickWorkspaceAndOpen(e){e.availableFileSystems=this.getWorkspaceAvailableFileSystems(e);let t=this.getFileSystemSchema(e);if(e.defaultUri||(e.defaultUri=await this.defaultWorkspacePath(t)),this.shouldUseSimplified(t))return super.pickWorkspaceAndOpenSimplified(t,e);throw new Error(m("pickWorkspaceAndOpen","Can't open workspaces, try adding a folder to the workspace instead."))}async pickFileToSave(e,t){let n=this.getFileSystemSchema({defaultUri:e,availableFileSystems:t}),i=this.getPickFileToSaveDialogOptions(e,t);if(this.shouldUseSimplified(n))return super.pickFileToSaveSimplified(n,i);let o=Yr();if(!Hi.supported(o))return this.showUnsupportedBrowserWarning("save");let s,a=bi.first(this.fileSystemProvider.directories);try{s=await o.showSaveFilePicker({types:this.getFilePickerTypes(i.filters),suggestedName:st(e),startIn:a})}catch{return}if(Hi.isFileSystemFileHandle(s))return this.fileSystemProvider.registerFileHandle(s)}getFilePickerTypes(e){return e?.filter(t=>!(t.extensions.length===1&&(t.extensions[0]==="*"||t.extensions[0]===""))).map(t=>{let n={},i=t.extensions.filter(o=>o.indexOf("-")<0&&o.indexOf("*")<0&&o.indexOf("_")<0);return n[V1(`fileName.${t.extensions[0]}`)??"text/plain"]=i.map(o=>o.startsWith(".")?o:`.${o}`),{description:t.name,accept:n}})}async showSaveDialog(e){let t=this.getFileSystemSchema(e);if(this.shouldUseSimplified(t))return super.showSaveDialogSimplified(t,e);let n=Yr();if(!Hi.supported(n))return this.showUnsupportedBrowserWarning("save");let i,o=bi.first(this.fileSystemProvider.directories);try{i=await n.showSaveFilePicker({types:this.getFilePickerTypes(e.filters),...e.defaultUri?{suggestedName:st(e.defaultUri)}:void 0,startIn:o})}catch{return}if(Hi.isFileSystemFileHandle(i))return this.fileSystemProvider.registerFileHandle(i)}async showOpenDialog(e){let t=this.getFileSystemSchema(e);if(this.shouldUseSimplified(t))return super.showOpenDialogSimplified(t,e);let n=Yr();if(!Hi.supported(n))return this.showUnsupportedBrowserWarning("open");let i,o=bi.first(this.fileSystemProvider.directories)??"documents";try{if(e.canSelectFiles){let s=await n.showOpenFilePicker({multiple:!1,types:this.getFilePickerTypes(e.filters),startIn:o});s.length===1&&Hi.isFileSystemFileHandle(s[0])&&(i=await this.fileSystemProvider.registerFileHandle(s[0]))}else{let s=await n.showDirectoryPicker({startIn:o});i=await this.fileSystemProvider.registerDirectoryHandle(s)}}catch{}return i?[i]:void 0}async showUnsupportedBrowserWarning(e){if(e==="save"){let n=this.codeEditorService.getActiveCodeEditor();if(!(n instanceof mu)){let i=n?.getModel();if(i){HL(dt.fromString(i.getValue()).buffer,st(i.uri));return}}}let t=[{label:m({key:"openRemote",comment:["&& denotes a mnemonic"]},"&&Open Remote..."),run:async()=>{await this.commandService.executeCommand("workbench.action.remote.showMenu")}},{label:m({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:async()=>{await this.openerService.open("https://aka.ms/VSCodeWebLocalFileSystemAccess")}}];e==="open"&&t.push({label:m({key:"openFiles",comment:["&& denotes a mnemonic"]},"Open &&Files..."),run:async()=>{let n=await zL();if(n){let i=(await this.instantiationService.invokeFunction(o=>rk(o,n))).filter(o=>!o.isDirectory);i.length>0&&this.editorService.openEditors(i.map(o=>({resource:o.resource,contents:o.contents?.toString(),options:{pinned:!0}})))}}}),await this.dialogService.prompt({type:gn.Warning,message:m("unsupportedBrowserMessage","Opening Local Folders is Unsupported"),detail:m("unsupportedBrowserDetail",`Your browser doesn't support opening local folders.
You can either open single files or open a remote repository.`),buttons:t})}shouldUseSimplified(e){return![J.file,J.vscodeUserData,J.tmp].includes(e)}};ne([Si],Yv.prototype,"fileSystemProvider",1);Jn(qs,Yv,1);export{Yv as FileDialogService};
