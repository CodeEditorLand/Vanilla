{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/auxiliaryWindow/browser/auxiliaryWindowService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getZoomLevel } from \"../../../../base/browser/browser.js\";\nimport {\n\ttype Dimension,\n\tEventHelper,\n\tEventType,\n\tModifierKeyEmitter,\n\taddDisposableListener,\n\tcloneGlobalStylesheets,\n\tcopyAttributes,\n\tcreateLinkElement,\n\tcreateMetaElement,\n\tgetActiveWindow,\n\tgetClientArea,\n\tgetWindowId,\n\tisGlobalStylesheet,\n\tisHTMLElement,\n\tposition,\n\tregisterWindow,\n\tsharedMutationObserver,\n\ttrackAttributes,\n} from \"../../../../base/browser/dom.js\";\nimport {\n\ttype CodeWindow,\n\tensureCodeWindow,\n\tmainWindow,\n} from \"../../../../base/browser/window.js\";\nimport { coalesce } from \"../../../../base/common/arrays.js\";\nimport { Barrier } from \"../../../../base/common/async.js\";\nimport { onUnexpectedError } from \"../../../../base/common/errors.js\";\nimport { Emitter, Event } from \"../../../../base/common/event.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\ttype IDisposable,\n\ttoDisposable,\n} from \"../../../../base/common/lifecycle.js\";\nimport { mark } from \"../../../../base/common/performance.js\";\nimport { isFirefox, isWeb } from \"../../../../base/common/platform.js\";\nimport Severity from \"../../../../base/common/severity.js\";\nimport { localize } from \"../../../../nls.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport { IDialogService } from \"../../../../platform/dialogs/common/dialogs.js\";\nimport {\n\tInstantiationType,\n\tregisterSingleton,\n} from \"../../../../platform/instantiation/common/extensions.js\";\nimport { createDecorator } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport { ITelemetryService } from \"../../../../platform/telemetry/common/telemetry.js\";\nimport {\n\ttype IRectangle,\n\tWindowMinimumSize,\n} from \"../../../../platform/window/common/window.js\";\nimport { BaseWindow } from \"../../../browser/window.js\";\nimport { IWorkbenchEnvironmentService } from \"../../environment/common/environmentService.js\";\nimport { IHostService } from \"../../host/browser/host.js\";\nimport { IWorkbenchLayoutService } from \"../../layout/browser/layoutService.js\";\n\nexport const IAuxiliaryWindowService = createDecorator<IAuxiliaryWindowService>(\n\t\"auxiliaryWindowService\",\n);\n\nexport interface IAuxiliaryWindowOpenEvent {\n\treadonly window: IAuxiliaryWindow;\n\treadonly disposables: DisposableStore;\n}\n\nexport enum AuxiliaryWindowMode {\n\tMaximized = 0,\n\tNormal = 1,\n\tFullscreen = 2,\n}\n\nexport interface IAuxiliaryWindowOpenOptions {\n\treadonly bounds?: Partial<IRectangle>;\n\n\treadonly mode?: AuxiliaryWindowMode;\n\treadonly zoomLevel?: number;\n\n\treadonly nativeTitlebar?: boolean;\n\treadonly disableFullscreen?: boolean;\n}\n\nexport interface IAuxiliaryWindowService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly onDidOpenAuxiliaryWindow: Event<IAuxiliaryWindowOpenEvent>;\n\n\topen(options?: IAuxiliaryWindowOpenOptions): Promise<IAuxiliaryWindow>;\n\n\tgetWindow(windowId: number): IAuxiliaryWindow | undefined;\n}\n\nexport interface BeforeAuxiliaryWindowUnloadEvent {\n\tveto(reason: string | undefined): void;\n}\n\nexport interface IAuxiliaryWindow extends IDisposable {\n\treadonly onWillLayout: Event<Dimension>;\n\treadonly onDidLayout: Event<Dimension>;\n\n\treadonly onBeforeUnload: Event<BeforeAuxiliaryWindowUnloadEvent>;\n\treadonly onUnload: Event<void>;\n\n\treadonly whenStylesHaveLoaded: Promise<void>;\n\n\treadonly window: CodeWindow;\n\treadonly container: HTMLElement;\n\n\tlayout(): void;\n\n\tcreateState(): IAuxiliaryWindowOpenOptions;\n}\n\nexport class AuxiliaryWindow extends BaseWindow implements IAuxiliaryWindow {\n\tprivate readonly _onWillLayout = this._register(new Emitter<Dimension>());\n\treadonly onWillLayout = this._onWillLayout.event;\n\n\tprivate readonly _onDidLayout = this._register(new Emitter<Dimension>());\n\treadonly onDidLayout = this._onDidLayout.event;\n\n\tprivate readonly _onBeforeUnload = this._register(\n\t\tnew Emitter<BeforeAuxiliaryWindowUnloadEvent>(),\n\t);\n\treadonly onBeforeUnload = this._onBeforeUnload.event;\n\n\tprivate readonly _onUnload = this._register(new Emitter<void>());\n\treadonly onUnload = this._onUnload.event;\n\n\tprivate readonly _onWillDispose = this._register(new Emitter<void>());\n\treadonly onWillDispose = this._onWillDispose.event;\n\n\treadonly whenStylesHaveLoaded: Promise<void>;\n\n\tconstructor(\n\t\treadonly window: CodeWindow,\n\t\treadonly container: HTMLElement,\n\t\tstylesHaveLoaded: Barrier,\n\t\t@IConfigurationService\n\t\tprivate readonly configurationService: IConfigurationService,\n\t\t@IHostService hostService: IHostService,\n\t\t@IWorkbenchEnvironmentService\n\t\tenvironmentService: IWorkbenchEnvironmentService,\n\t) {\n\t\tsuper(window, undefined, hostService, environmentService);\n\n\t\tthis.whenStylesHaveLoaded = stylesHaveLoaded\n\t\t\t.wait()\n\t\t\t.then(() => undefined);\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tthis._register(\n\t\t\taddDisposableListener(\n\t\t\t\tthis.window,\n\t\t\t\tEventType.BEFORE_UNLOAD,\n\t\t\t\t(e: BeforeUnloadEvent) => this.handleBeforeUnload(e),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\taddDisposableListener(this.window, EventType.UNLOAD, () =>\n\t\t\t\tthis.handleUnload(),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\taddDisposableListener(this.window, \"unhandledrejection\", (e) => {\n\t\t\t\tonUnexpectedError(e.reason);\n\t\t\t\te.preventDefault();\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\taddDisposableListener(this.window, EventType.RESIZE, () =>\n\t\t\t\tthis.layout(),\n\t\t\t),\n\t\t);\n\n\t\tthis._register(\n\t\t\taddDisposableListener(\n\t\t\t\tthis.container,\n\t\t\t\tEventType.SCROLL,\n\t\t\t\t() => (this.container.scrollTop = 0),\n\t\t\t),\n\t\t); // Prevent container from scrolling (#55456)\n\n\t\tif (isWeb) {\n\t\t\tthis._register(\n\t\t\t\taddDisposableListener(this.container, EventType.DROP, (e) =>\n\t\t\t\t\tEventHelper.stop(e, true),\n\t\t\t\t),\n\t\t\t); // Prevent default navigation on drop\n\t\t\tthis._register(\n\t\t\t\taddDisposableListener(\n\t\t\t\t\tthis.container,\n\t\t\t\t\tEventType.WHEEL,\n\t\t\t\t\t(e) => e.preventDefault(),\n\t\t\t\t\t{ passive: false },\n\t\t\t\t),\n\t\t\t); // Prevent the back/forward gestures in macOS\n\t\t\tthis._register(\n\t\t\t\taddDisposableListener(\n\t\t\t\t\tthis.container,\n\t\t\t\t\tEventType.CONTEXT_MENU,\n\t\t\t\t\t(e) => EventHelper.stop(e, true),\n\t\t\t\t),\n\t\t\t); // Prevent native context menus in web\n\t\t} else {\n\t\t\tthis._register(\n\t\t\t\taddDisposableListener(\n\t\t\t\t\tthis.window.document.body,\n\t\t\t\t\tEventType.DRAG_OVER,\n\t\t\t\t\t(e: DragEvent) => EventHelper.stop(e),\n\t\t\t\t),\n\t\t\t); // Prevent drag feedback on <body>\n\t\t\tthis._register(\n\t\t\t\taddDisposableListener(\n\t\t\t\t\tthis.window.document.body,\n\t\t\t\t\tEventType.DROP,\n\t\t\t\t\t(e: DragEvent) => EventHelper.stop(e),\n\t\t\t\t),\n\t\t\t); // Prevent default navigation on drop\n\t\t}\n\t}\n\n\tprivate handleBeforeUnload(e: BeforeUnloadEvent): void {\n\t\t// Check for veto from a listening component\n\t\tlet veto: string | undefined;\n\t\tthis._onBeforeUnload.fire({\n\t\t\tveto(reason) {\n\t\t\t\tif (reason) {\n\t\t\t\t\tveto = reason;\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\tif (veto) {\n\t\t\tthis.handleVetoBeforeClose(e, veto);\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Check for confirm before close setting\n\t\tconst confirmBeforeCloseSetting = this.configurationService.getValue<\n\t\t\t\"always\" | \"never\" | \"keyboardOnly\"\n\t\t>(\"window.confirmBeforeClose\");\n\t\tconst confirmBeforeClose =\n\t\t\tconfirmBeforeCloseSetting === \"always\" ||\n\t\t\t(confirmBeforeCloseSetting === \"keyboardOnly\" &&\n\t\t\t\tModifierKeyEmitter.getInstance().isModifierPressed);\n\t\tif (confirmBeforeClose) {\n\t\t\tthis.confirmBeforeClose(e);\n\t\t}\n\t}\n\n\tprotected handleVetoBeforeClose(\n\t\te: BeforeUnloadEvent,\n\t\treason: string,\n\t): void {\n\t\tthis.preventUnload(e);\n\t}\n\n\tprotected preventUnload(e: BeforeUnloadEvent): void {\n\t\te.preventDefault();\n\t\te.returnValue = localize(\n\t\t\t\"lifecycleVeto\",\n\t\t\t\"Changes that you made may not be saved. Please check press 'Cancel' and try again.\",\n\t\t);\n\t}\n\n\tprotected confirmBeforeClose(e: BeforeUnloadEvent): void {\n\t\tthis.preventUnload(e);\n\t}\n\n\tprivate handleUnload(): void {\n\t\t// Event\n\t\tthis._onUnload.fire();\n\t}\n\n\tlayout(): void {\n\t\t// Split layout up into two events so that downstream components\n\t\t// have a chance to participate in the beginning or end of the\n\t\t// layout phase.\n\t\t// This helps to build the auxiliary window in another component\n\t\t// in the `onWillLayout` phase and then let other compoments\n\t\t// react when the overall layout has finished in `onDidLayout`.\n\n\t\tconst dimension = getClientArea(\n\t\t\tthis.window.document.body,\n\t\t\tthis.container,\n\t\t);\n\t\tthis._onWillLayout.fire(dimension);\n\t\tthis._onDidLayout.fire(dimension);\n\t}\n\n\tcreateState(): IAuxiliaryWindowOpenOptions {\n\t\treturn {\n\t\t\tbounds: {\n\t\t\t\tx: this.window.screenX,\n\t\t\t\ty: this.window.screenY,\n\t\t\t\twidth: this.window.outerWidth,\n\t\t\t\theight: this.window.outerHeight,\n\t\t\t},\n\t\t\tzoomLevel: getZoomLevel(this.window),\n\t\t};\n\t}\n\n\toverride dispose(): void {\n\t\tif (this._store.isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._onWillDispose.fire();\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport class BrowserAuxiliaryWindowService\n\textends Disposable\n\timplements IAuxiliaryWindowService\n{\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static readonly DEFAULT_SIZE = { width: 800, height: 600 };\n\n\tprivate static WINDOW_IDS = getWindowId(mainWindow) + 1; // start from the main window ID + 1\n\n\tprivate readonly _onDidOpenAuxiliaryWindow = this._register(\n\t\tnew Emitter<IAuxiliaryWindowOpenEvent>(),\n\t);\n\treadonly onDidOpenAuxiliaryWindow = this._onDidOpenAuxiliaryWindow.event;\n\n\tprivate readonly windows = new Map<number, IAuxiliaryWindow>();\n\n\tconstructor(\n\t\t@IWorkbenchLayoutService\n\t\tprivate readonly layoutService: IWorkbenchLayoutService,\n\t\t@IDialogService protected readonly dialogService: IDialogService,\n\t\t@IConfigurationService\n\t\tprotected readonly configurationService: IConfigurationService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IHostService protected readonly hostService: IHostService,\n\t\t@IWorkbenchEnvironmentService\n\t\tprotected readonly environmentService: IWorkbenchEnvironmentService,\n\t) {\n\t\tsuper();\n\t}\n\n\tasync open(\n\t\toptions?: IAuxiliaryWindowOpenOptions,\n\t): Promise<IAuxiliaryWindow> {\n\t\tmark(\"code/auxiliaryWindow/willOpen\");\n\n\t\tconst targetWindow = await this.openWindow(options);\n\t\tif (!targetWindow) {\n\t\t\tthrow new Error(\n\t\t\t\tlocalize(\n\t\t\t\t\t\"unableToOpenWindowError\",\n\t\t\t\t\t\"Unable to open a new window.\",\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\t// Add a `vscodeWindowId` property to identify auxiliary windows\n\t\tconst resolvedWindowId = await this.resolveWindowId(targetWindow);\n\t\tensureCodeWindow(targetWindow, resolvedWindowId);\n\n\t\tconst containerDisposables = new DisposableStore();\n\t\tconst { container, stylesLoaded } = this.createContainer(\n\t\t\ttargetWindow,\n\t\t\tcontainerDisposables,\n\t\t\toptions,\n\t\t);\n\n\t\tconst auxiliaryWindow = this.createAuxiliaryWindow(\n\t\t\ttargetWindow,\n\t\t\tcontainer,\n\t\t\tstylesLoaded,\n\t\t);\n\n\t\tconst registryDisposables = new DisposableStore();\n\t\tthis.windows.set(targetWindow.vscodeWindowId, auxiliaryWindow);\n\t\tregistryDisposables.add(\n\t\t\ttoDisposable(() =>\n\t\t\t\tthis.windows.delete(targetWindow.vscodeWindowId),\n\t\t\t),\n\t\t);\n\n\t\tconst eventDisposables = new DisposableStore();\n\n\t\tEvent.once(auxiliaryWindow.onWillDispose)(() => {\n\t\t\ttargetWindow.close();\n\n\t\t\tcontainerDisposables.dispose();\n\t\t\tregistryDisposables.dispose();\n\t\t\teventDisposables.dispose();\n\t\t});\n\n\t\tregistryDisposables.add(registerWindow(targetWindow));\n\t\tthis._onDidOpenAuxiliaryWindow.fire({\n\t\t\twindow: auxiliaryWindow,\n\t\t\tdisposables: eventDisposables,\n\t\t});\n\n\t\tmark(\"code/auxiliaryWindow/didOpen\");\n\n\t\ttype AuxiliaryWindowClassification = {\n\t\t\towner: \"bpasero\";\n\t\t\tcomment: \"An event that fires when an auxiliary window is opened\";\n\t\t\tbounds: {\n\t\t\t\tclassification: \"SystemMetaData\";\n\t\t\t\tpurpose: \"FeatureInsight\";\n\t\t\t\tcomment: \"Has window bounds provided.\";\n\t\t\t};\n\t\t};\n\t\ttype AuxiliaryWindowOpenEvent = {\n\t\t\tbounds: boolean;\n\t\t};\n\t\tthis.telemetryService.publicLog2<\n\t\t\tAuxiliaryWindowOpenEvent,\n\t\t\tAuxiliaryWindowClassification\n\t\t>(\"auxiliaryWindowOpen\", { bounds: !!options?.bounds });\n\n\t\treturn auxiliaryWindow;\n\t}\n\n\tprotected createAuxiliaryWindow(\n\t\ttargetWindow: CodeWindow,\n\t\tcontainer: HTMLElement,\n\t\tstylesLoaded: Barrier,\n\t): AuxiliaryWindow {\n\t\treturn new AuxiliaryWindow(\n\t\t\ttargetWindow,\n\t\t\tcontainer,\n\t\t\tstylesLoaded,\n\t\t\tthis.configurationService,\n\t\t\tthis.hostService,\n\t\t\tthis.environmentService,\n\t\t);\n\t}\n\n\tprivate async openWindow(\n\t\toptions?: IAuxiliaryWindowOpenOptions,\n\t): Promise<Window | undefined> {\n\t\tconst activeWindow = getActiveWindow();\n\t\tconst activeWindowBounds = {\n\t\t\tx: activeWindow.screenX,\n\t\t\ty: activeWindow.screenY,\n\t\t\twidth: activeWindow.outerWidth,\n\t\t\theight: activeWindow.outerHeight,\n\t\t};\n\n\t\tconst width = Math.max(\n\t\t\toptions?.bounds?.width ??\n\t\t\t\tBrowserAuxiliaryWindowService.DEFAULT_SIZE.width,\n\t\t\tWindowMinimumSize.WIDTH,\n\t\t);\n\t\tconst height = Math.max(\n\t\t\toptions?.bounds?.height ??\n\t\t\t\tBrowserAuxiliaryWindowService.DEFAULT_SIZE.height,\n\t\t\tWindowMinimumSize.HEIGHT,\n\t\t);\n\n\t\tlet newWindowBounds: IRectangle = {\n\t\t\tx:\n\t\t\t\toptions?.bounds?.x ??\n\t\t\t\tMath.max(\n\t\t\t\t\tactiveWindowBounds.x +\n\t\t\t\t\t\tactiveWindowBounds.width / 2 -\n\t\t\t\t\t\twidth / 2,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\ty:\n\t\t\t\toptions?.bounds?.y ??\n\t\t\t\tMath.max(\n\t\t\t\t\tactiveWindowBounds.y +\n\t\t\t\t\t\tactiveWindowBounds.height / 2 -\n\t\t\t\t\t\theight / 2,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\twidth,\n\t\t\theight,\n\t\t};\n\n\t\tif (\n\t\t\t!options?.bounds &&\n\t\t\tnewWindowBounds.x === activeWindowBounds.x &&\n\t\t\tnewWindowBounds.y === activeWindowBounds.y\n\t\t) {\n\t\t\t// Offset the new window a bit so that it does not overlap\n\t\t\t// with the active window, unless bounds are provided\n\t\t\tnewWindowBounds = {\n\t\t\t\t...newWindowBounds,\n\t\t\t\tx: newWindowBounds.x + 30,\n\t\t\t\ty: newWindowBounds.y + 30,\n\t\t\t};\n\t\t}\n\n\t\tconst features = coalesce([\n\t\t\t\"popup=yes\",\n\t\t\t`left=${newWindowBounds.x}`,\n\t\t\t`top=${newWindowBounds.y}`,\n\t\t\t`width=${newWindowBounds.width}`,\n\t\t\t`height=${newWindowBounds.height}`,\n\n\t\t\t// non-standard properties\n\t\t\toptions?.nativeTitlebar ? \"window-native-titlebar=yes\" : undefined,\n\t\t\toptions?.disableFullscreen\n\t\t\t\t? \"window-disable-fullscreen=yes\"\n\t\t\t\t: undefined,\n\t\t\toptions?.mode === AuxiliaryWindowMode.Maximized\n\t\t\t\t? \"window-maximized=yes\"\n\t\t\t\t: undefined,\n\t\t\toptions?.mode === AuxiliaryWindowMode.Fullscreen\n\t\t\t\t? \"window-fullscreen=yes\"\n\t\t\t\t: undefined,\n\t\t]);\n\n\t\tconst auxiliaryWindow = mainWindow.open(\n\t\t\tisFirefox\n\t\t\t\t? \"\" /* FF immediately fires an unload event if using about:blank */\n\t\t\t\t: \"about:blank\",\n\t\t\tundefined,\n\t\t\tfeatures.join(\",\"),\n\t\t);\n\t\tif (!auxiliaryWindow && isWeb) {\n\t\t\treturn (\n\t\t\t\tawait this.dialogService.prompt({\n\t\t\t\t\ttype: Severity.Warning,\n\t\t\t\t\tmessage: localize(\n\t\t\t\t\t\t\"unableToOpenWindow\",\n\t\t\t\t\t\t\"The browser interrupted the opening of a new window. Press 'Retry' to try again.\",\n\t\t\t\t\t),\n\t\t\t\t\tdetail: localize(\n\t\t\t\t\t\t\"unableToOpenWindowDetail\",\n\t\t\t\t\t\t\"To avoid this problem in the future, please ensure to allow popups for this website.\",\n\t\t\t\t\t),\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: localize(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tkey: \"retry\",\n\t\t\t\t\t\t\t\t\tcomment: [\"&& denotes a mnemonic\"],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\"&&Retry\",\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\trun: () => this.openWindow(options),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tcancelButton: true,\n\t\t\t\t})\n\t\t\t).result;\n\t\t}\n\n\t\treturn auxiliaryWindow?.window;\n\t}\n\n\tprotected async resolveWindowId(auxiliaryWindow: Window): Promise<number> {\n\t\treturn BrowserAuxiliaryWindowService.WINDOW_IDS++;\n\t}\n\n\tprotected createContainer(\n\t\tauxiliaryWindow: CodeWindow,\n\t\tdisposables: DisposableStore,\n\t\toptions?: IAuxiliaryWindowOpenOptions,\n\t): { stylesLoaded: Barrier; container: HTMLElement } {\n\t\tauxiliaryWindow.document.createElement = () => {\n\t\t\t// Disallow `createElement` because it would create\n\t\t\t// HTML Elements in the \"wrong\" context and break\n\t\t\t// code that does \"instanceof HTMLElement\" etc.\n\t\t\tthrow new Error(\n\t\t\t\t'Not allowed to create elements in child window JavaScript context. Always use the main window so that \"xyz instanceof HTMLElement\" continues to work.',\n\t\t\t);\n\t\t};\n\n\t\tthis.applyMeta(auxiliaryWindow);\n\t\tconst { stylesLoaded } = this.applyCSS(auxiliaryWindow, disposables);\n\t\tconst container = this.applyHTML(auxiliaryWindow, disposables);\n\n\t\treturn { stylesLoaded, container };\n\t}\n\n\tprivate applyMeta(auxiliaryWindow: CodeWindow): void {\n\t\tfor (const metaTag of [\n\t\t\t'meta[charset=\"utf-8\"]',\n\t\t\t'meta[http-equiv=\"Content-Security-Policy\"]',\n\t\t\t'meta[name=\"viewport\"]',\n\t\t\t'meta[name=\"theme-color\"]',\n\t\t]) {\n\t\t\tconst metaElement = mainWindow.document.querySelector(metaTag);\n\t\t\tif (metaElement) {\n\t\t\t\tconst clonedMetaElement = createMetaElement(\n\t\t\t\t\tauxiliaryWindow.document.head,\n\t\t\t\t);\n\t\t\t\tcopyAttributes(metaElement, clonedMetaElement);\n\n\t\t\t\tif (metaTag === 'meta[http-equiv=\"Content-Security-Policy\"]') {\n\t\t\t\t\tconst content = clonedMetaElement.getAttribute(\"content\");\n\t\t\t\t\tif (content) {\n\t\t\t\t\t\tclonedMetaElement.setAttribute(\n\t\t\t\t\t\t\t\"content\",\n\t\t\t\t\t\t\tcontent.replace(\n\t\t\t\t\t\t\t\t/(script-src[^;]*)/,\n\t\t\t\t\t\t\t\t`script-src 'none'`,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst originalIconLinkTag =\n\t\t\tmainWindow.document.querySelector('link[rel=\"icon\"]');\n\t\tif (originalIconLinkTag) {\n\t\t\tconst icon = createLinkElement(auxiliaryWindow.document.head);\n\t\t\tcopyAttributes(originalIconLinkTag, icon);\n\t\t}\n\t}\n\n\tprivate applyCSS(\n\t\tauxiliaryWindow: CodeWindow,\n\t\tdisposables: DisposableStore,\n\t) {\n\t\tmark(\"code/auxiliaryWindow/willApplyCSS\");\n\n\t\tconst mapOriginalToClone = new Map<\n\t\t\tNode /* original */,\n\t\t\tNode /* clone */\n\t\t>();\n\n\t\tconst stylesLoaded = new Barrier();\n\t\tstylesLoaded\n\t\t\t.wait()\n\t\t\t.then(() => mark(\"code/auxiliaryWindow/didLoadCSSStyles\"));\n\n\t\tconst pendingLinksDisposables = disposables.add(new DisposableStore());\n\n\t\tlet pendingLinksToSettle = 0;\n\t\tfunction onLinkSettled() {\n\t\t\tif (--pendingLinksToSettle === 0) {\n\t\t\t\tpendingLinksDisposables.dispose();\n\t\t\t\tstylesLoaded.open();\n\t\t\t}\n\t\t}\n\n\t\tfunction cloneNode(originalNode: Element): void {\n\t\t\tif (isGlobalStylesheet(originalNode)) {\n\t\t\t\treturn; // global stylesheets are handled by `cloneGlobalStylesheets` below\n\t\t\t}\n\n\t\t\tconst clonedNode = auxiliaryWindow.document.head.appendChild(\n\t\t\t\toriginalNode.cloneNode(true),\n\t\t\t);\n\t\t\tif (originalNode.tagName.toLowerCase() === \"link\") {\n\t\t\t\tpendingLinksToSettle++;\n\n\t\t\t\tpendingLinksDisposables.add(\n\t\t\t\t\taddDisposableListener(clonedNode, \"load\", onLinkSettled),\n\t\t\t\t);\n\t\t\t\tpendingLinksDisposables.add(\n\t\t\t\t\taddDisposableListener(clonedNode, \"error\", onLinkSettled),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tmapOriginalToClone.set(originalNode, clonedNode);\n\t\t}\n\n\t\t// Clone all style elements and stylesheet links from the window to the child window\n\t\t// and keep track of <link> elements to settle to signal that styles have loaded\n\t\t// Increment pending links right from the beginning to ensure we only settle when\n\t\t// all style related nodes have been cloned.\n\t\tpendingLinksToSettle++;\n\t\ttry {\n\t\t\tfor (const originalNode of mainWindow.document.head.querySelectorAll(\n\t\t\t\t'link[rel=\"stylesheet\"], style',\n\t\t\t)) {\n\t\t\t\tcloneNode(originalNode);\n\t\t\t}\n\t\t} finally {\n\t\t\tonLinkSettled();\n\t\t}\n\n\t\t// Global stylesheets in <head> are cloned in a special way because the mutation\n\t\t// observer is not firing for changes done via `style.sheet` API. Only text changes\n\t\t// can be observed.\n\t\tdisposables.add(cloneGlobalStylesheets(auxiliaryWindow));\n\n\t\t// Listen to new stylesheets as they are being added or removed in the main window\n\t\t// and apply to child window (including changes to existing stylesheets elements)\n\t\tdisposables.add(\n\t\t\tsharedMutationObserver.observe(\n\t\t\t\tmainWindow.document.head,\n\t\t\t\tdisposables,\n\t\t\t\t{ childList: true, subtree: true },\n\t\t\t)((mutations) => {\n\t\t\t\tfor (const mutation of mutations) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tmutation.type !== \"childList\" || // only interested in added/removed nodes\n\t\t\t\t\t\tmutation.target.nodeName.toLowerCase() === \"title\" || // skip over title changes that happen frequently\n\t\t\t\t\t\tmutation.target.nodeName.toLowerCase() === \"script\" || // block <script> changes that are unsupported anyway\n\t\t\t\t\t\tmutation.target.nodeName.toLowerCase() === \"meta\" // do not observe <meta> elements for now\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const node of mutation.addedNodes) {\n\t\t\t\t\t\t// <style>/<link> element was added\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tisHTMLElement(node) &&\n\t\t\t\t\t\t\t(node.tagName.toLowerCase() === \"style\" ||\n\t\t\t\t\t\t\t\tnode.tagName.toLowerCase() === \"link\")\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tcloneNode(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// text-node was changed, try to apply to our clones\n\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\tnode.nodeType === Node.TEXT_NODE &&\n\t\t\t\t\t\t\tnode.parentNode\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst clonedNode = mapOriginalToClone.get(\n\t\t\t\t\t\t\t\tnode.parentNode,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (clonedNode) {\n\t\t\t\t\t\t\t\tclonedNode.textContent = node.textContent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const node of mutation.removedNodes) {\n\t\t\t\t\t\tconst clonedNode = mapOriginalToClone.get(node);\n\t\t\t\t\t\tif (clonedNode) {\n\t\t\t\t\t\t\tclonedNode.parentNode?.removeChild(clonedNode);\n\t\t\t\t\t\t\tmapOriginalToClone.delete(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tmark(\"code/auxiliaryWindow/didApplyCSS\");\n\n\t\treturn { stylesLoaded };\n\t}\n\n\tprivate applyHTML(\n\t\tauxiliaryWindow: CodeWindow,\n\t\tdisposables: DisposableStore,\n\t): HTMLElement {\n\t\tmark(\"code/auxiliaryWindow/willApplyHTML\");\n\n\t\t// Create workbench container and apply classes\n\t\tconst container = document.createElement(\"div\");\n\t\tcontainer.setAttribute(\"role\", \"application\");\n\t\tposition(container, 0, 0, 0, 0, \"relative\");\n\t\tcontainer.style.display = \"flex\";\n\t\tcontainer.style.height = \"100%\";\n\t\tcontainer.style.flexDirection = \"column\";\n\t\tauxiliaryWindow.document.body.append(container);\n\n\t\t// Track attributes\n\t\tdisposables.add(\n\t\t\ttrackAttributes(\n\t\t\t\tmainWindow.document.documentElement,\n\t\t\t\tauxiliaryWindow.document.documentElement,\n\t\t\t),\n\t\t);\n\t\tdisposables.add(\n\t\t\ttrackAttributes(\n\t\t\t\tmainWindow.document.body,\n\t\t\t\tauxiliaryWindow.document.body,\n\t\t\t),\n\t\t);\n\t\tdisposables.add(\n\t\t\ttrackAttributes(this.layoutService.mainContainer, container, [\n\t\t\t\t\"class\",\n\t\t\t]),\n\t\t); // only class attribute\n\n\t\tmark(\"code/auxiliaryWindow/didApplyHTML\");\n\n\t\treturn container;\n\t}\n\n\tgetWindow(windowId: number): IAuxiliaryWindow | undefined {\n\t\treturn this.windows.get(windowId);\n\t}\n}\n\nregisterSingleton(\n\tIAuxiliaryWindowService,\n\tBrowserAuxiliaryWindowService,\n\tInstantiationType.Delayed,\n);\n"],
  "mappings": "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",
  "names": ["AuxiliaryWindowMode"]
}
