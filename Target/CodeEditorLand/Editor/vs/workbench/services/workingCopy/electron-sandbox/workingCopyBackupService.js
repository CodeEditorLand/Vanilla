var l=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var p=(t,o,e,i)=>{for(var r=i>1?void 0:i?f(o,e):o,s=t.length-1,m;s>=0;s--)(m=t[s])&&(r=(i?m(o,e,r):m(r))||r);return i&&r&&l(o,e,r),r},c=(t,o)=>(e,i)=>o(e,i,t);import{localize as h}from"../../../../nls.js";import{WorkingCopyBackupService as k}from"../common/workingCopyBackupService.js";import{URI as g}from"../../../../base/common/uri.js";import{InstantiationType as u,registerSingleton as I}from"../../../../platform/instantiation/common/extensions.js";import{IWorkingCopyBackupService as v}from"../common/workingCopyBackup.js";import{IFileService as S}from"../../../../platform/files/common/files.js";import{ILogService as b}from"../../../../platform/log/common/log.js";import{INativeWorkbenchEnvironmentService as y}from"../../environment/electron-sandbox/environmentService.js";import{WorkbenchPhase as d,registerWorkbenchContribution2 as L}from"../../../common/contributions.js";import{ILifecycleService as w}from"../../lifecycle/common/lifecycle.js";import{NativeWorkingCopyBackupTracker as a}from"./workingCopyBackupTracker.js";let n=class extends k{constructor(e,i,r,s){super(e.backupPath?g.file(e.backupPath).with({scheme:e.userRoamingDataHome.scheme}):void 0,i,r);this.lifecycleService=s;this.registerListeners()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(e=>e.join(this.joinBackups(),{id:"join.workingCopyBackups",label:h("join.workingCopyBackups","Backup working copies")})))}};n=p([c(0,y),c(1,S),c(2,b),c(3,w)],n),I(v,n,u.Eager),L(a.ID,a,d.BlockStartup);export{n as NativeWorkingCopyBackupService};
