var f=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var c=(a,o,e,i)=>{for(var r=i>1?void 0:i?d(o,e):o,n=a.length-1,t;n>=0;n--)(t=a[n])&&(r=(i?t(o,e,r):t(r))||r);return i&&r&&f(o,e,r),r},s=(a,o)=>(e,i)=>o(e,i,a);import"../../../../../vs/base/common/cancellation.js";import{Disposable as u,toDisposable as v}from"../../../../../vs/base/common/lifecycle.js";import{LinkedList as I}from"../../../../../vs/base/common/linkedList.js";import{IConfigurationService as g}from"../../../../../vs/platform/configuration/common/configuration.js";import"../../../../../vs/platform/files/common/files.js";import{ILogService as S}from"../../../../../vs/platform/log/common/log.js";import"../../../../../vs/workbench/services/workingCopy/common/workingCopyFileService.js";let p=class extends u{constructor(e,i){super();this.logService=e;this.configurationService=i}participants=new I;addFileOperationParticipant(e){const i=this.participants.push(e);return v(()=>i())}async participate(e,i,r,n){const t=this.configurationService.getValue("files.participants.timeout");if(!(typeof t!="number"||t<=0))for(const l of this.participants)try{await l.participate(e,i,r,t,n)}catch(m){this.logService.warn(m)}}dispose(){this.participants.clear(),super.dispose()}};p=c([s(0,S),s(1,g)],p);export{p as WorkingCopyFileOperationParticipant};
