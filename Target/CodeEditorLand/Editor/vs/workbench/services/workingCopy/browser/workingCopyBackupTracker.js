var u=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var f=(n,e,i,o)=>{for(var r=o>1?void 0:o?d(e,i):e,c=n.length-1,p;c>=0;c--)(p=n[c])&&(r=(o?p(e,i,r):p(r))||r);return o&&r&&u(e,i,r),r},t=(n,e)=>(i,o)=>e(i,o,n);import{ILogService as v}from"../../../../../vs/platform/log/common/log.js";import"../../../../../vs/workbench/common/contributions.js";import{IEditorGroupsService as a}from"../../../../../vs/workbench/services/editor/common/editorGroupsService.js";import{IEditorService as g}from"../../../../../vs/workbench/services/editor/common/editorService.js";import{IFilesConfigurationService as I}from"../../../../../vs/workbench/services/filesConfiguration/common/filesConfigurationService.js";import{ILifecycleService as k}from"../../../../../vs/workbench/services/lifecycle/common/lifecycle.js";import{IWorkingCopyBackupService as l}from"../../../../../vs/workbench/services/workingCopy/common/workingCopyBackup.js";import{WorkingCopyBackupTracker as C}from"../../../../../vs/workbench/services/workingCopy/common/workingCopyBackupTracker.js";import{IWorkingCopyEditorService as h}from"../../../../../vs/workbench/services/workingCopy/common/workingCopyEditorService.js";import{IWorkingCopyService as y}from"../../../../../vs/workbench/services/workingCopy/common/workingCopyService.js";let s=class extends C{static ID="workbench.contrib.browserWorkingCopyBackupTracker";constructor(e,i,o,r,c,p,m,S){super(e,o,c,r,i,p,m,S)}onFinalBeforeShutdown(e){const i=this.workingCopyService.modifiedWorkingCopies;if(!i.length)return!1;if(!this.filesConfigurationService.isHotExitEnabled)return!0;for(const o of i)if(!this.workingCopyBackupService.hasBackupSync(o,this.getContentVersion(o)))return this.logService.warn("Unload veto: pending backups"),!0;return!1}};s=f([t(0,l),t(1,I),t(2,y),t(3,k),t(4,v),t(5,h),t(6,g),t(7,a)],s);export{s as BrowserWorkingCopyBackupTracker};
