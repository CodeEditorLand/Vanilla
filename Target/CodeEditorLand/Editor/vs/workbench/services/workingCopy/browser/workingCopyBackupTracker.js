var u=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var f=(n,e,i,o)=>{for(var r=o>1?void 0:o?d(e,i):e,c=n.length-1,p;c>=0;c--)(p=n[c])&&(r=(o?p(e,i,r):p(r))||r);return o&&r&&u(e,i,r),r},t=(n,e)=>(i,o)=>e(i,o,n);import{ILogService as v}from"../../../../platform/log/common/log.js";import{IEditorGroupsService as a}from"../../editor/common/editorGroupsService.js";import{IEditorService as g}from"../../editor/common/editorService.js";import{IFilesConfigurationService as I}from"../../filesConfiguration/common/filesConfigurationService.js";import{ILifecycleService as k}from"../../lifecycle/common/lifecycle.js";import{IWorkingCopyBackupService as l}from"../common/workingCopyBackup.js";import{WorkingCopyBackupTracker as C}from"../common/workingCopyBackupTracker.js";import{IWorkingCopyEditorService as y}from"../common/workingCopyEditorService.js";import{IWorkingCopyService as h}from"../common/workingCopyService.js";let s=class extends C{static ID="workbench.contrib.browserWorkingCopyBackupTracker";constructor(e,i,o,r,c,p,m,S){super(e,o,c,r,i,p,m,S)}onFinalBeforeShutdown(e){const i=this.workingCopyService.modifiedWorkingCopies;if(!i.length)return!1;if(!this.filesConfigurationService.isHotExitEnabled)return!0;for(const o of i)if(!this.workingCopyBackupService.hasBackupSync(o,this.getContentVersion(o)))return this.logService.warn("Unload veto: pending backups"),!0;return!1}};s=f([t(0,l),t(1,I),t(2,h),t(3,k),t(4,v),t(5,y),t(6,g),t(7,a)],s);export{s as BrowserWorkingCopyBackupTracker};
