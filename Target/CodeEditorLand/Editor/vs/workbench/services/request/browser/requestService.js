var m=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var u=(i,o,e,t)=>{for(var r=t>1?void 0:t?d(o,e):o,n=i.length-1,a;n>=0;n--)(a=i[n])&&(r=(t?a(o,e,r):a(r))||r);return t&&r&&m(o,e,r),r},s=(i,o)=>(e,t)=>o(e,t,i);import"../../../../base/common/cancellation.js";import{request as f}from"../../../../base/parts/request/browser/request.js";import"../../../../base/parts/request/common/request.js";import"../../../../editor/browser/editorExtensions.js";import{localize as g}from"../../../../nls.js";import{CommandsRegistry as l}from"../../../../platform/commands/common/commands.js";import{IConfigurationService as h}from"../../../../platform/configuration/common/configuration.js";import{ILoggerService as p}from"../../../../platform/log/common/log.js";import{AbstractRequestService as C}from"../../../../platform/request/common/request.js";import{RequestChannelClient as A}from"../../../../platform/request/common/requestIpc.js";import{IRemoteAgentService as I}from"../../remote/common/remoteAgentService.js";let c=class extends C{constructor(e,t,r){super(r.createLogger("network-window",{name:g("network-window","Network (Window)"),hidden:!0}));this.remoteAgentService=e;this.configurationService=t}async request(e,t){try{e.proxyAuthorization||(e.proxyAuthorization=this.configurationService.getValue("http.proxyAuthorization"));const r=await this.logAndRequest(e,()=>f(e,t)),n=this.remoteAgentService.getConnection();return n&&r.res.statusCode===405?this._makeRemoteRequest(n,e,t):r}catch(r){const n=this.remoteAgentService.getConnection();if(n)return this._makeRemoteRequest(n,e,t);throw r}}async resolveProxy(e){}async lookupAuthorization(e){}async lookupKerberosAuthorization(e){}async loadCertificates(){return[]}_makeRemoteRequest(e,t,r){return e.withChannel("request",n=>new A(n).request(t,r))}};c=u([s(0,I),s(1,h),s(2,p)],c),l.registerCommand("_workbench.fetchJSON",async function(i,o,e){const t=await fetch(o,{method:e,headers:{Accept:"application/json"}});if(t.ok)return t.json();throw new Error(t.statusText)});export{c as BrowserRequestService};
