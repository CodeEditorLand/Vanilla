var v=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var c=(n,r,e,i)=>{for(var t=i>1?void 0:i?h(r,e):r,s=n.length-1,d;s>=0;s--)(d=n[s])&&(t=(i?d(r,e,t):d(t))||t);return i&&t&&v(r,e,t),t},p=(n,r)=>(e,i)=>r(e,i,n);import{Emitter as m}from"../../../../base/common/event.js";import{IUpdateService as l,State as a,UpdateType as u}from"../../../../platform/update/common/update.js";import{InstantiationType as S,registerSingleton as f}from"../../../../platform/instantiation/common/extensions.js";import{IBrowserWorkbenchEnvironmentService as y}from"../../environment/browser/environmentService.js";import{IHostService as U}from"../../host/browser/host.js";import{Disposable as g}from"../../../../base/common/lifecycle.js";let o=class extends g{constructor(e,i){super();this.environmentService=e;this.hostService=i;this.checkForUpdates(!1)}_onStateChange=this._register(new m);onStateChange=this._onStateChange.event;_state=a.Uninitialized;get state(){return this._state}set state(e){this._state=e,this._onStateChange.fire(e)}async isLatestVersion(){const e=await this.doCheckForUpdates(!1);if(e!==void 0)return!!e}async checkForUpdates(e){await this.doCheckForUpdates(e)}async doCheckForUpdates(e){if(this.environmentService.options&&this.environmentService.options.updateProvider){const i=this.environmentService.options.updateProvider;this.state=a.CheckingForUpdates(e);const t=await i.checkForUpdate();return t?this.state=a.Ready({version:t.version,productVersion:t.version}):this.state=a.Idle(u.Archive),t}}async downloadUpdate(){}async applyUpdate(){this.hostService.reload()}async quitAndInstall(){this.hostService.reload()}async _applySpecificUpdate(e){}};o=c([p(0,y),p(1,U)],o),f(l,o,S.Eager);export{o as BrowserUpdateService};
