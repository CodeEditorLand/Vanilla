var IW=Object.defineProperty;var CW=Object.getOwnPropertyDescriptor;var K=(o,e,t,n)=>{for(var i=n>1?void 0:n?CW(e,t):e,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&IW(e,t,i),i},D=(o,e)=>(t,n)=>e(t,n,o);var aE=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Ea.isErrorNoTelemetry(e)?new Ea(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},dE=new aE;function uu(o){dE.onUnexpectedError(o)}function We(o){um(o)||dE.onUnexpectedError(o)}function wa(o){um(o)||dE.onUnexpectedExternalError(o)}var lE="Canceled";function um(o){return o instanceof ci?!0:o instanceof Error&&o.name===lE&&o.message===lE}var ci=class extends Error{constructor(){super(lE),this.name=this.message}};function wd(o){return o?new Error(`Illegal argument: ${o}`):new Error("Illegal argument")}function wR(o){return o?new Error(`Illegal state: ${o}`):new Error("Illegal state")}function cE(o){return o?o.message?o.message:o.stack?o.stack.split(`
`)[0]:String(o):"Error"}var Rb=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}};var Ea=class o extends Error{name;constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof o)return e;let t=new o;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},$e=class o extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,o.prototype)}};function TR(o,e){let t=xW(o,e);if(t!==-1)return o[t]}function xW(o,e,t=o.length-1){for(let n=t;n>=0;n--){let i=o[n];if(e(i))return n}return-1}function uE(o,e){let t=pu(o,e);return t===-1?void 0:o[t]}function pu(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?i=s+1:r=s}return i-1}function Mb(o,e,t=0,n=o.length){let i=t,r=n;for(;i<r;){let s=Math.floor((i+r)/2);e(o[s])?r=s:i=s+1}return i}function LR(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>0&&(t=i)}return t}function DR(o,e){if(o.length===0)return;let t=o[0];for(let n=1;n<o.length;n++){let i=o[n];e(i,t)>=0&&(t=i)}return t}function kR(o,e){return LR(o,(t,n)=>-e(t,n))}function RR(o,e){for(let t of o){let n=e(t);if(n!==void 0)return n}}function Mi(o,e=0){return o[o.length-(1+e)]}function tn(o,e,t=(n,i)=>n===i){if(o===e)return!0;if(!o||!e||o.length!==e.length)return!1;for(let n=0,i=o.length;n<i;n++)if(!t(o[n],e[n]))return!1;return!0}function Ob(o,e,t){return _W(o.length,n=>t(o[n],e))}function _W(o,e){let t=0,n=o-1;for(;t<=n;){let i=(t+n)/2|0,r=e(i);if(r<0)t=i+1;else if(r>0)n=i-1;else return i}return-(t+1)}function Pb(o,e,t){if(o=o|0,o>=e.length)throw new TypeError("invalid index");let n=e[Math.floor(e.length*Math.random())],i=[],r=[],s=[];for(let a of e){let l=t(a,n);l<0?i.push(a):l>0?r.push(a):s.push(a)}return o<i.length?Pb(o,i,t):o<i.length+s.length?s[0]:Pb(o-(i.length+s.length),r,t)}function pE(o,e){let t=[],n;for(let i of o.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function xs(o){return o.filter(e=>!!e)}function MR(o){return!Array.isArray(o)||o.length===0}function hu(o){return Array.isArray(o)&&o.length>0}function dr(o,e=t=>t){let t=new Set;return o.filter(n=>{let i=e(n);return t.has(i)?!1:(t.add(i),!0)})}function pm(o,e){let t=typeof e=="number"?o:0;typeof e=="number"?t=o:(t=0,e=o);let n=[];if(t<=e)for(let i=t;i<e;i++)n.push(i);else for(let i=t;i>e;i--)n.push(i);return n}function Ab(o,e){return o.push(e),()=>EW(o,e)}function EW(o,e){let t=o.indexOf(e);if(t>-1)return o.splice(t,1),e}function _s(o,e,t){let n=o.slice(0,e),i=o.slice(e);return n.concat(t,i)}function hE(o,e){let t;if(typeof e=="number"){let n=e;t=()=>{let i=Math.sin(n++)*179426549;return i-Math.floor(i)}}else t=Math.random;for(let n=o.length-1;n>0;n-=1){let i=Math.floor(t()*(n+1)),r=o[n];o[n]=o[i],o[i]=r}}function mE(o,e){for(let t of e)o.push(t)}var PR;(a=>{function o(l){return l<0}a.isLessThan=o;function e(l){return l<=0}a.isLessThanOrEqual=e;function t(l){return l>0}a.isGreaterThan=t;function n(l){return l===0}a.isNeitherLessOrGreaterThan=n,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(PR||={});function Es(o,e){return(t,n)=>e(o(t),o(n))}var ji=class{constructor(e){this.items=e}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},Ta=class o{constructor(e){this.iterate=e}static empty=new o(e=>{});forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new o(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new o(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(i=>((n||PR.isGreaterThan(e(i,t)))&&(n=!1,t=i),!0)),t}},Nb=class o{constructor(e){this._indexMap=e}static createSortPermutation(e,t){let n=Array.from(e.keys()).sort((i,r)=>t(e[i],e[r]));return new o(n)}apply(e){return e.map((t,n)=>e[this._indexMap[n]])}inverse(){let e=this._indexMap.slice();for(let t=0;t<this._indexMap.length;t++)e[this._indexMap[t]]=t;return new o(e)}};function gE(){return globalThis._VSCODE_NLS_MESSAGES}function hm(){return globalThis._VSCODE_NLS_LANGUAGE}var wW=hm()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Fb(o,e){let t;return e.length===0?t=o:t=o.replace(/\{(\d+)\}/g,(n,i)=>{let r=i[0],s=e[r],a=n;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),wW&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function h(o,e,...t){return Fb(typeof o=="number"?NR(o,e):e,t)}function NR(o,e){let t=gE()?.[o];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${o} !!!`)}return t}function cr(o,e,...t){let n;typeof o=="number"?n=NR(o,e):n=e;let i=Fb(n,t);return{value:i,original:e===n?i:Fb(e,t)}}var mu="en",gm=!1,fm=!1,mm=!1,TW=!1,BR=!1,bE=!1,LW=!1,vE=!1,DW=!1,WR=!1,Bb,Wb=mu,OR=mu,kW,La,Da=globalThis,Ko;typeof Da.vscode<"u"&&typeof Da.vscode.process<"u"?Ko=Da.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Ko=process);var VR=typeof Ko?.versions?.electron=="string",RW=VR&&Ko?.type==="renderer";if(typeof Ko=="object"){gm=Ko.platform==="win32",fm=Ko.platform==="darwin",mm=Ko.platform==="linux",TW=mm&&!!Ko.env.SNAP&&!!Ko.env.SNAP_REVISION,LW=VR,DW=!!Ko.env.CI||!!Ko.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Bb=mu,Wb=mu;let o=Ko.env.VSCODE_NLS_CONFIG;if(o)try{let e=JSON.parse(o);Bb=e.userLocale,OR=e.osLocale,Wb=e.resolvedLanguage||mu,kW=e.languagePack?.translationsConfigFile}catch{}BR=!0}else typeof navigator=="object"&&!RW?(La=navigator.userAgent,gm=La.indexOf("Windows")>=0,fm=La.indexOf("Macintosh")>=0,vE=(La.indexOf("Macintosh")>=0||La.indexOf("iPad")>=0||La.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,mm=La.indexOf("Linux")>=0,WR=La?.indexOf("Mobi")>=0,bE=!0,Wb=hm()||mu,Bb=navigator.language.toLowerCase(),OR=Bb):console.error("Unable to resolve platform.");var fE=0;fm?fE=1:gm?fE=3:mm&&(fE=2);var ct=gm,Ve=fm,Ut=mm;var ka=BR;var kr=bE,MW=bE&&typeof Da.importScripts=="function",HR=MW?Da.origin:void 0,bm=vE,UR=WR;var ws=La,yl=Wb,yE;(n=>{function o(){return yl}n.value=o;function e(){return yl.length===2?yl==="en":yl.length>=3?yl[0]==="e"&&yl[1]==="n"&&yl[2]==="-":!1}n.isDefaultVariant=e;function t(){return yl==="en"}n.isDefault=t})(yE||={});var PW=typeof Da.postMessage=="function"&&!Da.importScripts,Vb=(()=>{if(PW){let o=[];Da.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=o.length;n<i;n++){let r=o[n];if(r.id===t.data.vscodeScheduleAsyncWork){o.splice(n,1),r.callback();return}}});let e=0;return t=>{let n=++e;o.push({id:n,callback:t}),Da.postMessage({vscodeScheduleAsyncWork:n},"*")}}return o=>setTimeout(o)})();var fo=fm||vE?2:gm?1:3,AR=!0,FR=!1;function zR(){if(!FR){FR=!0;let o=new Uint8Array(2);o[0]=1,o[1]=2,AR=new Uint16Array(o.buffer)[0]===513}return AR}var IE=!!(ws&&ws.indexOf("Chrome")>=0),KR=!!(ws&&ws.indexOf("Firefox")>=0),GR=!!(!IE&&ws&&ws.indexOf("Safari")>=0),$R=!!(ws&&ws.indexOf("Edg/")>=0),jR=!!(ws&&ws.indexOf("Android")>=0);var Td,CE=globalThis.vscode;if(typeof CE<"u"&&typeof CE.process<"u"){let o=CE.process;Td={get platform(){return o.platform},get arch(){return o.arch},get env(){return o.env},cwd(){return o.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Td={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Td={get platform(){return ct?"win32":Ve?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var vm=Td.cwd,SE=Td.env,xE=Td.platform,NW=Td.arch;var AW=65,FW=97,BW=90,WW=122,Sl=46,ui=47,bo=92,Il=58,VW=63,Hb=class extends Error{code;constructor(e,t,n){let i;typeof t=="string"&&t.indexOf("not ")===0?(i="must not be",t=t.replace(/^not /,"")):i="must be";let r=e.indexOf(".")!==-1?"property":"argument",s=`The "${e}" ${r} ${i} of type ${t}`;s+=`. Received type ${typeof n}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function HW(o,e){if(o===null||typeof o!="object")throw new Hb(e,"Object",o)}function yn(o,e){if(typeof o!="string")throw new Hb(e,"string",o)}var vo=xE==="win32";function lt(o){return o===ui||o===bo}function _E(o){return o===ui}function Cl(o){return o>=AW&&o<=BW||o>=FW&&o<=WW}function Ub(o,e,t,n){let i="",r=0,s=-1,a=0,l=0;for(let d=0;d<=o.length;++d){if(d<o.length)l=o.charCodeAt(d);else{if(n(l))break;l=ui}if(n(l)){if(!(s===d-1||a===1))if(a===2){if(i.length<2||r!==2||i.charCodeAt(i.length-1)!==Sl||i.charCodeAt(i.length-2)!==Sl){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",r=0):(i=i.slice(0,c),r=i.length-1-i.lastIndexOf(t)),s=d,a=0;continue}else if(i.length!==0){i="",r=0,s=d,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",r=2)}else i.length>0?i+=`${t}${o.slice(s+1,d)}`:i=o.slice(s+1,d),r=d-s-1;s=d,a=0}else l===Sl&&a!==-1?++a:a=-1}return i}function UW(o){return o?`${o[0]==="."?"":"."}${o}`:""}function qR(o,e){HW(e,"pathObject");let t=e.dir||e.root,n=e.base||`${e.name||""}${UW(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${o}${n}`:n}var on={resolve(...o){let e="",t="",n=!1;for(let i=o.length-1;i>=-1;i--){let r;if(i>=0){if(r=o[i],yn(r,`paths[${i}]`),r.length===0)continue}else e.length===0?r=vm():(r=SE[`=${e}`]||vm(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===bo)&&(r=`${e}\\`));let s=r.length,a=0,l="",d=!1,c=r.charCodeAt(0);if(s===1)lt(c)&&(a=1,d=!0);else if(lt(c))if(d=!0,lt(r.charCodeAt(1))){let u=2,p=u;for(;u<s&&!lt(r.charCodeAt(u));)u++;if(u<s&&u!==p){let m=r.slice(p,u);for(p=u;u<s&&lt(r.charCodeAt(u));)u++;if(u<s&&u!==p){for(p=u;u<s&&!lt(r.charCodeAt(u));)u++;(u===s||u!==p)&&(l=`\\\\${m}\\${r.slice(p,u)}`,a=u)}}}else a=1;else Cl(c)&&r.charCodeAt(1)===Il&&(l=r.slice(0,2),a=2,s>2&&lt(r.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,n=d,d&&e.length>0)break}return t=Ub(t,!n,"\\",lt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(o){yn(o,"path");let e=o.length;if(e===0)return".";let t=0,n,i=!1,r=o.charCodeAt(0);if(e===1)return _E(r)?"\\":o;if(lt(r))if(i=!0,lt(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){let d=o.slice(l,a);for(l=a;a<e&&lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!lt(o.charCodeAt(a));)a++;if(a===e)return`\\\\${d}\\${o.slice(l)}\\`;a!==l&&(n=`\\\\${d}\\${o.slice(l,a)}`,t=a)}}}else t=1;else Cl(r)&&o.charCodeAt(1)===Il&&(n=o.slice(0,2),t=2,e>2&&lt(o.charCodeAt(2))&&(i=!0,t=3));let s=t<e?Ub(o.slice(t),!i,"\\",lt):"";return s.length===0&&!i&&(s="."),s.length>0&&lt(o.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(o){yn(o,"path");let e=o.length;if(e===0)return!1;let t=o.charCodeAt(0);return lt(t)||e>2&&Cl(t)&&o.charCodeAt(1)===Il&&lt(o.charCodeAt(2))},join(...o){if(o.length===0)return".";let e,t;for(let r=0;r<o.length;++r){let s=o[r];yn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&lt(t.charCodeAt(0))){++i;let r=t.length;r>1&&lt(t.charCodeAt(1))&&(++i,r>2&&(lt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&lt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return on.normalize(e)},relative(o,e){if(yn(o,"from"),yn(e,"to"),o===e)return"";let t=on.resolve(o),n=on.resolve(e);if(t===n||(o=t.toLowerCase(),e=n.toLowerCase(),o===e))return"";let i=0;for(;i<o.length&&o.charCodeAt(i)===bo;)i++;let r=o.length;for(;r-1>i&&o.charCodeAt(r-1)===bo;)r--;let s=r-i,a=0;for(;a<e.length&&e.charCodeAt(a)===bo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===bo;)l--;let d=l-a,c=s<d?s:d,u=-1,p=0;for(;p<c;p++){let f=o.charCodeAt(i+p);if(f!==e.charCodeAt(a+p))break;f===bo&&(u=p)}if(p!==c){if(u===-1)return n}else{if(d>c){if(e.charCodeAt(a+p)===bo)return n.slice(a+p+1);if(p===2)return n.slice(a+p)}s>c&&(o.charCodeAt(i+p)===bo?u=p:p===2&&(u=3)),u===-1&&(u=0)}let m="";for(p=i+u+1;p<=r;++p)(p===r||o.charCodeAt(p)===bo)&&(m+=m.length===0?"..":"\\..");return a+=u,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===bo&&++a,n.slice(a,l))},toNamespacedPath(o){if(typeof o!="string"||o.length===0)return o;let e=on.resolve(o);if(e.length<=2)return o;if(e.charCodeAt(0)===bo){if(e.charCodeAt(1)===bo){let t=e.charCodeAt(2);if(t!==VW&&t!==Sl)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Cl(e.charCodeAt(0))&&e.charCodeAt(1)===Il&&e.charCodeAt(2)===bo)return`\\\\?\\${e}`;return o},dirname(o){yn(o,"path");let e=o.length;if(e===0)return".";let t=-1,n=0,i=o.charCodeAt(0);if(e===1)return lt(i)?o:".";if(lt(i)){if(t=n=1,lt(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&lt(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!lt(o.charCodeAt(a));)a++;if(a===e)return o;a!==l&&(t=n=a+1)}}}}else Cl(i)&&o.charCodeAt(1)===Il&&(t=e>2&&lt(o.charCodeAt(2))?3:2,n=t);let r=-1,s=!0;for(let a=e-1;a>=n;--a)if(lt(o.charCodeAt(a))){if(!s){r=a;break}}else s=!1;if(r===-1){if(t===-1)return".";r=t}return o.slice(0,r)},basename(o,e){e!==void 0&&yn(e,"suffix"),yn(o,"path");let t=0,n=-1,i=!0,r;if(o.length>=2&&Cl(o.charCodeAt(0))&&o.charCodeAt(1)===Il&&(t=2),e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=t;--r){let l=o.charCodeAt(r);if(lt(l)){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=t;--r)if(lt(o.charCodeAt(r))){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){yn(o,"path");let e=0,t=-1,n=0,i=-1,r=!0,s=0;o.length>=2&&o.charCodeAt(1)===Il&&Cl(o.charCodeAt(0))&&(e=n=2);for(let a=o.length-1;a>=e;--a){let l=o.charCodeAt(a);if(lt(l)){if(!r){n=a+1;break}continue}i===-1&&(r=!1,i=a+1),l===Sl?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":o.slice(t,i)},format:qR.bind(null,"\\"),parse(o){yn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.length,n=0,i=o.charCodeAt(0);if(t===1)return lt(i)?(e.root=e.dir=o,e):(e.base=e.name=o,e);if(lt(i)){if(n=1,lt(o.charCodeAt(1))){let u=2,p=u;for(;u<t&&!lt(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&lt(o.charCodeAt(u));)u++;if(u<t&&u!==p){for(p=u;u<t&&!lt(o.charCodeAt(u));)u++;u===t?n=u:u!==p&&(n=u+1)}}}}else if(Cl(i)&&o.charCodeAt(1)===Il){if(t<=2)return e.root=e.dir=o,e;if(n=2,lt(o.charCodeAt(2))){if(t===3)return e.root=e.dir=o,e;n=3}}n>0&&(e.root=o.slice(0,n));let r=-1,s=n,a=-1,l=!0,d=o.length-1,c=0;for(;d>=n;--d){if(i=o.charCodeAt(d),lt(i)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),i===Sl?r===-1?r=d:c!==1&&(c=1):r!==-1&&(c=-1)}return a!==-1&&(r===-1||c===0||c===1&&r===a-1&&r===s+1?e.base=e.name=o.slice(s,a):(e.name=o.slice(s,r),e.base=o.slice(s,a),e.ext=o.slice(r,a))),s>0&&s!==n?e.dir=o.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},zW=(()=>{if(vo){let o=/\\/g;return()=>{let e=vm().replace(o,"/");return e.slice(e.indexOf("/"))}}return()=>vm()})(),rt={resolve(...o){let e="",t=!1;for(let n=o.length-1;n>=-1&&!t;n--){let i=n>=0?o[n]:zW();yn(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===ui)}return e=Ub(e,!t,"/",_E),t?`/${e}`:e.length>0?e:"."},normalize(o){if(yn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===ui,t=o.charCodeAt(o.length-1)===ui;return o=Ub(o,!e,"/",_E),o.length===0?e?"/":t?"./":".":(t&&(o+="/"),e?`/${o}`:o)},isAbsolute(o){return yn(o,"path"),o.length>0&&o.charCodeAt(0)===ui},join(...o){if(o.length===0)return".";let e;for(let t=0;t<o.length;++t){let n=o[t];yn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":rt.normalize(e)},relative(o,e){if(yn(o,"from"),yn(e,"to"),o===e||(o=rt.resolve(o),e=rt.resolve(e),o===e))return"";let t=1,n=o.length,i=n-t,r=1,s=e.length-r,a=i<s?i:s,l=-1,d=0;for(;d<a;d++){let u=o.charCodeAt(t+d);if(u!==e.charCodeAt(r+d))break;u===ui&&(l=d)}if(d===a)if(s>a){if(e.charCodeAt(r+d)===ui)return e.slice(r+d+1);if(d===0)return e.slice(r+d)}else i>a&&(o.charCodeAt(t+d)===ui?l=d:d===0&&(l=0));let c="";for(d=t+l+1;d<=n;++d)(d===n||o.charCodeAt(d)===ui)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(r+l)}`},toNamespacedPath(o){return o},dirname(o){if(yn(o,"path"),o.length===0)return".";let e=o.charCodeAt(0)===ui,t=-1,n=!0;for(let i=o.length-1;i>=1;--i)if(o.charCodeAt(i)===ui){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":o.slice(0,t)},basename(o,e){e!==void 0&&yn(e,"ext"),yn(o,"path");let t=0,n=-1,i=!0,r;if(e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let s=e.length-1,a=-1;for(r=o.length-1;r>=0;--r){let l=o.charCodeAt(r);if(l===ui){if(!i){t=r+1;break}}else a===-1&&(i=!1,a=r+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=r):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=o.length),o.slice(t,n)}for(r=o.length-1;r>=0;--r)if(o.charCodeAt(r)===ui){if(!i){t=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":o.slice(t,n)},extname(o){yn(o,"path");let e=-1,t=0,n=-1,i=!0,r=0;for(let s=o.length-1;s>=0;--s){let a=o.charCodeAt(s);if(a===ui){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===Sl?e===-1?e=s:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||n===-1||r===0||r===1&&e===n-1&&e===t+1?"":o.slice(e,n)},format:qR.bind(null,"/"),parse(o){yn(o,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;let t=o.charCodeAt(0)===ui,n;t?(e.root="/",n=1):n=0;let i=-1,r=0,s=-1,a=!0,l=o.length-1,d=0;for(;l>=n;--l){let c=o.charCodeAt(l);if(c===ui){if(!a){r=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===Sl?i===-1?i=l:d!==1&&(d=1):i!==-1&&(d=-1)}if(s!==-1){let c=r===0&&t?1:r;i===-1||d===0||d===1&&i===s-1&&i===r+1?e.base=e.name=o.slice(c,s):(e.name=o.slice(c,i),e.base=o.slice(c,s),e.ext=o.slice(i,s))}return r>0?e.dir=o.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};rt.win32=on.win32=on;rt.posix=on.posix=rt;var zb=vo?on.normalize:rt.normalize,Ld=vo?on.isAbsolute:rt.isAbsolute,ym=vo?on.join:rt.join,YR=vo?on.resolve:rt.resolve,XR=vo?on.relative:rt.relative,gu=vo?on.dirname:rt.dirname,ur=vo?on.basename:rt.basename,Kb=vo?on.extname:rt.extname,P8=vo?on.format:rt.format,ZR=vo?on.parse:rt.parse,N8=vo?on.toNamespacedPath:rt.toNamespacedPath,yo=vo?on.sep:rt.sep,O8=vo?on.delimiter:rt.delimiter;var GW=/^\w[\w\d+.-]*$/,$W=/^\//,jW=/^\/\//;function qW(o,e){if(!o.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${o.authority}", path: "${o.path}", query: "${o.query}", fragment: "${o.fragment}"}`);if(o.scheme&&!GW.test(o.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(o.path){if(o.authority){if(!$W.test(o.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(jW.test(o.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function YW(o,e){return!o&&!e?"file":o}function XW(o,e){switch(o){case"https":case"http":case"file":e?e[0]!==Rr&&(e=Rr+e):e=Rr;break}return e}var jt="",Rr="/",ZW=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,le=class o{static isUri(e){return e instanceof o?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,n,i,r,s=!1){typeof e=="object"?(this.scheme=e.scheme||jt,this.authority=e.authority||jt,this.path=e.path||jt,this.query=e.query||jt,this.fragment=e.fragment||jt):(this.scheme=YW(e,s),this.authority=t||jt,this.path=XW(this.scheme,n||jt),this.query=i||jt,this.fragment=r||jt,qW(this,s))}get fsPath(){return Im(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:r,fragment:s}=e;return t===void 0?t=this.scheme:t===null&&(t=jt),n===void 0?n=this.authority:n===null&&(n=jt),i===void 0?i=this.path:i===null&&(i=jt),r===void 0?r=this.query:r===null&&(r=jt),s===void 0?s=this.fragment:s===null&&(s=jt),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&s===this.fragment?this:new xl(t,n,i,r,s)}static parse(e,t=!1){let n=ZW.exec(e);return n?new xl(n[2]||jt,$b(n[4]||jt),$b(n[5]||jt),$b(n[7]||jt),$b(n[9]||jt),t):new xl(jt,jt,jt,jt,jt)}static file(e){let t=jt;if(ct&&(e=e.replace(/\\/g,Rr)),e[0]===Rr&&e[1]===Rr){let n=e.indexOf(Rr,2);n===-1?(t=e.substring(2),e=Rr):(t=e.substring(2,n),e=e.substring(n)||Rr)}return new xl("file",t,e,jt,jt)}static from(e,t){return new xl(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return ct&&e.scheme==="file"?n=o.file(on.join(Im(e,!0),...t)).path:n=rt.join(e.path,...t),e.with({path:n})}toString(e=!1){return EE(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof o)return e;{let t=new xl(e);return t._formatted=e.external??null,t._fsPath=e._sep===eM?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var eM=ct?1:void 0,xl=class extends le{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=Im(this,!1)),this._fsPath}toString(e=!1){return e?EE(this,!0):(this._formatted||(this._formatted=EE(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=eM),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},tM={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function QR(o,e,t){let n,i=-1;for(let r=0;r<o.length;r++){let s=o.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47||t&&s===91||t&&s===93||t&&s===58)i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n!==void 0&&(n+=o.charAt(r));else{n===void 0&&(n=o.substr(0,r));let a=tM[s];a!==void 0?(i!==-1&&(n+=encodeURIComponent(o.substring(i,r)),i=-1),n+=a):i===-1&&(i=r)}}return i!==-1&&(n+=encodeURIComponent(o.substring(i))),n!==void 0?n:o}function QW(o){let e;for(let t=0;t<o.length;t++){let n=o.charCodeAt(t);n===35||n===63?(e===void 0&&(e=o.substr(0,t)),e+=tM[n]):e!==void 0&&(e+=o[t])}return e!==void 0?e:o}function Im(o,e){let t;return o.authority&&o.path.length>1&&o.scheme==="file"?t=`//${o.authority}${o.path}`:o.path.charCodeAt(0)===47&&(o.path.charCodeAt(1)>=65&&o.path.charCodeAt(1)<=90||o.path.charCodeAt(1)>=97&&o.path.charCodeAt(1)<=122)&&o.path.charCodeAt(2)===58?e?t=o.path.substr(1):t=o.path[1].toLowerCase()+o.path.substr(2):t=o.path,ct&&(t=t.replace(/\//g,"\\")),t}function EE(o,e){let t=e?QW:QR,n="",{scheme:i,authority:r,path:s,query:a,fragment:l}=o;if(i&&(n+=i,n+=":"),(r||i==="file")&&(n+=Rr,n+=Rr),r){let d=r.indexOf("@");if(d!==-1){let c=r.substr(0,d);r=r.substr(d+1),d=c.lastIndexOf(":"),d===-1?n+=t(c,!1,!1):(n+=t(c.substr(0,d),!1,!1),n+=":",n+=t(c.substr(d+1),!1,!0)),n+="@"}r=r.toLowerCase(),d=r.lastIndexOf(":"),d===-1?n+=t(r,!1,!0):(n+=t(r.substr(0,d),!1,!0),n+=r.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}n+=t(s,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:QR(l,!1,!1)),n}function nM(o){try{return decodeURIComponent(o)}catch{return o.length>3?o.substr(0,3)+nM(o.substr(3)):o}}var JR=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function $b(o){return o.match(JR)?o.replace(JR,e=>nM(e)):o}function Cm(o,e,t){let n=o.get(e);return n===void 0&&(n=t,o.set(e,n)),n}var wE=class{constructor(e,t){this.uri=e;this.value=t}};function JW(o){return Array.isArray(o)}var pi=class o{static defaultToKey=e=>e.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(e,t){if(e instanceof o)this.map=new Map(e.map),this.toKey=t??o.defaultToKey;else if(JW(e)){this.map=new Map,this.toKey=t??o.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??o.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new wE(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[Symbol.iterator](){for(let[,e]of this.map)yield[e.uri,e.value]}},fu=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(e,t){!e||typeof e=="function"?this._map=new pi(e):(this._map=new pi(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var TE=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},jb=class extends TE{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Pi=class extends jb{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}},qb=class extends jb{constructor(e,t=1){super(e,t)}trim(e){this.trimNew(e)}set(e,t){return this._limit<=this.size&&!this.has(e)&&this.trim(Math.round(this._limit*this._ratio)-1),super.set(e,t),this}};var _l=class{map=new Map;add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){let n=this.map.get(e);n&&(n.delete(t),n.size===0&&this.map.delete(e))}forEach(e,t){let n=this.map.get(e);n&&n.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};function El(o,e){let t=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=o.apply(t,arguments)}finally{e()}else i=o.apply(t,arguments);return i}}var Ts;(C=>{function o(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}C.is=o;let e=Object.freeze([]);function t(){return e}C.empty=t;function*n(S){yield S}C.single=n;function i(S){return o(S)?S:n(S)}C.wrap=i;function r(S){return S||e}C.from=r;function*s(S){for(let _=S.length-1;_>=0;_--)yield S[_]}C.reverse=s;function a(S){return!S||S[Symbol.iterator]().next().done===!0}C.isEmpty=a;function l(S){return S[Symbol.iterator]().next().value}C.first=l;function d(S,_){let R=0;for(let N of S)if(_(N,R++))return!0;return!1}C.some=d;function c(S,_){for(let R of S)if(_(R))return R}C.find=c;function*u(S,_){for(let R of S)_(R)&&(yield R)}C.filter=u;function*p(S,_){let R=0;for(let N of S)yield _(N,R++)}C.map=p;function*m(S,_){let R=0;for(let N of S)yield*_(N,R++)}C.flatMap=m;function*f(...S){for(let _ of S)yield*_}C.concat=f;function g(S,_,R){let N=R;for(let F of S)N=_(N,F);return N}C.reduce=g;function*b(S,_,R=S.length){for(_<0&&(_+=S.length),R<0?R+=S.length:R>S.length&&(R=S.length);_<R;_++)yield S[_]}C.slice=b;function v(S,_=Number.POSITIVE_INFINITY){let R=[];if(_===0)return[R,S];let N=S[Symbol.iterator]();for(let F=0;F<_;F++){let P=N.next();if(P.done)return[R,C.empty()];R.push(P.value)}return[R,{[Symbol.iterator](){return N}}]}C.consume=v;async function I(S){let _=[];for await(let R of S)_.push(R);return Promise.resolve(_)}C.asyncToArray=I})(Ts||={});var tV=!1,Dd=null;function nV(o){Dd=o}if(tV){let o="__is_disposable_tracked__";nV(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[o]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==V.None)try{e[o]=!0}catch{}}markAsDisposed(e){if(e&&e!==V.None)try{e[o]=!0}catch{}}markAsSingleton(e){}})}function kd(o){return Dd?.trackDisposable(o),o}function Rd(o){Dd?.markAsDisposed(o)}function Sm(o,e){Dd?.setParent(o,e)}function iV(o,e){if(Dd)for(let t of o)Dd.setParent(t,e)}function wl(o){return Dd?.markAsSingleton(o),o}function Yb(o){return typeof o=="object"&&o!==null&&typeof o.dispose=="function"&&o.dispose.length===0}function yt(o){if(Ts.is(o)){let e=[];for(let t of o)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(o)?[]:o}else if(o)return o.dispose(),o}function Ls(...o){let e=Ce(()=>yt(o));return iV(o,e),e}function Ce(o){let e=kd({dispose:El(()=>{Rd(e),o()})});return e}var ae=class o{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){kd(this)}dispose(){this._isDisposed||(Rd(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{yt(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return Sm(e,this),this._isDisposed?o.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),Sm(e,null))}},V=class{static None=Object.freeze({dispose(){}});_store=new ae;constructor(){kd(this),Sm(this._store,this)}dispose(){Rd(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Wt=class{_value;_isDisposed=!1;constructor(){kd(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&Sm(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Rd(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&Sm(e,null),e}};var Go=class{_store=new Map;_isDisposed=!1;constructor(){kd(this)}dispose(){Rd(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{yt(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var iM=Object.freeze(function(o,e){let t=setTimeout(o.bind(e),0);return{dispose(){clearTimeout(t)}}}),Qt;(n=>{function o(i){return i===n.None||i===n.Cancelled||i instanceof bu?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=o,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:de.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:iM})})(Qt||={});var bu=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?iM:(this._emitter||(this._emitter=new L),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},jn=class{_token=void 0;_parentListener=void 0;constructor(e){this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new bu),this._token}cancel(){this._token?this._token instanceof bu&&this._token.cancel():this._token=Qt.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof bu&&this._token.dispose():this._token=Qt.None}};var rn=class o{static Undefined=new o(void 0);element;next;prev;constructor(e){this.element=e,this.next=o.Undefined,this.prev=o.Undefined}},An=class{_first=rn.Undefined;_last=rn.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===rn.Undefined}clear(){let e=this._first;for(;e!==rn.Undefined;){let t=e.next;e.prev=rn.Undefined,e.next=rn.Undefined,e=t}this._first=rn.Undefined,this._last=rn.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new rn(e);if(this._first===rn.Undefined)this._first=n,this._last=n;else if(t){let r=this._last;this._last=n,n.prev=r,r.next=n}else{let r=this._first;this._first=n,n.next=r,r.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==rn.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==rn.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==rn.Undefined&&e.next!==rn.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===rn.Undefined&&e.next===rn.Undefined?(this._first=rn.Undefined,this._last=rn.Undefined):e.next===rn.Undefined?(this._last=this._last.prev,this._last.next=rn.Undefined):e.prev===rn.Undefined&&(this._first=this._first.next,this._first.prev=rn.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==rn.Undefined;)yield e.element,e=e.next}};var $o=(o,e)=>o===e;function LE(o=$o){return(e,t)=>tn(e,t,o)}function oM(){return(o,e)=>o.equals(e)}function rM(o,e,t){if(t!==void 0){let n=o;return n==null||e===void 0||e===null?e===n:t(n,e)}else{let n=o;return(i,r)=>i==null||r===void 0||r===null?r===i:n(i,r)}}var qn=class{constructor(e,t,n){this.owner=e;this.debugNameSource=t;this.referenceFn=n}getDebugName(e){return dM(e,this)}},sM=new Map,DE=new WeakMap;function dM(o,e){let t=DE.get(o);if(t)return t;let n=oV(o,e);if(n){let i=sM.get(n)??0;i++,sM.set(n,i);let r=i===1?n:`${n}#${i}`;return DE.set(o,r),r}}function oV(o,e){let t=DE.get(o);if(t)return t;let n=e.owner?sV(e.owner)+".":"",i,r=e.debugNameSource;if(r!==void 0)if(typeof r=="function"){if(i=r(),i!==void 0)return n+i}else return n+r;let s=e.referenceFn;if(s!==void 0&&(i=Xb(s),i!==void 0))return n+i;if(e.owner!==void 0){let a=rV(e.owner,o);if(a!==void 0)return n+a}}function rV(o,e){for(let t in o)if(o[t]===e)return t}var aM=new Map,lM=new WeakMap;function sV(o){let e=lM.get(o);if(e)return e;let t=aV(o),n=aM.get(t)??0;n++,aM.set(t,n);let i=n===1?t:`${t}#${n}`;return lM.set(o,i),i}function aV(o){let e=o.constructor;return e?e.name:"Object"}function Xb(o){let e=o.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}function Zb(o,e){if(!o)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function Md(o,e="Unreachable"){throw new Error(e)}function Pd(o){if(!o()){debugger;o(),We(new $e("Assertion Failed"))}}function kE(o,e){let t=0;for(;t<o.length-1;){let n=o[t],i=o[t+1];if(!e(n,i))return!1;t++}return!0}function jo(o){return new Qb(new qn(void 0,void 0,o),o,void 0,void 0)}var Qb=class{constructor(e,t,n,i){this._debugNameData=e;this._runFn=t;this.createChangeSummary=n;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),Io()?.handleAutorunCreated(this),this._runIfNeeded(),kd(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),Rd(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){Io()?.handleAutorunTriggered(this);let n=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}catch(i){uu(i)}}}finally{t||Io()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}Pd(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e))try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:i=>i===e},this.changeSummary):!0)&&(this.state=2)}catch(n){uu(n)}}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=Qb)(jo||={});function Tl(o,e){return e!==void 0?new Nd(new qn(o,void 0,e),e,void 0,void 0,void 0,$o):new Nd(new qn(void 0,void 0,o),o,void 0,void 0,void 0,$o)}function Mr(o,e){return new Nd(new qn(o.owner,o.debugName,o.debugReferenceFn),e,void 0,void 0,o.onLastObserverRemoved,o.equalsFn??$o)}cM(Mr);function RE(o,e){return new Nd(new qn(o.owner,o.debugName,void 0),e,o.createEmptyChangeSummary,o.handleChange,void 0,o.equalityComparer??$o)}var Nd=class extends Ra{constructor(t,n,i,r,s=void 0,a){super();this._debugNameData=t;this._computeFn=n;this.createChangeSummary=i;this._handleChange=r;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Io()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let n=this.state!==0,i=this.value;this.state=3;let r=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}r=n&&!this._equalityComparator(i,this.value),Io()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:r,hadValue:n})}catch(s){uu(s)}if(r)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this)}Pd(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(t,n){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:t,change:n,didChange:s=>s===t},this.changeSummary):!0}catch(s){uu(s)}let r=this.state===3;if(i&&(this.state===1||r)&&(this.state=2,r))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let n=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),n}addObserver(t){let n=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),n&&t.beginUpdate(this)}removeObserver(t){let n=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),n&&t.endUpdate(this)}};function tv(o){return new ME(o)}var ME=class extends xm{constructor(t){super();this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}};function PE(...o){let e,t,n;return o.length===3?[e,t,n]=o:[t,n]=o,new Ll(new qn(e,void 0,n),t,n,()=>Ll.globalTransaction,$o)}var Ll=class extends Ra{constructor(t,n,i,r,s){super();this._debugNameData=t;this.event=n;this._getValue=i;this._getTransaction=r;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=t=>{let n=this._getValue(t),i=this.value,r=!this.hasValue||!this._equalityComparator(i,n),s=!1;r&&(this.value=n,this.hasValue&&(s=!0,vu(this._getTransaction(),a=>{Io()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Io()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:n,change:void 0,didChange:r,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=Ll;function e(n,i){let r=!1;Ll.globalTransaction===void 0&&(Ll.globalTransaction=n,r=!0);try{i()}finally{r&&(Ll.globalTransaction=void 0)}}t.batchEventsGlobally=e})(PE||={});function NE(o){return typeof o=="string"?new Jb(o):new Jb(void 0,o)}var Jb=class extends Ra{constructor(t,n){super();this._debugName=t;this._owner=n}get debugName(){return new qn(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(t,n){if(!t){Ma(i=>{this.trigger(i,n)},()=>`Trigger signal ${this.debugName}`);return}for(let i of this.observers)t.updateObserver(i,this),i.handleChange(this,n)}get(){}};function pM(o){let e=new ev(!1,void 0);return o.addObserver(e),Ce(()=>{o.removeObserver(e)})}mM(pM);function nv(o,e){let t=new ev(!0,e);return o.addObserver(t),e?e(o.get()):o.reportChanges(),Ce(()=>{o.removeObserver(t)})}hM(nv);var ev=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t}_counter=0;beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};var gM;function fM(o){gM=o}function Io(){return gM}var iv=class{indentation=0;textToConsoleArgs(e){return cV([Iu(hV("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[Iu(" "),Pr(Em(e.oldValue,70),{color:"red",strikeThrough:!0}),Iu(" "),Pr(Em(e.newValue,60),{color:"green"})]:[Iu(" (unchanged)")]:[Iu(" "),Pr(Em(e.newValue,60),{color:"green"}),Iu(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([_m("observable value changed"),Pr(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return Pr(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleDerivedRecomputed(e,t){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([_m("derived recomputed"),Pr(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([_m("observable from event triggered"),Pr(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,i)=>(this.changedObservablesSets.get(e).add(n),t.apply(e,[n,i]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([_m("autorun"),Pr(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([_m("transaction"),Pr(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function cV(o){let e=new Array,t=[],n="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(n+=`%c${s.text}`,e.push(s.style),s.data&&t.push(...s.data)):"data"in s&&t.push(...s.data)}i(o);let r=[n,...e];return r.push(...t),r}function Iu(o){return Pr(o,{color:"black"})}function _m(o){return Pr(mV(`${o}: `,10),{color:"black",bold:!0})}function Pr(o,e={color:"black"}){function t(i){return Object.entries(i).reduce((r,[s,a])=>`${r}${s}:${a};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:o,style:t(n)}}function Em(o,e){switch(typeof o){case"number":return""+o;case"string":return o.length+2<=e?`"${o}"`:`"${o.substr(0,e-7)}"+...`;case"boolean":return o?"true":"false";case"undefined":return"undefined";case"object":return o===null?"null":Array.isArray(o)?uV(o,e):pV(o,e);case"symbol":return o.toString();case"function":return`[[Function${o.name?" "+o.name:""}]]`;default:return""+o}}function uV(o,e){let t="[ ",n=!0;for(let i of o){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${Em(i,e-t.length)}`}return t+=" ]",t}function pV(o,e){let t="{ ",n=!0;for(let[i,r]of Object.entries(o)){if(n||(t+=", "),t.length-5>e){t+="...";break}n=!1,t+=`${i}: ${Em(r,e-t.length)}`}return t+=" }",t}function hV(o,e){let t="";for(let n=1;n<=e;n++)t+=o;return t}function mV(o,e){for(;o.length<e;)o+=" ";return o}var bM;function hM(o){bM=o}var vM;function mM(o){vM=o}var OE;function cM(o){OE=o}var xm=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,i=t===void 0?e:t;return OE({owner:n,debugName:()=>{let r=Xb(i);if(r!==void 0)return r;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:i},r=>i(this.read(r),r))}flatten(){return OE({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(bM(this,t)),this}keepObserved(e){return e.add(vM(this)),this}get debugValue(){return this.get()}},Ra=class extends xm{observers=new Set;addObserver(e){let t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function Ma(o,e){let t=new wm(o,e);try{o(t)}finally{t.finish()}}function vu(o,e,t){o?e(o):Ma(e,t)}var wm=class{constructor(e,t){this._fn=e;this._getDebugName=t;Io()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():Xb(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:n,observable:i}=e[t];n.endUpdate(i)}this.updatingObservers=null,Io()?.handleEndTransaction()}};function yu(o,e){let t;return typeof o=="string"?t=new qn(void 0,o,void 0):t=new qn(o,void 0,void 0),new Tm(t,e,$o)}var Tm=class extends Ra{constructor(t,n,i){super();this._debugNameData=t;this._equalityComparator=i;this._value=n}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(t,n,i){if(i===void 0&&this._equalityComparator(this._value,t))return;let r;n||(n=r=new wm(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(t),Io()?.handleObservableChanged(this,{oldValue:s,newValue:t,change:i,didChange:!0,hadValue:!0});for(let a of this.observers)n.updateObserver(a,this),a.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}};function ov(o,e){let t;return typeof o=="string"?t=new qn(void 0,o,void 0):t=new qn(o,void 0,void 0),new AE(t,e,$o)}var AE=class extends Tm{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}};var gV=!1;gV&&fM(new iv);var fV=globalThis.performance&&typeof globalThis.performance.now=="function",qi=class o{_startTime;_stopTime;_now;static create(e){return new o(e)}constructor(e){this._now=fV&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var FE=Symbol("MicrotaskDelay");var bV=!1,yM=!1,vV=!1,de;(fe=>{fe.None=()=>V.None;function e(ee){if(vV){let{onDidAddListener:X}=ee,se=Lm.create(),te=0;ee.onDidAddListener=()=>{++te===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),se.print()),X?.()}}}function t(ee,X){return m(ee,()=>{},0,void 0,!0,void 0,X)}fe.defer=t;function n(ee){return(X,se=null,te)=>{let Z=!1,ye;return ye=ee(Se=>{if(!Z)return ye?ye.dispose():Z=!0,X.call(se,Se)},null,te),Z&&ye.dispose(),ye}}fe.once=n;function i(ee,X){return fe.once(fe.filter(ee,X))}fe.onceIf=i;function r(ee,X,se){return u((te,Z=null,ye)=>ee(Se=>te.call(Z,X(Se)),null,ye),se)}fe.map=r;function s(ee,X,se){return u((te,Z=null,ye)=>ee(Se=>{X(Se),te.call(Z,Se)},null,ye),se)}fe.forEach=s;function a(ee,X,se){return u((te,Z=null,ye)=>ee(Se=>X(Se)&&te.call(Z,Se),null,ye),se)}fe.filter=a;function l(ee){return ee}fe.signal=l;function d(...ee){return(X,se=null,te)=>{let Z=Ls(...ee.map(ye=>ye(Se=>X.call(se,Se))));return p(Z,te)}}fe.any=d;function c(ee,X,se,te){let Z=se;return r(ee,ye=>(Z=X(Z,ye),Z),te)}fe.reduce=c;function u(ee,X){let se,te={onWillAddFirstListener(){se=ee(Z.fire,Z)},onDidRemoveLastListener(){se?.dispose()}};X||e(te);let Z=new L(te);return X?.add(Z),Z.event}function p(ee,X){return X instanceof Array?X.push(ee):X&&X.add(ee),ee}function m(ee,X,se=100,te=!1,Z=!1,ye,Se){let st,Ze,ke,$n=0,wn,$i={leakWarningThreshold:ye,onWillAddFirstListener(){st=ee(hl=>{$n++,Ze=X(Ze,hl),te&&!ke&&(go.fire(Ze),Ze=void 0),wn=()=>{let ai=Ze;Ze=void 0,ke=void 0,(!te||$n>1)&&go.fire(ai),$n=0},typeof se=="number"?(clearTimeout(ke),ke=setTimeout(wn,se)):ke===void 0&&(ke=0,queueMicrotask(wn))})},onWillRemoveListener(){Z&&$n>0&&wn?.()},onDidRemoveLastListener(){wn=void 0,st.dispose()}};Se||e($i);let go=new L($i);return Se?.add(go),go.event}fe.debounce=m;function f(ee,X=0,se){return fe.debounce(ee,(te,Z)=>te?(te.push(Z),te):[Z],X,void 0,!0,void 0,se)}fe.accumulate=f;function g(ee,X=(te,Z)=>te===Z,se){let te=!0,Z;return a(ee,ye=>{let Se=te||!X(ye,Z);return te=!1,Z=ye,Se},se)}fe.latch=g;function b(ee,X,se){return[fe.filter(ee,X,se),fe.filter(ee,te=>!X(te),se)]}fe.split=b;function v(ee,X=!1,se=[],te){let Z=se.slice(),ye=ee(Ze=>{Z?Z.push(Ze):st.fire(Ze)});te&&te.add(ye);let Se=()=>{Z?.forEach(Ze=>st.fire(Ze)),Z=null},st=new L({onWillAddFirstListener(){ye||(ye=ee(Ze=>st.fire(Ze)),te&&te.add(ye))},onDidAddFirstListener(){Z&&(X?setTimeout(Se):Se())},onDidRemoveLastListener(){ye&&ye.dispose(),ye=null}});return te&&te.add(st),st.event}fe.buffer=v;function I(ee,X){return(te,Z,ye)=>{let Se=X(new S);return ee(function(st){let Ze=Se.evaluate(st);Ze!==C&&te.call(Z,Ze)},void 0,ye)}}fe.chain=I;let C=Symbol("HaltChainable");class S{steps=[];map(X){return this.steps.push(X),this}forEach(X){return this.steps.push(se=>(X(se),se)),this}filter(X){return this.steps.push(se=>X(se)?se:C),this}reduce(X,se){let te=se;return this.steps.push(Z=>(te=X(te,Z),te)),this}latch(X=(se,te)=>se===te){let se=!0,te;return this.steps.push(Z=>{let ye=se||!X(Z,te);return se=!1,te=Z,ye?Z:C}),this}evaluate(X){for(let se of this.steps)if(X=se(X),X===C)break;return X}}function _(ee,X,se=te=>te){let te=(...st)=>Se.fire(se(...st)),Z=()=>ee.on(X,te),ye=()=>ee.removeListener(X,te),Se=new L({onWillAddFirstListener:Z,onDidRemoveLastListener:ye});return Se.event}fe.fromNodeEventEmitter=_;function R(ee,X,se=te=>te){let te=(...st)=>Se.fire(se(...st)),Z=()=>ee.addEventListener(X,te),ye=()=>ee.removeEventListener(X,te),Se=new L({onWillAddFirstListener:Z,onDidRemoveLastListener:ye});return Se.event}fe.fromDOMEventEmitter=R;function N(ee){return new Promise(X=>n(ee)(X))}fe.toPromise=N;function F(ee){let X=new L;return ee.then(se=>{X.fire(se)},()=>{X.fire(void 0)}).finally(()=>{X.dispose()}),X.event}fe.fromPromise=F;function P(ee,X){return ee(se=>X.fire(se))}fe.forward=P;function H(ee,X,se){return X(se),ee(te=>X(te))}fe.runAndSubscribe=H;class U{constructor(X,se){this._observable=X;let te={onWillAddFirstListener:()=>{X.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{X.removeObserver(this)}};se||e(te),this.emitter=new L(te),se&&se.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(X){this._counter++}handlePossibleChange(X){}handleChange(X,se){this._hasChanged=!0}endUpdate(X){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function z(ee,X){return new U(ee,X).emitter.event}fe.fromObservable=z;function oe(ee){return(X,se,te)=>{let Z=0,ye=!1,Se={beginUpdate(){Z++},endUpdate(){Z--,Z===0&&(ee.reportChanges(),ye&&(ye=!1,X.call(se)))},handlePossibleChange(){},handleChange(){ye=!0}};ee.addObserver(Se),ee.reportChanges();let st={dispose(){ee.removeObserver(Se)}};return te instanceof ae?te.add(st):Array.isArray(te)&&te.push(st),st}}fe.fromObservableLight=oe})(de||={});var BE=class o{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(e){this.name=`${e}_${o._idPool++}`,o.all.add(this)}start(e){this._stopWatch=new qi,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},IM=-1;var WE=class o{constructor(e,t,n=(o._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[r,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(r);let l=new VE(a,r);this._errorHandler(l)}return()=>{let r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,i]of this._stacks)(!e||t<i)&&(e=[n,i],t=i);return e}},Lm=class o{constructor(e){this.value=e}static create(){let e=new Error;return new o(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},VE=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},HE=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},yV=0,Cu=class{constructor(e){this.value=e}stack;id=yV++},IV=2,CM=(o,e)=>{if(o instanceof Cu)e(o);else for(let t=0;t<o.length;t++){let n=o[t];n&&e(n)}},rv;if(bV){let o=[];setInterval(()=>{o.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(o.join(`
`)),o.length=0)},3e3),rv=new FinalizationRegistry(e=>{typeof e=="string"&&o.push(e)})}var L=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(e){this._options=e,this._leakageMon=IM>0||this._options?.leakWarningThreshold?new WE(e?.onListenerError??We,this._options?.leakWarningThreshold??IM):void 0,this._perfMon=this._options?._profName?new BE(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(yM){let e=this._listeners;queueMicrotask(()=>{CM(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new HE(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||We)(c),V.None}if(this._disposed)return V.None;t&&(e=e.bind(t));let i=new Cu(e),r,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=Lm.create(),r=this._leakageMon.check(i.stack,this._size+1)),yM&&(i.stack=s??Lm.create()),this._listeners?this._listeners instanceof Cu?(this._deliveryQueue??=new sv,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=Ce(()=>{rv?.unregister(a),r?.(),this._removeListener(i)});if(n instanceof ae?n.add(a):Array.isArray(n)&&n.push(a),rv){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);rv.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*IV<=t.length){let r=0;for(let s=0;s<t.length;s++)t[s]?t[r++]=t[s]:i&&(this._deliveryQueue.end--,r<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=r}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||We;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof Cu)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},SM=()=>new sv,sv=class{i=-1;end=0;current;value;enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},Su=class extends L{_asyncDeliveryQueue;async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new An),CM(this._listeners,i=>this._asyncDeliveryQueue.push([i.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[i,r]=this._asyncDeliveryQueue.shift(),s=[],a={...r,token:t,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,i)),s.push(l)}};try{i(a)}catch(l){We(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&We(d.reason)})}}},Pa=class extends L{_isPaused=0;_eventQueue=new An;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}};var av=class extends L{_queuedEvents=[];_mergeFn;constructor(e){super(e),this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}};var xu=class{data=[];wrapEvent(e,t,n){return(i,r,s)=>e(a=>{let l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>i.call(r,a)):i.call(r,a);return}let d=l;if(!d){i.call(r,t(n,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=n?d.items.reduce(t,n):d.items.reduce(t),i.call(r,d.reducedResult)})},void 0,s)}bufferEvents(e){let t={buffers:new Array};this.data.push(t);let n=e();return this.data.pop(),t.buffers.forEach(i=>i()),n}};var zE;(e=>e.DEFAULT={allowTrailingComma:!0})(zE||={});function SV(o,e=!1){let t=0,n=o.length,i="",r=0,s=16,a=0;function l(g){let b=0,v=0;for(;b<g;){let I=o.charCodeAt(t);if(I>=48&&I<=57)v=v*16+I-48;else if(I>=65&&I<=70)v=v*16+I-65+10;else if(I>=97&&I<=102)v=v*16+I-97+10;else break;t++,b++}return b<g&&(v=-1),v}function d(g){t=g,i="",r=0,s=16,a=0}function c(){let g=t;if(o.charCodeAt(t)===48)t++;else for(t++;t<o.length&&_u(o.charCodeAt(t));)t++;if(t<o.length&&o.charCodeAt(t)===46)if(t++,t<o.length&&_u(o.charCodeAt(t)))for(t++;t<o.length&&_u(o.charCodeAt(t));)t++;else return a=3,o.substring(g,t);let b=t;if(t<o.length&&(o.charCodeAt(t)===69||o.charCodeAt(t)===101))if(t++,(t<o.length&&o.charCodeAt(t)===43||o.charCodeAt(t)===45)&&t++,t<o.length&&_u(o.charCodeAt(t))){for(t++;t<o.length&&_u(o.charCodeAt(t));)t++;b=t}else a=3;return o.substring(g,b)}function u(){let g="",b=t;for(;;){if(t>=n){g+=o.substring(b,t),a=2;break}let v=o.charCodeAt(t);if(v===34){g+=o.substring(b,t),t++;break}if(v===92){if(g+=o.substring(b,t),t++,t>=n){a=2;break}switch(o.charCodeAt(t++)){case 34:g+='"';break;case 92:g+="\\";break;case 47:g+="/";break;case 98:g+="\b";break;case 102:g+="\f";break;case 110:g+=`
`;break;case 114:g+="\r";break;case 116:g+="	";break;case 117:{let C=l(4);C>=0?g+=String.fromCharCode(C):a=4;break}default:a=5}b=t;continue}if(v>=0&&v<=31)if(lv(v)){g+=o.substring(b,t),a=2;break}else a=6;t++}return g}function p(){if(i="",a=0,r=t,t>=n)return r=n,s=17;let g=o.charCodeAt(t);if(UE(g)){do t++,i+=String.fromCharCode(g),g=o.charCodeAt(t);while(UE(g));return s=15}if(lv(g))return t++,i+=String.fromCharCode(g),g===13&&o.charCodeAt(t)===10&&(t++,i+=`
`),s=14;switch(g){case 123:return t++,s=1;case 125:return t++,s=2;case 91:return t++,s=3;case 93:return t++,s=4;case 58:return t++,s=6;case 44:return t++,s=5;case 34:return t++,i=u(),s=10;case 47:{let b=t-1;if(o.charCodeAt(t+1)===47){for(t+=2;t<n&&!lv(o.charCodeAt(t));)t++;return i=o.substring(b,t),s=12}if(o.charCodeAt(t+1)===42){t+=2;let v=n-1,I=!1;for(;t<v;){if(o.charCodeAt(t)===42&&o.charCodeAt(t+1)===47){t+=2,I=!0;break}t++}return I||(t++,a=1),i=o.substring(b,t),s=13}return i+=String.fromCharCode(g),t++,s=16}case 45:if(i+=String.fromCharCode(g),t++,t===n||!_u(o.charCodeAt(t)))return s=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return i+=c(),s=11;default:for(;t<n&&m(g);)t++,g=o.charCodeAt(t);if(r!==t){switch(i=o.substring(r,t),i){case"true":return s=8;case"false":return s=9;case"null":return s=7}return s=16}return i+=String.fromCharCode(g),t++,s=16}}function m(g){if(UE(g)||lv(g))return!1;switch(g){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function f(){let g;do g=p();while(g>=12&&g<=15);return g}return{setPosition:d,getPosition:()=>t,scan:e?f:p,getToken:()=>s,getTokenValue:()=>i,getTokenOffset:()=>r,getTokenLength:()=>t-r,getTokenError:()=>a}}function UE(o){return o===32||o===9||o===11||o===12||o===160||o===5760||o>=8192&&o<=8203||o===8239||o===8287||o===12288||o===65279}function lv(o){return o===10||o===13||o===8232||o===8233}function _u(o){return o>=48&&o<=57}function xM(o,e=[],t=zE.DEFAULT){let n=null,i=[],r=[];function s(l){Array.isArray(i)?i.push(l):n!==null&&(i[n]=l)}return KE(o,{onObjectBegin:()=>{let l={};s(l),r.push(i),i=l,n=null},onObjectProperty:l=>{n=l},onObjectEnd:()=>{i=r.pop()},onArrayBegin:()=>{let l=[];s(l),r.push(i),i=l,n=null},onArrayEnd:()=>{i=r.pop()},onLiteralValue:s,onError:(l,d,c)=>{e.push({error:l,offset:d,length:c})}},t),i[0]}function KE(o,e,t=zE.DEFAULT){let n=SV(o,!1);function i(P){return P?()=>P(n.getTokenOffset(),n.getTokenLength()):()=>!0}function r(P){return P?H=>P(H,n.getTokenOffset(),n.getTokenLength()):()=>!0}let s=i(e.onObjectBegin),a=r(e.onObjectProperty),l=i(e.onObjectEnd),d=i(e.onArrayBegin),c=i(e.onArrayEnd),u=r(e.onLiteralValue),p=r(e.onSeparator),m=i(e.onComment),f=r(e.onError),g=t&&t.disallowComments,b=t&&t.allowTrailingComma;function v(){for(;;){let P=n.scan();switch(n.getTokenError()){case 4:I(14);break;case 5:I(15);break;case 3:I(13);break;case 1:g||I(11);break;case 2:I(12);break;case 6:I(16);break}switch(P){case 12:case 13:g?I(10):m();break;case 16:I(1);break;case 15:case 14:break;default:return P}}}function I(P,H=[],U=[]){if(f(P),H.length+U.length>0){let z=n.getToken();for(;z!==17;){if(H.indexOf(z)!==-1){v();break}else if(U.indexOf(z)!==-1)break;z=v()}}}function C(P){let H=n.getTokenValue();return P?u(H):a(H),v(),!0}function S(){switch(n.getToken()){case 11:{let P=0;try{P=JSON.parse(n.getTokenValue()),typeof P!="number"&&(I(2),P=0)}catch{I(2)}u(P);break}case 7:u(null);break;case 8:u(!0);break;case 9:u(!1);break;default:return!1}return v(),!0}function _(){return n.getToken()!==10?(I(3,[],[2,5]),!1):(C(!1),n.getToken()===6?(p(":"),v(),F()||I(4,[],[2,5])):I(5,[],[2,5]),!0)}function R(){s(),v();let P=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(P||I(4,[],[]),p(","),v(),n.getToken()===2&&b)break}else P&&I(6,[],[]);_()||I(4,[],[2,5]),P=!0}return l(),n.getToken()!==2?I(7,[2],[]):v(),!0}function N(){d(),v();let P=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(P||I(4,[],[]),p(","),v(),n.getToken()===4&&b)break}else P&&I(6,[],[]);F()||I(4,[],[4,5]),P=!0}return c(),n.getToken()!==4?I(8,[4],[]):v(),!0}function F(){switch(n.getToken()){case 3:return N();case 1:return R();case 10:return C(!0);default:return S()}}return v(),n.getToken()===17?t.allowEmptyContent?!0:(I(4,[],[]),!1):F()?(n.getToken()!==17&&I(9,[],[]),!0):(I(4,[],[]),!1)}function _M(o){return o}var dv=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=_M):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Dm=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(e,t){typeof e=="function"?(this._fn=e,this._computeKey=_M):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let n=this._fn(e);return this._map.set(e,n),this._map2.set(t,n),n}};var yi=class{constructor(e){this.executor=e}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Od(o){return o<0?0:o>255?255:o|0}function uv(o){return!o||typeof o!="string"?!0:o.trim().length===0}var xV=/{(\d+)}/g;function jE(o,...e){return e.length===0?o:o.replace(xV,function(t,n){let i=parseInt(n,10);return isNaN(i)||i<0||i>=e.length?t:e[i]})}function wM(o){return o.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function Vd(o){return o.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Ni(o){return o.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function pv(o,e){if(!o||!e)return o;let t=e.length;if(t===0||o.length===0)return o;let n=0;for(;o.indexOf(e,n)===n;)n=n+t;return o.substring(n)}function hv(o,e,t={}){if(!o)throw new Error("Cannot create regex from empty string");e||(o=Ni(o)),t.wholeWord&&(/\B/.test(o.charAt(0))||(o="\\b"+o),/\B/.test(o.charAt(o.length-1))||(o=o+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(o,n)}function Nr(o){return o.split(/\r\n|\r|\n/)}function TM(o){let e=[],t=o.split(/(\r\n|\r|\n)/);for(let n=0;n<Math.ceil(t.length/2);n++)e.push(t[2*n]+(t[2*n+1]??""));return e}function zt(o){for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function kt(o,e=0,t=o.length){for(let n=e;n<t;n++){let i=o.charCodeAt(n);if(i!==32&&i!==9)return o.substring(e,n)}return o.substring(e,t)}function qo(o,e=o.length-1){for(let t=e;t>=0;t--){let n=o.charCodeAt(t);if(n!==32&&n!==9)return t}return-1}function km(o,e){return o<e?-1:o>e?1:0}function mv(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l<d)return-1;if(l>d)return 1}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Co(o,e){return Eu(o,e,0,o.length,0,e.length)}function Eu(o,e,t=0,n=o.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let l=o.charCodeAt(t),d=e.charCodeAt(i);if(l===d)continue;if(l>=128||d>=128)return mv(o.toLowerCase(),e.toLowerCase(),t,n,i,r);Ad(l)&&(l-=32),Ad(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=n-t,a=r-i;return s<a?-1:s>a?1:0}function Rm(o){return o>=48&&o<=57}function Ad(o){return o>=97&&o<=122}function Ds(o){return o>=65&&o<=90}function qt(o,e){return o.length===e.length&&Eu(o,e)===0}function Dl(o,e){let t=e.length;return e.length>o.length?!1:Eu(o,e,0,t)===0}function Or(o,e){let t=Math.min(o.length,e.length),n;for(n=0;n<t;n++)if(o.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function Mm(o,e){let t=Math.min(o.length,e.length),n,i=o.length-1,r=e.length-1;for(n=0;n<t;n++)if(o.charCodeAt(i-n)!==e.charCodeAt(r-n))return n;return t}function At(o){return 55296<=o&&o<=56319}function ks(o){return 56320<=o&&o<=57343}function gv(o,e){return(o-55296<<10)+(e-56320)+65536}function wu(o,e,t){let n=o.charCodeAt(t);if(At(n)&&t+1<e){let i=o.charCodeAt(t+1);if(ks(i))return gv(n,i)}return n}function _V(o,e){let t=o.charCodeAt(e-1);if(ks(t)&&e>1){let n=o.charCodeAt(e-2);if(At(n))return gv(n,t)}return t}var Fd=class{_str;_len;_offset;get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=_V(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){let e=wu(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}},Bd=class{_iterator;get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new Fd(e,t)}nextGraphemeLength(){let e=cv.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let r=t.offset,s=e.getGraphemeBreakType(t.nextCodePoint());if(EM(i,s)){t.setOffset(r);break}i=s}return t.offset-n}prevGraphemeLength(){let e=cv.getInstance(),t=this._iterator,n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let r=t.offset,s=e.getGraphemeBreakType(t.prevCodePoint());if(EM(s,i)){t.setOffset(r);break}i=s}return n-t.offset}eol(){return this._iterator.eol()}};function Pm(o,e){return new Bd(o,e).nextGraphemeLength()}function qE(o,e){return new Bd(o,e).prevGraphemeLength()}function fv(o,e){e>0&&ks(o.charCodeAt(e))&&e--;let t=e+Pm(o,e);return[t-qE(o,t),t]}var GE;function EV(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Na(o){return GE||(GE=EV()),GE.test(o)}var wV=/^[\t\n\r\x20-\x7E]*$/;function Nm(o){return wV.test(o)}var YE=/[\u2028\u2029]/;function bv(o){return YE.test(o)}function Yo(o){return o>=11904&&o<=55215||o>=63744&&o<=64255||o>=65281&&o<=65374}function Om(o){return o>=127462&&o<=127487||o===8986||o===8987||o===9200||o===9203||o>=9728&&o<=10175||o===11088||o===11093||o>=127744&&o<=128591||o>=128640&&o<=128764||o>=128992&&o<=129008||o>=129280&&o<=129535||o>=129648&&o<=129782}var LM=String.fromCharCode(65279);function DM(o){return!!(o&&o.length>0&&o.charCodeAt(0)===65279)}function vv(o){let e=26;return o=o%(2*e),o<e?String.fromCharCode(97+o):String.fromCharCode(65+o-e)}function EM(o,e){return o===0?e!==5&&e!==7:o===2&&e===3?!1:o===4||o===2||o===3||e===4||e===2||e===3?!0:!(o===8&&(e===8||e===9||e===11||e===12)||(o===11||o===9)&&(e===9||e===10)||(o===12||o===10)&&e===10||e===5||e===13||e===7||o===1||o===13&&e===14||o===6&&e===6)}var cv=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_data;constructor(){this._data=TV()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,n=t.length/3,i=1;for(;i<=n;)if(e<t[3*i])i=2*i;else if(e>t[3*i+1])i=2*i+1;else return t[3*i+2];return 0}};function TV(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function kM(o,e){if(o===0)return 0;let t=LV(o,e);if(t!==void 0)return t;let n=new Fd(e,o);return n.prevCodePoint(),n.offset}function LV(o,e){let t=new Fd(e,o),n=t.prevCodePoint();for(;DV(n)||n===65039||n===8419;){if(t.offset===0)return;n=t.prevCodePoint()}if(!Om(n))return;let i=t.offset;return i>0&&t.prevCodePoint()===8205&&(i=t.offset),i}function DV(o){return 127995<=o&&o<=127999}var $E=class o{constructor(e){this.confusableDictionary=e}static ambiguousCharacterData=new yi(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new dv({getCacheKey:JSON.stringify},e=>{function t(c){let u=new Map;for(let p=0;p<c.length;p+=2)u.set(c[p],c[p+1]);return u}function n(c,u){let p=new Map(c);for(let[m,f]of u)p.set(m,f);return p}function i(c,u){if(!c)return u;let p=new Map;for(let[m,f]of c)u.has(m)&&p.set(m,f);return p}let r=this.ambiguousCharacterData.value,s=e.filter(c=>!c.startsWith("_")&&c in r);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=t(r[c]);a=i(a,u)}let l=t(r._common),d=n(l,a);return new o(d)});static getInstance(e){return o.cache.get(Array.from(e))}static _locales=new yi(()=>Object.keys(o.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));static getLocales(){return o._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};var Ie;(ke=>(ke.inMemory="inmemory",ke.vscode="vscode",ke.internal="private",ke.walkThrough="walkThrough",ke.walkThroughSnippet="walkThroughSnippet",ke.http="http",ke.https="https",ke.file="file",ke.mailto="mailto",ke.untitled="untitled",ke.data="data",ke.command="command",ke.vscodeRemote="vscode-remote",ke.vscodeRemoteResource="vscode-remote-resource",ke.vscodeManagedRemoteResource="vscode-managed-remote-resource",ke.vscodeUserData="vscode-userdata",ke.vscodeCustomEditor="vscode-custom-editor",ke.vscodeNotebookCell="vscode-notebook-cell",ke.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",ke.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",ke.vscodeNotebookCellOutput="vscode-notebook-cell-output",ke.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",ke.vscodeNotebookMetadata="vscode-notebook-metadata",ke.vscodeInteractiveInput="vscode-interactive-input",ke.vscodeSettings="vscode-settings",ke.vscodeWorkspaceTrust="vscode-workspace-trust",ke.vscodeTerminal="vscode-terminal",ke.vscodeChatCodeBlock="vscode-chat-code-block",ke.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",ke.vscodeChatSesssion="vscode-chat-editor",ke.webviewPanel="webview-panel",ke.vscodeWebview="vscode-webview",ke.extension="extension",ke.vscodeFileResource="vscode-file",ke.tmp="tmp",ke.vsls="vsls",ke.vscodeSourceControl="vscode-scm",ke.commentsInput="comment",ke.codeSetting="code-setting",ke.outputChannel="output"))(Ie||={});function RM(o,e){return le.isUri(o)?qt(o.scheme,e):Dl(o,e+":")}var kV="tkn",XE=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=RV(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return rt.join(this._serverRootPath,Ie.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return We(a),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let i=this._ports[t],r=this._connectionTokens[t],s=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(s+=`&${kV}=${encodeURIComponent(r)}`),le.from({scheme:kr?this._preferredWebSchema:Ie.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:s})}},yv=new XE;function RV(o,e){return rt.join(e??"/",`${o.quality??"oss"}-${o.commit??"dev"}`)}var QE="vscode-app",ZE=class o{static FALLBACK_AUTHORITY=QE;asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===Ie.vscodeRemote?yv.rewrite(e):e.scheme===Ie.file&&(ka||HR===`${Ie.vscodeFileResource}://${o.FALLBACK_AUTHORITY}`)?e.with({scheme:Ie.vscodeFileResource,authority:e.authority||o.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===Ie.vscodeFileResource?e.with({scheme:Ie.file,authority:e.authority!==o.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if(le.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return le.joinPath(le.parse(n,!0),e);let i=ym(n,e);return le.file(i)}return le.parse(t.toUrl(e))}},Am=new ZE,MV;(r=>{let o=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(o.get("3"));let t="vscode-coi";function n(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:le.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(t);if(l)return o.get(l)}r.getHeadersFromQuery=n;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(t,d):s[t]=d}r.addSearchParam=i})(MV||={});function MM(o,e){let t=o;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}var Yt=window;var Fm=class o{static INSTANCE=new o;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new L;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(e){return this.mapWindowIdToZoomLevel.get(this.getWindowId(e))??0}setZoomLevel(e,t){if(this.getZoomLevel(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToZoomLevel.set(n,e),this._onDidChangeZoomLevel.fire(n)}mapWindowIdToZoomFactor=new Map;getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}setZoomFactor(e,t){this.mapWindowIdToZoomFactor.set(this.getWindowId(t),e)}_onDidChangeFullscreen=new L;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(e,t){if(this.isFullscreen(t)===e)return;let n=this.getWindowId(t);this.mapWindowIdToFullScreen.set(n,e),this._onDidChangeFullscreen.fire(n)}isFullscreen(e){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(e))}getWindowId(e){return e.vscodeWindowId}};function NV(o,e,t){typeof e=="string"&&(e=o.matchMedia(e)),e.addEventListener("change",t)}var dG=Fm.INSTANCE.onDidChangeZoomLevel;function PM(o){return Fm.INSTANCE.getZoomFactor(o)}var cG=Fm.INSTANCE.onDidChangeFullscreen,Tu=navigator.userAgent,In=Tu.indexOf("Firefox")>=0,Ar=Tu.indexOf("AppleWebKit")>=0,kl=Tu.indexOf("Chrome")>=0,Xo=!kl&&Tu.indexOf("Safari")>=0,NM=!kl&&!Xo&&Ar,uG=Tu.indexOf("Electron/")>=0,JE=Tu.indexOf("Android")>=0,Iv=!1;if(typeof Yt.matchMedia=="function"){let o=Yt.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Yt.matchMedia("(display-mode: fullscreen)");Iv=o.matches,NV(Yt,o,({matches:t})=>{Iv&&e.matches||(Iv=t)})}function OM(){return Iv}var Bm=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},Cv=new Bm,ew=new Bm,tw=new Bm,iw=new Array(230),OV={},AV=[],FV=Object.create(null),BV=Object.create(null);var AM=[],nw=[];for(let o=0;o<=193;o++)AM[o]=-1;for(let o=0;o<=132;o++)nw[o]=-1;(function(){let o="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",o,o],[1,1,"Hyper",0,o,0,o,o,o],[1,2,"Super",0,o,0,o,o,o],[1,3,"Fn",0,o,0,o,o,o],[1,4,"FnLock",0,o,0,o,o,o],[1,5,"Suspend",0,o,0,o,o,o],[1,6,"Resume",0,o,0,o,o,o],[1,7,"Turbo",0,o,0,o,o,o],[1,8,"Sleep",0,o,0,"VK_SLEEP",o,o],[1,9,"WakeUp",0,o,0,o,o,o],[0,10,"KeyA",31,"A",65,"VK_A",o,o],[0,11,"KeyB",32,"B",66,"VK_B",o,o],[0,12,"KeyC",33,"C",67,"VK_C",o,o],[0,13,"KeyD",34,"D",68,"VK_D",o,o],[0,14,"KeyE",35,"E",69,"VK_E",o,o],[0,15,"KeyF",36,"F",70,"VK_F",o,o],[0,16,"KeyG",37,"G",71,"VK_G",o,o],[0,17,"KeyH",38,"H",72,"VK_H",o,o],[0,18,"KeyI",39,"I",73,"VK_I",o,o],[0,19,"KeyJ",40,"J",74,"VK_J",o,o],[0,20,"KeyK",41,"K",75,"VK_K",o,o],[0,21,"KeyL",42,"L",76,"VK_L",o,o],[0,22,"KeyM",43,"M",77,"VK_M",o,o],[0,23,"KeyN",44,"N",78,"VK_N",o,o],[0,24,"KeyO",45,"O",79,"VK_O",o,o],[0,25,"KeyP",46,"P",80,"VK_P",o,o],[0,26,"KeyQ",47,"Q",81,"VK_Q",o,o],[0,27,"KeyR",48,"R",82,"VK_R",o,o],[0,28,"KeyS",49,"S",83,"VK_S",o,o],[0,29,"KeyT",50,"T",84,"VK_T",o,o],[0,30,"KeyU",51,"U",85,"VK_U",o,o],[0,31,"KeyV",52,"V",86,"VK_V",o,o],[0,32,"KeyW",53,"W",87,"VK_W",o,o],[0,33,"KeyX",54,"X",88,"VK_X",o,o],[0,34,"KeyY",55,"Y",89,"VK_Y",o,o],[0,35,"KeyZ",56,"Z",90,"VK_Z",o,o],[0,36,"Digit1",22,"1",49,"VK_1",o,o],[0,37,"Digit2",23,"2",50,"VK_2",o,o],[0,38,"Digit3",24,"3",51,"VK_3",o,o],[0,39,"Digit4",25,"4",52,"VK_4",o,o],[0,40,"Digit5",26,"5",53,"VK_5",o,o],[0,41,"Digit6",27,"6",54,"VK_6",o,o],[0,42,"Digit7",28,"7",55,"VK_7",o,o],[0,43,"Digit8",29,"8",56,"VK_8",o,o],[0,44,"Digit9",30,"9",57,"VK_9",o,o],[0,45,"Digit0",21,"0",48,"VK_0",o,o],[1,46,"Enter",3,"Enter",13,"VK_RETURN",o,o],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",o,o],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",o,o],[1,49,"Tab",2,"Tab",9,"VK_TAB",o,o],[1,50,"Space",10,"Space",32,"VK_SPACE",o,o],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,o,0,o,o,o],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",o,o],[1,64,"F1",59,"F1",112,"VK_F1",o,o],[1,65,"F2",60,"F2",113,"VK_F2",o,o],[1,66,"F3",61,"F3",114,"VK_F3",o,o],[1,67,"F4",62,"F4",115,"VK_F4",o,o],[1,68,"F5",63,"F5",116,"VK_F5",o,o],[1,69,"F6",64,"F6",117,"VK_F6",o,o],[1,70,"F7",65,"F7",118,"VK_F7",o,o],[1,71,"F8",66,"F8",119,"VK_F8",o,o],[1,72,"F9",67,"F9",120,"VK_F9",o,o],[1,73,"F10",68,"F10",121,"VK_F10",o,o],[1,74,"F11",69,"F11",122,"VK_F11",o,o],[1,75,"F12",70,"F12",123,"VK_F12",o,o],[1,76,"PrintScreen",0,o,0,o,o,o],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",o,o],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",o,o],[1,79,"Insert",19,"Insert",45,"VK_INSERT",o,o],[1,80,"Home",14,"Home",36,"VK_HOME",o,o],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",o,o],[1,82,"Delete",20,"Delete",46,"VK_DELETE",o,o],[1,83,"End",13,"End",35,"VK_END",o,o],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",o,o],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",o],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",o],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",o],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",o],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",o,o],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",o,o],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",o,o],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",o,o],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",o,o],[1,94,"NumpadEnter",3,o,0,o,o,o],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",o,o],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",o,o],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",o,o],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",o,o],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",o,o],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",o,o],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",o,o],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",o,o],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",o,o],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",o,o],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",o,o],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",o,o],[1,107,"ContextMenu",58,"ContextMenu",93,o,o,o],[1,108,"Power",0,o,0,o,o,o],[1,109,"NumpadEqual",0,o,0,o,o,o],[1,110,"F13",71,"F13",124,"VK_F13",o,o],[1,111,"F14",72,"F14",125,"VK_F14",o,o],[1,112,"F15",73,"F15",126,"VK_F15",o,o],[1,113,"F16",74,"F16",127,"VK_F16",o,o],[1,114,"F17",75,"F17",128,"VK_F17",o,o],[1,115,"F18",76,"F18",129,"VK_F18",o,o],[1,116,"F19",77,"F19",130,"VK_F19",o,o],[1,117,"F20",78,"F20",131,"VK_F20",o,o],[1,118,"F21",79,"F21",132,"VK_F21",o,o],[1,119,"F22",80,"F22",133,"VK_F22",o,o],[1,120,"F23",81,"F23",134,"VK_F23",o,o],[1,121,"F24",82,"F24",135,"VK_F24",o,o],[1,122,"Open",0,o,0,o,o,o],[1,123,"Help",0,o,0,o,o,o],[1,124,"Select",0,o,0,o,o,o],[1,125,"Again",0,o,0,o,o,o],[1,126,"Undo",0,o,0,o,o,o],[1,127,"Cut",0,o,0,o,o,o],[1,128,"Copy",0,o,0,o,o,o],[1,129,"Paste",0,o,0,o,o,o],[1,130,"Find",0,o,0,o,o,o],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",o,o],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",o,o],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",o,o],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",o,o],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",o,o],[1,136,"KanaMode",0,o,0,o,o,o],[0,137,"IntlYen",0,o,0,o,o,o],[1,138,"Convert",0,o,0,o,o,o],[1,139,"NonConvert",0,o,0,o,o,o],[1,140,"Lang1",0,o,0,o,o,o],[1,141,"Lang2",0,o,0,o,o,o],[1,142,"Lang3",0,o,0,o,o,o],[1,143,"Lang4",0,o,0,o,o,o],[1,144,"Lang5",0,o,0,o,o,o],[1,145,"Abort",0,o,0,o,o,o],[1,146,"Props",0,o,0,o,o,o],[1,147,"NumpadParenLeft",0,o,0,o,o,o],[1,148,"NumpadParenRight",0,o,0,o,o,o],[1,149,"NumpadBackspace",0,o,0,o,o,o],[1,150,"NumpadMemoryStore",0,o,0,o,o,o],[1,151,"NumpadMemoryRecall",0,o,0,o,o,o],[1,152,"NumpadMemoryClear",0,o,0,o,o,o],[1,153,"NumpadMemoryAdd",0,o,0,o,o,o],[1,154,"NumpadMemorySubtract",0,o,0,o,o,o],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",o,o],[1,156,"NumpadClearEntry",0,o,0,o,o,o],[1,0,o,5,"Ctrl",17,"VK_CONTROL",o,o],[1,0,o,4,"Shift",16,"VK_SHIFT",o,o],[1,0,o,6,"Alt",18,"VK_MENU",o,o],[1,0,o,57,"Meta",91,"VK_COMMAND",o,o],[1,157,"ControlLeft",5,o,0,"VK_LCONTROL",o,o],[1,158,"ShiftLeft",4,o,0,"VK_LSHIFT",o,o],[1,159,"AltLeft",6,o,0,"VK_LMENU",o,o],[1,160,"MetaLeft",57,o,0,"VK_LWIN",o,o],[1,161,"ControlRight",5,o,0,"VK_RCONTROL",o,o],[1,162,"ShiftRight",4,o,0,"VK_RSHIFT",o,o],[1,163,"AltRight",6,o,0,"VK_RMENU",o,o],[1,164,"MetaRight",57,o,0,"VK_RWIN",o,o],[1,165,"BrightnessUp",0,o,0,o,o,o],[1,166,"BrightnessDown",0,o,0,o,o,o],[1,167,"MediaPlay",0,o,0,o,o,o],[1,168,"MediaRecord",0,o,0,o,o,o],[1,169,"MediaFastForward",0,o,0,o,o,o],[1,170,"MediaRewind",0,o,0,o,o,o],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",o,o],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",o,o],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",o,o],[1,174,"Eject",0,o,0,o,o,o],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",o,o],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",o,o],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",o,o],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",o,o],[1,179,"LaunchApp1",0,o,0,"VK_MEDIA_LAUNCH_APP1",o,o],[1,180,"SelectTask",0,o,0,o,o,o],[1,181,"LaunchScreenSaver",0,o,0,o,o,o],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",o,o],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",o,o],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",o,o],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",o,o],[1,186,"BrowserStop",0,o,0,"VK_BROWSER_STOP",o,o],[1,187,"BrowserRefresh",0,o,0,"VK_BROWSER_REFRESH",o,o],[1,188,"BrowserFavorites",0,o,0,"VK_BROWSER_FAVORITES",o,o],[1,189,"ZoomToggle",0,o,0,o,o,o],[1,190,"MailReply",0,o,0,o,o,o],[1,191,"MailForward",0,o,0,o,o,o],[1,192,"MailSend",0,o,0,o,o,o],[1,0,o,114,"KeyInComposition",229,o,o,o],[1,0,o,116,"ABNT_C2",194,"VK_ABNT_C2",o,o],[1,0,o,96,"OEM_8",223,"VK_OEM_8",o,o],[1,0,o,0,o,0,"VK_KANA",o,o],[1,0,o,0,o,0,"VK_HANGUL",o,o],[1,0,o,0,o,0,"VK_JUNJA",o,o],[1,0,o,0,o,0,"VK_FINAL",o,o],[1,0,o,0,o,0,"VK_HANJA",o,o],[1,0,o,0,o,0,"VK_KANJI",o,o],[1,0,o,0,o,0,"VK_CONVERT",o,o],[1,0,o,0,o,0,"VK_NONCONVERT",o,o],[1,0,o,0,o,0,"VK_ACCEPT",o,o],[1,0,o,0,o,0,"VK_MODECHANGE",o,o],[1,0,o,0,o,0,"VK_SELECT",o,o],[1,0,o,0,o,0,"VK_PRINT",o,o],[1,0,o,0,o,0,"VK_EXECUTE",o,o],[1,0,o,0,o,0,"VK_SNAPSHOT",o,o],[1,0,o,0,o,0,"VK_HELP",o,o],[1,0,o,0,o,0,"VK_APPS",o,o],[1,0,o,0,o,0,"VK_PROCESSKEY",o,o],[1,0,o,0,o,0,"VK_PACKET",o,o],[1,0,o,0,o,0,"VK_DBE_SBCSCHAR",o,o],[1,0,o,0,o,0,"VK_DBE_DBCSCHAR",o,o],[1,0,o,0,o,0,"VK_ATTN",o,o],[1,0,o,0,o,0,"VK_CRSEL",o,o],[1,0,o,0,o,0,"VK_EXSEL",o,o],[1,0,o,0,o,0,"VK_EREOF",o,o],[1,0,o,0,o,0,"VK_PLAY",o,o],[1,0,o,0,o,0,"VK_ZOOM",o,o],[1,0,o,0,o,0,"VK_NONAME",o,o],[1,0,o,0,o,0,"VK_PA1",o,o],[1,0,o,0,o,0,"VK_OEM_CLEAR",o,o]],t=[],n=[];for(let i of e){let[r,s,a,l,d,c,u,p,m]=i;if(n[s]||(n[s]=!0,AV[s]=a,FV[a]=s,BV[a.toLowerCase()]=s,r&&(AM[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(nw[l]=s))),!t[l]){if(t[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);Cv.define(l,d),ew.define(l,p||d),tw.define(l,m||p||d)}c&&(iw[c]=l),u&&(OV[u]=l)}nw[3]=46})();var Wm;(s=>{function o(a){return Cv.keyCodeToStr(a)}s.toString=o;function e(a){return Cv.strToKeyCode(a)}s.fromString=e;function t(a){return ew.keyCodeToStr(a)}s.toUserSettingsUS=t;function n(a){return tw.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function i(a){return ew.strToKeyCode(a)||tw.strToKeyCode(a)}s.fromUserSettings=i;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Cv.keyCodeToStr(a)}s.toElectronAccelerator=r})(Wm||={});function Lt(o){return typeof o=="string"}function ow(o){return Array.isArray(o)&&o.every(e=>Lt(e))}function Ht(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&!(o instanceof RegExp)&&!(o instanceof Date)}function Yi(o){return typeof o=="number"&&!isNaN(o)}function Sv(o){return o===!0||o===!1}function Oi(o){return typeof o>"u"}function Hd(o){return!Yn(o)}function Yn(o){return Oi(o)||o===null}function hi(o,e){if(!o)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Rs(o){if(Yn(o))throw new Error("Assertion Failed: argument is undefined or null");return o}var WV=Object.prototype.hasOwnProperty;function xv(o){if(!Ht(o))return!1;for(let e in o)if(WV.call(o,e))return!1;return!0}function Vm(o){return typeof o=="function"}function FM(o,e){let t=Math.min(o.length,e.length);for(let n=0;n<t;n++)VV(o[n],e[n])}function VV(o,e){if(Lt(e)){if(typeof o!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Vm(e)){try{if(o instanceof e)return}catch{}if(!Yn(o)&&o.constructor===e||e.length===1&&e.call(void 0,o)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var _v={clipboard:{writeText:ka||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:ka||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:ka||OM()?0:navigator.keyboard||Xo?1:2,touch:"ontouchstart"in Yt||navigator.maxTouchPoints>0,pointerEvents:Yt.PointerEvent&&("ontouchstart"in Yt||navigator.maxTouchPoints>0)};function rw(o,e){if(typeof o=="number"){if(o===0)return null;let t=(o&65535)>>>0,n=(o&4294901760)>>>16;return n!==0?new Lu([Ev(t,e),Ev(n,e)]):new Lu([Ev(t,e)])}else{let t=[];for(let n=0;n<o.length;n++)t.push(Ev(o[n],e));return new Lu(t)}}function Ev(o,e){let t=!!(o&2048),n=!!(o&256),i=e===2?n:t,r=!!(o&1024),s=!!(o&512),a=e===2?t:n,l=o&255;return new Pl(i,r,s,a,l)}var Pl=class o{constructor(e,t,n,i,r){this.ctrlKey=e;this.shiftKey=t;this.altKey=n;this.metaKey=i;this.keyCode=r}equals(e){return e instanceof o&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){let e=this.ctrlKey?"1":"0",t=this.shiftKey?"1":"0",n=this.altKey?"1":"0",i=this.metaKey?"1":"0";return`K${e}${t}${n}${i}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new Lu([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var Lu=class{chords;constructor(e){if(e.length===0)throw wd("chords");this.chords=e}getHashCode(){let e="";for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};function HV(o){if(o.charCode){let t=String.fromCharCode(o.charCode).toUpperCase();return Wm.fromString(t)}let e=o.keyCode;if(e===3)return 7;if(In)switch(e){case 59:return 85;case 60:if(Ut)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Ve)return 57;break}else if(Ar){if(Ve&&e===93)return 57;if(!Ve&&e===92)return 57}return iw[e]||0}var UV=Ve?256:2048,zV=512,KV=1024,GV=Ve?2048:256;var pt=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(e){let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=HV(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=UV),this.altKey&&(t|=zV),this.shiftKey&&(t|=KV),this.metaKey&&(t|=GV),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new Pl(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}};var BM=new WeakMap;function $V(o){if(!o.parent||o.parent===o)return null;try{let e=o.location,t=o.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return o.parent}var wv=class{static getSameOriginWindowChain(e){let t=BM.get(e);if(!t){t=[],BM.set(e,t);let n=e,i;do i=$V(n),i?t.push({window:new WeakRef(n),iframeElement:n.frameElement||null}):t.push({window:new WeakRef(n),iframeElement:null}),n=i;while(n)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain(e);for(let s of r){let a=s.window.deref();if(n+=a?.scrollY??0,i+=a?.scrollX??0,a===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();n+=l.top,i+=l.left}return{top:n,left:i}}};var Ai=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=wv.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Zo=class{browserEvent;deltaY;deltaX;target;constructor(e,t=0,n=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t;let i=!1;if(kl){let r=navigator.userAgent.match(/Chrome\/(\d+)/);i=(r?parseInt(r[1]):123)<=122}if(e){let r=e,s=e,a=e.view?.devicePixelRatio||1;if(typeof r.wheelDeltaY<"u")i?this.deltaY=r.wheelDeltaY/(120*a):this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?In&&!Ve?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")Xo&&ct?this.deltaX=-(r.wheelDeltaX/120):i?this.deltaX=r.wheelDeltaX/(120*a):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?In&&!Ve?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(i?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};function Nl(o){return o===47||o===92}function Tv(o){return o.replace(/[\\/]/g,rt.sep)}function VM(o){return o.indexOf("/")===-1&&(o=Tv(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}function sw(o,e=rt.sep){if(!o)return"";let t=o.length,n=o.charCodeAt(0);if(Nl(n)){if(Nl(o.charCodeAt(1))&&!Nl(o.charCodeAt(2))){let r=3,s=r;for(;r<t&&!Nl(o.charCodeAt(r));r++);if(s!==r&&!Nl(o.charCodeAt(r+1))){for(r+=1;r<t;r++)if(Nl(o.charCodeAt(r)))return o.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(UM(n)&&o.charCodeAt(1)===58)return Nl(o.charCodeAt(2))?o.slice(0,2)+e:o.slice(0,2);let i=o.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Nl(o.charCodeAt(i)))return o.slice(0,i+1)}return""}var jV=/[\\/:\*\?"<>\|]/g,qV=/[/]/g,YV=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function HM(o,e=ct){let t=e?jV:qV;return!(!o||o.length===0||/^\s+$/.test(o)||(t.lastIndex=0,t.test(o))||e&&YV.test(o)||o==="."||o===".."||e&&o[o.length-1]==="."||e&&o.length!==o.trim().length||o.length>255)}function Hm(o,e,t,n=yo){if(o===e)return!0;if(!o||!e||e.length>o.length)return!1;if(t){if(!Dl(o,e))return!1;if(e.length===o.length)return!0;let r=e.length;return e.charAt(e.length-1)===n&&r--,o.charAt(r)===n}return e.charAt(e.length-1)!==n&&(e+=n),o.indexOf(e)===0}function UM(o){return o>=65&&o<=90||o>=97&&o<=122}function aw(o,e=ct){return e?UM(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}function zM(o,e=ct){return aw(o,e)?o[0]:void 0}function Oa(o){return Im(o,!0)}var Um=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:km(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===Ie.file)return Hm(Oa(e),Oa(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(KM(e.authority,t.authority))return Hm(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return le.joinPath(e,...t)}basenameOrAuthority(e){return Qo(e)||e.authority}basename(e){return rt.basename(e.path)}extname(e){return rt.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Ie.file?t=le.file(gu(Oa(e))).path:(t=rt.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Ie.file?t=le.file(zb(Oa(e))).path:t=rt.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!KM(e.authority,t.authority))return;if(e.scheme===Ie.file){let r=XR(Oa(e),Oa(t));return ct?Tv(r):r}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(let s=Math.min(n.length,i.length);r<s&&!(n.charCodeAt(r)!==i.charCodeAt(r)&&n.charAt(r).toLowerCase()!==i.charAt(r).toLowerCase());r++);n=i.substr(0,r)+n.substr(r)}return rt.relative(n,i)}resolvePath(e,t){if(e.scheme===Ie.file){let n=le.file(YR(Oa(e),t));return e.with({authority:n.authority,path:n.path})}return t=VM(t),e.with({path:rt.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&qt(e,t)}hasTrailingPathSeparator(e,t=yo){if(e.scheme===Ie.file){let n=Oa(e);return n.length>sw(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=yo){return GM(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=yo){let n=!1;if(e.scheme===Ie.file){let i=Oa(e);n=i!==void 0&&i.length===sw(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!GM(e,t)?e.with({path:e.path+"/"}):e}},_t=new Um(()=>!1),ZV=new Um(o=>o.scheme===Ie.file?!Ut:!0),QV=new Um(o=>!0),Xi=_t.isEqual.bind(_t),AG=_t.isEqualOrParent.bind(_t),FG=_t.getComparisonKey.bind(_t),JV=_t.basenameOrAuthority.bind(_t),Qo=_t.basename.bind(_t),lw=_t.extname.bind(_t),Ms=_t.dirname.bind(_t),Jo=_t.joinPath.bind(_t),BG=_t.normalizePath.bind(_t),Lv=_t.relativePath.bind(_t),dw=_t.resolvePath.bind(_t),WG=_t.isAbsolutePath.bind(_t),KM=_t.isEqualAuthority.bind(_t),GM=_t.hasTrailingPathSeparator.bind(_t),VG=_t.removeTrailingPathSeparator.bind(_t),HG=_t.addTrailingPathSeparator.bind(_t);var ku;(r=>{r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,p]=c.split(":");u&&p&&a.set(u,p)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(r.META_DATA_MIME,d),a}r.parseMetaData=i})(ku||={});function $M(o,e,t){if(e){let n=o.path;return n&&n[0]!==rt.sep&&(n=rt.sep+n),o.with({scheme:t,authority:e,path:n})}return o.with({scheme:t})}function Rv(o){return!!o&&typeof o.then=="function"}function zd(o){let e=new jn,t=o(e.token),n=new Promise((i,r)=>{let s=e.token.onCancellationRequested(()=>{s.dispose(),r(new ci)});Promise.resolve(t).then(a=>{s.dispose(),e.dispose(),i(a)},a=>{s.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,r){return n.then(i,r)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}function $m(o,e,t){return new Promise((n,i)=>{let r=e.onCancellationRequested(()=>{r.dispose(),n(t)});o.then(n,i).finally(()=>r.dispose())})}function qM(){let o,e;return{promise:new Promise((n,i)=>{o=n,e=i}),resolve:o,reject:e}}var cw=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(i=>{this.activePromise=null,t(i)},i=>{this.activePromise=null,n(i)})})}dispose(){this.isDisposed=!0}};var eH=(o,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},o);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},tH=o=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,o())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},Aa=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,r)=>{this.doResolve=i,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===FE?tH(n):eH(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new ci),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},zm=class{delayer;throttler;constructor(e){this.delayer=new Aa(e),this.throttler=new cw}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}};function pr(o,e){return e?new Promise((t,n)=>{let i=setTimeout(()=>{r.dispose(),t()},o),r=e.onCancellationRequested(()=>{clearTimeout(i),r.dispose(),n(new ci)})}):zd(t=>pr(o,t))}function Kd(o,e=0,t){let n=setTimeout(()=>{o(),t&&i.dispose()},e),i=Ce(()=>{clearTimeout(n),t?.deleteAndLeak(i)});return t?.add(i),i}var Zi=class{_token;_isDisposed=!1;constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new $e("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new $e("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},Dv=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new $e("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let i=n.setInterval(()=>{e()},t);this.disposable=Ce(()=>{n.clearInterval(i),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},dn=class{runner;timeoutToken;timeout;timeoutHandler;constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var Ol,Ru;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Ru=(o,e)=>{Vb(()=>{if(t)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Ru=(o,e,t)=>{let n=o.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),i=!1;return{dispose(){i||(i=!0,o.cancelIdleCallback(n))}}},Ol=o=>Ru(globalThis,o)})();var Km=class{_executor;_handle;_didRun=!1;_value;_error;constructor(e,t){this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=Ru(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},Gm=class extends Km{constructor(e){super(globalThis,e)}};var kv=class{_running;_queued;isRunning(e){return typeof e=="number"?this._running?.taskId===e:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(e,t,n){return this._running={taskId:e,cancel:()=>n?.(),promise:t},t.then(()=>this.doneRunning(e),()=>this.doneRunning(e)),t}doneRunning(e){this._running&&e===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let e=this._queued;this._queued=void 0,e.run().then(e.promiseResolve,e.promiseReject)}}queue(e){if(this._queued)this._queued.run=e;else{let{promise:t,resolve:n,reject:i}=qM();this._queued={run:e,promise:t,promiseResolve:n,promiseReject:i}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}};var Ps=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new ci)}},hr;(t=>{async function o(n){let i,r=await Promise.all(n.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return r}t.settled=o;function e(n){return new Promise(async(i,r)=>{try{await n(i,r)}catch(s){r(s)}})}t.withAsyncBody=e})(hr||={});var jM=class o{static fromArray(e){return new o(t=>{t.emitMany(e)})}static fromPromise(e){return new o(async t=>{t.emitMany(await e)})}static fromPromises(e){return new o(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new o(async t=>{await Promise.all(e.map(async n=>{for await(let i of n)t.emitOne(i)}))})}static EMPTY=o.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new L,queueMicrotask(async()=>{let n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await de.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new o(async n=>{for await(let i of e)n.emitOne(t(i))})}map(e){return o.map(this,e)}static filter(e,t){return new o(async n=>{for await(let i of e)t(i)&&n.emitOne(i)})}filter(e){return o.filter(this,e)}static coalesce(e){return o.filter(e,t=>!!t)}coalesce(){return o.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return o.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var{entries:nP,setPrototypeOf:YM,isFrozen:nH,getPrototypeOf:iH,getOwnPropertyDescriptor:oH}=Object,{freeze:Qi,seal:Br,create:rH}=Object,{apply:fw,construct:bw}=typeof Reflect<"u"&&Reflect;fw||(fw=function(e,t,n){return e.apply(t,n)});Qi||(Qi=function(e){return e});Br||(Br=function(e){return e});bw||(bw=function(e,t){return new e(...t)});var sH=mr(Array.prototype.forEach),XM=mr(Array.prototype.pop),jm=mr(Array.prototype.push),Nv=mr(String.prototype.toLowerCase),uw=mr(String.prototype.toString),aH=mr(String.prototype.match),Fr=mr(String.prototype.replace),lH=mr(String.prototype.indexOf),dH=mr(String.prototype.trim),er=mr(RegExp.prototype.test),qm=cH(TypeError);function mr(o){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return fw(o,e,n)}}function cH(o){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return bw(o,t)}}function ut(o,e,t){var n;t=(n=t)!==null&&n!==void 0?n:Nv,YM&&YM(o,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){let s=t(r);s!==r&&(nH(e)||(e[i]=s),r=s)}o[r]=!0}return o}function Mu(o){let e=rH(null);for(let[t,n]of nP(o))e[t]=n;return e}function Mv(o,e){for(;o!==null;){let n=oH(o,e);if(n){if(n.get)return mr(n.get);if(typeof n.value=="function")return mr(n.value)}o=iH(o)}function t(n){return console.warn("fallback value for",n),null}return t}var ZM=Qi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),pw=Qi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),hw=Qi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),uH=Qi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mw=Qi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),pH=Qi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),QM=Qi(["#text"]),JM=Qi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),gw=Qi(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eP=Qi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Pv=Qi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),hH=Br(/\{\{[\w\W]*|[\w\W]*\}\}/gm),mH=Br(/<%[\w\W]*|[\w\W]*%>/gm),gH=Br(/\${[\w\W]*}/gm),fH=Br(/^data-[\-\w.\u00B7-\uFFFF]/),bH=Br(/^aria-[\-\w]+$/),iP=Br(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),vH=Br(/^(?:\w+script|data):/i),yH=Br(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),oP=Br(/^html$/i),tP=Object.freeze({__proto__:null,MUSTACHE_EXPR:hH,ERB_EXPR:mH,TMPLIT_EXPR:gH,DATA_ATTR:fH,ARIA_ATTR:bH,IS_ALLOWED_URI:iP,IS_SCRIPT_OR_DATA:vH,ATTR_WHITESPACE:yH,DOCTYPE_NAME:oP}),IH=()=>typeof window>"u"?null:window,CH=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));let r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function rP(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IH(),e=Re=>rP(Re);if(e.version="3.0.5",e.removed=[],!o||!o.document||o.document.nodeType!==9)return e.isSupported=!1,e;let t=o.document,n=t.currentScript,{document:i}=o,{DocumentFragment:r,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:u,DOMParser:p,trustedTypes:m}=o,f=l.prototype,g=Mv(f,"cloneNode"),b=Mv(f,"nextSibling"),v=Mv(f,"childNodes"),I=Mv(f,"parentNode");if(typeof s=="function"){let Re=i.createElement("template");Re.content&&Re.content.ownerDocument&&(i=Re.content.ownerDocument)}let C,S="",{implementation:_,createNodeIterator:R,createDocumentFragment:N,getElementsByTagName:F}=i,{importNode:P}=t,H={};e.isSupported=typeof nP=="function"&&typeof I=="function"&&_&&_.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:U,ERB_EXPR:z,TMPLIT_EXPR:oe,DATA_ATTR:fe,ARIA_ATTR:ee,IS_SCRIPT_OR_DATA:X,ATTR_WHITESPACE:se}=tP,{IS_ALLOWED_URI:te}=tP,Z=null,ye=ut({},[...ZM,...pw,...hw,...mw,...QM]),Se=null,st=ut({},[...JM,...gw,...eP,...Pv]),Ze=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,$n=null,wn=!0,$i=!0,go=!1,hl=!0,ai=!1,Lr=!1,_d=!1,ml=!1,li=!1,gl=!1,fl=!1,du=!0,cu=!1,Oe="user-content-",xa=!0,bl=!1,vs={},lr=null,lm=ut({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ed=null,dm=ut({},["audio","video","img","source","image","track"]),ys=null,cm=ut({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Is="http://www.w3.org/1998/Math/MathML",Ho="http://www.w3.org/2000/svg",bn="http://www.w3.org/1999/xhtml",Uo=bn,_a=!1,ki=null,vl=ut({},[Is,Ho,bn],uw),Dr,Cs=["application/xhtml+xml","text/html"],pe="text/html",re,O=null,J=i.createElement("form"),ce=function(W){return W instanceof RegExp||W instanceof Function},qe=function(W){if(!(O&&O===W)){if((!W||typeof W!="object")&&(W={}),W=Mu(W),Dr=Cs.indexOf(W.PARSER_MEDIA_TYPE)===-1?Dr=pe:Dr=W.PARSER_MEDIA_TYPE,re=Dr==="application/xhtml+xml"?uw:Nv,Z="ALLOWED_TAGS"in W?ut({},W.ALLOWED_TAGS,re):ye,Se="ALLOWED_ATTR"in W?ut({},W.ALLOWED_ATTR,re):st,ki="ALLOWED_NAMESPACES"in W?ut({},W.ALLOWED_NAMESPACES,uw):vl,ys="ADD_URI_SAFE_ATTR"in W?ut(Mu(cm),W.ADD_URI_SAFE_ATTR,re):cm,Ed="ADD_DATA_URI_TAGS"in W?ut(Mu(dm),W.ADD_DATA_URI_TAGS,re):dm,lr="FORBID_CONTENTS"in W?ut({},W.FORBID_CONTENTS,re):lm,ke="FORBID_TAGS"in W?ut({},W.FORBID_TAGS,re):{},$n="FORBID_ATTR"in W?ut({},W.FORBID_ATTR,re):{},vs="USE_PROFILES"in W?W.USE_PROFILES:!1,wn=W.ALLOW_ARIA_ATTR!==!1,$i=W.ALLOW_DATA_ATTR!==!1,go=W.ALLOW_UNKNOWN_PROTOCOLS||!1,hl=W.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ai=W.SAFE_FOR_TEMPLATES||!1,Lr=W.WHOLE_DOCUMENT||!1,li=W.RETURN_DOM||!1,gl=W.RETURN_DOM_FRAGMENT||!1,fl=W.RETURN_TRUSTED_TYPE||!1,ml=W.FORCE_BODY||!1,du=W.SANITIZE_DOM!==!1,cu=W.SANITIZE_NAMED_PROPS||!1,xa=W.KEEP_CONTENT!==!1,bl=W.IN_PLACE||!1,te=W.ALLOWED_URI_REGEXP||iP,Uo=W.NAMESPACE||bn,Ze=W.CUSTOM_ELEMENT_HANDLING||{},W.CUSTOM_ELEMENT_HANDLING&&ce(W.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ze.tagNameCheck=W.CUSTOM_ELEMENT_HANDLING.tagNameCheck),W.CUSTOM_ELEMENT_HANDLING&&ce(W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ze.attributeNameCheck=W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),W.CUSTOM_ELEMENT_HANDLING&&typeof W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ze.allowCustomizedBuiltInElements=W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ai&&($i=!1),gl&&(li=!0),vs&&(Z=ut({},[...QM]),Se=[],vs.html===!0&&(ut(Z,ZM),ut(Se,JM)),vs.svg===!0&&(ut(Z,pw),ut(Se,gw),ut(Se,Pv)),vs.svgFilters===!0&&(ut(Z,hw),ut(Se,gw),ut(Se,Pv)),vs.mathMl===!0&&(ut(Z,mw),ut(Se,eP),ut(Se,Pv))),W.ADD_TAGS&&(Z===ye&&(Z=Mu(Z)),ut(Z,W.ADD_TAGS,re)),W.ADD_ATTR&&(Se===st&&(Se=Mu(Se)),ut(Se,W.ADD_ATTR,re)),W.ADD_URI_SAFE_ATTR&&ut(ys,W.ADD_URI_SAFE_ATTR,re),W.FORBID_CONTENTS&&(lr===lm&&(lr=Mu(lr)),ut(lr,W.FORBID_CONTENTS,re)),xa&&(Z["#text"]=!0),Lr&&ut(Z,["html","head","body"]),Z.table&&(ut(Z,["tbody"]),delete ke.tbody),W.TRUSTED_TYPES_POLICY){if(typeof W.TRUSTED_TYPES_POLICY.createHTML!="function")throw qm('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof W.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qm('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=W.TRUSTED_TYPES_POLICY,S=C.createHTML("")}else C===void 0&&(C=CH(m,n)),C!==null&&typeof S=="string"&&(S=C.createHTML(""));Qi&&Qi(W),O=W}},vt=ut({},["mi","mo","mn","ms","mtext"]),On=ut({},["foreignobject","desc","title","annotation-xml"]),di=ut({},["title","style","font","a","script"]),Be=ut({},pw);ut(Be,hw),ut(Be,uH);let E=ut({},mw);ut(E,pH);let T=function(W){let he=I(W);(!he||!he.tagName)&&(he={namespaceURI:Uo,tagName:"template"});let Te=Nv(W.tagName),Ot=Nv(he.tagName);return ki[W.namespaceURI]?W.namespaceURI===Ho?he.namespaceURI===bn?Te==="svg":he.namespaceURI===Is?Te==="svg"&&(Ot==="annotation-xml"||vt[Ot]):!!Be[Te]:W.namespaceURI===Is?he.namespaceURI===bn?Te==="math":he.namespaceURI===Ho?Te==="math"&&On[Ot]:!!E[Te]:W.namespaceURI===bn?he.namespaceURI===Ho&&!On[Ot]||he.namespaceURI===Is&&!vt[Ot]?!1:!E[Te]&&(di[Te]||!Be[Te]):!!(Dr==="application/xhtml+xml"&&ki[W.namespaceURI]):!1},k=function(W){jm(e.removed,{element:W});try{W.parentNode.removeChild(W)}catch{W.remove()}},A=function(W,he){try{jm(e.removed,{attribute:he.getAttributeNode(W),from:he})}catch{jm(e.removed,{attribute:null,from:he})}if(he.removeAttribute(W),W==="is"&&!Se[W])if(li||gl)try{k(he)}catch{}else try{he.setAttribute(W,"")}catch{}},B=function(W){let he,Te;if(ml)W="<remove></remove>"+W;else{let Ri=aH(W,/^[\r\n\t ]+/);Te=Ri&&Ri[0]}Dr==="application/xhtml+xml"&&Uo===bn&&(W='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+W+"</body></html>");let Ot=C?C.createHTML(W):W;if(Uo===bn)try{he=new p().parseFromString(Ot,Dr)}catch{}if(!he||!he.documentElement){he=_.createDocument(Uo,"template",null);try{he.documentElement.innerHTML=_a?S:Ot}catch{}}let Tn=he.body||he.documentElement;return W&&Te&&Tn.insertBefore(i.createTextNode(Te),Tn.childNodes[0]||null),Uo===bn?F.call(he,Lr?"html":"body")[0]:Lr?he.documentElement:Tn},q=function(W){return R.call(W.ownerDocument||W,W,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},Q=function(W){return W instanceof u&&(typeof W.nodeName!="string"||typeof W.textContent!="string"||typeof W.removeChild!="function"||!(W.attributes instanceof c)||typeof W.removeAttribute!="function"||typeof W.setAttribute!="function"||typeof W.namespaceURI!="string"||typeof W.insertBefore!="function"||typeof W.hasChildNodes!="function")},ve=function(W){return typeof a=="object"?W instanceof a:W&&typeof W=="object"&&typeof W.nodeType=="number"&&typeof W.nodeName=="string"},we=function(W,he,Te){H[W]&&sH(H[W],Ot=>{Ot.call(e,he,Te,O)})},Xe=function(W){let he;if(we("beforeSanitizeElements",W,null),Q(W))return k(W),!0;let Te=re(W.nodeName);if(we("uponSanitizeElement",W,{tagName:Te,allowedTags:Z}),W.hasChildNodes()&&!ve(W.firstElementChild)&&(!ve(W.content)||!ve(W.content.firstElementChild))&&er(/<[/\w]/g,W.innerHTML)&&er(/<[/\w]/g,W.textContent))return k(W),!0;if(!Z[Te]||ke[Te]){if(!ke[Te]&&Vt(Te)&&(Ze.tagNameCheck instanceof RegExp&&er(Ze.tagNameCheck,Te)||Ze.tagNameCheck instanceof Function&&Ze.tagNameCheck(Te)))return!1;if(xa&&!lr[Te]){let Ot=I(W)||W.parentNode,Tn=v(W)||W.childNodes;if(Tn&&Ot){let Ri=Tn.length;for(let hn=Ri-1;hn>=0;--hn)Ot.insertBefore(g(Tn[hn],!0),b(W))}}return k(W),!0}return W instanceof l&&!T(W)||(Te==="noscript"||Te==="noembed"||Te==="noframes")&&er(/<\/no(script|embed|frames)/i,W.innerHTML)?(k(W),!0):(ai&&W.nodeType===3&&(he=W.textContent,he=Fr(he,U," "),he=Fr(he,z," "),he=Fr(he,oe," "),W.textContent!==he&&(jm(e.removed,{element:W.cloneNode()}),W.textContent=he)),we("afterSanitizeElements",W,null),!1)},mt=function(W,he,Te){if(du&&(he==="id"||he==="name")&&(Te in i||Te in J))return!1;if(!($i&&!$n[he]&&er(fe,he))){if(!(wn&&er(ee,he))){if(!Se[he]||$n[he]){if(!(Vt(W)&&(Ze.tagNameCheck instanceof RegExp&&er(Ze.tagNameCheck,W)||Ze.tagNameCheck instanceof Function&&Ze.tagNameCheck(W))&&(Ze.attributeNameCheck instanceof RegExp&&er(Ze.attributeNameCheck,he)||Ze.attributeNameCheck instanceof Function&&Ze.attributeNameCheck(he))||he==="is"&&Ze.allowCustomizedBuiltInElements&&(Ze.tagNameCheck instanceof RegExp&&er(Ze.tagNameCheck,Te)||Ze.tagNameCheck instanceof Function&&Ze.tagNameCheck(Te))))return!1}else if(!ys[he]){if(!er(te,Fr(Te,se,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&W!=="script"&&lH(Te,"data:")===0&&Ed[W])){if(!(go&&!er(X,Fr(Te,se,"")))){if(Te)return!1}}}}}}return!0},Vt=function(W){return W.indexOf("-")>0},vn=function(W){let he,Te,Ot,Tn;we("beforeSanitizeAttributes",W,null);let{attributes:Ri}=W;if(!Ri)return;let hn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Se};for(Tn=Ri.length;Tn--;){he=Ri[Tn];let{name:Ss,namespaceURI:sE}=he;if(Te=Ss==="value"?he.value:dH(he.value),Ot=re(Ss),hn.attrName=Ot,hn.attrValue=Te,hn.keepAttr=!0,hn.forceKeepAttr=void 0,we("uponSanitizeAttribute",W,hn),Te=hn.attrValue,hn.forceKeepAttr||(A(Ss,W),!hn.keepAttr))continue;if(!hl&&er(/\/>/i,Te)){A(Ss,W);continue}ai&&(Te=Fr(Te,U," "),Te=Fr(Te,z," "),Te=Fr(Te,oe," "));let ER=re(W.nodeName);if(mt(ER,Ot,Te)){if(cu&&(Ot==="id"||Ot==="name")&&(A(Ss,W),Te=Oe+Te),C&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!sE)switch(m.getAttributeType(ER,Ot)){case"TrustedHTML":{Te=C.createHTML(Te);break}case"TrustedScriptURL":{Te=C.createScriptURL(Te);break}}try{sE?W.setAttributeNS(sE,Ss,Te):W.setAttribute(Ss,Te),XM(e.removed)}catch{}}}we("afterSanitizeAttributes",W,null)},$t=function Re(W){let he,Te=q(W);for(we("beforeSanitizeShadowDOM",W,null);he=Te.nextNode();)we("uponSanitizeShadowNode",he,null),!Xe(he)&&(he.content instanceof r&&Re(he.content),vn(he));we("afterSanitizeShadowDOM",W,null)};return e.sanitize=function(Re){let W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he,Te,Ot,Tn;if(_a=!Re,_a&&(Re="<!-->"),typeof Re!="string"&&!ve(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw qm("dirty is not a string, aborting")}else throw qm("toString is not a function");if(!e.isSupported)return Re;if(_d||qe(W),e.removed=[],typeof Re=="string"&&(bl=!1),bl){if(Re.nodeName){let Ss=re(Re.nodeName);if(!Z[Ss]||ke[Ss])throw qm("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof a)he=B("<!---->"),Te=he.ownerDocument.importNode(Re,!0),Te.nodeType===1&&Te.nodeName==="BODY"||Te.nodeName==="HTML"?he=Te:he.appendChild(Te);else{if(!li&&!ai&&!Lr&&Re.indexOf("<")===-1)return C&&fl?C.createHTML(Re):Re;if(he=B(Re),!he)return li?null:fl?S:""}he&&ml&&k(he.firstChild);let Ri=q(bl?Re:he);for(;Ot=Ri.nextNode();)Xe(Ot)||(Ot.content instanceof r&&$t(Ot.content),vn(Ot));if(bl)return Re;if(li){if(gl)for(Tn=N.call(he.ownerDocument);he.firstChild;)Tn.appendChild(he.firstChild);else Tn=he;return(Se.shadowroot||Se.shadowrootmode)&&(Tn=P.call(t,Tn,!0)),Tn}let hn=Lr?he.outerHTML:he.innerHTML;return Lr&&Z["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&er(oP,he.ownerDocument.doctype.name)&&(hn="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+hn),ai&&(hn=Fr(hn,U," "),hn=Fr(hn,z," "),hn=Fr(hn,oe," ")),C&&fl?C.createHTML(hn):hn},e.setConfig=function(Re){qe(Re),_d=!0},e.clearConfig=function(){O=null,_d=!1},e.isValidAttribute=function(Re,W,he){O||qe({});let Te=re(Re),Ot=re(W);return mt(Te,Ot,he)},e.addHook=function(Re,W){typeof W=="function"&&(H[Re]=H[Re]||[],jm(H[Re],W))},e.removeHook=function(Re){if(H[Re])return XM(H[Re])},e.removeHooks=function(Re){H[Re]&&(H[Re]=[])},e.removeAllHooks=function(){H={}},e}var Ns=rP();var r$=Ns.version,s$=Ns.isSupported,Ov=Ns.sanitize,a$=Ns.setConfig,l$=Ns.clearConfig,d$=Ns.isValidAttribute,Av=Ns.addHook,Fv=Ns.removeHook,c$=Ns.removeHooks,u$=Ns.removeAllHooks;function gr(o){return Xm(o,0)}function Xm(o,e){switch(typeof o){case"object":return o===null?Fa(349,e):Array.isArray(o)?xH(o,e):_H(o,e);case"string":return Bv(o,e);case"boolean":return SH(o,e);case"number":return Fa(o,e);case"undefined":return Fa(937,e);default:return Fa(617,e)}}function Fa(o,e){return(e<<5)-e+o|0}function SH(o,e){return Fa(o?433:863,e)}function Bv(o,e){e=Fa(149417,e);for(let t=0,n=o.length;t<n;t++)e=Fa(o.charCodeAt(t),e);return e}function xH(o,e){return e=Fa(104579,e),o.reduce((t,n)=>Xm(n,t),e)}function _H(o,e){return e=Fa(181387,e),Object.keys(o).sort().reduce((t,n)=>(t=Bv(n,t),Xm(o[n],t)),e)}function vw(o,e,t=32){let n=t-e,i=~((1<<n)-1);return(o<<e|(i&o)>>>n)>>>0}function aP(o,e=0,t=o.byteLength,n=0){for(let i=0;i<t;i++)o[e+i]=n}function EH(o,e,t="0"){for(;o.length<e;)o=t+o;return o}function Ym(o,e=32){return o instanceof ArrayBuffer?Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join(""):EH((o>>>0).toString(16),e/4)}var lP=class o{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,i=this._buffLen,r=this._leftoverHighSurrogate,s,a;for(r!==0?(s=r,a=-1,r=0):(s=e.charCodeAt(0),a=0);;){let l=s;if(At(s))if(a+1<t){let d=e.charCodeAt(a+1);ks(d)?(a++,l=gv(s,d)):l=65533}else{r=s;break}else ks(s)&&(l=65533);if(i=this._push(n,i,l),a++,a<t)s=e.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=r}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Ym(this._h0)+Ym(this._h1)+Ym(this._h2)+Ym(this._h3)+Ym(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,aP(this._buff,this._buffLen),this._buffLen>56&&(this._step(),aP(this._buff));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let e=o._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,vw(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let n=this._h0,i=this._h1,r=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=i&r|~i&s,d=1518500249):u<40?(l=i^r^s,d=1859775393):u<60?(l=i&r|i&s|r&s,d=2400959708):(l=i^r^s,d=3395469782),c=vw(n,5)+l+a+d+e.getUint32(u*4,!1)&4294967295,a=s,s=r,r=vw(i,30),i=n,n=c;this._h0=this._h0+n&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function Wr(o,e,t){return Math.min(Math.max(o,e),t)}var Zm=class{_n=1;_val=0;update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}},Wv=class{_n=0;_val=0;_values=[];_index=0;_sum=0;constructor(e){this._values=new Array(e),this._values.fill(0,0,e)}update(e){let t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}};var{registerWindow:M$,getWindow:ge,getDocument:P$,getWindows:dP,getWindowsCount:wH,getWindowId:Pu,getWindowById:Cw,hasWindow:N$,onDidRegisterWindow:Sw,onWillUnregisterWindow:O$,onDidUnregisterWindow:cP}=function(){let o=new Map;MM(Yt,1);let e={window:Yt,disposables:new ae};o.set(Yt.vscodeWindowId,e);let t=new L,n=new L,i=new L;function r(s,a){return(typeof s=="number"?o.get(s):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:i.event,onDidUnregisterWindow:n.event,registerWindow(s){if(o.has(s.vscodeWindowId))return V.None;let a=new ae,l={window:s,disposables:a.add(new ae)};return o.set(s.vscodeWindowId,l),a.add(Ce(()=>{o.delete(s.vscodeWindowId),n.fire(s)})),a.add(Y(s,Ee.BEFORE_UNLOAD,()=>{i.fire(s)})),t.fire(l),a},getWindows(){return o.values()},getWindowsCount(){return o.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return o.has(s)},getWindowById:r,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:Yt},getDocument(s){return ge(s).document}}}();function mi(o){for(;o.firstChild;)o.firstChild.remove()}var yw=class{_handler;_node;_type;_options;constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function Y(o,e,t,n){return new yw(o,e,t,n)}function TH(o,e){return function(t){return e(new Ai(o,t))}}function LH(o){return function(e){return o(new pt(e))}}var Ln=function(e,t,n,i){let r=n;return t==="click"||t==="mousedown"||t==="contextmenu"?r=TH(ge(e),n):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=LH(n)),Y(e,t,r,i)};function Jm(o,e,t){return Ru(o,e,t)}var Nu=class extends Km{constructor(e,t){super(e,t)}},Au,Zn;var Ou=class extends Dv{defaultTarget;constructor(e){super(),this.defaultTarget=e&&ge(e)}cancelAndSet(e,t,n){return super.cancelAndSet(e,t,n??this.defaultTarget)}},Qm=class{_runner;priority;_canceled;constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){We(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let o=new Map,e=new Map,t=new Map,n=new Map,i=r=>{t.set(r,!1);let s=o.get(r)??[];for(e.set(r,s),o.set(r,[]),n.set(r,!0);s.length>0;)s.sort(Qm.sort),s.shift().execute();n.set(r,!1)};Zn=(r,s,a=0)=>{let l=Pu(r),d=new Qm(s,a),c=o.get(l);return c||(c=[],o.set(l,c)),c.push(d),t.get(l)||(t.set(l,!0),r.requestAnimationFrame(()=>i(l))),d},Au=(r,s,a)=>{let l=Pu(r);if(n.get(l)){let d=new Qm(s,a),c=e.get(l);return c||(c=[],e.set(l,c)),c.push(d),d}else return Zn(r,s,a)}})();function uP(o){return ge(o).getComputedStyle(o,null)}function Gd(o,e){let t=ge(o),n=t.document;if(o!==n.body)return new Dt(o.clientWidth,o.clientHeight);if(bm&&t?.visualViewport)return new Dt(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new Dt(t.innerWidth,t.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new Dt(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new Dt(n.documentElement.clientWidth,n.documentElement.clientHeight);if(e)return Gd(e);throw new Error("Unable to figure out browser width and height")}var Fi=class o{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,n){let i=uP(e),r=i?i.getPropertyValue(t):"0";return o.convertToPixels(e,r)}static getBorderLeftWidth(e){return o.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return o.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return o.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return o.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return o.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return o.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return o.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return o.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return o.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return o.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return o.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return o.getDimension(e,"margin-bottom","marginBottom")}},Dt=class o{constructor(e,t){this.width=e;this.height=t}static None=new o(0,0);with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new o(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof o?e:new o(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};function pP(o){let e=o.offsetParent,t=o.offsetTop,n=o.offsetLeft;for(;(o=o.parentNode)!==null&&o!==o.ownerDocument.body&&o!==o.ownerDocument.documentElement;){t-=o.scrollTop;let i=gP(o)?null:uP(o);i&&(n-=i.direction!=="rtl"?o.scrollLeft:-o.scrollLeft),o===e&&(n+=Fi.getBorderLeftWidth(o),t+=Fi.getBorderTopWidth(o),t+=o.offsetTop,n+=o.offsetLeft,e=o.offsetParent)}return{left:n,top:t}}function hP(o,e,t){typeof e=="number"&&(o.style.width=`${e}px`),typeof t=="number"&&(o.style.height=`${t}px`)}function Bi(o){let e=o.getBoundingClientRect(),t=ge(o);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Fu(o){let e=Fi.getMarginLeft(o)+Fi.getMarginRight(o);return o.offsetWidth+e}function Uv(o){let e=Fi.getBorderLeftWidth(o)+Fi.getBorderRightWidth(o),t=Fi.getPaddingLeft(o)+Fi.getPaddingRight(o);return o.offsetWidth-e-t}function mP(o){let e=Fi.getBorderTopWidth(o)+Fi.getBorderBottomWidth(o),t=Fi.getPaddingTop(o)+Fi.getPaddingBottom(o);return o.offsetHeight-e-t}function zv(o){let e=Fi.getMarginTop(o)+Fi.getMarginBottom(o);return o.offsetHeight+e}function fr(o,e){return!!e?.contains(o)}function gP(o){return o&&!!o.host&&!!o.mode}function Al(o){for(;o.parentNode;){if(o===o.ownerDocument?.body)return null;o=o.parentNode}return gP(o)?o:null}function Ji(){let o=fP().activeElement;for(;o?.shadowRoot;)o=o.shadowRoot.activeElement;return o}function Vr(o){return Ji()===o}function fP(){return wH()<=1?Yt.document:Array.from(dP()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Yt.document}function Kv(){return fP().defaultView?.window??Yt}var DH=new Map;function Os(o=Yt.document.head,e,t){let n=document.createElement("style");if(n.type="text/css",n.media="screen",e?.(n),o.appendChild(n),t&&t.add(Ce(()=>n.remove())),o===Yt.document.head){let i=new Set;DH.set(n,i);for(let{window:r,disposables:s}of dP()){if(r===Yt)continue;let a=s.add(kH(n,i,r));t?.add(a)}}return n}function kH(o,e,t){let n=new ae,i=o.cloneNode(!0);t.document.head.appendChild(i),n.add(Ce(()=>i.remove()));for(let r of MH(o))i.sheet?.insertRule(r.cssText,i.sheet?.cssRules.length);return n.add(RH.observe(o,n,{childList:!0})(()=>{i.textContent=o.textContent})),e.add(i),n.add(Ce(()=>e.delete(i))),n}var RH=new class{mutationObservers=new Map;observe(o,e,t){let n=this.mutationObservers.get(o);n||(n=new Map,this.mutationObservers.set(o,n));let i=gr(t),r=n.get(i);if(r)r.users+=1;else{let s=new L,a=new MutationObserver(d=>s.fire(d));a.observe(o,t);let l=r={users:1,observer:a,onDidMutate:s.event};e.add(Ce(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),n?.delete(i),n?.size===0&&this.mutationObservers.delete(o))})),n.set(i,r)}return r.onDidMutate}};function MH(o){return o?.sheet?.rules?o.sheet.rules:o?.sheet?.cssRules?o.sheet.cssRules:[]}function Xn(o){return o instanceof HTMLElement||o instanceof ge(o).HTMLElement}function bP(o){return o instanceof SVGElement||o instanceof ge(o).SVGElement}function Gv(o){return o instanceof MouseEvent||o instanceof ge(o).MouseEvent}function xw(o){return o instanceof KeyboardEvent||o instanceof ge(o).KeyboardEvent}var Ee={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Ar?"webkitAnimationStart":"animationstart",ANIMATION_END:Ar?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Ar?"webkitAnimationIteration":"animationiteration"};var ot={stop:(o,e)=>(o.preventDefault(),e&&o.stopPropagation(),o)};function vP(o){let e=[];for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)e[t]=o.scrollTop,o=o.parentNode;return e}function yP(o,e){for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)o.scrollTop!==e[t]&&(o.scrollTop=e[t]),o=o.parentNode}var Iw=class o extends V{_onDidFocus=this._register(new L);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new L);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(e){if(Xn(e)){let t=Al(e),n=t?t.activeElement:e.ownerDocument.activeElement;return fr(n,e)}else{let t=e;return fr(t.document.activeElement,t.document)}}constructor(e){super();let t=o.hasFocusWithin(e),n=!1,i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(n=!0,(Xn(e)?ge(e):e).setTimeout(()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{o.hasFocusWithin(e)!==t&&(t?r():i())},this._register(Y(e,Ee.FOCUS,i,!0)),this._register(Y(e,Ee.BLUR,r,!0)),Xn(e)&&(this._register(Y(e,Ee.FOCUS_IN,()=>this._refreshStateHandler())),this._register(Y(e,Ee.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function $d(o){return new Iw(o)}function IP(o,e){return o.after(e),e}function Le(o,...e){if(o.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function CP(o,e){return o.insertBefore(e,o.firstChild),e}function Bu(o,...e){o.innerText="",Le(o,...e)}var PH=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function SP(o,e,t,...n){let i=PH.exec(e);if(!i)throw new Error("Bad use of emmet");let r=i[1]||"div",s;return o!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(o,r):s=document.createElement(r),i[3]&&(s.id=i[3]),i[4]&&(s.className=i[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...n),s}function xe(o,e,...t){return SP("http://www.w3.org/1999/xhtml",o,e,...t)}xe.SVG=function(o,e,...t){return SP("http://www.w3.org/2000/svg",o,e,...t)};function So(...o){for(let e of o)e.style.display="",e.removeAttribute("aria-hidden")}function eo(...o){for(let e of o)e.style.display="none",e.setAttribute("aria-hidden","true")}function _w(o,e){let t=o.devicePixelRatio*e;return Math.max(1,Math.floor(t))/o.devicePixelRatio}function xP(o,e){let t=()=>{e(),n=Zn(o,t)},n=Zn(o,t);return Ce(()=>n.dispose())}yv.setPreferredWebSchema(/^https:/.test(Yt.location.href)?"https":"http");function jd(o){return o?`url('${Am.uriToBrowserUri(o).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function Hr(o,e){if(o!==void 0){let t=o.match(/^\s*var\((.+)\)$/);if(t){let n=t[1].split(",",2);return n.length===2&&(e=Hr(n[1].trim(),e)),`var(${n[0]}, ${e})`}return o}return e}function _P(o,e=!1){let t=document.createElement("a");return Av("afterSanitizeAttributes",n=>{for(let i of["href","src"])if(n.hasAttribute(i)){let r=n.getAttribute(i);if(i==="href"&&r.startsWith("#"))continue;if(t.href=r,!o.includes(t.protocol.replace(/:$/,""))){if(e&&i==="src"&&t.href.startsWith("data:"))continue;n.removeAttribute(i)}}}),Ce(()=>{Fv("afterSanitizeAttributes")})}var A$=[Ie.http,Ie.https,Ie.command],EP=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),F$=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});var Vv=class o extends L{_subscriptions=new ae;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(de.runAndSubscribe(Sw,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Yt,disposables:this._subscriptions}))}registerListeners(e,t){t.add(Y(e,"keydown",n=>{if(n.defaultPrevented)return;let i=new pt(n);if(!(i.keyCode===6&&n.repeat)){if(n.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(n.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(n.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(n.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(i.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=n,this.fire(this._keyStatus))}},!0)),t.add(Y(e,"keyup",n=>{n.defaultPrevented||(!n.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!n.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!n.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!n.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=n.altKey,this._keyStatus.ctrlKey=n.ctrlKey,this._keyStatus.metaKey=n.metaKey,this._keyStatus.shiftKey=n.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=n,this.fire(this._keyStatus)))},!0)),t.add(Y(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(Y(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(Y(e.document.body,"mousemove",n=>{n.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(Y(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return o.instance||(o.instance=new o),o.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var Hv=class extends V{constructor(t,n){super();this.element=t;this.callbacks=n;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(Y(this.element,Ee.DRAG_START,t=>{this.callbacks.onDragStart?.(t)})),this.callbacks.onDrag&&this._register(Y(this.element,Ee.DRAG,t=>{this.callbacks.onDrag?.(t)})),this._register(Y(this.element,Ee.DRAG_ENTER,t=>{this.counter++,this.dragStartTime=t.timeStamp,this.callbacks.onDragEnter?.(t)})),this._register(Y(this.element,Ee.DRAG_OVER,t=>{t.preventDefault(),this.callbacks.onDragOver?.(t,t.timeStamp-this.dragStartTime)})),this._register(Y(this.element,Ee.DRAG_LEAVE,t=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(t))})),this._register(Y(this.element,Ee.DRAG_END,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(t)})),this._register(Y(this.element,Ee.DROP,t=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(t)}))}};function As(o){return o.tagName.toLowerCase()==="input"||o.tagName.toLowerCase()==="textarea"||Xn(o)&&!!o.editContext}var wP=2e4,DP,Ew,TP,ww,LP;function Fl(o){DP&&(Ew.textContent!==o?(mi(TP),$v(Ew,o)):(mi(Ew),$v(TP,o)))}function Bl(o){DP&&(ww.textContent!==o?(mi(LP),$v(ww,o)):(mi(ww),$v(LP,o)))}function $v(o,e){mi(o),e.length>wP&&(e=e.substr(0,wP)),o.textContent=e,o.style.visibility="hidden",o.style.visibility="visible"}function Et(o,e,t){let n=null,i=null;if(typeof t.value=="function"?(n="value",i=t.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(n="get",i=t.get),!i)throw new Error("not supported");let r=`$memoize$${e}`;t[n]=function(...s){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[r]}}var ht;(r=>(r.Tap="-monaco-gesturetap",r.Change="-monaco-gesturechange",r.Start="-monaco-gesturestart",r.End="-monaco-gesturesend",r.Contextmenu="-monaco-gesturecontextmenu"))(ht||={});var gi=class gi extends V{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new An;ignoreTargets=new An;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(de.runAndSubscribe(Sw,({window:e,disposables:t})=>{t.add(Y(e.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),t.add(Y(e.document,"touchend",n=>this.onTouchEnd(e,n))),t.add(Y(e.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:Yt,disposables:this._store}))}static addTarget(e){if(!gi.isTouchDevice())return V.None;gi.INSTANCE||(gi.INSTANCE=wl(new gi));let t=gi.INSTANCE.targets.push(e);return Ce(t)}static ignoreTarget(e){if(!gi.isTouchDevice())return V.None;gi.INSTANCE||(gi.INSTANCE=wl(new gi));let t=gi.INSTANCE.ignoreTargets.push(e);return Ce(t)}static isTouchDevice(){return"ontouchstart"in Yt||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let r=e.targetTouches.item(n);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};let s=this.newGestureEvent(ht.Start,r.target);s.pageX=r.pageX,s.pageY=r.pageY,this.dispatchEvent(s)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){let n=Date.now(),i=Object.keys(this.activeTouches).length;for(let r=0,s=t.changedTouches.length;r<s;r++){let a=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<gi.HOLD_DELAY&&Math.abs(l.initialPageX-Mi(l.rollingPageX))<30&&Math.abs(l.initialPageY-Mi(l.rollingPageY))<30){let c=this.newGestureEvent(ht.Tap,l.initialTarget);c.pageX=Mi(l.rollingPageX),c.pageY=Mi(l.rollingPageY),this.dispatchEvent(c)}else if(d>=gi.HOLD_DELAY&&Math.abs(l.initialPageX-Mi(l.rollingPageX))<30&&Math.abs(l.initialPageY-Mi(l.rollingPageY))<30){let c=this.newGestureEvent(ht.Contextmenu,l.initialTarget);c.pageX=Mi(l.rollingPageX),c.pageY=Mi(l.rollingPageY),this.dispatchEvent(c)}else if(i===1){let c=Mi(l.rollingPageX),u=Mi(l.rollingPageY),p=Mi(l.rollingTimestamps)-l.rollingTimestamps[0],m=c-l.rollingPageX[0],f=u-l.rollingPageY[0],g=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(e,g,n,Math.abs(m)/p,m>0?1:-1,c,Math.abs(f)/p,f>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(ht.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===ht.Tap){let t=new Date().getTime(),n=0;t-this._lastSetTapCountTime>gi.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=t,e.tapCount=n}else(e.type===ht.Change||e.type===ht.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(e.initialTarget))return;let t=[];for(let n of this.targets)if(n.contains(e.initialTarget)){let i=0,r=e.initialTarget;for(;r&&r!==n;)i++,r=r.parentElement;t.push([i,n])}t.sort((n,i)=>n[0]-i[0]);for(let[n,i]of t)i.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,n,i,r,s,a,l,d){this.handle=Zn(e,()=>{let c=Date.now(),u=c-n,p=0,m=0,f=!0;i+=gi.SCROLL_FRICTION*u,a+=gi.SCROLL_FRICTION*u,i>0&&(f=!1,p=r*i*u),a>0&&(f=!1,m=l*a*u);let g=this.newGestureEvent(ht.Change);g.translationX=p,g.translationY=m,t.forEach(b=>b.dispatchEvent(g)),f||this.inertia(e,t,c,i,r,s+p,a,l,d+m)})}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let r=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}let s=this.activeTouches[r.identifier],a=this.newGestureEvent(ht.Change,s.initialTarget);a.translationX=r.pageX-Mi(s.rollingPageX),a.translationY=r.pageY-Mi(s.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(r.pageX),s.rollingPageY.push(r.pageY),s.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};K([Et],gi,"isTouchDevice",1);var mn=gi;var He=class{emitter;get event(){return this.emitter.event}constructor(e,t,n){let i=r=>this.emitter.fire(r);this.emitter=new L({onWillAddFirstListener:()=>e.addEventListener(t,i,n),onDidRemoveLastListener:()=>e.removeEventListener(t,i,n)})}dispose(){this.emitter.dispose()}};var OH=!1;var AH=4,FH=new L;var BH=300,WH=new L;var eg=class{constructor(e){this.el=e}disposables=new ae;get onPointerMove(){return this.disposables.add(new He(ge(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new He(ge(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};K([Et],eg.prototype,"onPointerMove",1),K([Et],eg.prototype,"onPointerUp",1);var tg=class{constructor(e){this.el=e}disposables=new ae;get onPointerMove(){return this.disposables.add(new He(this.el,ht.Change)).event}get onPointerUp(){return this.disposables.add(new He(this.el,ht.End)).event}dispose(){this.disposables.dispose()}};K([Et],tg.prototype,"onPointerMove",1),K([Et],tg.prototype,"onPointerUp",1);var Wu=class{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};K([Et],Wu.prototype,"onPointerMove",1),K([Et],Wu.prototype,"onPointerUp",1);var kP="pointer-events-disabled",qd=class o extends V{el;layoutProvider;orientation;size;hoverDelay=BH;hoverDelayer=this._register(new Aa(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new L);_onDidStart=this._register(new L);_onDidChange=this._register(new L);_onDidReset=this._register(new L);_onDidEnd=this._register(new L);orthogonalStartSashDisposables=this._register(new ae);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new ae);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new ae);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new ae);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){let t=n=>{this.orthogonalStartDragHandleDisposables.clear(),n!==0&&(this._orthogonalStartDragHandle=Le(this.el,xe(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Ce(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new He(this._orthogonalStartDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new He(this._orthogonalStartDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){let t=n=>{this.orthogonalEndDragHandleDisposables.clear(),n!==0&&(this._orthogonalEndDragHandle=Le(this.el,xe(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Ce(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new He(this._orthogonalEndDragHandle,"mouseenter")).event(()=>o.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new He(this._orthogonalEndDragHandle,"mouseleave")).event(()=>o.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,n){super(),this.el=Le(e,xe(".monaco-sash")),n.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${n.orthogonalEdge}`),Ve&&this.el.classList.add("mac");let i=this._register(new He(this.el,"mousedown")).event;this._register(i(u=>this.onPointerStart(u,new eg(e)),this));let r=this._register(new He(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));let s=this._register(new He(this.el,"mouseenter")).event;this._register(s(()=>o.onMouseEnter(this)));let a=this._register(new He(this.el,"mouseleave")).event;this._register(a(()=>o.onMouseLeave(this))),this._register(mn.addTarget(this.el));let l=this._register(new He(this.el,ht.Start)).event;this._register(l(u=>this.onPointerStart(u,new tg(this.el)),this));let d=this._register(new He(this.el,ht.Tap)).event,c;this._register(d(u=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(u);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof n.size=="number"?(this.size=n.size,n.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=AH,this._register(FH.event(u=>{this.size=u,this.layout()}))),this._register(WH.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=n.orthogonalStartSash,this.orthogonalEndSash=n.orthogonalEndSash,this.orientation=n.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",OH),this.layout()}onPointerStart(e,t){ot.stop(e);let n=!1;if(!e.__orthogonalSashEvent){let f=this.getOrthogonalSash(e);f&&(n=!0,e.__orthogonalSashEvent=!0,f.onPointerStart(e,new Wu(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new Wu(t))),!this.state)return;let i=this.el.ownerDocument.getElementsByTagName("iframe");for(let f of i)f.classList.add(kP);let r=e.pageX,s=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=Os(this.el),c=()=>{let f="";n?f="all-scroll":this.orientation===1?this.state===1?f="s-resize":this.state===2?f="n-resize":f=Ve?"row-resize":"ns-resize":this.state===1?f="e-resize":this.state===2?f="w-resize":f=Ve?"col-resize":"ew-resize",d.textContent=`* { cursor: ${f} !important; }`},u=new ae;c(),n||this.onDidEnablementChange.event(c,null,u);let p=f=>{ot.stop(f,!1);let g={startX:r,currentX:f.pageX,startY:s,currentY:f.pageY,altKey:a};this._onDidChange.fire(g)},m=f=>{ot.stop(f,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(let g of i)g.classList.remove(kP)};t.onPointerMove(p,null,u),t.onPointerUp(m,null,u),u.add(t)}onPointerDoublePress(e){let t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&o.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&o.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){o.onMouseLeave(this)}layout(){if(this.orientation===0){let e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{let e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){let t=e.initialTarget??e.target;if(!(!t||!Xn(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};function jv(o){if(!o||typeof o!="object"||o instanceof RegExp)return o;let e=Array.isArray(o)?[]:{};return Object.entries(o).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?jv(n):n}),e}var VH=Object.prototype.hasOwnProperty;function Lw(o,e){return Tw(o,e,new Set)}function Tw(o,e,t){if(Yn(o))return o;let n=e(o);if(typeof n<"u")return n;if(Array.isArray(o)){let i=[];for(let r of o)i.push(Tw(r,e,t));return i}if(Ht(o)){if(t.has(o))throw new Error("Cannot clone recursive data-structure");t.add(o);let i={};for(let r in o)VH.call(o,r)&&(i[r]=Tw(o[r],e,t));return t.delete(o),i}return o}function qv(o,e,t=!0){return Ht(o)?(Ht(e)&&Object.keys(e).forEach(n=>{n in o?t&&(Ht(o[n])&&Ht(e[n])?qv(o[n],e[n],t):o[n]=e[n]):o[n]=e[n]}),o):e}function cn(o,e){if(o===e)return!0;if(o==null||e===null||e===void 0||typeof o!=typeof e||typeof o!="object"||Array.isArray(o)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(o)){if(o.length!==e.length)return!1;for(t=0;t<o.length;t++)if(!cn(o[t],e[t]))return!1}else{let i=[];for(n in o)i.push(n);i.sort();let r=[];for(n in e)r.push(n);if(r.sort(),!cn(i,r))return!1;for(t=0;t<i.length;t++)if(!cn(o[i[t]],e[i[t]]))return!1}return!0}var Xv=class extends V{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(e,t){super(),this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null,t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()},n=!1,i=!1,r=()=>{if(n&&!i)try{n=!1,i=!0,t()}finally{Zn(ge(this._referenceDomElement),()=>{i=!1,r()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?e={width:s[0].contentRect.width,height:s[0].contentRect.height}:e=null,n=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this._referenceDomElement&&(n=this._referenceDomElement.clientWidth,i=this._referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),(this._width!==n||this._height!==i)&&(this._width=n,this._height=i,e&&this._onDidChange.fire())}};var Dw=class extends V{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(e){super(),this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}},kw=class extends V{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(e){super(),this._value=this._getPixelRatio(e);let t=this._register(new Dw(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){let t=document.createElement("canvas").getContext("2d"),n=e.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/i}},Rw=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(e){let t=Pu(e),n=this.mapWindowIdToPixelRatioMonitor.get(t);return n||(n=wl(new kw(e)),this.mapWindowIdToPixelRatioMonitor.set(t,n),wl(de.once(cP)(({vscodeWindowId:i})=>{i===t&&(n?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))}))),n}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}},Vu=new Rw;var Yd=class{constructor(e){this.domNode=e}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(e){let t=xo(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=xo(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=xo(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=xo(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=xo(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=xo(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=xo(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=xo(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=xo(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=xo(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=xo(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=xo(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=xo(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=xo(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function xo(o){return typeof o=="number"?`${o}px`:o}function Ae(o){return new Yd(o)}function RP(o){let e=HH(o);if(e&&e.length>0)return new Uint32Array(e)}var _o=0,Wl=new Uint32Array(10);function HH(o){if(_o=0,Fs(o,Mw,4352),_o>0||(Fs(o,Pw,4449),_o>0)||(Fs(o,Nw,4520),_o>0)||(Fs(o,Xd,12593),_o))return Wl.subarray(0,_o);if(o>=44032&&o<=55203){let e=o-44032,t=e%588,n=Math.floor(e/588),i=Math.floor(t/28),r=t%28-1;if(n<Mw.length?Fs(n,Mw,0):4352+n-12593<Xd.length&&Fs(4352+n,Xd,12593),i<Pw.length?Fs(i,Pw,0):4449+i-12593<Xd.length&&Fs(4449+i-12593,Xd,12593),r>=0&&(r<Nw.length?Fs(r,Nw,0):4520+r-12593<Xd.length&&Fs(4520+r-12593,Xd,12593)),_o>0)return Wl.subarray(0,_o)}}function Fs(o,e,t){o>=t&&o<t+e.length&&UH(e[o-t])}function UH(o){o!==0&&(Wl[_o++]=o&255,o>>8&&(Wl[_o++]=o>>8&255),o>>16&&(Wl[_o++]=o>>16&255))}var Mw=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),Pw=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),Nw=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),Xd=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function Hu(...o){return function(e,t){for(let n=0,i=o.length;n<i;n++){let r=o[n](e,t);if(r)return r}return null}}var Aj=OP.bind(void 0,!1),Jd=OP.bind(void 0,!0);function OP(o,e,t){if(!t||t.length<e.length)return null;let n;return o?n=Dl(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}function ey(o,e){let t=e.toLowerCase().indexOf(o.toLowerCase());return t===-1?null:[{start:t,end:t+o.length}]}function Hw(o,e){return Fw(o.toLowerCase(),e.toLowerCase(),0,0)}function Fw(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]===e[n]){let i=null;return(i=Fw(o,e,t+1,n+1))?Kw({start:n,end:n+1},i):null}return Fw(o,e,t,n+1)}function Uw(o){return 97<=o&&o<=122}function ty(o){return 65<=o&&o<=90}function zw(o){return 48<=o&&o<=57}function AP(o){return o===32||o===9||o===10||o===13}var FP=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(o=>FP.add(o.charCodeAt(0)));function Jv(o){return AP(o)||FP.has(o)}function MP(o,e){return o===e||Jv(o)&&Jv(e)}var Ow=new Map;function PP(o){if(Ow.has(o))return Ow.get(o);let e,t=RP(o);return t&&(e=t),Ow.set(o,e),e}function BP(o){return Uw(o)||ty(o)||zw(o)}function Kw(o,e){return e.length===0?e=[o]:o.end===e[0].start?e[0].start=o.start:e.unshift(o),e}function WP(o,e){for(let t=e;t<o.length;t++){let n=o.charCodeAt(t);if(ty(n)||zw(n)||t>0&&!BP(o.charCodeAt(t-1)))return t}return o.length}function Bw(o,e,t,n){if(t===o.length)return[];if(n===e.length)return null;if(o[t]!==e[n].toLowerCase())return null;{let i=null,r=n+1;for(i=Bw(o,e,t+1,n+1);!i&&(r=WP(e,r))<e.length;)i=Bw(o,e,t+1,r),r++;return i===null?null:Kw({start:n,end:n+1},i)}}function zH(o){let e=0,t=0,n=0,i=0,r=0;for(let c=0;c<o.length;c++)r=o.charCodeAt(c),ty(r)&&e++,Uw(r)&&t++,BP(r)&&n++,zw(r)&&i++;let s=e/o.length,a=t/o.length,l=n/o.length,d=i/o.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function KH(o){let{upperPercent:e,lowerPercent:t}=o;return t===0&&e>.6}function GH(o){let{upperPercent:e,lowerPercent:t,alphaPercent:n,numericPercent:i}=o;return t>.2&&e<.8&&n>.6&&i<.2}function $H(o){let e=0,t=0,n=0,i=0;for(let r=0;r<o.length;r++)n=o.charCodeAt(r),ty(n)&&e++,Uw(n)&&t++,AP(n)&&i++;return(e===0||t===0)&&i===0?o.length<=30:e<=5}function ig(o,e){if(!e||(e=e.trim(),e.length===0)||!$H(o))return null;e.length>60&&(e=e.substring(0,60));let t=zH(e);if(!GH(t)){if(!KH(t))return null;e=e.toLowerCase()}let n=null,i=0;for(o=o.toLowerCase();i<e.length&&(n=Bw(o,e,0,i))===null;)i=WP(e,i+1);return n}function Ul(o,e,t=!1){if(!e||e.length===0)return null;let n=null,i=0;for(o=o.toLowerCase(),e=e.toLowerCase();i<e.length&&(n=Ww(o,e,0,i,t),n===null);)i=VP(e,i+1);return n}function Ww(o,e,t,n,i){let r=0;if(t===o.length)return[];if(n===e.length)return null;if(!MP(o.charCodeAt(t),e.charCodeAt(n))){let l=PP(o.charCodeAt(t));if(!l)return null;for(let d=0;d<l.length;d++)if(!MP(l[d],e.charCodeAt(n+d)))return null;r+=l.length-1}let s=null,a=n+r+1;if(s=Ww(o,e,t+1,a,i),!i)for(;!s&&(a=VP(e,a))<e.length;)s=Ww(o,e,t+1,a,i),a++;if(!s)return null;if(o.charCodeAt(t)!==e.charCodeAt(n)){let l=PP(o.charCodeAt(t));if(!l)return s;for(let d=0;d<l.length;d++)if(l[d]!==e.charCodeAt(n+d))return s}return Kw({start:n,end:n+r+1},s)}function VP(o,e){for(let t=e;t<o.length;t++)if(Jv(o.charCodeAt(t))||t>0&&Jv(o.charCodeAt(t-1)))return t;return o.length}var Fj=Hu(Jd,ig,ey),Bj=Hu(Jd,ig,Hw),Wj=new Pi(1e4);function HP(o,e){let t=Qd(o,o.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?Gw(t):null}function UP(o,e,t,n,i,r){let s=Math.min(13,o.length);for(;t<s;t++){let a=Qd(o,e,t,n,i,r,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(a)return a}return[0,r]}function Gw(o){if(typeof o>"u")return[];let e=[],t=o[1];for(let n=o.length-1;n>1;n--){let i=o[n]+t,r=e[e.length-1];r&&r.end===i?r.end=i+1:e.push({start:i,end:i+1})}return e}var Hl=128;function $w(){let o=[],e=[];for(let t=0;t<=Hl;t++)e[t]=0;for(let t=0;t<=Hl;t++)o.push(e.slice(0));return o}function zP(o){let e=[];for(let t=0;t<=o;t++)e[t]=0;return e}var KP=zP(2*Hl),Vw=zP(2*Hl),Bs=$w(),Vl=$w(),ng=$w(),jH=!1;function Aw(o,e,t,n,i){function r(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${n.split("").map(a=>r(a,3)).join("|")}
`;for(let a=0;a<=t;a++)a===0?s+=" |":s+=`${e[a-1]}|`,s+=o[a].slice(0,i+1).map(l=>r(l.toString(),3)).join("|")+`
`;return s}function qH(o,e,t,n){o=o.substr(e),t=t.substr(n),console.log(Aw(Vl,o,o.length,t,t.length)),console.log(Aw(ng,o,o.length,t,t.length)),console.log(Aw(Bs,o,o.length,t,t.length))}function Zv(o,e){if(e<0||e>=o.length)return!1;let t=o.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!Om(t)}}function NP(o,e){if(e<0||e>=o.length)return!1;switch(o.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function Qv(o,e,t){return e[o]!==t[o]}function YH(o,e,t,n,i,r,s=!1){for(;e<t&&i<r;)o[e]===n[i]&&(s&&(KP[e]=i),e+=1),i+=1;return e===t}var ec;(t=>{t.Default=[-100,0];function e(n){return!n||n.length===2&&n[0]===-100&&n[1]===0}t.isDefault=e})(ec||={});var Zd=class{constructor(e,t){this.firstMatchCanBeWeak=e;this.boostFullMatch=t}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function Qd(o,e,t,n,i,r,s=Zd.default){let a=o.length>Hl?Hl:o.length,l=n.length>Hl?Hl:n.length;if(t>=a||r>=l||a-t>l-r||!YH(e,t,a,i,r,l,!0))return;XH(a,l,t,r,e,i);let d=1,c=1,u=t,p=r,m=[!1];for(d=1,u=t;u<a;d++,u++){let I=KP[u],C=Vw[u],S=u+1<a?Vw[u+1]:l;for(c=I-r+1,p=I;p<S;c++,p++){let _=Number.MIN_SAFE_INTEGER,R=!1;p<=C&&(_=ZH(o,e,u,t,n,i,p,l,r,Bs[d-1][c-1]===0,m));let N=0;_!==Number.MAX_SAFE_INTEGER&&(R=!0,N=_+Vl[d-1][c-1]);let F=p>I,P=F?Vl[d][c-1]+(Bs[d][c-1]>0?-5:0):0,H=p>I+1&&Bs[d][c-1]>0,U=H?Vl[d][c-2]+(Bs[d][c-2]>0?-5:0):0;if(H&&(!F||U>=P)&&(!R||U>=N))Vl[d][c]=U,ng[d][c]=3,Bs[d][c]=0;else if(F&&(!R||P>=N))Vl[d][c]=P,ng[d][c]=2,Bs[d][c]=0;else if(R)Vl[d][c]=N,ng[d][c]=1,Bs[d][c]=Bs[d-1][c-1]+1;else throw new Error("not possible")}}if(jH&&qH(o,t,n,r),!m[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let f=[Vl[d][c],r],g=0,b=0;for(;d>=1;){let I=c;do{let C=ng[d][I];if(C===3)I=I-2;else if(C===2)I=I-1;else break}while(I>=1);g>1&&e[t+d-1]===i[r+c-1]&&!Qv(I+r-1,n,i)&&g+1>Bs[d][I]&&(I=c),I===c?g++:g=1,b||(b=I),d--,c=I-1,f.push(c)}l-r===a&&s.boostFullMatch&&(f[0]+=2);let v=b-a;return f[0]-=v,f}function XH(o,e,t,n,i,r){let s=o-1,a=e-1;for(;s>=t&&a>=n;)i[s]===r[a]&&(Vw[s]=a,s--),a--}function ZH(o,e,t,n,i,r,s,a,l,d,c){if(e[t]!==r[s])return Number.MIN_SAFE_INTEGER;let u=1,p=!1;return s===t-n?u=o[t]===i[s]?7:5:Qv(s,i,r)&&(s===0||!Qv(s-1,i,r))?(u=o[t]===i[s]?7:5,p=!0):Zv(r,s)&&(s===0||!Zv(r,s-1))?u=5:(Zv(r,s-1)||NP(r,s-1))&&(u=5,p=!0),u>1&&t===n&&(c[0]=!0),p||(p=Qv(s,i,r)||Zv(r,s-1)||NP(r,s-1)),t===n?s>l&&(u-=p?3:5):d?u+=p?2:0:u+=p?0:1,s+1===a&&(u-=p?3:5),u}function GP(o,e,t,n,i,r,s){return QH(o,e,t,n,i,r,!0,s)}function QH(o,e,t,n,i,r,s,a){let l=Qd(o,e,t,n,i,r,a);if(l&&!s)return l;if(o.length>=3){let d=Math.min(7,o.length-1);for(let c=t+1;c<d;c++){let u=JH(o,c);if(u){let p=Qd(u,u.toLowerCase(),t,n,i,r,a);p&&(p[0]-=3,(!l||p[0]>l[0])&&(l=p))}}}return l}function JH(o,e){if(e+1>=o.length)return;let t=o[e],n=o[e+1];if(t!==n)return o.slice(0,e)+n+t+o.slice(e+2)}var jw=Object.create(null);function y(o,e){if(Lt(e)){let t=jw[e];if(t===void 0)throw new Error(`${o} references an unknown codicon: ${e}`);e=t}return jw[o]=e,{id:o}}function qw(){return jw}var $P={add:y("add",6e4),plus:y("plus",6e4),gistNew:y("gist-new",6e4),repoCreate:y("repo-create",6e4),lightbulb:y("lightbulb",60001),lightBulb:y("light-bulb",60001),repo:y("repo",60002),repoDelete:y("repo-delete",60002),gistFork:y("gist-fork",60003),repoForked:y("repo-forked",60003),gitPullRequest:y("git-pull-request",60004),gitPullRequestAbandoned:y("git-pull-request-abandoned",60004),recordKeys:y("record-keys",60005),keyboard:y("keyboard",60005),tag:y("tag",60006),gitPullRequestLabel:y("git-pull-request-label",60006),tagAdd:y("tag-add",60006),tagRemove:y("tag-remove",60006),person:y("person",60007),personFollow:y("person-follow",60007),personOutline:y("person-outline",60007),personFilled:y("person-filled",60007),gitBranch:y("git-branch",60008),gitBranchCreate:y("git-branch-create",60008),gitBranchDelete:y("git-branch-delete",60008),sourceControl:y("source-control",60008),mirror:y("mirror",60009),mirrorPublic:y("mirror-public",60009),star:y("star",60010),starAdd:y("star-add",60010),starDelete:y("star-delete",60010),starEmpty:y("star-empty",60010),comment:y("comment",60011),commentAdd:y("comment-add",60011),alert:y("alert",60012),warning:y("warning",60012),search:y("search",60013),searchSave:y("search-save",60013),logOut:y("log-out",60014),signOut:y("sign-out",60014),logIn:y("log-in",60015),signIn:y("sign-in",60015),eye:y("eye",60016),eyeUnwatch:y("eye-unwatch",60016),eyeWatch:y("eye-watch",60016),circleFilled:y("circle-filled",60017),primitiveDot:y("primitive-dot",60017),closeDirty:y("close-dirty",60017),debugBreakpoint:y("debug-breakpoint",60017),debugBreakpointDisabled:y("debug-breakpoint-disabled",60017),debugHint:y("debug-hint",60017),terminalDecorationSuccess:y("terminal-decoration-success",60017),primitiveSquare:y("primitive-square",60018),edit:y("edit",60019),pencil:y("pencil",60019),info:y("info",60020),issueOpened:y("issue-opened",60020),gistPrivate:y("gist-private",60021),gitForkPrivate:y("git-fork-private",60021),lock:y("lock",60021),mirrorPrivate:y("mirror-private",60021),close:y("close",60022),removeClose:y("remove-close",60022),x:y("x",60022),repoSync:y("repo-sync",60023),sync:y("sync",60023),clone:y("clone",60024),desktopDownload:y("desktop-download",60024),beaker:y("beaker",60025),microscope:y("microscope",60025),vm:y("vm",60026),deviceDesktop:y("device-desktop",60026),file:y("file",60027),fileText:y("file-text",60027),more:y("more",60028),ellipsis:y("ellipsis",60028),kebabHorizontal:y("kebab-horizontal",60028),mailReply:y("mail-reply",60029),reply:y("reply",60029),organization:y("organization",60030),organizationFilled:y("organization-filled",60030),organizationOutline:y("organization-outline",60030),newFile:y("new-file",60031),fileAdd:y("file-add",60031),newFolder:y("new-folder",60032),fileDirectoryCreate:y("file-directory-create",60032),trash:y("trash",60033),trashcan:y("trashcan",60033),history:y("history",60034),clock:y("clock",60034),folder:y("folder",60035),fileDirectory:y("file-directory",60035),symbolFolder:y("symbol-folder",60035),logoGithub:y("logo-github",60036),markGithub:y("mark-github",60036),github:y("github",60036),terminal:y("terminal",60037),console:y("console",60037),repl:y("repl",60037),zap:y("zap",60038),symbolEvent:y("symbol-event",60038),error:y("error",60039),stop:y("stop",60039),variable:y("variable",60040),symbolVariable:y("symbol-variable",60040),array:y("array",60042),symbolArray:y("symbol-array",60042),symbolModule:y("symbol-module",60043),symbolPackage:y("symbol-package",60043),symbolNamespace:y("symbol-namespace",60043),symbolObject:y("symbol-object",60043),symbolMethod:y("symbol-method",60044),symbolFunction:y("symbol-function",60044),symbolConstructor:y("symbol-constructor",60044),symbolBoolean:y("symbol-boolean",60047),symbolNull:y("symbol-null",60047),symbolNumeric:y("symbol-numeric",60048),symbolNumber:y("symbol-number",60048),symbolStructure:y("symbol-structure",60049),symbolStruct:y("symbol-struct",60049),symbolParameter:y("symbol-parameter",60050),symbolTypeParameter:y("symbol-type-parameter",60050),symbolKey:y("symbol-key",60051),symbolText:y("symbol-text",60051),symbolReference:y("symbol-reference",60052),goToFile:y("go-to-file",60052),symbolEnum:y("symbol-enum",60053),symbolValue:y("symbol-value",60053),symbolRuler:y("symbol-ruler",60054),symbolUnit:y("symbol-unit",60054),activateBreakpoints:y("activate-breakpoints",60055),archive:y("archive",60056),arrowBoth:y("arrow-both",60057),arrowDown:y("arrow-down",60058),arrowLeft:y("arrow-left",60059),arrowRight:y("arrow-right",60060),arrowSmallDown:y("arrow-small-down",60061),arrowSmallLeft:y("arrow-small-left",60062),arrowSmallRight:y("arrow-small-right",60063),arrowSmallUp:y("arrow-small-up",60064),arrowUp:y("arrow-up",60065),bell:y("bell",60066),bold:y("bold",60067),book:y("book",60068),bookmark:y("bookmark",60069),debugBreakpointConditionalUnverified:y("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:y("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:y("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:y("debug-breakpoint-data-unverified",60072),debugBreakpointData:y("debug-breakpoint-data",60073),debugBreakpointDataDisabled:y("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:y("debug-breakpoint-log-unverified",60074),debugBreakpointLog:y("debug-breakpoint-log",60075),debugBreakpointLogDisabled:y("debug-breakpoint-log-disabled",60075),briefcase:y("briefcase",60076),broadcast:y("broadcast",60077),browser:y("browser",60078),bug:y("bug",60079),calendar:y("calendar",60080),caseSensitive:y("case-sensitive",60081),check:y("check",60082),checklist:y("checklist",60083),chevronDown:y("chevron-down",60084),chevronLeft:y("chevron-left",60085),chevronRight:y("chevron-right",60086),chevronUp:y("chevron-up",60087),chromeClose:y("chrome-close",60088),chromeMaximize:y("chrome-maximize",60089),chromeMinimize:y("chrome-minimize",60090),chromeRestore:y("chrome-restore",60091),circleOutline:y("circle-outline",60092),circle:y("circle",60092),debugBreakpointUnverified:y("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:y("terminal-decoration-incomplete",60092),circleSlash:y("circle-slash",60093),circuitBoard:y("circuit-board",60094),clearAll:y("clear-all",60095),clippy:y("clippy",60096),closeAll:y("close-all",60097),cloudDownload:y("cloud-download",60098),cloudUpload:y("cloud-upload",60099),code:y("code",60100),collapseAll:y("collapse-all",60101),colorMode:y("color-mode",60102),commentDiscussion:y("comment-discussion",60103),creditCard:y("credit-card",60105),dash:y("dash",60108),dashboard:y("dashboard",60109),database:y("database",60110),debugContinue:y("debug-continue",60111),debugDisconnect:y("debug-disconnect",60112),debugPause:y("debug-pause",60113),debugRestart:y("debug-restart",60114),debugStart:y("debug-start",60115),debugStepInto:y("debug-step-into",60116),debugStepOut:y("debug-step-out",60117),debugStepOver:y("debug-step-over",60118),debugStop:y("debug-stop",60119),debug:y("debug",60120),deviceCameraVideo:y("device-camera-video",60121),deviceCamera:y("device-camera",60122),deviceMobile:y("device-mobile",60123),diffAdded:y("diff-added",60124),diffIgnored:y("diff-ignored",60125),diffModified:y("diff-modified",60126),diffRemoved:y("diff-removed",60127),diffRenamed:y("diff-renamed",60128),diff:y("diff",60129),diffSidebyside:y("diff-sidebyside",60129),discard:y("discard",60130),editorLayout:y("editor-layout",60131),emptyWindow:y("empty-window",60132),exclude:y("exclude",60133),extensions:y("extensions",60134),eyeClosed:y("eye-closed",60135),fileBinary:y("file-binary",60136),fileCode:y("file-code",60137),fileMedia:y("file-media",60138),filePdf:y("file-pdf",60139),fileSubmodule:y("file-submodule",60140),fileSymlinkDirectory:y("file-symlink-directory",60141),fileSymlinkFile:y("file-symlink-file",60142),fileZip:y("file-zip",60143),files:y("files",60144),filter:y("filter",60145),flame:y("flame",60146),foldDown:y("fold-down",60147),foldUp:y("fold-up",60148),fold:y("fold",60149),folderActive:y("folder-active",60150),folderOpened:y("folder-opened",60151),gear:y("gear",60152),gift:y("gift",60153),gistSecret:y("gist-secret",60154),gist:y("gist",60155),gitCommit:y("git-commit",60156),gitCompare:y("git-compare",60157),compareChanges:y("compare-changes",60157),gitMerge:y("git-merge",60158),githubAction:y("github-action",60159),githubAlt:y("github-alt",60160),globe:y("globe",60161),grabber:y("grabber",60162),graph:y("graph",60163),gripper:y("gripper",60164),heart:y("heart",60165),home:y("home",60166),horizontalRule:y("horizontal-rule",60167),hubot:y("hubot",60168),inbox:y("inbox",60169),issueReopened:y("issue-reopened",60171),issues:y("issues",60172),italic:y("italic",60173),jersey:y("jersey",60174),json:y("json",60175),kebabVertical:y("kebab-vertical",60176),key:y("key",60177),law:y("law",60178),lightbulbAutofix:y("lightbulb-autofix",60179),linkExternal:y("link-external",60180),link:y("link",60181),listOrdered:y("list-ordered",60182),listUnordered:y("list-unordered",60183),liveShare:y("live-share",60184),loading:y("loading",60185),location:y("location",60186),mailRead:y("mail-read",60187),mail:y("mail",60188),markdown:y("markdown",60189),megaphone:y("megaphone",60190),mention:y("mention",60191),milestone:y("milestone",60192),gitPullRequestMilestone:y("git-pull-request-milestone",60192),mortarBoard:y("mortar-board",60193),move:y("move",60194),multipleWindows:y("multiple-windows",60195),mute:y("mute",60196),noNewline:y("no-newline",60197),note:y("note",60198),octoface:y("octoface",60199),openPreview:y("open-preview",60200),package:y("package",60201),paintcan:y("paintcan",60202),pin:y("pin",60203),play:y("play",60204),run:y("run",60204),plug:y("plug",60205),preserveCase:y("preserve-case",60206),preview:y("preview",60207),project:y("project",60208),pulse:y("pulse",60209),question:y("question",60210),quote:y("quote",60211),radioTower:y("radio-tower",60212),reactions:y("reactions",60213),references:y("references",60214),refresh:y("refresh",60215),regex:y("regex",60216),remoteExplorer:y("remote-explorer",60217),remote:y("remote",60218),remove:y("remove",60219),replaceAll:y("replace-all",60220),replace:y("replace",60221),repoClone:y("repo-clone",60222),repoForcePush:y("repo-force-push",60223),repoPull:y("repo-pull",60224),repoPush:y("repo-push",60225),report:y("report",60226),requestChanges:y("request-changes",60227),rocket:y("rocket",60228),rootFolderOpened:y("root-folder-opened",60229),rootFolder:y("root-folder",60230),rss:y("rss",60231),ruby:y("ruby",60232),saveAll:y("save-all",60233),saveAs:y("save-as",60234),save:y("save",60235),screenFull:y("screen-full",60236),screenNormal:y("screen-normal",60237),searchStop:y("search-stop",60238),server:y("server",60240),settingsGear:y("settings-gear",60241),settings:y("settings",60242),shield:y("shield",60243),smiley:y("smiley",60244),sortPrecedence:y("sort-precedence",60245),splitHorizontal:y("split-horizontal",60246),splitVertical:y("split-vertical",60247),squirrel:y("squirrel",60248),starFull:y("star-full",60249),starHalf:y("star-half",60250),symbolClass:y("symbol-class",60251),symbolColor:y("symbol-color",60252),symbolConstant:y("symbol-constant",60253),symbolEnumMember:y("symbol-enum-member",60254),symbolField:y("symbol-field",60255),symbolFile:y("symbol-file",60256),symbolInterface:y("symbol-interface",60257),symbolKeyword:y("symbol-keyword",60258),symbolMisc:y("symbol-misc",60259),symbolOperator:y("symbol-operator",60260),symbolProperty:y("symbol-property",60261),wrench:y("wrench",60261),wrenchSubaction:y("wrench-subaction",60261),symbolSnippet:y("symbol-snippet",60262),tasklist:y("tasklist",60263),telescope:y("telescope",60264),textSize:y("text-size",60265),threeBars:y("three-bars",60266),thumbsdown:y("thumbsdown",60267),thumbsup:y("thumbsup",60268),tools:y("tools",60269),triangleDown:y("triangle-down",60270),triangleLeft:y("triangle-left",60271),triangleRight:y("triangle-right",60272),triangleUp:y("triangle-up",60273),twitter:y("twitter",60274),unfold:y("unfold",60275),unlock:y("unlock",60276),unmute:y("unmute",60277),unverified:y("unverified",60278),verified:y("verified",60279),versions:y("versions",60280),vmActive:y("vm-active",60281),vmOutline:y("vm-outline",60282),vmRunning:y("vm-running",60283),watch:y("watch",60284),whitespace:y("whitespace",60285),wholeWord:y("whole-word",60286),window:y("window",60287),wordWrap:y("word-wrap",60288),zoomIn:y("zoom-in",60289),zoomOut:y("zoom-out",60290),listFilter:y("list-filter",60291),listFlat:y("list-flat",60292),listSelection:y("list-selection",60293),selection:y("selection",60293),listTree:y("list-tree",60294),debugBreakpointFunctionUnverified:y("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:y("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:y("debug-breakpoint-function-disabled",60296),debugStackframeActive:y("debug-stackframe-active",60297),circleSmallFilled:y("circle-small-filled",60298),debugStackframeDot:y("debug-stackframe-dot",60298),terminalDecorationMark:y("terminal-decoration-mark",60298),debugStackframe:y("debug-stackframe",60299),debugStackframeFocused:y("debug-stackframe-focused",60299),debugBreakpointUnsupported:y("debug-breakpoint-unsupported",60300),symbolString:y("symbol-string",60301),debugReverseContinue:y("debug-reverse-continue",60302),debugStepBack:y("debug-step-back",60303),debugRestartFrame:y("debug-restart-frame",60304),debugAlt:y("debug-alt",60305),callIncoming:y("call-incoming",60306),callOutgoing:y("call-outgoing",60307),menu:y("menu",60308),expandAll:y("expand-all",60309),feedback:y("feedback",60310),gitPullRequestReviewer:y("git-pull-request-reviewer",60310),groupByRefType:y("group-by-ref-type",60311),ungroupByRefType:y("ungroup-by-ref-type",60312),account:y("account",60313),gitPullRequestAssignee:y("git-pull-request-assignee",60313),bellDot:y("bell-dot",60314),debugConsole:y("debug-console",60315),library:y("library",60316),output:y("output",60317),runAll:y("run-all",60318),syncIgnored:y("sync-ignored",60319),pinned:y("pinned",60320),githubInverted:y("github-inverted",60321),serverProcess:y("server-process",60322),serverEnvironment:y("server-environment",60323),pass:y("pass",60324),issueClosed:y("issue-closed",60324),stopCircle:y("stop-circle",60325),playCircle:y("play-circle",60326),record:y("record",60327),debugAltSmall:y("debug-alt-small",60328),vmConnect:y("vm-connect",60329),cloud:y("cloud",60330),merge:y("merge",60331),export:y("export",60332),graphLeft:y("graph-left",60333),magnet:y("magnet",60334),notebook:y("notebook",60335),redo:y("redo",60336),checkAll:y("check-all",60337),pinnedDirty:y("pinned-dirty",60338),passFilled:y("pass-filled",60339),circleLargeFilled:y("circle-large-filled",60340),circleLarge:y("circle-large",60341),circleLargeOutline:y("circle-large-outline",60341),combine:y("combine",60342),gather:y("gather",60342),table:y("table",60343),variableGroup:y("variable-group",60344),typeHierarchy:y("type-hierarchy",60345),typeHierarchySub:y("type-hierarchy-sub",60346),typeHierarchySuper:y("type-hierarchy-super",60347),gitPullRequestCreate:y("git-pull-request-create",60348),runAbove:y("run-above",60349),runBelow:y("run-below",60350),notebookTemplate:y("notebook-template",60351),debugRerun:y("debug-rerun",60352),workspaceTrusted:y("workspace-trusted",60353),workspaceUntrusted:y("workspace-untrusted",60354),workspaceUnknown:y("workspace-unknown",60355),terminalCmd:y("terminal-cmd",60356),terminalDebian:y("terminal-debian",60357),terminalLinux:y("terminal-linux",60358),terminalPowershell:y("terminal-powershell",60359),terminalTmux:y("terminal-tmux",60360),terminalUbuntu:y("terminal-ubuntu",60361),terminalBash:y("terminal-bash",60362),arrowSwap:y("arrow-swap",60363),copy:y("copy",60364),personAdd:y("person-add",60365),filterFilled:y("filter-filled",60366),wand:y("wand",60367),debugLineByLine:y("debug-line-by-line",60368),inspect:y("inspect",60369),layers:y("layers",60370),layersDot:y("layers-dot",60371),layersActive:y("layers-active",60372),compass:y("compass",60373),compassDot:y("compass-dot",60374),compassActive:y("compass-active",60375),azure:y("azure",60376),issueDraft:y("issue-draft",60377),gitPullRequestClosed:y("git-pull-request-closed",60378),gitPullRequestDraft:y("git-pull-request-draft",60379),debugAll:y("debug-all",60380),debugCoverage:y("debug-coverage",60381),runErrors:y("run-errors",60382),folderLibrary:y("folder-library",60383),debugContinueSmall:y("debug-continue-small",60384),beakerStop:y("beaker-stop",60385),graphLine:y("graph-line",60386),graphScatter:y("graph-scatter",60387),pieChart:y("pie-chart",60388),bracket:y("bracket",60175),bracketDot:y("bracket-dot",60389),bracketError:y("bracket-error",60390),lockSmall:y("lock-small",60391),azureDevops:y("azure-devops",60392),verifiedFilled:y("verified-filled",60393),newline:y("newline",60394),layout:y("layout",60395),layoutActivitybarLeft:y("layout-activitybar-left",60396),layoutActivitybarRight:y("layout-activitybar-right",60397),layoutPanelLeft:y("layout-panel-left",60398),layoutPanelCenter:y("layout-panel-center",60399),layoutPanelJustify:y("layout-panel-justify",60400),layoutPanelRight:y("layout-panel-right",60401),layoutPanel:y("layout-panel",60402),layoutSidebarLeft:y("layout-sidebar-left",60403),layoutSidebarRight:y("layout-sidebar-right",60404),layoutStatusbar:y("layout-statusbar",60405),layoutMenubar:y("layout-menubar",60406),layoutCentered:y("layout-centered",60407),target:y("target",60408),indent:y("indent",60409),recordSmall:y("record-small",60410),errorSmall:y("error-small",60411),terminalDecorationError:y("terminal-decoration-error",60411),arrowCircleDown:y("arrow-circle-down",60412),arrowCircleLeft:y("arrow-circle-left",60413),arrowCircleRight:y("arrow-circle-right",60414),arrowCircleUp:y("arrow-circle-up",60415),layoutSidebarRightOff:y("layout-sidebar-right-off",60416),layoutPanelOff:y("layout-panel-off",60417),layoutSidebarLeftOff:y("layout-sidebar-left-off",60418),blank:y("blank",60419),heartFilled:y("heart-filled",60420),map:y("map",60421),mapHorizontal:y("map-horizontal",60421),foldHorizontal:y("fold-horizontal",60421),mapFilled:y("map-filled",60422),mapHorizontalFilled:y("map-horizontal-filled",60422),foldHorizontalFilled:y("fold-horizontal-filled",60422),circleSmall:y("circle-small",60423),bellSlash:y("bell-slash",60424),bellSlashDot:y("bell-slash-dot",60425),commentUnresolved:y("comment-unresolved",60426),gitPullRequestGoToChanges:y("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:y("git-pull-request-new-changes",60428),searchFuzzy:y("search-fuzzy",60429),commentDraft:y("comment-draft",60430),send:y("send",60431),sparkle:y("sparkle",60432),insert:y("insert",60433),mic:y("mic",60434),thumbsdownFilled:y("thumbsdown-filled",60435),thumbsupFilled:y("thumbsup-filled",60436),coffee:y("coffee",60437),snake:y("snake",60438),game:y("game",60439),vr:y("vr",60440),chip:y("chip",60441),piano:y("piano",60442),music:y("music",60443),micFilled:y("mic-filled",60444),repoFetch:y("repo-fetch",60445),copilot:y("copilot",60446),lightbulbSparkle:y("lightbulb-sparkle",60447),robot:y("robot",60448),sparkleFilled:y("sparkle-filled",60449),diffSingle:y("diff-single",60450),diffMultiple:y("diff-multiple",60451),surroundWith:y("surround-with",60452),share:y("share",60453),gitStash:y("git-stash",60454),gitStashApply:y("git-stash-apply",60455),gitStashPop:y("git-stash-pop",60456),vscode:y("vscode",60457),vscodeInsiders:y("vscode-insiders",60458),codeOss:y("code-oss",60459),runCoverage:y("run-coverage",60460),runAllCoverage:y("run-all-coverage",60461),coverage:y("coverage",60462),githubProject:y("github-project",60463),mapVertical:y("map-vertical",60464),foldVertical:y("fold-vertical",60464),mapVerticalFilled:y("map-vertical-filled",60465),foldVerticalFilled:y("fold-vertical-filled",60465),goToSearch:y("go-to-search",60466),percentage:y("percentage",60467),sortPercentage:y("sort-percentage",60467),attach:y("attach",60468)};var e4={dialogError:y("dialog-error","error"),dialogWarning:y("dialog-warning","warning"),dialogInfo:y("dialog-info","info"),dialogClose:y("dialog-close","close"),treeItemExpanded:y("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:y("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:y("tree-filter-on-type-off","list-selection"),treeFilterClear:y("tree-filter-clear","close"),treeItemLoading:y("tree-item-loading","loading"),menuSelection:y("menu-selection","check"),menuSubmenu:y("menu-submenu","chevron-right"),menuBarMore:y("menubar-more","more"),scrollbarButtonLeft:y("scrollbar-button-left","triangle-left"),scrollbarButtonRight:y("scrollbar-button-right","triangle-right"),scrollbarButtonUp:y("scrollbar-button-up","triangle-up"),scrollbarButtonDown:y("scrollbar-button-down","triangle-down"),toolBarMore:y("toolbar-more","more"),quickInputBack:y("quick-input-back","arrow-left"),dropDownButton:y("drop-down-button",60084),symbolCustomColor:y("symbol-customcolor",60252),exportIcon:y("export",60332),workspaceUnspecified:y("workspace-unspecified",60355),newLine:y("newline",60394),thumbsDownFilled:y("thumbsdown-filled",60435),thumbsUpFilled:y("thumbsup-filled",60436),gitFetch:y("git-fetch",60445),lightbulbSparkleAutofix:y("lightbulb-sparkle-autofix",60447),debugBreakpointPending:y("debug-breakpoint-pending",60377)},ue={...$P,...e4};var jP;(e=>{function o(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=o})(jP||={});var nt;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function r(b){let v=i.exec(b.id);if(!v)return r(ue.error);let[,I,C]=v,S=["codicon","codicon-"+I];return C&&S.push("codicon-modifier-"+C.substring(1)),S}g.asClassNameArray=r;function s(b){return r(b).join(" ")}g.asClassName=s;function a(b){return"."+r(b).join(".")}g.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||jP.isThemeColor(b.color))}g.isThemeIcon=l;let d=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function c(b){let v=d.exec(b);if(!v)return;let[,I]=v;return{id:I}}g.fromString=c;function u(b){return{id:b}}g.fromId=u;function p(b,v){let I=b.id,C=I.lastIndexOf("~");return C!==-1&&(I=I.substring(0,C)),v&&(I=`${I}~${v}`),{id:I}}g.modify=p;function m(b){let v=b.id.lastIndexOf("~");if(v!==-1)return b.id.substring(v+1)}g.getModifier=m;function f(b,v){return b.id===v.id&&b.color?.id===v.color?.id}g.isEqual=f})(nt||={});var t4="$(",Yw=new RegExp(`\\$\\(${nt.iconNameExpression}(?:${nt.iconModifierExpression})?\\)`,"g"),n4=new RegExp(`(\\\\)?${Yw.source}`,"g");function qP(o){return o.replace(n4,(e,t)=>t?e:`\\${e}`)}var i4=new RegExp(`\\\\${Yw.source}`,"g");function YP(o){return o.replace(i4,e=>`\\${e}`)}var o4=new RegExp(`(\\s)?(\\\\)?${Yw.source}(\\s)?`,"g");function Xw(o){return o.indexOf(t4)===-1?o:o.replace(o4,(e,t,n,i)=>n?e:t||i||"")}var rq=new RegExp(`\\$\\(${nt.iconNameCharacter}+\\)`,"g");var ny=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw wd("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=r4(this.supportThemeIcons?qP(e):e).replace(/([ \t]+)/g,(n,i)=>"&nbsp;".repeat(i.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${s4(t,e)}
`,this}appendLink(e,t,n){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),n&&(this.value+=` "${this._escape(this._escape(n,'"'),")")}"`),this.value+=")",this}_escape(e,t){let n=new RegExp(Ni(t),"g");return e.replace(n,(i,r)=>e.charAt(r-1)!=="\\"?`\\${i}`:i)}};function r4(o){return o.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function s4(o,e){let t=o.match(/^`+/gm)?.reduce((i,r)=>i.length>r.length?i:r).length??0,n=t>=3?t+1:3;return[`${"`".repeat(n)}${e}`,o,`${"`".repeat(n)}`].join(`
`)}function og(o){return o.replace(/"/g,"&quot;")}function iy(o){return o&&o.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function XP(o){let e=[],t=o.split("|").map(i=>i.trim());o=t[0];let n=t[1];if(n){let i=/height=(\d+)/.exec(n),r=/width=(\d+)/.exec(n),s=i?i[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&e.push(`width="${a}"`),d&&e.push(`height="${s}"`)}return{href:o,dimensions:e}}function ZP(o){let e=!1,t=new Map,n=new Map;if(a4(o,c=>{if(o===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let p=t.get(u);if(!p){let m={schemas:[c]};return t.set(u,m),n.set(c,m),!0}return p.schemas.push(c),n.set(c,p),e=!0,!1}),t.clear(),!e)return JSON.stringify(o);let r="$defs";for(;o.hasOwnProperty(r);)r+="_";let s=[];function a(c){return JSON.stringify(c,(u,p)=>{if(p!==c){let m=n.get(p);if(m&&m.schemas.length>1)return m.id||(m.id=`_${s.length}`,s.push(m.schemas[0])),{$ref:`#/${r}/${m.id}`}}return p})}let l=a(o),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${r}":{${d.join(",")}}}`:l}function Uu(o){return typeof o=="object"&&o!==null}function a4(o,e){if(!o||typeof o!="object")return;let t=(...l)=>{for(let d of l)Uu(d)&&s.push(d)},n=(...l)=>{for(let d of l)if(Uu(d))for(let c in d){let u=d[c];Uu(u)&&s.push(u)}},i=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)Uu(c)&&s.push(c)},r=l=>{if(Array.isArray(l))for(let d of l)Uu(d)&&s.push(d);else Uu(l)&&s.push(l)},s=[o],a=s.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),r(a.items)),a=s.pop()}var Qw=class o{constructor(e,t,n,i,r,s,a){this._forceIntegerValues=e;this._forceIntegerValues&&(t=t|0,n=n|0,i=i|0,r=r|0,s=s|0,a=a|0),this.rawScrollLeft=i,this.rawScrollTop=a,t<0&&(t=0),i+t>n&&(i=n-t),i<0&&(i=0),r<0&&(r=0),a+r>s&&(a=s-r),a<0&&(a=0),this.width=t,this.scrollWidth=n,this.scrollLeft=i,this.height=r,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new o(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new o(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){let n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:r,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},Ba=class extends V{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new L);onScroll=this._onScroll.event;constructor(e){super(),this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new Qw(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let n=this._state.withScrollDimensions(e,t);this._setState(n,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;t?i=new ry(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):i=this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{let n=this._state.withScrollPosition(e);this._smoothScrolling=ry.start(this._state,n,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}},oy=class{scrollLeft;scrollTop;isDone;constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}};function Zw(o,e){let t=e-o;return function(n){return o+t*c4(n)}}function l4(o,e,t){return function(n){return n<t?o(n/t):e((n-t)/(1-t))}}var ry=class o{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let r,s;return e<t?(r=e+.75*n,s=t-.75*n):(r=e-.75*n,s=t+.75*n),l4(Zw(e,r),Zw(s,t),.33)}return Zw(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){let t=(e-this.startTime)/this.duration;if(t<1){let n=this.scrollLeft(t),i=this.scrollTop(t);return new oy(n,i,!1)}return new oy(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return o.start(e,t,n)}static start(e,t,n){n=n+10;let i=Date.now()-10;return new o(e,t,i,n)}};function d4(o){return Math.pow(o,3)}function c4(o){return 1-d4(1-o)}var Ws={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var Jw="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function u4(o=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of Jw)o.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var sy=u4();function rg(o){let e=sy;if(o&&o instanceof RegExp)if(o.global)e=o;else{let t="g";o.ignoreCase&&(t+="i"),o.multiline&&(t+="m"),o.unicode&&(t+="u"),e=new RegExp(o.source,t)}return e.lastIndex=0,e}var QP=new An;QP.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function sg(o,e,t,n,i){if(e=rg(e),i||(i=Ts.first(QP)),t.length>i.maxLen){let d=o-i.maxLen/2;return d<0?d=0:n+=d,t=t.substring(d,o+i.maxLen/2),sg(o,e,t,n,i)}let r=Date.now(),s=o-1-n,a=-1,l=null;for(let d=1;!(Date.now()-r>=i.timeBudget);d++){let c=s-i.windowSize*d;e.lastIndex=Math.max(0,c);let u=p4(e,t,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,d}return null}function p4(o,e,t,n){let i;for(;i=o.exec(e);){let r=i.index||0;if(r<=t&&o.lastIndex>=t)return i;if(n>0&&r>n)return null}return null}function eT(...o){switch(o.length){case 1:return h("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",o[0]);case 2:return h("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",o[0],o[1]);case 3:return h("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",o[0],o[1],o[2]);default:return}}var h4=h("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),m4=h("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),zl=class o{static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw wR(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(eT("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(eT("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(eT("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;let t=this._input.substring(this._start,this._current),n=o._keywords.get(t);n?this._addToken(n):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(h4);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(m4);return}let r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!n){e++;break}else r===91?n=!0:r===92?t=!0:r===93&&(n=!1);e++}for(;e<this._input.length&&o._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var ag=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};var ay=class{_entries=new Map;constructor(...e){for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var Kl;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(r){return r[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n})(Kl||={});var dt=j("instantiationService");function g4(o,e,t){e[Kl.DI_TARGET]===e?e[Kl.DI_DEPENDENCIES].push({id:o,index:t}):(e[Kl.DI_DEPENDENCIES]=[{id:o,index:t}],e[Kl.DI_TARGET]=e)}function j(o){if(Kl.serviceIds.has(o))return Kl.serviceIds.get(o);let e=function(t,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");g4(e,t,i)};return e.toString=()=>o,Kl.serviceIds.set(o,e),e}var Qn=new Map;Qn.set("false",!1);Qn.set("true",!0);Qn.set("isMac",Ve);Qn.set("isLinux",Ut);Qn.set("isWindows",ct);Qn.set("isWeb",kr);Qn.set("isMacNative",Ve&&!kr);Qn.set("isEdge",$R);Qn.set("isFirefox",KR);Qn.set("isChrome",IE);Qn.set("isSafari",GR);var f4=Object.prototype.hasOwnProperty;var b4={regexParsingWithErrorRecovery:!0},v4=h("contextkey.parser.error.emptyString","Empty context key expression"),y4=h("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),I4=h("contextkey.parser.error.noInAfterNot","'in' after 'not'."),JP=h("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),C4=h("contextkey.parser.error.unexpectedToken","Unexpected token"),S4=h("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),x4=h("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),_4=h("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),tT=class o{constructor(e=b4){this._config=e}static _parseError=new Error;_scanner=new zl;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(e){if(e===""){this._parsingErrors.push({message:v4,offset:0,lexeme:"",additionalInfo:y4});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let n=this._peek(),i=n.type===17?S4:void 0;throw this._parsingErrors.push({message:C4,offset:n.offset,lexeme:zl.getLexeme(n),additionalInfo:i}),o._parseError}return t}catch(t){if(t!==o._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(16);){let t=this._and();e.push(t)}return e.length===1?e[0]:De.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(15);){let t=this._term();e.push(t)}return e.length===1?e[0]:De.and(...e)}_term(){if(this._matchOne(2)){let e=this._peek();switch(e.type){case 11:return this._advance(),Ii.INSTANCE;case 12:return this._advance(),Wi.INSTANCE;case 0:{this._advance();let t=this._expr();return this._consume(1,JP),t?.negate()}case 17:return this._advance(),nc.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){let e=this._peek();switch(e.type){case 11:return this._advance(),De.true();case 12:return this._advance(),De.false();case 0:{this._advance();let t=this._expr();return this._consume(1,JP),t}case 17:{let t=e.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let r=i.lexeme,s=r.lastIndexOf("/"),a=s===r.length-1?void 0:this._removeFlagsGY(r.substring(s+1)),l;try{l=new RegExp(r.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return gg.create(t,l)}switch(i.type){case 10:case 19:{let r=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<i.lexeme.length;p++)i.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;r.push(zl.getLexeme(s)),this._advance(),s=this._peek()}let l=r.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",i)}return De.regex(t,u)}case 18:{let r=i.lexeme;this._advance();let s=null;if(!uv(r)){let a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){let d=r.slice(a+1,l),c=r[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return gg.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,I4);let i=this._value();return De.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return De.equals(t,i);switch(i){case"true":return De.has(t);case"false":return De.not(t);default:return De.equals(t,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return De.notEquals(t,i);switch(i){case"true":return De.not(t);case"false":return De.has(t);default:return De.notEquals(t,i)}}case 5:return this._advance(),hg.create(t,this._value());case 6:return this._advance(),mg.create(t,this._value());case 7:return this._advance(),ug.create(t,this._value());case 8:return this._advance(),pg.create(t,this._value());case 13:return this._advance(),De.in(t,this._value());default:return De.has(t)}}case 20:throw this._parsingErrors.push({message:x4,offset:e.offset,lexeme:"",additionalInfo:_4}),o._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){let i=h("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,zl.getLexeme(t)),r=t.offset,s=zl.getLexeme(t);return this._parsingErrors.push({message:i,offset:r,lexeme:s,additionalInfo:n}),o._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},De=class{static false(){return Ii.INSTANCE}static true(){return Wi.INSTANCE}static has(e){return tc.create(e)}static equals(e,t){return dg.create(e,t)}static notEquals(e,t){return cg.create(e,t)}static regex(e,t){return gg.create(e,t)}static in(e,t){return ly.create(e,t)}static notIn(e,t){return dy.create(e,t)}static not(e){return nc.create(e)}static and(...e){return cy.create(e,null,!0)}static or(...e){return fg.create(e,null,!0)}static greater(e,t){return ug.create(e,t)}static greaterEquals(e,t){return pg.create(e,t)}static smaller(e,t){return hg.create(e,t)}static smallerEquals(e,t){return mg.create(e,t)}static _parser=new tT({regexParsingWithErrorRecovery:!1});static deserialize(e){return e==null?void 0:this._parser.parse(e)}};function lg(o,e){return o.cmp(e)}var Ii=class o{static INSTANCE=new o;type=0;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return Wi.INSTANCE}},Wi=class o{static INSTANCE=new o;type=1;constructor(){}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Ii.INSTANCE}},tc=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Qn.get(e);return typeof n=="boolean"?n?Wi.INSTANCE:Ii.INSTANCE:new o(e,t)}type=2;cmp(e){return e.type!==this.type?this.type-e.type:nN(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Qn.get(this.key);return typeof e=="boolean"?e?Wi.INSTANCE:Ii.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=nc.create(this.key,this)),this.negated}},dg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?tc.create(e,n):nc.create(e,n);let i=Qn.get(e);return typeof i=="boolean"?t===(i?"true":"false")?Wi.INSTANCE:Ii.INSTANCE:new o(e,t,n)}type=4;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Qn.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Wi.INSTANCE:Ii.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=cg.create(this.key,this.value,this)),this.negated}},ly=class o{constructor(e,t){this.key=e;this.valueKey=t}static create(e,t){return new o(e,t)}type=10;negated=null;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?f4.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=dy.create(this.key,this.valueKey)),this.negated}},dy=class o{constructor(e,t){this.key=e;this.valueKey=t;this._negated=ly.create(e,t)}static create(e,t){return new o(e,t)}type=11;_negated;cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},cg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){if(typeof t=="boolean")return t?nc.create(e,n):tc.create(e,n);let i=Qn.get(e);return typeof i=="boolean"?t===(i?"true":"false")?Ii.INSTANCE:Wi.INSTANCE:new o(e,t,n)}type=5;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=Qn.get(this.key);if(typeof e=="boolean"){let t=e?"true":"false";return this.value===t?Ii.INSTANCE:Wi.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=dg.create(this.key,this.value,this)),this.negated}},nc=class o{constructor(e,t){this.key=e;this.negated=t}static create(e,t=null){let n=Qn.get(e);return typeof n=="boolean"?n?Ii.INSTANCE:Wi.INSTANCE:new o(e,t)}type=3;cmp(e){return e.type!==this.type?this.type-e.type:nN(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=Qn.get(this.key);return typeof e=="boolean"?e?Ii.INSTANCE:Wi.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=tc.create(this.key,this)),this.negated}};function uy(o,e){if(typeof o=="string"){let t=parseFloat(o);isNaN(t)||(o=t)}return typeof o=="string"||typeof o=="number"?e(o):Ii.INSTANCE}var ug=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return uy(t,i=>new o(e,i,n))}type=12;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=mg.create(this.key,this.value,this)),this.negated}},pg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return uy(t,i=>new o(e,i,n))}type=13;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=hg.create(this.key,this.value,this)),this.negated}},hg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return uy(t,i=>new o(e,i,n))}type=14;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=pg.create(this.key,this.value,this)),this.negated}},mg=class o{constructor(e,t,n){this.key=e;this.value=t;this.negated=n}static create(e,t,n=null){return uy(t,i=>new o(e,i,n))}type=15;cmp(e){return e.type!==this.type?this.type-e.type:ic(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ug.create(this.key,this.value,this)),this.negated}},gg=class o{constructor(e,t){this.key=e;this.regexp=t}static create(e,t){return new o(e,t)}type=7;negated=null;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=nT.create(this)),this.negated}},nT=class o{constructor(e){this._actual=e}static create(e){return new o(e)}type=8;cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new o(this._actual.map(e))}negate(){return this._actual}};function tN(o){let e=null;for(let t=0,n=o.length;t<n;t++){let i=o[t].substituteConstants();if(o[t]!==i&&e===null){e=[];for(let r=0;r<t;r++)e[r]=o[r]}e!==null&&(e[t]=i)}return e===null?o:e}var cy=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=6;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=lg(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=tN(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){let i=[],r=!1;for(let s of e)if(s){if(s.type===1){r=!0;continue}if(s.type===0)return Ii.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&r)return Wi.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(lg);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,d=fg.create(s.expr.map(c=>o.create([c,a],null,n)),null,l);d&&(i.push(d),i.sort(lg))}if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return Ii.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=fg.create(e,this,!0)}return this.negated}},fg=class o{constructor(e,t){this.expr=e;this.negated=t}static create(e,t,n){return o._normalizeArr(e,t,n)}type=9;cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let i=lg(this.expr[t],e.expr[t]);if(i!==0)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let e=tN(this.expr);return e===this.expr?this:o.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let i=[],r=!1;if(e){for(let s=0,a=e.length;s<a;s++){let l=e[s];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return Wi.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&r)return Ii.INSTANCE;i.sort(lg)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(n){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return Wi.INSTANCE;if(i.length===1)return i[0]}return new o(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(e){return new o(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){let t=e.shift(),n=e.shift(),i=[];for(let r of eN(t))for(let s of eN(n))i.push(cy.create([r,s],null,!1));e.unshift(o.create(i,null,!1))}this.negated=o.create(e,this,!0)}return this.negated}},me=class o extends tc{static _info=[];static all(){return o._info.values()}_defaultValue;constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?o._info.push({...n,key:e}):n!==!0&&o._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return dg.create(this.key,e)}notEqualsTo(e){return cg.create(this.key,e)}},Rt=j("contextKeyService");function nN(o,e){return o<e?-1:o>e?1:0}function ic(o,e,t,n){return o<t?-1:o>t?1:e<n?-1:e>n?1:0}function eN(o){return o.type===9?o.expr:[o]}var Vi=j("accessibilityService");var sY=new me("accessibilityModeEnabled",!1);var iT=class{_value="";_pos=0;reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){let t=e.charCodeAt(0),n=this._value.charCodeAt(this._pos);return t-n}value(){return this._value[this._pos]}},oT=class{constructor(e=!0){this._caseSensitive=e}_value;_from;_to;reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?mv(e,this._value,0,e.length,this._from,this._to):Eu(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},py=class{constructor(e=!0,t=!0){this._splitOnBackslash=e;this._caseSensitive=t}_value;_valueLen;_from;_to;reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){let n=this._value.charCodeAt(t);if(!(n===47||this._splitOnBackslash&&n===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){let t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?mv(e,this._value,0,e.length,this._from,this._to):Eu(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}};var rT=class{constructor(e,t){this._ignorePathCasing=e;this._ignoreQueryAndFragment=t}_pathIterator;_value;_states=[];_stateIdx=0;reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new py(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return Co(e,this._value.scheme);if(this._states[this._stateIdx]===2)return Co(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return km(e,this._value.query);if(this._states[this._stateIdx]===5)return km(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}},zu=class{height=1;segment;value;key;left;mid;right;isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){let e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){let e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}};var Ku=class o{static forUris(e=()=>!1,t=()=>!1){return new o(new rT(e,t))}static forPaths(e=!1){return new o(new py(void 0,!e))}static forStrings(){return new o(new iT)}static forConfigKeys(){return new o(new oT)}_iter;_root;constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){let n=t.slice(0);hE(n);for(let i of n)this.set(i,e)}else{let n=e.slice(0);hE(n);for(let i of n)this.set(i[0],i[1])}}set(e,t){let n=this._iter.reset(e),i;this._root||(this._root=new zu,this._root.segment=n.value());let r=[];for(i=this._root;;){let a=n.cmp(i.segment);if(a>0)i.left||(i.left=new zu,i.left.segment=n.value()),r.push([-1,i]),i=i.left;else if(a<0)i.right||(i.right=new zu,i.right.segment=n.value()),r.push([1,i]),i=i.right;else if(n.hasNext())n.next(),i.mid||(i.mid=new zu,i.mid.segment=n.value()),r.push([0,i]),i=i.mid;else break}let s=i.value;i.value=t,i.key=e;for(let a=r.length-1;a>=0;a--){let l=r[a][1];l.updateHeight();let d=l.balanceFactor();if(d<-1||d>1){let c=r[a][0],u=r[a+1][0];if(c===1&&u===1)r[a][1]=l.rotateLeft();else if(c===-1&&u===-1)r[a][1]=l.rotateRight();else if(c===1&&u===-1)l.right=r[a+1][1]=r[a+1][1].rotateRight(),r[a][1]=l.rotateLeft();else if(c===-1&&u===1)l.left=r[a+1][1]=r[a+1][1].rotateLeft(),r[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(r[a-1][0]){case-1:r[a-1][1].left=r[a][1];break;case 1:r[a-1][1].right=r[a][1];break;case 0:r[a-1][1].mid=r[a][1];break}else this._root=r[0][1]}}return s}get(e){return this._getNode(e)?.value}_getNode(e){let t=this._iter.reset(e),n=this._root;for(;n;){let i=t.cmp(n.segment);if(i>0)n=n.left;else if(i<0)n=n.right;else if(t.hasNext())t.next(),n=n.mid;else break}return n}has(e){let t=this._getNode(e);return!(t?.value===void 0&&t?.mid===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){let n=this._iter.reset(e),i=[],r=this._root;for(;r;){let s=n.cmp(r.segment);if(s>0)i.push([-1,r]),r=r.left;else if(s<0)i.push([1,r]),r=r.right;else if(n.hasNext())n.next(),i.push([0,r]),r=r.mid;else break}if(r){if(t?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){let s=this._min(r.right);if(s.key){let{key:a,value:l,segment:d}=s;this._delete(s.key,!1),r.key=a,r.value=l,r.segment=d}}else{let s=r.left??r.right;if(i.length>0){let[a,l]=i[i.length-1];switch(a){case-1:l.left=s;break;case 0:l.mid=s;break;case 1:l.right=s;break}}else this._root=s}for(let s=i.length-1;s>=0;s--){let a=i[s][1];a.updateHeight();let l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),i[s][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),i[s][1]=a.rotateRight()),s>0)switch(i[s-1][0]){case-1:i[s-1][1].left=i[s][1];break;case 1:i[s-1][1].right=i[s][1];break;case 0:i[s-1][1].mid=i[s][1];break}else this._root=i[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){let t=this._iter.reset(e),n=this._root,i;for(;n;){let r=t.cmp(n.segment);if(r>0)n=n.left;else if(r<0)n=n.right;else if(t.hasNext())t.next(),i=n.value||i,n=n.mid;else break}return n&&n.value||i}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){let n=this._iter.reset(e),i=this._root;for(;i;){let r=n.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(n.hasNext())n.next(),i=i.mid;else return i.mid?this._entries(i.mid):t?i.value:void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(let[t,n]of this)e(n,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){let t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){let e=t=>{if(!t)return!0;let n=t.balanceFactor();return n<-1||n>1?!1:e(t.left)&&e(t.right)};return e(this._root)}};var tr=j("environmentService"),bY=tr;var to=j("contextService");function Gl(o){let e=o;return typeof e?.id=="string"&&le.isUri(e.uri)}function oN(o){return typeof o?.id=="string"&&!Gl(o)&&!bg(o)}var E4={id:"ext-dev"},w4={id:"empty-window"};function rN(o,e){if(typeof o=="string"||typeof o>"u")return typeof o=="string"?{id:ur(o)}:e?E4:w4;let t=o;return t.configuration?{id:t.id,configPath:t.configuration}:t.folders.length===1?{id:t.id,uri:t.folders[0].uri}:{id:t.id}}function bg(o){let e=o;return typeof e?.id=="string"&&le.isUri(e.configPath)}var vg="code-workspace",RY=`.${vg}`,MY=[{name:h("codeWorkspace","Code Workspace"),extensions:[vg]}];var Xt=j("configurationService");function sN(o){return o.applicationValue!==void 0||o.userValue!==void 0||o.userLocalValue!==void 0||o.userRemoteValue!==void 0||o.workspaceValue!==void 0||o.workspaceFolderValue!==void 0}function aN(o){return o.replace(/[\[\]]/g,"")}var sT=class{data=new Map;add(e,t){Zb(Lt(e)),Zb(Ht(t)),Zb(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}},et=new sT;var Wa={JSONContribution:"base.contributions.json"};function T4(o){return o.length>0&&o.charAt(o.length-1)==="#"?o.substring(0,o.length-1):o}var aT=class{schemasById;_onDidChangeSchema=new L;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(e,t){this.schemasById[T4(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?ZP(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}},L4=new aT;et.add(Wa.JSONContribution,L4);var JY=j("policy");var nr={Configuration:"base.contributions.configuration"};var my={properties:{},patternProperties:{}},gy={properties:{},patternProperties:{}},fy={properties:{},patternProperties:{}},by={properties:{},patternProperties:{}},vy={properties:{},patternProperties:{}},yg={properties:{},patternProperties:{}},oc="vscode://schemas/settings/resourceLanguage";var yy=et.as(Wa.JSONContribution),lT=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new L;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new L;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},yy.registerSchema(oc,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),yy.registerSchema(oc,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),yy.registerSchema(oc,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),yy.registerSchema(oc,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:i,source:r}of e)for(let s in i){t.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:r}),Ur.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,r),n.push(...D4(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,r,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let n of e){let i=this.registeredConfigurationDefaults.indexOf(n);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:n,source:i}of e)for(let r in n){let s=this.configurationDefaultsOverrides.get(r);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===n[r]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(r),Ur.test(r)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,d.value,d.source,l);l&&!xv(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(r,l,i)):(this.configurationDefaultsOverrides.delete(r),delete this.configurationProperties[r],delete this.defaultLanguageConfigurationOverridesNode.properties[r])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(r,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}t.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let i={type:"object",default:t.value,description:h("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",aN(e)),$ref:oc,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=i,this.defaultLanguageConfigurationOverridesNode.properties[e]=i}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,i){let r=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(t)){let l=t[a];if(Ht(l)&&(Oi(r[a])||Ht(r[a]))){if(r[a]={...r[a]??{},...l},n)for(let c in l)s.set(`${a}.${c}`,n)}else r[a]=l,n?s.set(a,n):s.delete(a)}return{value:r,source:s}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,i){let r=this.configurationProperties[e],s=i?.value??r?.defaultDefaultValue,a=n;if(Ht(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(Oi(s)||Ht(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in t)n&&a.set(`${e}.${d}`,n);t={...Ht(s)?s:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(i=>{this.validateAndRegisterProperties(i,t,i.extensionInfo,i.restrictedProperties,void 0,n),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(e,t){let n=i=>{if(i.properties)for(let r in i.properties){t.add(r);let s=this.configurationProperties[r];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[r],this.removeFromSchema(r,i.properties[r])}i.allOf?.forEach(r=>n(r))};for(let i of e){n(i);let r=this.configurationContributors.indexOf(i);r!==-1&&this.configurationContributors.splice(r,1)}}validateAndRegisterProperties(e,t=!0,n,i,r=3,s){r=Yn(e.scope)?r:e.scope;let a=e.properties;if(a)for(let d in a){let c=a[d];if(t&&k4(d,c)){delete a[d];continue}if(c.source=n,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),Ur.test(d)?c.scope=void 0:(c.scope=Yn(c.scope)?r:c.scope,c.restricted=Yn(c.restricted)?!!i?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=e.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,t,n,i,r,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=n=>{let i=n.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);n.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(my.properties[e]=t,t.scope){case 1:gy.properties[e]=t;break;case 2:fy.properties[e]=t;break;case 6:by.properties[e]=t;break;case 3:vy.properties[e]=t;break;case 4:yg.properties[e]=t;break;case 5:yg.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete my.properties[e],t.scope){case 1:delete gy.properties[e];break;case 2:delete fy.properties[e];break;case 6:delete by.properties[e];break;case 3:delete vy.properties[e];break;case 4:case 5:delete yg.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:oc};this.updatePropertyDefaultValue(t,n),my.properties[t]=n,gy.properties[t]=n,fy.properties[t]=n,by.properties[t]=n,vy.properties[t]=n,yg.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:oc};my.patternProperties[rc]=e,gy.patternProperties[rc]=e,fy.patternProperties[rc]=e,by.patternProperties[rc]=e,vy.patternProperties[rc]=e,yg.patternProperties[rc]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,i,r;n&&(!t.disallowConfigurationDefault||!n.source)&&(i=n.value,r=n.source),Oi(i)&&(i=t.defaultDefaultValue,r=void 0),Oi(i)&&(i=dT(t.type)),t.default=i,t.defaultValueSource=r}},dN="\\[([^\\]]+)\\]",lN=new RegExp(dN,"g"),rc=`^(${dN})+$`,Ur=new RegExp(rc);function D4(o){let e=[];if(Ur.test(o)){let t=lN.exec(o);for(;t?.length;){let n=t[1].trim();n&&e.push(n),t=lN.exec(o)}}return dr(e)}function dT(o){switch(Array.isArray(o)?o[0]:o){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var Iy=new lT;et.add(nr.Configuration,Iy);function k4(o,e){return o.trim()?Ur.test(o)?h("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",o):Iy.getConfigurationProperties()[o]!==void 0?h("config.property.duplicate","Cannot register '{0}'. This property is already registered.",o):e.policy?.name&&Iy.getPolicyConfigurations().get(e.policy?.name)!==void 0?h("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",o,e.policy?.name,Iy.getPolicyConfigurations().get(e.policy?.name)):null:h("config.property.empty","Cannot register an empty property")}var Kr=8,Cy=class{_values;constructor(e){this._values=e}hasChanged(e){return this._values[e]}},Ig=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},It=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return xy(e,t)}compute(e,t,n){return n}},$u=class{constructor(e,t){this.newValue=e;this.didChange=t}};function xy(o,e){if(typeof o!="object"||typeof e!="object"||!o||!e)return new $u(e,o!==e);if(Array.isArray(o)||Array.isArray(e)){let n=Array.isArray(o)&&Array.isArray(e)&&tn(o,e);return new $u(e,!n)}let t=!1;for(let n in e)if(e.hasOwnProperty(n)){let i=xy(o[n],e[n]);i.didChange&&(o[n]=i.newValue,t=!0)}return new $u(o,t)}var ac=class{id;name;defaultValue;schema=void 0;constructor(e){this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return xy(e,t)}validate(e){return this.defaultValue}},$l=class{id;name;defaultValue;schema;constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}applyUpdate(e,t){return xy(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}};function _e(o,e){return typeof o>"u"?e:o==="false"?!1:!!o}var Ye=class extends $l{constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return _e(e,this.defaultValue)}};function R4(o,e,t,n){if(typeof o>"u")return e;let i=parseInt(o,10);return isNaN(i)?e:(i=Math.max(t,i),i=Math.min(n,i),i|0)}var gt=class o extends $l{static clampedInt(e,t,n,i){return R4(e,t,n,i)}minimum;maximum;constructor(e,t,n,i,r,s=void 0){typeof s<"u"&&(s.type="integer",s.default=n,s.minimum=i,s.maximum=r),super(e,t,n,s),this.minimum=i,this.maximum=r}validate(e){return o.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}};var br=class o extends $l{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;let n=parseFloat(e);return isNaN(n)?t:n}validationFn;constructor(e,t,n,i,r){typeof r<"u"&&(r.type="number",r.default=n),super(e,t,n,r),this.validationFn=i}validate(e){return this.validationFn(o.float(e,this.defaultValue))}},fi=class o extends $l{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,i=void 0){typeof i<"u"&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return o.string(e,this.defaultValue)}};function Kt(o,e,t,n){return typeof o!="string"?e:n&&o in n?n[o]:t.indexOf(o)===-1?e:o}var Mt=class extends $l{_allowedValues;constructor(e,t,n,i,r=void 0){typeof r<"u"&&(r.type="string",r.enum=i,r.default=n),super(e,t,n,r),this._allowedValues=i}validate(e){return Kt(e,this.defaultValue,this._allowedValues)}},Gu=class extends It{_allowedValues;_convert;constructor(e,t,n,i,r,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=i),super(e,t,n,a),this._allowedValues=r,this._convert=s}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function M4(o){switch(o){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var cT=class extends It{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[h("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),h("accessibilitySupport.on","Optimize for usage with a Screen Reader."),h("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return n===0?e.accessibilitySupport:n}},uT=class extends It{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertSpace:_e(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:_e(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function P4(o){switch(o){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function N4(o){switch(o){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var pT=class extends ac{constructor(){super(144)}compute(e,t,n){let i=["monaco-editor"];return t.get(40)&&i.push(t.get(40)),e.extraEditorClassName&&i.push(e.extraEditorClassName),t.get(75)==="default"?i.push("mouse-default"):t.get(75)==="copy"&&i.push("mouse-copy"),t.get(113)&&i.push("showUnused"),t.get(142)&&i.push("showDeprecated"),i.join(" ")}},hT=class extends Ye{constructor(){super(38,"emptySelectionClipboard",!0,{description:h("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}},mT=class extends It{constructor(){let e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),h("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),h("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:h("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),h("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),h("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Ve},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{cursorMoveOnType:_e(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":Kt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":Kt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:_e(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:_e(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:_e(t.loop,this.defaultValue.loop)}}},lc=class o extends It{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",o.OFF,{anyOf:[{type:"boolean",description:h("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?o.OFF:e==="true"?o.ON:e:e?o.ON:o.OFF}},qu=class o extends It{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",o.OFF,{anyOf:[{type:"boolean",description:h("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?o.OFF:e==="true"?o.TRANSLATE:e:e?o.TRANSLATE:o.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},gT=class extends ac{constructor(){super(51)}compute(e,t,n){return e.fontInfo}},fT=class extends $l{constructor(){super(53,"fontSize",no.fontSize,{type:"number",minimum:6,maximum:100,default:no.fontSize,description:h("fontSize","Controls the font size in pixels.")})}validate(e){let t=br.float(e,this.defaultValue);return t===0?no.fontSize:br.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},bT=class o extends It{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",no.fontWeight,{anyOf:[{type:"number",minimum:o.MINIMUM_VALUE,maximum:o.MAXIMUM_VALUE,errorMessage:h("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:o.SUGGESTION_VALUES}],default:no.fontWeight,description:h("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(gt.clampedInt(e,no.fontWeight,o.MINIMUM_VALUE,o.MAXIMUM_VALUE))}},vT=class extends It{constructor(){let e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),h("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),h("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:h("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:h("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:h("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:h("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:h("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:h("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:h("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:h("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:h("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{multiple:Kt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??Kt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??Kt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??Kt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??Kt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??Kt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??Kt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:fi.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:fi.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:fi.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:fi.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:fi.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:fi.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},yT=class extends It{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),delay:gt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:_e(t.sticky,this.defaultValue.sticky),hidingDelay:gt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:_e(t.above,this.defaultValue.above)}}};var Cg=class o extends ac{constructor(){super(147)}compute(e,t,n){return o.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),i=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(i=Math.max(i,t-1));let r=(n+e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:i,desiredRatio:r,minimapLineCount:s}}static _computeMinimapLayout(e,t){let n=e.outerWidth,i=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let s=t.stableMinimapLayoutInput,a=s&&e.outerHeight===s.outerHeight&&e.lineHeight===s.lineHeight&&e.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&e.pixelRatio===s.pixelRatio&&e.scrollBeyondLastLine===s.scrollBeyondLastLine&&e.paddingTop===s.paddingTop&&e.paddingBottom===s.paddingBottom&&e.minimap.enabled===s.minimap.enabled&&e.minimap.side===s.minimap.side&&e.minimap.size===s.minimap.size&&e.minimap.showSlider===s.minimap.showSlider&&e.minimap.renderCharacters===s.minimap.renderCharacters&&e.minimap.maxColumn===s.minimap.maxColumn&&e.minimap.scale===s.minimap.scale&&e.verticalScrollbarWidth===s.verticalScrollbarWidth&&e.isViewportWrapping===s.isViewportWrapping,l=e.lineHeight,d=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters,p=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale,m=e.minimap.maxColumn,f=e.minimap.size,g=e.minimap.side,b=e.verticalScrollbarWidth,v=e.viewLineCount,I=e.remainingWidth,C=e.isViewportWrapping,S=u?2:3,_=Math.floor(r*i),R=_/r,N=!1,F=!1,P=S*p,H=p/r,U=1;if(f==="fill"||f==="fit"){let{typicalViewportLineCount:te,extraLinesBeforeFirstLine:Z,extraLinesBeyondLastLine:ye,desiredRatio:Se,minimapLineCount:st}=o.computeContainedMinimapLineCount({viewLineCount:v,scrollBeyondLastLine:c,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:i,lineHeight:l,pixelRatio:r});if(v/st>1)N=!0,F=!0,p=1,P=1,H=p/r;else{let ke=!1,$n=p+1;if(f==="fit"){let wn=Math.ceil((Z+v+ye)*P);C&&a&&I<=t.stableFitRemainingWidth?(ke=!0,$n=t.stableFitMaxMinimapScale):ke=wn>_}if(f==="fill"||ke){N=!0;let wn=p;P=Math.min(l*r,Math.max(1,Math.floor(1/Se))),C&&a&&I<=t.stableFitRemainingWidth&&($n=t.stableFitMaxMinimapScale),p=Math.min($n,Math.max(1,Math.floor(P/S))),p>wn&&(U=Math.min(2,p/wn)),H=p/r/U,_=Math.ceil(Math.max(te,Z+v+ye)*P),C?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=I,t.stableFitMaxMinimapScale=p):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}let z=Math.floor(m*H),oe=Math.min(z,Math.max(0,Math.floor((I-b-2)*H/(d+H)))+Kr),fe=Math.floor(r*oe),ee=fe/r;fe=Math.floor(fe*U);let X=u?1:2,se=g==="left"?0:n-oe-b;return{renderMinimap:X,minimapLeft:se,minimapWidth:oe,minimapHeightIsEditorHeight:N,minimapIsSampling:F,minimapScale:p,minimapLineHeight:P,minimapCanvasInnerWidth:fe,minimapCanvasInnerHeight:_,minimapCanvasOuterWidth:ee,minimapCanvasOuterHeight:R}}static computeLayout(e,t){let n=t.outerWidth|0,i=t.outerHeight|0,r=t.lineHeight|0,s=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,d=t.pixelRatio,c=t.viewLineCount,u=e.get(139),p=u==="inherit"?e.get(138):u,m=p==="inherit"?e.get(134):p,f=e.get(137),g=t.isDominatedByLongLines,b=e.get(58),v=e.get(69).renderType!==0,I=e.get(70),C=e.get(107),S=e.get(85),_=e.get(74),R=e.get(105),N=R.verticalScrollbarSize,F=R.verticalHasArrows,P=R.arrowSize,H=R.horizontalScrollbarSize,U=e.get(44),z=e.get(112)!=="never",oe=e.get(67);U&&z&&(oe+=16);let fe=0;if(v){let go=Math.max(s,I);fe=Math.round(go*l)}let ee=0;b&&(ee=r*t.glyphMarginDecorationLaneCount);let X=0,se=X+ee,te=se+fe,Z=te+oe,ye=n-ee-fe-oe,Se=!1,st=!1,Ze=-1;p==="inherit"&&g?(Se=!0,st=!0):m==="on"||m==="bounded"?st=!0:m==="wordWrapColumn"&&(Ze=f);let ke=o._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:C,paddingTop:S.top,paddingBottom:S.bottom,minimap:_,verticalScrollbarWidth:N,viewLineCount:c,remainingWidth:ye,isViewportWrapping:st},t.memory||new Ig);ke.renderMinimap!==0&&ke.minimapLeft===0&&(X+=ke.minimapWidth,se+=ke.minimapWidth,te+=ke.minimapWidth,Z+=ke.minimapWidth);let $n=ye-ke.minimapWidth,wn=Math.max(1,Math.floor(($n-N-2)/a)),$i=F?P:0;return st&&(Ze=Math.max(1,wn),m==="bounded"&&(Ze=Math.min(Ze,f))),{width:n,height:i,glyphMarginLeft:X,glyphMarginWidth:ee,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:se,lineNumbersWidth:fe,decorationsLeft:te,decorationsWidth:oe,contentLeft:Z,contentWidth:$n,minimap:ke,viewportColumn:wn,isWordWrapMinified:Se,isViewportWrapping:st,wrappingColumn:Ze,verticalScrollbarWidth:N,horizontalScrollbarHeight:H,overviewRuler:{top:$i,width:N,height:i-2*$i,right:0}}}},IT=class extends It{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return Kt(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(2)===2?"advanced":n}};var CT=class extends It{constructor(){let e={enabled:"onCode"};super(66,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:e.enabled,enumDescriptions:[h("editor.lightbulb.enabled.off","Disable the code action menu."),h("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),h("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Kt(e.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},ST=class extends It{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),maxLineCount:gt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Kt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:_e(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},xT=class extends It{constructor(){let e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h("editor.inlayHints.on","Inlay hints are enabled"),h("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Ve?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Ve?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:h("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:Kt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:gt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:fi.string(t.fontFamily,this.defaultValue.fontFamily),padding:_e(t.padding,this.defaultValue.padding),maximumLength:gt.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},_T=class extends It{constructor(){super(67,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):gt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?gt.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},ET=class extends br{constructor(){super(68,"lineHeight",no.lineHeight,e=>br.clamp(e,0,150),{markdownDescription:h("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}},wT=class extends It{constructor(){let e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),h("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),autohide:_e(t.autohide,this.defaultValue.autohide),size:Kt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Kt(t.side,this.defaultValue.side,["right","left"]),showSlider:Kt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:_e(t.renderCharacters,this.defaultValue.renderCharacters),scale:gt.clampedInt(t.scale,1,1,3),maxColumn:gt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:_e(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:_e(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:br.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:br.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function O4(o){return o==="ctrlCmd"?Ve?"metaKey":"ctrlKey":"altKey"}var TT=class extends It{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{top:gt.clampedInt(t.top,0,0,1e3),bottom:gt.clampedInt(t.bottom,0,0,1e3)}}},LT=class extends It{constructor(){let e={enabled:!0,cycle:!0};super(87,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),cycle:_e(t.cycle,this.defaultValue.cycle)}}},DT=class extends ac{constructor(){super(145)}compute(e,t,n){return e.pixelRatio}},kT=class extends It{constructor(){super(89,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},RT=class extends It{defaultValue;constructor(){let e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h("on","Quick suggestions show inside the suggest widget"),h("inline","Quick suggestions show as ghost text"),h("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:h("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:h("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:h("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){let d=e?"on":"off";return{comments:d,strings:d,other:d}}if(!e||typeof e!="object")return this.defaultValue;let{other:t,comments:n,strings:i}=e,r=["on","inline","off"],s,a,l;return typeof t=="boolean"?s=t?"on":"off":s=Kt(t,this.defaultValue.other,r),typeof n=="boolean"?a=n?"on":"off":a=Kt(n,this.defaultValue.comments,r),typeof i=="boolean"?l=i?"on":"off":l=Kt(i,this.defaultValue.strings,r),{other:s,comments:a,strings:l}}};var MT=class extends It{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h("lineNumbers.off","Line numbers are not rendered."),h("lineNumbers.on","Line numbers are rendered as absolute number."),h("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),h("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:h("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,n=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:n}}};function dc(o){let e=o.get(100);return e==="editable"?o.get(93):e!=="on"}var PT=class extends It{constructor(){let e=[],t={type:"number",description:h("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:h("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="number")t.push({column:gt.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){let i=n;t.push({column:gt.clampedInt(i.column,0,0,1e4),color:i.color})}return t.sort((n,i)=>n.column-i.column),t}return this.defaultValue}},NT=class extends It{constructor(){super(94,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function cN(o,e){if(typeof o!="string")return e;switch(o){case"hidden":return 2;case"visible":return 3;default:return 1}}var OT=class extends It{constructor(){let e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),h("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),h("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),h("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),h("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e,n=gt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=gt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:gt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:cN(t.vertical,this.defaultValue.vertical),horizontal:cN(t.horizontal,this.defaultValue.horizontal),useShadows:_e(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:_e(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:_e(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:_e(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:_e(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:gt.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:gt.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:_e(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:_e(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},zr="inUntrustedWorkspace",sc={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},AT=class extends It{constructor(){let e={nonBasicASCII:zr,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:zr,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",e,{[sc.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,zr],default:e.nonBasicASCII,description:h("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[sc.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:h("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[sc.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:h("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[sc.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,zr],default:e.includeComments,description:h("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[sc.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,zr],default:e.includeStrings,description:h("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[sc.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:h("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[sc.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(cn(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(cn(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let i=super.applyUpdate(e,t);return n?new $u(i.newValue,!0):i}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{nonBasicASCII:ju(t.nonBasicASCII,zr,[!0,!1,zr]),invisibleCharacters:_e(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:_e(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:ju(t.includeComments,zr,[!0,!1,zr]),includeStrings:ju(t.includeStrings,zr,[!0,!1,zr]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;let n={};for(let[i,r]of Object.entries(e))r===!0&&(n[i]=!0);return n}},FT=class extends It{constructor(){let e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),h("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),h("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:h("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:h("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),mode:Kt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Kt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:_e(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:_e(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:fi.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:_e(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},BT=class extends It{constructor(){let e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:h("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),h("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),h("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:h("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:h("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),showToolbar:Kt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:fi.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:_e(t.keepOnBlur,this.defaultValue.keepOnBlur)}}},WT=class extends It{constructor(){let e={enabled:Ws.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Ws.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:_e(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},VT=class extends It{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairs.true","Enables bracket pair guides."),h("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),h("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:h("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),h("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),h("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),h("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),h("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{bracketPairs:ju(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:ju(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:_e(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:_e(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:ju(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function ju(o,e,t){let n=t.indexOf(o);return n===-1?e:t[n]}var HT=class extends It{constructor(){let e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),h("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),h("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{insertMode:Kt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:_e(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:_e(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:_e(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:_e(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Kt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:_e(t.showIcons,this.defaultValue.showIcons),showStatusBar:_e(t.showStatusBar,this.defaultValue.showStatusBar),preview:_e(t.preview,this.defaultValue.preview),previewMode:Kt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:_e(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:_e(t.showMethods,this.defaultValue.showMethods),showFunctions:_e(t.showFunctions,this.defaultValue.showFunctions),showConstructors:_e(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:_e(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:_e(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:_e(t.showFields,this.defaultValue.showFields),showVariables:_e(t.showVariables,this.defaultValue.showVariables),showClasses:_e(t.showClasses,this.defaultValue.showClasses),showStructs:_e(t.showStructs,this.defaultValue.showStructs),showInterfaces:_e(t.showInterfaces,this.defaultValue.showInterfaces),showModules:_e(t.showModules,this.defaultValue.showModules),showProperties:_e(t.showProperties,this.defaultValue.showProperties),showEvents:_e(t.showEvents,this.defaultValue.showEvents),showOperators:_e(t.showOperators,this.defaultValue.showOperators),showUnits:_e(t.showUnits,this.defaultValue.showUnits),showValues:_e(t.showValues,this.defaultValue.showValues),showConstants:_e(t.showConstants,this.defaultValue.showConstants),showEnums:_e(t.showEnums,this.defaultValue.showEnums),showEnumMembers:_e(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:_e(t.showKeywords,this.defaultValue.showKeywords),showWords:_e(t.showWords,this.defaultValue.showWords),showColors:_e(t.showColors,this.defaultValue.showColors),showFiles:_e(t.showFiles,this.defaultValue.showFiles),showReferences:_e(t.showReferences,this.defaultValue.showReferences),showFolders:_e(t.showFolders,this.defaultValue.showFolders),showTypeParameters:_e(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:_e(t.showSnippets,this.defaultValue.showSnippets),showUsers:_e(t.showUsers,this.defaultValue.showUsers),showIssues:_e(t.showIssues,this.defaultValue.showIssues)}}},UT=class extends It{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:_e(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:_e(e.selectSubwords,this.defaultValue.selectSubwords)}}},zT=class extends It{constructor(){let e=[];super(132,"wordSegmenterLocales",e,{anyOf:[{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}};var KT=class extends It{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),h("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),h("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),h("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:h("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,n){return t.get(2)===2?0:n}},GT=class extends ac{constructor(){super(148)}compute(e,t,n){let i=t.get(147);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}},$T=class extends It{constructor(){let e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),h("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),showDropSelector:Kt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},jT=class extends It{constructor(){let e={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),h("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;let t=e;return{enabled:_e(t.enabled,this.defaultValue.enabled),showPasteSelector:Kt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},A4="Consolas, 'Courier New', monospace",F4="Menlo, Monaco, 'Courier New', monospace",B4="'Droid Sans Mono', 'monospace', monospace",no={fontFamily:Ve?F4:Ut?B4:A4,fontWeight:"normal",fontSize:Ve?12:14,lineHeight:0,letterSpacing:0},Yu=[];function $(o){return Yu[o.id]=o,o}var Hs={acceptSuggestionOnCommitCharacter:$(new Ye(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:$(new Mt(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:$(new cT),accessibilityPageSize:$(new gt(3,"accessibilityPageSize",10,1,1073741824,{description:h("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:$(new fi(4,"ariaLabel",h("editorViewAccessibleLabel","Editor content"))),ariaRequired:$(new Ye(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:$(new Ye(8,"screenReaderAnnounceInlineSuggestion",!0,{description:h("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:$(new Mt(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),h("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:$(new Mt(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),h("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:h("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:$(new Mt(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:$(new Mt(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:$(new Mt(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),h("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:$(new Gu(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],M4,{enumDescriptions:[h("editor.autoIndent.none","The editor will not insert indentation automatically."),h("editor.autoIndent.keep","The editor will keep the current line's indentation."),h("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),h("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:$(new Ye(13,"automaticLayout",!1)),autoSurround:$(new Mt(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),h("editor.autoSurround.quotes","Surround with quotes but not brackets."),h("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:h("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:$(new WT),bracketPairGuides:$(new VT),stickyTabStops:$(new Ye(118,"stickyTabStops",!1,{description:h("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:$(new Ye(17,"codeLens",!0,{description:h("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:$(new fi(18,"codeLensFontFamily","",{description:h("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:$(new gt(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:$(new Ye(20,"colorDecorators",!0,{description:h("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:$(new Mt(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),h("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),h("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:h("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:$(new gt(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:$(new Ye(22,"columnSelection",!1,{description:h("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:$(new uT),contextmenu:$(new Ye(24,"contextmenu",!0)),copyWithSyntaxHighlighting:$(new Ye(25,"copyWithSyntaxHighlighting",!0,{description:h("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:$(new Gu(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],P4,{description:h("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:$(new Mt(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),h("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:h("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:$(new Gu(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],N4,{description:h("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:$(new gt(29,"cursorSurroundingLines",0,0,1073741824,{description:h("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:$(new Mt(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:h("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:$(new gt(31,"cursorWidth",0,0,1073741824,{markdownDescription:h("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:$(new Ye(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:$(new Ye(33,"disableMonospaceOptimizations",!1)),domReadOnly:$(new Ye(34,"domReadOnly",!1)),dragAndDrop:$(new Ye(35,"dragAndDrop",!0,{description:h("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:$(new hT),dropIntoEditor:$(new $T),experimentalEditContextEnabled:$(new Ye(37,"experimentalEditContextEnabled",!1,{description:h("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:$(new ST),experimentalWhitespaceRendering:$(new Mt(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),h("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),h("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:h("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:$(new fi(40,"extraEditorClassName","")),fastScrollSensitivity:$(new br(41,"fastScrollSensitivity",5,o=>o<=0?5:o,{markdownDescription:h("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:$(new mT),fixedOverflowWidgets:$(new Ye(43,"fixedOverflowWidgets",!1)),folding:$(new Ye(44,"folding",!0,{description:h("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:$(new Mt(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),h("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:h("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:$(new Ye(46,"foldingHighlight",!0,{description:h("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:$(new Ye(47,"foldingImportsByDefault",!1,{description:h("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:$(new gt(48,"foldingMaximumRegions",5e3,10,65e3,{description:h("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:$(new Ye(49,"unfoldOnClickAfterEndOfLine",!1,{description:h("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:$(new fi(50,"fontFamily",no.fontFamily,{description:h("fontFamily","Controls the font family.")})),fontInfo:$(new gT),fontLigatures2:$(new lc),fontSize:$(new fT),fontWeight:$(new bT),fontVariations:$(new qu),formatOnPaste:$(new Ye(56,"formatOnPaste",!1,{description:h("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:$(new Ye(57,"formatOnType",!1,{description:h("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:$(new Ye(58,"glyphMargin",!0,{description:h("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:$(new vT),hideCursorInOverviewRuler:$(new Ye(60,"hideCursorInOverviewRuler",!1,{description:h("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:$(new yT),inDiffEditor:$(new Ye(62,"inDiffEditor",!1)),letterSpacing:$(new br(65,"letterSpacing",no.letterSpacing,o=>br.clamp(o,-5,20),{description:h("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:$(new CT),lineDecorationsWidth:$(new _T),lineHeight:$(new ET),lineNumbers:$(new MT),lineNumbersMinChars:$(new gt(70,"lineNumbersMinChars",5,1,300)),linkedEditing:$(new Ye(71,"linkedEditing",!1,{description:h("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:$(new Ye(72,"links",!0,{description:h("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:$(new Mt(73,"matchBrackets","always",["always","near","never"],{description:h("matchBrackets","Highlight matching brackets.")})),minimap:$(new wT),mouseStyle:$(new Mt(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:$(new br(76,"mouseWheelScrollSensitivity",1,o=>o===0?1:o,{markdownDescription:h("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:$(new Ye(77,"mouseWheelZoom",!1,{markdownDescription:Ve?h("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:$(new Ye(78,"multiCursorMergeOverlapping",!0,{description:h("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:$(new Gu(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],O4,{markdownEnumDescriptions:[h("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),h("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:$(new Mt(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h("multiCursorPaste.spread","Each cursor pastes a single line of the text."),h("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:h("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:$(new gt(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:$(new Mt(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h("occurrencesHighlight.off","Does not highlight occurrences."),h("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),h("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:$(new Ye(83,"overviewRulerBorder",!0,{description:h("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:$(new gt(84,"overviewRulerLanes",3,0,3)),padding:$(new TT),pasteAs:$(new jT),parameterHints:$(new LT),peekWidgetDefaultFocus:$(new Mt(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),h("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:h("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:$(new kT),definitionLinkOpensInPeek:$(new Ye(90,"definitionLinkOpensInPeek",!1,{description:h("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:$(new RT),quickSuggestionsDelay:$(new gt(92,"quickSuggestionsDelay",10,0,1073741824,{description:h("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:$(new Ye(93,"readOnly",!1)),readOnlyMessage:$(new NT),renameOnType:$(new Ye(95,"renameOnType",!1,{description:h("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:h("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:$(new Ye(96,"renderControlCharacters",!0,{description:h("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:$(new Mt(97,"renderFinalNewline",Ut?"dimmed":"on",["off","on","dimmed"],{description:h("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:$(new Mt(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:h("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:$(new Ye(99,"renderLineHighlightOnlyWhenFocus",!1,{description:h("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:$(new Mt(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:$(new Mt(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),h("renderWhitespace.selection","Render whitespace characters only on selected text."),h("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:h("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:$(new gt(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:$(new Ye(103,"roundedSelection",!0,{description:h("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:$(new PT),scrollbar:$(new OT),scrollBeyondLastColumn:$(new gt(106,"scrollBeyondLastColumn",4,0,1073741824,{description:h("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:$(new Ye(107,"scrollBeyondLastLine",!0,{description:h("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:$(new Ye(108,"scrollPredominantAxis",!0,{description:h("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:$(new Ye(109,"selectionClipboard",!0,{description:h("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Ut})),selectionHighlight:$(new Ye(110,"selectionHighlight",!0,{description:h("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:$(new Ye(111,"selectOnLineNumbers",!0)),showFoldingControls:$(new Mt(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h("showFoldingControls.always","Always show the folding controls."),h("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),h("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:h("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:$(new Ye(113,"showUnused",!0,{description:h("showUnused","Controls fading out of unused code.")})),showDeprecated:$(new Ye(142,"showDeprecated",!0,{description:h("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:$(new xT),snippetSuggestions:$(new Mt(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),h("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),h("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),h("snippetSuggestions.none","Do not show snippet suggestions.")],description:h("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:$(new UT),smoothScrolling:$(new Ye(116,"smoothScrolling",!1,{description:h("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:$(new gt(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:$(new HT),inlineSuggest:$(new FT),inlineEdit:$(new BT),inlineCompletionsAccessibilityVerbose:$(new Ye(151,"inlineCompletionsAccessibilityVerbose",!1,{description:h("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:$(new gt(121,"suggestFontSize",0,0,1e3,{markdownDescription:h("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:$(new gt(122,"suggestLineHeight",0,0,1e3,{markdownDescription:h("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:$(new Ye(123,"suggestOnTriggerCharacters",!0,{description:h("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:$(new Mt(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h("suggestSelection.first","Always select the first suggestion."),h("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:$(new Mt(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),h("tabCompletion.off","Disable tab completions."),h("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h("tabCompletion","Enables tab completions.")})),tabIndex:$(new gt(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:$(new AT),unusualLineTerminators:$(new Mt(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),h("unusualLineTerminators.off","Unusual line terminators are ignored."),h("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:h("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:$(new Ye(129,"useShadowDOM",!0)),useTabStops:$(new Ye(130,"useTabStops",!0,{description:h("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:$(new Mt(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h("wordBreak.normal","Use the default line break rule."),h("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:$(new zT),wordSeparators:$(new fi(133,"wordSeparators",Jw,{description:h("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:$(new Mt(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h("wordWrap.off","Lines will never wrap."),h("wordWrap.on","Lines will wrap at the viewport width."),h({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),h({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:$(new fi(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:$(new fi(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:$(new gt(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:h({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:$(new Mt(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:$(new Mt(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:$(new pT),defaultColorDecorators:$(new Ye(149,"defaultColorDecorators",!1,{markdownDescription:h("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:$(new DT),tabFocusMode:$(new Ye(146,"tabFocusMode",!1,{markdownDescription:h("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:$(new Cg),wrappingInfo:$(new GT),wrappingIndent:$(new KT),wrappingStrategy:$(new IT)};var Us=new class{_zoomLevel=0;_onDidChangeZoomLevel=new L;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(o){o=Math.min(Math.max(-5,o),20),this._zoomLevel!==o&&(this._zoomLevel=o,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var W4=Ve?1.5:1.35,qT=8,Sg=class o{_bareFontInfoBrand=void 0;static createFromValidatedSettings(e,t,n){let i=e.get(50),r=e.get(54),s=e.get(53),a=e.get(52),l=e.get(55),d=e.get(68),c=e.get(65);return o._create(i,r,s,a,l,d,c,t,n)}static createFromRawSettings(e,t,n=!1){let i=Hs.fontFamily.validate(e.fontFamily),r=Hs.fontWeight.validate(e.fontWeight),s=Hs.fontSize.validate(e.fontSize),a=Hs.fontLigatures2.validate(e.fontLigatures),l=Hs.fontVariations.validate(e.fontVariations),d=Hs.lineHeight.validate(e.lineHeight),c=Hs.letterSpacing.validate(e.letterSpacing);return o._create(i,r,s,a,l,d,c,t,n)}static _create(e,t,n,i,r,s,a,l,d){s===0?s=W4*n:s<qT&&(s=s*n),s=Math.round(s),s<qT&&(s=qT);let c=1+(d?0:Us.getZoomLevel()*.1);return n*=c,s*=c,r===qu.TRANSLATE&&(t==="normal"||t==="bold"?r=qu.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new o({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:n,fontFeatureSettings:i,fontVariationSettings:r,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(e){this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let e=no.fontFamily,t=o._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}},YT=2,Xu=class extends Sg{_editorStylingBrand=void 0;version=YT;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}};function Jt(o,e){o instanceof Yd?(o.setFontFamily(e.getMassagedFontFamily()),o.setFontWeight(e.fontWeight),o.setFontSize(e.fontSize),o.setFontFeatureSettings(e.fontFeatureSettings),o.setFontVariationSettings(e.fontVariationSettings),o.setLineHeight(e.lineHeight),o.setLetterSpacing(e.letterSpacing)):(o.style.fontFamily=e.getMassagedFontFamily(),o.style.fontWeight=e.fontWeight,o.style.fontSize=e.fontSize+"px",o.style.fontFeatureSettings=e.fontFeatureSettings,o.style.fontVariationSettings=e.fontVariationSettings,o.style.lineHeight=e.lineHeight+"px",o.style.letterSpacing=e.letterSpacing+"px")}var _y=class{chr;type;width;constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}},XT=class o{_bareFontInfo;_requests;_container;_testElements;constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";let t=document.createElement("div");Jt(t,this._bareFontInfo),e.appendChild(t);let n=document.createElement("div");Jt(n,this._bareFontInfo),n.style.fontWeight="bold",e.appendChild(n);let i=document.createElement("div");Jt(i,this._bareFontInfo),i.style.fontStyle="italic",e.appendChild(i);let r=[];for(let s of this._requests){let a;s.type===0&&(a=t),s.type===2&&(a=n),s.type===1&&(a=i),a.appendChild(document.createElement("br"));let l=document.createElement("span");o._render(l,s),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let n="\xA0";for(let i=0;i<8;i++)n+=n;e.innerText=n}else{let n=t.chr;for(let i=0;i<8;i++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){let n=this._requests[e],i=this._testElements[e];n.fulfill(i.offsetWidth/256)}}};function uN(o,e,t){new XT(e,t).read(o)}var ZT=class extends V{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){let t=Pu(e),n=this._cache.get(t);return n||(n=new QT,this._cache.set(t,n)),n}_writeToCache(e,t,n){this._ensureCache(e).put(t,n),!n.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){let t=this._ensureCache(e),n=t.getValues(),i=!1;for(let r of n)r.isTrusted||(i=!0,t.remove(r));i&&this._onDidChange.fire()}serializeFontInfo(e){return this._ensureCache(e).getValues().filter(n=>n.isTrusted)}restoreFontInfo(e,t){for(let n of t){if(n.version!==YT)continue;let i=new Xu(n,!1);this._writeToCache(e,i,i)}}readFontInfo(e,t){let n=this._ensureCache(e);if(!n.has(t)){let i=this._actualReadFontInfo(e,t);(i.typicalHalfwidthCharacterWidth<=2||i.typicalFullwidthCharacterWidth<=2||i.spaceWidth<=2||i.maxDigitWidth<=2)&&(i=new Xu({pixelRatio:Vu.getInstance(e).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:i.isMonospace,typicalHalfwidthCharacterWidth:Math.max(i.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(i.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:i.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(i.spaceWidth,5),middotWidth:Math.max(i.middotWidth,5),wsmiddotWidth:Math.max(i.wsmiddotWidth,5),maxDigitWidth:Math.max(i.maxDigitWidth,5)},!1)),this._writeToCache(e,t,i)}return n.get(t)}_createRequest(e,t,n,i){let r=new _y(e,t);return n.push(r),i?.push(r),r}_actualReadFontInfo(e,t){let n=[],i=[],r=this._createRequest("n",0,n,i),s=this._createRequest("\uFF4D",0,n,null),a=this._createRequest(" ",0,n,i),l=this._createRequest("0",0,n,i),d=this._createRequest("1",0,n,i),c=this._createRequest("2",0,n,i),u=this._createRequest("3",0,n,i),p=this._createRequest("4",0,n,i),m=this._createRequest("5",0,n,i),f=this._createRequest("6",0,n,i),g=this._createRequest("7",0,n,i),b=this._createRequest("8",0,n,i),v=this._createRequest("9",0,n,i),I=this._createRequest("\u2192",0,n,i),C=this._createRequest("\uFFEB",0,n,null),S=this._createRequest("\xB7",0,n,i),_=this._createRequest("\u2E31",0,n,null),R="|/-_ilm%";for(let U=0,z=R.length;U<z;U++)this._createRequest(R.charAt(U),0,n,i),this._createRequest(R.charAt(U),1,n,i),this._createRequest(R.charAt(U),2,n,i);uN(e,t,n);let N=Math.max(l.width,d.width,c.width,u.width,p.width,m.width,f.width,g.width,b.width,v.width),F=t.fontFeatureSettings===lc.OFF,P=i[0].width;for(let U=1,z=i.length;F&&U<z;U++){let oe=P-i[U].width;if(oe<-.001||oe>.001){F=!1;break}}let H=!0;return F&&C.width!==P&&(H=!1),C.width>I.width&&(H=!1),new Xu({pixelRatio:Vu.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:F,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:H,spaceWidth:a.width,middotWidth:S.width,wsmiddotWidth:_.width,maxDigitWidth:N},!0)}},QT=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId();return!!this._values[t]}get(e){let t=e.getId();return this._values[t]}put(e,t){let n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){let t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}},JT=new ZT;var xg=class o{constructor(e,t){this.key=e;this.migrate=t}static items=[];apply(e){let t=o._read(e,this.key),n=r=>o._read(e,r),i=(r,s)=>o._write(e,r,s);this.migrate(t,n,i)}static _read(e,t){if(typeof e>"u")return;let n=t.indexOf(".");if(n>=0){let i=t.substring(0,n);return this._read(e[i],t.substring(n+1))}return e[t]}static _write(e,t,n){let i=t.indexOf(".");if(i>=0){let r=t.substring(0,i);e[r]=e[r]||{},this._write(e[r],t.substring(i+1),n);return}e[t]=n}};function Gr(o,e){xg.items.push(new xg(o,e))}function io(o,e){Gr(o,(t,n,i)=>{if(typeof t<"u"){for(let[r,s]of e)if(t===r){i(o,s);return}}})}function pN(o){xg.items.forEach(e=>e.apply(o))}io("wordWrap",[[!0,"on"],[!1,"off"]]);io("lineNumbers",[[!0,"on"],[!1,"off"]]);io("cursorBlinking",[["visible","solid"]]);io("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);io("renderLineHighlight",[[!0,"line"],[!1,"none"]]);io("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);io("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);io("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);io("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);io("autoIndent",[[!1,"advanced"],[!0,"full"]]);io("matchBrackets",[[!0,"always"],[!1,"never"]]);io("renderFinalNewline",[[!0,"on"],[!1,"off"]]);io("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);io("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);io("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);Gr("autoClosingBrackets",(o,e,t)=>{o===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});Gr("renderIndentGuides",(o,e,t)=>{typeof o<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!o))});Gr("highlightActiveIndentGuide",(o,e,t)=>{typeof o<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!o))});var V4={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Gr("suggest.filteredTypes",(o,e,t)=>{if(o&&typeof o=="object"){for(let n of Object.entries(V4))o[n[0]]===!1&&typeof e(`suggest.${n[1]}`)>"u"&&t(`suggest.${n[1]}`,!1);t("suggest.filteredTypes",void 0)}});Gr("quickSuggestions",(o,e,t)=>{if(typeof o=="boolean"){let n=o?"on":"off";t("quickSuggestions",{comments:n,strings:n,other:n})}});Gr("experimental.stickyScroll.enabled",(o,e,t)=>{typeof o=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",o))});Gr("experimental.stickyScroll.maxLineCount",(o,e,t)=>{typeof o=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",o))});Gr("codeActionsOnSave",(o,e,t)=>{if(o&&typeof o=="object"){let n=!1,i={};for(let r of Object.entries(o))typeof r[1]=="boolean"?(n=!0,i[r[0]]=r[1]?"explicit":"never"):i[r[0]]=r[1];n&&t("codeActionsOnSave",i)}});Gr("codeActionWidget.includeNearbyQuickfixes",(o,e,t)=>{typeof o=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",o))});Gr("lightbulb.enabled",(o,e,t)=>{typeof o=="boolean"&&t("lightbulb.enabled",o?void 0:"off")});var eL=class{_tabFocus=!1;_onDidChangeTabFocus=new L;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}},Zu=new eL;var jl=class extends V{_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(e,t="",n="",i=!0,r){super(),this._id=e,this._label=t,this._cssClass=n,this._enabled=i,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}},$r=class extends V{_onWillRun=this._register(new L);onWillRun=this._onWillRun.event;_onDidRun=this._register(new L);onDidRun=this._onDidRun.event;async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let n;try{await this.runAction(e,t)}catch(i){n=i}this._onDidRun.fire({action:e,error:n})}async runAction(e,t){await e.run(t)}},jr=class o{static join(...e){let t=[];for(let n of e)n.length&&(t.length?t=[...t,new o,...n]:t=n);return t}static ID="vs.actions.separator";id=o.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}};function Va(o){return{id:o.id,label:o.label,tooltip:o.tooltip??o.label,class:o.class,enabled:o.enabled??!0,checked:o.checked,run:async(...e)=>o.run(...e)}}var hZ=Object.freeze({View:cr("view","View"),Help:cr("help","Help"),Test:cr("test","Test"),File:cr("file","File"),Preferences:cr("preferences","Preferences"),Developer:cr({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});var qr=j("commandService"),Eo=new class{_commands=new Map;_onDidRegisterCommand=new L;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(o,e){if(!o)throw new Error("invalid command");if(typeof o=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:o,handler:e})}if(o.metadata&&Array.isArray(o.metadata.args)){let s=[];for(let l of o.metadata.args)s.push(l.constraint);let a=o.handler;o.handler=function(l,...d){return FM(d,s),a(l,...d)}}let{id:t}=o,n=this._commands.get(t);n||(n=new An,this._commands.set(t,n));let i=n.unshift(o),r=Ce(()=>{i(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(o,e){return Eo.registerCommand(o,(t,...n)=>t.get(qr).executeCommand(e,...n))}getCommand(o){let e=this._commands.get(o);if(!(!e||e.isEmpty()))return Ts.first(e)}getCommands(){let o=new Map;for(let e of this._commands.keys()){let t=this.getCommand(e);t&&o.set(e,t)}return o}};Eo.registerCommand("noop",()=>{});function hN(o){return o?o.condition!==void 0:!1}var tL=class o{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new An,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(fo===1){if(e&&e.win)return e.win}else if(fo===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){let t=o.bindToCurrentPlatform(e),n=new ae;if(t&&t.primary){let i=rw(t.primary,fo);i&&n.add(this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let i=0,r=t.secondary.length;i<r;i++){let s=t.secondary[i],a=rw(s,fo);a&&n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-i-1,e.when))}return n}setExtensionKeybindings(e){let t=[],n=0;for(let i of e)i.keybinding&&(t[n++]={keybinding:i.keybinding,command:i.id,commandArgs:i.args,when:i.when,weight1:i.weight,weight2:0,extensionId:i.extensionId||null,isBuiltinExtension:i.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return Ls(this.registerKeybindingRule(e),Eo.registerCommand(e))}_registerDefaultKeybinding(e,t,n,i,r,s){let a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:s,weight1:i,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,Ce(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(U4)),this._cachedMergedKeybindings.slice(0)}},Ha=new tL,H4={EditorModes:"platform.keybindingsRegistry"};et.add(H4.EditorModes,Ha);function U4(o,e){if(o.weight1!==e.weight1)return o.weight1-e.weight1;if(o.command&&e.command){if(o.command<e.command)return-1;if(o.command>e.command)return 1}return o.weight2-e.weight2}function nL(o){return o.command!==void 0}var Fn=class o{static _instances=new Map;static CommandPalette=new o("CommandPalette");static DebugBreakpointsContext=new o("DebugBreakpointsContext");static DebugCallStackContext=new o("DebugCallStackContext");static DebugConsoleContext=new o("DebugConsoleContext");static DebugVariablesContext=new o("DebugVariablesContext");static NotebookVariablesContext=new o("NotebookVariablesContext");static DebugHoverContext=new o("DebugHoverContext");static DebugWatchContext=new o("DebugWatchContext");static DebugToolBar=new o("DebugToolBar");static DebugToolBarStop=new o("DebugToolBarStop");static DebugCallStackToolbar=new o("DebugCallStackToolbar");static DebugCreateConfiguration=new o("DebugCreateConfiguration");static EditorContext=new o("EditorContext");static SimpleEditorContext=new o("SimpleEditorContext");static EditorContent=new o("EditorContent");static EditorLineNumberContext=new o("EditorLineNumberContext");static EditorContextCopy=new o("EditorContextCopy");static EditorContextPeek=new o("EditorContextPeek");static EditorContextShare=new o("EditorContextShare");static EditorTitle=new o("EditorTitle");static EditorTitleRun=new o("EditorTitleRun");static EditorTitleContext=new o("EditorTitleContext");static EditorTitleContextShare=new o("EditorTitleContextShare");static EmptyEditorGroup=new o("EmptyEditorGroup");static EmptyEditorGroupContext=new o("EmptyEditorGroupContext");static EditorTabsBarContext=new o("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new o("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new o("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new o("EditorActionsPositionSubmenu");static ExplorerContext=new o("ExplorerContext");static ExplorerContextShare=new o("ExplorerContextShare");static ExtensionContext=new o("ExtensionContext");static ExtensionEditorContextMenu=new o("ExtensionEditorContextMenu");static GlobalActivity=new o("GlobalActivity");static CommandCenter=new o("CommandCenter");static CommandCenterCenter=new o("CommandCenterCenter");static LayoutControlMenuSubmenu=new o("LayoutControlMenuSubmenu");static LayoutControlMenu=new o("LayoutControlMenu");static MenubarMainMenu=new o("MenubarMainMenu");static MenubarAppearanceMenu=new o("MenubarAppearanceMenu");static MenubarDebugMenu=new o("MenubarDebugMenu");static MenubarEditMenu=new o("MenubarEditMenu");static MenubarCopy=new o("MenubarCopy");static MenubarFileMenu=new o("MenubarFileMenu");static MenubarGoMenu=new o("MenubarGoMenu");static MenubarHelpMenu=new o("MenubarHelpMenu");static MenubarLayoutMenu=new o("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new o("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new o("PanelAlignmentMenu");static PanelPositionMenu=new o("PanelPositionMenu");static ActivityBarPositionMenu=new o("ActivityBarPositionMenu");static MenubarPreferencesMenu=new o("MenubarPreferencesMenu");static MenubarRecentMenu=new o("MenubarRecentMenu");static MenubarSelectionMenu=new o("MenubarSelectionMenu");static MenubarShare=new o("MenubarShare");static MenubarSwitchEditorMenu=new o("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new o("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new o("MenubarTerminalMenu");static MenubarViewMenu=new o("MenubarViewMenu");static MenubarHomeMenu=new o("MenubarHomeMenu");static OpenEditorsContext=new o("OpenEditorsContext");static OpenEditorsContextShare=new o("OpenEditorsContextShare");static ProblemsPanelContext=new o("ProblemsPanelContext");static SCMInputBox=new o("SCMInputBox");static SCMChangesContext=new o("SCMChangesContext");static SCMChangeContext=new o("SCMChangeContext");static SCMResourceContext=new o("SCMResourceContext");static SCMResourceContextShare=new o("SCMResourceContextShare");static SCMResourceFolderContext=new o("SCMResourceFolderContext");static SCMResourceGroupContext=new o("SCMResourceGroupContext");static SCMSourceControl=new o("SCMSourceControl");static SCMSourceControlInline=new o("SCMSourceControlInline");static SCMSourceControlTitle=new o("SCMSourceControlTitle");static SCMHistoryTitle=new o("SCMHistoryTitle");static SCMTitle=new o("SCMTitle");static SearchContext=new o("SearchContext");static SearchActionMenu=new o("SearchActionContext");static StatusBarWindowIndicatorMenu=new o("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new o("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new o("StickyScrollContext");static TestItem=new o("TestItem");static TestItemGutter=new o("TestItemGutter");static TestProfilesContext=new o("TestProfilesContext");static TestMessageContext=new o("TestMessageContext");static TestMessageContent=new o("TestMessageContent");static TestPeekElement=new o("TestPeekElement");static TestPeekTitle=new o("TestPeekTitle");static TestCallStack=new o("TestCallStack");static TouchBarContext=new o("TouchBarContext");static TitleBarContext=new o("TitleBarContext");static TitleBarTitleContext=new o("TitleBarTitleContext");static TunnelContext=new o("TunnelContext");static TunnelPrivacy=new o("TunnelPrivacy");static TunnelProtocol=new o("TunnelProtocol");static TunnelPortInline=new o("TunnelInline");static TunnelTitle=new o("TunnelTitle");static TunnelLocalAddressInline=new o("TunnelLocalAddressInline");static TunnelOriginInline=new o("TunnelOriginInline");static ViewItemContext=new o("ViewItemContext");static ViewContainerTitle=new o("ViewContainerTitle");static ViewContainerTitleContext=new o("ViewContainerTitleContext");static ViewTitle=new o("ViewTitle");static ViewTitleContext=new o("ViewTitleContext");static CommentEditorActions=new o("CommentEditorActions");static CommentThreadTitle=new o("CommentThreadTitle");static CommentThreadActions=new o("CommentThreadActions");static CommentThreadAdditionalActions=new o("CommentThreadAdditionalActions");static CommentThreadTitleContext=new o("CommentThreadTitleContext");static CommentThreadCommentContext=new o("CommentThreadCommentContext");static CommentTitle=new o("CommentTitle");static CommentActions=new o("CommentActions");static CommentsViewThreadActions=new o("CommentsViewThreadActions");static InteractiveToolbar=new o("InteractiveToolbar");static InteractiveCellTitle=new o("InteractiveCellTitle");static InteractiveCellDelete=new o("InteractiveCellDelete");static InteractiveCellExecute=new o("InteractiveCellExecute");static InteractiveInputExecute=new o("InteractiveInputExecute");static InteractiveInputConfig=new o("InteractiveInputConfig");static ReplInputExecute=new o("ReplInputExecute");static IssueReporter=new o("IssueReporter");static NotebookToolbar=new o("NotebookToolbar");static NotebookStickyScrollContext=new o("NotebookStickyScrollContext");static NotebookCellTitle=new o("NotebookCellTitle");static NotebookCellDelete=new o("NotebookCellDelete");static NotebookCellInsert=new o("NotebookCellInsert");static NotebookCellBetween=new o("NotebookCellBetween");static NotebookCellListTop=new o("NotebookCellTop");static NotebookCellExecute=new o("NotebookCellExecute");static NotebookCellExecuteGoTo=new o("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new o("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new o("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new o("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new o("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new o("NotebookOutputToolbar");static NotebookOutlineFilter=new o("NotebookOutlineFilter");static NotebookOutlineActionMenu=new o("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new o("NotebookEditorLayoutConfigure");static NotebookKernelSource=new o("NotebookKernelSource");static BulkEditTitle=new o("BulkEditTitle");static BulkEditContext=new o("BulkEditContext");static TimelineItemContext=new o("TimelineItemContext");static TimelineTitle=new o("TimelineTitle");static TimelineTitleContext=new o("TimelineTitleContext");static TimelineFilterSubMenu=new o("TimelineFilterSubMenu");static AccountsContext=new o("AccountsContext");static SidebarTitle=new o("SidebarTitle");static PanelTitle=new o("PanelTitle");static AuxiliaryBarTitle=new o("AuxiliaryBarTitle");static AuxiliaryBarHeader=new o("AuxiliaryBarHeader");static TerminalInstanceContext=new o("TerminalInstanceContext");static TerminalEditorInstanceContext=new o("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new o("TerminalNewDropdownContext");static TerminalTabContext=new o("TerminalTabContext");static TerminalTabEmptyAreaContext=new o("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new o("TerminalStickyScrollContext");static WebviewContext=new o("WebviewContext");static InlineCompletionsActions=new o("InlineCompletionsActions");static InlineEditsActions=new o("InlineEditsActions");static InlineEditActions=new o("InlineEditActions");static NewFile=new o("NewFile");static MergeInput1Toolbar=new o("MergeToolbar1Toolbar");static MergeInput2Toolbar=new o("MergeToolbar2Toolbar");static MergeBaseToolbar=new o("MergeBaseToolbar");static MergeInputResultToolbar=new o("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new o("InlineSuggestionToolbar");static InlineEditToolbar=new o("InlineEditToolbar");static ChatContext=new o("ChatContext");static ChatCodeBlock=new o("ChatCodeblock");static ChatCompareBlock=new o("ChatCompareBlock");static ChatMessageTitle=new o("ChatMessageTitle");static ChatExecute=new o("ChatExecute");static ChatExecuteSecondary=new o("ChatExecuteSecondary");static ChatInputSide=new o("ChatInputSide");static AccessibleView=new o("AccessibleView");static MultiDiffEditorFileToolbar=new o("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new o("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new o("DiffEditorSelectionToolbar");static for(e){return o._instances.get(e)??new o(e)}id;constructor(e){if(o._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);o._instances.set(e,this),this.id=e}},Ey=j("menuService"),cc=class o{constructor(e){this.id=e;this.has=t=>t===e}static _all=new Map;static for(e){let t=this._all.get(e);return t||(t=new o(e),this._all.set(e,t)),t}static merge(e){let t=new Set;for(let n of e)n instanceof o&&t.add(n.id);return t}has},Qu=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new av({merge:cc.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(o){return this._commands.set(o.id,o),this._onDidChangeMenu.fire(cc.for(Fn.CommandPalette)),Ce(()=>{this._commands.delete(o.id)&&this._onDidChangeMenu.fire(cc.for(Fn.CommandPalette))})}getCommand(o){return this._commands.get(o)}getCommands(){let o=new Map;return this._commands.forEach((e,t)=>o.set(t,e)),o}appendMenuItem(o,e){let t=this._menuItems.get(o);t||(t=new An,this._menuItems.set(o,t));let n=t.push(e);return this._onDidChangeMenu.fire(cc.for(o)),Ce(()=>{n(),this._onDidChangeMenu.fire(cc.for(o))})}appendMenuItems(o){let e=new ae;for(let{id:t,item:n}of o)e.add(this.appendMenuItem(t,n));return e}getMenuItems(o){let e;return this._menuItems.has(o)?e=[...this._menuItems.get(o)]:e=[],o===Fn.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(o){let e=new Set;for(let t of o)nL(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,n)=>{e.has(n)||o.push({command:t})})}};var Yr=class{constructor(e,t,n,i,r,s,a){this.hideActions=i;this.menuKeybinding=r;this._commandService=a;this.id=e.id,this.label=Yr.label(e,n),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||s.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){let d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&nt.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=nt.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new Yr(t,void 0,n,i,void 0,s,a):void 0,this._options=n,this.class=l&&nt.asClassName(l)}static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};Yr=K([D(5,Rt),D(6,qr)],Yr);var Ju=class extends V{constructor(t,n,i,r,s){super();this._accessibilityService=s;this.isSimpleWidget=t,this.contextMenuId=n,this._containerObserver=this._register(new Xv(r,i.dimension)),this._targetWindowId=ge(r).vscodeWindowId,this._rawOptions=gN(i),this._validatedOptions=uc.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Us.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(Zu.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(JT.onDidChange(()=>this._recomputeOptions())),this._register(Vu.getInstance(ge(r)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new L);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new Ig;_rawOptions;_validatedOptions;options;_recomputeOptions(){let t=this._computeOptions(),n=uc.checkEquals(this.options,t);n!==null&&(this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n))}_computeOptions(){let t=this._readEnvConfiguration(),n=Sg.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(n),r={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:Zu.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return uc.computeOptions(this._validatedOptions,r)}_readEnvConfiguration(){return{extraEditorClassName:K4(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Ar||In,pixelRatio:Vu.getInstance(Cw(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return JT.readFontInfo(Cw(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){let n=gN(t);uc.applyUpdate(this._rawOptions,n)&&(this._validatedOptions=uc.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){let n=z4(t);this._lineNumbersDigitCount!==n&&(this._lineNumbersDigitCount=n,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};Ju=K([D(4,Vi)],Ju);function z4(o){let e=0;for(;o;)o=Math.floor(o/10),e++;return e||1}function K4(){let o="";return!Xo&&!NM&&(o+="no-user-select "),Xo&&(o+="no-minimap-shadow ",o+="enable-user-select "),Ve&&(o+="mac "),o}var iL=class{_values=[];_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}},oL=class{_values=[];_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}},uc=class o{static validateOptions(e){let t=new iL;for(let n of Yu){let i=n.name==="_never_"?void 0:e[n.name];t._write(n.id,n.validate(i))}return t}static computeOptions(e,t){let n=new oL;for(let i of Yu)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?tn(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e)if(!o._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){let n=[],i=!1;for(let r of Yu){let s=!o._deepEquals(e._read(r.id),t._read(r.id));n[r.id]=s,s&&(i=!0)}return i?new Cy(n):null}static applyUpdate(e,t){let n=!1;for(let i of Yu)if(t.hasOwnProperty(i.name)){let r=i.applyUpdate(e[i.name],t[i.name]);e[i.name]=r.newValue,n=n||r.didChange}return n}};function gN(o){let e=jv(o);return pN(e),e}var M=class o{lineNumber;column;constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new o(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return o.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return o.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return o.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,i=t.lineNumber|0;if(n===i){let r=e.column|0,s=t.column|0;return r-s}return n-i}clone(){return new o(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new o(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var w=class o{startLineNumber;startColumn;endLineNumber;endColumn;constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return o.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return o.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return o.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return o.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return o.plusRange(this,e)}static plusRange(e,t){let n,i,r,s;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,s=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,s=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,s=e.endColumn),new o(n,i,r,s)}intersectRanges(e){return o.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,s=e.endColumn,a=t.startLineNumber,l=t.startColumn,d=t.endLineNumber,c=t.endColumn;return n<a?(n=a,i=l):n===a&&(i=Math.max(i,l)),r>d?(r=d,s=c):r===d&&(s=Math.min(s,c)),n>r||n===r&&i>s?null:new o(n,i,r,s)}equalsRange(e){return o.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return o.getEndPosition(this)}static getEndPosition(e){return new M(e.endLineNumber,e.endColumn)}getStartPosition(){return o.getStartPosition(this)}static getStartPosition(e){return new M(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new o(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new o(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return o.collapseToStart(this)}static collapseToStart(e){return new o(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return o.collapseToEnd(this)}static collapseToEnd(e){return new o(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new o(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let r=e.startLineNumber|0,s=t.startLineNumber|0;if(r===s){let a=e.startColumn|0,l=t.startColumn|0;if(a===l){let d=e.endLineNumber|0,c=t.endLineNumber|0;if(d===c){let u=e.endColumn|0,p=t.endColumn|0;return u-p}return d-c}return a-l}return r-s}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var Me=class o extends w{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return o.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new o(this.startLineNumber,this.startColumn,e,t):new o(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new M(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new M(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new o(e,t,this.endLineNumber,this.endColumn):new o(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new o(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new o(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new o(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new o(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,i,r){return r===0?new o(e,t,n,i):new o(n,i,e,t)}};var Xr=class{originalStart;originalLength;modifiedStart;modifiedLength;constructor(e,t,n,i){this.originalStart=e,this.originalLength=t,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}};var ql=class{static Assert(e,t){if(!e)throw new Error(t)}},Yl=class{static Copy(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}static Copy2(e,t,n,i,r){for(let s=0;s<r;s++)n[i+s]=e[t+s]}};var wy=class{m_changes;m_originalStart;m_modifiedStart;m_originalCount;m_modifiedCount;constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Xr(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},ep=class o{ContinueProcessingPredicate;_originalSequence;_modifiedSequence;_hasStrings;_originalStringElements;_originalElementsOrHash;_modifiedStringElements;_modifiedElementsOrHash;m_forwardHistory;m_reverseHistory;constructor(e,t,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=t;let[i,r,s]=o._getElements(e),[a,l,d]=o._getElements(t);this._hasStrings=s&&d,this._originalStringElements=i,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){let t=e.getElements();if(o._isStringArray(t)){let n=new Int32Array(t.length);for(let i=0,r=t.length;i<r;i++)n[i]=Bv(t[i],0);return[t,n,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;let n=o._getStrictElement(this._originalSequence,e),i=o._getStrictElement(this._modifiedSequence,t);return n===i}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,n,i,r){let s=[!1],a=this.ComputeDiffRecursive(e,t,n,i,s);return r&&(a=this.PrettifyChanges(a)),{quitEarly:s[0],changes:a}}ComputeDiffRecursive(e,t,n,i,r){for(r[0]=!1;e<=t&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;t>=e&&i>=n&&this.ElementsAreEqual(t,i);)t--,i--;if(e>t||n>i){let u;return n<=i?(ql.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new Xr(e,0,n,i-n+1)]):e<=t?(ql.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[new Xr(e,t-e+1,n,0)]):(ql.Assert(e===t+1,"originalStart should only be one more than originalEnd"),ql.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}let s=[0],a=[0],l=this.ComputeRecursionPoint(e,t,n,i,s,a,r),d=s[0],c=a[0];if(l!==null)return l;if(!r[0]){let u=this.ComputeDiffRecursive(e,d,n,c,r),p=[];return r[0]?p=[new Xr(d+1,t-(d+1)+1,c+1,i-(c+1)+1)]:p=this.ComputeDiffRecursive(d+1,t,c+1,i,r),this.ConcatenateChanges(u,p)}return[new Xr(e,t-e+1,n,i-n+1)]}WALKTRACE(e,t,n,i,r,s,a,l,d,c,u,p,m,f,g,b,v,I){let C=null,S=null,_=new wy,R=t,N=n,F=m[0]-b[0]-i,P=-1073741824,H=this.m_forwardHistory.length-1;do{let U=F+e;U===R||U<N&&d[U-1]<d[U+1]?(u=d[U+1],f=u-F-i,u<P&&_.MarkNextChange(),P=u,_.AddModifiedElement(u+1,f),F=U+1-e):(u=d[U-1]+1,f=u-F-i,u<P&&_.MarkNextChange(),P=u-1,_.AddOriginalElement(u,f+1),F=U-1-e),H>=0&&(d=this.m_forwardHistory[H],e=d[0],R=1,N=d.length-1)}while(--H>=-1);if(C=_.getReverseChanges(),I[0]){let U=m[0]+1,z=b[0]+1;if(C!==null&&C.length>0){let oe=C[C.length-1];U=Math.max(U,oe.getOriginalEnd()),z=Math.max(z,oe.getModifiedEnd())}S=[new Xr(U,p-U+1,z,g-z+1)]}else{_=new wy,R=s,N=a,F=m[0]-b[0]-l,P=1073741824,H=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let U=F+r;U===R||U<N&&c[U-1]>=c[U+1]?(u=c[U+1]-1,f=u-F-l,u>P&&_.MarkNextChange(),P=u+1,_.AddOriginalElement(u+1,f+1),F=U+1-r):(u=c[U-1],f=u-F-l,u>P&&_.MarkNextChange(),P=u,_.AddModifiedElement(u+1,f+1),F=U-1-r),H>=0&&(c=this.m_reverseHistory[H],r=c[0],R=1,N=c.length-1)}while(--H>=-1);S=_.getChanges()}return this.ConcatenateChanges(C,S)}ComputeRecursionPoint(e,t,n,i,r,s,a){let l=0,d=0,c=0,u=0,p=0,m=0;e--,n--,r[0]=0,s[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let f=t-e+(i-n),g=f+1,b=new Int32Array(g),v=new Int32Array(g),I=i-n,C=t-e,S=e-n,_=t-i,N=(C-I)%2===0;b[I]=e,v[C]=t,a[0]=!1;for(let F=1;F<=f/2+1;F++){let P=0,H=0;c=this.ClipDiagonalBound(I-F,F,I,g),u=this.ClipDiagonalBound(I+F,F,I,g);for(let z=c;z<=u;z+=2){z===c||z<u&&b[z-1]<b[z+1]?l=b[z+1]:l=b[z-1]+1,d=l-(z-I)-S;let oe=l;for(;l<t&&d<i&&this.ElementsAreEqual(l+1,d+1);)l++,d++;if(b[z]=l,l+d>P+H&&(P=l,H=d),!N&&Math.abs(z-C)<=F-1&&l>=v[z])return r[0]=l,s[0]=d,oe<=v[z]&&F<=1448?this.WALKTRACE(I,c,u,S,C,p,m,_,b,v,l,t,r,d,i,s,N,a):null}let U=(P-e+(H-n)-F)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(P,U))return a[0]=!0,r[0]=P,s[0]=H,U>0&&F<=1448?this.WALKTRACE(I,c,u,S,C,p,m,_,b,v,l,t,r,d,i,s,N,a):(e++,n++,[new Xr(e,t-e+1,n,i-n+1)]);p=this.ClipDiagonalBound(C-F,F,C,g),m=this.ClipDiagonalBound(C+F,F,C,g);for(let z=p;z<=m;z+=2){z===p||z<m&&v[z-1]>=v[z+1]?l=v[z+1]-1:l=v[z-1],d=l-(z-C)-_;let oe=l;for(;l>e&&d>n&&this.ElementsAreEqual(l,d);)l--,d--;if(v[z]=l,N&&Math.abs(z-I)<=F&&l<=b[z])return r[0]=l,s[0]=d,oe>=b[z]&&F<=1448?this.WALKTRACE(I,c,u,S,C,p,m,_,b,v,l,t,r,d,i,s,N,a):null}if(F<=1447){let z=new Int32Array(u-c+2);z[0]=I-c+1,Yl.Copy2(b,c,z,1,u-c+1),this.m_forwardHistory.push(z),z=new Int32Array(m-p+2),z[0]=C-p+1,Yl.Copy2(v,p,z,1,m-p+1),this.m_reverseHistory.push(z)}}return this.WALKTRACE(I,c,u,S,C,p,m,_,b,v,l,t,r,d,i,s,N,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){let n=e[t],i=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,s=n.originalLength>0,a=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<r&&(!s||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!a||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){let d=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!d)break;n.originalStart++,n.modifiedStart++}let l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){let n=e[t],i=0,r=0;if(t>0){let u=e[t-1];i=u.originalStart+u.originalLength,r=u.modifiedStart+u.modifiedLength}let s=n.originalLength>0,a=n.modifiedLength>0,l=0,d=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let u=1;;u++){let p=n.originalStart-u,m=n.modifiedStart-u;if(p<i||m<r||s&&!this.OriginalElementsAreEqual(p,p+n.originalLength)||a&&!this.ModifiedElementsAreEqual(m,m+n.modifiedLength))break;let g=(p===i&&m===r?5:0)+this._boundaryScore(p,n.originalLength,m,n.modifiedLength);g>d&&(d=g,l=u)}n.originalStart-=l,n.modifiedStart-=l;let c=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],c)){e[t-1]=c[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,n=e.length;t<n;t++){let i=e[t-1],r=e[t],s=r.originalStart-i.originalStart-i.originalLength,a=i.originalStart,l=r.originalStart+r.originalLength,d=l-a,c=i.modifiedStart,u=r.modifiedStart+r.modifiedLength,p=u-c;if(s<5&&d<20&&p<20){let m=this._findBetterContiguousSequence(a,d,c,p,s);if(m){let[f,g]=m;(f!==i.originalStart+i.originalLength||g!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=f-i.originalStart,i.modifiedLength=g-i.modifiedStart,r.originalStart=f+s,r.modifiedStart=g+s,r.originalLength=l-r.originalStart,r.modifiedLength=u-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,n,i,r){if(t<r||i<r)return null;let s=e+t-r+1,a=n+i-r+1,l=0,d=0,c=0;for(let u=e;u<s;u++)for(let p=n;p<a;p++){let m=this._contiguousSequenceScore(u,p,r);m>0&&m>l&&(l=m,d=u,c=p)}return l>0?[d,c]:null}_contiguousSequenceScore(e,t,n){let i=0;for(let r=0;r<n;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;i+=this._originalStringElements[e+r].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){let n=e+t;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,t,n,i){let r=this._OriginalRegionIsBoundary(e,t)?1:0,s=this._ModifiedRegionIsBoundary(n,i)?1:0;return r+s}ConcatenateChanges(e,t){let n=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],n)){let i=new Array(e.length+t.length-1);return Yl.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Yl.Copy(t,1,i,e.length,t.length-1),i}else{let i=new Array(e.length+t.length);return Yl.Copy(e,0,i,0,e.length),Yl.Copy(t,0,i,e.length,t.length),i}}ChangesOverlap(e,t,n){if(ql.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),ql.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){let i=e.originalStart,r=e.originalLength,s=e.modifiedStart,a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),n[0]=new Xr(i,r,s,a),!0}else return n[0]=null,!1}ClipDiagonalBound(e,t,n,i){if(e>=0&&e<i)return e;let r=n,s=i-n-1,a=t%2===0;if(e<0){let l=r%2===0;return a===l?0:1}else{let l=s%2===0;return a===l?i-1:i-2}}};var wt=class o{constructor(e,t){this.start=e;this.endExclusive=t;if(e>t)throw new $e(`Invalid range: ${this.toString()}`)}static addRange(e,t){let n=0;for(;n<t.length&&t[n].endExclusive<e.start;)n++;let i=n;for(;i<t.length&&t[i].start<=e.endExclusive;)i++;if(n===i)t.splice(n,0,e);else{let r=Math.min(e.start,t[n].start),s=Math.max(e.endExclusive,t[i-1].endExclusive);t.splice(n,i-n,new o(r,s))}}static tryCreate(e,t){if(!(e>t))return new o(e,t)}static ofLength(e){return new o(0,e)}static ofStartAndLength(e,t){return new o(e,e+t)}static emptyAt(e){return new o(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new o(this.start+e,this.endExclusive+e)}deltaStart(e){return new o(this.start+e,this.endExclusive)}deltaEnd(e){return new o(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new o(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(t<=n)return new o(t,n)}intersectionLength(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-t)}intersects(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<n}intersectsOrTouches(e){let t=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return t<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new $e(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new $e(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let n=this.start;n<this.endExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}};var Ci=class o{static fromRange(e){return new o(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new o(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(e.startLineNumber,t.startLineNumber),new o(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new o(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new o(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new Ty(e[0].slice());for(let n=1;n<e.length;n++)t=t.getUnion(new Ty(e[n].slice()));return t.ranges}static join(e){if(e.length===0)throw new $e("lineRanges cannot be empty");let t=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)t=Math.min(t,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new o(t,n)}static ofLength(e,t){return new o(e,e+t)}static deserialize(e){return new o(e[0],e[1])}startLineNumber;endLineNumberExclusive;constructor(e,t){if(e>t)throw new $e(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new o(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new o(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new o(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=n)return new o(t,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new w(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new w(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)t.push(e(n));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new wt(this.startLineNumber-1,this.endLineNumberExclusive-1)}},Ty=class o{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=Mb(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=pu(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)this._normalizedRanges.splice(t,0,e);else if(t===n-1){let i=this._normalizedRanges[t];this._normalizedRanges[t]=i.join(e)}else{let i=this._normalizedRanges[t].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(t,n-t,i)}}contains(e){let t=uE(this._normalizedRanges,n=>n.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=uE(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],n=0,i=0,r=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let s=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let a=this._normalizedRanges[n],l=e._normalizedRanges[i];a.startLineNumber<l.startLineNumber?(s=a,n++):(s=l,i++)}else n<this._normalizedRanges.length?(s=this._normalizedRanges[n],n++):(s=e._normalizedRanges[i],i++);r===null?r=s:r.endLineNumberExclusive>=s.startLineNumber?r=new Ci(r.startLineNumber,Math.max(r.endLineNumberExclusive,s.endLineNumberExclusive)):(t.push(r),r=s)}return r!==null&&t.push(r),new o(t)}subtractFrom(e){let t=Mb(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),n=pu(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===n)return new o([e]);let i=[],r=e.startLineNumber;for(let s=t;s<n;s++){let a=this._normalizedRanges[s];a.startLineNumber>r&&i.push(new Ci(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&i.push(new Ci(r,e.endLineNumberExclusive)),new o(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let r=this._normalizedRanges[n],s=e._normalizedRanges[i],a=r.intersect(s);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<s.endLineNumberExclusive?n++:i++}return new o(t)}getWithDelta(e){return new o(this._normalizedRanges.map(t=>t.delta(e)))}};var wo=class{static insert(e,t){return{range:new w(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}};var Si=class o{constructor(e,t){this.lineCount=e;this.columnCount=t}static zero=new o(0,0);static lengthDiffNonNegative(e,t){return t.isLessThan(e)?o.zero:e.lineCount===t.lineCount?new o(0,t.columnCount-e.columnCount):new o(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new o(0,t.column-e.column):new o(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return o.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,n=0;for(let i of e)i===`
`?(t++,n=0):n++;return new o(t,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new o(this.lineCount,this.columnCount+e.columnCount):new o(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new w(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new w(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new w(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new M(e.lineNumber,e.column+this.columnCount):new M(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};var Ly=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}lineStartOffsetByLineIdx;getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new wt(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let t=pu(this.lineStartOffsetByLineIdx,r=>r<=e),n=t+1,i=e-this.lineStartOffsetByLineIdx[t]+1;return new M(n,i)}getRange(e){return w.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Si.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Si(e,this.text.length-this.lineStartOffsetByLineIdx[e])}};var Ua=class o{constructor(e){this.edits=e;Pd(()=>kE(e,(t,n)=>t.range.getEndPosition().isBeforeOrEqual(n.range.getStartPosition())))}static single(e,t){return new o([new un(e,t)])}normalize(){let e=[];for(let t of this.edits)if(e.length>0&&e[e.length-1].range.getEndPosition().equals(t.range.getStartPosition())){let n=e[e.length-1];e[e.length-1]=new un(n.range.plusRange(t.range),n.text+t.text)}else t.isEmpty||e.push(t);return new o(e)}mapPosition(e){let t=0,n=0,i=0;for(let r of this.edits){let s=r.range.getStartPosition(),a=r.range.getEndPosition();if(e.isBeforeOrEqual(s))break;let l=Si.ofText(r.text);if(e.isBefore(a)){let d=new M(s.lineNumber+t,s.column+(s.lineNumber+t===n?i:0)),c=l.addToPosition(d);return Dy(d,c)}t+=l.lineCount-(r.range.endLineNumber-r.range.startLineNumber),l.lineCount===0?a.lineNumber!==s.lineNumber?i+=l.columnCount-(a.column-1):i+=l.columnCount-(a.column-s.column):i=l.columnCount,n=a.lineNumber+t}return new M(e.lineNumber+t,e.column+(e.lineNumber+t===n?i:0))}mapRange(e){function t(s){return s instanceof M?s:s.getStartPosition()}function n(s){return s instanceof M?s:s.getEndPosition()}let i=t(this.mapPosition(e.getStartPosition())),r=n(this.mapPosition(e.getEndPosition()));return Dy(i,r)}inverseMapPosition(e,t){return this.inverse(t).mapPosition(e)}inverseMapRange(e,t){return this.inverse(t).mapRange(e)}apply(e){let t="",n=new M(1,1);for(let r of this.edits){let s=r.range,a=s.getStartPosition(),l=s.getEndPosition(),d=Dy(n,a);d.isEmpty()||(t+=e.getValueOfRange(d)),t+=r.text,n=l}let i=Dy(n,e.endPositionExclusive);return i.isEmpty()||(t+=e.getValueOfRange(i)),t}applyToString(e){let t=new sL(e);return this.apply(t)}inverse(e){let t=this.getNewRanges();return new o(this.edits.map((n,i)=>new un(t[i],e.getValueOfRange(n.range))))}getNewRanges(){let e=[],t=0,n=0,i=0;for(let r of this.edits){let s=Si.ofText(r.text),a=M.lift({lineNumber:r.range.startLineNumber+n,column:r.range.startColumn+(r.range.startLineNumber===t?i:0)}),l=s.createRange(a);e.push(l),n=l.endLineNumber-r.range.endLineNumber,i=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}},un=class{constructor(e,t){this.range=e;this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};function Dy(o,e){if(o.lineNumber===e.lineNumber&&o.column===Number.MAX_SAFE_INTEGER)return w.fromPositions(e,e);if(!o.isBeforeOrEqual(e))throw new $e("start must be before end");return new w(o.lineNumber,o.column,e.lineNumber,e.column)}var rL=class{get endPositionExclusive(){return this.length.addToPosition(new M(1,1))}getValue(){return this.getValueOfRange(this.length.toRange())}};var sL=class extends rL{constructor(t){super();this.value=t}_t=new Ly(this.value);getValueOfRange(t){return this._t.getOffsetRange(t).substring(this.value)}get length(){return this._t.textLength}};function lL(o,e){return new aL(o,e)}var aL=class{constructor(e,t){this.reducer=e;this.options=t}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(t=>this.pendingWritePromises.push(t))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(typeof e<"u"&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?We(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){let i=n.indexOf(t);i>=0&&n.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let e=this.reducer(this.buffer.data);this.emitData(e),this.buffer.data.length=0;let t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(n=>n())}}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function dL(o,e,t){o.on("error",n=>{t?.isCancellationRequested||e.onError(n)}),o.on("end",()=>{t?.isCancellationRequested||e.onEnd()}),o.on("data",n=>{t?.isCancellationRequested||e.onData(n)})}function fN(o,e){let t=lL(e);return t.end(o),t}function bN(o){let e=!1;return{read:()=>e?null:(e=!0,o)}}var ky=typeof Buffer<"u",$4=new yi(()=>new Uint8Array(256)),cL,uL,gn=class o{static alloc(e){return ky?new o(Buffer.allocUnsafe(e)):new o(new Uint8Array(e))}static wrap(e){return ky&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new o(e)}static fromString(e,t){return!(t?.dontUseNodeBuffer||!1)&&ky?new o(Buffer.from(e)):(cL||(cL=new TextEncoder),new o(cL.encode(e)))}static fromByteArray(e){let t=o.alloc(e.length);for(let n=0,i=e.length;n<i;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].byteLength}let n=o.alloc(t),i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];n.set(a,i),i+=a.byteLength}return n}buffer;byteLength;constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let e=o.alloc(this.byteLength);return e.set(this),e}toString(){return ky?this.buffer.toString():(uL||(uL=new TextDecoder),uL.decode(this.buffer))}slice(e,t){return new o(this.buffer.subarray(e,t))}set(e,t){if(e instanceof o)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Bn(this.buffer,e)}writeUInt32BE(e,t){Wn(this.buffer,e,t)}readUInt32LE(e){return q4(this.buffer,e)}writeUInt32LE(e,t){Y4(this.buffer,e,t)}readUInt8(e){return Ry(this.buffer,e)}writeUInt8(e,t){My(this.buffer,e,t)}indexOf(e,t=0){return j4(this.buffer,e instanceof o?e.buffer:e,t)}};function j4(o,e,t=0){let n=e.byteLength,i=o.byteLength;if(n===0)return 0;if(n===1)return o.indexOf(e[0]);if(n>i-t)return-1;let r=$4.value;r.fill(e.length);for(let d=0;d<e.length;d++)r[e[d]]=e.length-d-1;let s=t+e.length-1,a=s,l=-1;for(;s<i;)if(o[s]===e[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(e.length-a,r[o[s]]),a=e.length-1;return l}function vN(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0}function yN(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255}function Bn(o,e){return o[e]*2**24+o[e+1]*2**16+o[e+2]*2**8+o[e+3]}function Wn(o,e,t){o[t+3]=e,e=e>>>8,o[t+2]=e,e=e>>>8,o[t+1]=e,e=e>>>8,o[t]=e}function q4(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0|o[e+2]<<16>>>0|o[e+3]<<24>>>0}function Y4(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255,e=e>>>8,o[t+2]=e&255,e=e>>>8,o[t+3]=e&255}function Ry(o,e){return o[e]}function My(o,e,t){o[t]=e}function IN(o){return bN(o)}function CN(o){return fN(o,e=>gn.concat(e))}var hL;function SN(){return hL||(hL=new TextDecoder("UTF-16LE")),hL}var mL;function X4(){return mL||(mL=new TextDecoder("UTF-16BE")),mL}var gL;function fL(){return gL||(gL=zR()?SN():X4()),gL}function xN(o,e,t){let n=new Uint16Array(o.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?Z4(o,e,t):SN().decode(n)}function Z4(o,e,t){let n=[],i=0;for(let r=0;r<t;r++){let s=vN(o,e);e+=2,n[i++]=String.fromCharCode(s)}return n.join("")}var pc=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return fL().decode(e)}_flushBuffer(){let e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){let t=this._capacity-this._bufferLength;t<=1&&(t===0||At(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){let t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}};function Py(o){return o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var To=class o{constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Py(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Py(this.oldText)}")`:`(replace@${this.oldPosition} "${Py(this.oldText)}" with "${Py(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let i=t.length;Wn(e,i,n),n+=4;for(let r=0;r<i;r++)yN(e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){let n=Bn(e,t);return t+=4,xN(e,t,n)}writeSize(){return 8+o._writeStringSize(this.oldText)+o._writeStringSize(this.newText)}write(e,t){return Wn(e,this.oldPosition,t),t+=4,Wn(e,this.newPosition,t),t+=4,t=o._writeString(e,this.oldText,t),t=o._writeString(e,this.newText,t),t}static read(e,t,n){let i=Bn(e,t);t+=4;let r=Bn(e,t);t+=4;let s=o._readString(e,t);t+=o._writeStringSize(s);let a=o._readString(e,t);return t+=o._writeStringSize(a),n.push(new o(i,s,r,a)),t}};function _N(o,e){return o===null||o.length===0?e:new bL(o,e).compress()}var bL=class o{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(n===null){this._acceptCurr(i),i=this._getCurr(++t);continue}if(i===null){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){let[d,c]=o._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(d),i=c;continue}if(n.newPosition<i.oldPosition){let[d,c]=o._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(d),n=c;continue}let a,l;if(i.oldEnd===n.newEnd)a=n,l=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){let[d,c]=o._splitPrev(n,i.oldLength);a=d,l=i,n=c,i=this._getCurr(++t)}else{let[d,c]=o._splitCurr(i,n.newLength);a=n,l=d,n=this._getPrev(++e),i=c}this._result[this._resultLen++]=new To(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let r=o._merge(this._result);return o._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=o._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=o._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new To(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new To(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){let n=e.newText.substr(0,t),i=e.newText.substr(t);return[new To(e.oldPosition,e.oldText,e.newPosition,n),new To(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){let n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new To(e.oldPosition,n,e.newPosition,e.newText),new To(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){let s=e[r];i.oldEnd===s.oldPosition?i=new To(i.oldPosition,i.oldText+s.oldText,i.newPosition,i.newText+s.newText):(t[n++]=i,i=s)}return t[n++]=i,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],n=0;for(let i=0;i<e.length;i++){let r=e[i];r.oldText!==r.newText&&(t[n++]=r)}return t}};var hc=class o{_asciiMap;_map;_defaultValue;constructor(e){let t=Od(e);this._defaultValue=t,this._asciiMap=o._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=Od(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var Ny=class{_actual;constructor(){this._actual=new hc(0)}add(e){this._actual.set(e,1)}has(e){return this._actual.get(e)===1}clear(){return this._actual.clear()}};var vL=class extends hc{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(e,t){super(0),this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,i=e.length;n<i;n++)this.set(e.charCodeAt(n),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t)break;n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}},EN=new Pi(10);function zs(o,e){let t=`${o}/${e.join(",")}`,n=EN.get(t);return n||(n=new vL(o,e),EN.set(t,n)),n}function Zl(o,e){let t=Math.pow(10,e);return Math.round(o*t)/t}var je=class{_rgbaBrand=void 0;r;g;b;a;constructor(e,t,n,i=1){this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,n))|0,this.a=Zl(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}},Xl=class o{_hslaBrand=void 0;h;s;l;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=Zl(Math.max(Math.min(1,t),0),3),this.l=Zl(Math.max(Math.min(1,n),0),3),this.a=Zl(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=e.a,s=Math.max(t,n,i),a=Math.min(t,n,i),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case t:l=(n-i)/u+(n<i?6:0);break;case n:l=(i-t)/u+2;break;case i:l=(t-n)/u+4;break}l*=60,l=Math.round(l)}return new o(l,d,c,r)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){let t=e.h/360,{s:n,l:i,a:r}=e,s,a,l;if(n===0)s=a=l=i;else{let d=i<.5?i*(1+n):i+n-i*n,c=2*i-d;s=o._hue2rgb(c,d,t+1/3),a=o._hue2rgb(c,d,t),l=o._hue2rgb(c,d,t-1/3)}return new je(Math.round(s*255),Math.round(a*255),Math.round(l*255),r)}},tp=class o{_hsvaBrand=void 0;h;s;v;a;constructor(e,t,n,i){this.h=Math.max(Math.min(360,e),0)|0,this.s=Zl(Math.max(Math.min(1,t),0),3),this.v=Zl(Math.max(Math.min(1,n),0),3),this.a=Zl(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){let t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),a=r-s,l=r===0?0:a/r,d;return a===0?d=0:r===t?d=((n-i)/a%6+6)%6:r===n?d=(i-t)/a+2:d=(t-n)/a+4,new o(Math.round(d*60),l,r,e.a)}static toRGBA(e){let{h:t,s:n,v:i,a:r}=e,s=i*n,a=s*(1-Math.abs(t/60%2-1)),l=i-s,[d,c,u]=[0,0,0];return t<60?(d=s,c=a):t<120?(d=a,c=s):t<180?(c=s,u=a):t<240?(c=a,u=s):t<300?(d=a,u=s):t<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new je(d,c,u,r)}},G=class o{static fromHex(e){return o.Format.CSS.parseHex(e)||o.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:Xl.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:tp.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof je)this.rgba=e;else if(e instanceof Xl)this._hsla=e,this.rgba=Xl.toRGBA(e);else if(e instanceof tp)this._hsva=e,this.rgba=tp.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&je.equals(this.rgba,e.rgba)&&Xl.equals(this.hsla,e.hsla)&&tp.equals(this.hsva,e.hsva)}getRelativeLuminance(){let e=o._relativeLuminanceForComponent(this.rgba.r),t=o._relativeLuminanceForComponent(this.rgba.g),n=o._relativeLuminanceForComponent(this.rgba.b),i=.2126*e+.7152*t+.0722*n;return Zl(i,4)}static _relativeLuminanceForComponent(e){let t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t>n}isDarkerThan(e){let t=this.getRelativeLuminance(),n=e.getRelativeLuminance();return t<n}lighten(e){return new o(new Xl(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new o(new Xl(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new je(t,n,i,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new o(new je(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){let t=e.rgba,n=this.rgba.a,i=t.a,r=n+i*(1-n);if(r<1e-6)return o.transparent;let s=this.rgba.r*n/r+t.r*i*(1-n)/r,a=this.rgba.g*n/r+t.g*i*(1-n)/r,l=this.rgba.b*n/r+t.b*i*(1-n)/r;return new o(new je(s,a,l,r))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;let{r:t,g:n,b:i,a:r}=this.rgba;return new o(new je(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-n),e.rgba.b-r*(e.rgba.b-i),1))}flatten(...e){let t=e.reduceRight((n,i)=>o._flatten(i,n));return o._flatten(this,t)}static _flatten(e,t){let n=1-e.rgba.a;return new o(new je(n*t.rgba.r+e.rgba.a*e.rgba.r,n*t.rgba.g+e.rgba.a*e.rgba.g,n*t.rgba.b+e.rgba.a*e.rgba.b))}_toString;toString(){return this._toString||(this._toString=o.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(r-i)/r,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;let i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(i-r)/i,e.darken(n)}static white=new o(new je(255,255,255,1));static black=new o(new je(0,0,0,1));static red=new o(new je(255,0,0,1));static blue=new o(new je(0,0,255,1));static green=new o(new je(0,255,0,1));static cyan=new o(new je(0,255,255,1));static lightgrey=new o(new je(211,211,211,1));static transparent=new o(new je(0,0,0,0))};(e=>{let o;(n=>{let t;(f=>{function i(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:e.Format.CSS.formatRGBA(g)}f.formatRGB=i;function r(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}f.formatRGBA=r;function s(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:e.Format.CSS.formatHSLA(g)}f.formatHSL=s;function a(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}f.formatHSLA=a;function l(g){let b=g.toString(16);return b.length!==2?"0"+b:b}function d(g){return`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}`}f.formatHex=d;function c(g,b=!1){return b&&g.rgba.a===1?e.Format.CSS.formatHex(g):`#${l(g.rgba.r)}${l(g.rgba.g)}${l(g.rgba.b)}${l(Math.round(g.rgba.a*255))}`}f.formatHexA=c;function u(g){return g.isOpaque()?e.Format.CSS.formatHex(g):e.Format.CSS.formatRGBA(g)}f.format=u;function p(g){let b=g.length;if(b===0||g.charCodeAt(0)!==35)return null;if(b===7){let v=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),I=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),C=16*m(g.charCodeAt(5))+m(g.charCodeAt(6));return new e(new je(v,I,C,1))}if(b===9){let v=16*m(g.charCodeAt(1))+m(g.charCodeAt(2)),I=16*m(g.charCodeAt(3))+m(g.charCodeAt(4)),C=16*m(g.charCodeAt(5))+m(g.charCodeAt(6)),S=16*m(g.charCodeAt(7))+m(g.charCodeAt(8));return new e(new je(v,I,C,S/255))}if(b===4){let v=m(g.charCodeAt(1)),I=m(g.charCodeAt(2)),C=m(g.charCodeAt(3));return new e(new je(16*v+v,16*I+I,16*C+C))}if(b===5){let v=m(g.charCodeAt(1)),I=m(g.charCodeAt(2)),C=m(g.charCodeAt(3)),S=m(g.charCodeAt(4));return new e(new je(16*v+v,16*I+I,16*C+C,(16*S+S)/255))}return null}f.parseHex=p;function m(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(t=n.CSS||={})})(o=e.Format||={})})(G||={});var Ks=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let o;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?o=crypto.getRandomValues.bind(crypto):o=function(n){for(let i=0;i<n.length;i++)n[i]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){o(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let i=0,r="";return r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+="-",r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r+=t[e[i++]],r}}();var J4=Object.freeze({create:o=>dr(o.map(e=>e.toString())).join(`\r
`),split:o=>o.split(`\r
`),parse:o=>J4.split(o).filter(e=>!e.startsWith("#"))});var wN=class o{constructor(e){this.value=e}static sep=".";static None=new o("@@none@@");static Empty=new o("");equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+o.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new o((this.value?[this.value,...e]:e).join(o.sep))}};var Lo=class{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let n="mtk"+this.getForeground(e),i=this.getFontStyle(e);return i&1&&(n+=" mtki"),i&2&&(n+=" mtkb"),i&4&&(n+=" mtku"),i&8&&(n+=" mtks"),n}static getInlineStyleFromMetadata(e,t){let n=this.getForeground(e),i=this.getFontStyle(e),r=`color: ${t[n]};`;i&1&&(r+="font-style: italic;"),i&2&&(r+="font-weight: bold;");let s="";return i&4&&(s+=" underline"),i&8&&(s+=" line-through"),s&&(r+=`text-decoration:${s};`),r}static getPresentationFromMetadata(e){let t=this.getForeground(e),n=this.getFontStyle(e);return{foreground:t,italic:!!(n&1),bold:!!(n&2),underline:!!(n&4),strikethrough:!!(n&8)}}};var Oy="**",TN="/",Ay="[/\\\\]",Fy="[^/\\\\]",e5=/\//g;function LN(o,e){switch(o){case 0:return"";case 1:return`${Fy}*?`;default:return`(?:${Ay}|${Fy}+${Ay}${e?`|${Ay}${Fy}+`:""})*?`}}function DN(o,e){if(!o)return[];let t=[],n=!1,i=!1,r="";for(let s of o){switch(s){case e:if(!n&&!i){t.push(r),r="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}r+=s}return r&&t.push(r),t}function NN(o){if(!o)return"";let e="",t=DN(o,TN);if(t.every(n=>n===Oy))e=".*";else{let n=!1;t.forEach((i,r)=>{if(i===Oy){if(n)return;e+=LN(2,r===t.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of i){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===TN?u="":u=Ni(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${DN(a,",").map(m=>NN(m)).join("|")})`;e+=p,s=!1,a="";break}case"]":{e+="["+d+"]",l=!1,d="";break}case"?":e+=Fy;continue;case"*":e+=LN(1);continue;default:e+=Ni(c)}}r<t.length-1&&(t[r+1]!==Oy||r+2<t.length)&&(e+=Ay)}n=i===Oy})}return e}var t5=/^\*\*\/\*\.[\w\.-]+$/,n5=/^\*\*\/([\w\.-]+)\/?$/,i5=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,o5=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,r5=/^\*\*((\/[\w\.-]+)+)\/?$/,s5=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,kN=new Pi(1e4),RN=function(){return!1},Gs=function(){return null};function IL(o,e){if(!o)return Gs;let t;typeof o!="string"?t=o.pattern:t=o,t=t.trim();let n=`${t}_${!!e.trimForExclusions}`,i=kN.get(n);if(i)return MN(i,o);let r;return t5.test(t)?i=a5(t.substr(4),t):(r=n5.exec(yL(t,e)))?i=l5(r[1],t):(e.trimForExclusions?o5:i5).test(t)?i=d5(t,e):(r=r5.exec(yL(t,e)))?i=PN(r[1].substr(1),t,!0):(r=s5.exec(yL(t,e)))?i=PN(r[1],t,!1):i=c5(t),kN.set(n,i),MN(i,o)}function MN(o,e){if(typeof e=="string")return o;let t=function(n,i){return Hm(n,e.base,!Ut)?o(pv(n.substr(e.base.length),yo),i):null};return t.allBasenames=o.allBasenames,t.allPaths=o.allPaths,t.basenames=o.basenames,t.patterns=o.patterns,t}function yL(o,e){return e.trimForExclusions&&o.endsWith("/**")?o.substr(0,o.length-2):o}function a5(o,e){return function(t,n){return typeof t=="string"&&t.endsWith(o)?e:null}}function l5(o,e){let t=`/${o}`,n=`\\${o}`,i=function(s,a){return typeof s!="string"?null:a?a===o?e:null:s===o||s.endsWith(t)||s.endsWith(n)?e:null},r=[o];return i.basenames=r,i.patterns=[e],i.allBasenames=r,i}function d5(o,e){let t=ON(o.slice(1,-1).split(",").map(a=>IL(a,e)).filter(a=>a!==Gs),o),n=t.length;if(!n)return Gs;if(n===1)return t[0];let i=function(a,l){for(let d=0,c=t.length;d<c;d++)if(t[d](a,l))return o;return null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function PN(o,e,t){let n=yo===rt.sep,i=n?o:o.replace(e5,yo),r=yo+i,s=rt.sep+o,a;return t?a=function(l,d){return typeof l=="string"&&(l===i||l.endsWith(r)||!n&&(l===o||l.endsWith(s)))?e:null}:a=function(l,d){return typeof l=="string"&&(l===i||!n&&l===o)?e:null},a.allPaths=[(t?"*/":"./")+o],a}function c5(o){try{let e=new RegExp(`^${NN(o)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?o:null}}catch{return Gs}}function _g(o,e={}){if(!o)return RN;if(typeof o=="string"||u5(o)){let t=IL(o,e);if(t===Gs)return RN;let n=function(i,r){return!!t(i,r)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return p5(o,e)}function u5(o){let e=o;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function p5(o,e){let t=ON(Object.getOwnPropertyNames(o).map(a=>h5(a,o[a],e)).filter(a=>a!==Gs)),n=t.length;if(!n)return Gs;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];let a=function(c,u){let p;for(let m=0,f=t.length;m<f;m++){let g=t[m](c,u);if(typeof g=="string")return g;Rv(g)&&(p||(p=[]),p.push(g))}return p?(async()=>{for(let m of p){let f=await m;if(typeof f=="string")return f}return null})():null},l=t.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=t.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let i=function(a,l,d){let c,u;for(let p=0,m=t.length;p<m;p++){let f=t[p];f.requiresSiblings&&d&&(l||(l=ur(a)),c||(c=l.substr(0,l.length-Kb(a).length)));let g=f(a,l,c,d);if(typeof g=="string")return g;Rv(g)&&(u||(u=[]),u.push(g))}return u?(async()=>{for(let p of u){let m=await p;if(typeof m=="string")return m}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(i.allBasenames=r.allBasenames);let s=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function h5(o,e,t){if(e===!1)return Gs;let n=IL(o,t);if(n===Gs)return Gs;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let r=(s,a,l,d)=>{if(!d||!n(s,a))return null;let c=i.replace("$(basename)",()=>l),u=d(c);return Rv(u)?u.then(p=>p?o:null):u?o:null};return r.requiresSiblings=!0,r}}return n}function ON(o,e){let t=o.filter(a=>!!a.basenames);if(t.length<2)return o;let n=t.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),i;if(e){i=[];for(let a=0,l=n.length;a<l;a++)i.push(e)}else i=t.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let r=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=n.indexOf(l);return d!==-1?i[d]:null};r.basenames=n,r.patterns=i,r.allBasenames=n;let s=o.filter(a=>!a.basenames);return s.push(r),s}var Eg=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new L;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Ce(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new CL(this,e,t);return this._factories.set(e,n),Ce(()=>{let i=this._factories.get(e);!i||i!==n||(this._factories.delete(e),i.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},CL=class extends V{constructor(t,n,i){super();this._registry=t;this._languageId=n;this._factory=i}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}};function oo(o){let e=0,t=0,n=0,i=0;for(let r=0,s=o.length;r<s;r++){let a=o.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<s&&o.charCodeAt(r+1)===10?(i|=2,r++):i|=3,n=r+1):a===10&&(i|=1,e===0&&(t=r),e++,n=r+1)}return e===0&&(t=o.length),[e,t,o.length-n,i]}var SL=class o{constructor(e){this._tokenInfo=e}static create(e){return new o(e)}forEach(e){let t=0;for(let n of this._tokenInfo){let i=new wt(t,t+n.length);e(i,n),t+=n.length}}slice(e){let t=[],n=0;for(let i of this._tokenInfo){let r=n,s=r+i.length;if(s>e.start){if(r>=e.endExclusive)break;let a=Math.max(0,e.start-r),l=Math.max(0,s-e.endExclusive);t.push(new By(i.length-a-l,i.metadata))}n+=i.length}return o.create(t)}},By=class{constructor(e,t){this.length=e;this.metadata=t}},Wy=class{_tokens=[];add(e,t){this._tokens.push(new By(e,t))}build(){return SL.create(this._tokens)}};var en=class o{static createEmpty(e,t){let n=o.defaultTokenMetadata,i=new Uint32Array(2);return i[0]=e.length,i[1]=n,new o(i,e,t)}static createFromTextAndMetadata(e,t){let n=0,i="",r=new Array;for(let{text:s,metadata:a}of e)r.push(n+s.length,a),n+=s.length,i+=s;return new o(new Uint32Array(r),i,t)}static convertToEndOffset(e,t){let i=(e.length>>>1)-1;for(let r=0;r<i;r++)e[r<<1]=e[r+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){let r=n+Math.floor((i-n)/2),s=e[r<<1];if(s===t)return r+1;s<t?n=r+1:s>t&&(i=r)}return n}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(e,t,n){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=n}equals(e){return e instanceof o?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,n){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;let i=t<<1,r=i+(n<<1);for(let s=i;s<r;s++)if(this._tokens[s]!==e._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){let t=this._tokens[(e<<1)+1],n=Lo.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(n)}getStandardTokenType(e){let t=this._tokens[(e<<1)+1];return Lo.getTokenType(t)}getForeground(e){let t=this._tokens[(e<<1)+1];return Lo.getForeground(t)}getClassName(e){let t=this._tokens[(e<<1)+1];return Lo.getClassNameFromMetadata(t)}getInlineStyle(e,t){let n=this._tokens[(e<<1)+1];return Lo.getInlineStyleFromMetadata(n,t)}getPresentation(e){let t=this._tokens[(e<<1)+1];return Lo.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return o.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new xL(this,e,t,n)}withInserted(e){if(e.length===0)return this;let t=0,n=0,i="",r=new Array,s=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=n<e.length?e[n]:null;if(a!==-1&&(l===null||a<=l.offset)){i+=this._text.substring(s,a);let d=this._tokens[(t<<1)+1];r.push(i.length,d),t++,s=a}else if(l){if(l.offset>s){i+=this._text.substring(s,l.offset);let d=this._tokens[(t<<1)+1];r.push(i.length,d),s=l.offset}i+=l.text,r.push(i.length,l.tokenMetadata),n++}else break}return new o(new Uint32Array(r),i,this.languageIdCodec)}getTokensInRange(e){let t=new Wy,n=this.findTokenIndexAtOffset(e.start),i=this.findTokenIndexAtOffset(e.endExclusive);for(let r=n;r<=i;r++){let a=new wt(this.getStartOffset(r),this.getEndOffset(r)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(r))}return t.build()}getTokenText(e){let t=this.getStartOffset(e),n=this.getEndOffset(e);return this._text.substring(t,n)}forEach(e){let t=this.getCount();for(let n=0;n<t;n++)e(n)}},xL=class o{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let r=this._firstTokenIndex,s=e.getCount();r<s&&!(e.getStartOffset(r)>=n);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof o?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){let t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){let t=this._firstTokenIndex+e,n=this._source.getStartOffset(t),i=this._source.getEndOffset(t),r=this._source.getTokenText(t);return n<this._startOffset&&(r=r.substring(this._startOffset-n)),i>this._endOffset&&(r=r.substring(0,r.length-(i-this._endOffset))),r}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}};var $s=new Uint32Array(0).buffer,Vn=class o{static deleteBeginning(e,t){return e===null||e===$s?e:o.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===$s)return e;let n=js(e),i=n[n.length-2];return o.delete(e,t,i)}static delete(e,t,n){if(e===null||e===$s||t===n)return e;let i=js(e),r=i.length>>>1;if(t===0&&i[i.length-2]===n)return $s;let s=en.findIndexInTokensArray(i,t),a=s>0?i[s-1<<1]:0,l=i[s<<1];if(n<l){let m=n-t;for(let f=s;f<r;f++)i[f<<1]-=m;return e}let d,c;a!==t?(i[s<<1]=t,d=s+1<<1,c=t):(d=s<<1,c=a);let u=n-t;for(let m=s+1;m<r;m++){let f=i[m<<1]-u;f>c&&(i[d++]=f,i[d++]=i[(m<<1)+1],c=f)}if(d===i.length)return e;let p=new Uint32Array(d);return p.set(i.subarray(0,d),0),p.buffer}static append(e,t){if(t===$s)return e;if(e===$s)return t;if(e===null)return e;if(t===null)return null;let n=js(e),i=js(t),r=i.length>>>1,s=new Uint32Array(n.length+i.length);s.set(n,0);let a=n.length,l=n[n.length-2];for(let d=0;d<r;d++)s[a++]=i[d<<1]+l,s[a++]=i[(d<<1)+1];return s.buffer}static insert(e,t,n){if(e===null||e===$s)return e;let i=js(e),r=i.length>>>1,s=en.findIndexInTokensArray(i,t);s>0&&i[s-1<<1]===t&&s--;for(let a=s;a<r;a++)i[a<<1]+=n;return e}};function js(o){return o instanceof Uint32Array?o:new Uint32Array(o)}var wg=class o{static deserialize(e,t,n){let i=new Uint32Array(e.buffer),r=Bn(e,t);t+=4;let s=Bn(e,t);t+=4;let a=[];for(let l=0;l<s;l++){let d=Bn(e,t);t+=4,a.push(i.subarray(t/4,t/4+d/4)),t+=d}return n.push(new o(r,a)),t}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineRange(){return new Ci(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}serializeSize(){let e=0;e+=4,e+=4;for(let t=0;t<this._tokens.length;t++){let n=this._tokens[t];if(!(n instanceof Uint32Array))throw new Error("Not supported!");e+=4,e+=n.byteLength}return e}serialize(e,t){Wn(e,this._startLineNumber,t),t+=4,Wn(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++){let i=this._tokens[n];if(!(i instanceof Uint32Array))throw new Error("Not supported!");Wn(e,i.byteLength,t),t+=4,e.set(new Uint8Array(i.buffer),t),t+=i.byteLength}return t}applyEdit(e,t){let[n,i]=oo(t);this._acceptDeleteRange(e),this._acceptInsertText(new M(e.startLineNumber,e.startColumn),n,i)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;let t=e.startLineNumber-this._startLineNumber,n=e.endLineNumber-this._startLineNumber;if(n<0){let i=n-t;this._startLineNumber-=i;return}if(!(t>=this._tokens.length)){if(t<0&&n>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(t===n){this._tokens[t]=Vn.delete(this._tokens[t],e.startColumn-1,e.endColumn-1);return}if(t>=0)if(this._tokens[t]=Vn.deleteEnding(this._tokens[t],e.startColumn-1),n<this._tokens.length){let i=Vn.deleteBeginning(this._tokens[n],e.endColumn-1);this._tokens[t]=Vn.append(this._tokens[t],i),this._tokens.splice(t+1,n-t)}else this._tokens[t]=Vn.append(this._tokens[t],null),this._tokens=this._tokens.slice(0,t+1);else{let i=-t;this._startLineNumber-=i,this._tokens[n]=Vn.deleteBeginning(this._tokens[n],e.endColumn-1),this._tokens=this._tokens.slice(n)}}}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-this._startLineNumber;if(i<0){this._startLineNumber+=t;return}if(!(i>=this._tokens.length)){if(t===0){this._tokens[i]=Vn.insert(this._tokens[i],e.column-1,n);return}this._tokens[i]=Vn.deleteEnding(this._tokens[i],e.column-1),this._tokens[i]=Vn.insert(this._tokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._tokens=_s(this._tokens,e,n)}};var Vy=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(Vy||{});(a=>{let o="error",e="warning",t="warn",n="info",i="ignore";function r(l){return l?qt(o,l)?3:qt(e,l)||qt(t,l)?2:qt(n,l)?1:0:0}a.fromValue=r;function s(l){switch(l){case 3:return o;case 2:return e;case 1:return n;default:return i}}a.toString=s})(Vy||={});var Do=Vy;var FN=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var Jn=class{value;_lower;constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){let n=typeof e=="string"?e:e.value,i=typeof t=="string"?t:t.value;return qt(n,i)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}},Tg=class{_set=new Set;get size(){return this._set.size}constructor(e){if(e)for(let t of e)this.add(t)}add(e){this._set.add(Jn.toKey(e))}delete(e){return this._set.delete(Jn.toKey(e))}has(e){return this._set.has(Jn.toKey(e))}},Lg=class{_map=new Map;clear(){this._map.clear()}delete(e){this._map.delete(Jn.toKey(e))}get(e){return this._map.get(Jn.toKey(e))}has(e){return this._map.has(Jn.toKey(e))}set(e,t){this._map.set(Jn.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}};var yne=j("IBuiltinExtensionsScannerService");var Dg=(i=>(i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error",i))(Dg||{});(r=>{function o(s,a){return a-s}r.compare=o;let e=Object.create(null);e[8]=h("sev.error","Error"),e[4]=h("sev.warning","Warning"),e[2]=h("sev.info","Info");function t(s){return e[s]||""}r.toString=t;function n(s){switch(s){case Do.Error:return 8;case Do.Warning:return 4;case Do.Info:return 2;case Do.Ignore:return 1}}r.fromSeverity=n;function i(s){switch(s){case 8:return Do.Error;case 4:return Do.Warning;case 2:return Do.Info;case 1:return Do.Ignore}}r.toSeverity=i})(Dg||={});var b5;(n=>{let o="";function e(i){return t(i,!0)}n.makeKey=e;function t(i,r){let s=[o];return i.source?s.push(i.source.replace("\xA6","\\\xA6")):s.push(o),i.code?typeof i.code=="string"?s.push(i.code.replace("\xA6","\\\xA6")):s.push(i.code.value.replace("\xA6","\\\xA6")):s.push(o),i.severity!==void 0&&i.severity!==null?s.push(Dg.toString(i.severity)):s.push(o),i.message&&r?s.push(i.message.replace("\xA6","\\\xA6")):s.push(o),i.startLineNumber!==void 0&&i.startLineNumber!==null?s.push(i.startLineNumber.toString()):s.push(o),i.startColumn!==void 0&&i.startColumn!==null?s.push(i.startColumn.toString()):s.push(o),i.endLineNumber!==void 0&&i.endLineNumber!==null?s.push(i.endLineNumber.toString()):s.push(o),i.endColumn!==void 0&&i.endColumn!==null?s.push(i.endColumn.toString()):s.push(o),s.push(o),s.join("\xA6")}n.makeKeyOptionalMessage=t})(b5||={});var BN=j("markerService");var Hy=class{constructor(e,t){this.tokens=e;this.endState=t}_encodedTokenizationResultBrand=void 0};var np;(i=>{let o=new Map;o.set(0,ue.symbolMethod),o.set(1,ue.symbolFunction),o.set(2,ue.symbolConstructor),o.set(3,ue.symbolField),o.set(4,ue.symbolVariable),o.set(5,ue.symbolClass),o.set(6,ue.symbolStruct),o.set(7,ue.symbolInterface),o.set(8,ue.symbolModule),o.set(9,ue.symbolProperty),o.set(10,ue.symbolEvent),o.set(11,ue.symbolOperator),o.set(12,ue.symbolUnit),o.set(13,ue.symbolValue),o.set(15,ue.symbolEnum),o.set(14,ue.symbolConstant),o.set(15,ue.symbolEnum),o.set(16,ue.symbolEnumMember),o.set(17,ue.symbolKeyword),o.set(27,ue.symbolSnippet),o.set(18,ue.symbolText),o.set(19,ue.symbolColor),o.set(20,ue.symbolFile),o.set(21,ue.symbolReference),o.set(22,ue.symbolCustomColor),o.set(23,ue.symbolFolder),o.set(24,ue.symbolTypeParameter),o.set(25,ue.account),o.set(26,ue.issues);function e(r){let s=o.get(r);return s||(console.info("No codicon found for CompletionItemKind "+r),s=ue.symbolProperty),s}i.toIcon=e;let t=new Map;t.set("method",0),t.set("function",1),t.set("constructor",2),t.set("field",3),t.set("variable",4),t.set("class",5),t.set("struct",6),t.set("interface",7),t.set("module",8),t.set("property",9),t.set("event",10),t.set("operator",11),t.set("unit",12),t.set("value",13),t.set("constant",14),t.set("enum",15),t.set("enum-member",16),t.set("enumMember",16),t.set("keyword",17),t.set("snippet",27),t.set("text",18),t.set("color",19),t.set("file",20),t.set("reference",21),t.set("customcolor",22),t.set("folder",23),t.set("type-parameter",24),t.set("typeParameter",24),t.set("account",25),t.set("issue",26);function n(r,s){let a=t.get(r);return typeof a>"u"&&!s&&(a=9),a}i.fromString=n})(np||={});var vie={17:h("Array","array"),16:h("Boolean","boolean"),4:h("Class","class"),13:h("Constant","constant"),8:h("Constructor","constructor"),9:h("Enum","enumeration"),21:h("EnumMember","enumeration member"),23:h("Event","event"),7:h("Field","field"),0:h("File","file"),11:h("Function","function"),10:h("Interface","interface"),19:h("Key","key"),5:h("Method","method"),1:h("Module","module"),2:h("Namespace","namespace"),20:h("Null","null"),15:h("Number","number"),18:h("Object","object"),24:h("Operator","operator"),3:h("Package","package"),6:h("Property","property"),14:h("String","string"),22:h("Struct","struct"),25:h("TypeParameter","type parameter"),12:h("Variable","variable")};var v5;(t=>{let o=new Map;o.set(0,ue.symbolFile),o.set(1,ue.symbolModule),o.set(2,ue.symbolNamespace),o.set(3,ue.symbolPackage),o.set(4,ue.symbolClass),o.set(5,ue.symbolMethod),o.set(6,ue.symbolProperty),o.set(7,ue.symbolField),o.set(8,ue.symbolConstructor),o.set(9,ue.symbolEnum),o.set(10,ue.symbolInterface),o.set(11,ue.symbolFunction),o.set(12,ue.symbolVariable),o.set(13,ue.symbolConstant),o.set(14,ue.symbolString),o.set(15,ue.symbolNumber),o.set(16,ue.symbolBoolean),o.set(17,ue.symbolArray),o.set(18,ue.symbolObject),o.set(19,ue.symbolKey),o.set(20,ue.symbolNull),o.set(21,ue.symbolEnumMember),o.set(22,ue.symbolStruct),o.set(23,ue.symbolEvent),o.set(24,ue.symbolOperator),o.set(25,ue.symbolTypeParameter);function e(n){let i=o.get(n);return i||(console.info("No codicon found for SymbolKind "+n),i=ue.symbolProperty),i}t.toIcon=e})(v5||={});var WN=class o{constructor(e){this.value=e}static Comment=new o("comment");static Imports=new o("imports");static Region=new o("region");static fromValue(e){switch(e){case"comment":return o.Comment;case"imports":return o.Imports;case"region":return o.Region}return new o(e)}};var y5;(e=>{function o(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}e.is=o})(y5||={});var ro=new Eg,kg=new Eg;var Hi=j("languageService");function Ys(o,e){let t=o.getCount(),n=o.findTokenIndexAtOffset(e),i=o.getLanguageId(n),r=n;for(;r+1<t&&o.getLanguageId(r+1)===i;)r++;let s=n;for(;s>0&&o.getLanguageId(s-1)===i;)s--;return new EL(o,i,s,r+1,o.getStartOffset(s),o.getEndOffset(r))}var EL=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(e,t,n,i,r,s){this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=r,this._lastCharOffset=s,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},VN=(e=>(e[e.value=3]="value",e))(VN||{});function vr(o){return(o&VN.value)!==0}var ip=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(e){if(this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;let n=e.findTokenIndexAtOffset(t-2),i=e.getStandardTokenType(n);return this.isOK(i)}_findNeutralCharacterInRange(e,t){for(let n=e;n<=t;n++){let i=String.fromCharCode(n);if(!this.open.includes(i)&&!this.close.includes(i))return i}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},Uy=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let t of e)Rg(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),Rg(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),Rg(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),Rg(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&Rg(this.autoClosingPairsCloseSingleChar,t.close,t)}};function Rg(o,e,t){o.has(e)?o.get(e).push(t):o.set(e,[t])}var wL=class o{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(e,t,n,i,r,s){this.languageId=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=r,this.reversedRegex=s,this._openSet=o._toSet(this.open),this._closeSet=o._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){let t=new Set;for(let n of e)t.add(n);return t}};function C5(o){let e=o.length;o=o.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let t=[];for(let s=0;s<e;s++)t[s]=s;let n=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},i=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<e;c++)t[c]===d&&(t[c]=l)};for(let s=0;s<e;s++){let a=o[s];for(let l=s+1;l<e;l++){let d=o[l];n(a,d)&&i(t[s],t[l])}}let r=[];for(let s=0;s<e;s++){let a=[],l=[];for(let d=0;d<e;d++)if(t[d]===s){let[c,u]=o[d];a.push(c),l.push(u)}a.length>0&&r.push({open:a,close:l})}return r}var zy=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(e,t){let n=C5(t);this.brackets=n.map((i,r)=>new wL(e,r,i.open,i.close,S5(i.open,i.close,n,r),x5(i.open,i.close,n,r))),this.forwardRegex=_5(this.brackets),this.reversedRegex=E5(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let i of this.brackets){for(let r of i.open)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(let r of i.close)this.textIsBracket[r]=i,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}};function HN(o,e,t,n){for(let i=0,r=e.length;i<r;i++){if(i===t)continue;let s=e[i];for(let a of s.open)a.indexOf(o)>=0&&n.push(a);for(let a of s.close)a.indexOf(o)>=0&&n.push(a)}}function UN(o,e){return o.length-e.length}function Ky(o){if(o.length<=1)return o;let e=[],t=new Set;for(let n of o)t.has(n)||(e.push(n),t.add(n));return e}function S5(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)HN(i[r],t,n,i);return i=Ky(i),i.sort(UN),i.reverse(),op(i)}function x5(o,e,t,n){let i=[];i=i.concat(o),i=i.concat(e);for(let r=0,s=i.length;r<s;r++)HN(i[r],t,n,i);return i=Ky(i),i.sort(UN),i.reverse(),op(i.map(TL))}function _5(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=Ky(e),op(e)}function E5(o){let e=[];for(let t of o){for(let n of t.open)e.push(n);for(let n of t.close)e.push(n)}return e=Ky(e),op(e.map(TL))}function w5(o){let e=/^[\w ]+$/.test(o);return o=Ni(o),e?`\\b${o}\\b`:o}function op(o,e){let t=`(${o.map(w5).join(")|(")})`;return hv(t,!0,e)}var TL=function(){function o(n){let i=new Uint16Array(n.length),r=0;for(let s=n.length-1;s>=0;s--)i[r++]=n.charCodeAt(s);return fL().decode(i)}let e=null,t=null;return function(i){return e!==i&&(e=i,t=o(e)),t}}(),Ui=class{static _findPrevBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=n.length-(r.index||0),a=r[0].length,l=i+s;return new w(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,n,i,r){let a=TL(n).substring(n.length-r,n.length-i);return this._findPrevBracketInText(e,t,a,i)}static findNextBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let s=r.index||0,a=r[0].length;if(a===0)return null;let l=i+s;return new w(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,n,i,r){let s=n.substring(i,r);return this.findNextBracketInText(e,t,s,i)}};var Gy=class{constructor(e,t){this.languageId=e;let n=t.brackets?zN(t.brackets):[],i=new Dm(a=>{let l=new Set;return{info:new LL(this,a,l),closing:l}}),r=new Dm(a=>{let l=new Set,d=new Set;return{info:new DL(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of n){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=t.colorizedBracketPairs?zN(t.colorizedBracketPairs):n.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=i.get(a),c=r.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...i.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){let t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return op(t,e)}};function zN(o){return o.filter(([e,t])=>e!==""&&t!=="")}var $y=class{constructor(e,t){this.config=e;this.bracketText=t}get languageId(){return this.config.languageId}},LL=class extends $y{constructor(t,n,i){super(t,n);this.openedBrackets=i}isOpeningBracket=!0},DL=class extends $y{constructor(t,n,i,r){super(t,n);this.openingBrackets=i;this.openingColorizedBrackets=r}isOpeningBracket=!1;closes(t){return t.config!==this.config?!1:this.openingBrackets.has(t)}closesColorized(t){return t.config!==this.config?!1:this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}};var Ct=class o{static _nextVisibleColumn(e,t,n){return e===9?o.nextRenderTabStop(t,n):Yo(e)||Om(e)?t+2:t+1}static visibleColumnFromColumn(e,t,n){let i=Math.min(t-1,e.length),r=e.substring(0,i),s=new Bd(r),a=0;for(;!s.eol();){let l=wu(r,i,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,n)}return a}static toStatusbarColumn(e,t,n){let i=e.substring(0,Math.min(t-1,e.length)),r=new Fd(i),s=0;for(;!r.eol();)r.nextCodePoint()===9?s=o.nextRenderTabStop(s,n):s=s+1;return s+1}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;let i=e.length,r=new Bd(e),s=0,a=1;for(;!r.eol();){let l=wu(e,i,r.offset);r.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,n),c=r.offset+1;if(d>=t){let u=t-s;return d-t<u?c:a}s=d,a=c}return i+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}};function KN(o,e,t,n){return o!==t?Ft(t-o,n):Ft(0,n-e)}var fn=0;function rp(o){return o===0}var ko=2**26;function Ft(o,e){return o*ko+e}function xi(o){let e=o,t=Math.floor(e/ko),n=e-t*ko;return new Si(t,n)}function GN(o){return Math.floor(o/ko)}function ft(o,e){let t=o+e;return e>=ko&&(t=t-o%ko),t}function $N(o,e){return o.reduce((t,n)=>ft(t,e(n)),fn)}function kL(o,e){return o===e}function gc(o,e){let t=o,n=e;if(n-t<=0)return fn;let r=Math.floor(t/ko),s=Math.floor(n/ko),a=n-s*ko;if(r===s){let l=t-r*ko;return Ft(0,a-l)}else return Ft(s-r,a)}function za(o,e){return o<e}function Ql(o,e){return o<=e}function sp(o,e){return o>=e}function Jl(o){return Ft(o.lineNumber-1,o.column-1)}function ed(o,e){let t=o,n=Math.floor(t/ko),i=t-n*ko,r=e,s=Math.floor(r/ko),a=r-s*ko;return new w(n+1,i+1,s+1,a+1)}function jN(o){let e=Nr(o);return Ft(e.length-1,e[e.length-1].length)}var jy=[],ei=class o{constructor(e,t){this.items=e;this.additionalItems=t}static cache=new Array(129);static create(e,t){if(e<=128&&t.length===0){let n=o.cache[e];return n||(n=new o(e,t),o.cache[e]=n),n}return new o(e,t)}static empty=o.create(0,jy);static getEmpty(){return this.empty}add(e,t){let n=t.getKey(e),i=n>>5;if(i===0){let s=1<<n|this.items;return s===this.items?this:o.create(s,this.additionalItems)}i--;let r=this.additionalItems.slice(0);for(;r.length<i;)r.push(0);return r[i]|=1<<(n&31),o.create(this.items,r)}has(e,t){let n=t.getKey(e),i=n>>5;return i===0?(this.items&1<<n)!==0:(i--,((this.additionalItems[i]||0)&1<<(n&31))!==0)}merge(e){let t=this.items|e.items;if(this.additionalItems===jy&&e.additionalItems===jy)return t===this.items?this:t===e.items?e:o.create(t,jy);let n=[];for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){let r=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(r|s)}return o.create(t,n)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}equals(e){if(this.items!==e.items||this.additionalItems.length!==e.additionalItems.length)return!1;for(let t=0;t<this.additionalItems.length;t++)if(this.additionalItems[t]!==e.additionalItems[t])return!1;return!0}},RL={getKey(o){return o}},ap=class{items=new Map;getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}reverseLookup(e){return[...this.items].find(([t,n])=>n===e)?.[0]}reverseLookupSet(e){let t=[];for(let[n]of this.items)e.has(n,this)&&t.push(n);return t}keys(){return this.items.keys()}};var qy=class o{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new ip(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new ip({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){let t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new ip({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:o.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var Yy=class{_richEditBrackets;constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(let t of this._richEditBrackets.brackets)for(let n of t.close){let i=n.charAt(n.length-1);e.push(i)}return dr(e)}onElectricCharacter(e,t,n){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let i=t.findTokenIndexAtOffset(n-1);if(vr(t.getStandardTokenType(i)))return null;let r=this._richEditBrackets.reversedRegex,s=t.getLineContent().substring(0,n-1)+e,a=Ui.findPrevBracketInRange(r,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function Xy(o){return o.global&&(o.lastIndex=0),!0}var Zy=class{_indentationRules;constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&Xy(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&Xy(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&Xy(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&Xy(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}};var Qy=class o{_brackets;_regExpRules;constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{let n=o._createOpenBracketRegExp(t[0]),i=o._createCloseBracketRegExp(t[1]);n&&i&&this._brackets.push({open:t[0],openRegExp:n,close:t[1],closeRegExp:i})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let r=0,s=this._regExpRules.length;r<s;r++){let a=this._regExpRules[r];if([{reg:a.beforeText,text:n},{reg:a.afterText,text:i},{reg:a.previousLineText,text:t}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(e>=2&&n.length>0&&i.length>0)for(let r=0,s=this._brackets.length;r<s;r++){let a=this._brackets[r];if(a.openRegExp.test(n)&&a.closeRegExp.test(i))return{indentAction:2}}if(e>=2&&n.length>0){for(let r=0,s=this._brackets.length;r<s;r++)if(this._brackets[r].openRegExp.test(n))return{indentAction:1}}return null}static _createOpenBracketRegExp(e){let t=Ni(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",o._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Ni(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,o._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return We(t),null}}};var T5=[];function Cn(o,e,t){e instanceof ag||(e=new ag(e,[],!!t)),T5.push([o,e])}var fc=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});var L5={ModesRegistry:"editor.modesRegistry"},PL=class{_languages;_onDidChangeLanguages=new L;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}},YN=new PL;et.add(L5.ModesRegistry,YN);var ir="plaintext",D5=".txt";YN.registerLanguage({id:ir,extensions:[D5],aliases:[h("plainText.alias","Plain Text"),"text"],mimetypes:[fc.text]});et.as(nr.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var Pg=class{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}},Dn=j("languageConfigurationService"),Mg=class extends V{constructor(t,n){super();this.configurationService=t;this.languageService=n;let i=new Set(Object.values(NL));this._register(this.configurationService.onDidChangeConfiguration(r=>{let s=r.change.keys.some(l=>i.has(l)),a=r.change.overrides.filter(([l,d])=>d.some(c=>i.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new Pg(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new Pg(l)))})),this._register(this._registry.onDidChange(r=>{this.configurations.delete(r.languageId),this.onDidChangeEmitter.fire(new Pg(r.languageId))}))}_serviceBrand;_registry=this._register(new AL);onDidChangeEmitter=this._register(new L);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(t,n,i){return this._registry.register(t,n,i)}getLanguageConfiguration(t){let n=this.configurations.get(t);return n||(n=k5(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,n)),n}};Mg=K([D(0,Xt),D(1,Hi)],Mg);function k5(o,e,t,n){let i=e.getLanguageConfiguration(o);if(!i){if(!n.isRegisteredLanguageId(o))return new lp(o,{});i=new lp(o,{})}let r=R5(i.languageId,t),s=ZN([i.underlyingConfig,r]);return new lp(i.languageId,s)}var NL={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function R5(o,e){let t=e.getValue(NL.brackets,{overrideIdentifier:o}),n=e.getValue(NL.colorizedBracketPairs,{overrideIdentifier:o});return{brackets:XN(t),colorizedBracketPairs:XN(n)}}function XN(o){if(Array.isArray(o))return o.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function tI(o,e,t){let n=o.getLineContent(e),i=kt(n);return i.length>t-1&&(i=i.substring(0,t-1)),i}var OL=class{constructor(e){this.languageId=e;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(e,t){let n=new Jy(e,t,++this._order);return this._entries.push(n),this._resolved=null,Ce(()=>{for(let i=0;i<this._entries.length;i++)if(this._entries[i]===n){this._entries.splice(i,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let e=this._resolve();e&&(this._resolved=new lp(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(Jy.cmp),ZN(this._entries.map(e=>e.configuration)))}};function ZN(o){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let t of o)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}var Jy=class{constructor(e,t,n){this.configuration=e;this.priority=t;this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}},eI=class{constructor(e){this.languageId=e}},AL=class extends V{_entries=new Map;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(ir,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,n=0){let i=this._entries.get(e);i||(i=new OL(e),this._entries.set(e,i));let r=i.register(t,n);return this._onDidChange.fire(new eI(e)),Ce(()=>{r.dispose(),this._onDidChange.fire(new eI(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}},lp=class o{constructor(e,t){this.languageId=e;this.underlyingConfig=t;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Qy(this.underlyingConfig):null,this.comments=o._handleComments(this.underlyingConfig),this.characterPair=new qy(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||sy,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Zy(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new Gy(e,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return rg(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new zy(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new Yy(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}getAutoClosingPairs(){return new Uy(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[i,r]=t.blockComment;n.blockCommentStartToken=i,n.blockCommentEndToken=r}return n}};Cn(Dn,Mg,1);var FL=class o{constructor(e){this.map=e}static createFromLanguage(e,t){function n(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}let i=new Map;for(let r of e.bracketsNew.openingBrackets){let s=Ft(0,r.bracketText.length),a=n(r),l=ei.getEmpty().add(a,RL);i.set(r.bracketText,new Zr(s,1,a,l,Ng.create(s,r,l)))}for(let r of e.bracketsNew.closingBrackets){let s=Ft(0,r.bracketText.length),a=ei.getEmpty(),l=r.getOpeningBrackets();for(let d of l)a=a.add(n(d),RL);i.set(r.bracketText,new Zr(s,2,n(l[0]),a,Ng.create(s,r,a)))}return new o(i)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>M5(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(let[t,n]of this.map)if(n.kind===2&&n.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}};function M5(o){let e=Ni(o);return/^[\w ]+/.test(o)&&(e=`\\b${e}`),/[\w ]+$/.test(o)&&(e=`${e}\\b`),e}var dp=class{constructor(e,t){this.denseKeyProvider=e;this.getLanguageConfiguration=t}languageIdToBracketTokens=new Map;didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=FL.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}getToken(e,t){return this.getSingleLanguageBracketTokens(t).getToken(e)}};var Zr=class{constructor(e,t,n,i,r){this.length=e;this.kind=t;this.bracketId=n;this.bracketIds=i;this.astNode=r}},cp=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new BL(this.textModel,this.bracketTokens);_offset=fn;get offset(){return this._offset}get length(){return Ft(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(e){this.didPeek=!1,this._offset=ft(this._offset,e);let t=xi(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}didPeek=!1;peeked=null;read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=ft(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},BL=class{constructor(e,t){this.textModel=e;this.bracketTokens=t;this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let e=this.lineIdx,t=this.lineCharOffset,n=0;for(;;){let r=this.lineTokens,s=r.getCount(),a=null;if(this.lineTokenOffset<s){let l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=Lo.getTokenType(l)===0,c=Lo.containsBalancedBrackets(l),u=r.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let p=r.getLanguageId(this.lineTokenOffset),m=this.line.substring(this.lineCharOffset,u),f=this.bracketTokens.getSingleLanguageBracketTokens(p),g=f.regExpGlobal;if(g){g.lastIndex=0;let b=g.exec(m);b&&(a=f.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(n+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n+=33,n>1e3))break;if(n>1500)break}let i=KN(e,t,this.lineIdx,this.lineCharOffset);return new Zr(i,0,-1,ei.getEmpty(),new Qr(i))}},nI=class{constructor(e,t){this.text=e;let n=t.getRegExpStr(),i=n?new RegExp(n+`|
`,"gi"):null,r=[],s,a=0,l=0,d=0,c=0,u=[];for(let f=0;f<60;f++)u.push(new Zr(Ft(0,f),0,-1,ei.getEmpty(),new Qr(Ft(0,f))));let p=[];for(let f=0;f<60;f++)p.push(new Zr(Ft(1,f),0,-1,ei.getEmpty(),new Qr(Ft(1,f))));if(i)for(i.lastIndex=0;(s=i.exec(e))!==null;){let f=s.index,g=s[0];if(g===`
`)a++,l=f+1;else{if(d!==f){let b;if(c===a){let v=f-d;if(v<u.length)b=u[v];else{let I=Ft(0,v);b=new Zr(I,0,-1,ei.getEmpty(),new Qr(I))}}else{let v=a-c,I=f-l;if(v===1&&I<p.length)b=p[I];else{let C=Ft(v,I);b=new Zr(C,0,-1,ei.getEmpty(),new Qr(C))}}r.push(b)}r.push(t.getToken(g)),d=f+g.length,c=a}}let m=e.length;if(d!==m){let f=c===a?Ft(0,m-d):Ft(a-c,m-l);r.push(new Zr(f,0,-1,ei.getEmpty(),new Qr(f)))}this.length=Ft(a,m-l),this.tokens=r}_offset=fn;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new Rb}getText(){return this.text}};var Og=class{_length;get length(){return this._length}constructor(e){this._length=e}},Ag=class o extends Og{constructor(t,n,i,r,s){super(t);this.openingBracket=n;this.child=i;this.closingBracket=r;this.missingOpeningBracketIds=s}static create(t,n,i){let r=t.length;return n&&(r=ft(r,n.length)),i&&(r=ft(r,i.length)),new o(r,t,n,i,n?n.missingOpeningBracketIds:ei.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}canBeReused(t){return!(this.closingBracket===null||t.intersects(this.missingOpeningBracketIds))}flattenLists(){return o.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new o(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,n){return this.child?this.child.computeMinIndentation(ft(t,this.openingBracket.length),n):Number.MAX_SAFE_INTEGER}},Ro=class o extends Og{constructor(t,n,i){super(t);this.listHeight=n;this._missingOpeningBracketIds=i}static create23(t,n,i,r=!1){let s=t.length,a=t.missingOpeningBracketIds;if(t.listHeight!==n.listHeight)throw new Error("Invalid list heights");if(s=ft(s,n.length),a=a.merge(n.missingOpeningBracketIds),i){if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=ft(s,i.length),a=a.merge(i.missingOpeningBracketIds)}return r?new WL(s,t.listHeight+1,t,n,i,a):new Fg(s,t.listHeight+1,t,n,i,a)}static create(t,n=!1){if(t.length===0)return this.getEmpty();{let i=t[0].length,r=t[0].missingOpeningBracketIds;for(let s=1;s<t.length;s++)i=ft(i,t[s].length),r=r.merge(t[s].missingOpeningBracketIds);return n?new iI(i,t[0].listHeight+1,t,r):new Bg(i,t[0].listHeight+1,t,r)}}static getEmpty(){return new iI(fn,0,[],ei.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let t=this.childrenLength;if(t===0)return;let n=this.getChild(t-1),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(t-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let n=this.getChild(0),i=n.kind===4?n.toMutable():n;return n!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let n=this;for(;n.kind===4;){let i=n.childrenLength;if(i===0)throw new $e;n=n.getChild(i-1)}return n.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();let t=this.childrenLength,n=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let r=1;r<t;r++){let s=this.getChild(r);n=ft(n,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=n,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}flattenLists(){let t=[];for(let n of this.children){let i=n.flattenLists();i.kind===4?t.push(...i.children):t.push(i)}return o.create(t)}computeMinIndentation(t,n){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,r=t;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(i=Math.min(i,a.computeMinIndentation(r,n)),r=ft(r,a.length))}return this.cachedMinIndentation=i,i}},Fg=class o extends Ro{constructor(t,n,i,r,s,a){super(t,n,a);this._item1=i;this._item2=r;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,n){switch(t){case 0:this._item1=n;return;case 1:this._item2=n;return;case 2:this._item3=n;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new o(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}},WL=class extends Fg{toMutable(){return new Fg(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},Bg=class o extends Ro{constructor(t,n,i,r){super(t,n,r);this._children=i}get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,n){this._children[t]=n}get children(){return this._children}deepClone(){let t=new Array(this._children.length);for(let n=0;n<this._children.length;n++)t[n]=this._children[n].deepClone();return new o(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}},iI=class extends Bg{toMutable(){return new Bg(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},O5=[],Wg=class extends Og{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return O5}flattenLists(){return this}deepClone(){return this}},Qr=class extends Wg{get kind(){return 0}get missingOpeningBracketIds(){return ei.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){let n=xi(e),i=(n.columnCount===0?n.lineCount:n.lineCount+1)+1,r=GN(ft(e,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=i;a<=r;a++){let l=t.getLineFirstNonWhitespaceColumn(a),d=t.getLineContent(a);if(l===0)continue;let c=Ct.visibleColumnFromColumn(d,l,t.getOptions().tabSize);s=Math.min(s,c)}return s}},Ng=class o extends Wg{constructor(t,n,i){super(t);this.bracketInfo=n;this.bracketIds=i}static create(t,n,i){return new o(t,n,i)}get kind(){return 1}get missingOpeningBracketIds(){return ei.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,n){return Number.MAX_SAFE_INTEGER}},oI=class extends Wg{get kind(){return 3}missingOpeningBracketIds;constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}};var Vg=class{constructor(e,t,n,i){this.range=e;this.nestingLevel=t;this.nestingLevelOfEqualBracketType=n;this.isInvalid=i}},VL=class{constructor(e,t,n,i,r,s){this.range=e;this.openingBracketRange=t;this.closingBracketRange=n;this.nestingLevel=i;this.nestingLevelOfEqualBracketType=r;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},rI=class extends VL{constructor(t,n,i,r,s,a,l){super(t,n,i,r,s,a);this.minVisibleColumnIndentation=l}};var sI=class{changeType=1},so=class o{constructor(e,t,n,i,r){this.ownerId=e;this.lineNumber=t;this.column=n;this.options=i;this.order=r}static applyInjectedText(e,t){if(!t||t.length===0)return e;let n="",i=0;for(let r of t)n+=e.substring(i,r.column-1),i=r.column-1,n+=r.options.content;return n+=e.substring(i),n}static fromDecorations(e){let t=[];for(let n of e)n.options.before&&n.options.before.content.length>0&&t.push(new o(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new o(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((n,i)=>n.lineNumber===i.lineNumber?n.column===i.column?n.order-i.order:n.column-i.column:n.lineNumber-i.lineNumber),t}withText(e){return new o(this.ownerId,this.lineNumber,this.column,{...this.options,content:e},this.order)}},Hg=class{changeType=2;lineNumber;detail;injectedText;constructor(e,t,n){this.lineNumber=e,this.detail=t,this.injectedText=n}},aI=class{changeType=3;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},lI=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(e,t,n,i){this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}},dI=class{changeType=5},bc=class o{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.versionId,r=e.isUndoing||t.isUndoing,s=e.isRedoing||t.isRedoing;return new o(n,i,r,s)}},up=class{changes;constructor(e){this.changes=e}},td=class o{constructor(e,t){this.rawContentChangedEvent=e;this.contentChangedEvent=t}merge(e){let t=bc.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=o._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new o(t,n)}static _mergeChangeEvents(e,t){let n=[].concat(e.changes).concat(t.changes),i=t.eol,r=t.versionId,s=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,d=e.isEolChange&&t.isEolChange;return{changes:n,eol:i,isEolChange:d,versionId:r,isUndoing:s,isRedoing:a,isFlush:l}}};var yr=class{constructor(e,t,n,i,r,s){this.visibleColumn=e;this.column=t;this.className=n;this.horizontalLine=i;this.forWrappedLinesAfterColumn=r;this.forWrappedLinesBeforeOrAtColumn=s;if(e!==-1==(t!==-1))throw new Error}},Ka=class{constructor(e,t){this.top=e;this.endColumn=t}};var Ug=class o{constructor(e){this.edits=e;let t=-1;for(let n of e){if(!(n.replaceRange.start>=t))throw new $e(`Edits must be disjoint and sorted. Found ${n} after ${t}`);t=n.replaceRange.endExclusive}}static empty=new o([]);static fromJson(e){return new o(e.map(Jr.fromJson))}static replace(e,t){return new o([new Jr(e,t)])}static insert(e,t){return o.replace(wt.emptyAt(e),t)}normalize(){let e=[],t;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(t&&t.replaceRange.endExclusive===n.replaceRange.start?t=new Jr(t.replaceRange.join(n.replaceRange),t.newText+n.newText):(t&&e.push(t),t=n));return t&&e.push(t),new o(e)}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],n=0;for(let i of this.edits)t.push(e.substring(n,i.replaceRange.start)),t.push(i.newText),n=i.replaceRange.endExclusive;return t.push(e.substring(n)),t.join("")}compose(e){return F5(this,e)}inverse(e){let t=[],n=0;for(let i of this.edits)t.push(new Jr(wt.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new o(t)}getNewTextRanges(){let e=[],t=0;for(let n of this.edits)e.push(wt.ofStartAndLength(n.replaceRange.start+t,n.newText.length)),t+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],n=0,i=0,r=0;for(;i<this.edits.length||n<e.edits.length;){let s=e.edits[n],a=this.edits[i];if(a)s?a.replaceRange.intersects(s.replaceRange)?i++:a.replaceRange.start<s.replaceRange.start?(t.push(new Jr(a.replaceRange.delta(r),a.newText)),i++):(n++,r+=s.newText.length-s.replaceRange.length):(t.push(new Jr(a.replaceRange.delta(r),a.newText)),i++);else break}return new o(t)}applyToOffset(e){let t=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+t;t+=n.newText.length-n.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new wt(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let t=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-t){if(e-t<n.replaceRange.start+i)return n.replaceRange.start;t+=i-n.replaceRange.length}else break}return e-t}},Jr=class o{constructor(e,t){this.replaceRange=e;this.newText=t}static fromJson(e){return new o(wt.ofStartAndLength(e.pos,e.len),e.txt)}static insert(e,t){return new o(wt.emptyAt(e),t)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function F5(o,e){if(o=o.normalize(),e=e.normalize(),o.isEmpty)return e;if(e.isEmpty)return o;let t=[...o.edits],n=[],i=0;for(let r of e.edits){for(;;){let d=t[0];if(!d||d.replaceRange.start+i+d.newText.length>=r.replaceRange.start)break;t.shift(),n.push(d),i+=d.newText.length-d.replaceRange.length}let s=i,a,l;for(;;){let d=t[0];if(!d||d.replaceRange.start+i>r.replaceRange.endExclusive)break;a||(a=d),l=d,t.shift(),i+=d.newText.length-d.replaceRange.length}if(!a)n.push(new Jr(r.replaceRange.delta(-i),r.newText));else{let d="",c=r.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+i-r.replaceRange.endExclusive;if(u>0){let f=new Jr(wt.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));t.unshift(f),i-=f.newText.length-f.replaceRange.length}let p=d+r.newText,m=new wt(Math.min(a.replaceRange.start,r.replaceRange.start-s),r.replaceRange.endExclusive-i);n.push(new Jr(m,p))}}for(;;){let r=t.shift();if(!r)break;n.push(r)}return new Ug(n).normalize()}var cI=class o{constructor(e,t){this.lineEdit=e;this.additionalLines=t}static replace(e,t){return new o(Ug.replace(e,t),null)}};var eO=j("undoRedoService");var QN=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o},JN=class o{static _ID=0;id;order;constructor(){this.id=o._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new o};var pp=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&cn(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}},nd=class{_findMatchBrand=void 0;range;matches;constructor(e,t){this.range=e,this.matches=t}};function tO(o){return o&&typeof o.read=="function"}var hp=class{constructor(e,t,n,i,r,s){this.identifier=e;this.range=t;this.text=n;this.forceMoveMarkers=i;this.isAutoWhitespaceEdit=r;this._isTracked=s}},uI=class{regex;wordSeparators;simpleSearch;constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},pI=class{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}};var zg={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var Ga=class{constructor(e,t,n,i,r){this.injectionOffsets=e;this.injectionOptions=t;this.breakOffsets=n;this.breakOffsetsVisibleColumn=i;this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){let t=e>0?this.breakOffsets[e-1]:0,i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&i>this.injectionOffsets[r];r++)i<this.injectionOffsets[r]+this.injectionOptions[r].content.length?i=this.injectionOffsets[r]:i-=this.injectionOptions[r].content.length;return i}translateToOutputPosition(e,t=2){let n=e;if(this.injectionOffsets!==null)for(let i=0;i<this.injectionOffsets.length&&!(e<this.injectionOffsets[i]||t!==1&&e===this.injectionOffsets[i]);i++)n+=this.injectionOptions[i].content.length;return this.offsetInInputWithInjectionsToOutputPosition(n,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let n=0,i=this.breakOffsets.length-1,r=0,s=0;for(;n<=i;){r=n+(i-n)/2|0;let l=this.breakOffsets[r];if(s=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=s)i=r-1;else if(e>l)n=r+1;else break;else if(e<s)i=r-1;else if(e>=l)n=r+1;else break}let a=e-s;return r>0&&(a+=this.wrappedTextIndentLength),new mp(r,a)}normalizeOutputPosition(e,t,n){if(this.injectionOffsets!==null){let i=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(i,n);if(r!==i)return this.offsetInInputWithInjectionsToOutputPosition(r,n)}if(n===0){if(e>0&&t===this.getMinOutputOffset(e))return new mp(e-1,this.getMaxOutputOffset(e-1))}else if(n===1){let i=this.getOutputLineCount()-1;if(e<i&&t===this.getMaxOutputOffset(e))return new mp(e+1,this.getMinOutputOffset(e+1))}return new mp(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){let n=this.getInjectedTextAtOffset(e);if(!n)return e;if(t===2){if(e===n.offsetInInputWithInjections+n.length&&nO(this.injectionOptions[n.injectedTextIndex].cursorStops))return n.offsetInInputWithInjections+n.length;{let i=n.offsetInInputWithInjections;if(iO(this.injectionOptions[n.injectedTextIndex].cursorStops))return i;let r=n.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[n.injectedTextIndex]&&!(nO(this.injectionOptions[r].cursorStops)||(i-=this.injectionOptions[r].content.length,iO(this.injectionOptions[r].cursorStops)));)r--;return i}}else if(t===1||t===4){let i=n.offsetInInputWithInjections+n.length,r=n.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)i+=this.injectionOptions[r+1].content.length,r++;return i}else if(t===0||t===3){let i=n.offsetInInputWithInjections,r=n.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)i-=this.injectionOptions[r-1].content.length,r--;return i}Md(t)}getInjectedText(e,t){let n=this.outputPositionToOffsetInInputWithInjections(e,t),i=this.getInjectedTextAtOffset(n);return i?{options:this.injectionOptions[i.injectedTextIndex]}:null}getInjectedTextAtOffset(e){let t=this.injectionOffsets,n=this.injectionOptions;if(t!==null){let i=0;for(let r=0;r<t.length;r++){let s=n[r].content.length,a=t[r]+i,l=t[r]+i+s;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:s};i+=s}}}};function nO(o){return o==null?!0:o===1||o===0}function iO(o){return o==null?!0:o===2||o===0}var mp=class{outputLineIndex;outputOffset;constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new M(e+this.outputLineIndex,this.outputOffset+1)}};function W5(o,e,t){let n=0;for(let r=0;r<o.length;r++)o.charAt(r)==="	"?n=Ct.nextIndentTabStop(n,e):n++;let i="";if(!t){let r=Math.floor(n/e);n=n%e;for(let s=0;s<r;s++)i+="	"}for(let r=0;r<n;r++)i+=" ";return i}function hI(o,e,t){let n=zt(o);return n===-1&&(n=o.length),W5(o.substring(0,n),e,t)+o.substring(n)}var V5=()=>!0,H5=()=>!1,U5=o=>o===" "||o==="	",$a=class{constructor(e,t,n,i){this.languageConfigurationService=i;this._languageId=e;let r=n.options,s=r.get(147),a=r.get(51);this.readOnly=r.get(93),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=r.get(130),this.wordSeparators=r.get(133),this.emptySelectionClipboard=r.get(38),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(78),this.multiCursorPaste=r.get(80),this.multiCursorLimit=r.get(81),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(e){return e.hasChanged(147)||e.hasChanged(133)||e.hasChanged(38)||e.hasChanged(78)||e.hasChanged(80)||e.hasChanged(81)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(130)||e.hasChanged(51)||e.hasChanged(93)||e.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(let t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,n){let i=Ys(t,n-1),r=this.languageConfigurationService.getLanguageConfiguration(i.languageId).electricCharacter;return r?r.onElectricCharacter(e,i,n-i.firstCharOffset):null}normalizeIndentation(e){return hI(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,n){switch(t){case"beforeWhitespace":return U5;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,n);case"always":return V5;case"never":return H5}}_getLanguageDefinedShouldAutoClose(e,t){let n=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return i=>n.indexOf(i)!==-1}visibleColumnFromColumn(e,t){return Ct.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,n){let i=Ct.columnFromVisibleColumn(e.getLineContent(t),n,this.tabSize),r=e.getLineMinColumn(t);if(i<r)return r;let s=e.getLineMaxColumn(t);return i>s?s:i}},Ke=class o{_cursorStateBrand=void 0;static fromModelState(e){return new UL(e)}static fromViewState(e){return new zL(e)}static fromModelSelection(e){let t=Me.liftSelection(e),n=new pn(w.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return o.fromModelState(n)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}modelState;viewState;constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}},UL=class{modelState;viewState;constructor(e){this.modelState=e,this.viewState=null}},zL=class{modelState;viewState;constructor(e){this.modelState=null,this.viewState=e}};var pn=class o{constructor(e,t,n,i,r){this.selectionStart=e;this.selectionStartKind=t;this.selectionStartLeftoverVisibleColumns=n;this.position=i;this.leftoverVisibleColumns=r;this.selection=o._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new o(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new M(t,n),i):new o(new w(t,n,t,n),0,i,new M(t,n),i)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?Me.fromPositions(e.getStartPosition(),t):Me.fromPositions(e.getEndPosition(),t)}},Sn=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(e,t,n){this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}};function es(o){return o==="'"||o==='"'||o==="`"}function rO(o){return`--vscode-${o.replace(/\./g,"-")}`}function ne(o){return`var(${rO(o)})`}function sO(o,e){return`var(${rO(o)}, ${e})`}function z5(o){return o!==null&&typeof o=="object"&&"light"in o&&"dark"in o}var K5={ColorContribution:"base.contributions.colors"},G5="default",KL=class{_onDidChangeSchema=new L;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(e){for(let t of Object.keys(this.colorsById)){let n=e.getColor(t);n&&(this.colorSchema.properties[t].oneOf[0].defaultSnippets[0].body=`\${1:${n.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(e,t,n,i=!1,r){let s={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:r};this.colorsById[e]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),i&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=h("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:n,oneOf:[a,{type:"string",const:G5,description:h("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}deregisterColor(e){delete this.colorsById[e],delete this.colorSchema.properties[e];let t=this.colorReferenceSchema.enum.indexOf(e);t!==-1&&(this.colorReferenceSchema.enum.splice(t,1),this.colorReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let n=this.colorsById[e];if(n?.defaults){let i=z5(n.defaults)?n.defaults[t.type]:n.defaults;return ts(i,t)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let e=(t,n)=>{let i=t.indexOf(".")===-1?0:1,r=n.indexOf(".")===-1?0:1;return i!==r?i-r:t.localeCompare(n)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}},mI=new KL;et.add(K5.ColorContribution,mI);function x(o,e,t,n,i){return mI.registerColor(o,e,t,n,i)}function $5(o,e){switch(o.op){case 0:return ts(o.value,e)?.darken(o.factor);case 1:return ts(o.value,e)?.lighten(o.factor);case 2:return ts(o.value,e)?.transparent(o.factor);case 3:{let t=ts(o.background,e);return t?ts(o.value,e)?.makeOpaque(t):ts(o.value,e)}case 4:for(let t of o.values){let n=ts(t,e);if(n)return n}return;case 6:return ts(e.defines(o.if)?o.then:o.else,e);case 5:{let t=ts(o.value,e);if(!t)return;let n=ts(o.background,e);return n?t.isDarkerThan(n)?G.getLighterColor(t,n,o.factor).transparent(o.transparency):G.getDarkerColor(t,n,o.factor).transparent(o.transparency):t.transparent(o.factor*o.transparency)}default:throw Md(o)}}function Zs(o,e){return{op:0,value:o,factor:e}}function Mo(o,e){return{op:1,value:o,factor:e}}function ze(o,e){return{op:2,value:o,factor:e}}function GL(...o){return{op:4,values:o}}function aO(o,e,t){return{op:6,if:o,then:e,else:t}}function $L(o,e,t,n){return{op:5,value:o,background:e,factor:t,transparency:n}}function ts(o,e){if(o!==null){if(typeof o=="string")return o[0]==="#"?G.fromHex(o):e.getColor(o);if(o instanceof G)return o;if(typeof o=="object")return $5(o,e)}}var lO="vscode://schemas/workbench-colors",dO=et.as(Wa.JSONContribution);dO.registerSchema(lO,mI.getColorSchema());var oO=new dn(()=>dO.notifySchemaChanged(lO),200);mI.onDidChangeSchema(()=>{oO.isScheduled()||oO.schedule()});var Ne=x("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},h("foreground","Overall foreground color. This color is only used if not overridden by a component.")),Ade=x("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},h("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),Fde=x("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},h("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),Bde=x("descriptionForeground",{light:"#717171",dark:ze(Ne,.7),hcDark:ze(Ne,.7),hcLight:ze(Ne,.7)},h("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),Kg=x("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},h("iconForeground","The default color for icons in the workbench.")),Po=x("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},h("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Je=x("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},h("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Pt=x("contrastActiveBorder",{light:null,dark:null,hcDark:Po,hcLight:Po},h("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),Wde=x("selection.background",null,h("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),cO=x("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkForeground","Foreground color for links in text.")),Vde=x("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),Hde=x("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:G.black,hcLight:"#292929"},h("textSeparatorForeground","Color for text separators.")),Ude=x("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},h("textPreformatForeground","Foreground color for preformatted text segments.")),zde=x("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},h("textPreformatBackground","Background color for preformatted text segments.")),Kde=x("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},h("textBlockQuoteBackground","Background color for block quotes in text.")),Gde=x("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:G.white,hcLight:"#292929"},h("textBlockQuoteBorder","Border color for block quotes in text.")),$de=x("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:G.black,hcLight:"#F2F2F2"},h("textCodeBlockBackground","Background color for code blocks in text."));var Zde=x("sash.hoverBorder",Po,h("sashActiveBorder","Border color of active sashes.")),gp=x("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:G.black,hcLight:"#0F4A85"},h("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),uO=x("badge.foreground",{dark:G.white,light:"#333",hcDark:G.white,hcLight:G.white},h("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Gg=x("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},h("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),gI=x("scrollbarSlider.background",{dark:G.fromHex("#797979").transparent(.4),light:G.fromHex("#646464").transparent(.4),hcDark:ze(Je,.6),hcLight:ze(Je,.4)},h("scrollbarSliderBackground","Scrollbar slider background color.")),fI=x("scrollbarSlider.hoverBackground",{dark:G.fromHex("#646464").transparent(.7),light:G.fromHex("#646464").transparent(.7),hcDark:ze(Je,.8),hcLight:ze(Je,.8)},h("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),bI=x("scrollbarSlider.activeBackground",{dark:G.fromHex("#BFBFBF").transparent(.4),light:G.fromHex("#000000").transparent(.6),hcDark:Je,hcLight:Je},h("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),pO=x("progressBar.background",{dark:G.fromHex("#0E70C0"),light:G.fromHex("#0E70C0"),hcDark:Je,hcLight:Je},h("progressBarBackground","Background color of the progress bar that can show for long running operations."));var yc=x("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:G.black,hcLight:G.white},h("editorBackground","Editor background color.")),vI=x("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:G.white,hcLight:Ne},h("editorForeground","Editor default foreground color.")),ice=x("editorStickyScroll.background",yc,h("editorStickyScrollBackground","Background color of sticky scroll in the editor")),oce=x("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},h("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),rce=x("editorStickyScroll.border",{dark:null,light:null,hcDark:Je,hcLight:Je},h("editorStickyScrollBorder","Border color of sticky scroll in the editor")),sce=x("editorStickyScroll.shadow",Gg,h("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),bi=x("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:G.white},h("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),Ic=x("editorWidget.foreground",Ne,h("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),$g=x("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Je,hcLight:Je},h("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),ace=x("editorWidget.resizeBorder",null,h("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),lce=x("editorError.background",null,h("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),jg=x("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},h("editorError.foreground","Foreground color of error squigglies in the editor.")),dce=x("editorError.border",{dark:null,light:null,hcDark:G.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},h("errorBorder","If set, color of double underlines for errors in the editor.")),IO=x("editorWarning.background",null,h("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Ir=x("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},h("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),yp=x("editorWarning.border",{dark:null,light:null,hcDark:G.fromHex("#FFCC00").transparent(.8),hcLight:G.fromHex("#FFCC00").transparent(.8)},h("warningBorder","If set, color of double underlines for warnings in the editor.")),cce=x("editorInfo.background",null,h("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),ns=x("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},h("editorInfo.foreground","Foreground color of info squigglies in the editor.")),Ip=x("editorInfo.border",{dark:null,light:null,hcDark:G.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},h("infoBorder","If set, color of double underlines for infos in the editor.")),CO=x("editorHint.foreground",{dark:G.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},h("editorHint.foreground","Foreground color of hint squigglies in the editor.")),uce=x("editorHint.border",{dark:null,light:null,hcDark:G.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},h("hintBorder","If set, color of double underlines for hints in the editor.")),pce=x("editorLink.activeForeground",{dark:"#4E94CE",light:G.blue,hcDark:G.cyan,hcLight:"#292929"},h("activeLinkForeground","Color of active links.")),fp=x("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},h("editorSelectionBackground","Color of the editor selection.")),SO=x("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:G.white},h("editorSelectionForeground","Color of the selected text for high contrast.")),hce=x("editor.inactiveSelectionBackground",{light:ze(fp,.5),dark:ze(fp,.5),hcDark:ze(fp,.7),hcLight:ze(fp,.5)},h("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),mce=x("editor.selectionHighlightBackground",{light:$L(fp,yc,.3,.6),dark:$L(fp,yc,.3,.6),hcDark:null,hcLight:null},h("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),gce=x("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},h("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),fce=x("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},h("editorFindMatch","Color of the current search match.")),bce=x("editor.findMatchForeground",null,h("editorFindMatchForeground","Text color of the current search match.")),is=x("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},h("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),vce=x("editor.findMatchHighlightForeground",null,h("findMatchHighlightForeground","Foreground color of the other search matches."),!0),yce=x("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},h("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Ice=x("editor.findMatchBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},h("editorFindMatchBorder","Border color of the current search match.")),id=x("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Pt,hcLight:Pt},h("findMatchHighlightBorder","Border color of the other search matches.")),Cce=x("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:ze(Pt,.4),hcLight:ze(Pt,.4)},h("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Sce=x("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},h("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),hO=x("editorHoverWidget.background",bi,h("hoverBackground","Background color of the editor hover.")),xce=x("editorHoverWidget.foreground",Ic,h("hoverForeground","Foreground color of the editor hover.")),_ce=x("editorHoverWidget.border",$g,h("hoverBorder","Border color of the editor hover.")),Ece=x("editorHoverWidget.statusBarBackground",{dark:Mo(hO,.2),light:Zs(hO,.05),hcDark:bi,hcLight:bi},h("statusBarBackground","Background color of the editor hover status bar.")),xO=x("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:G.white,hcLight:G.black},h("editorInlayHintForeground","Foreground color of inline hints")),_O=x("editorInlayHint.background",{dark:ze(gp,.1),light:ze(gp,.1),hcDark:ze(G.white,.1),hcLight:ze(gp,.1)},h("editorInlayHintBackground","Background color of inline hints")),wce=x("editorInlayHint.typeForeground",xO,h("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),Tce=x("editorInlayHint.typeBackground",_O,h("editorInlayHintBackgroundTypes","Background color of inline hints for types")),Lce=x("editorInlayHint.parameterForeground",xO,h("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),Dce=x("editorInlayHint.parameterBackground",_O,h("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),j5=x("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},h("editorLightBulbForeground","The color used for the lightbulb actions icon.")),kce=x("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),Rce=x("editorLightBulbAi.foreground",j5,h("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),Mce=x("editor.snippetTabstopHighlightBackground",{dark:new G(new je(124,124,124,.3)),light:new G(new je(10,50,100,.2)),hcDark:new G(new je(124,124,124,.3)),hcLight:new G(new je(10,50,100,.2))},h("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),Pce=x("editor.snippetTabstopHighlightBorder",null,h("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),Nce=x("editor.snippetFinalTabstopHighlightBackground",null,h("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),Oce=x("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new G(new je(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},h("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),mO=new G(new je(155,185,85,.2)),gO=new G(new je(255,0,0,.2)),Ace=x("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},h("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Fce=x("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},h("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Bce=x("diffEditor.insertedLineBackground",{dark:mO,light:mO,hcDark:null,hcLight:null},h("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Wce=x("diffEditor.removedLineBackground",{dark:gO,light:gO,hcDark:null,hcLight:null},h("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Vce=x("diffEditorGutter.insertedLineBackground",null,h("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),Hce=x("diffEditorGutter.removedLineBackground",null,h("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),Uce=x("diffEditorOverview.insertedForeground",null,h("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),zce=x("diffEditorOverview.removedForeground",null,h("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),Kce=x("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},h("diffEditorInsertedOutline","Outline color for the text that got inserted.")),Gce=x("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},h("diffEditorRemovedOutline","Outline color for text that got removed.")),$ce=x("diffEditor.border",{dark:null,light:null,hcDark:Je,hcLight:Je},h("diffEditorBorder","Border color between the two text editors.")),jce=x("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},h("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),qce=x("diffEditor.unchangedRegionBackground","sideBar.background",h("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),Yce=x("diffEditor.unchangedRegionForeground","foreground",h("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),Xce=x("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},h("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),Cp=x("widget.shadow",{dark:ze(G.black,.36),light:ze(G.black,.16),hcDark:null,hcLight:null},h("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Zce=x("widget.border",{dark:null,light:null,hcDark:Je,hcLight:Je},h("widgetBorder","Border color of widgets such as find/replace inside the editor.")),fO=x("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},h("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),Qce=x("toolbar.hoverOutline",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),Jce=x("toolbar.activeBackground",{dark:Mo(fO,.1),light:Zs(fO,.1),hcDark:null,hcLight:null},h("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),EO=x("breadcrumb.foreground",ze(Ne,.8),h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),wO=x("breadcrumb.background",yc,h("breadcrumbsBackground","Background color of breadcrumb items.")),XL=x("breadcrumb.focusForeground",{light:Zs(Ne,.2),dark:Mo(Ne,.1),hcDark:Mo(Ne,.1),hcLight:Mo(Ne,.1)},h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),TO=x("breadcrumb.activeSelectionForeground",{light:Zs(Ne,.2),dark:Mo(Ne,.1),hcDark:Mo(Ne,.1),hcLight:Mo(Ne,.1)},h("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),eue=x("breadcrumbPicker.background",bi,h("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),LO=.5,bO=G.fromHex("#40C8AE").transparent(LO),vO=G.fromHex("#40A6FF").transparent(LO),yO=G.fromHex("#606060").transparent(.4),ZL=.4,bp=1,jL=x("merge.currentHeaderBackground",{dark:bO,light:bO,hcDark:null,hcLight:null},h("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),tue=x("merge.currentContentBackground",ze(jL,ZL),h("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),qL=x("merge.incomingHeaderBackground",{dark:vO,light:vO,hcDark:null,hcLight:null},h("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),nue=x("merge.incomingContentBackground",ze(qL,ZL),h("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),YL=x("merge.commonHeaderBackground",{dark:yO,light:yO,hcDark:null,hcLight:null},h("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),iue=x("merge.commonContentBackground",ze(YL,ZL),h("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),vp=x("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},h("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),oue=x("editorOverviewRuler.currentContentForeground",{dark:ze(jL,bp),light:ze(jL,bp),hcDark:vp,hcLight:vp},h("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),rue=x("editorOverviewRuler.incomingContentForeground",{dark:ze(qL,bp),light:ze(qL,bp),hcDark:vp,hcLight:vp},h("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),sue=x("editorOverviewRuler.commonContentForeground",{dark:ze(YL,bp),light:ze(YL,bp),hcDark:vp,hcLight:vp},h("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),aue=x("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},h("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),lue=x("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",h("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),DO=x("problemsErrorIcon.foreground",jg,h("problemsErrorIconForeground","The color used for the problems error icon.")),kO=x("problemsWarningIcon.foreground",Ir,h("problemsWarningIconForeground","The color used for the problems warning icon.")),RO=x("problemsInfoIcon.foreground",ns,h("problemsInfoIconForeground","The color used for the problems info icon."));var MO=x("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},h("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),mue=x("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),QL=x("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),gue=x("minimap.infoHighlight",{dark:ns,light:ns,hcDark:Ip,hcLight:Ip},h("minimapInfo","Minimap marker color for infos.")),fue=x("minimap.warningHighlight",{dark:Ir,light:Ir,hcDark:yp,hcLight:yp},h("overviewRuleWarning","Minimap marker color for warnings.")),bue=x("minimap.errorHighlight",{dark:new G(new je(255,18,18,.7)),light:new G(new je(255,18,18,.7)),hcDark:new G(new je(255,50,50,1)),hcLight:"#B5200D"},h("minimapError","Minimap marker color for errors.")),PO=x("minimap.background",null,h("minimapBackground","Minimap background color.")),NO=x("minimap.foregroundOpacity",G.fromHex("#000f"),h("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),vue=x("minimapSlider.background",ze(gI,.5),h("minimapSliderBackground","Minimap slider background color.")),yue=x("minimapSlider.hoverBackground",ze(fI,.5),h("minimapSliderHoverBackground","Minimap slider background color when hovering.")),Iue=x("minimapSlider.activeBackground",ze(bI,.5),h("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var wue=x("charts.foreground",Ne,h("chartsForeground","The foreground color used in charts.")),Tue=x("charts.lines",ze(Ne,.5),h("chartsLines","The color used for horizontal lines in charts.")),Lue=x("charts.red",jg,h("chartsRed","The red color used in chart visualizations.")),Due=x("charts.blue",ns,h("chartsBlue","The blue color used in chart visualizations.")),kue=x("charts.yellow",Ir,h("chartsYellow","The yellow color used in chart visualizations.")),Rue=x("charts.orange",MO,h("chartsOrange","The orange color used in chart visualizations.")),Mue=x("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},h("chartsGreen","The green color used in chart visualizations.")),Pue=x("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("chartsPurple","The purple color used in chart visualizations."));var OO=x("input.background",{dark:"#3C3C3C",light:G.white,hcDark:G.black,hcLight:G.white},h("inputBoxBackground","Input box background.")),AO=x("input.foreground",Ne,h("inputBoxForeground","Input box foreground.")),FO=x("input.border",{dark:null,light:null,hcDark:Je,hcLight:Je},h("inputBoxBorder","Input box border.")),JL=x("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Je,hcLight:Je},h("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),q5=x("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},h("inputOption.hoverBackground","Background color of activated options in input fields.")),e1=x("inputOption.activeBackground",{dark:ze(Po,.4),light:ze(Po,.2),hcDark:G.transparent,hcLight:G.transparent},h("inputOption.activeBackground","Background hover color of options in input fields.")),t1=x("inputOption.activeForeground",{dark:G.white,light:G.black,hcDark:Ne,hcLight:Ne},h("inputOption.activeForeground","Foreground color of activated options in input fields.")),Wue=x("input.placeholderForeground",{light:ze(Ne,.5),dark:ze(Ne,.5),hcDark:ze(Ne,.7),hcLight:ze(Ne,.7)},h("inputPlaceholderForeground","Input box foreground color for placeholder text.")),BO=x("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:G.black,hcLight:G.white},h("inputValidationInfoBackground","Input validation background color for information severity.")),WO=x("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:Ne},h("inputValidationInfoForeground","Input validation foreground color for information severity.")),VO=x("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Je,hcLight:Je},h("inputValidationInfoBorder","Input validation border color for information severity.")),HO=x("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:G.black,hcLight:G.white},h("inputValidationWarningBackground","Input validation background color for warning severity.")),UO=x("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:Ne},h("inputValidationWarningForeground","Input validation foreground color for warning severity.")),zO=x("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Je,hcLight:Je},h("inputValidationWarningBorder","Input validation border color for warning severity.")),KO=x("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:G.black,hcLight:G.white},h("inputValidationErrorBackground","Input validation background color for error severity.")),GO=x("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:Ne},h("inputValidationErrorForeground","Input validation foreground color for error severity.")),$O=x("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Je,hcLight:Je},h("inputValidationErrorBorder","Input validation border color for error severity.")),_p=x("dropdown.background",{dark:"#3C3C3C",light:G.white,hcDark:G.black,hcLight:G.white},h("dropdownBackground","Dropdown background.")),jO=x("dropdown.listBackground",{dark:null,light:null,hcDark:G.black,hcLight:G.white},h("dropdownListBackground","Dropdown list background.")),qg=x("dropdown.foreground",{dark:"#F0F0F0",light:Ne,hcDark:G.white,hcLight:Ne},h("dropdownForeground","Dropdown foreground.")),Yg=x("dropdown.border",{dark:_p,light:"#CECECE",hcDark:Je,hcLight:Je},h("dropdownBorder","Dropdown border.")),n1=x("button.foreground",G.white,h("buttonForeground","Button foreground color.")),qO=x("button.separator",ze(n1,.4),h("buttonSeparator","Button separator color.")),Sp=x("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},h("buttonBackground","Button background color.")),YO=x("button.hoverBackground",{dark:Mo(Sp,.2),light:Zs(Sp,.2),hcDark:Sp,hcLight:Sp},h("buttonHoverBackground","Button background color when hovering.")),XO=x("button.border",Je,h("buttonBorder","Button border color.")),ZO=x("button.secondaryForeground",{dark:G.white,light:G.white,hcDark:G.white,hcLight:Ne},h("buttonSecondaryForeground","Secondary button foreground color.")),yI=x("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:G.white},h("buttonSecondaryBackground","Secondary button background color.")),QO=x("button.secondaryHoverBackground",{dark:Mo(yI,.2),light:Zs(yI,.2),hcDark:null,hcLight:null},h("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),xp=x("radio.activeForeground",t1,h("radioActiveForeground","Foreground color of active radio option.")),JO=x("radio.activeBackground",e1,h("radioBackground","Background color of active radio option.")),eA=x("radio.activeBorder",JL,h("radioActiveBorder","Border color of the active radio option.")),tA=x("radio.inactiveForeground",null,h("radioInactiveForeground","Foreground color of inactive radio option.")),nA=x("radio.inactiveBackground",null,h("radioInactiveBackground","Background color of inactive radio option.")),iA=x("radio.inactiveBorder",{light:ze(xp,.2),dark:ze(xp,.2),hcDark:ze(xp,.4),hcLight:ze(xp,.2)},h("radioInactiveBorder","Border color of the inactive radio option.")),oA=x("radio.inactiveHoverBackground",q5,h("radioHoverBackground","Background color of inactive active radio option when hovering.")),rA=x("checkbox.background",_p,h("checkbox.background","Background color of checkbox widget.")),Vue=x("checkbox.selectBackground",bi,h("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),sA=x("checkbox.foreground",qg,h("checkbox.foreground","Foreground color of checkbox widget.")),aA=x("checkbox.border",Yg,h("checkbox.border","Border color of checkbox widget.")),Hue=x("checkbox.selectBorder",Kg,h("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),lA=x("keybindingLabel.background",{dark:new G(new je(128,128,128,.17)),light:new G(new je(221,221,221,.4)),hcDark:G.transparent,hcLight:G.transparent},h("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),dA=x("keybindingLabel.foreground",{dark:G.fromHex("#CCCCCC"),light:G.fromHex("#555555"),hcDark:G.white,hcLight:Ne},h("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),cA=x("keybindingLabel.border",{dark:new G(new je(51,51,51,.6)),light:new G(new je(204,204,204,.4)),hcDark:new G(new je(111,195,223)),hcLight:Je},h("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),uA=x("keybindingLabel.bottomBorder",{dark:new G(new je(68,68,68,.6)),light:new G(new je(187,187,187,.4)),hcDark:new G(new je(111,195,223)),hcLight:Ne},h("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var pA=x("list.focusBackground",null,h("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),hA=x("list.focusForeground",null,h("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),mA=x("list.focusOutline",{dark:Po,light:Po,hcDark:Pt,hcLight:Pt},h("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),gA=x("list.focusAndSelectionOutline",null,h("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Qs=x("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},h("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),od=x("list.activeSelectionForeground",{dark:G.white,light:G.white,hcDark:null,hcLight:null},h("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),II=x("list.activeSelectionIconForeground",null,h("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),fA=x("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:G.fromHex("#0F4A85").transparent(.1)},h("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),bA=x("list.inactiveSelectionForeground",null,h("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),vA=x("list.inactiveSelectionIconForeground",null,h("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),yA=x("list.inactiveFocusBackground",null,h("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),IA=x("list.inactiveFocusOutline",null,h("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),i1=x("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:G.white.transparent(.1),hcLight:G.fromHex("#0F4A85").transparent(.1)},h("listHoverBackground","List/Tree background when hovering over items using the mouse.")),o1=x("list.hoverForeground",null,h("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),CA=x("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},h("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),SA=x("list.dropBetweenBackground",{dark:Kg,light:Kg,hcDark:null,hcLight:null},h("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),Ep=x("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Po,hcLight:Po},h("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),xA=x("list.focusHighlightForeground",{dark:Ep,light:aO(Qs,Ep,"#BBE7FF"),hcDark:Ep,hcLight:Ep},h("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),jue=x("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},h("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),que=x("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},h("listErrorForeground","Foreground color of list items containing errors.")),Yue=x("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},h("listWarningForeground","Foreground color of list items containing warnings.")),_A=x("listFilterWidget.background",{light:Zs(bi,0),dark:Mo(bi,0),hcDark:bi,hcLight:bi},h("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),EA=x("listFilterWidget.outline",{dark:G.transparent,light:G.transparent,hcDark:"#f38518",hcLight:"#007ACC"},h("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),wA=x("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Je,hcLight:Je},h("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),TA=x("listFilterWidget.shadow",Cp,h("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),Xue=x("list.filterMatchBackground",{dark:is,light:is,hcDark:null,hcLight:null},h("listFilterMatchHighlight","Background color of the filtered match.")),Zue=x("list.filterMatchBorder",{dark:id,light:id,hcDark:Je,hcLight:Pt},h("listFilterMatchHighlightBorder","Border color of the filtered match.")),Que=x("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},h("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),r1=x("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},h("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),LA=x("tree.inactiveIndentGuidesStroke",ze(r1,.4),h("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),DA=x("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},h("tableColumnsBorder","Table border color between columns.")),kA=x("tree.tableOddRowsBackground",{dark:ze(Ne,.04),light:ze(Ne,.04),hcDark:null,hcLight:null},h("tableOddRowsBackgroundColor","Background color for odd table rows.")),Jue=x("editorActionList.background",bi,h("editorActionListBackground","Action List background color.")),epe=x("editorActionList.foreground",Ic,h("editorActionListForeground","Action List foreground color.")),tpe=x("editorActionList.focusForeground",od,h("editorActionListFocusForeground","Action List foreground color for the focused item.")),npe=x("editorActionList.focusBackground",Qs,h("editorActionListFocusBackground","Action List background color for the focused item."));var RA=x("menu.border",{dark:null,light:null,hcDark:Je,hcLight:Je},h("menuBorder","Border color of menus.")),MA=x("menu.foreground",qg,h("menuForeground","Foreground color of menu items.")),PA=x("menu.background",_p,h("menuBackground","Background color of menu items.")),NA=x("menu.selectionForeground",od,h("menuSelectionForeground","Foreground color of the selected menu item in menus.")),OA=x("menu.selectionBackground",Qs,h("menuSelectionBackground","Background color of the selected menu item in menus.")),AA=x("menu.selectionBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("menuSelectionBorder","Border color of the selected menu item in menus.")),FA=x("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Je,hcLight:Je},h("menuSeparatorBackground","Color of a separator menu item in menus."));var hpe=x("quickInput.background",bi,h("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),mpe=x("quickInput.foreground",Ic,h("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),gpe=x("quickInputTitle.background",{dark:new G(new je(255,255,255,.105)),light:new G(new je(0,0,0,.06)),hcDark:"#000000",hcLight:G.white},h("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),WA=x("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:G.white,hcLight:"#0F4A85"},h("pickerGroupForeground","Quick picker color for grouping labels.")),fpe=x("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:G.white,hcLight:"#0F4A85"},h("pickerGroupBorder","Quick picker color for grouping borders.")),BA=x("quickInput.list.focusBackground",null,"",void 0,h("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),CI=x("quickInputList.focusForeground",od,h("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),SI=x("quickInputList.focusIconForeground",II,h("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),xI=x("quickInputList.focusBackground",{dark:GL(BA,Qs),light:GL(BA,Qs),hcDark:null,hcLight:null},h("quickInput.listFocusBackground","Quick picker background color for the focused item."));var Cpe=x("search.resultsInfoForeground",{light:Ne,dark:ze(Ne,.65),hcDark:Ne,hcLight:Ne},h("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),Spe=x("searchEditor.findMatchBackground",{light:ze(is,.66),dark:ze(is,.66),hcDark:is,hcLight:is},h("searchEditor.queryMatch","Color of the Search Editor query matches.")),xpe=x("searchEditor.findMatchBorder",{light:ze(id,.66),dark:ze(id,.66),hcDark:id,hcLight:id},h("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var Y5={IconContribution:"base.contributions.icons"},X5;(e=>{function o(t,n){let i=t.defaults;for(;nt.isThemeIcon(i);){let r=wp.getIcon(i.id);if(!r)return;i=r.defaults}return i}e.getDefinition=o})(X5||={});var Z5;(t=>{function o(n){return{weight:n.weight,style:n.style,src:n.src.map(i=>({format:i.format,location:i.location.toString()}))}}t.toJSONObject=o;function e(n){let i=r=>Lt(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>Lt(r.format)&&Lt(r.location)))return{weight:i(n.weight),style:i(n.style),src:n.src.map(r=>({format:r.format,location:le.parse(r.location)}))}}t.fromJSONObject=e})(Z5||={});var s1=class{_onDidChange=new L;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:h("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${nt.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){let r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return r}let s={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=s;let a={$ref:"#/definitions/icons"};return i&&(a.deprecationMessage=i),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(r,s)=>r.id.localeCompare(s.id),t=r=>{for(;nt.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let i=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(let r of i.filter(s=>!!s.description).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|${nt.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(let r of i.filter(s=>!nt.isThemeIcon(s.defaults)).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|`);return n.join(`
`)}},wp=new s1;et.add(Y5.IconContribution,wp);function or(o,e,t,n){return wp.registerIcon(o,e,t,n)}function Q5(){let o=qw();for(let e in o){let t="\\"+o[e].toString(16);wp.registerIcon(e,{fontCharacter:t})}}Q5();var HA="vscode://schemas/icons",UA=et.as(Wa.JSONContribution);UA.registerSchema(HA,wp.getIconSchema());var VA=new dn(()=>UA.notifySchemaChanged(HA),200);wp.onDidChange(()=>{VA.isScheduled()||VA.schedule()});var Qpe=or("widget-close",ue.close,h("widgetClose","Icon for the close action in widgets.")),Jpe=or("goto-previous-location",ue.arrowUp,h("previousChangeIcon","Icon for goto previous editor location.")),ehe=or("goto-next-location",ue.arrowDown,h("nextChangeIcon","Icon for goto next editor location.")),the=nt.modify(ue.sync,"spin"),nhe=nt.modify(ue.loading,"spin");function Js(o){return o==="hcDark"||o==="hcLight"}function a1(o){return o==="dark"||o==="hcDark"}var os=j("themeService");var She=ue.file,xhe=ue.folder;function Xg(o){switch(o){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var J5={ThemingContribution:"base.contributions.theming"},l1=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new L}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),Ce(()=>{let t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},zA=new l1;et.add(J5.ThemingContribution,zA);function zi(o){return zA.onColorThemeChange(o)}var _I=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}};var EI=class{type=0;constructor(){}},wI=class{type=1;constructor(){}},TI=class{type=2;_source;constructor(e){this._source=e}hasChanged(e){return this._source.hasChanged(e)}},LI=class{constructor(e,t,n){this.selections=e;this.modelSelections=t;this.reason=n}type=3},ea=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(e){e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},Cc=class{type=5;constructor(){}},DI=class{type=6;isFocused;constructor(e){this.isFocused=e}},kI=class{type=7},Sc=class{type=8;constructor(){}},Zg=class{constructor(e,t){this.fromLineNumber=e;this.count=t}type=9},Tp=class{type=10;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}},Lp=class{type=11;fromLineNumber;toLineNumber;constructor(e,t){this.fromLineNumber=e,this.toLineNumber=t}};var ja=class{constructor(e,t,n,i,r,s,a){this.source=e;this.minimalReveal=t;this.range=n;this.selections=i;this.verticalType=r;this.revealHorizontal=s;this.scrollType=a}type=12},RI=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e){this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}},MI=class{constructor(e){this.theme=e}type=14},PI=class{type=15;ranges;constructor(e){this.ranges=e}},NI=class{type=16;constructor(){}},OI=class{type=17;constructor(){}};var Cr=class extends V{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let r=e[n];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}};var Qg=class{_viewportBrand=void 0;top;left;width;height;constructor(e,t,n,i){this.top=e|0,this.left=t|0,this.width=n|0,this.height=i|0}},AI=class{tabSize;data;constructor(e,t){this.tabSize=e,this.data=t}},xc=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(e,t,n,i,r,s,a){this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=r,this.tokens=s,this.inlineDecorations=a}},FI=class o{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(e,t,n,i,r,s,a,l,d,c){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=o.isBasicASCII(n,s),this.containsRTL=o.containsRTL(n,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(e,t){return t?Nm(e):!0}static containsRTL(e,t,n){return!t&&n?Na(e):!1}};var _c=class{constructor(e,t,n){this.range=e;this.inlineClassName=t;this.type=n}},BI=class{constructor(e,t,n,i){this.startOffset=e;this.endOffset=t;this.inlineClassName=n;this.inlineClassNameAffectsLetterSpacing=i}toInlineDecoration(e){return new _c(new w(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},kp=class{_viewModelDecorationBrand=void 0;range;options;constructor(e,t){this.range=e,this.options=t}},Ec=class o{constructor(e,t,n){this.color=e;this.zIndex=t;this.data=n}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&tn(e.data,t.data)}static equalsArr(e,t){return tn(e,t,o.equals)}};var WI=class{_colorZoneBrand=void 0;from;to;colorId;constructor(e,t,n){this.from=e|0,this.to=t|0,this.colorId=n|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}},d1=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(e,t,n,i){this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=n,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}},VI=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(d1.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=Math.floor(this._outerHeight),r=n/i,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!e){let S=c.getColorZones();if(S){a.push(S);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),p=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+t:u+c.heightInLines*t,m=Math.floor(r*u),f=Math.floor(r*p),g=Math.floor((m+f)/2),b=f-g;b<s&&(b=s),g-b<0&&(g=b),g+b>n&&(g=n-b);let v=c.color,I=this._color2Id[v];I||(I=++this._lastAssignedId,this._color2Id[v]=I,this._id2Color[I]=v);let C=new WI(g-b,g+b,I);c.setColorZone(C),a.push(C)}return this._colorZonesInvalid=!1,a.sort(WI.compare),a}};function KA(o){return o&&typeof o.getEditorType=="function"?o.getEditorType()===zg.ICodeEditor:!1}function eU(o){return o&&typeof o.getEditorType=="function"?o.getEditorType()===zg.IDiffEditor:!1}function tU(o){return!!o&&typeof o=="object"&&typeof o.onDidChangeActiveEditor=="function"}function GA(o){return KA(o)?o:eU(o)?o.getModifiedEditor():tU(o)&&KA(o.activeCodeEditor)?o.activeCodeEditor:null}function c1(o){let e=o;return typeof e?.resolve=="function"&&typeof e?.isResolved=="function"}var ta=j("codeEditorService");var rs=j("modelService");var qa=j("textModelService");var Rp=j("telemetryService"),ebe=j("customEndpointTelemetryService");function u1(o,e){return e&&(o.stack||o.stacktrace)?h("stackTrace.format","{0}: {1}",jA(o),$A(o.stack)||$A(o.stacktrace)):jA(o)}function $A(o){return Array.isArray(o)?o.join(`
`):o}function jA(o){return o.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${o.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof o.code=="string"&&typeof o.errno=="number"&&typeof o.syscall=="string"?h("nodeExceptionMessage","A system error occurred ({0})",o.message):o.message||h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function HI(o=null,e=!1){if(!o)return h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(o)){let t=xs(o),n=HI(t[0],e);return t.length>1?h("error.moreErrors","{0} ({1} errors in total)",n,t.length):n}if(Lt(o))return o;if(o.detail){let t=o.detail;if(t.error)return u1(t.error,e);if(t.exception)return u1(t.exception,e)}return o.stack?u1(o,e):o.message?o.message:h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function p1(o){let e=o;return e instanceof Error&&Array.isArray(e.actions)}var xn=j("logService"),xbe=j("loggerService");function nU(o){switch(o){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var _be=new me("logLevel",nU(3));var wc=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let t of e){let n=t.kbExpr;this.precondition&&(n?n=De.and(n,this.precondition):n=this.precondition);let i={id:this.id,weight:t.weight,args:t.args,when:n,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Ha.registerKeybindingRule(i)}}Eo.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){Qu.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}},Jg=class extends wc{_implementations=[];addImplementation(e,t,n,i){return this._implementations.push({priority:e,name:t,implementation:n,when:i}),this._implementations.sort((r,s)=>s.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===n){this._implementations.splice(r,1);return}}}}runCommand(e,t){let n=e.get(xn),i=e.get(Rt);n.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let r of this._implementations){if(r.when){let a=i.getContext(Ji());if(!r.when.evaluate(a))continue}let s=r.implementation(e,t);if(s)return n.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof s=="boolean"?void 0:s}n.trace(`The Command '${this.id}' was not handled by any implementation.`)}},UI=class extends wc{constructor(t,n){super(n);this.command=t}runCommand(t,n){return this.command.runCommand(t,n)}},na=class o extends wc{static bindToContribution(e){return class extends o{_callback;constructor(n){super(n),this._callback=n.handler}runEditorCommand(n,i,r){let s=e(i);s&&this._callback(s,r)}}}static runEditorCommand(e,t,n,i){let r=e.get(ta),s=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(Rt).contextMatchesRules(n??void 0))return i(a,s,t)})}runCommand(e,t){return o.runEditorCommand(e,t,this.precondition,(n,i,r)=>this.runEditorCommand(n,i,r))}},ef=class o extends na{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function n(i){return i.menuId||(i.menuId=Fn.EditorContext),i.title||(i.title=e.label),i.when=De.and(e.precondition,i.when),i}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(n)):e.contextMenuOpts&&t.push(n(e.contextMenuOpts)),e.menuOpts=t,e}label;alias;constructor(e){super(o.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,n){return this.reportTelemetry(e,t),this.run(e,t,n||{})}reportTelemetry(e,t){e.get(Rp).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}};function be(o){return ss.INSTANCE.registerEditorCommand(o),o}function h1(o){let e=new o;return ss.INSTANCE.registerEditorAction(e),e}function Mp(o,e,t){ss.INSTANCE.registerEditorContribution(o,e,t)}var Tc;(r=>{function o(s){return ss.INSTANCE.getEditorCommand(s)}r.getEditorCommand=o;function e(){return ss.INSTANCE.getEditorActions()}r.getEditorActions=e;function t(){return ss.INSTANCE.getEditorContributions()}r.getEditorContributions=t;function n(s){return ss.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}r.getSomeEditorContributions=n;function i(){return ss.INSTANCE.getDiffEditorContributions()}r.getDiffEditorContributions=i})(Tc||={});var iU={EditorCommonContributions:"editor.contributions"},ss=class o{static INSTANCE=new o;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(e,t,n){this.editorContributions.push({id:e,ctor:t,instantiation:n})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(e,t){this.diffEditorContributions.push({id:e,ctor:t})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};et.add(iU.EditorCommonContributions,ss.INSTANCE);function tf(o){return o.register(),o}var m1=tf(new Jg({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Fn.MenubarEditMenu,group:"1_do",title:h({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:Fn.CommandPalette,group:"",title:h("undo","Undo"),order:1}]}));tf(new UI(m1,{id:"default:undo",precondition:void 0}));var g1=tf(new Jg({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Fn.MenubarEditMenu,group:"1_do",title:h({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:Fn.CommandPalette,group:"",title:h("redo","Redo"),order:1}]}));tf(new UI(g1,{id:"default:redo",precondition:void 0}));var qA=tf(new Jg({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Fn.MenubarSelectionMenu,group:"1_basic",title:h({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:Fn.CommandPalette,group:"",title:h("selectAll","Select All"),order:1}]}));var rd=class o{static columnSelect(e,t,n,i,r,s){let a=Math.abs(r-n)+1,l=n>r,d=i>s,c=i<s,u=[];for(let p=0;p<a;p++){let m=n+(l?-p:p),f=e.columnFromVisibleColumn(t,m,i),g=e.columnFromVisibleColumn(t,m,s),b=e.visibleColumnFromColumn(t,new M(m,f)),v=e.visibleColumnFromColumn(t,new M(m,g));c&&(b>s||v<i)||d&&(v>i||b<s)||u.push(new pn(new w(m,f,m,f),0,0,new M(m,g),0))}if(u.length===0)for(let p=0;p<a;p++){let m=n+(l?-p:p),f=t.getLineMaxColumn(m);u.push(new pn(new w(m,f,m,f),0,0,new M(m,f),0))}return{viewStates:u,reversed:l,fromLineNumber:n,fromVisualColumn:i,toLineNumber:r,toVisualColumn:s}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,o.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0,r=Math.min(n.fromViewLineNumber,n.toViewLineNumber),s=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let l=r;l<=s;l++){let d=t.getLineMaxColumn(l),c=e.visibleColumnFromColumn(t,new M(l,d));i=Math.max(i,c)}let a=n.toViewVisualColumn;return a<i&&a++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,a)}static columnSelectUp(e,t,n,i){let r=i?e.pageSize:1,s=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){let r=i?e.pageSize:1,s=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,s,n.toViewVisualColumn)}};var ti=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return Me.fromPositions(i.getEndPosition())}};var Lc=class{_range;_text;insertsAutoWhitespace;constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return Me.fromPositions(i.getStartPosition())}},Dc=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(e,t,n,i,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return Me.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},GI=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};var kc=class o{static whitespaceVisibleColumn(e,t,n){let i=e.length,r=0,s=-1,a=-1;for(let l=0;l<i;l++){if(l===t)return[s,a,r];switch(r%n===0&&(s=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=Ct.nextRenderTabStop(r,n);break;default:return[-1,-1,-1]}}return t===i?[s,a,r]:[-1,-1,-1]}static atomicPosition(e,t,n,i){let r=e.length,[s,a,l]=o.whitespaceVisibleColumn(e,t,n);if(l===-1)return-1;let d;switch(i){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%n===0)return t;d=l%n<=n/2;break}if(d){if(s===-1)return-1;let p=a;for(let m=s;m<r;++m){if(p===a+n)return s;switch(e.charCodeAt(m)){case 32:p+=1;break;case 9:p=Ct.nextRenderTabStop(p,n);break;default:return-1}}return p===a+n?s:-1}let c=Ct.nextRenderTabStop(l,n),u=l;for(let p=t;p<r;p++){if(u===c)return p;switch(e.charCodeAt(p)){case 32:u+=1;break;case 9:u=Ct.nextRenderTabStop(u,n);break;default:return-1}}return u===c?r:-1}};var nf=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(e,t,n){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}},Gt=class o{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-qE(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){let n=t.lineNumber-1;return new M(n,e.getLineMaxColumn(n))}else return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){let i=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),s=kc.atomicPosition(r,t.column-1,n,0);if(s!==-1&&s+1>=i)return new M(t.lineNumber,s+1)}return this.leftPosition(e,t)}static left(e,t,n){let i=e.stickyTabStops?o.leftPositionAtomicSoftTabs(t,n,e.tabSize):o.leftPosition(t,n);return new nf(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.startLineNumber,a=n.selection.startColumn;else{let l=n.position.delta(void 0,-(r-1)),d=t.normalizePosition(o.clipPositionColumn(l,t),0),c=o.left(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static clipPositionColumn(e,t){return new M(e.lineNumber,o.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n=n+Pm(e.getLineContent(t),n-1):t<e.getLineCount()&&(t=t+1,n=e.getLineMinColumn(t)),new M(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,r){if(n<e.getLineIndentColumn(t)){let s=e.getLineContent(t),a=kc.atomicPosition(s,n-1,i,1);if(a!==-1)return new M(t,a+1)}return this.rightPosition(e,t,n)}static right(e,t,n){let i=e.stickyTabStops?o.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):o.rightPosition(t,n.lineNumber,n.column);return new nf(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let s,a;if(n.hasSelection()&&!i)s=n.selection.endLineNumber,a=n.selection.endColumn;else{let l=n.position.delta(void 0,r-1),d=t.normalizePosition(o.clipPositionColumn(l,t),1),c=o.right(e,t,d);s=c.lineNumber,a=c.column}return n.move(i,s,a,0)}static vertical(e,t,n,i,r,s,a,l){let d=Ct.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,c=t.getLineCount(),u=n===1&&i===1,p=n===c&&i===t.getLineMaxColumn(n),m=s<n?u:p;if(n=s,n<1?(n=1,a?i=t.getLineMinColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):n>c?(n=c,a?i=t.getLineMaxColumn(n):i=Math.min(t.getLineMaxColumn(n),i)):i=e.columnFromVisibleColumn(t,n,d),m?r=0:r=d-Ct.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),l!==void 0){let f=new M(n,i),g=t.normalizePosition(f,l);r=r+(i-g.column),n=g.lineNumber,i=g.column}return new nf(n,i,r)}static down(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n+s,a,4)}static moveDown(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.endLineNumber,a=n.selection.endColumn):(s=n.position.lineNumber,a=n.position.column);let l=0,d;do if(d=o.down(e,t,s+l,a,n.leftoverVisibleColumns,r,!0),t.normalizePosition(new M(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<t.getLineCount());return n.move(i,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,r=o.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new pn(new w(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new M(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(e,t,n,i,r,s,a){return this.vertical(e,t,n,i,r,n-s,a,3)}static moveUp(e,t,n,i,r){let s,a;n.hasSelection()&&!i?(s=n.selection.startLineNumber,a=n.selection.startColumn):(s=n.position.lineNumber,a=n.position.column);let l=o.up(e,t,s,a,n.leftoverVisibleColumns,r,!0);return n.move(i,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,r=o.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),s=o.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new pn(new w(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new M(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){let r=t.getLineCount(),s=n.position.lineNumber;for(;s<r&&this._isBlankLine(t,s);)s++;for(;s<r&&!this._isBlankLine(t,s);)s++;return n.move(i,s,t.getLineMinColumn(s),0)}static moveToBeginningOfLine(e,t,n,i){let r=n.position.lineNumber,s=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||s,l;return n.position.column===a?l=s:l=a,n.move(i,r,l,0)}static moveToEndOfLine(e,t,n,i,r){let s=n.position.lineNumber,a=t.getLineMaxColumn(s);return n.move(i,s,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),s=t.getLineMaxColumn(r);return n.move(i,r,s,0)}};var Ya=class o{static deleteRight(e,t,n,i){let r=[],s=e!==3;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d;if(c.isEmpty()){let u=d.getPosition(),p=Gt.right(t,n,u);c=new w(p.lineNumber,p.column,u.lineNumber,u.column)}if(c.isEmpty()){r[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),r[a]=new ti(c,"")}return[s,r]}static isAutoClosingPairDelete(e,t,n,i,r,s,a){if(t==="never"&&n==="never"||e==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let p=r.getLineContent(u.lineNumber);if(u.column<2||u.column>=p.length+1)return!1;let m=p.charAt(u.column-2),f=i.get(m);if(!f)return!1;if(es(m)){if(n==="never")return!1}else if(t==="never")return!1;let g=p.charAt(u.column-1),b=!1;for(let v of f)v.open===m&&v.close===g&&(b=!0);if(!b)return!1;if(e==="auto"){let v=!1;for(let I=0,C=a.length;I<C;I++){let S=a[I];if(u.lineNumber===S.startLineNumber&&u.column===S.startColumn){v=!0;break}}if(!v)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].getPosition(),l=new w(a.lineNumber,a.column-1,a.lineNumber,a.column+1);i[r]=new ti(l,"")}return[!0,i]}static deleteLeft(e,t,n,i,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,r))return this._runAutoClosingPairDelete(t,n,i);let s=[],a=e!==2;for(let l=0,d=i.length;l<d;l++){let c=o.getDeleteRange(i[l],n,t);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new ti(c,"")}return[a,s]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;let i=e.getPosition();if(n.useTabStops&&i.column>1){let r=t.getLineContent(i.lineNumber),s=zt(r),a=s===-1?r.length+1:s+1;if(i.column<=a){let l=n.visibleColumnFromColumn(t,i),d=Ct.prevIndentTabStop(l,n.indentSize),c=n.columnFromVisibleColumn(t,i.lineNumber,d);return new w(i.lineNumber,c,i.lineNumber,i.column)}}return w.fromPositions(o.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){let n=kM(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}else if(e.lineNumber>1){let n=e.lineNumber-1;return new M(n,t.getLineMaxColumn(n))}else return e}static cut(e,t,n){let i=[],r=null;n.sort((s,a)=>M.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=n.length;s<a;s++){let l=n[s];if(l.isEmpty())if(e.emptySelectionClipboard){let d=l.getPosition(),c,u,p,m;d.lineNumber<t.getLineCount()?(c=d.lineNumber,u=1,p=d.lineNumber+1,m=1):d.lineNumber>1&&r?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=t.getLineMaxColumn(d.lineNumber-1),p=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,p=d.lineNumber,m=t.getLineMaxColumn(d.lineNumber));let f=new w(c,u,p,m);r=f,f.isEmpty()?i[s]=null:i[s]=new ti(f,"")}else i[s]=null;else i[s]=new ti(l,"")}return new Sn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var Pp=class o{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0,r=t.findPrevIntlWordBeforeOrAtOffset(e,n.column-2);for(let s=n.column-2;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return this._createIntlWord(r,l);if(l===0){if(i===2)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=1}else if(l===2){if(i===1)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1));i=2}else if(l===1&&i!==0)return this._createWord(e,i,l,s+1,this._findEndOfWord(e,t,i,s+1))}return i!==0?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=t.findNextIntlWordAtOrAfterOffset(e,i),s=e.length;for(let a=i;a<s;a++){let l=e.charCodeAt(a),d=t.get(l);if(r&&a===r.index+r.segment.length||d===1||n===1&&d===2||n===2&&d===0)return a}return s}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length,s=t.findNextIntlWordAtOrAfterOffset(e,n.column-1);for(let a=n.column-1;a<r;a++){let l=e.charCodeAt(a),d=t.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(i===2)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=1}else if(d===2){if(i===1)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a);i=2}else if(d===1&&i!==0)return this._createWord(e,i,d,this._findStartOfWord(e,t,i,a-1),a)}return i!==0?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){let r=t.findPrevIntlWordBeforeOrAtOffset(e,i);for(let s=i;s>=0;s--){let a=e.charCodeAt(s),l=t.get(a);if(r&&s===r.index)return s;if(l===1||n===1&&l===2||n===2&&l===0)return s+1}return 0}static moveWordLeft(e,t,n,i,r){let s=n.lineNumber,a=n.column;a===1&&s>1&&(s=s-1,a=t.getLineMaxColumn(s));let l=o._findPreviousWordOnLine(e,t,new M(s,a));if(i===0)return new M(s,l?l.start+1:1);if(i===1)return!r&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findPreviousWordOnLine(e,t,new M(s,l.start+1))),new M(s,l?l.start+1:1);if(i===3){for(;l&&l.wordType===2;)l=o._findPreviousWordOnLine(e,t,new M(s,l.start+1));return new M(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=o._findPreviousWordOnLine(e,t,new M(s,l.start+1))),new M(s,l?l.end+1:1)}static _moveWordPartLeft(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===1)return n>1?new M(n-1,e.getLineMaxColumn(n-1)):t;let r=e.getLineContent(n);for(let s=t.column-1;s>1;s--){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a===95&&l!==95)return new M(n,s);if(a===45&&l!==45)return new M(n,s);if((Ad(a)||Rm(a))&&Ds(l))return new M(n,s);if(Ds(a)&&Ds(l)&&s+1<i){let d=r.charCodeAt(s);if(Ad(d)||Rm(d))return new M(n,s)}}return new M(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,s=n.column,a=!1;s===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,s=1);let l=o._findNextWordOnLine(e,t,new M(r,s));if(i===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=o._findNextWordOnLine(e,t,new M(r,l.end+1))),l?s=l.end+1:s=t.getLineMaxColumn(r);else if(i===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=o._findNextWordOnLine(e,t,new M(r,l.end+1));l?s=l.start+1:s=t.getLineMaxColumn(r)}else l&&!a&&s>=l.start+1&&(l=o._findNextWordOnLine(e,t,new M(r,l.end+1))),l?s=l.start+1:s=t.getLineMaxColumn(r);return new M(r,s)}static _moveWordPartRight(e,t){let n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new M(n+1,1):t;let r=e.getLineContent(n);for(let s=t.column+1;s<i;s++){let a=r.charCodeAt(s-2),l=r.charCodeAt(s-1);if(a!==95&&l===95)return new M(n,s);if(a!==45&&l===45)return new M(n,s);if((Ad(a)||Rm(a))&&Ds(l))return new M(n,s);if(Ds(a)&&Ds(l)&&s+1<i){let d=r.charCodeAt(s);if(Ad(d)||Rm(d))return new M(n,s)}}return new M(n,i)}static _deleteWordLeftWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-2,r=qo(n,i);return r+1<i?new w(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(Ya.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){let u=e.selection.getPosition();return new w(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new M(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(i,a);if(u)return u}let c=o._findPreviousWordOnLine(n,i,a);return t===0?c?d=c.start+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=o._findPreviousWordOnLine(n,i,new M(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=i.getLineMaxColumn(l))),new w(l,d,a.lineNumber,a.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;let i=new M(n.positionLineNumber,n.positionColumn),r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){let n=e.charCodeAt(t);return n===32||n===9}static _deleteInsideWordWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=n.length;if(i===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let s=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,s))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;s+1<i&&this._charAtIsWhitespace(n,s+1);)s++;return new w(t.lineNumber,r+1,t.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){let i=t.getLineContent(n.lineNumber),r=i.length;if(r===0)return n.lineNumber>1?new w(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new w(n.lineNumber,1,n.lineNumber+1,1):new w(n.lineNumber,1,n.lineNumber,1);let s=u=>u.start+1<=n.column&&n.column<=u.end+1,a=(u,p)=>(u=Math.min(u,n.column),p=Math.max(p,n.column),new w(n.lineNumber,u,n.lineNumber,p)),l=u=>{let p=u.start+1,m=u.end+1,f=!1;for(;m-1<r&&this._charAtIsWhitespace(i,m-1);)f=!0,m++;if(!f)for(;p>1&&this._charAtIsWhitespace(i,p-2);)p--;return a(p,m)},d=o._findPreviousWordOnLine(e,t,n);if(d&&s(d))return l(d);let c=o._findNextWordOnLine(e,t,n);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartLeft(e,n);return new w(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let r=e.charAt(i);if(r!==" "&&r!=="	")return i}return n}static _deleteWordRightWhitespace(e,t){let n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new w(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){let n=e.wordSeparators,i=e.model,r=e.selection,s=e.whitespaceHeuristics;if(!r.isEmpty())return r;let a=new M(r.positionLineNumber,r.positionColumn),l=a.lineNumber,d=a.column,c=i.getLineCount(),u=i.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let m=this._deleteWordRightWhitespace(i,a);if(m)return m}let p=o._findNextWordOnLine(n,i,a);return t===2?p?d=p.end+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new M(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l)):(p&&d>=p.start+1&&(p=o._findNextWordOnLine(n,i,new M(l,p.end+1))),p?d=p.start+1:d<u||l===c?d=u:(l++,p=o._findNextWordOnLine(n,i,new M(l,1)),p?d=p.start+1:d=i.getLineMaxColumn(l))),new w(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;let n=t.getPosition(),i=o._moveWordPartRight(e,n);return new w(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){let i=new w(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n,i){let r=zs(t,n),s=o._findPreviousWordOnLine(r,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return o._createWordAtPosition(e,i.lineNumber,s);let a=o._findNextWordOnLine(r,e,i);return a&&a.wordType===1&&a.start<=i.column-1&&i.column-1<=a.end?o._createWordAtPosition(e,i.lineNumber,a):null}static word(e,t,n,i,r){let s=zs(e.wordSeparators,e.wordSegmenterLocales),a=o._findPreviousWordOnLine(s,t,r),l=o._findNextWordOnLine(s,t,r);if(!i){let m,f;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(m=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(m=l.start+1,f=l.end+1):(a?m=a.end+1:m=1,l?f=l.start+1:f=t.getLineMaxColumn(r.lineNumber)),new pn(new w(r.lineNumber,m,r.lineNumber,f),1,0,new M(r.lineNumber,f),0)}let d,c;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(d=l.start+1,c=l.end+1):(d=r.column,c=r.column);let u=r.lineNumber,p;if(n.selectionStart.containsPosition(r))p=n.selectionStart.endColumn;else if(r.isBeforeOrEqual(n.selectionStart.getStartPosition())){p=d;let m=new M(u,p);n.selectionStart.containsPosition(m)&&(p=n.selectionStart.endColumn)}else{p=c;let m=new M(u,p);n.selectionStart.containsPosition(m)&&(p=n.selectionStart.startColumn)}return n.move(!0,u,p,0)}};var kn=class{static addCursorDown(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ke(l.modelState,l.viewState),n?i[r++]=Ke.fromModelState(Gt.translateDown(e.cursorConfig,e.model,l.modelState)):i[r++]=Ke.fromViewState(Gt.translateDown(e.cursorConfig,e,l.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s];i[r++]=new Ke(l.modelState,l.viewState),n?i[r++]=Ke.fromModelState(Gt.translateUp(e.cursorConfig,e.model,l.modelState)):i[r++]=Ke.fromViewState(Gt.translateUp(e.cursorConfig,e,l.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=this._moveToLineStart(e,a,n)}return i}static _moveToLineStart(e,t,n){let i=t.viewState.position.column,r=t.modelState.position.column,s=i===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!s&&!(i===l)?this._moveToLineStartByView(e,t,n):this._moveToLineStartByModel(e,t,n)}static _moveToLineStartByView(e,t,n){return Ke.fromViewState(Gt.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return Ke.fromModelState(Gt.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=this._moveToLineEnd(e,l,n,i)}return r}static _moveToLineEnd(e,t,n,i){let r=t.viewState.position,s=e.getLineMaxColumn(r.lineNumber),a=r.column===s,l=t.modelState.position,d=e.model.getLineMaxColumn(l.lineNumber),c=s-r.column===d-l.column;return a||c?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return Ke.fromViewState(Gt.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return Ke.fromModelState(Gt.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=s.modelState.selection.startLineNumber,l=e.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=e.model.getLineMaxColumn(l):(d++,c=1),n[i]=Ke.fromModelState(new pn(new w(a,1,a,1),0,0,new M(d,c),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ke.fromModelState(Gt.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r];i[r]=Ke.fromModelState(Gt.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,n))}return i}static selectAll(e,t){let n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return Ke.fromModelState(new pn(new w(1,1,1,1),0,0,new M(n,i),0))}static line(e,t,n,i,r){let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new M(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);if(!n){let d=e.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=e.model.getLineMaxColumn(c)),Ke.fromModelState(new pn(new w(s.lineNumber,1,c,u),2,0,new M(c,u),0))}let l=t.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Ke.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=e.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=e.getLineMaxColumn(c)),Ke.fromViewState(t.viewState.move(!0,c,u,0))}else{let d=t.modelState.selectionStart.getEndPosition();return Ke.fromModelState(t.modelState.move(!0,d.lineNumber,d.column,0))}}static word(e,t,n,i){let r=e.model.validatePosition(i);return Ke.fromModelState(Pp.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new Ke(t.modelState,t.viewState);let n=t.viewState.position.lineNumber,i=t.viewState.position.column;return Ke.fromViewState(new pn(new w(n,i,n,i),0,0,new M(n,i),0))}static moveTo(e,t,n,i,r){if(n){if(t.modelState.selectionStartKind===1)return this.word(e,t,n,i);if(t.modelState.selectionStartKind===2)return this.line(e,t,n,i,r)}let s=e.model.validatePosition(i),a=r?e.coordinatesConverter.validateViewPosition(new M(r.lineNumber,r.column),s):e.coordinatesConverter.convertModelPositionToViewPosition(s);return Ke.fromViewState(t.viewState.move(n,a.lineNumber,a.column,0))}static simpleMove(e,t,n,i,r,s){switch(n){case Fe.Direction.Left:return s===Fe.Unit.HalfLine?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case Fe.Direction.Right:return s===Fe.Unit.HalfLine?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case Fe.Direction.Up:return s===Fe.Unit.WrappedLine?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case Fe.Direction.Down:return s===Fe.Unit.WrappedLine?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case Fe.Direction.PrevBlankLine:return s===Fe.Unit.WrappedLine?t.map(a=>Ke.fromViewState(Gt.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ke.fromModelState(Gt.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Fe.Direction.NextBlankLine:return s===Fe.Unit.WrappedLine?t.map(a=>Ke.fromViewState(Gt.moveToNextBlankLine(e.cursorConfig,e,a.viewState,i))):t.map(a=>Ke.fromModelState(Gt.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,i)));case Fe.Direction.WrappedLineStart:return this._moveToViewMinColumn(e,t,i);case Fe.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case Fe.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(e,t,i);case Fe.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(e,t,i);case Fe.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){let s=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(s);switch(n){case Fe.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Fe.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(e.model,a,r),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Fe.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],i,l,d)]}case Fe.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=t.length;d<c;d++){let u=t[d];l[d]=this.findPositionInViewportIfOutside(e,u,s,i)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new Ke(t.modelState,t.viewState);{let s;r>n.endLineNumber-1?s=n.endLineNumber-1:r<n.startLineNumber?s=n.startLineNumber:s=r;let a=Gt.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,s,!1);return Ke.fromViewState(t.viewState.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map(r=>Ke.fromViewState(Gt.moveLeft(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ke.fromViewState(Gt.moveLeft(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveRight(e,t,n,i){return t.map(r=>Ke.fromViewState(Gt.moveRight(e.cursorConfig,e,r.viewState,n,i)))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round(e.getLineLength(l)/2);i[r]=Ke.fromViewState(Gt.moveRight(e.cursorConfig,e,a.viewState,n,d))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromViewState(Gt.moveDown(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromModelState(Gt.moveDown(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromViewState(Gt.moveUp(e.cursorConfig,e,l.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];r[s]=Ke.fromModelState(Gt.moveUp(e.cursorConfig,e.model,l.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return Ke.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return Ke.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMinColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineFirstNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineMaxColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.viewState.position.lineNumber,d=e.getLineLastNonWhitespaceColumn(l);i[r]=this._moveToViewPosition(e,a,n,l,d)}return i}},Fe;(a=>{let o=function(l){if(!Ht(l))return!1;let d=l;return!(!Lt(d.to)||!Oi(d.select)&&!Sv(d.select)||!Oi(d.by)&&!Lt(d.by)||!Oi(d.value)&&!Yi(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function i(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=i;let r;(N=>(N[N.Left=0]="Left",N[N.Right=1]="Right",N[N.Up=2]="Up",N[N.Down=3]="Down",N[N.PrevBlankLine=4]="PrevBlankLine",N[N.NextBlankLine=5]="NextBlankLine",N[N.WrappedLineStart=6]="WrappedLineStart",N[N.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",N[N.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",N[N.WrappedLineEnd=9]="WrappedLineEnd",N[N.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",N[N.ViewPortTop=11]="ViewPortTop",N[N.ViewPortCenter=12]="ViewPortCenter",N[N.ViewPortBottom=13]="ViewPortBottom",N[N.ViewPortIfOutside=14]="ViewPortIfOutside"))(r=a.Direction||={});let s;(m=>(m[m.None=0]="None",m[m.Line=1]="Line",m[m.WrappedLine=2]="WrappedLine",m[m.Character=3]="Character",m[m.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(Fe||={});function rU(o,e,t){let n=o.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let i,r=-1;for(i=e-1;i>=1;i--){if(o.tokenization.getLanguageIdAtPosition(i,0)!==n)return r;let s=o.getLineContent(i);if(t.shouldIgnore(i)||/^\s+$/.test(s)||s===""){r=i;continue}return i}}return-1}function of(o,e,t,n=!0,i){if(o<4)return null;let r=i.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;let s=new jI(e,r,i);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=rU(e,t,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=e.getLineContent(a);return{indentation:kt(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=e.getLineContent(a);return{indentation:kt(l),action:null,line:a}}else{if(a===1)return{indentation:kt(e.getLineContent(a)),action:null,line:a};let l=a-1,d=r.getIndentMetadata(e.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:kt(e.getLineContent(c+1)),action:null,line:c+1}}if(n)return{indentation:kt(e.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:kt(e.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let p=c-1;p>0;p--)if(!s.shouldIndentNextLine(c)){u=p;break}return{indentation:kt(e.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:kt(e.getLineContent(c)),action:null,line:c}}return{indentation:kt(e.getLineContent(1)),action:null,line:1}}}function XA(o,e,t,n,i){if(o<4)return null;let r=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(r).indentRulesSupport;if(!s)return null;e.tokenization.forceTokenization(t.startLineNumber);let l=new Rc(e,i).getProcessedTokenContextAroundRange(t),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=kt(c.getLineContent()),p=sU(e,t.startLineNumber,c),m=qI(e,t.getStartPosition()),f=e.getLineContent(t.startLineNumber),g=kt(f),b=of(o,p,t.startLineNumber+1,void 0,i);if(!b){let I=m?g:u;return{beforeEnter:I,afterEnter:I}}let v=m?g:b.indentation;return b.action===1&&(v=n.shiftIndent(v)),s.shouldDecrease(d.getLineContent())&&(v=n.unshiftIndent(v)),{beforeEnter:m?g:u,afterEnter:v}}function ZA(o,e,t,n,i,r){let s=o.autoIndent;if(s<4||qI(e,t.getStartPosition()))return null;let l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),d=r.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new Rc(e,r).getProcessedTokenContextAroundRange(t),p=u.beforeRangeProcessedTokens.getLineContent(),m=u.afterRangeProcessedTokens.getLineContent(),f=p+m,g=p+n+m;if(!d.shouldDecrease(f)&&d.shouldDecrease(g)){let v=of(s,e,t.startLineNumber,!1,r);if(!v)return null;let I=v.indentation;return v.action!==1&&(I=i.unshiftIndent(I)),I}let b=t.startLineNumber-1;if(b>0){let v=e.getLineContent(b);if(d.shouldIndentNextLine(v)&&d.shouldIncrease(g)){let C=of(s,e,t.startLineNumber,!1,r)?.indentation;if(C!==void 0){let S=e.getLineContent(t.startLineNumber),_=kt(S),N=i.shiftIndent(C)===_,F=/^\s*$/.test(f),P=o.autoClosingPairs.autoClosingPairsOpenByEnd.get(n),U=P&&P.length>0&&F;if(N&&U)return C}}}return null}function sU(o,e,t){return{tokenization:{getLineTokens:i=>i===e?t:o.tokenization.getLineTokens(i),getLanguageId:()=>o.getLanguageId(),getLanguageIdAtPosition:(i,r)=>o.getLanguageIdAtPosition(i,r)},getLineContent:i=>i===e?t.getLineContent():o.getLineContent(i)}}var jI=class{_indentRulesSupport;_indentationLineProcessor;constructor(e,t,n){this._indentRulesSupport=t,this._indentationLineProcessor=new YI(e,n)}shouldIncrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(n)}shouldDecrease(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(n)}shouldIgnore(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(n)}shouldIndentNextLine(e,t){let n=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(n)}},Rc=class{model;indentationLineProcessor;constructor(e,t){this.model=e,this.indentationLineProcessor=new YI(e,t)}getProcessedTokenContextAroundRange(e){let t=this._getProcessedTokensBeforeRange(e),n=this._getProcessedTokensAfterRange(e),i=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:n,previousLineProcessedTokens:i}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);let t=this.model.tokenization.getLineTokens(e.startLineNumber),n=Ys(t,e.startColumn-1),i;if(qI(this.model,e.getStartPosition())){let s=e.startColumn-1-n.firstCharOffset,a=n.firstCharOffset,l=a+s;i=t.sliceAndInflate(a,l,0)}else{let s=e.startColumn-1;i=t.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(i)}_getProcessedTokensAfterRange(e){let t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);let n=this.model.tokenization.getLineTokens(t.lineNumber),i=Ys(n,t.column-1),r=t.column-1-i.firstCharOffset,s=i.firstCharOffset+r,a=i.firstCharOffset+i.getLineLength(),l=n.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){let t=m=>{this.model.tokenization.forceTokenization(m);let f=this.model.tokenization.getLineTokens(m),g=this.model.getLineMaxColumn(m)-1;return Ys(f,g)};this.model.tokenization.forceTokenization(e.startLineNumber);let n=this.model.tokenization.getLineTokens(e.startLineNumber),i=Ys(n,e.startColumn-1),r=en.createEmpty("",i.languageIdCodec),s=e.startLineNumber-1;if(s===0||!(i.firstCharOffset===0))return r;let d=t(s);if(!(i.languageId===d.languageId))return r;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},YI=class{constructor(e,t){this.model=e;this.languageConfigurationService=t}getProcessedLine(e,t){let n=(s,a)=>{let l=kt(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(e);let i=this.model.tokenization.getLineTokens(e),r=this.getProcessedTokens(i).getLineContent();return t!==void 0&&(r=n(r,t)),r}getProcessedTokens(e){let t=l=>l===2||l===3||l===1,n=e.getLanguageId(0),r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getBracketRegExp({global:!0}),s=[];return e.forEach(l=>{let d=e.getStandardTokenType(l),c=e.getTokenText(l);t(d)&&(c=c.replace(r,""));let u=e.getMetadata(l);s.push({text:c,metadata:u})}),en.createFromTextAndMetadata(s,e.languageIdCodec)}};function qI(o,e){o.tokenization.forceTokenization(e.lineNumber);let t=o.tokenization.getLineTokens(e.lineNumber),n=Ys(t,e.column-1),i=n.firstCharOffset===0,r=t.getLanguageId(0)===n.languageId;return!i&&!r}function rf(o,e,t,n){e.tokenization.forceTokenization(t.startLineNumber);let i=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(i);if(!r)return null;let a=new Rc(e,n).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=r.onEnter(o,l,d,c);if(!u)return null;let p=u.indentAction,m=u.appendText,f=u.removeText||0;m?p===1&&(m="	"+m):p===1||p===2?m="	":m="";let g=tI(e,t.startLineNumber,t.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:p,appendText:m,removeText:f,indentation:g}}var b1=Object.create(null);function Mc(o,e){if(e<=0)return"";b1[o]||(b1[o]=["",o]);let t=b1[o];for(let n=t.length;n<=e;n++)t[n]=t[n-1]+o;return t[e]}var No=class{constructor(e,t,n){this._languageConfigurationService=n;this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,r){let s=Ct.visibleColumnFromColumn(e,t,n);if(r){let a=Mc(" ",i),d=Ct.prevIndentTabStop(s,i)/i;return Mc(a,d)}else{let a="	",d=Ct.prevRenderTabStop(s,n)/n;return Mc(a,d)}}static shiftIndent(e,t,n,i,r){let s=Ct.visibleColumnFromColumn(e,t,n);if(r){let a=Mc(" ",i),d=Ct.nextIndentTabStop(s,i)/i;return Mc(a,d)}else{let a="	",d=Ct.nextRenderTabStop(s,n)/n;return Mc(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){let n=this._selection.startLineNumber,i=this._selection.endLineNumber;this._selection.endColumn===1&&n!==i&&(i=i-1);let{tabSize:r,indentSize:s,insertSpaces:a}=this._opts,l=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=n;u<=i;u++,d=c){c=0;let p=e.getLineContent(u),m=zt(p);if(this._opts.isUnshift&&(p.length===0||m===0)||!l&&!this._opts.isUnshift&&p.length===0)continue;if(m===-1&&(m=p.length),u>1&&Ct.visibleColumnFromColumn(p,m+1,r)%s!==0&&e.tokenization.isCheapToTokenize(u-1)){let b=rf(this._opts.autoIndent,e,new w(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let v=0,I=b.appendText.length;v<I&&c<s&&b.appendText.charCodeAt(v)===32;v++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let v=0;v<c&&!(m===0||p.charCodeAt(m-1)!==32);v++)m--}}if(this._opts.isUnshift&&m===0)continue;let f;this._opts.isUnshift?f=No.unshiftIndent(p,m+1,r,s,a):f=No.shiftIndent(p,m+1,r,s,a),this._addEditOperation(t,new w(u,1,u,m+1),f),u===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=m+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(n)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?Mc(" ",s):"	";for(let c=n;c<=i;c++){let u=e.getLineContent(c),p=zt(u);if(!(this._opts.isUnshift&&(u.length===0||p===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(p===-1&&(p=u.length),!(this._opts.isUnshift&&p===0)))if(this._opts.isUnshift){p=Math.min(p,s);for(let m=0;m<p;m++)if(u.charCodeAt(m)===9){p=m+1;break}this._addEditOperation(t,new w(c,1,c,p+1),"")}else this._addEditOperation(t,new w(c,1,c,1),d),c===n&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let i=t.getInverseEditOperations()[0];return new Me(i.range.endLineNumber,i.range.endColumn,i.range.endLineNumber,i.range.endColumn)}let n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let i=this._selection.startColumn;return n.startColumn<=i?n:n.getDirection()===0?new Me(n.startLineNumber,i,n.endLineNumber,n.endColumn):new Me(n.endLineNumber,n.endColumn,n.startLineNumber,i)}return n}};No=K([D(2,Dn)],No);var XI=class{_range;_charBeforeSelection;_charAfterSelection;constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new w(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new w(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,r=n[1].range;return new Me(i.endLineNumber,i.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}},ZI=class{constructor(e,t,n){this._position=e;this._text=t;this._charAfter=n}getEditOperations(e,t){t.addTrackedEditOperation(new w(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return new Me(i.endLineNumber,i.startColumn,i.endLineNumber,i.endColumn-this._charAfter.length)}};var QI=class{static getEdits(e,t,n,i,r){if(!r&&this._isAutoIndentType(e,t,n)){let s=[];for(let l of n){let d=this._findActualIndentationForSelection(e,t,l,i);if(d===null)return;s.push({selection:l,indentation:d})}let a=Np.getAutoClosingPairClose(e,t,n,i,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,s,i,a)}}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,r=n.length;i<r;i++)if(!t.tokenization.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,n,i){let r=ZA(e,t,n,i,{shiftIndent:a=>sf(e,a),unshiftIndent:a=>Fp(e,a)},e.languageConfigurationService);if(r===null)return null;let s=tI(t,n.startLineNumber,n.startColumn);return r===e.normalizeIndentation(s)?null:r}static _getIndentationAndAutoClosingPairEdits(e,t,n,i,r){let s=n.map(({selection:l,indentation:d})=>{if(r!==null){let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!1);return new y1(c,l,i,r)}else{let c=this._getEditFromIndentationAndSelection(e,t,d,l,i,!0);return Pc(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Sn(4,s,a)}static _getEditFromIndentationAndSelection(e,t,n,i,r,s=!0){let a=i.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a),d=e.normalizeIndentation(n);if(l!==0){let u=t.getLineContent(a);d+=u.substring(l-1,i.startColumn-1)}return d+=s?r:"",{range:new w(a,1,i.endLineNumber,i.endColumn),text:d}}},JI=class{static getEdits(e,t,n,i,r,s){if(eF(t,n,i,r,s))return this._runAutoClosingOvertype(e,i,s)}static _runAutoClosingOvertype(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let l=t[r].getPosition(),d=new w(l.lineNumber,l.column,l.lineNumber,l.column+1);i[r]=new ti(d,n)}return new Sn(4,i,{shouldPushStackElementBefore:lC(e,4),shouldPushStackElementAfter:!1})}},eC=class{static getEdits(e,t,n,i,r){if(eF(e,t,n,i,r)){let s=n.map(a=>new ti(new w(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Sn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},Np=class{static getEdits(e,t,n,i,r,s){if(!s){let a=this.getAutoClosingPairClose(e,t,n,i,r);if(a!==null)return this._runAutoClosingOpenCharType(n,i,r,a)}}static _runAutoClosingOpenCharType(e,t,n,i){let r=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];r[s]=new v1(l,t,!n,i)}return new Sn(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,n,i,r){for(let f of n)if(!f.isEmpty())return null;let s=n.map(f=>{let g=f.getPosition();return r?{lineNumber:g.lineNumber,beforeColumn:g.column-i.length,afterColumn:g.column}:{lineNumber:g.lineNumber,beforeColumn:g.column,afterColumn:g.column}}),a=this._findAutoClosingPairOpen(e,t,s.map(f=>new M(f.lineNumber,f.beforeColumn)),i);if(!a)return null;let l,d;if(es(i)?(l=e.autoClosingQuotes,d=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,d=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,d=e.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(e,a),p=u?u.close:"",m=!0;for(let f of s){let{lineNumber:g,beforeColumn:b,afterColumn:v}=f,I=t.getLineContent(g),C=I.substring(0,b-1),S=I.substring(v-1);if(S.startsWith(p)||(m=!1),S.length>0){let F=S.charAt(0);if(!this._isBeforeClosingBrace(e,S)&&!d(F))return null}if(a.open.length===1&&(i==="'"||i==='"')&&l!=="always"){let F=zs(e.wordSeparators,[]);if(C.length>0){let P=C.charCodeAt(C.length-1);if(F.get(P)===0)return null}}if(!t.tokenization.isCheapToTokenize(g))return null;t.tokenization.forceTokenization(g);let _=t.tokenization.getLineTokens(g),R=Ys(_,b-1);if(!a.shouldAutoClose(R,b-R.firstCharOffset))return null;let N=a.findNeutralCharacter();if(N){let F=t.tokenization.getTokenTypeIfInsertingCharacter(g,b,N);if(!a.isOK(F))return null}}return m?a.close.substring(0,a.close.length-p.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;let n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[],r=null;for(let s of i)s.open!==t.open&&t.open.includes(s.open)&&t.close.endsWith(s.close)&&(!r||s.open.length>r.open.length)&&(r=s);return r}static _findAutoClosingPairOpen(e,t,n,i){let r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let s=null;for(let a of r)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of n)if(t.getValueInRange(new w(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+i!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(e,t){let n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],s=i.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!s&&a}},tC=class{static getEdits(e,t,n,i,r){if(!r&&this._isSurroundSelectionType(e,t,n,i))return this._runSurroundSelectionType(e,n,i)}static _runSurroundSelectionType(e,t,n){let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=e.surroundingPairs[n];i[r]=new XI(a,n,l)}return new Sn(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,n,i){if(!C1(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;let r=es(i);for(let s of n){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=t.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,p=d.substring(c,u);if(/[^ \t]/.test(p)){a=!1;break}}if(a)return!1;if(r&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=t.getValueInRange(s);if(es(l))return!1}}return!0}},nC=class{static getEdits(e,t,n,i,r,s){if(!s&&this._isTypeInterceptorElectricChar(t,n,i)){let a=this._typeInterceptorElectricChar(e,t,n,i[0],r);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,n){return!!(n.length===1&&t.tokenization.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,r){if(!t.electricChars.hasOwnProperty(r)||!i.isEmpty())return null;let s=i.getPosition();n.tokenization.forceTokenization(s.lineNumber);let a=n.tokenization.getLineTokens(s.lineNumber),l;try{l=t.onElectricCharacter(r,a,s.column)}catch(d){return We(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,c=n.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=n.getLineContent(c.startLineNumber),p=kt(u),m=t.normalizeIndentation(p),f=n.getLineContent(s.lineNumber),g=n.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=f.substring(g-1,s.column-1),v=m+b+r,I=new w(s.lineNumber,1,s.lineNumber,s.column),C=new ti(I,v);return new Sn(I1(v,e),[C],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},iC=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new ti(t[s],n);let r=I1(n,e);return new Sn(r,i,{shouldPushStackElementBefore:lC(e,r),shouldPushStackElementAfter:!1})}},Op=class{static getEdits(e,t,n,i,r){if(!r&&i===`
`){let s=[];for(let a=0,l=n.length;a<l;a++)s[a]=this._enter(e,t,!1,n[a]);return new Sn(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,n,i){if(e.autoIndent===0)return Pc(i,`
`,n);if(!t.tokenization.isCheapToTokenize(i.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(i.startLineNumber),d=kt(l).substring(0,i.startColumn-1);return Pc(i,`
`+e.normalizeIndentation(d),n)}let r=rf(e.autoIndent,t,i,e.languageConfigurationService);if(r){if(r.indentAction===0)return Pc(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===1)return Pc(i,`
`+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===2){let l=e.normalizeIndentation(r.indentation),d=e.normalizeIndentation(r.indentation+r.appendText),c=`
`+d+`
`+l;return n?new Lc(i,c,!0):new Dc(i,c,-1,d.length-l.length,!0)}else if(r.indentAction===3){let l=Fp(e,r.indentation);return Pc(i,`
`+e.normalizeIndentation(l+r.appendText),n)}}let s=t.getLineContent(i.startLineNumber),a=kt(s).substring(0,i.startColumn-1);if(e.autoIndent>=4){let l=XA(e.autoIndent,t,i,{unshiftIndent:d=>Fp(e,d),shiftIndent:d=>sf(e,d),normalizeIndentation:d=>e.normalizeIndentation(d)},e.languageConfigurationService);if(l){let d=e.visibleColumnFromColumn(t,i.getEndPosition()),c=i.endColumn,u=t.getLineContent(i.endLineNumber),p=zt(u);if(p>=0?i=i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,p+1)):i=i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new Lc(i,`
`+e.normalizeIndentation(l.afterEnter),!0);{let m=0;return c<=p+1&&(e.insertSpaces||(d=Math.ceil(d/e.indentSize)),m=Math.min(d+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new Dc(i,`
`+e.normalizeIndentation(l.afterEnter),0,m,!0)}}}return Pc(i,`
`+e.normalizeIndentation(a),n)}static lineInsertBefore(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber;if(a===1)i[r]=new Lc(new w(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new w(a,l,a,l))}}return i}static lineInsertAfter(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r].positionLineNumber,l=t.getLineMaxColumn(a);i[r]=this._enter(e,t,!1,new w(a,l,a,l))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=this._enter(e,t,!0,n[r]);return i}},oC=class{static getEdits(e,t,n,i,r,s){let a=this._distributePasteToCursors(e,n,i,r,s);return a?(n=n.sort(w.compareRangesUsingStarts),this._distributedPaste(e,t,n,a)):this._simplePaste(e,t,n,i,r)}static _distributePasteToCursors(e,t,n,i,r){if(i||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){n.charCodeAt(n.length-1)===10&&(n=n.substring(0,n.length-1)),n.charCodeAt(n.length-1)===13&&(n=n.substring(0,n.length-1));let s=Nr(n);if(s.length===t.length)return s}return null}static _distributedPaste(e,t,n,i){let r=[];for(let s=0,a=n.length;s<a;s++)r[s]=new ti(n[s],i[s]);return new Sn(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let s=[];for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.getPosition();if(r&&!d.isEmpty()&&(r=!1),r&&i.indexOf(`
`)!==i.length-1&&(r=!1),r){let u=new w(c.lineNumber,1,c.lineNumber,1);s[a]=new GI(u,i,d,!0)}else s[a]=new ti(d,i)}return new Sn(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},rC=class{static getEdits(e,t,n,i,r,s,a,l){let d=i.map(c=>this._compositionType(n,c,r,s,a,l));return new Sn(4,d,{shouldPushStackElementBefore:lC(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,s){if(!t.isEmpty())return null;let a=t.getPosition(),l=Math.max(1,a.column-i),d=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),c=new w(a.lineNumber,l,a.lineNumber,d);return e.getValueInRange(c)===n&&s===0?null:new Dc(c,n,0,s)}},sC=class{static getEdits(e,t,n){let i=[];for(let s=0,a=t.length;s<a;s++)i[s]=new ti(t[s],n);let r=I1(n,e);return new Sn(r,i,{shouldPushStackElementBefore:lC(e,r),shouldPushStackElementAfter:!1})}},aC=class{static getCommands(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++){let a=n[r];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(e,t,a.startLineNumber);d=d||"	";let c=e.normalizeIndentation(d);if(!l.startsWith(c)){i[r]=new ti(new w(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){i[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}i[r]=new No(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return i}static _goodIndentForLine(e,t,n){let i=null,r="",s=of(e.autoIndent,t,n,!1,e.languageConfigurationService);if(s)i=s.action,r=s.indentation;else if(n>1){let a;for(a=n-1;a>=1;a--){let c=t.getLineContent(a);if(qo(c)>=0)break}if(a<1)return null;let l=t.getLineMaxColumn(a),d=rf(e.autoIndent,t,new w(a,l,a,l),e.languageConfigurationService);d&&(r=d.indentation+d.appendText)}return i&&(i===1&&(r=sf(e,r)),i===3&&(r=Fp(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",s=n.getStartPosition();if(e.insertSpaces){let a=e.visibleColumnFromColumn(t,s),l=e.indentSize,d=l-a%l;for(let c=0;c<d;c++)r+=" "}else r="	";return new ti(n,r,i)}},Ap=class extends Dc{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(e,t,n,i,r,s){super(e,t,n,i),this._openCharacter=r,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,n){return this.closeCharacterRange=new w(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new w(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,n)}},v1=class extends Ap{constructor(e,t,n,i){let r=(n?t:"")+i,s=0,a=-i.length;super(e,r,s,a,t,i)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,i,t)}},y1=class extends Ap{_autoIndentationEdit;_autoClosingEdit;constructor(e,t,n,i){let r=n+i,s=0,a=n.length;super(t,r,s,a,n,i),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:r}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length!==2)throw new Error("There should be two inverse edit operations!");let i=n[0].range,r=n[1].range,s=i.plusRange(r);return this._computeCursorStateWithRange(e,s,t)}};function I1(o,e){return o===" "?e===5||e===6?6:5:4}function lC(o,e){return JA(o)&&!JA(e)?!0:o===5?!1:QA(o)!==QA(e)}function QA(o){return o===6||o===5?"space":o}function JA(o){return o===4||o===5||o===6}function eF(o,e,t,n,i){if(o.autoClosingOvertype==="never"||!o.autoClosingPairs.autoClosingPairsCloseSingleChar.has(i))return!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(!a.isEmpty())return!1;let l=a.getPosition(),d=e.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==i)return!1;let u=es(i);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(o.autoClosingOvertype==="auto"){let m=!1;for(let f=0,g=n.length;f<g;f++){let b=n[f];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){m=!0;break}}if(!m)return!1}}return!0}function Pc(o,e,t){return t?new Lc(o,e,!0):new ti(o,e,!0)}function sf(o,e,t){return t=t||1,No.shiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function Fp(o,e,t){return t=t||1,No.unshiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function C1(o,e){return es(e)?o.autoSurround==="quotes"||o.autoSurround==="languageDefined":o.autoSurround==="brackets"||o.autoSurround==="languageDefined"}var as=class{static indent(e,t,n){if(t===null||n===null)return[];let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new No(n[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static outdent(e,t,n){let i=[];for(let r=0,s=n.length;r<s;r++)i[r]=new No(n[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return i}static shiftIndent(e,t,n){return sf(e,t,n)}static unshiftIndent(e,t,n){return Fp(e,t,n)}static paste(e,t,n,i,r,s){return oC.getEdits(e,t,n,i,r,s)}static tab(e,t,n){return aC.getCommands(e,t,n)}static compositionType(e,t,n,i,r,s,a,l){return rC.getEdits(e,t,n,i,r,s,a,l)}static compositionEndWithInterceptors(e,t,n,i,r,s){if(!i)return null;let a=null;for(let p of i)if(a===null)a=p.insertedText;else if(a!==p.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let p of i)if(p.deletedText.length!==0){d=!0;break}if(d){if(!C1(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;let p=es(l);for(let g of i)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||p&&es(g.deletedText))return null;let m=[];for(let g of r){if(!g.isEmpty())return null;m.push(g.getPosition())}if(m.length!==i.length)return null;let f=[];for(let g=0,b=m.length;g<b;g++)f.push(new ZI(m[g],i[g].deletedText,t.surroundingPairs[l]));return new Sn(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=eC.getEdits(t,n,r,s,l);if(c!==void 0)return c;let u=Np.getEdits(t,n,r,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(e,t,n,i,r,s,a){let l=Op.getEdits(n,i,r,a,e);if(l!==void 0)return l;let d=QI.getEdits(n,i,r,a,e);if(d!==void 0)return d;let c=JI.getEdits(t,n,i,r,s,a);if(c!==void 0)return c;let u=Np.getEdits(n,i,r,a,!1,e);if(u!==void 0)return u;let p=tC.getEdits(n,i,r,a,e);if(p!==void 0)return p;let m=nC.getEdits(t,n,i,r,a,e);return m!==void 0?m:iC.getEdits(t,r,a)}static typeWithoutInterceptors(e,t,n,i,r){return sC.getEdits(e,i,r)}},dC=class{constructor(e,t,n,i,r,s){this.deletedText=e;this.deletedSelectionStart=t;this.deletedSelectionEnd=n;this.insertedText=i;this.insertedSelectionStart=r;this.insertedSelectionEnd=s}};var ie;(Oe=>(Oe.editorSimpleInput=new me("editorSimpleInput",!1,!0),Oe.editorTextFocus=new me("editorTextFocus",!1,h("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),Oe.focus=new me("editorFocus",!1,h("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),Oe.textInputFocus=new me("textInputFocus",!1,h("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),Oe.readOnly=new me("editorReadonly",!1,h("editorReadonly","Whether the editor is read-only")),Oe.inDiffEditor=new me("inDiffEditor",!1,h("inDiffEditor","Whether the context is a diff editor")),Oe.isEmbeddedDiffEditor=new me("isEmbeddedDiffEditor",!1,h("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),Oe.multiDiffEditorAllCollapsed=new me("multiDiffEditorAllCollapsed",void 0,h("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),Oe.hasChanges=new me("diffEditorHasChanges",!1,h("diffEditorHasChanges","Whether the diff editor has changes")),Oe.comparingMovedCode=new me("comparingMovedCode",!1,h("comparingMovedCode","Whether a moved code block is selected for comparison")),Oe.accessibleDiffViewerVisible=new me("accessibleDiffViewerVisible",!1,h("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),Oe.diffEditorRenderSideBySideInlineBreakpointReached=new me("diffEditorRenderSideBySideInlineBreakpointReached",!1,h("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),Oe.diffEditorInlineMode=new me("diffEditorInlineMode",!1,h("diffEditorInlineMode","Whether inline mode is active")),Oe.diffEditorOriginalWritable=new me("diffEditorOriginalWritable",!1,h("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),Oe.diffEditorModifiedWritable=new me("diffEditorModifiedWritable",!1,h("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),Oe.diffEditorOriginalUri=new me("diffEditorOriginalUri","",h("diffEditorOriginalUri","The uri of the original document")),Oe.diffEditorModifiedUri=new me("diffEditorModifiedUri","",h("diffEditorModifiedUri","The uri of the modified document")),Oe.columnSelection=new me("editorColumnSelection",!1,h("editorColumnSelection","Whether `editor.columnSelection` is enabled")),Oe.writable=Oe.readOnly.toNegated(),Oe.hasNonEmptySelection=new me("editorHasSelection",!1,h("editorHasSelection","Whether the editor has text selected")),Oe.hasOnlyEmptySelection=Oe.hasNonEmptySelection.toNegated(),Oe.hasMultipleSelections=new me("editorHasMultipleSelections",!1,h("editorHasMultipleSelections","Whether the editor has multiple selections")),Oe.hasSingleSelection=Oe.hasMultipleSelections.toNegated(),Oe.tabMovesFocus=new me("editorTabMovesFocus",!1,h("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),Oe.tabDoesNotMoveFocus=Oe.tabMovesFocus.toNegated(),Oe.isInEmbeddedEditor=new me("isInEmbeddedEditor",!1,!0),Oe.canUndo=new me("canUndo",!1,!0),Oe.canRedo=new me("canRedo",!1,!0),Oe.hoverVisible=new me("editorHoverVisible",!1,h("editorHoverVisible","Whether the editor hover is visible")),Oe.hoverFocused=new me("editorHoverFocused",!1,h("editorHoverFocused","Whether the editor hover is focused")),Oe.stickyScrollFocused=new me("stickyScrollFocused",!1,h("stickyScrollFocused","Whether the sticky scroll is focused")),Oe.stickyScrollVisible=new me("stickyScrollVisible",!1,h("stickyScrollVisible","Whether the sticky scroll is visible")),Oe.standaloneColorPickerVisible=new me("standaloneColorPickerVisible",!1,h("standaloneColorPickerVisible","Whether the standalone color picker is visible")),Oe.standaloneColorPickerFocused=new me("standaloneColorPickerFocused",!1,h("standaloneColorPickerFocused","Whether the standalone color picker is focused")),Oe.inCompositeEditor=new me("inCompositeEditor",void 0,h("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),Oe.notInCompositeEditor=Oe.inCompositeEditor.toNegated(),Oe.languageId=new me("editorLangId","",h("editorLangId","The language identifier of the editor")),Oe.hasCompletionItemProvider=new me("editorHasCompletionItemProvider",!1,h("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),Oe.hasCodeActionsProvider=new me("editorHasCodeActionsProvider",!1,h("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),Oe.hasCodeLensProvider=new me("editorHasCodeLensProvider",!1,h("editorHasCodeLensProvider","Whether the editor has a code lens provider")),Oe.hasDefinitionProvider=new me("editorHasDefinitionProvider",!1,h("editorHasDefinitionProvider","Whether the editor has a definition provider")),Oe.hasDeclarationProvider=new me("editorHasDeclarationProvider",!1,h("editorHasDeclarationProvider","Whether the editor has a declaration provider")),Oe.hasImplementationProvider=new me("editorHasImplementationProvider",!1,h("editorHasImplementationProvider","Whether the editor has an implementation provider")),Oe.hasTypeDefinitionProvider=new me("editorHasTypeDefinitionProvider",!1,h("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),Oe.hasHoverProvider=new me("editorHasHoverProvider",!1,h("editorHasHoverProvider","Whether the editor has a hover provider")),Oe.hasDocumentHighlightProvider=new me("editorHasDocumentHighlightProvider",!1,h("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),Oe.hasDocumentSymbolProvider=new me("editorHasDocumentSymbolProvider",!1,h("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),Oe.hasReferenceProvider=new me("editorHasReferenceProvider",!1,h("editorHasReferenceProvider","Whether the editor has a reference provider")),Oe.hasRenameProvider=new me("editorHasRenameProvider",!1,h("editorHasRenameProvider","Whether the editor has a rename provider")),Oe.hasSignatureHelpProvider=new me("editorHasSignatureHelpProvider",!1,h("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),Oe.hasInlayHintsProvider=new me("editorHasInlayHintsProvider",!1,h("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),Oe.hasDocumentFormattingProvider=new me("editorHasDocumentFormattingProvider",!1,h("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),Oe.hasDocumentSelectionFormattingProvider=new me("editorHasDocumentSelectionFormattingProvider",!1,h("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),Oe.hasMultipleDocumentFormattingProvider=new me("editorHasMultipleDocumentFormattingProvider",!1,h("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),Oe.hasMultipleDocumentSelectionFormattingProvider=new me("editorHasMultipleDocumentSelectionFormattingProvider",!1,h("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(ie||={});var it=0,Bt=class extends na{runEditorCommand(e,t,n){let i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}},ni;(a=>{let o=function(l){if(!Ht(l))return!1;let d=l;return!(!Lt(d.to)||!Oi(d.by)&&!Lt(d.by)||!Oi(d.value)&&!Yi(d.value)||!Oi(d.revealCursor)&&!Sv(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:o,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function i(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),p=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:p,select:!!l.select}}a.parse=i;let r;(p=>(p[p.Up=1]="Up",p[p.Right=2]="Right",p[p.Down=3]="Down",p[p.Left=4]="Left"))(r=a.Direction||={});let s;(f=>(f[f.Line=1]="Line",f[f.WrappedLine=2]="WrappedLine",f[f.Page=3]="Page",f[f.HalfPage=4]="HalfPage",f[f.Editor=5]="Editor",f[f.Column=6]="Column"))(s=a.Unit||={})})(ni||={});var af;(n=>{let o=function(i){if(!Ht(i))return!1;let r=i;return!(!Yi(r.lineNumber)&&!Lt(r.lineNumber)||!Oi(r.at)&&!Lt(r.at))};n.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:o,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(af||={});var lf=class{constructor(e){e.addImplementation(1e4,"code-editor",(t,n)=>{let i=t.get(ta).getFocusedCodeEditor();return i&&i.hasTextFocus()?this._runEditorCommand(t,i,n):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,n)=>{let i=Ji();return i&&As(i)?(this.runDOMCommand(i),!0):!1}),e.addImplementation(0,"generic-dom",(t,n)=>{let i=t.get(ta).getActiveCodeEditor();return i?(i.focus(),this._runEditorCommand(t,i,n)):!1})}_runEditorCommand(e,t,n){let i=this.runEditorCommand(e,t,n);return i||!0}};var _n;(pe=>{class o extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){if(!J.position)return;O.model.pushStackElement(),O.setCursorStates(J.source,3,[kn.moveTo(O,O.getPrimaryCursorState(),this._inSelectionMode,J.position,J.viewPosition)])&&J.revealType!==2&&O.revealAllCursors(J.source,!0,!0)}}pe.MoveTo=be(new o({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),pe.MoveToSelect=be(new o({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends Bt{runCoreEditorCommand(O,J){O.model.pushStackElement();let ce=this._getColumnSelectResult(O,O.getPrimaryCursorState(),O.getCursorColumnSelectData(),J);ce!==null&&(O.setCursorStates(J.source,3,ce.viewStates.map(qe=>Ke.fromViewState(qe))),O.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:ce.fromLineNumber,fromViewVisualColumn:ce.fromVisualColumn,toViewLineNumber:ce.toLineNumber,toViewVisualColumn:ce.toVisualColumn}),ce.reversed?O.revealTopMostCursor(J.source):O.revealBottomMostCursor(J.source))}}pe.ColumnSelect=be(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(re,O,J,ce){if(typeof ce.position>"u"||typeof ce.viewPosition>"u"||typeof ce.mouseColumn>"u")return null;let qe=re.model.validatePosition(ce.position),vt=re.coordinatesConverter.validateViewPosition(new M(ce.viewPosition.lineNumber,ce.viewPosition.column),qe),On=ce.doColumnSelect?J.fromViewLineNumber:vt.lineNumber,di=ce.doColumnSelect?J.fromViewVisualColumn:ce.mouseColumn-1;return rd.columnSelect(re.cursorConfig,re,On,di,vt.lineNumber,ce.mouseColumn-1)}}),pe.CursorColumnSelectLeft=be(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(re,O,J,ce){return rd.columnSelectLeft(re.cursorConfig,re,J)}}),pe.CursorColumnSelectRight=be(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(re,O,J,ce){return rd.columnSelectRight(re.cursorConfig,re,J)}});class a extends n{_isPaged;constructor(O){super(O),this._isPaged=O.isPaged}_getColumnSelectResult(O,J,ce,qe){return rd.columnSelectUp(O.cursorConfig,O,ce,this._isPaged)}}pe.CursorColumnSelectUp=be(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3600,linux:{primary:0}}})),pe.CursorColumnSelectPageUp=be(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends n{_isPaged;constructor(O){super(O),this._isPaged=O.isPaged}_getColumnSelectResult(O,J,ce,qe){return rd.columnSelectDown(O.cursorConfig,O,ce,this._isPaged)}}pe.CursorColumnSelectDown=be(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3602,linux:{primary:0}}})),pe.CursorColumnSelectPageDown=be(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3596,linux:{primary:0}}}));class m extends Bt{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Fe.metadata})}runCoreEditorCommand(O,J){let ce=Fe.parse(J);ce&&this._runCursorMove(O,J.source,ce)}_runCursorMove(O,J,ce){O.model.pushStackElement(),O.setCursorStates(J,3,m._move(O,O.getCursorStates(),ce)),O.revealAllCursors(J,!0)}static _move(O,J,ce){let qe=ce.select,vt=ce.value;switch(ce.direction){case Fe.Direction.Left:case Fe.Direction.Right:case Fe.Direction.Up:case Fe.Direction.Down:case Fe.Direction.PrevBlankLine:case Fe.Direction.NextBlankLine:case Fe.Direction.WrappedLineStart:case Fe.Direction.WrappedLineFirstNonWhitespaceCharacter:case Fe.Direction.WrappedLineColumnCenter:case Fe.Direction.WrappedLineEnd:case Fe.Direction.WrappedLineLastNonWhitespaceCharacter:return kn.simpleMove(O,J,ce.direction,qe,vt,ce.unit);case Fe.Direction.ViewPortTop:case Fe.Direction.ViewPortBottom:case Fe.Direction.ViewPortCenter:case Fe.Direction.ViewPortIfOutside:return kn.viewportMove(O,J,ce.direction,qe,vt);default:return null}}}pe.CursorMoveImpl=m,pe.CursorMove=be(new m);let g;(O=>O[O.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(g||={});class b extends Bt{_staticArgs;constructor(O){super(O),this._staticArgs=O.args}runCoreEditorCommand(O,J){let ce=this._staticArgs;this._staticArgs.value===-1&&(ce={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:J.pageSize||O.cursorConfig.pageSize}),O.model.pushStackElement(),O.setCursorStates(J.source,3,kn.simpleMove(O,O.getCursorStates(),ce.direction,ce.select,ce.value,ce.unit)),O.revealAllCursors(J.source,!0)}}pe.CursorLeft=be(new b({args:{direction:Fe.Direction.Left,unit:Fe.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),pe.CursorLeftSelect=be(new b({args:{direction:Fe.Direction.Left,unit:Fe.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1039}})),pe.CursorRight=be(new b({args:{direction:Fe.Direction.Right,unit:Fe.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),pe.CursorRightSelect=be(new b({args:{direction:Fe.Direction.Right,unit:Fe.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1041}})),pe.CursorUp=be(new b({args:{direction:Fe.Direction.Up,unit:Fe.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),pe.CursorUpSelect=be(new b({args:{direction:Fe.Direction.Up,unit:Fe.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),pe.CursorPageUp=be(new b({args:{direction:Fe.Direction.Up,unit:Fe.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:11}})),pe.CursorPageUpSelect=be(new b({args:{direction:Fe.Direction.Up,unit:Fe.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1035}})),pe.CursorDown=be(new b({args:{direction:Fe.Direction.Down,unit:Fe.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),pe.CursorDownSelect=be(new b({args:{direction:Fe.Direction.Down,unit:Fe.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),pe.CursorPageDown=be(new b({args:{direction:Fe.Direction.Down,unit:Fe.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:12}})),pe.CursorPageDownSelect=be(new b({args:{direction:Fe.Direction.Down,unit:Fe.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1036}})),pe.CreateCursor=be(new class extends Bt{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(re,O){if(!O.position)return;let J;O.wholeLine?J=kn.line(re,re.getPrimaryCursorState(),!1,O.position,O.viewPosition):J=kn.moveTo(re,re.getPrimaryCursorState(),!1,O.position,O.viewPosition);let ce=re.getCursorStates();if(ce.length>1){let qe=J.modelState?J.modelState.position:null,vt=J.viewState?J.viewState.position:null;for(let On=0,di=ce.length;On<di;On++){let Be=ce[On];if(!(qe&&!Be.modelState.selection.containsPosition(qe))&&!(vt&&!Be.viewState.selection.containsPosition(vt))){ce.splice(On,1),re.model.pushStackElement(),re.setCursorStates(O.source,3,ce);return}}}ce.push(J),re.model.pushStackElement(),re.setCursorStates(O.source,3,ce)}}),pe.LastCursorMoveToSelect=be(new class extends Bt{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(re,O){if(!O.position)return;let J=re.getLastAddedCursorIndex(),ce=re.getCursorStates(),qe=ce.slice(0);qe[J]=kn.moveTo(re,ce[J],!0,O.position,O.viewPosition),re.model.pushStackElement(),re.setCursorStates(O.source,3,qe)}});class ee extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){O.model.pushStackElement(),O.setCursorStates(J.source,3,kn.moveToBeginningOfLine(O,O.getCursorStates(),this._inSelectionMode)),O.revealAllCursors(J.source,!0)}}pe.CursorHome=be(new ee({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),pe.CursorHomeSelect=be(new ee({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class te extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){O.model.pushStackElement(),O.setCursorStates(J.source,3,this._exec(O.getCursorStates())),O.revealAllCursors(J.source,!0)}_exec(O){let J=[];for(let ce=0,qe=O.length;ce<qe;ce++){let vt=O[ce],On=vt.modelState.position.lineNumber;J[ce]=Ke.fromModelState(vt.modelState.move(this._inSelectionMode,On,1,0))}return J}}pe.CursorLineStart=be(new te({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:0,mac:{primary:287}}})),pe.CursorLineStartSelect=be(new te({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:0,mac:{primary:1311}}}));class Se extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){O.model.pushStackElement(),O.setCursorStates(J.source,3,kn.moveToEndOfLine(O,O.getCursorStates(),this._inSelectionMode,J.sticky||!1)),O.revealAllCursors(J.source,!0)}}pe.CursorEnd=be(new Se({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:it,kbExpr:ie.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),pe.CursorEndSelect=be(new Se({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:it,kbExpr:ie.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class ke extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){O.model.pushStackElement(),O.setCursorStates(J.source,3,this._exec(O,O.getCursorStates())),O.revealAllCursors(J.source,!0)}_exec(O,J){let ce=[];for(let qe=0,vt=J.length;qe<vt;qe++){let On=J[qe],di=On.modelState.position.lineNumber,Be=O.model.getLineMaxColumn(di);ce[qe]=Ke.fromModelState(On.modelState.move(this._inSelectionMode,di,Be,0))}return ce}}pe.CursorLineEnd=be(new ke({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:0,mac:{primary:291}}})),pe.CursorLineEndSelect=be(new ke({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:0,mac:{primary:1315}}}));class $i extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){O.model.pushStackElement(),O.setCursorStates(J.source,3,kn.moveToBeginningOfBuffer(O,O.getCursorStates(),this._inSelectionMode)),O.revealAllCursors(J.source,!0)}}pe.CursorTop=be(new $i({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:2062,mac:{primary:2064}}})),pe.CursorTopSelect=be(new $i({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3086,mac:{primary:3088}}}));class ai extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){O.model.pushStackElement(),O.setCursorStates(J.source,3,kn.moveToEndOfBuffer(O,O.getCursorStates(),this._inSelectionMode)),O.revealAllCursors(J.source,!0)}}pe.CursorBottom=be(new ai({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:2061,mac:{primary:2066}}})),pe.CursorBottomSelect=be(new ai({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:3085,mac:{primary:3090}}}));class ml extends Bt{constructor(){super({id:"editorScroll",precondition:void 0,metadata:ni.metadata})}determineScrollMethod(O){let J=[6],ce=[1,2,3,4,5,6],qe=[4,2],vt=[1,3];return J.includes(O.unit)&&qe.includes(O.direction)?this._runHorizontalEditorScroll.bind(this):ce.includes(O.unit)&&vt.includes(O.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(O,J){let ce=ni.parse(J);if(!ce)return;let qe=this.determineScrollMethod(ce);qe&&qe(O,J.source,ce)}_runVerticalEditorScroll(O,J,ce){let qe=this._computeDesiredScrollTop(O,ce);if(ce.revealCursor){let vt=O.getCompletelyVisibleViewRangeAtScrollTop(qe);O.setCursorStates(J,3,[kn.findPositionInViewportIfOutside(O,O.getPrimaryCursorState(),vt,ce.select)])}O.viewLayout.setScrollPosition({scrollTop:qe},0)}_computeDesiredScrollTop(O,J){if(J.unit===1){let vt=O.viewLayout.getFutureViewport(),On=O.getCompletelyVisibleViewRangeAtScrollTop(vt.top),di=O.coordinatesConverter.convertViewRangeToModelRange(On),Be;J.direction===1?Be=Math.max(1,di.startLineNumber-J.value):Be=Math.min(O.model.getLineCount(),di.startLineNumber+J.value);let E=O.coordinatesConverter.convertModelPositionToViewPosition(new M(Be,1));return O.viewLayout.getVerticalOffsetForLineNumber(E.lineNumber)}if(J.unit===5){let vt=0;return J.direction===3&&(vt=O.model.getLineCount()-O.cursorConfig.pageSize),O.viewLayout.getVerticalOffsetForLineNumber(vt)}let ce;J.unit===3?ce=O.cursorConfig.pageSize*J.value:J.unit===4?ce=Math.round(O.cursorConfig.pageSize/2)*J.value:ce=J.value;let qe=(J.direction===1?-1:1)*ce;return O.viewLayout.getCurrentScrollTop()+qe*O.cursorConfig.lineHeight}_runHorizontalEditorScroll(O,J,ce){let qe=this._computeDesiredScrollLeft(O,ce);O.viewLayout.setScrollPosition({scrollLeft:qe},0)}_computeDesiredScrollLeft(O,J){let ce=(J.direction===4?-1:1)*J.value;return O.viewLayout.getCurrentScrollLeft()+ce*O.cursorConfig.typicalHalfwidthCharacterWidth}}pe.EditorScrollImpl=ml,pe.EditorScroll=be(new ml),pe.ScrollLineUp=be(new class extends Bt{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Up,by:ni.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:O.source})}}),pe.ScrollPageUp=be(new class extends Bt{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Up,by:ni.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:O.source})}}),pe.ScrollEditorTop=be(new class extends Bt{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Up,by:ni.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:O.source})}}),pe.ScrollLineDown=be(new class extends Bt{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Down,by:ni.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:O.source})}}),pe.ScrollPageDown=be(new class extends Bt{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Down,by:ni.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:O.source})}}),pe.ScrollEditorBottom=be(new class extends Bt{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Down,by:ni.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:O.source})}}),pe.ScrollLeft=be(new class extends Bt{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Left,by:ni.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:O.source})}}),pe.ScrollRight=be(new class extends Bt{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus}})}runCoreEditorCommand(re,O){pe.EditorScroll.runCoreEditorCommand(re,{to:ni.RawDirection.Right,by:ni.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:O.source})}});class lr extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){J.position&&(O.model.pushStackElement(),O.setCursorStates(J.source,3,[kn.word(O,O.getPrimaryCursorState(),this._inSelectionMode,J.position)]),J.revealType!==2&&O.revealAllCursors(J.source,!0,!0))}}pe.WordSelect=be(new lr({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),pe.WordSelectDrag=be(new lr({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),pe.LastCursorWordSelect=be(new class extends Bt{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(re,O){if(!O.position)return;let J=re.getLastAddedCursorIndex(),ce=re.getCursorStates(),qe=ce.slice(0),vt=ce[J];qe[J]=kn.word(re,vt,vt.modelState.hasSelection(),O.position),re.model.pushStackElement(),re.setCursorStates(O.source,3,qe)}});class ys extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){J.position&&(O.model.pushStackElement(),O.setCursorStates(J.source,3,[kn.line(O,O.getPrimaryCursorState(),this._inSelectionMode,J.position,J.viewPosition)]),J.revealType!==2&&O.revealAllCursors(J.source,!1,!0))}}pe.LineSelect=be(new ys({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),pe.LineSelectDrag=be(new ys({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class Ho extends Bt{_inSelectionMode;constructor(O){super(O),this._inSelectionMode=O.inSelectionMode}runCoreEditorCommand(O,J){if(!J.position)return;let ce=O.getLastAddedCursorIndex(),qe=O.getCursorStates(),vt=qe.slice(0);vt[ce]=kn.line(O,qe[ce],this._inSelectionMode,J.position,J.viewPosition),O.model.pushStackElement(),O.setCursorStates(J.source,3,vt)}}pe.LastCursorLineSelect=be(new Ho({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),pe.LastCursorLineSelectDrag=be(new Ho({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),pe.CancelSelection=be(new class extends Bt{constructor(){super({id:"cancelSelection",precondition:ie.hasNonEmptySelection,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(re,O){re.model.pushStackElement(),re.setCursorStates(O.source,3,[kn.cancelSelection(re,re.getPrimaryCursorState())]),re.revealAllCursors(O.source,!0)}}),pe.RemoveSecondaryCursors=be(new class extends Bt{constructor(){super({id:"removeSecondaryCursors",precondition:ie.hasMultipleSelections,kbOpts:{weight:it+1,kbExpr:ie.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(re,O){re.model.pushStackElement(),re.setCursorStates(O.source,3,[re.getPrimaryCursorState()]),re.revealAllCursors(O.source,!0),Bl(h("removedCursor","Removed secondary cursors"))}}),pe.RevealLine=be(new class extends Bt{constructor(){super({id:"revealLine",precondition:void 0,metadata:af.metadata})}runCoreEditorCommand(re,O){let J=O,ce=J.lineNumber||0,qe=typeof ce=="number"?ce+1:parseInt(ce)+1;qe<1&&(qe=1);let vt=re.model.getLineCount();qe>vt&&(qe=vt);let On=new w(qe,1,qe,re.model.getLineMaxColumn(qe)),di=0;if(J.at)switch(J.at){case af.RawAtArgument.Top:di=3;break;case af.RawAtArgument.Center:di=1;break;case af.RawAtArgument.Bottom:di=4;break;default:break}let Be=re.coordinatesConverter.convertModelRangeToViewRange(On);re.revealRange(O.source,!1,Be,di,0)}}),pe.SelectAll=new class extends lf{constructor(){super(qA)}runDOMCommand(re){In&&(re.focus(),re.select()),re.ownerDocument.execCommand("selectAll")}runEditorCommand(re,O,J){let ce=O._getViewModel();ce&&this.runCoreEditorCommand(ce,J)}runCoreEditorCommand(re,O){re.model.pushStackElement(),re.setCursorStates("keyboard",3,[kn.selectAll(re,re.getPrimaryCursorState())])}},pe.SetSelection=be(new class extends Bt{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(re,O){O.selection&&(re.model.pushStackElement(),re.setCursorStates(O.source,3,[Ke.fromModelSelection(O.selection)]))}})})(_n||={});var lU=De.and(ie.textInputFocus,ie.columnSelection);function Vp(o,e){Ha.registerKeybindingRule({id:o,primary:e,when:lU,weight:it+1})}Vp(_n.CursorColumnSelectLeft.id,1039);Vp(_n.CursorColumnSelectRight.id,1041);Vp(_n.CursorColumnSelectUp.id,1040);Vp(_n.CursorColumnSelectPageUp.id,1035);Vp(_n.CursorColumnSelectDown.id,1042);Vp(_n.CursorColumnSelectPageDown.id,1036);function tF(o){return o.register(),o}var uC;(l=>{class o extends na{runEditorCommand(c,u,p){let m=u._getViewModel();m&&this.runCoreEditingCommand(u,m,p||{})}}l.CoreEditingCommand=o,l.LineBreakInsert=be(new class extends o{constructor(){super({id:"lineBreakInsert",precondition:ie.writable,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Op.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection)))}}),l.Outdent=be(new class extends o{constructor(){super({id:"outdent",precondition:ie.writable,kbOpts:{weight:it,kbExpr:De.and(ie.editorTextFocus,ie.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,as.outdent(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.Tab=be(new class extends o{constructor(){super({id:"tab",precondition:ie.writable,kbOpts:{weight:it,kbExpr:De.and(ie.editorTextFocus,ie.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,as.tab(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=be(new class extends o{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[p,m]=Ya.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection),c.getCursorAutoClosedCharacters());p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(2)}}),l.DeleteRight=be(new class extends o{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:it,kbExpr:ie.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[p,m]=Ya.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(f=>f.modelState.selection));p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(3)}}),l.Undo=new class extends lf{constructor(){super(m1)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends lf{constructor(){super(g1)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})(uC||={});var cC=class extends wc{_handlerId;constructor(e,t,n){super({id:e,precondition:void 0,metadata:n}),this._handlerId=t}runCommand(e,t){let n=e.get(ta).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}};function Nc(o,e){tF(new cC("default:"+o,o)),tF(new cC(o,o,e))}Nc("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Nc("replacePreviousChar");Nc("compositionType");Nc("compositionStart");Nc("compositionEnd");Nc("paste");Nc("cut");var ii=j("fileService");function nF(o){return!!(o.capabilities&2048)}var S1=class o extends Error{constructor(t,n){super(t);this.code=n}static create(t,n){let i=new o(t.toString(),n);return dU(i,n),i}};function dU(o,e){return o.name=e?`${e} (FileSystemError)`:"FileSystemError",o}function cU(o){if(!o)return"Unknown";if(o instanceof S1)return o.code;let e=/^(.+) \(FileSystemError\)$/.exec(o.name);if(!e)return"Unknown";switch(e[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function iF(o){if(o instanceof df)return o.fileOperationResult;switch(cU(o)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var df=class extends Error{constructor(t,n,i){super(t);this.fileOperationResult=n;this.options=i}};var pC=class extends df{constructor(t,n,i){super(t,2,i);this.stat=n}};var ls={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},Hp={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"};var oF="files.readonlyInclude",rF="files.readonlyExclude";var cf="";var sd=class o{static KB=1024;static MB=o.KB*o.KB;static GB=o.MB*o.KB;static TB=o.GB*o.KB;static formatSize(e){return Yi(e)||(e=0),e<o.KB?h("sizeB","{0}B",e.toFixed(0)):e<o.MB?h("sizeKB","{0}KB",(e/o.KB).toFixed(2)):e<o.GB?h("sizeMB","{0}MB",(e/o.MB).toFixed(2)):e<o.TB?h("sizeGB","{0}GB",(e/o.GB).toFixed(2)):h("sizeTB","{0}TB",(e/o.TB).toFixed(2))}};function sF(o){let e=typeof o=="string"||o?.scheme===Ie.vscodeRemote;return typeof o!="string"&&o?.scheme===Ie.file?1024*sd.MB:e?10*sd.MB:kr?50*sd.MB:1024*sd.MB}var uf=class{_resolvedKeybindingItemBrand=void 0;resolvedKeybinding;chords;bubble;command;commandArgs;when;isDefault;extensionId;isBuiltinExtension;constructor(e,t,n,i,r,s,a){this.resolvedKeybinding=e,this.chords=e?aF(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=aF(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=n,this.when=i,this.isDefault=r,this.extensionId=s,this.isBuiltinExtension=a}};function aF(o){let e=[];for(let t=0,n=o.length;t<n;t++){let i=o[t];if(!i)return[];e.push(i)}return e}var Oo=j("keybindingService");var Ao=j("labelService");var hC=Do,ds=j("notificationService");var lF="";var ia=class extends V{_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var Up=j("ILanguageDetectionService"),x1="languageDetection";var rr=class extends ia{constructor(t,n,i,r,s){super();this.modelService=t;this.languageService=n;this.languageDetectionService=i;this.accessibilityService=r;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new Wt);autoDetectLanguageThrottler=this._register(new zm(rr.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(t){let n=this.modelService.getModel(t);if(!n)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.textEditorModelHandle=t,this.registerModelDisposeListener(n)}registerModelDisposeListener(t){this.modelDisposeListener.value=t.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(t,n){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(t,n)}setLanguageIdInternal(t,n){this.isResolved()&&(!t||t===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(t),n))}installModelListeners(t){let n=this._register(t.onDidChangeLanguage(i=>{i.source!==x1&&(this._hasLanguageSetExplicitly=!0,n.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??ir))return;let t=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),n=this.getLanguageId();if(t&&t!==n&&!this.isDisposed()){this.setLanguageIdInternal(t,x1);let i=this.languageService.getLanguageName(t);this.accessibilityService.alert(h("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",i??t))}}createTextEditorModel(t,n,i){let r=this.getFirstLineText(t),s=this.getOrCreateLanguage(n,this.languageService,i,r);return this.doCreateTextEditorModel(t,s,n)}doCreateTextEditorModel(t,n,i){let r=i&&this.modelService.getModel(i);return r?this.updateTextEditorModel(t,n.languageId):(r=this.modelService.createModel(t,n,i),this.createdEditorModel=!0,this.registerModelDisposeListener(r)),this.textEditorModelHandle=r.uri,r}getFirstLineText(t){let n=t;return typeof n.getFirstLineText=="function"?n.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(t,n,i,r){return!i||i===ir?n.createByFilepathOrFirstLine(t??null,r):n.createById(i)}updateTextEditorModel(t,n){this.isResolved()&&(t&&this.modelService.updateModel(this.textEditorModel,t),n&&n!==ir&&this.textEditorModel.getLanguageId()!==n&&this.textEditorModel.setLanguage(this.languageService.createById(n)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};rr=K([D(0,rs),D(1,Hi),D(2,Up),D(3,Vi)],rr);var mC=j("workingCopyBackupService");var cs=j("textResourceConfigurationService"),ZEe=j("textResourcePropertiesService");var Oc=class o{constructor(e,t,n){this.startOffset=e;this.endOffset=t;this.newLength=n}static fromModelContentChanges(e){return e.map(n=>{let i=w.lift(n.range);return new o(Jl(i.getStartPosition()),Jl(i.getEndPosition()),jN(n.text))}).reverse()}toString(){return`[${xi(this.startOffset)}...${xi(this.endOffset)}) -> ${xi(this.newLength)}`}},gC=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(e){this.edits=e.map(t=>_1.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);let t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):null;return n===null?null:gc(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Ft(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Ft(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){let t=xi(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Ft(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Ft(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){let t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(Ql(n,e)){this.nextEditIdx++;let i=xi(n),r=xi(this.translateOldToCur(t.endOffsetBeforeObj)),s=i.lineCount-r.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=i.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}},_1=class o{static from(e){return new o(e.startOffset,e.endOffset,e.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(e,t,n){this.endOffsetBeforeObj=xi(t),this.endOffsetAfterObj=xi(ft(e,n)),this.offsetObj=xi(e)}};function cF(o){if(o.length===0)return null;if(o.length===1)return o[0];let e=0;function t(){if(e>=o.length)return null;let s=e,a=o[s].listHeight;for(e++;e<o.length&&o[e].listHeight===a;)e++;return e-s>=2?T1(s===0&&e===o.length?o:o.slice(s,e),!1):o[s]}let n=t(),i=t();if(!i)return n;for(let s=t();s;s=t())dF(n,i)<=dF(i,s)?(n=E1(n,i),i=s):i=E1(i,s);return E1(n,i)}function T1(o,e=!1){if(o.length===0)return null;if(o.length===1)return o[0];let t=o.length;for(;t>3;){let n=t>>1;for(let i=0;i<n;i++){let r=i<<1;o[i]=Ro.create23(o[r],o[r+1],r+3===t?o[r+2]:null,e)}t=n}return Ro.create23(o[0],o[1],t>=3?o[2]:null,e)}function dF(o,e){return Math.abs(o.listHeight-e.listHeight)}function E1(o,e){return o.listHeight===e.listHeight?Ro.create23(o,e,null,!1):o.listHeight>e.listHeight?uU(o,e):pU(e,o)}function uU(o,e){o=o.toMutable();let t=o,n=[],i;for(;;){if(e.listHeight===t.listHeight){i=e;break}if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeLastElementMutable()}for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=Ro.create23(s.unappendChild(),i,null,!1):(s.appendChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?Ro.create23(o,i,null,!1):o}function pU(o,e){o=o.toMutable();let t=o,n=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");n.push(t),t=t.makeFirstElementMutable()}let i=e;for(let r=n.length-1;r>=0;r--){let s=n[r];i?s.childrenLength>=3?i=Ro.create23(i,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(i),i=void 0):s.handleChildrenChanged()}return i?Ro.create23(i,o,null,!1):o}var fC=class{nextNodes;offsets;idxs;lastOffset=fn;constructor(e){this.nextNodes=[e],this.offsets=[fn],this.idxs=[]}readLongestNodeAt(e,t){if(za(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){let n=pf(this.nextNodes);if(!n)return;let i=pf(this.offsets);if(za(e,i))return;if(za(i,e))if(ft(i,n.length)<=e)this.nextNodeAfterCurrent();else{let r=L1(n);r!==-1?(this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(n))return this.nextNodeAfterCurrent(),n;{let r=L1(n);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(n.getChild(r)),this.offsets.push(i),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){let e=pf(this.offsets),t=pf(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let n=pf(this.nextNodes),i=L1(n,this.idxs[this.idxs.length-1]);if(i!==-1){this.nextNodes.push(n.getChild(i)),this.offsets.push(ft(e,t.length)),this.idxs[this.idxs.length-1]=i;break}else this.idxs.pop()}}};function L1(o,e=-1){for(;;){if(e++,e>=o.childrenLength)return-1;if(o.getChild(e))return e}}function pf(o){return o.length>0?o[o.length-1]:void 0}function hf(o,e,t,n){return new D1(o,e,t,n).parseDocument()}var D1=class{constructor(e,t,n,i){this.tokenizer=e;this.createImmutableLists=i;if(n&&i)throw new Error("Not supported");this.oldNodeReader=n?new fC(n):void 0,this.positionMapper=new gC(t)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(ei.getEmpty(),0);return e||(e=Ro.getEmpty()),e}parseList(e,t){let n=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||n.push(r)}return this.oldNodeReader?cF(n):T1(n,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){let t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!rp(t)){let n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),i=>t!==null&&!za(i.length,t)?!1:i.canBeReused(e));if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}}parseChild(e,t){this._itemsConstructed++;let n=this.tokenizer.read();switch(n.kind){case 2:return new oI(n.bracketIds,n.length);case 0:return n.astNode;case 1:{if(t>300)return new Qr(n.length);let i=e.merge(n.bracketIds),r=this.parseList(i,t+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===n.bracketId||s.bracketIds.intersects(n.bracketIds))?(this.tokenizer.read(),Ag.create(n.astNode,r,s.astNode)):Ag.create(n.astNode,r,null)}default:throw new Error("unexpected")}}};function k1(o,e){if(o.length===0)return e;if(e.length===0)return o;let t=new ji(uF(o)),n=uF(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=t.dequeue();function r(d){if(d===void 0){let u=t.takeWhile(p=>!0)||[];return i&&u.unshift(i),u}let c=[];for(;i&&!rp(d);){let[u,p]=i.splitAt(d);c.push(u),d=gc(u.lengthAfter,d),i=p??t.dequeue()}return rp(d)||c.push(new mf(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&kL(s[s.length-1].endOffset,d)){let p=s[s.length-1];s[s.length-1]=new Oc(p.startOffset,c,ft(p.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=fn;for(let d of n){let c=r(d.lengthBefore);if(d.modified){let u=$N(c,m=>m.lengthBefore),p=ft(l,u);a(l,p,d.lengthAfter),l=p}else for(let u of c){let p=l;l=ft(l,u.lengthBefore),u.modified&&a(p,l,u.lengthAfter)}}return s}var mf=class o{constructor(e,t,n){this.modified=e;this.lengthBefore=t;this.lengthAfter=n}splitAt(e){let t=gc(e,this.lengthAfter);return kL(t,fn)?[this,void 0]:this.modified?[new o(this.modified,this.lengthBefore,e),new o(this.modified,fn,t)]:[new o(this.modified,e,e),new o(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${xi(this.lengthBefore)} -> ${xi(this.lengthAfter)}`}};function uF(o){let e=[],t=fn;for(let n of o){let i=gc(t,n.startOffset);rp(i)||e.push(new mf(!1,i,i));let r=gc(n.startOffset,n.endOffset);e.push(new mf(!0,r,n.newLength)),t=n.endOffset}return e}var bC=class extends V{constructor(t,n){super();this.textModel=t;this.getLanguageConfiguration=n;if(t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),r=new nI(this.textModel.getValue(),i);this.initialAstWithoutTokens=hf(r,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new L;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new ap;brackets=new dp(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(t){return this.brackets.didLanguageChange(t)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){let n=t.map(i=>new Oc(Ft(i.fromLineNumber-1,0),Ft(i.toLineNumber,0),Ft(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(n,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){let n=Oc.fromModelContentChanges(t.changes);this.handleEdits(n,!1)}handleEdits(t,n){let i=k1(this.queuedTextEdits,t);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!n&&(this.queuedTextEditsForInitialAstWithoutTokens=k1(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,n,i){let s=n,a=new cp(this.textModel,this.brackets);return hf(a,t,s,i)}getBracketsInRange(t,n){this.flushQueue();let i=Ft(t.startLineNumber-1,t.startColumn-1),r=Ft(t.endLineNumber-1,t.endColumn-1);return new Ta(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;R1(a,fn,a.length,i,r,s,0,0,new Map,n)})}getBracketPairsInRange(t,n){this.flushQueue();let i=Jl(t.getStartPosition()),r=Jl(t.getEndPosition());return new Ta(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new M1(s,n,this.textModel);P1(a,fn,a.length,i,r,l,0,new Map)})}getFirstBracketAfter(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return mF(n,fn,n.length,Jl(t))}getFirstBracketBefore(t){this.flushQueue();let n=this.initialAstWithoutTokens||this.astWithTokens;return hF(n,fn,n.length,Jl(t))}};function hF(o,e,t,n){if(o.kind===4||o.kind===2){let i=[];for(let r of o.children)t=ft(e,r.length),i.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=i.length-1;r>=0;r--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=i[r];if(za(s,n)){let l=hF(o.children[r],s,a,n);if(l)return l}}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=ed(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function mF(o,e,t,n){if(o.kind===4||o.kind===2){for(let i of o.children){if(t=ft(e,i.length),za(n,t)){let r=mF(i,e,t,n);if(r)return r}e=t}return null}else{if(o.kind===3)return null;if(o.kind===1){let i=ed(e,t);return{bracketInfo:o.bracketInfo,range:i}}}return null}function R1(o,e,t,n,i,r,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(o.kind){case 4:{let u=o.childrenLength;for(let p=0;p<u;p++){let m=o.getChild(p);if(m){if(t=ft(e,m.length),Ql(e,i)&&sp(t,n)){if(sp(t,i)){o=m;continue e}if(!R1(m,e,t,n,i,r,s,0,l,d))return!1}e=t}}return!0}case 2:{let u=!d||!o.closingBracket||o.closingBracket.bracketInfo.closesColorized(o.openingBracket.bracketInfo),p=0;if(l){let f=l.get(o.openingBracket.text);f===void 0&&(f=0),p=f,u&&(f++,l.set(o.openingBracket.text,f))}let m=o.childrenLength;for(let f=0;f<m;f++){let g=o.getChild(f);if(g){if(t=ft(e,g.length),Ql(e,i)&&sp(t,n)){if(sp(t,i)&&g.kind!==1){o=g,u?(s++,a=p+1):a=p;continue e}if((u||g.kind!==1||!o.closingBracket)&&!R1(g,e,t,n,i,r,u?s+1:s,u?p+1:p,l,d,!o.closingBracket))return!1}e=t}}return l?.set(o.openingBracket.text,p),!0}case 3:{let u=ed(e,t);return r(new Vg(u,s-1,0,!0))}case 1:{let u=ed(e,t);return r(new Vg(u,s-1,a-1,c))}case 0:return!0}}var M1=class{constructor(e,t,n){this.push=e;this.includeMinIndentation=t;this.textModel=n}};function P1(o,e,t,n,i,r,s,a){if(s>200)return!0;let l=!0;if(o.kind===2){let d=0;if(a){let p=a.get(o.openingBracket.text);p===void 0&&(p=0),d=p,p++,a.set(o.openingBracket.text,p)}let c=ft(e,o.openingBracket.length),u=-1;if(r.includeMinIndentation&&(u=o.computeMinIndentation(e,r.textModel)),l=r.push(new rI(ed(e,t),ed(e,c),o.closingBracket?ed(ft(c,o.child?.length||fn),t):void 0,s,d,o,u)),e=c,l&&o.child){let p=o.child;if(t=ft(e,p.length),Ql(e,i)&&sp(t,n)&&(l=P1(p,e,t,n,i,r,s+1,a),!l))return!1}a?.set(o.openingBracket.text,d)}else{let d=e;for(let c of o.children){let u=d;if(d=ft(d,c.length),Ql(u,i)&&Ql(n,d)&&(l=P1(c,u,d,n,i,r,s,a),!l))return!1}}return l}var yC=class extends V{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}bracketPairsTree=this._register(new Wt);onDidChangeEmitter=new L;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(t){(!t.languageId||this.bracketPairsTree.value?.object.didLanguageChange(t.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){this.bracketPairsTree.value?.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){this.bracketPairsTree.value?.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let t=new ae;this.bracketPairsTree.value=hU(t.add(new bC(this.textModel,n=>this.languageConfigurationService.getLanguageConfiguration(n))),t),t.add(this.bracketPairsTree.value.object.onDidChange(n=>this.onDidChangeEmitter.fire(n))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!1)||Ta.empty}getBracketPairsInRangeWithMinIndentation(t){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(t,!0)||Ta.empty}getBracketsInRange(t,n=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(t,n)||Ta.empty}findMatchingBracketUp(t,n,i){let r=this.textModel.validatePosition(n),s=this.textModel.getLanguageIdAtPosition(r.lineNumber,r.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(t);if(!a)return null;let l=this.getBracketPairsInRange(w.fromPositions(n,n)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=t.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?vC(this._findMatchingBracketUp(d,r,N1(i))):null}}matchBracket(t,n){if(this.canBuildAST){let i=this.getBracketPairsInRange(w.fromPositions(t,t)).filter(r=>r.closingBracketRange!==void 0&&(r.openingBracketRange.containsPosition(t)||r.closingBracketRange.containsPosition(t))).findLastMaxBy(Es(r=>r.openingBracketRange.containsPosition(t)?r.openingBracketRange:r.closingBracketRange,w.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{let i=N1(n);return this._matchBracket(this.textModel.validatePosition(t),i)}}_establishBracketSearchOffsets(t,n,i,r){let s=n.getCount(),a=n.getLanguageId(r),l=Math.max(0,t.column-1-i.maxBracketLength);for(let c=r-1;c>=0;c--){let u=n.getEndOffset(c);if(u<=l)break;if(vr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){l=u;break}}let d=Math.min(n.getLineContent().length,t.column-1+i.maxBracketLength);for(let c=r+1;c<s;c++){let u=n.getStartOffset(c);if(u>=d)break;if(vr(n.getStandardTokenType(c))||n.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(t,n){let i=t.lineNumber,r=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),a=r.findTokenIndexAtOffset(t.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(a)).brackets;if(l&&!vr(r.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(t,r,l,a),u=null;for(;;){let p=Ui.findNextBracketInRange(l.forwardRegex,i,s,d,c);if(!p)break;if(p.startColumn<=t.column&&t.column<=p.endColumn){let m=s.substring(p.startColumn-1,p.endColumn-1).toLowerCase(),f=this._matchFoundBracket(p,l.textIsBracket[m],l.textIsOpenBracket[m],n);if(f){if(f instanceof Xa)return null;u=f}}d=p.endColumn-1}if(u)return u}if(a>0&&r.getStartOffset(a)===t.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId(d)).brackets;if(c&&!vr(r.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:p}=this._establishBracketSearchOffsets(t,r,c,d),m=Ui.findPrevBracketInRange(c.reversedRegex,i,s,u,p);if(m&&m.startColumn<=t.column&&t.column<=m.endColumn){let f=s.substring(m.startColumn-1,m.endColumn-1).toLowerCase(),g=this._matchFoundBracket(m,c.textIsBracket[f],c.textIsOpenBracket[f],n);if(g)return g instanceof Xa?null:g}}}return null}_matchFoundBracket(t,n,i,r){if(!n)return null;let s=i?this._findMatchingBracketDown(n,t.getEndPosition(),r):this._findMatchingBracketUp(n,t.getStartPosition(),r);return s?s instanceof Xa?s:[t,s]:null}_findMatchingBracketUp(t,n,i){let r=t.languageId,s=t.reversedRegex,a=-1,l=0,d=(c,u,p,m)=>{for(;;){if(i&&++l%100===0&&!i())return Xa.INSTANCE;let f=Ui.findPrevBracketInRange(s,c,u,p,m);if(!f)break;let g=u.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(t.isOpen(g)?a++:t.isClose(g)&&a--,a===0)return f;m=f.startColumn-1}return null};for(let c=n.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),p=u.getCount(),m=this.textModel.getLineContent(c),f=p-1,g=m.length,b=m.length;c===n.lineNumber&&(f=u.findTokenIndexAtOffset(n.column-1),g=n.column-1,b=n.column-1);let v=!0;for(;f>=0;f--){let I=u.getLanguageId(f)===r&&!vr(u.getStandardTokenType(f));if(I)v?g=u.getStartOffset(f):(g=u.getStartOffset(f),b=u.getEndOffset(f));else if(v&&g!==b){let C=d(c,m,g,b);if(C)return C}v=I}if(v&&g!==b){let I=d(c,m,g,b);if(I)return I}}return null}_findMatchingBracketDown(t,n,i){let r=t.languageId,s=t.forwardRegex,a=1,l=0,d=(u,p,m,f)=>{for(;;){if(i&&++l%100===0&&!i())return Xa.INSTANCE;let g=Ui.findNextBracketInRange(s,u,p,m,f);if(!g)break;let b=p.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(t.isOpen(b)?a++:t.isClose(b)&&a--,a===0)return g;m=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=n.lineNumber;u<=c;u++){let p=this.textModel.tokenization.getLineTokens(u),m=p.getCount(),f=this.textModel.getLineContent(u),g=0,b=0,v=0;u===n.lineNumber&&(g=p.findTokenIndexAtOffset(n.column-1),b=n.column-1,v=n.column-1);let I=!0;for(;g<m;g++){let C=p.getLanguageId(g)===r&&!vr(p.getStandardTokenType(g));if(C)I||(b=p.getStartOffset(g)),v=p.getEndOffset(g);else if(I&&b!==v){let S=d(u,f,b,v);if(S)return S}I=C}if(I&&b!==v){let C=d(u,f,b,v);if(C)return C}}return null}findPrevBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(n)||null;let i=null,r=null,s=null;for(let a=n.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,p=c.length,m=c.length;if(a===n.lineNumber){u=l.findTokenIndexAtOffset(n.column-1),p=n.column-1,m=n.column-1;let g=l.getLanguageId(u);i!==g&&(i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let f=!0;for(;u>=0;u--){let g=l.getLanguageId(u);if(i!==g){if(r&&s&&f&&p!==m){let v=Ui.findPrevBracketInRange(r.reversedRegex,a,c,p,m);if(v)return this._toFoundBracket(s,v);f=!1}i=g,r=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}let b=!!r&&!vr(l.getStandardTokenType(u));if(b)f?p=l.getStartOffset(u):(p=l.getStartOffset(u),m=l.getEndOffset(u));else if(s&&r&&f&&p!==m){let v=Ui.findPrevBracketInRange(r.reversedRegex,a,c,p,m);if(v)return this._toFoundBracket(s,v)}f=b}if(s&&r&&f&&p!==m){let g=Ui.findPrevBracketInRange(r.reversedRegex,a,c,p,m);if(g)return this._toFoundBracket(s,g)}}return null}findNextBracket(t){let n=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(n)||null;let i=this.textModel.getLineCount(),r=null,s=null,a=null;for(let l=n.lineNumber;l<=i;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),p=0,m=0,f=0;if(l===n.lineNumber){p=d.findTokenIndexAtOffset(n.column-1),m=n.column-1,f=n.column-1;let b=d.getLanguageId(p);r!==b&&(r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew)}let g=!0;for(;p<c;p++){let b=d.getLanguageId(p);if(r!==b){if(a&&s&&g&&m!==f){let I=Ui.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(I)return this._toFoundBracket(a,I);g=!1}r=b,s=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew}let v=!!s&&!vr(d.getStandardTokenType(p));if(v)g||(m=d.getStartOffset(p)),f=d.getEndOffset(p);else if(a&&s&&g&&m!==f){let I=Ui.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(I)return this._toFoundBracket(a,I)}g=v}if(a&&s&&g&&m!==f){let b=Ui.findNextBracketInRange(s.forwardRegex,l,u,m,f);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(t,n){let i=this.textModel.validatePosition(t);if(this.canBuildAST){let f=w.fromPositions(i),g=this.getBracketPairsInRange(w.fromPositions(i,i)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}let r=N1(n),s=this.textModel.getLineCount(),a=new Map,l=[],d=(f,g)=>{if(!a.has(f)){let b=[];for(let v=0,I=g?g.brackets.length:0;v<I;v++)b[v]=0;a.set(f,b)}l=a.get(f)},c=0,u=(f,g,b,v,I)=>{for(;;){if(r&&++c%100===0&&!r())return Xa.INSTANCE;let C=Ui.findNextBracketInRange(f.forwardRegex,g,b,v,I);if(!C)break;let S=b.substring(C.startColumn-1,C.endColumn-1).toLowerCase(),_=f.textIsBracket[S];if(_&&(_.isOpen(S)?l[_.index]++:_.isClose(S)&&l[_.index]--,l[_.index]===-1))return this._matchFoundBracket(C,_,!1,r);v=C.endColumn-1}return null},p=null,m=null;for(let f=i.lineNumber;f<=s;f++){let g=this.textModel.tokenization.getLineTokens(f),b=g.getCount(),v=this.textModel.getLineContent(f),I=0,C=0,S=0;if(f===i.lineNumber){I=g.findTokenIndexAtOffset(i.column-1),C=i.column-1,S=i.column-1;let R=g.getLanguageId(I);p!==R&&(p=R,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m))}let _=!0;for(;I<b;I++){let R=g.getLanguageId(I);if(p!==R){if(m&&_&&C!==S){let F=u(m,f,v,C,S);if(F)return vC(F);_=!1}p=R,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m)}let N=!!m&&!vr(g.getStandardTokenType(I));if(N)_||(C=g.getStartOffset(I)),S=g.getEndOffset(I);else if(m&&_&&C!==S){let F=u(m,f,v,C,S);if(F)return vC(F)}_=N}if(m&&_&&C!==S){let R=u(m,f,v,C,S);if(R)return vC(R)}}return null}_toFoundBracket(t,n){if(!n)return null;let i=this.textModel.getValueInRange(n);i=i.toLowerCase();let r=t.getBracketInfo(i);return r?{range:n,bracketInfo:r}:null}};function hU(o,e){return{object:o,dispose:()=>e?.dispose()}}function N1(o){if(typeof o>"u")return()=>!0;{let e=Date.now();return()=>Date.now()-e<=o}}var Xa=class o{static INSTANCE=new o;_searchCanceledBrand=void 0;constructor(){}};function vC(o){return o instanceof Xa?null:o}var O1=x("editor.lineHighlightBackground",null,h("lineHighlight","Background color for the highlight of line at the cursor position.")),A1=x("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Je},h("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),nLe=x("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},h("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),iLe=x("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("rangeHighlightBorder","Background color of the border around highlighted ranges.")),oLe=x("editor.symbolHighlightBackground",{dark:is,light:is,hcDark:null,hcLight:null},h("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),rLe=x("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Pt,hcLight:Pt},h("symbolHighlightBorder","Background color of the border around highlighted symbols.")),zp=x("editorCursor.foreground",{dark:"#AEAFAD",light:G.black,hcDark:G.white,hcLight:"#0F4A85"},h("caret","Color of the editor cursor.")),IC=x("editorCursor.background",null,h("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),CC=x("editorMultiCursor.primary.foreground",zp,h("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),gF=x("editorMultiCursor.primary.background",IC,h("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),SC=x("editorMultiCursor.secondary.foreground",zp,h("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),fF=x("editorMultiCursor.secondary.background",IC,h("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),xC=x("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},h("editorWhitespaces","Color of whitespace characters in the editor.")),bF=x("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:G.white,hcLight:"#292929"},h("editorLineNumbers","Color of editor line numbers.")),mU=x("editorIndentGuide.background",xC,h("editorIndentGuides","Color of the editor indentation guides."),!1,h("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),gU=x("editorIndentGuide.activeBackground",xC,h("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,h("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),vF=x("editorIndentGuide.background1",mU,h("editorIndentGuides1","Color of the editor indentation guides (1).")),yF=x("editorIndentGuide.background2","#00000000",h("editorIndentGuides2","Color of the editor indentation guides (2).")),IF=x("editorIndentGuide.background3","#00000000",h("editorIndentGuides3","Color of the editor indentation guides (3).")),CF=x("editorIndentGuide.background4","#00000000",h("editorIndentGuides4","Color of the editor indentation guides (4).")),SF=x("editorIndentGuide.background5","#00000000",h("editorIndentGuides5","Color of the editor indentation guides (5).")),xF=x("editorIndentGuide.background6","#00000000",h("editorIndentGuides6","Color of the editor indentation guides (6).")),_F=x("editorIndentGuide.activeBackground1",gU,h("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),EF=x("editorIndentGuide.activeBackground2","#00000000",h("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),wF=x("editorIndentGuide.activeBackground3","#00000000",h("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),TF=x("editorIndentGuide.activeBackground4","#00000000",h("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),LF=x("editorIndentGuide.activeBackground5","#00000000",h("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),DF=x("editorIndentGuide.activeBackground6","#00000000",h("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),fU=x("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Pt,hcLight:Pt},h("editorActiveLineNumber","Color of editor active line number"),!1,h("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),sLe=x("editorLineNumber.activeForeground",fU,h("editorActiveLineNumber","Color of editor active line number")),kF=x("editorLineNumber.dimmedForeground",null,h("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),aLe=x("editorRuler.foreground",{dark:"#5A5A5A",light:G.lightgrey,hcDark:G.white,hcLight:"#292929"},h("editorRuler","Color of the editor rulers.")),lLe=x("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},h("editorCodeLensForeground","Foreground color of editor CodeLens")),dLe=x("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},h("editorBracketMatchBackground","Background color behind matching brackets")),cLe=x("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Je,hcLight:Je},h("editorBracketMatchBorder","Color for matching brackets boxes")),RF=x("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},h("editorOverviewRulerBorder","Color of the overview ruler border.")),MF=x("editorOverviewRuler.background",null,h("editorOverviewRulerBackground","Background color of the editor overview ruler.")),uLe=x("editorGutter.background",yc,h("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),pLe=x("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:G.fromHex("#fff").transparent(.8),hcLight:Je},h("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),PF=x("editorUnnecessaryCode.opacity",{dark:G.fromHex("#000a"),light:G.fromHex("#0007"),hcDark:null,hcLight:null},h("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),hLe=x("editorGhostText.border",{dark:null,light:null,hcDark:G.fromHex("#fff").transparent(.8),hcLight:G.fromHex("#292929").transparent(.8)},h("editorGhostTextBorder","Border color of ghost text in the editor.")),mLe=x("editorGhostText.foreground",{dark:G.fromHex("#ffffff56"),light:G.fromHex("#0007"),hcDark:null,hcLight:null},h("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),gLe=x("editorGhostText.background",null,h("editorGhostTextBackground","Background color of the ghost text in the editor.")),bU=new G(new je(0,122,204,.6)),fLe=x("editorOverviewRuler.rangeHighlightForeground",bU,h("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),bLe=x("editorOverviewRuler.errorForeground",{dark:new G(new je(255,18,18,.7)),light:new G(new je(255,18,18,.7)),hcDark:new G(new je(255,50,50,1)),hcLight:"#B5200D"},h("overviewRuleError","Overview ruler marker color for errors.")),vLe=x("editorOverviewRuler.warningForeground",{dark:Ir,light:Ir,hcDark:yp,hcLight:yp},h("overviewRuleWarning","Overview ruler marker color for warnings.")),yLe=x("editorOverviewRuler.infoForeground",{dark:ns,light:ns,hcDark:Ip,hcLight:Ip},h("overviewRuleInfo","Overview ruler marker color for infos.")),_C=x("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},h("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),EC=x("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},h("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),wC=x("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},h("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),TC=x("editorBracketHighlight.foreground4","#00000000",h("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),LC=x("editorBracketHighlight.foreground5","#00000000",h("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),DC=x("editorBracketHighlight.foreground6","#00000000",h("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),NF=x("editorBracketHighlight.unexpectedBracket.foreground",{dark:new G(new je(255,18,18,.8)),light:new G(new je(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},h("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),OF=x("editorBracketPairGuide.background1","#00000000",h("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),AF=x("editorBracketPairGuide.background2","#00000000",h("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),FF=x("editorBracketPairGuide.background3","#00000000",h("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),BF=x("editorBracketPairGuide.background4","#00000000",h("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),WF=x("editorBracketPairGuide.background5","#00000000",h("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),VF=x("editorBracketPairGuide.background6","#00000000",h("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),HF=x("editorBracketPairGuide.activeBackground1","#00000000",h("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),UF=x("editorBracketPairGuide.activeBackground2","#00000000",h("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),zF=x("editorBracketPairGuide.activeBackground3","#00000000",h("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),KF=x("editorBracketPairGuide.activeBackground4","#00000000",h("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),GF=x("editorBracketPairGuide.activeBackground5","#00000000",h("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),$F=x("editorBracketPairGuide.activeBackground6","#00000000",h("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),ILe=x("editorUnicodeHighlight.border",Ir,h("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),CLe=x("editorUnicodeHighlight.background",IO,h("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));zi((o,e)=>{let t=o.getColor(yc),n=o.getColor(O1),i=n&&!n.isTransparent()?n:t;i&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${i}; }`)});var kC=class extends V{constructor(t){super();this.textModel=t;this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange(n=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new RC;onDidChangeEmitter=new L;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,n,i,r){return r?[]:n===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(t,n){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new w(1,1,this.textModel.getLineCount(),1),t,n):[]}},RC=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}};zi((o,e)=>{let t=[_C,EC,wC,TC,LC,DC],n=new RC;e.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${o.getColor(NF)}; }`);let i=t.map(r=>o.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){let s=i[r%i.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(r)} { color: ${s}; }`)}});function Kp(o){return o.toString()}var ao=class o{constructor(e,t,n,i,r,s,a){this.beforeVersionId=e;this.afterVersionId=t;this.beforeEOL=n;this.afterEOL=i;this.beforeCursorState=r;this.afterCursorState=s;this.changes=a}static create(e,t){let n=e.getAlternativeVersionId(),i=W1(e);return new o(n,n,i,i,t,t,[])}append(e,t,n,i,r){t.length>0&&(this.changes=_N(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,n){if(Wn(e,t?t.length:0,n),n+=4,t)for(let i of t)Wn(e,i.selectionStartLineNumber,n),n+=4,Wn(e,i.selectionStartColumn,n),n+=4,Wn(e,i.positionLineNumber,n),n+=4,Wn(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){let i=Bn(e,t);t+=4;for(let r=0;r<i;r++){let s=Bn(e,t);t+=4;let a=Bn(e,t);t+=4;let l=Bn(e,t);t+=4;let d=Bn(e,t);t+=4,n.push(new Me(s,a,l,d))}return t}serialize(){let e=10+o._writeSelectionsSize(this.beforeCursorState)+o._writeSelectionsSize(this.afterCursorState)+4;for(let i of this.changes)e+=i.writeSize();let t=new Uint8Array(e),n=0;Wn(t,this.beforeVersionId,n),n+=4,Wn(t,this.afterVersionId,n),n+=4,My(t,this.beforeEOL,n),n+=1,My(t,this.afterEOL,n),n+=1,n=o._writeSelections(t,this.beforeCursorState,n),n=o._writeSelections(t,this.afterCursorState,n),Wn(t,this.changes.length,n),n+=4;for(let i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){let t=new Uint8Array(e),n=0,i=Bn(t,n);n+=4;let r=Bn(t,n);n+=4;let s=Ry(t,n);n+=1;let a=Ry(t,n);n+=1;let l=[];n=o._readSelections(t,n,l);let d=[];n=o._readSelections(t,n,d);let c=Bn(t,n);n+=4;let u=[];for(let p=0;p<c;p++)n=To.read(t,n,u);return new o(i,r,s,a,l,d,u)}},MC=class{constructor(e,t,n,i){this.label=e;this.code=t;this.model=n,this._data=ao.create(n,i)}model;_data;get type(){return 0}get resource(){return le.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof ao?this._data:ao.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(le.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof ao}append(e,t,n,i,r){this._data instanceof ao&&this._data.append(e,t,n,i,r)}close(){this._data instanceof ao&&(this._data=this._data.serialize())}open(){this._data instanceof ao||(this._data=ao.deserialize(this._data))}undo(){if(le.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof ao&&(this._data=this._data.serialize());let e=ao.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(le.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof ao&&(this._data=this._data.serialize());let e=ao.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof ao&&(this._data=this._data.serialize()),this._data.byteLength+168}},B1=class{constructor(e,t,n){this.label=e;this.code=t;this._isOpen=!0,this._editStackElementsArr=n.slice(0),this._editStackElementsMap=new Map;for(let i of this._editStackElementsArr){let r=Kp(i.resource);this._editStackElementsMap.set(r,i)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(e=>e.resource)}setDelegate(e){this._delegate=e}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let e=[];for(let t of this._editStackElementsArr)le.isUri(t.model)&&e.push(t.model);return e}matchesResource(e){let t=Kp(e);return this._editStackElementsMap.has(t)}setModel(e){let t=Kp(le.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;let t=Kp(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,n,i,r){let s=Kp(e.uri);this._editStackElementsMap.get(s).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let e of this._editStackElementsArr)e.undo()}redo(){for(let e of this._editStackElementsArr)e.redo()}heapSize(e){let t=Kp(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(let t of this._editStackElementsArr)e.push(`${Qo(t.resource)}: ${t}`);return`{${e.join(", ")}}`}};function W1(o){return o.getEOL()===`
`?0:1}function F1(o){return o?o instanceof MC||o instanceof B1:!1}var PC=class o{_model;_undoRedoService;constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);F1(e)&&e.close()}popStackElement(){let e=this._undoRedoService.getLastElement(this._model.uri);F1(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){let n=this._undoRedoService.getLastElement(this._model.uri);if(F1(n)&&n.canAppend(this._model))return n;let i=new MC(h("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(i,t),i}pushEOL(e){let t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],W1(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n,i){let r=this._getOrCreateEditStackElement(e,i),s=this._model.applyEdits(t,!0),a=o._computeCursorState(n,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),r.append(this._model,l.map(d=>d.textChange),W1(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return We(n),null}}};var Gp=class extends V{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function jF(o,e){let t=0,n=0,i=o.length;for(;n<i;){let r=o.charCodeAt(n);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;n++}return n===i?-1:t}var NC=class extends Gp{constructor(t,n){super();this.textModel=t;this.languageConfigurationService=n}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return jF(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,n,i){this.assertNotDisposed();let r=this.textModel.getLineCount();if(t<1||t>r)throw new $e("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,p=F=>{if(l!==-1&&(l===-2||l>F-1)){l=-1,d=-1;for(let P=F-2;P>=0;P--){let H=this._computeIndentLevel(P);if(H>=0){l=P,d=H;break}}}if(c===-2){c=-1,u=-1;for(let P=F;P<r;P++){let H=this._computeIndentLevel(P);if(H>=0){c=P,u=H;break}}}},m=-2,f=-1,g=-2,b=-1,v=F=>{if(m===-2){m=-1,f=-1;for(let P=F-2;P>=0;P--){let H=this._computeIndentLevel(P);if(H>=0){m=P,f=H;break}}}if(g!==-1&&(g===-2||g<F-1)){g=-1,b=-1;for(let P=F;P<r;P++){let H=this._computeIndentLevel(P);if(H>=0){g=P,b=H;break}}}},I=0,C=!0,S=0,_=!0,R=0,N=0;for(let F=0;C||_;F++){let P=t-F,H=t+F;F>1&&(P<1||P<n)&&(C=!1),F>1&&(H>r||H>i)&&(_=!1),F>5e4&&(C=!1,_=!1);let U=-1;if(C&&P>=1){let oe=this._computeIndentLevel(P-1);oe>=0?(c=P-1,u=oe,U=Math.ceil(oe/this.textModel.getOptions().indentSize)):(p(P),U=this._getIndentLevelForWhitespaceLine(a,d,u))}let z=-1;if(_&&H<=r){let oe=this._computeIndentLevel(H-1);oe>=0?(m=H-1,f=oe,z=Math.ceil(oe/this.textModel.getOptions().indentSize)):(v(H),z=this._getIndentLevelForWhitespaceLine(a,f,b))}if(F===0){N=U;continue}if(F===1){if(H<=r&&z>=0&&N+1===z){C=!1,I=H,S=H,R=z;continue}if(P>=1&&U>=0&&U-1===N){_=!1,I=P,S=P,R=U;continue}if(I=t,S=t,R=N,R===0)return{startLineNumber:I,endLineNumber:S,indent:R}}C&&(U>=R?I=P:C=!1),_&&(z>=R?S=H:_=!1)}return{startLineNumber:I,endLineNumber:S,indent:R}}getLinesBracketGuides(t,n,i,r){let s=[];for(let p=t;p<=n;p++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new w(t,1,n,this.textModel.getLineMaxColumn(n))).toArray(),d;if(i&&l.length>0){let p=(t<=i.lineNumber&&i.lineNumber<=n?l:this.textModel.bracketPairs.getBracketPairsInRange(w.fromPositions(i)).toArray()).filter(m=>w.strictContainsPosition(m.range,i));d=TR(p,m=>a||m.range.startLineNumber!==m.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new gf;for(let p of l){if(!p.closingBracketRange)continue;let m=d&&p.range.equalsRange(d);if(!m&&!r.includeInactive)continue;let f=u.getInlineClassName(p.nestingLevel,p.nestingLevelOfEqualBracketType,c)+(r.highlightActive&&m?" "+u.activeClassName:""),g=p.openingBracketRange.getStartPosition(),b=p.closingBracketRange.getStartPosition(),v=r.horizontalGuides===2||r.horizontalGuides===1&&m;if(p.range.startLineNumber===p.range.endLineNumber){a&&v&&s[p.range.startLineNumber-t].push(new yr(-1,p.openingBracketRange.getEndPosition().column,f,new Ka(!1,b.column),-1,-1));continue}let I=this.getVisibleColumnFromPosition(b),C=this.getVisibleColumnFromPosition(p.openingBracketRange.getStartPosition()),S=Math.min(C,I,p.minVisibleColumnIndentation+1),_=!1;zt(this.textModel.getLineContent(p.closingBracketRange.startLineNumber))<p.closingBracketRange.startColumn-1&&(_=!0);let F=Math.max(g.lineNumber,t),P=Math.min(b.lineNumber,n),H=_?1:0;for(let U=F;U<P+H;U++)s[U-t].push(new yr(S,-1,f,null,U===g.lineNumber?g.column:-1,U===b.lineNumber?b.column:-1));v&&(g.lineNumber>=t&&C>S&&s[g.lineNumber-t].push(new yr(S,-1,f,new Ka(!1,g.column),-1,-1)),b.lineNumber<=n&&I>S&&s[b.lineNumber-t].push(new yr(S,-1,f,new Ka(!_,b.column),-1,-1)))}for(let p of s)p.sort((m,f)=>m.visibleColumn-f.visibleColumn);return s}getVisibleColumnFromPosition(t){return Ct.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,n){this.assertNotDisposed();let i=this.textModel.getLineCount();if(t<1||t>i)throw new Error("Illegal value for startLineNumber");if(n<1||n>i)throw new Error("Illegal value for endLineNumber");let r=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(n-t+1),d=-2,c=-1,u=-2,p=-1;for(let m=t;m<=n;m++){let f=m-t,g=this._computeIndentLevel(m-1);if(g>=0){d=m-1,c=g,l[f]=Math.ceil(g/r.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=m-2;b>=0;b--){let v=this._computeIndentLevel(b);if(v>=0){d=b,c=v;break}}}if(u!==-1&&(u===-2||u<m-1)){u=-1,p=-1;for(let b=m;b<i;b++){let v=this._computeIndentLevel(b);if(v>=0){u=b,p=v;break}}}l[f]=this._getIndentLevelForWhitespaceLine(a,c,p)}return l}_getIndentLevelForWhitespaceLine(t,n,i){let r=this.textModel.getOptions();return n===-1||i===-1?0:n<i?1+Math.floor(n/r.indentSize):n===i||t?Math.ceil(i/r.indentSize):1+Math.floor(i/r.indentSize)}},gf=class{activeClassName="indent-active";getInlineClassName(e,t,n){return this.getInlineClassNameOfLevel(n?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}};var V1=class{spacesDiff=0;looksLikeAlignment=!1};function IU(o,e,t,n,i){i.spacesDiff=0,i.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<n;r++){let p=o.charCodeAt(r),m=t.charCodeAt(r);if(p!==m)break}let s=0,a=0;for(let p=r;p<e;p++)o.charCodeAt(p)===32?s++:a++;let l=0,d=0;for(let p=r;p<n;p++)t.charCodeAt(p)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){i.spacesDiff=u,u>0&&0<=l-1&&l-1<o.length&&l<t.length&&t.charCodeAt(l)!==32&&o.charCodeAt(l-1)===32&&o.charCodeAt(o.length-1)===44&&(i.looksLikeAlignment=!0);return}if(u%c===0){i.spacesDiff=u/c;return}}function H1(o,e,t){let n=Math.min(o.getLineCount(),1e4),i=0,r=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new V1;for(let f=1;f<=n;f++){let g=o.getLineLength(f),b=o.getLineContent(f),v=g<=65536,I=!1,C=0,S=0,_=0;for(let N=0,F=g;N<F;N++){let P=v?b.charCodeAt(N):o.getLineCharCode(f,N);if(P===9)_++;else if(P===32)S++;else{I=!0,C=N;break}}if(!I||(_>0?i++:S>1&&r++,IU(s,a,b,C,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let R=u.spacesDiff;R<=d&&c[R]++,s=b,a=C}let p=t;i!==r&&(p=i<r);let m=e;if(p){let f=p?0:.1*n;l.forEach(g=>{let b=c[g];b>f&&(f=b,m=g)}),m===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(m=2)}return{insertSpaces:p,tabSize:m}}function Ki(o){return(o.metadata&1)>>>0}function Tt(o,e){o.metadata=o.metadata&254|e<<0}function Hn(o){return(o.metadata&2)>>>1===1}function xt(o,e){o.metadata=o.metadata&253|(e?1:0)<<1}function t2(o){return(o.metadata&4)>>>2===1}function qF(o,e){o.metadata=o.metadata&251|(e?1:0)<<2}function n2(o){return(o.metadata&64)>>>6===1}function YF(o,e){o.metadata=o.metadata&191|(e?1:0)<<6}function CU(o){return(o.metadata&24)>>>3}function XF(o,e){o.metadata=o.metadata&231|e<<3}function SU(o){return(o.metadata&32)>>>5===1}function ZF(o,e){o.metadata=o.metadata&223|(e?1:0)<<5}var vf=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,Tt(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,qF(this,!1),YF(this,!1),XF(this,1),ZF(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,xt(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;qF(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),YF(this,this.options.glyphMarginClassName!==null),XF(this,this.options.stickiness),ZF(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}},Ge=new vf(null,0,0);Ge.parent=Ge;Ge.left=Ge;Ge.right=Ge;Tt(Ge,0);var jp=class{root;requestNormalizeDelta;constructor(){this.root=Ge,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r,s){return this.root===Ge?[]:DU(this,e,t,n,i,r,s)}search(e,t,n,i){return this.root===Ge?[]:QF(this,e,t,n,i)}collectNodesFromOwner(e){return TU(this,e)}collectNodesPostOrder(){return LU(this)}insert(e){JF(this,e),this._normalizeDeltaIfNecessary()}delete(e){e2(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){let n=e,i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;let r=n.start+i,s=n.end+i;n.setCachedOffsets(r,s,t)}acceptReplace(e,t,n,i){let r=EU(this,e,e+t);for(let s=0,a=r.length;s<a;s++){let l=r[s];e2(this,l)}this._normalizeDeltaIfNecessary(),wU(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let s=0,a=r.length;s<a;s++){let l=r[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,_U(l,e,e+t,n,i),l.maxEnd=l.end,JF(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return QF(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,xU(this))}};function xU(o){let e=o.root,t=0;for(;e!==Ge;){if(e.left!==Ge&&!Hn(e.left)){e=e.left;continue}if(e.right!==Ge&&!Hn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Za(e),xt(e,!0),xt(e.left,!1),xt(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}xt(o.root,!1)}function $p(o,e,t,n){return o<t?!0:o>t||n===1?!1:n===2?!0:e}function _U(o,e,t,n,i){let r=CU(o),s=r===0||r===2,a=r===1||r===2,l=t-e,d=n,c=Math.min(l,d),u=o.start,p=!1,m=o.end,f=!1;e<=u&&m<=t&&SU(o)&&(o.start=e,p=!0,o.end=e,f=!0);{let b=i?1:l>0?2:0;!p&&$p(u,s,e,b)&&(p=!0),!f&&$p(m,a,e,b)&&(f=!0)}if(c>0&&!i){let b=l>d?2:0;!p&&$p(u,s,e+c,b)&&(p=!0),!f&&$p(m,a,e+c,b)&&(f=!0)}{let b=i?1:0;!p&&$p(u,s,t,b)&&(o.start=e+d,p=!0),!f&&$p(m,a,t,b)&&(o.end=e+d,f=!0)}let g=d-l;p||(o.start=Math.max(0,u+g)),f||(o.end=Math.max(0,m+g)),o.start>o.end&&(o.end=o.start)}function EU(o,e,t){let n=o.root,i=0,r=0,s=0,a=0,l=[],d=0;for(;n!==Ge;){if(Hn(n)){xt(n.left,!1),xt(n.right,!1),n===n.parent.right&&(i-=n.parent.delta),n=n.parent;continue}if(!Hn(n.left)){if(r=i+n.maxEnd,r<e){xt(n,!0);continue}if(n.left!==Ge){n=n.left;continue}}if(s=i+n.start,s>t){xt(n,!0);continue}if(a=i+n.end,a>=e&&(n.setCachedOffsets(s,a,0),l[d++]=n),xt(n,!0),n.right!==Ge&&!Hn(n.right)){i+=n.delta,n=n.right;continue}}return xt(o.root,!1),l}function wU(o,e,t,n){let i=o.root,r=0,s=0,a=0,l=n-(t-e);for(;i!==Ge;){if(Hn(i)){xt(i.left,!1),xt(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),Za(i),i=i.parent;continue}if(!Hn(i.left)){if(s=r+i.maxEnd,s<e){xt(i,!0);continue}if(i.left!==Ge){i=i.left;continue}}if(a=r+i.start,a>t){i.start+=l,i.end+=l,i.delta+=l,(i.delta<-1073741824||i.delta>1073741824)&&(o.requestNormalizeDelta=!0),xt(i,!0);continue}if(xt(i,!0),i.right!==Ge&&!Hn(i.right)){r+=i.delta,i=i.right;continue}}xt(o.root,!1)}function TU(o,e){let t=o.root,n=[],i=0;for(;t!==Ge;){if(Hn(t)){xt(t.left,!1),xt(t.right,!1),t=t.parent;continue}if(t.left!==Ge&&!Hn(t.left)){t=t.left;continue}if(t.ownerId===e&&(n[i++]=t),xt(t,!0),t.right!==Ge&&!Hn(t.right)){t=t.right;continue}}return xt(o.root,!1),n}function LU(o){let e=o.root,t=[],n=0;for(;e!==Ge;){if(Hn(e)){xt(e.left,!1),xt(e.right,!1),e=e.parent;continue}if(e.left!==Ge&&!Hn(e.left)){e=e.left;continue}if(e.right!==Ge&&!Hn(e.right)){e=e.right;continue}t[n++]=e,xt(e,!0)}return xt(o.root,!1),t}function QF(o,e,t,n,i){let r=o.root,s=0,a=0,l=0,d=[],c=0;for(;r!==Ge;){if(Hn(r)){xt(r.left,!1),xt(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),r=r.parent;continue}if(r.left!==Ge&&!Hn(r.left)){r=r.left;continue}a=s+r.start,l=s+r.end,r.setCachedOffsets(a,l,n);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&t2(r)&&(u=!1),i&&!n2(r)&&(u=!1),u&&(d[c++]=r),xt(r,!0),r.right!==Ge&&!Hn(r.right)){s+=r.delta,r=r.right;continue}}return xt(o.root,!1),d}function DU(o,e,t,n,i,r,s){let a=o.root,l=0,d=0,c=0,u=0,p=[],m=0;for(;a!==Ge;){if(Hn(a)){xt(a.left,!1),xt(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Hn(a.left)){if(d=l+a.maxEnd,d<e){xt(a,!0);continue}if(a.left!==Ge){a=a.left;continue}}if(c=l+a.start,c>t){xt(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(c,u,r);let f=!0;n&&a.ownerId&&a.ownerId!==n&&(f=!1),i&&t2(a)&&(f=!1),s&&!n2(a)&&(f=!1),f&&(p[m++]=a)}if(xt(a,!0),a.right!==Ge&&!Hn(a.right)){l+=a.delta,a=a.right;continue}}return xt(o.root,!1),p}function JF(o,e){if(o.root===Ge)return e.parent=Ge,e.left=Ge,e.right=Ge,Tt(e,0),o.root=e,o.root;kU(o,e),ad(e.parent);let t=e;for(;t!==o.root&&Ki(t.parent)===1;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;Ki(n)===1?(Tt(t.parent,0),Tt(n,0),Tt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,ff(o,t)),Tt(t.parent,0),Tt(t.parent.parent,1),bf(o,t.parent.parent))}else{let n=t.parent.parent.left;Ki(n)===1?(Tt(t.parent,0),Tt(n,0),Tt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,bf(o,t)),Tt(t.parent,0),Tt(t.parent.parent,1),ff(o,t.parent.parent))}return Tt(o.root,0),e}function kU(o,e){let t=0,n=o.root,i=e.start,r=e.end;for(;;)if(MU(i,r,n.start+t,n.end+t)<0)if(n.left===Ge){e.start-=t,e.end-=t,e.maxEnd-=t,n.left=e;break}else n=n.left;else if(n.right===Ge){e.start-=t+n.delta,e.end-=t+n.delta,e.maxEnd-=t+n.delta,n.right=e;break}else t+=n.delta,n=n.right;e.parent=n,e.left=Ge,e.right=Ge,Tt(e,1)}function e2(o,e){let t,n;if(e.left===Ge?(t=e.right,n=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Ge?(t=e.left,n=e):(n=RU(e.right),t=n.right,t.start+=n.delta,t.end+=n.delta,t.delta+=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),n.start+=e.delta,n.end+=e.delta,n.delta=e.delta,(n.delta<-1073741824||n.delta>1073741824)&&(o.requestNormalizeDelta=!0)),n===o.root){o.root=t,Tt(t,0),e.detach(),U1(),Za(t),o.root.parent=Ge;return}let i=Ki(n)===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?t.parent=n.parent:(n.parent===e?t.parent=n:t.parent=n.parent,n.left=e.left,n.right=e.right,n.parent=e.parent,Tt(n,Ki(e)),e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Ge&&(n.left.parent=n),n.right!==Ge&&(n.right.parent=n)),e.detach(),i){ad(t.parent),n!==e&&(ad(n),ad(n.parent)),U1();return}ad(t),ad(t.parent),n!==e&&(ad(n),ad(n.parent));let r;for(;t!==o.root&&Ki(t)===0;)t===t.parent.left?(r=t.parent.right,Ki(r)===1&&(Tt(r,0),Tt(t.parent,1),ff(o,t.parent),r=t.parent.right),Ki(r.left)===0&&Ki(r.right)===0?(Tt(r,1),t=t.parent):(Ki(r.right)===0&&(Tt(r.left,0),Tt(r,1),bf(o,r),r=t.parent.right),Tt(r,Ki(t.parent)),Tt(t.parent,0),Tt(r.right,0),ff(o,t.parent),t=o.root)):(r=t.parent.left,Ki(r)===1&&(Tt(r,0),Tt(t.parent,1),bf(o,t.parent),r=t.parent.left),Ki(r.left)===0&&Ki(r.right)===0?(Tt(r,1),t=t.parent):(Ki(r.left)===0&&(Tt(r.right,0),Tt(r,1),ff(o,r),r=t.parent.left),Tt(r,Ki(t.parent)),Tt(t.parent,0),Tt(r.left,0),bf(o,t.parent),t=o.root));Tt(t,0),U1()}function RU(o){for(;o.left!==Ge;)o=o.left;return o}function U1(){Ge.parent=Ge,Ge.delta=0,Ge.start=0,Ge.end=0}function ff(o,e){let t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Ge&&(t.left.parent=e),t.parent=e.parent,e.parent===Ge?o.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Za(e),Za(t)}function bf(o,e){let t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(o.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Ge&&(t.right.parent=e),t.parent=e.parent,e.parent===Ge?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Za(e),Za(t)}function i2(o){let e=o.end;if(o.left!==Ge){let t=o.left.maxEnd;t>e&&(e=t)}if(o.right!==Ge){let t=o.right.maxEnd+o.delta;t>e&&(e=t)}return e}function Za(o){o.maxEnd=i2(o)}function ad(o){for(;o!==Ge;){let e=i2(o);if(o.maxEnd===e)return;o.maxEnd=e,o=o.parent}}function MU(o,e,t,n){return o===t?e-n:o-t}var Yp=class{parent;left;right;color;piece;size_left;lf_left;constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Pe)return OC(this.right);let e=this;for(;e.parent!==Pe&&e.parent.left!==e;)e=e.parent;return e.parent===Pe?Pe:e.parent}prev(){if(this.left!==Pe)return K1(this.left);let e=this;for(;e.parent!==Pe&&e.parent.right!==e;)e=e.parent;return e.parent===Pe?Pe:e.parent}detach(){this.parent=null,this.left=null,this.right=null}};var Pe=new Yp(null,0);Pe.parent=Pe;Pe.left=Pe;Pe.right=Pe;Pe.color=0;function OC(o){for(;o.left!==Pe;)o=o.left;return o}function K1(o){for(;o.right!==Pe;)o=o.right;return o}function G1(o){return o===Pe?0:o.size_left+o.piece.length+G1(o.right)}function $1(o){return o===Pe?0:o.lf_left+o.piece.lineFeedCnt+$1(o.right)}function z1(){Pe.parent=Pe}function If(o,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Pe&&(t.left.parent=e),t.parent=e.parent,e.parent===Pe?o.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Cf(o,e){let t=e.left;e.left=t.right,t.right!==Pe&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Pe?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Sf(o,e){let t,n;if(e.left===Pe?(n=e,t=n.right):e.right===Pe?(n=e,t=n.left):(n=OC(e.right),t=n.right),n===o.root){o.root=t,t.color=0,e.detach(),z1(),o.root.parent=Pe;return}let i=n.color===1;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,yf(o,t)):(n.parent===e?t.parent=n:t.parent=n.parent,yf(o,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===o.root?o.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==Pe&&(n.left.parent=n),n.right!==Pe&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,yf(o,n)),e.detach(),t.parent.left===t){let s=G1(t),a=$1(t);if(s!==t.parent.size_left||a!==t.parent.lf_left){let l=s-t.parent.size_left,d=a-t.parent.lf_left;t.parent.size_left=s,t.parent.lf_left=a,oa(o,t.parent,l,d)}}if(yf(o,t.parent),i){z1();return}let r;for(;t!==o.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,If(o,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,Cf(o,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,If(o,t.parent),t=o.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,Cf(o,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,If(o,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,Cf(o,t.parent),t=o.root));t.color=0,z1()}function j1(o,e){for(yf(o,e);e!==o.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){let t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,If(o,e)),e.parent.color=0,e.parent.parent.color=1,Cf(o,e.parent.parent))}else{let t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Cf(o,e)),e.parent.color=0,e.parent.parent.color=1,If(o,e.parent.parent))}o.root.color=0}function oa(o,e,t,n){for(;e!==o.root&&e!==Pe;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function yf(o,e){let t=0,n=0;if(e!==o.root){for(;e!==o.root&&e===e.parent.right;)e=e.parent;if(e!==o.root)for(e=e.parent,t=G1(e.left)-e.size_left,n=$1(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==o.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}var PU=999,Ja=class{searchString;isRegex;matchCase;wordSeparators;constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=NU(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=hv(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new uI(t,this.wordSeparators?zs(this.wordSeparators,[]):null,n?this.searchString:null)}};function NU(o){if(!o||o.length===0)return!1;for(let e=0,t=o.length;e<t;e++){let n=o.charCodeAt(e);if(n===10)return!0;if(n===92){if(e++,e>=t)break;let i=o.charCodeAt(e);if(i===110||i===114||i===87)return!0}}return!1}function ld(o,e,t){if(!t)return new nd(o,null);let n=[];for(let i=0,r=e.length;i<r;i++)n[i]=e[i];return new nd(o,n)}var AC=class{_lineFeedsOffsets;constructor(e){let t=[],n=0;for(let i=0,r=e.length;i<r;i++)e.charCodeAt(i)===10&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){let t=this._lineFeedsOffsets,n=0,i=t.length-1;if(i===-1||e<=t[0])return 0;for(;n<i;){let r=n+((i-n)/2>>0);t[r]>=e?i=r-1:t[r+1]>=e?(n=r,i=r):n=r+1}return n+1}},Ac=class{static findMatches(e,t,n,i,r){let s=t.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(e,n,new Qa(s.wordSeparators,s.regex),i,r):this._doFindMatchesLineByLine(e,n,s,i,r):[]}static _getMultilineMatchRange(e,t,n,i,r,s){let a,l=0;i?(l=i.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let d;if(i){let m=i.findLineFeedCountBeforeOffset(r+s.length)-l;d=a+s.length+m}else d=a+s.length;let c=e.getPositionAt(a),u=e.getPositionAt(d);return new w(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,n,i,r){let s=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new AC(a):null,d=[],c=0,u;for(n.reset(0);u=n.next(a);)if(d[c++]=ld(this._getMultilineMatchRange(e,s,a,l,u.index,u[0]),u,i),c>=r)return d;return d}static _doFindMatchesLineByLine(e,t,n,i,r){let s=[],a=0;if(t.startLineNumber===t.endLineNumber){let d=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(n,d,t.startLineNumber,t.startColumn-1,a,s,i,r),s}let l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(n,l,t.startLineNumber,t.startColumn-1,a,s,i,r);for(let d=t.startLineNumber+1;d<t.endLineNumber&&a<r;d++)a=this._findMatchesInLine(n,e.getLineContent(d),d,0,a,s,i,r);if(a<r){let d=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(n,d,t.endLineNumber,0,a,s,i,r)}return s}static _findMatchesInLine(e,t,n,i,r,s,a,l){let d=e.wordSeparators;if(!a&&e.simpleSearch){let p=e.simpleSearch,m=p.length,f=t.length,g=-m;for(;(g=t.indexOf(p,g+m))!==-1;)if((!d||FC(d,t,f,g,m))&&(s[r++]=new nd(new w(n,g+1+i,n,g+1+m+i),null),r>=l))return r;return r}let c=new Qa(e.wordSeparators,e.regex),u;c.reset(0);do if(u=c.next(t),u&&(s[r++]=ld(new w(n,u.index+1+i,n,u.index+1+u[0].length+i),u,a),r>=l))return r;while(u);return r}static findNextMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new Qa(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,n,s,i):this._doFindNextMatchLineByLine(e,n,s,i)}static _doFindNextMatchMultiline(e,t,n,i){let r=new M(t.lineNumber,1),s=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new w(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),d=e.getEOL()===`\r
`?new AC(l):null;n.reset(t.column-1);let c=n.next(l);return c?ld(this._getMultilineMatchRange(e,s,l,d,c.index,c[0]),c,i):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new M(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s),l=this._findFirstMatchInLine(n,a,s,t.column,i);if(l)return l;for(let d=1;d<=r;d++){let c=(s+d-1)%r,u=e.getLineContent(c+1),p=this._findFirstMatchInLine(n,u,c+1,1,i);if(p)return p}return null}static _findFirstMatchInLine(e,t,n,i,r){e.reset(i-1);let s=e.next(t);return s?ld(new w(n,s.index+1,n,s.index+1+s[0].length),s,r):null}static findPreviousMatch(e,t,n,i){let r=t.parseSearchRequest();if(!r)return null;let s=new Qa(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,n,s,i):this._doFindPreviousMatchLineByLine(e,n,s,i)}static _doFindPreviousMatchMultiline(e,t,n,i){let r=this._doFindMatchesMultiline(e,new w(1,1,t.lineNumber,t.column),n,i,10*PU);if(r.length>0)return r[r.length-1];let s=e.getLineCount();return t.lineNumber!==s||t.column!==e.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(e,new M(s,e.getLineMaxColumn(s)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){let r=e.getLineCount(),s=t.lineNumber,a=e.getLineContent(s).substring(0,t.column-1),l=this._findLastMatchInLine(n,a,s,i);if(l)return l;for(let d=1;d<=r;d++){let c=(r+s-d-1)%r,u=e.getLineContent(c+1),p=this._findLastMatchInLine(n,u,c+1,i);if(p)return p}return null}static _findLastMatchInLine(e,t,n,i){let r=null,s;for(e.reset(0);s=e.next(t);)r=ld(new w(n,s.index+1,n,s.index+1+s[0].length),s,i);return r}};function OU(o,e,t,n,i){if(n===0)return!0;let r=e.charCodeAt(n-1);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n);if(o.get(s)!==0)return!0}return!1}function AU(o,e,t,n,i){if(n+i===t)return!0;let r=e.charCodeAt(n+i);if(o.get(r)!==0||r===13||r===10)return!0;if(i>0){let s=e.charCodeAt(n+i-1);if(o.get(s)!==0)return!0}return!1}function FC(o,e,t,n,i){return OU(o,e,t,n,i)&&AU(o,e,t,n,i)}var Qa=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let i=n.index,r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){wu(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=r,!this._wordSeparators||FC(this._wordSeparators,e,t,i,r))return n}while(n);return null}};var el=65535;function o2(o){let e;return o[o.length-1]<65536?e=new Uint16Array(o.length):e=new Uint32Array(o.length),e.set(o,0),e}var q1=class{constructor(e,t,n,i,r){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=r}};function sa(o,e=!0){let t=[0],n=1;for(let i=0,r=o.length;i<r;i++){let s=o.charCodeAt(i);s===13?i+1<r&&o.charCodeAt(i+1)===10?(t[n++]=i+2,i++):t[n++]=i+1:s===10&&(t[n++]=i+1)}return e?o2(t):t}function r2(o,e){o.length=0,o[0]=0;let t=1,n=0,i=0,r=0,s=!0;for(let l=0,d=e.length;l<d;l++){let c=e.charCodeAt(l);c===13?l+1<d&&e.charCodeAt(l+1)===10?(r++,o[t++]=l+2,l++):(n++,o[t++]=l+1):c===10?(i++,o[t++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new q1(o2(o),n,i,r,s);return o.length=0,a}var _i=class{bufferIndex;start;end;length;lineFeedCnt;constructor(e,t,n,i,r){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=r}},aa=class{buffer;lineStarts;constructor(e,t){this.buffer=e,this.lineStarts=t}},Y1=class{_pieces;_index;_tree;_BOM;constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Pe&&e.iterate(e.root,n=>(n!==Pe&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},X1=class{_limit;_cache;constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let r=n[i];if(r.node.parent===null||r.nodeStartOffset>=e){n[i]=null,t=!0;continue}}if(t){let i=[];for(let r of n)r!==null&&i.push(r);this._cache=i}}},BC=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new aa("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Pe,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let r=0,s=e.length;r<s;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=sa(e[r].buffer));let a=new _i(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),i=this.rbInsertRight(i,a)}this._searchCache=new X1(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=el,n=t-Math.floor(t/3),i=n*2,r="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=n||s+c<i)return r+=d,s+=c,!0;let u=r.replace(/\r\n|\r|\n/g,e);return a.push(new aa(u,sa(u))),r=d,s=c,!0}),s>0){let l=r.replace(/\r\n|\r|\n/g,e);a.push(new aa(l,sa(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new Y1(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,i=>{if(i===Pe)return!0;let r=this.getNodeContent(i),s=r.length,a=e.nodeAt(t),l=e.nodeAt(t+s),d=e.getValueInRange2(a,l);return t+=s,r===d})}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==Pe;)if(i.left!==Pe&&i.lf_left+1>=e)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let r=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=r+t-1}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==Pe;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let r=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+r.index,r.index===0){let s=this.getOffsetAt(n+1,1),a=i-s;return new M(n+1,a+1)}return new M(n+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===Pe){let r=this.getOffsetAt(n+1,1),s=i-e-r;return new M(n+1,s+1)}else t=t.right;return new M(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(n,i);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+e.remainder,d+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),s=i.substring(r+e.remainder,r+n.piece.length);for(n=n.next();n!==Pe;){let a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){s+=a.substring(l,l+t.remainder);break}else s+=a.substr(l,n.piece.length);n=n.next()}return s}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,r=>{if(r===Pe)return!0;let s=r.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,p=d[c]+s.start.column;if(i&&(l.charCodeAt(p)===10&&(p++,a--),e[t++]=n,n="",i=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(p+a-1)===13?(i=!0,n+=l.substr(p,a-1)):n+=l.substr(p,a),!0;n+=this._EOLNormalized?l.substring(p,Math.max(p,d[c+1]-this._EOLLength)):l.substring(p,d[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let m=c+1;m<u;m++)n=this._EOLNormalized?l.substring(d[m],d[m+1]-this._EOLLength):l.substring(d[m],d[m+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(i=!0,s.end.column===0?t--:n=l.substr(d[u],s.end.column-1)):n=l.substr(d[u],s.end.column),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{let t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let n=t.node.next();if(!n||n===Pe)return"";let i=this._buffers[n.piece.bufferIndex],r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(r,r+n.piece.length)}else{let n=this._buffers[t.node.piece.bufferIndex],i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=i+t.remainder,s=i+t.node.piece.length;return n.buffer.substring(r,s)}}findMatchesInNode(e,t,n,i,r,s,a,l,d,c,u){let p=this._buffers[e.piece.bufferIndex],m=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,r),g=this.offsetInBuffer(e.piece.bufferIndex,s),b,v={line:0,column:0},I,C;t._wordSeparators?(I=p.buffer.substring(f,g),C=S=>S+f,t.reset(0)):(I=p.buffer,C=S=>S,t.reset(f));do if(b=t.next(I),b){if(C(b.index)>=g)return c;this.positionInBuffer(e,C(b.index)-m,v);let S=this.getLineFeedCnt(e.piece.bufferIndex,r,v),_=v.line===r.line?v.column-r.column+i:v.column+1,R=_+b[0].length;if(u[c++]=ld(new w(n+S,_,n+S,R),b,l),C(b.index)+b[0].length>=g||c>=d)return c}while(b);return c}findMatchesLineByLine(e,t,n,i){let r=[],s=0,a=new Qa(t.wordSeparators,t.regex),l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let d=this.nodeAt2(e.endLineNumber,e.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,c,u,t,n,i,s,r),r;let p=e.startLineNumber,m=l.node;for(;m!==d.node;){let g=this.getLineFeedCnt(m.piece.bufferIndex,c,m.piece.end);if(g>=1){let v=this._buffers[m.piece.bufferIndex].lineStarts,I=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),C=v[c.line+g],S=p===e.startLineNumber?e.startColumn:1;if(s=this.findMatchesInNode(m,a,p,S,c,this.positionInBuffer(m,C-I),t,n,i,s,r),s>=i)return r;p+=g}let b=p===e.startLineNumber?e.startColumn-1:0;if(p===e.endLineNumber){let v=this.getLineContent(p).substring(b,e.endColumn-1);return s=this._findMatchesInLine(t,a,v,e.endLineNumber,b,s,r,n,i),r}if(s=this._findMatchesInLine(t,a,this.getLineContent(p).substr(b),p,b,s,r,n,i),s>=i)return r;p++,l=this.nodeAt2(p,1),m=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(p===e.endLineNumber){let g=p===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(p).substring(g,e.endColumn-1);return s=this._findMatchesInLine(t,a,b,e.endLineNumber,g,s,r,n,i),r}let f=p===e.startLineNumber?e.startColumn:1;return s=this.findMatchesInNode(d.node,a,p,f,c,u,t,n,i,s,r),r}_findMatchesInLine(e,t,n,i,r,s,a,l,d){let c=e.wordSeparators;if(!l&&e.simpleSearch){let p=e.simpleSearch,m=p.length,f=n.length,g=-m;for(;(g=n.indexOf(p,g+m))!==-1;)if((!c||FC(c,n,f,g,m))&&(a[s++]=new nd(new w(i,g+1+r,i,g+1+m+r),null),s>=d))return s;return s}let u;t.reset(0);do if(u=t.next(n),u&&(a[s++]=ld(new w(i,u.index+1+r,i,u.index+1+u[0].length+r),u,l),s>=d))return s;while(u);return s}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Pe){let{node:i,remainder:r,nodeStartOffset:s}=this.nodeAt(e),a=i.piece,l=a.bufferIndex,d=this.positionInBuffer(i,r);if(i.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===e&&t.length<el){this.appendToNode(i,t),this.computeBufferMetadata();return}if(s===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(s+i.piece.length>e){let c=[],u=new _i(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(i,r)===10){let g={line:u.start.line+1,column:0};u=new _i(u.bufferIndex,g,u.end,this.getLineFeedCnt(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(i,r-1)===13){let g=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,g),t="\r"+t,i.piece.length===0&&c.push(i)}else this.deleteNodeTail(i,d);else this.deleteNodeTail(i,d);let p=this.createNewPieces(t);u.length>0&&this.rbInsertRight(i,u);let m=i;for(let f=0;f<p.length;f++)m=this.rbInsertRight(m,p[f]);this.deleteNodes(c)}else this.insertContentToNodeRight(t,i)}else{let i=this.createNewPieces(t),r=this.rbInsertLeft(null,i[0]);for(let s=1;s<i.length;s++)r=this.rbInsertRight(r,i[s])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Pe)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),r=n.node,s=i.node;if(r===s){let p=this.positionInBuffer(r,n.remainder),m=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){let f=r.next();Sf(this,r),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(r,m),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,p),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,p,m),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);let d=this.positionInBuffer(s,i.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=r.next();for(let p=c;p!==Pe&&p!==s;p=p.next())a.push(p);let u=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let s=t.piece,a={line:s.start.line+1,column:0},l=new _i(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);t.piece=l,e+=`
`,oa(this,t,-1,-1),t.piece.length===0&&n.push(t)}let i=this.createNewPieces(e),r=this.rbInsertLeft(t,i[i.length-1]);for(let s=i.length-2;s>=0;s--)r=this.rbInsertLeft(r,i[s]);this.validateCRLFWithPrevNode(r),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),r=i;for(let s=1;s<n.length;s++)r=this.rbInsertRight(r,n[s]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,r=e.piece.bufferIndex,s=this._buffers[r].lineStarts,l=s[i.start.line]+i.start.column+t,d=i.start.line,c=i.end.line,u=0,p=0,m=0;for(;d<=c&&(u=d+(c-d)/2|0,m=s[u],u!==c);)if(p=s[u+1],l<m)c=u-1;else if(l>=p)d=u+1;else break;return n?(n.line=u,n.column=l-m,null):{line:u,column:l-m}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let r=i[n.line+1],s=i[n.line]+n.column;if(r>s+1)return n.line-t.line;let a=s-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Sf(this,e[t])}createNewPieces(e){if(e.length>el){let c=[];for(;e.length>el;){let p=e.charCodeAt(el-1),m;p===13||p>=55296&&p<=56319?(m=e.substring(0,el-1),e=e.substring(el-1)):(m=e.substring(0,el),e=e.substring(el));let f=sa(m);c.push(new _i(this._buffers.length,{line:0,column:0},{line:f.length-1,column:m.length-f[f.length-1]},f.length-1,m.length)),this._buffers.push(new aa(m,f))}let u=sa(e);return c.push(new _i(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new aa(e,u)),c}let t=this._buffers[0].buffer.length,n=sa(e,!1),i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let c=0;c<n.length;c++)n[c]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let c=0;c<n.length;c++)n[c]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let r=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new _i(0,i,l,this.getLineFeedCnt(0,i,l),r-t);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,i="",r=this._searchCache.get2(e);if(r){n=r.node;let s=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e)i=a.substring(l+s,l+n.piece.length);else{let d=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+s,l+d-t)}}else{let s=0,a=e;for(;n!==Pe;)if(n.left!==Pe&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this.getAccumulatedValue(n,e-n.lf_left-1),c=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:a-(e-1-n.lf_left)}),c.substring(u+l,u+d-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(n,e-n.lf_left-2),d=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=d.substring(c+l,c+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==Pe;){let s=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=s.substring(l,l+a-t),i}else{let a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=s.substr(a,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==Pe;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let s=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(s!==r)return{index:s,remainder:0}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,r=n.start.line+t+1;return r>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[r]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.end),s=t,a=this.offsetInBuffer(n.bufferIndex,s),l=this.getLineFeedCnt(n.bufferIndex,n.start,s),d=l-i,c=a-r,u=n.length+c;e.piece=new _i(n.bufferIndex,n.start,s,l,u),oa(this,e,c,d)}deleteNodeHead(e,t){let n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.start),s=t,a=this.getLineFeedCnt(n.bufferIndex,s,n.end),l=this.offsetInBuffer(n.bufferIndex,s),d=a-i,c=r-l,u=n.length+c;e.piece=new _i(n.bufferIndex,s,n.end,a,u),oa(this,e,c,d)}shrinkNode(e,t,n){let i=e.piece,r=i.start,s=i.end,a=i.length,l=i.lineFeedCnt,d=t,c=this.getLineFeedCnt(i.bufferIndex,i.start,d),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new _i(i.bufferIndex,i.start,d,c,u),oa(this,e,u-a,c-l);let p=new _i(i.bufferIndex,n,s,this.getLineFeedCnt(i.bufferIndex,n,s),this.offsetInBuffer(i.bufferIndex,s)-this.offsetInBuffer(i.bufferIndex,n)),m=this.rbInsertRight(e,p);this.validateCRLFWithPrevNode(m)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let r=sa(t,!1);for(let m=0;m<r.length;m++)r[m]+=i;if(n){let m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=e.piece.length+t.length,c=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),p=u-c;e.piece=new _i(e.piece.bufferIndex,e.piece.start,l,u,d),this._lastChangeBufferPos=l,oa(this,e,t.length,p)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==Pe;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){i+=t.size_left;let r={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==Pe;)if(n.left!==Pe&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(r+t-1,s),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length)return{node:n,remainder:r+t-1,nodeStartOffset:i};t-=n.piece.length-r;break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==Pe;){if(n.piece.lineFeedCnt>0){let r=this.getAccumulatedValue(n,0),s=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,r),nodeStartOffset:s}}else if(n.piece.length>=t-1){let r=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:r}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Pe||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,r=n[i]+t.start.column;return i===n.length-1||n[i+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Pe||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],i=this._buffers[e.piece.bufferIndex].lineStarts,r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};let s=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new _i(e.piece.bufferIndex,e.piece.start,r,a,s),oa(this,e,-1,-1),e.piece.length===0&&n.push(e);let l={line:t.piece.start.line+1,column:0},d=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new _i(t.piece.bufferIndex,l,t.piece.end,c,d),oa(this,t,-1,-1),t.piece.length===0&&n.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let p=0;p<n.length;p++)Sf(this,n[p])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)Sf(this,n);else{let i=n.piece,r={line:i.start.line+1,column:0},s=i.length-1,a=this.getLineFeedCnt(i.bufferIndex,r,i.end);n.piece=new _i(i.bufferIndex,r,i.end,a,s),oa(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Pe)return t(Pe);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Pe)return"";let t=this._buffers[e.piece.bufferIndex],n=e.piece,i=this.offsetInBuffer(n.bufferIndex,n.start),r=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(i,r)}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new Yp(t,1);if(n.left=Pe,n.right=Pe,n.parent=Pe,n.size_left=0,n.lf_left=0,this.root===Pe)this.root=n,n.color=0;else if(e.right===Pe)e.right=n,n.parent=e;else{let r=OC(e.right);r.left=n,n.parent=r}return j1(this,n),n}rbInsertLeft(e,t){let n=new Yp(t,1);if(n.left=Pe,n.right=Pe,n.parent=Pe,n.size_left=0,n.lf_left=0,this.root===Pe)this.root=n,n.color=0;else if(e.left===Pe)e.left=n,n.parent=e;else{let i=K1(e.left);i.right=n,n.parent=i}return j1(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}};var Xp=class o extends V{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;constructor(e,t,n,i,r,s,a){super(),this._BOM=t,this._mightContainNonBasicASCII=!s,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new BC(e,n,a)}equals(e){return!(e instanceof o)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,i=this.getPositionAt(e),r=this.getPositionAt(n);return new w(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn),r=0,s=this._getEndOfLine(t),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=e.endLineNumber-e.startLineNumber;r=l*d}return i-n+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0,i=e.startLineNumber,r=e.endLineNumber;for(let s=i;s<=r;s++){let a=this.getLineContent(s),l=s===i?e.startColumn-1:0,d=s===r?e.endColumn-1:a.length;for(let c=l;c<d;c++)At(a.charCodeAt(c))?(n=n+1,c=c+1):n=n+1}return n+=this._getEndOfLine(t).length*(r-i),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=zt(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=qo(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let g=0;g<e.length;g++){let b=e[g];a&&b._isTracked&&(a=!1);let v=b.range;if(b.text){let R=!0;s||(R=!Nm(b.text),s=R),!i&&R&&(i=Na(b.text)),!r&&R&&(r=bv(b.text))}let I="",C=0,S=0,_=0;if(b.text){let R;[C,S,_,R]=oo(b.text);let N=this.getEOL(),F=N===`\r
`?2:1;R===0||R===F?I=b.text:I=b.text.replace(/\r\n|\r|\n/g,N)}l[g]={sortIndex:g,identifier:b.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:I,eolCount:C,firstLineLength:S,lastLineLength:_,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(o._sortOpsAscending);let d=!1;for(let g=0,b=l.length-1;g<b;g++){let v=l[g].range.getEndPosition(),I=l[g+1].range.getStartPosition();if(I.isBeforeOrEqual(v)){if(I.isBefore(v))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=n||t?o._getInverseEditRanges(l):[],u=[];if(t)for(let g=0;g<l.length;g++){let b=l[g],v=c[g];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let I=v.startLineNumber;I<=v.endLineNumber;I++){let C="";I===v.startLineNumber&&(C=this.getLineContent(b.range.startLineNumber),zt(C)!==-1)||u.push({lineNumber:I,oldContent:C})}}let p=null;if(n){let g=0;p=[];for(let b=0;b<l.length;b++){let v=l[b],I=c[b],C=this.getValueInRange(v.range),S=v.rangeOffset+g;g+=v.text.length-C.length,p[b]={sortIndex:v.sortIndex,identifier:v.identifier,range:I,text:C,textChange:new To(v.rangeOffset,C,S,v.text)}}d||p.sort((b,v)=>b.sortIndex-v.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=s;let m=this._doApplyEdits(l),f=null;if(t&&u.length>0){u.sort((g,b)=>b.lineNumber-g.lineNumber),f=[];for(let g=0,b=u.length;g<b;g++){let v=u[g].lineNumber;if(g>0&&u[g-1].lineNumber===v)continue;let I=u[g].oldContent,C=this.getLineContent(v);C.length===0||C===I||zt(C)!==-1||f.push(v)}}return this._onDidChangeContent.fire(),new pI(p,m,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,i=e[e.length-1].range,r=new w(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn),s=n.startLineNumber,a=n.startColumn,l=[];for(let m=0,f=e.length;m<f;m++){let g=e[m],b=g.range;t=t||g.forceMoveMarkers,l.push(this.getValueInRange(new w(s,a,b.startLineNumber,b.startColumn))),g.text.length>0&&l.push(g.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,p]=oo(d);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:p,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(o._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n],r=i.range.startLineNumber,s=i.range.startColumn,a=i.range.endLineNumber,l=i.range.endColumn;if(r===a&&s===l&&i.text.length===0)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);let d=new w(r,s,a,l);t.push({range:d,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,i=e.startColumn,[r,s,a]=oo(t),l;if(t.length>0){let d=r+1;d===1?l=new w(n,i,n,i+s):l=new w(n,i,n+d-1,a+1)}else l=new w(n,i,n,i);return l}static _getInverseEditRanges(e){let t=[],n=0,i=0,r=null;for(let s=0,a=e.length;s<a;s++){let l=e[s],d,c;r?r.range.endLineNumber===l.range.startLineNumber?(d=n,c=i+(l.range.startColumn-r.range.endColumn)):(d=n+(l.range.startLineNumber-r.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let p=l.eolCount+1;p===1?u=new w(d,c,d,c+l.firstLineLength):u=new w(d,c,d+p-1,l.lastLineLength+1)}else u=new w(d,c,d,c);n=u.endLineNumber,i=u.endColumn,t.push(u),r=l}return t}static _sortOpsAscending(e,t){let n=w.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=w.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}};var Z1=class{constructor(e,t,n,i,r,s,a,l,d){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=r;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,s=n.length;r<s;r++){let a=n[r].buffer.replace(/\r\n|\r|\n/g,t),l=sa(a);n[r]=new aa(a,l)}let i=new Xp(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},Zp=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&DM(e)&&(this.BOM=LM,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=r2(this._tmpLineStarts,e);this.chunks.push(new aa(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Na(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=bv(e)))}finish(e=!0){return this._finish(),new Z1(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=sa(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}};var Q1=new class{clone(){return this}equals(o){return this===o}};function WC(o,e){let t=new Uint32Array(2);return t[0]=0,t[1]=(o<<0|0|0|32768|2<<24)>>>0,new Hy(t,e===null?Q1:e)}var VC=class{constructor(e){this._default=e}_store=[];get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,n){if(e>=this._store.length)return;if(t===0){this.insert(e,n);return}else if(n===0){this.delete(e,t);return}let i=this._store.slice(0,e),r=this._store.slice(e+t),s=BU(n,this._default);this._store=i.concat(s,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;let n=[];for(let i=0;i<t;i++)n[i]=this._default;this._store=_s(this._store,e,n)}};function BU(o,e){let t=[];for(let n=0;n<o;n++)t[n]=e;return t}var Fc=class{static deserialize(e){let t=0,n=Bn(e,t);t+=4;let i=[];for(let r=0;r<n;r++)t=wg.deserialize(e,t,i);return i}_tokens;constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){let n=this._tokens[this._tokens.length-1];if(n.endLineNumber+1===e){n.appendLineTokens(t);return}}this._tokens.push(new wg(e,[t]))}finalize(){return this._tokens}serialize(){let e=this._serializeSize(),t=new Uint8Array(e);return this._serialize(t),t}_serializeSize(){let e=0;e+=4;for(let t=0;t<this._tokens.length;t++)e+=this._tokens[t].serializeSize();return e}_serialize(e){let t=0;Wn(e,this._tokens.length,t),t+=4;for(let n=0;n<this._tokens.length;n++)t=this._tokens[n].serialize(e,t)}};var J1=class{constructor(e,t){this.tokenizationSupport=t;this.store=new Jp(e)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},HC=class extends J1{constructor(t,n,i,r){super(t,n);this._textModel=i;this._languageIdCodec=r}updateTokensUntilLine(t,n){let i=this._textModel.getLanguageId();for(;;){let r=this.getFirstInvalidLine();if(!r||r.lineNumber>n)break;let s=this._textModel.getLineContent(r.lineNumber),a=Qp(this._languageIdCodec,i,this.tokenizationSupport,s,!0,r.startState);t.add(r.lineNumber,a.tokens),this.store.setEndState(r.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(t,n){let i=this.getStartState(t.lineNumber);if(!i)return 0;let r=this._textModel.getLanguageId(),s=this._textModel.getLineContent(t.lineNumber),a=s.substring(0,t.column-1)+n+s.substring(t.column-1),l=Qp(this._languageIdCodec,r,this.tokenizationSupport,a,!0,i),d=new en(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(t.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(t,n){let i=this.getStartState(t);if(!i)return{mainLineTokens:null,additionalLines:null};let r=this._textModel.getLineContent(t),s=n.lineEdit.apply(r),a=this._textModel.getLanguageIdAtPosition(t,0),l=Qp(this._languageIdCodec,a,this.tokenizationSupport,s,!0,i),d=null;if(n.additionalLines){d=[];let u=l.endState;for(let p of n.additionalLines){let m=Qp(this._languageIdCodec,a,this.tokenizationSupport,p,!0,u);d.push(new en(m.tokens,p,this._languageIdCodec)),u=m.endState}}return{mainLineTokens:new en(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n}isCheapToTokenize(t){let n=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<n||t===n&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,n,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,i),{heuristicTokens:!1};let r=this.guessStartState(n),s=this._textModel.getLanguageId();for(let a=n;a<=i;a++){let l=this._textModel.getLineContent(a),d=Qp(this._languageIdCodec,s,this.tokenizationSupport,l,!0,r);t.add(a,d.tokens),r=d.endState}return{heuristicTokens:!0}}guessStartState(t){let n=this._textModel.getLineFirstNonWhitespaceColumn(t),i=[],r=null;for(let l=t-1;n>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<n&&(i.push(this._textModel.getLineContent(l)),n=d,r=this.getStartState(l),r))break}r||(r=this.tokenizationSupport.getInitialState()),i.reverse();let s=this._textModel.getLanguageId(),a=r;for(let l of i)a=Qp(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},Jp=class{constructor(e){this.lineCount=e;this._invalidEndStatesLineNumbers.addRange(new wt(1,e+1))}_tokenizationStateStore=new e0;_invalidEndStatesLineNumbers=new t0;getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new $e("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);let n=this._tokenizationStateStore.setEndState(e,t);return n&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new wt(e+1,e+2)),n}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new wt(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(let t of e){let[n]=oo(t.text);this.acceptChange(new Ci(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new wt(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){let t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;let n=this.getStartState(t,e);if(!n)throw new $e("Start state must be defined");return{lineNumber:t,startState:n}}},e0=class{_lineEndStates=new VC(null);getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){let n=this._lineEndStates.get(e);return n&&n.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let n=e.length;t>0&&n>0&&(n--,t--),this._lineEndStates.replace(e.startLineNumber,n,t)}acceptChanges(e){for(let t of e){let[n]=oo(t.text);this.acceptChange(new Ci(t.range.startLineNumber,t.range.endLineNumber+1),n+1)}}},t0=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let e=this._ranges[0];return e.start+1===e.endExclusive?this._ranges.shift():this._ranges[0]=new wt(e.start+1,e.endExclusive),e.start}delete(e){let t=this._ranges.findIndex(n=>n.contains(e));if(t!==-1){let n=this._ranges[t];n.start===e?n.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new wt(e+1,n.endExclusive):n.endExclusive===e+1?this._ranges[t]=new wt(n.start,e):this._ranges.splice(t,1,new wt(n.start,e),new wt(e+1,n.endExclusive))}}addRange(e){wt.addRange(e,this._ranges)}addRangeAndResize(e,t){let n=0;for(;!(n>=this._ranges.length||e.start<=this._ranges[n].endExclusive);)n++;let i=n;for(;!(i>=this._ranges.length||e.endExclusive<this._ranges[i].start);)i++;let r=t-e.length;for(let s=i;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(r);if(n===i){let s=new wt(e.start,e.start+t);s.isEmpty||this._ranges.splice(n,0,s)}else{let s=Math.min(e.start,this._ranges[n].start),a=Math.max(e.endExclusive,this._ranges[i-1].endExclusive),l=new wt(s,a+r);l.isEmpty?this._ranges.splice(n,i-n):this._ranges.splice(n,i-n,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}};function Qp(o,e,t,n,i,r){let s=null;if(t)try{s=t.tokenizeEncoded(n,i,r.clone())}catch(a){We(a)}return s||(s=WC(o.encodeLanguageId(e),r)),en.convertToEndOffset(s.tokens,n.length),s}var UC=class{constructor(e,t){this._tokenizerWithStateStore=e;this._backgroundTokenStore=t}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Ol(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){let t=Date.now()+e.timeRemaining(),n=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?Vb(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){let e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new Fc,n=qi.create(!1);do if(n.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){let t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Ci(e,t))}};var zC=class{_onDidChangeVisibleRanges=new L;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let e=new n0(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}},n0=class{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){let n=e.map(i=>new Ci(i.startLineNumber,i.endLineNumber+1));this.handleStateChange({visibleLineRanges:n,stabilized:t})}},KC=class extends V{constructor(t){super();this._refreshTokens=t}runner=this._register(new dn(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){tn(this._computedLineRanges,this._lineRanges,(t,n)=>t.equals(n))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},eh=class extends V{constructor(t,n,i){super();this._languageIdCodec=t;this._textModel=n;this.getLanguageId=i}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new L);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new L);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}};var s2=j("treeSitterParserService");var xf=class extends eh{constructor(t,n,i,r){super(n,i,r);this._treeSitterService=t;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let t=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==t)&&(this._lastLanguageId=t,this._tokenizationSupport=kg.get(t))}getLineTokens(t){let n=this._textModel.getLineContent(t);if(this._tokenizationSupport){let i=this._tokenizationSupport.tokenizeEncoded(t,this._textModel);if(i)return new en(i,n,this._languageIdCodec)}return en.createEmpty(n,this._languageIdCodec)}resetTokenization(t=!0){t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(t){t.isFlush&&this.resetTokenization(!1)}forceTokenization(t){}hasAccurateTokensForLine(t){return!0}isCheapToTokenize(t){return!0}getTokenTypeIfInsertingCharacter(t,n,i){return 0}tokenizeLineWithEdit(t,n){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var _f=class o{_lineTokens;_len;_languageIdCodec;constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),i!==null&&i!==$s)return new en(js(i),n,this._languageIdCodec);let r=new Uint32Array(2);return r[0]=n.length,r[1]=a2(this._languageIdCodec.encodeLanguageId(e)),new en(r,n,this._languageIdCodec)}static _massageTokens(e,t,n){let i=n?js(n):null;if(t===0){let r=!1;if(i&&i.length>1&&(r=Lo.getLanguageId(i[1])!==e),!r)return $s}if(!i||i.length===0){let r=new Uint32Array(2);return r[0]=t,r[1]=a2(e),r.buffer}return i[i.length-2]=t,i.byteOffset===0&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=_s(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,r){let s=o._massageTokens(this._languageIdCodec.encodeLanguageId(e),n,i);this._ensureLine(t);let a=this._lineTokens[t];return this._lineTokens[t]=s,r?!o._equals(a,s):!1}static _equals(e,t){if(!e||!t)return!e&&!t;let n=js(e),i=js(t);if(n.length!==i.length)return!1;for(let r=0,s=n.length;r<s;r++)if(n[r]!==i[r])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new M(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){let t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=Vn.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=Vn.deleteEnding(this._lineTokens[t],e.startColumn-1);let n=e.endLineNumber-1,i=null;n<this._len&&(i=Vn.deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=Vn.append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(t===0&&n===0)return;let i=e.lineNumber-1;if(!(i>=this._len)){if(t===0){this._lineTokens[i]=Vn.insert(this._lineTokens[i],e.column-1,n);return}this._lineTokens[i]=Vn.deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=Vn.insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(t.getLanguageId(),c-1,t.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&n.push({fromLineNumber:a,toLineNumber:l})}return{changes:n}}};function a2(o){return(o<<0|0|0|32768|2<<24|1024)>>>0}var GC=class o{_pieces;_isComplete;_languageIdCodec;constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){let r=t[0].getRange(),s=t[t.length-1].getRange();if(!r||!s)return e;n=e.plusRange(r).plusRange(s)}let i=null;for(let r=0,s=this._pieces.length;r<s;r++){let a=this._pieces[r];if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};break}if(a.removeTokens(n),a.isEmpty()){this._pieces.splice(r,1),r--,s--;continue}if(a.endLineNumber<n.startLineNumber)continue;if(a.startLineNumber>n.endLineNumber){i=i||{index:r};continue}let[l,d]=a.split(n);if(l.isEmpty()){i=i||{index:r};continue}d.isEmpty()||(this._pieces.splice(r,1,l,d),r++,s++,i=i||{index:r})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=_s(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;let n=this._pieces;if(n.length===0)return t;let i=o._findFirstPieceWithLine(n,e),r=n[i].getLineTokens(e);if(!r)return t;let s=t.getCount(),a=r.getCount(),l=0,d=[],c=0,u=0,p=(m,f)=>{m!==u&&(u=m,d[c++]=m,d[c++]=f)};for(let m=0;m<a;m++){let f=r.getStartCharacter(m),g=r.getEndCharacter(m),b=r.getMetadata(m),v=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,I=~v>>>0;for(;l<s&&t.getEndOffset(l)<=f;)p(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<s&&t.getStartOffset(l)<f&&p(f,t.getMetadata(l));l<s&&t.getEndOffset(l)<g;)p(t.getEndOffset(l),t.getMetadata(l)&I|b&v),l++;if(l<s)p(g,t.getMetadata(l)&I|b&v),t.getEndOffset(l)===g&&l++;else{let C=Math.min(Math.max(0,l-1),s-1);p(g,t.getMetadata(C)&I|b&v)}}for(;l<s;)p(t.getEndOffset(l),t.getMetadata(l)),l++;return new en(new Uint32Array(d),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let r=n+Math.floor((i-n)/2);if(e[r].endLineNumber<t)n=r+1;else if(e[r].startLineNumber>t)i=r-1;else{for(;r>n&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return n}acceptEdit(e,t,n,i,r){for(let s of this._pieces)s.acceptEdit(e,t,n,i,r)}};var tl=class extends Gp{constructor(t,n,i,r,s,a,l){super();this._textModel=t;this._bracketPairsTextModelPart=n;this._languageId=i;this._attachedViews=r;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(de.filter(kg.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new GC(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new L);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new L);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new L);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new ae);createGrammarTokens(){return this._register(new $C(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new xf(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(t){let n=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=t?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),n&&this._tokens.resetTokenization()}createPreferredTokenProvider(){kg.get(this._languageId)?this._tokens instanceof xf||this.createTokens(!0):this._tokens instanceof $C||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(t){t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(let n of t.changes){let[i,r,s]=oo(n.text);this._semanticTokens.acceptEdit(n.range,i,r,s,n.text.length>0?n.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(t)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);let n=this._tokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,n)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new $e("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this._tokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this._tokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this._tokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this._tokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,n,i){return this._tokens.getTokenTypeIfInsertingCharacter(t,n,i)}tokenizeLineWithEdit(t,n){return this._tokens.tokenizeLineWithEdit(t,n)}setSemanticTokens(t,n){this._semanticTokens.set(t,n),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,n){if(this.hasCompleteSemanticTokens())return;let i=this._textModel.validateRange(this._semanticTokens.setPartial(t,n));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();let n=this._textModel.validatePosition(t),i=this._textModel.getLineContent(n.lineNumber),r=this.getLineTokens(n.lineNumber),s=r.findTokenIndexAtOffset(n.column-1),[a,l]=tl._findLanguageBoundaries(r,s),d=sg(n.column,this.getLanguageConfiguration(r.getLanguageId(s)).getWordDefinition(),i.substring(a,l),a);if(d&&d.startColumn<=t.column&&t.column<=d.endColumn)return d;if(s>0&&a===n.column-1){let[c,u]=tl._findLanguageBoundaries(r,s-1),p=sg(n.column,this.getLanguageConfiguration(r.getLanguageId(s-1)).getWordDefinition(),i.substring(c,u),c);if(p&&p.startColumn<=t.column&&t.column<=p.endColumn)return p}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,n){let i=t.getLanguageId(n),r=0;for(let a=n;a>=0&&t.getLanguageId(a)===i;a--)r=t.getStartOffset(a);let s=t.getLineContent().length;for(let a=n,l=t.getCount();a<l&&t.getLanguageId(a)===i;a++)s=t.getEndOffset(a);return[r,s]}getWordUntilPosition(t){let n=this.getWordAtPosition(t);return n?{word:n.word.substr(0,t.column-n.startColumn),startColumn:n.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,n){let i=this._textModel.validatePosition(new M(t,n)),r=this.getLineTokens(i.lineNumber);return r.getLanguageId(r.findTokenIndexAtOffset(i.column-1))}setLanguageId(t,n="api"){if(this._languageId===t)return;let i={oldLanguage:this._languageId,newLanguage:t,source:n};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};tl=K([D(4,Hi),D(5,Dn),D(6,s2)],tl);var $C=class extends eh{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new Wt);_tokens=new _f(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new Wt);_attachedViewStates=this._register(new Go);constructor(e,t,n,i){super(e,t,n),this._register(ro.onDidChange(r=>{let s=this.getLanguageId();r.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(i.onDidChangeVisibleRanges(({view:r,state:s})=>{if(s){let a=this._attachedViewStates.get(r);a||(a=new KC(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new Jp(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let r=ro.get(this.getLanguageId());if(!r)return[null,null];let s;try{s=r.getInitialState()}catch(a){return We(a),[null,null]}return[r,s]},[n,i]=t();if(n&&i?this._tokenizer=new HC(this._textModel.getLineCount(),n,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let r={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};n&&n.createBackgroundTokenizer&&!n.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,r)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new UC(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),n?.backgroundTokenizerShouldOnlyVerifyTokens&&n.createBackgroundTokenizer?(this._debugBackgroundTokens=new _f(this._languageIdCodec),this._debugBackgroundStates=new Jp(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=n.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(let t of e.changes){let[n,i]=oo(t.text);this._tokens.acceptEdit(t.range,n,i),this._debugBackgroundTokens?.acceptEdit(t.range,n,i)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){let{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){let e=Ci.joinMany([...this._attachedViewStates].map(([t,n])=>n.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(let t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);let n=new Fc,{heuristicTokens:i}=this._tokenizer.tokenizeHeuristically(n,e,t),r=this.setTokens(n.finalize());if(i)for(let s of r.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){let t=new Fc;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){let t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){let i=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!n.equals(i)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return n}getTokenTypeIfInsertingCharacter(e,t,n){if(!this._tokenizer)return 0;let i=this._textModel.validatePosition(new M(e,t));return this.forceTokenization(i.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLineWithEdit(e,t)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function wf(o){let e=new Zp;return e.acceptChunk(o),e.finish()}function u2(o){return new Promise((e,t)=>{let n=new Zp,i=!1;dL(o,{onData:r=>{n.acceptChunk(typeof r=="string"?r:r.toString())},onError:r=>{i||(i=!0,t(r))},onEnd:()=>{i||(i=!0,e(n.finish()))}})})}function WU(o){let e=new Zp,t;for(;typeof(t=o.read())=="string";)e.acceptChunk(t);return e.finish()}function l2(o,e){let t;return typeof o=="string"?t=wf(o):tO(o)?t=WU(o):t=o,t.create(e)}var jC=0,VU=999,HU=1e4,o0=class{_source;_eos;constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(i===null)return this._eos=!0,t===0?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=64*1024)return e.join("")}while(!0)}},Ef=()=>{throw new Error("Invalid change accessor")};var da=class extends V{constructor(t,n,i,r=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;jC++,this.id="$model"+jC,this.isForSimpleWidget=i.isForSimpleWidget,typeof r>"u"||r===null?this._associatedResource=le.parse("inmemory://model/"+jC):this._associatedResource=r,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=l2(t,i.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=da.resolveOptions(this._buffer,i);let p=typeof n=="string"?n:n.languageId;typeof n!="string"&&(this._languageSelectionListener.value=n.onDidChange(()=>this._setLanguage(n.languageId))),this._bracketPairs=this._register(new yC(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new NC(this,this._languageConfigurationService)),this._decorationProvider=this._register(new kC(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(tl,this,this._bracketPairs,p,this._attachedViews);let m=this._buffer.getLineCount(),f=this._buffer.getValueLengthInRange(new w(1,1,m,this._buffer.getLineLength(m)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=f>da.LARGE_FILE_SIZE_THRESHOLD||m>da.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=f>da.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=f>da._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=vv(jC),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new YC,this._commandManager=new PC(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(g=>{this._bracketPairs.handleLanguageConfigurationServiceChange(g),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(g)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Ws.tabSize,indentSize:Ws.indentSize,insertSpaces:Ws.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Ws.trimAutoWhitespace,largeFileOptimizations:Ws.largeFileOptimizations,bracketPairColorizationOptions:Ws.bracketPairColorizationOptions};static resolveOptions(t,n){if(n.detectIndentation){let i=H1(t,n.tabSize,n.insertSpaces);return new pp({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:n.trimAutoWhitespace,defaultEOL:n.defaultEOL,bracketPairColorizationOptions:n.bracketPairColorizationOptions})}return new pp(n)}_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new l0(t=>this.handleBeforeFireDecorationsChangedEvent(t)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new L);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new L);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new L);_eventEmitter=this._register(new d0);onDidChangeContent(t){return this._eventEmitter.slowEvent(n=>t(n.contentChangedEvent))}onDidChangeContentOrInjectedText(t){return Ls(this._eventEmitter.fastEvent(n=>t(n)),this._onDidChangeInjectedText.event(n=>t(n)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new Wt);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new zC;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let t=new Xp([],"",`
`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=V.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new $e("Model is disposed!")}equalsTextBuffer(t){return this._assertNotDisposed(),this._buffer.equals(t)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(t,n){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(n),this._bracketPairs.handleDidChangeContent(n),this._eventEmitter.fire(new td(t,n)))}setValue(t){if(this._assertNotDisposed(),t==null)throw wd();let{textBuffer:n,disposable:i}=l2(t,this._options.defaultEOL);this._setValueFromTextBuffer(n,i)}_createContentChanged2(t,n,i,r,s,a,l,d){return{changes:[{range:t,rangeOffset:n,rangeLength:i,text:r}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(t,n){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=n,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new YC,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new bc([new sI],this._versionId,!1,!1),this._createContentChanged2(new w(1,1,s,a),0,r,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();let n=t===1?`\r
`:`
`;if(this._buffer.getEOL()===n)return;let i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(n),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new bc([new dI],this._versionId,!1,!1),this._createContentChanged2(new w(1,1,s,a),0,r,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let t=this.getVersionId(),n=this._decorationsTree.collectNodesPostOrder();for(let i=0,r=n.length;i<r;i++){let s=n[i],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=t,s.start=d-l,s.end=c-l,Za(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,n=0,i=this._buffer.getLineCount();for(let r=1;r<=i;r++){let s=this._buffer.getLineLength(r);s>=HU?n+=s:t+=s}return n>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();let n=typeof t.tabSize<"u"?t.tabSize:this._options.tabSize,i=typeof t.indentSize<"u"?t.indentSize:this._options.originalIndentSize,r=typeof t.insertSpaces<"u"?t.insertSpaces:this._options.insertSpaces,s=typeof t.trimAutoWhitespace<"u"?t.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof t.bracketColorizationOptions<"u"?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new pp({tabSize:n,indentSize:i,insertSpaces:r,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(t,n){this._assertNotDisposed();let i=H1(this._buffer,n,t);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),hI(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){let n=this.findMatches(YE.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,n.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();let n=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(n.lineNumber,n.column)}getPositionAt(t){this._assertNotDisposed();let n=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(n)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,n=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new $e("Operation would exceed heap memory limits");let i=this.getFullModelRange(),r=this.getValueInRange(i,t);return n?this._buffer.getBOM()+r:r}createSnapshot(t=!1){return new o0(this._buffer.createSnapshot(t))}getValueLength(t,n=!1){this._assertNotDisposed();let i=this.getFullModelRange(),r=this.getValueLengthInRange(i,t);return n?this._buffer.getBOM().length+r:r}getValueInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),n)}getValueLengthInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),n)}getCharacterCountInRange(t,n=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),n)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new $e("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new $e("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){let n=this._buffer.getLineCount(),i=t.startLineNumber,r=t.startColumn,s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=Math.floor(typeof r=="number"&&!isNaN(r)?r:1);if(s<1)s=1,a=1;else if(s>n)s=n,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let p=this.getLineMaxColumn(s);a>=p&&(a=p)}let l=t.endLineNumber,d=t.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>n)c=n,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let p=this.getLineMaxColumn(c);u>=p&&(u=p)}return i===s&&r===a&&l===c&&d===u&&t instanceof w&&!(t instanceof Me)?t:new w(s,a,c,u)}_isValidPosition(t,n,i){if(typeof t!="number"||typeof n!="number"||isNaN(t)||isNaN(n)||t<1||n<1||(t|0)!==t||(n|0)!==n)return!1;let r=this._buffer.getLineCount();if(t>r)return!1;if(n===1)return!0;let s=this.getLineMaxColumn(t);if(n>s)return!1;if(i===1){let a=this._buffer.getLineCharCode(t,n-2);if(At(a))return!1}return!0}_validatePosition(t,n,i){let r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=this._buffer.getLineCount();if(r<1)return new M(1,1);if(r>a)return new M(a,this.getLineMaxColumn(a));if(s<=1)return new M(r,1);let l=this.getLineMaxColumn(r);if(s>=l)return new M(r,l);if(i===1){let d=this._buffer.getLineCharCode(r,s-2);if(At(d))return new M(r,s-1)}return new M(r,s)}validatePosition(t){let n=1;return this._assertNotDisposed(),t instanceof M&&this._isValidPosition(t.lineNumber,t.column,n)?t:this._validatePosition(t.lineNumber,t.column,n)}_isValidRange(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn;if(!this._isValidPosition(i,r,0)||!this._isValidPosition(s,a,0))return!1;if(n===1){let l=r>1?this._buffer.getLineCharCode(i,r-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=At(l),u=At(d);return!c&&!u}return!0}validateRange(t){let n=1;if(this._assertNotDisposed(),t instanceof w&&!(t instanceof Me)&&this._isValidRange(t,n))return t;let i=this._validatePosition(t.startLineNumber,t.startColumn,0),r=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,a=i.column,l=r.lineNumber,d=r.column;if(n===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,p=At(c),m=At(u);return!p&&!m?new w(s,a,l,d):s===l&&a===d?new w(s,a-1,l,d-1):p&&m?new w(s,a-1,l,d+1):p?new w(s,a-1,l,d):new w(s,a,l,d+1)}return new w(s,a,l,d)}modifyPosition(t,n){this._assertNotDisposed();let i=this.getOffsetAt(t)+n;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();let t=this.getLineCount();return new w(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,n,i,r){return this._buffer.findMatchesLineByLine(t,n,i,r)}findMatches(t,n,i,r,s,a,l=VU){this._assertNotDisposed();let d=null;n!==null&&(Array.isArray(n)||(n=[n]),n.every(p=>w.isIRange(p))&&(d=n.map(p=>this.validateRange(p)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((p,m)=>p.startLineNumber-m.startLineNumber||p.startColumn-m.startColumn);let c=[];c.push(d.reduce((p,m)=>w.areIntersecting(p,m)?p.plusRange(m):(c.push(p),m)));let u;if(!i&&t.indexOf(`
`)<0){let m=new Ja(t,i,r,s).parseSearchRequest();if(!m)return[];u=f=>this.findMatchesLineByLine(f,m,a,l)}else u=p=>Ac.findMatches(this,new Ja(t,i,r,s),p,a,l);return c.map(u).reduce((p,m)=>p.concat(m),[])}findNextMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);if(!i&&t.indexOf(`
`)<0){let c=new Ja(t,i,r,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),p=new w(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),m=this.findMatchesLineByLine(p,c,a,1);return Ac.findNextMatch(this,new Ja(t,i,r,s),l,a),m.length>0||(p=new w(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),m=this.findMatchesLineByLine(p,c,a,1),m.length>0)?m[0]:null}return Ac.findNextMatch(this,new Ja(t,i,r,s),l,a)}findPreviousMatch(t,n,i,r,s,a){this._assertNotDisposed();let l=this.validatePosition(n);return Ac.findPreviousMatch(this,new Ja(t,i,r,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`
`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof hp?t:new hp(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){let n=[];for(let i=0,r=t.length;i<r;i++)n[i]=this._validateEditOperation(t[i]);return n}pushEditOperations(t,n,i,r){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(n),i,r)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,n,i,r){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=n.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(t)for(let l=0,d=t.length;l<d;l++){let c=t[l],u=!1;for(let p=0,m=s.length;p<m;p++){let f=s[p].range,g=f.startLineNumber>c.endLineNumber,b=c.startLineNumber>f.endLineNumber;if(!g&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),p=!0;for(let m=0,f=s.length;m<f;m++){let g=s[m].range,b=s[m].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===u&&g.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){p=!1;break}}if(p){let m=new w(c,1,c,u);n.push(new hp(null,m,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,n,i,r)}_applyUndo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new w(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,n,!0,!1,i,r)}_applyRedo(t,n,i,r){let s=t.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new w(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,n,!1,!0,i,r)}_applyUndoRedoEdits(t,n,i,r,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=r,this.applyEdits(t,!1),this.setEOL(n),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,n=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let i=this._validateEditOperations(t);return this._doApplyEdits(i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,n){let i=this._buffer.getLineCount(),r=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,n),s=this._buffer.getLineCount(),a=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let p=a[c];this._decorationsTree.acceptReplace(p.rangeOffset,p.rangeLength,p.text.length,p.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=i;for(let c=0,u=a.length;c<u;c++){let p=a[c],[m]=oo(p.text);this._onDidChangeDecorations.fire();let f=p.range.startLineNumber,g=p.range.endLineNumber,b=g-f,v=m,I=Math.min(b,v),C=v-b,S=s-d-C+f,_=S,R=S+v,N=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new M(_,1)),this.getOffsetAt(new M(R,this.getLineMaxColumn(R))),0),F=so.fromDecorations(N),P=new ji(F);for(let H=I;H>=0;H--){let U=f+H,z=S+H;P.takeFromEndWhile(fe=>fe.lineNumber>z);let oe=P.takeFromEndWhile(fe=>fe.lineNumber===z);l.push(new Hg(U,this.getLineContent(z),oe))}if(I<b){let H=f+I;l.push(new aI(H+1,g))}if(I<v){let H=new ji(F),U=f+I,z=v-I,oe=s-d-z+U+1,fe=[],ee=[];for(let X=0;X<z;X++){let se=oe+X;ee[X]=this.getLineContent(se),H.takeWhile(te=>te.lineNumber<se),fe[X]=H.takeWhile(te=>te.lineNumber===se)}l.push(new lI(U+1,f+v,ee,fe))}d+=C}this._emitContentChangedEvent(new bc(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;let i=Array.from(t).map(r=>new Hg(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeInjectedText.fire(new up(i))}changeDecorations(t,n=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(n,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,n){let i={addDecoration:(s,a)=>this._deltaDecorationsImpl(t,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,c2(a))},removeDecoration:s=>{this._deltaDecorationsImpl(t,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(t,s,a)},r=null;try{r=n(i)}catch(s){We(s)}return i.addDecoration=Ef,i.changeDecoration=Ef,i.changeDecorationOptions=Ef,i.removeDecoration=Ef,i.deltaDecorations=Ef,r}deltaDecorations(t,n,i=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&n.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),We(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,t,n)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,n,i){let r=t?this._decorations[t]:null;if(!r)return n?this._deltaDecorationsImpl(0,[],[{range:n,options:d2[i]}],!0)[0]:null;if(!n)return this._decorationsTree.delete(r),delete this._decorations[r.id],null;let s=this._validateRangeRelaxedNoAllocations(n),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(r),r.reset(this.getVersionId(),a,l,s),r.setOptions(d2[i]),this._decorationsTree.insert(r),r.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;let n=this._decorationsTree.collectNodesFromOwner(t);for(let i=0,r=n.length;i<r;i++){let s=n[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(t){let n=this._decorations[t];return n?n.options:null}getDecorationRange(t){let n=this._decorations[t];return n?this._decorationsTree.getNodeRange(this,n):null}getLineDecorations(t,n=0,i=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,n,i)}getLinesDecorations(t,n,i=0,r=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,t)),d=Math.min(a,Math.max(1,n)),c=this.getLineMaxColumn(d),u=new w(l,1,d,c),p=this._getDecorationsInRange(u,i,r,s);return mE(p,this._decorationProvider.getDecorationsInRange(u,i,r)),p}getDecorationsInRange(t,n=0,i=!1,r=!1,s=!1){let a=this.validateRange(t),l=this._getDecorationsInRange(a,n,i,s);return mE(l,this._decorationProvider.getDecorationsInRange(a,n,i,r)),l}getOverviewRulerDecorations(t=0,n=!1){return this._decorationsTree.getAll(this,t,n,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){let n=this._buffer.getOffsetAt(t,1),i=n+this._buffer.getLineLength(t),r=this._decorationsTree.getInjectedTextInInterval(this,n,i,0);return so.fromDecorations(r).filter(s=>s.lineNumber===t)}getAllDecorations(t=0,n=!1){let i=this._decorationsTree.getAll(this,t,n,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(t,n)),i}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,n,i,r){let s=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),a=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,n,i,r)}getRangeAt(t,n){return this._buffer.getRangeAt(t,n-t)}_changeDecorationImpl(t,n){let i=this._decorations[t];if(!i)return;if(i.options.after){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before){let l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let r=this._validateRangeRelaxedNoAllocations(n),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,a,r),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}_changeDecorationOptionsImpl(t,n){let i=this._decorations[t];if(!i)return;let r=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(n.overviewRuler&&n.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(n),i.options.after||n.after){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(i.options.before||n.before){let d=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=r!==s,l=zU(n)!==qC(i);a||l?(this._decorationsTree.delete(i),i.setOptions(n),this._decorationsTree.insert(i)):i.setOptions(n)}_deltaDecorationsImpl(t,n,i,r=!1){let s=this.getVersionId(),a=n.length,l=0,d=i.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let p=null;if(l<a){do p=this._decorations[n[l++]];while(!p&&l<a);if(p){if(p.options.after){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.endLineNumber)}if(p.options.before){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.startLineNumber)}this._decorationsTree.delete(p),r||this._onDidChangeDecorations.checkAffectedAndFire(p.options)}}if(c<d){if(!p){let I=++this._lastDecorationId,C=`${this._instanceId};${I}`;p=new vf(C,0,0),this._decorations[C]=p}let m=i[c],f=this._validateRangeRelaxedNoAllocations(m.range),g=c2(m.options),b=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),v=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);p.ownerId=t,p.reset(s,b,v,f),p.setOptions(g),p.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),p.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),r||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(p),u[c]=p.id,c++}else p&&delete this._decorations[p.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,n){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,n)):(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId,n)),this._setLanguage(t.languageId,n))}_setLanguage(t,n){this.tokenization.setLanguageId(t,n),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,n){return this.tokenization.getLanguageIdAtPosition(t,n)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,n){return t}getLineIndentColumn(t){return UU(this.getLineContent(t))+1}};da=K([D(4,eO),D(5,Hi),D(6,Dn),D(7,dt)],da);function UU(o){let e=0;for(let t of o)if(t===" "||t==="	")e++;else break;return e}function i0(o){return!!(o.options.overviewRuler&&o.options.overviewRuler.color)}function zU(o){return!!o.after||!!o.before}function qC(o){return!!o.options.after||!!o.options.before}var YC=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new jp,this._decorationsTree1=new jp,this._injectedTextDecorationsTree=new jp}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(let n of t)n.range===null&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,r,s){let a=e.getVersionId(),l=this._intervalSearch(t,n,i,r,a,s);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,n,i,r,s){let a=this._decorationsTree0.intervalSearch(e,t,n,i,r,s),l=this._decorationsTree1.intervalSearch(e,t,n,i,r,s),d=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,r,s);return a.concat(l).concat(d)}getInjectedTextInInterval(e,t,n,i){let r=e.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,r,!1);return this._ensureNodesHaveRanges(e,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){let n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n,!1);return this._ensureNodesHaveRanges(e,i).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,n,i,r){let s=e.getVersionId(),a=this._search(t,n,i,s,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,n,i,r){if(n)return this._decorationsTree1.search(e,t,i,r);{let s=this._decorationsTree0.search(e,t,i,r),a=this._decorationsTree1.search(e,t,i,r),l=this._injectedTextDecorationsTree.search(e,t,i,r);return s.concat(a).concat(l)}}collectNodesFromOwner(e){let t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){let e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){qC(e)?this._injectedTextDecorationsTree.insert(e):i0(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){qC(e)?this._injectedTextDecorationsTree.delete(e):i0(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){let n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){qC(e)?this._injectedTextDecorationsTree.resolveNode(e,t):i0(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}};function la(o){return o.replace(/[^a-z0-9\-_]/gi," ")}var XC=class{color;darkColor;constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}},r0=class extends XC{position;_resolvedColor;constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:2}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}},s0=class{position;persistLane;constructor(e){this.position=e?.position??2,this.persistLane=e?.persistLane}},a0=class extends XC{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?G.fromHex(e):t.getColor(e.id)}},ZC=class o{static from(e){return e instanceof o?e:new o(e)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}},En=class o{static EMPTY;static register(e){return new o(e)}static createDynamic(e){return new o(e)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?la(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?la(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new r0(e.overviewRuler):null,this.minimap=e.minimap?new a0(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new s0(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?la(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?la(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?la(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?wM(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?la(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?la(e.marginClassName):null,this.inlineClassName=e.inlineClassName?la(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?la(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?la(e.afterContentClassName):null,this.after=e.after?ZC.from(e.after):null,this.before=e.before?ZC.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}};En.EMPTY=En.register({description:"empty"});var d2=[En.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),En.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),En.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),En.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function c2(o){return o instanceof En?o:En.createDynamic(o)}var l0=class extends V{constructor(t){super();this.handleBeforeFire=t;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new L);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){this._affectsMinimap||=!!t.minimap?.position,this._affectsOverviewRuler||=!!t.overviewRuler?.color,this._affectsGlyphMargin||=!!t.glyphMarginClassName,this._affectsLineNumber||=!!t.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}},d0=class extends V{_fastEmitter=this._register(new L);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new L);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;let t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}};var Bc=j("workingCopyService"),u0=class extends V{_onDidRegister=this._register(new L);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new L);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new pi;mapWorkingCopyToListeners=this._register(new Go);registerWorkingCopy(e){let t=this.mapResourceToWorkingCopies.get(e.resource);if(t?.has(e.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${e.resource.toString()} and type ${e.typeId}.`);this._workingCopies.add(e),t||(t=new Map,this.mapResourceToWorkingCopies.set(e.resource,t)),t.set(e.typeId,e);let n=new ae;return n.add(e.onDidChangeContent(()=>this._onDidChangeContent.fire(e))),n.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),n.add(e.onDidSave(i=>this._onDidSave.fire({workingCopy:e,...i}))),this.mapWorkingCopyToListeners.set(e,n),this._onDidRegister.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e),Ce(()=>{this.unregisterWorkingCopy(e),this._onDidUnregister.fire(e)})}unregisterWorkingCopy(e){this._workingCopies.delete(e);let t=this.mapResourceToWorkingCopies.get(e.resource);t?.delete(e.typeId)&&t.size===0&&this.mapResourceToWorkingCopies.delete(e.resource),e.isDirty()&&this._onDidChangeDirty.fire(e),this.mapWorkingCopyToListeners.deleteAndDispose(e)}has(e){return le.isUri(e)?this.mapResourceToWorkingCopies.has(e):this.mapResourceToWorkingCopies.get(e.resource)?.has(e.typeId)??!1}get(e){return this.mapResourceToWorkingCopies.get(e.resource)?.get(e.typeId)}getAll(e){let t=this.mapResourceToWorkingCopies.get(e);if(t)return Array.from(t.values())}get hasDirty(){for(let e of this._workingCopies)if(e.isDirty())return!0;return!1}get dirtyCount(){let e=0;for(let t of this._workingCopies)t.isDirty()&&e++;return e}get dirtyWorkingCopies(){return this.workingCopies.filter(e=>e.isDirty())}get modifiedCount(){let e=0;for(let t of this._workingCopies)t.isModified()&&e++;return e}get modifiedWorkingCopies(){return this.workingCopies.filter(e=>e.isModified())}isDirty(e,t){let n=this.mapResourceToWorkingCopies.get(e);if(n){if(typeof t=="string")return n.get(t)?.isDirty()??!1;for(let[,i]of n)if(i.isDirty())return!0}return!1}};Cn(Bc,u0,1);function p0(o,e=ct){return aw(o,e)?o.charAt(0).toUpperCase()+o.slice(1):o}var p2="\u2026",Tf="\\\\",Lf="~";function h2(o,e=yo){let t=new Array(o.length),n=!1;for(let i=0;i<o.length;i++){let r=o[i];if(r===""){t[i]=`.${e}`;continue}if(!r){t[i]=r;continue}n=!0;let s="",a=r;a.indexOf(Tf)===0?(s=a.substr(0,a.indexOf(Tf)+Tf.length),a=a.substr(a.indexOf(Tf)+Tf.length)):a.indexOf(e)===0?(s=a.substr(0,a.indexOf(e)+e.length),a=a.substr(a.indexOf(e)+e.length)):a.indexOf(Lf)===0&&(s=a.substr(0,a.indexOf(Lf)+Lf.length),a=a.substr(a.indexOf(Lf)+Lf.length));let l=a.split(e);for(let d=1;n&&d<=l.length;d++)for(let c=l.length-d;n&&c>=0;c--){n=!1;let u=l.slice(c,c+d).join(e);for(let p=0;!n&&p<o.length;p++)if(p!==i&&o[p]&&o[p].indexOf(u)>-1){let m=c+d===l.length,f=c>0&&o[p].indexOf(e)>-1?e+u:u,g=o[p].endsWith(f);n=!m||g}if(!n){let p="";(l[0].endsWith(":")||s!=="")&&(c===1&&(c=0,d++,u=l[0]+e+u),c>0&&(p=l[0]+e),p=s+p),c>0&&(p=p+p2+e),p=p+u,c+d<l.length&&(p=p+e+p2),t[i]=p}}n&&(t[i]=r)}return t}var APe=j("productService"),m2="vscode://schemas/vscode-product";var iNe=j("dialogService");var oNe=j("fileDialogService");var lo=class extends Df{_onDidChangeDirty=this._register(new L);_onDidChangeLabel=this._register(new L);_onDidChangeCapabilities=this._register(new L);_onWillDispose=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(co(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:Xi(this.resource,th.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var Un=class extends lo{constructor(t,n,i,r,s){super();this.preferredName=t;this.preferredDescription=n;this.secondary=i;this.primary=r;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return Un.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(de.once(de.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let t=this.getPreferredName();return t||(this.hasIdenticalSides?this.primary.getName():h("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(t){let n=this.getPreferredDescription();return n||(this.hasIdenticalSides?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.preferredDescription}getTitle(t){let n;this.hasIdenticalSides?n=this.primary.getTitle(t)??this.getName():n=super.getTitle(t);let i=this.getPreferredTitle();return i&&(n=`${i} (${n})`),n}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,n){let i=await this.primary.save(t,n);return this.saveResultToEditor(i)}async saveAs(t,n){let i=await this.primary.saveAs(t,n);return this.saveResultToEditor(i)}saveResultToEditor(t){if(!t||!this.hasIdenticalSides)return t;if(this.primary.matches(t))return this;if(t instanceof lo)return new Un(this.preferredName,this.preferredDescription,t,t,this.editorService);if(!sr(t)&&!ih(t)&&!ca(t)&&!ua(t))return{primary:t,secondary:t,label:this.preferredName,description:this.preferredDescription}}revert(t,n){return this.primary.revert(t,n)}async rename(t,n){if(!this.hasIdenticalSides)return;let i=await this.primary.rename(t,n);if(i){if(co(i.editor))return{editor:new Un(this.preferredName,this.preferredDescription,i.editor,i.editor,this.editorService),options:{...i.options,viewState:nh(this,t,this.editorService)}};if(QC(i.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:i.editor,secondary:i.editor,options:{...i.options,viewState:nh(this,t,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){let n=this.primary.toUntyped(t),i=this.secondary.toUntyped(t);if(n&&i&&!sr(n)&&!sr(i)&&!ih(n)&&!ih(i)&&!ca(n)&&!ca(i)&&!ua(n)&&!ua(i)){let r={label:this.preferredName,description:this.preferredDescription,primary:n,secondary:i};return typeof t?.preserveViewState=="number"&&(r.options={viewState:nh(this,t.preserveViewState,this.editorService)}),r}}matches(t){return this===t?!0:g0(t)||sr(t)?!1:t instanceof Un?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):ca(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};Un=K([D(4,Ei)],Un);var f0={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function GU(o){let e=o;return!!(e&&typeof e=="object"&&Array.isArray(e.editors)&&Array.isArray(e.mru))}var pa=class extends V{constructor(t,n,i){super();this.instantiationService=n;this.configurationService=i;GU(t)?this._id=this.deserialize(t):this._id=pa.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new L({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationUpdated(t)))}onConfigurationUpdated(t){t&&!t.affectsConfiguration("workbench.editor.openPositioning")&&!t.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(t,n){let i=t===0?this.mru.slice(0):this.editors.slice(0);return n?.excludeSticky?t===0?i.filter(r=>!this.isSticky(r)):i.slice(this.sticky+1):i}getEditorByIndex(t){return this.editors[t]}get activeEditor(){return this.active}isActive(t){return this.matches(this.active,t)}get previewEditor(){return this.preview}openEditor(t,n){let i=n?.sticky||typeof n?.index=="number"&&this.isSticky(n.index),r=n?.pinned||n?.sticky,s=!!n?.transient,a=n?.active||!this.activeEditor||!r&&this.preview===this.activeEditor,l=this.findEditor(t,n);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),r&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),n&&typeof n.index=="number"&&this.moveEditor(d,n.index),i&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=t,c=this.indexOf(this.active),u;if(n&&typeof n.index=="number"?u=n.index:this.editorOpenPositioning===f0.FIRST?(u=0,!i&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===f0.LAST?u=this.editors.length:(this.editorOpenPositioning===f0.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!i&&this.isSticky(u)&&(u=this.sticky+1)),i&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(r||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!r){if(this.preview){let m=this.indexOf(this.preview);u>m&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let p={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(p),this.setSelection(a?d:this.activeEditor,n?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(t){let n=new ae;this.editorListeners.add(n),n.add(de.once(t.onWillDispose)(()=>{let i=this.editors.indexOf(t);if(i>=0){let r={kind:15,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}})),n.add(t.onDidChangeDirty(()=>{let i={kind:14,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeLabel(()=>{let i={kind:9,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(t.onDidChangeCapabilities(()=>{let i={kind:10,editor:t,editorIndex:this.editors.indexOf(t)};this._onDidModelChange.fire(i)})),n.add(this.onDidModelChange(i=>{i.kind===6&&i.editor?.matches(t)&&(yt(n),this.editorListeners.delete(n))}))}replaceEditor(t,n,i,r=!0){let s=this.doCloseEditor(t,1,r);if(this.splice(i,!1,n),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(t,n=0,i=!0){let r=this.doCloseEditor(t,n,i);if(r){let s={kind:6,...r};return this._onDidModelChange.fire(s),r}}doCloseEditor(t,n,i){let r=this.indexOf(t);if(r===-1)return;let s=this.editors[r],a=this.isSticky(r),l=this.active===s;if(i&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:r===this.editors.length-1?d=this.editors[r-1]:d=this.editors[r+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(r,!0),{editor:s,sticky:a,editorIndex:r,context:n}}moveEditor(t,n){n>=this.editors.length?n=this.editors.length-1:n<0&&(n=0);let i=this.indexOf(t);if(i<0||n===i)return;let r=this.editors[i],s=this.sticky;this.isSticky(i)&&n>this.sticky?this.sticky--:!this.isSticky(i)&&n<=this.sticky&&this.sticky++,this.editors.splice(i,1),this.editors.splice(n,0,r);let a={kind:7,editor:r,oldEditorIndex:i,editorIndex:n};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:r,editorIndex:n};this._onDidModelChange.fire(l)}return r}setActive(t){let n;return t?n=this.setEditorActive(t):this.setGroupActive(),n}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doSetSelection(i,r,[]),i}get selectedEditors(){return this.editors.filter(t=>this.doIsSelected(t))}isSelected(t){let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.doIsSelected(n)}doIsSelected(t){return this.selection.includes(t)}setSelection(t,n){let i=this.findEditor(t);if(!i)return;let[r,s]=i,a=new Set;for(let l of n){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==r&&a.add(c)}this.doSetSelection(r,s,Array.from(a))}doSetSelection(t,n,i){let r=this.activeEditor,s=this.selection,a;t?a=[t,...i]:a=[],this.selection=a;let l=t&&typeof n=="number"&&r!==t;if(l){let d=this.indexOf(t,this.mru);this.mru.splice(d,1),this.mru.unshift(t);let c={kind:8,editor:t,editorIndex:n};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(t){this._onDidModelChange.fire({kind:1})}setLabel(t){this._onDidModelChange.fire({kind:2})}pin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doPin(i,r),i}doPin(t,n){if(this.isPinned(t))return;this.setTransient(t,!1),this.preview=null;let i={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(i)}unpin(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnpin(i,r),i}doUnpin(t,n){if(!this.isPinned(t))return;let i=this.preview;this.preview=t;let r={kind:11,editor:t,editorIndex:n};this._onDidModelChange.fire(r),i&&this.closeEditor(i,3)}isPinned(t){let n;return typeof t=="number"?n=this.editors[t]:n=t,!this.matches(this.preview,n)}stick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doStick(i,r),i}doStick(t,n){if(this.isSticky(n))return;this.pin(t);let i=this.sticky+1;this.moveEditor(t,i),this.sticky++;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}unstick(t){let n=this.findEditor(t);if(!n)return;let[i,r]=n;return this.doUnstick(i,r),i}doUnstick(t,n){if(!this.isSticky(n))return;let i=this.sticky;this.moveEditor(t,i),this.sticky--;let r={kind:13,editor:t,editorIndex:i};this._onDidModelChange.fire(r)}isSticky(t){if(this.sticky<0)return!1;let n;return typeof t=="number"?n=t:n=this.indexOf(t),n<0?!1:n<=this.sticky}setTransient(t,n){if(!n&&this.transient.size===0)return;let i=this.findEditor(t);if(!i)return;let[r,s]=i;return this.doSetTransient(r,s,n),r}doSetTransient(t,n,i){if(i){if(this.transient.has(t))return;this.transient.add(t)}else{if(!this.transient.has(t))return;this.transient.delete(t)}let r={kind:12,editor:t,editorIndex:n};this._onDidModelChange.fire(r)}isTransient(t){if(this.transient.size===0)return!1;let n;return typeof t=="number"?n=this.editors[t]:n=this.findEditor(t)?.[0],!!n&&this.transient.has(n)}splice(t,n,i){let r=this.editors[t];if(n&&this.isSticky(t)&&this.sticky--,i?this.editors.splice(t,n?1:0,i):this.editors.splice(t,n?1:0),!n&&i)this.mru.length===0?this.mru.push(i):this.mru.splice(1,0,i);else{let s=this.indexOf(r,this.mru);n&&!i?this.mru.splice(s,1):n&&i&&this.mru.splice(s,1,i)}}indexOf(t,n=this.editors,i){let r=-1;if(!t)return r;for(let s=0;s<n.length;s++){let a=n[s];if(this.matches(a,t,i))if(i?.supportSideBySide&&a instanceof Un&&!(t instanceof Un))r=s;else{r=s;break}}return r}findEditor(t,n){let i=this.indexOf(t,this.editors,n);if(i!==-1)return[this.editors[i],i]}isFirst(t,n=this.editors){return this.matches(n[0],t)}isLast(t,n=this.editors){return this.matches(n[n.length-1],t)}contains(t,n){return this.indexOf(t,this.editors,n)!==-1}matches(t,n,i){if(!t||!n)return!1;if(i?.supportSideBySide&&t instanceof Un&&!(n instanceof Un))switch(i.supportSideBySide){case 4:if(this.matches(t.primary,n,i)||this.matches(t.secondary,n,i))return!0;break;case 3:if(this.matches(t.primary,n,i)&&this.matches(t.secondary,n,i))return!0;break}let r=t===n;return i?.strictEquals?r:r||t.matches(n)}get isLocked(){return this.locked}lock(t){this.isLocked!==t&&(this.locked=t,this._onDidModelChange.fire({kind:3}))}clone(){let t=this.instantiationService.createInstance(pa,void 0);t.editors=this.editors.slice(0),t.mru=this.mru.slice(0),t.preview=this.preview,t.selection=this.selection.slice(0),t.sticky=this.sticky;for(let n of t.editors)t.registerEditorListeners(n);return t}serialize(){let t=et.as(Wc.EditorFactory),n=[],i=[],r,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=t.getEditorSerializer(d);if(u){let p=u.canSerialize(d)?u.serialize(d):void 0;typeof p=="string"?(c=!0,i.push({id:d.typeId,value:p}),n.push(d),this.preview===d&&(r=n.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,n)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:i,mru:a,preview:r,sticky:s>=0?s:void 0}}deserialize(t){let n=et.as(Wc.EditorFactory);return typeof t.id=="number"?(this._id=t.id,pa.IDS=Math.max(t.id+1,pa.IDS)):this._id=pa.IDS++,t.locked&&(this.locked=!0),this.editors=xs(t.editors.map((i,r)=>{let s,a=n.getEditorSerializer(i.id);if(a){let l=a.deserialize(this.instantiationService,i.value);l instanceof lo&&(s=l,this.registerEditorListeners(s))}return!s&&typeof t.sticky=="number"&&r<=t.sticky&&t.sticky--,s})),this.mru=xs(t.mru.map(i=>this.editors[i])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof t.preview=="number"&&(this.preview=this.editors[t.preview]),typeof t.sticky=="number"&&(this.sticky=t.sticky),this._id}dispose(){yt(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};pa=K([D(1,dt),D(2,Xt)],pa);var kf={exports:{}};(function(){function e(r){let s=[];typeof r=="number"&&s.push("code/timeOrigin",r);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function t(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?e():{mark(r){performance.mark(r)},getMarks(){let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(r+a.startTime)});return s}};if(typeof process=="object"){let r=performance?.timeOrigin;return e(r)}else return console.trace("perf-util loaded in UNKNOWN environment"),e()}function n(r){return r.MonacoPerformanceMarks||(r.MonacoPerformanceMarks=t()),r.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof kf=="object"&&typeof kf.exports=="object"?kf.exports=n(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=n(i))})();var us=kf.exports.mark,bOe=kf.exports.getMarks;var dd=j("IUriIdentityService");function g2(o){let e=o;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&le.isUri(e.location)&&le.isUri(e.globalStorageHome)&&le.isUri(e.settingsResource)&&le.isUri(e.keybindingsResource)&&le.isUri(e.tasksResource)&&le.isUri(e.snippetsHome)&&le.isUri(e.extensionsResource))}var tS=j("IUserDataProfilesService");function JC(o,e,t,n,i,r){return{id:o,name:e,location:t,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:r&&i?.useDefaultFlags?.globalState?r.globalStorageHome:Jo(t,"globalStorage"),settingsResource:r&&i?.useDefaultFlags?.settings?r.settingsResource:Jo(t,"settings.json"),keybindingsResource:r&&i?.useDefaultFlags?.keybindings?r.keybindingsResource:Jo(t,"keybindings.json"),tasksResource:r&&i?.useDefaultFlags?.tasks?r.tasksResource:Jo(t,"tasks.json"),snippetsHome:r&&i?.useDefaultFlags?.snippets?r.snippetsHome:Jo(t,"snippets"),extensionsResource:r&&i?.useDefaultFlags?.extensions?r.extensionsResource:Jo(t,"extensions.json"),cacheHome:Jo(n,o),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var eS=class extends V{constructor(t,n,i,r){super();this.environmentService=t;this.fileService=n;this.uriIdentityService=i;this.logService=r;this.profilesHome=Jo(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=Jo(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new L);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new L);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new L);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new L);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new pi,workspaces:new pi,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(t){this.enabled!==t&&(this._profilesObject=void 0,this.enabled=t)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let t=this.createDefaultProfile(),n=[t];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!Lt(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}n.push(JC(Qo(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.logService.error(s)}let i=new pi,r=new Map;if(n.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=le.parse(a),c=n.find(u=>u.id===l);c&&i.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=n.find(c=>c.id===l);d&&r.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:n,workspaces:i,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){let t=JC("__default__profile__",h("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...t,extensionsResource:this.getDefaultProfileExtensionsLocation()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){let n="Temp",i=new RegExp(`${Ni(n)}\\s(\\d+)`),r=0;for(let a of this.profiles){let l=i.exec(a.name),d=l?parseInt(l[1]):0;r=d>r?d:r}let s=`${n} ${r+1}`;return this.createProfile(gr(Ks()).toString(16),s,{transient:!0},t)}async createNamedProfile(t,n,i){return this.createProfile(gr(Ks()).toString(16),t,n,i)}async createProfile(t,n,i,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(t,n,i);return r&&await this.setProfileForWorkspace(r,s),s}async doCreateProfile(t,n,i){if(!Lt(n)||!n)throw new Error("Name of the profile is mandatory and must be of type `string`");let r=this.profileCreationPromises.get(n);return r||(r=(async()=>{try{if(this.profiles.find(d=>d.name===n||d.id===t))throw new Error(`Profile with ${n} name already exists`);let a=JC(t,n,Jo(this.profilesHome,t),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await hr.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(n)}})(),this.profileCreationPromises.set(n,r)),r}async updateProfile(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);return i=JC(i.id,n.name??i.name,i.location,this.profilesCacheHome,{shortName:n.shortName??i.shortName,icon:n.icon===null?void 0:n.icon??i.icon,transient:n.transient??i.isTransient,useDefaultFlags:n.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(t.isDefault)throw new Error("Cannot remove default profile");let n=this.profiles.find(r=>r.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:n,join(r){i.push(r)}});try{await Promise.allSettled(i)}catch(r){this.logService.error(r)}for(let r of[...this.profilesObject.emptyWindows.keys()])n.id===this.profilesObject.emptyWindows.get(r)?.id&&this.profilesObject.emptyWindows.delete(r);for(let r of[...this.profilesObject.workspaces.keys()])n.id===this.profilesObject.workspaces.get(r)?.id&&this.profilesObject.workspaces.delete(r);this.updateStoredProfileAssociations(),this.updateProfiles([],[n],[]);try{await this.fileService.del(n.cacheHome,{recursive:!0})}catch(r){iF(r)!==1&&this.logService.error(r)}}async setProfileForWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(r=>r.id===n.id);if(!i)throw new Error(`Profile '${n.name}' does not exist`);this.updateWorkspaceAssociation(t,i)}unsetWorkspace(t,n){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(t,void 0,n)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let t=await this.fileService.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(n=>n.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,n.resource))).map(n=>this.fileService.del(n.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let t=this.transientProfilesObject.profiles.filter(n=>!this.isProfileAssociatedToWorkspace(n));await Promise.allSettled(t.map(n=>this.removeProfile(n)))}getProfileForWorkspace(t){let n=this.getWorkspace(t),i=le.isUri(n)?this.profilesObject.workspaces.get(n):this.profilesObject.emptyWindows.get(n);return i||(Gl(t)?this.transientProfilesObject.folders.get(t.uri):bg(t)?this.transientProfilesObject.workspaces.get(t.configPath):this.transientProfilesObject.emptyWindows.get(t.id))}getWorkspace(t){return Gl(t)?t.uri:bg(t)?t.configPath:t.id}isProfileAssociatedToWorkspace(t){return!!([...this.profilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.profilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.emptyWindows.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.workspaces.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location))||[...this.transientProfilesObject.folders.values()].some(n=>this.uriIdentityService.extUri.isEqual(n.location,t.location)))}updateProfiles(t,n,i){let r=[...this.profiles,...t],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of r){if(l.isDefault||n.some(c=>l.id===c.id))continue;l=i.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(t,n,i)}triggerProfilesChanges(t,n,i){this._onDidChangeProfiles.fire({added:t,removed:n,updated:i,all:this.profiles})}updateWorkspaceAssociation(t,n,i){if(i=n?.isTransient?!0:i,i)Gl(t)?(this.transientProfilesObject.folders.delete(t.uri),n&&this.transientProfilesObject.folders.set(t.uri,n)):bg(t)?(this.transientProfilesObject.workspaces.delete(t.configPath),n&&this.transientProfilesObject.workspaces.set(t.configPath,n)):(this.transientProfilesObject.emptyWindows.delete(t.id),n&&this.transientProfilesObject.emptyWindows.set(t.id,n));else{this.updateWorkspaceAssociation(t,void 0,!0);let r=this.getWorkspace(t);le.isUri(r)?(this.profilesObject.workspaces.delete(r),n&&this.profilesObject.workspaces.set(r,n)):(this.profilesObject.emptyWindows.delete(r),n&&this.profilesObject.emptyWindows.set(r,n)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let t={};for(let[i,r]of this.profilesObject.workspaces.entries())t[i.toString()]=r.id;let n={};for(let[i,r]of this.profilesObject.emptyWindows.entries())n[i.toString()]=r.id;this.saveStoredProfileAssociations({workspaces:t,emptyWindows:n}),this._profilesObject=void 0}migrateStoredProfileAssociations(t){let n={},i=this.createDefaultProfile();if(t.workspaces)for(let[s,a]of Object.entries(t.workspaces)){let l=le.parse(a);n[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let r={};if(t.emptyWindows)for(let[s,a]of Object.entries(t.emptyWindows)){let l=le.parse(a);r[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:n,emptyWindows:r}}getStoredProfiles(){return[]}saveStoredProfiles(t){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(t){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};eS=K([D(0,tr),D(1,ii),D(2,dd),D(3,xn)],eS);var f2=j("editorGroupsService");var Ei=j("editorService");var v0=-2;var y0=class{constructor(e,t,n){this.id=e;this.dependencies=t;this.callback=n}};var b2=class o{static INSTANCE=new o;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(e,t,n)=>{typeof e!="string"&&(n=t,t=e,e=null),(typeof t!="object"||!Array.isArray(t))&&(n=t,t=null),this._defineCalls.push(new y0(e,t,n))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){if(e.startsWith(window.location.origin)||e.startsWith(`${Ie.vscodeFileResource}://${QE}`))return e;throw new Error(`[trusted_script_src] Invalid script url: ${e}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(e){return e}}))}async load(e){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Ks();console.log(`[amdX] Using external define("${a}", ["${e}"])`),globalThis.define(a,[e],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}let n={},i=[],r=[];if(Array.isArray(t.dependencies))for(let s of t.dependencies)s==="exports"?i.push(n):r.push(s);if(r.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${r.join(", ")}`);return typeof t.callback=="function"?t.callback(...i)??n:t.callback}_rendererLoadScript(e){return new Promise((t,n)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let r=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{r(),t(this._defineCalls.pop())},a=l=>{r(),n(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),i.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{let t=(await import("fs")).default,n=(await import("vm")).default,i=(await import("module")).default,r=le.parse(e).fsPath,s=t.readFileSync(r).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new n.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};var C0="utf8";var M2e=512*8,P2e=512*128;var I0={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},N2e=(()=>{let o={};for(let e in I0)I0[e].guessableName&&(o[e]=I0[e]);return o})();var ps=class extends rr{constructor(t,n,i,r,s,a,l,d,c,u,p,m,f,g,b){super(l,a,g,b);this.resource=t;this.hasAssociatedFilePath=n;this.initialValue=i;this.preferredLanguageId=r;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=p;this.labelService=m;this.editorService=f;this._register(this.workingCopyService.registerWorkingCopy(this)),r&&this.setLanguageId(r),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new L);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new L);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new L);onDidRevert=this._onDidRevert.event;typeId=lF;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(t=>this.onConfigurationChange(t,!0)))}onConfigurationChange(t,n){if(!t||t.affectsConfiguration(this.resource,"files.encoding")){let i=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==i&&typeof i=="string"&&(this.configuredEncoding=i,n&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!t||t.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let i=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==i&&(i==="content"||i==="name")&&(this.configuredLabelFormat=i,n&&this._onDidChangeName.fire())}}setLanguageId(t,n){let i=t===ps.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:t;this.preferredLanguageId=i,i&&super.setLanguageId(i,n)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(t){let n=this.getEncoding();this.preferredEncoding=t,n!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(t){this.dirty!==t&&(this.dirty=t,this._onDidChangeDirty.fire())}async save(t){let n=await this.textFileService.save(this.resource,t);return n&&this._onDidSave.fire({reason:t?.reason,source:t?.source}),!!n}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(wf(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(t){let n;return this.isResolved()?n=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:C0}):typeof this.initialValue=="string"&&(n=IN(gn.fromString(this.initialValue))),{content:n}}ignoreDirtyOnModelContentChange=!1;async resolve(){let t=!1,n=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let r,s=await this.workingCopyBackupService.resolve(this);s?(r=s.value,n=!0):r=CN(gn.fromString(this.initialValue||""));let a=await u2(await this.textFileService.getDecodedStream(this.resource,r,{encoding:C0}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),t=!0}let i=Rs(this.textEditorModel);return this.installModelListeners(i),t&&((n||this.initialValue)&&this.updateNameFromFirstLine(i),this.setDirty(this.hasAssociatedFilePath||!!n||!!this.initialValue),(n||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n))),this._register(t.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(t)}onModelContentChanged(t,n){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&t.getLineCount()===1&&t.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),n.changes.some(i=>(i.range.startLineNumber===1||i.range.endLineNumber===1)&&i.range.startColumn<=ps.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(t),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(t){if(this.hasAssociatedFilePath)return;let n,i=t.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:ps.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");i=i.substr(0,fv(i,ps.FIRST_LINE_NAME_MAX_LENGTH)[0]),i&&rg().exec(i)&&(n=i),n!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=n,this._onDidChangeName.fire())}isReadonly(){return!1}};ps=K([D(5,Hi),D(6,rs),D(7,mC),D(8,cs),D(9,Bc),D(10,nl),D(11,Ao),D(12,Ei),D(13,Up),D(14,Vi)],ps);var S0=j("untitledTextEditorService"),Vc=class extends V{constructor(t,n){super();this.instantiationService=t;this.configurationService=n}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new L);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new L);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new L);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new pi;get(t){return this.mapResourceToModel.get(t)}getValue(t){return this.get(t)?.textEditorModel?.getValue()}async resolve(t){let n=this.doCreateOrGet(t);return await n.resolve(),n}create(t){return this.doCreateOrGet(t)}doCreateOrGet(t=Object.create(null)){let n=this.massageOptions(t);return n.untitledResource&&this.mapResourceToModel.has(n.untitledResource)?this.mapResourceToModel.get(n.untitledResource):this.doCreate(n)}massageOptions(t){let n=Object.create(null);if(t.associatedResource?(n.untitledResource=le.from({scheme:Ie.untitled,authority:t.associatedResource.authority,fragment:t.associatedResource.fragment,path:t.associatedResource.path,query:t.associatedResource.query}),n.associatedResource=t.associatedResource):t.untitledResource?.scheme===Ie.untitled&&(n.untitledResource=t.untitledResource),t.languageId)n.languageId=t.languageId;else if(!n.associatedResource){let i=this.configurationService.getValue();i.files?.defaultLanguage&&(n.languageId=i.files.defaultLanguage)}return n.encoding=t.encoding,n.initialValue=t.initialValue,n}doCreate(t){let n=t.untitledResource;if(!n){let r=1;do n=le.from({scheme:Ie.untitled,path:`Untitled-${r}`}),r++;while(this.mapResourceToModel.has(n))}let i=this._register(this.instantiationService.createInstance(ps,n,!!t.associatedResource,t.initialValue,t.languageId,t.encoding));return this.registerModel(i),i}registerModel(t){let n=new ae;n.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),n.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire(t))),n.add(t.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(t))),n.add(t.onWillDispose(()=>this._onWillDispose.fire(t))),de.once(t.onWillDispose)(()=>{this.mapResourceToModel.delete(t.resource),n.dispose()}),this.mapResourceToModel.set(t.resource,t),this._onDidCreate.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t)}isUntitledWithAssociatedResource(t){return t.scheme===Ie.untitled&&t.path.length>1&&!Vc.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(t.path)}canDispose(t){return t.isDisposed()?!0:this.doCanDispose(t)}async doCanDispose(t){return t.isDirty()?(await de.toPromise(t.onDidChangeDirty),this.canDispose(t)):!0}};Vc=K([D(0,dt),D(1,Xt)],Vc);Cn(S0,Vc,1);var Rf=j("progressService");var qBe=Object.freeze({total(){},worked(){},done(){}}),y2=class{constructor(e){this.callback=e}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(e){this._value=e,this.callback(this._value)}};var nS=class extends V{deferred=new Ps;reporter;lastStep;constructor(e,t){super(),t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(Ce(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};nS=K([D(1,Rf)],nS);var YBe=j("editorProgressService");var oh=class extends V{constructor(t,n){super();this.logService=t;this.configurationService=n}participants=new An;addFileOperationParticipant(t){let n=this.participants.push(t);return Ce(()=>n())}async participate(t,n,i,r){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(t,n,i,s,r)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};oh=K([D(0,xn),D(1,Xt)],oh);var uo=class extends V{constructor(t,n,i,r){super();this.getExpression=t;this.shouldUpdate=n;this.contextService=i;this.configurationService=r;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new L);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{this.shouldUpdate(t)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(t){let n=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!cn(c.expression,d.expression))&&(n=!0,this.mapFolderToParsedExpression.set(l,_g(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(n=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let i=new fu(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==uo.NO_FOLDER&&(i.has(le.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),n=!0));let r=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(uo.NO_FOLDER);r?(!s||!cn(s.expression,r.expression))&&(n=!0,this.mapFolderToParsedExpression.set(uo.NO_FOLDER,_g(r.expression)),this.mapFolderToConfiguredExpression.set(uo.NO_FOLDER,r)):s&&(n=!0,this.mapFolderToParsedExpression.delete(uo.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(uo.NO_FOLDER)),t&&n&&this._onExpressionChange.fire()}doGetExpression(t){let n=this.getExpression(t);if(!n)return;let i=Object.keys(n);if(i.length===0)return;let r=!1,s=Object.create(null);for(let a of i){r||(r=Ld(a));let l=a,d=zM(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=n[a]}return{expression:s,hasAbsolutePath:r}}matches(t,n){if(this.mapFolderToParsedExpression.size===0)return!1;let i=this.contextService.getWorkspaceFolder(t),r,s;if(i&&this.mapFolderToParsedExpression.has(i.uri.toString())?(r=this.mapFolderToParsedExpression.get(i.uri.toString()),s=this.mapFolderToConfiguredExpression.get(i.uri.toString())):(r=this.mapFolderToParsedExpression.get(uo.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(uo.NO_FOLDER)),!r)return!1;let a;return i?a=Lv(i.uri,t):a=this.uriToPath(t),typeof a=="string"&&r(a,void 0,n)?!0:a!==this.uriToPath(t)&&s?.hasAbsolutePath?!!r(this.uriToPath(t),void 0,n):!1}uriToPath(t){return t.scheme===Ie.file?t.fsPath:t.path}};uo=K([D(2,to),D(3,Xt)],uo);var XU=new me("autoSaveAfterShortDelayContext",!1,!0);var ha=j("filesConfigurationService"),po=class extends V{constructor(t,n,i,r,s,a,l,d){super();this.contextKeyService=t;this.configurationService=n;this.contextService=i;this.environmentService=r;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=n.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||Hp.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=kr?ls.AFTER_DELAY:ls.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:h("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:h({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:h({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:h({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:h("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new L);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new L);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new L);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new L);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new Pi(1e3);autoSaveDisabledOverrides=new pi;autoSaveAfterShortDelayContext=XU.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new Gm(()=>this.createReadonlyMatcher(oF)));readonlyExcludeMatcher=this._register(new Gm(()=>this.createReadonlyMatcher(rF)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new pi(t=>this.uriIdentityService.extUri.getComparisonKey(t));createReadonlyMatcher(t){let n=this._register(new uo(i=>this.configurationService.getValue(t,{resource:i}),i=>i.affectsConfiguration(t),this.contextService,this.configurationService));return this._register(n.onExpressionChange(()=>this._onDidChangeReadonly.fire())),n}isReadonly(t,n){let i=this.fileService.getProvider(t.scheme);if(i&&nF(i))return i.readOnlyMessage??po.READONLY_MESSAGES.providerReadonly;let r=this.sessionReadonlyOverrides.get(t);return typeof r=="boolean"?r===!0?po.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(t,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(t,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(t)?this.readonlyExcludeMatcher.value.matches(t)?!1:po.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&n?.locked?po.READONLY_MESSAGES.fileLocked:n?.readonly?po.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(t,n){if(n==="toggle"){let i;try{i=await this.fileService.resolve(t,{resolveMetadata:!0})}catch{}n=!this.isReadonly(t,i)}n==="reset"?this.sessionReadonlyOverrides.delete(t):this.sessionReadonlyOverrides.set(t,n),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(t,n){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,t.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),n&&this._onDidChangeAutoSaveConfiguration.fire();let i=t?.files?.associations;cn(this.currentFilesAssociationConfiguration,i)||(this.currentFilesAssociationConfiguration=i,n&&this._onDidChangeFilesAssociation.fire());let r=t?.files?.hotExit;r===Hp.OFF||r===Hp.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=r:this.currentHotExitConfiguration=Hp.ON_EXIT;let s=!!t?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,n&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(t){let n=this.toResource(t);if(n){let i=this.autoSaveConfigurationCache.get(n);return i||(i=this.computeAutoSaveConfiguration(n,this.textResourceConfigurationService.getValue(n,"files")),this.autoSaveConfigurationCache.set(n,i)),i}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(t,n){let i,r,s,a,l,d;switch(n?.autoSave??po.DEFAULT_AUTO_SAVE_MODE){case ls.AFTER_DELAY:{i="afterDelay",r=typeof n?.autoSaveDelay=="number"&&n.autoSaveDelay>=0?n.autoSaveDelay:po.DEFAULT_AUTO_SAVE_DELAY,d=r<=po.DEFAULT_AUTO_SAVE_DELAY;break}case ls.ON_FOCUS_CHANGE:i="onFocusChange";break;case ls.ON_WINDOW_CHANGE:i="onWindowChange";break}return n?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,t&&!this.contextService.isInsideWorkspace(t)&&(l=!0,d=void 0)),n?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:i,autoSaveDelay:r,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(t){return t instanceof lo?th.getOriginalUri(t,{supportSideBySide:1}):t}hasShortAutoSaveDelay(t){let n=this.toResource(t);return this.getAutoSaveConfiguration(n).isShortAutoSaveDelay?!n||!this.autoSaveDisabledOverrides.has(n):!1}getAutoSaveMode(t,n){let i=this.toResource(t);if(i&&this.autoSaveDisabledOverrides.has(i))return{mode:0,reason:4};let r=this.getAutoSaveConfiguration(i);if(typeof r.autoSave>"u")return{mode:0,reason:1};if(typeof n=="number"&&(r.autoSave==="afterDelay"&&n!==2||r.autoSave==="onFocusChange"&&n!==3&&n!==4||r.autoSave==="onWindowChange"&&n!==4))return{mode:0,reason:1};if(i){if(r.autoSaveWorkspaceFilesOnly&&r.isOutOfWorkspace)return{mode:0,reason:2};if(r.autoSaveWhenNoErrors&&this.markerService.read({resource:i,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(r.autoSave){case"afterDelay":return typeof r.autoSaveDelay=="number"&&r.autoSaveDelay<=po.DEFAULT_AUTO_SAVE_DELAY?{mode:r.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let t=this.configurationService.getValue("files.autoSave"),n;return[ls.AFTER_DELAY,ls.ON_FOCUS_CHANGE,ls.ON_WINDOW_CHANGE].some(i=>i===t)?n=ls.OFF:n=ls.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",n)}disableAutoSave(t){let n=this.toResource(t);if(!n)return V.None;let i=this.autoSaveDisabledOverrides.get(n)??0;return this.autoSaveDisabledOverrides.set(n,i+1),i===0&&this._onDidChangeAutoSaveDisabled.fire(n),Ce(()=>{let r=this.autoSaveDisabledOverrides.get(n)??0;r<=1?(this.autoSaveDisabledOverrides.delete(n),this._onDidChangeAutoSaveDisabled.fire(n)):this.autoSaveDisabledOverrides.set(n,r-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==Hp.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(t,n){return this.configurationService.getValue("files.saveConflictResolution",{resource:t,overrideIdentifier:n})!=="overwriteFileOnDisk"}};po=K([D(0,Rt),D(1,Xt),D(2,to),D(3,tr),D(4,dd),D(5,ii),D(6,BN),D(7,cs)],po);Cn(ha,po,0);var x0=j("workingCopyEditorService"),Mf=class extends V{constructor(t){super();this.editorService=t}_onDidRegisterHandler=this._register(new L);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(t){return this.handlers.add(t),this._onDidRegisterHandler.fire(t),Ce(()=>this.handlers.delete(t))}findEditor(t){for(let n of this.editorService.getEditors(0))if(this.isOpen(t,n.editor))return n}isOpen(t,n){for(let i of this.handlers)if(i.isOpen(t,n))return!0;return!1}};Mf=K([D(0,Ei)],Mf);Cn(x0,Mf,1);var I2=j("elevatedFileService");var rh=class extends V{constructor(t,n){super();this.resource=t;this.fileService=n;this._register(this.fileService.onDidFilesChange(i=>this.onDidFilesChange(i)))}_onDidChangeOrphaned=this._register(new L);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(t){let n=!1,i;if(this.orphaned?t.contains(this.resource,1)&&(i=!1,n=!0):t.contains(this.resource,2)&&(i=!0,n=!0),n&&this.orphaned!==i){let r=!1;i&&(await pr(100,Qt.None),this.isDisposed()?r=!0:r=!await this.fileService.exists(this.resource)),this.orphaned!==r&&!this.isDisposed()&&this.setOrphaned(r)}}setOrphaned(t){this.orphaned!==t&&(this.orphaned=t,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new L);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};rh=K([D(1,ii)],rh);var Hc=class extends rh{constructor(t,n,i,r,s,a,l,d,c,u,p,m,f,g,b,v){super(n,a);this.typeId=t;this.name=i;this.modelFactory=r;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=m;this.workingCopyEditorService=f;this.editorService=g;this.elevatedFileService=b;this.progressService=v;this._register(p.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new L);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new L);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new L);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new L);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new L);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new L);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new L);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(t){if(!this.isResolved())return;let n=this.dirty;this.doSetDirty(t),t!==n&&this._onDidChangeDirty.fire()}doSetDirty(t){let n=this.dirty,i=this.inConflictMode,r=this.inErrorMode,s=this.savedVersionId;return t?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=n,this.inConflictMode=i,this.inErrorMode=r,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(t){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!t?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(t)}async doResolve(t){if(t?.contents)return this.resolveFromBuffer(t.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(t)}async resolveFromBuffer(t){this.trace("resolveFromBuffer()");let n,i,r,s;try{let a=await this.fileService.stat(this.resource);n=a.mtime,i=a.ctime,r=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){n=Date.now(),i=Date.now(),r=0,s=cf,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:n,ctime:i,size:r,etag:s,value:t,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let t=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):t?(await this.doResolveFromBackup(t),!0):!1}async doResolveFromBackup(t){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:t.meta?t.meta.mtime:Date.now(),ctime:t.meta?t.meta.ctime:Date.now(),size:t.meta?t.meta.size:0,etag:t.meta?t.meta.etag:cf,value:t.value,readonly:!1,locked:!1},!0),t.meta&&t.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(t){this.trace("resolveFromFile()");let n=t?.forceReadFromFile,i;n?i=cf:this.lastResolvedFileStat&&(i=this.lastResolvedFileStat.etag);let r=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:i,limits:t?.limits});if(this.setOrphaned(!1),r!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof pC&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!n)return;throw s}}async resolveFromContent(t,n){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:t.name,mtime:t.mtime,ctime:t.ctime,size:t.size,etag:t.etag,readonly:t.readonly,locked:t.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(t.value):await this.doCreateModel(t.value),this.setDirty(!!n),this._onDidResolve.fire()}async doCreateModel(t){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,t,Qt.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(t){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(t,Qt.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(t){this._register(t.onDidChangeContent(n=>this.onModelContentChanged(t,n.isUndoing||n.isRedoing))),this._register(t.onWillDispose(()=>this.dispose()))}onModelContentChanged(t,n){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),n&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(t.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let i=this.dirty;this.setDirty(!1),i&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(t){let n;this.lastResolvedFileStat&&(n={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let i;return this.isResolved()&&(i=await $m(this.model.snapshot(2,t),t)),{meta:n,content:i}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new kv;ignoreSaveFromSaveParticipants=!1;async save(t=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(t.reason===2||t.reason===3||t.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(t),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(t){typeof t.reason!="number"&&(t.reason=1);let n=this.versionId;if(this.trace(`doSave(${n}) - enter with versionId ${n}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${n}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(n))return this.trace(`doSave(${n}) - exit - found a running save for versionId ${n}`),this.saveSequentializer.running;if(!t.force&&!this.dirty){this.trace(`doSave(${n}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${n}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(t));this.isResolved()&&this.model.pushStackElement();let i=new jn;return this.progressService.withProgress({title:h("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},r=>this.doSaveSequential(n,t,r,i),()=>{i.cancel()}).finally(()=>{i.dispose()})}doSaveSequential(t,n,i,r){return this.saveSequentializer.run(t,(async()=>{if(this.isResolved()&&!n.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(n.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<Hc.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await pr(Hc.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!r.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:n.reason??1,savedFrom:n.from},i,r.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${t}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(r.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;t=this.versionId,this.inErrorMode=!1,i.report({message:h("saveTextFile","Writing into file...")}),this.trace(`doSave(${t}) - before write()`);let s=Rs(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(t,(async()=>{try{let l={mtime:s.mtime,etag:n.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?cf:s.etag,unlock:n.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,r.token)}catch(c){if(r.token.isCancellationRequested)return;throw c}else{let c=await $m(a.model.snapshot(1,r.token),r.token);if(r.token.isCancellationRequested)return;r.dispose(),n?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,Rs(c),l):d=await this.fileService.writeFile(s.resource,Rs(c),l)}this.handleSaveSuccess(d,t,n)}catch(l){this.handleSaveError(l,t,n)}})(),()=>r.cancel())})(),()=>r.cancel())}handleSaveSuccess(t,n,i){this.updateLastResolvedFileStat(t),n===this.versionId?(this.trace(`handleSaveSuccess(${n}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${n}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:i.reason,stat:t,source:i.source})}handleSaveError(t,n,i){if((i.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${n}) - exit - resulted in a save error: ${t.toString()}`,this.resource.toString(),this.typeId]),i.ignoreErrorHandler)throw t;this.setDirty(!0),this.inErrorMode=!0,t.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(t,i),this._onDidSaveError.fire()}doHandleSaveError(t,n){let i=t,r=[],s;if(i.fileOperationResult===3)s=h("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),r.push(Va({id:"fileWorkingCopy.overwrite",label:h("overwrite","Overwrite"),run:()=>this.save({...n,ignoreModifiedSince:!0,reason:1})})),r.push(Va({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()}));else{let d=i.fileOperationResult===5,c=d&&i.options?.unlock,u=i.fileOperationResult===6,p=this.elevatedFileService.isSupported(this.resource);p1(t)&&r.push(...t.actions),p&&(u||c)?r.push(Va({id:"fileWorkingCopy.saveElevated",label:c?ct?h("overwriteElevated","Overwrite as Admin..."):h("overwriteElevatedSudo","Overwrite as Sudo..."):ct?h("saveElevated","Retry as Admin..."):h("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...n,writeElevated:!0,writeUnlock:c,reason:1})}})):d?r.push(Va({id:"fileWorkingCopy.unlock",label:h("overwrite","Overwrite"),run:()=>this.save({...n,writeUnlock:!0,reason:1})})):r.push(Va({id:"fileWorkingCopy.retry",label:h("retry","Retry"),run:()=>this.save({...n,reason:1})})),r.push(Va({id:"fileWorkingCopy.saveAs",label:h("saveAs","Save As..."),run:async()=>{let m=this.workingCopyEditorService.findEditor(this);m&&((await this.editorService.save(m,{saveAs:!0,reason:1})).success||this.doHandleSaveError(t,n))}})),r.push(Va({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()})),d?c&&p?s=ct?h("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):h("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=h("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):p&&u?s=ct?h("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):h("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=h({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,HI(t,!1))}let a=this.notificationService.notify({id:`${gr(this.resource.toString())}`,severity:hC.Error,message:s,actions:{primary:r}}),l=this._register(de.once(de.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(de.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(t){let n=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=t.mtime?this.lastResolvedFileStat=t:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:t.readonly,locked:t.locked}:this.lastResolvedFileStat=t,this.isReadonly()!==n&&this._onDidChangeReadonly.fire()}async revert(t){if(!this.isResolved()||!this.dirty&&!t?.force)return;this.trace("revert()");let n=this.dirty,i=this.doSetDirty(!1);if(!t?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw i(),s}this._onDidRevert.fire(),n&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(t){switch(t){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(t){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(t){this.logService.trace(`[stored file working copy] ${t}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};Hc=K([D(5,ii),D(6,xn),D(7,_0),D(8,ha),D(9,mC),D(10,Bc),D(11,ds),D(12,x0),D(13,Ei),D(14,I2),D(15,Rf)],Hc);var sh=class extends V{constructor(t){super();this.logService=t}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(t){let n=Ab(this.saveParticipants,t);return Ce(()=>n())}async participate(t,n,i,r){t.model?.pushStackElement();for(let s of this.saveParticipants){if(r.isCancellationRequested||t.isDisposed())break;try{let a=s.participate(t,n,i,r);await $m(a,r)}catch(a){this.logService.warn(a)}}t.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};sh=K([D(0,xn)],sh);var _0=j("workingCopyFileService"),Pf=class extends V{constructor(t,n,i,r){super();this.fileService=t;this.workingCopyService=n;this.instantiationService=i;this.uriIdentityService=r;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new Su);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new Su);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new Su);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(t,n,i){return this.doCreateFileOrFolder(t,!0,n,i)}createFolder(t,n,i){return this.doCreateFileOrFolder(t,!1,n,i)}async doCreateFileOrFolder(t,n,i,r){if(t.length===0)return[];if(n){let c=(await hr.settled(t.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=t.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,r,i);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,Qt.None);let l;try{n?l=await hr.settled(t.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await hr.settled(t.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,Qt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,Qt.None),l}async move(t,n,i){return this.doMoveOrCopy(t,!0,n,i)}async copy(t,n,i){return this.doMoveOrCopy(t,!1,n,i)}async doMoveOrCopy(t,n,i,r){let s=[];for(let{file:{source:d,target:c},overwrite:u}of t){let p=await(n?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(p instanceof Error)throw p}let a=t.map(d=>d.file);await this.runFileOperationParticipants(a,n?2:3,r,i);let l={correlationId:this.correlationIds++,operation:n?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,Qt.None);try{for(let{file:{source:d,target:c},overwrite:u}of t){if(!this.uriIdentityService.extUri.isEqual(d,c)){let p=n?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await hr.settled(p.map(m=>m.revert({soft:!0})))}n?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,Qt.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,Qt.None),s}async delete(t,n,i){for(let a of t){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let r=t.map(a=>({target:a.resource}));await this.runFileOperationParticipants(r,1,i,n);let s={correlationId:this.correlationIds++,operation:1,files:r};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,Qt.None);for(let a of t){let l=this.getDirty(a.resource);await hr.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of t)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,Qt.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,Qt.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(oh));addFileOperationParticipant(t){return this.fileOperationParticipants.addFileOperationParticipant(t)}runFileOperationParticipants(t,n,i,r){return this.fileOperationParticipants.participate(t,n,i,r)}saveParticipants=this._register(this.instantiationService.createInstance(sh));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(t){return this.saveParticipants.addSaveParticipant(t)}runSaveParticipants(t,n,i,r){return this.saveParticipants.participate(t,n,i,r)}workingCopyProviders=[];registerWorkingCopyProvider(t){let n=Ab(this.workingCopyProviders,t);return Ce(n)}getDirty(t){let n=new Set;for(let i of this.workingCopyProviders)for(let r of i(t))r.isDirty()&&n.add(r);return Array.from(n)}};Pf=K([D(0,ii),D(1,Bc),D(2,dt),D(3,dd)],Pf);Cn(_0,Pf,1);var nl=j("textFileService");var E0=".vscode",JU="settings",gUe=`${E0}/${JU}.json`;var fUe=[1],bUe=[2,3,4,5,6],ez=[3,4,5],vUe=[1,...ez],yUe=[2,3,4,5,6],x2=[3,4,5,6],_2=[4,5,6],iS="tasks",C2="launch",E2=Object.create(null);E2[iS]=`${E0}/${iS}.json`;E2[C2]=`${E0}/${C2}.json`;var tz=Object.create(null);tz[iS]=`${iS}.json`;var IUe=Xt;function ah(o,...e){return e.some(t=>o.includes(t))}function w2(o){return o===""||Yn(o)}function w0(o){let e=Array.isArray(o.type)?o.type:[o.type],t=ah(e,"null"),n=(ah(e,"number")||ah(e,"integer"))&&(e.length===1||e.length===2&&t),i=iz(o),r=nz(o),s=oz(o),a=rz(o);return l=>{if(t&&w2(l))return"";let d=[];if(s){let c=s(l);c&&d.push(c)}if(a){let c=a(l);c&&d.push(c)}return o.type==="boolean"&&l!==!0&&l!==!1&&d.push(h("validations.booleanIncorrectType",'Incorrect type. Expected "boolean".')),n&&(w2(l)||typeof l=="boolean"||Array.isArray(l)||isNaN(+l)?d.push(h("validations.expectedNumeric","Value must be a number.")):d.push(...i.filter(c=>!c.isValid(+l)).map(c=>c.message))),o.type==="string"&&(o.enum&&!ow(o.enum)?d.push(h("validations.stringIncorrectEnumOptions","The enum options should be strings, but there is a non-string option. Please file an issue with the extension author.")):Lt(l)?d.push(...r.filter(c=>!c.isValid(l)).map(c=>c.message)):d.push(h("validations.stringIncorrectType",'Incorrect type. Expected "string".'))),d.length?o.errorMessage?[o.errorMessage,...d].join(" "):d.join(" "):""}}function T2(o){try{return new RegExp(o,"u")}catch{try{return new RegExp(o)}catch{return console.error(h("regexParsingError","Error parsing the following regex both with and without the u flag:"),o),/.*/}}}function nz(o){let e=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,t;return typeof o.pattern=="string"&&(t=T2(o.pattern)),[{enabled:o.maxLength!==void 0,isValid:n=>n.length<=o.maxLength,message:h("validations.maxLength","Value must be {0} or fewer characters long.",o.maxLength)},{enabled:o.minLength!==void 0,isValid:n=>n.length>=o.minLength,message:h("validations.minLength","Value must be {0} or more characters long.",o.minLength)},{enabled:t!==void 0,isValid:n=>t.test(n),message:o.patternErrorMessage||h("validations.regex","Value must match regex `{0}`.",o.pattern)},{enabled:o.format==="color-hex",isValid:n=>G.Format.CSS.parseHex(n),message:h("validations.colorFormat","Invalid color format. Use #RGB, #RGBA, #RRGGBB or #RRGGBBAA.")},{enabled:o.format==="uri"||o.format==="uri-reference",isValid:n=>!!n.length,message:h("validations.uriEmpty","URI expected.")},{enabled:o.format==="uri"||o.format==="uri-reference",isValid:n=>e.test(n),message:h("validations.uriMissing","URI is expected.")},{enabled:o.format==="uri",isValid:n=>{let i=n.match(e);return!!(i&&i[2])},message:h("validations.uriSchemeMissing","URI with a scheme is expected.")},{enabled:o.enum!==void 0,isValid:n=>o.enum.includes(n),message:h("validations.invalidStringEnumValue","Value is not accepted. Valid values: {0}.",o.enum?o.enum.map(n=>`"${n}"`).join(", "):"[]")}].filter(n=>n.enabled)}function iz(o){let e=Array.isArray(o.type)?o.type:[o.type],t=ah(e,"null"),n=ah(e,"integer")&&(e.length===1||e.length===2&&t);if(!(ah(e,"number","integer")&&(e.length===1||e.length===2&&t)))return[];let r,s;return typeof o.exclusiveMaximum=="boolean"?r=o.exclusiveMaximum?o.maximum:void 0:r=o.exclusiveMaximum,typeof o.exclusiveMinimum=="boolean"?s=o.exclusiveMinimum?o.minimum:void 0:s=o.exclusiveMinimum,[{enabled:r!==void 0&&(o.maximum===void 0||r<=o.maximum),isValid:a=>a<r,message:h("validations.exclusiveMax","Value must be strictly less than {0}.",r)},{enabled:s!==void 0&&(o.minimum===void 0||s>=o.minimum),isValid:a=>a>s,message:h("validations.exclusiveMin","Value must be strictly greater than {0}.",s)},{enabled:o.maximum!==void 0&&(r===void 0||r>o.maximum),isValid:a=>a<=o.maximum,message:h("validations.max","Value must be less than or equal to {0}.",o.maximum)},{enabled:o.minimum!==void 0&&(s===void 0||s<o.minimum),isValid:a=>a>=o.minimum,message:h("validations.min","Value must be greater than or equal to {0}.",o.minimum)},{enabled:o.multipleOf!==void 0,isValid:a=>a%o.multipleOf===0,message:h("validations.multipleOf","Value must be a multiple of {0}.",o.multipleOf)},{enabled:n,isValid:a=>a%1===0,message:h("validations.expectedInteger","Value must be an integer.")}].filter(a=>a.enabled)}function oz(o){if(o.type==="array"&&o.items&&!Array.isArray(o.items)){let e=o.items;if(e&&!Array.isArray(e.type)){let t=n=>"'"+n+"'";return n=>{if(!n)return null;let i="";if(!Array.isArray(n))return i+=h("validations.arrayIncorrectType","Incorrect type. Expected an array."),i+=`
`,i;let r=n;if(o.uniqueItems&&new Set(r).size<r.length&&(i+=h("validations.stringArrayUniqueItems","Array has duplicate items"),i+=`
`),o.minItems&&r.length<o.minItems&&(i+=h("validations.stringArrayMinItem","Array must have at least {0} items",o.minItems),i+=`
`),o.maxItems&&r.length>o.maxItems&&(i+=h("validations.stringArrayMaxItem","Array must have at most {0} items",o.maxItems),i+=`
`),e.type==="string"){if(!ow(r))return i+=h("validations.stringArrayIncorrectType","Incorrect type. Expected a string array."),i+=`
`,i;if(typeof e.pattern=="string"){let a=T2(e.pattern);r.forEach(l=>{a.test(l)||(i+=e.patternErrorMessage||h("validations.stringArrayItemPattern","Value {0} must match regex {1}.",t(l),t(e.pattern)))})}let s=e.enum;s&&r.forEach(a=>{s.indexOf(a)===-1&&(i+=h("validations.stringArrayItemEnum","Value {0} is not one of {1}",t(a),"["+s.map(t).join(", ")+"]"),i+=`
`)})}else(e.type==="integer"||e.type==="number")&&r.forEach(s=>{let a=oS(e,s);a&&(i+=`${s}: ${a}
`)});return i}}}return null}function rz(o){if(o.type==="object"){let{properties:e,patternProperties:t,additionalProperties:n}=o;return i=>{if(!i)return null;let r=[];return Ht(i)?Object.keys(i).forEach(s=>{let a=i[s];if(e&&s in e){let l=oS(e[s],a);l&&r.push(`${s}: ${l}
`);return}if(t){for(let l in t)if(RegExp(l).test(s)){let d=oS(t[l],a);d&&r.push(`${s}: ${d}
`);return}}if(n===!1)r.push(h("validations.objectPattern",`Property {0} is not allowed.
`,s));else if(typeof n=="object"){let l=oS(n,a);l&&r.push(`${s}: ${l}
`)}}):r.push(h("validations.objectIncorrectType","Incorrect type. Expected an object.")),r.length?o.errorMessage?[o.errorMessage,...r].join(" "):r.join(" "):""}}return null}function oS(o,e){return w0(o)(e)}var Rn={startLineNumber:-1,startColumn:-1,endLineNumber:-1,endColumn:-1};function T0(o){return o.startLineNumber===-1&&o.startColumn===-1&&o.endLineNumber===-1&&o.endColumn===-1}var Nf=class extends ia{_currentResultGroups=new Map;updateResultGroup(e,t){return t?this._currentResultGroups.set(e,t):this._currentResultGroups.delete(e),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let e=new Set;[...this._currentResultGroups.keys()].sort((t,n)=>this._currentResultGroups.get(t).order-this._currentResultGroups.get(n).order).forEach(t=>{let n=this._currentResultGroups.get(t);n.result.filterMatches=n.result.filterMatches.filter(i=>!e.has(i.setting.key)),n.result.filterMatches.forEach(i=>e.add(i.setting.key))})}filterSettings(e,t,n){let i=this.filterGroups,r=[];for(let s of i){let a=t(s);for(let l of s.sections)for(let d of l.settings){let c=n(d,s);(a||c)&&r.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return r}getPreference(e){for(let t of this.settingsGroups)for(let n of t.sections)for(let i of n.settings)if(e===i.key)return i}collectMetadata(e){let t=Object.create(null),n=!1;return e.forEach(i=>{i.result.metadata&&(t[i.id]=i.result.metadata,n=!0)}),n?t:null}get filterGroups(){return this.settingsGroups}},Of=class extends Nf{constructor(t,n){super();this._configurationTarget=n;this.settingsModel=t.object.textEditorModel,this._register(this.onWillDispose(()=>t.dispose())),this._register(this.settingsModel.onDidChangeContent(()=>{this._settingsGroups=void 0,this._onDidChangeGroups.fire()}))}_settingsGroups;settingsModel;_onDidChangeGroups=this._register(new L);onDidChangeGroups=this._onDidChangeGroups.event;get uri(){return this.settingsModel.uri}get configurationTarget(){return this._configurationTarget}get settingsGroups(){return this._settingsGroups||this.parse(),this._settingsGroups}get content(){return this.settingsModel.getValue()}findValueMatches(t,n){return this.settingsModel.findMatches(t,n.valueRange,!1,!1,null,!1).map(i=>i.range)}isSettingsProperty(t,n){return n.length===0}parse(){this._settingsGroups=D2(this.settingsModel,(t,n)=>this.isSettingsProperty(t,n))}update(){let t=[...this._currentResultGroups.values()];if(!t.length)return;let n=[],i=[];t.forEach(l=>{l.result.filterMatches.forEach(d=>{n.push(d.setting),d.matches&&i.push(...d.matches)})});let r,s=this.settingsGroups[0];s&&(r={id:s.id,range:s.range,sections:[{settings:n}],title:s.title,titleRange:s.titleRange,order:s.order,extensionInfo:s.extensionInfo});let a=this.collectMetadata(t);return{allGroups:this.settingsGroups,filteredGroups:r?[r]:[],matches:i,metadata:a}}},lh=class extends Nf{constructor(t,n){super();this._defaultSettings=t;this._register(n.onDidChangeConfiguration(i=>{i.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(et.as(nr.Configuration).onDidSchemaChange(i=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new L);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let t=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...t,...this.additionalGroups]}setAdditionalGroups(t){this.additionalGroups=t}findValueMatches(t,n){return[]}update(){throw new Error("Not supported")}};lh=K([D(1,Xt)],lh);function D2(o,e){let t=[],n=null,i=null,r=[],s=[],a=-1,l={startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0};function d(u,p,m){if(Array.isArray(r)?r.push(u):i&&(r[i]=u),s.length===a+1||s.length===a+2&&n!==null){let f=s.length===a+1?t[t.length-1]:n.overrides[n.overrides.length-1];if(f){let g=o.getPositionAt(p),b=o.getPositionAt(p+m);f.value=u,f.valueRange={startLineNumber:g.lineNumber,startColumn:g.column,endLineNumber:b.lineNumber,endColumn:b.column},f.range=Object.assign(f.range,{endLineNumber:b.lineNumber,endColumn:b.column})}}}let c={onObjectBegin:(u,p)=>{if(e(i,s)){a=s.length;let f=o.getPositionAt(u);l.startLineNumber=f.lineNumber,l.startColumn=f.column}let m={};d(m,u,p),r=m,i=null,s.push(r)},onObjectProperty:(u,p,m)=>{if(i=u,s.length===a+1||s.length===a+2&&n!==null){let f=o.getPositionAt(p),g={description:[],descriptionIsMarkdown:!1,key:u,keyRange:{startLineNumber:f.lineNumber,startColumn:f.column+1,endLineNumber:f.lineNumber,endColumn:f.column+m},range:{startLineNumber:f.lineNumber,startColumn:f.column,endLineNumber:0,endColumn:0},value:null,valueRange:Rn,descriptionRanges:[],overrides:[],overrideOf:n??void 0};s.length===a+1?(t.push(g),Ur.test(u)&&(n=g)):n.overrides.push(g)}},onObjectEnd:(u,p)=>{if(r=s.pop(),a!==-1&&(s.length===a+1||s.length===a+2&&n!==null)){let m=s.length===a+1?t[t.length-1]:n.overrides[n.overrides.length-1];if(m){let f=o.getPositionAt(u+p);m.valueRange=Object.assign(m.valueRange,{endLineNumber:f.lineNumber,endColumn:f.column}),m.range=Object.assign(m.range,{endLineNumber:f.lineNumber,endColumn:f.column})}s.length===a+1&&(n=null)}if(s.length===a){let m=o.getPositionAt(u);l.endLineNumber=m.lineNumber,l.endColumn=m.column,a=-1}},onArrayBegin:(u,p)=>{let m=[];d(m,u,p),s.push(r),r=m,i=null},onArrayEnd:(u,p)=>{if(r=s.pop(),s.length===a+1||s.length===a+2&&n!==null){let m=s.length===a+1?t[t.length-1]:n.overrides[n.overrides.length-1];if(m){let f=o.getPositionAt(u+p);m.valueRange=Object.assign(m.valueRange,{endLineNumber:f.lineNumber,endColumn:f.column}),m.range=Object.assign(m.range,{endLineNumber:f.lineNumber,endColumn:f.column})}}},onLiteralValue:d,onError:u=>{let p=t[t.length-1];p&&(T0(p.range)||T0(p.keyRange)||T0(p.valueRange))&&t.pop()}};return o.isDisposed()||KE(o.getValue(),c),t.length>0?[{sections:[{settings:t}],title:"",titleRange:Rn,range:l}]:[]}var Af=class extends Of{_configurationGroups=[];get configurationGroups(){return this._configurationGroups}parse(){super.parse(),this._configurationGroups=D2(this.settingsModel,(e,t)=>t.length===0)}isSettingsProperty(e,t){return e==="settings"&&t.length===1}},ch=class extends V{constructor(t,n,i){super();this._mostCommonlyUsedSettingsKeys=t;this.target=n;this.configurationService=i;this._register(i.onDidChangeConfiguration(r=>{r.source===7&&(this.reset(),this._onDidChange.fire())}))}_allSettingsGroups;_content;_contentWithoutMostCommonlyUsed;_settingsByName=new Map;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;getContent(t=!1){return(!this._content||t)&&this.initialize(),this._content}getContentWithoutMostCommonlyUsed(t=!1){return(!this._contentWithoutMostCommonlyUsed||t)&&this.initialize(),this._contentWithoutMostCommonlyUsed}getSettingsGroups(t=!1){return(!this._allSettingsGroups||t)&&this.initialize(),this._allSettingsGroups}initialize(){this._allSettingsGroups=this.parse(),this._content=this.toContent(this._allSettingsGroups,0),this._contentWithoutMostCommonlyUsed=this.toContent(this._allSettingsGroups,1)}reset(){this._content=void 0,this._contentWithoutMostCommonlyUsed=void 0,this._allSettingsGroups=void 0}parse(){let t=this.getRegisteredGroups();return this.initAllSettingsMap(t),[this.getMostCommonlyUsedSettings(),...t]}getRegisteredGroups(){let t=et.as(nr.Configuration).getConfigurations().slice(),n=this.removeEmptySettingsGroups(t.sort(this.compareConfigurationNodes).reduce((i,r,s,a)=>this.parseConfig(r,i,a),[]));return this.sortGroups(n)}sortGroups(t){return t.forEach(n=>{n.sections.forEach(i=>{i.settings.sort((r,s)=>r.key.localeCompare(s.key))})}),t}initAllSettingsMap(t){this._settingsByName=new Map;for(let n of t)for(let i of n.sections)for(let r of i.settings)this._settingsByName.set(r.key,r)}getMostCommonlyUsedSettings(){let t=xs(this._mostCommonlyUsedSettingsKeys.map(n=>{let i=this._settingsByName.get(n);return i?{description:i.description,key:i.key,value:i.value,keyRange:Rn,range:Rn,valueRange:Rn,overrides:[],scope:4,type:i.type,enum:i.enum,enumDescriptions:i.enumDescriptions,descriptionRanges:[]}:null}));return{id:"mostCommonlyUsed",range:Rn,title:h("commonlyUsed","Commonly Used"),titleRange:Rn,sections:[{settings:t}]}}parseConfig(t,n,i,r,s){s=s||{};let a=t.title;if(!a){let l=i.find(d=>d.id===t.id&&d.title);l&&(a=l.title)}if(a&&(r?r.sections[r.sections.length-1].title=a:(r=n.find(l=>l.title===a&&l.extensionInfo?.id===t.extensionInfo?.id),r||(r={sections:[{settings:[]}],id:t.id||"",title:a||"",titleRange:Rn,order:t.order,range:Rn,extensionInfo:t.extensionInfo},n.push(r)))),t.properties){r||(r={sections:[{settings:[]}],id:t.id||"",title:t.id||"",titleRange:Rn,order:t.order,range:Rn,extensionInfo:t.extensionInfo},n.push(r));let l=[];for(let d of[...r.sections[r.sections.length-1].settings,...this.parseSettings(t)])s[d.key]||(l.push(d),s[d.key]=!0);l.length&&(r.sections[r.sections.length-1].settings=l)}return t.allOf?.forEach(l=>this.parseConfig(l,n,i,r,s)),n}removeEmptySettingsGroups(t){let n=[];for(let i of t)i.sections=i.sections.filter(r=>r.settings.length>0),i.sections.length&&n.push(i);return n}parseSettings(t){let n=[],i=t.properties,r=t.extensionInfo,s=t.extensionInfo?.id===t.id?t.title:t.id;for(let a in i){let l=i[a];if(this.matchesScope(l)){let d=l.default,c=l.markdownDescription||l.description||"";typeof c!="string"&&(c="");let u=c.split(`
`),p=Ur.test(a)?this.parseOverrideSettings(l.default):[],m;l.type==="array"&&l.items&&!Array.isArray(l.items)&&l.items.type&&(l.items.enum?m="enum":Array.isArray(l.items.type)||(m=l.items.type));let f=l.type==="object"?l.properties:void 0,g=l.type==="object"?l.patternProperties:void 0,b=l.type==="object"?l.additionalProperties:void 0,v=l.enum,I=l.markdownEnumDescriptions??l.enumDescriptions,C=!!l.markdownEnumDescriptions;m==="enum"&&!Array.isArray(l.items)&&(v=l.items.enum,I=l.items.markdownEnumDescriptions??l.items.enumDescriptions,C=!!l.items.markdownEnumDescriptions);let S=!1;l.type==="object"&&!l.additionalProperties&&l.properties&&Object.keys(l.properties).length&&(S=Object.keys(l.properties).every(N=>l.properties[N].type==="boolean"));let _=!1;Ur.test(a)&&(_=!0);let R;if(!_){let N=l;N&&N.defaultValueSource&&(R=N.defaultValueSource)}!v&&(l.enumItemLabels||I||C)&&console.error(`The setting ${a} has enum-related fields, but doesn't have an enum field. This setting may render improperly in the Settings editor.`),n.push({key:a,value:d,description:u,descriptionIsMarkdown:!!l.markdownDescription,range:Rn,keyRange:Rn,valueRange:Rn,descriptionRanges:[],overrides:p,scope:l.scope,type:l.type,arrayItemType:m,objectProperties:f,objectPatternProperties:g,objectAdditionalProperties:b,enum:v,enumDescriptions:I,enumDescriptionsAreMarkdown:C,enumItemLabels:l.enumItemLabels,uniqueItems:l.uniqueItems,tags:l.tags,disallowSyncIgnore:l.disallowSyncIgnore,restricted:l.restricted,extensionInfo:r,deprecationMessage:l.markdownDeprecationMessage||l.deprecationMessage,deprecationMessageIsMarkdown:!!l.markdownDeprecationMessage,validator:w0(l),allKeysAreBoolean:S,editPresentation:l.editPresentation,order:l.order,nonLanguageSpecificDefaultValueSource:R,isLanguageTagSetting:_,categoryLabel:s})}}return n}parseOverrideSettings(t){return Object.keys(t).map(n=>({key:n,value:t[n],description:[],descriptionIsMarkdown:!1,range:Rn,keyRange:Rn,valueRange:Rn,descriptionRanges:[],overrides:[]}))}matchesScope(t){return t.scope?this.target===6?_2.indexOf(t.scope)!==-1:this.target===5?x2.indexOf(t.scope)!==-1:!0:!0}compareConfigurationNodes(t,n){if(typeof t.order!="number")return 1;if(typeof n.order!="number")return-1;if(t.order===n.order){let i=t.title||"",r=n.title||"";return i.localeCompare(r)}return t.order-n.order}toContent(t,n){let i=new Ff;for(let r=n;r<t.length;r++)i.pushGroup(t[r],r===n,r===t.length-1);return i.getContent()}},rS=class extends Nf{constructor(t,n,i){super();this._uri=t;this.defaultSettings=i;this._register(i.onDidChange(()=>this._onDidChangeGroups.fire())),this._model=n.object.textEditorModel,this._register(this.onWillDispose(()=>n.dispose()))}_model;_onDidChangeGroups=this._register(new L);onDidChangeGroups=this._onDidChangeGroups.event;get uri(){return this._uri}get target(){return this.defaultSettings.target}get settingsGroups(){return this.defaultSettings.getSettingsGroups()}get filterGroups(){return this.settingsGroups.slice(1)}update(){if(this._model.isDisposed())return;let t=[...this._currentResultGroups.values()].sort((l,d)=>l.order-d.order),n=t.filter(l=>l.result.filterMatches.length),i=Mi(this.settingsGroups).range.endLineNumber+2,{settingsGroups:r,matches:s}=this.writeResultGroups(n,i),a=this.collectMetadata(t);return t.length?{allGroups:this.settingsGroups,filteredGroups:r,matches:s,metadata:a}:void 0}writeResultGroups(t,n){let i=n-1,r=new Ff(i),s=[],a=[];t.length&&(r.pushLine(","),t.forEach(m=>{let f=this.getGroup(m);s.push(f),a.push(...this.writeSettingsGroupToBuilder(r,f,m.result.filterMatches))}));let l=r.getContent()+`
`,d=this._model.getLineCount(),c=new Me(n,1,n,1),u={text:l,forceMoveMarkers:!0,range:new w(n,1,d,1)};this._model.pushEditOperations([c],[u],()=>[c]);let p=Math.min(n+60,this._model.getLineCount());return this._model.tokenization.forceTokenization(p),{matches:a,settingsGroups:s}}writeSettingsGroupToBuilder(t,n,i){return i=i.map(s=>({setting:s.setting,score:s.score,matches:s.matches&&s.matches.map(a=>new w(a.startLineNumber-s.setting.range.startLineNumber,a.startColumn,a.endLineNumber-s.setting.range.startLineNumber,a.endColumn))})),t.pushGroup(n),i.map(s=>s.matches||[]).flatMap((s,a)=>{let l=n.sections[0].settings[a];return s.map(d=>new w(d.startLineNumber+l.range.startLineNumber,d.startColumn,d.endLineNumber+l.range.startLineNumber,d.endColumn))})}copySetting(t){return{description:t.description,scope:t.scope,type:t.type,enum:t.enum,enumDescriptions:t.enumDescriptions,key:t.key,value:t.value,range:t.range,overrides:[],overrideOf:t.overrideOf,tags:t.tags,deprecationMessage:t.deprecationMessage,keyRange:Rn,valueRange:Rn,descriptionIsMarkdown:void 0,descriptionRanges:[]}}findValueMatches(t,n){return[]}getPreference(t){for(let n of this.settingsGroups)for(let i of n.sections)for(let r of i.settings)if(r.key===t)return r}getGroup(t){return{id:t.id,range:Rn,title:t.label,titleRange:Rn,sections:[{settings:t.result.filterMatches.map(n=>this.copySetting(n.setting))}]}}},Ff=class{constructor(e=0){this._rangeOffset=e;this._contentByLines=[]}_contentByLines;get lineCountWithOffset(){return this._contentByLines.length+this._rangeOffset}get lastLine(){return this._contentByLines[this._contentByLines.length-1]||""}pushLine(...e){this._contentByLines.push(...e)}pushGroup(e,t,n){this._contentByLines.push(t?"[{":"{");let i=this._pushGroup(e,"  ");if(i){let r=i.range.endLineNumber-this._rangeOffset,s=this._contentByLines[r-2];this._contentByLines[r-2]=s.substring(0,s.length-1)}this._contentByLines.push(n?"}]":"},")}_pushGroup(e,t){let n=null,i=this.lineCountWithOffset+1;for(let r of e.sections){if(r.title){let s=this.lineCountWithOffset+1;this.addDescription([r.title],t,this._contentByLines),r.titleRange={startLineNumber:s,startColumn:1,endLineNumber:this.lineCountWithOffset,endColumn:this.lastLine.length}}if(r.settings.length)for(let s of r.settings)this.pushSetting(s,t),n=s}return e.range={startLineNumber:i,startColumn:1,endLineNumber:this.lineCountWithOffset,endColumn:this.lastLine.length},n}getContent(){return this._contentByLines.join(`
`)}pushSetting(e,t){let n=this.lineCountWithOffset+1;this.pushSettingDescription(e,t);let i=t,r=JSON.stringify(e.key);i+=r,e.keyRange={startLineNumber:this.lineCountWithOffset+1,startColumn:i.indexOf(e.key)+1,endLineNumber:this.lineCountWithOffset+1,endColumn:e.key.length},i+=": ";let s=this.lineCountWithOffset+1;this.pushValue(e,i,t),e.valueRange={startLineNumber:s,startColumn:i.length+1,endLineNumber:this.lineCountWithOffset,endColumn:this.lastLine.length+1},this._contentByLines[this._contentByLines.length-1]+=",",this._contentByLines.push(""),e.range={startLineNumber:n,startColumn:1,endLineNumber:this.lineCountWithOffset,endColumn:this.lastLine.length}}pushSettingDescription(e,t){let n=s=>s.replace(/`#(.*)#`/g,(a,l)=>`\`${l}\``);e.descriptionRanges=[];let i=t+"// ",r=e.deprecationMessage?.split(/\n/g)??[];for(let s of[...r,...e.description])s=n(s),this._contentByLines.push(i+s),e.descriptionRanges.push({startLineNumber:this.lineCountWithOffset,startColumn:this.lastLine.indexOf(s)+1,endLineNumber:this.lineCountWithOffset,endColumn:this.lastLine.length});e.enum&&e.enumDescriptions?.some(s=>!!s)&&e.enumDescriptions.forEach((s,a)=>{let l=sz(String(e.enum[a])),d=s?`${l}: ${n(s)}`:l,c=d.split(/\n/g);c[0]=" - "+c[0],this._contentByLines.push(...c.map(u=>`${t}// ${u}`)),e.descriptionRanges.push({startLineNumber:this.lineCountWithOffset,startColumn:this.lastLine.indexOf(d)+1,endLineNumber:this.lineCountWithOffset,endColumn:this.lastLine.length})})}pushValue(e,t,n){let i=JSON.stringify(e.value,null,n);if(i&&typeof e.value=="object")if(e.overrides&&e.overrides.length){this._contentByLines.push(t+" {");for(let a of e.overrides)this.pushSetting(a,n+n),this._contentByLines.pop();let r=e.overrides[e.overrides.length-1],s=this._contentByLines[r.range.endLineNumber-2];this._contentByLines[r.range.endLineNumber-2]=s.substring(0,s.length-1),this._contentByLines.push(n+"}")}else{let r=i.split(`
`);this._contentByLines.push(t+r[0]);for(let s=1;s<r.length;s++)this._contentByLines.push(n+r[s])}else this._contentByLines.push(t+i)}addDescription(e,t,n){for(let i of e)n.push(t+"// "+i)}},L0=class extends Ff{constructor(t="	"){super(0);this.indent=t}pushGroup(t){this._pushGroup(t,this.indent)}},sS=class extends V{constructor(t){super();this.defaultSettings=t;this._register(t.onDidChange(()=>{this._content=null,this._onDidContentChanged.fire()}))}_content=null;_onDidContentChanged=this._register(new L);onDidContentChanged=this._onDidContentChanged.event;get content(){if(this._content===null){let t=new L0;t.pushLine("{");for(let n of this.defaultSettings.getRegisteredGroups())t.pushGroup(n);t.pushLine("}"),this._content=t.getContent()}return this._content}};function sz(o){return o&&o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function D0(o){return"// "+h("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+o.getDefaultKeybindingsContent()}var dh=class{constructor(e,t){this._uri=e;this.keybindingService=t}_content;get uri(){return this._uri}get content(){return this._content||(this._content=D0(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};dh=K([D(1,Oo)],dh);function aS(o){return{...o,override:xr.id,pinned:!0}}var lS=j("preferencesService");var k0=".vscode/settings.json",k2="workbench.settings.openDefaultSettings",R2="workbench.settings.useSplitJSON",M2="settings";var Wc={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},xr={id:"default",displayName:h("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:h("builtinProviderDisplayName","Built-in")};var P2="workbench.editors.textDiffEditor",N2="workbench.editors.binaryResourceDiffEditor";function nh(o,e,t){for(let n of t.visibleEditorPanes)if(n.group.id===e&&o.matches(n.input))return n.getViewState()}function QC(o){if(co(o))return!1;let e=o;return le.isUri(e?.resource)}function sr(o){if(co(o))return!1;let e=o;return e?.original!==void 0&&e.modified!==void 0}function ih(o){if(co(o))return!1;let e=o;return!e||e.resources&&!Array.isArray(e.resources)?!1:!!e.resources||!!e.multiDiffSource}function ca(o){if(co(o)||sr(o))return!1;let e=o;return e?.primary!==void 0&&e.secondary!==void 0}function O2(o){if(co(o))return!1;let e=o;return e?e.resource===void 0||e.resource.scheme===Ie.untitled||e.forceUntitled===!0:!1}function ua(o){if(co(o))return!1;let e=o;return le.isUri(e?.base?.resource)&&le.isUri(e?.input1?.resource)&&le.isUri(e?.input2?.resource)&&le.isUri(e?.result?.resource)}var R0=class{mapIdToSaveSource=new Map;registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}},c9e=new R0;var Df=class extends V{};function co(o){return o instanceof Df}function az(o){let e=o;return le.isUri(e?.preferredResource)}function lz(o){let e=o;return co(e?.primary)&&co(e?.secondary)}function g0(o){let e=o;return co(e?.modified)&&co(e?.original)}var M0=class{getOriginalUri(e,t){if(!e)return;if(ua(e))return th.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getOriginalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getOriginalUri(i,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(sr(e)||ih(e)||ca(e)||ua(e))return;let n=az(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return lz(e)||ca(e)?{primary:e.primary,secondary:e.secondary}:g0(e)||sr(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(ua(e))return th.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:i,secondary:r}=this.getSideEditors(e);if(i&&r){if(t?.supportSideBySide===3)return{primary:this.getCanonicalUri(i,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===4)return this.getCanonicalUri(i,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===1?i:r}}if(sr(e)||ih(e)||ca(e)||ua(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(n=>e.scheme===n))return e}else if(t===e.scheme)return e}};var th=new M0;var P0=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(e){let t=this.instantiationService=e.get(dt);for(let[n,i]of this.editorSerializerConstructors)this.createEditorSerializer(n,i,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let i=n.createInstance(t);this.editorSerializerInstances.set(e,i)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return Rs(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),Ce(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}};et.add(Wc.EditorFactory,new P0);var A2=j("jsonEditingService");var uh=class{modifierLabels;constructor(e,t,n=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=n}toLabel(e,t,n){if(t.length===0)return null;let i=[];for(let r=0,s=t.length;r<s;r++){let a=t[r],l=n(a);if(l===null)return null;i[r]=dz(a,l,this.modifierLabels[e])}return i.join(" ")}},Bf=new uh({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),F2=new uh({ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:h({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),C9e=new uh({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),B2=new uh({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function dz(o,e,t){if(e===null)return"";let n=[];return o.ctrlKey&&n.push(t.ctrlKey),o.shiftKey&&n.push(t.shiftKey),o.altKey&&n.push(t.altKey),o.metaKey&&n.push(t.metaKey),e!==""&&n.push(e),n.join(t.separator)}function W2(o){let e=[],t=new Map,n=(i,r)=>{if(!t.has(i)&&(t.set(i,!0),!(i[0]==="_"||i.indexOf("vscode.")===0)&&o.get(i)!==!0)){if(!r){let s=Eo.getCommand(i);if(s&&typeof s.metadata=="object"&&hu(s.metadata.args))return}e.push(i)}};for(let i of Qu.getMenuItems(Fn.CommandPalette))nL(i)&&n(i.command.id,!0);for(let i of Tc.getEditorActions())n(i.id,!0);for(let i of Eo.getCommands().keys())n(i,!1);return e}function N0(o){let e=JSON.parse(o);return e=ph(e),e}function ph(o,e=0){if(!o||e>200)return o;if(typeof o=="object"){switch(o.$mid){case 1:return le.revive(o);case 2:return new RegExp(o.source,o.flags);case 17:return new Date(o.source)}if(o instanceof gn||o instanceof Uint8Array)return o;if(Array.isArray(o))for(let t=0;t<o.length;++t)o[t]=ph(o[t],e+1);else for(let t in o)Object.hasOwnProperty.call(o,t)&&(o[t]=ph(o[t],e+1))}return o}function V2(o){switch(o){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function H2(o){switch(o){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function hh(o){let e=0;for(let t=0;;t+=7){let n=o.read(1);if(e|=(n.buffer[0]&127)<<t,!(n.buffer[0]&128))return e}}var uz=cd(0);function mh(o,e){if(e===0){o.write(uz);return}let t=0;for(let i=e;i!==0;i=i>>>7)t++;let n=gn.alloc(t);for(let i=0;e!==0;i++)n.buffer[i]=e&127,e=e>>>7,e>0&&(n.buffer[i]|=128);o.write(n)}var A0=class{constructor(e){this.buffer=e}pos=0;read(e){let t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}},F0=class{buffers=[];get buffer(){return gn.concat(this.buffers)}write(e){this.buffers.push(e)}};function cd(o){let e=gn.alloc(1);return e.writeUInt8(o,0),e}var Uc={Undefined:cd(0),String:cd(1),Buffer:cd(2),VSBuffer:cd(3),Array:cd(4),Object:cd(5),Uint:cd(6)},pz=typeof Buffer<"u";function B0(o,e){if(typeof e>"u")o.write(Uc.Undefined);else if(typeof e=="string"){let t=gn.fromString(e);o.write(Uc.String),mh(o,t.byteLength),o.write(t)}else if(pz&&Buffer.isBuffer(e)){let t=gn.wrap(e);o.write(Uc.Buffer),mh(o,t.byteLength),o.write(t)}else if(e instanceof gn)o.write(Uc.VSBuffer),mh(o,e.byteLength),o.write(e);else if(Array.isArray(e)){o.write(Uc.Array),mh(o,e.length);for(let t of e)B0(o,t)}else if(typeof e=="number"&&(e|0)===e)o.write(Uc.Uint),mh(o,e);else{let t=gn.fromString(JSON.stringify(e));o.write(Uc.Object),mh(o,t.byteLength),o.write(t)}}function W0(o){switch(o.read(1).readUInt8(0)){case 0:return;case 1:return o.read(hh(o)).toString();case 2:return o.read(hh(o)).buffer;case 3:return o.read(hh(o));case 4:{let t=hh(o),n=[];for(let i=0;i<t;i++)n.push(W0(o));return n}case 5:return JSON.parse(o.read(hh(o)).toString());case 6:return hh(o)}}var O0=class{constructor(e,t=null){this.protocol=e;this.protocolListener=this.protocol.onMessage(n=>this.onBuffer(n)),this.logger=t}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new L;onDidInitialize=this._onDidInitialize.event;getChannel(e){let t=this;return{call(n,i,r){return t.isDisposed?Promise.reject(new ci):t.requestPromise(e,n,i,r)},listen(n,i){return t.isDisposed?de.None:t.requestEvent(e,n,i)}}}requestPromise(e,t,n,i=Qt.None){let r=this.lastRequestId++,a={id:r,type:100,channelName:e,name:t,arg:n};if(i.isCancellationRequested)return Promise.reject(new ci);let l;return new Promise((c,u)=>{if(i.isCancellationRequested)return u(new ci);let p=()=>{let b=v=>{switch(v.type){case 201:this.handlers.delete(r),c(v.data);break;case 202:{this.handlers.delete(r);let I=new Error(v.data.message);I.stack=Array.isArray(v.data.stack)?v.data.stack.join(`
`):v.data.stack,I.name=v.data.name,u(I);break}case 203:this.handlers.delete(r),u(v.data);break}};this.handlers.set(r,b),this.sendRequest(a)},m=null;this.state===1?p():(m=zd(b=>this.whenInitialized()),m.then(()=>{m=null,p()}));let f=()=>{m?(m.cancel(),m=null):this.sendRequest({id:r,type:101}),u(new ci)},g=i.onCancellationRequested(f);l=Ls(Ce(f),g),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(e,t,n){let i=this.lastRequestId++,s={id:i,type:102,channelName:e,name:t,arg:n},a=null,l=new L({onWillAddFirstListener:()=>{a=zd(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(i,d),l.event}sendRequest(e){switch(e.type){case 100:case 102:{let t=this.send([e.type,e.id,e.channelName,e.name],e.arg);this.logger?.logOutgoing(t,e.id,0,`${V2(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{let t=this.send([e.type,e.id]);this.logger?.logOutgoing(t,e.id,0,V2(e.type));return}}}send(e,t=void 0){let n=new F0;return B0(n,e),B0(n,t),this.sendBuffer(n.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch{return 0}}onBuffer(e){let t=new A0(e),n=W0(t),i=W0(t),r=n[0];switch(r){case 200:return this.logger?.logIncoming(e.byteLength,0,0,H2(r)),this.onResponse({type:n[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(e.byteLength,n[1],0,H2(r),i),this.onResponse({type:n[0],id:n[1],data:i})}}onResponse(e){if(e.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(e.id)?.(e)}get onDidInitializePromise(){return de.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),yt(this.activeRequests.values()),this.activeRequests.clear()}};K([Et],O0.prototype,"onDidInitializePromise",1);var hz;(i=>{function o(r,s,a){let l=r,d=a&&a.disableMarshalling,c=new Map;for(let u in l)t(u)&&c.set(u,de.buffer(l[u],!0,void 0,s));return new class{listen(u,p,m){let f=c.get(p);if(f)return f;let g=l[p];if(typeof g=="function"){if(n(p))return g.call(l,m);if(t(p))return c.set(p,de.buffer(l[p],!0,void 0,s)),c.get(p)}throw new Ea(`Event not found: ${p}`)}call(u,p,m){let f=l[p];if(typeof f=="function"){if(!d&&Array.isArray(m))for(let b=0;b<m.length;b++)m[b]=ph(m[b]);let g=f.apply(l,m);return g instanceof Promise||(g=Promise.resolve(g)),g}throw new Ea(`Method not found: ${p}`)}}}i.fromService=o;function e(r,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):n(d)?function(c){return r.listen(d,c)}:t(d)?r.listen(d):async function(...c){let u;s&&!Yn(s.context)?u=[s.context,...c]:u=c;let p=await r.call(d,u);return a?p:ph(p)};throw new Ea(`Property not found: ${String(d)}`)}})}i.toService=e;function t(r){return r[0]==="o"&&r[1]==="n"&&Ds(r.charCodeAt(2))}function n(r){return/^onDynamic/.test(r)&&Ds(r.charCodeAt(9))}})(hz||={});var dS="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",y8e=new RegExp(dS);var I8e=j("extensionGalleryService");var C8e=j("extensionManagementService");var S8e=j("IGlobalExtensionEnablementService"),x8e=j("IExtensionTipsService"),_8e=cr("extensions","Extensions"),E8e=cr("preferences","Preferences");var V0=class{telemetryLevel=0;sessionId="someValue.sessionId";machineId="someValue.machineId";sqmId="someValue.sqmId";devDeviceId="someValue.devDeviceId";firstSessionDate="someValue.firstSessionDate";sendErrorTelemetry=!1;publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},r3e=new V0;var w3e=new Jn("pprice.better-merge");var H0=class{_generators=new Map;_cache=new WeakMap;register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){let t=Object.create(null);for(let n of e){let i=this.readActivationEvents(n);i.length>0&&(t[Jn.toKey(n.identifier)]=i)}return t}_readActivationEvents(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];let t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let n=0;n<t.length;n++)t[n]==="onUri"&&(t[n]=`onUri:${Jn.toKey(e.identifier)}`);if(!e.contributes)return t;for(let n in e.contributes){let i=this._generators.get(n);if(!i)continue;let r=e.contributes[n],s=Array.isArray(r)?r:[r];try{i(s,t)}catch(a){We(a)}}return t}},U0=new H0;var fz={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts"},aiTextSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProviderNew.d.ts"},attributableCoverage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.attributableCoverage.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:2},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},chatVariableResolver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribChatParticipantDetection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribChatParticipantDetection.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribIssueReporter:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},createFileSystemWatcher:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},documentPaste:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileComments:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProviderNew.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts"},findFiles2New:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2New.d.ts"},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFilesNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFilesNew.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},lmTools:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.lmTools.d.ts",version:6},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},showLocal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textSearchCompleteNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchCompleteNew.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProviderNew.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},Wf=Object.freeze(fz);var O3e=j("IV8InspectProfilingService"),bz;(t=>{function o(n){return!!(n.samples&&n.timeDeltas)}t.isValidProfile=o;function e(n,i="noAbsolutePaths"){for(let r of n.nodes)r.callFrame&&r.callFrame.url&&(Ld(r.callFrame.url)||/^\w[\w\d+.-]*:\/\/\/?/.test(r.callFrame.url))&&(r.callFrame.url=ym(i,ur(r.callFrame.url)));return n}t.rewriteAbsolutePaths=e})(bz||={});var q3e=j("remoteAuthorityResolverService");var j0=et.as(Wa.JSONContribution);var z0=class o{constructor(e,t){this.added=e;this.removed=t}static _toSet(e){let t=new Tg;for(let n=0,i=e.length;n<i;n++)t.add(e[n].description.identifier);return t}static compute(e,t){if(!e||!e.length)return new o(t,[]);if(!t||!t.length)return new o([],e);let n=this._toSet(e),i=this._toSet(t),r=t.filter(a=>!n.has(a.description.identifier)),s=e.filter(a=>!i.has(a.description.identifier));return new o(r,s)}},K0=class{name;defaultExtensionKind;_handler;_users;_delta;constructor(e,t){this.name=e,this.defaultExtensionKind=t,this._handler=null,this._users=null,this._delta=null}setHandler(e){if(this._handler!==null)throw new Error("Handler already set!");return this._handler=e,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=z0.compute(this._users,e),this._users=e,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(e){We(e)}}},vz={type:"string",enum:["ui","workspace"],enumDescriptions:[h("ui","UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h("workspace","Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]},z2="vscode://schemas/vscode-extensions",G0={properties:{engines:{type:"object",description:h("vscode.extension.engines","Engine compatibility."),properties:{vscode:{type:"string",description:h("vscode.extension.engines.vscode","For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h("vscode.extension.publisher","The publisher of the VS Code extension."),type:"string"},displayName:{description:h("vscode.extension.displayName","The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h("vscode.extension.categories","The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:FN},{type:"string",const:"Languages",deprecationMessage:h("vscode.extension.category.languages.deprecated","Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h("vscode.extension.galleryBanner","Banner used in the VS Code marketplace."),properties:{color:{description:h("vscode.extension.galleryBanner.color","The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h("vscode.extension.galleryBanner.theme","The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h("vscode.extension.contributes","All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h("vscode.extension.preview","Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h("vscode.extension.enableProposedApi.deprecated","Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h("vscode.extension.enabledApiProposals","Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Wf).map(o=>o),markdownEnumDescriptions:Object.values(Wf).map(o=>o.proposal)}},api:{markdownDescription:h("vscode.extension.api","Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h("vscode.extension.api.none","Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h("vscode.extension.activationEvents","Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h("vscode.extension.activationEvents.onWebviewPanel","An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h("vscode.extension.activationEvents.onLanguage","An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h("vscode.extension.activationEvents.onCommand","An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h("vscode.extension.activationEvents.onDebug","An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h("vscode.extension.activationEvents.onDebugInitialConfigurations",'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h("vscode.extension.activationEvents.onDebugDynamicConfigurations",'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h("vscode.extension.activationEvents.onDebugResolve","An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h("vscode.extension.activationEvents.onDebugAdapterProtocolTracker","An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h("vscode.extension.activationEvents.workspaceContains","An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h("vscode.extension.activationEvents.onStartupFinished","An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h("vscode.extension.activationEvents.onTaskType","An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h("vscode.extension.activationEvents.onFileSystem","An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h("vscode.extension.activationEvents.onEditSession","An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h("vscode.extension.activationEvents.onSearch","An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h("vscode.extension.activationEvents.onView","An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h("vscode.extension.activationEvents.onUri","An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h("vscode.extension.activationEvents.onOpenExternalUri","An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h("vscode.extension.activationEvents.onCustomEditor","An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h("vscode.extension.activationEvents.onNotebook","An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h("vscode.extension.activationEvents.onAuthenticationRequest","An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h("vscode.extension.activationEvents.onRenderer","An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h("vscode.extension.activationEvents.onTerminalProfile","An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h("vscode.extension.activationEvents.onTerminalQuickFixRequest","An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h("vscode.extension.activationEvents.onWalkthrough","An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h("vscode.extension.activationEvents.onIssueReporterOpened","An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h("vscode.extension.activationEvents.onChatParticipant","An activation event emitted when the specified chat participant is invoked.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:h("vscode.extension.activationEvents.onLanguageModelTool","An activation event emitted when the specified language model tool is invoked.")},{label:"*",description:h("vscode.extension.activationEvents.star","An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h("vscode.extension.badges","Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h("vscode.extension.badges.url","Badge image URL.")},href:{type:"string",description:h("vscode.extension.badges.href","Badge link.")},description:{type:"string",description:h("vscode.extension.badges.description","Badge description.")}}}},markdown:{type:"string",description:h("vscode.extension.markdown","Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h("vscode.extension.qna","Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:h("vscode.extension.extensionDependencies","Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:dS}},extensionPack:{description:h("vscode.extension.contributes.extensionPack","A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:dS}},extensionKind:{description:h("extensionKind","Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:vz,default:["workspace"],defaultSnippets:[{body:["ui"],description:h("extensionKind.ui","Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h("extensionKind.workspace","Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h("extensionKind.ui-workspace","Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h("extensionKind.workspace-ui","Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h("extensionKind.empty","Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h("vscode.extension.capabilities","Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h("vscode.extension.capabilities.virtualWorkspaces","Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:h("vscode.extension.capabilities.virtualWorkspaces.supported","Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h("vscode.extension.capabilities.virtualWorkspaces.supported.limited","The extension will be enabled in virtual workspaces with some functionality disabled."),h("vscode.extension.capabilities.virtualWorkspaces.supported.true","The extension will be enabled in virtual workspaces with all functionality enabled."),h("vscode.extension.capabilities.virtualWorkspaces.supported.false","The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h("vscode.extension.capabilities.virtualWorkspaces.description","A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h("vscode.extension.capabilities.untrustedWorkspaces","Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h("vscode.extension.capabilities.untrustedWorkspaces.supported","Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h("vscode.extension.capabilities.untrustedWorkspaces.supported.limited","The extension will be enabled in untrusted workspaces with some functionality disabled."),h("vscode.extension.capabilities.untrustedWorkspaces.supported.true","The extension will be enabled in untrusted workspaces with all functionality enabled."),h("vscode.extension.capabilities.untrustedWorkspaces.supported.false","The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h("vscode.extension.capabilities.untrustedWorkspaces.restrictedConfigurations","A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h("vscode.extension.capabilities.untrustedWorkspaces.description","A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h("vscode.extension.contributes.sponsor","Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:h("vscode.extension.contributes.sponsor.url","URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h("vscode.extension.scripts.prepublish","Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h("vscode.extension.scripts.uninstall","Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h("vscode.extension.icon","The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h({key:"vscode.extension.l10n",comment:['{Locked="bundle.l10n._locale_.json"}','{Locked="vscode.l10n API"}']},"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h("vscode.extension.pricing","The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}},$0=class{_extensionPoints=new Map;registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);let t=new K0(e.extensionPoint,e.defaultExtensionKind);return this._extensionPoints.set(e.extensionPoint,t),e.activationEventsGenerator&&U0.register(e.extensionPoint,e.activationEventsGenerator),G0.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,j0.registerSchema(z2,G0),t}getExtensionPoints(){return Array.from(this._extensionPoints.values())}},K2={ExtensionsRegistry:"ExtensionsRegistry"};et.add(K2.ExtensionsRegistry,new $0);var P6e=et.as(K2.ExtensionsRegistry);j0.registerSchema(z2,G0);j0.registerSchema(m2,{properties:{extensionEnabledApiProposals:{description:h("product.extensionEnabledApiProposals","API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Wf),markdownEnumDescriptions:Object.values(Wf).map(o=>o.proposal)}}]}}}});var cKe=Object.freeze({identifier:new Jn("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:le.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1});var cS=j("extensionService");var q0="keybinding.entry.template",G2=h("default","System"),$2=h("extension","Extension"),j2=h("user","User");var yz=Hu(Jd,Ul,ey),Iz=/@command:\s*([^\+]+)/i,Cz=/\+when:\s*(.+)/i,q2=/@source:\s*(user|default|system|extension)/i,Y2=/@ext:\s*((".+")|([^\s]+))/i,Sz=/@keybinding:\s*((\".+\")|(\S+))/i,wi=class extends ia{constructor(t,n,i){super();this.keybindingsService=n;this.extensionService=i;this._keybindingItems=[],this._keybindingItemsSortedByPrecedence=[],this.modifierLabels={ui:Bf.modifierLabels[t],aria:F2.modifierLabels[t],user:B2.modifierLabels[t]}}_keybindingItems;_keybindingItemsSortedByPrecedence;modifierLabels;fetch(t,n=!1){let i=n?this._keybindingItemsSortedByPrecedence:this._keybindingItems,r=Iz.exec(t);if(r&&r[1]){let s=r[1].trim(),a=i.filter(l=>l.command===s);if(a.length){let l=Cz.exec(t);if(l&&l[1]){let d=l[1].trim();a=this.filterByWhen(a,s,d)}}return a.map(l=>({id:wi.getId(l),keybindingItem:l,templateId:q0}))}if(q2.test(t))i=this.filterBySource(i,t),t=t.replace(q2,"");else{let s=Y2.exec(t);if(s&&(s[2]||s[3])){let a=s[2]?s[2].substring(1,s[2].length-1):s[3];i=this.filterByExtension(i,a),t=t.replace(Y2,"")}else{let a=Sz.exec(t);a&&(a[2]||a[3])&&(t=a[2]||`"${a[3]}"`)}}return t=t.trim(),t?this.filterByText(i,t):i.map(s=>({id:wi.getId(s),keybindingItem:s,templateId:q0}))}filterBySource(t,n){return/@source:\s*default/i.test(n)||/@source:\s*system/i.test(n)?t.filter(i=>i.source===G2):/@source:\s*user/i.test(n)?t.filter(i=>i.source===j2):/@source:\s*extension/i.test(n)?t.filter(i=>!Lt(i.source)||i.source===$2):t}filterByExtension(t,n){return n=n.toLowerCase().trim(),t.filter(i=>!Lt(i.source)&&(Jn.equals(i.source.identifier,n)||i.source.displayName?.toLowerCase()===n.toLowerCase()))}filterByText(t,n){let i=n.charAt(0)==='"',r=n.charAt(n.length-1)==='"',s=i&&r;i&&(n=n.substring(1)),r&&(n=n.substring(0,n.length-1)),n=n.trim();let a=[],l=n.split(" "),d=this.splitKeybindingWords(l);for(let c of t){let u=new Y0(this.modifierLabels,c,n,l,d,s);(u.commandIdMatches||u.commandLabelMatches||u.commandDefaultLabelMatches||u.sourceMatches||u.whenMatches||u.keybindingMatches||u.extensionIdMatches||u.extensionLabelMatches)&&a.push({id:wi.getId(c),templateId:q0,commandLabelMatches:u.commandLabelMatches||void 0,commandDefaultLabelMatches:u.commandDefaultLabelMatches||void 0,keybindingItem:c,keybindingMatches:u.keybindingMatches||void 0,commandIdMatches:u.commandIdMatches||void 0,sourceMatches:u.sourceMatches||void 0,whenMatches:u.whenMatches||void 0,extensionIdMatches:u.extensionIdMatches||void 0,extensionLabelMatches:u.extensionLabelMatches||void 0})}return a}filterByWhen(t,n,i){if(t.length===0)return[];let r=t.filter(d=>d.when===i);if(r.length)return r;let s=t[0].commandLabel,a=new uf(void 0,n,null,De.deserialize(i),!1,null,!1),l=new Map([[n,s]]);return[wi.toKeybindingEntry(n,a,l,this.getExtensionsMapping())]}splitKeybindingWords(t){let n=[];for(let i of t)n.push(...xs(i.split("+")));return n}async resolve(t=new Map){let n=this.getExtensionsMapping();this._keybindingItemsSortedByPrecedence=[];let i=new Map;for(let s of this.keybindingsService.getKeybindings())s.command&&(this._keybindingItemsSortedByPrecedence.push(wi.toKeybindingEntry(s.command,s,t,n)),i.set(s.command,!0));let r=this.keybindingsService.getDefaultKeybindings().map(s=>s.command);for(let s of W2(i)){let a=new uf(void 0,s,null,void 0,r.indexOf(s)===-1,null,!1);this._keybindingItemsSortedByPrecedence.push(wi.toKeybindingEntry(s,a,t,n))}return this._keybindingItemsSortedByPrecedence=dr(this._keybindingItemsSortedByPrecedence,s=>wi.getId(s)),this._keybindingItems=this._keybindingItemsSortedByPrecedence.slice(0).sort((s,a)=>wi.compareKeybindingData(s,a)),super.resolve()}static getId(t){return t.command+(t?.keybinding?.getAriaLabel()??"")+t.when+(Lt(t.source)?t.source:t.source.identifier.value)}getExtensionsMapping(){let t=new Lg;for(let n of this.extensionService.extensions)t.set(n.identifier,n);return t}static compareKeybindingData(t,n){return t.keybinding&&!n.keybinding?-1:n.keybinding&&!t.keybinding?1:t.commandLabel&&!n.commandLabel?-1:n.commandLabel&&!t.commandLabel?1:t.commandLabel&&n.commandLabel&&t.commandLabel!==n.commandLabel?t.commandLabel.localeCompare(n.commandLabel):t.command===n.command?t.keybindingItem.isDefault?1:-1:t.command.localeCompare(n.command)}static toKeybindingEntry(t,n,i,r){let s=Qu.getCommand(t),a=i.get(t),l=j2;if(n.isDefault){let d=n.extensionId??(n.resolvedKeybinding?void 0:s?.source?.id);l=d?r.get(d)??$2:G2}return{keybinding:n.resolvedKeybinding,keybindingItem:n,command:t,commandLabel:wi.getCommandLabel(s,a),commandDefaultLabel:wi.getCommandDefaultLabel(s),when:n.when?n.when.serialize():"",source:l}}static getCommandDefaultLabel(t){if(!yE.isDefaultVariant()&&t&&t.title&&t.title.original){let n=t.category?t.category.original:void 0,i=t.title.original;return n?h("cat.title","{0}: {1}",n,i):i}return null}static getCommandLabel(t,n){if(t){let i=t.category?typeof t.category=="string"?t.category:t.category.value:void 0,r=typeof t.title=="string"?t.title:t.title.value;return i?h("cat.title","{0}: {1}",i,r):r}return n||""}};wi=K([D(1,Oo),D(2,cS)],wi);var Y0=class{constructor(e,t,n,i,r,s){this.modifierLabels=e;s||(this.commandIdMatches=this.matches(n,t.command,Hu(Ul,ig),i),this.commandLabelMatches=t.commandLabel?this.matches(n,t.commandLabel,(a,l)=>Ul(a,t.commandLabel,!0),i):null,this.commandDefaultLabelMatches=t.commandDefaultLabel?this.matches(n,t.commandDefaultLabel,(a,l)=>Ul(a,t.commandDefaultLabel,!0),i):null,this.whenMatches=t.when?this.matches(null,t.when,Hu(Ul,ig),i):null,Lt(t.source)?this.sourceMatches=this.matches(n,t.source,(a,l)=>Ul(a,t.source,!0),i):this.extensionLabelMatches=t.source.displayName?this.matches(n,t.source.displayName,(a,l)=>Ul(a,t.commandLabel,!0),i):null),this.keybindingMatches=t.keybinding?this.matchesKeybinding(t.keybinding,n,r,s):null}commandIdMatches=null;commandLabelMatches=null;commandDefaultLabelMatches=null;sourceMatches=null;whenMatches=null;keybindingMatches=null;extensionIdMatches=null;extensionLabelMatches=null;matches(e,t,n,i){let r=e?yz(e,t):null;return r||(r=this.matchesWords(i,t,n)),r&&(r=this.filterAndSort(r)),r}matchesWords(e,t,n){let i=[];for(let r of e){let s=n(r,t);if(s)i=[...i||[],...s];else{i=null;break}}return i}filterAndSort(e){return dr(e,t=>t.start+"."+t.end).filter(t=>!e.some(n=>!(n.start===t.start&&n.end===t.end)&&n.start<=t.start&&n.end>=t.end)).sort((t,n)=>t.start-n.start)}matchesKeybinding(e,t,n,i){let[r,s]=e.getChords(),a=e.getUserSettingsLabel(),l=e.getAriaLabel(),d=e.getLabel();if(a&&Co(t,a)===0||l&&Co(t,l)===0||d&&Co(t,d)===0)return{firstPart:this.createCompleteMatch(r),chordPart:this.createCompleteMatch(s)};let c={},u={},p=[],m=[],f=[],g=!0;for(let b=0;b<n.length;b++){let v=n[b],I=!1,C=!1;g=g&&!c.keyCode;let S=!u.keyCode;if(g&&(I=this.matchPart(r,c,v,i),c.keyCode)){for(let _ of f)m.indexOf(_)===-1&&p.splice(p.indexOf(_),1);u={},f=[],S=!1}S&&(C=this.matchPart(s,u,v,i)),I&&m.push(b),C&&f.push(b),(I||C)&&p.push(b),g=g&&this.isModifier(v)}return p.length!==n.length||i&&(!this.isCompleteMatch(r,c)||!xv(u)&&!this.isCompleteMatch(s,u))?null:this.hasAnyMatch(c)||this.hasAnyMatch(u)?{firstPart:c,chordPart:u}:null}matchPart(e,t,n,i){let r=!1;return this.matchesMetaModifier(e,n)&&(r=!0,t.metaKey=!0),this.matchesCtrlModifier(e,n)&&(r=!0,t.ctrlKey=!0),this.matchesShiftModifier(e,n)&&(r=!0,t.shiftKey=!0),this.matchesAltModifier(e,n)&&(r=!0,t.altKey=!0),this.matchesKeyCode(e,n,i)&&(t.keyCode=!0,r=!0),r}matchesKeyCode(e,t,n){if(!e)return!1;let i=e.keyAriaLabel||"";if(n||i.length===1||t.length===1){if(Co(i,t)===0)return!0}else if(ey(t,i))return!0;return!1}matchesMetaModifier(e,t){return!e||!e.metaKey?!1:this.wordMatchesMetaModifier(t)}matchesCtrlModifier(e,t){return!e||!e.ctrlKey?!1:this.wordMatchesCtrlModifier(t)}matchesShiftModifier(e,t){return!e||!e.shiftKey?!1:this.wordMatchesShiftModifier(t)}matchesAltModifier(e,t){return!e||!e.altKey?!1:this.wordMatchesAltModifier(t)}hasAnyMatch(e){return!!e.altKey||!!e.ctrlKey||!!e.metaKey||!!e.shiftKey||!!e.keyCode}isCompleteMatch(e,t){return e?!(!t.keyCode||e.metaKey&&!t.metaKey||e.altKey&&!t.altKey||e.ctrlKey&&!t.ctrlKey||e.shiftKey&&!t.shiftKey):!0}createCompleteMatch(e){let t={};return e&&(t.keyCode=!0,e.metaKey&&(t.metaKey=!0),e.altKey&&(t.altKey=!0),e.ctrlKey&&(t.ctrlKey=!0),e.shiftKey&&(t.shiftKey=!0)),t}isModifier(e){return!!(this.wordMatchesAltModifier(e)||this.wordMatchesCtrlModifier(e)||this.wordMatchesMetaModifier(e)||this.wordMatchesShiftModifier(e))}wordMatchesAltModifier(e){return!!(qt(this.modifierLabels.ui.altKey,e)||qt(this.modifierLabels.aria.altKey,e)||qt(this.modifierLabels.user.altKey,e)||qt(h("option","option"),e))}wordMatchesCtrlModifier(e){return!!(qt(this.modifierLabels.ui.ctrlKey,e)||qt(this.modifierLabels.aria.ctrlKey,e)||qt(this.modifierLabels.user.ctrlKey,e))}wordMatchesMetaModifier(e){return!!(qt(this.modifierLabels.ui.metaKey,e)||qt(this.modifierLabels.aria.metaKey,e)||qt(this.modifierLabels.user.metaKey,e)||qt(h("meta","meta"),e))}wordMatchesShiftModifier(e){return!!(qt(this.modifierLabels.ui.shiftKey,e)||qt(this.modifierLabels.aria.shiftKey,e)||qt(this.modifierLabels.user.shiftKey,e))}};var xz=or("keybindings-editor-label-icon",ue.keyboard,h("keybindingsEditorLabelIcon","Icon of the keybindings editor label.")),il=class extends lo{static ID="workbench.input.keybindings";keybindingsModel;searchOptions=null;resource=void 0;constructor(e){super(),this.keybindingsModel=e.createInstance(wi,fo)}get typeId(){return il.ID}getName(){return h("keybindingsInputName","Keyboard Shortcuts")}getIcon(){return xz}async resolve(){return this.keybindingsModel}matches(e){return e instanceof il}dispose(){this.keybindingsModel.dispose(),super.dispose()}};il=K([D(0,dt)],il);var _z=or("settings-editor-label-icon",ue.settings,h("settingsEditorLabelIcon","Icon of the settings editor label.")),ol=class extends lo{static ID="workbench.input.settings2";_settingsModel;resource=le.from({scheme:Ie.vscodeSettings,path:"settingseditor"});constructor(e){super(),this._settingsModel=e.createSettings2EditorModel()}matches(e){return super.matches(e)||e instanceof ol}get typeId(){return ol.ID}getName(){return h("settingsEditor2InputName","Settings")}getIcon(){return _z}async resolve(){return this._settingsModel}dispose(){this._settingsModel.dispose(),super.dispose()}};ol=K([D(0,lS)],ol);var Ez="diagnosticsService",OGe=j(Ez);var wz;(s=>{s.enableDiagnostics=!1,s.records=[];let t=new WeakMap,n=0;function i(a,l){if(!t.has(a)){let d=String(++n);t.set(a,d)}return t.get(a)}function r(a,l,d,c){}s.traceSocketEvent=r})(wz||={});var n$e=j("remoteSocketFactoryService");var Tz="signService",r$e=j(Tz);var A$e=30*1e3;var gh=j("remoteAgentService"),nje=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(o){let e=1/0;for(let n=0;n<this.maxSampleCount;n++){let i=await o.getRoundTripTime();if(i===void 0)return;e=Math.min(e,i/2),await pr(this.sampleDelay)}this.average.push(e),this.average.length>this.maxAverageCount&&this.average.shift();let t;return this.initial.length<this.maxInitialCount?this.initial.push(e):t=this.initial.reduce((n,i)=>n+i,0)/this.initial.length,this.lastMeasurement={initial:t,current:e,average:this.average.reduce((n,i)=>n+i,0)/this.average.length,high:typeof t>"u"?!1:e>this.highLatencyMaxThreshold||e>this.highLatencyMinThreshold&&e>t*this.highLatencyMultiple},this.lastMeasurement}};var fh=class extends ia{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}constructor(e,t){super(),this._originalModel=e,this._modifiedModel=t}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}};var uS=class extends fh{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}_textDiffEditorModel=void 0;get textDiffEditorModel(){return this._textDiffEditorModel}constructor(e,t){super(e,t),this._originalModel=e,this._modifiedModel=t,this.updateTextDiffEditorModel()}async resolve(){await super.resolve(),this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this._textDiffEditorModel?(this._textDiffEditorModel.original=this.originalModel.textEditorModel,this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel):this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0,super.dispose()}};var rl=class extends Un{constructor(t,n,i,r,s,a){super(t,n,i,r,a);this.original=i;this.modified=r;this.forceOpenAsBinary=s}static ID="workbench.editors.diffEditorInput";get typeId(){return rl.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let t=super.capabilities;return this.labels.forceDescription&&(t|=64),t}cachedModel=void 0;labels=this.computeLabels();computeLabels(){let t,n=!1;if(this.preferredName)t=this.preferredName;else{let u=this.original.getName(),p=this.modified.getName();t=h("sideBySideLabels","{0} \u2194 {1}",u,p),n=u===p}let i,r,s;if(this.preferredDescription)i=this.preferredDescription,r=this.preferredDescription,s=this.preferredDescription;else{i=this.computeLabel(this.original.getDescription(0),this.modified.getDescription(0)),s=this.computeLabel(this.original.getDescription(2),this.modified.getDescription(2));let u=this.original.getDescription(1),p=this.modified.getDescription(1);if(typeof u=="string"&&typeof p=="string"&&(u||p)){let[m,f]=h2([u,p]);r=this.computeLabel(m,f)}}let a=this.computeLabel(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),l=this.computeLabel(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),d=this.computeLabel(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 "),c=this.getPreferredTitle();return c&&(a=`${c} (${a})`,l=`${c} (${l})`,d=`${c} (${d})`),{name:t,shortDescription:i,mediumDescription:r,longDescription:s,forceDescription:n,shortTitle:a,mediumTitle:l,longTitle:d}}computeLabel(t,n,i=" - "){if(!(!t||!n))return t===n?n:`${t}${i}${n}`}getName(){return this.labels.name}getDescription(t=1){switch(t){case 0:return this.labels.shortDescription;case 2:return this.labels.longDescription;case 1:default:return this.labels.mediumDescription}}getTitle(t){switch(t){case 0:return this.labels.shortTitle;case 2:return this.labels.longTitle;default:case 1:return this.labels.mediumTitle}}async resolve(){let t=await this.createModel();return this.cachedModel?.dispose(),this.cachedModel=t,this.cachedModel}prefersEditorPane(t){return this.forceOpenAsBinary?t.find(n=>n.typeId===N2):t.find(n=>n.typeId===P2)}async createModel(){let[t,n]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return n instanceof rr&&t instanceof rr?new uS(t,n):new fh(c1(t)?t:void 0,c1(n)?n:void 0)}toUntyped(t){let n=super.toUntyped(t);if(n)return{...n,modified:n.primary,original:n.secondary}}matches(t){return this===t?!0:t instanceof rl?this.modified.matches(t.modified)&&this.original.matches(t.original)&&t.forceOpenAsBinary===this.forceOpenAsBinary:sr(t)?this.modified.matches(t.modified)&&this.original.matches(t.original):!1}dispose(){this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=void 0),super.dispose()}};rl=K([D(5,Ei)],rl);var ma=class extends V{constructor(t,n){super();this.configurationService=t;this.workspaceContextService=n;this.storeEnablementState(),this.storeCustomPatterns(),this.registerListeners()}_serviceBrand;static SETTING_ID_PATTERNS="workbench.editor.customLabels.patterns";static SETTING_ID_ENABLED="workbench.editor.customLabels.enabled";_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;patterns=[];enabled=!0;cache=new qb(1e3);registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration(ma.SETTING_ID_ENABLED)){let n=this.enabled;this.storeEnablementState(),n!==this.enabled&&this.patterns.length>0&&this._onDidChange.fire()}else t.affectsConfiguration(ma.SETTING_ID_PATTERNS)&&(this.cache.clear(),this.storeCustomPatterns(),this._onDidChange.fire())}))}storeEnablementState(){this.enabled=this.configurationService.getValue(ma.SETTING_ID_ENABLED)}_templateRegexValidation=/[a-zA-Z0-9]/;storeCustomPatterns(){this.patterns=[];let t=this.configurationService.getValue(ma.SETTING_ID_PATTERNS);for(let n in t){let i=t[n];if(!this._templateRegexValidation.test(i))continue;let r=Ld(n),s=_g(n);this.patterns.push({pattern:n,template:i,isAbsolutePath:r,parsedPattern:s})}this.patterns.sort((n,i)=>this.patternWeight(i.pattern)-this.patternWeight(n.pattern))}patternWeight(t){let n=0;for(let i of t.split("/"))i==="**"?n+=1:i==="*"?n+=10:i.includes("*")||i.includes("?")?n+=50:i!==""&&(n+=100);return n}getName(t){if(!this.enabled||this.patterns.length===0)return;let n=t.toString(),i=this.cache.get(n);if(i!==void 0)return i??void 0;let r=this.applyPatterns(t);return this.cache.set(n,r??null),r}applyPatterns(t){let n=this.workspaceContextService.getWorkspaceFolder(t),i;for(let r of this.patterns){let s;if(n&&!r.isAbsolutePath?(i||(i=Lv(Ms(n.uri),t)??t.path),s=i):s=t.path,r.parsedPattern(s))return this.applyTemplate(r.template,t,s)}}_parsedTemplateExpression=/\$\{(dirname|filename|extname|extname\((?<extnameN>[-+]?\d+)\)|dirname\((?<dirnameN>[-+]?\d+)\))\}/g;_filenameCaptureExpression=/(?<filename>^\.*[^.]*)/;applyTemplate(t,n,i){let r;return t.replace(this._parsedTemplateExpression,(s,a,...l)=>{r=r??ZR(n.path);let{dirnameN:d="0",extnameN:c="0"}=l.pop();if(a==="filename"){let{filename:u}=this._filenameCaptureExpression.exec(r.base)?.groups??{};if(u)return u}else if(a==="extname"){let u=this.getExtnames(r.base);if(u)return u}else if(a.startsWith("extname")){let u=parseInt(c),p=this.getNthExtname(r.base,u);if(p)return p}else if(a.startsWith("dirname")){let u=parseInt(d),p=this.getNthDirname(gu(i),u);if(p)return p}return s})}removeLeadingDot(t){let n=t;for(;n.startsWith(".");)n=n.slice(1);return n}getNthDirname(t,n){t=t.startsWith("/")?t.slice(1):t;let i=t.split("/");return this.getNthFragment(i,n)}getExtnames(t){return this.removeLeadingDot(t).split(".").slice(1).join(".")}getNthExtname(t,n){let i=this.removeLeadingDot(t).split(".");return i.shift(),this.getNthFragment(i,n)}getNthFragment(t,n){let i=t.length,r;n<0?r=Math.abs(n)-1:r=i-n-1;let s=t[r];if(!(s===void 0||s===""))return s}};ma=K([D(0,Xt),D(1,to)],ma);var ud=j("ICustomEditorLabelService");Cn(ud,ma,1);var bh=class extends lo{constructor(t,n,i,r,s,a,l){super();this.resource=t;this.labelService=i;this.fileService=r;this.filesConfigurationService=s;this.textResourceConfigurationService=a;this.customEditorLabelService=l;this._preferredResource=n||t,this.registerListeners()}get capabilities(){let t=32;return this.fileService.hasProvider(this.resource)?this.filesConfigurationService.isReadonly(this.resource)&&(t|=2):t|=4,t&2||(t|=128),t}_preferredResource;get preferredResource(){return this._preferredResource}registerListeners(){this._register(this.labelService.onDidChangeFormatters(t=>this.onLabelEvent(t.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(t=>this.onLabelEvent(t.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(t=>this.onLabelEvent(t.scheme))),this._register(this.customEditorLabelService.onDidChange(()=>this.updateLabel()))}onLabelEvent(t){t===this._preferredResource.scheme&&this.updateLabel()}updateLabel(){this._name=void 0,this._shortDescription=void 0,this._mediumDescription=void 0,this._longDescription=void 0,this._shortTitle=void 0,this._mediumTitle=void 0,this._longTitle=void 0,this._onDidChangeLabel.fire()}setPreferredResource(t){Xi(t,this._preferredResource)||(this._preferredResource=t,this.updateLabel())}_name=void 0;getName(){return typeof this._name!="string"&&(this._name=this.customEditorLabelService.getName(this._preferredResource)??this.labelService.getUriBasenameLabel(this._preferredResource)),this._name}getDescription(t=1){switch(t){case 0:return this.shortDescription;case 2:return this.longDescription;case 1:default:return this.mediumDescription}}_shortDescription=void 0;get shortDescription(){return typeof this._shortDescription!="string"&&(this._shortDescription=this.labelService.getUriBasenameLabel(Ms(this._preferredResource))),this._shortDescription}_mediumDescription=void 0;get mediumDescription(){return typeof this._mediumDescription!="string"&&(this._mediumDescription=this.labelService.getUriLabel(Ms(this._preferredResource),{relative:!0})),this._mediumDescription}_longDescription=void 0;get longDescription(){return typeof this._longDescription!="string"&&(this._longDescription=this.labelService.getUriLabel(Ms(this._preferredResource))),this._longDescription}_shortTitle=void 0;get shortTitle(){return typeof this._shortTitle!="string"&&(this._shortTitle=this.getName()),this._shortTitle}_mediumTitle=void 0;get mediumTitle(){return typeof this._mediumTitle!="string"&&(this._mediumTitle=this.labelService.getUriLabel(this._preferredResource,{relative:!0})),this._mediumTitle}_longTitle=void 0;get longTitle(){return typeof this._longTitle!="string"&&(this._longTitle=this.labelService.getUriLabel(this._preferredResource)),this._longTitle}getTitle(t){switch(t){case 0:return this.shortTitle;case 2:return this.longTitle;default:case 1:return this.mediumTitle}}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource)}ensureLimits(t){if(t?.limits)return t.limits;let n=sF(this.resource),i,r=this.textResourceConfigurationService.inspect(this.resource,null,"workbench.editorLargeFileConfirmation");return sN(r)&&(i=r.value*sd.MB),{size:i??n}}};bh=K([D(2,Ao),D(3,ii),D(4,ha),D(5,cs),D(6,ud)],bh);var vh=class extends rr{constructor(e,t,n,i,r){super(n,t,i,r,e)}dispose(){this.textEditorModelHandle&&this.modelService.destroyModel(this.textEditorModelHandle),super.dispose()}};vh=K([D(1,Hi),D(2,rs),D(3,Up),D(4,Vi)],vh);var zc=class extends bh{constructor(t,n,i,r,s,a,l,d,c){super(t,n,s,a,l,d,c);this.editorService=i;this.textFileService=r}save(t,n){return this.resource.scheme!==Ie.untitled&&!this.fileService.hasProvider(this.resource)?this.saveAs(t,n):this.doSave(n,!1,t)}saveAs(t,n){return this.doSave(n,!0,t)}async doSave(t,n,i){let r;if(n?r=await this.textFileService.saveAs(this.resource,void 0,{...t,suggestedTarget:this.preferredResource}):r=await this.textFileService.save(this.resource,t),!!r)return{resource:r}}async revert(t,n){await this.textFileService.revert(this.resource,n)}};zc=K([D(2,Ei),D(3,nl),D(4,Ao),D(5,ii),D(6,ha),D(7,cs),D(8,ud)],zc);var ga=class extends zc{constructor(t,n,i,r,s,a,l,d,c,u,p,m,f){super(t,void 0,d,l,u,c,p,m,f);this.name=n;this.description=i;this.preferredLanguageId=r;this.preferredContents=s;this.textModelService=a}static ID="workbench.editors.resourceEditorInput";get typeId(){return ga.ID}get editorId(){return xr.id}cachedModel=void 0;modelReference=void 0;getName(){return this.name||super.getName()}setName(t){this.name!==t&&(this.name=t,this._onDidChangeLabel.fire())}getDescription(){return this.description}setDescription(t){this.description!==t&&(this.description=t,this._onDidChangeLabel.fire())}setLanguageId(t,n){this.setPreferredLanguageId(t),this.cachedModel?.setLanguageId(t,n)}setPreferredLanguageId(t){this.preferredLanguageId=t}setPreferredContents(t){this.preferredContents=t}async resolve(){let t=this.preferredContents,n=this.preferredLanguageId;this.preferredContents=void 0,this.preferredLanguageId=void 0,this.modelReference||(this.modelReference=this.textModelService.createModelReference(this.resource));let i=await this.modelReference,r=i.object;if(!(r instanceof vh))throw i.dispose(),this.modelReference=void 0,new Error(`Unexpected model for TextResourceEditorInput: ${this.resource}`);return this.cachedModel=r,(typeof t=="string"||typeof n=="string")&&r.updateTextEditorModel(typeof t=="string"?wf(t):void 0,n),r}matches(t){return this===t?!0:t instanceof ga?Xi(t.resource,this.resource):QC(t)?super.matches(t):!1}dispose(){this.modelReference&&(this.modelReference.then(t=>t.dispose()),this.modelReference=void 0),this.cachedModel=void 0,super.dispose()}};ga=K([D(5,qa),D(6,nl),D(7,Ei),D(8,ii),D(9,Ao),D(10,ha),D(11,cs),D(12,ud)],ga);var pS=tr;function X2(o){return o.scheme!==Ie.file&&o.scheme!==Ie.vscodeRemote}function Lz(o){if(o.folders.length)return o.folders.every(e=>X2(e.uri))?o.folders[0].uri:void 0;if(o.configuration&&X2(o.configuration))return o.configuration}function Z2(o){return Lz(o)?.scheme}var Q2=j("pathService"),yh=class{constructor(e,t,n,i){this.localUserHome=e;this.remoteAgentService=t;this.environmentService=n;this.contextService=i;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||fo)(),this.resolveUserHome=(async()=>{let r=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=r?.userHome??e})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(e,t,n){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(i=>this.doHasValidBasename(e,i,t)):this.doHasValidBasename(e,t,n)}doHasValidBasename(e,t,n){return e.scheme===Ie.file||e.scheme===Ie.vscodeRemote?HM(n??Qo(e),t===1):!0}get defaultUriScheme(){return yh.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return Ie.vscodeRemote;let n=Z2(t.getWorkspace());if(n)return n;let i=t.getWorkspace().folders[0];if(i)return i.uri.scheme;let r=t.getWorkspace().configuration;return r?r.scheme:Ie.file}userHome(e){return e?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?on:rt)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){let i=e.indexOf("/",2);i===-1?(t=e.substring(2),e="/"):(t=e.substring(2,i),e=e.substring(i)||"/")}return le.from({scheme:Ie.file,authority:t,path:e,query:"",fragment:""})}};yh=K([D(1,gh),D(2,pS),D(3,to)],yh);var fa=class extends zc{constructor(t,n,i,r,s,a,l,d,c,u,p){super(t.resource,void 0,r,n,i,s,d,u,p);this.model=t;this.environmentService=a;this.pathService=l;this.textModelService=c;this.registerModelListeners(t),this._register(this.textFileService.untitled.onDidCreate(m=>this.onDidCreateUntitledModel(m)))}static ID="workbench.editors.untitledEditorInput";get typeId(){return fa.ID}get editorId(){return xr.id}modelResolve=void 0;modelDisposables=this._register(new ae);cachedUntitledTextEditorModelReference=void 0;registerModelListeners(t){this.modelDisposables.clear(),this.modelDisposables.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this.modelDisposables.add(t.onDidChangeName(()=>this._onDidChangeLabel.fire())),this.modelDisposables.add(t.onDidRevert(()=>this.dispose()))}onDidCreateUntitledModel(t){Xi(t.resource,this.model.resource)&&t!==this.model&&(this.model=t,this.registerModelListeners(t))}getName(){return this.model.name}getDescription(t=1){if(!this.model.hasAssociatedFilePath){let n=this.resource.path;return n!==this.getName()?n:void 0}return super.getDescription(t)}getTitle(t){if(!this.model.hasAssociatedFilePath){let n=this.getName(),i=this.getDescription();return i&&i!==n?`${n} \u2022 ${i}`:n}return super.getTitle(t)}isDirty(){return this.model.isDirty()}getEncoding(){return this.model.getEncoding()}setEncoding(t,n){return this.model.setEncoding(t)}get hasLanguageSetExplicitly(){return this.model.hasLanguageSetExplicitly}get hasAssociatedFilePath(){return this.model.hasAssociatedFilePath}setLanguageId(t,n){this.model.setLanguageId(t,n)}getLanguageId(){return this.model.getLanguageId()}async resolve(){return this.modelResolve||(this.modelResolve=(async()=>{this.cachedUntitledTextEditorModelReference=await this.textModelService.createModelReference(this.resource)})()),await this.modelResolve,this.isDisposed()&&this.disposeModelReference(),this.model}toUntyped(t){let n={resource:this.model.hasAssociatedFilePath?$M(this.model.resource,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme):this.resource,forceUntitled:!0,options:{override:this.editorId}};return typeof t?.preserveViewState=="number"&&(n.encoding=this.getEncoding(),n.languageId=this.getLanguageId(),n.contents=this.model.isModified()?this.model.textEditorModel?.getValue():void 0,n.options.viewState=nh(this,t.preserveViewState,this.editorService),typeof n.contents=="string"&&!this.model.hasAssociatedFilePath&&!t.preserveResource&&(n.resource=void 0)),n}matches(t){return this===t?!0:t instanceof fa?Xi(t.resource,this.resource):O2(t)?super.matches(t):!1}dispose(){this.modelResolve=void 0,this.disposeModelReference(),super.dispose()}disposeModelReference(){yt(this.cachedUntitledTextEditorModelReference),this.cachedUntitledTextEditorModelReference=void 0}};fa=K([D(1,nl),D(2,Ao),D(3,Ei),D(4,ii),D(5,pS),D(6,Q2),D(7,ha),D(8,qa),D(9,cs),D(10,ud)],fa);var J2=j("lifecycleService");var eB=j("editorPaneService");var iB;(e=>e.Workbench="workbench.contributions.kind")(iB||={});var Kc=(i=>(i[i.BlockStartup=1]="BlockStartup",i[i.BlockRestore=2]="BlockRestore",i[i.AfterRestored=3]="AfterRestored",i[i.Eventually=4]="Eventually",i))(Kc||{});function tB(o){let e=o;return!!e&&typeof e.editorTypeId=="string"}function Dz(o){switch(o){case 3:return Kc.AfterRestored;case 4:return Kc.Eventually}}function nB(o){switch(o){case Kc.BlockStartup:return 1;case Kc.BlockRestore:return 2;case Kc.AfterRestored:return 3;case Kc.Eventually:return 4}}var Gc=class o extends V{static INSTANCE=new o;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new ae);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new Ps;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(e,t,n){let i={id:e,ctor:t};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof n=="number"&&this.lifecycleService.phase>=n||typeof e=="string"&&tB(n)&&this.editorPaneService.didInstantiateEditorPane(n.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,i,typeof n=="number"?nB(n):this.lifecycleService.phase):(typeof n=="number"&&Cm(this.contributionsByPhase,nB(n),[]).push(i),typeof e=="string"&&(this.contributionsById.has(e)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${e}'`):this.contributionsById.set(e,i),tB(n)&&Cm(this.contributionsByEditor,n.editorTypeId,[]).push(i)))}registerWorkbenchContribution(e,t){this.registerWorkbenchContribution2(void 0,e,Dz(t))}getWorkbenchContribution(e){if(this.instancesById.has(e))return this.instancesById.get(e);let t=this.instantiationService,n=this.lifecycleService,i=this.logService,r=this.environmentService;if(!t||!n||!i||!r)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): cannot be called before registry started`);let s=this.contributionsById.get(e);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution with that identifier is unknown.`);n.phase<3&&i.warn(`IWorkbenchContributionsRegistry#getContribution('${e}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(t,i,r,s,n.phase);let a=this.instancesById.get(e);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${e}'): failed to create contribution.`);return a}start(e){let t=this.instantiationService=e.get(dt),n=this.lifecycleService=e.get(J2),i=this.logService=e.get(xn),r=this.environmentService=e.get(tr),s=this.editorPaneService=e.get(eB);this._register(n.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(t,n,i,r,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,t,n,i,r);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,t,n,i,r)))}onEditor(e,t,n,i,r){let s=this.contributionsByEditor.get(e);if(s){this.contributionsByEditor.delete(e);for(let a of s)this.safeCreateContribution(t,i,r,a,n.phase)}}instantiateByPhase(e,t,n,i,r){t.phase>=r?this.doInstantiateByPhase(e,n,i,r):t.when(r).then(()=>this.doInstantiateByPhase(e,n,i,r))}async doInstantiateByPhase(e,t,n,i){let r=this.contributionsByPhase.get(i);if(r)switch(this.contributionsByPhase.delete(i),i){case 1:case 2:{us(`code/willCreateWorkbenchContributions/${i}`);for(let s of r)this.safeCreateContribution(e,t,n,s,i);us(`code/didCreateWorkbenchContributions/${i}`);break}case 3:case 4:{i===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(r,e,t,n,i);break}}}doInstantiateWhenIdle(e,t,n,i,r){us(`code/willCreateWorkbenchContributions/${r}`);let s=0,a=r===4?3e3:500,l=d=>{for(;s<e.length;){let c=e[s++];if(this.safeCreateContribution(t,n,i,c,r),d.timeRemaining()<1){Ol(l,a);break}}s===e.length&&(us(`code/didCreateWorkbenchContributions/${r}`),r===3&&this.pendingRestoredContributions.complete())};Ol(l,a)}safeCreateContribution(e,t,n,i,r){if(typeof i.id=="string"&&this.instancesById.has(i.id))return;let s=Date.now();try{typeof i.id=="string"&&us(`code/willCreateWorkbenchContribution/${r}/${i.id}`);let a=e.createInstance(i.ctor);typeof i.id=="string"&&(this.instancesById.set(i.id,a),this.contributionsById.delete(i.id)),Yb(a)&&this.instanceDisposables.add(a)}catch(a){t.error(`Unable to create workbench contribution '${i.id??i.ctor.name}'.`,a)}finally{typeof i.id=="string"&&us(`code/didCreateWorkbenchContribution/${r}/${i.id}`)}if(typeof i.id=="string"||!n.isBuilt){let a=Date.now()-s;if(a>(r<3?o.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:o.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&t.warn(`Creation of workbench contribution '${i.id??i.ctor.name}' took ${a}ms.`),typeof i.id=="string"){let l=this.timingsByPhase.get(r);l||(l=[],this.timingsByPhase.set(r,l)),l.push([i.id,a])}}}},FXe=Gc.INSTANCE.registerWorkbenchContribution2.bind(Gc.INSTANCE),BXe=Gc.INSTANCE.getWorkbenchContribution.bind(Gc.INSTANCE);et.add(iB.Workbench,Gc.INSTANCE);var lZe=Object.freeze({id:"application",order:100,title:h("applicationConfigurationTitle","Application"),type:"object"}),oB=Object.freeze({id:"workbench",order:7,title:h("workbenchConfigurationTitle","Workbench"),type:"object"}),Rz=Object.freeze({id:"security",scope:1,title:h("securityConfigurationTitle","Security"),type:"object",order:7}),dZe=Object.freeze({id:"problems",title:h("problemsConfigurationTitle","Problems"),type:"object",order:101}),Mz=Object.freeze({id:"window",order:8,title:h("windowConfigurationTitle","Window"),type:"object"}),Pz={ConfigurationMigration:"base.contributions.configuration.migration"},X0=class{migrations=[];_onDidRegisterConfigurationMigrations=new L;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(e){this.migrations.push(...e)}},fS=new X0;et.add(Pz.ConfigurationMigration,fS);var hS=class extends V{constructor(t,n){super();this.configurationService=t;this.workspaceService=n;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(let r of i.added)await this.migrateConfigurationsForFolder(r,fS.migrations)})),this.migrateConfigurations(fS.migrations),this._register(fS.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(t){await this.migrateConfigurationsForFolder(void 0,t);for(let n of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(n,t)}async migrateConfigurationsForFolder(t,n){await Promise.all([n.map(i=>this.migrateConfigurationsForFolderAndOverride(i,t?.uri))])}async migrateConfigurationsForFolderAndOverride(t,n){let i=this.configurationService.inspect(t.key,{resource:n}),r=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of r){let l=i[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(t,s,l.value,n,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let p=await this.runMigration(t,s,u,n,c);for(let m of p??[])d.push([m,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],p])=>this.configurationService.updateValue(c,u.value,{resource:n,overrideIdentifiers:p},a)))}}async runMigration(t,n,i,r,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:r})[n];if(u)return s?u.overrides?.find(({identifiers:p})=>cn(p,s))?.value:u.value},l=await t.migrateFn(i,a);return Array.isArray(l)?l:[[t.key,l]]}};hS=K([D(0,Xt),D(1,to)],hS);var mS=class extends V{constructor(t){super();this.remoteAgentService=t;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new Ps;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!ct&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;et.as(nr.Configuration).registerConfiguration({...Rz,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:h("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};mS=K([D(0,gh)],mS);var Vf="window.newWindowProfile",gS=class extends V{constructor(t,n){super();this.userDataProfilesService=t;this.configurationService=n;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(i=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(n.onDidChangeConfiguration(i=>{i.source!==7&&i.affectsConfiguration(Vf)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let t=et.as(nr.Configuration),n={...Mz,properties:{[Vf]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(i=>i.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(i=>""),h("active window","Active Window")],description:h("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?t.updateConfigurations({add:[n],remove:[this.configurationNode]}):t.registerConfiguration(n),this.configurationNode=n}setNewWindowProfile(){let t=this.configurationService.getValue(Vf);this.newWindowProfile=t?this.userDataProfilesService.profiles.find(n=>n.name===t):void 0}checkAndResetNewWindowProfileConfig(){let t=this.configurationService.getValue(Vf);if(!t)return;let n=this.newWindowProfile?this.userDataProfilesService.profiles.find(i=>i.id===this.newWindowProfile.id):void 0;t!==n?.name&&this.configurationService.updateValue(Vf,n?.name)}};gS=K([D(0,tS),D(1,Xt)],gS);var rB=j("editorResolverService");var Nz=et.as(nr.Configuration),Oz={...oB,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};Nz.registerConfiguration(Oz);var Z0=j("textEditorService"),Hf=class extends V{constructor(t,n,i,r,s){super();this.untitledTextEditorService=t;this.instantiationService=n;this.uriIdentityService=i;this.fileService=r;this.editorResolverService=s;this.registerDefaultEditor()}editorInputCache=new pi;fileEditorFactory=et.as(Wc.EditorFactory).getFileEditorFactory();registerDefaultEditor(){this._register(this.editorResolverService.registerEditor("*",{id:xr.id,label:xr.displayName,detail:xr.providerDisplayName,priority:"builtin"},{},{createEditorInput:t=>({editor:this.createTextEditor(t)}),createUntitledEditorInput:t=>({editor:this.createTextEditor(t)}),createDiffEditorInput:t=>({editor:this.createTextEditor(t)})}))}async resolveTextEditor(t){return this.createTextEditor(t)}createTextEditor(t){if(ua(t))return this.createTextEditor(t.result);if(sr(t)){let r=this.createTextEditor(t.original),s=this.createTextEditor(t.modified);return this.instantiationService.createInstance(rl,t.label,t.description,r,s,void 0)}if(ca(t)){let r=this.createTextEditor(t.primary),s=this.createTextEditor(t.secondary);return this.instantiationService.createInstance(Un,t.label,t.description,s,r)}let n=t;if(n.forceUntitled||!n.resource||n.resource.scheme===Ie.untitled){let r={languageId:n.languageId,initialValue:n.contents,encoding:n.encoding},s;return n.resource?.scheme===Ie.untitled?s=this.untitledTextEditorService.create({untitledResource:n.resource,...r}):s=this.untitledTextEditorService.create({associatedResource:n.resource,...r}),this.createOrGetCached(s.resource,()=>this.instantiationService.createInstance(fa,s))}let i=t;if(i.resource instanceof le){let r=i.label||Qo(i.resource),s=i.resource,a=this.uriIdentityService.asCanonicalUri(s);return this.createOrGetCached(a,()=>i.forceFile||this.fileService.hasProvider(a)?this.fileEditorFactory.createFileEditor(a,s,i.label,i.description,i.encoding,i.languageId,i.contents,this.instantiationService):this.instantiationService.createInstance(ga,a,i.label,i.description,i.languageId,i.contents),l=>{l instanceof fa||(l instanceof ga?(r&&l.setName(r),i.description&&l.setDescription(i.description),i.languageId&&l.setPreferredLanguageId(i.languageId),typeof i.contents=="string"&&l.setPreferredContents(i.contents)):(l.setPreferredResource(s),i.label&&l.setPreferredName(i.label),i.description&&l.setPreferredDescription(i.description),i.encoding&&l.setPreferredEncoding(i.encoding),i.languageId&&l.setPreferredLanguageId(i.languageId),typeof i.contents=="string"&&l.setPreferredContents(i.contents)))})}throw new Error(`ITextEditorService: Unable to create texteditor from ${JSON.stringify(t)}`)}createOrGetCached(t,n,i){let r=this.editorInputCache.get(t);return r?(i?.(r),r):(r=n(),this.editorInputCache.set(t,r),de.once(r.onWillDispose)(()=>this.editorInputCache.delete(t)),r)}};Hf=K([D(0,S0),D(1,dt),D(2,dd),D(3,ii),D(4,rB)],Hf);Cn(Z0,Hf,0);var Uf=class o{constructor(e,t,n,i,r){this._initialScrollTop=e;this._initialContentHeight=t;this._visiblePosition=n;this._visiblePositionScrollDelta=i;this._cursorPosition=r}static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new o(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,n=0,i=e.getVisibleRanges();if(i.length>0){t=i[0].getStartPosition();let r=e.getTopForPosition(t.lineNumber,t.column);n=e.getScrollTop()-r}return new o(e.getScrollTop(),e.getContentHeight(),t,n,e.getPosition())}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){let t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;let t=e.getPosition();if(!this._cursorPosition||!t)return;let n=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+n,1)}};var _r=j("ILanguageFeaturesService");var Q0=class o{static _table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}value="";pos=0;text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let e=this.pos,t=0,n=this.value.charCodeAt(e),i;if(i=o._table[n],typeof i=="number")return this.pos+=1,{type:i,pos:e,len:1};if(o.isDigitCharacter(n)){i=8;do t+=1,n=this.value.charCodeAt(e+t);while(o.isDigitCharacter(n));return this.pos+=t,{type:i,pos:e,len:t}}if(o.isVariableCharacter(n)){i=9;do n=this.value.charCodeAt(e+ ++t);while(o.isVariableCharacter(n)||o.isDigitCharacter(n));return this.pos+=t,{type:i,pos:e,len:t}}i=10;do t+=1,n=this.value.charCodeAt(e+t);while(!isNaN(n)&&typeof o._table[n]>"u"&&!o.isDigitCharacter(n)&&!o.isVariableCharacter(n));return this.pos+=t,{type:i,pos:e,len:t}}},pd=class{_markerBrand;parent;_children=[];appendChild(e){return e instanceof zn&&this._children[this._children.length-1]instanceof zn?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){let{parent:n}=e,i=n.children.indexOf(e),r=n.children.slice(0);r.splice(i,1,...t),n._children=r,function s(a,l){for(let d of a)d.parent=l,s(d.children,d)}(t,n)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof Ih)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}},zn=class o extends pd{constructor(t){super();this.value=t}static escape(t){return t.replace(/\$|}|\\/g,"\\$&")}toString(){return this.value}toTextmateString(){return o.escape(this.value)}len(){return this.value.length}clone(){return new o(this.value)}},bS=class extends pd{transform},Fo=class o extends bS{constructor(t){super();this.index=t}static compareByIndex(t,n){return t.index===n.index?0:t.isFinalTabstop?1:n.isFinalTabstop||t.index<n.index?-1:t.index>n.index?1:0}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof $c?this._children[0]:void 0}toTextmateString(){let t="";return this.transform&&(t=this.transform.toTextmateString()),this.children.length===0&&!this.transform?`$${this.index}`:this.children.length===0?`\${${this.index}${t}}`:this.choice?`\${${this.index}|${this.choice.toTextmateString()}|${t}}`:`\${${this.index}:${this.children.map(n=>n.toTextmateString()).join("")}${t}}`}clone(){let t=new o(this.index);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map(n=>n.clone()),t}},$c=class o extends pd{options=[];appendChild(e){return e instanceof zn&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}toTextmateString(){return this.options.map(e=>e.value.replace(/\||,|\\/g,"\\$&")).join(",")}len(){return this.options[0].len()}clone(){let e=new o;return this.options.forEach(e.appendChild,e),e}},J0=class o extends pd{regexp=new RegExp("");resolve(e){let t=this,n=!1,i=e.replace(this.regexp,function(){return n=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!n&&this._children.some(r=>r instanceof hs&&!!r.elseValue)&&(i=this._replace([])),i}_replace(e){let t="";for(let n of this._children)if(n instanceof hs){let i=e[n.index]||"";i=n.resolve(i),t+=i}else t+=n.toString();return t}toString(){return""}toTextmateString(){return`/${this.regexp.source}/${this.children.map(e=>e.toTextmateString())}/${(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")}`}clone(){let e=new o;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(t=>t.clone()),e}},hs=class o extends pd{constructor(t,n,i,r){super();this.index=t;this.shorthandName=n;this.ifValue=i;this.elseValue=r}resolve(t){return this.shorthandName==="upcase"?t?t.toLocaleUpperCase():"":this.shorthandName==="downcase"?t?t.toLocaleLowerCase():"":this.shorthandName==="capitalize"?t?t[0].toLocaleUpperCase()+t.substr(1):"":this.shorthandName==="pascalcase"?t?this._toPascalCase(t):"":this.shorthandName==="camelcase"?t?this._toCamelCase(t):"":t&&typeof this.ifValue=="string"?this.ifValue:!t&&typeof this.elseValue=="string"?this.elseValue:t||""}_toPascalCase(t){let n=t.match(/[a-z0-9]+/gi);return n?n.map(i=>i.charAt(0).toUpperCase()+i.substr(1)).join(""):t}_toCamelCase(t){let n=t.match(/[a-z0-9]+/gi);return n?n.map((i,r)=>r===0?i.charAt(0).toLowerCase()+i.substr(1):i.charAt(0).toUpperCase()+i.substr(1)).join(""):t}toTextmateString(){let t="${";return t+=this.index,this.shorthandName?t+=`:/${this.shorthandName}`:this.ifValue&&this.elseValue?t+=`:?${this.ifValue}:${this.elseValue}`:this.ifValue?t+=`:+${this.ifValue}`:this.elseValue&&(t+=`:-${this.elseValue}`),t+="}",t}clone(){return new o(this.index,this.shorthandName,this.ifValue,this.elseValue)}},zf=class o extends bS{constructor(t){super();this.name=t}resolve(t){let n=t.resolve(this);return this.transform&&(n=this.transform.resolve(n||"")),n!==void 0?(this._children=[new zn(n)],!0):!1}toTextmateString(){let t="";return this.transform&&(t=this.transform.toTextmateString()),this.children.length===0?`\${${this.name}${t}}`:`\${${this.name}:${this.children.map(n=>n.toTextmateString()).join("")}${t}}`}clone(){let t=new o(this.name);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map(n=>n.clone()),t}};function sB(o,e){let t=[...o];for(;t.length>0;){let n=t.shift();if(!e(n))break;t.unshift(...n.children)}}var Ih=class o extends pd{_placeholders;get placeholderInfo(){if(!this._placeholders){let e=[],t;this.walk(function(n){return n instanceof Fo&&(e.push(n),t=!t||t.index<n.index?n:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){let{all:e}=this.placeholderInfo;return e}offset(e){let t=0,n=!1;return this.walk(i=>i===e?(n=!0,!1):(t+=i.len(),!0)),n?t:-1}fullLen(e){let t=0;return sB([e],n=>(t+=n.len(),!0)),t}enclosingPlaceholders(e){let t=[],{parent:n}=e;for(;n;)n instanceof Fo&&t.push(n),n=n.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof zf&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}toTextmateString(){return this.children.reduce((e,t)=>e+t.toTextmateString(),"")}clone(){let e=new o;return this._children=this.children.map(t=>t.clone()),e}walk(e){sB(this.children,e)}},Er=class o{static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static asInsertText(e){return new o().parse(e).toString()}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}_scanner=new Q0;_token={type:14,pos:0,len:0};parse(e,t,n){let i=new Ih;return this.parseFragment(e,i),this.ensureFinalTabstop(i,n??!1,t??!1),i}parseFragment(e,t){let n=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););let i=new Map,r=[];t.walk(l=>(l instanceof Fo&&(l.isFinalTabstop?i.set(0,void 0):!i.has(l.index)&&l.children.length>0?i.set(l.index,l.children):r.push(l)),!0));let s=(l,d)=>{let c=i.get(l.index);if(!c)return;let u=new Fo(l.index);u.transform=l.transform;for(let p of c){let m=p.clone();u.appendChild(m),m instanceof Fo&&i.has(m.index)&&!d.has(m.index)&&(d.add(m.index),s(m,d),d.delete(m.index))}t.replace(l,[u])},a=new Set;for(let l of r)s(l,a);return t.children.slice(n)}ensureFinalTabstop(e,t,n){(t||n&&e.placeholders.length>0)&&(e.placeholders.find(r=>r.index===0)||e.appendChild(new Fo(0)))}_accept(e,t){if(e===void 0||this._token.type===e){let n=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),n}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){let t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){let i=this._scanner.next();if(i.type!==0&&i.type!==4&&i.type!==5)return!1}this._token=this._scanner.next()}let n=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),n}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new zn(t)),!0):!1}_parseTabstopOrVariableName(e){let t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new Fo(Number(t)):new zf(t)),!0):this._backTo(n)}_parseComplexPlaceholder(e){let t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);let r=new Fo(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new zn("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7)){let s=new $c;for(;;){if(this._parseChoiceElement(s)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(s),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}}else return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(n)}_parseChoiceElement(e){let t=this._token,n=[];for(;!(this._token.type===2||this._token.type===7);){let i;if((i=this._accept(5,!0))?i=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||i:i=this._accept(void 0,!0),!i)return this._backTo(t),!1;n.push(i)}return n.length===0?(this._backTo(t),!1):(e.appendChild(new zn(n.join(""))),!0)}_parseComplexVariable(e){let t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);let r=new zf(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new zn("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(n)}_parseTransform(e){let t=new J0,n="",i="";for(;!this._accept(6);){let r;if(r=this._accept(5,!0)){r=this._accept(6,!0)||r,n+=r;continue}if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let r;if(r=this._accept(5,!0)){r=this._accept(5,!0)||this._accept(6,!0)||r,t.appendChild(new zn(r));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(n,i)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){let t=this._token;if(!this._accept(0))return!1;let n=!1;this._accept(3)&&(n=!0);let i=this._accept(8,!0);if(i)if(n){if(this._accept(4))return e.appendChild(new hs(Number(i))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new hs(Number(i))),!0;else return this._backTo(t),!1;if(this._accept(6)){let r=this._accept(9,!0);return!r||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new hs(Number(i),r)),!0)}else if(this._accept(11)){let r=this._until(4);if(r)return e.appendChild(new hs(Number(i),void 0,r,void 0)),!0}else if(this._accept(12)){let r=this._until(4);if(r)return e.appendChild(new hs(Number(i),void 0,void 0,r)),!0}else if(this._accept(13)){let r=this._until(1);if(r){let s=this._until(4);if(s)return e.appendChild(new hs(Number(i),void 0,r,s)),!0}}else{let r=this._until(4);if(r)return e.appendChild(new hs(Number(i),void 0,void 0,r)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new zn(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}};var Kn;(i=>{function o(r,s){if(r.start>=s.end||s.start>=r.end)return{start:0,end:0};let a=Math.max(r.start,s.start),l=Math.min(r.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}i.intersect=o;function e(r){return r.end-r.start<=0}i.isEmpty=e;function t(r,s){return!e(o(r,s))}i.intersects=t;function n(r,s){let a=[],l={start:r.start,end:Math.min(s.start,r.end)},d={start:Math.max(s.end,r.start),end:r.end};return e(l)||a.push(l),e(d)||a.push(d),a}i.relativeComplement=n})(Kn||={});var vS={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:fc.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};var ba=class{_hooks=new ae;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,n,i,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=i,this._onStopCallback=r;let s=e;try{e.setPointerCapture(t),this._hooks.add(Ce(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=ge(e)}this._hooks.add(Y(s,Ee.POINTER_MOVE,a=>{if(a.buttons!==n){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(Y(s,Ee.POINTER_UP,a=>this.stopMonitoring(!0)))}};var oi=class extends V{onclick(e,t){this._register(Y(e,Ee.CLICK,n=>t(new Ai(ge(e),n))))}onmousedown(e,t){this._register(Y(e,Ee.MOUSE_DOWN,n=>t(new Ai(ge(e),n))))}onmouseover(e,t){this._register(Y(e,Ee.MOUSE_OVER,n=>t(new Ai(ge(e),n))))}onmouseleave(e,t){this._register(Y(e,Ee.MOUSE_LEAVE,n=>t(new Ai(ge(e),n))))}onkeydown(e,t){this._register(Y(e,Ee.KEY_DOWN,n=>t(new pt(n))))}onkeyup(e,t){this._register(Y(e,Ee.KEY_UP,n=>t(new pt(n))))}oninput(e,t){this._register(Y(e,Ee.INPUT,t))}onblur(e,t){this._register(Y(e,Ee.BLUR,t))}onfocus(e,t){this._register(Y(e,Ee.FOCUS,t))}onchange(e,t){this._register(Y(e,Ee.CHANGE,t))}ignoreGesture(e){return mn.ignoreTarget(e)}};var hd=11,yS=class extends oi{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...nt.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=hd+"px",this.domNode.style.height=hd+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new ba),this._register(Ln(this.bgDomNode,Ee.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(Ln(this.domNode,Ee.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new Ou),this._pointerdownScheduleRepeatTimer=this._register(new Zi)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,ge(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}};var Ch=class o{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(e,t,n,i,r,s){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=r,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new o(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){let t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){let t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){let t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,r){let s=Math.max(0,n-e),a=Math.max(0,s-2*t),l=i>0&&i>n;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(n*a/i))),c=(a-d)/(i-n),u=r*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let e=o._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;let t=e-this._arrowSize,n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;let t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}};var IS=class extends V{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Zi)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}};var Az=140,Sh=class extends oi{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new IS(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new ba),this._shouldRender=!0,this.domNode=Ae(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(Y(this.domNode.domNode,Ee.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new yS(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=Ae(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof n=="number"&&this.slider.setWidth(n),typeof i=="number"&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(Y(this.slider.domNode,Ee.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);n<=r&&r<=i?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,n;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,n=e.offsetY;else{let r=Bi(this.domNode.domNode);t=e.pageX-r.left,n=e.pageY-r.top}let i=this._pointerDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),n=this._sliderOrthogonalPointerPosition(e),i=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{let s=this._sliderOrthogonalPointerPosition(r),a=Math.abs(s-n);if(ct&&a>Az){this._setDesiredScrollPositionNow(i.getScrollPosition());return}let d=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(i.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var CS=class extends Sh{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Ch(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){let s=(t.arrowSize-hd)/2,a=(t.horizontalScrollbarSize-hd)/2;this._createArrow({className:"scra",icon:ue.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Zo(null,1,0))}),this._createArrow({className:"scra",icon:ue.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Zo(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}};var SS=class extends Sh{constructor(e,t,n){let i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Ch(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){let s=(t.arrowSize-hd)/2,a=(t.verticalScrollbarSize-hd)/2;this._createArrow({className:"scra",icon:ue.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Zo(null,0,1))}),this._createArrow({className:"scra",icon:ue.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Zo(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}};var Fz=500,aB=50,lB=!0,eD=class{timestamp;deltaX;deltaY;score;constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}},Kf=class o{static INSTANCE=new o;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,n=1,i=this._rear;do{let r=i===this._front?e:Math.pow(2,-n);if(e-=r,t+=this._memory[i].score*r,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(kl){let t=ge(e.browserEvent),n=PM(t);this.accept(Date.now(),e.deltaX*n,e.deltaY*n)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,n){let i=null,r=new eD(e,t,n);this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(i=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r),r.score=this._computeScore(r,i)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(n+=.25),t){let i=Math.abs(e.deltaX),r=Math.abs(e.deltaY),s=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(i,s),1),d=Math.max(Math.min(r,a),1),c=Math.max(i,s),u=Math.max(r,a);c%l===0&&u%d===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}},Gf=class extends oi{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new L);onScroll=this._onScroll.event;_onWillScroll=this._register(new L);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(e,t,n){super(),e.style.overflow="hidden",this._options=Bz(t),this._scrollable=n,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));let i={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new SS(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new CS(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Ae(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Ae(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Ae(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new Zi),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=yt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Ve&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Zo(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=yt(this._mouseWheelToDispose),e)){let n=i=>{this._onMouseWheel(new Zo(i))};this._mouseWheelToDispose.push(Y(this._listenOnDomNode,Ee.MOUSE_WHEEL,n,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=Kf.INSTANCE;lB&&t.acceptStandardWheelEvent(e);let n=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+r===0?s=r=0:Math.abs(r)>=Math.abs(s)?s=0:r=0),this._options.flipAxes&&([r,s]=[s,r]);let a=!Ve&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(r){let c=aB*r,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=aB*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(lB&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),n=!0)}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",r=t?" top":"",s=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),Fz)}},xS=class extends Gf{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new Ba({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>Zn(ge(e),i)});super(e,t,n),this._register(n)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},xh=class extends Gf{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},jc=class extends Gf{_element;constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;let n=new Ba({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>Zn(ge(e),i)});super(e,t,n),this._register(n),this._element=e,this._register(this.onScroll(i=>{i.scrollTopChanged&&(this._element.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this._element.scrollLeft=i.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function Bz(o){let e={lazyRender:typeof o.lazyRender<"u"?o.lazyRender:!1,className:typeof o.className<"u"?o.className:"",useShadows:typeof o.useShadows<"u"?o.useShadows:!0,handleMouseWheel:typeof o.handleMouseWheel<"u"?o.handleMouseWheel:!0,flipAxes:typeof o.flipAxes<"u"?o.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof o.consumeMouseWheelIfScrollbarIsNeeded<"u"?o.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof o.alwaysConsumeMouseWheel<"u"?o.alwaysConsumeMouseWheel:!1,scrollYToX:typeof o.scrollYToX<"u"?o.scrollYToX:!1,mouseWheelScrollSensitivity:typeof o.mouseWheelScrollSensitivity<"u"?o.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof o.fastScrollSensitivity<"u"?o.fastScrollSensitivity:5,scrollPredominantAxis:typeof o.scrollPredominantAxis<"u"?o.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof o.mouseWheelSmoothScroll<"u"?o.mouseWheelSmoothScroll:!0,arrowSize:typeof o.arrowSize<"u"?o.arrowSize:11,listenOnDomNode:typeof o.listenOnDomNode<"u"?o.listenOnDomNode:null,horizontal:typeof o.horizontal<"u"?o.horizontal:1,horizontalScrollbarSize:typeof o.horizontalScrollbarSize<"u"?o.horizontalScrollbarSize:10,horizontalSliderSize:typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:0,horizontalHasArrows:typeof o.horizontalHasArrows<"u"?o.horizontalHasArrows:!1,vertical:typeof o.vertical<"u"?o.vertical:1,verticalScrollbarSize:typeof o.verticalScrollbarSize<"u"?o.verticalScrollbarSize:10,verticalHasArrows:typeof o.verticalHasArrows<"u"?o.verticalHasArrows:!1,verticalSliderSize:typeof o.verticalSliderSize<"u"?o.verticalSliderSize:0,scrollByPage:typeof o.scrollByPage<"u"?o.scrollByPage:!1};return e.horizontalSliderSize=typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof o.verticalSliderSize<"u"?o.verticalSliderSize:e.verticalScrollbarSize,Ve&&(e.className+=" mac"),e}var Wz=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),tD=Wz,Vz=new yi(()=>tD("mouse",!1)),Hz=new yi(()=>tD("element",!1));function an(o){return o==="element"?Hz.value:Vz.value}function _h(){return tD("element",!0)}var va=class extends V{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new ae);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new Go);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new L);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new L({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new L);onDidRun=this._onDidRun.event;_onWillRun=this._register(new L);onWillRun=this._onWillRun.event;constructor(e,t={}){super(),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(_h()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new $r,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(r=>this._onDidRun.fire(r))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(r=>this._onWillRun.fire(r))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let n,i;switch(this._orientation){case 0:n=[15],i=[17];break;case 1:n=[16],i=[18],this.domNode.className+=" vertical";break}this._register(Y(this.domNode,Ee.KEY_DOWN,r=>{let s=new pt(r),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusPrevious():i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof Ti&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(Y(this.domNode,Ee.KEY_UP,r=>{let s=new pt(r);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register($d(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Ji()===this.domNode||!fr(Ji(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}setFocusable(e){if(this.focusable=e,this.focusable){let t=this.viewItems.find(n=>n instanceof Ti&&n.isEnabled());t instanceof Ti&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof Ti&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(n=>{t=t||e.equals(n)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e];if(fr(Ji(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}hasAction(e){return this.viewItems.findIndex(t=>t.action.id===e.id)!==-1}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(Xn(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){let n=Array.isArray(e)?e:[e],i=Yi(t.index)?t.index:null;n.forEach(r=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new md(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,Y(s,Ee.CONTEXT_MENU,d=>{ot.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof Ti&&this.viewItems.length===0&&a.setFocusable(!0),i===null||i<0||i>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[i]),this.viewItems.splice(i,0,a),i++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}getHeight(e){if(e>=0&&e<this.actionsList.children.length){let t=this.actionsList.children.item(e);if(t)return t.clientHeight}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),yt(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=yt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),mi(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,n;if(e===void 0?t=!0:typeof e=="number"?n=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){let i=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=i===-1?void 0:i,this.updateFocus(void 0,void 0,!0)}else n!==void 0&&(this.focusedItem=n),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let n=this.focusedItem,i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=n,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==n&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===jr.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let t=this.focusedItem,n;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}n=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===jr.ID));return this.updateFocus(!0),!0}updateFocus(e,t,n=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let i=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(i){let r=!0;Vm(i.focus)||(r=!1),this.options.focusOnlyEnabledItems&&Vm(i.isEnabled)&&!i.isEnabled()&&(r=!1),i.action.id===jr.ID&&(r=!1),r?(n||this.previouslyFocusedItem!==this.focusedItem)&&(i.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),r&&i.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;let t=this.viewItems[this.focusedItem];if(t instanceof Ti){let n=t._context===null||t._context===void 0?e:t._context;this.run(t._action,n)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=yt(this.viewItems),this.getContainer().remove(),super.dispose()}};function dB(o,e={}){let t=_S(e);return t.textContent=o,t}function cB(o,e={}){let t=_S(e);return uB(t,Uz(o,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function _S(o){let e=o.inline?"span":"div",t=document.createElement(e);return o.className&&(t.className=o.className),t}var nD=class{source;index;constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){let e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}};function uB(o,e,t,n){let i;if(e.type===2)i=document.createTextNode(e.content||"");else if(e.type===3)i=document.createElement("b");else if(e.type===4)i=document.createElement("i");else if(e.type===7&&n)i=document.createElement("code");else if(e.type===5&&t){let r=document.createElement("a");t.disposables.add(Ln(r,"click",s=>{t.callback(String(e.index),s)})),i=r}else e.type===8?i=document.createElement("br"):e.type===1&&(i=o);i&&o!==i&&o.appendChild(i),i&&Array.isArray(e.children)&&e.children.forEach(r=>{uB(i,r,t,n)})}function Uz(o,e){let t={type:1,children:[]},n=0,i=t,r=[],s=new nD(o);for(;!s.eos();){let a=s.next(),l=a==="\\"&&iD(s.peek(),e)!==0;if(l&&(a=s.next()),!l&&zz(a,e)&&a===s.peek()){s.advance(),i.type===2&&(i=r.pop());let d=iD(a,e);if(i.type===d||i.type===5&&d===6)i=r.pop();else{let c={type:d,children:[]};d===5&&(c.index=n,n++),i.children.push(c),r.push(i),i=c}}else if(a===`
`)i.type===2&&(i=r.pop()),i.children.push({type:8});else if(i.type!==2){let d={type:2,content:a};i.children.push(d),r.push(i),i=d}else i.content+=a}return i.type===2&&(i=r.pop()),r.length,t}function zz(o,e){return iD(o,e)!==0}function iD(o,e){switch(o){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}var ES=class{constructor(e){this.spliceables=e}splice(e,t,n){this.spliceables.forEach(i=>i.splice(e,t,n))}};function pB(o,e){let t=[];for(let n of e){if(o.start>=n.range.end)continue;if(o.end<n.range.start)break;let i=Kn.intersect(o,n.range);Kn.isEmpty(i)||t.push({range:i,size:n.size})}return t}function TS({start:o,end:e},t){return{start:o+t,end:e+t}}function Kz(o){let e=[],t=null;for(let n of o){let i=n.range.start,r=n.range.end,s=n.size;if(t&&s===t.size){t.range.end=r;continue}t={range:{start:i,end:r},size:s},e.push(t)}return e}function Gz(...o){return Kz(o.reduce((e,t)=>e.concat(t),[]))}var wS=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,n=[]){let i=n.length-t,r=pB({start:0,end:e},this.groups),s=pB({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:TS(l.range,i),size:l.size})),a=n.map((l,d)=>({range:{start:e+d,end:e+d+1},size:l.size}));this.groups=Gz(r,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,n=this._paddingTop;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r*i.size;if(e<s)return t+Math.floor((e-n)/i.size);t+=r,n=s}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){let r=i.range.end-i.range.start,s=n+r;if(e<s)return this._paddingTop+t+(e-n)*i.size;t+=r*i.size,n=s}return-1}};var LS=class{constructor(e){this.renderers=e}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(e){let t=this.getTemplateCache(e).pop(),n=!1;if(t)n=this.transactionNodesPendingRemoval.has(t.domNode),n&&this.transactionNodesPendingRemoval.delete(t.domNode);else{let i=xe(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(i);t={domNode:i,templateId:e,templateData:s}}return{row:t,isReusingConnectedDomNode:n}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(let t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){let{domNode:t,templateId:n}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(n).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(let n of e)this.getRenderer(t).disposeTemplate(n.templateData),n.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){let t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}};var qc={CurrentDragAndDropData:void 0};var ya={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(o){return[o]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},DS=class{elements;_context;get context(){return this._context}set context(e){this._context=e}constructor(e){this.elements=e}update(){}getData(){return this.elements}},oD=class{elements;constructor(e){this.elements=e}update(){}getData(){return this.elements}},rD=class{types;files;constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){let n=e.files.item(t);n&&(n.size||n.type)&&this.files.push(n)}}}getData(){return{types:this.types,files:this.files}}};function $z(o,e){return Array.isArray(o)&&Array.isArray(e)?tn(o,e):o===e}var sD=class{getSetSize;getPosInSet;getRole;isChecked;constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,n,i)=>i,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,n)=>n+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}},Bo=class Bo{constructor(e,t,n,i=ya){this.virtualDelegate=t;if(i.horizontalScrolling&&i.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(i.paddingTop??0);for(let s of n)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new LS(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof i.mouseSupport=="boolean"?i.mouseSupport:!0),this._horizontalScrolling=i.horizontalScrolling??ya.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof i.paddingBottom>"u"?0:i.paddingBottom,this.accessibilityProvider=new sD(i.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(i.transformOptimization??ya.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(mn.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new Ba({forceIntegerValues:!0,smoothScrollDuration:i.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>Zn(ge(this.domNode),s)})),this.scrollableElement=this.disposables.add(new xh(this.rowsContainer,{alwaysConsumeMouseWheel:i.alwaysConsumeMouseWheel??ya.alwaysConsumeMouseWheel,horizontal:1,vertical:i.verticalScrollMode??ya.verticalScrollMode,useShadows:i.useShadows??ya.useShadows,mouseWheelScrollSensitivity:i.mouseWheelScrollSensitivity,fastScrollSensitivity:i.fastScrollSensitivity,scrollByPage:i.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(Y(this.rowsContainer,ht.Change,s=>this.onTouchChange(s))),this.disposables.add(Y(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(Y(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(Y(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(Y(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(Y(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=i.setRowLineHeight??ya.setRowLineHeight,this.setRowHeight=i.setRowHeight??ya.setRowHeight,this.supportDynamicHeights=i.supportDynamicHeights??ya.supportDynamicHeights,this.dnd=i.dnd??this.disposables.add(ya.dnd),this.layout(i.initialSize?.height,i.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++Bo.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new Aa(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=V.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=V.None;onDragLeaveTimeout=V.None;disposables=new ae;_onDidChangeContentHeight=new L;_onDidChangeContentWidth=new L;onDidChangeContentHeight=de.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=de.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:Uv(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),i=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(n,Math.max(0,this.lastRenderTop+i),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(e){this.scrollableElement.delegateScrollFromMouseWheelEvent(e)}delegateVerticalScrollbarPointerDown(e){this.scrollableElement.delegateVerticalScrollbarPointerDown(e)}updateElementHeight(e,t,n){if(e<0||e>=this.items.length)return;let i=this.items[e].size;if(typeof t>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[e].lastDynamicHeightWidth=void 0,t=i+this.probeDynamicHeight(e)}if(i===t)return;let r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;e<r.start||n!==null&&n>e&&n<r.end?s=t-i:s=0,this.rangeMap.splice(e,1,[{size:t}]),this.items[e].size=t,this.render(r,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(e){return new wS(e)}splice(e,t,n=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,n)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,n=[]){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},s=Kn.intersect(i,r),a=new Map;for(let _=s.end-1;_>=s.start;_--){let R=this.items[_];if(R.dragStartDisposable.dispose(),R.checkedDisposable.dispose(),R.row){let N=a.get(R.templateId);N||(N=[],a.set(R.templateId,N));let F=this.renderers.get(R.templateId);F&&F.disposeElement&&F.disposeElement(R.element,_,R.row.templateData,R.size),N.unshift(R.row)}R.row=null,R.stale=!0}let l={start:e+t,end:this.items.length},d=Kn.intersect(l,i),c=Kn.relativeComplement(l,i),u=n.map(_=>({id:String(this.itemId++),element:_,templateId:this.virtualDelegate.getTemplateId(_),size:this.virtualDelegate.getHeight(_),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(_),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:V.None,checkedDisposable:V.None,stale:!1})),p;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),p=this.items,this.items=u):(this.rangeMap.splice(e,t,u),p=this.items.splice(e,t,...u));let m=n.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=TS(d,m),b=Kn.intersect(f,g);for(let _=b.start;_<b.end;_++)this.updateItemInDOM(this.items[_],_);let v=Kn.relativeComplement(g,f);for(let _ of v)for(let R=_.start;R<_.end;R++)this.removeItemFromDOM(R);let I=c.map(_=>TS(_,m)),S=[{start:e,end:e+n.length},...I].map(_=>Kn.intersect(f,_)).reverse();for(let _ of S)for(let R=_.end-1;R>=_.start;R--){let N=this.items[R],P=a.get(N.templateId)?.pop();this.insertItemInDOM(R,P)}for(let _ of a.values())for(let R of _)this.cache.release(R);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),p.map(_=>_.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Zn(ge(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(let t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(e){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let t=this.items[e];this.measureItemWidth(t),typeof t.width<"u"&&t.width>this.scrollWidth&&(this.scrollWidth=t.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let e=this.firstVisibleIndex,t=this.rangeMap.positionAt(e),n=this.rangeMap.positionAt(e+1);return n!==-1&&(n-t)/2+t<this.scrollTop?e+1:e}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){let t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let n={height:typeof e=="number"?e:mP(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,n.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(n),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:Uv(this.domNode)})}render(e,t,n,i,r,s=!1){let a=this.getRenderRange(t,n),l=Kn.relativeComplement(a,e).reverse(),d=Kn.relativeComplement(e,a);if(s){let c=Kn.intersect(e,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),i!==void 0&&(this.rowsContainer.style.left=`-${i}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=n}insertItemInDOM(e,t){let n=this.items[e];if(!n.row)if(t)n.row=t,n.stale=!0;else{let l=this.cache.alloc(n.templateId);n.row=l.row,n.stale||=l.isReusingConnectedDomNode}let i=this.accessibilityProvider.getRole(n.element)||"listitem";n.row.domNode.setAttribute("role",i);let r=this.accessibilityProvider.isChecked(n.element);if(typeof r=="boolean")n.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){let l=d=>n.row.domNode.setAttribute("aria-checked",String(!!d));l(r.value),n.checkedDisposable=r.onDidChange(()=>l(r.value))}if(n.stale||!n.row.domNode.parentElement){let l=this.items.at(e+1)?.row?.domNode??null;(n.row.domNode.parentElement!==this.rowsContainer||n.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(n.row.domNode,l),n.stale=!1}this.updateItemInDOM(n,e);let s=this.renderers.get(n.templateId);if(!s)throw new Error(`No renderer found for template id ${n.templateId}`);s?.renderElement(n.element,e,n.row.templateData,n.size);let a=this.dnd.getDragURI(n.element);n.dragStartDisposable.dispose(),n.row.domNode.draggable=!!a,a&&(n.dragStartDisposable=Y(n.row.domNode,"dragstart",l=>this.onDragStart(n.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(n),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=Uv(e.row.domNode);let t=ge(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){let t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let n=this.renderers.get(t.templateId);n&&n.disposeElement&&n.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return de.map(this.disposables.add(new He(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return de.map(this.disposables.add(new He(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return de.filter(de.map(this.disposables.add(new He(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseUp(){return de.map(this.disposables.add(new He(this.domNode,"mouseup")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDown(){return de.map(this.disposables.add(new He(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return de.map(this.disposables.add(new He(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMove(){return de.map(this.disposables.add(new He(this.domNode,"mousemove")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return de.map(this.disposables.add(new He(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return de.any(de.map(this.disposables.add(new He(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),de.map(this.disposables.add(new He(this.domNode,ht.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return de.map(this.disposables.add(new He(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return de.map(this.disposables.add(new He(this.rowsContainer,ht.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toTouchEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toGestureEvent(e){let t=this.getItemIndexFromEventTarget(e.initialTarget||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element;return{browserEvent:e,index:t,element:i}}toDragEvent(e){let t=this.getItemIndexFromEventTarget(e.target||null),n=typeof t>"u"?void 0:this.items[t],i=n&&n.element,r=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:i,sector:r}}onScroll(e){try{let t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,n){if(!n.dataTransfer)return;let i=this.dnd.getDragElements(e);if(n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData(vS.TEXT,t),n.dataTransfer.setDragImage){let r;this.dnd.getDragLabel&&(r=this.dnd.getDragLabel(i,n)),typeof r>"u"&&(r=String(i.length));let s=xe(".monaco-drag-image");s.textContent=r,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),n.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new DS(i),qc.CurrentDragAndDropData=new oD(i),this.dnd.onDragStart?.(this.currentDragData,n)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),qc.CurrentDragAndDropData&&qc.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(qc.CurrentDragAndDropData)this.currentDragData=qc.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new rD}let t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let n;typeof t!="boolean"&&t.feedback?n=t.feedback:typeof e.index>"u"?n=[-1]:n=[e.index],n=dr(n).filter(r=>r>=-1&&r<this.length).sort((r,s)=>r-s),n=n[0]===-1?[-1]:n;let i=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if($z(this.currentDragFeedback,n)&&this.currentDragFeedbackPosition===i)return!0;if(this.currentDragFeedback=n,this.currentDragFeedbackPosition=i,this.currentDragFeedbackDisposable.dispose(),n[0]===-1)this.domNode.classList.add(i),this.rowsContainer.classList.add(i),this.currentDragFeedbackDisposable=Ce(()=>{this.domNode.classList.remove(i),this.rowsContainer.classList.remove(i)});else{if(n.length>1&&i!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");i==="drop-target-after"&&n[0]<this.length-1&&(n[0]+=1,i="drop-target-before");for(let r of n){let s=this.items[r];s.dropTarget=!0,s.row?.domNode.classList.add(i)}this.currentDragFeedbackDisposable=Ce(()=>{for(let r of n){let s=this.items[r];s.dropTarget=!1,s.row?.domNode.classList.remove(i)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=Kd(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;let t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,qc.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,qc.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=V.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){let t=pP(this.domNode).top;this.dragOverAnimationDisposable=xP(ge(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=Kd(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;let t=this.dragOverMouseY-e,n=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>n&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-n))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;let n=e.offsetY/this.items[t].size,i=Math.floor(n/.25);return Wr(i,0,3)}getItemIndexFromEventTarget(e){let t=this.scrollableElement.getDomNode(),n=e;for(;(Xn(n)||bP(n))&&n!==this.rowsContainer&&t.contains(n);){let i=n.getAttribute("data-index");if(i){let r=Number(i);if(!isNaN(r))return r}n=n.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,n){let i=this.getRenderRange(e,t),r,s;e===this.elementTop(i.start)?(r=i.start,s=0):i.end-i.start>1&&(r=i.start+1,s=this.elementTop(r)-e);let a=0;for(;;){let l=this.getRenderRange(e,t),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=Kn.relativeComplement(i,l);for(let p of c)for(let m=p.start;m<p.end;m++)this.items[m].row&&this.removeItemFromDOM(m);let u=Kn.relativeComplement(l,i).reverse();for(let p of u)for(let m=p.end-1;m>=p.start;m--)this.insertItemInDOM(m);for(let p=l.start;p<l.end;p++)this.items[p].row&&this.updateItemInDOM(this.items[p],p);if(typeof r=="number"){let p=this.scrollable.getFutureScrollPosition().scrollTop-e,m=this.elementTop(r)-s+p;this.setScrollTop(m,n)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){let t=this.items[e];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(t.element);if(s!==null){let a=t.size;return t.size=s,t.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;let n=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!fr(t.row.domNode,ge(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-n;let{row:i}=this.cache.alloc(t.templateId);i.domNode.style.height="",this.rowsContainer.appendChild(i.domNode);let r=this.renderers.get(t.templateId);if(!r)throw new $e("Missing renderer for templateId: "+t.templateId);return r.renderElement(t.element,e,i.templateData,void 0),t.size=i.domNode.offsetHeight,r.disposeElement?.(t.element,e,i.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,i.domNode.remove(),this.cache.release(i),t.size-n}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(let e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};K([Et],Bo.prototype,"onMouseClick",1),K([Et],Bo.prototype,"onMouseDblClick",1),K([Et],Bo.prototype,"onMouseMiddleClick",1),K([Et],Bo.prototype,"onMouseUp",1),K([Et],Bo.prototype,"onMouseDown",1),K([Et],Bo.prototype,"onMouseOver",1),K([Et],Bo.prototype,"onMouseMove",1),K([Et],Bo.prototype,"onMouseOut",1),K([Et],Bo.prototype,"onContextMenu",1),K([Et],Bo.prototype,"onTouchStart",1),K([Et],Bo.prototype,"onTap",1);var kS=Bo;var Ia=class extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}};var aD=class{constructor(e){this.trait=e}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,n){let i=this.renderedElements.findIndex(r=>r.templateData===n);if(i>=0){let r=this.renderedElements[i];this.trait.unrender(n),r.index=t}else{let r={index:t,templateData:n};this.renderedElements.push(r)}this.trait.renderIndex(t,n)}splice(e,t,n){let i=[];for(let r of this.renderedElements)r.index<e?i.push(r):r.index>=e+t&&i.push({index:r.index+n-t,templateData:r.templateData});this.renderedElements=i}renderIndexes(e){for(let{index:t,templateData:n}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,n)}disposeTemplate(e){let t=this.renderedElements.findIndex(n=>n.templateData===e);t<0||this.renderedElements.splice(t,1)}},Eh=class{constructor(e){this._trait=e}indexes=[];sortedIndexes=[];_onChange=new L;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new aD(this)}splice(e,t,n){let i=n.length-t,r=e+t,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)s.push(this.sortedIndexes[a++]);for(let l=0;l<n.length;l++)n[l]&&s.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=r;)s.push(this.sortedIndexes[a++]+i);this.renderer.splice(e,t,n.length),this._set(s,s)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(mB),t)}_set(e,t,n){let i=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;let s=pD(r,e);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:e,browserEvent:n}),i}get(){return this.indexes}contains(e){return Ob(this.sortedIndexes,e,mB)>=0}dispose(){yt(this._onChange)}};K([Et],Eh.prototype,"renderer",1);var lD=class extends Eh{constructor(t){super("selected");this.setAriaSelected=t}renderIndex(t,n){super.renderIndex(t,n),this.setAriaSelected&&(this.contains(t)?n.setAttribute("aria-selected","true"):n.setAttribute("aria-selected","false"))}},jf=class{constructor(e,t,n){this.trait=e;this.view=t;this.identityProvider=n}splice(e,t,n){if(!this.identityProvider)return this.trait.splice(e,t,new Array(n.length).fill(!1));let i=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(i.length===0)return this.trait.splice(e,t,new Array(n.length).fill(!1));let r=new Set(i),s=n.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,s)}};function gB(o,e){return o.classList.contains(e)?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:gB(o.parentElement,e)}function $f(o){return gB(o,"monaco-editor")}var RS=class{constructor(e,t,n){this.list=e;this.view=t;this.multipleSelectionSupport=n.multipleSelectionSupport,this.disposables.add(this.onKeyDown(i=>{switch(i.keyCode){case 3:return this.onEnter(i);case 16:return this.onUpArrow(i);case 18:return this.onDownArrow(i);case 11:return this.onPageUpArrow(i);case 12:return this.onPageDownArrow(i);case 9:return this.onEscape(i);case 31:this.multipleSelectionSupport&&(Ve?i.metaKey:i.ctrlKey)&&this.onCtrlA(i)}}))}disposables=new ae;multipleSelectionDisposables=new ae;multipleSelectionSupport;get onKeyDown(){return de.chain(this.disposables.add(new He(this.view.domNode,"keydown")).event,e=>e.filter(t=>!As(t.target)).map(t=>new pt(t)))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);let t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(pm(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};K([Et],RS.prototype,"onKeyDown",1);var Yz=new class{mightProducePrintableCharacter(o){return o.ctrlKey||o.metaKey||o.altKey?!1:o.keyCode>=31&&o.keyCode<=56||o.keyCode>=21&&o.keyCode<=30||o.keyCode>=98&&o.keyCode<=107||o.keyCode>=85&&o.keyCode<=95}},dD=class{constructor(e,t,n,i,r){this.list=e;this.view=t;this.keyboardNavigationLabelProvider=n;this.keyboardNavigationEventFilter=i;this.delegate=r;this.updateOptions(e.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new ae;disposables=new ae;updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let e=!1,t=de.chain(this.enabledDisposables.add(new He(this.view.domNode,"keydown")).event,r=>r.filter(s=>!As(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new pt(s)).filter(s=>e||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>ot.stop(s,!0)).map(s=>s.browserEvent.key)),n=de.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);de.reduce(de.any(t,n),(r,s)=>s===null?null:(r||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),n(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),n(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){let t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?Fl(t):t&&Fl(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=0,this.triggered=!1;return}let t=this.list.getFocus(),n=t.length>0?t[0]:0,i=this.state===0?1:0;this.state=1;for(let r=0;r<this.list.length;r++){let s=(n+r+i)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(Jd(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}let d=HP(e,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||Jd(e,l)){this.previouslyFocused=n,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},cD=class{constructor(e,t){this.list=e;this.view=t;let n=de.chain(this.disposables.add(new He(t.domNode,"keydown")).event,r=>r.filter(s=>!As(s.target)).map(s=>new pt(s)));de.chain(n,r=>r.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new ae;onTab(e){if(e.target!==this.view.domNode)return;let t=this.list.getFocus();if(t.length===0)return;let n=this.view.domElement(t[0]);if(!n)return;let i=n.querySelector("[tabIndex]");if(!i||!Xn(i)||i.tabIndex===-1)return;let r=ge(i).getComputedStyle(i);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),i.focus())}dispose(){this.disposables.dispose()}};function Xz(o){return Ve?o.browserEvent.metaKey:o.browserEvent.ctrlKey}function Zz(o){return o.browserEvent.shiftKey}function Qz(o){return Gv(o)&&o.button===2}var hB={isSelectionSingleChangeEvent:Xz,isSelectionRangeChangeEvent:Zz},MS=class{constructor(e){this.list=e;e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||hB),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(mn.addTarget(e.getHTMLElement()))),de.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new ae;_onPointer=new L;onPointer=this._onPointer.event;updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||hB))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){$f(e.browserEvent.target)||Ji()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(As(e.browserEvent.target)||$f(e.browserEvent.target))return;let t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||As(e.browserEvent.target)||$f(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),Qz(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(As(e.browserEvent.target)||$f(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;let t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){let t=e.index,n=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof n>"u"&&(n=this.list.getFocus()[0]??t,this.list.setAnchor(n));let i=Math.min(n,t),r=Math.max(n,t),s=pm(i,r+1),a=this.list.getSelection(),l=e7(pD(a,[n]),n);if(l.length===0)return;let d=pD(s,t7(a,l));this.list.setSelection(d,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){let i=this.list.getSelection(),r=i.filter(s=>s!==t);this.list.setFocus([t]),this.list.setAnchor(t),i.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}},uD=class{constructor(e,t){this.styleElement=e;this.selectorSuffix=t}style(e){let t=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];e.listBackground&&n.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&n.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(n.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&n.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&n.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);let i=Hr(e.listFocusAndSelectionOutline,Hr(e.listSelectionOutline,e.listFocusOutline??""));i&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${i}; outline-offset: -1px;}`),e.listFocusOutline&&n.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);let r=Hr(e.listSelectionOutline,e.listInactiveFocusOutline??"");r&&n.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${r}; outline-offset: -1px; }`),e.listSelectionOutline&&n.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&n.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&n.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&n.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),n.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&n.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&n.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=n.join(`
`)}},fB={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:G.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:G.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:G.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},Jz={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function e7(o,e){let t=o.indexOf(e);if(t===-1)return[];let n=[],i=t-1;for(;i>=0&&o[i]===e-(t-i);)n.push(o[i--]);for(n.reverse(),i=t;i<o.length&&o[i]===e+(i-t);)n.push(o[i++]);return n}function pD(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){t.push(o[n]),n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):t.push(e[i++]);return t}function t7(o,e){let t=[],n=0,i=0;for(;n<o.length||i<e.length;)if(n>=o.length)t.push(e[i++]);else if(i>=e.length)t.push(o[n++]);else if(o[n]===e[i]){n++,i++;continue}else o[n]<e[i]?t.push(o[n++]):i++;return t}var mB=(o,e)=>o-e,hD=class{constructor(e,t){this._templateId=e;this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,n,i){let r=0;for(let s of this.renderers)s.renderElement(e,t,n[r++],i)}disposeElement(e,t,n,i){let r=0;for(let s of this.renderers)s.disposeElement?.(e,t,n[r],i),r+=1}disposeTemplate(e){let t=0;for(let n of this.renderers)n.disposeTemplate(e[t++])}},mD=class{constructor(e){this.accessibilityProvider=e}templateId="a18n";renderTemplate(e){return{container:e,disposables:new ae}}renderElement(e,t,n){let i=this.accessibilityProvider.getAriaLabel(e),r=i&&typeof i!="string"?i:tv(i);n.disposables.add(jo(a=>{this.setAriaLabel(a.readObservable(r),n.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?n.container.setAttribute("aria-level",`${s}`):n.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,n,i){n.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}},gD=class{constructor(e,t){this.list=e;this.dnd=t}getDragElements(e){let t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,n,i,r){return this.dnd.onDragOver(e,t,n,i,r)}onDragLeave(e,t,n,i){this.dnd.onDragLeave?.(e,t,n,i)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,n,i,r){this.dnd.drop(e,t,n,i,r)}dispose(){this.dnd.dispose()}},ho=class{constructor(e,t,n,i,r=Jz){this.user=e;this._options=r;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new lD(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new mD(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),i=i.map(d=>new hD(d.templateId,[...a,d]));let l={...r,dnd:r.dnd&&new gD(this,r.dnd)};if(this.view=this.createListView(t,n,i,l),this.view.domNode.setAttribute("role",s),r.styleController)this.styleController=r.styleController(this.view.domId);else{let d=Os(this.view.domNode);this.styleController=new uD(d,this.view.domId)}if(this.spliceable=new ES([new jf(this.focus,this.view,r.identityProvider),new jf(this.selection,this.view,r.identityProvider),new jf(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new cD(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new RS(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){let d=r.keyboardNavigationDelegate||Yz;this.typeNavigationController=new dD(this,this.view,r.keyboardNavigationLabelProvider,r.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new Eh("focused");selection;anchor=new Eh("anchor");eventBufferer=new xu;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new ae;get onDidChangeFocus(){return de.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return de.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1,t=de.chain(this.disposables.add(new He(this.view.domNode,"keydown")).event,r=>r.map(s=>new pt(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>ot.stop(s,!0)).filter(()=>!1)),n=de.chain(this.disposables.add(new He(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(s=>new pt(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>ot.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),i=de.chain(this.view.onContextMenu,r=>r.filter(s=>!e).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new Ai(ge(this.view.domNode),l),browserEvent:l})));return de.any(t,n,i)}get onKeyDown(){return this.disposables.add(new He(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new He(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new He(this.view.domNode,"keypress")).event}get onDidFocus(){return de.signal(this.disposables.add(new He(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return de.signal(this.disposables.add(new He(this.view.domNode,"blur",!0)).event)}_onDidDispose=new L;onDidDispose=this._onDidDispose.event;createListView(e,t,n,i){return new kS(e,t,n,i)}createMouseController(e){return new MS(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,n=[]){if(e<0||e>this.view.length)throw new Ia(this.user,`Invalid start index: ${e}`);if(t<0)throw new Ia(this.user,`Invalid delete count: ${t}`);t===0&&n.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,n))}updateWidth(e){this.view.updateWidth(e)}updateElementHeight(e,t){this.view.updateElementHeight(e,t,null)}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(e){this.view.setScrollLeft(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(e,t){for(let n of e)if(n<0||n>=this.length)throw new Ia(this.user,`Invalid index ${n}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Ia(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(let n of e)if(n<0||n>=this.length)throw new Ia(this.user,`Invalid index ${n}`);this.focus.set(e,t)}focusNext(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findNextIndex(r.length>0?r[0]+e:0,t,i);s>-1&&this.setFocus([s],n)}focusPrevious(e=1,t=!1,n,i){if(this.length===0)return;let r=this.focus.get(),s=this.findPreviousIndex(r.length>0?r[0]-e:0,t,i);s>-1&&this.setFocus([s],n)}async focusNextPage(e,t){let n=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);n=n===0?0:n-1;let i=this.getFocus()[0];if(i!==n&&(i===void 0||n>i)){let r=this.findPreviousIndex(n,!1,t);r>-1&&i!==r?this.setFocus([r],e):this.setFocus([n],e)}else{let r=this.view.getScrollTop(),s=r+this.view.renderHeight;n>i&&(s-=this.view.elementHeight(n)),this.view.setScrollTop(s),this.view.getScrollTop()!==r&&(this.setFocus([]),await pr(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,n=()=>0){let i,r=n(),s=this.view.getScrollTop()+r;s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==i&&(a===void 0||a>=i)){let l=this.findNextIndex(i,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([i],e)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-r),this.view.getScrollTop()+n()!==l&&(this.setFocus([]),await pr(0),await this.focusPreviousPage(e,t,n))}}focusLast(e,t){if(this.length===0)return;let n=this.findPreviousIndex(this.length-1,!1,t);n>-1&&this.setFocus([n],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,n){if(this.length===0)return;let i=this.findNextIndex(e,!1,n);i>-1&&this.setFocus([i],t)}findNextIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!n||n(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!n||n(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,n=0){if(e<0||e>=this.length)throw new Ia(this.user,`Invalid index ${e}`);let i=this.view.getScrollTop(),r=this.view.elementTop(e),s=this.view.elementHeight(e);if(Yi(t)){let a=s-this.view.renderHeight+n;this.view.setScrollTop(a*Wr(t,0,1)+r-n)}else{let a=r+s,l=i+this.view.renderHeight;r<i+n&&a>=l||(r<i+n||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(r-n):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new Ia(this.user,`Invalid index ${e}`);let n=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(i<n+t||i+r>n+this.view.renderHeight)return null;let s=r-this.view.renderHeight+t;return Math.abs((n+t-i)/s)}isDOMFocused(){return Vr(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(n=>this.view.element(n)),browserEvent:t}}_onFocusChange(){let e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};K([Et],ho.prototype,"onDidChangeFocus",1),K([Et],ho.prototype,"onDidChangeSelection",1),K([Et],ho.prototype,"onContextMenu",1),K([Et],ho.prototype,"onKeyDown",1),K([Et],ho.prototype,"onKeyUp",1),K([Et],ho.prototype,"onKeyPress",1),K([Et],ho.prototype,"onDidFocus",1),K([Et],ho.prototype,"onDidBlur",1);var n7=new RegExp(`(\\\\)?\\$\\((${nt.iconNameExpression}(?:${nt.iconModifierExpression})?)\\)`,"g");function Yc(o){let e=new Array,t,n=0,i=0;for(;(t=n7.exec(o))!==null;){i=t.index||0,n<i&&e.push(o.substring(n,i)),n=(t.index||0)+t[0].length;let[,r,s]=t;e.push(r?`$(${s})`:i7({id:s}))}return n<o.length&&e.push(o.substring(n)),e}function i7(o){let e=xe("span");return e.classList.add(...nt.asClassNameArray(o)),e}var fD=class{_prefix;_lastId;constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},bD=new fD("id#");var ri={};(function(){function o(e,t){t(ri)}o.amd=!0,function(e,t){typeof o=="function"&&o.amd?o(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){"use strict";function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function n(Be){e.defaults=Be}let i=/[&<>"']/,r=new RegExp(i.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=Be=>l[Be];function c(Be,E){if(E){if(i.test(Be))return Be.replace(r,d)}else if(s.test(Be))return Be.replace(a,d);return Be}let u=/(^|[^\[])\^/g;function p(Be,E){let T=typeof Be=="string"?Be:Be.source;E=E||"";let k={replace:(A,B)=>{let q=typeof B=="string"?B:B.source;return q=q.replace(u,"$1"),T=T.replace(A,q),k},getRegex:()=>new RegExp(T,E)};return k}function m(Be){try{Be=encodeURI(Be).replace(/%25/g,"%")}catch{return null}return Be}let f={exec:()=>null};function g(Be,E){let T=Be.replace(/\|/g,(B,q,Q)=>{let ve=!1,we=q;for(;--we>=0&&Q[we]==="\\";)ve=!ve;return ve?"|":" |"}),k=T.split(/ \|/),A=0;if(k[0].trim()||k.shift(),k.length>0&&!k[k.length-1].trim()&&k.pop(),E)if(k.length>E)k.splice(E);else for(;k.length<E;)k.push("");for(;A<k.length;A++)k[A]=k[A].trim().replace(/\\\|/g,"|");return k}function b(Be,E,T){let k=Be.length;if(k===0)return"";let A=0;for(;A<k;){let B=Be.charAt(k-A-1);if(B===E&&!T)A++;else if(B!==E&&T)A++;else break}return Be.slice(0,k-A)}function v(Be,E){if(Be.indexOf(E[1])===-1)return-1;let T=0;for(let k=0;k<Be.length;k++)if(Be[k]==="\\")k++;else if(Be[k]===E[0])T++;else if(Be[k]===E[1]&&(T--,T<0))return k;return-1}function I(Be,E,T,k){let A=E.href,B=E.title?c(E.title):null,q=Be[1].replace(/\\([\[\]])/g,"$1");if(Be[0].charAt(0)!=="!"){k.state.inLink=!0;let Q={type:"link",raw:T,href:A,title:B,text:q,tokens:k.inlineTokens(q)};return k.state.inLink=!1,Q}return{type:"image",raw:T,href:A,title:B,text:c(q)}}function C(Be,E){let T=Be.match(/^(\s+)(?:```)/);if(T===null)return E;let k=T[1];return E.split(`
`).map(A=>{let B=A.match(/^\s+/);if(B===null)return A;let[q]=B;return q.length>=k.length?A.slice(k.length):A}).join(`
`)}class S{options;rules;lexer;constructor(E){this.options=E||e.defaults}space(E){let T=this.rules.block.newline.exec(E);if(T&&T[0].length>0)return{type:"space",raw:T[0]}}code(E){let T=this.rules.block.code.exec(E);if(T){let k=T[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:T[0],codeBlockStyle:"indented",text:this.options.pedantic?k:b(k,`
`)}}}fences(E){let T=this.rules.block.fences.exec(E);if(T){let k=T[0],A=C(k,T[3]||"");return{type:"code",raw:k,lang:T[2]?T[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):T[2],text:A}}}heading(E){let T=this.rules.block.heading.exec(E);if(T){let k=T[2].trim();if(/#$/.test(k)){let A=b(k,"#");(this.options.pedantic||!A||/ $/.test(A))&&(k=A.trim())}return{type:"heading",raw:T[0],depth:T[1].length,text:k,tokens:this.lexer.inline(k)}}}hr(E){let T=this.rules.block.hr.exec(E);if(T)return{type:"hr",raw:b(T[0],`
`)}}blockquote(E){let T=this.rules.block.blockquote.exec(E);if(T){let k=b(T[0],`
`).split(`
`),A="",B="",q=[];for(;k.length>0;){let Q=!1,ve=[],we;for(we=0;we<k.length;we++)if(/^ {0,3}>/.test(k[we]))ve.push(k[we]),Q=!0;else if(!Q)ve.push(k[we]);else break;k=k.slice(we);let Xe=ve.join(`
`),mt=Xe.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");A=A?`${A}
${Xe}`:Xe,B=B?`${B}
${mt}`:mt;let Vt=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(mt,q,!0),this.lexer.state.top=Vt,k.length===0)break;let vn=q[q.length-1];if(vn?.type==="code")break;if(vn?.type==="blockquote"){let $t=vn,Re=$t.raw+`
`+k.join(`
`),W=this.blockquote(Re);q[q.length-1]=W,A=A.substring(0,A.length-$t.raw.length)+W.raw,B=B.substring(0,B.length-$t.text.length)+W.text;break}else if(vn?.type==="list"){let $t=vn,Re=$t.raw+`
`+k.join(`
`),W=this.list(Re);q[q.length-1]=W,A=A.substring(0,A.length-vn.raw.length)+W.raw,B=B.substring(0,B.length-$t.raw.length)+W.raw,k=Re.substring(q[q.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:A,tokens:q,text:B}}}list(E){let T=this.rules.block.list.exec(E);if(T){let k=T[1].trim(),A=k.length>1,B={type:"list",raw:"",ordered:A,start:A?+k.slice(0,-1):"",loose:!1,items:[]};k=A?`\\d{1,9}\\${k.slice(-1)}`:`\\${k}`,this.options.pedantic&&(k=A?k:"[*+-]");let q=new RegExp(`^( {0,3}${k})((?:[	 ][^\\n]*)?(?:\\n|$))`),Q=!1;for(;E;){let ve=!1,we="",Xe="";if(!(T=q.exec(E))||this.rules.block.hr.test(E))break;we=T[0],E=E.substring(we.length);let mt=T[2].split(`
`,1)[0].replace(/^\t+/,he=>" ".repeat(3*he.length)),Vt=E.split(`
`,1)[0],vn=!mt.trim(),$t=0;if(this.options.pedantic?($t=2,Xe=mt.trimStart()):vn?$t=T[1].length+1:($t=T[2].search(/[^ ]/),$t=$t>4?1:$t,Xe=mt.slice($t),$t+=T[1].length),vn&&/^ *$/.test(Vt)&&(we+=Vt+`
`,E=E.substring(Vt.length+1),ve=!0),!ve){let he=new RegExp(`^ {0,${Math.min(3,$t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Te=new RegExp(`^ {0,${Math.min(3,$t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),Ot=new RegExp(`^ {0,${Math.min(3,$t-1)}}(?:\`\`\`|~~~)`),Tn=new RegExp(`^ {0,${Math.min(3,$t-1)}}#`);for(;E;){let Ri=E.split(`
`,1)[0];if(Vt=Ri,this.options.pedantic&&(Vt=Vt.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),Ot.test(Vt)||Tn.test(Vt)||he.test(Vt)||Te.test(E))break;if(Vt.search(/[^ ]/)>=$t||!Vt.trim())Xe+=`
`+Vt.slice($t);else{if(vn||mt.search(/[^ ]/)>=4||Ot.test(mt)||Tn.test(mt)||Te.test(mt))break;Xe+=`
`+Vt}!vn&&!Vt.trim()&&(vn=!0),we+=Ri+`
`,E=E.substring(Ri.length+1),mt=Vt.slice($t)}}B.loose||(Q?B.loose=!0:/\n *\n *$/.test(we)&&(Q=!0));let Re=null,W;this.options.gfm&&(Re=/^\[[ xX]\] /.exec(Xe),Re&&(W=Re[0]!=="[ ] ",Xe=Xe.replace(/^\[[ xX]\] +/,""))),B.items.push({type:"list_item",raw:we,task:!!Re,checked:W,loose:!1,text:Xe,tokens:[]}),B.raw+=we}B.items[B.items.length-1].raw=B.items[B.items.length-1].raw.trimEnd(),B.items[B.items.length-1].text=B.items[B.items.length-1].text.trimEnd(),B.raw=B.raw.trimEnd();for(let ve=0;ve<B.items.length;ve++)if(this.lexer.state.top=!1,B.items[ve].tokens=this.lexer.blockTokens(B.items[ve].text,[]),!B.loose){let we=B.items[ve].tokens.filter(mt=>mt.type==="space"),Xe=we.length>0&&we.some(mt=>/\n.*\n/.test(mt.raw));B.loose=Xe}if(B.loose)for(let ve=0;ve<B.items.length;ve++)B.items[ve].loose=!0;return B}}html(E){let T=this.rules.block.html.exec(E);if(T)return{type:"html",block:!0,raw:T[0],pre:T[1]==="pre"||T[1]==="script"||T[1]==="style",text:T[0]}}def(E){let T=this.rules.block.def.exec(E);if(T){let k=T[1].toLowerCase().replace(/\s+/g," "),A=T[2]?T[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",B=T[3]?T[3].substring(1,T[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):T[3];return{type:"def",tag:k,raw:T[0],href:A,title:B}}}table(E){let T=this.rules.block.table.exec(E);if(!T||!/[:|]/.test(T[2]))return;let k=g(T[1]),A=T[2].replace(/^\||\| *$/g,"").split("|"),B=T[3]&&T[3].trim()?T[3].replace(/\n[ \t]*$/,"").split(`
`):[],q={type:"table",raw:T[0],header:[],align:[],rows:[]};if(k.length===A.length){for(let Q of A)/^ *-+: *$/.test(Q)?q.align.push("right"):/^ *:-+: *$/.test(Q)?q.align.push("center"):/^ *:-+ *$/.test(Q)?q.align.push("left"):q.align.push(null);for(let Q=0;Q<k.length;Q++)q.header.push({text:k[Q],tokens:this.lexer.inline(k[Q]),header:!0,align:q.align[Q]});for(let Q of B)q.rows.push(g(Q,q.header.length).map((ve,we)=>({text:ve,tokens:this.lexer.inline(ve),header:!1,align:q.align[we]})));return q}}lheading(E){let T=this.rules.block.lheading.exec(E);if(T)return{type:"heading",raw:T[0],depth:T[2].charAt(0)==="="?1:2,text:T[1],tokens:this.lexer.inline(T[1])}}paragraph(E){let T=this.rules.block.paragraph.exec(E);if(T){let k=T[1].charAt(T[1].length-1)===`
`?T[1].slice(0,-1):T[1];return{type:"paragraph",raw:T[0],text:k,tokens:this.lexer.inline(k)}}}text(E){let T=this.rules.block.text.exec(E);if(T)return{type:"text",raw:T[0],text:T[0],tokens:this.lexer.inline(T[0])}}escape(E){let T=this.rules.inline.escape.exec(E);if(T)return{type:"escape",raw:T[0],text:c(T[1])}}tag(E){let T=this.rules.inline.tag.exec(E);if(T)return!this.lexer.state.inLink&&/^<a /i.test(T[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(T[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(T[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(T[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:T[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:T[0]}}link(E){let T=this.rules.inline.link.exec(E);if(T){let k=T[2].trim();if(!this.options.pedantic&&/^</.test(k)){if(!/>$/.test(k))return;let q=b(k.slice(0,-1),"\\");if((k.length-q.length)%2===0)return}else{let q=v(T[2],"()");if(q>-1){let ve=(T[0].indexOf("!")===0?5:4)+T[1].length+q;T[2]=T[2].substring(0,q),T[0]=T[0].substring(0,ve).trim(),T[3]=""}}let A=T[2],B="";if(this.options.pedantic){let q=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(A);q&&(A=q[1],B=q[3])}else B=T[3]?T[3].slice(1,-1):"";return A=A.trim(),/^</.test(A)&&(this.options.pedantic&&!/>$/.test(k)?A=A.slice(1):A=A.slice(1,-1)),I(T,{href:A&&A.replace(this.rules.inline.anyPunctuation,"$1"),title:B&&B.replace(this.rules.inline.anyPunctuation,"$1")},T[0],this.lexer)}}reflink(E,T){let k;if((k=this.rules.inline.reflink.exec(E))||(k=this.rules.inline.nolink.exec(E))){let A=(k[2]||k[1]).replace(/\s+/g," "),B=T[A.toLowerCase()];if(!B){let q=k[0].charAt(0);return{type:"text",raw:q,text:q}}return I(k,B,k[0],this.lexer)}}emStrong(E,T,k=""){let A=this.rules.inline.emStrongLDelim.exec(E);if(!A||A[3]&&k.match(/[\p{L}\p{N}]/u))return;if(!(A[1]||A[2]||"")||!k||this.rules.inline.punctuation.exec(k)){let q=[...A[0]].length-1,Q,ve,we=q,Xe=0,mt=A[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(mt.lastIndex=0,T=T.slice(-1*E.length+q);(A=mt.exec(T))!=null;){if(Q=A[1]||A[2]||A[3]||A[4]||A[5]||A[6],!Q)continue;if(ve=[...Q].length,A[3]||A[4]){we+=ve;continue}else if((A[5]||A[6])&&q%3&&!((q+ve)%3)){Xe+=ve;continue}if(we-=ve,we>0)continue;ve=Math.min(ve,ve+we+Xe);let Vt=[...A[0]][0].length,vn=E.slice(0,q+A.index+Vt+ve);if(Math.min(q,ve)%2){let Re=vn.slice(1,-1);return{type:"em",raw:vn,text:Re,tokens:this.lexer.inlineTokens(Re)}}let $t=vn.slice(2,-2);return{type:"strong",raw:vn,text:$t,tokens:this.lexer.inlineTokens($t)}}}}codespan(E){let T=this.rules.inline.code.exec(E);if(T){let k=T[2].replace(/\n/g," "),A=/[^ ]/.test(k),B=/^ /.test(k)&&/ $/.test(k);return A&&B&&(k=k.substring(1,k.length-1)),k=c(k,!0),{type:"codespan",raw:T[0],text:k}}}br(E){let T=this.rules.inline.br.exec(E);if(T)return{type:"br",raw:T[0]}}del(E){let T=this.rules.inline.del.exec(E);if(T)return{type:"del",raw:T[0],text:T[2],tokens:this.lexer.inlineTokens(T[2])}}autolink(E){let T=this.rules.inline.autolink.exec(E);if(T){let k,A;return T[2]==="@"?(k=c(T[1]),A="mailto:"+k):(k=c(T[1]),A=k),{type:"link",raw:T[0],text:k,href:A,tokens:[{type:"text",raw:k,text:k}]}}}url(E){let T;if(T=this.rules.inline.url.exec(E)){let k,A;if(T[2]==="@")k=c(T[0]),A="mailto:"+k;else{let B;do B=T[0],T[0]=this.rules.inline._backpedal.exec(T[0])?.[0]??"";while(B!==T[0]);k=c(T[0]),T[1]==="www."?A="http://"+T[0]:A=T[0]}return{type:"link",raw:T[0],text:k,href:A,tokens:[{type:"text",raw:k,text:k}]}}}inlineText(E){let T=this.rules.inline.text.exec(E);if(T){let k;return this.lexer.state.inRawBlock?k=T[0]:k=c(T[0]),{type:"text",raw:T[0],text:k}}}}let _=/^(?: *(?:\n|$))+/,R=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,N=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,F=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,P=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,H=/(?:[*+-]|\d{1,9}[.)])/,U=p(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,H).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),z=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,oe=/^[^\n]+/,fe=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ee=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",fe).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),X=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,H).getRegex(),se="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",te=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Z=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",te).replace("tag",se).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ye=p(z).replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",se).getRegex(),st={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ye).getRegex(),code:R,def:ee,fences:N,heading:P,hr:F,html:Z,lheading:U,list:X,newline:_,paragraph:ye,table:f,text:oe},Ze=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",se).getRegex(),ke={...st,table:Ze,paragraph:p(z).replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ze).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",se).getRegex()},$n={...st,html:p(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",te).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p(z).replace("hr",F).replace("heading",` *#{1,6} *[^
]`).replace("lheading",U).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},wn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,$i=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,go=/^( {2,}|\\)\n(?!\s*$)/,hl=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ai="\\p{P}\\p{S}",Lr=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,ai).getRegex(),_d=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,ml=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,ai).getRegex(),li=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,ai).getRegex(),gl=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,ai).getRegex(),fl=p(/\\([punct])/,"gu").replace(/punct/g,ai).getRegex(),du=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),cu=p(te).replace("(?:-->|$)","-->").getRegex(),Oe=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",cu).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),xa=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,bl=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",xa).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),vs=p(/^!?\[(label)\]\[(ref)\]/).replace("label",xa).replace("ref",fe).getRegex(),lr=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",fe).getRegex(),lm=p("reflink|nolink(?!\\()","g").replace("reflink",vs).replace("nolink",lr).getRegex(),Ed={_backpedal:f,anyPunctuation:fl,autolink:du,blockSkip:_d,br:go,code:$i,del:f,emStrongLDelim:ml,emStrongRDelimAst:li,emStrongRDelimUnd:gl,escape:wn,link:bl,nolink:lr,punctuation:Lr,reflink:vs,reflinkSearch:lm,tag:Oe,text:hl,url:f},dm={...Ed,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",xa).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",xa).getRegex()},ys={...Ed,escape:p(wn).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},cm={...ys,br:p(go).replace("{2,}","*").getRegex(),text:p(ys.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Is={normal:st,gfm:ke,pedantic:$n},Ho={normal:Ed,gfm:ys,breaks:cm,pedantic:dm};class bn{tokens;options;state;tokenizer;inlineQueue;constructor(E){this.tokens=[],this.tokens.links=Object.create(null),this.options=E||e.defaults,this.options.tokenizer=this.options.tokenizer||new S,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let T={block:Is.normal,inline:Ho.normal};this.options.pedantic?(T.block=Is.pedantic,T.inline=Ho.pedantic):this.options.gfm&&(T.block=Is.gfm,this.options.breaks?T.inline=Ho.breaks:T.inline=Ho.gfm),this.tokenizer.rules=T}static get rules(){return{block:Is,inline:Ho}}static lex(E,T){return new bn(T).lex(E)}static lexInline(E,T){return new bn(T).inlineTokens(E)}lex(E){E=E.replace(/\r\n|\r/g,`
`),this.blockTokens(E,this.tokens);for(let T=0;T<this.inlineQueue.length;T++){let k=this.inlineQueue[T];this.inlineTokens(k.src,k.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(E,T=[],k=!1){this.options.pedantic?E=E.replace(/\t/g,"    ").replace(/^ +$/gm,""):E=E.replace(/^( *)(\t+)/gm,(Q,ve,we)=>ve+"    ".repeat(we.length));let A,B,q;for(;E;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(Q=>(A=Q.call({lexer:this},E,T))?(E=E.substring(A.raw.length),T.push(A),!0):!1))){if(A=this.tokenizer.space(E)){E=E.substring(A.raw.length),A.raw.length===1&&T.length>0?T[T.length-1].raw+=`
`:T.push(A);continue}if(A=this.tokenizer.code(E)){E=E.substring(A.raw.length),B=T[T.length-1],B&&(B.type==="paragraph"||B.type==="text")?(B.raw+=`
`+A.raw,B.text+=`
`+A.text,this.inlineQueue[this.inlineQueue.length-1].src=B.text):T.push(A);continue}if(A=this.tokenizer.fences(E)){E=E.substring(A.raw.length),T.push(A);continue}if(A=this.tokenizer.heading(E)){E=E.substring(A.raw.length),T.push(A);continue}if(A=this.tokenizer.hr(E)){E=E.substring(A.raw.length),T.push(A);continue}if(A=this.tokenizer.blockquote(E)){E=E.substring(A.raw.length),T.push(A);continue}if(A=this.tokenizer.list(E)){E=E.substring(A.raw.length),T.push(A);continue}if(A=this.tokenizer.html(E)){E=E.substring(A.raw.length),T.push(A);continue}if(A=this.tokenizer.def(E)){E=E.substring(A.raw.length),B=T[T.length-1],B&&(B.type==="paragraph"||B.type==="text")?(B.raw+=`
`+A.raw,B.text+=`
`+A.raw,this.inlineQueue[this.inlineQueue.length-1].src=B.text):this.tokens.links[A.tag]||(this.tokens.links[A.tag]={href:A.href,title:A.title});continue}if(A=this.tokenizer.table(E)){E=E.substring(A.raw.length),T.push(A);continue}if(A=this.tokenizer.lheading(E)){E=E.substring(A.raw.length),T.push(A);continue}if(q=E,this.options.extensions&&this.options.extensions.startBlock){let Q=1/0,ve=E.slice(1),we;this.options.extensions.startBlock.forEach(Xe=>{we=Xe.call({lexer:this},ve),typeof we=="number"&&we>=0&&(Q=Math.min(Q,we))}),Q<1/0&&Q>=0&&(q=E.substring(0,Q+1))}if(this.state.top&&(A=this.tokenizer.paragraph(q))){B=T[T.length-1],k&&B?.type==="paragraph"?(B.raw+=`
`+A.raw,B.text+=`
`+A.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=B.text):T.push(A),k=q.length!==E.length,E=E.substring(A.raw.length);continue}if(A=this.tokenizer.text(E)){E=E.substring(A.raw.length),B=T[T.length-1],B&&B.type==="text"?(B.raw+=`
`+A.raw,B.text+=`
`+A.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=B.text):T.push(A);continue}if(E){let Q="Infinite loop on byte: "+E.charCodeAt(0);if(this.options.silent){console.error(Q);break}else throw new Error(Q)}}return this.state.top=!0,T}inline(E,T=[]){return this.inlineQueue.push({src:E,tokens:T}),T}inlineTokens(E,T=[]){let k,A,B,q=E,Q,ve,we;if(this.tokens.links){let Xe=Object.keys(this.tokens.links);if(Xe.length>0)for(;(Q=this.tokenizer.rules.inline.reflinkSearch.exec(q))!=null;)Xe.includes(Q[0].slice(Q[0].lastIndexOf("[")+1,-1))&&(q=q.slice(0,Q.index)+"["+"a".repeat(Q[0].length-2)+"]"+q.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(Q=this.tokenizer.rules.inline.blockSkip.exec(q))!=null;)q=q.slice(0,Q.index)+"["+"a".repeat(Q[0].length-2)+"]"+q.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(Q=this.tokenizer.rules.inline.anyPunctuation.exec(q))!=null;)q=q.slice(0,Q.index)+"++"+q.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;E;)if(ve||(we=""),ve=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(Xe=>(k=Xe.call({lexer:this},E,T))?(E=E.substring(k.raw.length),T.push(k),!0):!1))){if(k=this.tokenizer.escape(E)){E=E.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.tag(E)){E=E.substring(k.raw.length),A=T[T.length-1],A&&k.type==="text"&&A.type==="text"?(A.raw+=k.raw,A.text+=k.text):T.push(k);continue}if(k=this.tokenizer.link(E)){E=E.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.reflink(E,this.tokens.links)){E=E.substring(k.raw.length),A=T[T.length-1],A&&k.type==="text"&&A.type==="text"?(A.raw+=k.raw,A.text+=k.text):T.push(k);continue}if(k=this.tokenizer.emStrong(E,q,we)){E=E.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.codespan(E)){E=E.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.br(E)){E=E.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.del(E)){E=E.substring(k.raw.length),T.push(k);continue}if(k=this.tokenizer.autolink(E)){E=E.substring(k.raw.length),T.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(E))){E=E.substring(k.raw.length),T.push(k);continue}if(B=E,this.options.extensions&&this.options.extensions.startInline){let Xe=1/0,mt=E.slice(1),Vt;this.options.extensions.startInline.forEach(vn=>{Vt=vn.call({lexer:this},mt),typeof Vt=="number"&&Vt>=0&&(Xe=Math.min(Xe,Vt))}),Xe<1/0&&Xe>=0&&(B=E.substring(0,Xe+1))}if(k=this.tokenizer.inlineText(B)){E=E.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(we=k.raw.slice(-1)),ve=!0,A=T[T.length-1],A&&A.type==="text"?(A.raw+=k.raw,A.text+=k.text):T.push(k);continue}if(E){let Xe="Infinite loop on byte: "+E.charCodeAt(0);if(this.options.silent){console.error(Xe);break}else throw new Error(Xe)}}return T}}class Uo{options;parser;constructor(E){this.options=E||e.defaults}space(E){return""}code({text:E,lang:T,escaped:k}){let A=(T||"").match(/^\S*/)?.[0],B=E.replace(/\n$/,"")+`
`;return A?'<pre><code class="language-'+c(A)+'">'+(k?B:c(B,!0))+`</code></pre>
`:"<pre><code>"+(k?B:c(B,!0))+`</code></pre>
`}blockquote({tokens:E}){return`<blockquote>
${this.parser.parse(E)}</blockquote>
`}html({text:E}){return E}heading({tokens:E,depth:T}){return`<h${T}>${this.parser.parseInline(E)}</h${T}>
`}hr(E){return`<hr>
`}list(E){let T=E.ordered,k=E.start,A="";for(let Q=0;Q<E.items.length;Q++){let ve=E.items[Q];A+=this.listitem(ve)}let B=T?"ol":"ul",q=T&&k!==1?' start="'+k+'"':"";return"<"+B+q+`>
`+A+"</"+B+`>
`}listitem(E){let T="";if(E.task){let k=this.checkbox({checked:!!E.checked});E.loose?E.tokens.length>0&&E.tokens[0].type==="paragraph"?(E.tokens[0].text=k+" "+E.tokens[0].text,E.tokens[0].tokens&&E.tokens[0].tokens.length>0&&E.tokens[0].tokens[0].type==="text"&&(E.tokens[0].tokens[0].text=k+" "+E.tokens[0].tokens[0].text)):E.tokens.unshift({type:"text",raw:k+" ",text:k+" "}):T+=k+" "}return T+=this.parser.parse(E.tokens,!!E.loose),`<li>${T}</li>
`}checkbox({checked:E}){return"<input "+(E?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:E}){return`<p>${this.parser.parseInline(E)}</p>
`}table(E){let T="",k="";for(let B=0;B<E.header.length;B++)k+=this.tablecell(E.header[B]);T+=this.tablerow({text:k});let A="";for(let B=0;B<E.rows.length;B++){let q=E.rows[B];k="";for(let Q=0;Q<q.length;Q++)k+=this.tablecell(q[Q]);A+=this.tablerow({text:k})}return A&&(A=`<tbody>${A}</tbody>`),`<table>
<thead>
`+T+`</thead>
`+A+`</table>
`}tablerow({text:E}){return`<tr>
${E}</tr>
`}tablecell(E){let T=this.parser.parseInline(E.tokens),k=E.header?"th":"td";return(E.align?`<${k} align="${E.align}">`:`<${k}>`)+T+`</${k}>
`}strong({tokens:E}){return`<strong>${this.parser.parseInline(E)}</strong>`}em({tokens:E}){return`<em>${this.parser.parseInline(E)}</em>`}codespan({text:E}){return`<code>${E}</code>`}br(E){return"<br>"}del({tokens:E}){return`<del>${this.parser.parseInline(E)}</del>`}link({href:E,title:T,tokens:k}){let A=this.parser.parseInline(k),B=m(E);if(B===null)return A;E=B;let q='<a href="'+E+'"';return T&&(q+=' title="'+T+'"'),q+=">"+A+"</a>",q}image({href:E,title:T,text:k}){let A=m(E);if(A===null)return k;E=A;let B=`<img src="${E}" alt="${k}"`;return T&&(B+=` title="${T}"`),B+=">",B}text(E){return"tokens"in E&&E.tokens?this.parser.parseInline(E.tokens):E.text}}class _a{strong({text:E}){return E}em({text:E}){return E}codespan({text:E}){return E}del({text:E}){return E}html({text:E}){return E}text({text:E}){return E}link({text:E}){return""+E}image({text:E}){return""+E}br(){return""}}class ki{options;renderer;textRenderer;constructor(E){this.options=E||e.defaults,this.options.renderer=this.options.renderer||new Uo,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new _a}static parse(E,T){return new ki(T).parse(E)}static parseInline(E,T){return new ki(T).parseInline(E)}parse(E,T=!0){let k="";for(let A=0;A<E.length;A++){let B=E[A];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[B.type]){let Q=B,ve=this.options.extensions.renderers[Q.type].call({parser:this},Q);if(ve!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Q.type)){k+=ve||"";continue}}let q=B;switch(q.type){case"space":{k+=this.renderer.space(q);continue}case"hr":{k+=this.renderer.hr(q);continue}case"heading":{k+=this.renderer.heading(q);continue}case"code":{k+=this.renderer.code(q);continue}case"table":{k+=this.renderer.table(q);continue}case"blockquote":{k+=this.renderer.blockquote(q);continue}case"list":{k+=this.renderer.list(q);continue}case"html":{k+=this.renderer.html(q);continue}case"paragraph":{k+=this.renderer.paragraph(q);continue}case"text":{let Q=q,ve=this.renderer.text(Q);for(;A+1<E.length&&E[A+1].type==="text";)Q=E[++A],ve+=`
`+this.renderer.text(Q);T?k+=this.renderer.paragraph({type:"paragraph",raw:ve,text:ve,tokens:[{type:"text",raw:ve,text:ve}]}):k+=ve;continue}default:{let Q='Token with "'+q.type+'" type was not found.';if(this.options.silent)return console.error(Q),"";throw new Error(Q)}}}return k}parseInline(E,T){T=T||this.renderer;let k="";for(let A=0;A<E.length;A++){let B=E[A];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[B.type]){let Q=this.options.extensions.renderers[B.type].call({parser:this},B);if(Q!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(B.type)){k+=Q||"";continue}}let q=B;switch(q.type){case"escape":{k+=T.text(q);break}case"html":{k+=T.html(q);break}case"link":{k+=T.link(q);break}case"image":{k+=T.image(q);break}case"strong":{k+=T.strong(q);break}case"em":{k+=T.em(q);break}case"codespan":{k+=T.codespan(q);break}case"br":{k+=T.br(q);break}case"del":{k+=T.del(q);break}case"text":{k+=T.text(q);break}default:{let Q='Token with "'+q.type+'" type was not found.';if(this.options.silent)return console.error(Q),"";throw new Error(Q)}}}return k}}class vl{options;constructor(E){this.options=E||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(E){return E}postprocess(E){return E}processAllTokens(E){return E}}class Dr{defaults=t();options=this.setOptions;parse=this.parseMarkdown(bn.lex,ki.parse);parseInline=this.parseMarkdown(bn.lexInline,ki.parseInline);Parser=ki;Renderer=Uo;TextRenderer=_a;Lexer=bn;Tokenizer=S;Hooks=vl;constructor(...E){this.use(...E)}walkTokens(E,T){let k=[];for(let A of E)switch(k=k.concat(T.call(this,A)),A.type){case"table":{let B=A;for(let q of B.header)k=k.concat(this.walkTokens(q.tokens,T));for(let q of B.rows)for(let Q of q)k=k.concat(this.walkTokens(Q.tokens,T));break}case"list":{let B=A;k=k.concat(this.walkTokens(B.items,T));break}default:{let B=A;this.defaults.extensions?.childTokens?.[B.type]?this.defaults.extensions.childTokens[B.type].forEach(q=>{let Q=B[q].flat(1/0);k=k.concat(this.walkTokens(Q,T))}):B.tokens&&(k=k.concat(this.walkTokens(B.tokens,T)))}}return k}use(...E){let T=this.defaults.extensions||{renderers:{},childTokens:{}};return E.forEach(k=>{let A={...k};if(A.async=this.defaults.async||A.async||!1,k.extensions&&(k.extensions.forEach(B=>{if(!B.name)throw new Error("extension name required");if("renderer"in B){let q=T.renderers[B.name];q?T.renderers[B.name]=function(...Q){let ve=B.renderer.apply(this,Q);return ve===!1&&(ve=q.apply(this,Q)),ve}:T.renderers[B.name]=B.renderer}if("tokenizer"in B){if(!B.level||B.level!=="block"&&B.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let q=T[B.level];q?q.unshift(B.tokenizer):T[B.level]=[B.tokenizer],B.start&&(B.level==="block"?T.startBlock?T.startBlock.push(B.start):T.startBlock=[B.start]:B.level==="inline"&&(T.startInline?T.startInline.push(B.start):T.startInline=[B.start]))}"childTokens"in B&&B.childTokens&&(T.childTokens[B.name]=B.childTokens)}),A.extensions=T),k.renderer){let B=this.defaults.renderer||new Uo(this.defaults);for(let q in k.renderer){if(!(q in B))throw new Error(`renderer '${q}' does not exist`);if(["options","parser"].includes(q))continue;let Q=q,ve=k.renderer[Q],we=B[Q];B[Q]=(...Xe)=>{let mt=ve.apply(B,Xe);return mt===!1&&(mt=we.apply(B,Xe)),mt||""}}A.renderer=B}if(k.tokenizer){let B=this.defaults.tokenizer||new S(this.defaults);for(let q in k.tokenizer){if(!(q in B))throw new Error(`tokenizer '${q}' does not exist`);if(["options","rules","lexer"].includes(q))continue;let Q=q,ve=k.tokenizer[Q],we=B[Q];B[Q]=(...Xe)=>{let mt=ve.apply(B,Xe);return mt===!1&&(mt=we.apply(B,Xe)),mt}}A.tokenizer=B}if(k.hooks){let B=this.defaults.hooks||new vl;for(let q in k.hooks){if(!(q in B))throw new Error(`hook '${q}' does not exist`);if(q==="options")continue;let Q=q,ve=k.hooks[Q],we=B[Q];vl.passThroughHooks.has(q)?B[Q]=Xe=>{if(this.defaults.async)return Promise.resolve(ve.call(B,Xe)).then(Vt=>we.call(B,Vt));let mt=ve.call(B,Xe);return we.call(B,mt)}:B[Q]=(...Xe)=>{let mt=ve.apply(B,Xe);return mt===!1&&(mt=we.apply(B,Xe)),mt}}A.hooks=B}if(k.walkTokens){let B=this.defaults.walkTokens,q=k.walkTokens;A.walkTokens=function(Q){let ve=[];return ve.push(q.call(this,Q)),B&&(ve=ve.concat(B.call(this,Q))),ve}}this.defaults={...this.defaults,...A}}),this}setOptions(E){return this.defaults={...this.defaults,...E},this}lexer(E,T){return bn.lex(E,T??this.defaults)}parser(E,T){return ki.parse(E,T??this.defaults)}parseMarkdown(E,T){return(A,B)=>{let q={...B},Q={...this.defaults,...q},ve=this.onError(!!Q.silent,!!Q.async);if(this.defaults.async===!0&&q.async===!1)return ve(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof A>"u"||A===null)return ve(new Error("marked(): input parameter is undefined or null"));if(typeof A!="string")return ve(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(A)+", string expected"));if(Q.hooks&&(Q.hooks.options=Q),Q.async)return Promise.resolve(Q.hooks?Q.hooks.preprocess(A):A).then(we=>E(we,Q)).then(we=>Q.hooks?Q.hooks.processAllTokens(we):we).then(we=>Q.walkTokens?Promise.all(this.walkTokens(we,Q.walkTokens)).then(()=>we):we).then(we=>T(we,Q)).then(we=>Q.hooks?Q.hooks.postprocess(we):we).catch(ve);try{Q.hooks&&(A=Q.hooks.preprocess(A));let we=E(A,Q);Q.hooks&&(we=Q.hooks.processAllTokens(we)),Q.walkTokens&&this.walkTokens(we,Q.walkTokens);let Xe=T(we,Q);return Q.hooks&&(Xe=Q.hooks.postprocess(Xe)),Xe}catch(we){return ve(we)}}}onError(E,T){return k=>{if(k.message+=`
Please report this to https://github.com/markedjs/marked.`,E){let A="<p>An error occurred:</p><pre>"+c(k.message+"",!0)+"</pre>";return T?Promise.resolve(A):A}if(T)return Promise.reject(k);throw k}}}let Cs=new Dr;function pe(Be,E){return Cs.parse(Be,E)}pe.options=pe.setOptions=function(Be){return Cs.setOptions(Be),pe.defaults=Cs.defaults,n(pe.defaults),pe},pe.getDefaults=t,pe.defaults=e.defaults,pe.use=function(...Be){return Cs.use(...Be),pe.defaults=Cs.defaults,n(pe.defaults),pe},pe.walkTokens=function(Be,E){return Cs.walkTokens(Be,E)},pe.parseInline=Cs.parseInline,pe.Parser=ki,pe.parser=ki.parse,pe.Renderer=Uo,pe.TextRenderer=_a,pe.Lexer=bn,pe.lexer=bn.lex,pe.Tokenizer=S,pe.Hooks=vl,pe.parse=pe;let re=pe.options,O=pe.setOptions,J=pe.use,ce=pe.walkTokens,qe=pe.parseInline,vt=pe,On=ki.parse,di=bn.lex;e.Hooks=vl,e.Lexer=bn,e.Marked=Dr,e.Parser=ki,e.Renderer=Uo,e.TextRenderer=_a,e.Tokenizer=S,e.getDefaults=t,e.lexer=di,e.marked=pe,e.options=re,e.parse=vt,e.parseInline=qe,e.parser=On,e.setOptions=O,e.use=J,e.walkTokens=ce})})();var trt=ri.Hooks||exports.Hooks,nrt=ri.Lexer||exports.Lexer,irt=ri.Marked||exports.Marked,ort=ri.Parser||exports.Parser,vD=ri.Renderer||exports.Renderer,rrt=ri.TextRenderer||exports.TextRenderer,srt=ri.Tokenizer||exports.Tokenizer,bB=ri.defaults||exports.defaults,art=ri.getDefaults||exports.getDefaults,qf=ri.lexer||exports.lexer,lrt=ri.marked||exports.marked,drt=ri.options||exports.options,vB=ri.parse||exports.parse,crt=ri.parseInline||exports.parseInline,yB=ri.parser||exports.parser,urt=ri.setOptions||exports.setOptions,prt=ri.use||exports.use,hrt=ri.walkTokens||exports.walkTokens;var yD=Object.freeze({image:({href:o,title:e,text:t})=>{let n=[],i=[];return o&&({href:o,dimensions:n}=XP(o),i.push(`src="${og(o)}"`)),t&&i.push(`alt="${og(t)}"`),e&&i.push(`title="${og(e)}"`),n.length&&(i=i.concat(n)),"<img "+i.join(" ")+">"},paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>`},link({href:o,title:e,tokens:t}){let n=this.parser.parseInline(t);return typeof o!="string"?"":(o===n&&(n=iy(n)),e=typeof e=="string"?og(iy(e)):"",o=iy(o),o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${o}" title="${e||o}" draggable="false">${n}</a>`)}});function Yf(o,e={},t={}){let n=new ae,i=!1,r=_S(e),s=function(g){let b;try{b=N0(decodeURIComponent(g))}catch{}return b?(b=Lw(b,v=>{if(o.uris&&o.uris[v])return le.revive(o.uris[v])}),encodeURIComponent(JSON.stringify(b))):g},a=function(g,b){let v=o.uris&&o.uris[g],I=le.revive(v);return b?g.startsWith(Ie.data+":")?g:(I||(I=le.parse(g)),Am.uriToBrowserUri(I).toString(!0)):!I||le.parse(g).toString()===I.toString()?g:(I.query&&(I=I.with({query:s(I.query)})),I.toString())},l=new vD;l.image=yD.image,l.link=yD.link,l.paragraph=yD.paragraph;let d=[],c=[];if(e.codeBlockRendererSync?l.code=({text:g,lang:b})=>{let v=bD.nextId(),I=e.codeBlockRendererSync(IB(b),g);return c.push([v,I]),`<div class="code" data-code="${v}">${Vd(g)}</div>`}:e.codeBlockRenderer&&(l.code=({text:g,lang:b})=>{let v=bD.nextId(),I=e.codeBlockRenderer(IB(b),g);return d.push(I.then(C=>[v,C])),`<div class="code" data-code="${v}">${Vd(g)}</div>`}),e.actionHandler){let g=function(I){let C=I.target.closest("a[data-href]");if(Xn(C))try{let S=C.dataset.href;S&&(o.baseUri&&(S=ID(le.from(o.baseUri),S)),e.actionHandler.callback(S,I))}catch(S){We(S)}finally{I.preventDefault()}},b=e.actionHandler.disposables.add(new He(r,"click")),v=e.actionHandler.disposables.add(new He(r,"auxclick"));e.actionHandler.disposables.add(de.any(b.event,v.event)(I=>{let C=new Ai(ge(r),I);!C.leftButton&&!C.middleButton||g(C)})),e.actionHandler.disposables.add(Y(r,"keydown",I=>{let C=new pt(I);!C.equals(10)&&!C.equals(3)||g(C)}))}o.supportHtml||(l.html=({text:g})=>e.sanitizerOptions?.replaceWithPlaintext?Vd(g):(o.isTrusted?g.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?g:""),t.renderer=l;let u=o.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),o.supportThemeIcons&&(u=YP(u));let p;if(e.fillInIncompleteTokens){let g={...bB,...t},b=qf(u,g),v=p7(b);p=yB(v,g)}else p=vB(u,{...t,async:!1});o.supportThemeIcons&&(p=Yc(p).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let f=new DOMParser().parseFromString(CB({isTrusted:o.isTrusted,...e.sanitizerOptions},p),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(g=>{let b=g.getAttribute("src");if(b){let v=b;try{o.baseUri&&(v=ID(le.from(o.baseUri),v))}catch{}if(g.setAttribute("src",a(v,!0)),e.remoteImageIsAllowed){let I=le.parse(v);I.scheme!==Ie.file&&I.scheme!==Ie.data&&!e.remoteImageIsAllowed(I)&&g.replaceWith(xe("",void 0,g.outerHTML))}}}),f.body.querySelectorAll("a").forEach(g=>{let b=g.getAttribute("href");if(g.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!o.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))g.replaceWith(...g.childNodes);else{let v=a(b,!1);o.baseUri&&(v=ID(le.from(o.baseUri),b)),g.dataset.href=v}}),r.innerHTML=CB({isTrusted:o.isTrusted,...e.sanitizerOptions},f.body.innerHTML),d.length>0)Promise.all(d).then(g=>{if(i)return;let b=new Map(g),v=r.querySelectorAll("div[data-code]");for(let I of v){let C=b.get(I.dataset.code??"");C&&Bu(I,C)}e.asyncRenderCallback?.()});else if(c.length>0){let g=new Map(c),b=r.querySelectorAll("div[data-code]");for(let v of b){let I=g.get(v.dataset.code??"");I&&Bu(v,I)}}if(e.asyncRenderCallback)for(let g of r.getElementsByTagName("img")){let b=n.add(Y(g,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:r,dispose:()=>{i=!0,n.dispose()}}}function IB(o){if(!o)return"";let e=o.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:o}function ID(o,e){return/^\w[\w\d+.-]*:/.test(e)?e:o.path.endsWith("/")?dw(o,e).toString():dw(Ms(o),e).toString()}var r7=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function CB(o,e){let{config:t,allowedSchemes:n}=a7(o),i=new ae;i.add(SB("uponSanitizeAttribute",(r,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(r.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(r.tagName==="INPUT"&&r.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),i.add(SB("uponSanitizeElement",(r,s)=>{if(s.tagName==="input"&&(r.attributes.getNamedItem("type")?.value==="checkbox"?r.setAttribute("disabled",""):o.replaceWithPlaintext||r.remove()),o.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&r.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${r.textContent}-->`;else{let p=r7.includes(s.tagName),m=r.attributes.length?" "+Array.from(r.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${s.tagName}${m}>`,p||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=r.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?r.parentElement.ownerDocument.createTextNode(l):void 0;for(;r.firstChild;)d.appendChild(r.firstChild);u&&d.appendChild(u),r.parentElement.replaceChild(d,r)}})),i.add(_P(n));try{return Ov(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{i.dispose()}}var s7=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function a7(o){let e=[Ie.http,Ie.https,Ie.mailto,Ie.data,Ie.file,Ie.vscodeFileResource,Ie.vscodeRemote,Ie.vscodeRemoteResource];return o.isTrusted&&e.push(Ie.command),{config:{ALLOWED_TAGS:o.allowedTags??[...EP],ALLOWED_ATTR:s7,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function xB(){let o=new vD;return o.code=({text:e})=>e,o.blockquote=({text:e})=>e+`
`,o.html=e=>"",o.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.hr=()=>"",o.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},o.listitem=({text:e})=>e+`
`,o.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.table=function({header:e,rows:t}){return e.map(n=>this.tablecell(n)).join(" ")+`
`+t.map(n=>n.map(i=>this.tablecell(i)).join(" ")).join(`
`)+`
`},o.tablerow=({text:e})=>e,o.tablecell=function({tokens:e}){return this.parser.parseInline(e)},o.strong=({text:e})=>e,o.em=({text:e})=>e,o.codespan=({text:e})=>e,o.br=e=>`
`,o.del=({text:e})=>e,o.image=e=>"",o.text=({text:e})=>e,o.link=({text:e})=>e,o}var Frt=new yi(o=>xB()),Brt=new yi(()=>{let o=xB();return o.code=({text:e})=>`
\`\`\`
${e}
\`\`\`
`,o});function PS(o){let e="";return o.forEach(t=>{e+=t.raw}),e}function _B(o){if(o.tokens)for(let e=o.tokens.length-1;e>=0;e--){let t=o.tokens[e];if(t.type==="text"){let n=t.raw.split(`
`),i=n[n.length-1];if(i.includes("`"))return m7(o);if(i.includes("**"))return I7(o);if(i.match(/\*\w/))return g7(o);if(i.match(/(^|\s)__\w/))return C7(o);if(i.match(/(^|\s)_\w/))return f7(o);if(l7(i)||d7(i)&&o.tokens.slice(0,e).some(r=>r.type==="text"&&r.raw.match(/\[[^\]]*$/))){let r=o.tokens.slice(e+1);return r[0]?.type==="link"&&r[1]?.type==="text"&&r[1].raw.match(/^ *"[^"]*$/)||i.match(/^[^"]* +"[^"]*$/)?v7(o):b7(o)}else if(i.match(/(^|\s)\[\w*/))return y7(o)}}}function l7(o){return!!o.match(/(^|\s)\[.*\]\(\w*/)}function d7(o){return!!o.match(/^[^\[]*\]\([^\)]*$/)}function c7(o){let e=o.items[o.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,n;if(t?.type==="text"&&!("inRawBlock"in e)&&(n=_B(t)),!n||n.type!=="paragraph")return;let i=PS(o.items.slice(0,-1)),r=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!r)return;let s=r+PS(e.tokens.slice(0,-1))+n.raw,a=qf(i+s)[0];if(a.type==="list")return a}var u7=3;function p7(o){for(let e=0;e<u7;e++){let t=h7(o);if(t)o=t;else break}return o}function h7(o){let e,t;for(e=0;e<o.length;e++){let n=o[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=S7(o.slice(e));break}if(e===o.length-1&&n.type==="list"){let i=c7(n);if(i){t=[i];break}}if(e===o.length-1&&n.type==="paragraph"){let i=_B(n);if(i){t=[i];break}}}if(t){let n=[...o.slice(0,e),...t];return n.links=o.links,n}return null}function m7(o){return gd(o,"`")}function g7(o){return gd(o,"*")}function f7(o){return gd(o,"_")}function b7(o){return gd(o,")")}function v7(o){return gd(o,'")')}function y7(o){return gd(o,"](https://microsoft.com)")}function I7(o){return gd(o,"**")}function C7(o){return gd(o,"__")}function gd(o,e){let t=PS(Array.isArray(o)?o:[o]);return qf(t+e)[0]}function S7(o){let e=PS(o),t=e.split(`
`),n,i=!1;for(let r=0;r<t.length;r++){let s=t[r].trim();if(typeof n>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(n=a.length)}else if(typeof n=="number")if(s.match(/^\s*\|/)){if(r!==t.length-1)return;i=!0}else return}if(typeof n=="number"&&n>0){let r=i?t.slice(0,-1).join(`
`):e,s=!!r.match(/\|\s*$/),a=r+(s?"":"|")+`
|${" --- |".repeat(n)}`;return qf(a)}}function SB(o,e){return Av(o,e),Ce(()=>Fv(o))}var x7={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function vi(){return x7}var Xc=xe,EB="selectOption.entry.template",CD=class{get templateId(){return EB}renderTemplate(e){let t=Object.create(null);return t.root=e,t.text=Le(e,Xc(".option-text")),t.detail=Le(e,Xc(".option-detail")),t.decoratorRight=Le(e,Xc(".option-decorator-right")),t}renderElement(e,t,n){let i=n,r=e.text,s=e.detail,a=e.decoratorRight,l=e.isDisabled;i.text.textContent=r,i.detail.textContent=s||"",i.decoratorRight.innerText=a||"",l?i.root.classList.add("option-disabled"):i.root.classList.remove("option-disabled")}disposeTemplate(e){}},NS=class o extends V{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(e,t,n,i,r){super(),this._isVisible=!1,this.styles=i,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=o.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new L,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(n),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(vi().setupManagedHover(an("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return EB}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=xe(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Le(this.selectDropDownContainer,Xc(".select-box-details-pane"));let t=Le(this.selectDropDownContainer,Xc(".select-box-dropdown-container-width-control")),n=Le(t,Xc(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Le(n,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Os(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(Y(this.selectDropDownContainer,Ee.DRAG_START,i=>{ot.stop(i,!0)}))}registerListeners(){this._register(Ln(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(Y(this.selectElement,Ee.CLICK,t=>{ot.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(Y(this.selectElement,Ee.MOUSE_DOWN,t=>{ot.stop(t)}));let e;this._register(Y(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(Y(this.selectElement,"touchend",t=>{ot.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(Y(this.selectElement,Ee.KEY_DOWN,t=>{let n=new pt(t),i=!1;Ve?(n.keyCode===18||n.keyCode===16||n.keyCode===10||n.keyCode===3)&&(i=!0):(n.keyCode===18&&n.altKey||n.keyCode===16&&n.altKey||n.keyCode===10||n.keyCode===3)&&(i=!0),i&&(this.showSelectDropDown(),ot.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){tn(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled)),typeof n.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setEnabled(e){this.selectElement.disabled=!e}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){let e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",n=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=n}styleList(){let e=this.styles.selectBackground??"",t=Hr(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;let n=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=n,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,n)=>{this.updateDetail(n),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let t=ge(this.selectElement),n=Bi(this.selectElement),i=ge(this.selectElement).getComputedStyle(this.selectElement),r=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),s=t.innerHeight-n.top-n.height-(this.selectBoxOptions.minBottomMargin||0),a=n.top-o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let p=this._hasDetails?this._cachedMaxDetailsHeight:0,m=u+r+p,f=Math.floor((s-r-p)/this.getHeight()),g=Math.floor((a-r-p)/this.getHeight());if(e)return n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<o.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(n.top+n.height>t.innerHeight-22||n.top<o.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;m>s&&(u=f*this.getHeight())}else m>a&&(u=g*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+r+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+r+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let n=0,i=0;this.options.forEach((r,s)=>{let a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,d=r.text.length+a+l;d>i&&(n=s,i=d)}),e.textContent=this.options[n].text+(this.options[n].decoratorRight?this.options[n].decoratorRight+" ":""),t=Fu(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=Le(e,Xc(".select-box-dropdown-list-container")),this.listRenderer=new CD,this.selectList=this._register(new ho("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:i=>{let r=i.text;return i.detail&&(r+=`. ${i.detail}`),i.decoratorRight&&(r+=`. ${i.decoratorRight}`),i.description&&(r+=`. ${i.description}`),r},getWidgetAriaLabel:()=>h({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Ve?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let t=this._register(new He(this.selectDropDownListContainer,"keydown")),n=de.chain(t.event,i=>i.filter(()=>this.selectList.length>0).map(r=>new pt(r)));this._register(de.chain(n,i=>i.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(de.chain(n,i=>i.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(Y(this.selectList.getHTMLElement(),Ee.POINTER_UP,i=>this.onPointerUp(i))),this._register(this.selectList.onMouseOver(i=>typeof i.index<"u"&&this.selectList.setFocus([i.index]))),this._register(this.selectList.onDidChangeFocus(i=>this.onListFocus(i))),this._register(Y(this.selectDropDownContainer,Ee.FOCUS_OUT,i=>{!this._isVisible||fr(i.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;ot.stop(e);let t=e.target;if(!t||t.classList.contains("slider"))return;let n=t.closest(".monaco-list-row");if(!n)return;let i=Number(n.getAttribute("data-index")),r=n.classList.contains("option-disabled");i>=0&&i<this.options.length&&!r&&(this.selected=i,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){let n=r=>{for(let s=0;s<r.childNodes.length;s++){let a=r.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():n(a)}},i=Yf({value:e,supportThemeIcons:!0},{actionHandler:t});return i.element.classList.add("select-box-description-markdown"),n(i.element),i.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";let t=this.options[e],n=t?.description??"",i=t?.descriptionIsMarkdown??!1;if(n){if(i){let r=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(n,r))}else this.selectionDetailsPane.innerText=n;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){ot.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){ot.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){ot.stop(e,!0);let t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(ot.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){ot.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){ot.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){ot.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){ot.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){let t=Wm.toString(e.keyCode),n=-1;for(let i=0;i<this.options.length-1;i++)if(n=(i+this.selected+1)%this.options.length,this.options[n].text.charAt(0).toUpperCase()===t&&!this.options[n].isDisabled){this.select(n),this.selectList.setFocus([n]),this.selectList.reveal(this.selectList.getFocus()[0]),ot.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var OS=class extends V{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(e,t,n,i){super(),this.selectBoxOptions=i||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new L),this.styles=n,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(mn.addTarget(this.selectElement)),[ht.Tap].forEach(e=>{this._register(Y(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(Ln(this.selectElement,"click",e=>{ot.stop(e,!0)})),this._register(Ln(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(Ln(this.selectElement,"keydown",e=>{let t=!1;Ve?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!tn(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((n,i)=>{this.selectElement.add(this.createOption(n.text,i,n.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(e){this.selectBoxOptions.ariaLabel=e,this.selectElement.setAttribute("aria-label",e)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(e){this.selectElement.disabled=!e}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(e){this.styles=e,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,n){let i=document.createElement("option");return i.value=e,i.text=e,i.disabled=!!n,i}};var Yst={...fB,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},AS=class extends oi{selectBoxDelegate;constructor(e,t,n,i,r){super(),Ve&&!r?.useCustomDrawn?this.selectBoxDelegate=new OS(e,t,i,r):this.selectBoxDelegate=new NS(e,t,n,i,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}setAriaLabel(e){this.selectBoxDelegate.setAriaLabel(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}setEnabled(e){this.selectBoxDelegate.setEnabled(e)}render(e){this.selectBoxDelegate.render(e)}};var Ti=class extends V{constructor(t,n,i={}){super();this.options=i;this._context=t||this,this._action=n,n instanceof jl&&this._register(n.onDidChange(r=>{this.element&&this.handleActionChangeEvent(r)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new $r)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){let n=this.element=t;this._register(mn.addTarget(t));let i=this.options&&this.options.draggable;i&&(t.draggable=!0,In&&this._register(Y(t,Ee.DRAG_START,r=>r.dataTransfer?.setData(vS.TEXT,this._action.label)))),this._register(Y(n,ht.Tap,r=>this.onClick(r,!0))),this._register(Y(n,Ee.MOUSE_DOWN,r=>{i||ot.stop(r,!0),this._action.enabled&&r.button===0&&n.classList.add("active")})),Ve&&this._register(Y(n,Ee.CONTEXT_MENU,r=>{r.button===0&&r.ctrlKey===!0&&this.onClick(r)})),this._register(Y(n,Ee.CLICK,r=>{ot.stop(r,!0),this.options&&this.options.isMenu||this.onClick(r)})),this._register(Y(n,Ee.DBLCLICK,r=>{ot.stop(r,!0)})),[Ee.MOUSE_UP,Ee.MOUSE_OUT].forEach(r=>{this._register(Y(n,r,s=>{ot.stop(s),n.classList.remove("active")}))})}onClick(t,n=!1){ot.stop(t,!0);let i=Yn(this._context)?this.options?.useEventAsContext?t:{preserveFocus:n}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let t=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=t;else if(!this.customHover&&t!==""){let n=this.options.hoverDelegate??an("element");this.customHover=this._store.add(vi().setupManagedHover(n,this.element,t))}else this.customHover&&this.customHover.update(t)}updateAriaLabel(){if(this.element){let t=this.getTooltip()??"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},md=class extends Ti{label;options;cssClass;constructor(e,t,n){super(e,t,n),this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass=""}render(e){super.render(e),hi(this.element);let t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){let n=document.createElement("span");n.classList.add("keybinding"),n.textContent=this.options.keybinding,this.element.appendChild(n)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===jr.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=h({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},FS=class extends Ti{selectBox;constructor(e,t,n,i,r,s,a){super(e,t),this.selectBox=new AS(n,i,r,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(e,t){this.selectBox.setOptions(e,t)}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}};var sl=class extends oi{_onChange=this._register(new L);onChange=this._onChange.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(e){super(),this._opts=e,this._checked=this._opts.isChecked;let t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...nt.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(vi().setupManagedHover(e.hoverDelegate??an("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,n=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),n.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,n=>{if(n.keyCode===10||n.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),n.preventDefault(),n.stopPropagation();return}this._onKeyDown.fire(n)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...nt.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...nt.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(e){this._hover.update(e),this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var _7=h("caseDescription","Match Case"),E7=h("wordsDescription","Match Whole Word"),w7=h("regexDescription","Use Regular Expression"),BS=class extends sl{constructor(e){super({icon:ue.caseSensitive,title:_7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??an("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},WS=class extends sl{constructor(e){super({icon:ue.wholeWord,title:E7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??an("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},VS=class extends sl{constructor(e){super({icon:ue.regex,title:w7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??an("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}};var HS=class{constructor(e,t=0,n=e.length,i=t-1){this.items=e;this.start=t;this.end=n;this.index=i}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var US=class{_history;_limit;_navigator;constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let e=this._elements;this._navigator=new HS(e,0,e.length,e.length)}_reduceToLimit(){let e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){let e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(let t of e)this._history.add(t)}get _elements(){let e=[];return this._history.forEach(t=>e.push(t)),e}};var Xf=xe;var zS=class extends oi{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new L);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new L);onDidHeightChange=this._onDidHeightChange.event;constructor(e,t,n){super(),this.contextViewProvider=t,this.options=n,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Le(e,Xf(".monaco-inputbox.idle"));let i=this.options.flexibleHeight?"textarea":"input",r=Le(this.element,Xf(".ibwrapper"));if(this.input=Le(r,Xf(i+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Le(r,Xf("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new xS(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Le(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new He(e.ownerDocument,"selectionchange")),a=de.filter(s.event,()=>e.ownerDocument.getSelection()?.anchorNode===r);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new va(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(vi().setupManagedHover(an("mouse"),this.input,e))}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get step(){return this.input.step}set step(e){this.input.step=e}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:zv(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return Vr(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let e=this.input.selectionStart;if(e===null)return null;let t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(e){e?this.enable():this.disable()}get width(){return Fu(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){let n=parseFloat(this.mirror.style.paddingLeft||"")||0,i=parseFloat(this.mirror.style.paddingRight||"")||0;t=n+i}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let e=this.cachedContentHeight,t=this.cachedHeight,n=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:n})}showMessage(e,t){if(this.state==="open"&&cn(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));let n=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Hr(n.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){let t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t=()=>e.style.width=Fu(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:i=>{if(!this.message)return null;e=Le(i,Xf(".monaco-inputbox-container")),t();let r={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?cB(this.message.content,r):dB(this.message.content,r);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",Le(e,s),null},onHide:()=>{this.state="closed"},layout:t});let n;this.message.type===3?n=h("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?n=h("alertWarningMessage","Warning: {0}",this.message.content):n=h("alertInfoMessage","Info: {0}",this.message.content),Fl(n),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let e=this.value,n=e.charCodeAt(e.length-1)===10?" ":"";(e+n).replace(/\u000c/g,"")?this.mirror.textContent=e+n:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let e=this.options.inputBoxStyles,t=e.inputBackground??"",n=e.inputForeground??"",i=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=n,this.input.style.backgroundColor="inherit",this.input.style.color=n,this.element.style.border=`1px solid ${Hr(i,"transparent")}`}layout(){if(!this.mirror)return;let e=this.cachedContentHeight;this.cachedContentHeight=zv(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){let t=this.inputElement,n=t.selectionStart,i=t.selectionEnd,r=t.value;n!==null&&i!==null&&(this.value=r.substr(0,n)+e+r.substr(i),t.setSelectionRange(n+1,n+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},fd=class extends zS{history;observer;_onDidFocus=this._register(new L);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new L);onDidBlur=this._onDidBlur.event;constructor(e,t,n){let i=h({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),r=h({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(e,t,n),this.history=new US(n.history,100);let s=()=>{if(n.showHistoryHint&&n.showHistoryHint()&&!this.placeholder.endsWith(i)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?i:r,l=this.placeholder+a;n.showPlaceholderOnFocus&&!Vr(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return n.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(r)||a(i)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(e){let t=this.getHistory();this.clearHistory(),e.forEach(n=>{this.history.add(n)}),t.forEach(n=>{this.history.add(n)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",Bl(this.value?this.value:h("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,Bl(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var L7=h("defaultLabel","input"),Zf=class extends oi{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new Wt);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new L);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new L);onMouseDown=this._onMouseDown.event;_onInput=this._register(new L);onInput=this._onInput.event;_onKeyUp=this._register(new L);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new L);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new L);onRegexKeyDown=this._onRegexKeyDown.event;constructor(e,t,n){super(),this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||L7,this.showCommonFindToggles=!!n.showCommonFindToggles;let i=n.appendCaseSensitiveLabel||"",r=n.appendWholeWordsLabel||"",s=n.appendRegexLabel||"",a=n.history||[],l=!!n.flexibleHeight,d=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new fd(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:n.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles}));let u=this._register(_h());if(this.showCommonFindToggles){this.regex=this._register(new VS({appendTitle:s,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.regex.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(m=>{this._onRegexKeyDown.fire(m)})),this.wholeWords=this._register(new WS({appendTitle:r,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.wholeWords.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new BS({appendTitle:i,isChecked:!1,hoverDelegate:u,...n.toggleStyles})),this._register(this.caseSensitive.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(m=>{this._onCaseSensitiveKeyDown.fire(m)}));let p=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=p.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%p.length:m.equals(15)&&(f===0?g=p.length-1:g=f-1),m.equals(9)?(p[f].blur(),this.inputBox.focus()):g>=0&&p[g].focus(),ot.stop(m,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(n?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(Y(this.inputBox.inputElement,"compositionstart",p=>{this.imeSessionInProgress=!0})),this._register(Y(this.inputBox.inputElement,"compositionend",p=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,p=>this._onKeyDown.fire(p)),this.onkeyup(this.inputBox.inputElement,p=>this._onKeyUp.fire(p)),this.oninput(this.inputBox.inputElement,p=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,p=>this._onMouseDown.fire(p))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(let t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new ae;for(let t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(n=>{this._onDidOptionChange.fire(n),!n&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,n)=>t+n.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var D7=h("defaultLabel","input"),k7=h("label.preserveCaseToggle","Preserve Case"),SD=class extends sl{constructor(e){super({icon:ue.preserveCase,title:k7+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??an("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},KS=class extends oi{constructor(t,n,i,r){super();this._showOptionButtons=i;this.contextViewProvider=n,this.placeholder=r.placeholder||"",this.validation=r.validation,this.label=r.label||D7;let s=r.appendPreserveCaseLabel||"",a=r.history||[],l=!!r.flexibleHeight,d=!!r.flexibleWidth,c=r.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new fd(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:r.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:r.inputBoxStyles})),this.preserveCase=this._register(new SD({appendTitle:s,isChecked:!1,...r.toggleStyles})),this._register(this.preserveCase.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(m=>{this._onPreserveCaseKeyDown.fire(m)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let u=[this.preserveCase.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let f=u.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;m.equals(17)?g=(f+1)%u.length:m.equals(15)&&(f===0?g=u.length-1:g=f-1),m.equals(9)?(u[f].blur(),this.inputBox.focus()):g>=0&&u[g].focus(),ot.stop(m,!0)}}});let p=document.createElement("div");p.className="controls",p.style.display=this._showOptionButtons?"block":"none",p.appendChild(this.preserveCase.domNode),this.domNode.appendChild(p),t?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,m=>this._onKeyDown.fire(m)),this.onkeyup(this.inputBox.inputElement,m=>this._onKeyUp.fire(m)),this.oninput(this.inputBox.inputElement,m=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,m=>this._onMouseDown.fire(m))}static OPTION_CHANGE="optionChange";contextViewProvider;placeholder;validation;label;fixFocusOnOptionClickEnabled=!0;preserveCase;cachedOptionsWidth=0;domNode;inputBox;_onDidOptionChange=this._register(new L);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new L);onMouseDown=this._onMouseDown.event;_onInput=this._register(new L);onInput=this._onInput.event;_onKeyUp=this._register(new L);onKeyUp=this._onKeyUp.event;_onPreserveCaseKeyDown=this._register(new L);onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event;enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setFocusInputOnOptionClick(t){this.fixFocusOnOptionClickEnabled=t}setEnabled(t){t?this.enable():this.disable()}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(t){this.inputBox.value!==t&&(this.inputBox.value=t)}onSearchSubmit(){this.inputBox.addToHistory()}applyStyles(){}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(t){this.preserveCase.checked=t}focusOnPreserve(){this.preserveCase.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox?.validate()}showMessage(t){this.inputBox?.showMessage(t)}clearMessage(){this.inputBox?.hideMessage()}clearValidation(){this.inputBox?.hideMessage()}set width(t){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=t+"px"}dispose(){super.dispose()}};var YS=new me("suggestWidgetVisible",!1,h("suggestWidgetVisible","Whether suggestion are visible")),xD="historyNavigationWidgetFocus",wB="historyNavigationForwardsEnabled",TB="historyNavigationBackwardsEnabled",Qf,GS=[];function _D(o,e){if(GS.includes(e))throw new Error("Cannot register the same widget multiple times");GS.push(e);let t=new ae,n=new me(xD,!1).bindTo(o),i=new me(wB,!0).bindTo(o),r=new me(TB,!0).bindTo(o),s=()=>{n.set(!0),Qf=e},a=()=>{n.set(!1),Qf===e&&(Qf=void 0)};return Vr(e.element)&&s(),t.add(e.onDidFocus(()=>s())),t.add(e.onDidBlur(()=>a())),t.add(Ce(()=>{GS.splice(GS.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:i,historyNavigationBackwardsEnablement:r,dispose(){t.dispose()}}}var $S=class extends fd{constructor(e,t,n,i){super(e,t,n);let r=this._register(i.createScoped(this.element));this._register(_D(r,this))}};$S=K([D(3,Rt)],$S);var jS=class extends Zf{constructor(e,t,n,i){super(e,t,n);let r=this._register(i.createScoped(this.inputBox.element));this._register(_D(r,this.inputBox))}};jS=K([D(3,Rt)],jS);var qS=class extends KS{constructor(e,t,n,i,r=!1){super(e,t,r,n);let s=this._register(i.createScoped(this.inputBox.element));this._register(_D(s,this.inputBox))}};qS=K([D(3,Rt)],qS);Ha.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:De.and(De.has(xD),De.equals(TB,!0),De.not("isComposing"),YS.isEqualTo(!1)),primary:16,secondary:[528],handler:o=>{Qf?.showPreviousValue()}});Ha.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:De.and(De.has(xD),De.equals(wB,!0),De.not("isComposing"),YS.isEqualTo(!1)),primary:18,secondary:[530],handler:o=>{Qf?.showNextValue()}});var Ue={Visible:YS,HasFocusedSuggestion:new me("suggestWidgetHasFocusedSuggestion",!1,h("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new me("suggestWidgetDetailsVisible",!1,h("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new me("suggestWidgetMultipleSuggestions",!1,h("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new me("suggestionMakesTextEdit",!0,h("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new me("acceptSuggestionOnEnter",!0,h("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new me("suggestionHasInsertAndReplaceRange",!1,h("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new me("suggestionInsertMode",void 0,{type:"string",description:h("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new me("suggestionCanResolve",!1,h("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},Ca=new Fn("suggestWidgetStatusBar"),ED=class{constructor(e,t,n,i){this.position=e;this.completion=t;this.container=n;this.provider=i;this.textLabel=typeof t.label=="string"?t.label:t.label?.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),this.extensionId=t.extensionId,w.isIRange(t.range)?(this.editStart=new M(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new M(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new M(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||w.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new M(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new M(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new M(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||w.spansMultipleLines(t.range.insert)||w.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),typeof i.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}_brand;editStart;editInsertEnd;editReplaceEnd;textLabel;labelLow;sortTextLow;filterTextLow;isInvalid=!1;score=ec.Default;distance=0;idx;word;extensionId;_resolveDuration;_resolveCache;get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(e){if(!this._resolveCache){let t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),n=new qi(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(i=>{Object.assign(this.completion,i),this._resolveDuration=n.elapsed()},i=>{um(i)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{t.dispose()})}return this._resolveCache}};var Jf=class o{constructor(e=2,t=new Set,n=new Set,i=new Map,r=!0){this.snippetSortOrder=e;this.kindFilter=t;this.providerFilter=n;this.providerItemsToReuse=i;this.showDeprecated=r}static default=new o},wh;function kB(){return wh}var wD=class{constructor(e,t,n,i){this.items=e;this.needsClipboard=t;this.durations=n;this.disposable=i}};async function TD(o,e,t,n=Jf.default,i={triggerKind:0},r=Qt.None){let s=new qi;t=t.clone();let a=e.getWordAtPosition(t),l=a?new w(t.lineNumber,a.startColumn,t.lineNumber,a.endColumn):w.fromPositions(t),d={replace:l,insert:l.setEndPosition(t.lineNumber,t.column)},c=[],u=new ae,p=[],m=!1,f=(b,v,I)=>{let C=!1;if(!v)return C;for(let S of v.suggestions)if(!n.kindFilter.has(S.kind)){if(!n.showDeprecated&&S?.tags?.includes(1))continue;S.range||(S.range=d),S.sortText||(S.sortText=typeof S.label=="string"?S.label:S.label.label),!m&&S.insertTextRules&&S.insertTextRules&4&&(m=Er.guessNeedsClipboard(S.insertText)),c.push(new ED(t,S,v,b)),C=!0}return Yb(v)&&u.add(v),p.push({providerName:b._debugDisplayName??"unknown_provider",elapsedProvider:v.duration??-1,elapsedOverall:I.elapsed()}),C},g=(async()=>{if(!wh||n.kindFilter.has(27))return;let b=n.providerItemsToReuse.get(wh);if(b){b.forEach(C=>c.push(C));return}if(n.providerFilter.size>0&&!n.providerFilter.has(wh))return;let v=new qi,I=await wh.provideCompletionItems(e,t,i,r);f(wh,I,v)})();for(let b of o.orderedGroups(e)){let v=!1;if(await Promise.all(b.map(async I=>{if(n.providerItemsToReuse.has(I)){let C=n.providerItemsToReuse.get(I);C.forEach(S=>c.push(S)),v=v||C.length>0;return}if(!(n.providerFilter.size>0&&!n.providerFilter.has(I)))try{let C=new qi,S=await I.provideCompletionItems(e,t,i,r);v=f(I,S,C)||v}catch(C){wa(C)}})),v||r.isCancellationRequested)break}return await g,r.isCancellationRequested?(u.dispose(),Promise.reject(new ci)):new wD(c.sort(N7(n.snippetSortOrder)),m,{entries:p,elapsed:s.elapsed()},u)}function LD(o,e){if(o.sortTextLow&&e.sortTextLow){if(o.sortTextLow<e.sortTextLow)return-1;if(o.sortTextLow>e.sortTextLow)return 1}return o.textLabel<e.textLabel?-1:o.textLabel>e.textLabel?1:o.completion.kind-e.completion.kind}function M7(o,e){if(o.completion.kind!==e.completion.kind){if(o.completion.kind===27)return-1;if(e.completion.kind===27)return 1}return LD(o,e)}function P7(o,e){if(o.completion.kind!==e.completion.kind){if(o.completion.kind===27)return 1;if(e.completion.kind===27)return-1}return LD(o,e)}var XS=new Map;XS.set(0,M7);XS.set(2,P7);XS.set(1,LD);function N7(o){return XS.get(o)}Eo.registerCommand("_executeCompletionItemProvider",async(o,...e)=>{let[t,n,i,r]=e;hi(le.isUri(t)),hi(M.isIPosition(n)),hi(typeof i=="string"||!i),hi(typeof r=="number"||!r);let{completionProvider:s}=o.get(_r),a=await o.get(qa).createModelReference(t);try{let l={incomplete:!1,suggestions:[]},d=[],c=a.object.textEditorModel.validatePosition(n),u=await TD(s,a.object.textEditorModel,c,void 0,{triggerCharacter:i??void 0,triggerKind:i?1:0});for(let p of u.items)d.length<(r??0)&&d.push(p.resolve(Qt.None)),l.incomplete=l.incomplete||p.container.incomplete,l.suggestions.push(p.completion);try{return await Promise.all(d),l}finally{setTimeout(()=>u.disposable.dispose(),100)}}finally{a.dispose()}});function RB(o,e){o.getContribution("editor.contrib.suggestController")?.triggerSuggest(new Set().add(e),void 0,!0)}var Zc=class{static isAllOff(e){return e.other==="off"&&e.comments==="off"&&e.strings==="off"}static isAllOn(e){return e.other==="on"&&e.comments==="on"&&e.strings==="on"}static valueFor(e,t){switch(t){case 1:return e.comments;case 2:return e.strings;default:return e.other}}};var Vct=new RegExp("\\bMARK:\\s*(.*)$","d");var MB=j("editorWorkerService");var ZS=class o{async provideSelectionRanges(e,t){let n=[];for(let i of t){let r=[];n.push(r);let s=new Map;await new Promise(a=>o._bracketsRightYield(a,0,e,i,s)),await new Promise(a=>o._bracketsLeftYield(a,0,e,i,s,r))}return n}static _maxDuration=30;static _maxRounds=2;static _bracketsRightYield(e,t,n,i,r){let s=new Map,a=Date.now();for(;;){if(t>=o._maxRounds){e();break}if(!i){e();break}let l=n.bracketPairs.findNextBracket(i);if(!l){e();break}if(Date.now()-a>o._maxDuration){setTimeout(()=>o._bracketsRightYield(e,t+1,n,i,r));break}if(l.bracketInfo.isOpeningBracket){let c=l.bracketInfo.bracketText,u=s.has(c)?s.get(c):0;s.set(c,u+1)}else{let c=l.bracketInfo.getOpeningBrackets()[0].bracketText,u=s.has(c)?s.get(c):0;if(u-=1,s.set(c,Math.max(0,u)),u<0){let p=r.get(c);p||(p=new An,r.set(c,p)),p.push(l.range)}}i=l.range.getEndPosition()}}static _bracketsLeftYield(e,t,n,i,r,s){let a=new Map,l=Date.now();for(;;){if(t>=o._maxRounds&&r.size===0){e();break}if(!i){e();break}let d=n.bracketPairs.findPrevBracket(i);if(!d){e();break}if(Date.now()-l>o._maxDuration){setTimeout(()=>o._bracketsLeftYield(e,t+1,n,i,r,s));break}if(d.bracketInfo.isOpeningBracket){let u=d.bracketInfo.bracketText,p=a.has(u)?a.get(u):0;if(p-=1,a.set(u,Math.max(0,p)),p<0){let m=r.get(u);if(m){let f=m.shift();m.size===0&&r.delete(u);let g=w.fromPositions(d.range.getEndPosition(),f.getStartPosition()),b=w.fromPositions(d.range.getStartPosition(),f.getEndPosition());s.push({range:g}),s.push({range:b}),o._addBracketLeading(n,b,s)}}}else{let u=d.bracketInfo.getOpeningBrackets()[0].bracketText,p=a.has(u)?a.get(u):0;a.set(u,p+1)}i=d.range.getStartPosition()}}static _addBracketLeading(e,t,n){if(t.startLineNumber===t.endLineNumber)return;let i=t.startLineNumber,r=e.getLineFirstNonWhitespaceColumn(i);r!==0&&r!==t.startColumn&&(n.push({range:w.fromPositions(new M(i,r),t.getEndPosition())}),n.push({range:w.fromPositions(new M(i,1),t.getEndPosition())}));let s=i-1;if(s>0){let a=e.getLineFirstNonWhitespaceColumn(s);a===t.startColumn&&a!==e.getLineLastNonWhitespaceColumn(s)&&(n.push({range:w.fromPositions(new M(s,a),t.getEndPosition())}),n.push({range:w.fromPositions(new M(s,1),t.getEndPosition())}))}}};var QS=class o{static None=new class extends o{distance(){return 0}};static async create(e,t){if(!t.getOption(120).localityBonus||!t.hasModel())return o.None;let n=t.getModel(),i=t.getPosition();if(!e.canComputeWordRanges(n.uri))return o.None;let[r]=await new ZS().provideSelectionRanges(n,[i]);if(r.length===0)return o.None;let s=await e.computeWordRanges(n.uri,r[0].range);if(!s)return o.None;let a=n.getWordUntilPosition(i);return delete s[a.word],new class extends o{distance(l,d){if(!i.equals(t.getPosition()))return 0;if(d.kind===17)return 2<<20;let c=typeof d.label=="string"?d.label:d.label.label,u=s[c];if(MR(u))return 2<<20;let p=Ob(u,w.fromPositions(l),w.compareRangesUsingStarts),m=p>=0?u[p]:u[Math.max(0,~p-1)],f=r.length;for(let g of r){if(!w.containsRange(g.range,m))break;f-=1}return f}}}};var JS=j("clipboardService");var ex=class o{constructor(e,t,n,i,r,s,a=Zd.default,l=void 0){this.clipboardText=l;this._items=e,this._column=t,this._wordDistance=i,this._options=r,this._refilterKind=1,this._lineContext=n,this._fuzzyScoreOptions=a,s==="top"?this._snippetCompareFn=o._compareCompletionItemsSnippetsUp:s==="bottom"&&(this._snippetCompareFn=o._compareCompletionItemsSnippetsDown)}_items;_column;_wordDistance;_options;_snippetCompareFn=o._compareCompletionItems;_fuzzyScoreOptions;_lineContext;_refilterKind;_filteredItems;_itemsByProvider;_stats;get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();let e=new Set;for(let[t,n]of this.getItemsByProvider())n.length>0&&n[0].container.incomplete&&e.add(t);return e}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;let e=[],{leadingLineContent:t,characterCountDelta:n}=this._lineContext,i="",r="",s=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||s.length>2e3?Qd:GP;for(let d=0;d<s.length;d++){let c=s[d];if(c.isInvalid)continue;let u=this._itemsByProvider.get(c.provider);u?u.push(c):this._itemsByProvider.set(c.provider,[c]);let p=c.position.column-c.editStart.column,m=p+n-(c.position.column-this._column);if(i.length!==m&&(i=m===0?"":t.slice(-m),r=i.toLowerCase()),c.word=i,m===0)c.score=ec.Default;else{let f=0;for(;f<p;){let g=i.charCodeAt(f);if(g===32||g===9)f+=1;else break}if(f>=m)c.score=ec.Default;else if(typeof c.completion.filterText=="string"){let g=l(i,r,f,c.completion.filterText,c.filterTextLow,0,this._fuzzyScoreOptions);if(!g)continue;Co(c.completion.filterText,c.textLabel)===0?c.score=g:(c.score=UP(i,r,f,c.textLabel,c.labelLow,0),c.score[0]=g[0])}else{let g=l(i,r,f,c.textLabel,c.labelLow,0,this._fuzzyScoreOptions);if(!g)continue;c.score=g}}c.idx=d,c.distance=this._wordDistance.distance(c.position,c.completion),a.push(c),e.push(c.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?Pb(e.length-.85,e,(d,c)=>d-c):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return o._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return o._compareCompletionItems(e,t)}};var O7=j("ILanguageFeatureDebounceService"),RD;(n=>{let o=new WeakMap,e=0;function t(i){let r=o.get(i);return r===void 0&&(r=++e,o.set(i,r)),r}n.of=t})(RD||={});var DD=class{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}},kD=class{constructor(e,t,n,i,r,s){this._logService=e;this._name=t;this._registry=n;this._default=i;this._min=r;this._max=s}_cache=new Pi(50,.7);_key(e){return e.id+this._registry.all(e).reduce((t,n)=>Xm(RD.of(n),t),0)}get(e){let t=this._key(e),n=this._cache.get(t);return n?Wr(n.value,this._min,this._max):this.default()}update(e,t){let n=this._key(e),i=this._cache.get(n);i||(i=new Wv(6),this._cache.set(n,i));let r=Wr(i.update(t),this._min,this._max);return RM(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r}_overall(){let e=new Zm;for(let[,t]of this._cache)e.update(t.value);return e.value}default(){let e=this._overall()|0||this._default;return Wr(e,this._min,this._max)}},tb=class{constructor(e,t){this._logService=e;this._isDev=t.isExtensionDevelopment||!t.isBuilt}_data=new Map;_isDev;for(e,t,n){let i=n?.min??50,r=n?.max??i**2,s=n?.key??void 0,a=`${RD.of(e)},${i}${s?","+s:""}`,l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new DD(i*1.5)):l=new kD(this._logService,t,e,this._overallAverage()|0||i*1.5,i,r),this._data.set(a,l)),l}_overallAverage(){let e=new Zm;for(let t of this._data.values())e.update(t.default());return e.value}};tb=K([D(0,xn),D(1,tr)],tb);Cn(O7,tb,1);var A7=[];function PB(){return A7}function NB(o,e){return new M(o.lineNumber+e.lineNumber-1,e.lineNumber===1?o.column+e.column-1:e.column)}function MD(o,e){return new M(o.lineNumber-e.lineNumber+1,o.lineNumber-e.lineNumber===0?o.column-e.column+1:o.column)}var bd=class{constructor(e,t){this.lineNumber=e;this.parts=t}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every((t,n)=>t.equals(e.parts[n]))}render(e,t=!1){return new Ua([...this.parts.map(n=>new un(w.fromPositions(new M(this.lineNumber,n.column)),t?`[${n.lines.join(`
`)}]`:n.lines.join(`
`)))]).applyToString(e)}renderForScreenReader(e){if(this.parts.length===0)return"";let t=this.parts[this.parts.length-1],n=e.substr(0,t.column-1);return new Ua([...this.parts.map(r=>new un(w.fromPositions(new M(1,r.column)),r.lines.join(`
`)))]).applyToString(n).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every(e=>e.lines.length===0)}get lineCount(){return 1+this.parts.reduce((e,t)=>e+t.lines.length-1,0)}},Th=class{constructor(e,t,n){this.column=e;this.text=t;this.preview=n}lines=Nr(this.text);equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every((t,n)=>t===e.lines[n])}},tx=class{constructor(e,t,n,i=0){this.lineNumber=e;this.columnRange=t;this.text=n;this.additionalReservedLineCount=i}parts=[new Th(this.columnRange.endColumnExclusive,this.text,!1)];newLines=Nr(this.text);renderForScreenReader(e){return this.newLines.join(`
`)}render(e,t=!1){let n=this.columnRange.toRange(this.lineNumber);return t?new Ua([new un(w.fromPositions(n.getStartPosition()),"("),new un(w.fromPositions(n.getEndPosition()),`)[${this.newLines.join(`
`)}]`)]).applyToString(e):new Ua([new un(n,this.newLines.join(`
`))]).applyToString(e)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every(e=>e.lines.length===0)}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every((t,n)=>t===e.newLines[n])&&this.additionalReservedLineCount===e.additionalReservedLineCount}};function PD(o,e){return tn(o,e,ND)}function ND(o,e){return o===e?!0:!o||!e?!1:o instanceof bd&&e instanceof bd||o instanceof tx&&e instanceof tx?o.equals(e):!1}function OB(o,e){let t=new ap,n=new dp(t,d=>e.getLanguageConfiguration(d)),i=new cp(new OD([o]),n),r=hf(i,[],void 0,!0),s="",a=o.getLineContent();function l(d,c){if(d.kind===2)if(l(d.openingBracket,c),c=ft(c,d.openingBracket.length),d.child&&(l(d.child,c),c=ft(c,d.child.length)),d.closingBracket)l(d.closingBracket,c),c=ft(c,d.closingBracket.length);else{let p=n.getSingleLanguageBracketTokens(d.openingBracket.languageId).findClosingTokenText(d.openingBracket.bracketIds);s+=p}else if(d.kind!==3){if(d.kind===0||d.kind===1)s+=a.substring(c,ft(c,d.length));else if(d.kind===4)for(let u of d.children)l(u,c),c=ft(c,u.length)}}return l(r,fn),s}var OD=class{constructor(e){this.lines=e}getValue(){return this.lines.map(e=>e.getLineContent()).join(`
`)}getLineCount(){return this.lines.length}getLineLength(e){return this.lines[e-1].getLineContent().length}tokenization={getLineTokens:e=>this.lines[e-1]}};async function FB(o,e,t,n,i=Qt.None,r){let s=e instanceof M?F7(e,t):e,a=o.all(t),l=new _l;for(let v of a)v.groupId&&l.add(v.groupId,v);function d(v){if(!v.yieldsToGroupIds)return[];let I=[];for(let C of v.yieldsToGroupIds||[]){let S=l.get(C);for(let _ of S)I.push(_)}return I}let c=new Map,u=new Set;function p(v,I){if(I=[...I,v],u.has(v))return I;u.add(v);try{let C=d(v);for(let S of C){let _=p(S,I);if(_)return _}}finally{u.delete(v)}}function m(v){let I=c.get(v);if(I)return I;let C=p(v,[]);C&&wa(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${C.map(_=>_.toString?_.toString():""+_).join(" -> ")}`));let S=new Ps;return c.set(v,S.p),(async()=>{if(!C){let _=d(v);for(let R of _){let N=await m(R);if(N&&N.items.length>0)return}}try{return e instanceof M?await v.provideInlineCompletions(t,e,n,i):await v.provideInlineEdits?.(t,e,n,i)}catch(_){wa(_);return}})().then(_=>S.complete(_),_=>S.error(_)),S.p}let f=await Promise.all(a.map(async v=>({provider:v,completions:await m(v)}))),g=new Map,b=[];for(let v of f){let I=v.completions;if(!I)continue;let C=new FD(I,v.provider);b.push(C);for(let S of I.items){let _=BD.from(S,C,s,t,r);g.set(_.hash(),_)}}return new AD(Array.from(g.values()),new Set(g.keys()),b)}var AD=class{constructor(e,t,n){this.completions=e;this.hashs=t;this.providerResults=n}has(e){return this.hashs.has(e.hash())}dispose(){for(let e of this.providerResults)e.removeRef()}},FD=class{constructor(e,t){this.inlineCompletions=e;this.provider=t}refCount=1;addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}},BD=class o{constructor(e,t,n,i,r,s,a,l){this.filterText=e;this.command=t;this.range=n;this.insertText=i;this.snippetInfo=r;this.additionalTextEdits=s;this.sourceInlineCompletion=a;this.source=l;e=e.replace(/\r\n|\r/g,`
`),i=e.replace(/\r\n|\r/g,`
`)}static from(e,t,n,i,r){let s,a,l=e.range?w.lift(e.range):n;if(typeof e.insertText=="string"){if(s=e.insertText,r&&e.completeBracketPairs){s=AB(s,l.getStartPosition(),i,r);let d=s.length-e.insertText.length;d!==0&&(l=new w(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+d))}a=void 0}else if("snippet"in e.insertText){let d=e.insertText.snippet.length;if(r&&e.completeBracketPairs){e.insertText.snippet=AB(e.insertText.snippet,l.getStartPosition(),i,r);let u=e.insertText.snippet.length-d;u!==0&&(l=new w(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+u))}let c=new Er().parse(e.insertText.snippet);c.children.length===1&&c.children[0]instanceof zn?(s=c.children[0].value,a=void 0):(s=c.toString(),a={snippet:e.insertText.snippet,range:l})}else Md(e.insertText);return new o(s,e.command,l,s,a,e.additionalTextEdits||PB(),e,t)}withRange(e){return new o(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}toSingleTextEdit(){return new un(this.range,this.insertText)}};function F7(o,e){let t=e.getWordAtPosition(o),n=e.getLineMaxColumn(o.lineNumber);return t?new w(o.lineNumber,t.startColumn,o.lineNumber,n):w.fromPositions(o,o.with(void 0,n))}function AB(o,e,t,n){let r=t.getLineContent(e.lineNumber).substring(0,e.column-1)+o,s=cI.replace(wt.ofStartAndLength(e.column-1,r.length-(e.column-1)),o),l=t.tokenization.tokenizeLineWithEdit(e.lineNumber,s)?.mainLineTokens?.sliceAndInflate(e.column-1,r.length,0);return l?OB(l,n):o}function vd(o,e,t){let n=t?o.range.intersectRanges(t):o.range;if(!n)return o;let i=e.getValueInRange(n,1),r=Or(i,o.text),s=Si.ofText(i.substring(0,r)).addToPosition(o.range.getStartPosition()),a=o.text.substring(r),l=w.fromPositions(s,o.range.getEndPosition());return new un(l,a)}function WD(o,e){return o.text.startsWith(e.text)&&B7(o.range,e.range)}function VD(o,e,t,n,i=0){let r=vd(o,e);if(r.range.endLineNumber!==r.range.startLineNumber)return;let s=e.getLineContent(r.range.startLineNumber),a=kt(s).length;if(r.range.startColumn-1<=a){let f=kt(r.text).length,g=s.substring(r.range.startColumn-1,a),[b,v]=[r.range.getStartPosition(),r.range.getEndPosition()],I=b.column+g.length<=v.column?b.delta(0,g.length):v,C=w.fromPositions(I,v),S=r.text.startsWith(g)?r.text.substring(g.length):r.text.substring(f);r=new un(C,S)}let d=e.getValueInRange(r.range),c=W7(d,r.text);if(!c)return;let u=r.range.startLineNumber,p=new Array;if(t==="prefix"){let f=c.filter(g=>g.originalLength===0);if(f.length>1||f.length===1&&f[0].originalStart!==d.length)return}let m=r.text.length-i;for(let f of c){let g=r.range.startColumn+f.originalStart+f.originalLength;if(t==="subwordSmart"&&n&&n.lineNumber===r.range.startLineNumber&&g<n.column||f.originalLength>0)return;if(f.modifiedLength===0)continue;let b=f.modifiedStart+f.modifiedLength,v=Math.max(f.modifiedStart,Math.min(b,m)),I=r.text.substring(f.modifiedStart,v),C=r.text.substring(v,Math.max(f.modifiedStart,b));I.length>0&&p.push(new Th(g,I,!1)),C.length>0&&p.push(new Th(g,C,!0))}return new bd(u,p)}function B7(o,e){return e.getStartPosition().equals(o.getStartPosition())&&e.getEndPosition().isBeforeOrEqual(o.getEndPosition())}var nx;function W7(o,e){if(nx?.originalValue===o&&nx?.newValue===e)return nx?.changes;{let t=WB(o,e,!0);if(t){let n=BB(t);if(n>0){let i=WB(o,e,!1);i&&BB(i)<n&&(t=i)}}return nx={originalValue:o,newValue:e,changes:t},t}}function BB(o){let e=0;for(let t of o)e+=t.originalLength;return e}function WB(o,e,t){if(o.length>5e3||e.length>5e3)return;function n(d){let c=0;for(let u=0,p=d.length;u<p;u++){let m=d.charCodeAt(u);m>c&&(c=m)}return c}let i=Math.max(n(o),n(e));function r(d){if(d<0)throw new Error("unexpected");return i+d+1}function s(d){let c=0,u=0,p=new Int32Array(d.length);for(let m=0,f=d.length;m<f;m++)if(t&&d[m]==="("){let g=u*100+c;p[m]=r(2*g),c++}else if(t&&d[m]===")"){c=Math.max(c-1,0);let g=u*100+c;p[m]=r(2*g+1),c===0&&u++}else p[m]=d.charCodeAt(m);return p}let a=s(o),l=s(e);return new ep({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var Lh=class extends V{constructor(t,n,i,r,s){super();this.textModel=t;this.versionId=n;this._debounceValue=i;this.languageFeaturesService=r;this.languageConfigurationService=s;this._register(this.textModel.onDidChangeContent(()=>{this._updateOperation.clear()}))}_updateOperation=this._register(new Wt);inlineCompletions=ov("inlineCompletions",void 0);suggestWidgetInlineCompletions=ov("suggestWidgetInlineCompletions",void 0);fetch(t,n,i){let r=new UD(t,n,this.textModel.getVersionId()),s=n.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(this._updateOperation.value?.request.satisfies(r))return this._updateOperation.value.promise;if(s.get()?.request.satisfies(r))return Promise.resolve(!0);let a=!!this._updateOperation.value;this._updateOperation.clear();let l=new jn,d=(async()=>{if((a||n.triggerKind===0)&&await H7(this._debounceValue.get(this.textModel),l.token),l.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==r.versionId)return!1;let p=new Date,m=await FB(this.languageFeaturesService.inlineCompletionsProvider,t,this.textModel,n,l.token,this.languageConfigurationService);if(l.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==r.versionId)return!1;let f=new Date;this._debounceValue.update(this.textModel,f.getTime()-p.getTime());let g=new KD(m,r,this.textModel,this.versionId);if(i){let b=i.toInlineCompletion(void 0);i.canBeReused(this.textModel,t)&&!m.has(b)&&g.prepend(i.inlineCompletion,b.range,!0)}return this._updateOperation.clear(),Ma(b=>{s.set(g,b)}),!0})(),c=new zD(r,l,d);return this._updateOperation.value=c,d}clear(t){this._updateOperation.clear(),this.inlineCompletions.set(void 0,t),this.suggestWidgetInlineCompletions.set(void 0,t)}clearSuggestWidgetInlineCompletions(t){this._updateOperation.value?.request.context.selectedSuggestionInfo&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,t)}cancelUpdate(){this._updateOperation.clear()}};Lh=K([D(3,_r),D(4,Dn)],Lh);function H7(o,e){return new Promise(t=>{let n,i=setTimeout(()=>{n&&n.dispose(),t()},o);e&&(n=e.onCancellationRequested(()=>{clearTimeout(i),n&&n.dispose(),t()}))})}var UD=class{constructor(e,t,n){this.position=e;this.context=t;this.versionId=n}satisfies(e){return this.position.equals(e.position)&&rM(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,oM())&&(e.context.triggerKind===0||this.context.triggerKind===1)&&this.versionId===e.versionId}},zD=class{constructor(e,t,n){this.request=e;this.cancellationTokenSource=t;this.promise=n}dispose(){this.cancellationTokenSource.cancel()}},KD=class{constructor(e,t,n,i){this.inlineCompletionProviderResult=e;this.request=t;this._textModel=n;this._versionId=i;let r=n.deltaDecorations([],e.completions.map(s=>({range:s.range,options:{description:"inline-completion-tracking-range"}})));this._inlineCompletions=e.completions.map((s,a)=>new ix(s,r[a],this._textModel,this._versionId))}_inlineCompletions;get inlineCompletions(){return this._inlineCompletions}_refCount=1;_prependedInlineCompletionItems=[];clone(){return this._refCount++,this}dispose(){if(this._refCount--,this._refCount===0){setTimeout(()=>{this._textModel.isDisposed()||this._textModel.deltaDecorations(this._inlineCompletions.map(e=>e.decorationId),[])},0),this.inlineCompletionProviderResult.dispose();for(let e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,n){n&&e.source.addRef();let i=this._textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new ix(e,i,this._textModel,this._versionId)),this._prependedInlineCompletionItems.push(e)}},ix=class{constructor(e,t,n,i){this.inlineCompletion=e;this.decorationId=t;this._textModel=n;this._modelVersion=i}semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]);get forwardStable(){return this.inlineCompletion.source.inlineCompletions.enableForwardStability??!1}_updatedRange=Mr({owner:this,equalsFn:w.equalsRange},e=>(this._modelVersion.read(e),this._textModel.getDecorationRange(this.decorationId)));toInlineCompletion(e){return this.inlineCompletion.withRange(this._updatedRange.read(e)??HD)}toSingleTextEdit(e){return new un(this._updatedRange.read(e)??HD,this.inlineCompletion.insertText)}isVisible(e,t,n){let i=vd(this._toFilterTextReplacement(n),e),r=this._updatedRange.read(n);if(!r||!this.inlineCompletion.range.getStartPosition().equals(r.getStartPosition())||t.lineNumber!==i.range.startLineNumber)return!1;let s=e.getValueInRange(i.range,1),a=i.text,l=Math.max(0,t.column-i.range.startColumn),d=a.substring(0,l),c=a.substring(l),u=s.substring(0,l),p=s.substring(l),m=e.getLineIndentColumn(i.range.startLineNumber);return i.range.startColumn<=m&&(u=u.trimStart(),u.length===0&&(p=p.trimStart()),d=d.trimStart(),d.length===0&&(c=c.trimStart())),d.startsWith(u)&&!!Hw(p,c)}canBeReused(e,t){let n=this._updatedRange.read(void 0);return!!n&&n.containsPosition(t)&&this.isVisible(e,t,void 0)&&Si.ofRange(n).isGreaterThanOrEqualTo(Si.ofRange(this.inlineCompletion.range))}_toFilterTextReplacement(e){return new un(this._updatedRange.read(e)??HD,this.inlineCompletion.filterText)}},HD=new w(1,1,1,1);var kmt=Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,CURRENT_TIMEZONE_OFFSET:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,CURSOR_INDEX:!0,CURSOR_NUMBER:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0}),nb=class{constructor(e){this._delegates=e}resolve(e){for(let t of this._delegates){let n=t.resolve(e);if(n!==void 0)return n}}},ib=class{constructor(e,t,n,i){this._model=e;this._selection=t;this._selectionIdx=n;this._overtypingCapturer=i}resolve(e){let{name:t}=e;if(t==="SELECTION"||t==="TM_SELECTED_TEXT"){let n=this._model.getValueInRange(this._selection)||void 0,i=this._selection.startLineNumber!==this._selection.endLineNumber;if(!n&&this._overtypingCapturer){let r=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);r&&(n=r.value,i=r.multiline)}if(n&&i&&e.snippet){let r=this._model.getLineContent(this._selection.startLineNumber),s=kt(r,0,this._selection.startColumn-1),a=s;e.snippet.walk(d=>d===e?!1:(d instanceof zn&&(a=kt(Nr(d.value).pop())),!0));let l=Or(a,s);n=n.replace(/(\r\n|\r|\n)(.*)/g,(d,c,u)=>`${c}${a.substr(l)}${u}`)}return n}else{if(t==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(t==="TM_CURRENT_WORD"){let n=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return n&&n.word||void 0}else{if(t==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(t==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(t==="CURSOR_INDEX")return String(this._selectionIdx);if(t==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}},ob=class{constructor(e,t){this._labelService=e;this._model=t}resolve(e){let{name:t}=e;if(t==="TM_FILENAME")return ur(this._model.uri.fsPath);if(t==="TM_FILENAME_BASE"){let n=ur(this._model.uri.fsPath),i=n.lastIndexOf(".");return i<=0?n:n.slice(0,i)}else{if(t==="TM_DIRECTORY")return gu(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(Ms(this._model.uri));if(t==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(t==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}},rb=class{constructor(e,t,n,i){this._readClipboardText=e;this._selectionIdx=t;this._selectionCount=n;this._spread=i}resolve(e){if(e.name!=="CLIPBOARD")return;let t=this._readClipboardText();if(t){if(this._spread){let n=t.split(/\r\n|\n|\r/).filter(i=>!uv(i));if(n.length===this._selectionCount)return n[this._selectionIdx]}return t}}},Qc=class{constructor(e,t,n){this._model=e;this._selection=t;this._languageConfigurationService=n}resolve(e){let{name:t}=e,n=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),i=this._languageConfigurationService.getLanguageConfiguration(n).comments;if(i){if(t==="LINE_COMMENT")return i.lineCommentToken||void 0;if(t==="BLOCK_COMMENT_START")return i.blockCommentStartToken||void 0;if(t==="BLOCK_COMMENT_END")return i.blockCommentEndToken||void 0}}};Qc=K([D(2,Dn)],Qc);var sb=class o{static dayNames=[h("Sunday","Sunday"),h("Monday","Monday"),h("Tuesday","Tuesday"),h("Wednesday","Wednesday"),h("Thursday","Thursday"),h("Friday","Friday"),h("Saturday","Saturday")];static dayNamesShort=[h("SundayShort","Sun"),h("MondayShort","Mon"),h("TuesdayShort","Tue"),h("WednesdayShort","Wed"),h("ThursdayShort","Thu"),h("FridayShort","Fri"),h("SaturdayShort","Sat")];static monthNames=[h("January","January"),h("February","February"),h("March","March"),h("April","April"),h("May","May"),h("June","June"),h("July","July"),h("August","August"),h("September","September"),h("October","October"),h("November","November"),h("December","December")];static monthNamesShort=[h("JanuaryShort","Jan"),h("FebruaryShort","Feb"),h("MarchShort","Mar"),h("AprilShort","Apr"),h("MayShort","May"),h("JuneShort","Jun"),h("JulyShort","Jul"),h("AugustShort","Aug"),h("SeptemberShort","Sep"),h("OctoberShort","Oct"),h("NovemberShort","Nov"),h("DecemberShort","Dec")];_date=new Date;resolve(e){let{name:t}=e;if(t==="CURRENT_YEAR")return String(this._date.getFullYear());if(t==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(t==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(t==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(t==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(t==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(t==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(t==="CURRENT_DAY_NAME")return o.dayNames[this._date.getDay()];if(t==="CURRENT_DAY_NAME_SHORT")return o.dayNamesShort[this._date.getDay()];if(t==="CURRENT_MONTH_NAME")return o.monthNames[this._date.getMonth()];if(t==="CURRENT_MONTH_NAME_SHORT")return o.monthNamesShort[this._date.getMonth()];if(t==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(t==="CURRENT_TIMEZONE_OFFSET"){let n=this._date.getTimezoneOffset(),i=n>0?"-":"+",r=Math.trunc(Math.abs(n/60)),s=r<10?"0"+r:r,a=Math.abs(n)-r*60,l=a<10?"0"+a:a;return i+s+":"+l}}},ab=class{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;let t=rN(this._workspaceService.getWorkspace());if(!oN(t)){if(e.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(t);if(e.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(Gl(e))return ur(e.uri.path);let t=ur(e.configPath.path);return t.endsWith(vg)&&(t=t.substr(0,t.length-vg.length-1)),t}_resoveWorkspacePath(e){if(Gl(e))return p0(e.uri.fsPath);let t=ur(e.configPath.path),n=e.configPath.fsPath;return n.endsWith(t)&&(n=n.substr(0,n.length-t.length-1)),n?p0(n):"/"}},lb=class{resolve(e){let{name:t}=e;if(t==="RANDOM")return Math.random().toString().slice(-6);if(t==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(t==="UUID")return Ks()}};var ox=class o{constructor(e,t,n){this._editor=e;this._snippet=t;this._snippetLineLeadingWhitespace=n;this._placeholderGroups=pE(t.placeholders,Fo.compareByIndex),this._placeholderGroupsIdx=-1}_placeholderDecorations;_placeholderGroups;_offset=-1;_placeholderGroupsIdx;_nestingLevel=1;static _decor={active:En.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:En.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:En.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:En.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};initialize(e){this._offset=e.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;let e=this._editor.getModel();this._editor.changeDecorations(t=>{for(let n of this._snippet.placeholders){let i=this._snippet.offset(n),r=this._snippet.fullLen(n),s=w.fromPositions(e.getPositionAt(this._offset+i),e.getPositionAt(this._offset+i+r)),a=n.isFinalTabstop?o._decor.inactiveFinal:o._decor.inactive,l=t.addDecoration(s,a);this._placeholderDecorations.set(n,l)}})}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let i=[];for(let r of this._placeholderGroups[this._placeholderGroupsIdx])if(r.transform){let s=this._placeholderDecorations.get(r),a=this._editor.getModel().getDecorationRange(s),l=this._editor.getModel().getValueInRange(a),d=r.transform.resolve(l).split(/\r\n|\r|\n/);for(let c=1;c<d.length;c++)d[c]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+d[c]);i.push(wo.replace(a,d.join(this._editor.getModel().getEOL())))}i.length>0&&this._editor.executeEdits("snippet.placeholderTransform",i)}let t=!1;e===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):e===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);let n=this._editor.getModel().changeDecorations(i=>{let r=new Set,s=[];for(let a of this._placeholderGroups[this._placeholderGroupsIdx]){let l=this._placeholderDecorations.get(a),d=this._editor.getModel().getDecorationRange(l);s.push(new Me(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(a),i.changeDecorationOptions(l,a.isFinalTabstop?o._decor.activeFinal:o._decor.active),r.add(a);for(let c of this._snippet.enclosingPlaceholders(a)){let u=this._placeholderDecorations.get(c);i.changeDecorationOptions(u,c.isFinalTabstop?o._decor.activeFinal:o._decor.active),r.add(c)}}for(let[a,l]of this._placeholderDecorations)r.has(a)||i.changeDecorationOptions(l,a.isFinalTabstop?o._decor.inactiveFinal:o._decor.inactive);return s});return t?this.move(e):n??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof Fo){let n=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(n).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){let[e]=this._snippet.placeholders;if(e.isFinalTabstop&&this._snippet.rightMostDescendant===e)return!0}return!1}computePossibleSelections(){let e=new Map;for(let t of this._placeholderGroups){let n;for(let i of t){if(i.isFinalTabstop)break;n||(n=[],e.set(i.index,n));let r=this._placeholderDecorations.get(i),s=this._editor.getModel().getDecorationRange(r);if(!s){e.delete(i.index);break}n.push(s)}}return e}get activeChoice(){if(!this._placeholderDecorations)return;let e=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!e?.choice)return;let t=this._placeholderDecorations.get(e);if(!t)return;let n=this._editor.getModel().getDecorationRange(t);if(n)return{range:n,choice:e.choice}}get hasChoice(){let e=!1;return this._snippet.walk(t=>(e=t instanceof $c,!e)),e}merge(e){let t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(n=>{for(let i of this._placeholderGroups[this._placeholderGroupsIdx]){let r=e.shift();console.assert(r._offset!==-1),console.assert(!r._placeholderDecorations);let s=r._snippet.placeholderInfo.last.index;for(let l of r._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=i.index+(s+1)/this._nestingLevel:l.index=i.index+l.index/this._nestingLevel;this._snippet.replace(i,r._snippet.children);let a=this._placeholderDecorations.get(i);n.removeDecoration(a),this._placeholderDecorations.delete(i);for(let l of r._snippet.placeholders){let d=r._snippet.offset(l),c=r._snippet.fullLen(l),u=w.fromPositions(t.getPositionAt(r._offset+d),t.getPositionAt(r._offset+d+c)),p=n.addDecoration(u,o._decor.inactive);this._placeholderDecorations.set(l,p)}}this._placeholderGroups=pE(this._snippet.placeholders,Fo.compareByIndex)})}getEnclosingRange(){let e,t=this._editor.getModel();for(let n of this._placeholderDecorations.values()){let i=t.getDecorationRange(n)??void 0;e?e=e.plusRange(i):e=i}return e}},VB={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},Li=class{constructor(e,t,n=VB,i){this._editor=e;this._template=t;this._options=n;this._languageConfigurationService=i}static adjustWhitespace(e,t,n,i,r){let s=e.getLineContent(t.lineNumber),a=kt(s,0,t.column-1),l;return i.walk(d=>{if(!(d instanceof zn)||d.parent instanceof $c||r&&!r.has(d))return!0;let c=d.value.split(/\r\n|\r|\n/);if(n){let p=i.offset(d);if(p===0)c[0]=e.normalizeIndentation(c[0]);else{l=l??i.toString();let m=l.charCodeAt(p-1);(m===10||m===13)&&(c[0]=e.normalizeIndentation(a+c[0]))}for(let m=1;m<c.length;m++)c[m]=e.normalizeIndentation(a+c[m])}let u=c.join(e.getEOL());return u!==d.value&&(d.parent.replace(d,[new zn(u)]),l=void 0),!0}),a}static adjustSelection(e,t,n,i){if(n!==0||i!==0){let{positionLineNumber:r,positionColumn:s}=t,a=s-n,l=s+i,d=e.validateRange({startLineNumber:r,startColumn:a,endLineNumber:r,endColumn:l});t=Me.createWithDirection(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn,t.getDirection())}return t}static createEditsAndSnippetsFromSelections(e,t,n,i,r,s,a,l,d){let c=[],u=[];if(!e.hasModel())return{edits:c,snippets:u};let p=e.getModel(),m=e.invokeWithinContext(S=>S.get(to)),f=e.invokeWithinContext(S=>new ob(S.get(Ao),p)),g=()=>a,b=p.getValueInRange(Li.adjustSelection(p,e.getSelection(),n,0)),v=p.getValueInRange(Li.adjustSelection(p,e.getSelection(),0,i)),I=p.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber),C=e.getSelections().map((S,_)=>({selection:S,idx:_})).sort((S,_)=>w.compareRangesUsingStarts(S.selection,_.selection));for(let{selection:S,idx:_}of C){let R=Li.adjustSelection(p,S,n,0),N=Li.adjustSelection(p,S,0,i);b!==p.getValueInRange(R)&&(R=S),v!==p.getValueInRange(N)&&(N=S);let F=S.setStartPosition(R.startLineNumber,R.startColumn).setEndPosition(N.endLineNumber,N.endColumn),P=new Er().parse(t,!0,r),H=F.getStartPosition(),U=Li.adjustWhitespace(p,H,s||_>0&&I!==p.getLineFirstNonWhitespaceColumn(S.positionLineNumber),P);P.resolveVariables(new nb([f,new rb(g,_,C.length,e.getOption(80)==="spread"),new ib(p,S,_,l),new Qc(p,S,d),new sb,new ab(m),new lb])),c[_]=wo.replace(F,P.toString()),c[_].identifier={major:_,minor:0},c[_]._isTracked=!0,u[_]=new ox(e,P,U)}return{edits:c,snippets:u}}static createEditsAndSnippetsFromEdits(e,t,n,i,r,s,a){if(!e.hasModel()||t.length===0)return{edits:[],snippets:[]};let l=[],d=e.getModel(),c=new Er,u=new Ih,p=new nb([e.invokeWithinContext(f=>new ob(f.get(Ao),d)),new rb(()=>r,0,e.getSelections().length,e.getOption(80)==="spread"),new ib(d,e.getSelection(),0,s),new Qc(d,e.getSelection(),a),new sb,new ab(e.invokeWithinContext(f=>f.get(to))),new lb]);t=t.sort((f,g)=>w.compareRangesUsingStarts(f.range,g.range));let m=0;for(let f=0;f<t.length;f++){let{range:g,template:b}=t[f];if(f>0){let _=t[f-1].range,R=w.fromPositions(_.getEndPosition(),g.getStartPosition()),N=new zn(d.getValueInRange(R));u.appendChild(N),m+=N.value.length}let v=c.parseFragment(b,u);Li.adjustWhitespace(d,g.getStartPosition(),!0,u,new Set(v)),u.resolveVariables(p);let I=u.toString(),C=I.slice(m);m=I.length;let S=wo.replace(g,C);S.identifier={major:f,minor:0},S._isTracked=!0,l.push(S)}return c.ensureFinalTabstop(u,n,!0),{edits:l,snippets:[new ox(e,u,"")]}}_templateMerges=[];_snippets=[];dispose(){yt(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;let{edits:e,snippets:t}=typeof this._template=="string"?Li.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):Li.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=t,this._editor.executeEdits("snippet",e,n=>{let i=n.filter(r=>!!r.identifier);for(let r=0;r<t.length;r++)t[r].initialize(i[r].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):i.map(r=>Me.fromPositions(r.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=VB){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);let{edits:n,snippets:i}=Li.createEditsAndSnippetsFromSelections(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",n,r=>{let s=r.filter(l=>!!l.identifier);for(let l=0;l<i.length;l++)i[l].initialize(s[l].textChange);let a=i[0].isTrivialSnippet;if(!a){for(let l of this._snippets)l.merge(i);console.assert(i.length===0)}return this._snippets[0].hasPlaceholder&&!a?this._move(void 0):s.map(l=>Me.fromPositions(l.range.getEndPosition()))})}next(){let e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){let e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){let t=[];for(let n of this._snippets){let i=n.move(e);t.push(...i)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;let e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;let t=new Map;for(let n of this._snippets){let i=n.computePossibleSelections();if(t.size===0)for(let[r,s]of i){s.sort(w.compareRangesUsingStarts);for(let a of e)if(s[0].containsRange(a)){t.set(r,[]);break}}if(t.size===0)return!1;t.forEach((r,s)=>{r.push(...i.get(s))})}e.sort(w.compareRangesUsingStarts);for(let[n,i]of t){if(i.length!==e.length){t.delete(n);continue}i.sort(w.compareRangesUsingStarts);for(let r=0;r<i.length;r++)if(!i[r].containsRange(e[r])){t.delete(n);continue}}return t.size>0}getEnclosingRange(){let e;for(let t of this._snippets){let n=t.getEnclosingRange();e?e=e.plusRange(n):e=n}return e}};Li=K([D(3,Dn)],Li);var rx=class extends V{constructor(t,n,i,r,s,a,l,d,c,u,p,m){super();this.textModel=t;this.selectedSuggestItem=n;this._textModelVersionId=i;this._positions=r;this._debounceValue=s;this._suggestPreviewEnabled=a;this._suggestPreviewMode=l;this._inlineSuggestMode=d;this._enabled=c;this._instantiationService=u;this._commandService=p;this._languageConfigurationService=m;this._register(nv(this._fetchInlineCompletionsPromise));let f;this._register(jo(g=>{let v=this.state.read(g)?.inlineCompletion;if(v?.semanticId!==f?.semanticId&&(f=v,v)){let I=v.inlineCompletion,C=I.source;C.provider.handleItemDidShow?.(C.inlineCompletions,I.sourceInlineCompletion,I.insertText)}}))}_source=this._register(this._instantiationService.createInstance(Lh,this.textModel,this._textModelVersionId,this._debounceValue));_isActive=yu(this,!1);_forceUpdateExplicitlySignal=NE(this);_selectedInlineCompletionId=yu(this,void 0);_primaryPosition=Tl(this,t=>this._positions.read(t)[0]??new M(1,1));_isAcceptingPartially=!1;get isAcceptingPartially(){return this._isAcceptingPartially}_preserveCurrentCompletionReasons=new Set([1,0,2]);_getReason(t){return t?.isUndoing?0:t?.isRedoing?1:this.isAcceptingPartially?2:3}_fetchInlineCompletionsPromise=RE({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:0}),handleChange:(t,n)=>(t.didChange(this._textModelVersionId)&&this._preserveCurrentCompletionReasons.has(this._getReason(t.change))?n.preserveCurrentCompletion=!0:t.didChange(this._forceUpdateExplicitlySignal)&&(n.inlineCompletionTriggerKind=1),!0)},(t,n)=>{if(this._forceUpdateExplicitlySignal.read(t),!(this._enabled.read(t)&&this.selectedSuggestItem.read(t)||this._isActive.read(t))){this._source.cancelUpdate();return}this._textModelVersionId.read(t);let r=this._source.suggestWidgetInlineCompletions.get(),s=this.selectedSuggestItem.read(t);if(r&&!s){let u=this._source.inlineCompletions.get();Ma(p=>{(!u||r.request.versionId>u.request.versionId)&&this._source.inlineCompletions.set(r.clone(),p),this._source.clearSuggestWidgetInlineCompletions(p)})}let a=this._primaryPosition.read(t),l={triggerKind:n.inlineCompletionTriggerKind,selectedSuggestionInfo:s?.toSelectedSuggestionInfo()},d=this.selectedInlineCompletion.get(),c=n.preserveCurrentCompletion||d?.forwardStable?d:void 0;return this._source.fetch(a,l,c)});async trigger(t){this._isActive.set(!0,t),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(t){vu(t,n=>{this._isActive.set(!0,n),this._forceUpdateExplicitlySignal.trigger(n)}),await this._fetchInlineCompletionsPromise.get()}stop(t){vu(t,n=>{this._isActive.set(!1,n),this._source.clear(n)})}_filteredInlineCompletionItems=Mr({owner:this,equalsFn:LE()},t=>{let n=this._source.inlineCompletions.read(t);if(!n)return[];let i=this._primaryPosition.read(t);return n.inlineCompletions.filter(s=>s.isVisible(this.textModel,i,t))});selectedInlineCompletionIndex=Tl(this,t=>{let n=this._selectedInlineCompletionId.read(t),i=this._filteredInlineCompletionItems.read(t),r=this._selectedInlineCompletionId===void 0?-1:i.findIndex(s=>s.semanticId===n);return r===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):r});selectedInlineCompletion=Tl(this,t=>{let n=this._filteredInlineCompletionItems.read(t),i=this.selectedInlineCompletionIndex.read(t);return n[i]});activeCommands=Mr({owner:this,equalsFn:LE()},t=>this.selectedInlineCompletion.read(t)?.inlineCompletion.source.inlineCompletions.commands??[]);lastTriggerKind=this._source.inlineCompletions.map(this,t=>t?.request.context.triggerKind);inlineCompletionsCount=Tl(this,t=>{if(this.lastTriggerKind.read(t)===1)return this._filteredInlineCompletionItems.read(t).length});state=Mr({owner:this,equalsFn:(t,n)=>!t||!n?t===n:PD(t.ghostTexts,n.ghostTexts)&&t.inlineCompletion===n.inlineCompletion&&t.suggestItem===n.suggestItem},t=>{let n=this.textModel,i=this.selectedSuggestItem.read(t);if(i){let r=vd(i.toSingleTextEdit(),n),s=this._computeAugmentation(r,t);if(!this._suggestPreviewEnabled.read(t)&&!s)return;let l=s?.edit??r,d=s?s.edit.text.length-r.text.length:0,c=this._suggestPreviewMode.read(t),u=this._positions.read(t),p=[l,...GD(this.textModel,u,l)],m=p.map((g,b)=>VD(g,n,c,u[b],d)).filter(Hd),f=m[0]??new bd(l.range.endLineNumber,[]);return{edits:p,primaryGhostText:f,ghostTexts:m,inlineCompletion:s?.completion,suggestItem:i}}else{if(!this._isActive.read(t))return;let r=this.selectedInlineCompletion.read(t);if(!r)return;let s=r.toSingleTextEdit(t),a=this._inlineSuggestMode.read(t),l=this._positions.read(t),d=[s,...GD(this.textModel,l,s)],c=d.map((u,p)=>VD(u,n,a,l[p],0)).filter(Hd);return c[0]?{edits:d,primaryGhostText:c[0],ghostTexts:c,inlineCompletion:r,suggestItem:void 0}:void 0}});_computeAugmentation(t,n){let i=this.textModel,r=this._source.suggestWidgetInlineCompletions.read(n),s=r?r.inlineCompletions:[this.selectedInlineCompletion.read(n)].filter(Hd);return RR(s,l=>{let d=l.toSingleTextEdit(n);return d=vd(d,i,w.fromPositions(d.range.getStartPosition(),t.range.getEndPosition())),WD(d,t)?{completion:l,edit:d}:void 0})}ghostTexts=Mr({owner:this,equalsFn:PD},t=>{let n=this.state.read(t);if(n)return n.ghostTexts});primaryGhostText=Mr({owner:this,equalsFn:ND},t=>{let n=this.state.read(t);if(n)return n?.primaryGhostText});async _deltaSelectedInlineCompletionIndex(t){await this.triggerExplicitly();let n=this._filteredInlineCompletionItems.get()||[];if(n.length>0){let i=(this.selectedInlineCompletionIndex.get()+t+n.length)%n.length;this._selectedInlineCompletionId.set(n[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(t){if(t.getModel()!==this.textModel)throw new $e;let n=this.state.get();if(!n||n.primaryGhostText.isEmpty()||!n.inlineCompletion)return;let i=n.inlineCompletion.toInlineCompletion(void 0);if(i.command&&i.source.addRef(),t.pushUndoStop(),i.snippetInfo)t.executeEdits("inlineSuggestion.accept",[wo.replace(i.range,""),...i.additionalTextEdits]),t.setPosition(i.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),Zt.get(t)?.insert(i.snippetInfo.snippet,{undoStopBefore:!1});else{let r=n.edits,s=HB(r).map(a=>Me.fromPositions(a));t.executeEdits("inlineSuggestion.accept",[...r.map(a=>wo.replace(a.range,a.text)),...i.additionalTextEdits]),t.setSelections(s,"inlineCompletionAccept")}this.stop(),i.command&&(await this._commandService.executeCommand(i.command.id,...i.command.arguments||[]).then(void 0,wa),i.source.removeRef())}async acceptNextWord(t){await this._acceptNext(t,(n,i)=>{let r=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column),s=this._languageConfigurationService.getLanguageConfiguration(r),a=new RegExp(s.wordDefinition.source,s.wordDefinition.flags.replace("g","")),l=i.match(a),d=0;l&&l.index!==void 0?l.index===0?d=l[0].length:d=l.index:d=i.length;let u=/\s+/g.exec(i);return u&&u.index!==void 0&&u.index+u[0].length<d&&(d=u.index+u[0].length),d},0)}async acceptNextLine(t){await this._acceptNext(t,(n,i)=>{let r=i.match(/\n/);return r&&r.index!==void 0?r.index+1:i.length},1)}async _acceptNext(t,n,i){if(t.getModel()!==this.textModel)throw new $e;let r=this.state.get();if(!r||r.primaryGhostText.isEmpty()||!r.inlineCompletion)return;let s=r.primaryGhostText,a=r.inlineCompletion.toInlineCompletion(void 0);if(a.snippetInfo||a.filterText!==a.insertText){await this.accept(t);return}let l=s.parts[0],d=new M(s.lineNumber,l.column),c=l.text,u=n(d,c);if(u===c.length&&s.parts.length===1){this.accept(t);return}let p=c.substring(0,u),m=this._positions.get(),f=m[0];a.source.addRef();try{this._isAcceptingPartially=!0;try{t.pushUndoStop();let g=w.fromPositions(f,d),b=t.getModel().getValueInRange(g)+p,v=new un(g,b),I=[v,...GD(this.textModel,m,v)],C=HB(I).map(S=>Me.fromPositions(S));t.executeEdits("inlineSuggestion.accept",I.map(S=>wo.replace(S.range,S.text))),t.setSelections(C,"inlineCompletionPartialAccept"),t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1)}finally{this._isAcceptingPartially=!1}if(a.source.provider.handlePartialAccept){let g=w.fromPositions(a.range.getStartPosition(),Si.ofText(p).addToPosition(d)),b=t.getModel().getValueInRange(g,1);a.source.provider.handlePartialAccept(a.source.inlineCompletions,a.sourceInlineCompletion,b.length,{kind:i})}}finally{a.source.removeRef()}}handleSuggestAccepted(t){let n=vd(t.toSingleTextEdit(),this.textModel),i=this._computeAugmentation(n,void 0);if(!i)return;let r=i.completion.inlineCompletion;r.source.provider.handlePartialAccept?.(r.source.inlineCompletions,r.sourceInlineCompletion,n.text.length,{kind:2})}};rx=K([D(9,dt),D(10,qr),D(11,Dn)],rx);function GD(o,e,t){if(e.length===1)return[];let n=e[0],i=e.slice(1),r=t.range.getStartPosition(),s=t.range.getEndPosition(),a=o.getValueInRange(w.fromPositions(n,s)),l=MD(n,r);if(l.lineNumber<1)return We(new $e(`positionWithinTextEdit line number should be bigger than 0.
			Invalid subtraction between ${n.toString()} and ${r.toString()}`)),[];let d=U7(t.text,l);return i.map(c=>{let u=NB(MD(c,r),s),p=o.getValueInRange(w.fromPositions(c,u)),m=Or(a,p),f=w.fromPositions(c,c.delta(0,m));return new un(f,d)})}function U7(o,e){let t="",n=TM(o);for(let i=e.lineNumber-1;i<n.length;i++)t+=n[i].substring(i===e.lineNumber-1?e.column-1:0);return t}function HB(o){let e=Nb.createSortPermutation(o,Es(r=>r.range,w.compareRangesUsingStarts)),n=new Ua(e.apply(o)).getNewRanges();return e.inverse().apply(n).map(r=>r.getEndPosition())}var Dh=class o extends V{constructor(t,n){super();this.contextKeyService=t;this.model=n;this._register(jo(i=>{let s=this.model.read(i)?.state.read(i),a=!!s?.inlineCompletion&&s?.primaryGhostText!==void 0&&!s?.primaryGhostText.isEmpty();this.inlineCompletionVisible.set(a),s?.primaryGhostText&&s?.inlineCompletion&&this.suppressSuggestions.set(s.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(jo(i=>{let r=this.model.read(i),s=!1,a=!0,l=r?.primaryGhostText.read(i);if(r?.selectedSuggestItem&&l&&l.parts.length>0){let{column:d,lines:c}=l.parts[0],u=c[0],p=r.textModel.getLineIndentColumn(l.lineNumber);if(d<=p){let f=zt(u);f===-1&&(f=u.length-1),s=f>0;let g=r.textModel.getOptions().tabSize;a=Ct.visibleColumnFromColumn(u,f+1,g)<g}}this.inlineCompletionSuggestsIndentation.set(s),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(a)}))}static inlineSuggestionVisible=new me("inlineSuggestionVisible",!1,h("inlineSuggestionVisible","Whether an inline suggestion is visible"));static inlineSuggestionHasIndentation=new me("inlineSuggestionHasIndentation",!1,h("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace"));static inlineSuggestionHasIndentationLessThanTabSize=new me("inlineSuggestionHasIndentationLessThanTabSize",!0,h("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab"));static suppressSuggestions=new me("inlineSuggestionSuppressSuggestions",void 0,h("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"));inlineCompletionVisible=o.inlineSuggestionVisible.bindTo(this.contextKeyService);inlineCompletionSuggestsIndentation=o.inlineSuggestionHasIndentation.bindTo(this.contextKeyService);inlineCompletionSuggestsIndentationLessThanTabSize=o.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService);suppressSuggestions=o.suppressSuggestions.bindTo(this.contextKeyService)};var al=class{static shouldAutoTrigger(e){if(!e.hasModel())return!1;let t=e.getModel(),n=e.getPosition();t.tokenization.tokenizeIfCheap(n.lineNumber);let i=t.getWordAtPosition(n);return!(!i||i.endColumn!==n.column&&i.startColumn+1!==n.column||!isNaN(Number(i.word)))}lineNumber;column;leadingLineContent;leadingWord;triggerOptions;constructor(e,t,n){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.triggerOptions=n}};function z7(o,e,t){if(!e.getContextKeyValue(Dh.inlineSuggestionVisible.key))return!0;let n=e.getContextKeyValue(Dh.suppressSuggestions.key);return n!==void 0?!n:!o.getOption(63).suppressSuggestions}function K7(o,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;let n=e.getContextKeyValue(Dh.suppressSuggestions.key);return n!==void 0?!n:!o.getOption(63).suppressSuggestions}var yd=class{constructor(e,t,n,i,r,s,a,l,d){this._editor=e;this._editorWorkerService=t;this._clipboardService=n;this._telemetryService=i;this._logService=r;this._contextKeyService=s;this._configurationService=a;this._languageFeaturesService=l;this._envService=d;this._currentSelection=this._editor.getSelection()||new Me(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let c=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{c=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{c=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(u=>{c||this._onCursorChange(u)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!c&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}_toDispose=new ae;_triggerCharacterListener=new ae;_triggerQuickSuggest=new Zi;_triggerState=void 0;_requestToken;_context;_currentSelection;_completionModel;_completionDisposables=new ae;_onDidCancel=new L;_onDidTrigger=new L;_onDidSuggest=new L;onDidCancel=this._onDidCancel.event;onDidTrigger=this._onDidTrigger.event;onDidSuggest=this._onDidSuggest.event;dispose(){yt(this._triggerCharacterListener),yt([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(93)||!this._editor.hasModel()||!this._editor.getOption(123))return;let e=new Map;for(let n of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(let i of n.triggerCharacters||[]){let r=e.get(i);if(!r){r=new Set;let s=kB();s&&r.add(s),e.set(i,r)}r.add(n)}let t=n=>{if(!K7(this._editor,this._contextKeyService,this._configurationService)||al.shouldAutoTrigger(this._editor))return;if(!n){let s=this._editor.getPosition();n=this._editor.getModel().getLineContent(s.lineNumber).substr(0,s.column-1)}let i="";ks(n.charCodeAt(n.length-1))?At(n.charCodeAt(n.length-2))&&(i=n.substr(n.length-2)):i=n.charAt(n.length-1);let r=e.get(i);if(r){let s=new Map;if(this._completionModel)for(let[a,l]of this._completionModel.getItemsByProvider())r.has(a)||s.set(a,l);this.trigger({auto:!0,triggerKind:1,triggerCharacter:i,retrigger:!!this._completionModel,clipboardText:this._completionModel?.clipboardText,completionOptions:{providerFilter:r,providerItemsToReuse:s}})}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>t()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(e=!1){this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),this._requestToken?.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(e){if(!this._editor.hasModel())return;let t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!=="keyboard"&&e.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){Zc.isAllOff(this._editor.getOption(91))||this._editor.getOption(120).snippetsPreventQuickSuggestions&&Zt.get(this._editor)?.isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!al.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;let e=this._editor.getModel(),t=this._editor.getPosition(),n=this._editor.getOption(91);if(!Zc.isAllOff(n)){if(!Zc.isAllOn(n)){e.tokenization.tokenizeIfCheap(t.lineNumber);let i=e.tokenization.getLineTokens(t.lineNumber),r=i.getStandardTokenType(i.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(Zc.valueFor(n,r)!=="on")return}z7(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(e)&&this.trigger({auto:!0})}},this._editor.getOption(92)))}_refilterCompletionItems(){hi(this._editor.hasModel()),hi(this._triggerState!==void 0);let e=this._editor.getModel(),t=this._editor.getPosition(),n=new al(e,t,{...this._triggerState,refilter:!0});this._onNewContext(n)}trigger(e){if(!this._editor.hasModel())return;let t=this._editor.getModel(),n=new al(t,this._editor.getPosition(),e);this.cancel(e.retrigger),this._triggerState=e,this._onDidTrigger.fire({auto:e.auto,shy:e.shy??!1,position:this._editor.getPosition()}),this._context=n;let i={triggerKind:e.triggerKind??0};e.triggerCharacter&&(i={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new jn;let r=this._editor.getOption(114),s=1;switch(r){case"top":s=0;break;case"bottom":s=2;break}let{itemKind:a,showDeprecated:l}=yd.createSuggestFilter(this._editor),d=new Jf(s,e.completionOptions?.kindFilter??a,e.completionOptions?.providerFilter,e.completionOptions?.providerItemsToReuse,l),c=QS.create(this._editorWorkerService,this._editor),u=TD(this._languageFeaturesService.completionProvider,t,this._editor.getPosition(),d,i,this._requestToken.token);Promise.all([u,c]).then(async([p,m])=>{if(this._requestToken?.dispose(),!this._editor.hasModel())return;let f=e?.clipboardText;if(!f&&p.needsClipboard&&(f=await this._clipboardService.readText()),this._triggerState===void 0)return;let g=this._editor.getModel(),b=new al(g,this._editor.getPosition(),e),v={...Zd.default,firstMatchCanBeWeak:!this._editor.getOption(120).matchOnWordStartOnly};if(this._completionModel=new ex(p.items,this._context.column,{leadingLineContent:b.leadingLineContent,characterCountDelta:b.column-this._context.column},m,this._editor.getOption(120),this._editor.getOption(114),v,f),this._completionDisposables.add(p.disposable),this._onNewContext(b),this._reportDurationsTelemetry(p.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(let I of p.items)I.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${I.provider._debugDisplayName}`,I.completion)}).catch(We)}_telemetryGate=0;_reportDurationsTelemetry(e){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)})}static createSuggestFilter(e){let t=new Set;e.getOption(114)==="none"&&t.add(27);let i=e.getOption(120);return i.showMethods||t.add(0),i.showFunctions||t.add(1),i.showConstructors||t.add(2),i.showFields||t.add(3),i.showVariables||t.add(4),i.showClasses||t.add(5),i.showStructs||t.add(6),i.showInterfaces||t.add(7),i.showModules||t.add(8),i.showProperties||t.add(9),i.showEvents||t.add(10),i.showOperators||t.add(11),i.showUnits||t.add(12),i.showValues||t.add(13),i.showConstants||t.add(14),i.showEnums||t.add(15),i.showEnumMembers||t.add(16),i.showKeywords||t.add(17),i.showWords||t.add(18),i.showColors||t.add(19),i.showFiles||t.add(20),i.showReferences||t.add(21),i.showColors||t.add(22),i.showFolders||t.add(23),i.showTypeParameters||t.add(24),i.showSnippets||t.add(27),i.showUsers||t.add(25),i.showIssues||t.add(26),{itemKind:t,showDeprecated:i.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(kt(e.leadingLineContent)!==kt(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){if(al.shouldAutoTrigger(this._editor)&&this._context){let n=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:n}})}return}if(e.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&e.leadingWord.word.length!==0){let t=new Map,n=new Set;for(let[i,r]of this._completionModel.getItemsByProvider())r.length>0&&r[0].container.incomplete?n.add(i):t.set(i,r);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:n,providerItemsToReuse:t}})}else{let t=this._completionModel.lineContext,n=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){let i=al.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(i&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=t,n=this._completionModel.items.length>0,n&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:e.triggerOptions,isFrozen:n})}}}}};yd=K([D(1,MB),D(2,JS),D(3,Rp),D(4,xn),D(5,Rt),D(6,Xt),D(7,_r),D(8,tr)],yd);var sx=class o{static _maxSelectionLength=51200;_disposables=new ae;_lastOvertyped=[];_locked=!1;constructor(e,t){this._disposables.add(e.onWillType(()=>{if(this._locked||!e.hasModel())return;let n=e.getSelections(),i=n.length,r=!1;for(let a=0;a<i;a++)if(!n[a].isEmpty()){r=!0;break}if(!r){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];let s=e.getModel();for(let a=0;a<i;a++){let l=n[a];if(s.getValueLengthInRange(l)>o._maxSelectionLength)return;this._lastOvertyped[a]={value:s.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}})),this._disposables.add(t.onDidTrigger(n=>{this._locked=!0})),this._disposables.add(t.onDidCancel(n=>{this._locked=!1}))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}};var ax={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},Zt=class{constructor(e,t,n,i,r){this._editor=e;this._logService=t;this._languageFeaturesService=n;this._languageConfigurationService=r;this._inSnippet=Zt.InSnippetMode.bindTo(i),this._hasNextTabstop=Zt.HasNextTabstop.bindTo(i),this._hasPrevTabstop=Zt.HasPrevTabstop.bindTo(i)}static ID="snippetController2";static get(e){return e.getContribution(Zt.ID)}static InSnippetMode=new me("inSnippetMode",!1,h("inSnippetMode","Whether the editor in current in snippet mode"));static HasNextTabstop=new me("hasNextTabstop",!1,h("hasNextTabstop","Whether there is a next tab stop when in snippet mode"));static HasPrevTabstop=new me("hasPrevTabstop",!1,h("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode"));_inSnippet;_hasNextTabstop;_hasPrevTabstop;_session;_snippetListener=new ae;_modelVersionId=-1;_currentChoice;_choiceCompletions;dispose(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._session?.dispose(),this._snippetListener.dispose()}apply(e,t){try{this._doInsert(e,typeof t>"u"?ax:{...ax,...t})}catch(n){this.cancel(),this._logService.error(n),this._logService.error("snippet_error"),this._logService.error("insert_edits=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}insert(e,t){try{this._doInsert(e,typeof t>"u"?ax:{...ax,...t})}catch(n){this.cancel(),this._logService.error(n),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){if(this._editor.hasModel()){if(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof e!="string"&&this.cancel(),this._session?(hi(typeof e=="string"),this._session.merge(e,t)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new Li(this._editor,e,t,this._languageConfigurationService),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._session?.hasChoice){let n={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(d,c)=>{if(!this._session||d!==this._editor.getModel()||!M.equals(this._editor.getPosition(),c))return;let{activeChoice:u}=this._session;if(!u||u.choice.options.length===0)return;let p=d.getValueInRange(u.range),m=!!u.choice.options.find(g=>g.value===p),f=[];for(let g=0;g<u.choice.options.length;g++){let b=u.choice.options[g];f.push({kind:13,label:b.value,insertText:b.value,sortText:"a".repeat(g+1),range:u.range,filterText:m?`${p}_${b.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:h("next","Go to next placeholder...")}})}return{suggestions:f}}},i=this._editor.getModel(),r,s=!1,a=()=>{r?.dispose(),s=!1},l=()=>{s||(r=this._languageFeaturesService.completionProvider.register({language:i.getLanguageId(),pattern:i.uri.fsPath,scheme:i.uri.scheme,exclusive:!0},n),this._snippetListener.add(r),s=!0)};this._choiceCompletions={provider:n,enable:l,disable:a}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(n=>n.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}let{activeChoice:e}=this._session;if(!e||!this._choiceCompletions){this._choiceCompletions?.disable(),this._currentChoice=void 0;return}this._currentChoice!==e.choice&&(this._currentChoice=e.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{RB(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,this._session?.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session?.prev(),this._updateState()}next(){this._session?.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}getSessionEnclosingRange(){if(this._session)return this._session.getEnclosingRange()}};Zt=K([D(1,xn),D(2,_r),D(3,Rt),D(4,Dn)],Zt);Mp(Zt.ID,Zt,4);var lx=na.bindToContribution(Zt.get);be(new lx({id:"jumpToNextSnippetPlaceholder",precondition:De.and(Zt.InSnippetMode,Zt.HasNextTabstop),handler:o=>o.next(),kbOpts:{weight:130,kbExpr:ie.textInputFocus,primary:2}}));be(new lx({id:"jumpToPrevSnippetPlaceholder",precondition:De.and(Zt.InSnippetMode,Zt.HasPrevTabstop),handler:o=>o.prev(),kbOpts:{weight:130,kbExpr:ie.textInputFocus,primary:1026}}));be(new lx({id:"leaveSnippet",precondition:Zt.InSnippetMode,handler:o=>o.cancel(!0),kbOpts:{weight:130,kbExpr:ie.textInputFocus,primary:9,secondary:[1033]}}));be(new lx({id:"acceptSnippet",precondition:Zt.InSnippetMode,handler:o=>o.finish()}));var G7="__$__isNewStorageMarker",dx="__$__targetStorageMarker",kh=j("storageService");function $7(o){let e=o.get(dx);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}var UB=class o extends V{constructor(t={flushInterval:o.DEFAULT_FLUSH_INTERVAL}){super();this.options=t}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new Pa);_onDidChangeTarget=this._register(new Pa);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new L);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new dn(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new Wt);onDidChangeValue(t,n,i){return de.filter(this._onDidChangeValue.event,r=>r.scope===t&&(n===void 0||r.key===n),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Ol(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){yt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{us("code/willInitStorage");try{await this.doInitialize()}finally{us("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(t,n){let{key:i,external:r}=n;if(i===dx){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:i,target:this.getKeyTargets(t)[i],external:r})}emitWillSaveState(t){this._onWillSaveState.fire({reason:t})}get(t,n,i){return this.getStorage(n)?.get(t,i)}getBoolean(t,n,i){return this.getStorage(n)?.getBoolean(t,i)}getNumber(t,n,i){return this.getStorage(n)?.getNumber(t,i)}getObject(t,n,i){return this.getStorage(n)?.getObject(t,i)}storeAll(t,n){this.withPausedEmitters(()=>{for(let i of t)this.store(i.key,i.value,i.scope,i.target,n)})}store(t,n,i,r,s=!1){if(Yn(n)){this.remove(t,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(t,i,r),this.getStorage(i)?.set(t,n,s)})}remove(t,n,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(t,n,void 0),this.getStorage(n)?.delete(t,i)})}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(t,n){let i=[],r=this.getKeyTargets(t);for(let s of Object.keys(r))r[s]===n&&i.push(s);return i}updateKeyTarget(t,n,i,r=!1){let s=this.getKeyTargets(n);typeof i=="number"?s[t]!==i&&(s[t]=i,this.getStorage(n)?.set(dx,JSON.stringify(s),r)):typeof s[t]=="number"&&(delete s[t],this.getStorage(n)?.set(dx,JSON.stringify(s),r))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){let n=this.getStorage(t);return n?$7(n):Object.create(null)}isNew(t){return this.getBoolean(G7,t)===!0}async flush(t=0){this._onWillSaveState.fire({reason:t});let n=this.getStorage(-1),i=this.getStorage(0),r=this.getStorage(1);switch(t){case 0:await hr.settled([n?.whenFlushed()??Promise.resolve(),i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case 1:await hr.settled([n?.flush(0)??Promise.resolve(),i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){let t=this.getStorage(-1)?.items??new Map,n=this.getStorage(0)?.items??new Map,i=this.getStorage(1)?.items??new Map;return j7(t,n,i,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(t){return await this.flush(),this.getStorage(t)?.optimize()}async switch(t,n){return this.emitWillSaveState(0),g2(t)?this.switchToProfile(t,n):this.switchToWorkspace(t,n)}canSwitchProfile(t,n){return!(t.id===n.id||zB(n)&&zB(t))}switchData(t,n,i){this.withPausedEmitters(()=>{let r=new Set;for(let[s,a]of t)r.add(s),n.get(s)!==a&&this.emitDidChangeValue(i,{key:s,external:!0});for(let[s]of n.items)r.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};function zB(o){return o.isDefault||!!o.useDefaultFlags?.globalState}async function j7(o,e,t,n,i,r){let s=g=>{try{return JSON.parse(g)}catch{return g}},a=new Map,l=new Map;o.forEach((g,b)=>{a.set(b,g),l.set(b,s(g))});let d=new Map,c=new Map;e.forEach((g,b)=>{d.set(b,g),c.set(b,s(g))});let u=new Map,p=new Map;t.forEach((g,b)=>{u.set(b,g),p.set(b,s(g))}),console.group(n!==i?`Storage: Application (path: ${n})`:`Storage: Application & Profile (path: ${n}, default profile)`);let m=[];if(a.forEach((g,b)=>{m.push({key:b,value:g})}),console.table(m),console.groupEnd(),console.log(l),n!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let g=[];d.forEach((b,v)=>{g.push({key:v,value:b})}),console.table(g),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${r})`);let f=[];u.forEach((g,b)=>{f.push({key:b,value:g})}),console.table(f),console.groupEnd(),console.log(p)}var db=class{constructor(e){this.name=e}select(e,t,n){if(n.length===0)return 0;let i=n[0].score[0];for(let r=0;r<n.length;r++){let{score:s,completion:a}=n[r];if(s[0]!==i)break;if(a.preselect)return r}return 0}},cx=class extends db{constructor(){super("first")}memorize(e,t,n){}toJSON(){}fromJSON(){}},jD=class extends db{constructor(){super("recentlyUsed")}_cache=new Pi(300,.66);_seq=0;memorize(e,t,n){let i=`${e.getLanguageId()}/${n.textLabel}`;this._cache.set(i,{touch:this._seq++,type:n.completion.kind,insertText:n.completion.insertText})}select(e,t,n){if(n.length===0)return 0;let i=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(i))return super.select(e,t,n);let r=n[0].score[0],s=-1,a=-1,l=-1;for(let d=0;d<n.length&&n[d].score[0]===r;d++){let c=`${e.getLanguageId()}/${n[d].textLabel}`,u=this._cache.peek(c);if(u&&u.touch>l&&u.type===n[d].completion.kind&&u.insertText===n[d].completion.insertText&&(l=u.touch,a=d),n[d].completion.preselect&&s===-1)return s=d}return a!==-1?a:s!==-1?s:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();let t=0;for(let[n,i]of e)i.touch=t,i.type=typeof i.type=="number"?i.type:np.fromString(i.type),this._cache.set(n,i);this._seq=this._cache.size}},qD=class extends db{constructor(){super("recentlyUsedByPrefix")}_trie=Ku.forStrings();_seq=0;memorize(e,t,n){let{word:i}=e.getWordUntilPosition(t),r=`${e.getLanguageId()}/${i}`;this._trie.set(r,{type:n.completion.kind,insertText:n.completion.insertText,touch:this._seq++})}select(e,t,n){let{word:i}=e.getWordUntilPosition(t);if(!i)return super.select(e,t,n);let r=`${e.getLanguageId()}/${i}`,s=this._trie.get(r);if(s||(s=this._trie.findSubstr(r)),s)for(let a=0;a<n.length;a++){let{kind:l,insertText:d}=n[a].completion;if(l===s.type&&d===s.insertText)return a}return super.select(e,t,n)}toJSON(){let e=[];return this._trie.forEach((t,n)=>e.push([n,t])),e.sort((t,n)=>-(t[1].touch-n[1].touch)).forEach((t,n)=>t[1].touch=n),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(let[t,n]of e)n.type=typeof n.type=="number"?n.type:np.fromString(n.type),this._trie.set(t,n)}}},ll=class{constructor(e,t){this._storageService=e;this._configService=t;this._persistSoon=new dn(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(n=>{n.reason===1&&this._saveState()}))}static _strategyCtors=new Map([["recentlyUsedByPrefix",qD],["recentlyUsed",jD],["first",cx]]);static _storagePrefix="suggest/memories";_serviceBrand;_persistSoon;_disposables=new ae;_strategy;dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,n){this._withStrategy(e,t).memorize(e,t,n),this._persistSoon.schedule()}select(e,t,n){return this._withStrategy(e,t).select(e,t,n)}_withStrategy(e,t){let n=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if(this._strategy?.name!==n){this._saveState();let i=ll._strategyCtors.get(n)||cx;this._strategy=new i;try{let s=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,a=this._storageService.get(`${ll._storagePrefix}/${n}`,s);a&&this._strategy.fromJSON(JSON.parse(a))}catch{}}return this._strategy}_saveState(){if(this._strategy){let t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,n=JSON.stringify(this._strategy);this._storageService.store(`${ll._storagePrefix}/${this._strategy.name}`,n,t,1)}}};ll=K([D(0,kh),D(1,Xt)],ll);var YD=j("ISuggestMemories");Cn(YD,ll,1);var dl=class{constructor(e,t){this._editor=e;this._ckAtEnd=dl.AtEnd.bindTo(t),this._configListener=this._editor.onDidChangeConfiguration(n=>n.hasChanged(125)&&this._update()),this._update()}static AtEnd=new me("atEndOfWord",!1);_ckAtEnd;_configListener;_enabled=!1;_selectionListener;dispose(){this._configListener.dispose(),this._selectionListener?.dispose(),this._ckAtEnd.reset()}_update(){let e=this._editor.getOption(125)==="on";if(this._enabled!==e)if(this._enabled=e,this._enabled){let t=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}let n=this._editor.getModel(),i=this._editor.getSelection(),r=n.getWordAtPosition(i.getStartPosition());if(!r){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(r.endColumn===i.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};dl=K([D(1,Rt)],dl);var $B=j("markerDecorationsService");var Rh=class{static ID="editor.contrib.markerDecorations";constructor(e,t){}dispose(){}};Rh=K([D(1,$B)],Rh);Mp(Rh.ID,Rh,0);var cl;(N=>{let o={total:0,min:Number.MAX_VALUE,max:0},e={...o},t={...o},n={...o},i=0,r;(U=>(U[U.Before=0]="Before",U[U.InProgress=1]="InProgress",U[U.Finished=2]="Finished"))(r||={});let s={keydown:0,input:0,render:0};function a(){v(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}N.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}N.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}N.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function p(){v()}N.onKeyUp=p;function m(){v()}N.onSelectionChange=m;function f(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(g),b())}N.onRenderStart=f;function g(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(v)}function v(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),I("keydown",o),I("input",e),I("render",t),I("inputlatency",n),i++,C())}function I(F,P){let H=performance.getEntriesByName(F)[0].duration;P.total+=H,P.min=Math.min(P.min,H),P.max=Math.max(P.max,H)}function C(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function S(){if(i===0)return;let F={keydown:_(o),input:_(e),render:_(t),total:_(n),sampleCount:i};return R(o),R(e),R(t),R(n),i=0,F}N.getAndClearMeasurements=S;function _(F){return{average:F.total/i,max:F.max,min:F.min}}function R(F){F.total=0,F.min=Number.MAX_VALUE,F.max=0}})(cl||={});var Id=class{constructor(e,t){this.x=e;this.y=t}_pageCoordinatesBrand=void 0;toClientCoordinates(e){return new cb(this.x-e.scrollX,this.y-e.scrollY)}},cb=class{constructor(e,t){this.clientX=e;this.clientY=t}_clientCoordinatesBrand=void 0;toPageCoordinates(e){return new Id(this.clientX+e.scrollX,this.clientY+e.scrollY)}},XD=class{constructor(e,t,n,i){this.x=e;this.y=t;this.width=n;this.height=i}_editorPagePositionBrand=void 0},ZD=class{constructor(e,t){this.x=e;this.y=t}_positionRelativeToEditorBrand=void 0};function mx(o){let e=Bi(o);return new XD(e.left,e.top,e.width,e.height)}function gx(o,e,t){let n=e.width/o.offsetWidth,i=e.height/o.offsetHeight,r=(t.x-e.x)/n,s=(t.y-e.y)/i;return new ZD(r,s)}var wr=class extends Ai{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(e,t,n){super(ge(n),e),this.isFromPointerCapture=t,this.pos=new Id(this.posx,this.posy),this.editorPos=mx(n),this.relativePos=gx(n,this.editorPos,this.pos)}},ux=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new wr(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return Y(e,"contextmenu",n=>{t(this._create(n))})}onMouseUp(e,t){return Y(e,"mouseup",n=>{t(this._create(n))})}onMouseDown(e,t){return Y(e,Ee.MOUSE_DOWN,n=>{t(this._create(n))})}onPointerDown(e,t){return Y(e,Ee.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onMouseLeave(e,t){return Y(e,Ee.MOUSE_LEAVE,n=>{t(this._create(n))})}onMouseMove(e,t){return Y(e,"mousemove",n=>t(this._create(n)))}},px=class{_editorViewDomNode;constructor(e){this._editorViewDomNode=e}_create(e){return new wr(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return Y(e,"pointerup",n=>{t(this._create(n))})}onPointerDown(e,t){return Y(e,Ee.POINTER_DOWN,n=>{t(this._create(n),n.pointerId)})}onPointerLeave(e,t){return Y(e,Ee.POINTER_LEAVE,n=>{t(this._create(n))})}onPointerMove(e,t){return Y(e,"pointermove",n=>t(this._create(n)))}},hx=class extends V{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new ba),this._keydownListener=null}startMonitoring(e,t,n,i,r){this._keydownListener=Ln(e.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,n,s=>{i(new wr(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),r(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var fx=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(e,t,n,i){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new w(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var QD=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},bx=class extends QD{_renderingContextBrand=void 0;_viewLines;constructor(e,t,n){super(e,t),this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}},vx=class{constructor(e,t,n,i){this.outsideRenderedLine=e;this.lineNumber=t;this.ranges=n;this.continuesOnNextLine=i}static firstLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber<t.lineNumber)&&(t=n);return t}static lastLine(e){if(!e)return null;let t=null;for(let n of e)(!t||n.lineNumber>t.lineNumber)&&(t=n);return t}},Mh=class o{_horizontalRangeBrand=void 0;left;width;static from(e){let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=new o(r.left,r.width)}return t}constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}},ms=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}},yx=class{outsideRenderedLine;left;originalLeft;constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}},ub=class{constructor(e,t){this.outsideRenderedLine=e;this.ranges=t}};var Ix=class{configuration;viewModel;viewLayout;theme;constructor(e,t,n){this.configuration=e,this.theme=new _I(t),this.viewModel=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}};var Nt=class extends Cr{_context;constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Mn=class{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;let r=new Uint8Array(i);for(let s=0;s<i;s++)r[s]=n[i-s-1];return r}};function Ph(o,e){let t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(o,e)}catch(n){We(n);return}try{return globalThis.trustedTypes?.createPolicy(o,e)}catch(n){We(n);return}}var pb=class{constructor(e){this._lineFactory=e;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new $e("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;let n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){let l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>i)return null;let r=0,s=0;for(let l=n;l<=i;l++){let d=l-this._rendLineNumberStart;e<=l&&l<=t&&(s===0?(r=d,s=1):s++)}if(e<n){let l=0;t<n?l=t-e+1:l=n-e,this._rendLineNumberStart-=l}return this._lines.splice(r,s)}onLinesChanged(e,t){let n=e+t-1;if(this.getCount()===0)return!1;let i=this.getStartLineNumber(),r=this.getEndLineNumber(),s=!1;for(let a=e;a<=n;a++)a>=i&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;let n=t-e+1,i=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>r)return null;if(n+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);let s=[];for(let u=0;u<n;u++)s[u]=this._lineFactory.createLine();let a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-n),c=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(e){if(this.getCount()===0)return!1;let t=this.getStartLineNumber(),n=this.getEndLineNumber(),i=!1;for(let r=0,s=e.length;r<s;r++){let a=e[r];if(a.toLineNumber<t||a.fromLineNumber>n)continue;let l=Math.max(t,a.fromLineNumber),d=Math.min(n,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),i=!0}}return i}},Nh=class{constructor(e){this._lineFactory=e}domNode=this._createDomNode();_linesCollection=new pb(this._lineFactory);_createDomNode(){let e=Ae(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(147)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++)t[n].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),n=new JD(this.domNode.domNode,this._lineFactory,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}},JD=class o{constructor(e,t,n){this._domNode=e;this._lineFactory=t;this._viewportData=n}static _ttPolicy=Ph("editorViewLayer",{createHTML:e=>e});render(e,t,n,i){let r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||n<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=n-t+1,r.lines=[];for(let s=t;s<=n;s++)r.lines[s-t]=this._lineFactory.createLine();return this._finishRendering(r,!0,i),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(n-r.rendLineNumberStart,r.linesLength-1),i,t),r.rendLineNumberStart>t){let s=t,a=Math.min(n,r.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart<t){let s=Math.min(r.linesLength,t-r.rendLineNumberStart);s>0&&(this._removeLinesBefore(r,s),r.linesLength-=s)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<n){let s=r.rendLineNumberStart+r.linesLength,a=n;s<=a&&(this._insertLinesAfter(r,s,a,i,t),r.linesLength+=a-s+1)}else if(r.rendLineNumberStart+r.linesLength-1>n){let s=Math.max(0,n-r.rendLineNumberStart+1),l=r.linesLength-1-s+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,i),r}_renderUntouchedLines(e,t,n,i,r){let s=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=n;l++){let d=s+l;a[l].layoutLine(d,i[d-r],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++)e.lines[n].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,r){let s=[],a=0;for(let l=t;l<=n;l++)s[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){let n=e.linesLength-t;for(let i=0;i<t;i++)e.lines[n+i].getDomNode()?.remove();e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){o._ttPolicy&&(n=o._ttPolicy.createHTML(n));let r=this._domNode.lastChild;t||!r?this._domNode.innerHTML=n:r.insertAdjacentHTML("afterend",n);let s=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){let l=e.lines[a];i[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,n){let i=document.createElement("div");o._ttPolicy&&(t=o._ttPolicy.createHTML(t)),i.innerHTML=t;for(let r=0;r<e.linesLength;r++){let s=e.lines[r];if(n[r]){let a=i.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new pc(1e5);_finishRendering(e,t,n){let i=o._sb,r=e.linesLength,s=e.lines,a=e.rendLineNumberStart,l=[];{i.reset();let d=!1;for(let c=0;c<r;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,n[c],this._viewportData.lineHeight,this._viewportData,i))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,i.build(),l)}{i.reset();let d=!1,c=[];for(let u=0;u<r;u++){let p=s[u];c[u]=!1,!(l[u]||!p.renderLine(u+a,n[u],this._viewportData.lineHeight,this._viewportData,i))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(e,i.build(),c)}}};var Oh=class{constructor(e,t){this._domNode=e;this.endNode=t}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var Jc=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,r){let s=this._createRange();try{return s.setStart(e,t),s.setEnd(n,i),s.getClientRects()}catch{return null}finally{this._detachRange(s,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(ms.compare);let t=[],n=0,i=e[0];for(let r=1,s=e.length;r<s;r++){let a=e[r];i.left+i.width+.9>=a.left?i.width=Math.max(i.width,a.left+a.width-i.left):(t[n++]=i,i=a)}return t[n++]=i,t}static _createHorizontalRangesFromClientRects(e,t,n){if(!e||e.length===0)return null;let i=[];for(let r=0,s=e.length;r<s;r++){let a=e[r];i[r]=new ms(Math.max(0,(a.left-t)/n),a.width/n)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,n,i,r,s){let l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),i=Math.min(l,Math.max(0,i)),t===i&&n===r&&n===0&&!e.children[t].firstChild){let p=e.children[t].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}t!==i&&i>0&&r===0&&(i--,r=1073741824);let d=e.children[t].firstChild,c=e.children[i].firstChild;if((!d||!c)&&(!d&&n===0&&t>0&&(d=e.children[t-1].firstChild,n=1073741824),!c&&r===0&&i>0&&(c=e.children[i-1].firstChild,r=1073741824)),!d||!c)return null;n=Math.min(d.textContent.length,Math.max(0,n)),r=Math.min(c.textContent.length,Math.max(0,r));let u=this._readClientRects(d,n,c,r,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var ln=class{constructor(e,t,n,i){this.endIndex=e;this.type=t;this.metadata=n;this.containsRTL=i}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var ul=class o{constructor(e,t,n,i){this.startColumn=e;this.endColumn=t;this.className=n;this.type=i}_lineDecorationBrand=void 0;static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!o._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,n){if(e.length===0)return e;let i=t+1,r=n+1,s=n-t,a=[],l=0;for(let d of e)d.endColumn<=i||d.startColumn>=r||(a[l++]=new o(Math.max(1,d.startColumn-i+1),Math.min(s+1,d.endColumn-i+1),d.className,d.type));return a}static filter(e,t,n,i){if(e.length===0)return[];let r=[],s=0;for(let a=0,l=e.length;a<l;a++){let d=e[a],c=d.range;if(c.endLineNumber<t||c.startLineNumber>t||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===t?c.startColumn:n,p=c.endLineNumber===t?c.endColumn:i;r[s++]=new o(u,p,d.inlineClassName,d.type)}return r}static _typeCompare(e,t){let n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;let n=o._typeCompare(e.type,t.type);return n!==0?n:e.className!==t.className?e.className<t.className?-1:1:0}},Cx=class{startOffset;endOffset;className;metadata;constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}},ek=class o{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let i=0;for(;i+1<this.count&&this.stopOffsets[i]===this.stopOffsets[i+1];)i++;n.push(new Cx(t,this.stopOffsets[i],this.classNames.join(" "),o._metadata(this.metadata))),t=this.stopOffsets[i]+1,this.stopOffsets.splice(0,i+1),this.classNames.splice(0,i+1),this.metadata.splice(0,i+1),this.count-=i+1}return this.count>0&&t<e&&(n.push(new Cx(t,e-1,this.classNames.join(" "),o._metadata(this.metadata))),t=e),t}insert(e,t,n){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}},Sx=class{static normalize(e,t){if(t.length===0)return[];let n=[],i=new ek,r=0;for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.startColumn,c=l.endColumn,u=l.className,p=l.type===1?2:l.type===2?4:0;if(d>1){let g=e.charCodeAt(d-2);At(g)&&d--}if(c>1){let g=e.charCodeAt(c-2);At(g)&&c--}let m=d-1,f=c-2;r=i.consumeLowerThan(m,r,n),i.count===0&&(r=m),i.insert(f,u,p)}return i.consumeLowerThan(1073741824,r,n),n}};var Ah=class{startOffset;endOffset;constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}},xx=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(e,t,n,i,r,s,a,l,d,c,u,p,m,f,g,b,v,I,C){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(ul.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=p,this.stopRenderingLineAfter=g,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=v,this.fontLigatures=I,this.selectionsOnLine=C&&C.sort((R,N)=>R.startOffset<N.startOffset?-1:1);let S=Math.abs(f-p),_=Math.abs(m-p);S<_?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=m,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&ul.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}};var hb=class{constructor(e,t){this.partIndex=e;this.charIndex=t}},mb=class o{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}length;_data;_horizontalOffset;constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,n,i){let r=(t<<16|n<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=i}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){let t=this.charOffsetToPartData(e-1),n=o.getPartIndex(t),i=o.getCharIndex(t);return new hb(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(this.length===0)return 0;let i=(e<<16|n<<0)>>>0,r=0,s=this.length-1;for(;r+1<s;){let g=r+s>>>1,b=this._data[g];if(b===i)return g;b>i?s=g:r=g}if(r===s)return r;let a=this._data[r],l=this._data[s];if(a===i)return r;if(l===i)return s;let d=o.getPartIndex(a),c=o.getCharIndex(a),u=o.getPartIndex(l),p;d!==u?p=t:p=o.getCharIndex(l);let m=n-c,f=p-n;return m<=f?r:s}inflate(){let e=[];for(let t=0;t<this.length;t++){let n=this._data[t],i=o.getPartIndex(n),r=o.getCharIndex(n),s=this._horizontalOffset[t];e.push([i,r,s])}return e}};var gb=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(e,t,n){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}};function jB(o,e){if(o.lineContent.length===0){if(o.lineDecorations.length>0){e.appendString("<span>");let t=0,n=0,i=0;for(let s of o.lineDecorations)(s.type===1||s.type===2)&&(e.appendString('<span class="'),e.appendString(s.className),e.appendString('"></span>'),s.type===1&&(i|=1,t++),s.type===2&&(i|=2,n++));e.appendString("</span>");let r=new mb(1,t+n);return r.setColumnInfo(1,t,0,0),new gb(r,!1,i)}return e.appendString("<span><span></span></span>"),new gb(new mb(0,0),!1,0)}return n9(X7(o),e)}var nk=class{constructor(e,t,n,i,r,s,a,l,d,c,u,p,m,f,g,b){this.fontIsMonospace=e;this.canUseHalfwidthRightwardsArrow=t;this.lineContent=n;this.len=i;this.isOverflowing=r;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=p;this.spaceWidth=m;this.renderSpaceCharCode=f;this.renderWhitespace=g;this.renderControlCharacters=b}};function X7(o){let e=o.lineContent,t,n,i;o.stopRenderingLineAfter!==-1&&o.stopRenderingLineAfter<e.length?(t=!0,n=e.length-o.stopRenderingLineAfter,i=o.stopRenderingLineAfter):(t=!1,n=0,i=e.length);let r=Z7(e,o.containsRTL,o.lineTokens,o.fauxIndentLength,i);o.renderControlCharacters&&!o.isBasicASCII&&(r=J7(e,r)),(o.renderWhitespace===4||o.renderWhitespace===1||o.renderWhitespace===2&&o.selectionsOnLine||o.renderWhitespace===3&&!o.continuesWithWrappedLine)&&(r=e9(o,e,i,r));let s=0;if(o.lineDecorations.length>0){for(let a=0,l=o.lineDecorations.length;a<l;a++){let d=o.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}r=t9(e,i,r,o.lineDecorations)}return o.containsRTL||(r=Q7(e,r,!o.isBasicASCII||o.fontLigatures)),new nk(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,e,i,t,n,r,s,o.fauxIndentLength,o.tabSize,o.startVisibleColumn,o.containsRTL,o.spaceWidth,o.renderSpaceCharCode,o.renderWhitespace,o.renderControlCharacters)}function Z7(o,e,t,n,i){let r=[],s=0;n>0&&(r[s++]=new ln(n,"",0,!1));let a=n;for(let l=0,d=t.getCount();l<d;l++){let c=t.getEndOffset(l);if(c<=n)continue;let u=t.getClassName(l);if(c>=i){let m=e?Na(o.substring(a,i)):!1;r[s++]=new ln(i,u,0,m);break}let p=e?Na(o.substring(a,c)):!1;r[s++]=new ln(c,u,0,p),a=c}return r}function Q7(o,e,t){let n=0,i=[],r=0;if(t)for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex;if(n+50<d){let c=l.type,u=l.metadata,p=l.containsRTL,m=-1,f=n;for(let g=n;g<d;g++)o.charCodeAt(g)===32&&(m=g),m!==-1&&g-f>=50&&(i[r++]=new ln(m+1,c,u,p),f=m+1,m=-1);f!==d&&(i[r++]=new ln(d,c,u,p))}else i[r++]=l;n=d}else for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.endIndex,c=d-n;if(c>50){let u=l.type,p=l.metadata,m=l.containsRTL,f=Math.ceil(c/50);for(let g=1;g<f;g++){let b=n+g*50;i[r++]=new ln(b,u,p,m)}i[r++]=new ln(d,u,p,m)}else i[r++]=l;n=d}return i}function qB(o){return o<32?o!==9:o===127||o>=8234&&o<=8238||o>=8294&&o<=8297||o>=8206&&o<=8207||o===1564}function J7(o,e){let t=[],n=new ln(0,"",0,!1),i=0;for(let r of e){let s=r.endIndex;for(;i<s;i++){let a=o.charCodeAt(i);qB(a)&&(i>n.endIndex&&(n=new ln(i,r.type,r.metadata,r.containsRTL),t.push(n)),n=new ln(i+1,"mtkcontrol",r.metadata,!1),t.push(n))}i>n.endIndex&&(n=new ln(s,r.type,r.metadata,r.containsRTL),t.push(n))}return t}function e9(o,e,t,n){let i=o.continuesWithWrappedLine,r=o.fauxIndentLength,s=o.tabSize,a=o.startVisibleColumn,l=o.useMonospaceOptimizations,d=o.selectionsOnLine,c=o.renderWhitespace===1,u=o.renderWhitespace===3,p=o.renderSpaceWidth!==o.spaceWidth,m=[],f=0,g=0,b=n[g].type,v=n[g].containsRTL,I=n[g].endIndex,C=n.length,S=!1,_=zt(e),R;_===-1?(S=!0,_=t,R=t):R=qo(e);let N=!1,F=0,P=d&&d[F],H=a%s;for(let z=r;z<t;z++){let oe=e.charCodeAt(z);P&&z>=P.endOffset&&(F++,P=d&&d[F]);let fe;if(z<_||z>R)fe=!0;else if(oe===9)fe=!0;else if(oe===32)if(c)if(N)fe=!0;else{let ee=z+1<t?e.charCodeAt(z+1):0;fe=ee===32||ee===9}else fe=!0;else fe=!1;if(fe&&d&&(fe=!!P&&P.startOffset<=z&&P.endOffset>z),fe&&u&&(fe=S||z>R),fe&&v&&z>=_&&z<=R&&(fe=!1),N){if(!fe||!l&&H>=s){if(p){let ee=f>0?m[f-1].endIndex:r;for(let X=ee+1;X<=z;X++)m[f++]=new ln(X,"mtkw",1,!1)}else m[f++]=new ln(z,"mtkw",1,!1);H=H%s}}else(z===I||fe&&z>r)&&(m[f++]=new ln(z,b,0,v),H=H%s);for(oe===9?H=s:Yo(oe)?H+=2:H++,N=fe;z===I&&(g++,g<C);)b=n[g].type,v=n[g].containsRTL,I=n[g].endIndex}let U=!1;if(N)if(i&&c){let z=t>0?e.charCodeAt(t-1):0,oe=t>1?e.charCodeAt(t-2):0;z===32&&oe!==32&&oe!==9||(U=!0)}else U=!0;if(U)if(p){let z=f>0?m[f-1].endIndex:r;for(let oe=z+1;oe<=t;oe++)m[f++]=new ln(oe,"mtkw",1,!1)}else m[f++]=new ln(t,"mtkw",1,!1);else m[f++]=new ln(t,b,0,v);return m}function t9(o,e,t,n){n.sort(ul.compare);let i=Sx.normalize(o,n),r=i.length,s=0,a=[],l=0,d=0;for(let u=0,p=t.length;u<p;u++){let m=t[u],f=m.endIndex,g=m.type,b=m.metadata,v=m.containsRTL;for(;s<r&&i[s].startOffset<f;){let I=i[s];if(I.startOffset>d&&(d=I.startOffset,a[l++]=new ln(d,g,b,v)),I.endOffset+1<=f)d=I.endOffset+1,a[l++]=new ln(d,g+" "+I.className,b|I.metadata,v),s++;else{d=f,a[l++]=new ln(d,g+" "+I.className,b|I.metadata,v);break}}f>d&&(d=f,a[l++]=new ln(d,g,b,v))}let c=t[t.length-1].endIndex;if(s<r&&i[s].startOffset===c)for(;s<r&&i[s].startOffset===c;){let u=i[s];a[l++]=new ln(d,u.className,u.metadata,!1),s++}return a}function n9(o,e){let t=o.fontIsMonospace,n=o.canUseHalfwidthRightwardsArrow,i=o.containsForeignElements,r=o.lineContent,s=o.len,a=o.isOverflowing,l=o.overflowingCharCount,d=o.parts,c=o.fauxIndentLength,u=o.tabSize,p=o.startVisibleColumn,m=o.containsRTL,f=o.spaceWidth,g=o.renderSpaceCharCode,b=o.renderWhitespace,v=o.renderControlCharacters,I=new mb(s+1,d.length),C=!1,S=0,_=p,R=0,N=0,F=0;m?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let P=0,H=d.length;P<H;P++){let U=d[P],z=U.endIndex,oe=U.type,fe=U.containsRTL,ee=b!==0&&U.isWhitespace(),X=ee&&!t&&(oe==="mtkw"||!i),se=S===z&&U.isPseudoAfter();if(R=0,e.appendString("<span "),fe&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(X?"mtkz":oe),e.appendASCIICharCode(34),ee){let te=0;{let Z=S,ye=_;for(;Z<z;Z++){let st=(r.charCodeAt(Z)===9?u-ye%u:1)|0;te+=st,Z>=c&&(ye+=st)}}for(X&&(e.appendString(' style="width:'),e.appendString(String(f*te)),e.appendString('px"')),e.appendASCIICharCode(62);S<z;S++){I.setColumnInfo(S+1,P-F,R,N),F=0;let Z=r.charCodeAt(S),ye,Se;if(Z===9){ye=u-_%u|0,Se=ye,!n||Se>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let st=2;st<=Se;st++)e.appendCharCode(160)}else ye=2,Se=1,e.appendCharCode(g),e.appendCharCode(8204);R+=ye,N+=Se,S>=c&&(_+=Se)}}else for(e.appendASCIICharCode(62);S<z;S++){I.setColumnInfo(S+1,P-F,R,N),F=0;let te=r.charCodeAt(S),Z=1,ye=1;switch(te){case 9:Z=u-_%u,ye=Z;for(let Se=1;Se<=Z;Se++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:v?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Yo(te)&&ye++,v&&te<32?e.appendCharCode(9216+te):v&&te===127?e.appendCharCode(9249):v&&qB(te)?(e.appendString("[U+"),e.appendString(i9(te)),e.appendString("]"),Z=8,ye=Z):e.appendCharCode(te)}R+=Z,N+=ye,S>=c&&(_+=ye)}se?F++:F=0,S>=s&&!C&&U.isPseudoAfter()&&(C=!0,I.setColumnInfo(S+1,P,R,N)),e.appendString("</span>")}return C||I.setColumnInfo(s+1,d.length-1,R,N),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(h("showMore","Show more ({0})",o9(l))),e.appendString("</span>")),e.appendString("</span>"),new gb(I,m,i)}function i9(o){return o.toString(16).toUpperCase().padStart(4,"0")}function o9(o){return o<1024?h("overflow.chars","{0} chars",o):o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/1024/1024).toFixed(1)} MB`}var r9=function(){return ka?!0:!(Ut||In||Xo)}(),Bh=!0,fb=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(e,t){this.themeType=t;let n=e.options,i=n.get(51);n.get(39)==="off"?this.renderWhitespace=n.get(101):this.renderWhitespace="none",this.renderControlCharacters=n.get(96),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(33),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(68),this.stopRenderingLineAfter=n.get(119),this.fontLigatures=n.get(52)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}},gs=class o{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=Ae(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return Js(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,n,i,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=i.getViewLineRenderingData(e),a=this._options,l=ul.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn),d=null;if(Js(a.themeType)||this._options.renderWhitespace==="selection"){let m=i.selections;for(let f of m){if(f.endLineNumber<e||f.startLineNumber>e)continue;let g=f.startLineNumber===e?f.startColumn:s.minColumn,b=f.endLineNumber===e?f.endColumn:s.maxColumn;g<b&&(Js(a.themeType)&&l.push(new ul(g,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new Ah(g-1,b-1))))}}let c=new xx(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==lc.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;" class="'),r.appendString(o.CLASS_NAME),r.appendString('">');let u=jB(c,r);r.appendString("</div>");let p=null;return Bh&&r9&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(p=new Fh(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),p||(p=YB(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=p,!0}layoutLine(e,t,n){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(n))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof Fh:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof Fh?this._renderedViewLine.monospaceAssumptionsAreValid():Bh}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof Fh&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n,i){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),n=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,n));let r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&n>r+1)return new ub(!0,[new ms(this.getWidth(i),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&n>r+1&&(n=r+1);let s=this._renderedViewLine.getVisibleRangesForRange(e,t,n,i);return s&&s.length>0?new ub(!1,s):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};var Fh=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(e,t,n){this.domNode=e,this.input=t;let i=Math.floor(t.lineContent.length/300);if(i>0){this._keyColumnPixelOffsetCache=new Float32Array(i);for(let r=0;r<i;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){let t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return Bh;if(this.input.lineContent.length<300){let e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),Bh=!1)}return Bh}toSlowRenderedLine(){return YB(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n,i){let r=this._getColumnPixelOffset(e,t,i),s=this._getColumnPixelOffset(e,n,i);return[new ms(r,s-r)]}_getColumnPixelOffset(e,t,n){if(t<=300){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let i=Math.floor((t-1)/300)-1,r=(i+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[i],s===-1&&(s=this._actualReadPixelOffset(e,r,n),this._keyColumnPixelOffsetCache[i]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(t);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return s+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,n){if(!this.domNode)return-1;let i=this._characterMapping.getDomPosition(t),r=Jc.readHorizontalRanges(this._getReadingTarget(this.domNode),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return XB(this._characterMapping,e,t)}},_x=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(e,t,n,i,r){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,n,i){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let r=this._readPixelOffset(this.domNode,e,t,i);if(r===-1)return null;let s=this._readPixelOffset(this.domNode,e,n,i);return s===-1?null:[new ms(r,s-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,n,i)}_readVisibleRangesForRange(e,t,n,i,r){if(n===i){let s=this._readPixelOffset(e,t,n,r);return s===-1?null:[new ms(s,0)]}else return this._readRawVisibleRangesForRange(e,n,i,r)}_readPixelOffset(e,t,n,i){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(i);let r=this._getReadingTarget(e);return r.firstChild?(i.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let r=this._pixelOffsetCache[n];if(r!==-1)return r;let s=this._actualReadPixelOffset(e,t,n,i);return this._pixelOffsetCache[n]=s,s}return this._actualReadPixelOffset(e,t,n,i)}_actualReadPixelOffset(e,t,n,i){if(this._characterMapping.length===0){let l=Jc.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,i);return!l||l.length===0?-1:l[0].left}if(n===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(i);let r=this._characterMapping.getDomPosition(n),s=Jc.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,i);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(n),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(e,t,n,i){if(t===1&&n===this._characterMapping.length)return[new ms(0,this.getWidth(i))];let r=this._characterMapping.getDomPosition(t),s=this._characterMapping.getDomPosition(n);return Jc.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,s.partIndex,s.charIndex,i)}getColumnOfNodeOffset(e,t){return XB(this._characterMapping,e,t)}},ik=class extends _x{_readVisibleRangesForRange(e,t,n,i,r){let s=super._readVisibleRangesForRange(e,t,n,i,r);if(!s||s.length===0||n===i||n===1&&i===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(e,t,i,r);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},YB=function(){return Ar?s9:a9}();function s9(o,e,t,n,i){return new ik(o,e,t,n,i)}function a9(o,e,t,n,i){return new _x(o,e,t,n,i)}function XB(o,e,t){let n=e.textContent.length,i=-1;for(;e;)e=e.previousSibling,i++;return o.getColumn(new hb(i,t),n)}var pl="monaco-mouse-cursor-text";var Ex=class{constructor(e,t,n,i,r,s,a){this.top=e;this.left=t;this.paddingLeft=n;this.width=i;this.height=r;this.textContent=s;this.textContentClassName=a}};var bb=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(e,t){this._context=e;let n=this._context.configuration.options,i=n.get(51);this._cursorStyle=n.get(28),this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(n.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Ae(document.createElement("div")),this._domNode.setClassName(`cursor ${pl}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),Jt(this._domNode,i),this._domNode.setDisplay("none"),this._position=new M(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(51);return this._cursorStyle=t.get(28),this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),Jt(this._domNode,n),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){let{lineNumber:e,column:t}=this._position,n=this._context.viewModel.getLineContent(e),[i,r]=fv(n,t-1);return[new M(e,i+1),n.substring(i,r)]}_prepareRender(e){let t="",n="",[i,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let p=e.visibleRangeForPosition(i);if(!p||p.outsideRenderedLine)return null;let m=ge(this._domNode.domNode),f;this._cursorStyle===1?(f=_w(m,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=r,n=this._getTokenClassName(i))):f=_w(m,1);let g=p.left,b=0;f>=2&&g>=1&&(b=1,g-=b);let v=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new Ex(v,g,b,f,this._lineHeight,t,n)}let s=e.linesVisibleRangesForRange(new w(i.lineNumber,i.column,i.lineNumber,i.column+r.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(t=r,n=this._getTokenClassName(i));let c=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new Ex(c,l.left,0,d,u,t,n)}_getTokenClassName(e){let t=this._context.viewModel.getViewLineData(e.lineNumber),n=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(n)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${pl} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var Sa=class{constructor(e=null){this.hitTarget=e}type=0},wx=class{constructor(e,t,n){this.position=e;this.spanNode=t;this.injectedText=n}type=1;get hitTarget(){return this.spanNode}},Wh;(e=>{function o(t,n,i){let r=t.getPositionFromDOMInfo(n,i);return r?new wx(r,n,null):new Sa(n)}e.createFromDOMInfo=o})(Wh||={});var Tx=class{constructor(e,t){this.lastViewCursorsRenderData=e;this.lastTextareaPosition=t}},Pn=class{static _deduceRage(e,t=null){return!t&&e?new w(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,n){return{type:0,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,n,i,r,s){return{type:e,element:t,mouseColumn:n,position:i,range:r,detail:s}}static createViewZone(e,t,n,i,r){return{type:e,element:t,mouseColumn:n,position:i,range:this._deduceRage(i),detail:r}}static createContentText(e,t,n,i,r){return{type:6,element:e,mouseColumn:t,position:n,range:this._deduceRage(n,i),detail:r}}static createContentEmpty(e,t,n,i){return{type:7,element:e,mouseColumn:t,position:n,range:this._deduceRage(n),detail:i}}static createContentWidget(e,t,n){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createScrollbar(e,t,n){return{type:11,element:e,mouseColumn:t,position:n,range:this._deduceRage(n)}}static createOverlayWidget(e,t,n){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:n}}static createOutsideEditor(e,t,n,i){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:n,outsideDistance:i}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}},si=class{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}},Vh=class o{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(e,t,n){this.viewModel=e.viewModel;let i=e.configuration.options;this.layoutInfo=i.get(147),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(68),this.stickyTabStops=i.get(118),this.typicalHalfwidthCharacterWidth=i.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return o.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){let n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){let i=n.verticalOffset+n.height/2,r=e.viewModel.getLineCount(),s=null,a,l=null;return n.afterLineNumber!==r&&(l=new M(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new M(n.afterLineNumber,e.viewModel.getLineMaxColumn(n.afterLineNumber))),l===null?a=s:s===null?a=l:t<i?a=s:a=l,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let i=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(i);return{range:new w(i,r,i,r),isAfterLines:!0}}let t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.viewModel.getLineMaxColumn(t);return{range:new w(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return o._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},rk=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(e,t,n,i){this.editorPos=t,this.pos=n,this.relativePos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Hh._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}},sk=class extends rk{_ctx;_eventTarget;hitTestResult=new yi(()=>Hh.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Mn.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,n,i,r){super(e,t,n,i),this._ctx=e,this._eventTarget=r;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Ct.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Pn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Pn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,n,i){return Pn.createMargin(e,this.target,this._getMouseColumn(t),t,n,i)}fulfillViewZone(e,t,n){return Pn.createViewZone(e,this.target,this._getMouseColumn(t),t,n)}fulfillContentText(e,t,n){return Pn.createContentText(this.target,this._getMouseColumn(e),e,t,n)}fulfillContentEmpty(e,t){return Pn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Pn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Pn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Pn.createOverlayWidget(this.target,this._getMouseColumn(),e)}},ZB={isAfterLines:!0};function ok(o){return{isAfterLines:!1,horizontalDistanceToText:o}}var Hh=class o{_context;_viewHelper;constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,n=Mn.collect(t,this._viewHelper.viewDomNode);return!!(si.isChildOfContentWidgets(n)||si.isChildOfOverflowingContentWidgets(n)||si.isChildOfOverlayWidgets(n)||si.isChildOfOverflowingOverlayWidgets(n))}createMouseTarget(e,t,n,i,r){let s=new Vh(this._context,this._viewHelper,e),a=new sk(s,t,n,i,r);try{let l=o._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=o._snapToSoftTabBoundary(l.position,s.viewModel),c=w.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();let n=t,i=null;return!si.isChildOfOverflowGuard(t.targetPath)&&!si.isChildOfOverflowingContentWidgets(t.targetPath)&&!si.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(i=i||t.fulfillUnknown()),i=i||o._hitTestContentWidget(e,n),i=i||o._hitTestOverlayWidget(e,n),i=i||o._hitTestMinimap(e,n),i=i||o._hitTestScrollbarSlider(e,n),i=i||o._hitTestViewZone(e,n),i=i||o._hitTestMargin(e,n),i=i||o._hitTestViewCursor(e,n),i=i||o._hitTestTextArea(e,n),i=i||o._hitTestViewLines(e,n),i=i||o._hitTestScrollbar(e,n),i||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(si.isChildOfContentWidgets(t.targetPath)||si.isChildOfOverflowingContentWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillContentWidget(n):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(si.isChildOfOverlayWidgets(t.targetPath)||si.isChildOfOverflowingOverlayWidgets(t.targetPath)){let n=e.findAttribute(t.target,"widgetId");return n?t.fulfillOverlayWidget(n):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){let n=e.lastRenderData.lastViewCursorsRenderData;for(let i of n)if(t.target===i.domNode)return t.fulfillContentText(i.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){let n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(let s of n){if(i<s.contentLeft||i>s.contentLeft+s.width)continue;let a=e.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=r&&r<=a+s.height)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){let n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){let i=t.isInContentArea?8:5;return t.fulfillViewZone(i,n.position,n)}return null}static _hitTestTextArea(e,t){return si.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){let n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition(),r=Math.abs(t.relativePos.x),s={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};if(r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth){let a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(n.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(r/e.lineHeight)],t.fulfillMargin(2,i,n.range,s)}return r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,i,n.range,s):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,i,n.range,s))}return null}static _hitTestViewLines(e,t){if(!si.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new M(1,1),ZB);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){let i=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new M(i,r),ZB)}if(si.isStrictChildOfViewLines(t.targetPath)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(i)===0){let s=e.getLineWidth(i),a=ok(t.mouseContentHorizontalOffset-s);return t.fulfillContentEmpty(new M(i,1),a)}let r=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=r){let s=ok(t.mouseContentHorizontalOffset-r),a=new M(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(a,s)}}let n=t.hitTestResult.value;return n.type===1?o.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(si.isChildOfMinimap(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new M(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(si.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){let n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new M(i,r))}}return null}static _hitTestScrollbar(e,t){if(si.isChildOfScrollableElement(t.targetPath)){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new M(n,i))}return null}getMouseColumn(e){let t=this._context.configuration.options,n=t.get(147),i=this._context.viewLayout.getCurrentScrollLeft()+e.x-n.contentLeft;return o._getMouseColumn(i,t.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i,r){let s=i.lineNumber,a=i.column,l=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>l){let v=ok(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(i,v)}let d=e.visibleRangeForPosition(s,a);if(!d)return t.fulfillUnknown(i);let c=d.left;if(Math.abs(t.mouseContentHorizontalOffset-c)<1)return t.fulfillContentText(i,null,{mightBeForeignElement:!!r,injectedText:r});let u=[];if(u.push({offset:d.left,column:a}),a>1){let v=e.visibleRangeForPosition(s,a-1);v&&u.push({offset:v.left,column:a-1})}let p=e.viewModel.getLineMaxColumn(s);if(a<p){let v=e.visibleRangeForPosition(s,a+1);v&&u.push({offset:v.left,column:a+1})}u.sort((v,I)=>v.offset-I.offset);let m=t.pos.toClientCoordinates(ge(e.viewDomNode)),f=n.getBoundingClientRect(),g=f.left<=m.clientX&&m.clientX<=f.right,b=null;for(let v=1;v<u.length;v++){let I=u[v-1],C=u[v];if(I.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=C.offset){b=new w(s,I.column,s,C.column);let S=Math.abs(I.offset-t.mouseContentHorizontalOffset),_=Math.abs(C.offset-t.mouseContentHorizontalOffset);i=S<_?new M(s,I.column):new M(s,C.column);break}}return t.fulfillContentText(i,b,{mightBeForeignElement:!g||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){let n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n),r=i+e.lineHeight;if(!(n===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){let a=Math.floor((i+r)/2),l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);let d=new Id(t.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(e,d.toClientCoordinates(ge(e.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(ge(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let n=Al(e.viewDomNode),i;if(n?typeof n.caretRangeFromPoint>"u"?i=d9(n,t.clientX,t.clientY):i=n.caretRangeFromPoint(t.clientX,t.clientY):i=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new Sa;let r=i.startContainer;if(r.nodeType===r.TEXT_NODE){let s=r.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===gs.CLASS_NAME?Wh.createFromDOMInfo(e,s,i.startOffset):new Sa(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){let s=r.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===gs.CLASS_NAME?Wh.createFromDOMInfo(e,r,r.textContent.length):new Sa(r)}return new Sa}static _doHitTestWithCaretPositionFromPoint(e,t){let n=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){let i=n.offsetNode.parentNode,r=i?i.parentNode:null,s=r?r.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===gs.CLASS_NAME?Wh.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new Sa(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){let i=n.offsetNode.parentNode,r=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,s=i?i.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(r===gs.CLASS_NAME){let l=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(l)return Wh.createFromDOMInfo(e,l,0)}else if(a===gs.CLASS_NAME)return Wh.createFromDOMInfo(e,n.offsetNode,0)}return new Sa(n.offsetNode)}static _snapToSoftTabBoundary(e,t){let n=t.getLineContent(e.lineNumber),{tabSize:i}=t.model.getOptions(),r=kc.atomicPosition(n,e.column-1,i,2);return r!==-1?new M(e.lineNumber,r+1):e}static doHitTest(e,t){let n=new Sa;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?n=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(ge(e.viewDomNode)))),n.type===1){let i=e.viewModel.getInjectedTextAt(n.position),r=e.viewModel.normalizePosition(n.position,2);(i||!r.equals(n.position))&&(n=new wx(r,n.spanNode,i))}return n}};function d9(o,e,t){let n=document.createRange(),i=o.elementFromPoint(e,t);if(i!==null){for(;i&&i.firstChild&&i.firstChild.nodeType!==i.firstChild.TEXT_NODE&&i.lastChild&&i.lastChild.firstChild;)i=i.lastChild;let r=i.getBoundingClientRect(),s=ge(i),a=s.getComputedStyle(i,null).getPropertyValue("font-style"),l=s.getComputedStyle(i,null).getPropertyValue("font-variant"),d=s.getComputedStyle(i,null).getPropertyValue("font-weight"),c=s.getComputedStyle(i,null).getPropertyValue("font-size"),u=s.getComputedStyle(i,null).getPropertyValue("line-height"),p=s.getComputedStyle(i,null).getPropertyValue("font-family"),m=`${a} ${l} ${d} ${c}/${u} ${p}`,f=i.innerText,g=r.left,b=0,v;if(e>r.left+r.width)b=f.length;else{let I=ak.getInstance();for(let C=0;C<f.length+1;C++){if(v=I.getCharWidth(f.charAt(C),m)/2,g+=v,e<g){b=C;break}g+=v}}n.setStart(i.firstChild,b),n.setEnd(i.firstChild,b)}return n}var ak=class o{static _INSTANCE=null;static getInstance(){return o._INSTANCE||(o._INSTANCE=new o),o._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){let n=e+t;if(this._cache[n])return this._cache[n];let i=this._canvas.getContext("2d");i.font=t;let s=i.measureText(e).width;return this._cache[n]=s,s}};var Uh=class o{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(e){this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return o.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){let n={...e};return n.position&&(n.position=t.convertViewPositionToModelPosition(n.position)),n.range&&(n.range=t.convertViewRangeToModelRange(n.range)),(n.type===5||n.type===8)&&(n.detail=this.convertViewToModelViewZoneData(n.detail,t)),n}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new M(e.afterLineNumber,1)).lineNumber}}};var Lx=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){_n.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){let t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new M(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(79)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){let t=this.configuration.options,n=Ut&&t.get(109),i=t.get(22);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){_n.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){_n.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,n){e=this._validateViewColumn(e),_n.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),_n.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){_n.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){_n.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){_n.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){_n.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){_n.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){_n.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){_n.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){_n.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){_n.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}};var zh=class extends Cr{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new Hh(this._context,n),this._mouseDownOperation=this._register(new dk(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let i=new ux(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(i.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=Y(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new wr(a,!1,this.viewHelper.viewDomNode))}))})),this._register(i.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let r=0;this._register(i.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{r=a})),this._register(Y(this.viewHelper.viewDomNode,Ee.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(i.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let e=Kf.INSTANCE,t=0,n=Us.getZoomLevel(),i=!1,r=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Zo(l);if(e.acceptStandardWheelEvent(d),e.isPhysicalMouseWheel()){if(a(l)){let c=Us.getZoomLevel(),u=d.deltaY>0?1:-1;Us.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-t>50&&(n=Us.getZoomLevel(),i=a(l),r=0),t=Date.now(),r+=d.deltaY,i&&(Us.setZoomLevel(n+r/5),d.preventDefault(),d.stopPropagation())};this._register(Y(this.viewHelper.viewDomNode,Ee.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return Ve?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(147)){let t=this._context.configuration.options.get(147).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){let i=new cb(e,t).toPageCoordinates(ge(this.viewHelper.viewDomNode)),r=mx(this.viewHelper.viewDomNode);if(i.y<r.y||i.y>r.y+r.height||i.x<r.x||i.x>r.x+r.width)return null;let s=gx(this.viewHelper.viewDomNode,r,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,i,s,null)}_createMouseTarget(e,t){let n=e.target;if(!this.viewHelper.viewDomNode.contains(n)){let i=Al(this.viewHelper.viewDomNode);i&&(n=i.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?n:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){let n=this._createMouseTarget(e,!0),i=n.type===6||n.type===7,r=n.type===2||n.type===3||n.type===4,s=n.type===3,a=this._context.configuration.options.get(111),l=n.type===8||n.type===5,d=n.type===9,c=e.leftButton||e.middleButton;Ve&&e.leftButton&&e.ctrlKey&&(c=!1);let u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(i||s&&a))u(),this._mouseDownOperation.start(n.type,e,t);else if(r)e.preventDefault();else if(l){let p=n.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(p.viewZoneId)&&(u(),this._mouseDownOperation.start(n.type,e,t),e.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(n.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:n})}_onMouseWheel(e){this.viewController.emitMouseWheel(e)}},dk=class extends V{constructor(t,n,i,r,s,a){super();this._context=t;this._viewController=n;this._viewHelper=i;this._mouseTargetFactory=r;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new hx(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new ck(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new pk,this._currentSelection=new Me(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);let n=this._findMousePosition(t,!1);n&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:n}):n.type===13&&(n.outsidePosition==="above"||n.outsidePosition==="below")?this._topBottomDragScrolling.start(n,t):(this._topBottomDragScrolling.stop(),this._dispatchMouse(n,!0,1)))}start(t,n,i){this._lastMouseEvent=n,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(n),this._mouseState.setModifiers(n);let r=this._findMousePosition(n,!0);if(!r||!r.position)return;this._mouseState.trySetCount(n.detail,r.position),n.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&n.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&r.type===6&&r.position&&this._currentSelection.containsPosition(r.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);xw(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(r,n.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,n.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){let n=t.editorPos,i=this._context.viewModel,r=this._context.viewLayout,s=this._getMouseColumn(t);if(t.posy<n.y){let l=n.y-t.posy,d=Math.max(r.getCurrentScrollTop()-l,0),c=Vh.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Pn.createOutsideEditor(s,p,"above",l)}let u=r.getLineNumberAtVerticalOffset(d);return Pn.createOutsideEditor(s,new M(u,1),"above",l)}if(t.posy>n.y+n.height){let l=t.posy-n.y-n.height,d=r.getCurrentScrollTop()+t.relativePos.y,c=Vh.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Pn.createOutsideEditor(s,p,"below",l)}let u=r.getLineNumberAtVerticalOffset(d);return Pn.createOutsideEditor(s,new M(u,i.getLineMaxColumn(u)),"below",l)}let a=r.getLineNumberAtVerticalOffset(r.getCurrentScrollTop()+t.relativePos.y);if(t.posx<n.x){let l=n.x-t.posx;return Pn.createOutsideEditor(s,new M(a,1),"left",l)}if(t.posx>n.x+n.width){let l=t.posx-n.x-n.width;return Pn.createOutsideEditor(s,new M(a,i.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(t,n){let i=this._getPositionOutsideEditor(t);if(i)return i;let r=this._createMouseTarget(t,n);if(!r.position)return null;if(r.type===8||r.type===5){let a=this._helpPositionJumpOverViewZone(r.detail);if(a)return Pn.createViewZone(r.type,r.element,r.mouseColumn,a,r.detail)}return r}_helpPositionJumpOverViewZone(t){let n=new M(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=t.positionBefore,r=t.positionAfter;return i&&r?i.isBefore(n)?i:r:null}_dispatchMouse(t,n,i){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:n,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}},ck=class extends V{constructor(t,n,i,r){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(t,n){this._operation?this._operation.setPosition(t,n):this._operation=new uk(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,n)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},uk=class extends V{constructor(t,n,i,r,s,a){super();this._context=t;this._viewHelper=n;this._mouseTargetFactory=i;this._dispatchMouse=r;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=Zn(ge(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,n){this._position=t,this._mouseEvent=n}_tick(){let t=Date.now(),n=t-this._lastTime;return this._lastTime=t,n}_getScrollSpeed(){let t=this._context.configuration.options.get(68),n=this._context.configuration.options.get(147).height/t,i=this._position.outsideDistance/t;return i<=1.5?Math.max(30,n*(1+i)):i<=3?Math.max(60,n*(2+i)):Math.max(200,n*(7+i))}_execute(){let t=this._context.configuration.options.get(68),n=this._getScrollSpeed(),i=this._tick(),r=n*(i/1e3)*t,s=this._position.outsidePosition==="above"?-r:r;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=mx(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,p=new Id(this._mouseEvent.pos.x,c.y+c.height-u-.1),m=gx(this._viewHelper.viewDomNode,c,p);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,p,m,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Pn.createOutsideEditor(this._position.mouseColumn,new M(l,1),"above",this._position.outsideDistance):d=Pn.createOutsideEditor(this._position.mouseColumn,new M(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=Zn(ge(d.element),()=>this._execute())}},pk=class o{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let n=new Date().getTime();n-this._lastSetMouseDownCountTime>o.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};function Dx(o,e,t,n){let i=o.getPlainTextToCopy(e,t,ct),r=o.model.getEOL(),s=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(i)?i:null,l=Array.isArray(i)?i.join(r):i,d,c=null;if(u9.forceCopyWithSyntaxHighlighting||n&&l.length<65536){let p=o.getRichTextToCopy(e,t);p&&(d=p.html,c=p.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var tu=class o{static INSTANCE=new o;_lastState;constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}},u9={forceCopyWithSyntaxHighlighting:!1};var Kh=class o{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){let n=e*t,i=n+1,r=n+t;return new w(i,1,r+1,1)}static fromEditorSelection(e,t,n,i){let s=o._getPageOfLine(t.startLineNumber,n),a=o._getRangeForPage(s,n),l=o._getPageOfLine(t.endLineNumber,n),d=o._getRangeForPage(l,n),c=a.intersectRanges(new w(1,1,t.startLineNumber,t.startColumn));if(i&&e.getValueLengthInRange(c,1)>500){let v=e.modifyPosition(c.getEndPosition(),-500);c=w.fromPositions(v,c.getEndPosition())}let u=e.getValueInRange(c,1),p=e.getLineCount(),m=e.getLineMaxColumn(p),f=d.intersectRanges(new w(t.endLineNumber,t.endColumn,p,m));if(i&&e.getValueLengthInRange(f,1)>500){let v=e.modifyPosition(f.getStartPosition(),500);f=w.fromPositions(f.getStartPosition(),v)}let g=e.getValueInRange(f,1),b;if(s===l||s+1===l)b=e.getValueInRange(t,1);else{let v=a.intersectRanges(t),I=d.intersectRanges(t);b=e.getValueInRange(v,1)+"\u2026"+e.getValueInRange(I,1)}return i&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+g,selection:t,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function vb(o,e){if(o.get(2)===1){let n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),i=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),r=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=h("accessibilityModeOff","The editor is not accessible at this time.");return n?h("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,n):i?h("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,i):r?h("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,r):s}return o.get(4)}function yb(o){let e=0,t=-1;do{if(t=o.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var mo=!1,Nn=class o{constructor(e,t,n,i,r){this.value=e;this.selectionStart=t;this.selectionEnd=n;this.selection=i;this.newlineCountBeforeSelection=r}static EMPTY=new o("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){let n=e.getValue(),i=e.getSelectionStart(),r=e.getSelectionEnd(),s;if(t){let a=n.substring(0,i),l=t.value.substring(0,t.selectionStart);a===l&&(s=t.newlineCountBeforeSelection)}return new o(n,i,r,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new o(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,n){mo&&console.log(`writeToTextArea ${e}: ${this.toString()}`),t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){let i=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,i,-1)}if(e>=this.selectionEnd){let i=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,1)}let t=this.value.substring(this.selectionStart,e);if(t.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);let n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)i++;return[e,n*t.length,i]}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};mo&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`));let i=Math.min(Or(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(Mm(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd),s=e.value.substring(i,e.value.length-r),a=t.value.substring(i,t.value.length-r),l=e.selectionStart-i,d=e.selectionEnd-i,c=t.selectionStart-i,u=t.selectionEnd-i;if(mo&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let m=e.selectionStart-i;return mo&&console.log(`REMOVE PREVIOUS: ${m} chars`),{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}let p=d-l;return{text:a,replacePrevCharCnt:p,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(mo&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${e.toString()}`),console.log(`CURRENT STATE: ${t.toString()}`)),e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};let n=Math.min(Or(e.value,t.value),e.selectionEnd),i=Math.min(Mm(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(n,e.value.length-i),s=t.value.substring(n,t.value.length-i),a=e.selectionStart-n,l=e.selectionEnd-n,d=t.selectionStart-n,c=t.selectionEnd-n;return mo&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${r}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:r.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(e){return new o(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};var Rx;(e=>e.Tap="-monaco-textarea-synthetic-tap")(Rx||={});var hk=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";let t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}},Gh=class extends V{constructor(t,n,i,r,s,a){super();this._host=t;this._textArea=n;this._OS=i;this._browser=r;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new dn(()=>this._onCut.fire(),0)),this._textAreaState=Nn.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(de.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new dn(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new pt(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new pt(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{mo&&console.log("[compositionstart]",d);let c=new hk;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){mo&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{mo&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let p=Nn.readFromTextArea(this._textArea,this._textAreaState),m=Nn.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Nn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{mo&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let p=Nn.readFromTextArea(this._textArea,this._textAreaState),m=Nn.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Nn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(mo&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=Nn.readFromTextArea(this._textArea,this._textAreaState),u=Nn.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(At(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=QB.getTextData(d.clipboardData);c&&(u=u||tu.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new dn(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new L);onFocus=this._onFocus.event;_onBlur=this._register(new L);onBlur=this._onBlur.event;_onKeyDown=this._register(new L);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new L);onKeyUp=this._onKeyUp.event;_onCut=this._register(new L);onCut=this._onCut.event;_onPaste=this._register(new L);onPaste=this._onPaste.event;_onType=this._register(new L);onType=this._onType.event;_onCompositionStart=this._register(new L);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new L);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new L);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new L);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new Wt);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=Nn.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let t=0;return Y(this._textArea.ownerDocument,"selectionchange",n=>{if(cl.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let i=Date.now(),r=i-t;if(t=i,r<5)return;let s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),p=this._textAreaState.deduceEditorPosition(d),m=this._host.deduceModelPosition(p[0],p[1],p[2]),f=new Me(u.lineNumber,u.column,m.lineNumber,m.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,n){this._hasFocus||(n=n.collapseSelection()),n.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=n}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){let n=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:n.isFromEmptySelection,multicursorText:n.multicursorText,mode:n.mode};tu.INSTANCE.set(this._browser.isFirefox?n.text.replace(/\r\n/g,`
`):n.text,i),t.preventDefault(),t.clipboardData&&QB.setTextData(t.clipboardData,n.text,n.html,i)}};Gh=K([D(4,Vi),D(5,xn)],Gh);var QB={getTextData(o){let e=o.getData(fc.text),t=null,n=o.getData("vscode-editor-data");if(typeof n=="string")try{t=JSON.parse(n),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&o.files.length>0?[Array.prototype.slice.call(o.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(o,e,t,n){o.setData(fc.text,e),typeof t=="string"&&o.setData("text/html",t),o.setData("vscode-editor-data",JSON.stringify(n))}},kx=class extends V{constructor(t){super();this._actual=t;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>cl.onKeyDown())),this._register(this.onBeforeInput(()=>cl.onBeforeInput())),this._register(this.onInput(()=>cl.onInput())),this._register(this.onKeyUp(()=>cl.onKeyUp())),this._register(Y(this._actual,Rx.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new He(this._actual,"keydown")).event;onKeyPress=this._register(new He(this._actual,"keypress")).event;onKeyUp=this._register(new He(this._actual,"keyup")).event;onCompositionStart=this._register(new He(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new He(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new He(this._actual,"compositionend")).event;onBeforeInput=this._register(new He(this._actual,"beforeinput")).event;onInput=this._register(new He(this._actual,"input")).event;onCut=this._register(new He(this._actual,"cut")).event;onCopy=this._register(new He(this._actual,"copy")).event;onPaste=this._register(new He(this._actual,"paste")).event;onFocus=this._register(new He(this._actual,"focus")).event;onBlur=this._register(new He(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new L);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let t=Al(this._actual);return t?t.activeElement===this._actual:this._actual.isConnected?Ji()===this._actual:!1}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,n){let i=this._actual;i.value!==n&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=n)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,n,i){let r=this._actual,s=null,a=Al(r);a?s=a.activeElement:s=Ji();let l=ge(s),d=s===r,c=r.selectionStart,u=r.selectionEnd;if(d&&c===n&&u===i){In&&l.parent!==l&&r.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),r.setSelectionRange(n,i),In&&l.parent!==l&&r.focus();return}try{let p=vP(r);this.setIgnoreSelectionChangeTime("setSelectionRange"),r.focus(),r.setSelectionRange(n,i),yP(r,p)}catch{}}};var mk=class extends zh{_lastPointerType;constructor(e,t,n){super(e,t,n),this._register(mn.addTarget(this.viewHelper.linesContentDomNode)),this._register(Y(this.viewHelper.linesContentDomNode,ht.Tap,r=>this.onTap(r))),this._register(Y(this.viewHelper.linesContentDomNode,ht.Change,r=>this.onChange(r))),this._register(Y(this.viewHelper.linesContentDomNode,ht.Contextmenu,r=>this._onContextMenu(new wr(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(Y(this.viewHelper.linesContentDomNode,"pointerdown",r=>{let s=r.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let i=new px(this.viewHelper.viewDomNode);this._register(i.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(i.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(r,s)=>this._onMouseDown(r,s)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){let n=this._createMouseTarget(new wr(e,!1,this.viewHelper.viewDomNode),!1);n.position&&this.viewController.dispatchMouse({position:n.position,mouseColumn:n.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:n.type===6&&n.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}},gk=class extends zh{constructor(e,t,n){super(e,t,n),this._register(mn.addTarget(this.viewHelper.linesContentDomNode)),this._register(Y(this.viewHelper.linesContentDomNode,ht.Tap,i=>this.onTap(i))),this._register(Y(this.viewHelper.linesContentDomNode,ht.Change,i=>this.onChange(i))),this._register(Y(this.viewHelper.linesContentDomNode,ht.Contextmenu,i=>this._onContextMenu(new wr(i,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();let t=this._createMouseTarget(new wr(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){let n=document.createEvent("CustomEvent");n.initEvent(Rx.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(n),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}},Mx=class extends V{handler;constructor(e,t,n){super(),(bm||jR&&UR)&&_v.pointerEvents?this.handler=this._register(new mk(e,t,n)):Yt.TouchEvent?this.handler=this._register(new gk(e,t,n)):this.handler=this._register(new zh(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}};var Gi=class extends Cr{};var Px=class extends Nt{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(e){super(e),this._visibleLines=new Nh({createLine:()=>new fk(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let n=this._context.configuration.options.get(51);Jt(this.domNode,n),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);let n=this._context.configuration.options.get(51);return Jt(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(n=>n.shouldRender());for(let n=0,i=t.length;n<i;n++){let r=t[n];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}},fk=class{_dynamicOverlays;_domNode;_renderedContent;constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Ae(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,n,i,r){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,r.appendString('<div style="top:'),r.appendString(String(t)),r.appendString("px;height:"),r.appendString(String(n)),r.appendString('px;">'),r.appendString(s),r.appendString("</div>"),!0)}layoutLine(e,t,n){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(n))}},Nx=class extends Px{_contentWidth;constructor(e){super(e);let n=this._context.configuration.options.get(147);this._contentWidth=n.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._contentWidth=n.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}},Ox=class extends Px{_contentLeft;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Jt(this.domNode,t.get(51))}onConfigurationChanged(e){let t=this._context.configuration.options;Jt(this.domNode,t.get(51));let n=t.get(147);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);let t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}};var Ax=class extends Nt{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(e){super(e),this.domNode=Ae(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1,n=this._context.configuration.options.get(147),i=n.contentWidth-n.verticalScrollbarWidth;this.contentWidth!==i&&(this.contentWidth=i,e=!0);let r=n.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0,n=e.getDecorationsInViewport();for(let i of n){if(!i.options.blockClassName)continue;let r=this.blocks[t];r||(r=this.blocks[t]=Ae(document.createElement("div")),this.domNode.appendChild(r));let s,a;i.options.blockIsAfterEnd?(s=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0)):(s=e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!0),a=i.range.isEmpty()&&!i.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(i.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(i.range.endLineNumber,!0));let[l,d,c,u]=i.options.blockPadding??[0,0,0,0];r.setClassName("blockDecorations-block "+i.options.blockClassName),r.setLeft(this.contentLeft-u),r.setWidth(this.contentWidth+u+d),r.setTop(s-e.scrollTop-l),r.setHeight(a-s+l+c),t++}for(let i=t;i<this.blocks.length;i++)this.blocks[i].domNode.remove();this.blocks.length=t}};var Fx=class extends Nt{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Ae(document.createElement("div")),Mn.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Ae(document.createElement("div")),Mn.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){let e=Object.keys(this._widgets);for(let t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){let t=new vk(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n,i,r){this._widgets[e.getId()].setPosition(t,n,i,r),this.setShouldRender()}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let n=this._widgets[t];delete this._widgets[t];let i=n.domNode.domNode;i.remove(),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].prepareRender(e)}render(e){let t=Object.keys(this._widgets);for(let n of t)this._widgets[n].render(e)}},vk=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new nu(null,null);_secondaryAnchor=new nu(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=Ae(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let i=this._context.configuration.options,r=i.get(147);this._fixedOverflowWidgets=i.get(43),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=i.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){let t=this._context.configuration.options;if(this._lineHeight=t.get(68),e.hasChanged(147)){let n=t.get(147);this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,n){this._affinity=e,this._primaryAnchor=i(t,this._context.viewModel,this._affinity),this._secondaryAnchor=i(n,this._context.viewModel,this._affinity);function i(r,s,a){if(!r)return new nu(null,null);let l=s.model.validatePosition(r);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new nu(r,d)}return new nu(r,null)}}_getMaxWidth(){let e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,n,i){this._setPosition(i,e,t),this._preference=n,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,n,i){let r=e.top,s=r,a=e.top+e.height,l=i.viewportHeight-a,d=r-n,c=s>=n,u=a,p=l>=n,m=e.left;return m+t>i.scrollLeft+i.viewportWidth&&(m=i.scrollLeft+i.viewportWidth-t),m<i.scrollLeft&&(m=i.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:p,belowTop:u,left:m}}_layoutHorizontalSegmentInPage(e,t,n,i){let a=Math.max(15,t.left-i),l=Math.min(t.left+t.width+i,e.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=t.left+n-(c?.scrollX??0);if(u+i>l){let p=u-(l-i);u-=p,n-=p}if(u<a){let p=u-a;u-=p,n-=p}return[n,u]}_layoutBoxInPage(e,t,n,i){let r=e.top-n,s=e.top+e.height,a=Bi(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+r-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),p=Gd(l.body),[m,f]=this._layoutHorizontalSegmentInPage(p,a,e.left-i.scrollLeft+this._contentLeft,t),g=22,b=22,v=c>=g,I=u+n<=p.height-b;return this._fixedOverflowWidgets?{fitsAbove:v,aboveTop:Math.max(c,g),fitsBelow:I,belowTop:u,left:f}:{fitsAbove:v,aboveTop:r,fitsBelow:I,belowTop:s,left:m}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new iu(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){let t=r(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),n=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,i=r(n,this._affinity,this._lineHeight);return{primary:t,secondary:i};function r(s,a,l){if(!s)return null;let d=e.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.scrollTop;return new Bx(u,c,l)}}_reduceAnchorCoordinates(e,t,n){if(!t)return e;let i=this._context.configuration.options.get(51),r=t.left;return r<e.left?r=Math.max(r,e.left-n+i.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+n-i.typicalFullwidthCharacterWidth),new Bx(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;let{primary:t,secondary:n}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=bk(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let i=this._reduceAnchorCoordinates(t,n,this._cachedDomNodeOffsetWidth),r;this.allowEditorOverflow?r=this._layoutBoxInPage(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!r)return null;if(s===2||r.fitsAbove)return{kind:"inViewport",coordinate:new iu(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(s===2||r.fitsBelow)return{kind:"inViewport",coordinate:new iu(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new iu(i.top,i.left)),position:0}:{kind:"inViewport",coordinate:new iu(i.top,i.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&bk(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&bk(this._actual.afterRender,this._actual,this._renderData.position)}},nu=class{constructor(e,t){this.modelPosition=e;this.viewPosition=t}},iu=class{constructor(e,t){this.top=e;this.left=t}_coordinateBrand=void 0},Bx=class{constructor(e,t,n){this.top=e;this.left=t;this.height=n}_anchorCoordinateBrand=void 0};function bk(o,e,...t){try{return o.call(e,...t)}catch{return null}}var Wx=class extends Gi{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(e){super(),this._context=e;let t=this._context.configuration.options,n=t.get(147);this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Me(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1,t=new Set;for(let r of this._selections)t.add(r.positionLineNumber);let n=Array.from(t);n.sort((r,s)=>r-s),tn(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);let i=this._selections.every(r=>r.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._renderLineHighlight=t.get(98),this._renderLineHighlightOnlyWhenFocus=t.get(99),this._wordWrap=n.isViewportWrapping,this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=[];for(let s=t;s<=n;s++){let a=s-t;i[a]=""}if(this._wordWrap){let s=this._renderOne(e,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new M(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new M(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new M(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,p=Math.max(c,t),m=Math.min(u,n);for(let f=p;f<=m;f++){let g=f-t;i[g]=s}}}let r=this._renderOne(e,!0);for(let s of this._cursorLineNumbers){if(s<t||s>n)continue;let a=s-t;i[a]=r}this._renderData=i}render(e,t){if(!this._renderData)return"";let n=t-e;return n>=this._renderData.length?"":this._renderData[n]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},Vx=class extends Wx{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},Hx=class extends Wx{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};zi((o,e)=>{let t=o.getColor(O1);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||o.defines(A1)){let n=o.getColor(A1);n&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${n}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${n}; }`),Js(o.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var Ux=class extends Gi{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let l=0,d=t.length;l<d;l++){let c=t[l];c.options.className&&(n[i++]=c)}n=n.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:w.compareRangesUsingStarts(l.range,d.range)});let r=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=s;l++){let d=l-r;a[d]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){let l=t[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,i),u=Math.min(l.range.endLineNumber,r);for(let p=c;p<=u;p++){let m=p-i;n[m]+=d}}}_renderNormalDecorations(e,t,n){let i=e.visibleRange.startLineNumber,r=null,s=!1,a=null,l=!1;for(let d=0,c=t.length;d<c;d++){let u=t[d];if(u.options.isWholeLine)continue;let p=u.options.className,m=!!u.options.showIfCollapsed,f=u.range;if(m&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new w(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),r===p&&s===m&&w.areIntersectingOrTouching(a,f)){a=w.plusRange(a,f);continue}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n),r=p,s=m,a=f,l=u.options.shouldFillLineOnLineBreak??!1}r!==null&&this._renderNormalDecoration(e,a,r,l,s,i,n)}_renderNormalDecoration(e,t,n,i,r,s,a){let l=e.linesVisibleRangesForRange(t,n==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let p=u.lineNumber-s;if(r&&u.ranges.length===1){let m=u.ranges[0];if(m.width<this._typicalHalfwidthCharacterWidth){let f=Math.round(m.left+m.width/2),g=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new Mh(g,this._typicalHalfwidthCharacterWidth)}}for(let m=0,f=u.ranges.length;m<f;m++){let g=i&&u.continuesOnNextLine&&f===1,b=u.ranges[m],v='<div class="cdr '+n+'" style="left:'+String(b.left)+"px;width:"+(g?"100%;":String(b.width)+"px;")+'"></div>';a[p]+=v}}}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};var zx=class extends Nt{scrollbar;scrollbarDomNode;constructor(e,t,n,i){super(e);let r=this._context.configuration.options,s=r.get(105),a=r.get(76),l=r.get(41),d=r.get(108),c={listenOnDomNode:n.domNode,className:"editor-scrollable "+Xg(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new xh(t.domNode,c,this._context.viewLayout.getScrollable())),Mn.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Ae(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(p,m,f)=>{let g={};if(m){let b=p.scrollTop;b&&(g.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,p.scrollTop=0)}if(f){let b=p.scrollLeft;b&&(g.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(g,1)};this._register(Y(n.domNode,"scroll",p=>u(n.domNode,!0,!0))),this._register(Y(t.domNode,"scroll",p=>u(t.domNode,!0,!1))),this._register(Y(i.domNode,"scroll",p=>u(i.domNode,!0,!1))),this._register(Y(this.scrollbarDomNode.domNode,"scroll",p=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let e=this._context.configuration.options,t=e.get(147);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(74).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(105)||e.hasChanged(76)||e.hasChanged(41)){let t=this._context.configuration.options,n=t.get(105),i=t.get(76),r=t.get(41),s=t.get(108),a={vertical:n.vertical,horizontal:n.horizontal,verticalScrollbarSize:n.verticalScrollbarSize,horizontalScrollbarSize:n.horizontalScrollbarSize,scrollByPage:n.scrollByPage,handleMouseWheel:n.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:r,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return e.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+Xg(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}};var ou=class{constructor(e,t,n,i,r){this.startLineNumber=e;this.endLineNumber=t;this.className=n;this.tooltip=i;this.zIndex=r??0}_decorationToRenderBrand=void 0;zIndex},yk=class{constructor(e,t,n){this.className=e;this.zIndex=t;this.tooltip=n}},Ik=class{decorations=[];add(e){this.decorations.push(e)}getDecorations(){return this.decorations}},$h=class extends Gi{_render(e,t,n){let i=[];for(let a=e;a<=t;a++){let l=a-e;i[l]=new Ik}if(n.length===0)return i;n.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,s=0;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d.className,u=d.zIndex,p=Math.max(d.startLineNumber,e)-e,m=Math.min(d.endLineNumber,t)-e;r===c?(p=Math.max(s+1,p),s=Math.max(s,m)):(r=c,s=m);for(let f=p;f<=s;f++)i[f].add(new yk(c,u,d.tooltip))}return i}},Kx=class extends Nt{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(e){super(e),this._context=e;let t=this._context.configuration.options,n=t.get(147);this.domNode=Ae(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._glyphMargin=t.get(58),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._glyphMarginDecorationLaneCount=n.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){let t=Ae(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let n=this._widgets[e.getId()];return n.preference.lane===t.lane&&n.preference.zIndex===t.zIndex&&w.equalsRange(n.preference.range,t.range)?!1:(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId();if(this._widgets[t]){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=e.getDecorationsInViewport();for(let s of r){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,n),d=Math.min(s.range.endLineNumber,i),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let p=l;p<=d;p++){let m=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new M(p,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(m.lineNumber).indexOf(c);t.push(new Ck(p,f,u,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){let n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let r of Object.values(this._widgets)){let s=r.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(w.lift(s));if(!a||!l||l<n||a>i)continue;let d=Math.max(a,n),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new M(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(r.preference.lane);t.push(new Sk(d,u,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){let t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((n,i)=>n.lineNumber===i.lineNumber?n.laneIndex===i.laneIndex?n.zIndex===i.zIndex?i.type===n.type?n.type===0&&i.type===0?n.className<i.className?-1:1:0:i.type-n.type:i.zIndex-n.zIndex:n.laneIndex-i.laneIndex:n.lineNumber-i.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let i of Object.values(this._widgets))i.renderInfo=null;let t=new ji(this._collectSortedGlyphRenderRequests(e)),n=[];for(;t.length>0;){let i=t.peek();if(!i)break;let r=t.takeWhile(a=>a.lineNumber===i.lineNumber&&a.laneIndex===i.laneIndex);if(!r||r.length===0)break;let s=r[0];if(s.type===0){let a=[];for(let l of r){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}n.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=n}render(e){if(!this._glyphMargin){for(let n of Object.values(this._widgets))n.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let n of Object.values(this._widgets))if(!n.renderInfo)n.domNode.setDisplay("none");else{let i=e.viewportData.relativeVerticalOffset[n.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.renderInfo.laneIndex*this._lineHeight;n.domNode.setDisplay("block"),n.domNode.setTop(i),n.domNode.setLeft(r),n.domNode.setWidth(t),n.domNode.setHeight(this._lineHeight)}for(let n=0;n<this._decorationGlyphsToRender.length;n++){let i=this._decorationGlyphsToRender[n],r=e.viewportData.relativeVerticalOffset[i.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.laneIndex*this._lineHeight,a;n<this._managedDomNodes.length?a=this._managedDomNodes[n]:(a=Ae(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+i.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(s),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var Ck=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.className=i}type=0;accept(e){return new xk(this.lineNumber,this.laneIndex,e)}},Sk=class{constructor(e,t,n,i){this.lineNumber=e;this.laneIndex=t;this.zIndex=n;this.widget=i}type=1},xk=class{constructor(e,t,n){this.lineNumber=e;this.laneIndex=t;this.combinedClassName=n}};var Gx=class extends Gi{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(e){super(),this._context=e,this._primaryPosition=null;let t=this._context.configuration.options,n=t.get(148),i=t.get(51);this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(148),i=t.get(51);return this._spaceWidth=i.spaceWidth,this._maxIndentLeft=n.wrappingColumn===-1?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){let n=e.selections[0].getPosition();return this._primaryPosition?.equals(n)?!1:(this._primaryPosition=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=e.scrollWidth,r=this._primaryPosition,s=this.getGuidesByLine(t,Math.min(n+1,this._context.viewModel.getLineCount()),r),a=[];for(let l=t;l<=n;l++){let d=l-t,c=s[d],u="",p=e.visibleRangeForPosition(new M(l,1))?.left??0;for(let m of c){let f=m.column===-1?p+(m.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new M(l,m.column)).left;if(f>i||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;let g=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=m.horizontalLine?(e.visibleRangeForPosition(new M(l,m.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;u+=`<div class="core-guide ${m.className} ${g}" style="left:${f}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(e,t,n){let i=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,n,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&n){let u=this._context.viewModel.getActiveIndentGuide(n.lineNumber,e,t);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=e;u<=t;u++){let p=new Array;c.push(p);let m=i?i[u-e]:[],f=new ji(m),g=r?r[u-e]:0;for(let b=1;b<=g;b++){let v=(b-1)*d+1,I=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||m.length===0)&&s<=u&&u<=a&&b===l;p.push(...f.takeWhile(S=>S.visibleColumn<v)||[]);let C=f.peek();(!C||C.visibleColumn!==v||C.horizontalLine)&&p.push(new yr(v,-1,`core-guide-indent lvl-${(b-1)%30}`+(I?" indent-active":""),null,-1,-1))}p.push(...f.takeWhile(b=>!0)||[])}return c}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};function jh(o){if(!(o&&o.isTransparent()))return o}zi((o,e)=>{let t=[{bracketColor:_C,guideColor:OF,guideColorActive:HF},{bracketColor:EC,guideColor:AF,guideColorActive:UF},{bracketColor:wC,guideColor:FF,guideColorActive:zF},{bracketColor:TC,guideColor:BF,guideColorActive:KF},{bracketColor:LC,guideColor:WF,guideColorActive:GF},{bracketColor:DC,guideColor:VF,guideColorActive:$F}],n=new gf,i=[{indentColor:vF,indentColorActive:_F},{indentColor:yF,indentColorActive:EF},{indentColor:IF,indentColorActive:wF},{indentColor:CF,indentColorActive:TF},{indentColor:SF,indentColorActive:LF},{indentColor:xF,indentColorActive:DF}],r=t.map(a=>{let l=o.getColor(a.bracketColor),d=o.getColor(a.guideColor),c=o.getColor(a.guideColorActive),u=jh(jh(d)??l?.transparent(.3)),p=jh(jh(c)??l);if(!(!u||!p))return{guideColor:u,guideColorActive:p}}).filter(Hd),s=i.map(a=>{let l=o.getColor(a.indentColor),d=o.getColor(a.indentColorActive),c=jh(l),u=jh(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(Hd);if(r.length>0){for(let a=0;a<30;a++){let l=r[a%r.length];e.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${n.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${n.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${n.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var qh=class o extends Gi{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new M(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let e=this._context.configuration.options;this._lineHeight=e.get(68);let t=e.get(69);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(97);let n=e.get(147);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){let t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){let t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new M(e,1));if(t.column!==1)return"";let n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(this._renderLineNumbers===2){let i=Math.abs(this._lastCursorModelPosition.lineNumber-n);return i===0?'<span class="relative-current-line-number">'+n+"</span>":String(i)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===n||n%10===0)return String(n);let i=this._context.viewModel.getLineCount();return n===i?String(n):""}return String(n)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}let t=Ut?this._lineHeight%2===0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(d=>!!d.options.lineNumberClassName);r.sort((d,c)=>w.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=n;d<=i;d++){let c=d-n,u=this._getLineRenderLineNumber(d),p="";for(;s<r.length&&r[s].range.endLineNumber<d;)s++;for(let m=s;m<r.length;m++){let{range:f,options:g}=r[m];f.startLineNumber<=d&&(p+=" "+g.lineNumberClassName)}if(!u&&!p){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeLineNumber&&(p+=" active-line-number"),l[c]=`<div class="${o.CLASS_NAME}${t}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};zi((o,e)=>{let t=o.getColor(bF),n=o.getColor(kF);n?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${n}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});var _k=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new w(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}},Ek=class{constructor(e,t,n,i,r,s,a){this.minimalReveal=e;this.lineNumber=t;this.startColumn=n;this.endColumn=i;this.startScrollTop=r;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=t,this.maxLineNumber=t}type="range";minLineNumber;maxLineNumber},wk=class{constructor(e,t,n,i,r){this.minimalReveal=e;this.selections=t;this.startScrollTop=n;this.stopScrollTop=i;this.scrollType=r;let s=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,d=t.length;l<d;l++){let c=t[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},$x=class o extends Nt{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(e,t){super(e);let n=this._context.configuration,i=this._context.configuration.options,r=i.get(51),s=i.get(148);this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(102),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._viewLineOptions=new fb(n,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Nh({createLine:()=>new gs(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Mn.write(this.domNode,8),this.domNode.setClassName(`view-lines ${pl}`),Jt(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new dn(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new dn(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new _k,this._horizontalRevealRequest=null,this._stickyScrollEnabled=i.get(117).enabled,this._maxNumberStickyLines=i.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(148)&&(this._maxLineWidth=0);let t=this._context.configuration.options,n=t.get(51),i=t.get(148);return this._lineHeight=t.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(102),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(117).enabled,this._maxNumberStickyLines=t.get(117).maxLineCount,Jt(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let e=this._context.configuration,t=new fb(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=!1;for(let r=t;r<=n;r++)i=this._visibleLines.getVisibleLine(r).onSelectionChanged()||i;return i}onDecorationsChanged(e){{let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){let t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new Ek(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new wk(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;let r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(n,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){let t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){let n=this._getViewLineDomNode(e);if(n===null)return null;let i=this._getLineNumberFor(n);if(i===-1||i<1||i>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(i)===1)return new M(i,1);let r=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(i<r||i>s)return null;let a=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(e,t),l=this._context.viewModel.getLineMinColumn(i);return a<l&&(a=l),new M(i,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===gs.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){let r=this._visibleLines.getVisibleLine(i);if(e===r.getDomNode())return i}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();if(e<t||e>n)return-1;let i=new Oh(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;let n=e.endLineNumber,i=w.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let r=[],s=0,a=new Oh(this.domNode.domNode,this._textRangeRestingSpot),l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new M(i.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=i.startLineNumber;u<=i.endLineNumber;u++){if(u<d||u>c)continue;let p=u===i.startLineNumber?i.startColumn:1,m=u!==i.endLineNumber,f=m?this._context.viewModel.getLineMaxColumn(u):i.endColumn,g=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,p,f,a);if(g){if(t&&u<n){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new M(u+1,1)).lineNumber,b!==l&&(g.ranges[g.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[s++]=new vx(g.outsideRenderedLine,u,Mh.from(g.ranges),m)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:r}_visibleRangesForLineRange(e,t,n){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;let i=new Oh(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,n,i);return this._updateLineWidthsSlowIfDomDidLayout(i),r}visibleRangeForPosition(e){let t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new yx(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){let t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber(),i=1,r=!0;for(let s=t;s<=n;s++){let a=this._visibleLines.getVisibleLine(s);if(e&&!a.getWidthIsFast()){r=!1;continue}i=Math.max(i,a.getWidth(null))}return r&&t===1&&n===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1,n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++){let s=this._visibleLines.getVisibleLine(r);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=n;r<=i;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let n=this._horizontalRevealRequest;if(e.startLineNumber<=n.minLineNumber&&n.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let i=this._computeScrollLeftToReveal(n);i&&(this._isViewportWrapping||this._ensureMaxLineWidth(i.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:i.scrollLeft},n.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Ut&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,r,s){let a=e.top,l=e.height,d=a+l,c,u,p;if(r&&r.length>0){let v=r[0].startLineNumber,I=r[0].endLineNumber;for(let C=1,S=r.length;C<S;C++){let _=r[C];v=Math.min(v,_.startLineNumber),I=Math.max(I,_.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(v),p=this._context.viewLayout.getVerticalOffsetForLineNumber(I)+this._lineHeight}else if(i)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),p=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;let m=(t==="mouse"||n)&&this._cursorSurroundingLinesStyle==="default",f=0,g=0;if(m)n||(f=this._lineHeight);else{let v=l/this._lineHeight,I=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),C=Math.min(v/2,I);f=C*this._lineHeight,g=Math.max(0,C-1)*this._lineHeight}n||(s===0||s===4)&&(g+=this._lineHeight),u-=f,p+=g;let b;if(p-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&p<=d)b=a;else{let v=Math.max(5*this._lineHeight,l*.2),I=u-v,C=p-l;b=Math.max(C,I)}else if(s===1||s===2)if(s===2&&a<=u&&p<=d)b=a;else{let v=(u+p)/2;b=Math.max(0,v-l/2)}else b=this._computeMinimumScrolling(a,d,u,p,s===3,s===4);return b}_computeScrollLeftToReveal(e){let t=this._context.viewLayout.getCurrentViewport(),n=this._context.configuration.options.get(147),i=t.left,r=i+t.width-n.verticalScrollbarWidth,s=1073741824,a=0;if(e.type==="range"){let d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(s=Math.max(0,s-o.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,r,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,n,i,r,s){e=e|0,t=t|0,n=n|0,i=i|0,r=!!r,s=!!s;let a=t-e;if(i-n<a){if(r)return n;if(s)return Math.max(0,i-a);if(n<e)return n;if(i>t)return Math.max(0,i-a)}else return n;return e}};var jx=class extends $h{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(e){super(),this._context=e;let n=this._context.configuration.options.get(147);this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._decorationsLeft=n.decorationsLeft,this._decorationsWidth=n.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(n[i++]=new ou(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(n[i++]=new ou(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+s+'px;"></div>',l=[];for(let d=t;d<=n;d++){let c=d-t,u=i[c].getDecorations(),p="";for(let m of u){let f='<div class="cldr '+m.className;m.tooltip!==null&&(f+='" title="'+m.tooltip),f+=a,p+=f}l[c]=p}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var Yh=class o extends Nt{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=Ae(document.createElement("div")),this._domNode.setClassName(o.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Ae(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(o.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._canUseLayerHinting=!t.get(32),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);let n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}};var qx=class extends $h{_context;_renderResult;constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),n=[],i=0;for(let r=0,s=t.length;r<s;r++){let a=t[r],l=a.options.marginClassName,d=a.options.zIndex;l&&(n[i++]=new ou(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return n}prepareRender(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=[];for(let s=t;s<=n;s++){let a=s-t,l=i[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';r[a]=d}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}};var fs=class o{_rgba8Brand=void 0;static Empty=new o(0,0,0,0);r;g;b;a;constructor(e,t,n,i){this.r=o._clamp(e),this.g=o._clamp(t),this.b=o._clamp(n),this.a=o._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};var JB=(()=>{let o=[];for(let e=32;e<=126;e++)o.push(e);return o.push(65533),o})(),eW=(o,e)=>(o-=32,o<0||o>96?e<=2?(o+96)%96:95:o);var Ib=class o{constructor(e,t){this.scale=t;this.charDataNormal=o.soften(e,12/15),this.charDataLight=o.soften(e,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=Od(e[i]*t);return n}renderChar(e,t,n,i,r,s,a,l,d,c,u){let p=1*this.scale,m=2*this.scale,f=u?1:m;if(t+p>e.width||n+f>e.height){console.warn("bad render request outside image data");return}let g=c?this.charDataLight:this.charDataNormal,b=eW(i,d),v=e.width*4,I=a.r,C=a.g,S=a.b,_=r.r-I,R=r.g-C,N=r.b-S,F=Math.max(s,l),P=e.data,H=b*p*m,U=n*v+t*4;for(let z=0;z<f;z++){let oe=U;for(let fe=0;fe<p;fe++){let ee=g[H++]/255*(s/255);P[oe++]=I+_*ee,P[oe++]=C+R*ee,P[oe++]=S+N*ee,P[oe++]=F}U+=v}}blockRenderChar(e,t,n,i,r,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(t+d>e.width||n+u>e.height){console.warn("bad render request outside image data");return}let p=e.width*4,m=.5*(r/255),f=s.r,g=s.g,b=s.b,v=i.r-f,I=i.g-g,C=i.b-b,S=f+v*m,_=g+I*m,R=b+C*m,N=Math.max(r,a),F=e.data,P=n*p+t*4;for(let H=0;H<u;H++){let U=P;for(let z=0;z<d;z++)F[U++]=S,F[U++]=_,F[U++]=R,F[U++]=N;P+=p}}};var Xh=class o extends V{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=wl(new o)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new L;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(ro.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let e=ro.getColorMap();if(!e){this._colors=[fs.Empty],this._backgroundIsLight=!0;return}this._colors=[fs.Empty];for(let n=1;n<e.length;n++){let i=e[n].rgba;this._colors[n]=new fs(i.r,i.g,i.b,Math.round(i.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};var nW={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},iW=o=>{let e=new Uint8ClampedArray(o.length/2);for(let t=0;t<o.length;t+=2)e[t>>1]=nW[o[t]]<<4|nW[o[t+1]]&15;return e},Tk={1:El(()=>iW("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:El(()=>iW("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var Yx=class o{static lastCreated;static lastFontFamily;static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return Tk[e]?n=new Ib(Tk[e](),e):n=o.createFromSampleData(o.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){let t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(let r of JB)n.fillText(String.fromCharCode(r),i,16/2),i+=10;return n.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){let n=16*10*4*96;if(e.length!==n)throw new Error("Unexpected source in MinimapCharRenderer");let i=o._downsample(e,t);return new Ib(i,t)}static _downsampleChar(e,t,n,i,r){let s=1*r,a=2*r,l=i,d=0;for(let c=0;c<a;c++){let u=c/a*16,p=(c+1)/a*16;for(let m=0;m<s;m++){let f=m/s*10,g=(m+1)/s*10,b=0,v=0;for(let C=u;C<p;C++){let S=t+Math.floor(C)*3840,_=1-(C-Math.floor(C));for(let R=f;R<g;R++){let N=1-(R-Math.floor(R)),F=S+Math.floor(R)*4,P=N*_;v+=P,b+=e[F]*e[F+3]/255*P}}let I=b/v;d=Math.max(d,I),n[l++]=Od(I)}}return d}static _downsample(e,t){let n=2*t*1*t,i=n*96,r=new Uint8ClampedArray(i),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(e,a,r,s,t)),s+=n,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<i;c++)r[c]*=d}return r}};var oW=ct?'"Segoe WPC", "Segoe UI", sans-serif':Ve?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var m9=140,g9=2,Xx=class o{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(e,t,n){let i=e.options,r=i.get(145),s=i.get(147),a=s.minimap,l=i.get(51),d=i.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(107),this.paddingTop=i.get(85).top,this.paddingBottom=i.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=oW,this.sectionHeaderFontSize=d.sectionHeaderFontSize*r,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=o._getSectionHeaderColor(t,n.getColor(1)),this.charRenderer=El(()=>Yx.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=n.getColor(2),this.backgroundColor=o._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=o._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){let n=e.getColor(PO);return n?new fs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}static _getMinimapForegroundOpacity(e){let t=e.getColor(NO);return t?fs._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){let n=e.getColor(vI);return n?new fs(n.rgba.r,n.rgba.g,n.rgba.b,Math.round(255*n.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}},Lk=class o{constructor(e,t,n,i,r,s,a,l,d){this.scrollTop=e;this.scrollHeight=t;this.sliderNeeded=n;this._computedSliderRatio=i;this.sliderTop=r;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){let t=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumber,e.endLineNumber);return t>n?null:[t,n]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,n,i,r,s,a,l,d,c,u){let p=e.pixelRatio,m=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/m),g=e.lineHeight;if(e.minimapHeightIsEditorHeight){let R=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(R+=Math.max(0,r-e.lineHeight-e.paddingBottom));let N=Math.max(1,Math.floor(r*r/R)),F=Math.max(0,e.minimapHeight-N),P=F/(c-r),H=d*P,U=F>0,z=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),oe=Math.floor(e.paddingTop/e.lineHeight);return new o(d,c,U,P,H,N,oe,1,Math.min(a,z))}let b;if(s&&n!==a){let R=n-t+1;b=Math.floor(R*m/p)}else{let R=r/g;b=Math.floor(R*m/p)}let v=Math.floor(e.paddingTop/g),I=Math.floor(e.paddingBottom/g);if(e.scrollBeyondLastLine){let R=r/g;I=Math.max(I,R-1)}let C;if(I>0){let R=r/g;C=(v+a+I-R-1)*m/p}else C=Math.max(0,(v+a)*m/p-b);C=Math.min(e.minimapHeight-b,C);let S=C/(c-r),_=d*S;if(f>=v+a+I){let R=C>0;return new o(d,c,R,S,_,b,v,1,a)}else{let R;t>1?R=t+v:R=Math.max(1,d/g);let N,F=Math.max(1,Math.floor(R-_*p/m));F<v?(N=v-F+1,F=1):(N=0,F=Math.max(1,F-v)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(F=Math.min(F,u.startLineNumber),N=Math.max(N,u.topPaddingLineCount)),u.scrollTop<d&&(F=Math.max(F,u.startLineNumber),N=Math.min(N,u.topPaddingLineCount)));let P=Math.min(a,F-N+f-1),H=(d-i)/g,U;return d>=e.paddingTop?U=(t-F+N+H)*m/p:U=d/e.paddingTop*(N+H)*m/p,new o(d,c,!0,S,U,b,N,F,P)}}},Zx=class o{static INVALID=new o(-1);dy;constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},Qx=class{renderedLayout;_imageData;_renderedLines;constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new pb({createLine:()=>Zx.INVALID}),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;let n=this._renderedLines._get().lines;for(let i=0,r=n.length;i<r;i++)if(n[i].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){let e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}},Dk=class o{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(e,t,n,i){this._backgroundFillData=o._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){let i=n.r,r=n.g,s=n.b,a=n.a,l=new Uint8ClampedArray(e*t*4),d=0;for(let c=0;c<t;c++)for(let u=0;u<e;u++)l[d]=i,l[d+1]=r,l[d+2]=s,l[d+3]=a,d+=4;return l}},Jx=class o{constructor(e,t){this.samplingRatio=e;this.minimapLines=t}static compute(e,t,n){if(e.renderMinimap===0||!e.isSampling)return[null,[]];let{minimapLineCount:i}=Cg.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/i,s=r/2;if(!n||n.minimapLines.length===0){let b=[];if(b[0]=1,i>1){for(let v=0,I=i-1;v<I;v++)b[v]=Math.round(v*r+s);b[i-1]=t}return[new o(r,b),[]]}let a=n.minimapLines,l=a.length,d=[],c=0,u=0,p=1,m=10,f=[],g=null;for(let b=0;b<i;b++){let v=Math.max(p,Math.round(b*r)),I=Math.max(v,Math.round((b+1)*r));for(;c<l&&a[c]<v;){if(f.length<m){let S=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:S,deleteToLineNumber:S},f.push(g)),u--}c++}let C;if(c<l&&a[c]<=I)C=a[c],c++;else if(b===0?C=1:b+1===i?C=t:C=Math.round(b*r+s),f.length<m){let S=c+1+u;g&&g.type==="inserted"&&g._i===b-1?g.insertToLineNumber++:(g={type:"inserted",_i:b,insertFromLineNumber:S,insertToLineNumber:S},f.push(g)),u++}d[b]=C,p=C}if(f.length<m)for(;c<l;){let b=c+1+u;g&&g.type==="deleted"&&g._oldIndex===c-1?g.deleteToLineNumber++:(g={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},f.push(g)),u--,c++}else f=[{type:"flush"}];return[new o(r,d),f]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){let r=this.minimapLines[n];if(r<e||r>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){let t=e.toLineNumber-e.fromLineNumber+1,n=this.minimapLines.length,i=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,r),i=Math.max(i,r)):this.minimapLines[r]-=t;return[n,i]}onLinesInserted(e){let t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}},e_=class extends Nt{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new Pi(10,1.5);_actual;constructor(e){super(e),this.tokensColorTracker=Xh.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Xx(this._context.configuration,this._context.theme,this.tokensColorTracker);let[t]=Jx.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new kk(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let e=new Xx(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){let t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){let[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(let n of e.ranges){let i=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);i&&t.push({fromLineNumber:i[0],toLineNumber:i[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));let i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;let e=!!this._samplingState,[t,n]=Jx.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(let i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let r=0,s=t-e+1;r<s;r++)n[r]?i[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):i[r]=null;return i}return this._context.viewModel.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let e of this._selections){let[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new Me(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n=this._getMinimapDecorationsInViewport(e,t).filter(i=>!i.options.minimap?.sectionHeaderStyle);if(this._samplingState){let i=[];for(let r of n){if(!r.options.minimap)continue;let s=r.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);i.push(new kp(new w(a,s.startColumn,l,s.endColumn),r.options))}return i}return n}getSectionHeaderDecorationsInViewport(e,t){let n=this.options.minimapLineHeight,r=this.options.sectionHeaderFontSize/n;return e=Math.floor(Math.max(1,e-r)),this._getMinimapDecorationsInViewport(e,t).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){let i=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];n=new w(i,1,r,this._context.viewModel.getLineMaxColumn(r))}else n=new w(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(n)}getSectionHeaderText(e,t){let n=e.options.minimap?.sectionHeaderText;if(!n)return null;let i=this._sectionHeaderCache.get(n);if(i)return i;let r=t(n);return this._sectionHeaderCache.set(n,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new w(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}},kk=class o extends V{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(e,t){super(),this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(QL),this._domNode=Ae(document.createElement("div")),Mn.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Ae(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Ae(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Ae(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Ae(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Ae(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=Ln(this._domNode.domNode,Ee.POINTER_DOWN,n=>{if(n.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(n.button===0&&this._lastRenderData){let d=Bi(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(n,c,this._lastRenderData.renderedLayout)}return}let r=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*n.offsetY,l=Math.floor(s/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new ba,this._sliderPointerDownListener=Ln(this._slider.domNode,Ee.POINTER_DOWN,n=>{n.preventDefault(),n.stopPropagation(),n.button===0&&this._lastRenderData&&this._startSliderDragging(n,n.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=mn.addTarget(this._domNode.domNode),this._sliderTouchStartListener=Y(this._domNode.domNode,ht.Start,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(n))},{passive:!1}),this._sliderTouchMoveListener=Y(this._domNode.domNode,ht.Change,n=>{n.preventDefault(),n.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(n)},{passive:!1}),this._sliderTouchEndListener=Ln(this._domNode.domNode,ht.End,n=>{n.preventDefault(),n.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,n){if(!e.target||!(e.target instanceof Element))return;let i=e.pageX;this._slider.toggleClassName("active",!0);let r=(s,a)=>{let l=Bi(this._domNode.domNode),d=Math.min(Math.abs(a-i),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(ct&&d>m9){this._model.setScrollTop(n.scrollTop);return}let c=s-t;this._model.setScrollTop(n.getDesiredScrollTopFromDelta(c))};e.pageY!==t&&r(e.pageY,i),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>r(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){let t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new Dk(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(QL),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let n=Lk.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(n.sliderNeeded?"block":"none"),this._slider.setTop(n.sliderTop),this._slider.setHeight(n.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(n.sliderHeight),this.renderDecorations(n),this._lastRenderData=this.renderLines(n)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;let t=this._model.getSelections();t.sort(w.compareRangesUsingStarts);let n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);n.sort((p,m)=>(p.options.zIndex||0)-(m.options.zIndex||0));let{canvasInnerWidth:i,canvasInnerHeight:r}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,i,r);let c=new t_(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(d,t,c,e,s),this._renderDecorationsLineHighlights(d,n,c,e,s);let u=new t_(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(d,t,u,e,s,l,a,i),this._renderDecorationsHighlights(d,n,u,e,s,l,a,i),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,n,i,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of t){let d=i.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let f=c;f<=u;f++)n.set(f,!0);let p=i.getYForLineNumber(c,r),m=i.getYForLineNumber(u,r);a>=p||(a>s&&e.fillRect(Kr,s,e.canvas.width,a-s),s=p),a=m}a>s&&e.fillRect(Kr,s,e.canvas.width,a-s)}_renderDecorationsLineHighlights(e,t,n,i,r){let s=new Map;for(let a=t.length-1;a>=0;a--){let l=t[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=i.intersectWithViewport(l.range);if(!c)continue;let[u,p]=c,m=d.getColor(this._theme.value);if(!m||m.isTransparent())continue;let f=s.get(m.toString());f||(f=m.transparent(.5).toString(),s.set(m.toString(),f)),e.fillStyle=f;for(let g=u;g<=p;g++){if(n.has(g))continue;n.set(g,!0);let b=i.getYForLineNumber(u,r);e.fillRect(Kr,b,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,n,i,r,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of t){let c=i.intersectWithViewport(d);if(!c)continue;let[u,p]=c;for(let m=u;m<=p;m++)this.renderDecorationOnLine(e,n,d,this._selectionColor,i,m,r,r,s,a,l)}}_renderDecorationsHighlights(e,t,n,i,r,s,a,l){for(let d of t){let c=d.options.minimap;if(!c)continue;let u=i.intersectWithViewport(d.range);if(!u)continue;let[p,m]=u,f=c.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let g=p;g<=m;g++)switch(c.position){case 1:this.renderDecorationOnLine(e,n,d.range,f,i,g,r,r,s,a,l);continue;case 2:{let b=i.getYForLineNumber(g,r);this.renderDecoration(e,f,2,b,g9,r);continue}}}}renderDecorationOnLine(e,t,n,i,r,s,a,l,d,c,u){let p=r.getYForLineNumber(s,l);if(p+a<0||p>this._model.options.canvasInnerHeight)return;let{startLineNumber:m,endLineNumber:f}=n,g=m===s?n.startColumn:1,b=f===s?n.endColumn:this._model.getLineMaxColumn(s),v=this.getXOffsetForPosition(t,s,g,d,c,u),I=this.getXOffsetForPosition(t,s,b,d,c,u);this.renderDecoration(e,i,v,p,I-v,a)}getXOffsetForPosition(e,t,n,i,r,s){if(n===1)return Kr;if((n-1)*r>=s)return s;let l=e.get(t);if(!l){let d=this._model.getLineContent(t);l=[Kr];let c=Kr;for(let u=1;u<d.length+1;u++){let p=d.charCodeAt(u-1),m=p===9?i*r:Yo(p)?2*r:r,f=c+m;if(f>=s){l[u]=s;break}l[u]=f,c=f}e.set(t,l)}return n-1<l.length?l[n-1]:s}renderDecoration(e,t,n,i,r,s){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,r,s)}_renderSectionHeaders(e){let t=this._model.options.minimapLineHeight,n=this._model.options.sectionHeaderFontSize,i=this._model.options.sectionHeaderLetterSpacing,r=n*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,p=this._decorationsCanvas.domNode.getContext("2d");p.letterSpacing=i+"px",p.font="500 "+n+"px "+this._model.options.sectionHeaderFontFamily,p.strokeStyle=u,p.lineWidth=.2;let m=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);m.sort((g,b)=>g.range.startLineNumber-b.range.startLineNumber);let f=o._fitSectionHeader.bind(null,p,s-Kr);for(let g of m){let b=e.getYForLineNumber(g.range.startLineNumber,t)+n,v=b-n,I=v+2,C=this._model.getSectionHeaderText(g,f);o._renderSectionLabel(p,C,g.options.minimap?.sectionHeaderStyle===2,l,c,s,v,r,b,I)}}static _fitSectionHeader(e,t,n){if(!n)return n;let i="\u2026",r=e.measureText(n).width,s=e.measureText(i).width;if(r<=t||r<=s)return n;let a=n.length,l=r/n.length,d=Math.floor((t-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(n[c-1]);)--c;return n.substring(0,c)+i+n.substring(a-(d-c))}static _renderSectionLabel(e,t,n,i,r,s,a,l,d,c){t&&(e.fillStyle=i,e.fillRect(0,a,s,l),e.fillStyle=r,e.fillText(t,Kr,d)),n&&(e.beginPath(),e.moveTo(0,c),e.lineTo(s,c),e.closePath(),e.stroke())}renderLines(e){let t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){let ee=this._lastRenderData._get();return new Qx(e,ee.imageData,ee.lines)}let r=this._getBuffer();if(!r)return null;let[s,a,l]=o._renderUntouchedLines(r,e.topPaddingLineCount,t,n,i,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(t,n,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,p=this._model.options.backgroundColor,m=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,g=f.backgroundIsLight(),b=this._model.options.renderMinimap,v=this._model.options.charRenderer(),I=this._model.options.fontScale,C=this._model.options.minimapCharWidth,_=(b===1?2:3)*I,R=i>_?Math.floor((i-_)/2):0,N=p.a/255,F=new fs(Math.round((p.r-u.r)*N+u.r),Math.round((p.g-u.g)*N+u.g),Math.round((p.b-u.b)*N+u.b),255),P=e.topPaddingLineCount*i,H=[];for(let ee=0,X=n-t+1;ee<X;ee++)l[ee]&&o._renderLine(r,F,p.a,g,b,C,f,m,v,P,R,c,d[ee],I,i),H[ee]=new Zx(P),P+=i;let U=s===-1?0:s,oe=(a===-1?r.height:a)-U;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,U,r.width,oe),new Qx(e,r,H)}static _renderUntouchedLines(e,t,n,i,r,s){let a=[];if(!s){for(let P=0,H=i-n+1;P<H;P++)a[P]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,p=u.length,m=e.width,f=e.data,g=(i-n+1)*r*m*4,b=-1,v=-1,I=-1,C=-1,S=-1,_=-1,R=t*r;for(let P=n;P<=i;P++){let H=P-n,U=P-c,z=U>=0&&U<p?u[U].dy:-1;if(z===-1){a[H]=!0,R+=r;continue}let oe=z*m*4,fe=(z+r)*m*4,ee=R*m*4,X=(R+r)*m*4;C===oe&&_===ee?(C=fe,_=X):(I!==-1&&(f.set(d.subarray(I,C),S),b===-1&&I===0&&I===S&&(b=C),v===-1&&C===g&&I===S&&(v=I)),I=oe,C=fe,S=ee,_=X),a[H]=!1,R+=r}I!==-1&&(f.set(d.subarray(I,C),S),b===-1&&I===0&&I===S&&(b=C),v===-1&&C===g&&I===S&&(v=I));let N=b===-1?-1:b/(m*4),F=v===-1?-1:v/(m*4);return[N,F,a]}static _renderLine(e,t,n,i,r,s,a,l,d,c,u,p,m,f,g){let b=m.content,v=m.tokens,I=e.width-s,C=g===1,S=Kr,_=0,R=0;for(let N=0,F=v.getCount();N<F;N++){let P=v.getEndOffset(N),H=v.getForeground(N),U=a.getColor(H);for(;_<P;_++){if(S>I)return;let z=b.charCodeAt(_);if(z===9){let oe=p-(_+R)%p;R+=oe-1,S+=oe*s}else if(z===32)S+=s;else{let oe=Yo(z)?2:1;for(let fe=0;fe<oe;fe++)if(r===2?d.blockRenderChar(e,S,c+u,U,l,t,n,C):d.renderChar(e,S,c+u,z,U,l,t,n,f,i,C),S+=s,S>I)return}}}}},t_=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(e,t,n){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=n,this._values=[];for(let i=0,r=this._endLineNumber-this._startLineNumber+1;i<r;i++)this._values[i]=n}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}};var n_=class extends Nt{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(e,t){super(e),this._viewDomNode=t;let i=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Ae(document.createElement("div")),Mn.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Ae(document.createElement("div")),Mn.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){let n=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,!0}addWidget(e){let t=Ae(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){let n=this._widgets[e.getId()],i=t?t.preference:null,r=t?.stackOridinal;return n.preference===i&&n.stack===r?(this._updateMaxMinWidth(),!1):(n.preference=i,n.stack=r,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){let t=e.getId();if(this._widgets.hasOwnProperty(t)){let i=this._widgets[t].domNode.domNode;delete this._widgets[t],i.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0,t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){let r=t[n],a=this._widgets[r].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){let n=e.domNode;if(e.preference===null){n.setTop("");return}let i=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){let r=n.domNode.clientHeight;n.setTop(this._editorHeight-r-2*this._horizontalScrollbarHeight)}else n.setTop(0);e.stack!==void 0?(n.setTop(t[e.preference]),t[e.preference]+=n.domNode.clientWidth):n.setRight(i)}else if(e.preference===2)n.domNode.style.right="50%",e.stack!==void 0?(n.setTop(t[2]),t[2]+=n.domNode.clientHeight):n.setTop(0);else{let{top:r,left:s}=e.preference;if(this._context.configuration.options.get(43)&&e.widget.allowEditorOverflow){let l=this._viewDomNodeRect;n.setTop(r+l.top),n.setLeft(s+l.left),n.setPosition("fixed")}else n.setTop(r),n.setLeft(s),n.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=Bi(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);let t=Object.keys(this._widgets),n=Array.from({length:3},()=>0);t.sort((i,r)=>(this._widgets[i].stack||0)-(this._widgets[r].stack||0));for(let i=0,r=t.length;i<r;i++){let s=t[i];this._renderWidget(this._widgets[s],n)}}};var Rk=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(e,t){let n=e.options;this.lineHeight=n.get(68),this.pixelRatio=n.get(145),this.overviewRulerLanes=n.get(84),this.renderBorder=n.get(83);let i=t.getColor(RF);this.borderColor=i?i.toString():null,this.hideCursor=n.get(60);let r=t.getColor(zp);this.cursorColorSingle=r?r.transparent(.7).toString():null;let s=t.getColor(CC);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=t.getColor(SC);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;let l=n.get(74),d=l.enabled,c=l.side,u=t.getColor(MF),p=ro.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=p:this.backgroundColor=null;let f=n.get(147).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[g,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=g,this.w=b}_initLanes(e,t,n){let i=t-e;if(n>=3){let r=Math.floor(i/3),s=Math.floor(i/3),a=i-r-s,l=e,d=l+r,c=l+r+a;return[[0,l,d,l,c,l,d,l],[0,r,a,r+a,s,r+a+s,a+s,r+a+s]]}else if(n===2){let r=Math.floor(i/2),s=i-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,s,r+s,r+s,r+s]]}else{let r=e,s=i;return[[0,r,r,r,r,r,r,r],[0,s,s,s,s,s,s,s]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&G.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}};var i_=class extends Nt{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(e){super(e),this._domNode=Ae(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=ro.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new M(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){let t=new Rk(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++){let i=this._settings.cursorColorSingle;n>1&&(i=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:i})}return this._cursorPositions.sort((t,n)=>M.compare(t.position,n.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){let e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?G.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}let t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Ec.compareByRenderingProps),this._actualShouldRender===1&&!Ec.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!tn(this._renderedCursorPositions,this._cursorPositions,(f,g)=>f.position.lineNumber===g.position.lineNumber&&f.color===g.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let n=this._settings.canvasWidth,i=this._settings.canvasHeight,r=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=i/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=G.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):(u.clearRect(0,0,n,i),u.fillStyle=G.Format.CSS.formatHexA(e),u.fillRect(0,0,n,i)):u.clearRect(0,0,n,i);let p=this._settings.x,m=this._settings.w;for(let f of t){let g=f.color,b=f.data;u.fillStyle=g;let v=0,I=0,C=0;for(let S=0,_=b.length/3;S<_;S++){let R=b[3*S],N=b[3*S+1],F=b[3*S+2],P=s.getVerticalOffsetForLineNumber(N)*l|0,H=(s.getVerticalOffsetForLineNumber(F)+r)*l|0;if(H-P<d){let z=(P+H)/2|0;z<c?z=c:z+c>i&&(z=i-c),P=z-c,H=z+c}P>C+1||R!==v?(S!==0&&u.fillRect(p[v],I,m[v],C-I),v=R,I=P,C=H):H>C&&(C=H)}u.fillRect(p[v],I,m[v],C-I)}if(!this._settings.hideCursor){let f=2*this._settings.pixelRatio|0,g=f/2|0,b=this._settings.x[7],v=this._settings.w[7],I=-100,C=-100,S=null;for(let _=0,R=this._cursorPositions.length;_<R;_++){let N=this._cursorPositions[_].color;if(!N)continue;let F=this._cursorPositions[_].position,P=s.getVerticalOffsetForLineNumber(F.lineNumber)*l|0;P<g?P=g:P+g>i&&(P=i-g);let H=P-g,U=H+f;H>C+1||N!==S?(_!==0&&S&&u.fillRect(b,I,v,C-I),I=H,C=U):U>C&&(C=U),S=N,u.fillStyle=N}S&&u.fillRect(b,I,v,C-I)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,i),u.moveTo(1,0),u.lineTo(n,0),u.stroke())}};var o_=class extends Cr{_context;_domNode;_zoneManager;constructor(e,t){super(),this._context=e;let n=this._context.configuration.options;this._domNode=Ae(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new VI(i=>this._context.viewLayout.getVerticalOffsetForLineNumber(i)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(68)),this._zoneManager.setPixelRatio(n.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return e.hasChanged(68)&&(this._zoneManager.setLineHeight(t.get(68)),this._render()),e.hasChanged(145)&&(this._zoneManager.setPixelRatio(t.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(r,n,i,e),!0}_renderOneLane(e,t,n,i){let r=0,s=0,a=0;for(let l of t){let d=l.colorId,c=l.from,u=l.to;d!==r?(e.fillRect(0,s,i,a-s),r=d,e.fillStyle=n[r],s=c,a=u):a>=c?a=Math.max(a,u):(e.fillRect(0,s,i,a-s),s=c,a=u)}e.fillRect(0,s,i,a-s)}};var r_=class extends Nt{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(e){super(e),this.domNode=Ae(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let t=this._context.configuration.options;this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._rulers=t.get(104),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){let e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){let{tabSize:i}=this._context.viewModel.model.getOptions(),r=i,s=t-e;for(;s>0;){let a=Ae(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let n=e-t;for(;n>0;){let i=this._renderedRulers.pop();this.domNode.removeChild(i),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){let i=this._renderedRulers[t],r=this._rulers[t];i.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}};var s_=class extends Nt{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let n=this._context.configuration.options.get(105);this._useShadows=n.useShadows,this._domNode=Ae(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let t=this._context.configuration.options.get(147);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){let n=this._context.configuration.options.get(105);return this._useShadows=n.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var Mk=class{left;width;startStyle;endStyle;constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}},Pk=class{lineNumber;ranges;constructor(e,t){this.lineNumber=e,this.ranges=t}};function f9(o){return new Mk(o)}function b9(o){return new Pk(o.lineNumber,o.ranges.map(f9))}var l_=class o extends Gi{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(e){super(),this._context=e;let t=this._context.configuration.options;this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=this._context.configuration.options;return this._roundedSelection=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,n){let i=this._typicalHalfwidthCharacterWidth/4,r=null,s=null;if(n&&n.length>0&&t.length>0){let a=t[0].lineNumber;if(a===e.startLineNumber)for(let d=0;!r&&d<n.length;d++)n[d].lineNumber===a&&(r=n[d].ranges[0]);let l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let d=n.length-1;!s&&d>=0;d--)n[d].lineNumber===l&&(s=n[d].ranges[0]);r&&!r.startStyle&&(r=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=t.length;a<l;a++){let d=t[a].ranges[0],c=d.left,u=d.left+d.width,p={top:0,bottom:0},m={top:0,bottom:0};if(a>0){let f=t[a-1].ranges[0].left,g=t[a-1].ranges[0].left+t[a-1].ranges[0].width;a_(c-f)<i?p.top=2:c>f&&(p.top=1),a_(u-g)<i?m.top=2:f<u&&u<g&&(m.top=1)}else r&&(p.top=r.startStyle.top,m.top=r.endStyle.top);if(a+1<l){let f=t[a+1].ranges[0].left,g=t[a+1].ranges[0].left+t[a+1].ranges[0].width;a_(c-f)<i?p.bottom=2:f<c&&c<g&&(p.bottom=1),a_(u-g)<i?m.bottom=2:u<g&&(m.bottom=1)}else s&&(p.bottom=s.startStyle.bottom,m.bottom=s.endStyle.bottom);d.startStyle=p,d.endStyle=m}}_getVisibleRangesWithStyle(e,t,n){let r=(t.linesVisibleRangesForRange(e,!0)||[]).map(b9);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,n),r}_createSelectionPiece(e,t,n,i,r){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+i.toString()+"px;width:"+r.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(i.length===0)return;let r=!!i[0].ranges[0].startStyle,s=i[0].lineNumber,a=i[i.length-1].lineNumber;for(let l=0,d=i.length;l<d;l++){let c=i[l],u=c.lineNumber,p=u-t,m=n&&u===s?1:0,f=n&&u!==s&&u===a?1:0,g="",b="";for(let v=0,I=c.ranges.length;v<I;v++){let C=c.ranges[v];if(r){let _=C.startStyle,R=C.endStyle;if(_.top===1||_.bottom===1){g+=this._createSelectionPiece(m,f,o.SELECTION_CLASS_NAME,C.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH);let N=o.EDITOR_BACKGROUND_CLASS_NAME;_.top===1&&(N+=" "+o.SELECTION_TOP_RIGHT),_.bottom===1&&(N+=" "+o.SELECTION_BOTTOM_RIGHT),g+=this._createSelectionPiece(m,f,N,C.left-o.ROUNDED_PIECE_WIDTH,o.ROUNDED_PIECE_WIDTH)}if(R.top===1||R.bottom===1){g+=this._createSelectionPiece(m,f,o.SELECTION_CLASS_NAME,C.left+C.width,o.ROUNDED_PIECE_WIDTH);let N=o.EDITOR_BACKGROUND_CLASS_NAME;R.top===1&&(N+=" "+o.SELECTION_TOP_LEFT),R.bottom===1&&(N+=" "+o.SELECTION_BOTTOM_LEFT),g+=this._createSelectionPiece(m,f,N,C.left+C.width,o.ROUNDED_PIECE_WIDTH)}}let S=o.SELECTION_CLASS_NAME;if(r){let _=C.startStyle,R=C.endStyle;_.top===0&&(S+=" "+o.SELECTION_TOP_LEFT),_.bottom===0&&(S+=" "+o.SELECTION_BOTTOM_LEFT),R.top===0&&(S+=" "+o.SELECTION_TOP_RIGHT),R.bottom===0&&(S+=" "+o.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(m,f,S,C.left,C.width)}e[p][0]+=g,e[p][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(e){let t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let s=n;s<=i;s++){let a=s-n;t[a]=["",""]}let r=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){r[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[s]);r[s]=d,this._actualRenderOneSelection(t,n,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([s,a])=>s+a)}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}};zi((o,e)=>{let t=o.getColor(SO);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function a_(o){return o<0?-o:o}var d_=class o extends Nt{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(e){super(e);let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new bb(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=Ae(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Zi,this._cursorFlatBlinkInterval=new Ou,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){let t=this._context.configuration.options;this._readOnly=t.get(93),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,n){let i=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&n!==3;if(this._primaryCursor.setPlurality(t.length?1:0),this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let r=t.length-this._secondaryCursors.length;for(let s=0;s<r;s++){let a=new bb(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){let r=this._secondaryCursors.length-t.length;for(let s=0;s<r;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],i)}onCursorStateChanged(e){let t=[];for(let i=0,r=e.selections.length;i<r;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);let n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=n=>{for(let i=0,r=e.ranges.length;i<r;i++)if(e.ranges[i].fromLineNumber<=n.lineNumber&&n.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(let n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let e=this._getCursorBlinking(),t=e===0,n=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!n&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},o.BLINK_INTERVAL,ge(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},o.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case 1:e+=" cursor-line-style";break;case 2:e+=" cursor-block-style";break;case 3:e+=" cursor-underline-style";break;case 4:e+=" cursor-line-thin-style";break;case 5:e+=" cursor-block-outline-style";break;case 6:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0,i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let r=0,s=this._secondaryCursors.length;r<s;r++){let a=this._secondaryCursors[r].render(e);a&&(t[n++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};zi((o,e)=>{let t=[{class:".cursor",foreground:zp,background:IC},{class:".cursor-primary",foreground:CC,background:gF},{class:".cursor-secondary",foreground:SC,background:fF}];for(let n of t){let i=o.getColor(n.foreground);if(i){let r=o.getColor(n.background);r||(r=i.opposite()),e.addRule(`.monaco-editor .cursors-layer ${n.class} { background-color: ${i}; border-color: ${i}; color: ${r}; }`),Js(o.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${n.class} { border-left: 1px solid ${r}; border-right: 1px solid ${r}; }`)}}});var Nk=()=>{throw new Error("Invalid change accessor")},c_=class extends Nt{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(e){super(e);let t=this._context.configuration.options,n=t.get(147);this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=Ae(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Ae(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=this._context.viewLayout.getWhitespaces(),t=new Map;for(let i of e)t.set(i.id,i);let n=!1;return this._context.viewModel.changeWhitespace(i=>{let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=t.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(i.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),n=!0)}}),n}onConfigurationChanged(e){let t=this._context.configuration.options,n=t.get(147);return this._lineHeight=t.get(68),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new M(s,this._context.viewModel.model.getLineMaxColumn(s))}let n;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):n=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});let i=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(n);return{isInHiddenArea:!r,afterViewLineNumber:i.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(n=>{let i={addZone:r=>(t=!0,this._addZone(n,r)),removeZone:r=>{r&&(t=this._removeZone(n,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(n,r)||t)}};v9(e,i),i.addZone=Nk,i.removeZone=Nk,i.layoutZone=Nk}),t}_addZone(e,t){let n=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isInHiddenArea:n.isInHiddenArea,isVisible:!1,domNode:Ae(t.domNode),marginDomNode:t.marginDomNode?Ae(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,n.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.remove(),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){let n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return n.isInHiddenArea=i.isInHiddenArea,e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(n){We(n)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(n){We(n)}}prepareRender(e){}render(e){let t=e.viewportData.whitespaceViewportData,n={},i=!1;for(let s of t)this._zones[s.id].isInHiddenArea||(n[s.id]=s,i=!0);let r=Object.keys(this._zones);for(let s=0,a=r.length;s<a;s++){let l=r[s],d=this._zones[l],c=0,u=0,p="none";n.hasOwnProperty(l)?(c=n[l].verticalOffset-e.bigNumbersDelta,u=n[l].height,p="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(n[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(p),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(p))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function v9(o,e){try{return o(e)}catch(t){We(t)}}var u_=class extends Gi{_context;_options;_selection;_renderResult;constructor(e){super(),this._context=e,this._options=new p_(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){let t=new p_(this._context.configuration);return this._options.equals(t)?e.hasChanged(147):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber-t+1,r=new Array(i);for(let a=0;a<i;a++)r[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){let l=a-e.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let p of u){if(p.endLineNumber<a||p.startLineNumber>a)continue;let m=p.startLineNumber===a?p.startColumn:d.minColumn,f=p.endLineNumber===a?p.endColumn:d.maxColumn;m<f&&(c||(c=[]),c.push(new Ah(m-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,c,d)}}_applyRenderWhitespace(e,t,n,i){if(this._options.renderWhitespace==="selection"&&!n||this._options.renderWhitespace==="trailing"&&i.continuesWithWrappedLine)return"";let r=this._context.theme.getColor(xC),s=this._options.renderWithSVG,a=i.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=i.continuesWithWrappedLine,c=i.minColumn-1,u=this._options.renderWhitespace==="boundary",p=this._options.renderWhitespace==="trailing",m=this._options.lineHeight,f=this._options.middotWidth,g=this._options.wsmiddotWidth,b=this._options.spaceWidth,v=Math.abs(g-b),I=Math.abs(f-b),C=v<I?11825:183,S=this._options.canUseHalfwidthRightwardsArrow,_="",R=!1,N=zt(a),F;N===-1?(R=!0,N=l,F=l):F=qo(a);let P=0,H=n&&n[P],U=0;for(let z=c;z<l;z++){let oe=a.charCodeAt(z);if(H&&z>=H.endOffset&&(P++,H=n&&n[P]),oe!==9&&oe!==32||p&&!R&&z<=F)continue;if(u&&z>=N&&z<=F&&oe===32){let ee=z-1>=0?a.charCodeAt(z-1):0,X=z+1<l?a.charCodeAt(z+1):0;if(ee!==32&&X!==32)continue}if(u&&d&&z===l-1){let ee=z-1>=0?a.charCodeAt(z-1):0;if(oe===32&&ee!==32&&ee!==9)continue}if(n&&(!H||H.startOffset>z||H.endOffset<=z))continue;let fe=e.visibleRangeForPosition(new M(t,z+1));fe&&(s?(U=Math.max(U,fe.left),oe===9?_+=this._renderArrow(m,b,fe.left):_+=`<circle cx="${(fe.left+b/2).toFixed(2)}" cy="${(m/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):oe===9?_+=`<div class="mwh" style="left:${fe.left}px;height:${m}px;">${S?"\uFFEB":"\u2192"}</div>`:_+=`<div class="mwh" style="left:${fe.left}px;height:${m}px;">${String.fromCharCode(C)}</div>`)}return s?(U=Math.round(U+b),`<svg style="bottom:0;position:absolute;width:${U}px;height:${m}px" viewBox="0 0 ${U} ${m}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+_+"</svg>"):_}_renderArrow(e,t,n){let i=t/7,r=t,s=e/2,a=n,l={x:0,y:i/2},d={x:100/125*r,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},p={x:u.x+.35*d.x,y:u.y-.35*d.x},m={x:p.x,y:-p.y},f={x:u.x,y:-u.y},g={x:c.x,y:-c.y},b={x:d.x,y:-d.y},v={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,p,m,f,g,b,v].map(S=>`${(a+S.x).toFixed(2)} ${(s+S.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";let n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}},p_=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(e){let t=e.options,n=t.get(51),i=t.get(39);i==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):i==="svg"?(this.renderWhitespace=t.get(101),this.renderWithSVG=!0):(this.renderWhitespace=t.get(101),this.renderWithSVG=!1),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(68),this.stopRenderingLineAfter=t.get(119)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}};var Zh=class extends Nt{};var Ok=class{_onDidChange=new L;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},Ak=new Ok;var Bk=class{constructor(e,t,n,i,r){this._context=e;this.modelLineNumber=t;this.distanceToModelLineStart=n;this.widthOfHiddenLineTextBefore=i;this.distanceToModelLineEnd=r}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(e){let t=new M(this.modelLineNumber,this.distanceToModelLineStart+1),n=new M(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},Fk=In,Qh=class extends Zh{constructor(t,n,i,r,s){super(t);this._keybindingService=r;this._instantiationService=s;this._viewController=n,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new Me(1,1,1,1)],this._modelSelections=[new Me(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Ae(document.createElement("textarea")),Mn.write(this.textArea,7),this.textArea.setClassName(`inputarea ${pl}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",vb(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",h("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Ae(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:m=>this._context.viewModel.getLineMaxColumn(m),getValueInRange:(m,f)=>this._context.viewModel.getValueInRange(m,f),getValueLengthInRange:(m,f)=>this._context.viewModel.getValueLengthInRange(m,f),modifyPosition:(m,f)=>this._context.viewModel.modifyPosition(m,f)},u={getDataToCopy:()=>Dx(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let f=this._selections[0];if(Ve&&f.isEmpty()){let b=f.getStartPosition(),v=this._getWordBeforePosition(b);if(v.length===0&&(v=this._getCharacterBeforePosition(b)),v.length>0)return new Nn(v,v.length,v.length,w.fromPositions(b),0)}if(Ve&&!f.isEmpty()&&c.getValueLengthInRange(f,0)<500){let b=c.getValueInRange(f,0);return new Nn(b,0,b.length,f,0)}if(Xo&&!f.isEmpty()){let b="vscode-placeholder";return new Nn(b,0,b.length,null,void 0)}return Nn.EMPTY}if(JE){let f=this._selections[0];if(f.isEmpty()){let g=f.getStartPosition(),[b,v]=this._getAndroidWordAtPosition(g);if(b.length>0)return new Nn(b,v,v,w.fromPositions(g),0)}return Nn.EMPTY}let m=Kh.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return Nn.fromScreenReaderContentState(m)},deduceModelPosition:(m,f,g)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(m,f,g)},p=this._register(new kx(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(Gh,u,p,fo,{isAndroid:JE,isChrome:kl,isFirefox:In,isSafari:Xo})),this._register(this._textAreaInput.onKeyDown(m=>{this._viewController.emitKeyDown(m)})),this._register(this._textAreaInput.onKeyUp(m=>{this._viewController.emitKeyUp(m)})),this._register(this._textAreaInput.onPaste(m=>{let f=!1,g=null,b=null;m.metadata&&(f=this._emptySelectionClipboard&&!!m.metadata.isFromEmptySelection,g=typeof m.metadata.multicursorText<"u"?m.metadata.multicursorText:null,b=m.metadata.mode),this._viewController.paste(m.text,f,g,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(m=>{m.replacePrevCharCnt||m.replaceNextCharCnt||m.positionDelta?(mo&&console.log(` => compositionType: <<${m.text}>>, ${m.replacePrevCharCnt}, ${m.replaceNextCharCnt}, ${m.positionDelta}`),this._viewController.compositionType(m.text,m.replacePrevCharCnt,m.replaceNextCharCnt,m.positionDelta)):(mo&&console.log(` => type: <<${m.text}>>`),this._viewController.type(m.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(m=>{this._viewController.setSelection(m)})),this._register(this._textAreaInput.onCompositionStart(m=>{let f=this.textArea.domNode,g=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:v}=(()=>{let C=f.value.substring(0,Math.min(f.selectionStart,f.selectionEnd)),S=C.lastIndexOf(`
`),_=C.substring(S+1),R=_.lastIndexOf("	"),N=_.length-R-1,F=g.getStartPosition(),P=Math.min(F.column-1,N),H=F.column-1-P,U=_.substring(0,_.length-P),{tabSize:z}=this._context.viewModel.model.getOptions(),oe=y9(this.textArea.domNode.ownerDocument,U,this._fontInfo,z);return{distanceToModelLineStart:H,widthOfHiddenTextBefore:oe}})(),{distanceToModelLineEnd:I}=(()=>{let C=f.value.substring(Math.max(f.selectionStart,f.selectionEnd)),S=C.indexOf(`
`),_=S===-1?C:C.substring(0,S),R=_.indexOf("	"),N=R===-1?_.length:_.length-R-1,F=g.getEndPosition(),P=Math.min(this._context.viewModel.model.getLineMaxColumn(F.lineNumber)-F.column,N);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(F.lineNumber)-F.column-P}})();this._context.viewModel.revealRange("keyboard",!0,w.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new Bk(this._context,g.startLineNumber,b,v,I),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${pl} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(m=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${pl}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(Ak.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(t){t.appendChild(this.textArea),t.appendChild(this.textAreaCover)}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(t){let n='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(t.lineNumber),r=zs(n,[]),s=!0,a=t.column,l=!0,d=t.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=i.charCodeAt(a-2);r.get(u)!==0?s=!1:a--}if(l&&d>i.length&&(l=!1),l){let u=i.charCodeAt(d-1);r.get(u)!==0?l=!1:d++}c++}return[i.substring(a-1,d-1),t.column-a]}_getWordBeforePosition(t){let n=this._context.viewModel.getLineContent(t.lineNumber),i=zs(this._context.configuration.options.get(133),[]),r=t.column,s=0;for(;r>1;){let a=n.charCodeAt(r-2);if(i.get(a)!==0||s>50)return n.substring(r-1,t.column-1);s++,r--}return n.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){let i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!At(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);let n=t.get(3);this._accessibilitySupport===2&&n===Hs.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=n;let r=t.get(147).wrappingColumn;if(r!==-1&&this._accessibilitySupport!==1){let s=t.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(r*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=Fk?0:1}onConfigurationChanged(t){let n=this._context.configuration.options,i=n.get(147);this._setAccessibilityOptions(n),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=n.get(51),this._lineHeight=n.get(68),this._emptySelectionClipboard=n.get(38),this._copyWithSyntaxHighlighting=n.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:r}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${r*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",vb(n,this._keybindingService)),this.textArea.setAttribute("aria-required",n.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(n.get(126))),(t.hasChanged(34)||t.hasChanged(93))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){let t=this._context.configuration.options;!Ak.enabled||t.get(34)&&t.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new M(1,1);_primaryCursorVisibleRange=null;prepareRender(t){this._primaryCursorPosition=new M(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let i=this._visibleTextArea.visibleTextareaStart,r=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&i&&r&&r.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=yb(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+i.left-this._scrollLeft,p=r.left-i.left+1;if(u<this._contentLeft){let I=this._contentLeft-u;u+=I,c+=I,p-=I}p>this._contentWidth&&(p=this._contentWidth);let m=this._context.viewModel.getViewLineData(s.lineNumber),f=m.tokens.findTokenIndexAtOffset(s.column-1),g=m.tokens.findTokenIndexAtOffset(a.column-1),b=f===g,v=this._visibleTextArea.definePresentation(b?m.tokens.getPresentation(f):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:p,height:this._lineHeight,useCover:!1,color:(ro.getColorMap()||[])[v.foreground],italic:v.italic,bold:v.bold,underline:v.underline,strikethrough:v.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(n<0||n>this._contentHeight){this._renderAtTopLeft();return}if(Ve||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??yb(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:n,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:Fk?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:Fk?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;let n=this.textArea,i=this.textAreaCover;Jt(n,this._fontInfo),n.setTop(t.top),n.setLeft(t.left),n.setWidth(t.width),n.setHeight(t.height),n.setColor(t.color?G.Format.CSS.formatHex(t.color):""),n.setFontStyle(t.italic?"italic":""),t.bold&&n.setFontWeight("bold"),n.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);let r=this._context.configuration.options;r.get(58)?i.setClassName("monaco-editor-background textAreaCover "+Yh.OUTER_CLASS_NAME):r.get(69).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+qh.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};Qh=K([D(3,Oo),D(4,dt)],Qh);function y9(o,e,t,n){if(e.length===0)return 0;let i=o.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";let r=o.createElement("span");Jt(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${n*t.spaceWidth}px`,r.append(e),i.appendChild(r),o.body.appendChild(i);let s=r.offsetWidth;return i.remove(),s}var h_=class extends V{constructor(t,n){super();this._domNode=t;this._onFocusChange=n;this._register(Y(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(Y(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(t){this._isFocused!==t&&(this._isFocused=t,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function Jh(o,e,t,n){return o.addEventListener(e,t,n),{dispose(){o.removeEventListener(e,t)}}}var em=class{constructor(e,t,n){this._domNode=e;this._context=t;this._keybindingService=n;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new Me(1,1,1,1);_screenReaderContentState;onConfigurationChanged(e){this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let e=this._context.configuration.options,t=e.get(147);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._fontInfo=e.get(51),this._lineHeight=e.get(68),this._accessibilitySupport=e.get(2),this._accessibilityPageSize=e.get(3)}_updateDomAttributes(){let e=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",vb(e,this._keybindingService));let t=this._context.viewModel.model.getOptions().tabSize,n=e.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${t*n}px`}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new Me(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent()}render(e){if(!this._screenReaderContentState)return;Jt(this._domNode,this._fontInfo);let t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),n=this._context.viewLayout.getCurrentScrollTop(),i=t-n;this._domNode.setTop(i),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let r=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=yb(r);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let e=this._accessibilitySupport===1?1:this._accessibilityPageSize,t={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:n=>this._context.viewModel.getLineMaxColumn(n),getValueInRange:(n,i)=>this._context.viewModel.getValueInRange(n,i),getValueLengthInRange:(n,i)=>this._context.viewModel.getValueLengthInRange(n,i),modifyPosition:(n,i)=>this._context.viewModel.modifyPosition(n,i)};return Kh.fromEditorSelection(t,this._primarySelection,e,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(e,t){let i=Kv().document.getSelection();if(!i)return;let r=this._domNode.domNode.firstChild;if(!r)return;let s=Kv().document.activeElement,a=new globalThis.Range;a.setStart(r,e),a.setEnd(r,t),i.removeAllRanges(),i.addRange(a),Xn(s)&&s.focus()}};em=K([D(2,Oo)],em);var tm=class extends Zh{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new Me(1,1,1,1);_textStartPositionWithinEditor=new M(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(e,t,n,i){super(e),this.domNode=new Yd(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new h_(this.domNode.domNode,r=>this._context.viewModel.setHasFocus(r))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=n.createInstance(em,this.domNode,e),this._register(Y(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(i))),this._register(Y(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(i),t.cut()})),this._register(Y(this.domNode.domNode,"keyup",r=>t.emitKeyUp(new pt(r)))),this._register(Y(this.domNode.domNode,"keydown",async r=>{let s=new pt(r);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(t,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),t.emitKeyDown(s)})),this._register(Jh(this._editContext,"textformatupdate",r=>this._handleTextFormatUpdate(r))),this._register(Jh(this._editContext,"characterboundsupdate",r=>this._updateCharacterBounds())),this._register(Jh(this._editContext,"textupdate",r=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=w.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(t,r),this._screenReaderSupport.writeScreenReaderContent()})),this._register(Jh(this._editContext,"compositionstart",r=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=w.fromPositions(s,s);this._compositionRangeWithinEditor=a,t.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(Jh(this._editContext,"compositionend",r=>{this._compositionRangeWithinEditor=void 0,t.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(e){e.appendChild(this.domNode),this._parent=e.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._renderingContext=e,this._screenReaderSupport.prepareRender(e),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new Me(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(126)))}_updateEditContext(){let e=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._textStartPositionWithinEditor=e.textStartPositionWithinEditor}_emitTypeEvent(e,t){if(!this._editContext)return;let n=this._context.viewModel.model,i=n.getOffsetAt(this._textStartPositionWithinEditor),r=n.getOffsetAt(this._primarySelection.getEndPosition()),s=n.getOffsetAt(this._primarySelection.getStartPosition()),a=r-i,l=s-i,d=0,c=0;t.updateRangeEnd>a&&(d=t.updateRangeEnd-a),t.updateRangeStart<l&&(c=l-t.updateRangeStart);let u="";l<t.updateRangeStart&&(u+=this._editContext.text.substring(l,t.updateRangeStart)),u+=t.text,a>t.updateRangeEnd&&(u+=this._editContext.text.substring(t.updateRangeEnd,a));let p={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(e,p);let m=l-c+u.length;this._updateCursorStatesAfterType(m,t.selectionStart,t.selectionEnd)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_updateCursorStatesAfterType(e,t,n){let i=t-e,r=n-e,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new Me(c,u+i,c,u+r)}).map(d=>Ke.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let e=this._primarySelection.startColumn-1,t=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?t+=this._primarySelection.endColumn-1:t+=this._context.viewModel.model.getLineMaxColumn(a);let n=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),i=new w(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,n),r=this._context.viewModel.model.getValueInRange(i,0),s=i.getStartPosition();return{text:r,selectionStartOffset:e,selectionEndOffset:t,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(e){if(!this._editContext)return;let t=e.getTextFormats(),n=this._textStartPositionWithinEditor,i=[];t.forEach(r=>{let s=this._context.viewModel.model,a=s.getOffsetAt(n),l=s.getPositionAt(a+r.rangeStart),d=s.getPositionAt(a+r.rangeEnd),c=w.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${r.underlineStyle.toLowerCase()}`,`underline-thickness-${r.underlineThickness.toLowerCase()}`];i.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,i)}_updateSelectionAndControlBounds(){if(!this._parent)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=i.top+r-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*t,d=i.left+n,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let m=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];m.length>0&&(d+=Math.min(...m.map(f=>Math.min(...f.ranges.map(g=>g.left)))))}c=e.get(51).typicalHalfwidthCharacterWidth/2}else c=i.width-n;let u=new DOMRect(d,a,c,l),p=u;this._editContext.updateControlBounds(p),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let e=this._context.configuration.options,t=e.get(68),n=e.get(147).contentLeft,i=this._parent.getBoundingClientRect(),r=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(r.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=i.top+s-a,d=[];if(this._renderingContext){let f=this._renderingContext.linesVisibleRangesForRange(r,!0)??[];for(let g of f)for(let b of g.ranges)d.push(new DOMRect(i.left+n+b.left,l,b.width,t))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),m=c.getOffsetAt(r.getStartPosition())-u;this._editContext.updateCharacterBounds(m,d)}_ensureClipboardGetsEditorSelection(e){let t=this._context.configuration.options,n=t.get(38),i=t.get(25),r=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=Dx(this._context.viewModel,r,n,i),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};tu.INSTANCE.set(In?s.text.replace(/\r\n/g,`
`):s.text,a),e.writeText(s.text)}};tm=K([D(2,dt),D(3,JS)],tm);var nm=class extends Cr{constructor(t,n,i,r,s,a,l){super();this._instantiationService=l;this._selections=[new Me(1,1,1,1)],this._renderAnimationFrame=null;let d=new Lx(n,r,s,t);this._context=new Ix(n,i,r),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(tm,this._context,d):this._instantiationService.createInstance(Qh,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=Ae(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Ae(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Ae(document.createElement("div")),Mn.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new zx(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new $x(this._context,this._linesContent),this._viewZones=new c_(this._context),this._viewParts.push(this._viewZones);let u=new i_(this._context);this._viewParts.push(u);let p=new s_(this._context);this._viewParts.push(p);let m=new Nx(this._context);this._viewParts.push(m),m.addDynamicOverlay(new Vx(this._context)),m.addDynamicOverlay(new l_(this._context)),m.addDynamicOverlay(new Gx(this._context)),m.addDynamicOverlay(new Ux(this._context)),m.addDynamicOverlay(new u_(this._context));let f=new Ox(this._context);this._viewParts.push(f),f.addDynamicOverlay(new Hx(this._context)),f.addDynamicOverlay(new qx(this._context)),f.addDynamicOverlay(new jx(this._context)),f.addDynamicOverlay(new qh(this._context)),this._glyphMarginWidgets=new Kx(this._context),this._viewParts.push(this._glyphMarginWidgets);let g=new Yh(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(f.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new Fx(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new d_(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new n_(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new r_(this._context);this._viewParts.push(b);let v=new Ax(this._context);this._viewParts.push(v);let I=new e_(this._context);if(this._viewParts.push(I),u){let C=this._scrollbar.getOverviewRulerLayoutInfo();C.parent.insertBefore(u.getDomNode(),C.insertBefore)}this._linesContent.appendChild(m.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(I.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new Mx(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let t=this._context.viewModel.model,n=this._context.viewModel.glyphLanes,i=[],r=0;i=i.concat(t.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return r=Math.max(r,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=t.validateRange(s.preference.range);return r=Math.max(r,a.endLineNumber),{range:a,lane:s.preference.lane}})),i.sort((s,a)=>w.compareRangesUsingStarts(s.range,a.range)),n.reset(r);for(let s of i)n.push(s.lane,s.range,s.persist);return n}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._editContext.domNode.domNode.dispatchEvent(t)},getLastRenderData:()=>{let t=this._viewCursors.getLastRenderData()||[],n=this._editContext.getLastRenderData();return new Tx(t,n)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,n)),visibleRangeForPosition:(t,n)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new M(t,n))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){let n=this._context.configuration.options.get(147);this.domNode.setWidth(n.width),this.domNode.setHeight(n.height),this._overflowGuardContainer.setWidth(n.width),this._overflowGuardContainer.setHeight(n.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let t=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+Xg(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new $e;if(this._renderAnimationFrame===null){let t=this._createCoordinatedRendering();this._renderAnimationFrame=Wk.INSTANCE.scheduleCoordinatedRendering({window:ge(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new $e;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new $e;return t.renderText()},prepareRender:(n,i)=>{if(this._store.isDisposed)throw new $e;return t.prepareRender(n,i)},render:(n,i)=>{if(this._store.isDisposed)throw new $e;return t.render(n,i)}})}}_flushAccumulatedAndRenderNow(){let t=this._createCoordinatedRendering();Cd(()=>t.prepareRenderText());let n=Cd(()=>t.renderText());if(n){let[i,r]=n;Cd(()=>t.prepareRender(i,r)),Cd(()=>t.render(i,r))}}_getViewPartsToRender(){let t=[],n=0;for(let i of this._viewParts)i.shouldRender()&&(t[n++]=i);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}cl.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;let n=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(n.startLineNumber,n.endLineNumber,n.centeredLineNumber);let i=new fx(this._selections,n,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new bx(this._context.viewLayout,i,this._viewLines)]},prepareRender:(t,n)=>{for(let i of t)i.prepareRender(n)},render:(t,n)=>{for(let i of t)i.render(n),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,n){let i=this._context.viewModel.model.validatePosition({lineNumber:t,column:n}),r=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new M(r.lineNumber,r.column));return s?s.left:-1}getTargetAtClientPoint(t,n){let i=this._pointerHandler.getTargetAtClientPoint(t,n);return i?Uh.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new o_(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,n){if(n){this._viewLines.forceShouldRender();for(let i of this._viewParts)i.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._editContext.writeScreenReaderContent(t)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(t){this._editContext.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){this._contentWidgets.setWidgetPosition(t.widget,t.position?.position??null,t.position?.secondaryPosition??null,t.position?.preference??null,t.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){this._overlayWidgets.setWidgetPosition(t.widget,t.position)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){let n=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,n)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};nm=K([D(6,dt)],nm);function Cd(o){try{return o()}catch(e){return We(e),null}}var Wk=class o{static INSTANCE=new o;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{let t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(let[n,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){let t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,Au(e,t,100))}}_onRenderScheduled(){let e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let n of e)Cd(()=>n.prepareRenderText());let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];t[n]=Cd(()=>r.renderText())}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Cd(()=>r.prepareRender(a,l))}for(let n=0,i=e.length;n<i;n++){let r=e[n],s=t[n];if(!s)continue;let[a,l]=s;Cd(()=>r.render(a,l))}}};var C9=Ph("domLineBreaksComputer",{createHTML:o=>o}),m_=class o{constructor(e){this.targetWindow=e}static create(e){return new o(new WeakRef(e))}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>S9(Rs(this.targetWindow.deref()),s,e,t,n,i,r,a)}}};function S9(o,e,t,n,i,r,s,a){function l(P){let H=a[P];if(H){let U=so.applyInjectedText(e[P],H),z=H.map(fe=>fe.options),oe=H.map(fe=>fe.column-1);return new Ga(oe,z,[U.length],[],0)}else return null}if(i===-1){let P=[];for(let H=0,U=e.length;H<U;H++)P[H]=l(H);return P}let d=Math.round(i*t.typicalHalfwidthCharacterWidth),c=r===3?2:r===2?1:0,u=Math.round(n*c),p=Math.ceil(t.spaceWidth*u),m=document.createElement("div");Jt(m,t);let f=new pc(1e4),g=[],b=[],v=[],I=[],C=[];for(let P=0;P<e.length;P++){let H=so.applyInjectedText(e[P],a[P]),U=0,z=0,oe=d;if(r!==0)if(U=zt(H),U===-1)U=0;else{for(let se=0;se<U;se++){let te=H.charCodeAt(se)===9?n-z%n:1;z+=te}let X=Math.ceil(t.spaceWidth*z);X+t.typicalFullwidthCharacterWidth>d?(U=0,z=0):oe=d-X}let fe=H.substr(U),ee=x9(fe,z,n,oe,f,p);g[P]=U,b[P]=z,v[P]=fe,I[P]=ee[0],C[P]=ee[1]}let S=f.build(),_=C9?.createHTML(S)??S;m.innerHTML=_,m.style.position="absolute",m.style.top="10000",s==="keepAll"?(m.style.wordBreak="keep-all",m.style.overflowWrap="anywhere"):(m.style.wordBreak="inherit",m.style.overflowWrap="break-word"),o.document.body.appendChild(m);let R=document.createRange(),N=Array.prototype.slice.call(m.children,0),F=[];for(let P=0;P<e.length;P++){let H=N[P],U=_9(R,H,v[P],I[P]);if(U===null){F[P]=l(P);continue}let z=g[P],oe=b[P]+u,fe=C[P],ee=[];for(let Z=0,ye=U.length;Z<ye;Z++)ee[Z]=fe[U[Z]];if(z!==0)for(let Z=0,ye=U.length;Z<ye;Z++)U[Z]+=z;let X,se,te=a[P];te?(X=te.map(Z=>Z.options),se=te.map(Z=>Z.column-1)):(X=null,se=null),F[P]=new Ga(se,X,U,ee,oe)}return m.remove(),F}function x9(o,e,t,n,i,r){if(r!==0){let p=String(r);i.appendString('<div style="text-indent: -'),i.appendString(p),i.appendString("px; padding-left: "),i.appendString(p),i.appendString("px; box-sizing: border-box; width:")}else i.appendString('<div style="width:');i.appendString(String(n)),i.appendString('px;">');let s=o.length,a=e,l=0,d=[],c=[],u=0<s?o.charCodeAt(0):0;i.appendString("<span>");for(let p=0;p<s;p++){p!==0&&p%16384===0&&i.appendString("</span><span>"),d[p]=l,c[p]=a;let m=u;u=p+1<s?o.charCodeAt(p+1):0;let f=1,g=1;switch(m){case 9:f=t-a%t,g=f;for(let b=1;b<=f;b++)b<f?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 32:u===32?i.appendCharCode(160):i.appendASCIICharCode(32);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Yo(m)&&g++,m<32?i.appendCharCode(9216+m):i.appendCharCode(m)}l+=f,a+=g}return i.appendString("</span>"),d[o.length]=l,c[o.length]=a,i.appendString("</div>"),[d,c]}function _9(o,e,t,n){if(t.length<=1)return null;let i=Array.prototype.slice.call(e.children,0),r=[];try{Hk(o,i,n,0,null,t.length-1,null,r)}catch(s){return console.log(s),null}return r.length===0?null:(r.push(t.length),r)}function Hk(o,e,t,n,i,r,s,a){if(n===r||(i=i||Vk(o,e,t[n],t[n+1]),s=s||Vk(o,e,t[r],t[r+1]),Math.abs(i[0].top-s[0].top)<=.1))return;if(n+1===r){a.push(r);return}let l=n+(r-n)/2|0,d=Vk(o,e,t[l],t[l+1]);Hk(o,e,t,n,i,l,d,a),Hk(o,e,t,l,d,r,s,a)}function Vk(o,e,t,n){return o.setStart(e[t/16384|0].firstChild,t%16384),o.setEnd(e[n/16384|0].firstChild,n%16384),o.getClientRects()}var g_=class extends V{_editor=null;_instantiationService=null;_instances=this._register(new Go);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,n){this._editor=e,this._instantiationService=n;for(let i of t){if(this._pending.has(i.id)){We(new Error(`Cannot have two contributions with the same id ${i.id}`));continue}this._pending.set(i.id,i)}this._instantiateSome(0),this._register(Jm(ge(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(Jm(ge(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(Jm(ge(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let e={};for(let[t,n]of this._instances)typeof n.saveViewState=="function"&&(e[t]=n.saveViewState());return e}restoreViewState(e){for(let[t,n]of this._instances)typeof n.restoreViewState=="function"&&n.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}set(e,t){this._instances.set(e,t)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return Jm(ge(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;let t=this._findPendingContributionsByInstantiation(e);for(let n of t)this._instantiateById(n.id)}_findPendingContributionsByInstantiation(e){let t=[];for(let[,n]of this._pending)n.instantiation===e&&t.push(n);return t}_instantiateById(e){let t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let n=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,n),typeof n.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(n){We(n)}}}};var f_=class{constructor(e,t,n,i,r,s,a){this.id=e;this.label=t;this.alias=n;this.metadata=i;this._precondition=r;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}};var b_=class o{static create(e){return new o(e.get(136),e.get(135))}classifier;constructor(e,t){this.classifier=new Uk(e,t)}createLineBreaksComputer(e,t,n,i,r){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,c=[];for(let u=0,p=s.length;u<p;u++){let m=a[u],f=l[u];f&&!f.injectionOptions&&!m?c[u]=E9(this.classifier,f,s[u],t,n,d,i,r):c[u]=w9(this.classifier,s[u],m,t,n,d,i,r)}return zk.length=0,Kk.length=0,c}}}};var Uk=class extends hc{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}},zk=[],Kk=[];function E9(o,e,t,n,i,r,s,a){if(i===-1)return null;let l=t.length;if(l<=1)return null;let d=a==="keepAll",c=e.breakOffsets,u=e.breakOffsetsVisibleColumn,p=sW(t,n,i,r,s),m=i-p,f=zk,g=Kk,b=0,v=0,I=0,C=i,S=c.length,_=0;if(_>=0){let R=Math.abs(u[_]-C);for(;_+1<S;){let N=Math.abs(u[_+1]-C);if(N>=R)break;R=N,_++}}for(;_<S;){let R=_<0?0:c[_],N=_<0?0:u[_];v>R&&(R=v,N=I);let F=0,P=0,H=0,U=0;if(N<=C){let oe=N,fe=R===0?0:t.charCodeAt(R-1),ee=R===0?0:o.get(fe),X=!0;for(let se=R;se<l;se++){let te=se,Z=t.charCodeAt(se),ye,Se;if(At(Z)?(se++,ye=0,Se=2):(ye=o.get(Z),Se=Cb(Z,oe,n,r)),te>v&&Gk(fe,ee,Z,ye,d)&&(F=te,P=oe),oe+=Se,oe>C){te>v?(H=te,U=oe-Se):(H=se+1,U=oe),oe-P>m&&(F=0),X=!1;break}fe=Z,ee=ye}if(X){b>0&&(f[b]=c[c.length-1],g[b]=u[c.length-1],b++);break}}if(F===0){let oe=N,fe=t.charCodeAt(R),ee=o.get(fe),X=!1;for(let se=R-1;se>=v;se--){let te=se+1,Z=t.charCodeAt(se);if(Z===9){X=!0;break}let ye,Se;if(ks(Z)?(se--,ye=0,Se=2):(ye=o.get(Z),Se=Yo(Z)?r:1),oe<=C){if(H===0&&(H=te,U=oe),oe<=C-m)break;if(Gk(Z,ye,fe,ee,d)){F=te,P=oe;break}}oe-=Se,fe=Z,ee=ye}if(F!==0){let se=m-(U-P);if(se<=n){let te=t.charCodeAt(H),Z;At(te)?Z=2:Z=Cb(te,U,n,r),se-Z<0&&(F=0)}}if(X){_--;continue}}if(F===0&&(F=H,P=U),F<=v){let oe=t.charCodeAt(v);At(oe)?(F=v+2,P=I+2):(F=v+1,P=I+Cb(oe,I,n,r))}for(v=F,f[b]=F,I=P,g[b]=P,b++,C=P+m;_<0||_<S&&u[_]<P;)_++;let z=Math.abs(u[_]-C);for(;_+1<S;){let oe=Math.abs(u[_+1]-C);if(oe>=z)break;z=oe,_++}}return b===0?null:(f.length=b,g.length=b,zk=e.breakOffsets,Kk=e.breakOffsetsVisibleColumn,e.breakOffsets=f,e.breakOffsetsVisibleColumn=g,e.wrappedTextIndentLength=p,e)}function w9(o,e,t,n,i,r,s,a){let l=so.applyInjectedText(e,t),d,c;if(t&&t.length>0?(d=t.map(P=>P.options),c=t.map(P=>P.column-1)):(d=null,c=null),i===-1)return d?new Ga(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new Ga(c,d,[l.length],[],0):null;let p=a==="keepAll",m=sW(l,n,i,r,s),f=i-m,g=[],b=[],v=0,I=0,C=0,S=i,_=l.charCodeAt(0),R=o.get(_),N=Cb(_,0,n,r),F=1;At(_)&&(N+=1,_=l.charCodeAt(1),R=o.get(_),F++);for(let P=F;P<u;P++){let H=P,U=l.charCodeAt(P),z,oe;At(U)?(P++,z=0,oe=2):(z=o.get(U),oe=Cb(U,N,n,r)),Gk(_,R,U,z,p)&&(I=H,C=N),N+=oe,N>S&&((I===0||N-C>f)&&(I=H,C=N-oe),g[v]=I,b[v]=C,v++,S=C+f,I=0),_=U,R=z}return v===0&&(!t||t.length===0)?null:(g[v]=u,b[v]=N,new Ga(c,d,g,b,m))}function Cb(o,e,t,n){return o===9?t-e%t:Yo(o)||o<32?n:1}function rW(o,e){return e-o%e}function Gk(o,e,t,n,i){return t!==32&&(e===2&&n!==2||e!==1&&n===1||!i&&e===3&&n!==2||!i&&n===3&&e!==1)}function sW(o,e,t,n,i){let r=0;if(i!==0){let s=zt(o);if(s!==-1){for(let l=0;l<s;l++){let d=o.charCodeAt(l)===9?rW(r,e):1;r+=d}let a=i===3?2:i===2?1:0;for(let l=0;l<a;l++){let d=rW(r,e);r+=d}r+n>t&&(r=0)}}return r}var Sb=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(e,t,n,i){this.model=e,this.viewModel=t,this.coordinatesConverter=n,this.cursorConfig=i}};var xb=class o{modelState;viewState;_selTrackedRange;_trackSelection;constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new pn(new w(1,1,1,1),0,0,new M(1,1),0),new pn(new w(1,1,1,1),0,0,new M(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Ke(this.modelState,this.viewState)}readSelectionFromMarkers(e){let t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?Me.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):Me.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}static _validatePositionWithCache(e,t,n,i){return t.equals(n)?i:e.normalizePosition(t,2)}static _validateViewState(e,t){let n=t.position,i=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),s=e.normalizePosition(n,2),a=this._validatePositionWithCache(e,i,n,s),l=this._validatePositionWithCache(e,r,i,a);return n.equals(s)&&i.equals(a)&&r.equals(l)?t:new pn(w.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+i.column-a.column,s,t.leftoverVisibleColumns+n.column-s.column)}_setState(e,t,n){if(n&&(n=o._validateViewState(e.viewModel,n)),t){let i=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,s=e.model.validatePosition(t.position),a=t.position.equals(s)?t.leftoverVisibleColumns:0;t=new pn(i,t.selectionStartKind,r,s,a)}else{if(!n)return;let i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new pn(i,n.selectionStartKind,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){let i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new pn(i,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{let i=e.coordinatesConverter.convertModelPositionToViewPosition(new M(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new M(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),s=new w(i.lineNumber,i.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new pn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}};var _b=class{context;cursors;lastAddedCursorIndex;constructor(e){this.context=e,this.cursors=[new xb(e)],this.lastAddedCursorIndex=0}dispose(){for(let e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(let e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(let e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(let e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return kR(this.cursors,Es(e=>e.viewState.position,M.compare)).viewState.position}getBottomMostViewPosition(){return DR(this.cursors,Es(e=>e.viewState.position,M.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(Ke.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){let t=this.cursors.length-1,n=e.length;if(t<n){let i=n-t;for(let r=0;r<i;r++)this._addSecondaryCursor()}else if(t>n){let i=t-n;for(let r=0;r<i;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<n;i++)this.cursors[i+1].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new xb(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;let e=this.cursors.slice(0),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(Es(n=>n.selection,w.compareRangesUsingStarts));for(let n=0;n<t.length-1;n++){let i=t[n],r=t[n+1],s=i.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=i.index<r.index?n:n+1,c=i.index<r.index?n+1:n,u=t[c].index,p=t[d].index,m=t[c].selection,f=t[d].selection;if(!m.equalsSelection(f)){let g=m.plusRange(f),b=m.selectionStartLineNumber===m.startLineNumber&&m.selectionStartColumn===m.startColumn,v=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,I;u===this.lastAddedCursorIndex?(I=b,this.lastAddedCursorIndex=p):I=v;let C;I?C=new Me(g.startLineNumber,g.startColumn,g.endLineNumber,g.endColumn):C=new Me(g.endLineNumber,g.endColumn,g.startLineNumber,g.startColumn),t[d].selection=C;let S=Ke.fromModelSelection(C);e[p].setState(this.context,S.modelState,S.viewState)}for(let g of t)g.index>u&&g.index--;e.splice(u,1),t.splice(c,1),this._removeSecondaryCursor(u-1),n--}}}};var v_=class extends V{_onEvent=this._register(new L);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++){let i=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(i){this._outgoingEvents[t]=i;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new $k),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(let n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let e=this._viewEventQueue;this._viewEventQueue=null;let t=this._eventHandlers.slice(0);for(let n of t)n.handleEvents(e)}}},$k=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}};var y_=class o{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(e,t,n,i){this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}},I_=class o{kind=1;oldHasFocus;hasFocus;constructor(e,t){this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldHasFocus,e.hasFocus)}},C_=class o{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(e,t,n,i,r,s,a,l){this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=r,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new o(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}},S_=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},x_=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},__=class o{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(e,t,n,i,r,s,a){this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=r,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let n=e.length,i=t.length;if(n!==i)return!1;for(let r=0;r<n;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return o._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new o(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}},E_=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}},w_=class{constructor(e){this.event=e}kind=7;isNoOp(){return!1}attemptToMerge(e){return null}},T_=class{constructor(e){this.event=e}kind=8;isNoOp(){return!1}attemptToMerge(e){return null}},L_=class{constructor(e){this.event=e}kind=9;isNoOp(){return!1}attemptToMerge(e){return null}},D_=class{constructor(e){this.event=e}kind=10;isNoOp(){return!1}attemptToMerge(e){return null}},k_=class{constructor(e){this.event=e}kind=11;isNoOp(){return!1}attemptToMerge(e){return null}},R_=class{constructor(e){this.event=e}kind=12;isNoOp(){return!1}attemptToMerge(e){return null}};var M_=class extends V{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new Sb(this._model,this._viewModel,this._coordinatesConverter,i),this._cursors=new _b(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=yt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new Sb(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){let n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1,s=this.context.cursorConfig.multiCursorLimit;i!==null&&i.length>s&&(i=i.slice(0,s),r=!0);let a=Eb.from(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,n,i,r,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=w.fromPositions(a[0],a[0]),e.emitViewEvent(new ja(t,n,l,d,i,r,s))}revealPrimary(e,t,n,i,r,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new ja(t,n,null,l,i,r,s))}saveState(){let e=[],t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){let r=t[n];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){let s=t[i],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),n.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,Ke.fromModelSelections(n)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof up){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let n=t.rawContentChangedEvent;if(this._knownModelVersionId=n.versionId,this._isHandling)return;let i=n.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new _b(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&n.resultingSelection&&n.resultingSelection.length>0){let r=Ke.fromModelSelections(n.resultingSelection);this.setStates(e,"modelChange",n.isUndoing?5:n.isRedoing?6:2,r)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{let r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,Ke.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t,n,i){this.setStates(e,t,i,Ke.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let a=0,l=e.length;a<l;a++)n.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});let r=this._model.deltaDecorations([],n),s=this._model.deltaDecorations([],i);this._autoClosedActions.push(new P_(this._model,r,s))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();let t=jk.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let r=0;r<e.commands.length;r++){let s=e.commands[r];s instanceof Ap&&s.enclosingRange&&s.closeCharacterRange&&(n.push(s.closeCharacterRange),i.push(s.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){let s=Eb.from(this._model,this);if(s.equals(i))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new LI(l,a,n)),!i||i.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(i.cursorState[c].modelState))){let d=i?i.cursorState.map(u=>u.modelState.selection):null,c=i?i.modelVersionId:0;e.emitOutgoingEvent(new __(d,a,c,s.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];if(!r.text||r.text.indexOf(`
`)>=0)return null;let s=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=r.text.length-s[2].length-1,u=r.text.lastIndexOf(d,c-1);if(u===-1)return null;t.push([u,c])}return t}executeEdits(e,t,n,i){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),n,d=>{if(r)for(let u=0,p=r.length;u<p;u++){let[m,f]=r[u],g=d[u],b=g.range.startLineNumber,v=g.range.startColumn-1+m,I=g.range.startColumn-1+f;s.push(new w(b,I+1,b,I+2)),a.push(new w(b,v+1,b,I+2))}let c=i(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;let r=Eb.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(s){We(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,r,!1)&&this.revealAll(t,n,!1,0,!0,0)}getAutoClosedCharacters(){return P_.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new Yk(this._model,this.getSelections())}endComposition(e,t){let n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(as.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,n){this._executeEdit(()=>{if(n==="keyboard"){let i=t.length,r=0;for(;r<i;){let s=Pm(t,r),a=t.substr(r,s);this._executeEditOperation(as.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=s}}else this._executeEditOperation(as.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,n)}compositionType(e,t,n,i,r,s){if(t.length===0&&n===0&&i===0){if(r!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new Me(d.lineNumber,d.column+r,d.lineNumber,d.column+r)});this.setSelections(e,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(as.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))},e,s)}paste(e,t,n,i,r){this._executeEdit(()=>{this._executeEditOperation(as.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(Ya.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,n){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Sn(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}executeCommands(e,t,n){this._executeEdit(()=>{this._executeEditOperation(new Sn(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,n)}},Eb=class o{constructor(e,t){this.modelVersionId=e;this.cursorState=t}static from(e,t){return new o(e.getVersionId(),t.getCursorStates())}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}},P_=class{static getAllAutoClosedCharacters(e){let t=[];for(let n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){let n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){let i=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(i&&(t.push(i),i.startLineNumber!==i.endLineNumber))return!1}t.sort(w.compareRangesUsingStarts),e.sort(w.compareRangesUsingStarts);for(let n=0;n<e.length;n++)if(n>=t.length||!t[n].strictContainsRange(e[n]))return!1;return!0}},jk=class{static executeCommands(e,t,n){let i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let s=0,a=i.trackedRanges.length;s<a;s++)i.model._setTrackedRange(i.trackedRanges[s],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;let n=this._getEditOperations(e,t);if(n.operations.length===0)return null;let i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=i.length;d<c;d++)r.hasOwnProperty(i[d].identifier.major.toString())||s.push(i[d]);n.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,s,d=>{let c=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m]=[];for(let m of d)m.identifier&&c[m.identifier.major].push(m);let u=(m,f)=>m.identifier.minor-f.identifier.minor,p=[];for(let m=0;m<e.selectionsBefore.length;m++)c[m].length>0?(c[m].sort(u),p[m]=t[m].computeCursorState(e.model,{getInverseEditOperations:()=>c[m],getTrackedSelection:f=>{let g=parseInt(f,10),b=e.model._getTrackedRange(e.trackedRanges[g]);return e.trackedRangesDirection[g]===0?new Me(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new Me(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):p[m]=e.selectionsBefore[m];return p});a||(a=e.selectionsBefore);let l=[];for(let d in r)r.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,s=t.length;r<s;r++){let a=t[r];if(a){let l=this._getEditOperationsFromCommand(e,r,a);n=n.concat(l.operations),i=i||l.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],r=0,s=(u,p,m=!1)=>{w.isEmpty(u)&&p===""||i.push({identifier:{major:t,minor:r++},range:u,text:p,forceMoveMarkers:m,isAutoWhitespaceEdit:n.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,p,m)=>{a=!0,s(u,p,m)},trackSelection:(u,p)=>{let m=Me.liftSelection(u),f;if(m.isEmpty())if(typeof p=="boolean")p?f=2:f=3;else{let v=e.model.getLineMaxColumn(m.startLineNumber);m.startColumn===v?f=2:f=3}else f=1;let g=e.trackedRanges.length,b=e.model._setTrackedRange(null,m,f);return e.trackedRanges[g]=b,e.trackedRangesDirection[g]=m.getDirection(),g.toString()}};try{n.getEditOperations(e.model,c)}catch(u){return We(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((n,i)=>-w.compareRangesUsingEnds(n.range,i.range));let t={};for(let n=1;n<e.length;n++){let i=e[n-1],r=e[n];if(w.getStartPosition(i.range).isBefore(w.getEndPosition(r.range))){let s;i.identifier.major>r.identifier.major?s=i.identifier.major:s=r.identifier.major,t[s.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===s&&(e.splice(a,1),a<n&&n--,a--);n>0&&n--}}return t}},qk=class{constructor(e,t,n){this.text=e;this.startSelection=t;this.endSelection=n}},Yk=class o{_original;static _capture(e,t){let n=[];for(let i of t){if(i.startLineNumber!==i.endLineNumber)return null;n.push(new qk(e.getLineContent(i.startLineNumber),i.startColumn-1,i.endColumn-1))}return n}constructor(e,t){this._original=o._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;let n=o._capture(e,t);if(!n||this._original.length!==n.length)return null;let i=[];for(let r=0,s=this._original.length;r<s;r++)i.push(o._deduceOutcome(this._original[r],n[r]));return i}static _deduceOutcome(e,t){let n=Math.min(e.startSelection,t.startSelection,Or(e.text,t.text)),i=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,Mm(e.text,t.text)),r=e.text.substring(n,e.text.length-i),s=t.text.substring(n,t.text.length-i);return new dC(r,e.startSelection-n,e.endSelection-n,s,t.startSelection-n,t.endSelection-n)}};var aW={getInitialState:()=>Q1,tokenizeEncoded:(o,e,t)=>WC(0,t)};async function dW(o,e,t){if(!t)return lW(e,o.languageIdCodec,aW);let n=await ro.getOrCreate(t);return lW(e,o.languageIdCodec,n||aW)}function cW(o,e,t,n,i,r,s){let a="<div>",l=n,d=0,c=!0;for(let u=0,p=e.getCount();u<p;u++){let m=e.getEndOffset(u);if(m<=n)continue;let f="";for(;l<m&&l<i;l++){let g=o.charCodeAt(l);switch(g){case 9:{let b=r-(l+d)%r;for(d+=b-1;b>0;)s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0),b--;break}case 60:f+="&lt;",c=!1;break;case 62:f+="&gt;",c=!1;break;case 38:f+="&amp;",c=!1;break;case 0:f+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:f+="\uFFFD",c=!1;break;case 13:f+="&#8203",c=!1;break;case 32:s&&c?(f+="&#160;",c=!1):(f+=" ",c=!0);break;default:f+=String.fromCharCode(g),c=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${f}</span>`,m>i||l>=i)break}return a+="</div>",a}function lW(o,e,t){let n='<div class="monaco-tokenized-source">',i=Nr(o),r=t.getInitialState();for(let s=0,a=i.length;s<a;s++){let l=i[s];s>0&&(n+="<br/>");let d=t.tokenizeEncoded(l,!0,r);en.convertToEndOffset(d.tokens,l.length);let u=new en(d.tokens,l,e).inflate(),p=0;for(let m=0,f=u.getCount();m<f;m++){let g=u.getClassName(m),b=u.getEndOffset(m);n+=`<span class="${g}">${Vd(l.substring(p,b))}</span>`,p=b}r=d.endState}return n+="</div>",n}var Xk=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;let t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}},Zk=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(e,t,n,i,r){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=r,this.prefixSum=0}},N_=class o{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(e,t,n,i){this._instanceId=vv(++o.INSTANCE_COUNT),this._pendingChanges=new Xk,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,r=e.length;for(;i<r;){let s=i+r>>>1;t===e[s].afterLineNumber?n<e[s].ordinal?r=s:i=s+1:t<e[s].afterLineNumber?r=s:i=s+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(i,r,s,a)=>{t=!0,i=i|0,r=r|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new Zk(l,i,r,s,a)),l},changeOneWhitespace:(i,r,s)=>{t=!0,r=r|0,s=s|0,this._pendingChanges.change({id:i,newAfterLineNumber:r,newHeight:s})},removeWhitespace:i=>{t=!0,this._pendingChanges.remove({id:i})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(let l of e)this._insertWhitespace(l);for(let l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of n){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let i=new Set;for(let l of n)i.add(l.id);let r=new Map;for(let l of t)r.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!i.has(c.id)){if(r.has(c.id)){let u=r.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(e));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){let t=o.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){let t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){let i=this._findWhitespaceIndex(e);if(i!==-1&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){let r=this._arr[i];this._removeWhitespace(i),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&r<=t?this._arr[n].afterLineNumber=e-1:r>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){let r=this._arr[n].afterLineNumber;e<=r&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;let t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;let t=this._arr,n=0,i=t.length-1;for(;n<=i;){let s=(i-n|0)/2|0,a=n+s|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;n=a+1|0}else i=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;let n=this._findLastWhitespaceBeforeLineNumber(e)+1;return n<this._arr.length?n:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n;e>1?n=this._lineHeight*(e-1):n=0;let i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return n+i+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let n=this._lineHeight*e,i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return n+i+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;let t=this._lineCount|0,n=this._lineHeight,i=1,r=t;for(;i<r;){let s=(i+r)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(e>=a+n)i=s+1;else{if(e>=a)return s;r=s}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this._lineHeight,i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(i)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(i)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=r,p=u,m=5e5,f=0;r>=m&&(f=Math.floor(r/m)*m,f=Math.floor(f/n)*n,p-=f);let g=[],b=e+(t-e)/2,v=-1;for(let _=i;_<=s;_++){if(v===-1){let R=u,N=u+n;(R<=b&&b<N||R>b)&&(v=_)}for(u+=n,g[_-i]=p,p+=n;c===_;)p+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){s=_;break}}v===-1&&(v=s);let I=this.getVerticalOffsetForLineNumber(s)|0,C=i,S=s;return C<S&&r<e&&C++,C<S&&I+n>t&&S--,{bigNumbersDelta:f,startLineNumber:i,endLineNumber:s,relativeVerticalOffset:g,centeredLineNumber:v,completelyVisibleStartLineNumber:C,completelyVisibleEndLineNumber:S,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;let t=this.getAfterLineNumberForWhitespaceIndex(e),n;t>=1?n=this._lineHeight*t:n=0;let i;return e>0?i=this.getWhitespacesAccumulatedHeight(e-1):i=0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;let i=this.getVerticalOffsetForWhitespaceIndex(n),r=this.getHeightForWhitespaceIndex(n);if(e>=i+r)return-1;for(;t<n;){let s=Math.floor((t+n)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(e>=a+l)t=s+1;else{if(e>=a)return s;n=s}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;let n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;let i=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),s=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:s,verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;let n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let r=[];for(let s=n;s<=i;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};var L9=125,ru=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(e,t,n,i){e=e|0,t=t|0,n=n|0,i=i|0,e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),i<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}},Qk=class extends V{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new L);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(e,t){super(),this._dimensions=new ru(0,0,0,0),this._scrollable=this._register(new Ba({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;let t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);let n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new y_(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},O_=class extends V{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(e,t,n){super(),this._configuration=e;let i=this._configuration.options,r=i.get(147),s=i.get(85);this._linesLayout=new N_(t,i.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new Qk(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new ru(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?L9:0)}onConfigurationChanged(e){let t=this._configuration.options;if(e.hasChanged(68)&&this._linesLayout.setLineHeight(t.get(68)),e.hasChanged(85)){let n=t.get(85);this._linesLayout.setPadding(n.top,n.bottom)}if(e.hasChanged(147)){let n=t.get(147),i=n.contentWidth,r=n.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new ru(i,s.contentWidth,r,this._getContentHeight(i,r,a)))}else this._updateHeight();e.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){let i=this._configuration.options.get(105);return i.horizontal===2||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,n){let i=this._configuration.options,r=this._linesLayout.getLinesTotalHeight();return i.get(107)?r+=Math.max(0,t-i.get(68)-i.get(85).bottom):i.get(105).ignoreHorizontalScrollbarInContentHeight||(r+=this._getHorizontalScrollbarHeight(e,n)),r}_updateHeight(){let e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new ru(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new Qg(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){let e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new Qg(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){let e=this._configuration.options,t=this._maxLineWidth,n=e.get(148),i=e.get(51),r=e.get(147);if(n.isViewportWrapping){let s=e.get(74);return t>r.contentWidth+i.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?t+r.verticalScrollbarWidth:t}else{let s=e.get(106)*i.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+s+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){let e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new ru(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){let e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),i=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n);return{scrollTop:t,scrollTopWithoutViewZones:t-i,scrollLeft:e.scrollLeft}}changeWhitespace(e){let t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){let t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){let e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){let n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}};function B_(o,e){return o===null?e?A_.INSTANCE:F_.INSTANCE:new eR(o,e)}var eR=class{_projectionData;_isVisible;constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,n){this._assertVisible();let i=n>0?this._projectionData.breakOffsets[n-1]:0,r=this._projectionData.breakOffsets[n],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new so(0,0,d+1,this._projectionData.injectionOptions[c],0));s=so.applyInjectedText(e.getLineContent(t),a).substring(i,r)}else s=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:r+1});return n>0&&(s=uW(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(e,t,n){return this._assertVisible(),this._projectionData.getLineLength(n)}getViewLineMinColumn(e,t,n){return this._assertVisible(),this._projectionData.getMinOutputOffset(n)+1}getViewLineMaxColumn(e,t,n){return this._assertVisible(),this._projectionData.getMaxOutputOffset(n)+1}getViewLineData(e,t,n){let i=new Array;return this.getViewLinesData(e,t,n,1,0,[!0],i),i[0]}getViewLinesData(e,t,n,i,r,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let m=0,f=0;for(let g=0;g<l.getOutputLineCount();g++){let b=new Array;u[g]=b;let v=g>0?l.breakOffsets[g-1]:0,I=l.breakOffsets[g];for(;f<d.length;){let C=c[f].content.length,S=d[f]+m,_=S+C;if(S>I)break;if(v<_){let R=c[f];if(R.inlineClassName){let N=g>0?l.wrappedTextIndentLength:0,F=N+Math.max(S-v,0),P=N+Math.min(_-v,I-v);F!==P&&b.push(new BI(F,P,R.inlineClassName,R.inlineClassNameAffectsLetterSpacing))}}if(_<=I)m+=C,f++;else break}}}let p;if(d){let m=[];for(let f=0;f<d.length;f++){let g=d[f],b=c[f].tokens;b?b.forEach((v,I)=>{m.push({offset:g,text:v.substring(c[f].content),tokenMetadata:I.metadata})}):m.push({offset:g,text:c[f].content,tokenMetadata:en.defaultTokenMetadata})}p=e.tokenization.getLineTokens(t).withInserted(m)}else p=e.tokenization.getLineTokens(t);for(let m=n;m<n+i;m++){let f=r+m-n;if(!s[f]){a[f]=null;continue}a[f]=this._getViewLineData(p,u?u[m]:null,m)}}_getViewLineData(e,t,n){this._assertVisible();let i=this._projectionData,r=n>0?i.wrappedTextIndentLength:0,s=n>0?i.breakOffsets[n-1]:0,a=i.breakOffsets[n],l=e.sliceAndInflate(s,a,r),d=l.getLineContent();n>0&&(d=uW(i.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(n)+1,u=d.length+1,p=n+1<this.getViewLineCount(),m=n===0?0:i.breakOffsetsVisibleColumn[n-1];return new xc(d,p,c,u,m,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,n=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,n).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();let n=this._projectionData.translateToOutputPosition(t-1);return e+n.outputLineIndex}normalizePosition(e,t,n){let i=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,n).toPosition(i)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},A_=class o{static INSTANCE=new o;constructor(){}isVisible(){return!0}setVisible(e){return e?this:F_.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.tokenization.getLineTokens(t),r=i.getLineContent();return new xc(r,!1,1,r.length+1,0,i.inflate(),null)}getViewLinesData(e,t,n,i,r,s,a){if(!s[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new M(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n){return t}getInjectedTextAt(e,t){return null}},F_=class o{static INSTANCE=new o;constructor(){}isVisible(){return!1}setVisible(e){return e?A_.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,r,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}},Jk=[""];function uW(o){if(o>=Jk.length)for(let e=1;e<=o;e++)Jk[e]=D9(e);return Jk[o]}function D9(o){return new Array(o+1).join(" ")}var W_=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();let t=this._indexBySum[e],n=t>0?this._prefixSum[t-1]:0;return new tR(t,e-n)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=_s(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){let n=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+n;for(let r=0;r<n;r++)this._indexBySum[i+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}},tR=class{constructor(e,t){this.index=e;this.remainder=t;this.index=e,this.remainder=t}_prefixSumIndexOfResultBrand=void 0};var V_=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(e,t,n,i,r,s,a,l,d,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=r,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new nR(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),r=n.length,s=this.createLineBreaksComputer(),a=new ji(so.fromDecorations(i));for(let g=0;g<r;g++){let b=a.takeWhile(v=>v.lineNumber===g+1);s.addRequest(n[g],b,t?t[g]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(g=>this.model.getDecorationRange(g)).sort(w.compareRangesUsingStarts),u=1,p=0,m=-1,f=m+1<c.length?p+1:r+2;for(let g=0;g<r;g++){let b=g+1;b===f&&(m++,u=c[m].startLineNumber,p=c[m].endLineNumber,f=m+1<c.length?p+1:r+2);let v=b>=u&&b<=p,I=B_(l[g],!v);d[g]=I.getViewLineCount(),this.modelLineProjections[g]=I}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new W_(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){let t=e.map(p=>this.model.validateRange(p)),n=k9(t),i=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(w.compareRangesUsingStarts);if(n.length===i.length){let p=!1;for(let m=0;m<n.length;m++)if(!n[m].equalsRange(i[m])){p=!0;break}if(!p)return!1}let r=n.map(p=>({range:p,options:En.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);let s=n,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let p=0;p<this.modelLineProjections.length;p++){let m=p+1;m===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let f=!1;if(m>=a&&m<=l?this.modelLineProjections[p].isVisible()&&(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!1),f=!0):(u=!0,this.modelLineProjections[p].isVisible()||(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!0),f=!0)),f){let g=this.modelLineProjections[p].getViewLineCount();this.projectedModelLineLineCounts.setValue(p,g)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i,r){let s=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===n,d=this.wrappingIndent===i,c=this.wordBreak===r;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i,this.wordBreak=r;let p=null;if(u){p=[];for(let m=0,f=this.modelLineProjections.length;m<f;m++)p[m]=this.modelLineProjections[m].getProjectionData()}return this._constructLines(!1,p),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections.splice(t-1,n-t+1),this.projectedModelLineLineCounts.removeValues(t-1,n-t+1),new Tp(i,r)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;let r=t>2&&!this.modelLineProjections[t-2].isVisible(),s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,a=0,l=[],d=[];for(let c=0,u=i.length;c<u;c++){let p=B_(i[c],!r);l.push(p);let m=p.getViewLineCount();a+=m,d[c]=m}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,d),new Lp(s,s+a-1)}onModelLineChanged(e,t,n){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,r=this.modelLineProjections[i].getViewLineCount(),s=this.modelLineProjections[i].isVisible(),a=B_(n,s);this.modelLineProjections[i]=a;let l=this.modelLineProjections[i].getViewLineCount(),d=!1,c=0,u=-1,p=0,m=-1,f=0,g=-1;r>l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1,f=u+1,g=f+(r-l)-1,d=!0):r<l?(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+r-1,p=u+1,m=p+(l-r)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(i,l);let b=c<=u?new Zg(c,u-c+1):null,v=p<=m?new Lp(p,m):null,I=f<=g?new Tp(f,g):null;return[d,b,v,I]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;let t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);let i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),a=this.model.guides.getActiveIndentGuide(i.lineNumber,r.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.projectedModelLineLineCounts.getIndexOf(e-1),n=t.index,i=t.remainder;return new H_(n+1,i)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new M(e.modelLineNumber,i)}getModelEndPositionOfViewLine(e){let t=this.modelLineProjections[e.modelLineNumber-1],n=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),i=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,n);return new M(e.modelLineNumber,i)}getViewLineInfosGroupedByModelRanges(e,t){let n=this.getViewLineInfo(e),i=this.getViewLineInfo(t),r=new Array,s=this.getModelStartPositionOfViewLine(n),a=new Array;for(let l=n.modelLineNumber;l<=i.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===n.modelLineNumber?n.modelLineWrappedLineIdx:0,u=l===i.modelLineNumber?i.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let p=c;p<u;p++)a.push(new H_(l,p))}if(!d.isVisible()&&s){let c=new M(l-1,this.model.getLineMaxColumn(l-1)+1),u=w.fromPositions(s,c);r.push(new U_(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new M(l,1))}if(s){let l=w.fromPositions(s,this.getModelEndPositionOfViewLine(i));r.push(new U_(l,a))}return r}getViewLinesBracketGuides(e,t,n,i){let r=n?this.convertViewPositionToModelPosition(n.lineNumber,n.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(e,t)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,i);for(let c of a.viewLines){let p=d[c.modelLineNumber-l].map(m=>{if(m.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||m.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!m.horizontalLine)return m;let f=-1;if(m.column!==-1){let v=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.column);if(v.lineNumber===c.modelLineWrappedLineIdx)f=v.column;else if(v.lineNumber<c.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(c);else if(v.lineNumber>c.modelLineWrappedLineIdx)return}let g=this.convertModelPositionToViewPosition(c.modelLineNumber,m.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new yr(m.visibleColumn,f,m.className,new Ka(m.horizontalLine.top,g.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||m.visibleColumn!==-1?void 0:new yr(m.visibleColumn,f,m.className,new Ka(m.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(p.filter(m=>!!m))}}return s}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t)),r=[],s=[],a=[],l=n.lineNumber-1,d=i.lineNumber-1,c=null;for(let f=l;f<=d;f++){let g=this.modelLineProjections[f];if(g.isVisible()){let b=g.getViewLineNumberOfModelPosition(0,f===l?n.column:1),v=g.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),I=v-b+1,C=0;I>1&&g.getViewLineMinColumn(this.model,f+1,v)===1&&(C=b===0?1:2),s.push(I),a.push(C),c===null&&(c=new M(f+1,0))}else c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,f)),c=null)}c!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,i.lineNumber)),c=null);let u=t-e+1,p=new Array(u),m=0;for(let f=0,g=r.length;f<g;f++){let b=r[f],v=Math.min(u-m,s[f]),I=a[f],C;I===2?C=0:I===1?C=1:C=v;for(let S=0;S<v;S++)S===C&&(b=0),p[m++]=b}return p}getViewLineContent(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){let t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=e,s=i.index,a=i.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let p=d===s?a:0,m=u.getViewLineCount()-p,f=!1;if(r+m>t&&(f=!0,m=t-r+1),u.getViewLinesData(this.model,d+1,p,m,r-e,n,l),r+=m,f)break}return l}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.projectedModelLineLineCounts.getIndexOf(e-1),r=i.index,s=i.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,s),d=a.getViewLineMaxColumn(this.model,r+1,s);t<l&&(t=l),t>d&&(t=d);let c=a.getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new M(r+1,c)).equals(n)?new M(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){let n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new w(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){let n=this.getViewLineInfo(e),i=this.modelLineProjections[n.modelLineNumber-1].getModelColumnOfViewPosition(n.modelLineWrappedLineIdx,t);return this.model.validatePosition(new M(n.modelLineNumber,i))}convertViewRangeToModelRange(e){let t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new w(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t,n=2,i=!1,r=!1){let s=this.model.validatePosition(new M(e,t)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(r)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new M(i?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),p;return c?r?p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,n):p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),n):p=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,n),p}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return w.fromPositions(n)}else{let n=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new w(n.lineNumber,n.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let n=e-1;if(this.modelLineProjections[n].isVisible()){let r=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(r,t)}for(;n>0&&!this.modelLineProjections[n].isVisible();)n--;if(n===0&&!this.modelLineProjections[n].isVisible())return 1;let i=1+this.projectedModelLineLineCounts.getPrefixSum(n);return this.modelLineProjections[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getDecorationsInRange(e,t,n,i,r){let s=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-s.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new w(s.lineNumber,1,a.lineNumber,a.column),t,n,i,r);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let g=d;g<=c;g++)if(this.modelLineProjections[g].isVisible())u===null&&(u=new M(g+1,g===d?s.column:1));else if(u!==null){let v=this.model.getLineMaxColumn(g);l=l.concat(this.model.getDecorationsInRange(new w(u.lineNumber,u.column,g,v),t,n,i)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new w(u.lineNumber,u.column,a.lineNumber,a.column),t,n,i)),u=null),l.sort((g,b)=>{let v=w.compareRangesUsingStarts(g.range,b.range);return v===0?g.id<b.id?-1:g.id>b.id?1:0:v});let p=[],m=0,f=null;for(let g of l){let b=g.id;f!==b&&(f=b,p[m++]=g)}return p}getInjectedTextAt(e){let t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){let n=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[n.modelLineNumber-1].normalizePosition(n.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){let t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}};function k9(o){if(o.length===0)return[];let e=o.slice();e.sort(w.compareRangesUsingStarts);let t=[],n=e[0].startLineNumber,i=e[0].endLineNumber;for(let r=1,s=e.length;r<s;r++){let a=e[r];a.startLineNumber>i+1?(t.push(new w(n,1,i,1)),n=a.startLineNumber,i=a.endLineNumber):a.endLineNumber>i&&(i=a.endLineNumber)}return t.push(new w(n,1,i,1)),t}var H_=class{constructor(e,t){this.modelLineNumber=e;this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},U_=class{constructor(e,t){this.modelRange=e;this.viewLines=t}},nR=class{_lines;constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,n,i){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,n,i)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}};var z_=class{model;constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new iR(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new Tp(t,n)}onModelLinesInserted(e,t,n,i){return new Lp(t,n)}onModelLineChanged(e,t,n){return[!1,new Zg(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,n){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){let n=t-e+1,i=new Array(n);for(let r=0;r<n;r++)i[r]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.tokenization.getLineTokens(e),n=t.getLineContent();return new xc(n,!1,1,n.length+1,0,t.inflate(),null)}getViewLinesData(e,t,n){let i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let r=[];for(let s=e;s<=t;s++){let a=s-e;r[a]=n[a]?this.getViewLineData(s):null}return r}getDecorationsInRange(e,t,n,i,r){return this.model.getDecorationsInRange(e,t,n,i,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}},iR=class{_lines;constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){let t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}modelRangeIsVisible(e){let t=this._lines.model.getLineCount();return!(e.startLineNumber<1||e.startLineNumber>t||e.endLineNumber<1||e.endLineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}};var K_=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(e,t,n,i,r){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){let t=e.id,n=this._decorationsCache[t];if(!n){let i=e.range,r=e.options,s;if(r.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new M(i.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new M(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)),1);s=new w(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(i,1);n=new kp(s,r),this._decorationsCache[t]=n}return n}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,n=!1){let i=new w(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(i,t,n).inlineDecorations[0]}_getDecorationsInRange(e,t,n){let i=this._linesCollection.getDecorationsInRange(e,this.editorId,dc(this.configuration.options),t,n),r=e.startLineNumber,s=e.endLineNumber,a=[],l=0,d=[];for(let c=r;c<=s;c++)d[c-r]=[];for(let c=0,u=i.length;c<u;c++){let p=i[c],m=p.options;if(!R9(this.model,p))continue;let f=this._getOrCreateViewModelDecoration(p),g=f.range;if(a[l++]=f,m.inlineClassName){let b=new _c(g,m.inlineClassName,m.inlineClassNameAffectsLetterSpacing?3:0),v=Math.max(r,g.startLineNumber),I=Math.min(s,g.endLineNumber);for(let C=v;C<=I;C++)d[C-r].push(b)}if(m.beforeContentClassName&&r<=g.startLineNumber&&g.startLineNumber<=s){let b=new _c(new w(g.startLineNumber,g.startColumn,g.startLineNumber,g.startColumn),m.beforeContentClassName,1);d[g.startLineNumber-r].push(b)}if(m.afterContentClassName&&r<=g.endLineNumber&&g.endLineNumber<=s){let b=new _c(new w(g.endLineNumber,g.endColumn,g.endLineNumber,g.endColumn),m.afterContentClassName,2);d[g.endLineNumber-r].push(b)}}return{decorations:a,inlineDecorations:d}}};function R9(o,e){return!(e.options.hideInCommentTokens&&M9(o,e)||e.options.hideInStringTokens&&P9(o,e))}function M9(o,e){return pW(o,e.range,t=>t===1)}function P9(o,e){return pW(o,e.range,t=>t===2)}function pW(o,e,t){for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let i=o.tokenization.getLineTokens(n),r=n===e.startLineNumber,s=n===e.endLineNumber,a=r?i.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<i.getCount()&&!(s&&i.getStartOffset(a)>e.endColumn-1);){if(!t(i.getStandardTokenType(a)))return!1;a++}}return!0}var su=3,G_=class{lanes;persist=0;_requiredLanes=1;constructor(e){this.lanes=new Uint8Array(Math.ceil((e+1)*su/8))}reset(e){let t=Math.ceil((e+1)*su/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,n){n&&(this.persist|=1<<e-1);for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let r=su*i+(e-1);this.lanes[r>>>3]|=1<<r%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(i))}}getLanesAtLine(e){let t=[],n=su*e;for(let i=0;i<su;i++)(this.persist&1<<i||this.lanes[n>>>3]&1<<n%8)&&t.push(i+1),n++;return t.length?t:[2]}countAtLine(e){let t=su*e,n=0;for(let i=0;i<su;i++)(this.persist&1<<i||this.lanes[t>>>3]&1<<t%8)&&n++,t++;return n}};var N9=!0,$_=class extends V{constructor(t,n,i,r,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=t,this._configuration=n,this.model=i,this._eventDispatcher=new v_,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new $a(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new dn(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=oR.create(this.model),this.glyphLanes=new G_(0),N9&&this.model.isTooLargeForTokenization())this._lines=new z_(this.model);else{let p=this._configuration.options,m=p.get(51),f=p.get(141),g=p.get(148),b=p.get(140),v=p.get(131);this._lines=new V_(this._editorId,this.model,r,s,m,this.model.getOptions().tabSize,f,g.wrappingColumn,b,v)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new M_(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new O_(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(p=>{p.scrollTopChanged&&this._handleVisibleLinesChanged(),p.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new RI(p)),this._eventDispatcher.emitOutgoingEvent(new C_(p.oldScrollWidth,p.oldScrollLeft,p.oldScrollHeight,p.oldScrollTop,p.scrollWidth,p.scrollLeft,p.scrollHeight,p.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(p=>{this._eventDispatcher.emitOutgoingEvent(p)})),this._decorations=new K_(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(p=>{try{let m=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(m,p)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(Xh.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new NI)})),this._register(this._themeService.onDidColorThemeChange(p=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new MI(p))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let t=this.viewLayout.getLinesViewportData(),n=new w(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(n)}visibleLinesStabilized(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){let t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new DI(t)),this._eventDispatcher.emitOutgoingEvent(new I_(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new EI)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new wI)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let t=new M(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),n=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new j_(n,this._viewportStart.startLineDelta)}return new j_(null,0)}_onConfigurationChanged(t,n){let i=this._captureStableViewport(),r=this._configuration.options,s=r.get(51),a=r.get(141),l=r.get(148),d=r.get(140),c=r.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(t.emitViewEvent(new Cc),t.emitViewEvent(new Sc),t.emitViewEvent(new ea(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),n.hasChanged(93)&&(this._decorations.reset(),t.emitViewEvent(new ea(null))),n.hasChanged(100)&&(this._decorations.reset(),t.emitViewEvent(new ea(null))),t.emitViewEvent(new TI(n)),this.viewLayout.onConfigurationChanged(n),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),$a.shouldRecreate(n)&&(this.cursorConfig=new $a(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(t=>{try{let i=this._eventDispatcher.beginEmitViewEvents(),r=!1,s=!1,a=t instanceof td?t.rawContentChangedEvent.changes:t.changes,l=t instanceof td?t.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let p of a)switch(p.changeType){case 4:{for(let m=0;m<p.detail.length;m++){let f=p.detail[m],g=p.injectedTexts[m];g&&(g=g.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(f,g,null)}break}case 2:{let m=null;p.injectedText&&(m=p.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),d.addRequest(p.detail,m,null);break}}let c=d.finalize(),u=new ji(c);for(let p of a)switch(p.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new Cc),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),r=!0;break}case 3:{let m=this._lines.onModelLinesDeleted(l,p.fromLineNumber,p.toLineNumber);m!==null&&(i.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber)),r=!0;break}case 4:{let m=u.takeCount(p.detail.length),f=this._lines.onModelLinesInserted(l,p.fromLineNumber,p.toLineNumber,m);f!==null&&(i.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),r=!0;break}case 2:{let m=u.dequeue(),[f,g,b,v]=this._lines.onModelLineChanged(l,p.lineNumber,m);s=f,g&&i.emitViewEvent(g),b&&(i.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),v&&(i.emitViewEvent(v),this.viewLayout.onLinesDeleted(v.fromLineNumber,v.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!r&&s&&(i.emitViewEvent(new Sc),i.emitViewEvent(new ea(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){let i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){let r=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let i=this._eventDispatcher.beginEmitViewEvents();t instanceof td&&i.emitOutgoingEvent(new D_(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(t=>{let n=[];for(let i=0,r=t.ranges.length;i<r;i++){let s=t.ranges[i],a=this.coordinatesConverter.convertModelPositionToViewPosition(new M(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new M(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;n[i]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new PI(n)),this._eventDispatcher.emitOutgoingEvent(new R_(t))})),this._register(this.model.onDidChangeLanguageConfiguration(t=>{this._eventDispatcher.emitSingleViewEvent(new kI),this.cursorConfig=new $a(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new L_(t))})),this._register(this.model.onDidChangeLanguage(t=>{this.cursorConfig=new $a(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new T_(t))})),this._register(this.model.onDidChangeOptions(t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new Cc),n.emitViewEvent(new Sc),n.emitViewEvent(new ea(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new $a(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new k_(t))})),this._register(this.model.onDidChangeDecorations(t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new ea(t)),this._eventDispatcher.emitOutgoingEvent(new w_(t))}))}hiddenAreasModel=new sR;previousHiddenAreas=[];setHiddenAreas(t,n){this.hiddenAreasModel.setHiddenAreas(n,t);let i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;let r=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(a.emitViewEvent(new Cc),a.emitViewEvent(new Sc),a.emitViewEvent(new ea(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=r.viewportStartModelPosition?.lineNumber;l&&i.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||r.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new x_)}getVisibleRangesPlusViewportAboveBelow(){let t=this._configuration.options.get(147),n=this._configuration.options.get(68),i=Math.max(20,Math.round(t.height/n)),r=this.viewLayout.getLinesViewportData(),s=Math.max(1,r.completelyVisibleStartLineNumber-i),a=Math.min(this.getLineCount(),r.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new w(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){let n=this.coordinatesConverter.convertViewRangeToModelRange(t),i=this._lines.getHiddenAreas();if(i.length===0)return[n];let r=[],s=0,a=n.startLineNumber,l=n.startColumn,d=n.endLineNumber,c=n.endColumn;for(let u=0,p=i.length;u<p;u++){let m=i[u].startLineNumber,f=i[u].endLineNumber;f<a||m>d||(a<m&&(r[s++]=new w(a,l,m-1,this.model.getLineMaxColumn(m-1))),a=f+1,l=1)}return(a<d||a===d&&l<c)&&(r[s++]=new w(a,l,d,c)),r}getCompletelyVisibleViewRange(){let t=this.viewLayout.getLinesViewportData(),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new w(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(t){let n=this.viewLayout.getLinesViewportDataAtScrollTop(t),i=n.completelyVisibleStartLineNumber,r=n.completelyVisibleEndLineNumber;return new w(i,this.getLineMinColumn(i),r,this.getLineMaxColumn(r))}saveState(){let t=this.viewLayout.saveState(),n=t.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(n),r=this.coordinatesConverter.convertViewPositionToModelPosition(new M(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-n;return{scrollLeft:t.scrollLeft,firstPosition:r,firstPositionDeltaTop:s}}reduceRestoreState(t){if(typeof t.firstPosition>"u")return this._reduceRestoreStateCompatibility(t);let n=this.model.validatePosition(t.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(n),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:r}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,n,i){this._viewportStart.update(this,t)}getActiveIndentGuide(t,n,i){return this._lines.getActiveIndentGuide(t,n,i)}getLinesIndentGuides(t,n){return this._lines.getViewLinesIndentGuides(t,n)}getBracketGuidesInRangeByLine(t,n,i,r){return this._lines.getViewLinesBracketGuides(t,n,i,r)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){let n=zt(this.getLineContent(t));return n===-1?0:n+1}getLineLastNonWhitespaceColumn(t){let n=qo(this.getLineContent(t));return n===-1?0:n+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,n){let r=this._decorations.getDecorationsViewportData(t).inlineDecorations[n-t.startLineNumber];return this._getViewLineRenderingData(n,r)}getViewLineRenderingData(t){let n=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,n)}_getViewLineRenderingData(t,n){let i=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(t);return a.inlineDecorations&&(n=[...n,...a.inlineDecorations.map(l=>l.toInlineDecoration(t))]),new FI(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,i,r,a.tokens,n,s,a.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,n,i){let r=this._lines.getViewLinesData(t,n,i);return new AI(this.getTabSize(),r)}getAllOverviewRulerDecorations(t){let n=this.model.getOverviewRulerDecorations(this._editorId,dc(this._configuration.options)),i=new rR;for(let r of n){let s=r.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(t.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.startLineNumber,r.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.endLineNumber,r.range.endColumn);i.accept(d,s.zIndex,c,u,l)}return i.asArray}_invalidateDecorationsColorCache(){let t=this.model.getOverviewRulerDecorations();for(let n of t)n.options.overviewRuler?.invalidateCachedColor(),n.options.minimap?.invalidateCachedColor()}getValueInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(i,n)}getValueLengthInRange(t,n){let i=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(i,n)}modifyPosition(t,n){let i=this.coordinatesConverter.convertViewPositionToModelPosition(t),r=this.model.modifyPosition(i,n);return this.coordinatesConverter.convertModelPositionToViewPosition(r)}deduceModelPositionRelativeToViewPosition(t,n,i){let r=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(n<0?n-=i:n+=i);let a=this.model.getOffsetAt(r)+n;return this.model.getPositionAt(a)}getPlainTextToCopy(t,n,i){let r=i?`\r
`:this.model.getEOL();t=t.slice(0),t.sort(w.compareRangesUsingStarts);let s=!1,a=!1;for(let d of t)d.isEmpty()?s=!0:a=!0;if(!a){if(!n)return"";let d=t.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+r);return c}if(s&&n){let d=[],c=0;for(let u of t){let p=u.startLineNumber;u.isEmpty()?p!==c&&d.push(this.model.getLineContent(p)):d.push(this.model.getValueInRange(u,i?2:0)),c=p}return d.length===1?d[0]:d}let l=[];for(let d of t)d.isEmpty()||l.push(this.model.getValueInRange(d,i?2:0));return l.length===1?l[0]:l}getRichTextToCopy(t,n){let i=this.model.getLanguageId();if(i===ir||t.length!==1)return null;let r=t[0];if(r.isEmpty()){if(!n)return null;let u=r.startLineNumber;r=new w(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===no.fontFamily,c;return d?c=no.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${no.fontFamily}`),{mode:i,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(r,a)+"</div>"}}_getHTMLToCopy(t,n){let i=t.startLineNumber,r=t.startColumn,s=t.endLineNumber,a=t.endColumn,l=this.getTabSize(),d="";for(let c=i;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),p=u.getLineContent(),m=c===i?r-1:0,f=c===s?a-1:p.length;p===""?d+="<br>":d+=cW(p,u.inflate(),n,m,f,l,ct)}return d}_getColorMap(){let t=ro.getColorMap(),n=["#000000"];if(t)for(let i=1,r=t.length;i<r;i++)n[i]=G.Format.CSS.formatHex(t[i]);return n}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,n,i){return this._withViewEventsCollector(r=>this._cursor.setStates(r,t,n,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,n,i=0){this._withViewEventsCollector(r=>this._cursor.setSelections(r,t,n,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector(n=>this._cursor.restoreState(n,t))}_executeCursorEdit(t){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new E_);return}this._withViewEventsCollector(t)}executeEdits(t,n,i){this._executeCursorEdit(r=>this._cursor.executeEdits(r,t,n,i))}startComposition(){this._executeCursorEdit(t=>this._cursor.startComposition(t))}endComposition(t){this._executeCursorEdit(n=>this._cursor.endComposition(n,t))}type(t,n){this._executeCursorEdit(i=>this._cursor.type(i,t,n))}compositionType(t,n,i,r,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,t,n,i,r,s))}paste(t,n,i,r){this._executeCursorEdit(s=>this._cursor.paste(s,t,n,i,r))}cut(t){this._executeCursorEdit(n=>this._cursor.cut(n,t))}executeCommand(t,n){this._executeCursorEdit(i=>this._cursor.executeCommand(i,t,n))}executeCommands(t,n){this._executeCursorEdit(i=>this._cursor.executeCommands(i,t,n))}revealAllCursors(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealAll(r,t,i,0,n,0))}revealPrimaryCursor(t,n,i=!1){this._withViewEventsCollector(r=>this._cursor.revealPrimary(r,t,i,0,n,0))}revealTopMostCursor(t){let n=this._cursor.getTopMostViewPosition(),i=new w(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new ja(t,!1,i,null,0,!0,0)))}revealBottomMostCursor(t){let n=this._cursor.getBottomMostViewPosition(),i=new w(n.lineNumber,n.column,n.lineNumber,n.column);this._withViewEventsCollector(r=>r.emitViewEvent(new ja(t,!1,i,null,0,!0,0)))}revealRange(t,n,i,r,s){this._withViewEventsCollector(a=>a.emitViewEvent(new ja(t,!1,i,null,r,n,s)))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new OI),this._eventDispatcher.emitOutgoingEvent(new S_))}_withViewEventsCollector(t){return this._transactionalTarget.batchChanges(()=>{try{let n=this._eventDispatcher.beginEmitViewEvents();return t(n)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(t){this._withViewEventsCollector(()=>{t()})}normalizePosition(t,n){return this._lines.normalizePosition(t,n)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}},oR=class o{constructor(e,t,n,i,r){this._model=e;this._viewLineNumber=t;this._isValid=n;this._modelTrackedRange=i;this._startLineDelta=r}static create(e){let t=e._setTrackedRange(null,new w(1,1,1,1),1);return new o(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){let n=e.coordinatesConverter.convertViewPositionToModelPosition(new M(t,e.getLineMinColumn(t))),i=e.model._setTrackedRange(this._modelTrackedRange,new w(n.lineNumber,n.column,n.lineNumber,n.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),s=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=i,this._startLineDelta=s-r}invalidate(){this._isValid=!1}},rR=class{_asMap=Object.create(null);asArray=[];accept(e,t,n,i,r){let s=this._asMap[e];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===r&&d+1>=n){i>d&&(a[a.length-1]=i);return}a.push(r,n,i)}else{let a=new Ec(e,t,[r,n,i]);this._asMap[e]=a,this.asArray.push(a)}}},sR=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(e,t){let n=this.hiddenAreas.get(e);n&&hW(n,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let e=Array.from(this.hiddenAreas.values()).reduce((t,n)=>O9(t,n),[]);return hW(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}};function O9(o,e){let t=[],n=0,i=0;for(;n<o.length&&i<e.length;){let r=o[n],s=e[i];if(r.endLineNumber<s.startLineNumber-1)t.push(o[n++]);else if(s.endLineNumber<r.startLineNumber-1)t.push(e[i++]);else{let a=Math.min(r.startLineNumber,s.startLineNumber),l=Math.max(r.endLineNumber,s.endLineNumber);t.push(new w(a,1,l,1)),n++,i++}}for(;n<o.length;)t.push(o[n++]);for(;i<e.length;)t.push(e[i++]);return t}function hW(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].equalsRange(e[t]))return!1;return!0}var j_=class{constructor(e,t){this.viewportStartModelPosition=e;this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;let n=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),i=t.getVerticalOffsetForLineNumber(n.lineNumber);t.setScrollPosition({scrollTop:i+this.startLineDelta},1)}};var Tr=class extends V{constructor(t,n,i,r,s,a,l,d,c,u,p,m){super();this.languageConfigurationService=p;s.willCreateCodeEditor();let f={...n};this._domElement=t,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++A9,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?Fn.SimpleEditorContext:Fn.EditorContext),f,u)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);let I=this._configuration.options;if(v.hasChanged(147)){let C=I.get(147);this._onDidLayoutChange.fire(C)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new dR(this,this._contextKeyService)),this._register(new cR(this,this._contextKeyService,m)),this._instantiationService=this._register(r.createChild(new ay([Rt,this._contextKeyService]))),this._modelData=null,this._focusTracker=new uR(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let g;Array.isArray(i.contributions)?g=i.contributions:g=Tc.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(let v of Tc.getEditorActions()){if(this._actions.has(v.id)){We(new Error(`Cannot have two actions with the same id ${v.id}`));continue}let I=new f_(v.id,v.label,v.alias,v.metadata,v.precondition??void 0,C=>this._instantiationService.invokeFunction(S=>Promise.resolve(v.runEditorCommand(S,this,C))),this._contextKeyService);this._actions.set(I.id,I)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new Hv(this._domElement,{onDragOver:v=>{if(!b())return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this.showDropIndicatorAt(I.position)},onDrop:async v=>{if(!b()||(this.removeDropIndicator(),!v.dataTransfer))return;let I=this.getTargetAtClientPoint(v.clientX,v.clientY);I?.position&&this._onDropIntoEditor.fire({position:I.position,event:v})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=En.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=SM();_contributions=this._register(new g_);_onDidDispose=this._register(new L);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new L({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new Gn(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new q_({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new q_({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new Gn(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new Gn(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new Gn(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new Gn(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new Gn(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new Gn(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new Gn(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new Gn(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new Gn(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new Gn(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new L({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new L);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new L);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(t){this._modelData?.view.writeScreenReaderContent(t)}_createConfiguration(t,n,i,r){return new Ju(t,n,i,this._domElement,r)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return zg.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?Pp.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),t):null}getValue(t=null){if(!this._modelData)return"";let n=!!(t&&t.preserveBOM),i=0;return t&&t.lineEnding&&t.lineEnding===`
`?i=1:t&&t.lineEnding&&t.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,n)}setValue(t){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(t)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){try{this._beginUpdate();let n=t;if(this._modelData===null&&n===null||this._modelData&&this._modelData.model===n)return;let i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:n?.uri||null};this._onWillChangeModel.fire(i);let r=this.hasTextFocus(),s=this._detachModel();this._attachModel(n),r&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let t in this._decorationTypeSubtypes){let n=this._decorationTypeSubtypes[t];for(let i in n)this._removeDecorationType(t+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,n,i,r){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,r)}getTopForLineNumber(t,n=!1){return this._modelData?Tr._getVerticalOffsetForPosition(this._modelData,t,1,n):-1}getTopForPosition(t,n){return this._modelData?Tr._getVerticalOffsetForPosition(this._modelData,t,n,!1):-1}static _getVerticalOffsetForPosition(t,n,i,r=!1){let s=t.model.validatePosition({lineNumber:n,column:i}),a=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,r)}getBottomForLineNumber(t,n=!1){if(!this._modelData)return-1;let i=this._modelData.model.getLineMaxColumn(t);return Tr._getVerticalOffsetAfterPosition(this._modelData,t,i,n)}setHiddenAreas(t,n){this._modelData?.viewModel.setHiddenAreas(t.map(i=>w.lift(i)),n)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Ct.visibleColumnFromColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)+1}getStatusbarColumn(t){if(!this._modelData)return t.column;let n=this._modelData.model.validatePosition(t),i=this._modelData.model.getOptions().tabSize;return Ct.toStatusbarColumn(this._modelData.model.getLineContent(n.lineNumber),n.column,i)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,n="api"){if(this._modelData){if(!M.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,n,i,r){if(!this._modelData)return;if(!w.isIRange(t))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(t),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,a,n,r)}revealLine(t,n=0){this._revealLine(t,0,n)}revealLineInCenter(t,n=0){this._revealLine(t,1,n)}revealLineInCenterIfOutsideViewport(t,n=0){this._revealLine(t,2,n)}revealLineNearTop(t,n=0){this._revealLine(t,5,n)}_revealLine(t,n,i){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new w(t,1,t,1),n,!1,i)}revealPosition(t,n=0){this._revealPosition(t,0,!0,n)}revealPositionInCenter(t,n=0){this._revealPosition(t,1,!0,n)}revealPositionInCenterIfOutsideViewport(t,n=0){this._revealPosition(t,2,!0,n)}revealPositionNearTop(t,n=0){this._revealPosition(t,5,!0,n)}_revealPosition(t,n,i,r){if(!M.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new w(t.lineNumber,t.column,t.lineNumber,t.column),n,i,r)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,n="api"){let i=Me.isISelection(t),r=w.isIRange(t);if(!i&&!r)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(t,n);else if(r){let s={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(s,n)}}_setSelectionImpl(t,n){if(!this._modelData)return;let i=new Me(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(n,[i])}revealLines(t,n,i=0){this._revealLines(t,n,0,i)}revealLinesInCenter(t,n,i=0){this._revealLines(t,n,1,i)}revealLinesInCenterIfOutsideViewport(t,n,i=0){this._revealLines(t,n,2,i)}revealLinesNearTop(t,n,i=0){this._revealLines(t,n,5,i)}_revealLines(t,n,i,r){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid arguments");this._sendRevealRange(new w(t,1,n,1),i,!1,r)}revealRange(t,n=0,i=!1,r=!0){this._revealRange(t,i?1:0,r,n)}revealRangeInCenter(t,n=0){this._revealRange(t,1,!0,n)}revealRangeInCenterIfOutsideViewport(t,n=0){this._revealRange(t,2,!0,n)}revealRangeNearTop(t,n=0){this._revealRange(t,5,!0,n)}revealRangeNearTopIfOutsideViewport(t,n=0){this._revealRange(t,6,!0,n)}revealRangeAtTop(t,n=0){this._revealRange(t,3,!0,n)}_revealRange(t,n,i,r){if(!w.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(w.lift(t),n,i,r)}setSelections(t,n="api",i=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let r=0,s=t.length;r<s;r++)if(!Me.isISelection(t[r]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(n,t,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},n)}}setScrollTop(t,n=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},n)}}setScrollPosition(t,n=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,n)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let t=this._contributions.saveViewState(),n=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:n,viewState:i,contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;let n=t;if(n&&n.cursorState&&n.viewState){let i=n.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(n.contributionsState||{});let r=this._modelData.viewModel.reduceRestoreState(n.viewState);this._modelData.view.restoreState(r)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter(n=>n.isSupported()),t}getAction(t){return this._actions.get(t)||null}trigger(t,n,i){i=i||{};try{switch(this._beginUpdate(),n){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(t);return;case"type":{let s=i;this._type(t,s.text||"");return}case"replacePreviousChar":{let s=i;this._compositionType(t,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=i;this._compositionType(t,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=i;this._paste(t,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(t);return}let r=this.getAction(n);if(r){Promise.resolve(r.run(i)).then(void 0,We);return}if(!this._modelData||this._triggerEditorCommand(t,n,i))return;this._triggerCommand(n,i)}finally{this._endUpdate()}}_triggerCommand(t,n){this._commandService.executeCommand(t,n)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,n){!this._modelData||n.length===0||(t==="keyboard"&&this._onWillType.fire(n),this._modelData.viewModel.type(n,t),t==="keyboard"&&this._onDidType.fire(n))}_compositionType(t,n,i,r,s){this._modelData&&this._modelData.viewModel.compositionType(n,i,r,s,t)}_paste(t,n,i,r,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(n,i,r,t);let c=l.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new w(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,n,i){let r=Tc.getEditorCommand(n);return r?(i=i||{},i.source=t,this._instantiationService.invokeFunction(s=>{Promise.resolve(r.runEditorCommand(s,this,i)).then(void 0,We)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(t,n,i){if(!this._modelData||this._configuration.options.get(93))return!1;let r;return i?Array.isArray(i)?r=()=>i:r=i:r=()=>null,this._modelData.viewModel.executeEdits(t,n,r),!0}executeCommand(t,n){this._modelData&&this._modelData.viewModel.executeCommand(n,t)}executeCommands(t,n){this._modelData&&this._modelData.viewModel.executeCommands(n,t)}createDecorationsCollection(t){return new pR(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,dc(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,dc(this._configuration.options)):null}deltaDecorations(t,n){return this._modelData?t.length===0&&n.length===0?t:this._modelData.model.deltaDecorations(t,n,this._id):[]}removeDecorations(t){!this._modelData||t.length===0||this._modelData.model.changeDecorations(n=>{n.deltaDecorations(t,[])})}setDecorationsByType(t,n,i){let r={},s=this._decorationTypeSubtypes[n]||{};this._decorationTypeSubtypes[n]=r;let a=[];for(let d of i){let c=n;if(d.renderOptions){let p=gr(d.renderOptions).toString(16);c=n+"-"+p,!s[p]&&!r[p]&&this._registerDecorationType(t,c,d.renderOptions,n),r[p]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)r[d]||this._removeDecorationType(n+"-"+d);let l=this._decorationTypeKeysToIds[n]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[n]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(t,n){let i=this._decorationTypeSubtypes[t]||{};for(let l in i)this._removeDecorationType(t+"-"+l);this._decorationTypeSubtypes[t]={};let r=En.createDynamic(this._resolveDecorationOptions(t,!1)),s=new Array(n.length);for(let l=0,d=n.length;l<d;l++)s[l]={range:n[l],options:r};let a=this._decorationTypeKeysToIds[t]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[t]=l.deltaDecorations(a,s))}removeDecorationsByType(t){let n=this._decorationTypeKeysToIds[t];n&&this.changeDecorations(i=>i.deltaDecorations(n,[])),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(t)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,n=!1){this._configuration.observeContainer(t),n||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){let n={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(n)}layoutContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(t){let n=t.getId();if(this._contentWidgets.hasOwnProperty(n)){let i=this._contentWidgets[n];delete this._contentWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(t){let n={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(n)}layoutOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(t){let n=t.getId();if(this._overlayWidgets.hasOwnProperty(n)){let i=this._overlayWidgets[n];delete this._overlayWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(t){let n={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=n,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(n)}layoutGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];i.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(t){let n=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(n)){let i=this._glyphMarginWidgets[n];delete this._glyphMarginWidgets[n],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(t)}getTargetAtClientPoint(t,n){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(t,n)}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;let n=this._modelData.model.validatePosition(t),i=this._configuration.options,r=i.get(147),s=Tr._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:i.get(68)}}getOffsetForColumn(t,n){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(t,n)}render(t=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,t)})}setAriaOptions(t){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(t)}applyFontInfo(t){Jt(t,this._configuration.options.get(51))}setBanner(t,n){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=t,this._configuration.setReservedHeight(t?n:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t){this._modelData=null;return}let n=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());let i=t.onBeforeAttached(),r=new $_(this._id,this._configuration,t,m_.create(ge(this._domElement)),b_.create(this._configuration.options),l=>Zn(ge(this._domElement),l),this.languageConfigurationService,this._themeService,i,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});n.push(t.onWillDispose(()=>this.setModel(null))),n.push(r.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let p=this.getOption(81),m=h("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",p);this._notificationService.prompt(hC.Warning,m,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:h("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let p=0,m=l.selections.length;p<m;p++)d[p]=l.selections[p].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(r);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new lR(t,r,s,a,n,i)}_createView(t){let n;this.isSimpleWidget?n={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:n={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let i=new Uh(t.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new nm(n,this._configuration,this._themeService.getColorTheme(),t,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let t=this._modelData.model,n=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),n&&this._domElement.contains(n)&&n.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),t}_registerDecorationType(t,n,i,r){this._codeEditorService.registerDecorationType(t,n,i,r,this)}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}_resolveDecorationOptions(t,n){return this._codeEditorService.resolveDecorationOptions(t,n)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){let n=[{range:new w(t.lineNumber,t.column,t.lineNumber,t.column),options:Tr.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(n),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,n){this._contextKeyService.createKey(t,n)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};Tr=K([D(3,dt),D(4,ta),D(5,qr),D(6,Rt),D(7,os),D(8,ds),D(9,Vi),D(10,Dn),D(11,_r)],Tr);var A9=0,lR=class{constructor(e,t,n,i,r,s){this.model=e;this.viewModel=t;this.view=n;this.hasRealView=i;this.listenersToRemove=r;this.attachedView=s}dispose(){yt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var q_=class extends V{constructor(t){super();this._emitterOptions=t;this._value=0}_onDidChangeToTrue=this._register(new L(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new L(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(t){let n=t?2:1;this._value!==n&&(this._value=n,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},Gn=class extends L{constructor(t,n){super({deliveryQueue:n});this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}},dR=class extends V{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=ie.editorSimpleInput.bindTo(t),this._editorFocus=ie.focus.bindTo(t),this._textInputFocus=ie.textInputFocus.bindTo(t),this._editorTextFocus=ie.editorTextFocus.bindTo(t),this._tabMovesFocus=ie.tabMovesFocus.bindTo(t),this._editorReadonly=ie.readOnly.bindTo(t),this._inDiffEditor=ie.inDiffEditor.bindTo(t),this._editorColumnSelection=ie.columnSelection.bindTo(t),this._hasMultipleSelections=ie.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=ie.hasNonEmptySelection.bindTo(t),this._canUndo=ie.canUndo.bindTo(t),this._canRedo=ie.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(Zu.onDidChangeTabFocus(n=>this._tabMovesFocus.set(n))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let e=this._editor.getOptions();this._tabMovesFocus.set(Zu.getTabFocusMode()),this._editorReadonly.set(e.get(93)),this._inDiffEditor.set(e.get(62)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){let e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}},cR=class extends V{constructor(t,n,i){super();this._editor=t;this._contextKeyService=n;this._languageFeaturesService=i;this._langId=ie.languageId.bindTo(n),this._hasCompletionItemProvider=ie.hasCompletionItemProvider.bindTo(n),this._hasCodeActionsProvider=ie.hasCodeActionsProvider.bindTo(n),this._hasCodeLensProvider=ie.hasCodeLensProvider.bindTo(n),this._hasDefinitionProvider=ie.hasDefinitionProvider.bindTo(n),this._hasDeclarationProvider=ie.hasDeclarationProvider.bindTo(n),this._hasImplementationProvider=ie.hasImplementationProvider.bindTo(n),this._hasTypeDefinitionProvider=ie.hasTypeDefinitionProvider.bindTo(n),this._hasHoverProvider=ie.hasHoverProvider.bindTo(n),this._hasDocumentHighlightProvider=ie.hasDocumentHighlightProvider.bindTo(n),this._hasDocumentSymbolProvider=ie.hasDocumentSymbolProvider.bindTo(n),this._hasReferenceProvider=ie.hasReferenceProvider.bindTo(n),this._hasRenameProvider=ie.hasRenameProvider.bindTo(n),this._hasSignatureHelpProvider=ie.hasSignatureHelpProvider.bindTo(n),this._hasInlayHintsProvider=ie.hasInlayHintsProvider.bindTo(n),this._hasDocumentFormattingProvider=ie.hasDocumentFormattingProvider.bindTo(n),this._hasDocumentSelectionFormattingProvider=ie.hasDocumentSelectionFormattingProvider.bindTo(n),this._hasMultipleDocumentFormattingProvider=ie.hasMultipleDocumentFormattingProvider.bindTo(n),this._hasMultipleDocumentSelectionFormattingProvider=ie.hasMultipleDocumentSelectionFormattingProvider.bindTo(n),this._isInEmbeddedEditor=ie.isInEmbeddedEditor.bindTo(n);let r=()=>this._update();this._register(t.onDidChangeModel(r)),this._register(t.onDidChangeModelLanguage(r)),this._register(i.completionProvider.onDidChange(r)),this._register(i.codeActionProvider.onDidChange(r)),this._register(i.codeLensProvider.onDidChange(r)),this._register(i.definitionProvider.onDidChange(r)),this._register(i.declarationProvider.onDidChange(r)),this._register(i.implementationProvider.onDidChange(r)),this._register(i.typeDefinitionProvider.onDidChange(r)),this._register(i.hoverProvider.onDidChange(r)),this._register(i.documentHighlightProvider.onDidChange(r)),this._register(i.documentSymbolProvider.onDidChange(r)),this._register(i.referenceProvider.onDidChange(r)),this._register(i.renameProvider.onDidChange(r)),this._register(i.documentFormattingEditProvider.onDidChange(r)),this._register(i.documentRangeFormattingEditProvider.onDidChange(r)),this._register(i.signatureHelpProvider.onDidChange(r)),this._register(i.inlayHintsProvider.onDidChange(r)),r()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let t=this._editor.getModel();if(!t){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===Ie.walkThroughSnippet||t.uri.scheme===Ie.vscodeChatCodeBlock)})}},uR=class extends V{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new L);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(e,t){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register($d(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register($d(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},pR=class{constructor(e,t){this._editor=e;Array.isArray(t)&&t.length>0&&this.set(t)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(e,t,n){return this._editor.onDidChangeModelDecorations(i=>{this._isChangingDecorations||e.call(t,i)},n)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];let e=this._editor.getModel(),t=[];for(let n of this._decorationIds){let i=e.getDecorationRange(n);i&&t.push(i)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(n=>{t=n.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}},F9=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),B9=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function aR(o){return F9+encodeURIComponent(o.toString())+B9}var W9=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),V9=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function H9(o){return W9+encodeURIComponent(o.toString())+V9}zi((o,e)=>{let t=o.getColor(jg);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${aR(t)}") repeat-x bottom left; }`);let n=o.getColor(Ir);n&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${aR(n)}") repeat-x bottom left; }`);let i=o.getColor(ns);i&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${aR(i)}") repeat-x bottom left; }`);let r=o.getColor(CO);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${H9(r)}") no-repeat bottom left; }`);let s=o.getColor(PF);s&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});var im=class extends Tr{_parentEditor;_overwriteOptions;constructor(e,t,n,i,r,s,a,l,d,c,u,p,m){super(e,{...i.getRawOptions(),overflowWidgetsDomNode:i.getOverflowWidgetsDomNode()},n,r,s,a,l,d,c,u,p,m),this._parentEditor=i,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(i.onDidChangeConfiguration(f=>this._onParentConfigurationChanged(f)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){qv(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};im=K([D(4,dt),D(5,ta),D(6,qr),D(7,Rt),D(8,os),D(9,ds),D(10,Vi),D(11,Dn),D(12,_r)],im);var hR=class extends $r{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new L);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(e,t){super(),this._element=Le(e,xe(".monaco-dropdown")),this._label=Le(this._element,xe(".dropdown-label"));let n=t.labelRenderer;n||(n=r=>(r.textContent=t.label||"",null));for(let r of[Ee.CLICK,Ee.MOUSE_DOWN,ht.Tap])this._register(Y(this.element,r,s=>ot.stop(s,!0)));for(let r of[Ee.MOUSE_DOWN,ht.Tap])this._register(Y(this._label,r,s=>{Gv(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(Y(this._label,Ee.KEY_UP,r=>{let s=new pt(r);(s.equals(3)||s.equals(10))&&(ot.stop(r,!0),this.visible?this.hide():this.show())}));let i=n(this._label);i&&this._register(i),this._register(mn.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(e){this._label&&(!this.hover&&e!==""?this.hover=this._register(vi().setupManagedHover(an("mouse"),this._label,e)):this.hover&&this.hover.update(e))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(e,t){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},Y_=class extends hR{constructor(t,n){super(t,n);this._options=n;this.actions=n.actions||[]}_menuOptions;_actions=[];set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,n)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,n):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var wb=class extends Ti{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new L);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(e,t,n,i=Object.create(null)){super(null,e,i),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=i,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=r=>{this.element=Le(r,xe("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(vi().setupManagedHover(this.options.hoverDelegate??an("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},n=Array.isArray(this.menuActionsOrProvider),i={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:n?this.menuActionsOrProvider:void 0,actionProvider:n?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new Y_(e,i)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{this.element?.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let r=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return r.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){let e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}};var mW=j("contextViewService"),X_=j("contextMenuService");var Qzt={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:G.white.toString(),buttonForeground:G.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0};function G9(o,e){let t={...e};for(let n in o){let i=o[n];t[n]=i!==void 0?ne(i):void 0}return t}var S6t={keybindingLabelBackground:ne(lA),keybindingLabelForeground:ne(dA),keybindingLabelBorder:ne(cA),keybindingLabelBottomBorder:ne(uA),keybindingLabelShadow:ne(Cp)};var x6t={buttonForeground:ne(n1),buttonSeparator:ne(qO),buttonBackground:ne(Sp),buttonHoverBackground:ne(YO),buttonSecondaryForeground:ne(ZO),buttonSecondaryBackground:ne(yI),buttonSecondaryHoverBackground:ne(QO),buttonBorder:ne(XO)};var _6t={progressBarBackground:ne(pO)};var $9={inputActiveOptionBorder:ne(JL),inputActiveOptionForeground:ne(t1),inputActiveOptionBackground:ne(e1)},E6t={activeForeground:ne(xp),activeBackground:ne(JO),activeBorder:ne(eA),inactiveForeground:ne(tA),inactiveBackground:ne(nA),inactiveBorder:ne(iA),inactiveHoverBackground:ne(oA)};var w6t={checkboxBackground:ne(rA),checkboxBorder:ne(aA),checkboxForeground:ne(sA)};var T6t={dialogBackground:ne(bi),dialogForeground:ne(Ic),dialogShadow:ne(Cp),dialogBorder:ne(Je),errorIconForeground:ne(DO),warningIconForeground:ne(kO),infoIconForeground:ne(RO),textLinkForeground:ne(cO)};var j9={inputBackground:ne(OO),inputForeground:ne(AO),inputBorder:ne(FO),inputValidationInfoBorder:ne(VO),inputValidationInfoBackground:ne(BO),inputValidationInfoForeground:ne(WO),inputValidationWarningBorder:ne(zO),inputValidationWarningBackground:ne(HO),inputValidationWarningForeground:ne(UO),inputValidationErrorBorder:ne($O),inputValidationErrorBackground:ne(KO),inputValidationErrorForeground:ne(GO)};var L6t={listFilterWidgetBackground:ne(_A),listFilterWidgetOutline:ne(EA),listFilterWidgetNoMatchesOutline:ne(wA),listFilterWidgetShadow:ne(TA),inputBoxStyles:j9,toggleStyles:$9},D6t={badgeBackground:ne(gp),badgeForeground:ne(uO),badgeBorder:ne(Je)};var k6t={breadcrumbsBackground:ne(wO),breadcrumbsForeground:ne(EO),breadcrumbsHoverForeground:ne(XL),breadcrumbsFocusForeground:ne(XL),breadcrumbsFocusAndSelectionForeground:ne(TO)};var q9={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:ne(pA),listFocusForeground:ne(hA),listFocusOutline:ne(mA),listActiveSelectionBackground:ne(Qs),listActiveSelectionForeground:ne(od),listActiveSelectionIconForeground:ne(II),listFocusAndSelectionOutline:ne(gA),listFocusAndSelectionBackground:ne(Qs),listFocusAndSelectionForeground:ne(od),listInactiveSelectionBackground:ne(fA),listInactiveSelectionIconForeground:ne(vA),listInactiveSelectionForeground:ne(bA),listInactiveFocusBackground:ne(yA),listInactiveFocusOutline:ne(IA),listHoverBackground:ne(i1),listHoverForeground:ne(o1),listDropOverBackground:ne(CA),listDropBetweenBackground:ne(SA),listSelectionOutline:ne(Pt),listHoverOutline:ne(Pt),treeIndentGuidesStroke:ne(r1),treeInactiveIndentGuidesStroke:ne(LA),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:ne(Gg),tableColumnsBorder:ne(DA),tableOddRowsBackgroundColor:ne(kA)};function gW(o){return G9(o,q9)}var fW={selectBackground:ne(_p),selectListBackground:ne(jO),selectForeground:ne(qg),decoratorRightForeground:ne(WA),selectBorder:ne(Yg),focusBorder:ne(Po),listFocusBackground:ne(xI),listInactiveSelectionIconForeground:ne(SI),listFocusForeground:ne(CI),listFocusOutline:sO(Pt,G.transparent.toString()),listHoverBackground:ne(i1),listHoverForeground:ne(o1),listHoverOutline:ne(Pt),selectListBorder:ne($g),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var R6t={shadowColor:ne(Cp),borderColor:ne(RA),foregroundColor:ne(MA),backgroundColor:ne(PA),selectionForegroundColor:ne(NA),selectionBackgroundColor:ne(OA),selectionBorderColor:ne(AA),separatorColor:ne(FA),scrollbarShadow:ne(Gg),scrollbarSliderBackground:ne(gI),scrollbarSliderHoverBackground:ne(fI),scrollbarSliderActiveBackground:ne(bI)};var au=class extends md{constructor(t,n,i,r,s,a,l,d){super(void 0,t,{icon:!!(t.class||t.item.icon),label:!t.class&&!t.item.icon,draggable:n?.draggable,keybinding:n?.keybinding,hoverDelegate:n?.hoverDelegate});this._options=n;this._keybindingService=i;this._notificationService=r;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=Vv.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new Wt);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(n){this._notificationService.error(n)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let n=!1,i=()=>{let r=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||n)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&n);r!==this._wantsAltCommand&&(this._wantsAltCommand=r,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(Y(t,"mouseleave",r=>{n=!1,i()})),this._register(Y(t,"mouseenter",r=>{n=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),n=t&&t.getLabel(),i=this._commandAction.tooltip||this._commandAction.label,r=n?h("titleAndKb","{0} ({1})",i,n):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?h("titleAndKb","{0} ({1})",s,l):s;r=h("titleAndKbAndAlt",`{0}
[{1}] {2}`,r,Bf.modifierLabels[fo].altKey,d)}return r}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;let{element:n,label:i}=this;if(!n||!i)return;let r=this._commandAction.checked&&hN(t.toggled)&&t.toggled.icon?t.toggled.icon:t.icon;if(r)if(nt.isThemeIcon(r)){let s=nt.asClassNameArray(r);i.classList.add(...s),this._itemClassDispose.value=Ce(()=>{i.classList.remove(...s)})}else i.style.backgroundImage=a1(this._themeService.getColorTheme().type)?jd(r.dark):jd(r.light),i.classList.add("icon"),this._itemClassDispose.value=Ls(Ce(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};au=K([D(2,Oo),D(3,ds),D(4,Rt),D(5,os),D(6,X_),D(7,Vi)],au);var eE=class o extends au{render(e){this.options.label=!0,this.options.icon=!1,super.render(e),e.classList.add("text-only"),e.classList.toggle("use-comma",this._options?.useComma??!1)}updateLabel(){let e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){let t=o._symbolPrintEnter(e);this._options?.conversational?this.label.textContent=h({key:"content2",comment:['A label with keybindg like "ESC to dismiss"']},"{1} to {0}",this._action.label,t):this.label.textContent=h({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,t)}}static _symbolPrintEnter(e){return e.getLabel()?.replace(/\benter\b/gi,"\u23CE").replace(/\bEscape\b/gi,"Esc")}},Z_=class extends wb{constructor(t,n,i,r,s){let a={...n,menuAsChild:n?.menuAsChild??!1,classNames:n?.classNames??(nt.isThemeIcon(t.item.icon)?nt.asClassName(t.item.icon):void 0),keybindingProvider:n?.keybindingProvider??(l=>i.lookupKeybinding(l.id))};super(t,{getActions:()=>t.actions},r,a);this._keybindingService=i;this._contextMenuService=r;this._themeService=s}render(t){super.render(t),hi(this.element),t.classList.add("menu-entry");let n=this._action,{icon:i}=n.item;if(i&&!nt.isThemeIcon(i)){this.element.classList.add("icon");let r=()=>{this.element&&(this.element.style.backgroundImage=a1(this._themeService.getColorTheme().type)?jd(i.dark):jd(i.light))};r(),this._register(this._themeService.onDidColorThemeChange(()=>{r()}))}}};Z_=K([D(2,Oo),D(3,X_),D(4,os)],Z_);var Q_=class extends Ti{constructor(t,n,i,r,s,a,l,d){super(null,t);this._keybindingService=i;this._notificationService=r;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=n,this._storageKey=`${t.item.submenu.id}_lastActionId`;let c,u=n?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=t.actions.find(m=>u===m.id)),c||(c=t.actions[0]),this._defaultAction=this._instaService.createInstance(au,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let p={keybindingProvider:m=>this._keybindingService.lookupKeybinding(m.id),...n,menuAsChild:n?.menuAsChild??!0,classNames:n?.classNames??["codicon","codicon-chevron-down"],actionRunner:n?.actionRunner??new $r};this._dropdown=new wb(t,t.actions,this._contextMenuService,p),this._register(this._dropdown.actionRunner.onDidRun(m=>{m.action instanceof Yr&&this.update(m.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(t){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(au,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends $r{async runAction(n,i){await n.run(void 0)}},this._container&&this._defaultAction.render(CP(this._container,xe(".action-container")))}_getDefaultActionKeybindingLabel(t){let n;if(this._options?.renderKeybindingWithDefaultActionLabel){let i=this._keybindingService.lookupKeybinding(t.id);i&&(n=`(${i.getLabel()})`)}return n}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let n=xe(".action-container");this._defaultAction.render(Le(this._container,n)),this._register(Y(n,Ee.KEY_DOWN,r=>{let s=new pt(r);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let i=xe(".dropdown-action-container");this._dropdown.render(Le(this._container,i)),this._register(Y(i,Ee.KEY_DOWN,r=>{let s=new pt(r);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};Q_=K([D(2,Oo),D(3,ds),D(4,X_),D(5,Ey),D(6,dt),D(7,kh)],Q_);var J_=class extends FS{constructor(e,t){super(null,e,e.actions.map(n=>({text:n.id===jr.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":n.label,isDisabled:!n.enabled})),0,t,fW,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=ne(Yg)}runAction(e,t){let n=this.action.actions[t];n&&this.actionRunner.run(n)}};J_=K([D(1,mW)],J_);var om=class{constructor(e,t,n,i,r){this._menuId=t;this._menuService=i;this._contextKeyService=r;this.element=Le(e,xe(".suggest-status-bar"));let s=a=>a instanceof Yr?n.createInstance(eE,a,{useComma:!0}):void 0;this._leftActions=new va(this.element,{actionViewItemProvider:s}),this._rightActions=new va(this.element,{actionViewItemProvider:s}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}element;_leftActions;_rightActions;_menuDisposables=new ae;dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){let e=this._menuService.createMenu(this._menuId,this._contextKeyService),t=()=>{let n=[],i=[];for(let[r,s]of e.getActions())r==="left"?n.push(...s):i.push(...s);this._leftActions.clear(),this._leftActions.push(n),this._rightActions.clear(),this._rightActions.push(i)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};om=K([D(2,dt),D(3,Ey),D(4,Rt)],om);var BKt=x("symbolIcon.arrayForeground",Ne,h("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),WKt=x("symbolIcon.booleanForeground",Ne,h("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),VKt=x("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},h("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),HKt=x("symbolIcon.colorForeground",Ne,h("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),UKt=x("symbolIcon.constantForeground",Ne,h("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),zKt=x("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),KKt=x("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},h("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),GKt=x("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),$Kt=x("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},h("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),jKt=x("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),qKt=x("symbolIcon.fileForeground",Ne,h("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),YKt=x("symbolIcon.folderForeground",Ne,h("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),XKt=x("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),ZKt=x("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),QKt=x("symbolIcon.keyForeground",Ne,h("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),JKt=x("symbolIcon.keywordForeground",Ne,h("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),eGt=x("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),tGt=x("symbolIcon.moduleForeground",Ne,h("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),nGt=x("symbolIcon.namespaceForeground",Ne,h("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),iGt=x("symbolIcon.nullForeground",Ne,h("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),oGt=x("symbolIcon.numberForeground",Ne,h("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),rGt=x("symbolIcon.objectForeground",Ne,h("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),sGt=x("symbolIcon.operatorForeground",Ne,h("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),aGt=x("symbolIcon.packageForeground",Ne,h("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),lGt=x("symbolIcon.propertyForeground",Ne,h("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),dGt=x("symbolIcon.referenceForeground",Ne,h("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),cGt=x("symbolIcon.snippetForeground",Ne,h("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),uGt=x("symbolIcon.stringForeground",Ne,h("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),pGt=x("symbolIcon.structForeground",Ne,h("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),hGt=x("symbolIcon.textForeground",Ne,h("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),mGt=x("symbolIcon.typeParameterForeground",Ne,h("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),gGt=x("symbolIcon.unitForeground",Ne,h("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),fGt=x("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));var rm=class{domNode;_onDidWillResize=new L;onDidWillResize=this._onDidWillResize.event;_onDidResize=new L;onDidResize=this._onDidResize.event;_northSash;_eastSash;_southSash;_westSash;_sashListener=new ae;_size=new Dt(0,0);_minSize=new Dt(0,0);_maxSize=new Dt(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);_preferredSize;constructor(){this.domNode=document.createElement("div"),this._eastSash=new qd(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new qd(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new qd(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:"north"}),this._southSash=new qd(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:"south"}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,n=0;this._sashListener.add(de.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,n=0)})),this._sashListener.add(de.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,n=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(i=>{e&&(n=i.currentX-i.startX,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(i=>{e&&(n=-(i.currentX-i.startX),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(i=>{e&&(t=-(i.currentY-i.startY),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(i=>{e&&(t=i.currentY-i.startY,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(de.any(this._eastSash.onDidReset,this._westSash.onDidReset)(i=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(de.any(this._northSash.onDidReset,this._southSash.onDidReset)(i=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,n,i){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=n?3:0,this._westSash.state=i?3:0}layout(e=this.size.height,t=this.size.width){let{height:n,width:i}=this._minSize,{height:r,width:s}=this._maxSize;e=Math.max(n,Math.min(r,e)),t=Math.max(i,Math.min(s,t));let a=new Dt(t,e);Dt.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}};var bW=j("openerService");var Sd=class{constructor(e,t,n){this._options=e;this._languageService=t;this._openerService=n}static _ttpTokenizer=Ph("tokenizeToString",{createHTML(e){return e}});_onDidRenderAsync=new L;onDidRenderAsync=this._onDidRenderAsync.event;dispose(){this._onDidRenderAsync.dispose()}render(e,t,n){if(!e)return{element:document.createElement("span"),dispose:()=>{}};let i=new ae,r=i.add(Yf(e,{...this._getRenderOptions(e,i),...t},n));return r.element.classList.add("rendered-markdown"),{element:r.element,dispose:()=>i.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:async(n,i)=>{let r;n?r=this._languageService.getLanguageIdByLanguageName(n):this._options.editor&&(r=this._options.editor.getModel()?.getLanguageId()),r||(r=ir);let s=await dW(this._languageService,i,r),a=document.createElement("span");if(a.innerHTML=Sd._ttpTokenizer?.createHTML(s)??s,this._options.editor){let l=this._options.editor.getOption(51);Jt(a,l)}else this._options.codeBlockFontFamily&&(a.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(a.style.fontSize=this._options.codeBlockFontSize),a},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:n=>this.openMarkdownLink(n,e),disposables:t}}}async openMarkdownLink(e,t){await Y9(this._openerService,e,t.isTrusted)}};Sd=K([D(1,Hi),D(2,bW)],Sd);async function Y9(o,e,t){try{return await o.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:X9(t)})}catch(n){return We(n),!1}}function X9(o){return o===!0?!0:o&&Array.isArray(o.enabledCommands)?o.enabledCommands:!1}function Tb(o){return!!o&&!!(o.completion.documentation||o.completion.detail&&o.completion.detail!==o.completion.label)}var sm=class{constructor(e,t){this._editor=e;this.domNode=xe(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(Sd,{editor:e}),this._body=xe(".body"),this._scrollbar=new jc(this._body,{alwaysConsumeMouseWheel:!0}),Le(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=Le(this._body,xe(".header")),this._close=Le(this._header,xe("span"+nt.asCSSSelector(ue.close))),this._close.title=h("details.close","Close"),this._close.role="button",this._close.tabIndex=-1,this._type=Le(this._header,xe("p.type")),this._docs=Le(this._body,xe("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(51)&&this._configureFont()}))}domNode;_onDidClose=new L;onDidClose=this._onDidClose.event;_onDidChangeContents=new L;onDidChangeContents=this._onDidChangeContents.event;_close;_scrollbar;_body;_header;_type;_docs;_disposables=new ae;_markdownRenderer;_renderDisposeable=new ae;_borderWidth=1;_size=new Dt(330,0);dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){let e=this._editor.getOptions(),t=e.get(51),n=t.getMassagedFontFamily(),i=e.get(121)||t.fontSize,r=e.get(122)||t.lineHeight,s=t.fontWeight,a=`${i}px`,l=`${r}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${r/i}`,this.domNode.style.fontWeight=s,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=n,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){let e=this._editor.getOption(122)||this._editor.getOption(51).lineHeight,t=this._borderWidth,n=t*2;return{lineHeight:e,borderWidth:t,borderHeight:n,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=h("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){this._renderDisposeable.clear();let{detail:n,documentation:i}=e.completion;if(t){let r="";r+=`score: ${e.score[0]}
`,r+=`prefix: ${e.word??"(no prefix)"}
`,r+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}
`,r+=`distance: ${e.distance} (localityBonus-setting)
`,r+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}
`,r+=`commit_chars: ${e.completion.commitCharacters?.join("")}
`,i=new ny().appendCodeblock("empty",r),n=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!Tb(e)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),n){let r=n.length>1e5?`${n.substr(0,1e5)}\u2026`:n;this._type.textContent=r,this._type.title=r,So(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(r))}else mi(this._type),this._type.title="",eo(this._type),this.domNode.classList.add("no-type");if(mi(this._docs),typeof i=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=i;else if(i){this._docs.classList.add("markdown-docs"),mi(this._docs);let r=this._markdownRenderer.render(i);this._docs.appendChild(r.element),this._renderDisposeable.add(r),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=r=>{r.preventDefault(),r.stopPropagation()},this._close.onclick=r=>{r.preventDefault(),r.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(e,t){let n=new Dt(e,t);Dt.equals(n,this._size)||(this._size=n,hP(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}focus(){this.domNode.focus()}};sm=K([D(1,dt)],sm);var tE=class{constructor(e,t){this.widget=e;this._editor=t;this._resizable=new rm,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let n,i,r=0,s=0;this._disposables.add(this._resizable.onDidWillResize(()=>{n=this._topLeft,i=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(n&&i){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(s=i.width-a.dimension.width,l=!0),a.north&&(r=i.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:n.top+r,left:n.left+s})}a.done&&(n=void 0,i=void 0,r=0,s=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}allowEditorOverflow=!0;_disposables=new ae;_resizable;_added=!1;_anchorBox;_preferAlignAtTop=!0;_userSize;_topLeft;dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e,t){let n=e.getBoundingClientRect();this._anchorBox=n,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,t)}_placeAtAnchor(e,t,n){let i=Gd(this.getDomNode().ownerDocument.body),r=this.widget.getLayoutInfo(),s=new Dt(220,2*r.lineHeight),a=e.top,l=function(){let _=i.width-(e.left+e.width+r.borderWidth+r.horizontalPadding),R=-r.borderWidth+e.left+e.width,N=new Dt(_,i.height-e.top-r.borderHeight-r.verticalPadding),F=N.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:R,fit:_-t.width,maxSizeTop:N,maxSizeBottom:F,minSize:s.with(Math.min(_,s.width))}}(),d=function(){let _=e.left-r.borderWidth-r.horizontalPadding,R=Math.max(r.horizontalPadding,e.left-t.width-r.borderWidth),N=new Dt(_,i.height-e.top-r.borderHeight-r.verticalPadding),F=N.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:R,fit:_-t.width,maxSizeTop:N,maxSizeBottom:F,minSize:s.with(Math.min(_,s.width))}}(),c=function(){let _=e.left,R=-r.borderWidth+e.top+e.height,N=new Dt(e.width-r.borderHeight,i.height-e.top-e.height-r.verticalPadding);return{top:R,left:_,fit:N.height-t.height,maxSizeBottom:N,maxSizeTop:N,minSize:s.with(N.width)}}(),u=[l,d,c],p=u.find(_=>_.fit>=0)??u.sort((_,R)=>R.fit-_.fit)[0],m=e.top+e.height-r.borderHeight,f,g=t.height,b=Math.max(p.maxSizeTop.height,p.maxSizeBottom.height);g>b&&(g=b);let v;n?g<=p.maxSizeTop.height?(f=!0,v=p.maxSizeTop):(f=!1,v=p.maxSizeBottom):g<=p.maxSizeBottom.height?(f=!1,v=p.maxSizeBottom):(f=!0,v=p.maxSizeTop);let{top:I,left:C}=p;!f&&g>e.height&&(I=m-g);let S=this._editor.getDomNode();if(S){let _=S.getBoundingClientRect();I-=_.top,C-=_.left}this._applyTopLeft({left:C,top:I}),this._resizable.enableSashes(!f,p===l,f,p!==l),this._resizable.minSize=p.minSize,this._resizable.maxSize=v,this._resizable.layout(g,Math.min(v.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this._editor.layoutOverlayWidget(this)}};var xd=class o extends V{constructor(t,n){super();this.options=n;this.supportIcons=n?.supportIcons??!1,this.domNode=Le(t,xe("span.monaco-highlighted-label"))}domNode;text="";title="";highlights=[];supportIcons;didEverRender=!1;customHover;get element(){return this.domNode}set(t,n=[],i="",r){t||(t=""),r&&(t=o.escapeNewLines(t,n)),!(this.didEverRender&&this.text===t&&this.title===i&&cn(this.highlights,n))&&(this.text=t,this.title=i,this.highlights=n,this.render())}render(){let t=[],n=0;for(let i of this.highlights){if(i.end===i.start)continue;if(n<i.start){let a=this.text.substring(n,i.start);this.supportIcons?t.push(...Yc(a)):t.push(a),n=i.start}let r=this.text.substring(n,i.end),s=xe("span.highlight",void 0,...this.supportIcons?Yc(r):[r]);i.extraClasses&&s.classList.add(...i.extraClasses),t.push(s),n=i.end}if(n<this.text.length){let i=this.text.substring(n);this.supportIcons?t.push(...Yc(i)):t.push(i)}if(Bu(this.domNode,...t),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){let i=this.options?.hoverDelegate??an("mouse");this.customHover=this._register(vi().setupManagedHover(i,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(t,n){let i=0,r=0;return t.replace(/\r\n|\r|\n/g,(s,a)=>{r=s===`\r
`?-1:0,a+=i;for(let l of n)l.end<=a||(l.start>=a&&(l.start+=r),l.end>=a&&(l.end+=r));return i+=r,"\u23CE"})}};var lu=class{constructor(e){this._element=e}disposed;_textContent;_classNames;_empty;get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||cn(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}},nE=class extends V{creationOptions;domNode;nameContainer;nameNode;descriptionNode;suffixNode;labelContainer;hoverDelegate;customHovers=new Map;constructor(e,t){super(),this.creationOptions=t,this.domNode=this._register(new lu(Le(e,xe(".monaco-icon-label")))),this.labelContainer=Le(this.domNode.element,xe(".monaco-icon-label-container")),this.nameContainer=Le(this.labelContainer,xe("span.monaco-icon-name-container")),t?.supportHighlights||t?.supportIcons?this.nameNode=this._register(new gR(this.nameContainer,!!t.supportIcons)):this.nameNode=new mR(this.nameContainer),this.hoverDelegate=t?.hoverDelegate??an("mouse")}get element(){return this.domNode.element}setLabel(e,t,n){let i=["monaco-icon-label"],r=["monaco-icon-label-container"],s="";n&&(n.extraClasses&&i.push(...n.extraClasses),n.italic&&i.push("italic"),n.strikethrough&&i.push("strikethrough"),n.disabledCommand&&r.push("disabled"),n.title&&(typeof n.title=="string"?s+=n.title:s+=e));let a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(n?.iconPath){let l;!a||!Xn(a)?(l=xe(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=jd(n?.iconPath)}else a&&a.remove();if(this.domNode.classNames=i,this.domNode.element.setAttribute("aria-label",s),this.labelContainer.classList.value="",this.labelContainer.classList.add(...r),this.setupHover(n?.descriptionTitle?this.labelContainer:this.element,n?.title),this.nameNode.setLabel(e,n),t||this.descriptionNode){let l=this.getOrCreateDescriptionNode();l instanceof xd?(l.set(t||"",n?n.descriptionMatches:void 0,void 0,n?.labelEscapeNewLines),this.setupHover(l.element,n?.descriptionTitle)):(l.textContent=t&&n?.labelEscapeNewLines?xd.escapeNewLines(t,[]):t||"",this.setupHover(l.element,n?.descriptionTitle||""),l.empty=!t)}if(n?.suffix||this.suffixNode){let l=this.getOrCreateSuffixNode();l.textContent=n?.suffix??""}}setupHover(e,t){let n=this.customHovers.get(e);if(n&&(n.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover){let r=function(s,a){Lt(a)?s.title=Xw(a):a?.markdownNotSupportedFallback?s.title=a.markdownNotSupportedFallback:s.removeAttribute("title")};var i=r;r(e,t)}else{let r=vi().setupManagedHover(this.hoverDelegate,e,t);r&&this.customHovers.set(e,r)}}dispose(){super.dispose();for(let e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){let e=this._register(new lu(IP(this.nameContainer,xe("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new lu(Le(e.element,xe("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){let e=this._register(new lu(Le(this.labelContainer,xe("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new xd(Le(e.element,xe("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new lu(Le(e.element,xe("span.label-description"))))}return this.descriptionNode}},mR=class{constructor(e){this.container=e}label=void 0;singleLabel=void 0;options;setLabel(e,t){if(!(this.label===e&&cn(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=Le(this.container,xe("a.label-name",{id:t?.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let n=0;n<e.length;n++){let i=e[n],r=t?.domId&&`${t?.domId}_${n}`;Le(this.container,xe("a.label-name",{id:r,"data-icon-label-count":e.length,"data-icon-label-index":n,role:"treeitem"},i)),n<e.length-1&&Le(this.container,xe("span.label-separator",void 0,t?.separator||"/"))}}}};function Z9(o,e,t){if(!t)return;let n=0;return o.map(i=>{let r={start:n,end:n+i.length},s=t.map(a=>Kn.intersect(r,a)).filter(a=>!Kn.isEmpty(a)).map(({start:a,end:l})=>({start:a-n,end:l-n}));return n=r.end+e.length,s})}var gR=class extends V{constructor(t,n){super();this.container=t;this.supportIcons=n}label=void 0;singleLabel=void 0;options;setLabel(t,n){if(!(this.label===t&&cn(this.options,n)))if(this.label=t,this.options=n,typeof t=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new xd(Le(this.container,xe("a.label-name",{id:n?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(t,n?.matches,void 0,n?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;let i=n?.separator||"/",r=Z9(t,i,n?.matches);for(let s=0;s<t.length;s++){let a=t[s],l=r?r[s]:void 0,d=n?.domId&&`${n?.domId}_${s}`,c=xe("a.label-name",{id:d,"data-icon-label-count":t.length,"data-icon-label-index":s,role:"treeitem"});this._register(new xd(Le(this.container,c),{supportIcons:this.supportIcons})).set(a,l,void 0,n?.labelEscapeNewLines),s<t.length-1&&Le(c,xe("span.label-separator",void 0,i))}}}};var J9=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function Lb(o,e,t,n,i){if(nt.isThemeIcon(i))return[`codicon-${i.id}`,"predefined-file-icon"];if(le.isUri(i))return[];let r=n===2?["rootfolder-icon"]:n===1?["folder-icon"]:["file-icon"];if(t){let s;if(t.scheme===Ie.data)s=ku.parseMetaData(t).get(ku.META_DATA_LABEL);else{let a=t.path.match(J9);a?(s=iE(a[2].toLowerCase()),a[1]&&r.push(`${iE(a[1].toLowerCase())}-name-dir-icon`)):s=iE(t.authority.toLowerCase())}if(n===2)r.push(`${s}-root-name-folder-icon`);else if(n===1)r.push(`${s}-name-folder-icon`);else{if(s){if(r.push(`${s}-name-file-icon`),r.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)r.push(`${l.slice(d).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}let a=e8(o,e,t);a&&r.push(`${iE(a)}-lang-file-icon`)}}return r}function e8(o,e,t){if(!t)return null;let n=null;if(t.scheme===Ie.data){let r=ku.parseMetaData(t).get(ku.META_DATA_MIME);r&&(n=e.getLanguageIdByMimeType(r))}else{let i=o.getModel(t);i&&(n=i.getLanguageId())}return n&&n!==ir?n:e.guessLanguageIdByFilepathOrFirstLine(t)}function iE(o){return o.replace(/[\s]/g,"/")}function bR(o){return`suggest-aria-id:${o}`}var t8=or("suggest-more-info",ue.chevronRight,h("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),n8=new class Db{static _regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/;static _regexStrict=new RegExp(`^${Db._regexRelaxed.source}$`,"i");extract(e,t){if(e.textLabel.match(Db._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(Db._regexStrict))return t[0]=e.completion.detail,!0;if(e.completion.documentation){let n=typeof e.completion.documentation=="string"?e.completion.documentation:e.completion.documentation.value,i=Db._regexRelaxed.exec(n);if(i&&(i.index===0||i.index+i[0].length===n.length))return t[0]=i[0],!0}return!1}},am=class{constructor(e,t,n,i){this._editor=e;this._modelService=t;this._languageService=n;this._themeService=i}_onDidToggleDetails=new L;onDidToggleDetails=this._onDidToggleDetails.event;templateId="suggestion";dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){let t=new ae,n=e;n.classList.add("show-file-icons");let i=Le(e,xe(".icon")),r=Le(i,xe("span.colorspan")),s=Le(e,xe(".contents")),a=Le(s,xe(".main")),l=Le(a,xe(".icon-label.codicon")),d=Le(a,xe("span.left")),c=Le(a,xe("span.right")),u=new nE(d,{supportHighlights:!0,supportIcons:!0});t.add(u);let p=Le(d,xe("span.signature-label")),m=Le(d,xe("span.qualifier-label")),f=Le(c,xe("span.details-label")),g=Le(c,xe("span.readMore"+nt.asCSSSelector(t8)));return g.title=h("readMore","Read More"),{root:n,left:d,right:c,icon:i,colorspan:r,iconLabel:u,iconContainer:l,parametersLabel:p,qualifierLabel:m,detailsLabel:f,readMore:g,disposables:t,configureFont:()=>{let v=this._editor.getOptions(),I=v.get(51),C=I.getMassagedFontFamily(),S=I.fontFeatureSettings,_=v.get(121)||I.fontSize,R=v.get(122)||I.lineHeight,N=I.fontWeight,F=I.letterSpacing,P=`${_}px`,H=`${R}px`,U=`${F}px`;n.style.fontSize=P,n.style.fontWeight=N,n.style.letterSpacing=U,a.style.fontFamily=C,a.style.fontFeatureSettings=S,a.style.lineHeight=H,i.style.height=H,i.style.width=H,g.style.height=H,g.style.width=H}}}renderElement(e,t,n){n.configureFont();let{completion:i}=e;n.root.id=bR(t),n.colorspan.style.backgroundColor="";let r={labelEscapeNewLines:!0,matches:Gw(e.score)},s=[];if(i.kind===19&&n8.extract(e,s))n.icon.className="icon customcolor",n.iconContainer.className="icon hide",n.colorspan.style.backgroundColor=s[0];else if(i.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){n.icon.className="icon hide",n.iconContainer.className="icon hide";let a=Lb(this._modelService,this._languageService,le.from({scheme:"fake",path:e.textLabel}),0),l=Lb(this._modelService,this._languageService,le.from({scheme:"fake",path:i.detail}),0);r.extraClasses=a.length>l.length?a:l}else i.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(n.icon.className="icon hide",n.iconContainer.className="icon hide",r.extraClasses=[Lb(this._modelService,this._languageService,le.from({scheme:"fake",path:e.textLabel}),1),Lb(this._modelService,this._languageService,le.from({scheme:"fake",path:i.detail}),1)].flat()):(n.icon.className="icon hide",n.iconContainer.className="",n.iconContainer.classList.add("suggest-icon",...nt.asClassNameArray(np.toIcon(i.kind))));i.tags&&i.tags.indexOf(1)>=0&&(r.extraClasses=(r.extraClasses||[]).concat(["deprecated"]),r.matches=[]),n.iconLabel.setLabel(e.textLabel,void 0,r),typeof i.label=="string"?(n.parametersLabel.textContent="",n.detailsLabel.textContent=fR(i.detail||""),n.root.classList.add("string-label")):(n.parametersLabel.textContent=fR(i.label.detail||""),n.detailsLabel.textContent=fR(i.label.description||""),n.root.classList.remove("string-label")),this._editor.getOption(120).showInlineDetails?So(n.detailsLabel):eo(n.detailsLabel),Tb(e)?(n.right.classList.add("can-expand-details"),So(n.readMore),n.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},n.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(n.right.classList.remove("can-expand-details"),eo(n.readMore),n.readMore.onmousedown=null,n.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};am=K([D(1,rs),D(2,Hi),D(3,os)],am);function fR(o){return o.replace(/\r\n|\r|\n/g,"")}x("editorSuggestWidget.background",bi,h("editorSuggestWidgetBackground","Background color of the suggest widget."));x("editorSuggestWidget.border",$g,h("editorSuggestWidgetBorder","Border color of the suggest widget."));var i8=x("editorSuggestWidget.foreground",vI,h("editorSuggestWidgetForeground","Foreground color of the suggest widget."));x("editorSuggestWidget.selectedForeground",CI,h("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));x("editorSuggestWidget.selectedIconForeground",SI,h("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));var o8=x("editorSuggestWidget.selectedBackground",xI,h("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));x("editorSuggestWidget.highlightForeground",Ep,h("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));x("editorSuggestWidget.focusHighlightForeground",xA,h("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));x("editorSuggestWidgetStatus.foreground",ze(i8,.5),h("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));var vR=class{constructor(e,t){this._service=e;this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof im}`}_key;restore(){let e=this._service.get(this._key,0)??"";try{let t=JSON.parse(e);if(Dt.is(t))return Dt.lift(t)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}},bs=class{constructor(e,t,n,i,r){this.editor=e;this._storageService=t;this.element=new rm,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new yR(this,e),this._persistedSize=new vR(t,e);class s{constructor(m,f,g=!1,b=!1){this.persistedSize=m;this.currentSize=f;this.persistHeight=g;this.persistWidth=b}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new s(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(p=>{if(this._resize(p.dimension.width,p.dimension.height),a&&(a.persistHeight=a.persistHeight||!!p.north||!!p.south,a.persistWidth=a.persistWidth||!!p.east||!!p.west),!!p.done){if(a){let{itemHeight:m,defaultSize:f}=this.getLayoutInfo(),g=Math.round(m/2),{width:b,height:v}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-v)<=g)&&(v=a.persistedSize?.height??f.height),(!a.persistWidth||Math.abs(a.currentSize.width-b)<=g)&&(b=a.persistedSize?.width??f.width),this._persistedSize.store(new Dt(b,v))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=Le(this.element.domNode,xe(".message")),this._listElement=Le(this.element.domNode,xe(".tree"));let l=this._disposables.add(r.createInstance(sm,this.editor));l.onDidClose(()=>this.toggleDetails(),this,this._disposables),this._details=new tE(l,this.editor);let d=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(120).showIcons);d();let c=r.createInstance(am,this.editor);this._disposables.add(c),this._disposables.add(c.onDidToggleDetails(()=>this.toggleDetails())),this._list=new ho("SuggestWidget",this._listElement,{getHeight:p=>this.getLayoutInfo().itemHeight,getTemplateId:p=>"suggestion"},[c],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>h("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:p=>{let m=p.textLabel;if(typeof p.completion.label!="string"){let{detail:v,description:I}=p.completion.label;v&&I?m=h("label.full","{0} {1}, {2}",m,v,I):v?m=h("label.detail","{0} {1}",m,v):I&&(m=h("label.desc","{0}, {1}",m,I))}if(!p.isResolved||!this._isDetailsVisible())return m;let{documentation:f,detail:g}=p.completion,b=jE("{0}{1}",g||"",f?typeof f=="string"?f:f.value:"");return h("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",m,b)}}}),this._list.style(gW({listInactiveFocusBackground:o8,listInactiveFocusOutline:Pt})),this._status=r.createInstance(om,this.element.domNode,Ca);let u=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(120).showStatusBar);u(),this._disposables.add(i.onDidColorThemeChange(p=>this._onThemeChange(p))),this._onThemeChange(i.getColorTheme()),this._disposables.add(this._list.onMouseDown(p=>this._onListMouseDownOrTap(p))),this._disposables.add(this._list.onTap(p=>this._onListMouseDownOrTap(p))),this._disposables.add(this._list.onDidChangeSelection(p=>this._onListSelection(p))),this._disposables.add(this._list.onDidChangeFocus(p=>this._onListFocus(p))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(p=>{p.hasChanged(120)&&(u(),d()),this._completionModel&&(p.hasChanged(51)||p.hasChanged(121)||p.hasChanged(122))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=Ue.Visible.bindTo(n),this._ctxSuggestWidgetDetailsVisible=Ue.DetailsVisible.bindTo(n),this._ctxSuggestWidgetMultipleSuggestions=Ue.MultipleSuggestions.bindTo(n),this._ctxSuggestWidgetHasFocusedSuggestion=Ue.HasFocusedSuggestion.bindTo(n),this._disposables.add(Ln(this._details.widget.domNode,"keydown",p=>{this._onDetailsKeydown.fire(p)})),this._disposables.add(this.editor.onMouseDown(p=>this._onEditorMouseDown(p)))}static LOADING_MESSAGE=h("suggestWidget.loading","Loading...");static NO_SUGGESTIONS_MESSAGE=h("suggestWidget.noSuggestions","No suggestions.");_state=0;_isAuto=!1;_loadingTimeout;_pendingLayout=new Wt;_pendingShowDetails=new Wt;_currentSuggestionDetails;_focusedItem;_ignoreFocusEvents=!1;_completionModel;_cappedHeight;_forceRenderingAbove=!1;_explainMode=!1;element;_messageElement;_listElement;_list;_status;_details;_contentWidget;_persistedSize;_ctxSuggestWidgetVisible;_ctxSuggestWidgetDetailsVisible;_ctxSuggestWidgetMultipleSuggestions;_ctxSuggestWidgetHasFocusedSuggestion;_showTimeout=new Zi;_disposables=new ae;_onDidSelect=new Pa;_onDidFocus=new Pa;_onDidHide=new L;_onDidShow=new L;onDidSelect=this._onDidSelect.event;onDidFocus=this._onDidFocus.event;onDidHide=this._onDidHide.event;onDidShow=this._onDidShow.event;_onDetailsKeydown=new L;onDetailsKeyDown=this._onDetailsKeydown.event;dispose(){this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),this._loadingTimeout?.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){let n=this._completionModel;n&&(this._onDidSelect.fire({item:e,index:t,model:n}),this.editor.focus())}_onThemeChange(e){this._details.widget.borderWidth=Js(e.type)?2:1}_onListFocus(e){if(this._ignoreFocusEvents)return;if(this._state===5&&this._setState(3),!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);let t=e.elements[0],n=e.indexes[0];t!==this._focusedItem&&(this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=t,this._list.reveal(n),this._currentSuggestionDetails=zd(async i=>{let r=Kd(()=>{this._isDetailsVisible()&&this._showDetails(!0,!1)},250),s=i.onCancellationRequested(()=>r.dispose());try{return await t.resolve(i)}finally{r.dispose(),s.dispose()}}),this._currentSuggestionDetails.then(()=>{n>=this._list.length||t!==this._list.element(n)||(this._ignoreFocusEvents=!0,this._list.splice(n,1,[t]),this._list.setFocus([n]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this._showDetails(!1,!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:bR(n)}))}).catch(We)),this._onDidFocus.fire({item:t,index:n,model:this._completionModel})}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",e===4),this.element.domNode.classList.remove("message"),e){case 0:eo(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=bs.LOADING_MESSAGE,eo(this._listElement,this._status.element),So(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Bl(bs.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=bs.NO_SUGGESTIONS_MESSAGE,eo(this._listElement,this._status.element),So(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Bl(bs.NO_SUGGESTIONS_MESSAGE);break;case 3:eo(this._messageElement),So(this._listElement,this._status.element),this._show();break;case 4:eo(this._messageElement),So(this._listElement,this._status.element),this._show();break;case 5:eo(this._messageElement),So(this._listElement,this._status.element),this._details.show(),this._show(),this._details.widget.focus();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=Kd(()=>this._setState(1),t)))}showSuggestions(e,t,n,i,r){if(this._contentWidget.setPosition(this.editor.getPosition()),this._loadingTimeout?.dispose(),this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),n&&this._state!==2&&this._state!==0){this._setState(4);return}let s=this._completionModel.items.length,a=s===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(s>1),a){this._setState(i?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(n?4:3),this._list.reveal(t,0),this._list.setFocus(r?[]:[t])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=Au(ge(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._list.setFocus(this._list.getFocus()),this._setState(3)):this._state===3&&(this._setState(5),this._isDetailsVisible()?this._details.widget.focus():this.toggleDetails(!0))}toggleDetails(e=!1){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(Tb(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this._showDetails(!1,e))}_showDetails(e,t){this._pendingShowDetails.value=Au(ge(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show();let n=!1;e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details"),t&&(this._details.widget.focus(),n=!0)),n||this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this._showDetails(!1,!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){this._pendingLayout.clear(),this._pendingShowDetails.clear(),this._loadingTimeout?.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();let e=this._persistedSize.restore(),t=Math.ceil(this.getLayoutInfo().itemHeight*4.3);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(e){if(!this.editor.hasModel()||!this.editor.getDomNode())return;let t=Gd(this.element.domNode.ownerDocument.body),n=this.getLayoutInfo();e||(e=n.defaultSize);let i=e.height,r=e.width;if(this._status.element.style.height=`${n.itemHeight}px`,this._state===2||this._state===1)i=n.itemHeight+n.borderHeight,r=n.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Dt(r,i),this._contentWidget.setPreference(2);else{let s=t.width-n.borderHeight-2*n.horizontalPadding;r>s&&(r=s);let a=this._completionModel?this._completionModel.stats.pLabelLen*n.typicalHalfwidthCharacterWidth:r,l=n.statusBarHeight+this._list.contentHeight+n.borderHeight,d=n.itemHeight+n.statusBarHeight,c=Bi(this.editor.getDomNode()),u=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),p=c.top+u.top+u.height,m=Math.min(t.height-p-n.verticalPadding,l),f=c.top+u.top-n.verticalPadding,g=Math.min(f,l),b=Math.min(Math.max(g,m)+n.borderHeight,l);i===this._cappedHeight?.capped&&(i=this._cappedHeight.wanted),i<d&&(i=d),i>b&&(i=b),i>m||this._forceRenderingAbove&&f>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),b=g):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),b=m),this.element.preferredSize=new Dt(a,n.defaultSize.height),this.element.maxSize=new Dt(s,b),this.element.minSize=new Dt(220,d),this._cappedHeight=i===l?{wanted:this._cappedHeight?.wanted??e.height,capped:i}:void 0}this._resize(r,i)}_resize(e,t){let{width:n,height:i}=this.element.maxSize;e=Math.min(n,e),t=Math.min(i,t);let{statusBarHeight:r}=this.getLayoutInfo();this._list.layout(t-r,e),this._listElement.style.height=`${t-r}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,this._contentWidget.getPosition()?.preference[0]===2)}getLayoutInfo(){let e=this.editor.getOption(51),t=Wr(this.editor.getOption(122)||e.lineHeight,8,1e3),n=!this.editor.getOption(120).showStatusBar||this._state===2||this._state===1?0:t,i=this._details.widget.borderWidth,r=2*i;return{itemHeight:t,statusBarHeight:n,borderWidth:i,borderHeight:r,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Dt(430,n+12*t+r)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};bs=K([D(1,kh),D(2,Rt),D(3,os),D(4,dt)],bs);var yR=class{constructor(e,t){this._widget=e;this._editor=t}allowEditorOverflow=!0;suppressMouseDown=!1;_position;_preference;_preferenceLocked=!1;_added=!1;_hidden=!1;dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){let{height:e,width:t}=this._widget.element.size,{borderWidth:n,horizontalPadding:i}=this._widget.getLayoutInfo();return new Dt(t+2*n+i,e+2*n)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}};var ar=class{constructor(e,t){this._editor=e;this._ckOtherSuggestions=ar.OtherSuggestions.bindTo(t)}static OtherSuggestions=new me("hasOtherSuggestions",!1);_ckOtherSuggestions;_index=0;_model;_acceptNext;_listener;_ignore;dispose(){this.reset()}reset(){this._ckOtherSuggestions.reset(),this._listener?.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:e,index:t},n){if(e.items.length===0){this.reset();return}if(ar._moveIndex(!0,e,t)===t){this.reset();return}this._acceptNext=n,this._model=e,this._index=t,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,n){let i=n;for(let r=t.items.length;r>0&&(i=(i+t.items.length+(e?1:-1))%t.items.length,!(i===n||!t.items[i].completion.additionalTextEdits));r--);return i}next(){this._move(!0)}prev(){this._move(!1)}_move(e){if(this._model)try{this._ignore=!0,this._index=ar._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};ar=K([D(1,Rt)],ar);var oE=class{_disposables=new ae;_active;constructor(e,t,n,i){this._disposables.add(n.onDidSuggest(r=>{r.completionModel.items.length===0&&this.reset()})),this._disposables.add(n.onDidCancel(r=>{this.reset()})),this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(r=>{if(this._active&&!t.isFrozen()&&n.state!==0){let s=r.charCodeAt(r.length-1);this._active.acceptCharacters.has(s)&&e.getOption(0)&&i(this._active.item)}}))}_onItem(e){if(!e||!hu(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;let t=new Ny;for(let n of e.item.completion.commitCharacters)n.length>0&&t.add(n.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}};var s8=!1,IR=class{constructor(e,t){this._model=e;this._position=t;if(e.getLineMaxColumn(t.lineNumber)!==t.column){let i=e.getOffsetAt(t),r=e.getPositionAt(i+1);e.changeDecorations(s=>{this._marker&&s.removeDecoration(this._marker),this._marker=s.addDecoration(w.fromPositions(t,r),this._decorationOptions)})}}_decorationOptions=En.register({description:"suggest-line-suffix",stickiness:1});_marker;dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(e=>{e.removeDecoration(this._marker),this._marker=void 0})}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){let t=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}};var Wo=class{constructor(e,t,n,i,r,s,a){this._memoryService=t;this._commandService=n;this._contextKeyService=i;this._instantiationService=r;this._logService=s;this._telemetryService=a;this.editor=e,this.model=r.createInstance(yd,this.editor),this._selectors.register({priority:0,select:(u,p,m)=>this._memoryService.select(u,p,m)});let l=Ue.InsertMode.bindTo(i);l.set(e.getOption(120).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>l.set(e.getOption(120).insertMode))),this.widget=this._toDispose.add(new Nu(ge(e.getDomNode()),()=>{let u=this._instantiationService.createInstance(bs,this.editor);this._toDispose.add(u),this._toDispose.add(u.onDidSelect(b=>this._insertSuggestion(b,0),this));let p=new oE(this.editor,u,this.model,b=>this._insertSuggestion(b,2));this._toDispose.add(p);let m=Ue.MakesTextEdit.bindTo(this._contextKeyService),f=Ue.HasInsertAndReplaceRange.bindTo(this._contextKeyService),g=Ue.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(Ce(()=>{m.reset(),f.reset(),g.reset()})),this._toDispose.add(u.onDidFocus(({item:b})=>{let v=this.editor.getPosition(),I=b.editStart.column,C=v.column,S=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!b.completion.additionalTextEdits&&!(b.completion.insertTextRules&4)&&C-I===b.completion.insertText.length&&(S=this.editor.getModel().getValueInRange({startLineNumber:v.lineNumber,startColumn:I,endLineNumber:v.lineNumber,endColumn:C})!==b.completion.insertText),m.set(S),f.set(!M.equals(b.editInsertEnd,b.editReplaceEnd)),g.set(!!b.provider.resolveCompletionItem||!!b.completion.documentation||b.completion.detail!==b.completion.label)})),this._toDispose.add(u.onDetailsKeyDown(b=>{if(b.toKeyCodeChord().equals(new Pl(!0,!1,!1,!1,33))||Ve&&b.toKeyCodeChord().equals(new Pl(!1,!1,!1,!0,33))){b.stopPropagation();return}b.toKeyCodeChord().isModifierKey()||this.editor.focus()})),u})),this._overtypingCapturer=this._toDispose.add(new Nu(ge(e.getDomNode()),()=>this._toDispose.add(new sx(this.editor,this.model)))),this._alternatives=this._toDispose.add(new Nu(ge(e.getDomNode()),()=>this._toDispose.add(new ar(this.editor,this._contextKeyService)))),this._toDispose.add(r.createInstance(dl,e)),this._toDispose.add(this.model.onDidTrigger(u=>{this.widget.value.showTriggered(u.auto,u.shy?250:50),this._lineSuffix.value=new IR(this.editor.getModel(),u.position)})),this._toDispose.add(this.model.onDidSuggest(u=>{if(u.triggerOptions.shy)return;let p=-1;for(let f of this._selectors.itemsOrderedByPriorityDesc)if(p=f.select(this.editor.getModel(),this.editor.getPosition(),u.completionModel.items),p!==-1)break;if(p===-1&&(p=0),this.model.state===0)return;let m=!1;if(u.triggerOptions.auto){let f=this.editor.getOption(120);f.selectionMode==="never"||f.selectionMode==="always"?m=f.selectionMode==="never":f.selectionMode==="whenTriggerCharacter"?m=u.triggerOptions.triggerKind!==1:f.selectionMode==="whenQuickSuggestion"&&(m=u.triggerOptions.triggerKind===1&&!u.triggerOptions.refilter)}this.widget.value.showSuggestions(u.completionModel,p,u.isFrozen,u.triggerOptions.auto,m)})),this._toDispose.add(this.model.onDidCancel(u=>{u.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{s8||(this.model.cancel(),this.model.clear())}));let d=Ue.AcceptSuggestionsOnEnter.bindTo(i),c=()=>{let u=this.editor.getOption(1);d.set(u==="on"||u==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>c())),c()}static ID="editor.contrib.suggestController";static get(e){return e.getContribution(Wo.ID)}editor;model;widget;_alternatives;_lineSuffix=new Wt;_toDispose=new ae;_overtypingCapturer;_selectors=new CR(e=>e.priority);_onWillInsertSuggestItem=new L;onWillInsertSuggestItem=this._onWillInsertSuggestItem.event;dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(e,t){if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;let n=Zt.get(this.editor);if(!n)return;this._onWillInsertSuggestItem.fire({item:e.item});let i=this.editor.getModel(),r=i.getAlternativeVersionId(),{item:s}=e,a=[],l=new jn;t&1||this.editor.pushUndoStop();let d=this.getOverwriteInfo(s,!!(t&8));this._memoryService.memorize(i,this.editor.getPosition(),s);let c=s.isResolved,u=-1,p=-1;if(Array.isArray(s.completion.additionalTextEdits)){this.model.cancel();let f=Uf.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",s.completion.additionalTextEdits.map(g=>{let b=w.lift(g.range);if(b.startLineNumber===s.position.lineNumber&&b.startColumn>s.position.column){let v=this.editor.getPosition().column-s.position.column,I=v,C=w.spansMultipleLines(b)?0:v;b=new w(b.startLineNumber,b.startColumn+I,b.endLineNumber,b.endColumn+C)}return wo.replaceMove(b,g.text)})),f.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!c){let f=new qi,g,b=i.onDidChangeContent(S=>{if(S.isFlush){l.cancel(),b.dispose();return}for(let _ of S.changes){let R=w.getEndPosition(_.range);(!g||M.isBefore(R,g))&&(g=R)}}),v=t;t|=2;let I=!1,C=this.editor.onWillType(()=>{C.dispose(),I=!0,v&2||this.editor.pushUndoStop()});a.push(s.resolve(l.token).then(()=>{if(!s.completion.additionalTextEdits||l.token.isCancellationRequested)return;if(g&&s.completion.additionalTextEdits.some(_=>M.isBefore(g,w.getStartPosition(_.range))))return!1;I&&this.editor.pushUndoStop();let S=Uf.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",s.completion.additionalTextEdits.map(_=>wo.replaceMove(w.lift(_.range),_.text))),S.restoreRelativeVerticalPositionOfCursor(this.editor),(I||!(v&2))&&this.editor.pushUndoStop(),!0}).then(S=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",f.elapsed(),S),p=S===!0?1:S===!1?0:-2}).finally(()=>{b.dispose(),C.dispose()}))}let{insertText:m}=s.completion;if(s.completion.insertTextRules&4||(m=Er.escape(m)),this.model.cancel(),n.insert(m,{overwriteBefore:d.overwriteBefore,overwriteAfter:d.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(s.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),t&2||this.editor.pushUndoStop(),s.completion.command)if(s.completion.command.id===rE.id)this.model.trigger({auto:!0,retrigger:!0});else{let f=new qi;a.push(this._commandService.executeCommand(s.completion.command.id,...s.completion.command.arguments?[...s.completion.command.arguments]:[]).catch(g=>{s.completion.extensionId?wa(g):We(g)}).finally(()=>{u=f.elapsed()}))}t&4&&this._alternatives.value.set(e,f=>{for(l.cancel();i.canUndo();){r!==i.getAlternativeVersionId()&&i.undo(),this._insertSuggestion(f,3|(t&8?8:0));break}}),this._alertCompletionItem(s),Promise.all(a).finally(()=>{this._reportSuggestionAcceptedTelemetry(s,i,c,u,p,e.index,e.model.items),this.model.clear(),l.dispose()})}_reportSuggestionAcceptedTelemetry(e,t,n,i,r,s,a){if(Math.floor(Math.random()*100)===0)return;let l=new Map;for(let p=0;p<Math.min(30,a.length);p++){let m=a[p].textLabel;l.has(m)?l.get(m).push(p):l.set(m,[p])}let d=l.get(e.textLabel),u=d&&d.length>1?d[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:e.extensionId?.value??"unknown",providerId:e.provider._debugDisplayName??"unknown",kind:e.completion.kind,basenameHash:gr(Qo(t.uri)).toString(16),languageId:t.getLanguageId(),fileExtension:lw(t.uri),resolveInfo:e.provider.resolveCompletionItem?n?1:0:-1,resolveDuration:e.resolveDuration,commandDuration:i,additionalEditsAsync:r,index:s,firstIndex:u})}getOverwriteInfo(e,t){hi(this.editor.hasModel());let n=this.editor.getOption(120).insertMode==="replace";t&&(n=!n);let i=e.position.column-e.editStart.column,r=(n?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,s=this.editor.getPosition().column-e.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:i+s,overwriteAfter:r+a}}_alertCompletionItem(e){if(hu(e.completion.additionalTextEdits)){let t=h("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);Fl(t)}}triggerSuggest(e,t,n){this.editor.hasModel()&&(this.model.trigger({auto:t??!1,completionOptions:{providerFilter:e,kindFilter:n?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;let t=this.editor.getPosition(),n=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},i=r=>{if(r.completion.insertTextRules&4||r.completion.additionalTextEdits)return!0;let s=this.editor.getPosition(),a=r.editStart.column,l=s.column;return l-a!==r.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:s.lineNumber,startColumn:a,endLineNumber:s.lineNumber,endColumn:l})!==r.completion.insertText};de.once(this.model.onDidTrigger)(r=>{let s=[];de.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{yt(s),n()},void 0,s),this.model.onDidSuggest(({completionModel:a})=>{if(yt(s),a.items.length===0){n();return}let l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),d=a.items[l];if(!i(d)){n();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:d,model:a},7)},void 0,s)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){let n=this.widget.value.getFocusedItem(),i=0;e&&(i|=4),t&&(i|=8),this._insertSuggestion(n,i)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}};Wo=K([D(1,YD),D(2,qr),D(3,Rt),D(4,dt),D(5,xn),D(6,Rp)],Wo);var CR=class{constructor(e){this.prioritySelector=e}_items=new Array;register(e){if(this._items.indexOf(e)!==-1)throw new Error("Value is already registered");return this._items.push(e),this._items.sort((t,n)=>this.prioritySelector(n)-this.prioritySelector(t)),{dispose:()=>{let t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}},rE=class o extends ef{static id="editor.action.triggerSuggest";constructor(){super({id:o.id,label:h("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:De.and(ie.writable,ie.hasCompletionItemProvider,Ue.Visible.toNegated()),kbOpts:{kbExpr:ie.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t,n){let i=Wo.get(t);if(!i)return;let r;n&&typeof n=="object"&&n.auto===!0&&(r=!0),i.triggerSuggest(void 0,r,void 0)}};Mp(Wo.ID,Wo,2);h1(rE);var Vo=190,Di=na.bindToContribution(Wo.get);be(new Di({id:"acceptSelectedSuggestion",precondition:De.and(Ue.Visible,Ue.HasFocusedSuggestion),handler(o){o.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:De.and(Ue.Visible,ie.textInputFocus),weight:Vo},{primary:3,kbExpr:De.and(Ue.Visible,ie.textInputFocus,Ue.AcceptSuggestionsOnEnter,Ue.MakesTextEdit),weight:Vo}],menuOpts:[{menuId:Ca,title:h("accept.insert","Insert"),group:"left",order:1,when:Ue.HasInsertAndReplaceRange.toNegated()},{menuId:Ca,title:h("accept.insert","Insert"),group:"left",order:1,when:De.and(Ue.HasInsertAndReplaceRange,Ue.InsertMode.isEqualTo("insert"))},{menuId:Ca,title:h("accept.replace","Replace"),group:"left",order:1,when:De.and(Ue.HasInsertAndReplaceRange,Ue.InsertMode.isEqualTo("replace"))}]}));be(new Di({id:"acceptAlternativeSelectedSuggestion",precondition:De.and(Ue.Visible,ie.textInputFocus,Ue.HasFocusedSuggestion),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:1027,secondary:[1026]},handler(o){o.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:Ca,group:"left",order:2,when:De.and(Ue.HasInsertAndReplaceRange,Ue.InsertMode.isEqualTo("insert")),title:h("accept.replace","Replace")},{menuId:Ca,group:"left",order:2,when:De.and(Ue.HasInsertAndReplaceRange,Ue.InsertMode.isEqualTo("replace")),title:h("accept.insert","Insert")}]}));Eo.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");be(new Di({id:"hideSuggestWidget",precondition:Ue.Visible,handler:o=>o.cancelSuggestWidget(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:9,secondary:[1033]}}));be(new Di({id:"selectNextSuggestion",precondition:De.and(Ue.Visible,De.or(Ue.MultipleSuggestions,Ue.HasFocusedSuggestion.negate())),handler:o=>o.selectNextSuggestion(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));be(new Di({id:"selectNextPageSuggestion",precondition:De.and(Ue.Visible,De.or(Ue.MultipleSuggestions,Ue.HasFocusedSuggestion.negate())),handler:o=>o.selectNextPageSuggestion(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:12,secondary:[2060]}}));be(new Di({id:"selectLastSuggestion",precondition:De.and(Ue.Visible,De.or(Ue.MultipleSuggestions,Ue.HasFocusedSuggestion.negate())),handler:o=>o.selectLastSuggestion()}));be(new Di({id:"selectPrevSuggestion",precondition:De.and(Ue.Visible,De.or(Ue.MultipleSuggestions,Ue.HasFocusedSuggestion.negate())),handler:o=>o.selectPrevSuggestion(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));be(new Di({id:"selectPrevPageSuggestion",precondition:De.and(Ue.Visible,De.or(Ue.MultipleSuggestions,Ue.HasFocusedSuggestion.negate())),handler:o=>o.selectPrevPageSuggestion(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:11,secondary:[2059]}}));be(new Di({id:"selectFirstSuggestion",precondition:De.and(Ue.Visible,De.or(Ue.MultipleSuggestions,Ue.HasFocusedSuggestion.negate())),handler:o=>o.selectFirstSuggestion()}));be(new Di({id:"focusSuggestion",precondition:De.and(Ue.Visible,Ue.HasFocusedSuggestion.negate()),handler:o=>o.focusSuggestion(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));be(new Di({id:"focusAndAcceptSuggestion",precondition:De.and(Ue.Visible,Ue.HasFocusedSuggestion.negate()),handler:o=>{o.focusSuggestion(),o.acceptSelectedSuggestion(!0,!1)}}));be(new Di({id:"toggleSuggestionDetails",precondition:De.and(Ue.Visible,Ue.HasFocusedSuggestion),handler:o=>o.toggleSuggestionDetails(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:Ca,group:"right",order:1,when:De.and(Ue.DetailsVisible,Ue.CanResolve),title:h("detail.more","Show Less")},{menuId:Ca,group:"right",order:1,when:De.and(Ue.DetailsVisible.toNegated(),Ue.CanResolve),title:h("detail.less","Show More")}]}));be(new Di({id:"toggleExplainMode",precondition:Ue.Visible,handler:o=>o.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));be(new Di({id:"toggleSuggestionFocus",precondition:Ue.Visible,handler:o=>o.toggleSuggestionFocus(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:2570,mac:{primary:778}}}));be(new Di({id:"insertBestCompletion",precondition:De.and(ie.textInputFocus,De.equals("config.editor.tabCompletion","on"),dl.AtEnd,Ue.Visible.toNegated(),ar.OtherSuggestions.toNegated(),Zt.InSnippetMode.toNegated()),handler:(o,e)=>{o.triggerSuggestAndAcceptBest(Ht(e)?{fallback:"tab",...e}:{fallback:"tab"})},kbOpts:{weight:Vo,primary:2}}));be(new Di({id:"insertNextSuggestion",precondition:De.and(ie.textInputFocus,De.equals("config.editor.tabCompletion","on"),ar.OtherSuggestions,Ue.Visible.toNegated(),Zt.InSnippetMode.toNegated()),handler:o=>o.acceptNextSuggestion(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:2}}));be(new Di({id:"insertPrevSuggestion",precondition:De.and(ie.textInputFocus,De.equals("config.editor.tabCompletion","on"),ar.OtherSuggestions,Ue.Visible.toNegated(),Zt.InSnippetMode.toNegated()),handler:o=>o.acceptPrevSuggestion(),kbOpts:{weight:Vo,kbExpr:ie.textInputFocus,primary:1026}}));h1(class extends ef{constructor(){super({id:"editor.action.resetSuggestSize",label:h("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(o,e){Wo.get(e)?.resetWidgetSize()}});var HXt=h("views log","Views"),UXt=or("default-view-icon",ue.window,h("defaultViewIcon","Default view icon.")),_R;(t=>(t.ViewContainersRegistry="workbench.registry.view.containers",t.ViewsRegistry="workbench.registry.view"))(_R||={});var SR=class extends V{_onDidRegister=this._register(new L);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new L);onDidDeregister=this._onDidDeregister.event;viewContainers=new Map;defaultViewContainers=[];get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,n){let i=this.get(e.id);if(i)return i;let r=e;return r.openCommandActionDescriptor=n?.doNotRegisterOpenCommand?void 0:r.openCommandActionDescriptor??{id:r.id},Cm(this.viewContainers,t,[]).push(r),n?.isDefault&&this.defaultViewContainers.push(r),this._onDidRegister.fire({viewContainer:r,viewContainerLocation:t}),r}deregisterViewContainer(e){for(let t of this.viewContainers.keys()){let n=this.viewContainers.get(t),i=n?.indexOf(e);if(i!==-1){n?.splice(i,1),n.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(n=>n?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}};et.add(_R.ViewContainersRegistry,new SR);function a8(o,e){let t=o.group??"9_more",n=e.group??"9_more";return t!==n?t.localeCompare(n):(o.order??5)-(e.order??5)}var xR=class extends V{_onViewsRegistered=this._register(new L);onViewsRegistered=this._onViewsRegistered.event;_onViewsDeregistered=this._register(new L);onViewsDeregistered=this._onViewsDeregistered.event;_onDidChangeContainer=this._register(new L);onDidChangeContainer=this._onDidChangeContainer.event;_onDidChangeViewWelcomeContent=this._register(new L);onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;_viewContainers=[];_views=new Map;_viewWelcomeContents=new _l;registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:n})=>this.addViews(t,n)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){let n=this.removeViews(e,t);n.length&&this._onViewsDeregistered.fire({views:n,viewContainer:t})}moveViews(e,t){for(let n of this._views.keys())if(n!==t){let i=this.removeViews(e,n);i.length&&(this.addViews(i,t),this._onDidChangeContainer.fire({views:i,from:n,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(let t of this._viewContainers){let n=(this._views.get(t)||[]).filter(i=>i.id===e)[0];if(n)return n}return null}getViewContainer(e){for(let t of this._viewContainers)if((this._views.get(t)||[]).filter(i=>i.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),Ce(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){let n=new Map;for(let[i,r]of t)this._viewWelcomeContents.add(e,r),n.set(i,Ce(()=>{this._viewWelcomeContents.delete(e,r),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),n}getViewWelcomeContent(e){let t=[];return this._viewWelcomeContents.forEach(e,n=>t.push(n)),t.sort(a8)}addViews(e,t){let n=this._views.get(t);n||(n=[],this._views.set(t,n),this._viewContainers.push(t));for(let i of e){if(this.getView(i.id)!==null)throw new Error(h("duplicateId","A view with id '{0}' is already registered",i.id));n.push(i)}}removeViews(e,t){let n=this._views.get(t);if(!n)return[];let i=[],r=[];for(let s of n)e.includes(s)?i.push(s):r.push(s);return i.length&&(r.length?this._views.set(t,r):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),i}};et.add(_R.ViewsRegistry,new xR);var zXt=j("viewDescriptorService");var vW=j("IUserDataProfileService"),gZt=j("IUserDataProfileManagementService");var fZt=j("IUserDataProfileImportExportService"),bZt=or("defaultProfile-icon",ue.settings,h("defaultProfileIcon","Icon for Default Profile.")),l8=cr("profiles","Profiles"),vZt={...l8},d8="code-profile",yZt=[{name:h("profile","Profile"),extensions:[d8]}],IZt=new me("profiles.enabled",!0),CZt=new me("currentProfile",""),SZt=new me("isCurrentProfileTransient",!1),xZt=new me("hasProfiles",!1);var yW=j("urlService");var c8=`{
}`,kb=class extends V{constructor(t,n,i,r,s,a,l,d,c,u,p,m,f,g,b,v,I,C,S){super();this.editorService=t;this.editorGroupService=n;this.textFileService=i;this.configurationService=r;this.notificationService=s;this.contextService=a;this.instantiationService=l;this.userDataProfileService=d;this.userDataProfilesService=c;this.textModelResolverService=u;this.jsonEditingService=f;this.labelService=g;this.remoteAgentService=b;this.textEditorService=v;this.extensionService=C;this.progressService=S;this._register(p.onDidUpdateKeybindings(()=>{let _=m.getModel(this.defaultKeybindingsResource);_&&m.updateModel(_,D0(p))})),this._register(I.registerHandler(this))}_onDispose=this._register(new L);_onDidDefaultSettingsContentChanged=this._register(new L);onDidDefaultSettingsContentChanged=this._onDidDefaultSettingsContentChanged.event;_defaultUserSettingsContentModel;_defaultWorkspaceSettingsContentModel;_defaultFolderSettingsContentModel;_defaultRawSettingsEditorModel;_requestedDefaultSettings=new fu;_settingsGroups=void 0;defaultKeybindingsResource=le.from({scheme:Ie.vscode,authority:"defaultsettings",path:"/keybindings.json"});defaultSettingsRawResource=le.from({scheme:Ie.vscode,authority:"defaultsettings",path:"/defaultSettings.json"});get userSettingsResource(){return this.userDataProfileService.currentProfile.settingsResource}get workspaceSettingsResource(){if(this.contextService.getWorkbenchState()===1)return null;let t=this.contextService.getWorkspace();return t.configuration||t.folders[0].toResource(k0)}createSettingsEditor2Input(){return new ol(this)}getFolderSettingsResource(t){let n=this.contextService.getWorkspaceFolder(t);return n?n.toResource(k0):null}hasDefaultSettingsContent(t){return this.isDefaultSettingsResource(t)||Xi(t,this.defaultSettingsRawResource)||Xi(t,this.defaultKeybindingsResource)}getDefaultSettingsContent(t){if(this.isDefaultSettingsResource(t)){let n=this.getConfigurationTargetFromDefaultSettingsResource(t),i=this.getDefaultSettings(n);return this._requestedDefaultSettings.has(t)||(this._register(i.onDidChange(()=>this._onDidDefaultSettingsContentChanged.fire(t))),this._requestedDefaultSettings.add(t)),i.getContentWithoutMostCommonlyUsed(!0)}if(Xi(t,this.defaultSettingsRawResource))return this._defaultRawSettingsEditorModel||(this._defaultRawSettingsEditorModel=this._register(this.instantiationService.createInstance(sS,this.getDefaultSettings(3))),this._register(this._defaultRawSettingsEditorModel.onDidContentChanged(()=>this._onDidDefaultSettingsContentChanged.fire(t)))),this._defaultRawSettingsEditorModel.content;if(Xi(t,this.defaultKeybindingsResource))return this.instantiationService.createInstance(dh,t).content}async createPreferencesEditorModel(t){if(this.isDefaultSettingsResource(t))return this.createDefaultSettingsEditorModel(t);if(this.userSettingsResource.toString()===t.toString()||this.userDataProfilesService.defaultProfile.settingsResource.toString()===t.toString())return this.createEditableSettingsEditorModel(3,t);let n=await this.getEditableSettingsURI(5);if(n&&n.toString()===t.toString())return this.createEditableSettingsEditorModel(5,n);if(this.contextService.getWorkbenchState()===3){let s=await this.getEditableSettingsURI(6,t);if(s&&s.toString()===t.toString())return this.createEditableSettingsEditorModel(6,t)}let i=await this.remoteAgentService.getEnvironment(),r=i?i.settingsPath:null;return r&&r.toString()===t.toString()?this.createEditableSettingsEditorModel(4,t):null}openRawDefaultSettings(){return this.editorService.openEditor({resource:this.defaultSettingsRawResource})}openRawUserSettings(){return this.editorService.openEditor({resource:this.userSettingsResource})}shouldOpenJsonByDefault(){return this.configurationService.getValue("workbench.settings.editor")==="json"}openSettings(t={}){return t={...t,target:3},t.query&&(t.jsonEditor=!1),this.open(this.userSettingsResource,t)}openLanguageSpecificSettings(t,n={}){return this.shouldOpenJsonByDefault()?(n.query=void 0,n.revealSetting={key:`[${t}]`,edit:!0}):n.query=`@lang:${t}${n.query?` ${n.query}`:""}`,n.target=n.target??3,this.open(this.userSettingsResource,n)}open(t,n){return n={...n,jsonEditor:n.jsonEditor??this.shouldOpenJsonByDefault()},n.jsonEditor?this.openSettingsJson(t,n):this.openSettings2(n)}async openSettings2(t){let n=this.createSettingsEditor2Input();return t={...t,focusSearch:!0},await this.editorService.openEditor(n,aS(t),t.openToSide?v0:void 0),this.editorGroupService.activeGroup.activeEditorPane}openApplicationSettings(t={}){return t={...t,target:3},this.open(this.userDataProfilesService.defaultProfile.settingsResource,t)}openUserSettings(t={}){return t={...t,target:3},this.open(this.userSettingsResource,t)}async openRemoteSettings(t={}){let n=await this.remoteAgentService.getEnvironment();n&&(t={...t,target:4},this.open(n.settingsPath,t))}openWorkspaceSettings(t={}){return this.workspaceSettingsResource?(t={...t,target:5},this.open(this.workspaceSettingsResource,t)):(this.notificationService.info(h("openFolderFirst","Open a folder or workspace first to create workspace or folder settings.")),Promise.reject(null))}async openFolderSettings(t={}){if(t={...t,target:6},!t.folderUri)throw new Error("Missing folder URI");let n=await this.getEditableSettingsURI(6,t.folderUri);if(!n)throw new Error(`Invalid folder URI - ${t.folderUri.toString()}`);return this.open(n,t)}async openGlobalKeybindingSettings(t,n){if(n={pinned:!0,revealIfOpened:!0,...n},t){let i="// "+h("emptyKeybindingsHeader","Place your key bindings in this file to override the defaults")+`
[
]`,r=this.userDataProfileService.currentProfile.keybindingsResource,s=!!this.configurationService.getValue("workbench.settings.openDefaultKeybindings");if(await this.createIfNotExists(r,i),s){let a=this.editorGroupService.activeGroup,l=this.editorGroupService.addGroup(a.id,3);await Promise.all([this.editorService.openEditor({resource:this.defaultKeybindingsResource,options:{pinned:!0,preserveFocus:!0,revealIfOpened:!0,override:xr.id},label:h("defaultKeybindings","Default Keybindings"),description:""}),this.editorService.openEditor({resource:r,options:n},l.id)])}else await this.editorService.openEditor({resource:r,options:n})}else{let i=await this.editorService.openEditor(this.instantiationService.createInstance(il),{...n});n.query&&i.search(n.query)}}openDefaultKeybindingsFile(){return this.editorService.openEditor({resource:this.defaultKeybindingsResource,label:h("defaultKeybindings","Default Keybindings")})}async openSettingsJson(t,n){let i=n?.openToSide?v0:void 0,r=await this.doOpenSettingsJson(t,n,i);return r&&n?.revealSetting&&await this.revealSetting(n.revealSetting.key,!!n.revealSetting.edit,r,t),r}async doOpenSettingsJson(t,n,i){let r=!!this.configurationService.getValue(R2),s=!!this.configurationService.getValue(k2);if(r||s)return this.doOpenSplitJSON(t,n,i);let a=n?.target??2,l=await this.getOrCreateEditableSettingsEditorInput(a,t);return n={...n,pinned:!0},await this.editorService.openEditor(l,aS(n),i)}async doOpenSplitJSON(t,n={},i){let r=n.target??2;await this.createSettingsIfNotExists(r,t);let s=this.createSplitJsonEditorInput(r,t);return n={...n,pinned:!0},this.editorService.openEditor(s,aS(n),i)}createSplitJsonEditorInput(t,n){let i=this.textEditorService.createTextEditor({resource:n}),r=this.textEditorService.createTextEditor({resource:this.getDefaultSettingsResource(t)});return this.instantiationService.createInstance(Un,i.getName(),void 0,r,i)}createSettings2EditorModel(){return this.instantiationService.createInstance(lh,this.getDefaultSettings(3))}getConfigurationTargetFromDefaultSettingsResource(t){return this.isDefaultWorkspaceSettingsResource(t)?5:this.isDefaultFolderSettingsResource(t)?6:3}isDefaultSettingsResource(t){return this.isDefaultUserSettingsResource(t)||this.isDefaultWorkspaceSettingsResource(t)||this.isDefaultFolderSettingsResource(t)}isDefaultUserSettingsResource(t){return t.authority==="defaultsettings"&&t.scheme===Ie.vscode&&!!t.path.match(/\/(\d+\/)?settings\.json$/)}isDefaultWorkspaceSettingsResource(t){return t.authority==="defaultsettings"&&t.scheme===Ie.vscode&&!!t.path.match(/\/(\d+\/)?workspaceSettings\.json$/)}isDefaultFolderSettingsResource(t){return t.authority==="defaultsettings"&&t.scheme===Ie.vscode&&!!t.path.match(/\/(\d+\/)?resourceSettings\.json$/)}getDefaultSettingsResource(t){switch(t){case 5:return le.from({scheme:Ie.vscode,authority:"defaultsettings",path:"/workspaceSettings.json"});case 6:return le.from({scheme:Ie.vscode,authority:"defaultsettings",path:"/resourceSettings.json"})}return le.from({scheme:Ie.vscode,authority:"defaultsettings",path:"/settings.json"})}async getOrCreateEditableSettingsEditorInput(t,n){return await this.createSettingsIfNotExists(t,n),this.textEditorService.createTextEditor({resource:n})}async createEditableSettingsEditorModel(t,n){let i=this.contextService.getWorkspace();if(i.configuration&&i.configuration.toString()===n.toString()){let s=await this.textModelResolverService.createModelReference(n);return this.instantiationService.createInstance(Af,s,t)}let r=await this.textModelResolverService.createModelReference(n);return this.instantiationService.createInstance(Of,r,t)}async createDefaultSettingsEditorModel(t){let n=await this.textModelResolverService.createModelReference(t),i=this.getConfigurationTargetFromDefaultSettingsResource(t);return this.instantiationService.createInstance(rS,t,n,this.getDefaultSettings(i))}getDefaultSettings(t){return t===5?(this._defaultWorkspaceSettingsContentModel??=this._register(new ch(this.getMostCommonlyUsedSettings(),t,this.configurationService)),this._defaultWorkspaceSettingsContentModel):t===6?(this._defaultFolderSettingsContentModel??=this._register(new ch(this.getMostCommonlyUsedSettings(),t,this.configurationService)),this._defaultFolderSettingsContentModel):(this._defaultUserSettingsContentModel??=this._register(new ch(this.getMostCommonlyUsedSettings(),t,this.configurationService)),this._defaultUserSettingsContentModel)}async getEditableSettingsURI(t,n){switch(t){case 1:return this.userDataProfilesService.defaultProfile.settingsResource;case 2:case 3:return this.userSettingsResource;case 4:{let i=await this.remoteAgentService.getEnvironment();return i?i.settingsPath:null}case 5:return this.workspaceSettingsResource;case 6:if(n)return this.getFolderSettingsResource(n)}return null}async createSettingsIfNotExists(t,n){if(this.contextService.getWorkbenchState()===3&&t===5){let i=this.contextService.getWorkspace().configuration;if(!i)return;let r=await this.textFileService.read(i);Object.keys(xM(r.value)).indexOf("settings")===-1&&await this.jsonEditingService.write(n,[{path:["settings"],value:{}}],!0);return}await this.createIfNotExists(n,c8)}async createIfNotExists(t,n){try{await this.textFileService.read(t,{acceptTextOnly:!0})}catch(i){if(i.fileOperationResult===1)try{await this.textFileService.write(t,n);return}catch(r){throw new Error(h("fail.createSettings","Unable to create '{0}' ({1}).",this.labelService.getUriLabel(t,{relative:!0}),cE(r)))}else throw i}}getMostCommonlyUsedSettings(){return["files.autoSave","editor.fontSize","editor.fontFamily","editor.tabSize","editor.renderWhitespace","editor.cursorStyle","editor.multiCursorModifier","editor.insertSpaces","editor.wordWrap","files.exclude","files.associations","workbench.editor.enablePreview"]}async revealSetting(t,n,i,r){let s=i?GA(i.getControl()):null;if(!s)return;let a=await this.createPreferencesEditorModel(r);if(!a)return;let l=await this.getPositionToReveal(t,n,a,s);l&&(s.setPosition(l),s.revealPositionNearTop(l),s.focus(),n&&Wo.get(s)?.triggerSuggest())}async getPositionToReveal(t,n,i,r){let s=r.getModel();if(!s)return null;let a=et.as(nr.Configuration).getConfigurationProperties()[t],l=Ur.test(t);if(!a&&!l)return null;let d=null,c=a?.type??"object",u=i.getPreference(t);if(!u&&n){let p=c==="object"||c==="array"?this.configurationService.inspect(t).defaultValue:dT(c);if(p=p===void 0&&l?{}:p,p!==void 0){let m=i instanceof Af?["settings",t]:[t];await this.jsonEditingService.write(i.uri,[{path:m,value:p}],!1),u=i.getPreference(t)}}if(u)if(n)if(Ht(u.value)||Array.isArray(u.value)){d={lineNumber:u.valueRange.startLineNumber,column:u.valueRange.startColumn+1},r.setPosition(d),await uC.LineBreakInsert.runEditorCommand(null,r,null),d={lineNumber:d.lineNumber+1,column:s.getLineMaxColumn(d.lineNumber+1)};let p=s.getLineFirstNonWhitespaceColumn(d.lineNumber);p&&(r.setPosition({lineNumber:d.lineNumber,column:p}),await uC.LineBreakInsert.runEditorCommand(null,r,null),d={lineNumber:d.lineNumber,column:s.getLineMaxColumn(d.lineNumber)})}else d={lineNumber:u.valueRange.startLineNumber,column:u.valueRange.endColumn};else d={lineNumber:u.keyRange.startLineNumber,column:u.keyRange.startColumn};return d}getSetting(t){if(!this._settingsGroups){let n=this.getDefaultSettings(2),i=this._register(new Wt);i.value=n.onDidChange(()=>{this._settingsGroups=void 0,i.clear()}),this._settingsGroups=n.getSettingsGroups()}for(let n of this._settingsGroups)for(let i of n.sections)for(let r of i.settings)if(Co(r.key,t)===0)return r}async handleURL(t){if(Co(t.authority,M2)!==0)return!1;let n=t.path.split("/").filter(a=>!!a),i=n.length>0?n[0]:void 0;if(!i)return this.openSettings(),!0;let r=this.getSetting(i);!r&&this.extensionService.extensions.length===0&&(await this.progressService.withProgress({location:10},()=>de.toPromise(this.extensionService.onDidRegisterExtensions)),r=this.getSetting(i));let s={};return r&&(s.query=i),this.openSettings(s),!0}dispose(){this._onDispose.fire(),super.dispose()}};kb=K([D(0,Ei),D(1,f2),D(2,nl),D(3,Xt),D(4,ds),D(5,to),D(6,dt),D(7,vW),D(8,tS),D(9,qa),D(10,Oo),D(11,rs),D(12,A2),D(13,Ao),D(14,gh),D(15,Z0),D(16,yW),D(17,cS),D(18,Rf)],kb);Cn(lS,kb,1);export{kb as PreferencesService};
