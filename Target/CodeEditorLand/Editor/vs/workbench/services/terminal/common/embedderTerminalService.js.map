{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/terminal/common/embedderTerminalService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from \"../../../../base/common/event.js\";\nimport { Disposable } from \"../../../../base/common/lifecycle.js\";\nimport {\n\tInstantiationType,\n\tregisterSingleton,\n} from \"../../../../platform/instantiation/common/extensions.js\";\nimport { createDecorator } from \"../../../../platform/instantiation/common/instantiation.js\";\nimport {\n\ttype IProcessDataEvent,\n\ttype IProcessProperty,\n\ttype IProcessPropertyMap,\n\ttype IProcessReadyEvent,\n\ttype IShellLaunchConfig,\n\ttype ITerminalChildProcess,\n\ttype ITerminalLaunchError,\n\tProcessPropertyType,\n} from \"../../../../platform/terminal/common/terminal.js\";\n\nexport const IEmbedderTerminalService =\n\tcreateDecorator<IEmbedderTerminalService>(\"embedderTerminalService\");\n\n/**\n * Manages terminals that the embedder can create before the terminal contrib is available.\n */\nexport interface IEmbedderTerminalService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly onDidCreateTerminal: Event<IShellLaunchConfig>;\n\n\tcreateTerminal(options: IEmbedderTerminalOptions): void;\n}\n\nexport type EmbedderTerminal = IShellLaunchConfig &\n\tRequired<Pick<IShellLaunchConfig, \"customPtyImplementation\">>;\n\nexport interface IEmbedderTerminalOptions {\n\tname: string;\n\tpty: IEmbedderTerminalPty;\n\n\t// Extension APIs that have not been implemented for embedders:\n\t//   iconPath?: URI | { light: URI; dark: URI } | ThemeIcon;\n\t//   color?: ThemeColor;\n\t//   location?: TerminalLocation | TerminalEditorLocationOptions | TerminalSplitLocationOptions;\n\t//   isTransient?: boolean;\n}\n\n/**\n * See Pseudoterminal on the vscode API for usage.\n */\nexport interface IEmbedderTerminalPty {\n\tonDidWrite: Event<string>;\n\tonDidClose?: Event<void | number>;\n\tonDidChangeName?: Event<string>;\n\n\topen(): void;\n\tclose(): void;\n\n\t// Extension APIs that have not been implemented for embedders:\n\t//   onDidOverrideDimensions?: Event<TerminalDimensions | undefined>;\n\t//   handleInput?(data: string): void;\n\t//   setDimensions?(dimensions: TerminalDimensions): void;\n}\n\nclass EmbedderTerminalService implements IEmbedderTerminalService {\n\tdeclare _serviceBrand: undefined;\n\n\tprivate readonly _onDidCreateTerminal = new Emitter<IShellLaunchConfig>();\n\treadonly onDidCreateTerminal = Event.buffer(\n\t\tthis._onDidCreateTerminal.event,\n\t);\n\n\tcreateTerminal(options: IEmbedderTerminalOptions): void {\n\t\tconst slc: EmbedderTerminal = {\n\t\t\tname: options.name,\n\t\t\tisFeatureTerminal: true,\n\t\t\tcustomPtyImplementation(terminalId, cols, rows) {\n\t\t\t\treturn new EmbedderTerminalProcess(terminalId, options.pty);\n\t\t\t},\n\t\t};\n\t\tthis._onDidCreateTerminal.fire(slc);\n\t}\n}\n\nclass EmbedderTerminalProcess\n\textends Disposable\n\timplements ITerminalChildProcess\n{\n\tprivate readonly _pty: IEmbedderTerminalPty;\n\n\treadonly shouldPersist = false;\n\n\treadonly onProcessData: Event<IProcessDataEvent | string>;\n\tprivate readonly _onProcessReady = this._register(\n\t\tnew Emitter<IProcessReadyEvent>(),\n\t);\n\treadonly onProcessReady = this._onProcessReady.event;\n\tprivate readonly _onDidChangeProperty = this._register(\n\t\tnew Emitter<IProcessProperty<any>>(),\n\t);\n\treadonly onDidChangeProperty = this._onDidChangeProperty.event;\n\tprivate readonly _onProcessExit = this._register(\n\t\tnew Emitter<number | undefined>(),\n\t);\n\treadonly onProcessExit = this._onProcessExit.event;\n\n\tconstructor(\n\t\treadonly id: number,\n\t\tpty: IEmbedderTerminalPty,\n\t) {\n\t\tsuper();\n\n\t\tthis._pty = pty;\n\t\tthis.onProcessData = this._pty.onDidWrite;\n\t\tif (this._pty.onDidClose) {\n\t\t\tthis._register(\n\t\t\t\tthis._pty.onDidClose((e) =>\n\t\t\t\t\tthis._onProcessExit.fire(e || undefined),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t\tif (this._pty.onDidChangeName) {\n\t\t\tthis._register(\n\t\t\t\tthis._pty.onDidChangeName((e) =>\n\t\t\t\t\tthis._onDidChangeProperty.fire({\n\t\t\t\t\t\ttype: ProcessPropertyType.Title,\n\t\t\t\t\t\tvalue: e,\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tasync start(): Promise<ITerminalLaunchError | undefined> {\n\t\tthis._onProcessReady.fire({ pid: -1, cwd: \"\", windowsPty: undefined });\n\t\tthis._pty.open();\n\t\treturn undefined;\n\t}\n\tshutdown(): void {\n\t\tthis._pty.close();\n\t}\n\n\t// TODO: A lot of these aren't useful for some implementations of ITerminalChildProcess, should\n\t// they be optional? Should there be a base class for \"external\" consumers to implement?\n\n\tinput(): void {\n\t\t// not supported\n\t}\n\tasync processBinary(): Promise<void> {\n\t\t// not supported\n\t}\n\tresize(): void {\n\t\t// no-op\n\t}\n\tclearBuffer(): void | Promise<void> {\n\t\t// no-op\n\t}\n\tacknowledgeDataEvent(): void {\n\t\t// no-op, flow control not currently implemented\n\t}\n\tasync setUnicodeVersion(): Promise<void> {\n\t\t// no-op\n\t}\n\tasync getInitialCwd(): Promise<string> {\n\t\treturn \"\";\n\t}\n\tasync getCwd(): Promise<string> {\n\t\treturn \"\";\n\t}\n\trefreshProperty<T extends ProcessPropertyType>(\n\t\tproperty: ProcessPropertyType,\n\t): Promise<IProcessPropertyMap[T]> {\n\t\tthrow new Error(\n\t\t\t`refreshProperty is not suppported in EmbedderTerminalProcess. property: ${property}`,\n\t\t);\n\t}\n\n\tupdateProperty(property: ProcessPropertyType, value: any): Promise<void> {\n\t\tthrow new Error(\n\t\t\t`updateProperty is not suppported in EmbedderTerminalProcess. property: ${property}, value: ${value}`,\n\t\t);\n\t}\n}\n\nregisterSingleton(\n\tIEmbedderTerminalService,\n\tEmbedderTerminalService,\n\tInstantiationType.Delayed,\n);\n"],
  "mappings": ";;AAKA,SAAS,SAAS,aAAa;AAC/B,SAAS,kBAAkB;AAC3B;AAAA,EACC;AAAA,EACA;AAAA,OACM;AACP,SAAS,uBAAuB;AAChC;AAAA,EAQC;AAAA,OACM;AAEA,MAAM,2BACZ,gBAA0C,yBAAyB;AA4CpE,MAAM,wBAA4D;AAAA,EApElE,OAoEkE;AAAA;AAAA;AAAA,EAGhD,uBAAuB,IAAI,QAA4B;AAAA,EAC/D,sBAAsB,MAAM;AAAA,IACpC,KAAK,qBAAqB;AAAA,EAC3B;AAAA,EAEA,eAAe,SAAyC;AACvD,UAAM,MAAwB;AAAA,MAC7B,MAAM,QAAQ;AAAA,MACd,mBAAmB;AAAA,MACnB,wBAAwB,YAAY,MAAM,MAAM;AAC/C,eAAO,IAAI,wBAAwB,YAAY,QAAQ,GAAG;AAAA,MAC3D;AAAA,IACD;AACA,SAAK,qBAAqB,KAAK,GAAG;AAAA,EACnC;AACD;AAEA,MAAM,gCACG,WAET;AAAA,EAmBC,YACU,IACT,KACC;AACD,UAAM;AAHG;AAKT,SAAK,OAAO;AACZ,SAAK,gBAAgB,KAAK,KAAK;AAC/B,QAAI,KAAK,KAAK,YAAY;AACzB,WAAK;AAAA,QACJ,KAAK,KAAK;AAAA,UAAW,CAAC,MACrB,KAAK,eAAe,KAAK,KAAK,MAAS;AAAA,QACxC;AAAA,MACD;AAAA,IACD;AACA,QAAI,KAAK,KAAK,iBAAiB;AAC9B,WAAK;AAAA,QACJ,KAAK,KAAK;AAAA,UAAgB,CAAC,MAC1B,KAAK,qBAAqB,KAAK;AAAA,YAC9B,MAAM,oBAAoB;AAAA,YAC1B,OAAO;AAAA,UACR,CAAC;AAAA,QACF;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAvID,OA2FA;AAAA;AAAA;AAAA,EACkB;AAAA,EAER,gBAAgB;AAAA,EAEhB;AAAA,EACQ,kBAAkB,KAAK;AAAA,IACvC,IAAI,QAA4B;AAAA,EACjC;AAAA,EACS,iBAAiB,KAAK,gBAAgB;AAAA,EAC9B,uBAAuB,KAAK;AAAA,IAC5C,IAAI,QAA+B;AAAA,EACpC;AAAA,EACS,sBAAsB,KAAK,qBAAqB;AAAA,EACxC,iBAAiB,KAAK;AAAA,IACtC,IAAI,QAA4B;AAAA,EACjC;AAAA,EACS,gBAAgB,KAAK,eAAe;AAAA,EA6B7C,MAAM,QAAmD;AACxD,SAAK,gBAAgB,KAAK,EAAE,KAAK,IAAI,KAAK,IAAI,YAAY,OAAU,CAAC;AACrE,SAAK,KAAK,KAAK;AACf,WAAO;AAAA,EACR;AAAA,EACA,WAAiB;AAChB,SAAK,KAAK,MAAM;AAAA,EACjB;AAAA;AAAA;AAAA,EAKA,QAAc;AAAA,EAEd;AAAA,EACA,MAAM,gBAA+B;AAAA,EAErC;AAAA,EACA,SAAe;AAAA,EAEf;AAAA,EACA,cAAoC;AAAA,EAEpC;AAAA,EACA,uBAA6B;AAAA,EAE7B;AAAA,EACA,MAAM,oBAAmC;AAAA,EAEzC;AAAA,EACA,MAAM,gBAAiC;AACtC,WAAO;AAAA,EACR;AAAA,EACA,MAAM,SAA0B;AAC/B,WAAO;AAAA,EACR;AAAA,EACA,gBACC,UACkC;AAClC,UAAM,IAAI;AAAA,MACT,2EAA2E,QAAQ;AAAA,IACpF;AAAA,EACD;AAAA,EAEA,eAAe,UAA+B,OAA2B;AACxE,UAAM,IAAI;AAAA,MACT,0EAA0E,QAAQ,YAAY,KAAK;AAAA,IACpG;AAAA,EACD;AACD;AAEA;AAAA,EACC;AAAA,EACA;AAAA,EACA,kBAAkB;AACnB;",
  "names": []
}
