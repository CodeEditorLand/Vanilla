function f(c,e,t=!0){for(let n=e.length-1;n>=0;n--){const i=e.slice(0,n),o=e[n],r=p(c,o,i,t);if(r)return r}return null}function p(c,e,t,n){let i=null;for(let o=c.tokenColors.length-1;o>=0;o--){const r=c.tokenColors[o];if(n&&!r.settings.foreground)continue;let s;if(typeof r.scope=="string")s=r.scope.split(/,/).map(l=>l.trim());else if(Array.isArray(r.scope))s=r.scope;else continue;for(let l=0,g=s.length;l<g;l++){const h=s[l],a=new u(h,r.settings);a.matches(e,t)&&a.isMoreSpecific(i)&&(i=a)}}return i}class u{rawSelector;settings;scope;parentScopes;constructor(e,t){this.rawSelector=e,this.settings=t;const n=this.rawSelector.split(/ /);this.scope=n[n.length-1],this.parentScopes=n.slice(0,n.length-1)}matches(e,t){return u._matches(this.scope,this.parentScopes,e,t)}static _cmp(e,t){if(e===null&&t===null)return 0;if(e===null)return-1;if(t===null)return 1;if(e.scope.length!==t.scope.length)return e.scope.length-t.scope.length;const n=e.parentScopes.length,i=t.parentScopes.length;if(n!==i)return n-i;for(let o=0;o<n;o++){const r=e.parentScopes[o].length,s=t.parentScopes[o].length;if(r!==s)return r-s}return 0}isMoreSpecific(e){return u._cmp(this,e)>0}static _matchesOne(e,t){const n=e+".";return e===t||t.substring(0,n.length)===n}static _matches(e,t,n,i){if(!this._matchesOne(e,n))return!1;let o=t.length-1,r=i.length-1;for(;o>=0&&r>=0;)this._matchesOne(t[o],i[r])&&o--,r--;return o===-1}}export{u as ThemeRule,f as findMatchingThemeRule};
