function f(s,e,t=!0){for(let n=e.length-1;n>=0;n--){let i=e.slice(0,n),o=e[n],r=p(s,o,i,t);if(r)return r}return null}function p(s,e,t,n){let i=null;for(let o=s.tokenColors.length-1;o>=0;o--){let r=s.tokenColors[o];if(n&&!r.settings.foreground)continue;let l;if(typeof r.scope=="string")l=r.scope.split(/,/).map(c=>c.trim());else if(Array.isArray(r.scope))l=r.scope;else continue;for(let c=0,g=l.length;c<g;c++){let h=l[c],a=new u(h,r.settings);a.matches(e,t)&&a.isMoreSpecific(i)&&(i=a)}}return i}var u=class s{rawSelector;settings;scope;parentScopes;constructor(e,t){this.rawSelector=e,this.settings=t;let n=this.rawSelector.split(/ /);this.scope=n[n.length-1],this.parentScopes=n.slice(0,n.length-1)}matches(e,t){return s._matches(this.scope,this.parentScopes,e,t)}static _cmp(e,t){if(e===null&&t===null)return 0;if(e===null)return-1;if(t===null)return 1;if(e.scope.length!==t.scope.length)return e.scope.length-t.scope.length;let n=e.parentScopes.length,i=t.parentScopes.length;if(n!==i)return n-i;for(let o=0;o<n;o++){let r=e.parentScopes[o].length,l=t.parentScopes[o].length;if(r!==l)return r-l}return 0}isMoreSpecific(e){return s._cmp(this,e)>0}static _matchesOne(e,t){let n=e+".";return e===t||t.substring(0,n.length)===n}static _matches(e,t,n,i){if(!this._matchesOne(e,n))return!1;let o=t.length-1,r=i.length-1;for(;o>=0&&r>=0;)this._matchesOne(t[o],i[r])&&o--,r--;return o===-1}};export{u as ThemeRule,f as findMatchingThemeRule};
