{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/textMate/common/TMHelper.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport interface IColorTheme {\n\treadonly tokenColors: ITokenColorizationRule[];\n}\n\nexport interface ITokenColorizationRule {\n\tname?: string;\n\tscope?: string | string[];\n\tsettings: ITokenColorizationSetting;\n}\n\nexport interface ITokenColorizationSetting {\n\tforeground?: string;\n\tbackground?: string;\n\tfontStyle?: string;  // italic, underline, strikethrough, bold\n}\n\nexport function findMatchingThemeRule(theme: IColorTheme, scopes: string[], onlyColorRules: boolean = true): ThemeRule | null {\n\tfor (let i = scopes.length - 1; i >= 0; i--) {\n\t\tconst parentScopes = scopes.slice(0, i);\n\t\tconst scope = scopes[i];\n\t\tconst r = findMatchingThemeRule2(theme, scope, parentScopes, onlyColorRules);\n\t\tif (r) {\n\t\t\treturn r;\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findMatchingThemeRule2(theme: IColorTheme, scope: string, parentScopes: string[], onlyColorRules: boolean): ThemeRule | null {\n\tlet result: ThemeRule | null = null;\n\n\t// Loop backwards, to ensure the last most specific rule wins\n\tfor (let i = theme.tokenColors.length - 1; i >= 0; i--) {\n\t\tconst rule = theme.tokenColors[i];\n\t\tif (onlyColorRules && !rule.settings.foreground) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet selectors: string[];\n\t\tif (typeof rule.scope === 'string') {\n\t\t\tselectors = rule.scope.split(/,/).map(scope => scope.trim());\n\t\t} else if (Array.isArray(rule.scope)) {\n\t\t\tselectors = rule.scope;\n\t\t} else {\n\t\t\tcontinue;\n\t\t}\n\n\t\tfor (let j = 0, lenJ = selectors.length; j < lenJ; j++) {\n\t\t\tconst rawSelector = selectors[j];\n\n\t\t\tconst themeRule = new ThemeRule(rawSelector, rule.settings);\n\t\t\tif (themeRule.matches(scope, parentScopes)) {\n\t\t\t\tif (themeRule.isMoreSpecific(result)) {\n\t\t\t\t\tresult = themeRule;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport class ThemeRule {\n\treadonly rawSelector: string;\n\treadonly settings: ITokenColorizationSetting;\n\treadonly scope: string;\n\treadonly parentScopes: string[];\n\n\tconstructor(rawSelector: string, settings: ITokenColorizationSetting) {\n\t\tthis.rawSelector = rawSelector;\n\t\tthis.settings = settings;\n\t\tconst rawSelectorPieces = this.rawSelector.split(/ /);\n\t\tthis.scope = rawSelectorPieces[rawSelectorPieces.length - 1];\n\t\tthis.parentScopes = rawSelectorPieces.slice(0, rawSelectorPieces.length - 1);\n\t}\n\n\tpublic matches(scope: string, parentScopes: string[]): boolean {\n\t\treturn ThemeRule._matches(this.scope, this.parentScopes, scope, parentScopes);\n\t}\n\n\tprivate static _cmp(a: ThemeRule | null, b: ThemeRule | null): number {\n\t\tif (a === null && b === null) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (a === null) {\n\t\t\t// b > a\n\t\t\treturn -1;\n\t\t}\n\t\tif (b === null) {\n\t\t\t// a > b\n\t\t\treturn 1;\n\t\t}\n\t\tif (a.scope.length !== b.scope.length) {\n\t\t\t// longer scope length > shorter scope length\n\t\t\treturn a.scope.length - b.scope.length;\n\t\t}\n\t\tconst aParentScopesLen = a.parentScopes.length;\n\t\tconst bParentScopesLen = b.parentScopes.length;\n\t\tif (aParentScopesLen !== bParentScopesLen) {\n\t\t\t// more parents > less parents\n\t\t\treturn aParentScopesLen - bParentScopesLen;\n\t\t}\n\t\tfor (let i = 0; i < aParentScopesLen; i++) {\n\t\t\tconst aLen = a.parentScopes[i].length;\n\t\t\tconst bLen = b.parentScopes[i].length;\n\t\t\tif (aLen !== bLen) {\n\t\t\t\treturn aLen - bLen;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic isMoreSpecific(other: ThemeRule | null): boolean {\n\t\treturn (ThemeRule._cmp(this, other) > 0);\n\t}\n\n\tprivate static _matchesOne(selectorScope: string, scope: string): boolean {\n\t\tconst selectorPrefix = selectorScope + '.';\n\t\tif (selectorScope === scope || scope.substring(0, selectorPrefix.length) === selectorPrefix) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate static _matches(selectorScope: string, selectorParentScopes: string[], scope: string, parentScopes: string[]): boolean {\n\t\tif (!this._matchesOne(selectorScope, scope)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet selectorParentIndex = selectorParentScopes.length - 1;\n\t\tlet parentIndex = parentScopes.length - 1;\n\t\twhile (selectorParentIndex >= 0 && parentIndex >= 0) {\n\t\t\tif (this._matchesOne(selectorParentScopes[selectorParentIndex], parentScopes[parentIndex])) {\n\t\t\t\tselectorParentIndex--;\n\t\t\t}\n\t\t\tparentIndex--;\n\t\t}\n\n\t\tif (selectorParentIndex === -1) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["scope"]
}
