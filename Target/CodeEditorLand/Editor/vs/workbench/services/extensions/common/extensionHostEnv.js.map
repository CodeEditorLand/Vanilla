{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/extensions/common/extensionHostEnv.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { IProcessEnvironment } from \"../../../../base/common/platform.js\";\n\nexport enum ExtHostConnectionType {\n\tIPC = 1,\n\tSocket = 2,\n\tMessagePort = 3,\n}\n\n/**\n * The extension host will connect via named pipe / domain socket to its renderer.\n */\nexport class IPCExtHostConnection {\n\tpublic static ENV_KEY = \"VSCODE_EXTHOST_IPC_HOOK\";\n\n\tpublic readonly type = ExtHostConnectionType.IPC;\n\n\tconstructor(public readonly pipeName: string) {}\n\n\tpublic serialize(env: IProcessEnvironment): void {\n\t\tenv[IPCExtHostConnection.ENV_KEY] = this.pipeName;\n\t}\n}\n\n/**\n * The extension host will receive via nodejs IPC the socket to its renderer.\n */\nexport class SocketExtHostConnection {\n\tpublic static ENV_KEY = \"VSCODE_EXTHOST_WILL_SEND_SOCKET\";\n\n\tpublic readonly type = ExtHostConnectionType.Socket;\n\n\tpublic serialize(env: IProcessEnvironment): void {\n\t\tenv[SocketExtHostConnection.ENV_KEY] = \"1\";\n\t}\n}\n\n/**\n * The extension host will receive via nodejs IPC the MessagePort to its renderer.\n */\nexport class MessagePortExtHostConnection {\n\tpublic static ENV_KEY = \"VSCODE_WILL_SEND_MESSAGE_PORT\";\n\n\tpublic readonly type = ExtHostConnectionType.MessagePort;\n\n\tpublic serialize(env: IProcessEnvironment): void {\n\t\tenv[MessagePortExtHostConnection.ENV_KEY] = \"1\";\n\t}\n}\n\nexport type ExtHostConnection =\n\t| IPCExtHostConnection\n\t| SocketExtHostConnection\n\t| MessagePortExtHostConnection;\n\nfunction clean(env: IProcessEnvironment): void {\n\tdelete env[IPCExtHostConnection.ENV_KEY];\n\tdelete env[SocketExtHostConnection.ENV_KEY];\n\tdelete env[MessagePortExtHostConnection.ENV_KEY];\n}\n\n/**\n * Write `connection` into `env` and clean up `env`.\n */\nexport function writeExtHostConnection(\n\tconnection: ExtHostConnection,\n\tenv: IProcessEnvironment,\n): void {\n\t// Avoid having two different keys that might introduce amiguity or problems.\n\tclean(env);\n\tconnection.serialize(env);\n}\n\n/**\n * Read `connection` from `env` and clean up `env`.\n */\nexport function readExtHostConnection(\n\tenv: IProcessEnvironment,\n): ExtHostConnection {\n\tif (env[IPCExtHostConnection.ENV_KEY]) {\n\t\treturn cleanAndReturn(\n\t\t\tenv,\n\t\t\tnew IPCExtHostConnection(env[IPCExtHostConnection.ENV_KEY]!),\n\t\t);\n\t}\n\tif (env[SocketExtHostConnection.ENV_KEY]) {\n\t\treturn cleanAndReturn(env, new SocketExtHostConnection());\n\t}\n\tif (env[MessagePortExtHostConnection.ENV_KEY]) {\n\t\treturn cleanAndReturn(env, new MessagePortExtHostConnection());\n\t}\n\tthrow new Error(`No connection information defined in environment!`);\n}\n\nfunction cleanAndReturn(\n\tenv: IProcessEnvironment,\n\tresult: ExtHostConnection,\n): ExtHostConnection {\n\tclean(env);\n\treturn result;\n}\n"],
  "mappings": ";;AAOO,IAAK,wBAAL,kBAAKA,2BAAL;AACN,EAAAA,8CAAA,SAAM,KAAN;AACA,EAAAA,8CAAA,YAAS,KAAT;AACA,EAAAA,8CAAA,iBAAc,KAAd;AAHW,SAAAA;AAAA,GAAA;AASL,MAAM,qBAAqB;AAAA,EAKjC,YAA4B,UAAkB;AAAlB;AAAA,EAAmB;AAAA,EArBhD,OAgBkC;AAAA;AAAA;AAAA,EACjC,OAAc,UAAU;AAAA,EAER,OAAO;AAAA,EAIhB,UAAU,KAAgC;AAChD,QAAI,qBAAqB,OAAO,IAAI,KAAK;AAAA,EAC1C;AACD;AAKO,MAAM,wBAAwB;AAAA,EA/BrC,OA+BqC;AAAA;AAAA;AAAA,EACpC,OAAc,UAAU;AAAA,EAER,OAAO;AAAA,EAEhB,UAAU,KAAgC;AAChD,QAAI,wBAAwB,OAAO,IAAI;AAAA,EACxC;AACD;AAKO,MAAM,6BAA6B;AAAA,EA5C1C,OA4C0C;AAAA;AAAA;AAAA,EACzC,OAAc,UAAU;AAAA,EAER,OAAO;AAAA,EAEhB,UAAU,KAAgC;AAChD,QAAI,6BAA6B,OAAO,IAAI;AAAA,EAC7C;AACD;AAOA,SAAS,MAAM,KAAgC;AAC9C,SAAO,IAAI,qBAAqB,OAAO;AACvC,SAAO,IAAI,wBAAwB,OAAO;AAC1C,SAAO,IAAI,6BAA6B,OAAO;AAChD;AAJS;AASF,SAAS,uBACf,YACA,KACO;AAEP,QAAM,GAAG;AACT,aAAW,UAAU,GAAG;AACzB;AAPgB;AAYT,SAAS,sBACf,KACoB;AACpB,MAAI,IAAI,qBAAqB,OAAO,GAAG;AACtC,WAAO;AAAA,MACN;AAAA,MACA,IAAI,qBAAqB,IAAI,qBAAqB,OAAO,CAAE;AAAA,IAC5D;AAAA,EACD;AACA,MAAI,IAAI,wBAAwB,OAAO,GAAG;AACzC,WAAO,eAAe,KAAK,IAAI,wBAAwB,CAAC;AAAA,EACzD;AACA,MAAI,IAAI,6BAA6B,OAAO,GAAG;AAC9C,WAAO,eAAe,KAAK,IAAI,6BAA6B,CAAC;AAAA,EAC9D;AACA,QAAM,IAAI,MAAM,mDAAmD;AACpE;AAhBgB;AAkBhB,SAAS,eACR,KACA,QACoB;AACpB,QAAM,GAAG;AACT,SAAO;AACR;AANS;",
  "names": ["ExtHostConnectionType"]
}
