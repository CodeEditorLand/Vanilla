var m=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var c=(n,t,e,r)=>{for(var i=r>1?void 0:r?P(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&m(t,e,i),i},a=(n,t)=>(e,r)=>t(e,r,n);import{IUriIdentityService as d}from"../../../../platform/uriIdentity/common/uriIdentity.js";import{IUserDataProfilesService as v}from"../../../../platform/userDataProfile/common/userDataProfile.js";import{IRemoteUserDataProfilesService as I}from"../../userDataProfile/common/remoteUserDataProfiles.js";import{IUserDataProfileService as p}from"../../userDataProfile/common/userDataProfile.js";import{ProfileAwareExtensionManagementChannelClient as U}from"./extensionManagementChannelClient.js";let f=class extends U{constructor(e,r,i,o,s){super(e,r,s);this.userDataProfilesService=i;this.remoteUserDataProfilesService=o}async filterEvent(e,r){if(r||!e&&this.userDataProfileService.currentProfile.isDefault)return!0;const i=await this.remoteUserDataProfilesService.getRemoteProfile(this.userDataProfileService.currentProfile);return!!this.uriIdentityService.extUri.isEqual(i.extensionsResource,e)}async getProfileLocation(e){if(!e&&this.userDataProfileService.currentProfile.isDefault)return;e=await super.getProfileLocation(e);let r=this.userDataProfilesService.profiles.find(i=>this.uriIdentityService.extUri.isEqual(i.extensionsResource,e));return r?r=await this.remoteUserDataProfilesService.getRemoteProfile(r):r=(await this.remoteUserDataProfilesService.getRemoteProfiles()).find(i=>this.uriIdentityService.extUri.isEqual(i.extensionsResource,e)),r?.extensionsResource}async switchExtensionsProfile(e,r,i){const o=await this.remoteUserDataProfilesService.getRemoteProfiles(),s=o.find(l=>this.uriIdentityService.extUri.isEqual(l.extensionsResource,e)),u=o.find(l=>this.uriIdentityService.extUri.isEqual(l.extensionsResource,r));return s?.id===u?.id?{added:[],removed:[]}:super.switchExtensionsProfile(e,r,i)}};f=c([a(1,p),a(2,v),a(3,I),a(4,d)],f);export{f as RemoteExtensionManagementService};
