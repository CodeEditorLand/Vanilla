var S=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var c=(a,e,t,o)=>{for(var n=o>1?void 0:o?I(e,t):e,i=a.length-1,r;i>=0;i--)(r=a[i])&&(n=(o?r(e,t,n):r(n))||n);return o&&n&&S(e,t,n),n},s=(a,e)=>(t,o)=>e(t,o,a);import{Disposable as E}from"../../../../base/common/lifecycle.js";import{Schemas as l}from"../../../../base/common/network.js";import{localize as g}from"../../../../nls.js";import{InstantiationType as p,registerSingleton as M}from"../../../../platform/instantiation/common/extensions.js";import{IInstantiationService as h}from"../../../../platform/instantiation/common/instantiation.js";import{ISharedProcessService as f}from"../../../../platform/ipc/electron-sandbox/services.js";import{ILabelService as d}from"../../../../platform/label/common/label.js";import{IRemoteAgentService as u}from"../../remote/common/remoteAgentService.js";import{ExtensionInstallLocation as v,IExtensionManagementServerService as y}from"../common/extensionManagement.js";import{NativeExtensionManagementService as b}from"./nativeExtensionManagementService.js";import{NativeRemoteExtensionManagementService as L}from"./remoteExtensionManagementService.js";let m=class extends E{localExtensionManagementServer;remoteExtensionManagementServer=null;webExtensionManagementServer=null;constructor(e,t,o,n){super();const i=this._register(n.createInstance(b,e.getChannel("extensions")));this.localExtensionManagementServer={extensionManagementService:i,id:"local",label:g("local","Local")};const r=t.getConnection();if(r){const x=n.createInstance(L,r.getChannel("extensions"),this.localExtensionManagementServer);this.remoteExtensionManagementServer={id:"remote",extensionManagementService:x,get label(){return o.getHostLabel(l.vscodeRemote,r.remoteAuthority)||g("remote","Remote")}}}}getExtensionManagementServer(e){if(e.location.scheme===l.file)return this.localExtensionManagementServer;if(this.remoteExtensionManagementServer&&e.location.scheme===l.vscodeRemote)return this.remoteExtensionManagementServer;throw new Error(`Invalid Extension ${e.location}`)}getExtensionInstallLocation(e){return this.getExtensionManagementServer(e)===this.remoteExtensionManagementServer?v.Remote:v.Local}};m=c([s(0,f),s(1,u),s(2,d),s(3,h)],m),M(y,m,p.Delayed);export{m as ExtensionManagementServerService};
