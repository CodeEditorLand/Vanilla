{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/extensionManagement/electron-sandbox/extensionManagementServerService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from '../../../../nls.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { ExtensionInstallLocation, IExtensionManagementServer, IExtensionManagementServerService } from '../common/extensionManagement.js';\nimport { IRemoteAgentService } from '../../remote/common/remoteAgentService.js';\nimport { IChannel } from '../../../../base/parts/ipc/common/ipc.js';\nimport { ISharedProcessService } from '../../../../platform/ipc/electron-sandbox/services.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { NativeRemoteExtensionManagementService } from './remoteExtensionManagementService.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IExtension } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { NativeExtensionManagementService } from './nativeExtensionManagementService.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\n\nexport class ExtensionManagementServerService extends Disposable implements IExtensionManagementServerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\treadonly localExtensionManagementServer: IExtensionManagementServer;\n\treadonly remoteExtensionManagementServer: IExtensionManagementServer | null = null;\n\treadonly webExtensionManagementServer: IExtensionManagementServer | null = null;\n\n\tconstructor(\n\t\t@ISharedProcessService sharedProcessService: ISharedProcessService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tconst localExtensionManagementService = this._register(instantiationService.createInstance(NativeExtensionManagementService, sharedProcessService.getChannel('extensions')));\n\t\tthis.localExtensionManagementServer = { extensionManagementService: localExtensionManagementService, id: 'local', label: localize('local', \"Local\") };\n\t\tconst remoteAgentConnection = remoteAgentService.getConnection();\n\t\tif (remoteAgentConnection) {\n\t\t\tconst extensionManagementService = instantiationService.createInstance(NativeRemoteExtensionManagementService, remoteAgentConnection.getChannel<IChannel>('extensions'), this.localExtensionManagementServer);\n\t\t\tthis.remoteExtensionManagementServer = {\n\t\t\t\tid: 'remote',\n\t\t\t\textensionManagementService,\n\t\t\t\tget label() { return labelService.getHostLabel(Schemas.vscodeRemote, remoteAgentConnection.remoteAuthority) || localize('remote', \"Remote\"); },\n\t\t\t};\n\t\t}\n\n\t}\n\n\tgetExtensionManagementServer(extension: IExtension): IExtensionManagementServer {\n\t\tif (extension.location.scheme === Schemas.file) {\n\t\t\treturn this.localExtensionManagementServer;\n\t\t}\n\t\tif (this.remoteExtensionManagementServer && extension.location.scheme === Schemas.vscodeRemote) {\n\t\t\treturn this.remoteExtensionManagementServer;\n\t\t}\n\t\tthrow new Error(`Invalid Extension ${extension.location}`);\n\t}\n\n\tgetExtensionInstallLocation(extension: IExtension): ExtensionInstallLocation | null {\n\t\tconst server = this.getExtensionManagementServer(extension);\n\t\treturn server === this.remoteExtensionManagementServer ? ExtensionInstallLocation.Remote : ExtensionInstallLocation.Local;\n\t}\n}\n\nregisterSingleton(IExtensionManagementServerService, ExtensionManagementServerService, InstantiationType.Delayed);\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,gBAAgB;AACzB,SAAS,eAAe;AACxB,SAAS,0BAA0B,4BAA4B,yCAAyC;AACxG,SAAS,2BAA2B;AACpC,SAAS,gBAAgB;AACzB,SAAS,6BAA6B;AACtC,SAAS,mBAAmB,yBAAyB;AACrD,SAAS,8CAA8C;AACvD,SAAS,qBAAqB;AAC9B,SAAS,kBAAkB;AAC3B,SAAS,6BAA6B;AACtC,SAAS,wCAAwC;AACjD,SAAS,kBAAkB;AAEpB,IAAM,mCAAN,cAA+C,WAAwD;AAAA,EAnB9G,OAmB8G;AAAA;AAAA;AAAA,EAIpG;AAAA,EACA,kCAAqE;AAAA,EACrE,+BAAkE;AAAA,EAE3E,YACwB,sBACF,oBACN,cACQ,sBACtB;AACD,UAAM;AACN,UAAM,kCAAkC,KAAK,UAAU,qBAAqB,eAAe,kCAAkC,qBAAqB,WAAW,YAAY,CAAC,CAAC;AAC3K,SAAK,iCAAiC,EAAE,4BAA4B,iCAAiC,IAAI,SAAS,OAAO,SAAS,SAAS,OAAO,EAAE;AACpJ,UAAM,wBAAwB,mBAAmB,cAAc;AAC/D,QAAI,uBAAuB;AAC1B,YAAM,6BAA6B,qBAAqB,eAAe,wCAAwC,sBAAsB,WAAqB,YAAY,GAAG,KAAK,8BAA8B;AAC5M,WAAK,kCAAkC;AAAA,QACtC,IAAI;AAAA,QACJ;AAAA,QACA,IAAI,QAAQ;AAAE,iBAAO,aAAa,aAAa,QAAQ,cAAc,sBAAsB,eAAe,KAAK,SAAS,UAAU,QAAQ;AAAA,QAAG;AAAA,MAC9I;AAAA,IACD;AAAA,EAED;AAAA,EAEA,6BAA6B,WAAmD;AAC/E,QAAI,UAAU,SAAS,WAAW,QAAQ,MAAM;AAC/C,aAAO,KAAK;AAAA,IACb;AACA,QAAI,KAAK,mCAAmC,UAAU,SAAS,WAAW,QAAQ,cAAc;AAC/F,aAAO,KAAK;AAAA,IACb;AACA,UAAM,IAAI,MAAM,qBAAqB,UAAU,QAAQ,EAAE;AAAA,EAC1D;AAAA,EAEA,4BAA4B,WAAwD;AACnF,UAAM,SAAS,KAAK,6BAA6B,SAAS;AAC1D,WAAO,WAAW,KAAK,kCAAkC,yBAAyB,SAAS,yBAAyB;AAAA,EACrH;AACD;AA3Ca,mCAAN;AAAA,EASJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAZU;AA6Cb,kBAAkB,mCAAmC,kCAAkC,kBAAkB,OAAO;",
  "names": []
}
