var p=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var v=(n,r,o,e)=>{for(var t=e>1?void 0:e?f(r,o):r,i=n.length-1,s;i>=0;i--)(s=n[i])&&(t=(e?s(r,o,t):s(t))||t);return e&&t&&p(r,o,t),t},m=(n,r)=>(o,e)=>r(o,e,n);import{Schemas as l}from"../../../../base/common/network.js";import{OS as c,OperatingSystem as g}from"../../../../base/common/platform.js";import{ITextResourcePropertiesService as h}from"../../../../editor/common/services/textResourceConfiguration.js";import{IConfigurationService as I}from"../../../../platform/configuration/common/configuration.js";import{InstantiationType as u,registerSingleton as y}from"../../../../platform/instantiation/common/extensions.js";import{IStorageService as E,StorageScope as S,StorageTarget as d}from"../../../../platform/storage/common/storage.js";import{IWorkbenchEnvironmentService as A}from"../../environment/common/environmentService.js";import{IRemoteAgentService as O}from"../../remote/common/remoteAgentService.js";let a=class{constructor(r,o,e,t){this.configurationService=r;this.environmentService=e;this.storageService=t;o.getEnvironment().then(i=>this.remoteEnvironment=i)}remoteEnvironment=null;getEOL(r,o){const e=this.configurationService.getValue("files.eol",{overrideIdentifier:o,resource:r});if(e&&typeof e=="string"&&e!=="auto")return e;const t=this.getOS(r);return t===g.Linux||t===g.Macintosh?`
`:`\r
`}getOS(r){let o=c;const e=this.environmentService.remoteAuthority;if(e&&r&&r.scheme!==l.file){const t=`resource.authority.os.${e}`;o=this.remoteEnvironment?this.remoteEnvironment.os:this.storageService.getNumber(t,S.WORKSPACE,c),this.storageService.store(t,o,S.WORKSPACE,d.MACHINE)}return o}};a=v([m(0,I),m(1,O),m(2,A),m(3,E)],a),y(h,a,u.Delayed);export{a as TextResourcePropertiesService};
