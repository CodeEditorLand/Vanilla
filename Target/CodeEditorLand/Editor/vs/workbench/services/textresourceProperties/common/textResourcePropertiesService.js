var f=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var v=(n,r,o,e)=>{for(var t=e>1?void 0:e?p(r,o):r,i=n.length-1,s;i>=0;i--)(s=n[i])&&(t=(e?s(r,o,t):s(t))||t);return e&&t&&f(r,o,t),t},m=(n,r)=>(o,e)=>r(o,e,n);import"../../../../base/common/uri.js";import{IConfigurationService as l}from"../../../../platform/configuration/common/configuration.js";import{ITextResourcePropertiesService as h}from"../../../../editor/common/services/textResourceConfiguration.js";import{OperatingSystem as c,OS as g}from"../../../../base/common/platform.js";import{Schemas as I}from"../../../../base/common/network.js";import{IStorageService as u,StorageScope as S,StorageTarget as y}from"../../../../platform/storage/common/storage.js";import{IWorkbenchEnvironmentService as E}from"../../environment/common/environmentService.js";import{InstantiationType as d,registerSingleton as A}from"../../../../platform/instantiation/common/extensions.js";import"../../../../platform/remote/common/remoteAgentEnvironment.js";import{IRemoteAgentService as O}from"../../remote/common/remoteAgentService.js";let a=class{constructor(r,o,e,t){this.configurationService=r;this.environmentService=e;this.storageService=t;o.getEnvironment().then(i=>this.remoteEnvironment=i)}remoteEnvironment=null;getEOL(r,o){const e=this.configurationService.getValue("files.eol",{overrideIdentifier:o,resource:r});if(e&&typeof e=="string"&&e!=="auto")return e;const t=this.getOS(r);return t===c.Linux||t===c.Macintosh?`
`:`\r
`}getOS(r){let o=g;const e=this.environmentService.remoteAuthority;if(e&&r&&r.scheme!==I.file){const t=`resource.authority.os.${e}`;o=this.remoteEnvironment?this.remoteEnvironment.os:this.storageService.getNumber(t,S.WORKSPACE,g),this.storageService.store(t,o,S.WORKSPACE,y.MACHINE)}return o}};a=v([m(0,l),m(1,O),m(2,E),m(3,u)],a),A(h,a,d.Delayed);export{a as TextResourcePropertiesService};
