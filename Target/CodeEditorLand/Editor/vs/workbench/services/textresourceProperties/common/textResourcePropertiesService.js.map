{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/textresourceProperties/common/textResourcePropertiesService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from \"../../../../base/common/network.js\";\nimport { OS, OperatingSystem } from \"../../../../base/common/platform.js\";\nimport type { URI } from \"../../../../base/common/uri.js\";\nimport { ITextResourcePropertiesService } from \"../../../../editor/common/services/textResourceConfiguration.js\";\nimport { IConfigurationService } from \"../../../../platform/configuration/common/configuration.js\";\nimport {\n\tInstantiationType,\n\tregisterSingleton,\n} from \"../../../../platform/instantiation/common/extensions.js\";\nimport type { IRemoteAgentEnvironment } from \"../../../../platform/remote/common/remoteAgentEnvironment.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../../../platform/storage/common/storage.js\";\nimport { IWorkbenchEnvironmentService } from \"../../environment/common/environmentService.js\";\nimport { IRemoteAgentService } from \"../../remote/common/remoteAgentService.js\";\n\nexport class TextResourcePropertiesService\n\timplements ITextResourcePropertiesService\n{\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate remoteEnvironment: IRemoteAgentEnvironment | null = null;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tremoteAgentService.getEnvironment().then(remoteEnv => this.remoteEnvironment = remoteEnv);\n\t}\n\n\tgetEOL(resource?: URI, language?: string): string {\n\t\tconst eol = this.configurationService.getValue(\"files.eol\", {\n\t\t\toverrideIdentifier: language,\n\t\t\tresource,\n\t\t});\n\t\tif (eol && typeof eol === \"string\" && eol !== \"auto\") {\n\t\t\treturn eol;\n\t\t}\n\t\tconst os = this.getOS(resource);\n\t\treturn os === OperatingSystem.Linux || os === OperatingSystem.Macintosh\n\t\t\t? \"\\n\"\n\t\t\t: \"\\r\\n\";\n\t}\n\n\tprivate getOS(resource?: URI): OperatingSystem {\n\t\tlet os = OS;\n\n\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\tif (remoteAuthority) {\n\t\t\tif (resource && resource.scheme !== Schemas.file) {\n\t\t\t\tconst osCacheKey = `resource.authority.os.${remoteAuthority}`;\n\t\t\t\tos = this.remoteEnvironment\n\t\t\t\t\t? this.remoteEnvironment.os\n\t\t\t\t\t: /* Get it from cache */ this.storageService.getNumber(\n\t\t\t\t\t\t\tosCacheKey,\n\t\t\t\t\t\t\tStorageScope.WORKSPACE,\n\t\t\t\t\t\t\tOS,\n\t\t\t\t\t\t);\n\t\t\t\tthis.storageService.store(\n\t\t\t\t\tosCacheKey,\n\t\t\t\t\tos,\n\t\t\t\t\tStorageScope.WORKSPACE,\n\t\t\t\t\tStorageTarget.MACHINE,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn os;\n\t}\n}\n\nregisterSingleton(\n\tITextResourcePropertiesService,\n\tTextResourcePropertiesService,\n\tInstantiationType.Delayed,\n);\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,eAAe;AACxB,SAAS,IAAI,uBAAuB;AAEpC,SAAS,sCAAsC;AAC/C,SAAS,6BAA6B;AACtC;AAAA,EACC;AAAA,EACA;AAAA,OACM;AAEP;AAAA,EACC;AAAA,EACA;AAAA,EACA;AAAA,OACM;AACP,SAAS,oCAAoC;AAC7C,SAAS,2BAA2B;AAE7B,IAAM,gCAAN,MAEP;AAAA,EAKC,YACyC,sBACnB,oBAC0B,oBACb,gBACjC;AAJuC;AAEO;AACb;AAElC,uBAAmB,eAAe,EAAE,KAAK,eAAa,KAAK,oBAAoB,SAAS;AAAA,EACzF;AAAA,EArCD,OAyBA;AAAA;AAAA;AAAA,EAGS,oBAAoD;AAAA,EAW5D,OAAO,UAAgB,UAA2B;AACjD,UAAM,MAAM,KAAK,qBAAqB,SAAS,aAAa;AAAA,MAC3D,oBAAoB;AAAA,MACpB;AAAA,IACD,CAAC;AACD,QAAI,OAAO,OAAO,QAAQ,YAAY,QAAQ,QAAQ;AACrD,aAAO;AAAA,IACR;AACA,UAAM,KAAK,KAAK,MAAM,QAAQ;AAC9B,WAAO,OAAO,gBAAgB,SAAS,OAAO,gBAAgB,YAC3D,OACA;AAAA,EACJ;AAAA,EAEQ,MAAM,UAAiC;AAC9C,QAAI,KAAK;AAET,UAAM,kBAAkB,KAAK,mBAAmB;AAChD,QAAI,iBAAiB;AACpB,UAAI,YAAY,SAAS,WAAW,QAAQ,MAAM;AACjD,cAAM,aAAa,yBAAyB,eAAe;AAC3D,aAAK,KAAK,oBACP,KAAK,kBAAkB;AAAA;AAAA,UACC,KAAK,eAAe;AAAA,YAC5C;AAAA,YACA,aAAa;AAAA,YACb;AAAA,UACD;AAAA;AACF,aAAK,eAAe;AAAA,UACnB;AAAA,UACA;AAAA,UACA,aAAa;AAAA,UACb,cAAc;AAAA,QACf;AAAA,MACD;AAAA,IACD;AAEA,WAAO;AAAA,EACR;AACD;AAvDa,gCAAN;AAAA,EAQJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAXU;AAyDb;AAAA,EACC;AAAA,EACA;AAAA,EACA,kBAAkB;AACnB;",
  "names": []
}
