{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/services/textresourceProperties/common/textResourcePropertiesService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../../base/common/uri.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ITextResourcePropertiesService } from '../../../../editor/common/services/textResourceConfiguration.js';\nimport { OperatingSystem, OS } from '../../../../base/common/platform.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { IStorageService, StorageScope, StorageTarget } from '../../../../platform/storage/common/storage.js';\nimport { IWorkbenchEnvironmentService } from '../../environment/common/environmentService.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IRemoteAgentEnvironment } from '../../../../platform/remote/common/remoteAgentEnvironment.js';\nimport { IRemoteAgentService } from '../../remote/common/remoteAgentService.js';\n\nexport class TextResourcePropertiesService implements ITextResourcePropertiesService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate remoteEnvironment: IRemoteAgentEnvironment | null = null;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tremoteAgentService.getEnvironment().then(remoteEnv => this.remoteEnvironment = remoteEnv);\n\t}\n\n\tgetEOL(resource?: URI, language?: string): string {\n\t\tconst eol = this.configurationService.getValue('files.eol', { overrideIdentifier: language, resource });\n\t\tif (eol && typeof eol === 'string' && eol !== 'auto') {\n\t\t\treturn eol;\n\t\t}\n\t\tconst os = this.getOS(resource);\n\t\treturn os === OperatingSystem.Linux || os === OperatingSystem.Macintosh ? '\\n' : '\\r\\n';\n\t}\n\n\tprivate getOS(resource?: URI): OperatingSystem {\n\t\tlet os = OS;\n\n\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\tif (remoteAuthority) {\n\t\t\tif (resource && resource.scheme !== Schemas.file) {\n\t\t\t\tconst osCacheKey = `resource.authority.os.${remoteAuthority}`;\n\t\t\t\tos = this.remoteEnvironment ? this.remoteEnvironment.os : /* Get it from cache */ this.storageService.getNumber(osCacheKey, StorageScope.WORKSPACE, OS);\n\t\t\t\tthis.storageService.store(osCacheKey, os, StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t\t\t}\n\t\t}\n\n\t\treturn os;\n\t}\n}\n\nregisterSingleton(ITextResourcePropertiesService, TextResourcePropertiesService, InstantiationType.Delayed);\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,WAAW;AACpB,SAAS,6BAA6B;AACtC,SAAS,sCAAsC;AAC/C,SAAS,iBAAiB,UAAU;AACpC,SAAS,eAAe;AACxB,SAAS,iBAAiB,cAAc,qBAAqB;AAC7D,SAAS,oCAAoC;AAC7C,SAAS,mBAAmB,yBAAyB;AACrD,SAAS,+BAA+B;AACxC,SAAS,2BAA2B;AAE7B,IAAM,gCAAN,MAA8E;AAAA,EAMpF,YACyC,sBACnB,oBAC0B,oBACb,gBACjC;AAJuC;AAEO;AACb;AAElC,uBAAmB,eAAe,EAAE,KAAK,eAAa,KAAK,oBAAoB,SAAS;AAAA,EACzF;AAAA,EA7BD,OAgBqF;AAAA;AAAA;AAAA,EAI5E,oBAAoD;AAAA,EAW5D,OAAO,UAAgB,UAA2B;AACjD,UAAM,MAAM,KAAK,qBAAqB,SAAS,aAAa,EAAE,oBAAoB,UAAU,SAAS,CAAC;AACtG,QAAI,OAAO,OAAO,QAAQ,YAAY,QAAQ,QAAQ;AACrD,aAAO;AAAA,IACR;AACA,UAAM,KAAK,KAAK,MAAM,QAAQ;AAC9B,WAAO,OAAO,gBAAgB,SAAS,OAAO,gBAAgB,YAAY,OAAO;AAAA,EAClF;AAAA,EAEQ,MAAM,UAAiC;AAC9C,QAAI,KAAK;AAET,UAAM,kBAAkB,KAAK,mBAAmB;AAChD,QAAI,iBAAiB;AACpB,UAAI,YAAY,SAAS,WAAW,QAAQ,MAAM;AACjD,cAAM,aAAa,yBAAyB,eAAe;AAC3D,aAAK,KAAK,oBAAoB,KAAK,kBAAkB;AAAA;AAAA,UAA6B,KAAK,eAAe,UAAU,YAAY,aAAa,WAAW,EAAE;AAAA;AACtJ,aAAK,eAAe,MAAM,YAAY,IAAI,aAAa,WAAW,cAAc,OAAO;AAAA,MACxF;AAAA,IACD;AAEA,WAAO;AAAA,EACR;AACD;AAtCa,gCAAN;AAAA,EAOJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,GAVU;AAwCb,kBAAkB,gCAAgC,+BAA+B,kBAAkB,OAAO;",
  "names": []
}
