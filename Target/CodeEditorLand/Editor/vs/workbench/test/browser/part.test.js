import n from"assert";import{Part as P}from"../../browser/part.js";import{isEmptyObject as b}from"../../../base/common/types.js";import{TestThemeService as p}from"../../../platform/theme/test/common/testThemeService.js";import{append as i,$ as d,hide as E}from"../../../base/browser/dom.js";import{TestLayoutService as T}from"./workbenchTestServices.js";import{StorageScope as y,StorageTarget as h}from"../../../platform/storage/common/storage.js";import{TestStorageService as M}from"../common/workbenchTestServices.js";import{ensureNoDisposablesAreLeakedInTestSuite as S}from"../../../base/test/common/utils.js";import{DisposableStore as L}from"../../../base/common/lifecycle.js";import{mainWindow as m}from"../../../base/browser/window.js";suite("Workbench parts",()=>{const a=new L;class l extends P{minimumWidth=50;maximumWidth=50;minimumHeight=50;maximumHeight=50;layout(t,e){throw new Error("Method not implemented.")}toJSON(){throw new Error("Method not implemented.")}}class u extends l{constructor(e){super("myPart",{hasTitle:!0},new p,a.add(new M),new T);this.expectedParent=e}createTitleArea(e){return n.strictEqual(e,this.expectedParent),super.createTitleArea(e)}createContentArea(e){return n.strictEqual(e,this.expectedParent),super.createContentArea(e)}testGetMemento(e,o){return super.getMemento(e,o)}testSaveState(){return super.saveState()}}class v extends l{constructor(){super("myPart2",{hasTitle:!0},new p,a.add(new M),new T)}createTitleArea(t){const e=i(t,d("div")),o=i(e,d("span"));return o.id="myPart.title",o.innerText="Title",e}createContentArea(t){const e=i(t,d("div")),o=i(e,d("span"));return o.id="myPart.content",o.innerText="Content",e}}class w extends l{constructor(){super("myPart2",{hasTitle:!1},new p,a.add(new M),new T)}createTitleArea(t){return null}createContentArea(t){const e=i(t,d("div")),o=i(e,d("span"));return o.id="myPart.content",o.innerText="Content",e}}let c;const s="workbench-part-fixture";setup(()=>{c=document.createElement("div"),c.id=s,m.document.body.appendChild(c)}),teardown(()=>{c.remove(),a.clear()}),test("Creation",()=>{const r=document.createElement("div");m.document.getElementById(s).appendChild(r),E(r);let t=a.add(new u(r));t.create(r),n.strictEqual(t.getId(),"myPart");let e=t.testGetMemento(y.PROFILE,h.MACHINE);n(e),e.foo="bar",e.bar=[1,2,3],t.testSaveState(),t=a.add(new u(r)),e=t.testGetMemento(y.PROFILE,h.MACHINE),n(e),n.strictEqual(e.foo,"bar"),n.strictEqual(e.bar.length,3),delete e.foo,delete e.bar,t.testSaveState(),t=a.add(new u(r)),e=t.testGetMemento(y.PROFILE,h.MACHINE),n(e),n.strictEqual(b(e),!0)}),test("Part Layout with Title and Content",function(){const r=document.createElement("div");m.document.getElementById(s).appendChild(r),E(r),a.add(new v).create(r),n(m.document.getElementById("myPart.title")),n(m.document.getElementById("myPart.content"))}),test("Part Layout with Content only",function(){const r=document.createElement("div");m.document.getElementById(s).appendChild(r),E(r),a.add(new w).create(r),n(!m.document.getElementById("myPart.title")),n(m.document.getElementById("myPart.content"))}),S()});
