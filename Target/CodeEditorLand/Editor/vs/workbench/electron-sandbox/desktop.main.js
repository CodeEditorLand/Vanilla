var Xte=Object.defineProperty;var Qte=Object.getOwnPropertyDescriptor;var D_=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var _=(r,t,e,i)=>{for(var n=i>1?void 0:i?Qte(t,e):t,o=r.length-1,s;o>=0;o--)(s=r[o])&&(n=(i?s(t,e,n):s(n))||n);return i&&n&&Xte(t,e,n),n},v=(r,t)=>(e,i)=>t(e,i,r);function NF(){return globalThis._VSCODE_NLS_MESSAGES}function _S(){return globalThis._VSCODE_NLS_LANGUAGE}var Jte=_S()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function L_(r,t){let e;return t.length===0?e=r:e=r.replace(/\{(\d+)\}/g,(i,n)=>{let o=n[0],s=t[o],a=i;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),Jte&&(e="\uFF3B"+e.replace(/[aouei]/g,"$&$&")+"\uFF3D"),e}function h(r,t,...e){return L_(typeof r=="number"?V9(r,t):t,e)}function V9(r,t){let e=NF()?.[r];if(typeof e!="string"){if(typeof t=="string")return t;throw new Error(`!!! NLS MISSING: ${r} !!!`)}return e}function pe(r,t,...e){let i;typeof r=="number"?i=V9(r,t):i=t;let n=L_(i,e);return{value:n,original:t===i?n:L_(t,e)}}var Nb="en",kS=!1,RS=!1,LS=!1,eie=!1,H9=!1,VF=!1,tie=!1,WF=!1,z9=!1,K9=!1,DS,k_=Nb,BF=Nb,iie,Ru,Au=globalThis,wa;typeof Au.vscode<"u"&&typeof Au.vscode.process<"u"?wa=Au.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(wa=process);var G9=typeof wa?.versions?.electron=="string",nie=G9&&wa?.type==="renderer";if(typeof wa=="object"){kS=wa.platform==="win32",RS=wa.platform==="darwin",LS=wa.platform==="linux",eie=LS&&!!wa.env.SNAP&&!!wa.env.SNAP_REVISION,tie=G9,z9=!!wa.env.CI||!!wa.env.BUILD_ARTIFACTSTAGINGDIRECTORY,DS=Nb,k_=Nb;let r=wa.env.VSCODE_NLS_CONFIG;if(r)try{let t=JSON.parse(r);DS=t.userLocale,BF=t.osLocale,k_=t.resolvedLanguage||Nb,iie=t.languagePack?.translationsConfigFile}catch{}H9=!0}else typeof navigator=="object"&&!nie?(Ru=navigator.userAgent,kS=Ru.indexOf("Windows")>=0,RS=Ru.indexOf("Macintosh")>=0,WF=(Ru.indexOf("Macintosh")>=0||Ru.indexOf("iPad")>=0||Ru.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,LS=Ru.indexOf("Linux")>=0,K9=Ru?.indexOf("Mobi")>=0,VF=!0,k_=_S()||Nb,DS=navigator.language.toLowerCase(),BF=DS):console.error("Unable to resolve platform.");var FF=0;RS?FF=1:kS?FF=3:LS&&(FF=2);var rt=kS,be=RS,_t=LS;var Pi=H9;var wt=VF,oie=VF&&typeof Au.importScripts=="function",q9=oie?Au.origin:void 0,Xo=WF,R_=K9,A_=z9;var uc=Ru,rl=k_,rie;(i=>{function r(){return rl}i.value=r;function t(){return rl.length===2?rl==="en":rl.length>=3?rl[0]==="e"&&rl[1]==="n"&&rl[2]==="-":!1}i.isDefaultVariant=t;function e(){return rl==="en"}i.isDefault=e})(rie||={});var j9=DS,$9=BF;var sie=typeof Au.postMessage=="function"&&!Au.importScripts,P_=(()=>{if(sie){let r=[];Au.addEventListener("message",e=>{if(e.data&&e.data.vscodeScheduleAsyncWork)for(let i=0,n=r.length;i<n;i++){let o=r[i];if(o.id===e.data.vscodeScheduleAsyncWork){r.splice(i,1),o.callback();return}}});let t=0;return e=>{let i=++t;r.push({id:i,callback:e}),Au.postMessage({vscodeScheduleAsyncWork:i},"*")}}return r=>setTimeout(r)})();var Hs=RS||WF?2:kS?1:3,W9=!0,U9=!1;function Y9(){if(!U9){U9=!0;let r=new Uint8Array(2);r[0]=1,r[1]=2,W9=new Uint16Array(r.buffer)[0]===513}return W9}var UF=!!(uc&&uc.indexOf("Chrome")>=0),M_=!!(uc&&uc.indexOf("Firefox")>=0),Z9=!!(!UF&&uc&&uc.indexOf("Safari")>=0),X9=!!(uc&&uc.indexOf("Edg/")>=0),Q9=!!(uc&&uc.indexOf("Android")>=0);function J9(r){return parseFloat(r)>=20}var dg,HF=globalThis.vscode;if(typeof HF<"u"&&typeof HF.process<"u"){let r=HF.process;dg={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?dg={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:dg={get platform(){return rt?"win32":be?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var AS=dg.cwd,zs=dg.env,zF=dg.platform,aie=dg.arch;function e7(r,t){let e=new Set;for(let i of t)r.has(i)&&e.add(i);return e}var Ks,KF=globalThis.vscode;if(typeof KF<"u"&&typeof KF.context<"u"){let r=KF.context.configuration();if(r)Ks=r.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(Ks=globalThis._VSCODE_PRODUCT_JSON,zs.VSCODE_DEV&&Object.assign(Ks,{nameShort:`${Ks.nameShort} Dev`,nameLong:`${Ks.nameLong} Dev`,dataFolderName:`${Ks.dataFolderName}-dev`,serverDataFolderName:Ks.serverDataFolderName?`${Ks.serverDataFolderName}-dev`:void 0}),!Ks.version){let r=globalThis._VSCODE_PACKAGE_JSON;Object.assign(Ks,{version:r.version})}}else Ks={},Object.keys(Ks).length===0&&Object.assign(Ks,{version:"1.94.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var t7=Ks;var PS={exports:{}};(function(){function t(o){let s=[];typeof o=="number"&&s.push("code/timeOrigin",o);function a(d){s.push(d,Date.now())}function l(){let d=[];for(let c=0;c<s.length;c+=2)d.push({name:s[c],startTime:s[c+1]});return d}return{mark:a,getMarks:l}}function e(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?t():{mark(o){performance.mark(o)},getMarks(){let o=performance.timeOrigin;typeof o!="number"&&(o=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(o)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(o+a.startTime)});return s}};if(typeof process=="object"){let o=performance?.timeOrigin;return t(o)}else return console.trace("perf-util loaded in UNKNOWN environment"),t()}function i(o){return o.MonacoPerformanceMarks||(o.MonacoPerformanceMarks=e()),o.MonacoPerformanceMarks}var n;typeof global=="object"?n=global:typeof self=="object"?n=self:n={},typeof PS=="object"&&typeof PS.exports=="object"?PS.exports=i(n):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),n.perf=i(n))})();var Dt=PS.exports.mark,Xhe=PS.exports.getMarks;var cie=65,uie=97,pie=90,hie=122,sh=46,Ir=47,Gs=92,oh=58,mie=63,O_=class extends Error{code;constructor(t,e,i){let n;typeof e=="string"&&e.indexOf("not ")===0?(n="must not be",e=e.replace(/^not /,"")):n="must be";let o=t.indexOf(".")!==-1?"property":"argument",s=`The "${t}" ${o} ${n} of type ${e}`;s+=`. Received type ${typeof i}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function gie(r,t){if(r===null||typeof r!="object")throw new O_(t,"Object",r)}function so(r,t){if(typeof r!="string")throw new O_(t,"string",r)}var qs=zF==="win32";function hi(r){return r===Ir||r===Gs}function GF(r){return r===Ir}function rh(r){return r>=cie&&r<=pie||r>=uie&&r<=hie}function N_(r,t,e,i){let n="",o=0,s=-1,a=0,l=0;for(let d=0;d<=r.length;++d){if(d<r.length)l=r.charCodeAt(d);else{if(i(l))break;l=Ir}if(i(l)){if(!(s===d-1||a===1))if(a===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==sh||n.charCodeAt(n.length-2)!==sh){if(n.length>2){let c=n.lastIndexOf(e);c===-1?(n="",o=0):(n=n.slice(0,c),o=n.length-1-n.lastIndexOf(e)),s=d,a=0;continue}else if(n.length!==0){n="",o=0,s=d,a=0;continue}}t&&(n+=n.length>0?`${e}..`:"..",o=2)}else n.length>0?n+=`${e}${r.slice(s+1,d)}`:n=r.slice(s+1,d),o=d-s-1;s=d,a=0}else l===sh&&a!==-1?++a:a=-1}return n}function fie(r){return r?`${r[0]==="."?"":"."}${r}`:""}function i7(r,t){gie(t,"pathObject");let e=t.dir||t.root,i=t.base||`${t.name||""}${fie(t.ext)}`;return e?e===t.root?`${e}${i}`:`${e}${r}${i}`:i}var hn={resolve(...r){let t="",e="",i=!1;for(let n=r.length-1;n>=-1;n--){let o;if(n>=0){if(o=r[n],so(o,`paths[${n}]`),o.length===0)continue}else t.length===0?o=AS():(o=zs[`=${t}`]||AS(),(o===void 0||o.slice(0,2).toLowerCase()!==t.toLowerCase()&&o.charCodeAt(2)===Gs)&&(o=`${t}\\`));let s=o.length,a=0,l="",d=!1,c=o.charCodeAt(0);if(s===1)hi(c)&&(a=1,d=!0);else if(hi(c))if(d=!0,hi(o.charCodeAt(1))){let u=2,p=u;for(;u<s&&!hi(o.charCodeAt(u));)u++;if(u<s&&u!==p){let m=o.slice(p,u);for(p=u;u<s&&hi(o.charCodeAt(u));)u++;if(u<s&&u!==p){for(p=u;u<s&&!hi(o.charCodeAt(u));)u++;(u===s||u!==p)&&(l=`\\\\${m}\\${o.slice(p,u)}`,a=u)}}}else a=1;else rh(c)&&o.charCodeAt(1)===oh&&(l=o.slice(0,2),a=2,s>2&&hi(o.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(t.length>0){if(l.toLowerCase()!==t.toLowerCase())continue}else t=l;if(i){if(t.length>0)break}else if(e=`${o.slice(a)}\\${e}`,i=d,d&&t.length>0)break}return e=N_(e,!i,"\\",hi),i?`${t}\\${e}`:`${t}${e}`||"."},normalize(r){so(r,"path");let t=r.length;if(t===0)return".";let e=0,i,n=!1,o=r.charCodeAt(0);if(t===1)return GF(o)?"\\":r;if(hi(o))if(n=!0,hi(r.charCodeAt(1))){let a=2,l=a;for(;a<t&&!hi(r.charCodeAt(a));)a++;if(a<t&&a!==l){let d=r.slice(l,a);for(l=a;a<t&&hi(r.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!hi(r.charCodeAt(a));)a++;if(a===t)return`\\\\${d}\\${r.slice(l)}\\`;a!==l&&(i=`\\\\${d}\\${r.slice(l,a)}`,e=a)}}}else e=1;else rh(o)&&r.charCodeAt(1)===oh&&(i=r.slice(0,2),e=2,t>2&&hi(r.charCodeAt(2))&&(n=!0,e=3));let s=e<t?N_(r.slice(e),!n,"\\",hi):"";return s.length===0&&!n&&(s="."),s.length>0&&hi(r.charCodeAt(t-1))&&(s+="\\"),i===void 0?n?`\\${s}`:s:n?`${i}\\${s}`:`${i}${s}`},isAbsolute(r){so(r,"path");let t=r.length;if(t===0)return!1;let e=r.charCodeAt(0);return hi(e)||t>2&&rh(e)&&r.charCodeAt(1)===oh&&hi(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let t,e;for(let o=0;o<r.length;++o){let s=r[o];so(s,"path"),s.length>0&&(t===void 0?t=e=s:t+=`\\${s}`)}if(t===void 0)return".";let i=!0,n=0;if(typeof e=="string"&&hi(e.charCodeAt(0))){++n;let o=e.length;o>1&&hi(e.charCodeAt(1))&&(++n,o>2&&(hi(e.charCodeAt(2))?++n:i=!1))}if(i){for(;n<t.length&&hi(t.charCodeAt(n));)n++;n>=2&&(t=`\\${t.slice(n)}`)}return hn.normalize(t)},relative(r,t){if(so(r,"from"),so(t,"to"),r===t)return"";let e=hn.resolve(r),i=hn.resolve(t);if(e===i||(r=e.toLowerCase(),t=i.toLowerCase(),r===t))return"";let n=0;for(;n<r.length&&r.charCodeAt(n)===Gs;)n++;let o=r.length;for(;o-1>n&&r.charCodeAt(o-1)===Gs;)o--;let s=o-n,a=0;for(;a<t.length&&t.charCodeAt(a)===Gs;)a++;let l=t.length;for(;l-1>a&&t.charCodeAt(l-1)===Gs;)l--;let d=l-a,c=s<d?s:d,u=-1,p=0;for(;p<c;p++){let g=r.charCodeAt(n+p);if(g!==t.charCodeAt(a+p))break;g===Gs&&(u=p)}if(p!==c){if(u===-1)return i}else{if(d>c){if(t.charCodeAt(a+p)===Gs)return i.slice(a+p+1);if(p===2)return i.slice(a+p)}s>c&&(r.charCodeAt(n+p)===Gs?u=p:p===2&&(u=3)),u===-1&&(u=0)}let m="";for(p=n+u+1;p<=o;++p)(p===o||r.charCodeAt(p)===Gs)&&(m+=m.length===0?"..":"\\..");return a+=u,m.length>0?`${m}${i.slice(a,l)}`:(i.charCodeAt(a)===Gs&&++a,i.slice(a,l))},toNamespacedPath(r){if(typeof r!="string"||r.length===0)return r;let t=hn.resolve(r);if(t.length<=2)return r;if(t.charCodeAt(0)===Gs){if(t.charCodeAt(1)===Gs){let e=t.charCodeAt(2);if(e!==mie&&e!==sh)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(rh(t.charCodeAt(0))&&t.charCodeAt(1)===oh&&t.charCodeAt(2)===Gs)return`\\\\?\\${t}`;return r},dirname(r){so(r,"path");let t=r.length;if(t===0)return".";let e=-1,i=0,n=r.charCodeAt(0);if(t===1)return hi(n)?r:".";if(hi(n)){if(e=i=1,hi(r.charCodeAt(1))){let a=2,l=a;for(;a<t&&!hi(r.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&hi(r.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!hi(r.charCodeAt(a));)a++;if(a===t)return r;a!==l&&(e=i=a+1)}}}}else rh(n)&&r.charCodeAt(1)===oh&&(e=t>2&&hi(r.charCodeAt(2))?3:2,i=e);let o=-1,s=!0;for(let a=t-1;a>=i;--a)if(hi(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(e===-1)return".";o=e}return r.slice(0,o)},basename(r,t){t!==void 0&&so(t,"suffix"),so(r,"path");let e=0,i=-1,n=!0,o;if(r.length>=2&&rh(r.charCodeAt(0))&&r.charCodeAt(1)===oh&&(e=2),t!==void 0&&t.length>0&&t.length<=r.length){if(t===r)return"";let s=t.length-1,a=-1;for(o=r.length-1;o>=e;--o){let l=r.charCodeAt(o);if(hi(l)){if(!n){e=o+1;break}}else a===-1&&(n=!1,a=o+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(o=r.length-1;o>=e;--o)if(hi(r.charCodeAt(o))){if(!n){e=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":r.slice(e,i)},extname(r){so(r,"path");let t=0,e=-1,i=0,n=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===oh&&rh(r.charCodeAt(0))&&(t=i=2);for(let a=r.length-1;a>=t;--a){let l=r.charCodeAt(a);if(hi(l)){if(!o){i=a+1;break}continue}n===-1&&(o=!1,n=a+1),l===sh?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===i+1?"":r.slice(e,n)},format:i7.bind(null,"\\"),parse(r){so(r,"path");let t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;let e=r.length,i=0,n=r.charCodeAt(0);if(e===1)return hi(n)?(t.root=t.dir=r,t):(t.base=t.name=r,t);if(hi(n)){if(i=1,hi(r.charCodeAt(1))){let u=2,p=u;for(;u<e&&!hi(r.charCodeAt(u));)u++;if(u<e&&u!==p){for(p=u;u<e&&hi(r.charCodeAt(u));)u++;if(u<e&&u!==p){for(p=u;u<e&&!hi(r.charCodeAt(u));)u++;u===e?i=u:u!==p&&(i=u+1)}}}}else if(rh(n)&&r.charCodeAt(1)===oh){if(e<=2)return t.root=t.dir=r,t;if(i=2,hi(r.charCodeAt(2))){if(e===3)return t.root=t.dir=r,t;i=3}}i>0&&(t.root=r.slice(0,i));let o=-1,s=i,a=-1,l=!0,d=r.length-1,c=0;for(;d>=i;--d){if(n=r.charCodeAt(d),hi(n)){if(!l){s=d+1;break}continue}a===-1&&(l=!1,a=d+1),n===sh?o===-1?o=d:c!==1&&(c=1):o!==-1&&(c=-1)}return a!==-1&&(o===-1||c===0||c===1&&o===a-1&&o===s+1?t.base=t.name=r.slice(s,a):(t.name=r.slice(s,o),t.base=r.slice(s,a),t.ext=r.slice(o,a))),s>0&&s!==i?t.dir=r.slice(0,s-1):t.dir=t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},bie=(()=>{if(qs){let r=/\\/g;return()=>{let t=AS().replace(r,"/");return t.slice(t.indexOf("/"))}}return()=>AS()})(),Ft={resolve(...r){let t="",e=!1;for(let i=r.length-1;i>=-1&&!e;i--){let n=i>=0?r[i]:bie();so(n,`paths[${i}]`),n.length!==0&&(t=`${n}/${t}`,e=n.charCodeAt(0)===Ir)}return t=N_(t,!e,"/",GF),e?`/${t}`:t.length>0?t:"."},normalize(r){if(so(r,"path"),r.length===0)return".";let t=r.charCodeAt(0)===Ir,e=r.charCodeAt(r.length-1)===Ir;return r=N_(r,!t,"/",GF),r.length===0?t?"/":e?"./":".":(e&&(r+="/"),t?`/${r}`:r)},isAbsolute(r){return so(r,"path"),r.length>0&&r.charCodeAt(0)===Ir},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){let i=r[e];so(i,"path"),i.length>0&&(t===void 0?t=i:t+=`/${i}`)}return t===void 0?".":Ft.normalize(t)},relative(r,t){if(so(r,"from"),so(t,"to"),r===t||(r=Ft.resolve(r),t=Ft.resolve(t),r===t))return"";let e=1,i=r.length,n=i-e,o=1,s=t.length-o,a=n<s?n:s,l=-1,d=0;for(;d<a;d++){let u=r.charCodeAt(e+d);if(u!==t.charCodeAt(o+d))break;u===Ir&&(l=d)}if(d===a)if(s>a){if(t.charCodeAt(o+d)===Ir)return t.slice(o+d+1);if(d===0)return t.slice(o+d)}else n>a&&(r.charCodeAt(e+d)===Ir?l=d:d===0&&(l=0));let c="";for(d=e+l+1;d<=i;++d)(d===i||r.charCodeAt(d)===Ir)&&(c+=c.length===0?"..":"/..");return`${c}${t.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(so(r,"path"),r.length===0)return".";let t=r.charCodeAt(0)===Ir,e=-1,i=!0;for(let n=r.length-1;n>=1;--n)if(r.charCodeAt(n)===Ir){if(!i){e=n;break}}else i=!1;return e===-1?t?"/":".":t&&e===1?"//":r.slice(0,e)},basename(r,t){t!==void 0&&so(t,"ext"),so(r,"path");let e=0,i=-1,n=!0,o;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t===r)return"";let s=t.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===Ir){if(!n){e=o+1;break}}else a===-1&&(n=!1,a=o+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===Ir){if(!n){e=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":r.slice(e,i)},extname(r){so(r,"path");let t=-1,e=0,i=-1,n=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===Ir){if(!n){e=s+1;break}continue}i===-1&&(n=!1,i=s+1),a===sh?t===-1?t=s:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===e+1?"":r.slice(t,i)},format:i7.bind(null,"/"),parse(r){so(r,"path");let t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;let e=r.charCodeAt(0)===Ir,i;e?(t.root="/",i=1):i=0;let n=-1,o=0,s=-1,a=!0,l=r.length-1,d=0;for(;l>=i;--l){let c=r.charCodeAt(l);if(c===Ir){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===sh?n===-1?n=l:d!==1&&(d=1):n!==-1&&(d=-1)}if(s!==-1){let c=o===0&&e?1:o;n===-1||d===0||d===1&&n===s-1&&n===o+1?t.base=t.name=r.slice(c,s):(t.name=r.slice(c,n),t.base=r.slice(c,s),t.ext=r.slice(n,s))}return o>0?t.dir=r.slice(0,o-1):e&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Ft.win32=hn.win32=hn;Ft.posix=hn.posix=Ft;var sl=qs?hn.normalize:Ft.normalize,cg=qs?hn.isAbsolute:Ft.isAbsolute,fs=qs?hn.join:Ft.join,Fb=qs?hn.resolve:Ft.resolve,F_=qs?hn.relative:Ft.relative,B_=qs?hn.dirname:Ft.dirname,ah=qs?hn.basename:Ft.basename,Pu=qs?hn.extname:Ft.extname,eme=qs?hn.format:Ft.format,tme=qs?hn.parse:Ft.parse,ime=qs?hn.toNamespacedPath:Ft.toNamespacedPath,Gn=qs?hn.sep:Ft.sep,nme=qs?hn.delimiter:Ft.delimiter;var vie=/^\w[\w\d+.-]*$/,yie=/^\//,Iie=/^\/\//;function Cie(r,t){if(!r.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${r.authority}", path: "${r.path}", query: "${r.query}", fragment: "${r.fragment}"}`);if(r.scheme&&!vie.test(r.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(r.path){if(r.authority){if(!yie.test(r.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(Iie.test(r.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function Sie(r,t){return!r&&!t?"file":r}function wie(r,t){switch(r){case"https":case"http":case"file":t?t[0]!==Gl&&(t=Gl+t):t=Gl;break}return t}var yn="",Gl="/",Eie=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,q=class r{static isUri(t){return t instanceof r?!0:t?typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function":!1}scheme;authority;path;query;fragment;constructor(t,e,i,n,o,s=!1){typeof t=="object"?(this.scheme=t.scheme||yn,this.authority=t.authority||yn,this.path=t.path||yn,this.query=t.query||yn,this.fragment=t.fragment||yn):(this.scheme=Sie(t,s),this.authority=e||yn,this.path=wie(this.scheme,i||yn),this.query=n||yn,this.fragment=o||yn,Cie(this,s))}get fsPath(){return MS(this,!1)}with(t){if(!t)return this;let{scheme:e,authority:i,path:n,query:o,fragment:s}=t;return e===void 0?e=this.scheme:e===null&&(e=yn),i===void 0?i=this.authority:i===null&&(i=yn),n===void 0?n=this.path:n===null&&(n=yn),o===void 0?o=this.query:o===null&&(o=yn),s===void 0?s=this.fragment:s===null&&(s=yn),e===this.scheme&&i===this.authority&&n===this.path&&o===this.query&&s===this.fragment?this:new lh(e,i,n,o,s)}static parse(t,e=!1){let i=Eie.exec(t);return i?new lh(i[2]||yn,V_(i[4]||yn),V_(i[5]||yn),V_(i[7]||yn),V_(i[9]||yn),e):new lh(yn,yn,yn,yn,yn)}static file(t){let e=yn;if(rt&&(t=t.replace(/\\/g,Gl)),t[0]===Gl&&t[1]===Gl){let i=t.indexOf(Gl,2);i===-1?(e=t.substring(2),t=Gl):(e=t.substring(2,i),t=t.substring(i)||Gl)}return new lh("file",e,t,yn,yn)}static from(t,e){return new lh(t.scheme,t.authority,t.path,t.query,t.fragment,e)}static joinPath(t,...e){if(!t.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return rt&&t.scheme==="file"?i=r.file(hn.join(MS(t,!0),...e)).path:i=Ft.join(t.path,...e),t.with({path:i})}toString(t=!1){return jF(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof r)return t;{let e=new lh(t);return e._formatted=t.external??null,e._fsPath=t._sep===s7?t.fsPath??null:null,e}}else return t}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var s7=rt?1:void 0,lh=class extends q{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=MS(this,!1)),this._fsPath}toString(t=!1){return t?jF(this,!0):(this._formatted||(this._formatted=jF(this,!1)),this._formatted)}toJSON(){let t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=s7),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t}},a7={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function n7(r,t,e){let i,n=-1;for(let o=0;o<r.length;o++){let s=r.charCodeAt(o);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||t&&s===47||e&&s===91||e&&s===93||e&&s===58)n!==-1&&(i+=encodeURIComponent(r.substring(n,o)),n=-1),i!==void 0&&(i+=r.charAt(o));else{i===void 0&&(i=r.substr(0,o));let a=a7[s];a!==void 0?(n!==-1&&(i+=encodeURIComponent(r.substring(n,o)),n=-1),i+=a):n===-1&&(n=o)}}return n!==-1&&(i+=encodeURIComponent(r.substring(n))),i!==void 0?i:r}function Tie(r){let t;for(let e=0;e<r.length;e++){let i=r.charCodeAt(e);i===35||i===63?(t===void 0&&(t=r.substr(0,e)),t+=a7[i]):t!==void 0&&(t+=r[e])}return t!==void 0?t:r}function MS(r,t){let e;return r.authority&&r.path.length>1&&r.scheme==="file"?e=`//${r.authority}${r.path}`:r.path.charCodeAt(0)===47&&(r.path.charCodeAt(1)>=65&&r.path.charCodeAt(1)<=90||r.path.charCodeAt(1)>=97&&r.path.charCodeAt(1)<=122)&&r.path.charCodeAt(2)===58?t?e=r.path.substr(1):e=r.path[1].toLowerCase()+r.path.substr(2):e=r.path,rt&&(e=e.replace(/\//g,"\\")),e}function jF(r,t){let e=t?Tie:n7,i="",{scheme:n,authority:o,path:s,query:a,fragment:l}=r;if(n&&(i+=n,i+=":"),(o||n==="file")&&(i+=Gl,i+=Gl),o){let d=o.indexOf("@");if(d!==-1){let c=o.substr(0,d);o=o.substr(d+1),d=c.lastIndexOf(":"),d===-1?i+=e(c,!1,!1):(i+=e(c.substr(0,d),!1,!1),i+=":",i+=e(c.substr(d+1),!1,!0)),i+="@"}o=o.toLowerCase(),d=o.lastIndexOf(":"),d===-1?i+=e(o,!1,!0):(i+=e(o.substr(0,d),!1,!0),i+=o.substr(d))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let d=s.charCodeAt(1);d>=65&&d<=90&&(s=`/${String.fromCharCode(d+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let d=s.charCodeAt(0);d>=65&&d<=90&&(s=`${String.fromCharCode(d+32)}:${s.substr(2)}`)}i+=e(s,!0,!1)}return a&&(i+="?",i+=e(a,!1,!1)),l&&(i+="#",i+=t?l:n7(l,!1,!1)),i}function l7(r){try{return decodeURIComponent(r)}catch{return r.length>3?r.substr(0,3)+l7(r.substr(3)):r}}var o7=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function V_(r){return r.match(o7)?r.replace(o7,t=>l7(t)):r}function ug(r,t){let e=xie(r,t);if(e!==-1)return r[e]}function xie(r,t,e=r.length-1){for(let i=e;i>=0;i--){let n=r[i];if(t(n))return i}return-1}function Mu(r,t){let e=Ou(r,t);return e===-1?void 0:r[e]}function Ou(r,t,e=0,i=r.length){let n=e,o=i;for(;n<o;){let s=Math.floor((n+o)/2);t(r[s])?n=s+1:o=s}return n-1}function d7(r,t){let e=NS(r,t);return e===r.length?void 0:r[e]}function NS(r,t,e=0,i=r.length){let n=e,o=i;for(;n<o;){let s=Math.floor((n+o)/2);t(r[s])?o=s:n=s+1}return n}var OS=class r{constructor(t){this._array=t}static assertInvariants=!1;_findLastMonotonousLastIdx=0;_prevFindLastPredicate;findLastMonotonous(t){if(r.assertInvariants){if(this._prevFindLastPredicate){for(let i of this._array)if(this._prevFindLastPredicate(i)&&!t(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=t}let e=Ou(this._array,t,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=e+1,e===-1?void 0:this._array[e]}};function _ie(r,t){if(r.length===0)return;let e=r[0];for(let i=1;i<r.length;i++){let n=r[i];t(n,e)>0&&(e=n)}return e}function c7(r,t){if(r.length===0)return;let e=r[0];for(let i=1;i<r.length;i++){let n=r[i];t(n,e)>=0&&(e=n)}return e}function u7(r,t){return _ie(r,(e,i)=>-t(e,i))}function p7(r,t){if(r.length===0)return-1;let e=0;for(let i=1;i<r.length;i++){let n=r[i];t(n,r[e])>0&&(e=i)}return e}var $F=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout(()=>{throw t.stack?Br.isErrorNoTelemetry(t)?new Br(t.message+`

`+t.stack):new Error(t.message+`

`+t.stack):t},0)}}addListener(t){return this.listeners.push(t),()=>{this._removeListener(t)}}emit(t){this.listeners.forEach(e=>{e(t)})}_removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}setUnexpectedErrorHandler(t){this.unexpectedErrorHandler=t}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(t){this.unexpectedErrorHandler(t),this.emit(t)}onUnexpectedExternalError(t){this.unexpectedErrorHandler(t)}},YF=new $F;function h7(r){YF.setUnexpectedErrorHandler(r)}function Bb(r){YF.onUnexpectedError(r)}function Ke(r){al(r)||YF.onUnexpectedError(r)}var W_="Canceled";function al(r){return r instanceof Cr?!0:r instanceof Error&&r.name===W_&&r.message===W_}var Cr=class extends Error{constructor(){super(W_),this.name=this.message}};function H_(){let r=new Error(W_);return r.name=r.message,r}function dh(r){return r?new Error(`Illegal argument: ${r}`):new Error("Illegal argument")}function z_(r){return r?new Error(`Illegal state: ${r}`):new Error("Illegal state")}function Nu(r){return r?r.message?r.message:r.stack?r.stack.split(`
`)[0]:String(r):"Error"}var U_=class extends Error{constructor(t){super("NotSupported"),t&&(this.message=t)}};var Br=class r extends Error{name;constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof r)return t;let e=new r;return e.message=t.message,e.stack=t.stack,e}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},yt=class r extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,r.prototype)}};function Vr(r,t=0){return r[r.length-(1+t)]}function Dn(r){if(r.length===0)throw new Error("Invalid tail call");return[r.slice(0,r.length-1),r[r.length-1]]}function ti(r,t,e=(i,n)=>i===n){if(r===t)return!0;if(!r||!t||r.length!==t.length)return!1;for(let i=0,n=r.length;i<n;i++)if(!e(r[i],t[i]))return!1;return!0}function m7(r,t){let e=r.length-1;t<e&&(r[t]=r[e]),r.pop()}function g7(r,t,e){return Die(r.length,i=>e(r[i],t))}function Die(r,t){let e=0,i=r-1;for(;e<=i;){let n=(e+i)/2|0,o=t(n);if(o<0)e=n+1;else if(o>0)i=n-1;else return n}return-(e+1)}function*Vb(r,t){let e,i;for(let n of r)i!==void 0&&t(i,n)?e.push(n):(e&&(yield e),e=[n]),i=n;e&&(yield e)}function G_(r,t){for(let e=0;e<=r.length;e++)t(e===0?void 0:r[e-1],e===r.length?void 0:r[e])}function f7(r,t){for(let e=0;e<r.length;e++)t(e===0?void 0:r[e-1],r[e],e+1===r.length?void 0:r[e+1])}function Lie(r,t,e){let i=[];function n(a,l,d){if(l===0&&d.length===0)return;let c=i[i.length-1];c&&c.start+c.deleteCount===a?(c.deleteCount+=l,c.toInsert.push(...d)):i.push({start:a,deleteCount:l,toInsert:d})}let o=0,s=0;for(;;){if(o===r.length){n(o,0,t.slice(s));break}if(s===t.length){n(o,r.length-o,[]);break}let a=r[o],l=t[s],d=e(a,l);d===0?(o+=1,s+=1):d<0?(n(o,1,[]),o+=1):d>0&&(n(o,0,[l]),s+=1)}return i}function pg(r,t,e){let i=Lie(r,t,e),n=[],o=[];for(let s of i)n.push(...r.slice(s.start,s.start+s.deleteCount)),o.push(...s.toInsert);return{removed:n,added:o}}function Ei(r){return r.filter(t=>!!t)}function XF(r){let t=0;for(let e=0;e<r.length;e++)r[e]&&(r[t]=r[e],t+=1);r.length=t}function FS(r){return Array.isArray(r)&&r.length>0}function yo(r,t=e=>e){let e=new Set;return r.filter(i=>{let n=t(i);return e.has(n)?!1:(e.add(n),!0)})}function b7(r,t,e=(i,n)=>i===n){let i=0;for(let n=0,o=Math.min(r.length,t.length);n<o&&e(r[n],t[n]);n++)i++;return i}function Io(r,t){let e=typeof t=="number"?r:0;typeof t=="number"?e=r:(e=0,t=r);let i=[];if(e<=t)for(let n=e;n<t;n++)i.push(n);else for(let n=e;n>t;n--)i.push(n);return i}function Bu(r,t){return r.push(t),()=>kie(r,t)}function kie(r,t){let e=r.indexOf(t);if(e>-1)return r.splice(e,1),t}function pc(r,t,e){let i=r.slice(0,t),n=r.slice(t);return i.concat(e,n)}function QF(r,t){let e;if(typeof t=="number"){let i=t;e=()=>{let n=Math.sin(i++)*179426549;return n-Math.floor(n)}}else e=Math.random;for(let i=r.length-1;i>0;i-=1){let n=Math.floor(e()*(i+1)),o=r[i];r[i]=r[n],r[n]=o}}function q_(r,t){let e=r.indexOf(t);e>-1&&(r.splice(e,1),r.unshift(t))}function BS(r,t){let e=r.indexOf(t);e>-1&&(r.splice(e,1),r.push(t))}function VS(r,t){for(let e of t)r.push(e)}function v7(r){return Array.isArray(r)?r:[r]}function Rie(r,t,e){let i=y7(r,t),n=r.length,o=e.length;r.length=n+o;for(let s=n-1;s>=i;s--)r[s+o]=r[s];for(let s=0;s<o;s++)r[s+i]=e[s]}function JF(r,t,e,i){let n=y7(r,t),o=r.splice(n,e);return o===void 0&&(o=[]),Rie(r,n,i),o}function y7(r,t){return t<0?Math.max(t+r.length,0):Math.min(t,r.length)}var K_;(a=>{function r(l){return l<0}a.isLessThan=r;function t(l){return l<=0}a.isLessThanOrEqual=t;function e(l){return l>0}a.isGreaterThan=e;function i(l){return l===0}a.isNeitherLessOrGreaterThan=i,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(K_||={});function Qr(r,t){return(e,i)=>t(r(e),r(i))}function I7(...r){return(t,e)=>{for(let i of r){let n=i(t,e);if(!K_.isNeitherLessOrGreaterThan(n))return n}return K_.neitherLessOrGreaterThan}}var hc=(r,t)=>r-t,C7=(r,t)=>hc(r?1:0,t?1:0);function S7(r){return(t,e)=>-r(t,e)}var Sr=class{constructor(t){this.items=t}firstIdx=0;lastIdx=this.items.length-1;get length(){return this.lastIdx-this.firstIdx+1}takeWhile(t){let e=this.firstIdx;for(;e<this.items.length&&t(this.items[e]);)e++;let i=e===this.firstIdx?null:this.items.slice(this.firstIdx,e);return this.firstIdx=e,i}takeFromEndWhile(t){let e=this.lastIdx;for(;e>=0&&t(this.items[e]);)e--;let i=e===this.lastIdx?null:this.items.slice(e+1,this.lastIdx+1);return this.lastIdx=e,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let t=this.items[this.firstIdx];return this.firstIdx++,t}removeLast(){let t=this.items[this.lastIdx];return this.lastIdx--,t}takeCount(t){let e=this.items.slice(this.firstIdx,this.firstIdx+t);return this.firstIdx+=t,e}},Fu=class r{constructor(t){this.iterate=t}static empty=new r(t=>{});forEach(t){this.iterate(e=>(t(e),!0))}toArray(){let t=[];return this.iterate(e=>(t.push(e),!0)),t}filter(t){return new r(e=>this.iterate(i=>t(i)?e(i):!0))}map(t){return new r(e=>this.iterate(i=>e(t(i))))}some(t){let e=!1;return this.iterate(i=>(e=t(i),!e)),e}findFirst(t){let e;return this.iterate(i=>t(i)?(e=i,!1):!0),e}findLast(t){let e;return this.iterate(i=>(t(i)&&(e=i),!0)),e}findLastMaxBy(t){let e,i=!0;return this.iterate(n=>((i||K_.isGreaterThan(t(n,e)))&&(i=!1,e=n),!0)),e}};function ql(r,t,e){let i=r.get(t);return i===void 0&&(i=e,r.set(t,i)),i}var eB=class{constructor(t,e){this.uri=t;this.value=e}};function Aie(r){return Array.isArray(r)}var Ci=class r{static defaultToKey=t=>t.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(t,e){if(t instanceof r)this.map=new Map(t.map),this.toKey=e??r.defaultToKey;else if(Aie(t)){this.map=new Map,this.toKey=e??r.defaultToKey;for(let[i,n]of t)this.set(i,n)}else this.map=new Map,this.toKey=t??r.defaultToKey}set(t,e){return this.map.set(this.toKey(t),new eB(t,e)),this}get(t){return this.map.get(this.toKey(t))?.value}has(t){return this.map.has(this.toKey(t))}get size(){return this.map.size}clear(){this.map.clear()}delete(t){return this.map.delete(this.toKey(t))}forEach(t,e){typeof e<"u"&&(t=t.bind(e));for(let[i,n]of this.map)t(n.value,n.uri,this)}*values(){for(let t of this.map.values())yield t.value}*keys(){for(let t of this.map.values())yield t.uri}*entries(){for(let t of this.map.values())yield[t.uri,t.value]}*[Symbol.iterator](){for(let[,t]of this.map)yield[t.uri,t.value]}},Wb=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(t,e){!t||typeof t=="function"?this._map=new Ci(t):(this._map=new Ci(e),t.forEach(this.add,this))}get size(){return this._map.size}add(t){return this._map.set(t,t),this}clear(){this._map.clear()}delete(t){return this._map.delete(t)}forEach(t,e){this._map.forEach((i,n)=>t.call(e,n,n,this))}has(t){return this._map.has(t)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var tB=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(t){return this._map.has(t)}get(t,e=0){let i=this._map.get(t);if(i)return e!==0&&this.touch(i,e),i.value}set(t,e,i=0){let n=this._map.get(t);if(n)n.value=e,i!==0&&this.touch(n,i);else{switch(n={key:t,value:e,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(t,n),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){let e=this._map.get(t);if(e)return this._map.delete(t),this.removeItem(e),this._size--,e.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,e){let i=this._state,n=this._head;for(;n;){if(e?t.bind(e)(n.value,n.key,this):t(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){let t=this,e=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.key,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}values(){let t=this,e=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.value,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}entries(){let t=this,e=this._state,i=this._head,n={[Symbol.iterator](){return n},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:[i.key,i.value],done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}[Symbol.iterator](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let e=this._head,i=this.size;for(;e&&i>t;)this._map.delete(e.key),e=e.next,i--;this._head=e,this._size=i,e&&(e.previous=void 0),this._state++}trimNew(t){if(t>=this.size)return;if(t===0){this.clear();return}let e=this._tail,i=this.size;for(;e&&i>t;)this._map.delete(e.key),e=e.previous,i--;this._tail=e,this._size=i,e&&(e.next=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{let e=t.next,i=t.previous;if(!e||!i)throw new Error("Invalid list");e.previous=i,i.next=e}t.next=void 0,t.previous=void 0,this._state++}touch(t,e){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(e!==1&&e!==2)){if(e===1){if(t===this._head)return;let i=t.next,n=t.previous;t===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(e===2){if(t===this._tail)return;let i=t.next,n=t.previous;t===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){let t=[];return this.forEach((e,i)=>{t.push([i,e])}),t}fromJSON(t){this.clear();for(let[e,i]of t)this.set(e,i)}},iB=class extends tB{_limit;_ratio;constructor(t,e=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,e),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,e=2){return super.get(t,e)}peek(t){return super.get(t,0)}set(t,e){return super.set(t,e,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},$s=class extends iB{constructor(t,e=1){super(t,e)}trim(t){this.trimOld(t)}set(t,e){return super.set(t,e),this.checkTrim(),this}};var Vu=class{map=new Map;add(t,e){let i=this.map.get(t);i||(i=new Set,this.map.set(t,i)),i.add(e)}delete(t,e){let i=this.map.get(t);i&&(i.delete(e),i.size===0&&this.map.delete(t))}forEach(t,e){let i=this.map.get(t);i&&i.forEach(e)}get(t){let e=this.map.get(t);return e||new Set}};function w7(r,t){if(r===t)return!0;if(r.size!==t.size)return!1;for(let[e,i]of r)if(!t.has(e)||t.get(e)!==i)return!1;for(let[e]of t)if(!r.has(e))return!1;return!0}function jl(r,t){let e=this,i=!1,n;return function(){if(i)return n;if(i=!0,t)try{n=r.apply(e,arguments)}finally{t()}else n=r.apply(e,arguments);return n}}var Lt;(E=>{function r(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}E.is=r;let t=Object.freeze([]);function e(){return t}E.empty=e;function*i(S){yield S}E.single=i;function n(S){return r(S)?S:i(S)}E.wrap=n;function o(S){return S||t}E.from=o;function*s(S){for(let w=S.length-1;w>=0;w--)yield S[w]}E.reverse=s;function a(S){return!S||S[Symbol.iterator]().next().done===!0}E.isEmpty=a;function l(S){return S[Symbol.iterator]().next().value}E.first=l;function d(S,w){let D=0;for(let k of S)if(w(k,D++))return!0;return!1}E.some=d;function c(S,w){for(let D of S)if(w(D))return D}E.find=c;function*u(S,w){for(let D of S)w(D)&&(yield D)}E.filter=u;function*p(S,w){let D=0;for(let k of S)yield w(k,D++)}E.map=p;function*m(S,w){let D=0;for(let k of S)yield*w(k,D++)}E.flatMap=m;function*g(...S){for(let w of S)yield*w}E.concat=g;function f(S,w,D){let k=D;for(let R of S)k=w(k,R);return k}E.reduce=f;function*b(S,w,D=S.length){for(w<0&&(w+=S.length),D<0?D+=S.length:D>S.length&&(D=S.length);w<D;w++)yield S[w]}E.slice=b;function y(S,w=Number.POSITIVE_INFINITY){let D=[];if(w===0)return[D,S];let k=S[Symbol.iterator]();for(let R=0;R<w;R++){let A=k.next();if(A.done)return[D,E.empty()];D.push(A.value)}return[D,{[Symbol.iterator](){return k}}]}E.consume=y;async function I(S){let w=[];for await(let D of S)w.push(D);return Promise.resolve(w)}E.asyncToArray=I})(Lt||={});var Pie=!1,hg=null;function Mie(r){hg=r}if(Pie){let r="__is_disposable_tracked__";Mie(new class{trackDisposable(t){let e=new Error("Potentially leaked disposable").stack;setTimeout(()=>{t[r]||console.log(e)},3e3)}setParent(t,e){if(t&&t!==L.None)try{t[r]=!0}catch{}}markAsDisposed(t){if(t&&t!==L.None)try{t[r]=!0}catch{}}markAsSingleton(t){}})}function mg(r){return hg?.trackDisposable(r),r}function gg(r){hg?.markAsDisposed(r)}function WS(r,t){hg?.setParent(r,t)}function Oie(r,t){if(hg)for(let e of r)hg.setParent(e,t)}function mc(r){return hg?.markAsSingleton(r),r}function fg(r){return typeof r=="object"&&r!==null&&typeof r.dispose=="function"&&r.dispose.length===0}function nt(r){if(Lt.is(r)){let t=[];for(let e of r)if(e)try{e.dispose()}catch(i){t.push(i)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}function E7(r){for(let t of r)fg(t)&&t.dispose();return[]}function Ln(...r){let t=te(()=>nt(r));return Oie(r,t),t}function te(r){let t=mg({dispose:jl(()=>{gg(t),r()})});return t}var W=class r{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){mg(this)}dispose(){this._isDisposed||(gg(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{nt(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return WS(t,this),this._isDisposed?r.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(t),t.dispose()}}deleteAndLeak(t){t&&this._toDispose.has(t)&&(this._toDispose.delete(t),WS(t,null))}},L=class{static None=Object.freeze({dispose(){}});_store=new W;constructor(){mg(this),WS(this._store,this)}dispose(){gg(this),this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}},mt=class{_value;_isDisposed=!1;constructor(){mg(this)}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),t&&WS(t,this),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,gg(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t&&WS(t,null),t}};var Bo=class{_store=new Map;_isDisposed=!1;constructor(){mg(this)}dispose(){gg(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{nt(this._store.values())}finally{this._store.clear()}}has(t){return this._store.has(t)}get size(){return this._store.size}get(t){return this._store.get(t)}set(t,e,i=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this._store.get(t)?.dispose(),this._store.set(t,e)}deleteAndDispose(t){this._store.get(t)?.dispose(),this._store.delete(t)}deleteAndLeak(t){let e=this._store.get(t);return this._store.delete(t),e}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var T7=Object.freeze(function(r,t){let e=setTimeout(r.bind(t),0);return{dispose(){clearTimeout(e)}}}),In;(i=>{function r(n){return n===i.None||n===i.Cancelled||n instanceof Ub?!0:!n||typeof n!="object"?!1:typeof n.isCancellationRequested=="boolean"&&typeof n.onCancellationRequested=="function"}i.isCancellationToken=r,i.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:O.None}),i.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:T7})})(In||={});var Ub=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?T7:(this._emitter||(this._emitter=new T),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Cn=class{_token=void 0;_parentListener=void 0;constructor(t){this._parentListener=t&&t.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Ub),this._token}cancel(){this._token?this._token instanceof Ub&&this._token.cancel():this._token=In.Cancelled}dispose(t=!1){t&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof Ub&&this._token.dispose():this._token=In.None}};var Bn=class r{static Undefined=new r(void 0);element;next;prev;constructor(t){this.element=t,this.next=r.Undefined,this.prev=r.Undefined}},ao=class{_first=Bn.Undefined;_last=Bn.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===Bn.Undefined}clear(){let t=this._first;for(;t!==Bn.Undefined;){let e=t.next;t.prev=Bn.Undefined,t.next=Bn.Undefined,t=e}this._first=Bn.Undefined,this._last=Bn.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,e){let i=new Bn(t);if(this._first===Bn.Undefined)this._first=i,this._last=i;else if(e){let o=this._last;this._last=i,i.prev=o,o.next=i}else{let o=this._first;this._first=i,i.next=o,o.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==Bn.Undefined){let t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==Bn.Undefined){let t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==Bn.Undefined&&t.next!==Bn.Undefined){let e=t.prev;e.next=t.next,t.next.prev=e}else t.prev===Bn.Undefined&&t.next===Bn.Undefined?(this._first=Bn.Undefined,this._last=Bn.Undefined):t.next===Bn.Undefined?(this._last=this._last.prev,this._last.next=Bn.Undefined):t.prev===Bn.Undefined&&(this._first=this._first.next,this._first.prev=Bn.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==Bn.Undefined;)yield t.element,t=t.next}};var wr=(r,t)=>r===t;function oB(r=wr){return(t,e)=>ti(t,e,r)}function j_(r,t,e){if(e!==void 0){let i=r;return i==null||t===void 0||t===null?t===i:e(i,t)}else{let i=r;return(n,o)=>n==null||o===void 0||o===null?o===n:i(n,o)}}function _7(r){return JSON.stringify(nB(r))}var Nie=0,x7=new WeakMap;function nB(r){if(Array.isArray(r))return r.map(nB);if(r&&typeof r=="object")if(Object.getPrototypeOf(r)===Object.prototype){let t=r,e=Object.create(null);for(let i of Object.keys(t).sort())e[i]=nB(t[i]);return e}else{let t=x7.get(r);return t===void 0&&(t=Nie++,x7.set(r,t)),t+"----2b76a038c20c4bcc"}return r}var kn=class{constructor(t,e,i){this.owner=t;this.debugNameSource=e;this.referenceFn=i}getDebugName(t){return R7(t,this)}},D7=new Map,rB=new WeakMap;function R7(r,t){let e=rB.get(r);if(e)return e;let i=Fie(r,t);if(i){let n=D7.get(i)??0;n++,D7.set(i,n);let o=n===1?i:`${i}#${n}`;return rB.set(r,o),o}}function Fie(r,t){let e=rB.get(r);if(e)return e;let i=t.owner?Vie(t.owner)+".":"",n,o=t.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(n=o(),n!==void 0)return i+n}else return i+o;let s=t.referenceFn;if(s!==void 0&&(n=$_(s),n!==void 0))return i+n;if(t.owner!==void 0){let a=Bie(t.owner,r);if(a!==void 0)return i+a}}function Bie(r,t){for(let e in r)if(r[e]===t)return e}var L7=new Map,k7=new WeakMap;function Vie(r){let t=k7.get(r);if(t)return t;let e=Wie(r),i=L7.get(e)??0;i++,L7.set(e,i);let n=i===1?e:`${e}#${i}`;return k7.set(r,n),n}function Wie(r){let t=r.constructor;return t?t.name:"Object"}function $_(r){let t=r.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t);return(i?i[1]:void 0)?.trim()}function Y_(r,t){if(!r)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function US(r,t="Unreachable"){throw new Error(t)}function sB(r){r||Ke(new yt("Soft Assertion Failed"))}function $l(r){if(!r()){debugger;r(),Ke(new yt("Assertion Failed"))}}function HS(r,t){let e=0;for(;e<r.length-1;){let i=r[e],n=r[e+1];if(!t(i,n))return!1;e++}return!0}function Ut(r){return new Hb(new kn(void 0,void 0,r),r,void 0,void 0)}function Wu(r,t){return new Hb(new kn(r.owner,r.debugName,r.debugReferenceFn??t),t,void 0,void 0)}function ch(r,t){return new Hb(new kn(r.owner,r.debugName,r.debugReferenceFn??t),t,r.createEmptyChangeSummary,r.handleChange)}function Qo(r){let t=new W,e=Wu({owner:void 0,debugName:void 0,debugReferenceFn:r},i=>{t.clear(),r(i,t)});return te(()=>{e.dispose(),t.dispose()})}var Hb=class{constructor(t,e,i,n){this._debugNameData=t;this._runFn=e;this.createChangeSummary=i;this._handleChange=n;this.changeSummary=this.createChangeSummary?.(),Ys()?.handleAutorunCreated(this),this._runIfNeeded(),mg(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),gg(this)}_runIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t,this.state=3;let e=this.disposed;try{if(!e){Ys()?.handleAutorunTriggered(this);let i=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,i)}catch(n){Bb(n)}}}finally{e||Ys()?.handleAutorunFinished(this);for(let i of this.dependenciesToBeRemoved)i.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}$l(()=>this.updateCount>=0)}handlePossibleChange(t){this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)&&(this.state=1)}handleChange(t,e){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t))try{(this._handleChange?this._handleChange({changedObservable:t,change:e,didChange:n=>n===t},this.changeSummary):!0)&&(this.state=2)}catch(i){Bb(i)}}readObservable(t){if(this.disposed)return t.get();t.addObserver(this);let e=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),e}};(t=>t.Observer=Hb)(Ut||={});function et(r,t){return t!==void 0?new Uu(new kn(r,void 0,t),t,void 0,void 0,void 0,wr):new Uu(new kn(void 0,void 0,r),r,void 0,void 0,void 0,wr)}function zb(r,t,e){return new aB(new kn(r,void 0,t),t,void 0,void 0,void 0,wr,e)}function gc(r,t){return new Uu(new kn(r.owner,r.debugName,r.debugReferenceFn),t,void 0,void 0,r.onLastObserverRemoved,r.equalsFn??wr)}A7(gc);function Hu(r,t){let e,i;t===void 0?(e=r,i=void 0):(i=r,e=t);let n=new W;return new Uu(new kn(i,void 0,e),o=>(n.clear(),e(o,n)),void 0,void 0,()=>n.dispose(),wr)}function Ea(r,t){let e,i;t===void 0?(e=r,i=void 0):(i=r,e=t);let n;return new Uu(new kn(i,void 0,e),o=>{n?n.clear():n=new W;let s=e(o);return s&&n.add(s),s},void 0,void 0,()=>{n&&(n.dispose(),n=void 0)},wr)}var Uu=class extends Yl{constructor(e,i,n,o,s=void 0,a){super();this._debugNameData=e;this._computeFn=i;this.createChangeSummary=n;this._handleChange=o;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Ys()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let e=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),e}else{do{if(this.state===1){for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;let i=this.state!==0,n=this.value;this.state=3;let o=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}o=i&&!this._equalityComparator(n,this.value),Ys()?.handleDerivedRecomputed(this,{oldValue:n,newValue:this.value,change:void 0,didChange:o,hadValue:i})}catch(s){Bb(s)}if(o)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;let i=this.updateCount===1;if(this.state===3&&(this.state=1,!i))for(let n of this.observers)n.handlePossibleChange(this);if(i)for(let n of this.observers)n.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){let i=[...this.observers];for(let n of i)n.endUpdate(this)}$l(()=>this.updateCount>=0)}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(let i of this.observers)i.handlePossibleChange(this)}}handleChange(e,i){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){let n=!1;try{n=this._handleChange?this._handleChange({changedObservable:e,change:i,didChange:s=>s===e},this.changeSummary):!0}catch(s){Bb(s)}let o=this.state===3;if(n&&(this.state===1||o)&&(this.state=2,o))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);let i=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),i}addObserver(e){let i=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),i&&e.beginUpdate(this)}removeObserver(e){let i=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),i&&e.endUpdate(this)}},aB=class extends Uu{constructor(e,i,n,o,s=void 0,a,l){super(e,i,n,o,s,a);this.set=l}};function uh(r){return new lB(r)}var lB=class extends zS{constructor(e){super();this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}};function Ti(...r){let t,e,i;return r.length===3?[t,e,i]=r:[e,i]=r,new fc(new kn(t,void 0,i),e,i,()=>fc.globalTransaction,wr)}function P7(r,t,e){return new fc(new kn(r.owner,r.debugName,r.debugReferenceFn??e),t,e,()=>fc.globalTransaction,r.equalsFn??wr)}var fc=class extends Yl{constructor(e,i,n,o,s){super();this._debugNameData=e;this.event=i;this._getValue=n;this._getTransaction=o;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=e=>{let i=this._getValue(e),n=this.value,o=!this.hasValue||!this._equalityComparator(n,i),s=!1;o&&(this.value=i,this.hasValue&&(s=!0,vg(this._getTransaction(),a=>{Ys()?.handleFromEventObservableTriggered(this,{oldValue:n,newValue:i,change:void 0,didChange:o,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Ys()?.handleFromEventObservableTriggered(this,{oldValue:n,newValue:i,change:void 0,didChange:o,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(e=>{e.Observer=fc;function t(i,n){let o=!1;fc.globalTransaction===void 0&&(fc.globalTransaction=i,o=!0);try{n()}finally{o&&(fc.globalTransaction=void 0)}}e.batchEventsGlobally=t})(Ti||={});function Jo(r,t){return new dB(r,t)}var dB=class extends Yl{constructor(e,i){super();this.debugName=e;this.event=i}subscription;onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=()=>{Yi(e=>{for(let i of this.observers)e.updateObserver(i,this),i.handleChange(this,void 0)},()=>this.debugName)};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}};function bg(r){return typeof r=="string"?new Z_(r):new Z_(void 0,r)}var Z_=class extends Yl{constructor(e,i){super();this._debugName=e;this._owner=i}get debugName(){return new kn(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(e,i){if(!e){Yi(n=>{this.trigger(n,i)},()=>`Trigger signal ${this.debugName}`);return}for(let n of this.observers)e.updateObserver(n,this),n.handleChange(this,i)}get(){}};function M7(r){let t=new X_(!1,void 0);return r.addObserver(t),te(()=>{r.removeObserver(t)})}B7(M7);function Kb(r,t){let e=new X_(!0,t);return r.addObserver(e),t?t(r.get()):r.reportChanges(),te(()=>{r.removeObserver(e)})}F7(Kb);var X_=class{constructor(t,e){this._forceRecompute=t;this._handleValue=e}_counter=0;beginUpdate(t){this._counter++}endUpdate(t){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(t.get()):t.reportChanges())}handlePossibleChange(t){}handleChange(t,e){}};function O7(r,t){let e;return gc({owner:r,debugReferenceFn:t},n=>(e=t(n,e),e))}var Q_=class{constructor(t){this.observable=t}get onDidChange(){return O.fromObservableLight(this.observable)}get value(){return this.observable.get()}};function N7(r,t){return O7(r,(e,i)=>i??t(e))}var V7;function W7(r){V7=r}function Ys(){return V7}var J_=class{indentation=0;textToConsoleArgs(t){return zie([Gb(qie("|  ",this.indentation)),t])}formatInfo(t){return t.hadValue?t.didChange?[Gb(" "),Zl(GS(t.oldValue,70),{color:"red",strikeThrough:!0}),Gb(" "),Zl(GS(t.newValue,60),{color:"green"})]:[Gb(" (unchanged)")]:[Gb(" "),Zl(GS(t.newValue,60),{color:"green"}),Gb(" (initial)")]}handleObservableChanged(t,e){console.log(...this.textToConsoleArgs([KS("observable value changed"),Zl(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e)]))}changedObservablesSets=new WeakMap;formatChanges(t){if(t.size!==0)return Zl(" (changed deps: "+[...t].map(e=>e.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(t){let e=t.handleChange;this.changedObservablesSets.set(t,new Set),t.handleChange=(i,n)=>(this.changedObservablesSets.get(t).add(i),e.apply(t,[i,n]))}handleDerivedRecomputed(t,e){let i=this.changedObservablesSets.get(t);console.log(...this.textToConsoleArgs([KS("derived recomputed"),Zl(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e),this.formatChanges(i),{data:[{fn:t._debugNameData.referenceFn??t._computeFn}]}])),i.clear()}handleFromEventObservableTriggered(t,e){console.log(...this.textToConsoleArgs([KS("observable from event triggered"),Zl(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e),{data:[{fn:t._getValue}]}]))}handleAutorunCreated(t){let e=t.handleChange;this.changedObservablesSets.set(t,new Set),t.handleChange=(i,n)=>(this.changedObservablesSets.get(t).add(i),e.apply(t,[i,n]))}handleAutorunTriggered(t){let e=this.changedObservablesSets.get(t);console.log(...this.textToConsoleArgs([KS("autorun"),Zl(t.debugName,{color:"BlueViolet"}),this.formatChanges(e),{data:[{fn:t._debugNameData.referenceFn??t._runFn}]}])),e.clear(),this.indentation++}handleAutorunFinished(t){this.indentation--}handleBeginTransaction(t){let e=t.getDebugName();e===void 0&&(e=""),console.log(...this.textToConsoleArgs([KS("transaction"),Zl(e,{color:"BlueViolet"}),{data:[{fn:t._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function zie(r){let t=new Array,e=[],i="";function n(s){if("length"in s)for(let a of s)a&&n(a);else"text"in s?(i+=`%c${s.text}`,t.push(s.style),s.data&&e.push(...s.data)):"data"in s&&e.push(...s.data)}n(r);let o=[i,...t];return o.push(...e),o}function Gb(r){return Zl(r,{color:"black"})}function KS(r){return Zl(jie(`${r}: `,10),{color:"black",bold:!0})}function Zl(r,t={color:"black"}){function e(n){return Object.entries(n).reduce((o,[s,a])=>`${o}${s}:${a};`,"")}let i={color:t.color};return t.strikeThrough&&(i["text-decoration"]="line-through"),t.bold&&(i["font-weight"]="bold"),{text:r,style:e(i)}}function GS(r,t){switch(typeof r){case"number":return""+r;case"string":return r.length+2<=t?`"${r}"`:`"${r.substr(0,t-7)}"+...`;case"boolean":return r?"true":"false";case"undefined":return"undefined";case"object":return r===null?"null":Array.isArray(r)?Kie(r,t):Gie(r,t);case"symbol":return r.toString();case"function":return`[[Function${r.name?" "+r.name:""}]]`;default:return""+r}}function Kie(r,t){let e="[ ",i=!0;for(let n of r){if(i||(e+=", "),e.length-5>t){e+="...";break}i=!1,e+=`${GS(n,t-e.length)}`}return e+=" ]",e}function Gie(r,t){let e="{ ",i=!0;for(let[n,o]of Object.entries(r)){if(i||(e+=", "),e.length-5>t){e+="...";break}i=!1,e+=`${n}: ${GS(o,t-e.length)}`}return e+=" }",e}function qie(r,t){let e="";for(let i=1;i<=t;i++)e+=r;return e}function jie(r,t){for(;r.length<t;)r+=" ";return r}var U7;function F7(r){U7=r}var H7;function B7(r){H7=r}var cB;function A7(r){cB=r}var zS=class{get TChange(){return null}reportChanges(){this.get()}read(t){return t?t.readObservable(this):this.get()}map(t,e){let i=e===void 0?void 0:t,n=e===void 0?t:e;return cB({owner:i,debugName:()=>{let o=$_(n);if(o!==void 0)return o;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(n.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:n},o=>n(this.read(o),o))}flatten(){return cB({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},t=>this.read(t).read(t))}recomputeInitiallyAndOnChange(t,e){return t.add(U7(this,e)),this}keepObserved(t){return t.add(H7(this)),this}get debugValue(){return this.get()}},Yl=class extends zS{observers=new Set;addObserver(t){let e=this.observers.size;this.observers.add(t),e===0&&this.onFirstObserverAdded()}removeObserver(t){this.observers.delete(t)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function Yi(r,t){let e=new ph(r,t);try{r(e)}finally{e.finish()}}function vg(r,t,e){r?t(r):Yi(t,e)}var ph=class{constructor(t,e){this._fn=t;this._getDebugName=e;Ys()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():$_(this._fn)}updateObserver(t,e){this.updatingObservers.push({observer:t,observable:e}),t.beginUpdate(e)}finish(){let t=this.updatingObservers;for(let e=0;e<t.length;e++){let{observer:i,observable:n}=t[e];i.endUpdate(n)}this.updatingObservers=null,Ys()?.handleEndTransaction()}};function Kt(r,t){let e;return typeof r=="string"?e=new kn(void 0,r,void 0):e=new kn(r,void 0,void 0),new qb(e,t,wr)}var qb=class extends Yl{constructor(e,i,n){super();this._debugNameData=e;this._equalityComparator=n;this._value=i}_value;get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(e,i,n){if(n===void 0&&this._equalityComparator(this._value,e))return;let o;i||(i=o=new ph(()=>{},()=>`Setting ${this.debugName}`));try{let s=this._value;this._setValue(e),Ys()?.handleObservableChanged(this,{oldValue:s,newValue:e,change:n,didChange:!0,hadValue:!0});for(let a of this.observers)i.updateObserver(a,this),a.handleChange(this,n)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}};function pB(r,t){let e;return typeof r=="string"?e=new kn(void 0,r,void 0):e=new kn(r,void 0,void 0),new uB(e,t,wr)}var uB=class extends qb{_setValue(t){this._value!==t&&(this._value&&this._value.dispose(),this._value=t)}dispose(){this._value?.dispose()}};function hB(r,t,e,i){return t||(t=n=>n!=null),new Promise((n,o)=>{let s=!0,a=!1,l=r.map(c=>({isFinished:t(c),error:e?e(c):!1,state:c})),d=Ut(c=>{let{isFinished:u,error:p,state:m}=l.read(c);(u||p)&&(s?a=!0:d.dispose(),p?o(p===!0?m:p):n(m))});if(i){let c=i.onCancellationRequested(()=>{d.dispose(),c.dispose(),o(new Cr)});if(i.isCancellationRequested){d.dispose(),c.dispose(),o(new Cr);return}}s=!1,a&&d.dispose()})}var eD=class extends Yl{constructor(e,i,n){super();this._debugNameData=e;this._equalityComparator=n;this._value=i}_value;_isUpToDate=!0;_deltas=[];get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(let e of this.observers)for(let i of this._deltas)e.handleChange(this,i);this._deltas.length=0}else for(let e of this.observers)e.handleChange(this,void 0)}_updateCounter=0;_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(let e of this.observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();let e=[...this.observers];for(let i of e)i.endUpdate(this)}}addObserver(e){let i=!this.observers.has(e)&&this._updateCounter>0;super.addObserver(e),i&&e.beginUpdate(this)}removeObserver(e){let i=this.observers.has(e)&&this._updateCounter>0;super.removeObserver(e),i&&e.endUpdate(this)}set(e,i,n){if(n===void 0&&this._equalityComparator(this._value,e))return;let o;i||(i=o=new ph(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),n!==void 0&&this._deltas.push(n),i.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(s,a)=>{},handlePossibleChange:s=>{}},this),this._updateCounter>1)for(let s of this.observers)s.handlePossibleChange(this)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}};function tD(r,t){return r.lazy?new eD(new kn(r.owner,r.debugName,void 0),t,r.equalsFn??wr):new qb(new kn(r.owner,r.debugName,void 0),t,r.equalsFn??wr)}var $ie=!1;$ie&&W7(new J_);var Yie=globalThis.performance&&typeof globalThis.performance.now=="function",ll=class r{_startTime;_stopTime;_now;static create(t){return new r(t)}constructor(t){this._now=Yie&&t===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var iD=Symbol("MicrotaskDelay");var Zie=!1,z7=!1,Xie=!1,O;(Ve=>{Ve.None=()=>L.None;function t(me){if(Xie){let{onDidAddListener:ce}=me,xe=jS.create(),Ie=0;me.onDidAddListener=()=>{++Ie===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),xe.print()),ce?.()}}}function e(me,ce){return m(me,()=>{},0,void 0,!0,void 0,ce)}Ve.defer=e;function i(me){return(ce,xe=null,Ie)=>{let ge=!1,He;return He=me(_e=>{if(!ge)return He?He.dispose():ge=!0,ce.call(xe,_e)},null,Ie),ge&&He.dispose(),He}}Ve.once=i;function n(me,ce){return Ve.once(Ve.filter(me,ce))}Ve.onceIf=n;function o(me,ce,xe){return u((Ie,ge=null,He)=>me(_e=>Ie.call(ge,ce(_e)),null,He),xe)}Ve.map=o;function s(me,ce,xe){return u((Ie,ge=null,He)=>me(_e=>{ce(_e),Ie.call(ge,_e)},null,He),xe)}Ve.forEach=s;function a(me,ce,xe){return u((Ie,ge=null,He)=>me(_e=>ce(_e)&&Ie.call(ge,_e),null,He),xe)}Ve.filter=a;function l(me){return me}Ve.signal=l;function d(...me){return(ce,xe=null,Ie)=>{let ge=Ln(...me.map(He=>He(_e=>ce.call(xe,_e))));return p(ge,Ie)}}Ve.any=d;function c(me,ce,xe,Ie){let ge=xe;return o(me,He=>(ge=ce(ge,He),ge),Ie)}Ve.reduce=c;function u(me,ce){let xe,Ie={onWillAddFirstListener(){xe=me(ge.fire,ge)},onDidRemoveLastListener(){xe?.dispose()}};ce||t(Ie);let ge=new T(Ie);return ce?.add(ge),ge.event}function p(me,ce){return ce instanceof Array?ce.push(me):ce&&ce.add(me),me}function m(me,ce,xe=100,Ie=!1,ge=!1,He,_e){let xt,bt,je,_n=0,pn,no={leakWarningThreshold:He,onWillAddFirstListener(){xt=me(zl=>{_n++,bt=ce(bt,zl),Ie&&!je&&(No.fire(bt),bt=void 0),pn=()=>{let Ai=bt;bt=void 0,je=void 0,(!Ie||_n>1)&&No.fire(Ai),_n=0},typeof xe=="number"?(clearTimeout(je),je=setTimeout(pn,xe)):je===void 0&&(je=0,queueMicrotask(pn))})},onWillRemoveListener(){ge&&_n>0&&pn?.()},onDidRemoveLastListener(){pn=void 0,xt.dispose()}};_e||t(no);let No=new T(no);return _e?.add(No),No.event}Ve.debounce=m;function g(me,ce=0,xe){return Ve.debounce(me,(Ie,ge)=>Ie?(Ie.push(ge),Ie):[ge],ce,void 0,!0,void 0,xe)}Ve.accumulate=g;function f(me,ce=(Ie,ge)=>Ie===ge,xe){let Ie=!0,ge;return a(me,He=>{let _e=Ie||!ce(He,ge);return Ie=!1,ge=He,_e},xe)}Ve.latch=f;function b(me,ce,xe){return[Ve.filter(me,ce,xe),Ve.filter(me,Ie=>!ce(Ie),xe)]}Ve.split=b;function y(me,ce=!1,xe=[],Ie){let ge=xe.slice(),He=me(bt=>{ge?ge.push(bt):xt.fire(bt)});Ie&&Ie.add(He);let _e=()=>{ge?.forEach(bt=>xt.fire(bt)),ge=null},xt=new T({onWillAddFirstListener(){He||(He=me(bt=>xt.fire(bt)),Ie&&Ie.add(He))},onDidAddFirstListener(){ge&&(ce?setTimeout(_e):_e())},onDidRemoveLastListener(){He&&He.dispose(),He=null}});return Ie&&Ie.add(xt),xt.event}Ve.buffer=y;function I(me,ce){return(Ie,ge,He)=>{let _e=ce(new S);return me(function(xt){let bt=_e.evaluate(xt);bt!==E&&Ie.call(ge,bt)},void 0,He)}}Ve.chain=I;let E=Symbol("HaltChainable");class S{steps=[];map(ce){return this.steps.push(ce),this}forEach(ce){return this.steps.push(xe=>(ce(xe),xe)),this}filter(ce){return this.steps.push(xe=>ce(xe)?xe:E),this}reduce(ce,xe){let Ie=xe;return this.steps.push(ge=>(Ie=ce(Ie,ge),Ie)),this}latch(ce=(xe,Ie)=>xe===Ie){let xe=!0,Ie;return this.steps.push(ge=>{let He=xe||!ce(ge,Ie);return xe=!1,Ie=ge,He?ge:E}),this}evaluate(ce){for(let xe of this.steps)if(ce=xe(ce),ce===E)break;return ce}}function w(me,ce,xe=Ie=>Ie){let Ie=(...xt)=>_e.fire(xe(...xt)),ge=()=>me.on(ce,Ie),He=()=>me.removeListener(ce,Ie),_e=new T({onWillAddFirstListener:ge,onDidRemoveLastListener:He});return _e.event}Ve.fromNodeEventEmitter=w;function D(me,ce,xe=Ie=>Ie){let Ie=(...xt)=>_e.fire(xe(...xt)),ge=()=>me.addEventListener(ce,Ie),He=()=>me.removeEventListener(ce,Ie),_e=new T({onWillAddFirstListener:ge,onDidRemoveLastListener:He});return _e.event}Ve.fromDOMEventEmitter=D;function k(me){return new Promise(ce=>i(me)(ce))}Ve.toPromise=k;function R(me){let ce=new T;return me.then(xe=>{ce.fire(xe)},()=>{ce.fire(void 0)}).finally(()=>{ce.dispose()}),ce.event}Ve.fromPromise=R;function A(me,ce){return me(xe=>ce.fire(xe))}Ve.forward=A;function H(me,ce,xe){return ce(xe),me(Ie=>ce(Ie))}Ve.runAndSubscribe=H;class z{constructor(ce,xe){this._observable=ce;let Ie={onWillAddFirstListener:()=>{ce.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{ce.removeObserver(this)}};xe||t(Ie),this.emitter=new T(Ie),xe&&xe.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(ce){this._counter++}handlePossibleChange(ce){}handleChange(ce,xe){this._hasChanged=!0}endUpdate(ce){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Z(me,ce){return new z(me,ce).emitter.event}Ve.fromObservable=Z;function fe(me){return(ce,xe,Ie)=>{let ge=0,He=!1,_e={beginUpdate(){ge++},endUpdate(){ge--,ge===0&&(me.reportChanges(),He&&(He=!1,ce.call(xe)))},handlePossibleChange(){},handleChange(){He=!0}};me.addObserver(_e),me.reportChanges();let xt={dispose(){me.removeObserver(_e)}};return Ie instanceof W?Ie.add(xt):Array.isArray(Ie)&&Ie.push(xt),xt}}Ve.fromObservableLight=fe})(O||={});var mB=class r{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(t){this.name=`${t}_${r._idPool++}`,r.all.add(this)}start(t){this._stopWatch=new ll,this.listenerCount=t}stop(){if(this._stopWatch){let t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}},qS=-1;function K7(r){let t=qS;return qS=r,{dispose(){qS=t}}}var gB=class r{constructor(t,e,i=(r._idPool++).toString(16).padStart(3,"0")){this._errorHandler=t;this.threshold=e;this.name=i}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(t,e){let i=this.threshold;if(i<=0||e<i)return;this._stacks||(this._stacks=new Map);let n=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let[o,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${e} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(o);let l=new fB(a,o);this._errorHandler(l)}return()=>{let o=this._stacks.get(t.value)||0;this._stacks.set(t.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let t,e=0;for(let[i,n]of this._stacks)(!t||e<n)&&(t=[i,n],e=n);return t}},jS=class r{constructor(t){this.value=t}static create(){let t=new Error;return new r(t.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},fB=class extends Error{constructor(t,e){super(t),this.name="ListenerLeakError",this.stack=e}},bB=class extends Error{constructor(t,e){super(t),this.name="ListenerRefusalError",this.stack=e}},Qie=0,jb=class{constructor(t){this.value=t}stack;id=Qie++},Jie=2,G7=(r,t)=>{if(r instanceof jb)t(r);else for(let e=0;e<r.length;e++){let i=r[e];i&&t(i)}},nD;if(Zie){let r=[];setInterval(()=>{r.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(r.join(`
`)),r.length=0)},3e3),nD=new FinalizationRegistry(t=>{typeof t=="string"&&r.push(t)})}var T=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(t){this._options=t,this._leakageMon=qS>0||this._options?.leakWarningThreshold?new gB(t?.onListenerError??Ke,this._options?.leakWarningThreshold??qS):void 0,this._perfMon=this._options?._profName?new mB(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(z7){let t=this._listeners;queueMicrotask(()=>{G7(t,e=>e.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(t,e,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new bB(`${l}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||Ke)(c),L.None}if(this._disposed)return L.None;e&&(t=t.bind(e));let n=new jb(t),o,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=jS.create(),o=this._leakageMon.check(n.stack,this._size+1)),z7&&(n.stack=s??jS.create()),this._listeners?this._listeners instanceof jb?(this._deliveryQueue??=new oD,this._listeners=[this._listeners,n]):this._listeners.push(n):(this._options?.onWillAddFirstListener?.(this),this._listeners=n,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=te(()=>{nD?.unregister(a),o?.(),this._removeListener(n)});if(i instanceof W?i.add(a):Array.isArray(i)&&i.push(a),nD){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),d=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);nD.register(a,d?.[2]??l,a)}return a},this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let e=this._listeners,i=e.indexOf(t);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,e[i]=void 0;let n=this._deliveryQueue.current===this;if(this._size*Jie<=e.length){let o=0;for(let s=0;s<e.length;s++)e[s]?e[o++]=e[s]:n&&(this._deliveryQueue.end--,o<this._deliveryQueue.i&&this._deliveryQueue.i--);e.length=o}}_deliver(t,e){if(!t)return;let i=this._options?.onListenerError||Ke;if(!i){t.value(e);return}try{t.value(e)}catch(n){i(n)}}_deliverQueue(t){let e=t.current._listeners;for(;t.i<t.end;)this._deliver(e[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof jb)this._deliver(this._listeners,t);else{let e=this._deliveryQueue;e.enqueue(this,t,this._listeners.length),this._deliverQueue(e)}this._perfMon?.stop()}hasListeners(){return this._size>0}},q7=()=>new oD,oD=class{i=-1;end=0;current;value;enqueue(t,e,i){this.i=0,this.end=i,this.current=t,this.value=e}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},$b=class extends T{_asyncDeliveryQueue;async fireAsync(t,e,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new ao),G7(this._listeners,n=>this._asyncDeliveryQueue.push([n.value,t]));this._asyncDeliveryQueue.size>0&&!e.isCancellationRequested;){let[n,o]=this._asyncDeliveryQueue.shift(),s=[],a={...o,token:e,waitUntil:l=>{if(Object.isFrozen(s))throw new Error("waitUntil can NOT be called asynchronous");i&&(l=i(l,n)),s.push(l)}};try{n(a)}catch(l){Ke(l);continue}Object.freeze(s),await Promise.allSettled(s).then(l=>{for(let d of l)d.status==="rejected"&&Ke(d.reason)})}}},hh=class extends T{_isPaused=0;_eventQueue=new ao;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(t){super(t),this._mergeFn=t?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let t=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(t))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(t){this._size&&(this._isPaused!==0?this._eventQueue.push(t):super.fire(t))}},rD=class extends hh{_delay;_handle;constructor(t){super(t),this._delay=t.delay??100}fire(t){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(t)}},sD=class extends T{_queuedEvents=[];_mergeFn;constructor(t){super(t),this._mergeFn=t?.merge}fire(t){this.hasListeners()&&(this._queuedEvents.push(t),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(e=>super.fire(e)),this._queuedEvents=[]}))}},$S=class{emitter;hasListeners=!1;events=[];constructor(){this.emitter=new T({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(t){let e={event:t,listener:null};return this.events.push(e),this.hasListeners&&this.hook(e),te(jl(()=>{this.hasListeners&&this.unhook(e);let n=this.events.indexOf(e);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(t=>this.hook(t))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(t=>this.unhook(t))}hook(t){t.listener=t.event(e=>this.emitter.fire(e))}unhook(t){t.listener?.dispose(),t.listener=null}dispose(){this.emitter.dispose();for(let t of this.events)t.listener?.dispose();this.events=[]}};var mh=class{data=[];wrapEvent(t,e,i){return(n,o,s)=>t(a=>{let l=this.data[this.data.length-1];if(!e){l?l.buffers.push(()=>n.call(o,a)):n.call(o,a);return}let d=l;if(!d){n.call(o,e(i,a));return}d.items??=[],d.items.push(a),d.buffers.length===0&&l.buffers.push(()=>{d.reducedResult??=i?d.items.reduce(e,i):d.items.reduce(e),n.call(o,d.reducedResult)})},void 0,s)}bufferEvents(t){let e={buffers:new Array};this.data.push(e);let i=t();return this.data.pop(),e.buffers.forEach(n=>n()),i}},Er=class{listening=!1;inputEvent=O.None;inputEventListener=L.None;emitter=new T({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(t){this.inputEvent=t,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=t(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};function si(r){return typeof r=="string"}function Mi(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function j7(r){let t=Object.getPrototypeOf(Uint8Array);return typeof r=="object"&&r instanceof t}function Vo(r){return typeof r=="number"&&!isNaN(r)}function vB(r){return!!r&&typeof r[Symbol.iterator]=="function"}function gh(r){return r===!0||r===!1}function Vn(r){return typeof r>"u"}function zu(r){return!Zi(r)}function Zi(r){return Vn(r)||r===null}function Yb(r,t){if(!r)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function Ue(r){if(Zi(r))throw new Error("Assertion Failed: argument is undefined or null");return r}function Zs(...r){let t=[];for(let e=0;e<r.length;e++){let i=r[e];if(Zi(i))throw new Error(`Assertion Failed: argument at index ${e} is undefined or null`);t.push(i)}return t}var tne=Object.prototype.hasOwnProperty;function Xl(r){if(!Mi(r))return!1;for(let t in r)if(tne.call(r,t))return!1;return!0}function yg(r){return typeof r=="function"}function $7(r,t){let e=Math.min(r.length,t.length);for(let i=0;i<e;i++)ine(r[i],t[i])}function ine(r,t){if(si(t)){if(typeof r!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(yg(t)){try{if(r instanceof t)return}catch{}if(!Zi(r)&&r.constructor===t||t.length===1&&t.call(void 0,r)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var Xs=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(t,e=[],i=!1){this.ctor=t,this.staticArguments=e,this.supportsDelayedInstantiation=i}};var Wr=class{_entries=new Map;constructor(...t){for(let[e,i]of t)this.set(e,i)}set(t,e){let i=this._entries.get(t);return this._entries.set(t,e),i}has(t){return this._entries.has(t)}get(t){return this._entries.get(t)}};var Ql;(n=>{n.serviceIds=new Map,n.DI_TARGET="$di$target",n.DI_DEPENDENCIES="$di$dependencies";function i(o){return o[n.DI_DEPENDENCIES]||[]}n.getServiceDependencies=i})(Ql||={});var ae=$("instantiationService");function nne(r,t,e){t[Ql.DI_TARGET]===t?t[Ql.DI_DEPENDENCIES].push({id:r,index:e}):(t[Ql.DI_DEPENDENCIES]=[{id:r,index:e}],t[Ql.DI_TARGET]=t)}function $(r){if(Ql.serviceIds.has(r))return Ql.serviceIds.get(r);let t=function(e,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");nne(t,e,n)};return t.toString=()=>r,Ql.serviceIds.set(r,t),t}function Y7(r){return r}var aD=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(t,e){typeof t=="function"?(this._fn=t,this._computeKey=Y7):(this._fn=e,this._computeKey=t.getCacheKey)}get(t){let e=this._computeKey(t);return this.lastArgKey!==e&&(this.lastArgKey=e,this.lastCache=this._fn(t)),this.lastCache}},fh=class{_map=new Map;_map2=new Map;get cachedValues(){return this._map}_fn;_computeKey;constructor(t,e){typeof t=="function"?(this._fn=t,this._computeKey=Y7):(this._fn=e,this._computeKey=t.getCacheKey)}get(t){let e=this._computeKey(t);if(this._map2.has(e))return this._map2.get(e);let i=this._fn(t);return this._map.set(t,i),this._map2.set(e,i),i}};var an=class{constructor(t){this.executor=t}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(t){this._error=t}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Ig(r){return r<0?0:r>255?255:r|0}function YS(r){return!r||typeof r!="string"?!0:r.trim().length===0}function X7(r){return r.replace(/[<>"'&]/g,t=>{switch(t){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return t})}function Ku(r){return r.replace(/[<>&]/g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return t}})}function Jr(r){return r.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function Q7(r,t=" "){let e=vh(r,t);return Gu(e,t)}function vh(r,t){if(!r||!t)return r;let e=t.length;if(e===0||r.length===0)return r;let i=0;for(;r.indexOf(t,i)===i;)i=i+e;return r.substring(i)}function Gu(r,t){if(!r||!t)return r;let e=t.length,i=r.length;if(e===0||i===0)return r;let n=i,o=-1;for(;o=r.lastIndexOf(t,n-1),!(o===-1||o+e!==n);){if(o===0)return"";n=o}return r.substring(0,n)}function J7(r){return r.replace(/\*/g,"")}function dD(r,t,e={}){if(!r)throw new Error("Cannot create regex from empty string");t||(r=Jr(r)),e.wholeWord&&(/\B/.test(r.charAt(0))||(r="\\b"+r),/\B/.test(r.charAt(r.length-1))||(r=r+"\\b"));let i="";return e.global&&(i+="g"),e.matchCase||(i+="i"),e.multiline&&(i+="m"),e.unicode&&(i+="u"),new RegExp(r,i)}function ZS(r){return r.split(/\r\n|\r|\n/)}function Rn(r){for(let t=0,e=r.length;t<e;t++){let i=r.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function Co(r,t=0,e=r.length){for(let i=t;i<e;i++){let n=r.charCodeAt(i);if(n!==32&&n!==9)return r.substring(t,i)}return r.substring(t,e)}function Ta(r,t=r.length-1){for(let e=t;e>=0;e--){let i=r.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function XS(r,t){return r<t?-1:r>t?1:0}function cD(r,t,e=0,i=r.length,n=0,o=t.length){for(;e<i&&n<o;e++,n++){let l=r.charCodeAt(e),d=t.charCodeAt(n);if(l<d)return-1;if(l>d)return 1}let s=i-e,a=o-n;return s<a?-1:s>a?1:0}function uD(r,t){return Zb(r,t,0,r.length,0,t.length)}function Zb(r,t,e=0,i=r.length,n=0,o=t.length){for(;e<i&&n<o;e++,n++){let l=r.charCodeAt(e),d=t.charCodeAt(n);if(l===d)continue;if(l>=128||d>=128)return cD(r.toLowerCase(),t.toLowerCase(),e,i,n,o);Cg(l)&&(l-=32),Cg(d)&&(d-=32);let c=l-d;if(c!==0)return c}let s=i-e,a=o-n;return s<a?-1:s>a?1:0}function QS(r){return r>=48&&r<=57}function Cg(r){return r>=97&&r<=122}function vc(r){return r>=65&&r<=90}function Qs(r,t){return r.length===t.length&&Zb(r,t)===0}function yh(r,t){let e=t.length;return t.length>r.length?!1:Zb(r,t,0,e)===0}function JS(r,t){let e=Math.min(r.length,t.length),i;for(i=0;i<e;i++)if(r.charCodeAt(i)!==t.charCodeAt(i))return i;return e}function ew(r,t){let e=Math.min(r.length,t.length),i,n=r.length-1,o=t.length-1;for(i=0;i<e;i++)if(r.charCodeAt(n-i)!==t.charCodeAt(o-i))return i;return e}function ln(r){return 55296<=r&&r<=56319}function Ih(r){return 56320<=r&&r<=57343}function pD(r,t){return(r-55296<<10)+(t-56320)+65536}function Xb(r,t,e){let i=r.charCodeAt(e);if(ln(i)&&e+1<t){let n=r.charCodeAt(e+1);if(Ih(n))return pD(i,n)}return i}function one(r,t){let e=r.charCodeAt(t-1);if(Ih(e)&&t>1){let i=r.charCodeAt(t-2);if(ln(i))return pD(i,e)}return e}var Sg=class{_str;_len;_offset;get offset(){return this._offset}constructor(t,e=0){this._str=t,this._len=t.length,this._offset=e}setOffset(t){this._offset=t}prevCodePoint(){let t=one(this._str,this._offset);return this._offset-=t>=65536?2:1,t}nextCodePoint(){let t=Xb(this._str,this._len,this._offset);return this._offset+=t>=65536?2:1,t}eol(){return this._offset>=this._len}},wg=class{_iterator;get offset(){return this._iterator.offset}constructor(t,e=0){this._iterator=new Sg(t,e)}nextGraphemeLength(){let t=lD.getInstance(),e=this._iterator,i=e.offset,n=t.getGraphemeBreakType(e.nextCodePoint());for(;!e.eol();){let o=e.offset,s=t.getGraphemeBreakType(e.nextCodePoint());if(Z7(n,s)){e.setOffset(o);break}n=s}return e.offset-i}prevGraphemeLength(){let t=lD.getInstance(),e=this._iterator,i=e.offset,n=t.getGraphemeBreakType(e.prevCodePoint());for(;e.offset>0;){let o=e.offset,s=t.getGraphemeBreakType(e.prevCodePoint());if(Z7(s,n)){e.setOffset(o);break}n=s}return i-e.offset}eol(){return this._iterator.eol()}};function tw(r,t){return new wg(r,t).nextGraphemeLength()}function CB(r,t){return new wg(r,t).prevGraphemeLength()}function hD(r,t){t>0&&Ih(r.charCodeAt(t))&&t--;let e=t+tw(r,t);return[e-CB(r,e),e]}var yB;function rne(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function qu(r){return yB||(yB=rne()),yB.test(r)}var sne=/^[\t\n\r\x20-\x7E]*$/;function iw(r){return sne.test(r)}var SB=/[\u2028\u2029]/;function mD(r){return SB.test(r)}function xa(r){return r>=11904&&r<=55215||r>=63744&&r<=64255||r>=65281&&r<=65374}function nw(r){return r>=127462&&r<=127487||r===8986||r===8987||r===9200||r===9203||r>=9728&&r<=10175||r===11088||r===11093||r>=127744&&r<=128591||r>=128640&&r<=128764||r>=128992&&r<=129008||r>=129280&&r<=129535||r>=129648&&r<=129782}var eG=String.fromCharCode(65279);function tG(r){return!!(r&&r.length>0&&r.charCodeAt(0)===65279)}function gD(r){let t=26;return r=r%(2*t),r<t?String.fromCharCode(97+r):String.fromCharCode(65+r-t)}function Z7(r,t){return r===0?t!==5&&t!==7:r===2&&t===3?!1:r===4||r===2||r===3||t===4||t===2||t===3?!0:!(r===8&&(t===8||t===9||t===11||t===12)||(r===11||r===9)&&(t===9||t===10)||(r===12||r===10)&&t===10||t===5||t===13||t===7||r===1||r===13&&t===14||r===6&&t===6)}var lD=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_data;constructor(){this._data=ane()}getGraphemeBreakType(t){if(t<32)return t===10?3:t===13?2:4;if(t<127)return 0;let e=this._data,i=e.length/3,n=1;for(;n<=i;)if(t<e[3*n])n=2*n;else if(t>e[3*n+1])n=2*n+1;else return e[3*n+2];return 0}};function ane(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function iG(r,t){if(r===0)return 0;let e=lne(r,t);if(e!==void 0)return e;let i=new Sg(t,r);return i.prevCodePoint(),i.offset}function lne(r,t){let e=new Sg(t,r),i=e.prevCodePoint();for(;dne(i)||i===65039||i===8419;){if(e.offset===0)return;i=e.prevCodePoint()}if(!nw(i))return;let n=e.offset;return n>0&&e.prevCodePoint()===8205&&(n=e.offset),n}function dne(r){return 127995<=r&&r<=127999}var IB=class r{constructor(t){this.confusableDictionary=t}static ambiguousCharacterData=new an(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new aD({getCacheKey:JSON.stringify},t=>{function e(c){let u=new Map;for(let p=0;p<c.length;p+=2)u.set(c[p],c[p+1]);return u}function i(c,u){let p=new Map(c);for(let[m,g]of u)p.set(m,g);return p}function n(c,u){if(!c)return u;let p=new Map;for(let[m,g]of c)u.has(m)&&p.set(m,g);return p}let o=this.ambiguousCharacterData.value,s=t.filter(c=>!c.startsWith("_")&&c in o);s.length===0&&(s=["_default"]);let a;for(let c of s){let u=e(o[c]);a=n(a,u)}let l=e(o._common),d=i(l,a);return new r(d)});static getInstance(t){return r.cache.get(Array.from(t))}static _locales=new an(()=>Object.keys(r.ambiguousCharacterData.value).filter(t=>!t.startsWith("_")));static getLocales(){return r._locales.value}isAmbiguous(t){return this.confusableDictionary.has(t)}containsAmbiguousCharacter(t){for(let e=0;e<t.length;e++){let i=t.codePointAt(e);if(typeof i=="number"&&this.isAmbiguous(i))return!0}return!1}getPrimaryConfusable(t){return this.confusableDictionary.get(t)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};var wB=class{_value="";_pos=0;reset(t){return this._value=t,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(t){let e=t.charCodeAt(0),i=this._value.charCodeAt(this._pos);return e-i}value(){return this._value[this._pos]}},EB=class{constructor(t=!0){this._caseSensitive=t}_value;_from;_to;reset(t){return this._value=t,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let t=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(t)this._from++;else break;else t=!1;return this}cmp(t){return this._caseSensitive?cD(t,this._value,0,t.length,this._from,this._to):Zb(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},fD=class{constructor(t=!0,e=!0){this._splitOnBackslash=t;this._caseSensitive=e}_value;_valueLen;_from;_to;reset(t){this._from=0,this._to=0,this._value=t,this._valueLen=t.length;for(let e=t.length-1;e>=0;e--,this._valueLen--){let i=this._value.charCodeAt(e);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let t=!0;for(;this._to<this._valueLen;this._to++){let e=this._value.charCodeAt(this._to);if(e===47||this._splitOnBackslash&&e===92)if(t)this._from++;else break;else t=!1}return this}cmp(t){return this._caseSensitive?cD(t,this._value,0,t.length,this._from,this._to):Zb(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}};var TB=class{constructor(t,e){this._ignorePathCasing=t;this._ignoreQueryAndFragment=e}_pathIterator;_value;_states=[];_stateIdx=0;reset(t){return this._value=t,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new fD(!1,!this._ignorePathCasing(t)),this._pathIterator.reset(t.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(t)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(t){if(this._states[this._stateIdx]===1)return uD(t,this._value.scheme);if(this._states[this._stateIdx]===2)return uD(t,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(t);if(this._states[this._stateIdx]===4)return XS(t,this._value.query);if(this._states[this._stateIdx]===5)return XS(t,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}},Qb=class{height=1;segment;value;key;left;mid;right;isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){let t=this.right;return this.right=t.left,t.left=this,this.updateHeight(),t.updateHeight(),t}rotateRight(){let t=this.left;return this.left=t.right,t.right=this,this.updateHeight(),t.updateHeight(),t}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}};var _a=class r{static forUris(t=()=>!1,e=()=>!1){return new r(new TB(t,e))}static forPaths(t=!1){return new r(new fD(void 0,!t))}static forStrings(){return new r(new wB)}static forConfigKeys(){return new r(new EB)}_iter;_root;constructor(t){this._iter=t}clear(){this._root=void 0}fill(t,e){if(e){let i=e.slice(0);QF(i);for(let n of i)this.set(n,t)}else{let i=t.slice(0);QF(i);for(let n of i)this.set(n[0],n[1])}}set(t,e){let i=this._iter.reset(t),n;this._root||(this._root=new Qb,this._root.segment=i.value());let o=[];for(n=this._root;;){let a=i.cmp(n.segment);if(a>0)n.left||(n.left=new Qb,n.left.segment=i.value()),o.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new Qb,n.right.segment=i.value()),o.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new Qb,n.mid.segment=i.value()),o.push([0,n]),n=n.mid;else break}let s=n.value;n.value=e,n.key=t;for(let a=o.length-1;a>=0;a--){let l=o[a][1];l.updateHeight();let d=l.balanceFactor();if(d<-1||d>1){let c=o[a][0],u=o[a+1][0];if(c===1&&u===1)o[a][1]=l.rotateLeft();else if(c===-1&&u===-1)o[a][1]=l.rotateRight();else if(c===1&&u===-1)l.right=o[a+1][1]=o[a+1][1].rotateRight(),o[a][1]=l.rotateLeft();else if(c===-1&&u===1)l.left=o[a+1][1]=o[a+1][1].rotateLeft(),o[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(o[a-1][0]){case-1:o[a-1][1].left=o[a][1];break;case 1:o[a-1][1].right=o[a][1];break;case 0:o[a-1][1].mid=o[a][1];break}else this._root=o[0][1]}}return s}get(t){return this._getNode(t)?.value}_getNode(t){let e=this._iter.reset(t),i=this._root;for(;i;){let n=e.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(e.hasNext())e.next(),i=i.mid;else break}return i}has(t){let e=this._getNode(t);return!(e?.value===void 0&&e?.mid===void 0)}delete(t){return this._delete(t,!1)}deleteSuperstr(t){return this._delete(t,!0)}_delete(t,e){let i=this._iter.reset(t),n=[],o=this._root;for(;o;){let s=i.cmp(o.segment);if(s>0)n.push([-1,o]),o=o.left;else if(s<0)n.push([1,o]),o=o.right;else if(i.hasNext())i.next(),n.push([0,o]),o=o.mid;else break}if(o){if(e?(o.left=void 0,o.mid=void 0,o.right=void 0,o.height=1):(o.key=void 0,o.value=void 0),!o.mid&&!o.value)if(o.left&&o.right){let s=this._min(o.right);if(s.key){let{key:a,value:l,segment:d}=s;this._delete(s.key,!1),o.key=a,o.value=l,o.segment=d}}else{let s=o.left??o.right;if(n.length>0){let[a,l]=n[n.length-1];switch(a){case-1:l.left=s;break;case 0:l.mid=s;break;case 1:l.right=s;break}}else this._root=s}for(let s=n.length-1;s>=0;s--){let a=n[s][1];a.updateHeight();let l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[s][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[s][1]=a.rotateRight()),s>0)switch(n[s-1][0]){case-1:n[s-1][1].left=n[s][1];break;case 1:n[s-1][1].right=n[s][1];break;case 0:n[s-1][1].mid=n[s][1];break}else this._root=n[0][1]}}}_min(t){for(;t.left;)t=t.left;return t}findSubstr(t){let e=this._iter.reset(t),i=this._root,n;for(;i;){let o=e.cmp(i.segment);if(o>0)i=i.left;else if(o<0)i=i.right;else if(e.hasNext())e.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(t){return this._findSuperstrOrElement(t,!1)}_findSuperstrOrElement(t,e){let i=this._iter.reset(t),n=this._root;for(;n;){let o=i.cmp(n.segment);if(o>0)n=n.left;else if(o<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):e?n.value:void 0}}hasElementOrSubtree(t){return this._findSuperstrOrElement(t,!0)!==void 0}forEach(t){for(let[e,i]of this)t(i,e)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(t){let e=[];return this._dfsEntries(t,e),e[Symbol.iterator]()}_dfsEntries(t,e){t&&(t.left&&this._dfsEntries(t.left,e),t.value&&e.push([t.key,t.value]),t.mid&&this._dfsEntries(t.mid,e),t.right&&this._dfsEntries(t.right,e))}_isBalanced(){let t=e=>{if(!e)return!0;let i=e.balanceFactor();return i<-1||i>1?!1:t(e.left)&&t(e.right)};return t(this._root)}};function Ch(r){return r===47||r===92}function Jb(r){return r.replace(/[\\/]/g,Ft.sep)}function nG(r){return r.indexOf("/")===-1&&(r=Jb(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function xB(r,t=Ft.sep){if(!r)return"";let e=r.length,i=r.charCodeAt(0);if(Ch(i)){if(Ch(r.charCodeAt(1))&&!Ch(r.charCodeAt(2))){let o=3,s=o;for(;o<e&&!Ch(r.charCodeAt(o));o++);if(s!==o&&!Ch(r.charCodeAt(o+1))){for(o+=1;o<e;o++)if(Ch(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,t)}}return t}else if(sG(i)&&r.charCodeAt(1)===58)return Ch(r.charCodeAt(2))?r.slice(0,2)+t:r.slice(0,2);let n=r.indexOf("://");if(n!==-1){for(n+=3;n<e;n++)if(Ch(r.charCodeAt(n)))return r.slice(0,n+1)}return""}function oG(r){if(!rt||!r||r.length<5)return!1;let t=r.charCodeAt(0);if(t!==92||(t=r.charCodeAt(1),t!==92))return!1;let e=2,i=e;for(;e<r.length&&(t=r.charCodeAt(e),t!==92);e++);return!(i===e||(t=r.charCodeAt(e+1),isNaN(t)||t===92))}var cne=/[\\/:\*\?"<>\|]/g,une=/[/]/g,pne=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function rG(r,t=rt){let e=t?cne:une;return!(!r||r.length===0||/^\s+$/.test(r)||(e.lastIndex=0,e.test(r))||t&&pne.test(r)||r==="."||r===".."||t&&r[r.length-1]==="."||t&&r.length!==r.trim().length||r.length>255)}function ow(r,t,e,i=Gn){if(r===t)return!0;if(!r||!t||t.length>r.length)return!1;if(e){if(!yh(r,t))return!1;if(t.length===r.length)return!0;let o=t.length;return t.charAt(t.length-1)===i&&o--,r.charAt(o)===i}return t.charAt(t.length-1)!==i&&(t+=i),r.indexOf(t)===0}function sG(r){return r>=65&&r<=90||r>=97&&r<=122}function aG(r){return rt?(r=Gu(r,Gn),r.endsWith(":")&&(r+=Gn)):(r=Gu(r,Gn),r||(r=Gn)),r}function _B(r,t=rt){return t?sG(r.charCodeAt(0))&&r.charCodeAt(1)===58:!1}function lG(r,t=rt){return _B(r,t)?r[0]:void 0}function dG(r,t,e){return t.length>r.length?-1:r===t?0:(e&&(r=r.toLowerCase(),t=t.toLowerCase()),r.indexOf(t))}function cG(r){let t=r.split(":"),e,i,n;for(let o of t){let s=Number(o);Vo(s)?i===void 0?i=s:n===void 0&&(n=s):e=e?[e,o].join(":"):o}if(!e)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:e,line:i!==void 0?i:void 0,column:n!==void 0?n:i!==void 0?1:void 0}}var he;(je=>(je.inMemory="inmemory",je.vscode="vscode",je.internal="private",je.walkThrough="walkThrough",je.walkThroughSnippet="walkThroughSnippet",je.http="http",je.https="https",je.file="file",je.mailto="mailto",je.untitled="untitled",je.data="data",je.command="command",je.vscodeRemote="vscode-remote",je.vscodeRemoteResource="vscode-remote-resource",je.vscodeManagedRemoteResource="vscode-managed-remote-resource",je.vscodeUserData="vscode-userdata",je.vscodeCustomEditor="vscode-custom-editor",je.vscodeNotebookCell="vscode-notebook-cell",je.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",je.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",je.vscodeNotebookCellOutput="vscode-notebook-cell-output",je.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",je.vscodeNotebookMetadata="vscode-notebook-metadata",je.vscodeInteractiveInput="vscode-interactive-input",je.vscodeSettings="vscode-settings",je.vscodeWorkspaceTrust="vscode-workspace-trust",je.vscodeTerminal="vscode-terminal",je.vscodeChatCodeBlock="vscode-chat-code-block",je.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",je.vscodeChatSesssion="vscode-chat-editor",je.webviewPanel="webview-panel",je.vscodeWebview="vscode-webview",je.extension="extension",je.vscodeFileResource="vscode-file",je.tmp="tmp",je.vsls="vsls",je.vscodeSourceControl="vscode-scm",je.commentsInput="comment",je.codeSetting="code-setting",je.outputChannel="output"))(he||={});function ev(r,t){return q.isUri(r)?Qs(r.scheme,t):yh(r,t+":")}function uG(r,...t){return t.some(e=>ev(r,e))}var mne="tkn",DB=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(t){this._preferredWebSchema=t}setDelegate(t){this._delegate=t}setServerRootPath(t,e){this._serverRootPath=gne(t,e)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return Ft.join(this._serverRootPath,he.vscodeRemoteResource)}set(t,e,i){this._hosts[t]=e,this._ports[t]=i}setConnectionToken(t,e){this._connectionTokens[t]=e}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(t){if(this._delegate)try{return this._delegate(t)}catch(a){return Ke(a),t}let e=t.authority,i=this._hosts[e];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);let n=this._ports[e],o=this._connectionTokens[e],s=`path=${encodeURIComponent(t.path)}`;return typeof o=="string"&&(s+=`&${mne}=${encodeURIComponent(o)}`),q.from({scheme:wt?this._preferredWebSchema:he.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:s})}},Jl=new DB;function gne(r,t){return Ft.join(t??"/",`${r.quality??"oss"}-${r.commit??"dev"}`)}var pG="vs/../../node_modules",hG="vs/../../node_modules.asar";var kB="vscode-app",LB=class r{static FALLBACK_AUTHORITY=kB;asBrowserUri(t){let e=this.toUri(t);return this.uriToBrowserUri(e)}uriToBrowserUri(t){return t.scheme===he.vscodeRemote?Jl.rewrite(t):t.scheme===he.file&&(Pi||q9===`${he.vscodeFileResource}://${r.FALLBACK_AUTHORITY}`)?t.with({scheme:he.vscodeFileResource,authority:t.authority||r.FALLBACK_AUTHORITY,query:null,fragment:null}):t}asFileUri(t){let e=this.toUri(t);return this.uriToFileUri(e)}uriToFileUri(t){return t.scheme===he.vscodeFileResource?t.with({scheme:he.file,authority:t.authority!==r.FALLBACK_AUTHORITY?t.authority:null,query:null,fragment:null}):t}toUri(t,e){if(q.isUri(t))return t;if(globalThis._VSCODE_FILE_ROOT){let i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return q.joinPath(q.parse(i,!0),t);let n=fs(i,t);return q.file(n)}return q.parse(e.toUrl(t))}},Da=new LB,fne;(o=>{let r=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);o.CoopAndCoep=Object.freeze(r.get("3"));let e="vscode-coi";function i(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:q.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(e);if(l)return r.get(l)}o.getHeadersFromQuery=i;function n(s,a,l){if(!globalThis.crossOriginIsolated)return;let d=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(e,d):s[e]=d}o.addSearchParam=n})(fne||={});function ju(r){return MS(r,!0)}var Eg=class{constructor(t){this._ignorePathCasing=t}compare(t,e,i=!1){return t===e?0:XS(this.getComparisonKey(t,i),this.getComparisonKey(e,i))}isEqual(t,e,i=!1){return t===e?!0:!t||!e?!1:this.getComparisonKey(t,i)===this.getComparisonKey(e,i)}getComparisonKey(t,e=!1){return t.with({path:this._ignorePathCasing(t)?t.path.toLowerCase():void 0,fragment:e?null:void 0}).toString()}ignorePathCasing(t){return this._ignorePathCasing(t)}isEqualOrParent(t,e,i=!1){if(t.scheme===e.scheme){if(t.scheme===he.file)return ow(ju(t),ju(e),this._ignorePathCasing(t))&&t.query===e.query&&(i||t.fragment===e.fragment);if(rw(t.authority,e.authority))return ow(t.path,e.path,this._ignorePathCasing(t),"/")&&t.query===e.query&&(i||t.fragment===e.fragment)}return!1}joinPath(t,...e){return q.joinPath(t,...e)}basenameOrAuthority(t){return Tr(t)||t.authority}basename(t){return Ft.basename(t.path)}extname(t){return Ft.extname(t.path)}dirname(t){if(t.path.length===0)return t;let e;return t.scheme===he.file?e=q.file(B_(ju(t))).path:(e=Ft.dirname(t.path),t.authority&&e.length&&e.charCodeAt(0)!==47&&(console.error(`dirname("${t.toString})) resulted in a relative path`),e="/")),t.with({path:e})}normalizePath(t){if(!t.path.length)return t;let e;return t.scheme===he.file?e=q.file(sl(ju(t))).path:e=Ft.normalize(t.path),t.with({path:e})}relativePath(t,e){if(t.scheme!==e.scheme||!rw(t.authority,e.authority))return;if(t.scheme===he.file){let o=F_(ju(t),ju(e));return rt?Jb(o):o}let i=t.path||"/",n=e.path||"/";if(this._ignorePathCasing(t)){let o=0;for(let s=Math.min(i.length,n.length);o<s&&!(i.charCodeAt(o)!==n.charCodeAt(o)&&i.charAt(o).toLowerCase()!==n.charAt(o).toLowerCase());o++);i=n.substr(0,o)+i.substr(o)}return Ft.relative(i,n)}resolvePath(t,e){if(t.scheme===he.file){let i=q.file(Fb(ju(t),e));return t.with({authority:i.authority,path:i.path})}return e=nG(e),t.with({path:Ft.resolve(t.path,e)})}isAbsolutePath(t){return!!t.path&&t.path[0]==="/"}isEqualAuthority(t,e){return t===e||t!==void 0&&e!==void 0&&Qs(t,e)}hasTrailingPathSeparator(t,e=Gn){if(t.scheme===he.file){let i=ju(t);return i.length>xB(i).length&&i[i.length-1]===e}else{let i=t.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(t.fsPath)}}removeTrailingPathSeparator(t,e=Gn){return mG(t,e)?t.with({path:t.path.substr(0,t.path.length-1)}):t}addTrailingPathSeparator(t,e=Gn){let i=!1;if(t.scheme===he.file){let n=ju(t);i=n!==void 0&&n.length===xB(n).length&&n[n.length-1]===e}else{e="/";let n=t.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!mG(t,e)?t.with({path:t.path+"/"}):t}},ii=new Eg(()=>!1),gG=new Eg(r=>r.scheme===he.file?!_t:!0),sw=new Eg(r=>!0),Wn=ii.isEqual.bind(ii),sve=ii.isEqualOrParent.bind(ii),ave=ii.getComparisonKey.bind(ii),tv=ii.basenameOrAuthority.bind(ii),Tr=ii.basename.bind(ii),aw=ii.extname.bind(ii),er=ii.dirname.bind(ii),Ot=ii.joinPath.bind(ii),fG=ii.normalizePath.bind(ii),bD=ii.relativePath.bind(ii),RB=ii.resolvePath.bind(ii),bG=ii.isAbsolutePath.bind(ii),rw=ii.isEqualAuthority.bind(ii),mG=ii.hasTrailingPathSeparator.bind(ii),lve=ii.removeTrailingPathSeparator.bind(ii),dve=ii.addTrailingPathSeparator.bind(ii);var iv;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function n(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[u,p]=c.split(":");u&&p&&a.set(u,p)});let d=s.path.substring(0,s.path.indexOf(";"));return d&&a.set(o.META_DATA_MIME,d),a}o.parseMetaData=n})(iv||={});var tr=$("environmentService"),mve=tr;var Xt=$("contextService");function dl(r){let t=r;return typeof t?.id=="string"&&q.isUri(t.uri)}var bne={id:"ext-dev"},vne={id:"empty-window"};function ov(r,t){if(typeof r=="string"||typeof r>"u")return typeof r=="string"?{id:ah(r)}:t?bne:vne;let e=r;return e.configuration?{id:e.id,configPath:e.configuration}:e.folders.length===1?{id:e.id,uri:e.folders[0].uri}:{id:e.id}}function $u(r){let t=r;return typeof t?.id=="string"&&q.isUri(t.configPath)}function vG(r){let t=r;if(t?.uri)return{id:t.id,uri:q.revive(t.uri)};let e=r;if(e?.configPath)return{id:e.id,configPath:q.revive(e.configPath)};if(r?.id)return{id:r.id}}function yD(r){let t=r;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&Array.isArray(t.folders))}function cl(r){let t=r;return!!(t&&typeof t=="object"&&q.isUri(t.uri)&&typeof t.name=="string"&&typeof t.toResource=="function")}var vD=class{constructor(t,e,i,n,o){this._id=t;this._transient=i;this._configuration=n;this._ignorePathCasing=o;this.folders=e}_foldersMap=_a.forUris(this._ignorePathCasing,()=>!0);_folders;update(t){this._id=t.id,this._configuration=t.configuration,this._transient=t.transient,this._ignorePathCasing=t._ignorePathCasing,this.folders=t.folders}get folders(){return this._folders}set folders(t){this._folders=t,this.updateFoldersMap()}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(t){this._configuration=t}getFolder(t){return t&&this._foldersMap.findSubstr(t)||null}updateFoldersMap(){this._foldersMap=_a.forUris(this._ignorePathCasing,()=>!0);for(let t of this.folders)this._foldersMap.set(t.uri,t)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}},lw=class{constructor(t,e){this.raw=e;this.uri=t.uri,this.index=t.index,this.name=t.name}uri;name;index;toResource(t){return Ot(this.uri,t)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}};function yG(r){return new lw({uri:r,index:0,name:tv(r)},{uri:r.toString()})}var IG="code-workspace",yne=`.${IG}`,Dve=[{name:h("codeWorkspace","Code Workspace"),extensions:[IG]}];function Ine(r,t){return gG.isEqualOrParent(r,t.untitledWorkspacesHome)}function Yu(r){let t;return q.isUri(r)?t=r:t=r.configuration,t?.scheme===he.tmp}function AB(r,t){return!Ine(r,t)&&!Yu(r)}function CG(r){return(typeof r=="string"?Pu(r):aw(r))===yne}var de=$("configurationService");function ID(r){return r&&typeof r=="object"&&(!r.overrideIdentifier||typeof r.overrideIdentifier=="string")&&(!r.resource||r.resource instanceof q)}function SG(r){return r&&typeof r=="object"&&(!r.overrideIdentifiers||Array.isArray(r.overrideIdentifiers))&&!r.overrideIdentifier&&(!r.resource||r.resource instanceof q)}function wG(r){switch(r){case 1:return"APPLICATION";case 2:return"USER";case 3:return"USER_LOCAL";case 4:return"USER_REMOTE";case 5:return"WORKSPACE";case 6:return"WORKSPACE_FOLDER";case 7:return"DEFAULT";case 8:return"MEMORY"}}function Tg(r,t){let e=Object.create(null);for(let i in r)PB(e,i,r[i],t);return e}function PB(r,t,e,i){let n=t.split("."),o=n.pop(),s=r;for(let a=0;a<n.length;a++){let l=n[a],d=s[l];switch(typeof d){case"undefined":d=s[l]=Object.create(null);break;case"object":if(d===null){i(`Ignoring ${t} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${t} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(d)}`);return}s=d}if(typeof s=="object"&&s!==null)try{s[o]=e}catch{i(`Ignoring ${t} as ${n.join(".")} is ${JSON.stringify(s)}`)}else i(`Ignoring ${t} as ${n.join(".")} is ${JSON.stringify(s)}`)}function EG(r,t){let e=t.split(".");TG(r,e)}function TG(r,t){let e=t.shift();if(t.length===0){delete r[e];return}if(Object.keys(r).indexOf(e)!==-1){let i=r[e];typeof i=="object"&&!Array.isArray(i)&&(TG(i,t),Object.keys(i).length===0&&delete r[e])}}function dw(r,t,e){function i(s,a){let l=s;for(let d of a){if(typeof l!="object"||l===null)return;l=l[d]}return l}let n=t.split("."),o=i(r,n);return typeof o>"u"?e:o}function xG(r){return r.replace(/[\[\]]/g,"")}function MB(r){let t=r;return typeof t?.resolve=="function"&&typeof t?.isResolved=="function"}function cw(r){let t=r;return t?[t.on,t.pause,t.resume,t.destroy].every(e=>typeof e=="function"):!1}function CD(r){let t=r;return t?cw(t.stream)&&Array.isArray(t.buffer)&&typeof t.ended=="boolean":!1}function ed(r,t){return new OB(r,t)}var OB=class{constructor(t,e){this.reducer=t;this.options=e}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(t){if(!this.state.destroyed){if(this.state.flowing)this.emitData(t);else if(this.buffer.data.push(t),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(e=>this.pendingWritePromises.push(e))}}error(t){this.state.destroyed||(this.state.flowing?this.emitError(t):this.buffer.error.push(t))}end(t){this.state.destroyed||(typeof t<"u"&&this.write(t),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(t){this.listeners.data.slice(0).forEach(e=>e(t))}emitError(t){this.listeners.error.length===0?Ke(t):this.listeners.error.slice(0).forEach(e=>e(t))}emitEnd(){this.listeners.end.slice(0).forEach(t=>t())}on(t,e){if(!this.state.destroyed)switch(t){case"data":this.listeners.data.push(e),this.resume();break;case"end":this.listeners.end.push(e),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(e),this.state.flowing&&this.flowErrors();break}}removeListener(t,e){if(this.state.destroyed)return;let i;switch(t){case"data":i=this.listeners.data;break;case"end":i=this.listeners.end;break;case"error":i=this.listeners.error;break}if(i){let n=i.indexOf(e);n>=0&&i.splice(n,1)}}flowData(){if(this.buffer.data.length>0){let t=this.reducer(this.buffer.data);this.emitData(t),this.buffer.data.length=0;let e=[...this.pendingWritePromises];this.pendingWritePromises.length=0,e.forEach(i=>i())}}flowErrors(){if(this.listeners.error.length>0){for(let t of this.buffer.error)this.emitError(t);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function _G(r,t){let e=[],i;for(;(i=r.read())!==null;)e.push(i);return t(e)}function DG(r,t,e){let i=[],n;for(;(n=r.read())!==null&&i.length<e;)i.push(n);return n===null&&i.length>0?t(i):{read:()=>{if(i.length>0)return i.shift();if(typeof n<"u"){let o=n;return n=void 0,o}return r.read()}}}function SD(r,t){return new Promise((e,i)=>{let n=[];xg(r,{onData:o=>{t&&n.push(o)},onError:o=>{t?i(o):e(void 0)},onEnd:()=>{e(t?t(n):void 0)}})})}function xg(r,t,e){r.on("error",i=>{e?.isCancellationRequested||t.onError(i)}),r.on("end",()=>{e?.isCancellationRequested||t.onEnd()}),r.on("data",i=>{e?.isCancellationRequested||t.onData(i)})}function LG(r,t){return new Promise((e,i)=>{let n=new W,o=[],s=d=>{if(o.push(d),o.length>t)return n.dispose(),r.pause(),e({stream:r,buffer:o,ended:!1})},a=d=>(n.dispose(),i(d)),l=()=>(n.dispose(),e({stream:r,buffer:o,ended:!0}));n.add(te(()=>r.removeListener("error",a))),r.on("error",a),n.add(te(()=>r.removeListener("end",l))),r.on("end",l),n.add(te(()=>r.removeListener("data",s))),r.on("data",s)})}function kG(r,t){let e=ed(t);return e.end(r),e}function RG(r){let t=!1;return{read:()=>t?null:(t=!0,r)}}function NB(r,t,e){let i=ed(e);return xg(r,{onData:n=>i.write(t.data(n)),onError:n=>i.error(t.error?t.error(n):n),onEnd:()=>i.end()}),i}var wD=typeof Buffer<"u",Sne=new an(()=>new Uint8Array(256)),FB,BB,qe=class r{static alloc(t){return wD?new r(Buffer.allocUnsafe(t)):new r(new Uint8Array(t))}static wrap(t){return wD&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new r(t)}static fromString(t,e){return!(e?.dontUseNodeBuffer||!1)&&wD?new r(Buffer.from(t)):(FB||(FB=new TextEncoder),new r(FB.encode(t)))}static fromByteArray(t){let e=r.alloc(t.length);for(let i=0,n=t.length;i<n;i++)e.buffer[i]=t[i];return e}static concat(t,e){if(typeof e>"u"){e=0;for(let o=0,s=t.length;o<s;o++)e+=t[o].byteLength}let i=r.alloc(e),n=0;for(let o=0,s=t.length;o<s;o++){let a=t[o];i.set(a,n),n+=a.byteLength}return i}buffer;byteLength;constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}clone(){let t=r.alloc(this.byteLength);return t.set(this),t}toString(){return wD?this.buffer.toString():(BB||(BB=new TextDecoder),BB.decode(this.buffer))}slice(t,e){return new r(this.buffer.subarray(t,e))}set(t,e){if(t instanceof r)this.buffer.set(t.buffer,e);else if(t instanceof Uint8Array)this.buffer.set(t,e);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),e);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e);else throw new Error("Unknown argument 'array'")}readUInt32BE(t){return Wo(this.buffer,t)}writeUInt32BE(t,e){Uo(this.buffer,t,e)}readUInt32LE(t){return Ene(this.buffer,t)}writeUInt32LE(t,e){Tne(this.buffer,t,e)}readUInt8(t){return ED(this.buffer,t)}writeUInt8(t,e){TD(this.buffer,t,e)}indexOf(t,e=0){return wne(this.buffer,t instanceof r?t.buffer:t,e)}};function wne(r,t,e=0){let i=t.byteLength,n=r.byteLength;if(i===0)return 0;if(i===1)return r.indexOf(t[0]);if(i>n-e)return-1;let o=Sne.value;o.fill(t.length);for(let d=0;d<t.length;d++)o[t[d]]=t.length-d-1;let s=e+t.length-1,a=s,l=-1;for(;s<n;)if(r[s]===t[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(t.length-a,o[r[s]]),a=t.length-1;return l}function AG(r,t){return r[t+0]<<0>>>0|r[t+1]<<8>>>0}function PG(r,t,e){r[e+0]=t&255,t=t>>>8,r[e+1]=t&255}function Wo(r,t){return r[t]*2**24+r[t+1]*2**16+r[t+2]*2**8+r[t+3]}function Uo(r,t,e){r[e+3]=t,t=t>>>8,r[e+2]=t,t=t>>>8,r[e+1]=t,t=t>>>8,r[e]=t}function Ene(r,t){return r[t+0]<<0>>>0|r[t+1]<<8>>>0|r[t+2]<<16>>>0|r[t+3]<<24>>>0}function Tne(r,t,e){r[e+0]=t&255,t=t>>>8,r[e+1]=t&255,t=t>>>8,r[e+2]=t&255,t=t>>>8,r[e+3]=t&255}function ED(r,t){return r[t]}function TD(r,t,e){r[e]=t}function MG(r){return _G(r,t=>qe.concat(t))}function xD(r){return RG(r)}function rv(r){return SD(r,t=>qe.concat(t))}async function OG(r){return r.ended?qe.concat(r.buffer):qe.concat([...r.buffer,await rv(r.stream)])}function NG(r){return kG(r,t=>qe.concat(t))}function FG(r){return ed(t=>qe.concat(t),r)}function BG(r){let t=0,e=0,i=0,n=new Uint8Array(Math.floor(r.length/4*3)),o=a=>{switch(e){case 3:n[i++]=t|a,e=0;break;case 2:n[i++]=t|a>>>2,t=a<<6,e=3;break;case 1:n[i++]=t|a>>>4,t=a<<4,e=2;break;default:t=a<<2,e=1}};for(let a=0;a<r.length;a++){let l=r.charCodeAt(a);if(l>=65&&l<=90)o(l-65);else if(l>=97&&l<=122)o(l-97+26);else if(l>=48&&l<=57)o(l-48+52);else if(l===43||l===45)o(62);else if(l===47||l===95)o(63);else{if(l===61)break;throw new SyntaxError(`Unexpected base64 character ${r[a]}`)}}let s=i;for(;e>0;)o(0);return qe.wrap(n).slice(0,s)}var xne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function _D({buffer:r},t=!0,e=!1){let i=e?_ne:xne,n="",o=r.byteLength%3,s=0;for(;s<r.byteLength-o;s+=3){let a=r[s+0],l=r[s+1],d=r[s+2];n+=i[a>>>2],n+=i[(a<<4|l>>>4)&63],n+=i[(l<<2|d>>>6)&63],n+=i[d&63]}if(o===1){let a=r[s+0];n+=i[a>>>2],n+=i[a<<4&63],t&&(n+="==")}else if(o===2){let a=r[s+0],l=r[s+1];n+=i[a>>>2],n+=i[(a<<4|l>>>4)&63],n+=i[l<<2&63],t&&(n+="=")}return n}function MD(r){return!!r&&typeof r.then=="function"}function Sh(r){let t=new Cn,e=r(t.token),i=new Promise((n,o)=>{let s=t.token.onCancellationRequested(()=>{s.dispose(),o(new Cr)});Promise.resolve(e).then(a=>{s.dispose(),t.dispose(),n(a)},a=>{s.dispose(),t.dispose(),o(a)})});return new class{cancel(){t.cancel(),t.dispose()}then(n,o){return i.then(n,o)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function uw(r,t,e){return new Promise((i,n)=>{let o=t.onCancellationRequested(()=>{o.dispose(),i(e)});r.then(i,n).finally(()=>o.dispose())})}function av(){let r,t;return{promise:new Promise((i,n)=>{r=i,t=n}),resolve:r,reject:t}}var WB=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(t){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=t,!this.queuedPromise){let e=()=>{if(this.queuedPromise=null,this.isDisposed)return;let i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(e,e).then(i)})}return new Promise((e,i)=>{this.queuedPromise.then(e,i)})}return this.activePromise=t(),new Promise((e,i)=>{this.activePromise.then(n=>{this.activePromise=null,e(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.isDisposed=!0}};var DD=class{promiseMap=new Map;queue(t,e){let n=(this.promiseMap.get(t)??Promise.resolve()).catch(()=>{}).then(e).finally(()=>{this.promiseMap.get(t)===n&&this.promiseMap.delete(t)});return this.promiseMap.set(t,n),n}},Dne=(r,t)=>{let e=!0,i=setTimeout(()=>{e=!1,t()},r);return{isTriggered:()=>e,dispose:()=>{clearTimeout(i),e=!1}}},Lne=r=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,r())}),{isTriggered:()=>t,dispose:()=>{t=!1}}},bs=class{constructor(t){this.defaultDelay=t;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(t,e=this.defaultDelay){this.task=t,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,o)=>{this.doResolve=n,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let n=this.task;return this.task=null,n()}}));let i=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=e===iD?Lne(i):Dne(e,i),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new Cr),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Zu=class{delayer;throttler;constructor(t){this.delayer=new bs(t),this.throttler=new WB}trigger(t,e){return this.delayer.trigger(()=>this.throttler.queue(t),e)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},La=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((t,e)=>{this._completePromise=t})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function Sn(r,t){return t?new Promise((e,i)=>{let n=setTimeout(()=>{o.dispose(),e()},r),o=t.onCancellationRequested(()=>{clearTimeout(n),o.dispose(),i(new Cr)})}):Sh(e=>Sn(r,e))}function pw(r,t=0,e){let i=setTimeout(()=>{r(),e&&n.dispose()},t),n=te(()=>{clearTimeout(i),e?.deleteAndLeak(n)});return e?.add(n),n}var UB=class{_size=0;_isDisposed=!1;runningPromises;maxDegreeOfParalellism;outstandingPromises;_onDrained;constructor(t){this.maxDegreeOfParalellism=t,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new T}whenIdle(){return this.size>0?O.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(t){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((e,i)=>{this.outstandingPromises.push({factory:t,c:e,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let t=this.outstandingPromises.shift();this.runningPromises++;let e=t.factory();e.then(t.c,t.e),e.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}},Xu=class extends UB{constructor(){super(1)}};var LD=class{queues=new Map;drainers=new Set;drainListeners=void 0;drainListenerCount=0;async whenDrained(){if(this.isDrained())return;let t=new xr;return this.drainers.add(t),t.p}isDrained(){for(let[,t]of this.queues)if(t.size>0)return!1;return!0}queueSize(t,e=ii){let i=e.getComparisonKey(t);return this.queues.get(i)?.size??0}queueFor(t,e,i=ii){let n=i.getComparisonKey(t),o=this.queues.get(n);if(!o){o=new Xu;let s=this.drainListenerCount++,a=O.once(o.onDrained)(()=>{o?.dispose(),this.queues.delete(n),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(s),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new Bo),this.drainListeners.set(s,a),this.queues.set(n,o)}return o.queue(e)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(let t of this.drainers)t.complete();this.drainers.clear()}dispose(){for(let[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}},td=class{_token;_isDisposed=!1;constructor(t,e){this._token=-1,typeof t=="function"&&typeof e=="number"&&this.setIfNotSet(t,e)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,e){if(this._isDisposed)throw new yt("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},e)}setIfNotSet(t,e){if(this._isDisposed)throw new yt("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},e))}},kD=class{disposable=void 0;isDisposed=!1;cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(t,e,i=globalThis){if(this.isDisposed)throw new yt("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let n=i.setInterval(()=>{t()},e);this.disposable=te(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},Et=class{runner;timeoutToken;timeout;timeoutHandler;constructor(t,e){this.timeoutToken=-1,this.runner=t,this.timeout=e,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(t=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,t)}get delay(){return this.timeout}set delay(t){this.timeout=t}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var wh,sv;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?sv=(r,t)=>{P_(()=>{if(e)return;let i=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let e=!1;return{dispose(){e||(e=!0)}}}:sv=(r,t,e)=>{let i=r.requestIdleCallback(t,typeof e=="number"?{timeout:e}:void 0),n=!1;return{dispose(){n||(n=!0,r.cancelIdleCallback(i))}}},wh=r=>sv(globalThis,r)})();var RD=class{_executor;_handle;_didRun=!1;_value;_error;constructor(t,e){this._executor=()=>{try{this._value=e()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=sv(t,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},_g=class extends RD{constructor(t){super(globalThis,t)}};var AD=class{_running;_queued;isRunning(t){return typeof t=="number"?this._running?.taskId===t:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(t,e,i){return this._running={taskId:t,cancel:()=>i?.(),promise:e},e.then(()=>this.doneRunning(t),()=>this.doneRunning(t)),e}doneRunning(t){this._running&&t===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){let t=this._queued;this._queued=void 0,t.run().then(t.promiseResolve,t.promiseReject)}}queue(t){if(this._queued)this._queued.run=t;else{let{promise:e,resolve:i,reject:n}=av();this._queued={run:t,promise:e,promiseResolve:i,promiseReject:n}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}},PD=class{constructor(t,e=()=>Date.now()){this.interval=t;this.nowFn=e}lastIncrementTime=0;value=0;increment(){let t=this.nowFn();return t-this.lastIncrementTime>this.interval&&(this.lastIncrementTime=t,this.value=0),this.value++,this.value}};var xr=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((t,e)=>{this.completeCallback=t,this.errorCallback=e})}complete(t){return new Promise(e=>{this.completeCallback(t),this.outcome={outcome:0,value:t},e()})}error(t){return new Promise(e=>{this.errorCallback(t),this.outcome={outcome:1,value:t},e()})}cancel(){return this.error(new Cr)}},Vi;(e=>{async function r(i){let n,o=await Promise.all(i.map(s=>s.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return o}e.settled=r;function t(i){return new Promise(async(n,o)=>{try{await i(n,o)}catch(s){o(s)}})}e.withAsyncBody=t})(Vi||={});var VG=class r{static fromArray(t){return new r(e=>{e.emitMany(t)})}static fromPromise(t){return new r(async e=>{e.emitMany(await t)})}static fromPromises(t){return new r(async e=>{await Promise.all(t.map(async i=>e.emitOne(await i)))})}static merge(t){return new r(async e=>{await Promise.all(t.map(async i=>{for await(let n of i)e.emitOne(n)}))})}static EMPTY=r.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(t,e){this._state=0,this._results=[],this._error=null,this._onReturn=e,this._onStateChanged=new T,queueMicrotask(async()=>{let i={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(t(i)),this.resolve()}catch(n){this.reject(n)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await O.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,e){return new r(async i=>{for await(let n of t)i.emitOne(e(n))})}map(t){return r.map(this,t)}static filter(t,e){return new r(async i=>{for await(let n of t)e(n)&&i.emitOne(n)})}filter(t){return r.filter(this,t)}static coalesce(t){return r.filter(t,e=>!!e)}coalesce(){return r.coalesce(this)}static async toPromise(t){let e=[];for await(let i of t)e.push(i);return e}toPromise(){return r.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}};var hw="**",WG="/",OD="[/\\\\]",ND="[^/\\\\]",kne=/\//g;function UG(r,t){switch(r){case 0:return"";case 1:return`${ND}*?`;default:return`(?:${OD}|${ND}+${OD}${t?`|${OD}${ND}+`:""})*?`}}function HG(r,t){if(!r)return[];let e=[],i=!1,n=!1,o="";for(let s of r){switch(s){case t:if(!i&&!n){e.push(o),o="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}o+=s}return o&&e.push(o),e}function jG(r){if(!r)return"";let t="",e=HG(r,WG);if(e.every(i=>i===hw))t=".*";else{let i=!1;e.forEach((n,o)=>{if(n===hw){if(i)return;t+=UG(2,o===e.length-1)}else{let s=!1,a="",l=!1,d="";for(let c of n){if(c!=="}"&&s){a+=c;continue}if(l&&(c!=="]"||!d)){let u;c==="-"?u=c:(c==="^"||c==="!")&&!d?u="^":c===WG?u="":u=Jr(c),d+=u;continue}switch(c){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${HG(a,",").map(m=>jG(m)).join("|")})`;t+=p,s=!1,a="";break}case"]":{t+="["+d+"]",l=!1,d="";break}case"?":t+=ND;continue;case"*":t+=UG(1);continue;default:t+=Jr(c)}}o<e.length-1&&(e[o+1]!==hw||o+2<e.length)&&(t+=OD)}i=n===hw})}return t}var Rne=/^\*\*\/\*\.[\w\.-]+$/,Ane=/^\*\*\/([\w\.-]+)\/?$/,Pne=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,Mne=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,One=/^\*\*((\/[\w\.-]+)+)\/?$/,Nne=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,zG=new $s(1e4),KG=function(){return!1},yc=function(){return null};function zB(r,t){if(!r)return yc;let e;typeof r!="string"?e=r.pattern:e=r,e=e.trim();let i=`${e}_${!!t.trimForExclusions}`,n=zG.get(i);if(n)return GG(n,r);let o;return Rne.test(e)?n=Fne(e.substr(4),e):(o=Ane.exec(HB(e,t)))?n=Bne(o[1],e):(t.trimForExclusions?Mne:Pne).test(e)?n=Vne(e,t):(o=One.exec(HB(e,t)))?n=qG(o[1].substr(1),e,!0):(o=Nne.exec(HB(e,t)))?n=qG(o[1],e,!1):n=Wne(e),zG.set(i,n),GG(n,r)}function GG(r,t){if(typeof t=="string")return r;let e=function(i,n){return ow(i,t.base,!_t)?r(vh(i.substr(t.base.length),Gn),n):null};return e.allBasenames=r.allBasenames,e.allPaths=r.allPaths,e.basenames=r.basenames,e.patterns=r.patterns,e}function HB(r,t){return t.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function Fne(r,t){return function(e,i){return typeof e=="string"&&e.endsWith(r)?t:null}}function Bne(r,t){let e=`/${r}`,i=`\\${r}`,n=function(s,a){return typeof s!="string"?null:a?a===r?t:null:s===r||s.endsWith(e)||s.endsWith(i)?t:null},o=[r];return n.basenames=o,n.patterns=[t],n.allBasenames=o,n}function Vne(r,t){let e=$G(r.slice(1,-1).split(",").map(a=>zB(a,t)).filter(a=>a!==yc),r),i=e.length;if(!i)return yc;if(i===1)return e[0];let n=function(a,l){for(let d=0,c=e.length;d<c;d++)if(e[d](a,l))return r;return null},o=e.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);let s=e.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(n.allPaths=s),n}function qG(r,t,e){let i=Gn===Ft.sep,n=i?r:r.replace(kne,Gn),o=Gn+n,s=Ft.sep+r,a;return e?a=function(l,d){return typeof l=="string"&&(l===n||l.endsWith(o)||!i&&(l===r||l.endsWith(s)))?t:null}:a=function(l,d){return typeof l=="string"&&(l===n||!i&&l===r)?t:null},a.allPaths=[(e?"*/":"./")+r],a}function Wne(r){try{let t=new RegExp(`^${jG(r)}$`);return function(e){return t.lastIndex=0,typeof e=="string"&&t.test(e)?r:null}}catch{return yc}}function lv(r,t={}){if(!r)return KG;if(typeof r=="string"||Une(r)){let e=zB(r,t);if(e===yc)return KG;let i=function(n,o){return!!e(n,o)};return e.allBasenames&&(i.allBasenames=e.allBasenames),e.allPaths&&(i.allPaths=e.allPaths),i}return Hne(r,t)}function Une(r){let t=r;return t?typeof t.base=="string"&&typeof t.pattern=="string":!1}function Hne(r,t){let e=$G(Object.getOwnPropertyNames(r).map(a=>zne(a,r[a],t)).filter(a=>a!==yc)),i=e.length;if(!i)return yc;if(!e.some(a=>!!a.requiresSiblings)){if(i===1)return e[0];let a=function(c,u){let p;for(let m=0,g=e.length;m<g;m++){let f=e[m](c,u);if(typeof f=="string")return f;MD(f)&&(p||(p=[]),p.push(f))}return p?(async()=>{for(let m of p){let g=await m;if(typeof g=="string")return g}return null})():null},l=e.find(c=>!!c.allBasenames);l&&(a.allBasenames=l.allBasenames);let d=e.reduce((c,u)=>u.allPaths?c.concat(u.allPaths):c,[]);return d.length&&(a.allPaths=d),a}let n=function(a,l,d){let c,u;for(let p=0,m=e.length;p<m;p++){let g=e[p];g.requiresSiblings&&d&&(l||(l=ah(a)),c||(c=l.substr(0,l.length-Pu(a).length)));let f=g(a,l,c,d);if(typeof f=="string")return f;MD(f)&&(u||(u=[]),u.push(f))}return u?(async()=>{for(let p of u){let m=await p;if(typeof m=="string")return m}return null})():null},o=e.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);let s=e.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(n.allPaths=s),n}function zne(r,t,e){if(t===!1)return yc;let i=zB(r,e);if(i===yc)return yc;if(typeof t=="boolean")return i;if(t){let n=t.when;if(typeof n=="string"){let o=(s,a,l,d)=>{if(!d||!i(s,a))return null;let c=n.replace("$(basename)",()=>l),u=d(c);return MD(u)?u.then(p=>p?r:null):u?r:null};return o.requiresSiblings=!0,o}}return i}function $G(r,t){let e=r.filter(a=>!!a.basenames);if(e.length<2)return r;let i=e.reduce((a,l)=>{let d=l.basenames;return d?a.concat(d):a},[]),n;if(t){n=[];for(let a=0,l=i.length;a<l;a++)n.push(t)}else n=e.reduce((a,l)=>{let d=l.patterns;return d?a.concat(d):a},[]);let o=function(a,l){if(typeof a!="string")return null;if(!l){let c;for(c=a.length;c>0;c--){let u=a.charCodeAt(c-1);if(u===47||u===92)break}l=a.substr(c)}let d=i.indexOf(l);return d!==-1?n[d]:null};o.basenames=i,o.patterns=n,o.allBasenames=i;let s=r.filter(a=>!a.basenames);return s.push(o),s}var Iye=new Uint32Array(10);var Cye=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),Sye=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),wye=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),Eye=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function XG(...r){return function(t,e){for(let i=0,n=r.length;i<n;i++){let o=r[i](t,e);if(o)return o}return null}}var Rye=QG.bind(void 0,!1),Dg=QG.bind(void 0,!0);function QG(r,t,e){if(!e||e.length<t.length)return null;let i;return r?i=yh(e,t):i=e.indexOf(t)===0,i?t.length>0?[{start:0,end:t.length}]:[]:null}function Kne(r,t){let e=t.toLowerCase().indexOf(r.toLowerCase());return e===-1?null:[{start:e,end:e+r.length}]}function Gne(r,t){return GB(r.toLowerCase(),t.toLowerCase(),0,0)}function GB(r,t,e,i){if(e===r.length)return[];if(i===t.length)return null;if(r[e]===t[i]){let n=null;return(n=GB(r,t,e+1,i+1))?e3({start:i,end:i+1},n):null}return GB(r,t,e,i+1)}function YB(r){return 97<=r&&r<=122}function dv(r){return 65<=r&&r<=90}function ZB(r){return 48<=r&&r<=57}function qne(r){return r===32||r===9||r===10||r===13}var jne=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(r=>jne.add(r.charCodeAt(0)));function JG(r){return YB(r)||dv(r)||ZB(r)}function e3(r,t){return t.length===0?t=[r]:r.end===t[0].start?t[0].start=r.start:t.unshift(r),t}function t3(r,t){for(let e=t;e<r.length;e++){let i=r.charCodeAt(e);if(dv(i)||ZB(i)||e>0&&!JG(r.charCodeAt(e-1)))return e}return r.length}function qB(r,t,e,i){if(e===r.length)return[];if(i===t.length)return null;if(r[e]!==t[i].toLowerCase())return null;{let n=null,o=i+1;for(n=qB(r,t,e+1,i+1);!n&&(o=t3(t,o))<t.length;)n=qB(r,t,e+1,o),o++;return n===null?null:e3({start:i,end:i+1},n)}}function $ne(r){let t=0,e=0,i=0,n=0,o=0;for(let c=0;c<r.length;c++)o=r.charCodeAt(c),dv(o)&&t++,YB(o)&&e++,JG(o)&&i++,ZB(o)&&n++;let s=t/r.length,a=e/r.length,l=i/r.length,d=n/r.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:d}}function Yne(r){let{upperPercent:t,lowerPercent:e}=r;return e===0&&t>.6}function Zne(r){let{upperPercent:t,lowerPercent:e,alphaPercent:i,numericPercent:n}=r;return e>.2&&t<.8&&i>.6&&n<.2}function Xne(r){let t=0,e=0,i=0,n=0;for(let o=0;o<r.length;o++)i=r.charCodeAt(o),dv(i)&&t++,YB(i)&&e++,qne(i)&&n++;return(t===0||e===0)&&n===0?r.length<=30:t<=5}function i3(r,t){if(!t||(t=t.trim(),t.length===0)||!Xne(r))return null;t.length>60&&(t=t.substring(0,60));let e=$ne(t);if(!Zne(e)){if(!Yne(e))return null;t=t.toLowerCase()}let i=null,n=0;for(r=r.toLowerCase();n<t.length&&(i=qB(r,t,0,n))===null;)n=t3(t,n+1);return i}var Aye=XG(Dg,i3,Kne),Pye=XG(Dg,i3,Gne),Mye=new $s(1e4);function n3(r,t){let e=WD(r,r.toLowerCase(),0,t,t.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return e?VD(e):null}function VD(r){if(typeof r>"u")return[];let t=[],e=r[1];for(let i=r.length-1;i>1;i--){let n=r[i]+e,o=t[t.length-1];o&&o.end===n?o.end=n+1:t.push({start:n,end:n+1})}return t}var Th=128;function XB(){let r=[],t=[];for(let e=0;e<=Th;e++)t[e]=0;for(let e=0;e<=Th;e++)r.push(t.slice(0));return r}function o3(r){let t=[];for(let e=0;e<=r;e++)t[e]=0;return t}var r3=o3(2*Th),jB=o3(2*Th),Ic=XB(),Eh=XB(),mw=XB(),Qne=!1;function KB(r,t,e,i,n){function o(a,l,d=" "){for(;a.length<l;)a=d+a;return a}let s=` |   |${i.split("").map(a=>o(a,3)).join("|")}
`;for(let a=0;a<=e;a++)a===0?s+=" |":s+=`${t[a-1]}|`,s+=r[a].slice(0,n+1).map(l=>o(l.toString(),3)).join("|")+`
`;return s}function Jne(r,t,e,i){r=r.substr(t),e=e.substr(i),console.log(KB(Eh,r,r.length,e,e.length)),console.log(KB(mw,r,r.length,e,e.length)),console.log(KB(Ic,r,r.length,e,e.length))}function FD(r,t){if(t<0||t>=r.length)return!1;let e=r.codePointAt(t);switch(e){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!nw(e)}}function ZG(r,t){if(t<0||t>=r.length)return!1;switch(r.charCodeAt(t)){case 32:case 9:return!0;default:return!1}}function BD(r,t,e){return t[r]!==e[r]}function eoe(r,t,e,i,n,o,s=!1){for(;t<e&&n<o;)r[t]===i[n]&&(s&&(r3[t]=n),t+=1),n+=1;return t===e}var Lg;(e=>{e.Default=[-100,0];function t(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}e.isDefault=t})(Lg||={});var $B=class{constructor(t,e){this.firstMatchCanBeWeak=t;this.boostFullMatch=e}static default={boostFullMatch:!0,firstMatchCanBeWeak:!1}};function WD(r,t,e,i,n,o,s=$B.default){let a=r.length>Th?Th:r.length,l=i.length>Th?Th:i.length;if(e>=a||o>=l||a-e>l-o||!eoe(t,e,a,n,o,l,!0))return;toe(a,l,e,o,t,n);let d=1,c=1,u=e,p=o,m=[!1];for(d=1,u=e;u<a;d++,u++){let I=r3[u],E=jB[u],S=u+1<a?jB[u+1]:l;for(c=I-o+1,p=I;p<S;c++,p++){let w=Number.MIN_SAFE_INTEGER,D=!1;p<=E&&(w=ioe(r,t,u,e,i,n,p,l,o,Ic[d-1][c-1]===0,m));let k=0;w!==Number.MAX_SAFE_INTEGER&&(D=!0,k=w+Eh[d-1][c-1]);let R=p>I,A=R?Eh[d][c-1]+(Ic[d][c-1]>0?-5:0):0,H=p>I+1&&Ic[d][c-1]>0,z=H?Eh[d][c-2]+(Ic[d][c-2]>0?-5:0):0;if(H&&(!R||z>=A)&&(!D||z>=k))Eh[d][c]=z,mw[d][c]=3,Ic[d][c]=0;else if(R&&(!D||A>=k))Eh[d][c]=A,mw[d][c]=2,Ic[d][c]=0;else if(D)Eh[d][c]=k,mw[d][c]=1,Ic[d][c]=Ic[d-1][c-1]+1;else throw new Error("not possible")}}if(Qne&&Jne(r,e,i,o),!m[0]&&!s.firstMatchCanBeWeak)return;d--,c--;let g=[Eh[d][c],o],f=0,b=0;for(;d>=1;){let I=c;do{let E=mw[d][I];if(E===3)I=I-2;else if(E===2)I=I-1;else break}while(I>=1);f>1&&t[e+d-1]===n[o+c-1]&&!BD(I+o-1,i,n)&&f+1>Ic[d][I]&&(I=c),I===c?f++:f=1,b||(b=I),d--,c=I-1,g.push(c)}l-o===a&&s.boostFullMatch&&(g[0]+=2);let y=b-a;return g[0]-=y,g}function toe(r,t,e,i,n,o){let s=r-1,a=t-1;for(;s>=e&&a>=i;)n[s]===o[a]&&(jB[s]=a,s--),a--}function ioe(r,t,e,i,n,o,s,a,l,d,c){if(t[e]!==o[s])return Number.MIN_SAFE_INTEGER;let u=1,p=!1;return s===e-i?u=r[e]===n[s]?7:5:BD(s,n,o)&&(s===0||!BD(s-1,n,o))?(u=r[e]===n[s]?7:5,p=!0):FD(o,s)&&(s===0||!FD(o,s-1))?u=5:(FD(o,s-1)||ZG(o,s-1))&&(u=5,p=!0),u>1&&e===i&&(c[0]=!0),p||(p=BD(s,n,o)||FD(o,s-1)||ZG(o,s-1)),e===i?s>l&&(u-=p?3:5):d?u+=p?2:0:u+=p?0:1,s+1===a&&(u-=p?3:5),u}var QB=Object.create(null);function C(r,t){if(si(t)){let e=QB[t];if(e===void 0)throw new Error(`${r} references an unknown codicon: ${t}`);t=e}return QB[r]=t,{id:r}}function UD(){return QB}var s3={add:C("add",6e4),plus:C("plus",6e4),gistNew:C("gist-new",6e4),repoCreate:C("repo-create",6e4),lightbulb:C("lightbulb",60001),lightBulb:C("light-bulb",60001),repo:C("repo",60002),repoDelete:C("repo-delete",60002),gistFork:C("gist-fork",60003),repoForked:C("repo-forked",60003),gitPullRequest:C("git-pull-request",60004),gitPullRequestAbandoned:C("git-pull-request-abandoned",60004),recordKeys:C("record-keys",60005),keyboard:C("keyboard",60005),tag:C("tag",60006),gitPullRequestLabel:C("git-pull-request-label",60006),tagAdd:C("tag-add",60006),tagRemove:C("tag-remove",60006),person:C("person",60007),personFollow:C("person-follow",60007),personOutline:C("person-outline",60007),personFilled:C("person-filled",60007),gitBranch:C("git-branch",60008),gitBranchCreate:C("git-branch-create",60008),gitBranchDelete:C("git-branch-delete",60008),sourceControl:C("source-control",60008),mirror:C("mirror",60009),mirrorPublic:C("mirror-public",60009),star:C("star",60010),starAdd:C("star-add",60010),starDelete:C("star-delete",60010),starEmpty:C("star-empty",60010),comment:C("comment",60011),commentAdd:C("comment-add",60011),alert:C("alert",60012),warning:C("warning",60012),search:C("search",60013),searchSave:C("search-save",60013),logOut:C("log-out",60014),signOut:C("sign-out",60014),logIn:C("log-in",60015),signIn:C("sign-in",60015),eye:C("eye",60016),eyeUnwatch:C("eye-unwatch",60016),eyeWatch:C("eye-watch",60016),circleFilled:C("circle-filled",60017),primitiveDot:C("primitive-dot",60017),closeDirty:C("close-dirty",60017),debugBreakpoint:C("debug-breakpoint",60017),debugBreakpointDisabled:C("debug-breakpoint-disabled",60017),debugHint:C("debug-hint",60017),terminalDecorationSuccess:C("terminal-decoration-success",60017),primitiveSquare:C("primitive-square",60018),edit:C("edit",60019),pencil:C("pencil",60019),info:C("info",60020),issueOpened:C("issue-opened",60020),gistPrivate:C("gist-private",60021),gitForkPrivate:C("git-fork-private",60021),lock:C("lock",60021),mirrorPrivate:C("mirror-private",60021),close:C("close",60022),removeClose:C("remove-close",60022),x:C("x",60022),repoSync:C("repo-sync",60023),sync:C("sync",60023),clone:C("clone",60024),desktopDownload:C("desktop-download",60024),beaker:C("beaker",60025),microscope:C("microscope",60025),vm:C("vm",60026),deviceDesktop:C("device-desktop",60026),file:C("file",60027),fileText:C("file-text",60027),more:C("more",60028),ellipsis:C("ellipsis",60028),kebabHorizontal:C("kebab-horizontal",60028),mailReply:C("mail-reply",60029),reply:C("reply",60029),organization:C("organization",60030),organizationFilled:C("organization-filled",60030),organizationOutline:C("organization-outline",60030),newFile:C("new-file",60031),fileAdd:C("file-add",60031),newFolder:C("new-folder",60032),fileDirectoryCreate:C("file-directory-create",60032),trash:C("trash",60033),trashcan:C("trashcan",60033),history:C("history",60034),clock:C("clock",60034),folder:C("folder",60035),fileDirectory:C("file-directory",60035),symbolFolder:C("symbol-folder",60035),logoGithub:C("logo-github",60036),markGithub:C("mark-github",60036),github:C("github",60036),terminal:C("terminal",60037),console:C("console",60037),repl:C("repl",60037),zap:C("zap",60038),symbolEvent:C("symbol-event",60038),error:C("error",60039),stop:C("stop",60039),variable:C("variable",60040),symbolVariable:C("symbol-variable",60040),array:C("array",60042),symbolArray:C("symbol-array",60042),symbolModule:C("symbol-module",60043),symbolPackage:C("symbol-package",60043),symbolNamespace:C("symbol-namespace",60043),symbolObject:C("symbol-object",60043),symbolMethod:C("symbol-method",60044),symbolFunction:C("symbol-function",60044),symbolConstructor:C("symbol-constructor",60044),symbolBoolean:C("symbol-boolean",60047),symbolNull:C("symbol-null",60047),symbolNumeric:C("symbol-numeric",60048),symbolNumber:C("symbol-number",60048),symbolStructure:C("symbol-structure",60049),symbolStruct:C("symbol-struct",60049),symbolParameter:C("symbol-parameter",60050),symbolTypeParameter:C("symbol-type-parameter",60050),symbolKey:C("symbol-key",60051),symbolText:C("symbol-text",60051),symbolReference:C("symbol-reference",60052),goToFile:C("go-to-file",60052),symbolEnum:C("symbol-enum",60053),symbolValue:C("symbol-value",60053),symbolRuler:C("symbol-ruler",60054),symbolUnit:C("symbol-unit",60054),activateBreakpoints:C("activate-breakpoints",60055),archive:C("archive",60056),arrowBoth:C("arrow-both",60057),arrowDown:C("arrow-down",60058),arrowLeft:C("arrow-left",60059),arrowRight:C("arrow-right",60060),arrowSmallDown:C("arrow-small-down",60061),arrowSmallLeft:C("arrow-small-left",60062),arrowSmallRight:C("arrow-small-right",60063),arrowSmallUp:C("arrow-small-up",60064),arrowUp:C("arrow-up",60065),bell:C("bell",60066),bold:C("bold",60067),book:C("book",60068),bookmark:C("bookmark",60069),debugBreakpointConditionalUnverified:C("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:C("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:C("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:C("debug-breakpoint-data-unverified",60072),debugBreakpointData:C("debug-breakpoint-data",60073),debugBreakpointDataDisabled:C("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:C("debug-breakpoint-log-unverified",60074),debugBreakpointLog:C("debug-breakpoint-log",60075),debugBreakpointLogDisabled:C("debug-breakpoint-log-disabled",60075),briefcase:C("briefcase",60076),broadcast:C("broadcast",60077),browser:C("browser",60078),bug:C("bug",60079),calendar:C("calendar",60080),caseSensitive:C("case-sensitive",60081),check:C("check",60082),checklist:C("checklist",60083),chevronDown:C("chevron-down",60084),chevronLeft:C("chevron-left",60085),chevronRight:C("chevron-right",60086),chevronUp:C("chevron-up",60087),chromeClose:C("chrome-close",60088),chromeMaximize:C("chrome-maximize",60089),chromeMinimize:C("chrome-minimize",60090),chromeRestore:C("chrome-restore",60091),circleOutline:C("circle-outline",60092),circle:C("circle",60092),debugBreakpointUnverified:C("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:C("terminal-decoration-incomplete",60092),circleSlash:C("circle-slash",60093),circuitBoard:C("circuit-board",60094),clearAll:C("clear-all",60095),clippy:C("clippy",60096),closeAll:C("close-all",60097),cloudDownload:C("cloud-download",60098),cloudUpload:C("cloud-upload",60099),code:C("code",60100),collapseAll:C("collapse-all",60101),colorMode:C("color-mode",60102),commentDiscussion:C("comment-discussion",60103),creditCard:C("credit-card",60105),dash:C("dash",60108),dashboard:C("dashboard",60109),database:C("database",60110),debugContinue:C("debug-continue",60111),debugDisconnect:C("debug-disconnect",60112),debugPause:C("debug-pause",60113),debugRestart:C("debug-restart",60114),debugStart:C("debug-start",60115),debugStepInto:C("debug-step-into",60116),debugStepOut:C("debug-step-out",60117),debugStepOver:C("debug-step-over",60118),debugStop:C("debug-stop",60119),debug:C("debug",60120),deviceCameraVideo:C("device-camera-video",60121),deviceCamera:C("device-camera",60122),deviceMobile:C("device-mobile",60123),diffAdded:C("diff-added",60124),diffIgnored:C("diff-ignored",60125),diffModified:C("diff-modified",60126),diffRemoved:C("diff-removed",60127),diffRenamed:C("diff-renamed",60128),diff:C("diff",60129),diffSidebyside:C("diff-sidebyside",60129),discard:C("discard",60130),editorLayout:C("editor-layout",60131),emptyWindow:C("empty-window",60132),exclude:C("exclude",60133),extensions:C("extensions",60134),eyeClosed:C("eye-closed",60135),fileBinary:C("file-binary",60136),fileCode:C("file-code",60137),fileMedia:C("file-media",60138),filePdf:C("file-pdf",60139),fileSubmodule:C("file-submodule",60140),fileSymlinkDirectory:C("file-symlink-directory",60141),fileSymlinkFile:C("file-symlink-file",60142),fileZip:C("file-zip",60143),files:C("files",60144),filter:C("filter",60145),flame:C("flame",60146),foldDown:C("fold-down",60147),foldUp:C("fold-up",60148),fold:C("fold",60149),folderActive:C("folder-active",60150),folderOpened:C("folder-opened",60151),gear:C("gear",60152),gift:C("gift",60153),gistSecret:C("gist-secret",60154),gist:C("gist",60155),gitCommit:C("git-commit",60156),gitCompare:C("git-compare",60157),compareChanges:C("compare-changes",60157),gitMerge:C("git-merge",60158),githubAction:C("github-action",60159),githubAlt:C("github-alt",60160),globe:C("globe",60161),grabber:C("grabber",60162),graph:C("graph",60163),gripper:C("gripper",60164),heart:C("heart",60165),home:C("home",60166),horizontalRule:C("horizontal-rule",60167),hubot:C("hubot",60168),inbox:C("inbox",60169),issueReopened:C("issue-reopened",60171),issues:C("issues",60172),italic:C("italic",60173),jersey:C("jersey",60174),json:C("json",60175),kebabVertical:C("kebab-vertical",60176),key:C("key",60177),law:C("law",60178),lightbulbAutofix:C("lightbulb-autofix",60179),linkExternal:C("link-external",60180),link:C("link",60181),listOrdered:C("list-ordered",60182),listUnordered:C("list-unordered",60183),liveShare:C("live-share",60184),loading:C("loading",60185),location:C("location",60186),mailRead:C("mail-read",60187),mail:C("mail",60188),markdown:C("markdown",60189),megaphone:C("megaphone",60190),mention:C("mention",60191),milestone:C("milestone",60192),gitPullRequestMilestone:C("git-pull-request-milestone",60192),mortarBoard:C("mortar-board",60193),move:C("move",60194),multipleWindows:C("multiple-windows",60195),mute:C("mute",60196),noNewline:C("no-newline",60197),note:C("note",60198),octoface:C("octoface",60199),openPreview:C("open-preview",60200),package:C("package",60201),paintcan:C("paintcan",60202),pin:C("pin",60203),play:C("play",60204),run:C("run",60204),plug:C("plug",60205),preserveCase:C("preserve-case",60206),preview:C("preview",60207),project:C("project",60208),pulse:C("pulse",60209),question:C("question",60210),quote:C("quote",60211),radioTower:C("radio-tower",60212),reactions:C("reactions",60213),references:C("references",60214),refresh:C("refresh",60215),regex:C("regex",60216),remoteExplorer:C("remote-explorer",60217),remote:C("remote",60218),remove:C("remove",60219),replaceAll:C("replace-all",60220),replace:C("replace",60221),repoClone:C("repo-clone",60222),repoForcePush:C("repo-force-push",60223),repoPull:C("repo-pull",60224),repoPush:C("repo-push",60225),report:C("report",60226),requestChanges:C("request-changes",60227),rocket:C("rocket",60228),rootFolderOpened:C("root-folder-opened",60229),rootFolder:C("root-folder",60230),rss:C("rss",60231),ruby:C("ruby",60232),saveAll:C("save-all",60233),saveAs:C("save-as",60234),save:C("save",60235),screenFull:C("screen-full",60236),screenNormal:C("screen-normal",60237),searchStop:C("search-stop",60238),server:C("server",60240),settingsGear:C("settings-gear",60241),settings:C("settings",60242),shield:C("shield",60243),smiley:C("smiley",60244),sortPrecedence:C("sort-precedence",60245),splitHorizontal:C("split-horizontal",60246),splitVertical:C("split-vertical",60247),squirrel:C("squirrel",60248),starFull:C("star-full",60249),starHalf:C("star-half",60250),symbolClass:C("symbol-class",60251),symbolColor:C("symbol-color",60252),symbolConstant:C("symbol-constant",60253),symbolEnumMember:C("symbol-enum-member",60254),symbolField:C("symbol-field",60255),symbolFile:C("symbol-file",60256),symbolInterface:C("symbol-interface",60257),symbolKeyword:C("symbol-keyword",60258),symbolMisc:C("symbol-misc",60259),symbolOperator:C("symbol-operator",60260),symbolProperty:C("symbol-property",60261),wrench:C("wrench",60261),wrenchSubaction:C("wrench-subaction",60261),symbolSnippet:C("symbol-snippet",60262),tasklist:C("tasklist",60263),telescope:C("telescope",60264),textSize:C("text-size",60265),threeBars:C("three-bars",60266),thumbsdown:C("thumbsdown",60267),thumbsup:C("thumbsup",60268),tools:C("tools",60269),triangleDown:C("triangle-down",60270),triangleLeft:C("triangle-left",60271),triangleRight:C("triangle-right",60272),triangleUp:C("triangle-up",60273),twitter:C("twitter",60274),unfold:C("unfold",60275),unlock:C("unlock",60276),unmute:C("unmute",60277),unverified:C("unverified",60278),verified:C("verified",60279),versions:C("versions",60280),vmActive:C("vm-active",60281),vmOutline:C("vm-outline",60282),vmRunning:C("vm-running",60283),watch:C("watch",60284),whitespace:C("whitespace",60285),wholeWord:C("whole-word",60286),window:C("window",60287),wordWrap:C("word-wrap",60288),zoomIn:C("zoom-in",60289),zoomOut:C("zoom-out",60290),listFilter:C("list-filter",60291),listFlat:C("list-flat",60292),listSelection:C("list-selection",60293),selection:C("selection",60293),listTree:C("list-tree",60294),debugBreakpointFunctionUnverified:C("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:C("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:C("debug-breakpoint-function-disabled",60296),debugStackframeActive:C("debug-stackframe-active",60297),circleSmallFilled:C("circle-small-filled",60298),debugStackframeDot:C("debug-stackframe-dot",60298),terminalDecorationMark:C("terminal-decoration-mark",60298),debugStackframe:C("debug-stackframe",60299),debugStackframeFocused:C("debug-stackframe-focused",60299),debugBreakpointUnsupported:C("debug-breakpoint-unsupported",60300),symbolString:C("symbol-string",60301),debugReverseContinue:C("debug-reverse-continue",60302),debugStepBack:C("debug-step-back",60303),debugRestartFrame:C("debug-restart-frame",60304),debugAlt:C("debug-alt",60305),callIncoming:C("call-incoming",60306),callOutgoing:C("call-outgoing",60307),menu:C("menu",60308),expandAll:C("expand-all",60309),feedback:C("feedback",60310),gitPullRequestReviewer:C("git-pull-request-reviewer",60310),groupByRefType:C("group-by-ref-type",60311),ungroupByRefType:C("ungroup-by-ref-type",60312),account:C("account",60313),gitPullRequestAssignee:C("git-pull-request-assignee",60313),bellDot:C("bell-dot",60314),debugConsole:C("debug-console",60315),library:C("library",60316),output:C("output",60317),runAll:C("run-all",60318),syncIgnored:C("sync-ignored",60319),pinned:C("pinned",60320),githubInverted:C("github-inverted",60321),serverProcess:C("server-process",60322),serverEnvironment:C("server-environment",60323),pass:C("pass",60324),issueClosed:C("issue-closed",60324),stopCircle:C("stop-circle",60325),playCircle:C("play-circle",60326),record:C("record",60327),debugAltSmall:C("debug-alt-small",60328),vmConnect:C("vm-connect",60329),cloud:C("cloud",60330),merge:C("merge",60331),export:C("export",60332),graphLeft:C("graph-left",60333),magnet:C("magnet",60334),notebook:C("notebook",60335),redo:C("redo",60336),checkAll:C("check-all",60337),pinnedDirty:C("pinned-dirty",60338),passFilled:C("pass-filled",60339),circleLargeFilled:C("circle-large-filled",60340),circleLarge:C("circle-large",60341),circleLargeOutline:C("circle-large-outline",60341),combine:C("combine",60342),gather:C("gather",60342),table:C("table",60343),variableGroup:C("variable-group",60344),typeHierarchy:C("type-hierarchy",60345),typeHierarchySub:C("type-hierarchy-sub",60346),typeHierarchySuper:C("type-hierarchy-super",60347),gitPullRequestCreate:C("git-pull-request-create",60348),runAbove:C("run-above",60349),runBelow:C("run-below",60350),notebookTemplate:C("notebook-template",60351),debugRerun:C("debug-rerun",60352),workspaceTrusted:C("workspace-trusted",60353),workspaceUntrusted:C("workspace-untrusted",60354),workspaceUnknown:C("workspace-unknown",60355),terminalCmd:C("terminal-cmd",60356),terminalDebian:C("terminal-debian",60357),terminalLinux:C("terminal-linux",60358),terminalPowershell:C("terminal-powershell",60359),terminalTmux:C("terminal-tmux",60360),terminalUbuntu:C("terminal-ubuntu",60361),terminalBash:C("terminal-bash",60362),arrowSwap:C("arrow-swap",60363),copy:C("copy",60364),personAdd:C("person-add",60365),filterFilled:C("filter-filled",60366),wand:C("wand",60367),debugLineByLine:C("debug-line-by-line",60368),inspect:C("inspect",60369),layers:C("layers",60370),layersDot:C("layers-dot",60371),layersActive:C("layers-active",60372),compass:C("compass",60373),compassDot:C("compass-dot",60374),compassActive:C("compass-active",60375),azure:C("azure",60376),issueDraft:C("issue-draft",60377),gitPullRequestClosed:C("git-pull-request-closed",60378),gitPullRequestDraft:C("git-pull-request-draft",60379),debugAll:C("debug-all",60380),debugCoverage:C("debug-coverage",60381),runErrors:C("run-errors",60382),folderLibrary:C("folder-library",60383),debugContinueSmall:C("debug-continue-small",60384),beakerStop:C("beaker-stop",60385),graphLine:C("graph-line",60386),graphScatter:C("graph-scatter",60387),pieChart:C("pie-chart",60388),bracket:C("bracket",60175),bracketDot:C("bracket-dot",60389),bracketError:C("bracket-error",60390),lockSmall:C("lock-small",60391),azureDevops:C("azure-devops",60392),verifiedFilled:C("verified-filled",60393),newline:C("newline",60394),layout:C("layout",60395),layoutActivitybarLeft:C("layout-activitybar-left",60396),layoutActivitybarRight:C("layout-activitybar-right",60397),layoutPanelLeft:C("layout-panel-left",60398),layoutPanelCenter:C("layout-panel-center",60399),layoutPanelJustify:C("layout-panel-justify",60400),layoutPanelRight:C("layout-panel-right",60401),layoutPanel:C("layout-panel",60402),layoutSidebarLeft:C("layout-sidebar-left",60403),layoutSidebarRight:C("layout-sidebar-right",60404),layoutStatusbar:C("layout-statusbar",60405),layoutMenubar:C("layout-menubar",60406),layoutCentered:C("layout-centered",60407),target:C("target",60408),indent:C("indent",60409),recordSmall:C("record-small",60410),errorSmall:C("error-small",60411),terminalDecorationError:C("terminal-decoration-error",60411),arrowCircleDown:C("arrow-circle-down",60412),arrowCircleLeft:C("arrow-circle-left",60413),arrowCircleRight:C("arrow-circle-right",60414),arrowCircleUp:C("arrow-circle-up",60415),layoutSidebarRightOff:C("layout-sidebar-right-off",60416),layoutPanelOff:C("layout-panel-off",60417),layoutSidebarLeftOff:C("layout-sidebar-left-off",60418),blank:C("blank",60419),heartFilled:C("heart-filled",60420),map:C("map",60421),mapHorizontal:C("map-horizontal",60421),foldHorizontal:C("fold-horizontal",60421),mapFilled:C("map-filled",60422),mapHorizontalFilled:C("map-horizontal-filled",60422),foldHorizontalFilled:C("fold-horizontal-filled",60422),circleSmall:C("circle-small",60423),bellSlash:C("bell-slash",60424),bellSlashDot:C("bell-slash-dot",60425),commentUnresolved:C("comment-unresolved",60426),gitPullRequestGoToChanges:C("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:C("git-pull-request-new-changes",60428),searchFuzzy:C("search-fuzzy",60429),commentDraft:C("comment-draft",60430),send:C("send",60431),sparkle:C("sparkle",60432),insert:C("insert",60433),mic:C("mic",60434),thumbsdownFilled:C("thumbsdown-filled",60435),thumbsupFilled:C("thumbsup-filled",60436),coffee:C("coffee",60437),snake:C("snake",60438),game:C("game",60439),vr:C("vr",60440),chip:C("chip",60441),piano:C("piano",60442),music:C("music",60443),micFilled:C("mic-filled",60444),repoFetch:C("repo-fetch",60445),copilot:C("copilot",60446),lightbulbSparkle:C("lightbulb-sparkle",60447),robot:C("robot",60448),sparkleFilled:C("sparkle-filled",60449),diffSingle:C("diff-single",60450),diffMultiple:C("diff-multiple",60451),surroundWith:C("surround-with",60452),share:C("share",60453),gitStash:C("git-stash",60454),gitStashApply:C("git-stash-apply",60455),gitStashPop:C("git-stash-pop",60456),vscode:C("vscode",60457),vscodeInsiders:C("vscode-insiders",60458),codeOss:C("code-oss",60459),runCoverage:C("run-coverage",60460),runAllCoverage:C("run-all-coverage",60461),coverage:C("coverage",60462),githubProject:C("github-project",60463),mapVertical:C("map-vertical",60464),foldVertical:C("fold-vertical",60464),mapVerticalFilled:C("map-vertical-filled",60465),foldVerticalFilled:C("fold-vertical-filled",60465),goToSearch:C("go-to-search",60466),percentage:C("percentage",60467),sortPercentage:C("sort-percentage",60467),attach:C("attach",60468)};var noe={dialogError:C("dialog-error","error"),dialogWarning:C("dialog-warning","warning"),dialogInfo:C("dialog-info","info"),dialogClose:C("dialog-close","close"),treeItemExpanded:C("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:C("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:C("tree-filter-on-type-off","list-selection"),treeFilterClear:C("tree-filter-clear","close"),treeItemLoading:C("tree-item-loading","loading"),menuSelection:C("menu-selection","check"),menuSubmenu:C("menu-submenu","chevron-right"),menuBarMore:C("menubar-more","more"),scrollbarButtonLeft:C("scrollbar-button-left","triangle-left"),scrollbarButtonRight:C("scrollbar-button-right","triangle-right"),scrollbarButtonUp:C("scrollbar-button-up","triangle-up"),scrollbarButtonDown:C("scrollbar-button-down","triangle-down"),toolBarMore:C("toolbar-more","more"),quickInputBack:C("quick-input-back","arrow-left"),dropDownButton:C("drop-down-button",60084),symbolCustomColor:C("symbol-customcolor",60252),exportIcon:C("export",60332),workspaceUnspecified:C("workspace-unspecified",60355),newLine:C("newline",60394),thumbsDownFilled:C("thumbsdown-filled",60435),thumbsUpFilled:C("thumbsup-filled",60436),gitFetch:C("git-fetch",60445),lightbulbSparkleAutofix:C("lightbulb-sparkle-autofix",60447),debugBreakpointPending:C("debug-breakpoint-pending",60377)},B={...s3,...noe};var a3;(t=>{function r(e){return e&&typeof e=="object"&&typeof e.id=="string"}t.isThemeColor=r})(a3||={});var ye;(f=>{f.iconNameSegment="[A-Za-z0-9]+",f.iconNameExpression="[A-Za-z0-9-]+",f.iconModifierExpression="~[A-Za-z]+",f.iconNameCharacter="[A-Za-z0-9~-]";let n=new RegExp(`^(${f.iconNameExpression})(${f.iconModifierExpression})?$`);function o(b){let y=n.exec(b.id);if(!y)return o(B.error);let[,I,E]=y,S=["codicon","codicon-"+I];return E&&S.push("codicon-modifier-"+E.substring(1)),S}f.asClassNameArray=o;function s(b){return o(b).join(" ")}f.asClassName=s;function a(b){return"."+o(b).join(".")}f.asCSSSelector=a;function l(b){return b&&typeof b=="object"&&typeof b.id=="string"&&(typeof b.color>"u"||a3.isThemeColor(b.color))}f.isThemeIcon=l;let d=new RegExp(`^\\$\\((${f.iconNameExpression}(?:${f.iconModifierExpression})?)\\)$`);function c(b){let y=d.exec(b);if(!y)return;let[,I]=y;return{id:I}}f.fromString=c;function u(b){return{id:b}}f.fromId=u;function p(b,y){let I=b.id,E=I.lastIndexOf("~");return E!==-1&&(I=I.substring(0,E)),y&&(I=`${I}~${y}`),{id:I}}f.modify=p;function m(b){let y=b.id.lastIndexOf("~");if(y!==-1)return b.id.substring(y+1)}f.getModifier=m;function g(b,y){return b.id===y.id&&b.color?.id===y.color?.id}f.isEqual=g})(ye||={});var ooe="$(",JB=new RegExp(`\\$\\(${ye.iconNameExpression}(?:${ye.iconModifierExpression})?\\)`,"g"),roe=new RegExp(`(\\\\)?${JB.source}`,"g");function l3(r){return r.replace(roe,(t,e)=>e?t:`\\${t}`)}var soe=new RegExp(`\\\\${JB.source}`,"g");function d3(r){return r.replace(soe,t=>`\\${t}`)}var aoe=new RegExp(`(\\s)?(\\\\)?${JB.source}(\\s)?`,"g");function HD(r){return r.indexOf(ooe)===-1?r:r.replace(aoe,(t,e,i,n)=>i?t:e||n||"")}var eIe=new RegExp(`\\$\\(${ye.iconNameCharacter}+\\)`,"g");var kg=class{value;isTrusted;supportThemeIcons;supportHtml;baseUri;constructor(t="",e=!1){if(this.value=t,typeof this.value!="string")throw dh("value");typeof e=="boolean"?(this.isTrusted=e,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=e.isTrusted??void 0,this.supportThemeIcons=e.supportThemeIcons??!1,this.supportHtml=e.supportHtml??!1)}appendText(t,e=0){return this.value+=loe(this.supportThemeIcons?l3(t):t).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,e===1?`\\
`:`

`),this}appendMarkdown(t){return this.value+=t,this}appendCodeblock(t,e){return this.value+=`
${doe(e,t)}
`,this}appendLink(t,e,i){return this.value+="[",this.value+=this._escape(e,"]"),this.value+="](",this.value+=this._escape(String(t),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(t,e){let i=new RegExp(Jr(e),"g");return t.replace(i,(n,o)=>t.charAt(o-1)!=="\\"?`\\${n}`:n)}};function xh(r){return r instanceof kg?!0:r&&typeof r=="object"?typeof r.value=="string"&&(typeof r.isTrusted=="boolean"||typeof r.isTrusted=="object"||r.isTrusted===void 0)&&(typeof r.supportThemeIcons=="boolean"||r.supportThemeIcons===void 0):!1}function zD(r,t){return r===t?!0:!r||!t?!1:r.value===t.value&&r.isTrusted===t.isTrusted&&r.supportThemeIcons===t.supportThemeIcons&&r.supportHtml===t.supportHtml&&(r.baseUri===t.baseUri||!!r.baseUri&&!!t.baseUri&&Wn(q.from(r.baseUri),q.from(t.baseUri)))}function loe(r){return r.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function doe(r,t){let e=r.match(/^`+/gm)?.reduce((n,o)=>n.length>o.length?n:o).length??0,i=e>=3?e+1:3;return[`${"`".repeat(i)}${t}`,r,`${"`".repeat(i)}`].join(`
`)}function gw(r){return r.replace(/"/g,"&quot;")}function KD(r){return r&&r.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function c3(r){let t=[],e=r.split("|").map(n=>n.trim());r=e[0];let i=e[1];if(i){let n=/height=(\d+)/.exec(i),o=/width=(\d+)/.exec(i),s=n?n[1]:"",a=o?o[1]:"",l=isFinite(parseInt(a)),d=isFinite(parseInt(s));l&&t.push(`width="${a}"`),d&&t.push(`height="${s}"`)}return{href:r,dimensions:t}}var ai=$("fileService");function ka(r){return!!(r.capabilities&2)}function fw(r){return!!(r.capabilities&8)}function qD(r){return!!(r.capabilities&131072)}function Ju(r){return!!(r.capabilities&4)}function jD(r){return!!(r.capabilities&16)}function $D(r){return ka(r)?!!(r.capabilities&16384):!1}function eV(r){return ka(r)?!!(r.capabilities&32768):!1}function u3(r){return!!(r.capabilities&65536)}function p3(r){return!!(r.capabilities&2048)}var cv=class r extends Error{constructor(e,i){super(e);this.code=i}static create(e,i){let n=new r(e.toString(),i);return coe(n,i),n}};function Lh(r,t){return cv.create(r,t)}function ep(r){return r||Lh(h("unknownError","Unknown Error"),"Unknown")}function coe(r,t){return r.name=t?`${t} (FileSystemError)`:"FileSystemError",r}function bw(r){if(!r)return"Unknown";if(r instanceof cv)return r.code;let t=/^(.+) \(FileSystemError\)$/.exec(r.name);if(!t)return"Unknown";switch(t[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function vw(r){if(r instanceof So)return r.fileOperationResult;switch(bw(r)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var Qu=class{constructor(t,e,i){this.resource=t;this.operation=e;this.target=i}isOperation(t){return this.operation===t}};var GD=class r{constructor(t,e){this.ignorePathCasing=e;for(let i of t){switch(i.type){case 1:this.rawAdded.push(i.resource);break;case 0:this.rawUpdated.push(i.resource);break;case 2:this.rawDeleted.push(i.resource);break}this.correlationId!==r.MIXED_CORRELATION&&(typeof i.cId=="number"?this.correlationId===void 0?this.correlationId=i.cId:this.correlationId!==i.cId&&(this.correlationId=r.MIXED_CORRELATION):this.correlationId!==void 0&&(this.correlationId=r.MIXED_CORRELATION))}}static MIXED_CORRELATION=null;correlationId=void 0;added=new an(()=>{let t=_a.forUris(()=>this.ignorePathCasing);return t.fill(this.rawAdded.map(e=>[e,!0])),t});updated=new an(()=>{let t=_a.forUris(()=>this.ignorePathCasing);return t.fill(this.rawUpdated.map(e=>[e,!0])),t});deleted=new an(()=>{let t=_a.forUris(()=>this.ignorePathCasing);return t.fill(this.rawDeleted.map(e=>[e,!0])),t});contains(t,...e){return this.doContains(t,{includeChildren:!1},...e)}affects(t,...e){return this.doContains(t,{includeChildren:!0},...e)}doContains(t,e,...i){if(!t)return!1;let n=i.length>0;return!!((!n||i.includes(1))&&(this.added.value.get(t)||e.includeChildren&&this.added.value.findSuperstr(t))||(!n||i.includes(0))&&(this.updated.value.get(t)||e.includeChildren&&this.updated.value.findSuperstr(t))||(!n||i.includes(2))&&(this.deleted.value.findSubstr(t)||e.includeChildren&&this.deleted.value.findSuperstr(t)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(t){return this.correlationId===t}hasCorrelation(){return typeof this.correlationId=="number"}rawAdded=[];rawUpdated=[];rawDeleted=[]};var So=class extends Error{constructor(e,i,n){super(e);this.fileOperationResult=i;this.options=n}},_h=class extends So{constructor(e,i,n,o){super(e,i,o);this.fileOperationResult=i;this.size=n}},Dh=class extends So{constructor(e,i,n){super(e,2,n);this.stat=i}};var id={OFF:"off",AFTER_DELAY:"afterDelay",ON_FOCUS_CHANGE:"onFocusChange",ON_WINDOW_CHANGE:"onWindowChange"},pv={OFF:"off",ON_EXIT:"onExit",ON_EXIT_AND_WINDOW_CLOSE:"onExitAndWindowClose"},h3="files.associations";var m3="files.readonlyInclude",g3="files.readonlyExclude";var kh=(i=>(i[i.FILE=0]="FILE",i[i.FOLDER=1]="FOLDER",i[i.ROOT_FOLDER=2]="ROOT_FOLDER",i))(kh||{}),tp="";function tV(r){if(!(typeof r.size!="number"||typeof r.mtime!="number"))return r.mtime.toString(29)+r.size.toString(31)}async function iV(r,t){if(!t.hasProvider(q.from({scheme:r.scheme})))return new Promise(e=>{let i=t.onDidChangeFileSystemProviderRegistrations(n=>{n.scheme===r.scheme&&n.added&&(i.dispose(),e())})})}var uv=class r{static KB=1024;static MB=r.KB*r.KB;static GB=r.MB*r.KB;static TB=r.GB*r.KB;static formatSize(t){return Vo(t)||(t=0),t<r.KB?h("sizeB","{0}B",t.toFixed(0)):t<r.MB?h("sizeKB","{0}KB",(t/r.KB).toFixed(2)):t<r.GB?h("sizeMB","{0}MB",(t/r.MB).toFixed(2)):t<r.TB?h("sizeGB","{0}GB",(t/r.GB).toFixed(2)):h("sizeTB","{0}TB",(t/r.TB).toFixed(2))}};var ot=class extends L{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_id;_label;_tooltip;_cssClass;_enabled=!0;_checked;_actionCallback;constructor(t,e="",i="",n=!0,o){super(),this._id=t,this._label=e,this._cssClass=i,this._enabled=n,this._actionCallback=o}get id(){return this._id}get label(){return this._label}set label(t){this._setLabel(t)}_setLabel(t){this._label!==t&&(this._label=t,this._onDidChange.fire({label:t}))}get tooltip(){return this._tooltip||""}set tooltip(t){this._setTooltip(t)}_setTooltip(t){this._tooltip!==t&&(this._tooltip=t,this._onDidChange.fire({tooltip:t}))}get class(){return this._cssClass}set class(t){this._setClass(t)}_setClass(t){this._cssClass!==t&&(this._cssClass=t,this._onDidChange.fire({class:t}))}get enabled(){return this._enabled}set enabled(t){this._setEnabled(t)}_setEnabled(t){this._enabled!==t&&(this._enabled=t,this._onDidChange.fire({enabled:t}))}get checked(){return this._checked}set checked(t){this._setChecked(t)}_setChecked(t){this._checked!==t&&(this._checked=t,this._onDidChange.fire({checked:t}))}async run(t,e){this._actionCallback&&await this._actionCallback(t)}},wn=class extends L{_onWillRun=this._register(new T);onWillRun=this._onWillRun.event;_onDidRun=this._register(new T);onDidRun=this._onDidRun.event;async run(t,e){if(!t.enabled)return;this._onWillRun.fire({action:t});let i;try{await this.runAction(t,e)}catch(n){i=n}this._onDidRun.fire({action:t,error:i})}async runAction(t,e){await t.run(e)}},pt=class r{static join(...t){let e=[];for(let i of t)i.length&&(e.length?e=[...e,new r,...i]:e=i);return e}static ID="vs.actions.separator";id=r.ID;label="";tooltip="";class="separator";enabled=!1;checked=!1;async run(){}},mn=class{id;label;class;tooltip="";enabled=!0;checked=void 0;_actions;get actions(){return this._actions}constructor(t,e,i,n){this.id=t,this.label=e,this.class=n,this._actions=i}async run(){}},YD=class r extends ot{static ID="vs.actions.empty";constructor(){super(r.ID,h("submenu.empty","(empty)"),void 0,!1)}};function Ht(r){return{id:r.id,label:r.label,tooltip:r.tooltip??r.label,class:r.class,enabled:r.enabled??!0,checked:r.checked,run:async(...t)=>r.run(...t)}}function nV(r,t){return t&&(r.stack||r.stacktrace)?h("stackTrace.format","{0}: {1}",b3(r),f3(r.stack)||f3(r.stacktrace)):b3(r)}function f3(r){return Array.isArray(r)?r.join(`
`):r}function b3(r){return r.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${r.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof r.code=="string"&&typeof r.errno=="number"&&typeof r.syscall=="string"?h("nodeExceptionMessage","A system error occurred ({0})",r.message):r.message||h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function lo(r=null,t=!1){if(!r)return h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(r)){let e=Ei(r),i=lo(e[0],t);return e.length>1?h("error.moreErrors","{0} ({1} errors in total)",i,e.length):i}if(si(r))return r;if(r.detail){let e=r.detail;if(e.error)return nV(e.error,t);if(e.exception)return nV(e.exception,t)}return r.stack?nV(r,t):r.message?r.message:h("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function yw(r){let t=r;return t instanceof Error&&Array.isArray(t.actions)}function v3(r,t){let e;return typeof r=="string"?e=new Error(r):e=r,e.actions=t,e}function Xn(r){return rV(r,0)}function rV(r,t){switch(typeof r){case"object":return r===null?ip(349,t):Array.isArray(r)?poe(r,t):hoe(r,t);case"string":return XD(r,t);case"boolean":return uoe(r,t);case"number":return ip(r,t);case"undefined":return ip(937,t);default:return ip(617,t)}}function ip(r,t){return(t<<5)-t+r|0}function uoe(r,t){return ip(r?433:863,t)}function XD(r,t){t=ip(149417,t);for(let e=0,i=r.length;e<i;e++)t=ip(r.charCodeAt(e),t);return t}function poe(r,t){return t=ip(104579,t),r.reduce((e,i)=>rV(i,e),t)}function hoe(r,t){return t=ip(181387,t),Object.keys(r).sort().reduce((e,i)=>(e=XD(i,e),rV(r[i],e)),t)}function oV(r,t,e=32){let i=e-t,n=~((1<<i)-1);return(r<<t|(n&r)>>>i)>>>0}function y3(r,t=0,e=r.byteLength,i=0){for(let n=0;n<e;n++)r[t+n]=i}function moe(r,t,e="0"){for(;r.length<t;)r=e+r;return r}function Iw(r,t=32){return r instanceof ArrayBuffer?Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join(""):moe((r>>>0).toString(16),t/4)}var ZD=class r{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(t){let e=t.length;if(e===0)return;let i=this._buff,n=this._buffLen,o=this._leftoverHighSurrogate,s,a;for(o!==0?(s=o,a=-1,o=0):(s=t.charCodeAt(0),a=0);;){let l=s;if(ln(s))if(a+1<e){let d=t.charCodeAt(a+1);Ih(d)?(a++,l=pD(s,d)):l=65533}else{o=s;break}else Ih(s)&&(l=65533);if(n=this._push(i,n,l),a++,a<e)s=t.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=o}_push(t,e,i){return i<128?t[e++]=i:i<2048?(t[e++]=192|(i&1984)>>>6,t[e++]=128|(i&63)>>>0):i<65536?(t[e++]=224|(i&61440)>>>12,t[e++]=128|(i&4032)>>>6,t[e++]=128|(i&63)>>>0):(t[e++]=240|(i&1835008)>>>18,t[e++]=128|(i&258048)>>>12,t[e++]=128|(i&4032)>>>6,t[e++]=128|(i&63)>>>0),e>=64&&(this._step(),e-=64,this._totalLen+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),e}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Iw(this._h0)+Iw(this._h1)+Iw(this._h2)+Iw(this._h3)+Iw(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,y3(this._buff,this._buffLen),this._buffLen>56&&(this._step(),y3(this._buff));let t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){let t=r._bigBlock32,e=this._buffDV;for(let u=0;u<64;u+=4)t.setUint32(u,e.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)t.setUint32(u,oV(t.getUint32(u-12,!1)^t.getUint32(u-32,!1)^t.getUint32(u-56,!1)^t.getUint32(u-64,!1),1),!1);let i=this._h0,n=this._h1,o=this._h2,s=this._h3,a=this._h4,l,d,c;for(let u=0;u<80;u++)u<20?(l=n&o|~n&s,d=1518500249):u<40?(l=n^o^s,d=1859775393):u<60?(l=n&o|n&s|o&s,d=2400959708):(l=n^o^s,d=3395469782),c=oV(i,5)+l+a+d+t.getUint32(u*4,!1)&4294967295,a=s,s=o,o=oV(n,30),n=i,i=c;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function sV(...r){switch(r.length){case 1:return h("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",r[0]);case 2:return h("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",r[0],r[1]);case 3:return h("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",r[0],r[1],r[2]);default:return}}var goe=h("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),foe=h("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),Rh=class r{static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return t.lexeme;case 18:return t.lexeme;case 19:return t.lexeme;case 20:return"EOF";default:throw z_(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(t=>t.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(t){return this._input=t,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let e=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:e})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let e=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:e})}else this._match(126)?this._addToken(9):this._error(sV("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(sV("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(sV("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(t){return this._isAtEnd()||this._input.charCodeAt(this._current)!==t?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(t){this._tokens.push({type:t,offset:this._start})}_error(t){let e=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:e,lexeme:i,additionalInfo:t}),this._tokens.push(n)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let t=this.stringRe.exec(this._input);if(t){this._current=this._start+t[0].length;let e=this._input.substring(this._start,this._current),i=r._keywords.get(e);i?this._addToken(i):this._tokens.push({type:17,lexeme:e,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(goe);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let t=this._current,e=!1,i=!1;for(;;){if(t>=this._input.length){this._current=t,this._error(foe);return}let o=this._input.charCodeAt(t);if(e)e=!1;else if(o===47&&!i){t++;break}else o===91?i=!0:o===92?e=!0:o===93&&(i=!1);t++}for(;t<this._input.length&&r._regexFlags.has(this._input.charCodeAt(t));)t++;this._current=t;let n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var wo=new Map;wo.set("false",!1);wo.set("true",!0);wo.set("isMac",be);wo.set("isLinux",_t);wo.set("isWindows",rt);wo.set("isWeb",wt);wo.set("isMacNative",be&&!wt);wo.set("isEdge",X9);wo.set("isFirefox",M_);wo.set("isChrome",UF);wo.set("isSafari",Z9);function S3(r,t){if(wo.get(r)!==void 0)throw dh("contextkey.setConstant(k, v) invoked with already set constant `k`");wo.set(r,t)}var boe=Object.prototype.hasOwnProperty;var voe={regexParsingWithErrorRecovery:!0},yoe=h("contextkey.parser.error.emptyString","Empty context key expression"),Ioe=h("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),Coe=h("contextkey.parser.error.noInAfterNot","'in' after 'not'."),I3=h("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),Soe=h("contextkey.parser.error.unexpectedToken","Unexpected token"),woe=h("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),Eoe=h("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),Toe=h("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),aV=class r{constructor(t=voe){this._config=t}static _parseError=new Error;_scanner=new Rh;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(t){if(t===""){this._parsingErrors.push({message:yoe,offset:0,lexeme:"",additionalInfo:Ioe});return}this._tokens=this._scanner.reset(t).scan(),this._current=0,this._parsingErrors=[];try{let e=this._expr();if(!this._isAtEnd()){let i=this._peek(),n=i.type===17?woe:void 0;throw this._parsingErrors.push({message:Soe,offset:i.offset,lexeme:Rh.getLexeme(i),additionalInfo:n}),r._parseError}return e}catch(e){if(e!==r._parseError)throw e;return}}_expr(){return this._or()}_or(){let t=[this._and()];for(;this._matchOne(16);){let e=this._and();t.push(e)}return t.length===1?t[0]:X.or(...t)}_and(){let t=[this._term()];for(;this._matchOne(15);){let e=this._term();t.push(e)}return t.length===1?t[0]:X.and(...t)}_term(){if(this._matchOne(2)){let t=this._peek();switch(t.type){case 11:return this._advance(),Ur.INSTANCE;case 12:return this._advance(),es.INSTANCE;case 0:{this._advance();let e=this._expr();return this._consume(1,I3),e?.negate()}case 17:return this._advance(),Ag.create(t.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",t)}}return this._primary()}_primary(){let t=this._peek();switch(t.type){case 11:return this._advance(),X.true();case 12:return this._advance(),X.false();case 0:{this._advance();let e=this._expr();return this._consume(1,I3),e}case 17:{let e=t.lexeme;if(this._advance(),this._matchOne(9)){let n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);let o=n.lexeme,s=o.lastIndexOf("/"),a=s===o.length-1?void 0:this._removeFlagsGY(o.substring(s+1)),l;try{l=new RegExp(o.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",n)}return Dw.create(e,l)}switch(n.type){case 10:case 19:{let o=[n.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<n.lexeme.length;p++)n.lexeme.charCodeAt(p)===40?a++:n.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:n.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;o.push(Rh.getLexeme(s)),this._advance(),s=this._peek()}let l=o.join(""),d=l.lastIndexOf("/"),c=d===l.length-1?void 0:this._removeFlagsGY(l.substring(d+1)),u;try{u=new RegExp(l.substring(1,d),c)}catch{throw this._errExpectedButGot("REGEX",n)}return X.regex(e,u)}case 18:{let o=n.lexeme;this._advance();let s=null;if(!YS(o)){let a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){let d=o.slice(a+1,l),c=o[l+1]==="i"?"i":"";try{s=new RegExp(d,c)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(s===null)throw this._errExpectedButGot("REGEX",n);return Dw.create(e,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,Coe);let n=this._value();return X.notIn(e,n)}switch(this._peek().type){case 3:{this._advance();let n=this._value();if(this._previous().type===18)return X.equals(e,n);switch(n){case"true":return X.has(e);case"false":return X.not(e);default:return X.equals(e,n)}}case 4:{this._advance();let n=this._value();if(this._previous().type===18)return X.notEquals(e,n);switch(n){case"true":return X.not(e);case"false":return X.has(e);default:return X.notEquals(e,n)}}case 5:return this._advance(),xw.create(e,this._value());case 6:return this._advance(),_w.create(e,this._value());case 7:return this._advance(),Ew.create(e,this._value());case 8:return this._advance(),Tw.create(e,this._value());case 13:return this._advance(),X.in(e,this._value());default:return X.has(e)}}case 20:throw this._parsingErrors.push({message:Eoe,offset:t.offset,lexeme:"",additionalInfo:Toe}),r._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let t=this._peek();switch(t.type){case 17:case 18:return this._advance(),t.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(t){return t.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(t){return this._check(t)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(t,e){if(this._check(t))return this._advance();throw this._errExpectedButGot(e,this._peek())}_errExpectedButGot(t,e,i){let n=h("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,t,Rh.getLexeme(e)),o=e.offset,s=Rh.getLexeme(e);return this._parsingErrors.push({message:n,offset:o,lexeme:s,additionalInfo:i}),r._parseError}_check(t){return this._peek().type===t}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},X=class{static false(){return Ur.INSTANCE}static true(){return es.INSTANCE}static has(t){return Rg.create(t)}static equals(t,e){return Sw.create(t,e)}static notEquals(t,e){return ww.create(t,e)}static regex(t,e){return Dw.create(t,e)}static in(t,e){return QD.create(t,e)}static notIn(t,e){return JD.create(t,e)}static not(t){return Ag.create(t)}static and(...t){return eL.create(t,null,!0)}static or(...t){return Lw.create(t,null,!0)}static greater(t,e){return Ew.create(t,e)}static greaterEquals(t,e){return Tw.create(t,e)}static smaller(t,e){return xw.create(t,e)}static smallerEquals(t,e){return _w.create(t,e)}static _parser=new aV({regexParsingWithErrorRecovery:!1});static deserialize(t){return t==null?void 0:this._parser.parse(t)}};function Cw(r,t){return r.cmp(t)}var Ur=class r{static INSTANCE=new r;type=0;constructor(){}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}map(t){return this}negate(){return es.INSTANCE}},es=class r{static INSTANCE=new r;type=1;constructor(){}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}map(t){return this}negate(){return Ur.INSTANCE}},Rg=class r{constructor(t,e){this.key=t;this.negated=e}static create(t,e=null){let i=wo.get(t);return typeof i=="boolean"?i?es.INSTANCE:Ur.INSTANCE:new r(t,e)}type=2;cmp(t){return t.type!==this.type?this.type-t.type:E3(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){let t=wo.get(this.key);return typeof t=="boolean"?t?es.INSTANCE:Ur.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(t){return t.mapDefined(this.key)}negate(){return this.negated||(this.negated=Ag.create(this.key,this)),this.negated}},Sw=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){if(typeof e=="boolean")return e?Rg.create(t,i):Ag.create(t,i);let n=wo.get(t);return typeof n=="boolean"?e===(n?"true":"false")?es.INSTANCE:Ur.INSTANCE:new r(t,e,i)}type=4;cmp(t){return t.type!==this.type?this.type-t.type:Pg(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){let t=wo.get(this.key);if(typeof t=="boolean"){let e=t?"true":"false";return this.value===e?es.INSTANCE:Ur.INSTANCE}return this}evaluate(t){return t.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(t){return t.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ww.create(this.key,this.value,this)),this.negated}},QD=class r{constructor(t,e){this.key=t;this.valueKey=e}static create(t,e){return new r(t,e)}type=10;negated=null;cmp(t){return t.type!==this.type?this.type-t.type:Pg(this.key,this.valueKey,t.key,t.valueKey)}equals(t){return t.type===this.type?this.key===t.key&&this.valueKey===t.valueKey:!1}substituteConstants(){return this}evaluate(t){let e=t.getValue(this.valueKey),i=t.getValue(this.key);return Array.isArray(e)?e.includes(i):typeof i=="string"&&typeof e=="object"&&e!==null?boe.call(e,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(t){return t.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=JD.create(this.key,this.valueKey)),this.negated}},JD=class r{constructor(t,e){this.key=t;this.valueKey=e;this._negated=QD.create(t,e)}static create(t,e){return new r(t,e)}type=11;_negated;cmp(t){return t.type!==this.type?this.type-t.type:this._negated.cmp(t._negated)}equals(t){return t.type===this.type?this._negated.equals(t._negated):!1}substituteConstants(){return this}evaluate(t){return!this._negated.evaluate(t)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(t){return t.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},ww=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){if(typeof e=="boolean")return e?Ag.create(t,i):Rg.create(t,i);let n=wo.get(t);return typeof n=="boolean"?e===(n?"true":"false")?Ur.INSTANCE:es.INSTANCE:new r(t,e,i)}type=5;cmp(t){return t.type!==this.type?this.type-t.type:Pg(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){let t=wo.get(this.key);if(typeof t=="boolean"){let e=t?"true":"false";return this.value===e?Ur.INSTANCE:es.INSTANCE}return this}evaluate(t){return t.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(t){return t.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Sw.create(this.key,this.value,this)),this.negated}},Ag=class r{constructor(t,e){this.key=t;this.negated=e}static create(t,e=null){let i=wo.get(t);return typeof i=="boolean"?i?Ur.INSTANCE:es.INSTANCE:new r(t,e)}type=3;cmp(t){return t.type!==this.type?this.type-t.type:E3(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){let t=wo.get(this.key);return typeof t=="boolean"?t?Ur.INSTANCE:es.INSTANCE:this}evaluate(t){return!t.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(t){return t.mapNot(this.key)}negate(){return this.negated||(this.negated=Rg.create(this.key,this)),this.negated}};function tL(r,t){if(typeof r=="string"){let e=parseFloat(r);isNaN(e)||(r=e)}return typeof r=="string"||typeof r=="number"?t(r):Ur.INSTANCE}var Ew=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return tL(e,n=>new r(t,n,i))}type=12;cmp(t){return t.type!==this.type?this.type-t.type:Pg(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=_w.create(this.key,this.value,this)),this.negated}},Tw=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return tL(e,n=>new r(t,n,i))}type=13;cmp(t){return t.type!==this.type?this.type-t.type:Pg(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=xw.create(this.key,this.value,this)),this.negated}},xw=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return tL(e,n=>new r(t,n,i))}type=14;cmp(t){return t.type!==this.type?this.type-t.type:Pg(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Tw.create(this.key,this.value,this)),this.negated}},_w=class r{constructor(t,e,i){this.key=t;this.value=e;this.negated=i}static create(t,e,i=null){return tL(e,n=>new r(t,n,i))}type=15;cmp(t){return t.type!==this.type?this.type-t.type:Pg(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Ew.create(this.key,this.value,this)),this.negated}},Dw=class r{constructor(t,e){this.key=t;this.regexp=e}static create(t,e){return new r(t,e)}type=7;negated=null;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.key<t.key)return-1;if(this.key>t.key)return 1;let e=this.regexp?this.regexp.source:"",i=t.regexp?t.regexp.source:"";return e<i?-1:e>i?1:0}equals(t){if(t.type===this.type){let e=this.regexp?this.regexp.source:"",i=t.regexp?t.regexp.source:"";return this.key===t.key&&e===i}return!1}substituteConstants(){return this}evaluate(t){let e=t.getValue(this.key);return this.regexp?this.regexp.test(e):!1}serialize(){let t=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${t}`}keys(){return[this.key]}map(t){return t.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=lV.create(this)),this.negated}},lV=class r{constructor(t){this._actual=t}static create(t){return new r(t)}type=8;cmp(t){return t.type!==this.type?this.type-t.type:this._actual.cmp(t._actual)}equals(t){return t.type===this.type?this._actual.equals(t._actual):!1}substituteConstants(){return this}evaluate(t){return!this._actual.evaluate(t)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(t){return new r(this._actual.map(t))}negate(){return this._actual}};function w3(r){let t=null;for(let e=0,i=r.length;e<i;e++){let n=r[e].substituteConstants();if(r[e]!==n&&t===null){t=[];for(let o=0;o<e;o++)t[o]=r[o]}t!==null&&(t[e]=n)}return t===null?r:t}var eL=class r{constructor(t,e){this.expr=t;this.negated=e}static create(t,e,i){return r._normalizeArr(t,e,i)}type=6;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let e=0,i=this.expr.length;e<i;e++){let n=Cw(this.expr[e],t.expr[e]);if(n!==0)return n}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let e=0,i=this.expr.length;e<i;e++)if(!this.expr[e].equals(t.expr[e]))return!1;return!0}return!1}substituteConstants(){let t=w3(this.expr);return t===this.expr?this:r.create(t,this.negated,!1)}evaluate(t){for(let e=0,i=this.expr.length;e<i;e++)if(!this.expr[e].evaluate(t))return!1;return!0}static _normalizeArr(t,e,i){let n=[],o=!1;for(let s of t)if(s){if(s.type===1){o=!0;continue}if(s.type===0)return Ur.INSTANCE;if(s.type===6){n.push(...s.expr);continue}n.push(s)}if(n.length===0&&o)return es.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(Cw);for(let s=1;s<n.length;s++)n[s-1].equals(n[s])&&(n.splice(s,1),s--);if(n.length===1)return n[0];for(;n.length>1;){let s=n[n.length-1];if(s.type!==9)break;n.pop();let a=n.pop(),l=n.length===0,d=Lw.create(s.expr.map(c=>r.create([c,a],null,i)),null,l);d&&(n.push(d),n.sort(Cw))}if(n.length===1)return n[0];if(i){for(let s=0;s<n.length;s++)for(let a=s+1;a<n.length;a++)if(n[s].negate().equals(n[a]))return Ur.INSTANCE;if(n.length===1)return n[0]}return new r(n,e)}}serialize(){return this.expr.map(t=>t.serialize()).join(" && ")}keys(){let t=[];for(let e of this.expr)t.push(...e.keys());return t}map(t){return new r(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let t=[];for(let e of this.expr)t.push(e.negate());this.negated=Lw.create(t,this,!0)}return this.negated}},Lw=class r{constructor(t,e){this.expr=t;this.negated=e}static create(t,e,i){return r._normalizeArr(t,e,i)}type=9;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let e=0,i=this.expr.length;e<i;e++){let n=Cw(this.expr[e],t.expr[e]);if(n!==0)return n}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let e=0,i=this.expr.length;e<i;e++)if(!this.expr[e].equals(t.expr[e]))return!1;return!0}return!1}substituteConstants(){let t=w3(this.expr);return t===this.expr?this:r.create(t,this.negated,!1)}evaluate(t){for(let e=0,i=this.expr.length;e<i;e++)if(this.expr[e].evaluate(t))return!0;return!1}static _normalizeArr(t,e,i){let n=[],o=!1;if(t){for(let s=0,a=t.length;s<a;s++){let l=t[s];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return es.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&o)return Ur.INSTANCE;n.sort(Cw)}if(n.length!==0){if(n.length===1)return n[0];for(let s=1;s<n.length;s++)n[s-1].equals(n[s])&&(n.splice(s,1),s--);if(n.length===1)return n[0];if(i){for(let s=0;s<n.length;s++)for(let a=s+1;a<n.length;a++)if(n[s].negate().equals(n[a]))return es.INSTANCE;if(n.length===1)return n[0]}return new r(n,e)}}serialize(){return this.expr.map(t=>t.serialize()).join(" || ")}keys(){let t=[];for(let e of this.expr)t.push(...e.keys());return t}map(t){return new r(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let t=[];for(let e of this.expr)t.push(e.negate());for(;t.length>1;){let e=t.shift(),i=t.shift(),n=[];for(let o of C3(e))for(let s of C3(i))n.push(eL.create([o,s],null,!1));t.unshift(r.create(n,null,!1))}this.negated=r.create(t,this,!0)}return this.negated}},ie=class r extends Rg{static _info=[];static all(){return r._info.values()}_defaultValue;constructor(t,e,i){super(t,null),this._defaultValue=e,typeof i=="object"?r._info.push({...i,key:t}):i!==!0&&r._info.push({key:t,description:i,type:e!=null?typeof e:void 0})}bindTo(t){return t.createKey(this.key,this._defaultValue)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return Sw.create(this.key,t)}notEqualsTo(t){return ww.create(this.key,t)}},ke=$("contextKeyService");function E3(r,t){return r<t?-1:r>t?1:0}function Pg(r,t,e,i){return r<e?-1:r>e?1:t<i?-1:t>i?1:0}function C3(r){return r.type===9?r.expr:[r]}var gt=Object.freeze({View:pe("view","View"),Help:pe("help","Help"),Test:pe("test","Test"),File:pe("file","File"),Preferences:pe("preferences","Preferences"),Developer:pe({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});function T3(r){let t=!1,e=new Map,i=new Map;if(xoe(r,c=>{if(r===c)return!0;let u=JSON.stringify(c);if(u.length<30)return!0;let p=e.get(u);if(!p){let m={schemas:[c]};return e.set(u,m),i.set(c,m),!0}return p.schemas.push(c),i.set(c,p),t=!0,!1}),e.clear(),!t)return JSON.stringify(r);let o="$defs";for(;r.hasOwnProperty(o);)o+="_";let s=[];function a(c){return JSON.stringify(c,(u,p)=>{if(p!==c){let m=i.get(p);if(m&&m.schemas.length>1)return m.id||(m.id=`_${s.length}`,s.push(m.schemas[0])),{$ref:`#/${o}/${m.id}`}}return p})}let l=a(r),d=[];for(let c=0;c<s.length;c++)d.push(`"_${c}":${a(s[c])}`);return d.length?`${l.substring(0,l.length-1)},"${o}":{${d.join(",")}}}`:l}function hv(r){return typeof r=="object"&&r!==null}function xoe(r,t){if(!r||typeof r!="object")return;let e=(...l)=>{for(let d of l)hv(d)&&s.push(d)},i=(...l)=>{for(let d of l)if(hv(d))for(let c in d){let u=d[c];hv(u)&&s.push(u)}},n=(...l)=>{for(let d of l)if(Array.isArray(d))for(let c of d)hv(c)&&s.push(c)},o=l=>{if(Array.isArray(l))for(let d of l)hv(d)&&s.push(d);else hv(l)&&s.push(l)},s=[r],a=s.pop();for(;a;)t(a)&&(e(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),i(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),n(a.anyOf,a.allOf,a.oneOf,a.prefixItems),o(a.items)),a=s.pop()}var ni=$("commandService"),En=new class{_commands=new Map;_onDidRegisterCommand=new T;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(r,t){if(!r)throw new Error("invalid command");if(typeof r=="string"){if(!t)throw new Error("invalid command");return this.registerCommand({id:r,handler:t})}if(r.metadata&&Array.isArray(r.metadata.args)){let s=[];for(let l of r.metadata.args)s.push(l.constraint);let a=r.handler;r.handler=function(l,...d){return $7(d,s),a(l,...d)}}let{id:e}=r,i=this._commands.get(e);i||(i=new ao,this._commands.set(e,i));let n=i.unshift(r),o=te(()=>{n(),this._commands.get(e)?.isEmpty()&&this._commands.delete(e)});return this._onDidRegisterCommand.fire(e),o}registerCommandAlias(r,t){return En.registerCommand(r,(e,...i)=>e.get(ni).executeCommand(t,...i))}getCommand(r){let t=this._commands.get(r);if(!(!t||t.isEmpty()))return Lt.first(t)}getCommands(){let r=new Map;for(let t of this._commands.keys()){let e=this.getCommand(t);e&&r.set(t,e)}return r}};En.registerCommand("noop",()=>{});function iL(r){return r?r.condition!==void 0:!1}var Gt=$("logService"),x3=$("loggerService");function _3(r){return Vo(r)}var lL=3;function mv(r,t=!1){let e="";for(let i=0;i<r.length;i++){let n=r[i];if(n instanceof Error&&(n=lo(n,t)),typeof n=="object")try{n=JSON.stringify(n)}catch{}e+=(i>0?" ":"")+n}return e}var gv=class extends L{level=lL;_onDidChangeLogLevel=this._register(new T);onDidChangeLogLevel=this._onDidChangeLogLevel.event;setLevel(t){this.level!==t&&(this.level=t,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(t){return this.level!==0&&this.level<=t}},nL=class extends gv{constructor(e){super();this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...i){this.checkLogLevel(1)&&this.log(1,mv([e,...i],!0))}debug(e,...i){this.checkLogLevel(2)&&this.log(2,mv([e,...i]))}info(e,...i){this.checkLogLevel(3)&&this.log(3,mv([e,...i]))}warn(e,...i){this.checkLogLevel(4)&&this.log(4,mv([e,...i]))}error(e,...i){if(this.checkLogLevel(5))if(e instanceof Error){let n=Array.prototype.slice.call(arguments);n[0]=e.stack,this.log(5,mv(n))}else this.log(5,mv([e,...i]))}flush(){}};var oL=class extends gv{constructor(e=lL,i=!0){super();this.useColors=i;this.setLevel(e)}trace(e,...i){this.checkLogLevel(1)&&(this.useColors?console.log("%cTRACE","color: #888",e,...i):console.log(e,...i))}debug(e,...i){this.checkLogLevel(2)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...i):console.log(e,...i))}info(e,...i){this.checkLogLevel(3)&&(this.useColors?console.log("%c INFO","color: #33f",e,...i):console.log(e,...i))}warn(e,...i){this.checkLogLevel(4)&&(this.useColors?console.log("%c WARN","color: #993",e,...i):console.log(e,...i))}error(e,...i){this.checkLogLevel(5)&&(this.useColors?console.log("%c  ERR","color: #f33",e,...i):console.error(e,...i))}flush(){}},kw=class extends gv{constructor(e,i=lL){super();this.adapter=e;this.setLevel(i)}trace(e,...i){this.checkLogLevel(1)&&this.adapter.log(1,[this.extractMessage(e),...i])}debug(e,...i){this.checkLogLevel(2)&&this.adapter.log(2,[this.extractMessage(e),...i])}info(e,...i){this.checkLogLevel(3)&&this.adapter.log(3,[this.extractMessage(e),...i])}warn(e,...i){this.checkLogLevel(4)&&this.adapter.log(4,[this.extractMessage(e),...i])}error(e,...i){this.checkLogLevel(5)&&this.adapter.log(5,[this.extractMessage(e),...i])}extractMessage(e){return typeof e=="string"?e:lo(e,this.checkLogLevel(1))}flush(){}},rL=class extends gv{constructor(e){super();this.loggers=e;e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(let i of this.loggers)i.setLevel(e);super.setLevel(e)}trace(e,...i){for(let n of this.loggers)n.trace(e,...i)}debug(e,...i){for(let n of this.loggers)n.debug(e,...i)}info(e,...i){for(let n of this.loggers)n.info(e,...i)}warn(e,...i){for(let n of this.loggers)n.warn(e,...i)}error(e,...i){for(let n of this.loggers)n.error(e,...i)}flush(){for(let e of this.loggers)e.flush()}dispose(){for(let e of this.loggers)e.dispose();super.dispose()}},sL=class extends L{constructor(e,i,n){super();this.logLevel=e;this.logsHome=i;if(n)for(let o of n)this._loggers.set(o.resource,{logger:void 0,info:o})}_loggers=new Ci;_onDidChangeLoggers=this._register(new T);onDidChangeLoggers=this._onDidChangeLoggers.event;_onDidChangeLogLevel=this._register(new T);onDidChangeLogLevel=this._onDidChangeLogLevel.event;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;getLoggerEntry(e){return si(e)?[...this._loggers.values()].find(i=>i.info.id===e):this._loggers.get(e)}getLogger(e){return this.getLoggerEntry(e)?.logger}createLogger(e,i){let n=this.toResource(e),o=si(e)?e:i?.id??Xn(n.toString()).toString(16),s=this._loggers.get(n)?.logger,a=i?.logLevel==="always"?1:i?.logLevel;s||(s=this.doCreateLogger(n,a??this.getLogLevel(n)??this.logLevel,{...i,id:o}));let l={logger:s,info:{resource:n,id:o,logLevel:a,name:i?.name,hidden:i?.hidden,extensionId:i?.extensionId,when:i?.when}};return this.registerLogger(l.info),this._loggers.set(n,l),s}toResource(e){return si(e)?Ot(this.logsHome,`${e}.log`):e}setLogLevel(e,i){if(q.isUri(e)){let n=e,o=i,s=this._loggers.get(n);s&&o!==s.info.logLevel&&(s.info.logLevel=o===this.logLevel?void 0:o,s.logger?.setLevel(o),this._loggers.set(s.info.resource,s),this._onDidChangeLogLevel.fire([n,o]))}else{this.logLevel=e;for(let[n,o]of this._loggers.entries())this._loggers.get(n)?.info.logLevel===void 0&&o.logger?.setLevel(this.logLevel);this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,i){let n=this.getLoggerEntry(e);n&&i!==!n.info.hidden&&(n.info.hidden=!i,this._loggers.set(n.info.resource,n),this._onDidChangeVisibility.fire([n.info.resource,i]))}getLogLevel(e){let i;return e&&(i=this._loggers.get(e)?.info.logLevel),i??this.logLevel}registerLogger(e){let i=this._loggers.get(e.resource);i?i.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){let i=this._loggers.get(e);i&&(i.logger&&i.logger.dispose(),this._loggers.delete(e),this._onDidChangeLoggers.fire({added:[],removed:[i.info]}))}*getRegisteredLoggers(){for(let e of this._loggers.values())yield e.info}getRegisteredLogger(e){return this._loggers.get(e)?.info}dispose(){this._loggers.forEach(e=>e.logger?.dispose()),this._loggers.clear(),super.dispose()}},dV=class{onDidChangeLogLevel=new T().event;setLevel(t){}getLevel(){return 3}trace(t,...e){}debug(t,...e){}info(t,...e){}warn(t,...e){}error(t,...e){}critical(t,...e){}dispose(){}flush(){}},aL=class extends dV{};function dL(r){switch(r){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}var sSe=new ie("logLevel",dL(3));var uL=$("policy"),cL=class extends L{_serviceBrand;policyDefinitions={};policies=new Map;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;async updatePolicyDefinitions(t){let e=Object.keys(this.policyDefinitions).length;return this.policyDefinitions={...t,...this.policyDefinitions},e!==Object.keys(this.policyDefinitions).length&&await this._updatePolicyDefinitions(t),Lt.reduce(this.policies.entries(),(i,[n,o])=>({...i,[n]:o}),{})}getPolicyValue(t){return this.policies.get(t)}serialize(){return Lt.reduce(Object.entries(this.policyDefinitions),(t,[e,i])=>({...t,[e]:{definition:i,value:this.policies.get(e)}}),{})}},fv=class{_serviceBrand;onDidChange=O.None;async updatePolicyDefinitions(){return{}}getPolicyValue(){}serialize(){}};function Ph(r,t){let e=Math.pow(10,t);return Math.round(r*e)/e}var Pt=class{_rgbaBrand=void 0;r;g;b;a;constructor(t,e,i,n=1){this.r=Math.min(255,Math.max(0,t))|0,this.g=Math.min(255,Math.max(0,e))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Ph(Math.max(Math.min(1,n),0),3)}static equals(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}},Ah=class r{_hslaBrand=void 0;h;s;l;a;constructor(t,e,i,n){this.h=Math.max(Math.min(360,t),0)|0,this.s=Ph(Math.max(Math.min(1,e),0),3),this.l=Ph(Math.max(Math.min(1,i),0),3),this.a=Ph(Math.max(Math.min(1,n),0),3)}static equals(t,e){return t.h===e.h&&t.s===e.s&&t.l===e.l&&t.a===e.a}static fromRGBA(t){let e=t.r/255,i=t.g/255,n=t.b/255,o=t.a,s=Math.max(e,i,n),a=Math.min(e,i,n),l=0,d=0,c=(a+s)/2,u=s-a;if(u>0){switch(d=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),s){case e:l=(i-n)/u+(i<n?6:0);break;case i:l=(n-e)/u+2;break;case n:l=(e-i)/u+4;break}l*=60,l=Math.round(l)}return new r(l,d,c,o)}static _hue2rgb(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*(2/3-i)*6:t}static toRGBA(t){let e=t.h/360,{s:i,l:n,a:o}=t,s,a,l;if(i===0)s=a=l=n;else{let d=n<.5?n*(1+i):n+i-n*i,c=2*n-d;s=r._hue2rgb(c,d,e+1/3),a=r._hue2rgb(c,d,e),l=r._hue2rgb(c,d,e-1/3)}return new Pt(Math.round(s*255),Math.round(a*255),Math.round(l*255),o)}},bv=class r{_hsvaBrand=void 0;h;s;v;a;constructor(t,e,i,n){this.h=Math.max(Math.min(360,t),0)|0,this.s=Ph(Math.max(Math.min(1,e),0),3),this.v=Ph(Math.max(Math.min(1,i),0),3),this.a=Ph(Math.max(Math.min(1,n),0),3)}static equals(t,e){return t.h===e.h&&t.s===e.s&&t.v===e.v&&t.a===e.a}static fromRGBA(t){let e=t.r/255,i=t.g/255,n=t.b/255,o=Math.max(e,i,n),s=Math.min(e,i,n),a=o-s,l=o===0?0:a/o,d;return a===0?d=0:o===e?d=((i-n)/a%6+6)%6:o===i?d=(n-e)/a+2:d=(e-i)/a+4,new r(Math.round(d*60),l,o,t.a)}static toRGBA(t){let{h:e,s:i,v:n,a:o}=t,s=n*i,a=s*(1-Math.abs(e/60%2-1)),l=n-s,[d,c,u]=[0,0,0];return e<60?(d=s,c=a):e<120?(d=a,c=s):e<180?(c=s,u=a):e<240?(c=a,u=s):e<300?(d=a,u=s):e<=360&&(d=s,u=a),d=Math.round((d+l)*255),c=Math.round((c+l)*255),u=Math.round((u+l)*255),new Pt(d,c,u,o)}},Y=class r{static fromHex(t){return r.Format.CSS.parseHex(t)||r.red}static equals(t,e){return!t&&!e?!0:!t||!e?!1:t.equals(e)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:Ah.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:bv.fromRGBA(this.rgba)}constructor(t){if(t)if(t instanceof Pt)this.rgba=t;else if(t instanceof Ah)this._hsla=t,this.rgba=Ah.toRGBA(t);else if(t instanceof bv)this._hsva=t,this.rgba=bv.toRGBA(t);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(t){return!!t&&Pt.equals(this.rgba,t.rgba)&&Ah.equals(this.hsla,t.hsla)&&bv.equals(this.hsva,t.hsva)}getRelativeLuminance(){let t=r._relativeLuminanceForComponent(this.rgba.r),e=r._relativeLuminanceForComponent(this.rgba.g),i=r._relativeLuminanceForComponent(this.rgba.b),n=.2126*t+.7152*e+.0722*i;return Ph(n,4)}static _relativeLuminanceForComponent(t){let e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}getContrastRatio(t){let e=this.getRelativeLuminance(),i=t.getRelativeLuminance();return e>i?(e+.05)/(i+.05):(i+.05)/(e+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(t){let e=this.getRelativeLuminance(),i=t.getRelativeLuminance();return e>i}isDarkerThan(t){let e=this.getRelativeLuminance(),i=t.getRelativeLuminance();return e<i}lighten(t){return new r(new Ah(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*t,this.hsla.a))}darken(t){return new r(new Ah(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*t,this.hsla.a))}transparent(t){let{r:e,g:i,b:n,a:o}=this.rgba;return new r(new Pt(e,i,n,o*t))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new r(new Pt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(t){let e=t.rgba,i=this.rgba.a,n=e.a,o=i+n*(1-i);if(o<1e-6)return r.transparent;let s=this.rgba.r*i/o+e.r*n*(1-i)/o,a=this.rgba.g*i/o+e.g*n*(1-i)/o,l=this.rgba.b*i/o+e.b*n*(1-i)/o;return new r(new Pt(s,a,l,o))}makeOpaque(t){if(this.isOpaque()||t.rgba.a!==1)return this;let{r:e,g:i,b:n,a:o}=this.rgba;return new r(new Pt(t.rgba.r-o*(t.rgba.r-e),t.rgba.g-o*(t.rgba.g-i),t.rgba.b-o*(t.rgba.b-n),1))}flatten(...t){let e=t.reduceRight((i,n)=>r._flatten(n,i));return r._flatten(this,e)}static _flatten(t,e){let i=1-t.rgba.a;return new r(new Pt(i*e.rgba.r+t.rgba.a*t.rgba.r,i*e.rgba.g+t.rgba.a*t.rgba.g,i*e.rgba.b+t.rgba.a*t.rgba.b))}_toString;toString(){return this._toString||(this._toString=r.Format.CSS.format(this)),this._toString}static getLighterColor(t,e,i){if(t.isLighterThan(e))return t;i=i||.5;let n=t.getRelativeLuminance(),o=e.getRelativeLuminance();return i=i*(o-n)/o,t.lighten(i)}static getDarkerColor(t,e,i){if(t.isDarkerThan(e))return t;i=i||.5;let n=t.getRelativeLuminance(),o=e.getRelativeLuminance();return i=i*(n-o)/n,t.darken(i)}static white=new r(new Pt(255,255,255,1));static black=new r(new Pt(0,0,0,1));static red=new r(new Pt(255,0,0,1));static blue=new r(new Pt(0,0,255,1));static green=new r(new Pt(0,255,0,1));static cyan=new r(new Pt(0,255,255,1));static lightgrey=new r(new Pt(211,211,211,1));static transparent=new r(new Pt(0,0,0,0))};(t=>{let r;(i=>{let e;(g=>{function n(f){return f.rgba.a===1?`rgb(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b})`:t.Format.CSS.formatRGBA(f)}g.formatRGB=n;function o(f){return`rgba(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b}, ${+f.rgba.a.toFixed(2)})`}g.formatRGBA=o;function s(f){return f.hsla.a===1?`hsl(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%)`:t.Format.CSS.formatHSLA(f)}g.formatHSL=s;function a(f){return`hsla(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%, ${f.hsla.a.toFixed(2)})`}g.formatHSLA=a;function l(f){let b=f.toString(16);return b.length!==2?"0"+b:b}function d(f){return`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}`}g.formatHex=d;function c(f,b=!1){return b&&f.rgba.a===1?t.Format.CSS.formatHex(f):`#${l(f.rgba.r)}${l(f.rgba.g)}${l(f.rgba.b)}${l(Math.round(f.rgba.a*255))}`}g.formatHexA=c;function u(f){return f.isOpaque()?t.Format.CSS.formatHex(f):t.Format.CSS.formatRGBA(f)}g.format=u;function p(f){let b=f.length;if(b===0||f.charCodeAt(0)!==35)return null;if(b===7){let y=16*m(f.charCodeAt(1))+m(f.charCodeAt(2)),I=16*m(f.charCodeAt(3))+m(f.charCodeAt(4)),E=16*m(f.charCodeAt(5))+m(f.charCodeAt(6));return new t(new Pt(y,I,E,1))}if(b===9){let y=16*m(f.charCodeAt(1))+m(f.charCodeAt(2)),I=16*m(f.charCodeAt(3))+m(f.charCodeAt(4)),E=16*m(f.charCodeAt(5))+m(f.charCodeAt(6)),S=16*m(f.charCodeAt(7))+m(f.charCodeAt(8));return new t(new Pt(y,I,E,S/255))}if(b===4){let y=m(f.charCodeAt(1)),I=m(f.charCodeAt(2)),E=m(f.charCodeAt(3));return new t(new Pt(16*y+y,16*I+I,16*E+E))}if(b===5){let y=m(f.charCodeAt(1)),I=m(f.charCodeAt(2)),E=m(f.charCodeAt(3)),S=m(f.charCodeAt(4));return new t(new Pt(16*y+y,16*I+I,16*E+E,(16*S+S)/255))}return null}g.parseHex=p;function m(f){switch(f){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e=i.CSS||={})})(r=t.Format||={})})(Y||={});var cV=class{data=new Map;add(t,e){Y_(si(t)),Y_(Mi(e)),Y_(!this.data.has(t),"There is already an extension with this id"),this.data.set(t,e)}knows(t){return this.data.has(t)}as(t){return this.data.get(t)||null}},Ne=new cV;var nd={JSONContribution:"base.contributions.json"};function _oe(r){return r.length>0&&r.charAt(r.length-1)==="#"?r.substring(0,r.length-1):r}var uV=class{schemasById;_onDidChangeSchema=new T;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(t,e){this.schemasById[_oe(t)]=e,this._onDidChangeSchema.fire(t)}notifySchemaChanged(t){this._onDidChangeSchema.fire(t)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(t){let e=this.schemasById[t];return e?T3(e):void 0}hasSchemaContent(t){return!!this.schemasById[t]}},Doe=new uV;Ne.add(nd.JSONContribution,Doe);function L3(r){return`--vscode-${r.replace(/\./g,"-")}`}function Se(r){return`var(${L3(r)})`}function k3(r,t){return`var(${L3(r)}, ${t})`}function Loe(r){return r!==null&&typeof r=="object"&&"light"in r&&"dark"in r}var koe={ColorContribution:"base.contributions.colors"},Roe="default",pV=class{_onDidChangeSchema=new T;onDidChangeSchema=this._onDidChangeSchema.event;colorsById;colorSchema={type:"object",properties:{}};colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]};constructor(){this.colorsById={}}notifyThemeUpdate(t){for(let e of Object.keys(this.colorsById)){let i=t.getColor(e);i&&(this.colorSchema.properties[e].oneOf[0].defaultSnippets[0].body=`\${1:${i.toString()}}`)}this._onDidChangeSchema.fire()}registerColor(t,e,i,n=!1,o){let s={id:t,description:i,defaults:e,needsTransparency:n,deprecationMessage:o};this.colorsById[t]=s;let a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(a.deprecationMessage=o),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=h("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[t]={description:i,oneOf:[a,{type:"string",const:Roe,description:h("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(t),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),t}deregisterColor(t){delete this.colorsById[t],delete this.colorSchema.properties[t];let e=this.colorReferenceSchema.enum.indexOf(t);e!==-1&&(this.colorReferenceSchema.enum.splice(e,1),this.colorReferenceSchema.enumDescriptions.splice(e,1)),this._onDidChangeSchema.fire()}getColors(){return Object.keys(this.colorsById).map(t=>this.colorsById[t])}resolveDefaultColor(t,e){let i=this.colorsById[t];if(i?.defaults){let n=Loe(i.defaults)?i.defaults[e.type]:i.defaults;return od(n,e)}}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){let t=(e,i)=>{let n=e.indexOf(".")===-1?0:1,o=i.indexOf(".")===-1?0:1;return n!==o?n-o:e.localeCompare(i)};return Object.keys(this.colorsById).sort(t).map(e=>`- \`${e}\`: ${this.colorsById[e].description}`).join(`
`)}},hL=new pV;Ne.add(koe.ColorContribution,hL);function x(r,t,e,i,n){return hL.registerColor(r,t,e,i,n)}function Aoe(r,t){switch(r.op){case 0:return od(r.value,t)?.darken(r.factor);case 1:return od(r.value,t)?.lighten(r.factor);case 2:return od(r.value,t)?.transparent(r.factor);case 3:{let e=od(r.background,t);return e?od(r.value,t)?.makeOpaque(e):od(r.value,t)}case 4:for(let e of r.values){let i=od(e,t);if(i)return i}return;case 6:return od(t.defines(r.if)?r.then:r.else,t);case 5:{let e=od(r.value,t);if(!e)return;let i=od(r.background,t);return i?e.isDarkerThan(i)?Y.getLighterColor(e,i,r.factor).transparent(r.transparency):Y.getDarkerColor(e,i,r.factor).transparent(r.transparency):e.transparent(r.factor*r.transparency)}default:throw US(r)}}function Hr(r,t){return{op:0,value:r,factor:t}}function ts(r,t){return{op:1,value:r,factor:t}}function Fe(r,t){return{op:2,value:r,factor:t}}function hV(...r){return{op:4,values:r}}function R3(r,t,e){return{op:6,if:r,then:t,else:e}}function mV(r,t,e,i){return{op:5,value:r,background:t,factor:e,transparency:i}}function od(r,t){if(r!==null){if(typeof r=="string")return r[0]==="#"?Y.fromHex(r):t.getColor(r);if(r instanceof Y)return r;if(typeof r=="object")return Aoe(r,t)}}var A3="vscode://schemas/workbench-colors",P3=Ne.as(nd.JSONContribution);P3.registerSchema(A3,hL.getColorSchema());var D3=new Et(()=>P3.notifySchemaChanged(A3),200);hL.onDidChangeSchema(()=>{D3.isScheduled()||D3.schedule()});var li=x("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},h("foreground","Overall foreground color. This color is only used if not overridden by a component.")),FSe=x("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},h("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component.")),gV=x("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},h("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),BSe=x("descriptionForeground",{light:"#717171",dark:Fe(li,.7),hcDark:Fe(li,.7),hcLight:Fe(li,.7)},h("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),Rw=x("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},h("iconForeground","The default color for icons in the workbench.")),ir=x("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},h("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Le=x("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},h("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),oi=x("contrastActiveBorder",{light:null,dark:null,hcDark:ir,hcLight:ir},h("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),M3=x("selection.background",null,h("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),mL=x("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkForeground","Foreground color for links in text.")),VSe=x("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},h("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),WSe=x("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:Y.black,hcLight:"#292929"},h("textSeparatorForeground","Color for text separators.")),USe=x("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},h("textPreformatForeground","Foreground color for preformatted text segments.")),HSe=x("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},h("textPreformatBackground","Background color for preformatted text segments.")),zSe=x("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},h("textBlockQuoteBackground","Background color for block quotes in text.")),KSe=x("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:Y.white,hcLight:"#292929"},h("textBlockQuoteBorder","Border color for block quotes in text.")),GSe=x("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:Y.black,hcLight:"#F2F2F2"},h("textCodeBlockBackground","Background color for code blocks in text."));var ZSe=x("sash.hoverBorder",ir,h("sashActiveBorder","Border color of active sashes.")),ul=x("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:Y.black,hcLight:"#0F4A85"},h("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),Mh=x("badge.foreground",{dark:Y.white,light:"#333",hcDark:Y.white,hcLight:Y.white},h("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),Oh=x("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},h("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),gL=x("scrollbarSlider.background",{dark:Y.fromHex("#797979").transparent(.4),light:Y.fromHex("#646464").transparent(.4),hcDark:Fe(Le,.6),hcLight:Fe(Le,.4)},h("scrollbarSliderBackground","Scrollbar slider background color.")),fL=x("scrollbarSlider.hoverBackground",{dark:Y.fromHex("#646464").transparent(.7),light:Y.fromHex("#646464").transparent(.7),hcDark:Fe(Le,.8),hcLight:Fe(Le,.8)},h("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),bL=x("scrollbarSlider.activeBackground",{dark:Y.fromHex("#BFBFBF").transparent(.4),light:Y.fromHex("#000000").transparent(.6),hcDark:Le,hcLight:Le},h("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),O3=x("progressBar.background",{dark:Y.fromHex("#0E70C0"),light:Y.fromHex("#0E70C0"),hcDark:Le,hcLight:Le},h("progressBarBackground","Background color of the progress bar that can show for long running operations."));var Js=x("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:Y.black,hcLight:Y.white},h("editorBackground","Editor background color.")),Cc=x("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:Y.white,hcLight:li},h("editorForeground","Editor default foreground color.")),iwe=x("editorStickyScroll.background",Js,h("editorStickyScrollBackground","Background color of sticky scroll in the editor")),nwe=x("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:Y.fromHex("#0F4A85").transparent(.1)},h("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor")),owe=x("editorStickyScroll.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("editorStickyScrollBorder","Border color of sticky scroll in the editor")),rwe=x("editorStickyScroll.shadow",Oh,h("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor")),nr=x("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:Y.white},h("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),Sc=x("editorWidget.foreground",li,h("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),yV=x("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Le,hcLight:Le},h("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),swe=x("editorWidget.resizeBorder",null,h("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),awe=x("editorError.background",null,h("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Mg=x("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},h("editorError.foreground","Foreground color of error squigglies in the editor.")),lwe=x("editorError.border",{dark:null,light:null,hcDark:Y.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},h("errorBorder","If set, color of double underlines for errors in the editor.")),W3=x("editorWarning.background",null,h("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),is=x("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},h("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),Cv=x("editorWarning.border",{dark:null,light:null,hcDark:Y.fromHex("#FFCC00").transparent(.8),hcLight:Y.fromHex("#FFCC00").transparent(.8)},h("warningBorder","If set, color of double underlines for warnings in the editor.")),dwe=x("editorInfo.background",null,h("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),ea=x("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},h("editorInfo.foreground","Foreground color of info squigglies in the editor.")),Sv=x("editorInfo.border",{dark:null,light:null,hcDark:Y.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},h("infoBorder","If set, color of double underlines for infos in the editor.")),U3=x("editorHint.foreground",{dark:Y.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},h("editorHint.foreground","Foreground color of hint squigglies in the editor.")),cwe=x("editorHint.border",{dark:null,light:null,hcDark:Y.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},h("hintBorder","If set, color of double underlines for hints in the editor.")),uwe=x("editorLink.activeForeground",{dark:"#4E94CE",light:Y.blue,hcDark:Y.cyan,hcLight:"#292929"},h("activeLinkForeground","Color of active links.")),vv=x("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},h("editorSelectionBackground","Color of the editor selection.")),H3=x("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:Y.white},h("editorSelectionForeground","Color of the selected text for high contrast.")),pwe=x("editor.inactiveSelectionBackground",{light:Fe(vv,.5),dark:Fe(vv,.5),hcDark:Fe(vv,.7),hcLight:Fe(vv,.5)},h("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),hwe=x("editor.selectionHighlightBackground",{light:mV(vv,Js,.3,.6),dark:mV(vv,Js,.3,.6),hcDark:null,hcLight:null},h("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),mwe=x("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:oi,hcLight:oi},h("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),gwe=x("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},h("editorFindMatch","Color of the current search match.")),fwe=x("editor.findMatchForeground",null,h("editorFindMatchForeground","Text color of the current search match.")),rd=x("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},h("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),bwe=x("editor.findMatchHighlightForeground",null,h("findMatchHighlightForeground","Foreground color of the other search matches."),!0),vwe=x("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},h("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),ywe=x("editor.findMatchBorder",{light:null,dark:null,hcDark:oi,hcLight:oi},h("editorFindMatchBorder","Border color of the current search match.")),Nh=x("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:oi,hcLight:oi},h("findMatchHighlightBorder","Border color of the other search matches.")),Iwe=x("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Fe(oi,.4),hcLight:Fe(oi,.4)},h("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Cwe=x("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},h("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),N3=x("editorHoverWidget.background",nr,h("hoverBackground","Background color of the editor hover.")),Swe=x("editorHoverWidget.foreground",Sc,h("hoverForeground","Foreground color of the editor hover.")),wwe=x("editorHoverWidget.border",yV,h("hoverBorder","Border color of the editor hover.")),Ewe=x("editorHoverWidget.statusBarBackground",{dark:ts(N3,.2),light:Hr(N3,.05),hcDark:nr,hcLight:nr},h("statusBarBackground","Background color of the editor hover status bar.")),z3=x("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:Y.white,hcLight:Y.black},h("editorInlayHintForeground","Foreground color of inline hints")),K3=x("editorInlayHint.background",{dark:Fe(ul,.1),light:Fe(ul,.1),hcDark:Fe(Y.white,.1),hcLight:Fe(ul,.1)},h("editorInlayHintBackground","Background color of inline hints")),Twe=x("editorInlayHint.typeForeground",z3,h("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),xwe=x("editorInlayHint.typeBackground",K3,h("editorInlayHintBackgroundTypes","Background color of inline hints for types")),_we=x("editorInlayHint.parameterForeground",z3,h("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),Dwe=x("editorInlayHint.parameterBackground",K3,h("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),Poe=x("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},h("editorLightBulbForeground","The color used for the lightbulb actions icon.")),Lwe=x("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},h("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),kwe=x("editorLightBulbAi.foreground",Poe,h("editorLightBulbAiForeground","The color used for the lightbulb AI icon.")),Rwe=x("editor.snippetTabstopHighlightBackground",{dark:new Y(new Pt(124,124,124,.3)),light:new Y(new Pt(10,50,100,.2)),hcDark:new Y(new Pt(124,124,124,.3)),hcLight:new Y(new Pt(10,50,100,.2))},h("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),Awe=x("editor.snippetTabstopHighlightBorder",null,h("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),Pwe=x("editor.snippetFinalTabstopHighlightBackground",null,h("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),Mwe=x("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new Y(new Pt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},h("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),vL=new Y(new Pt(155,185,85,.2)),yL=new Y(new Pt(255,0,0,.2)),G3=x("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},h("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),q3=x("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},h("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Owe=x("diffEditor.insertedLineBackground",{dark:vL,light:vL,hcDark:null,hcLight:null},h("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Nwe=x("diffEditor.removedLineBackground",{dark:yL,light:yL,hcDark:null,hcLight:null},h("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Fwe=x("diffEditorGutter.insertedLineBackground",null,h("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),Bwe=x("diffEditorGutter.removedLineBackground",null,h("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),j3=x("diffEditorOverview.insertedForeground",null,h("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),$3=x("diffEditorOverview.removedForeground",null,h("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),Vwe=x("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},h("diffEditorInsertedOutline","Outline color for the text that got inserted.")),Wwe=x("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},h("diffEditorRemovedOutline","Outline color for text that got removed.")),Uwe=x("diffEditor.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("diffEditorBorder","Border color between the two text editors.")),Hwe=x("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},h("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),zwe=x("diffEditor.unchangedRegionBackground","sideBar.background",h("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor.")),Kwe=x("diffEditor.unchangedRegionForeground","foreground",h("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor.")),Gwe=x("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},h("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor.")),pl=x("widget.shadow",{dark:Fe(Y.black,.36),light:Fe(Y.black,.16),hcDark:null,hcLight:null},h("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Og=x("widget.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("widgetBorder","Border color of widgets such as find/replace inside the editor.")),Aw=x("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},h("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),qwe=x("toolbar.hoverOutline",{dark:null,light:null,hcDark:oi,hcLight:oi},h("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),jwe=x("toolbar.activeBackground",{dark:ts(Aw,.1),light:Hr(Aw,.1),hcDark:null,hcLight:null},h("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),Y3=x("breadcrumb.foreground",Fe(li,.8),h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),Z3=x("breadcrumb.background",Js,h("breadcrumbsBackground","Background color of breadcrumb items.")),IV=x("breadcrumb.focusForeground",{light:Hr(li,.2),dark:ts(li,.1),hcDark:ts(li,.1),hcLight:ts(li,.1)},h("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),X3=x("breadcrumb.activeSelectionForeground",{light:Hr(li,.2),dark:ts(li,.1),hcDark:ts(li,.1),hcLight:ts(li,.1)},h("breadcrumbsSelectedForeground","Color of selected breadcrumb items.")),CV=x("breadcrumbPicker.background",nr,h("breadcrumbsSelectedBackground","Background color of breadcrumb item picker.")),Q3=.5,F3=Y.fromHex("#40C8AE").transparent(Q3),B3=Y.fromHex("#40A6FF").transparent(Q3),V3=Y.fromHex("#606060").transparent(.4),SV=.4,yv=1,fV=x("merge.currentHeaderBackground",{dark:F3,light:F3,hcDark:null,hcLight:null},h("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),$we=x("merge.currentContentBackground",Fe(fV,SV),h("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),bV=x("merge.incomingHeaderBackground",{dark:B3,light:B3,hcDark:null,hcLight:null},h("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Ywe=x("merge.incomingContentBackground",Fe(bV,SV),h("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),vV=x("merge.commonHeaderBackground",{dark:V3,light:V3,hcDark:null,hcLight:null},h("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Zwe=x("merge.commonContentBackground",Fe(vV,SV),h("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0),Iv=x("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},h("mergeBorder","Border color on headers and the splitter in inline merge-conflicts.")),Xwe=x("editorOverviewRuler.currentContentForeground",{dark:Fe(fV,yv),light:Fe(fV,yv),hcDark:Iv,hcLight:Iv},h("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),Qwe=x("editorOverviewRuler.incomingContentForeground",{dark:Fe(bV,yv),light:Fe(bV,yv),hcDark:Iv,hcLight:Iv},h("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),Jwe=x("editorOverviewRuler.commonContentForeground",{dark:Fe(vV,yv),light:Fe(vV,yv),hcDark:Iv,hcLight:Iv},h("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),eEe=x("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},h("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),tEe=x("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",h("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),J3=x("problemsErrorIcon.foreground",Mg,h("problemsErrorIconForeground","The color used for the problems error icon.")),e6=x("problemsWarningIcon.foreground",is,h("problemsWarningIconForeground","The color used for the problems warning icon.")),t6=x("problemsInfoIcon.foreground",ea,h("problemsInfoIconForeground","The color used for the problems info icon."));var i6=x("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},h("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),aEe=x("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),wV=x("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},h("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),lEe=x("minimap.infoHighlight",{dark:ea,light:ea,hcDark:Sv,hcLight:Sv},h("minimapInfo","Minimap marker color for infos.")),dEe=x("minimap.warningHighlight",{dark:is,light:is,hcDark:Cv,hcLight:Cv},h("overviewRuleWarning","Minimap marker color for warnings.")),cEe=x("minimap.errorHighlight",{dark:new Y(new Pt(255,18,18,.7)),light:new Y(new Pt(255,18,18,.7)),hcDark:new Y(new Pt(255,50,50,1)),hcLight:"#B5200D"},h("minimapError","Minimap marker color for errors.")),n6=x("minimap.background",null,h("minimapBackground","Minimap background color.")),o6=x("minimap.foregroundOpacity",Y.fromHex("#000f"),h("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),uEe=x("minimapSlider.background",Fe(gL,.5),h("minimapSliderBackground","Minimap slider background color.")),pEe=x("minimapSlider.hoverBackground",Fe(fL,.5),h("minimapSliderHoverBackground","Minimap slider background color when hovering.")),hEe=x("minimapSlider.activeBackground",Fe(bL,.5),h("minimapSliderActiveBackground","Minimap slider background color when clicked on."));var yEe=x("charts.foreground",li,h("chartsForeground","The foreground color used in charts.")),IEe=x("charts.lines",Fe(li,.5),h("chartsLines","The color used for horizontal lines in charts.")),CEe=x("charts.red",Mg,h("chartsRed","The red color used in chart visualizations.")),SEe=x("charts.blue",ea,h("chartsBlue","The blue color used in chart visualizations.")),wEe=x("charts.yellow",is,h("chartsYellow","The yellow color used in chart visualizations.")),EEe=x("charts.orange",i6,h("chartsOrange","The orange color used in chart visualizations.")),TEe=x("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},h("chartsGreen","The green color used in chart visualizations.")),xEe=x("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},h("chartsPurple","The purple color used in chart visualizations."));var r6=x("input.background",{dark:"#3C3C3C",light:Y.white,hcDark:Y.black,hcLight:Y.white},h("inputBoxBackground","Input box background.")),s6=x("input.foreground",li,h("inputBoxForeground","Input box foreground.")),Tv=x("input.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("inputBoxBorder","Input box border.")),EV=x("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Le,hcLight:Le},h("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),Moe=x("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},h("inputOption.hoverBackground","Background color of activated options in input fields.")),TV=x("inputOption.activeBackground",{dark:Fe(ir,.4),light:Fe(ir,.2),hcDark:Y.transparent,hcLight:Y.transparent},h("inputOption.activeBackground","Background hover color of options in input fields.")),xV=x("inputOption.activeForeground",{dark:Y.white,light:Y.black,hcDark:li,hcLight:li},h("inputOption.activeForeground","Foreground color of activated options in input fields.")),AEe=x("input.placeholderForeground",{light:Fe(li,.5),dark:Fe(li,.5),hcDark:Fe(li,.7),hcLight:Fe(li,.7)},h("inputPlaceholderForeground","Input box foreground color for placeholder text.")),a6=x("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:Y.black,hcLight:Y.white},h("inputValidationInfoBackground","Input validation background color for information severity.")),l6=x("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:li},h("inputValidationInfoForeground","Input validation foreground color for information severity.")),d6=x("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Le,hcLight:Le},h("inputValidationInfoBorder","Input validation border color for information severity.")),c6=x("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:Y.black,hcLight:Y.white},h("inputValidationWarningBackground","Input validation background color for warning severity.")),u6=x("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:li},h("inputValidationWarningForeground","Input validation foreground color for warning severity.")),p6=x("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Le,hcLight:Le},h("inputValidationWarningBorder","Input validation border color for warning severity.")),h6=x("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:Y.black,hcLight:Y.white},h("inputValidationErrorBackground","Input validation background color for error severity.")),m6=x("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:li},h("inputValidationErrorForeground","Input validation foreground color for error severity.")),g6=x("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Le,hcLight:Le},h("inputValidationErrorBorder","Input validation border color for error severity.")),xv=x("dropdown.background",{dark:"#3C3C3C",light:Y.white,hcDark:Y.black,hcLight:Y.white},h("dropdownBackground","Dropdown background.")),f6=x("dropdown.listBackground",{dark:null,light:null,hcDark:Y.black,hcLight:Y.white},h("dropdownListBackground","Dropdown list background.")),Pw=x("dropdown.foreground",{dark:"#F0F0F0",light:li,hcDark:Y.white,hcLight:li},h("dropdownForeground","Dropdown foreground.")),Mw=x("dropdown.border",{dark:xv,light:"#CECECE",hcDark:Le,hcLight:Le},h("dropdownBorder","Dropdown border.")),_V=x("button.foreground",Y.white,h("buttonForeground","Button foreground color.")),b6=x("button.separator",Fe(_V,.4),h("buttonSeparator","Button separator color.")),wv=x("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},h("buttonBackground","Button background color.")),v6=x("button.hoverBackground",{dark:ts(wv,.2),light:Hr(wv,.2),hcDark:wv,hcLight:wv},h("buttonHoverBackground","Button background color when hovering.")),y6=x("button.border",Le,h("buttonBorder","Button border color.")),I6=x("button.secondaryForeground",{dark:Y.white,light:Y.white,hcDark:Y.white,hcLight:li},h("buttonSecondaryForeground","Secondary button foreground color.")),IL=x("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:Y.white},h("buttonSecondaryBackground","Secondary button background color.")),C6=x("button.secondaryHoverBackground",{dark:ts(IL,.2),light:Hr(IL,.2),hcDark:null,hcLight:null},h("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),Ev=x("radio.activeForeground",xV,h("radioActiveForeground","Foreground color of active radio option.")),S6=x("radio.activeBackground",TV,h("radioBackground","Background color of active radio option.")),w6=x("radio.activeBorder",EV,h("radioActiveBorder","Border color of the active radio option.")),E6=x("radio.inactiveForeground",null,h("radioInactiveForeground","Foreground color of inactive radio option.")),T6=x("radio.inactiveBackground",null,h("radioInactiveBackground","Background color of inactive radio option.")),x6=x("radio.inactiveBorder",{light:Fe(Ev,.2),dark:Fe(Ev,.2),hcDark:Fe(Ev,.4),hcLight:Fe(Ev,.2)},h("radioInactiveBorder","Border color of the inactive radio option.")),_6=x("radio.inactiveHoverBackground",Moe,h("radioHoverBackground","Background color of inactive active radio option when hovering.")),D6=x("checkbox.background",xv,h("checkbox.background","Background color of checkbox widget.")),PEe=x("checkbox.selectBackground",nr,h("checkbox.select.background","Background color of checkbox widget when the element it's in is selected.")),L6=x("checkbox.foreground",Pw,h("checkbox.foreground","Foreground color of checkbox widget.")),k6=x("checkbox.border",Mw,h("checkbox.border","Border color of checkbox widget.")),MEe=x("checkbox.selectBorder",Rw,h("checkbox.select.border","Border color of checkbox widget when the element it's in is selected.")),R6=x("keybindingLabel.background",{dark:new Y(new Pt(128,128,128,.17)),light:new Y(new Pt(221,221,221,.4)),hcDark:Y.transparent,hcLight:Y.transparent},h("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),A6=x("keybindingLabel.foreground",{dark:Y.fromHex("#CCCCCC"),light:Y.fromHex("#555555"),hcDark:Y.white,hcLight:li},h("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),P6=x("keybindingLabel.border",{dark:new Y(new Pt(51,51,51,.6)),light:new Y(new Pt(204,204,204,.4)),hcDark:new Y(new Pt(111,195,223)),hcLight:Le},h("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),M6=x("keybindingLabel.bottomBorder",{dark:new Y(new Pt(68,68,68,.6)),light:new Y(new Pt(187,187,187,.4)),hcDark:new Y(new Pt(111,195,223)),hcLight:li},h("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut."));var O6=x("list.focusBackground",null,h("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),N6=x("list.focusForeground",null,h("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),F6=x("list.focusOutline",{dark:ir,light:ir,hcDark:oi,hcLight:oi},h("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),B6=x("list.focusAndSelectionOutline",null,h("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),or=x("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:Y.fromHex("#0F4A85").transparent(.1)},h("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),ta=x("list.activeSelectionForeground",{dark:Y.white,light:Y.white,hcDark:null,hcLight:null},h("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),SL=x("list.activeSelectionIconForeground",null,h("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),V6=x("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:Y.fromHex("#0F4A85").transparent(.1)},h("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),W6=x("list.inactiveSelectionForeground",null,h("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),U6=x("list.inactiveSelectionIconForeground",null,h("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),H6=x("list.inactiveFocusBackground",null,h("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),z6=x("list.inactiveFocusOutline",null,h("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),DV=x("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:Y.white.transparent(.1),hcLight:Y.fromHex("#0F4A85").transparent(.1)},h("listHoverBackground","List/Tree background when hovering over items using the mouse.")),LV=x("list.hoverForeground",null,h("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),K6=x("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},h("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),G6=x("list.dropBetweenBackground",{dark:Rw,light:Rw,hcDark:null,hcLight:null},h("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),CL=x("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:ir,hcLight:ir},h("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),WEe=x("list.focusHighlightForeground",{dark:CL,light:R3(or,CL,"#BBE7FF"),hcDark:CL,hcLight:CL},h("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),UEe=x("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},h("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),HEe=x("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},h("listErrorForeground","Foreground color of list items containing errors.")),zEe=x("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},h("listWarningForeground","Foreground color of list items containing warnings.")),q6=x("listFilterWidget.background",{light:Hr(nr,0),dark:ts(nr,0),hcDark:nr,hcLight:nr},h("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),j6=x("listFilterWidget.outline",{dark:Y.transparent,light:Y.transparent,hcDark:"#f38518",hcLight:"#007ACC"},h("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),$6=x("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Le,hcLight:Le},h("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),Y6=x("listFilterWidget.shadow",pl,h("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees.")),KEe=x("list.filterMatchBackground",{dark:rd,light:rd,hcDark:null,hcLight:null},h("listFilterMatchHighlight","Background color of the filtered match.")),GEe=x("list.filterMatchBorder",{dark:Nh,light:Nh,hcDark:Le,hcLight:oi},h("listFilterMatchHighlightBorder","Border color of the filtered match.")),qEe=x("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},h("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized.")),_v=x("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},h("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),Z6=x("tree.inactiveIndentGuidesStroke",Fe(_v,.4),h("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),X6=x("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},h("tableColumnsBorder","Table border color between columns.")),Q6=x("tree.tableOddRowsBackground",{dark:Fe(li,.04),light:Fe(li,.04),hcDark:null,hcLight:null},h("tableOddRowsBackgroundColor","Background color for odd table rows.")),jEe=x("editorActionList.background",nr,h("editorActionListBackground","Action List background color.")),$Ee=x("editorActionList.foreground",Sc,h("editorActionListForeground","Action List foreground color.")),YEe=x("editorActionList.focusForeground",ta,h("editorActionListFocusForeground","Action List foreground color for the focused item.")),ZEe=x("editorActionList.focusBackground",or,h("editorActionListFocusBackground","Action List background color for the focused item."));var J6=x("menu.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("menuBorder","Border color of menus.")),eq=x("menu.foreground",Pw,h("menuForeground","Foreground color of menu items.")),tq=x("menu.background",xv,h("menuBackground","Background color of menu items.")),iq=x("menu.selectionForeground",ta,h("menuSelectionForeground","Foreground color of the selected menu item in menus.")),nq=x("menu.selectionBackground",or,h("menuSelectionBackground","Background color of the selected menu item in menus.")),oq=x("menu.selectionBorder",{dark:null,light:null,hcDark:oi,hcLight:oi},h("menuSelectionBorder","Border color of the selected menu item in menus.")),rq=x("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Le,hcLight:Le},h("menuSeparatorBackground","Color of a separator menu item in menus."));var aTe=x("quickInput.background",nr,h("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),lTe=x("quickInput.foreground",Sc,h("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),dTe=x("quickInputTitle.background",{dark:new Y(new Pt(255,255,255,.105)),light:new Y(new Pt(0,0,0,.06)),hcDark:"#000000",hcLight:Y.white},h("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),aq=x("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:Y.white,hcLight:"#0F4A85"},h("pickerGroupForeground","Quick picker color for grouping labels.")),cTe=x("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:Y.white,hcLight:"#0F4A85"},h("pickerGroupBorder","Quick picker color for grouping borders.")),sq=x("quickInput.list.focusBackground",null,"",void 0,h("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),lq=x("quickInputList.focusForeground",ta,h("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),dq=x("quickInputList.focusIconForeground",SL,h("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),cq=x("quickInputList.focusBackground",{dark:hV(sq,or),light:hV(sq,or),hcDark:null,hcLight:null},h("quickInput.listFocusBackground","Quick picker background color for the focused item."));var gTe=x("search.resultsInfoForeground",{light:li,dark:Fe(li,.65),hcDark:li,hcLight:li},h("search.resultsInfoForeground","Color of the text in the search viewlet's completion message.")),fTe=x("searchEditor.findMatchBackground",{light:Fe(rd,.66),dark:Fe(rd,.66),hcDark:rd,hcLight:rd},h("searchEditor.queryMatch","Color of the Search Editor query matches.")),bTe=x("searchEditor.findMatchBorder",{light:Fe(Nh,.66),dark:Fe(Nh,.66),hcDark:Nh,hcLight:Nh},h("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var Ooe={IconContribution:"base.contributions.icons"},Noe;(t=>{function r(e,i){let n=e.defaults;for(;ye.isThemeIcon(n);){let o=Ng.getIcon(n.id);if(!o)return;n=o.defaults}return n}t.getDefinition=r})(Noe||={});var Foe;(e=>{function r(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}e.toJSONObject=r;function t(i){let n=o=>si(o)?o:void 0;if(i&&Array.isArray(i.src)&&i.src.every(o=>si(o.format)&&si(o.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(o=>({format:o.format,location:q.parse(o.location)}))}}e.fromJSONObject=t})(Foe||={});var kV=class{_onDidChange=new T;onDidChange=this._onDidChange.event;iconsById;iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:h("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};iconReferenceSchema={type:"string",pattern:`^${ye.iconNameExpression}$`,enum:[],enumDescriptions:[]};iconFontsById;constructor(){this.iconsById={},this.iconFontsById={}}registerIcon(t,e,i,n){let o=this.iconsById[t];if(o){if(i&&!o.description){o.description=i,this.iconSchema.properties[t].markdownDescription=`${i} $(${t})`;let l=this.iconReferenceSchema.enum.indexOf(t);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return o}let s={id:t,description:i,defaults:e,deprecationMessage:n};this.iconsById[t]=s;let a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${t})`),this.iconSchema.properties[t]=a,this.iconReferenceSchema.enum.push(t),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:t}}deregisterIcon(t){delete this.iconsById[t],delete this.iconSchema.properties[t];let e=this.iconReferenceSchema.enum.indexOf(t);e!==-1&&(this.iconReferenceSchema.enum.splice(e,1),this.iconReferenceSchema.enumDescriptions.splice(e,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(t=>this.iconsById[t])}getIcon(t){return this.iconsById[t]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(t,e){let i=this.iconFontsById[t];return i||(this.iconFontsById[t]=e,this._onDidChange.fire(),e)}deregisterIconFont(t){delete this.iconFontsById[t]}getIconFont(t){return this.iconFontsById[t]}toString(){let t=(o,s)=>o.id.localeCompare(s.id),e=o=>{for(;ye.isThemeIcon(o.defaults);)o=this.iconsById[o.defaults.id];return`codicon codicon-${o?o.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");let n=Object.keys(this.iconsById).map(o=>this.iconsById[o]);for(let o of n.filter(s=>!!s.description).sort(t))i.push(`|<i class="${e(o)}"></i>|${o.id}|${ye.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(let o of n.filter(s=>!ye.isThemeIcon(s.defaults)).sort(t))i.push(`|<i class="${e(o)}"></i>|${o.id}|`);return i.join(`
`)}},Ng=new kV;Ne.add(Ooe.IconContribution,Ng);function Tt(r,t,e,i){return Ng.registerIcon(r,t,e,i)}function pq(){return Ng}function Boe(){let r=UD();for(let t in r){let e="\\"+r[t].toString(16);Ng.registerIcon(t,{fontCharacter:e})}}Boe();var hq="vscode://schemas/icons",mq=Ne.as(nd.JSONContribution);mq.registerSchema(hq,Ng.getIconSchema());var uq=new Et(()=>mq.notifySchemaChanged(hq),200);Ng.onDidChange(()=>{uq.isScheduled()||uq.schedule()});var qTe=Tt("widget-close",B.close,h("widgetClose","Icon for the close action in widgets.")),jTe=Tt("goto-previous-location",B.arrowUp,h("previousChangeIcon","Icon for goto previous editor location.")),$Te=Tt("goto-next-location",B.arrowDown,h("nextChangeIcon","Icon for goto next editor location.")),RV=ye.modify(B.sync,"spin"),gq=ye.modify(B.loading,"spin");function Ra(r){return r==="hcDark"||r==="hcLight"}function AV(r){return r==="dark"||r==="hcDark"}var Ze=$("themeService");var hxe=B.file,mxe=B.folder;function Ow(r){switch(r){case"dark":return"vs-dark";case"hcDark":return"hc-black";case"hcLight":return"hc-light";default:return"vs"}}var Woe={ThemingContribution:"base.contributions.theming"},PV=class{themingParticipants=[];onThemingParticipantAddedEmitter;constructor(){this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new T}onColorThemeChange(t){return this.themingParticipants.push(t),this.onThemingParticipantAddedEmitter.fire(t),te(()=>{let e=this.themingParticipants.indexOf(t);this.themingParticipants.splice(e,1)})}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}},fq=new PV;Ne.add(Woe.ThemingContribution,fq);function co(r){return fq.onColorThemeChange(r)}var ia=class extends L{constructor(e){super();this.themeService=e;this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(i=>this.onThemeChange(i)))}theme;onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}getColor(e,i){let n=this.theme.getColor(e);return n&&i&&(n=i(n,this.theme)),n?n.toString():null}};var _r=$("IUriIdentityService");var zr=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?r=crypto.getRandomValues.bind(crypto):r=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};let t=new Uint8Array(16),e=[];for(let i=0;i<256;i++)e.push(i.toString(16).padStart(2,"0"));return function(){r(t),t[6]=t[6]&15|64,t[8]=t[8]&63|128;let n=0,o="";return o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+="-",o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o+=e[t[n++]],o}}();function TL(r){let t=r;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&typeof t.isDefault=="boolean"&&typeof t.name=="string"&&q.isUri(t.location)&&q.isUri(t.globalStorageHome)&&q.isUri(t.settingsResource)&&q.isUri(t.keybindingsResource)&&q.isUri(t.tasksResource)&&q.isUri(t.snippetsHome)&&q.isUri(t.extensionsResource))}var Dv=$("IUserDataProfilesService");function hl(r,t){return{id:r.id,isDefault:r.isDefault,name:r.name,shortName:r.shortName,icon:r.icon,location:q.revive(r.location).with({scheme:t}),globalStorageHome:q.revive(r.globalStorageHome).with({scheme:t}),settingsResource:q.revive(r.settingsResource).with({scheme:t}),keybindingsResource:q.revive(r.keybindingsResource).with({scheme:t}),tasksResource:q.revive(r.tasksResource).with({scheme:t}),snippetsHome:q.revive(r.snippetsHome).with({scheme:t}),extensionsResource:q.revive(r.extensionsResource).with({scheme:t}),cacheHome:q.revive(r.cacheHome).with({scheme:t}),useDefaultFlags:r.useDefaultFlags,isTransient:r.isTransient}}function wL(r,t,e,i,n,o){return{id:r,name:t,location:e,isDefault:!1,shortName:n?.shortName,icon:n?.icon,globalStorageHome:o&&n?.useDefaultFlags?.globalState?o.globalStorageHome:Ot(e,"globalStorage"),settingsResource:o&&n?.useDefaultFlags?.settings?o.settingsResource:Ot(e,"settings.json"),keybindingsResource:o&&n?.useDefaultFlags?.keybindings?o.keybindingsResource:Ot(e,"keybindings.json"),tasksResource:o&&n?.useDefaultFlags?.tasks?o.tasksResource:Ot(e,"tasks.json"),snippetsHome:o&&n?.useDefaultFlags?.snippets?o.snippetsHome:Ot(e,"snippets"),extensionsResource:o&&n?.useDefaultFlags?.extensions?o.extensionsResource:Ot(e,"extensions.json"),cacheHome:Ot(i,r),useDefaultFlags:n?.useDefaultFlags,isTransient:n?.transient}}var EL=class extends L{constructor(e,i,n,o){super();this.environmentService=e;this.fileService=i;this.uriIdentityService=n;this.logService=o;this.profilesHome=Ot(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=Ot(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new T);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new T);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new T);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new T);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new Ci,workspaces:new Ci,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(e){this.enabled!==e&&(this._profilesObject=void 0,this.enabled=e)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let e=this.createDefaultProfile(),i=[e];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!si(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}i.push(wL(Tr(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},e))}}catch(s){this.logService.error(s)}let n=new Ci,o=new Map;if(i.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let d=q.parse(a),c=i.find(u=>u.id===l);c&&n.set(d,c)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let d=i.find(c=>c.id===l);d&&o.set(a,d)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:i,workspaces:n,emptyWindows:o}}return this._profilesObject}createDefaultProfile(){let e=wL("__default__profile__",h("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:!0}}async createTransientProfile(e){let i="Temp",n=new RegExp(`${Jr(i)}\\s(\\d+)`),o=0;for(let a of this.profiles){let l=n.exec(a.name),d=l?parseInt(l[1]):0;o=d>o?d:o}let s=`${i} ${o+1}`;return this.createProfile(Xn(zr()).toString(16),s,{transient:!0},e)}async createNamedProfile(e,i,n){return this.createProfile(Xn(zr()).toString(16),e,i,n)}async createProfile(e,i,n,o){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(e,i,n);return o&&await this.setProfileForWorkspace(o,s),s}async doCreateProfile(e,i,n){if(!si(i)||!i)throw new Error("Name of the profile is mandatory and must be of type `string`");let o=this.profileCreationPromises.get(i);return o||(o=(async()=>{try{if(this.profiles.find(d=>d.name===i||d.id===e))throw new Error(`Profile with ${i} name already exists`);let a=wL(e,i,Ot(this.profilesHome,e),this.profilesCacheHome,n,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(d){l.push(d)}}),await Vi.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(i)}})(),this.profileCreationPromises.set(i,o)),o}async updateProfile(e,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let n=this.profiles.find(o=>o.id===e.id);if(!n)throw new Error(`Profile '${e.name}' does not exist`);return n=wL(n.id,i.name??n.name,n.location,this.profilesCacheHome,{shortName:i.shortName??n.shortName,icon:i.icon===null?void 0:i.icon??n.icon,transient:i.transient??n.isTransient,useDefaultFlags:i.useDefaultFlags??n.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[n]),n}async removeProfile(e){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(e.isDefault)throw new Error("Cannot remove default profile");let i=this.profiles.find(o=>o.id===e.id);if(!i)throw new Error(`Profile '${e.name}' does not exist`);let n=[];this._onWillRemoveProfile.fire({profile:i,join(o){n.push(o)}});try{await Promise.allSettled(n)}catch(o){this.logService.error(o)}for(let o of[...this.profilesObject.emptyWindows.keys()])i.id===this.profilesObject.emptyWindows.get(o)?.id&&this.profilesObject.emptyWindows.delete(o);for(let o of[...this.profilesObject.workspaces.keys()])i.id===this.profilesObject.workspaces.get(o)?.id&&this.profilesObject.workspaces.delete(o);this.updateStoredProfileAssociations(),this.updateProfiles([],[i],[]);try{await this.fileService.del(i.cacheHome,{recursive:!0})}catch(o){vw(o)!==1&&this.logService.error(o)}}async setProfileForWorkspace(e,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let n=this.profiles.find(o=>o.id===i.id);if(!n)throw new Error(`Profile '${i.name}' does not exist`);this.updateWorkspaceAssociation(e,n)}unsetWorkspace(e,i){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(e,void 0,i)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let e=await this.fileService.resolve(this.profilesHome);await Promise.all((e.children||[]).filter(i=>i.isDirectory&&this.profiles.every(n=>!this.uriIdentityService.extUri.isEqual(n.location,i.resource))).map(i=>this.fileService.del(i.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let e=this.transientProfilesObject.profiles.filter(i=>!this.isProfileAssociatedToWorkspace(i));await Promise.allSettled(e.map(i=>this.removeProfile(i)))}getProfileForWorkspace(e){let i=this.getWorkspace(e),n=q.isUri(i)?this.profilesObject.workspaces.get(i):this.profilesObject.emptyWindows.get(i);return n||(dl(e)?this.transientProfilesObject.folders.get(e.uri):$u(e)?this.transientProfilesObject.workspaces.get(e.configPath):this.transientProfilesObject.emptyWindows.get(e.id))}getWorkspace(e){return dl(e)?e.uri:$u(e)?e.configPath:e.id}isProfileAssociatedToWorkspace(e){return!!([...this.profilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.profilesObject.workspaces.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.transientProfilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.transientProfilesObject.workspaces.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.transientProfilesObject.folders.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location)))}updateProfiles(e,i,n){let o=[...this.profiles,...e],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of o){if(l.isDefault||i.some(c=>l.id===c.id))continue;l=n.find(c=>l.id===c.id)??l;let d=a.find(c=>l.id===c.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(d){for(let[c,u]of this.transientProfilesObject.emptyWindows.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:c},l);break}for(let[c,u]of this.transientProfilesObject.workspaces.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},l);break}for(let[c,u]of this.transientProfilesObject.folders.entries())if(l.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(e,i,n)}triggerProfilesChanges(e,i,n){this._onDidChangeProfiles.fire({added:e,removed:i,updated:n,all:this.profiles})}updateWorkspaceAssociation(e,i,n){if(n=i?.isTransient?!0:n,n)dl(e)?(this.transientProfilesObject.folders.delete(e.uri),i&&this.transientProfilesObject.folders.set(e.uri,i)):$u(e)?(this.transientProfilesObject.workspaces.delete(e.configPath),i&&this.transientProfilesObject.workspaces.set(e.configPath,i)):(this.transientProfilesObject.emptyWindows.delete(e.id),i&&this.transientProfilesObject.emptyWindows.set(e.id,i));else{this.updateWorkspaceAssociation(e,void 0,!0);let o=this.getWorkspace(e);q.isUri(o)?(this.profilesObject.workspaces.delete(o),i&&this.profilesObject.workspaces.set(o,i)):(this.profilesObject.emptyWindows.delete(o),i&&this.profilesObject.emptyWindows.set(o,i)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let e={};for(let[n,o]of this.profilesObject.workspaces.entries())e[n.toString()]=o.id;let i={};for(let[n,o]of this.profilesObject.emptyWindows.entries())i[n.toString()]=o.id;this.saveStoredProfileAssociations({workspaces:e,emptyWindows:i}),this._profilesObject=void 0}migrateStoredProfileAssociations(e){let i={},n=this.createDefaultProfile();if(e.workspaces)for(let[s,a]of Object.entries(e.workspaces)){let l=q.parse(a);i[s]=this.uriIdentityService.extUri.isEqual(l,n.location)?n.id:this.uriIdentityService.extUri.basename(l)}let o={};if(e.emptyWindows)for(let[s,a]of Object.entries(e.emptyWindows)){let l=q.parse(a);o[s]=this.uriIdentityService.extUri.isEqual(l,n.location)?n.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:i,emptyWindows:o}}getStoredProfiles(){return[]}saveStoredProfiles(e){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};EL=_([v(0,tr),v(1,ai),v(2,_r),v(3,Gt)],EL);var Lv={WIDTH:400,WIDTH_WITH_VERTICAL_PANEL:600,HEIGHT:270};function na(r){let t=Dr(r),e=r.getValue("window.menuBarVisibility");return e==="default"||t&&e==="compact"||be&&Pi?"classic":e}function np(r,t){return!0}function Dr(r,t){return t||(t=Nw(r)),t==="native"}function Nw(r){if(wt)return"custom";let t=r.getValue("window");if(t){if(be&&t.nativeTabs===!0||be&&t.nativeFullScreen===!1)return"native";let n=t.titleBarStyle;if(n==="native"||n==="custom")return n}return _t?"native":"custom"}var bq=35;function vq(r){if(be||wt||Dr(r))return!1;if(_t){let t=r.getValue("window.experimentalControlOverlay");if(typeof t=="boolean")return t}return!0}function yq(r=0){return Math.pow(1.2,r)}function Av(r){switch(r.type){case"light":return Y.fromHex("#F3F3F3");case"hcLight":return Y.fromHex("#FFFFFF");case"hcDark":return Y.fromHex("#000000");default:return Y.fromHex("#252526")}}var RL=x("tab.activeBackground",Js,h("tabActiveBackground","Active tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Sq=x("tab.unfocusedActiveBackground",RL,h("tabUnfocusedActiveBackground","Active tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),MV=x("tab.inactiveBackground",{dark:"#2D2D2D",light:"#ECECEC",hcDark:null,hcLight:null},h("tabInactiveBackground","Inactive tab background color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),wq=x("tab.unfocusedInactiveBackground",MV,h("tabUnfocusedInactiveBackground","Inactive tab background color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),op=x("tab.activeForeground",{dark:Y.white,light:"#333333",hcDark:Y.white,hcLight:"#292929"},h("tabActiveForeground","Active tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Iq=x("tab.inactiveForeground",{dark:Fe(op,.5),light:Fe(op,.7),hcDark:Y.white,hcLight:"#292929"},h("tabInactiveForeground","Inactive tab foreground color in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Eq=x("tab.unfocusedActiveForeground",{dark:Fe(op,.5),light:Fe(op,.7),hcDark:Y.white,hcLight:"#292929"},h("tabUnfocusedActiveForeground","Active tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),P_e=x("tab.unfocusedInactiveForeground",{dark:Fe(Iq,.5),light:Fe(Iq,.5),hcDark:Y.white,hcLight:"#292929"},h("tabUnfocusedInactiveForeground","Inactive tab foreground color in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),xL=x("tab.hoverBackground",null,h("tabHoverBackground","Tab background color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Tq=x("tab.unfocusedHoverBackground",{dark:Fe(xL,.5),light:Fe(xL,.7),hcDark:null,hcLight:null},h("tabUnfocusedHoverBackground","Tab background color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),_L=x("tab.hoverForeground",null,h("tabHoverForeground","Tab foreground color when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),xq=x("tab.unfocusedHoverForeground",{dark:Fe(_L,.5),light:Fe(_L,.5),hcDark:null,hcLight:null},h("tabUnfocusedHoverForeground","Tab foreground color in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),AL=x("tab.border",{dark:"#252526",light:"#F3F3F3",hcDark:Le,hcLight:Le},h("tabBorder","Border to separate tabs from each other. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),_q=x("tab.lastPinnedBorder",{dark:_v,light:_v,hcDark:Le,hcLight:Le},h("lastPinnedTabBorder","Border to separate pinned tabs from other tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),DL=x("tab.activeBorder",null,h("tabActiveBorder","Border on the bottom of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Dq=x("tab.unfocusedActiveBorder",{dark:Fe(DL,.5),light:Fe(DL,.7),hcDark:null,hcLight:null},h("tabActiveUnfocusedBorder","Border on the bottom of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Fw=x("tab.activeBorderTop",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},h("tabActiveBorderTop","Border to the top of an active tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Lq=x("tab.unfocusedActiveBorderTop",{dark:Fe(Fw,.5),light:Fe(Fw,.7),hcDark:null,hcLight:"#B5200D"},h("tabActiveUnfocusedBorderTop","Border to the top of an active tab in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),kq=x("tab.selectedBorderTop",Fw,h("tabSelectedBorderTop","Border to the top of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),M_e=x("tab.selectedBackground",RL,h("tabSelectedBackground","Background of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),O_e=x("tab.selectedForeground",op,h("tabSelectedForeground","Foreground of a selected tab. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),LL=x("tab.hoverBorder",null,h("tabHoverBorder","Border to highlight tabs when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Rq=x("tab.unfocusedHoverBorder",{dark:Fe(LL,.5),light:Fe(LL,.7),hcDark:null,hcLight:Le},h("tabUnfocusedHoverBorder","Border to highlight tabs in an unfocused group when hovering. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),N_e=x("tab.dragAndDropBorder",{dark:op,light:op,hcDark:oi,hcLight:oi},h("tabDragAndDropBorder","Border between tabs to indicate that a tab can be inserted between two tabs. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),kv=x("tab.activeModifiedBorder",{dark:"#3399CC",light:"#33AAEE",hcDark:null,hcLight:Le},h("tabActiveModifiedBorder","Border on the top of modified active tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),kL=x("tab.inactiveModifiedBorder",{dark:Fe(kv,.5),light:Fe(kv,.5),hcDark:Y.white,hcLight:Le},h("tabInactiveModifiedBorder","Border on the top of modified inactive tabs in an active group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Aq=x("tab.unfocusedActiveModifiedBorder",{dark:Fe(kv,.5),light:Fe(kv,.7),hcDark:Y.white,hcLight:Le},h("unfocusedActiveModifiedBorder","Border on the top of modified active tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),Pq=x("tab.unfocusedInactiveModifiedBorder",{dark:Fe(kL,.5),light:Fe(kL,.5),hcDark:Y.white,hcLight:Le},h("unfocusedINactiveModifiedBorder","Border on the top of modified inactive tabs in an unfocused group. Tabs are the containers for editors in the editor area. Multiple tabs can be opened in one editor group. There can be multiple editor groups.")),F_e=x("editorPane.background",Js,h("editorPaneBackground","Background color of the editor pane visible on the left and right side of the centered editor layout.")),B_e=x("editorGroup.emptyBackground",null,h("editorGroupEmptyBackground","Background color of an empty editor group. Editor groups are the containers of editors.")),V_e=x("editorGroup.focusedEmptyBorder",{dark:null,light:null,hcDark:ir,hcLight:ir},h("editorGroupFocusedEmptyBorder","Border color of an empty editor group that is focused. Editor groups are the containers of editors.")),Mq=x("editorGroupHeader.tabsBackground",{dark:"#252526",light:"#F3F3F3",hcDark:null,hcLight:null},h("tabsContainerBackground","Background color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),Oq=x("editorGroupHeader.tabsBorder",null,h("tabsContainerBorder","Border color of the editor group title header when tabs are enabled. Editor groups are the containers of editors.")),W_e=x("editorGroupHeader.noTabsBackground",Js,h("editorGroupHeaderBackground",'Background color of the editor group title header when (`"workbench.editor.showTabs": "single"`). Editor groups are the containers of editors.')),U_e=x("editorGroupHeader.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("editorTitleContainerBorder","Border color of the editor group title header. Editor groups are the containers of editors.")),Nq=x("editorGroup.border",{dark:"#444444",light:"#E7E7E7",hcDark:Le,hcLight:Le},h("editorGroupBorder","Color to separate multiple editor groups from each other. Editor groups are the containers of editors.")),Pv=x("editorGroup.dropBackground",{dark:Y.fromHex("#53595D").transparent(.5),light:Y.fromHex("#2677CB").transparent(.18),hcDark:null,hcLight:Y.fromHex("#0F4A85").transparent(.5)},h("editorDragAndDropBackground","Background color when dragging editors around. The color should have transparency so that the editor contents can still shine through.")),H_e=x("editorGroup.dropIntoPromptForeground",Sc,h("editorDropIntoPromptForeground","Foreground color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),z_e=x("editorGroup.dropIntoPromptBackground",nr,h("editorDropIntoPromptBackground","Background color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),K_e=x("editorGroup.dropIntoPromptBorder",{dark:null,light:null,hcDark:Le,hcLight:Le},h("editorDropIntoPromptBorder","Border color of text shown over editors when dragging files. This text informs the user that they can hold shift to drop into the editor.")),Fq=x("sideBySideEditor.horizontalBorder",Nq,h("sideBySideEditor.horizontalBorder","Color to separate two editors from each other when shown side by side in an editor group from top to bottom.")),Bq=x("sideBySideEditor.verticalBorder",Nq,h("sideBySideEditor.verticalBorder","Color to separate two editors from each other when shown side by side in an editor group from left to right.")),Fg=x("panel.background",Js,h("panelBackground","Panel background color. Panels are shown below the editor area and contain views like output and integrated terminal.")),PL=x("panel.border",{dark:Y.fromHex("#808080").transparent(.35),light:Y.fromHex("#808080").transparent(.35),hcDark:Le,hcLight:Le},h("panelBorder","Panel border color to separate the panel from the editor. Panels are shown below the editor area and contain views like output and integrated terminal.")),rp=x("panelTitle.activeForeground",{dark:"#E7E7E7",light:"#424242",hcDark:Y.white,hcLight:Cc},h("panelActiveTitleForeground","Title color for the active panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),ML=x("panelTitle.inactiveForeground",{dark:Fe(rp,.6),light:Fe(rp,.75),hcDark:Y.white,hcLight:Cc},h("panelInactiveTitleForeground","Title color for the inactive panel. Panels are shown below the editor area and contain views like output and integrated terminal.")),OL=x("panelTitle.activeBorder",{dark:rp,light:rp,hcDark:Le,hcLight:"#B5200D"},h("panelActiveTitleBorder","Border color for the active panel title. Panels are shown below the editor area and contain views like output and integrated terminal.")),G_e=x("panelInput.border",{dark:Tv,light:Y.fromHex("#ddd"),hcDark:Tv,hcLight:Tv},h("panelInputBorder","Input box border for inputs in the panel.")),NL=x("panel.dropBorder",rp,h("panelDragAndDropBorder","Drag and drop feedback color for the panel titles. Panels are shown below the editor area and contain views like output and integrated terminal.")),OV=x("panelSection.dropBackground",Pv,h("panelSectionDragAndDropBackground","Drag and drop feedback color for the panel sections. The color should have transparency so that the panel sections can still shine through. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Vq=x("panelSectionHeader.background",{dark:Y.fromHex("#808080").transparent(.2),light:Y.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},h("panelSectionHeaderBackground","Panel section header background color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Wq=x("panelSectionHeader.foreground",null,h("panelSectionHeaderForeground","Panel section header foreground color. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Uq=x("panelSectionHeader.border",Le,h("panelSectionHeaderBorder","Panel section header border color used when multiple views are stacked vertically in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),Hq=x("panelSection.border",PL,h("panelSectionBorder","Panel section border color used when multiple views are stacked horizontally in the panel. Panels are shown below the editor area and contain views like output and integrated terminal. Panel sections are views nested within the panels.")),zq=x("panelStickyScroll.background",Fg,h("panelStickyScrollBackground","Background color of sticky scroll in the panel.")),Kq=x("panelStickyScroll.border",null,h("panelStickyScrollBorder","Border color of sticky scroll in the panel.")),Gq=x("panelStickyScroll.shadow",Oh,h("panelStickyScrollShadow","Shadow color of sticky scroll in the panel.")),Uoe=x("outputView.background",null,h("outputViewBackground","Output view background color."));x("outputViewStickyScroll.background",Uoe,h("outputViewStickyScrollBackground","Output view sticky scroll background color."));var q_e=x("banner.background",{dark:or,light:Hr(or,.3),hcDark:or,hcLight:or},h("banner.background","Banner background color. The banner is shown under the title bar of the window.")),j_e=x("banner.foreground",ta,h("banner.foreground","Banner foreground color. The banner is shown under the title bar of the window.")),$_e=x("banner.iconForeground",ea,h("banner.iconForeground","Banner icon color. The banner is shown under the title bar of the window.")),wc=x("statusBar.foreground",{dark:"#FFFFFF",light:"#FFFFFF",hcDark:"#FFFFFF",hcLight:Cc},h("statusBarForeground","Status bar foreground color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),qq=x("statusBar.noFolderForeground",wc,h("statusBarNoFolderForeground","Status bar foreground color when no folder is opened. The status bar is shown in the bottom of the window.")),jq=x("statusBar.background",{dark:"#007ACC",light:"#007ACC",hcDark:null,hcLight:null},h("statusBarBackground","Status bar background color when a workspace or folder is opened. The status bar is shown in the bottom of the window.")),$q=x("statusBar.noFolderBackground",{dark:"#68217A",light:"#68217A",hcDark:null,hcLight:null},h("statusBarNoFolderBackground","Status bar background color when no folder is opened. The status bar is shown in the bottom of the window.")),NV=x("statusBar.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("statusBarBorder","Status bar border color separating to the sidebar and editor. The status bar is shown in the bottom of the window.")),Yq=x("statusBar.focusBorder",{dark:wc,light:wc,hcDark:null,hcLight:wc},h("statusBarFocusBorder","Status bar border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),Zq=x("statusBar.noFolderBorder",NV,h("statusBarNoFolderBorder","Status bar border color separating to the sidebar and editor when no folder is opened. The status bar is shown in the bottom of the window.")),Y_e=x("statusBarItem.activeBackground",{dark:Y.white.transparent(.18),light:Y.white.transparent(.18),hcDark:Y.white.transparent(.18),hcLight:Y.black.transparent(.18)},h("statusBarItemActiveBackground","Status bar item background color when clicking. The status bar is shown in the bottom of the window.")),Xq=x("statusBarItem.focusBorder",{dark:wc,light:wc,hcDark:null,hcLight:oi},h("statusBarItemFocusBorder","Status bar item border color when focused on keyboard navigation. The status bar is shown in the bottom of the window.")),Ec=x("statusBarItem.hoverBackground",{dark:Y.white.transparent(.12),light:Y.white.transparent(.12),hcDark:Y.white.transparent(.12),hcLight:Y.black.transparent(.12)},h("statusBarItemHoverBackground","Status bar item background color when hovering. The status bar is shown in the bottom of the window.")),Bw=x("statusBarItem.hoverForeground",wc,h("statusBarItemHoverForeground","Status bar item foreground color when hovering. The status bar is shown in the bottom of the window.")),Qq=x("statusBarItem.compactHoverBackground",{dark:Y.white.transparent(.2),light:Y.white.transparent(.2),hcDark:Y.white.transparent(.2),hcLight:Y.black.transparent(.2)},h("statusBarItemCompactHoverBackground","Status bar item background color when hovering an item that contains two hovers. The status bar is shown in the bottom of the window.")),Z_e=x("statusBarItem.prominentForeground",wc,h("statusBarProminentItemForeground","Status bar prominent items foreground color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),X_e=x("statusBarItem.prominentBackground",Y.black.transparent(.5),h("statusBarProminentItemBackground","Status bar prominent items background color. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),Q_e=x("statusBarItem.prominentHoverForeground",Bw,h("statusBarProminentItemHoverForeground","Status bar prominent items foreground color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),J_e=x("statusBarItem.prominentHoverBackground",{dark:Y.black.transparent(.3),light:Y.black.transparent(.3),hcDark:Y.black.transparent(.3),hcLight:null},h("statusBarProminentItemHoverBackground","Status bar prominent items background color when hovering. Prominent items stand out from other status bar entries to indicate importance. The status bar is shown in the bottom of the window.")),eDe=x("statusBarItem.errorBackground",{dark:Hr(gV,.4),light:Hr(gV,.4),hcDark:null,hcLight:"#B5200D"},h("statusBarErrorItemBackground","Status bar error items background color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),tDe=x("statusBarItem.errorForeground",Y.white,h("statusBarErrorItemForeground","Status bar error items foreground color. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),iDe=x("statusBarItem.errorHoverForeground",Bw,h("statusBarErrorItemHoverForeground","Status bar error items foreground color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),nDe=x("statusBarItem.errorHoverBackground",Ec,h("statusBarErrorItemHoverBackground","Status bar error items background color when hovering. Error items stand out from other status bar entries to indicate error conditions. The status bar is shown in the bottom of the window.")),oDe=x("statusBarItem.warningBackground",{dark:Hr(is,.4),light:Hr(is,.4),hcDark:null,hcLight:"#895503"},h("statusBarWarningItemBackground","Status bar warning items background color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),rDe=x("statusBarItem.warningForeground",Y.white,h("statusBarWarningItemForeground","Status bar warning items foreground color. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),sDe=x("statusBarItem.warningHoverForeground",Bw,h("statusBarWarningItemHoverForeground","Status bar warning items foreground color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),aDe=x("statusBarItem.warningHoverBackground",Ec,h("statusBarWarningItemHoverBackground","Status bar warning items background color when hovering. Warning items stand out from other status bar entries to indicate warning conditions. The status bar is shown in the bottom of the window.")),Jq=x("activityBar.background",{dark:"#333333",light:"#2C2C2C",hcDark:"#000000",hcLight:"#FFFFFF"},h("activityBarBackground","Activity bar background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),Vh=x("activityBar.foreground",{dark:Y.white,light:Y.white,hcDark:Y.white,hcLight:Cc},h("activityBarForeground","Activity bar item foreground color when it is active. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ej=x("activityBar.inactiveForeground",{dark:Fe(Vh,.4),light:Fe(Vh,.4),hcDark:Y.white,hcLight:Cc},h("activityBarInActiveForeground","Activity bar item foreground color when it is inactive. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),tj=x("activityBar.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("activityBarBorder","Activity bar border color separating to the side bar. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),FV=x("activityBar.activeBorder",{dark:Vh,light:Vh,hcDark:Le,hcLight:Le},h("activityBarActiveBorder","Activity bar border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ij=x("activityBar.activeFocusBorder",{dark:null,light:null,hcDark:null,hcLight:"#B5200D"},h("activityBarActiveFocusBorder","Activity bar focus border color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),BV=x("activityBar.activeBackground",null,h("activityBarActiveBackground","Activity bar background color for the active item. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),nj=x("activityBar.dropBorder",{dark:Vh,light:Vh,hcDark:null,hcLight:null},h("activityBarDragAndDropBorder","Drag and drop feedback color for the activity bar items. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),sd=x("activityBarBadge.background",{dark:"#007ACC",light:"#007ACC",hcDark:"#000000",hcLight:"#0F4A85"},h("activityBarBadgeBackground","Activity notification badge background color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),ad=x("activityBarBadge.foreground",Y.white,h("activityBarBadgeForeground","Activity notification badge foreground color. The activity bar is showing on the far left or right and allows to switch between views of the side bar.")),sp=x("activityBarTop.foreground",{dark:"#E7E7E7",light:"#424242",hcDark:Y.white,hcLight:Cc},h("activityBarTop","Active foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),FL=x("activityBarTop.activeBorder",{dark:sp,light:sp,hcDark:Le,hcLight:"#B5200D"},h("activityBarTopActiveFocusBorder","Focus border color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),lDe=x("activityBarTop.activeBackground",null,h("activityBarTopActiveBackground","Background color for the active item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),BL=x("activityBarTop.inactiveForeground",{dark:Fe(sp,.6),light:Fe(sp,.75),hcDark:Y.white,hcLight:Cc},h("activityBarTopInActiveForeground","Inactive foreground color of the item in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),VL=x("activityBarTop.dropBorder",sp,h("activityBarTopDragAndDropBorder","Drag and drop feedback color for the items in the Activity bar when it is on top / bottom. The activity allows to switch between views of the side bar.")),dDe=x("activityBarTop.background",null,h("activityBarTopBackground","Background color of the activity bar when set to top / bottom.")),cDe=x("profileBadge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:Y.white,hcLight:Y.black},h("profileBadgeBackground","Profile badge background color. The profile badge shows on top of the settings gear icon in the activity bar.")),uDe=x("profileBadge.foreground",{dark:Y.white,light:"#333333",hcDark:Y.black,hcLight:Y.white},h("profileBadgeForeground","Profile badge foreground color. The profile badge shows on top of the settings gear icon in the activity bar.")),pDe=x("statusBarItem.remoteBackground",sd,h("statusBarItemHostBackground","Background color for the remote indicator on the status bar.")),Hoe=x("statusBarItem.remoteForeground",ad,h("statusBarItemHostForeground","Foreground color for the remote indicator on the status bar.")),hDe=x("statusBarItem.remoteHoverForeground",Bw,h("statusBarRemoteItemHoverForeground","Foreground color for the remote indicator on the status bar when hovering.")),mDe=x("statusBarItem.remoteHoverBackground",{dark:Ec,light:Ec,hcDark:Ec,hcLight:null},h("statusBarRemoteItemHoverBackground","Background color for the remote indicator on the status bar when hovering.")),gDe=x("statusBarItem.offlineBackground","#6c1717",h("statusBarItemOfflineBackground","Status bar item background color when the workbench is offline.")),fDe=x("statusBarItem.offlineForeground",Hoe,h("statusBarItemOfflineForeground","Status bar item foreground color when the workbench is offline.")),bDe=x("statusBarItem.offlineHoverForeground",Bw,h("statusBarOfflineItemHoverForeground","Status bar item foreground hover color when the workbench is offline.")),vDe=x("statusBarItem.offlineHoverBackground",{dark:Ec,light:Ec,hcDark:Ec,hcLight:null},h("statusBarOfflineItemHoverBackground","Status bar item background hover color when the workbench is offline.")),yDe=x("extensionBadge.remoteBackground",sd,h("extensionBadge.remoteBackground","Background color for the remote badge in the extensions view.")),IDe=x("extensionBadge.remoteForeground",ad,h("extensionBadge.remoteForeground","Foreground color for the remote badge in the extensions view.")),gl=x("sideBar.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},h("sideBarBackground","Side bar background color. The side bar is the container for views like explorer and search.")),Mv=x("sideBar.foreground",null,h("sideBarForeground","Side bar foreground color. The side bar is the container for views like explorer and search.")),Ov=x("sideBar.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("sideBarBorder","Side bar border color on the side separating to the editor. The side bar is the container for views like explorer and search.")),CDe=x("sideBarTitle.background",gl,h("sideBarTitleBackground","Side bar title background color. The side bar is the container for views like explorer and search.")),oj=x("sideBarTitle.foreground",Mv,h("sideBarTitleForeground","Side bar title foreground color. The side bar is the container for views like explorer and search.")),Vw=x("sideBar.dropBackground",Pv,h("sideBarDragAndDropBackground","Drag and drop feedback color for the side bar sections. The color should have transparency so that the side bar sections can still shine through. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),rj=x("sideBarSectionHeader.background",{dark:Y.fromHex("#808080").transparent(.2),light:Y.fromHex("#808080").transparent(.2),hcDark:null,hcLight:null},h("sideBarSectionHeaderBackground","Side bar section header background color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),sj=x("sideBarSectionHeader.foreground",Mv,h("sideBarSectionHeaderForeground","Side bar section header foreground color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),VV=x("sideBarSectionHeader.border",Le,h("sideBarSectionHeaderBorder","Side bar section header border color. The side bar is the container for views like explorer and search. Side bar sections are views nested within the side bar.")),SDe=x("sideBarActivityBarTop.border",VV,h("sideBarActivityBarTopBorder","Border color between the activity bar at the top/bottom and the views.")),aj=x("sideBarStickyScroll.background",gl,h("sideBarStickyScrollBackground","Background color of sticky scroll in the side bar.")),lj=x("sideBarStickyScroll.border",null,h("sideBarStickyScrollBorder","Border color of sticky scroll in the side bar.")),dj=x("sideBarStickyScroll.shadow",Oh,h("sideBarStickyScrollShadow","Shadow color of sticky scroll in the side bar.")),ml=x("titleBar.activeForeground",{dark:"#CCCCCC",light:"#333333",hcDark:"#FFFFFF",hcLight:"#292929"},h("titleBarActiveForeground","Title bar foreground when the window is active.")),WL=x("titleBar.inactiveForeground",{dark:Fe(ml,.6),light:Fe(ml,.6),hcDark:null,hcLight:"#292929"},h("titleBarInactiveForeground","Title bar foreground when the window is inactive.")),Rv=x("titleBar.activeBackground",{dark:"#3C3C3C",light:"#DDDDDD",hcDark:"#000000",hcLight:"#FFFFFF"},h("titleBarActiveBackground","Title bar background when the window is active.")),cj=x("titleBar.inactiveBackground",{dark:Fe(Rv,.6),light:Fe(Rv,.6),hcDark:null,hcLight:null},h("titleBarInactiveBackground","Title bar background when the window is inactive.")),uj=x("titleBar.border",{dark:null,light:null,hcDark:Le,hcLight:Le},h("titleBarBorder","Title bar border color.")),zoe=x("menubar.selectionForeground",ml,h("menubarSelectionForeground","Foreground color of the selected menu item in the menubar.")),Cq=x("menubar.selectionBackground",{dark:Aw,light:Aw,hcDark:null,hcLight:null},h("menubarSelectionBackground","Background color of the selected menu item in the menubar.")),wDe=x("menubar.selectionBorder",{dark:null,light:null,hcDark:oi,hcLight:oi},h("menubarSelectionBorder","Border color of the selected menu item in the menubar.")),EDe=x("commandCenter.foreground",ml,h("commandCenter-foreground","Foreground color of the command center"),!1),TDe=x("commandCenter.activeForeground",zoe,h("commandCenter-activeForeground","Active foreground color of the command center"),!1),xDe=x("commandCenter.inactiveForeground",WL,h("commandCenter-inactiveForeground","Foreground color of the command center when the window is inactive"),!1),_De=x("commandCenter.background",{dark:Y.white.transparent(.05),hcDark:null,light:Y.black.transparent(.05),hcLight:null},h("commandCenter-background","Background color of the command center"),!1),DDe=x("commandCenter.activeBackground",{dark:Y.white.transparent(.08),hcDark:Cq,light:Y.black.transparent(.08),hcLight:Cq},h("commandCenter-activeBackground","Active background color of the command center"),!1),LDe=x("commandCenter.border",{dark:Fe(ml,.2),hcDark:Le,light:Fe(ml,.2),hcLight:Le},h("commandCenter-border","Border color of the command center"),!1),kDe=x("commandCenter.activeBorder",{dark:Fe(ml,.3),hcDark:ml,light:Fe(ml,.3),hcLight:ml},h("commandCenter-activeBorder","Active border color of the command center"),!1),RDe=x("commandCenter.inactiveBorder",Fe(WL,.25),h("commandCenter-inactiveBorder","Border color of the command center when the window is inactive"),!1),pj=x("notificationCenter.border",{dark:Og,light:Og,hcDark:Le,hcLight:Le},h("notificationCenterBorder","Notifications center border color. Notifications slide in from the bottom right of the window.")),hj=x("notificationToast.border",{dark:Og,light:Og,hcDark:Le,hcLight:Le},h("notificationToastBorder","Notification toast border color. Notifications slide in from the bottom right of the window.")),ADe=x("notifications.foreground",Sc,h("notificationsForeground","Notifications foreground color. Notifications slide in from the bottom right of the window.")),Bh=x("notifications.background",nr,h("notificationsBackground","Notifications background color. Notifications slide in from the bottom right of the window.")),PDe=x("notificationLink.foreground",mL,h("notificationsLink","Notification links foreground color. Notifications slide in from the bottom right of the window.")),mj=x("notificationCenterHeader.foreground",null,h("notificationCenterHeaderForeground","Notifications center header foreground color. Notifications slide in from the bottom right of the window.")),WV=x("notificationCenterHeader.background",{dark:ts(Bh,.3),light:Hr(Bh,.05),hcDark:Bh,hcLight:Bh},h("notificationCenterHeaderBackground","Notifications center header background color. Notifications slide in from the bottom right of the window.")),MDe=x("notifications.border",WV,h("notificationsBorder","Notifications border color separating from other notifications in the notifications center. Notifications slide in from the bottom right of the window.")),ODe=x("notificationsErrorIcon.foreground",Mg,h("notificationsErrorIconForeground","The color used for the icon of error notifications. Notifications slide in from the bottom right of the window.")),NDe=x("notificationsWarningIcon.foreground",is,h("notificationsWarningIconForeground","The color used for the icon of warning notifications. Notifications slide in from the bottom right of the window.")),FDe=x("notificationsInfoIcon.foreground",ea,h("notificationsInfoIconForeground","The color used for the icon of info notifications. Notifications slide in from the bottom right of the window.")),gj=x("window.activeBorder",{dark:null,light:null,hcDark:Le,hcLight:Le},h("windowActiveBorder","The color used for the border of the window when it is active. Only supported in the macOS and Linux desktop client when using the custom title bar.")),fj=x("window.inactiveBorder",{dark:null,light:null,hcDark:Le,hcLight:Le},h("windowInactiveBorder","The color used for the border of the window when it is inactive. Only supported in the macOS and Linux desktop client when using the custom title bar."));function UL(r,t){let e=r;typeof e.vscodeWindowId!="number"&&Object.defineProperty(e,"vscodeWindowId",{get:()=>t})}var ne=window;function HL(r){return r===ne?!1:typeof r?.vscodeWindowId=="number"}var Tc=class r{static INSTANCE=new r;mapWindowIdToZoomLevel=new Map;_onDidChangeZoomLevel=new T;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(t){return this.mapWindowIdToZoomLevel.get(this.getWindowId(t))??0}setZoomLevel(t,e){if(this.getZoomLevel(e)===t)return;let i=this.getWindowId(e);this.mapWindowIdToZoomLevel.set(i,t),this._onDidChangeZoomLevel.fire(i)}mapWindowIdToZoomFactor=new Map;getZoomFactor(t){return this.mapWindowIdToZoomFactor.get(this.getWindowId(t))??1}setZoomFactor(t,e){this.mapWindowIdToZoomFactor.set(this.getWindowId(e),t)}_onDidChangeFullscreen=new T;onDidChangeFullscreen=this._onDidChangeFullscreen.event;mapWindowIdToFullScreen=new Map;setFullscreen(t,e){if(this.isFullscreen(e)===t)return;let i=this.getWindowId(e);this.mapWindowIdToFullScreen.set(i,t),this._onDidChangeFullscreen.fire(i)}isFullscreen(t){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(t))}getWindowId(t){return t.vscodeWindowId}};function Koe(r,t,e){typeof t=="string"&&(t=r.matchMedia(t)),t.addEventListener("change",e)}function bj(r,t){Tc.INSTANCE.setZoomLevel(r,t)}function Wh(r){return Tc.INSTANCE.getZoomLevel(r)}var vj=Tc.INSTANCE.onDidChangeZoomLevel;function ap(r){return Tc.INSTANCE.getZoomFactor(r)}function yj(r,t){Tc.INSTANCE.setZoomFactor(r,t)}function Bg(r,t){Tc.INSTANCE.setFullscreen(r,t)}function ld(r){return Tc.INSTANCE.isFullscreen(r)}var Nv=Tc.INSTANCE.onDidChangeFullscreen,Fv=navigator.userAgent,dn=Fv.indexOf("Firefox")>=0,dd=Fv.indexOf("AppleWebKit")>=0,xc=Fv.indexOf("Chrome")>=0,Eo=!xc&&Fv.indexOf("Safari")>=0,Ij=!xc&&!Eo&&dd,zDe=Fv.indexOf("Electron/")>=0,UV=Fv.indexOf("Android")>=0,zL=!1;if(typeof ne.matchMedia=="function"){let r=ne.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),t=ne.matchMedia("(display-mode: fullscreen)");zL=r.matches,Koe(ne,r,({matches:e})=>{zL&&t.matches||(zL=e)})}function KL(){return zL}function Vg(){return navigator?.windowControlsOverlay?.visible}function Cj(r){return r.navigator?.windowControlsOverlay?.getTitlebarAreaRect()}var Bv={clipboard:{writeText:Pi||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:Pi||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:Pi||KL()?0:navigator.keyboard||Eo?1:2,touch:"ontouchstart"in ne||navigator.maxTouchPoints>0,pointerEvents:ne.PointerEvent&&("ontouchstart"in ne||navigator.maxTouchPoints>0)};var Ww=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(t,e){this._keyCodeToStr[t]=e,this._strToKeyCode[e.toLowerCase()]=t}keyCodeToStr(t){return this._keyCodeToStr[t]}strToKeyCode(t){return this._strToKeyCode[t.toLowerCase()]||0}},GL=new Ww,HV=new Ww,zV=new Ww,GV=new Array(230),Goe={},Sj=[],wj=Object.create(null),Ej=Object.create(null),Uw={lowerCaseToEnum:r=>Ej[r]||0,toEnum:r=>wj[r]||0,toString:r=>Sj[r]||"None"},Tj=[],KV=[];for(let r=0;r<=193;r++)Tj[r]=-1;for(let r=0;r<=132;r++)KV[r]=-1;(function(){let r="",t=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",r,r],[1,1,"Hyper",0,r,0,r,r,r],[1,2,"Super",0,r,0,r,r,r],[1,3,"Fn",0,r,0,r,r,r],[1,4,"FnLock",0,r,0,r,r,r],[1,5,"Suspend",0,r,0,r,r,r],[1,6,"Resume",0,r,0,r,r,r],[1,7,"Turbo",0,r,0,r,r,r],[1,8,"Sleep",0,r,0,"VK_SLEEP",r,r],[1,9,"WakeUp",0,r,0,r,r,r],[0,10,"KeyA",31,"A",65,"VK_A",r,r],[0,11,"KeyB",32,"B",66,"VK_B",r,r],[0,12,"KeyC",33,"C",67,"VK_C",r,r],[0,13,"KeyD",34,"D",68,"VK_D",r,r],[0,14,"KeyE",35,"E",69,"VK_E",r,r],[0,15,"KeyF",36,"F",70,"VK_F",r,r],[0,16,"KeyG",37,"G",71,"VK_G",r,r],[0,17,"KeyH",38,"H",72,"VK_H",r,r],[0,18,"KeyI",39,"I",73,"VK_I",r,r],[0,19,"KeyJ",40,"J",74,"VK_J",r,r],[0,20,"KeyK",41,"K",75,"VK_K",r,r],[0,21,"KeyL",42,"L",76,"VK_L",r,r],[0,22,"KeyM",43,"M",77,"VK_M",r,r],[0,23,"KeyN",44,"N",78,"VK_N",r,r],[0,24,"KeyO",45,"O",79,"VK_O",r,r],[0,25,"KeyP",46,"P",80,"VK_P",r,r],[0,26,"KeyQ",47,"Q",81,"VK_Q",r,r],[0,27,"KeyR",48,"R",82,"VK_R",r,r],[0,28,"KeyS",49,"S",83,"VK_S",r,r],[0,29,"KeyT",50,"T",84,"VK_T",r,r],[0,30,"KeyU",51,"U",85,"VK_U",r,r],[0,31,"KeyV",52,"V",86,"VK_V",r,r],[0,32,"KeyW",53,"W",87,"VK_W",r,r],[0,33,"KeyX",54,"X",88,"VK_X",r,r],[0,34,"KeyY",55,"Y",89,"VK_Y",r,r],[0,35,"KeyZ",56,"Z",90,"VK_Z",r,r],[0,36,"Digit1",22,"1",49,"VK_1",r,r],[0,37,"Digit2",23,"2",50,"VK_2",r,r],[0,38,"Digit3",24,"3",51,"VK_3",r,r],[0,39,"Digit4",25,"4",52,"VK_4",r,r],[0,40,"Digit5",26,"5",53,"VK_5",r,r],[0,41,"Digit6",27,"6",54,"VK_6",r,r],[0,42,"Digit7",28,"7",55,"VK_7",r,r],[0,43,"Digit8",29,"8",56,"VK_8",r,r],[0,44,"Digit9",30,"9",57,"VK_9",r,r],[0,45,"Digit0",21,"0",48,"VK_0",r,r],[1,46,"Enter",3,"Enter",13,"VK_RETURN",r,r],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",r,r],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",r,r],[1,49,"Tab",2,"Tab",9,"VK_TAB",r,r],[1,50,"Space",10,"Space",32,"VK_SPACE",r,r],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,r,0,r,r,r],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",r,r],[1,64,"F1",59,"F1",112,"VK_F1",r,r],[1,65,"F2",60,"F2",113,"VK_F2",r,r],[1,66,"F3",61,"F3",114,"VK_F3",r,r],[1,67,"F4",62,"F4",115,"VK_F4",r,r],[1,68,"F5",63,"F5",116,"VK_F5",r,r],[1,69,"F6",64,"F6",117,"VK_F6",r,r],[1,70,"F7",65,"F7",118,"VK_F7",r,r],[1,71,"F8",66,"F8",119,"VK_F8",r,r],[1,72,"F9",67,"F9",120,"VK_F9",r,r],[1,73,"F10",68,"F10",121,"VK_F10",r,r],[1,74,"F11",69,"F11",122,"VK_F11",r,r],[1,75,"F12",70,"F12",123,"VK_F12",r,r],[1,76,"PrintScreen",0,r,0,r,r,r],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",r,r],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",r,r],[1,79,"Insert",19,"Insert",45,"VK_INSERT",r,r],[1,80,"Home",14,"Home",36,"VK_HOME",r,r],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",r,r],[1,82,"Delete",20,"Delete",46,"VK_DELETE",r,r],[1,83,"End",13,"End",35,"VK_END",r,r],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",r,r],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",r],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",r],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",r],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",r],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",r,r],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",r,r],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",r,r],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",r,r],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",r,r],[1,94,"NumpadEnter",3,r,0,r,r,r],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",r,r],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",r,r],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",r,r],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",r,r],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",r,r],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",r,r],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",r,r],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",r,r],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",r,r],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",r,r],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",r,r],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",r,r],[1,107,"ContextMenu",58,"ContextMenu",93,r,r,r],[1,108,"Power",0,r,0,r,r,r],[1,109,"NumpadEqual",0,r,0,r,r,r],[1,110,"F13",71,"F13",124,"VK_F13",r,r],[1,111,"F14",72,"F14",125,"VK_F14",r,r],[1,112,"F15",73,"F15",126,"VK_F15",r,r],[1,113,"F16",74,"F16",127,"VK_F16",r,r],[1,114,"F17",75,"F17",128,"VK_F17",r,r],[1,115,"F18",76,"F18",129,"VK_F18",r,r],[1,116,"F19",77,"F19",130,"VK_F19",r,r],[1,117,"F20",78,"F20",131,"VK_F20",r,r],[1,118,"F21",79,"F21",132,"VK_F21",r,r],[1,119,"F22",80,"F22",133,"VK_F22",r,r],[1,120,"F23",81,"F23",134,"VK_F23",r,r],[1,121,"F24",82,"F24",135,"VK_F24",r,r],[1,122,"Open",0,r,0,r,r,r],[1,123,"Help",0,r,0,r,r,r],[1,124,"Select",0,r,0,r,r,r],[1,125,"Again",0,r,0,r,r,r],[1,126,"Undo",0,r,0,r,r,r],[1,127,"Cut",0,r,0,r,r,r],[1,128,"Copy",0,r,0,r,r,r],[1,129,"Paste",0,r,0,r,r,r],[1,130,"Find",0,r,0,r,r,r],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",r,r],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",r,r],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",r,r],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",r,r],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",r,r],[1,136,"KanaMode",0,r,0,r,r,r],[0,137,"IntlYen",0,r,0,r,r,r],[1,138,"Convert",0,r,0,r,r,r],[1,139,"NonConvert",0,r,0,r,r,r],[1,140,"Lang1",0,r,0,r,r,r],[1,141,"Lang2",0,r,0,r,r,r],[1,142,"Lang3",0,r,0,r,r,r],[1,143,"Lang4",0,r,0,r,r,r],[1,144,"Lang5",0,r,0,r,r,r],[1,145,"Abort",0,r,0,r,r,r],[1,146,"Props",0,r,0,r,r,r],[1,147,"NumpadParenLeft",0,r,0,r,r,r],[1,148,"NumpadParenRight",0,r,0,r,r,r],[1,149,"NumpadBackspace",0,r,0,r,r,r],[1,150,"NumpadMemoryStore",0,r,0,r,r,r],[1,151,"NumpadMemoryRecall",0,r,0,r,r,r],[1,152,"NumpadMemoryClear",0,r,0,r,r,r],[1,153,"NumpadMemoryAdd",0,r,0,r,r,r],[1,154,"NumpadMemorySubtract",0,r,0,r,r,r],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",r,r],[1,156,"NumpadClearEntry",0,r,0,r,r,r],[1,0,r,5,"Ctrl",17,"VK_CONTROL",r,r],[1,0,r,4,"Shift",16,"VK_SHIFT",r,r],[1,0,r,6,"Alt",18,"VK_MENU",r,r],[1,0,r,57,"Meta",91,"VK_COMMAND",r,r],[1,157,"ControlLeft",5,r,0,"VK_LCONTROL",r,r],[1,158,"ShiftLeft",4,r,0,"VK_LSHIFT",r,r],[1,159,"AltLeft",6,r,0,"VK_LMENU",r,r],[1,160,"MetaLeft",57,r,0,"VK_LWIN",r,r],[1,161,"ControlRight",5,r,0,"VK_RCONTROL",r,r],[1,162,"ShiftRight",4,r,0,"VK_RSHIFT",r,r],[1,163,"AltRight",6,r,0,"VK_RMENU",r,r],[1,164,"MetaRight",57,r,0,"VK_RWIN",r,r],[1,165,"BrightnessUp",0,r,0,r,r,r],[1,166,"BrightnessDown",0,r,0,r,r,r],[1,167,"MediaPlay",0,r,0,r,r,r],[1,168,"MediaRecord",0,r,0,r,r,r],[1,169,"MediaFastForward",0,r,0,r,r,r],[1,170,"MediaRewind",0,r,0,r,r,r],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",r,r],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",r,r],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",r,r],[1,174,"Eject",0,r,0,r,r,r],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",r,r],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",r,r],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",r,r],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",r,r],[1,179,"LaunchApp1",0,r,0,"VK_MEDIA_LAUNCH_APP1",r,r],[1,180,"SelectTask",0,r,0,r,r,r],[1,181,"LaunchScreenSaver",0,r,0,r,r,r],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",r,r],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",r,r],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",r,r],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",r,r],[1,186,"BrowserStop",0,r,0,"VK_BROWSER_STOP",r,r],[1,187,"BrowserRefresh",0,r,0,"VK_BROWSER_REFRESH",r,r],[1,188,"BrowserFavorites",0,r,0,"VK_BROWSER_FAVORITES",r,r],[1,189,"ZoomToggle",0,r,0,r,r,r],[1,190,"MailReply",0,r,0,r,r,r],[1,191,"MailForward",0,r,0,r,r,r],[1,192,"MailSend",0,r,0,r,r,r],[1,0,r,114,"KeyInComposition",229,r,r,r],[1,0,r,116,"ABNT_C2",194,"VK_ABNT_C2",r,r],[1,0,r,96,"OEM_8",223,"VK_OEM_8",r,r],[1,0,r,0,r,0,"VK_KANA",r,r],[1,0,r,0,r,0,"VK_HANGUL",r,r],[1,0,r,0,r,0,"VK_JUNJA",r,r],[1,0,r,0,r,0,"VK_FINAL",r,r],[1,0,r,0,r,0,"VK_HANJA",r,r],[1,0,r,0,r,0,"VK_KANJI",r,r],[1,0,r,0,r,0,"VK_CONVERT",r,r],[1,0,r,0,r,0,"VK_NONCONVERT",r,r],[1,0,r,0,r,0,"VK_ACCEPT",r,r],[1,0,r,0,r,0,"VK_MODECHANGE",r,r],[1,0,r,0,r,0,"VK_SELECT",r,r],[1,0,r,0,r,0,"VK_PRINT",r,r],[1,0,r,0,r,0,"VK_EXECUTE",r,r],[1,0,r,0,r,0,"VK_SNAPSHOT",r,r],[1,0,r,0,r,0,"VK_HELP",r,r],[1,0,r,0,r,0,"VK_APPS",r,r],[1,0,r,0,r,0,"VK_PROCESSKEY",r,r],[1,0,r,0,r,0,"VK_PACKET",r,r],[1,0,r,0,r,0,"VK_DBE_SBCSCHAR",r,r],[1,0,r,0,r,0,"VK_DBE_DBCSCHAR",r,r],[1,0,r,0,r,0,"VK_ATTN",r,r],[1,0,r,0,r,0,"VK_CRSEL",r,r],[1,0,r,0,r,0,"VK_EXSEL",r,r],[1,0,r,0,r,0,"VK_EREOF",r,r],[1,0,r,0,r,0,"VK_PLAY",r,r],[1,0,r,0,r,0,"VK_ZOOM",r,r],[1,0,r,0,r,0,"VK_NONAME",r,r],[1,0,r,0,r,0,"VK_PA1",r,r],[1,0,r,0,r,0,"VK_OEM_CLEAR",r,r]],e=[],i=[];for(let n of t){let[o,s,a,l,d,c,u,p,m]=n;if(i[s]||(i[s]=!0,Sj[s]=a,wj[a]=s,Ej[a.toLowerCase()]=s,o&&(Tj[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(KV[l]=s))),!e[l]){if(e[l]=!0,!d)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);GL.define(l,d),HV.define(l,p||d),zV.define(l,m||p||d)}c&&(GV[c]=l),u&&(Goe[u]=l)}KV[3]=46})();var Hw;(s=>{function r(a){return GL.keyCodeToStr(a)}s.toString=r;function t(a){return GL.strToKeyCode(a)}s.fromString=t;function e(a){return HV.keyCodeToStr(a)}s.toUserSettingsUS=e;function i(a){return zV.keyCodeToStr(a)}s.toUserSettingsGeneral=i;function n(a){return HV.strToKeyCode(a)||zV.strToKeyCode(a)}s.fromUserSettings=n;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return GL.keyCodeToStr(a)}s.toElectronAccelerator=o})(Hw||={});function Kr(r,t){let e=(t&65535)<<16>>>0;return(r|e)>>>0}function qV(r,t){if(typeof r=="number"){if(r===0)return null;let e=(r&65535)>>>0,i=(r&4294901760)>>>16;return i!==0?new Vv([qL(e,t),qL(i,t)]):new Vv([qL(e,t)])}else{let e=[];for(let i=0;i<r.length;i++)e.push(qL(r[i],t));return new Vv(e)}}function qL(r,t){let e=!!(r&2048),i=!!(r&256),n=t===2?i:e,o=!!(r&1024),s=!!(r&512),a=t===2?e:i,l=r&255;return new zw(n,o,s,a,l)}var zw=class r{constructor(t,e,i,n,o){this.ctrlKey=t;this.shiftKey=e;this.altKey=i;this.metaKey=n;this.keyCode=o}equals(t){return t instanceof r&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){let t=this.ctrlKey?"1":"0",e=this.shiftKey?"1":"0",i=this.altKey?"1":"0",n=this.metaKey?"1":"0";return`K${t}${e}${i}${n}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new Vv([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}};var Vv=class{chords;constructor(t){if(t.length===0)throw dh("chords");this.chords=t}getHashCode(){let t="";for(let e=0,i=this.chords.length;e<i;e++)e!==0&&(t+=";"),t+=this.chords[e].getHashCode();return t}equals(t){if(t===null||this.chords.length!==t.chords.length)return!1;for(let e=0;e<this.chords.length;e++)if(!this.chords[e].equals(t.chords[e]))return!1;return!0}};function qoe(r){if(r.charCode){let e=String.fromCharCode(r.charCode).toUpperCase();return Hw.fromString(e)}let t=r.keyCode;if(t===3)return 7;if(dn)switch(t){case 59:return 85;case 60:if(_t)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(be)return 57;break}else if(dd){if(be&&t===93)return 57;if(!be&&t===92)return 57}return GV[t]||0}var joe=be?256:2048,$oe=512,Yoe=1024,Zoe=be?2048:256;var st=class{_standardKeyboardEventBrand=!0;browserEvent;target;ctrlKey;shiftKey;altKey;metaKey;altGraphKey;keyCode;code;_asKeybinding;_asKeyCodeChord;constructor(t){let e=t;this.browserEvent=e,this.target=e.target,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,this.altGraphKey=e.getModifierState?.("AltGraph"),this.keyCode=qoe(e),this.code=e.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(t){return this._asKeybinding===t}_computeKeybinding(){let t=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode);let e=0;return this.ctrlKey&&(e|=joe),this.altKey&&(e|=$oe),this.shiftKey&&(e|=Yoe),this.metaKey&&(e|=Zoe),e|=t,e}_computeKeyCodeChord(){let t=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode),new zw(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,t)}};var _j=new WeakMap;function Xoe(r){if(!r.parent||r.parent===r)return null;try{let t=r.location,e=r.parent.location;if(t.origin!=="null"&&e.origin!=="null"&&t.origin!==e.origin)return null}catch{return null}return r.parent}var jL=class{static getSameOriginWindowChain(t){let e=_j.get(t);if(!e){e=[],_j.set(t,e);let i=t,n;do n=Xoe(i),n?e.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):e.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return e.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(t,e){if(!e||t===e)return{top:0,left:0};let i=0,n=0,o=this.getSameOriginWindowChain(t);for(let s of o){let a=s.window.deref();if(i+=a?.scrollY??0,n+=a?.scrollX??0,a===e||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}};var ri=class{browserEvent;leftButton;middleButton;rightButton;buttons;target;detail;posx;posy;ctrlKey;shiftKey;altKey;metaKey;timestamp;constructor(t,e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=e.button===0,this.middleButton=e.button===1,this.rightButton=e.button===2,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,e.type==="dblclick"&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,typeof e.pageX=="number"?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=e.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let i=jL.getPositionOfChildWindowRelativeToAncestorWindow(t,e.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}};var Aa=class{browserEvent;deltaY;deltaX;target;constructor(t,e=0,i=0){this.browserEvent=t||null,this.target=t?t.target||t.targetNode||t.srcElement:null,this.deltaY=i,this.deltaX=e;let n=!1;if(xc){let o=navigator.userAgent.match(/Chrome\/(\d+)/);n=(o?parseInt(o[1]):123)<=122}if(t){let o=t,s=t,a=t.view?.devicePixelRatio||1;if(typeof o.wheelDeltaY<"u")n?this.deltaY=o.wheelDeltaY/(120*a):this.deltaY=o.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(t.type==="wheel"){let l=t;l.deltaMode===l.DOM_DELTA_LINE?dn&&!be?this.deltaY=-t.deltaY/3:this.deltaY=-t.deltaY:this.deltaY=-t.deltaY/40}if(typeof o.wheelDeltaX<"u")Eo&&rt?this.deltaX=-(o.wheelDeltaX/120):n?this.deltaX=o.wheelDeltaX/(120*a):this.deltaX=o.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-t.detail/3;else if(t.type==="wheel"){let l=t;l.deltaMode===l.DOM_DELTA_LINE?dn&&!be?this.deltaX=-t.deltaX/3:this.deltaX=-t.deltaX:this.deltaX=-t.deltaX/40}this.deltaY===0&&this.deltaX===0&&t.wheelDelta&&(n?this.deltaY=t.wheelDelta/(120*a):this.deltaY=t.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}};var{entries:Oj,setPrototypeOf:Dj,isFrozen:Qoe,getPrototypeOf:Joe,getOwnPropertyDescriptor:ere}=Object,{freeze:vs,seal:ud,create:tre}=Object,{apply:QV,construct:JV}=typeof Reflect<"u"&&Reflect;QV||(QV=function(t,e,i){return t.apply(e,i)});vs||(vs=function(t){return t});ud||(ud=function(t){return t});JV||(JV=function(t,e){return new t(...e)});var ire=fl(Array.prototype.forEach),Lj=fl(Array.prototype.pop),Kw=fl(Array.prototype.push),ZL=fl(String.prototype.toLowerCase),jV=fl(String.prototype.toString),nre=fl(String.prototype.match),cd=fl(String.prototype.replace),ore=fl(String.prototype.indexOf),rre=fl(String.prototype.trim),Pa=fl(RegExp.prototype.test),Gw=sre(TypeError);function fl(r){return function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return QV(r,t,i)}}function sre(r){return function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return JV(r,e)}}function fi(r,t,e){var i;e=(i=e)!==null&&i!==void 0?i:ZL,Dj&&Dj(r,null);let n=t.length;for(;n--;){let o=t[n];if(typeof o=="string"){let s=e(o);s!==o&&(Qoe(t)||(t[n]=s),o=s)}r[o]=!0}return r}function Wv(r){let t=tre(null);for(let[e,i]of Oj(r))t[e]=i;return t}function $L(r,t){for(;r!==null;){let i=ere(r,t);if(i){if(i.get)return fl(i.get);if(typeof i.value=="function")return fl(i.value)}r=Joe(r)}function e(i){return console.warn("fallback value for",i),null}return e}var kj=vs(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),$V=vs(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),YV=vs(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),are=vs(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ZV=vs(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),lre=vs(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Rj=vs(["#text"]),Aj=vs(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),XV=vs(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Pj=vs(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),YL=vs(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dre=ud(/\{\{[\w\W]*|[\w\W]*\}\}/gm),cre=ud(/<%[\w\W]*|[\w\W]*%>/gm),ure=ud(/\${[\w\W]*}/gm),pre=ud(/^data-[\-\w.\u00B7-\uFFFF]/),hre=ud(/^aria-[\-\w]+$/),Nj=ud(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mre=ud(/^(?:\w+script|data):/i),gre=ud(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Fj=ud(/^html$/i),Mj=Object.freeze({__proto__:null,MUSTACHE_EXPR:dre,ERB_EXPR:cre,TMPLIT_EXPR:ure,DATA_ATTR:pre,ARIA_ATTR:hre,IS_ALLOWED_URI:Nj,IS_SCRIPT_OR_DATA:mre,ATTR_WHITESPACE:gre,DOCTYPE_NAME:Fj}),fre=()=>typeof window>"u"?null:window,bre=function(t,e){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let i=null,n="data-tt-policy-suffix";e&&e.hasAttribute(n)&&(i=e.getAttribute(n));let o="dompurify"+(i?"#"+i:"");try{return t.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function Bj(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fre(),t=lt=>Bj(lt);if(t.version="3.0.5",t.removed=[],!r||!r.document||r.document.nodeType!==9)return t.isSupported=!1,t;let e=r.document,i=e.currentScript,{document:n}=r,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:d,NamedNodeMap:c=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:u,DOMParser:p,trustedTypes:m}=r,g=l.prototype,f=$L(g,"cloneNode"),b=$L(g,"nextSibling"),y=$L(g,"childNodes"),I=$L(g,"parentNode");if(typeof s=="function"){let lt=n.createElement("template");lt.content&&lt.content.ownerDocument&&(n=lt.content.ownerDocument)}let E,S="",{implementation:w,createNodeIterator:D,createDocumentFragment:k,getElementsByTagName:R}=n,{importNode:A}=e,H={};t.isSupported=typeof Oj=="function"&&typeof I=="function"&&w&&w.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:z,ERB_EXPR:Z,TMPLIT_EXPR:fe,DATA_ATTR:Ve,ARIA_ATTR:me,IS_SCRIPT_OR_DATA:ce,ATTR_WHITESPACE:xe}=Mj,{IS_ALLOWED_URI:Ie}=Mj,ge=null,He=fi({},[...kj,...$V,...YV,...ZV,...Rj]),_e=null,xt=fi({},[...Aj,...XV,...Pj,...YL]),bt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),je=null,_n=null,pn=!0,no=!0,No=!1,zl=!0,Ai=!1,br=!1,ag=!1,Jp=!1,vr=!1,eh=!1,th=!1,Mb=!0,Ob=!1,ht="user-content-",Lu=!0,ih=!1,sc={},ol=null,ES=fi({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),lg=null,TS=fi({},["audio","video","img","source","image","track"]),ac=null,xS=fi({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),lc="http://www.w3.org/1998/Math/MathML",Ca="http://www.w3.org/2000/svg",oo="http://www.w3.org/1999/xhtml",Sa=oo,ku=!1,Zr=null,nh=fi({},[lc,Ca,oo],jV),Kl,dc=["application/xhtml+xml","text/html"],Oe="text/html",De,K=null,we=n.createElement("form"),Ae=function(J){return J instanceof RegExp||J instanceof Function},Nt=function(J){if(!(K&&K===J)){if((!J||typeof J!="object")&&(J={}),J=Wv(J),Kl=dc.indexOf(J.PARSER_MEDIA_TYPE)===-1?Kl=Oe:Kl=J.PARSER_MEDIA_TYPE,De=Kl==="application/xhtml+xml"?jV:ZL,ge="ALLOWED_TAGS"in J?fi({},J.ALLOWED_TAGS,De):He,_e="ALLOWED_ATTR"in J?fi({},J.ALLOWED_ATTR,De):xt,Zr="ALLOWED_NAMESPACES"in J?fi({},J.ALLOWED_NAMESPACES,jV):nh,ac="ADD_URI_SAFE_ATTR"in J?fi(Wv(xS),J.ADD_URI_SAFE_ATTR,De):xS,lg="ADD_DATA_URI_TAGS"in J?fi(Wv(TS),J.ADD_DATA_URI_TAGS,De):TS,ol="FORBID_CONTENTS"in J?fi({},J.FORBID_CONTENTS,De):ES,je="FORBID_TAGS"in J?fi({},J.FORBID_TAGS,De):{},_n="FORBID_ATTR"in J?fi({},J.FORBID_ATTR,De):{},sc="USE_PROFILES"in J?J.USE_PROFILES:!1,pn=J.ALLOW_ARIA_ATTR!==!1,no=J.ALLOW_DATA_ATTR!==!1,No=J.ALLOW_UNKNOWN_PROTOCOLS||!1,zl=J.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ai=J.SAFE_FOR_TEMPLATES||!1,br=J.WHOLE_DOCUMENT||!1,vr=J.RETURN_DOM||!1,eh=J.RETURN_DOM_FRAGMENT||!1,th=J.RETURN_TRUSTED_TYPE||!1,Jp=J.FORCE_BODY||!1,Mb=J.SANITIZE_DOM!==!1,Ob=J.SANITIZE_NAMED_PROPS||!1,Lu=J.KEEP_CONTENT!==!1,ih=J.IN_PLACE||!1,Ie=J.ALLOWED_URI_REGEXP||Nj,Sa=J.NAMESPACE||oo,bt=J.CUSTOM_ELEMENT_HANDLING||{},J.CUSTOM_ELEMENT_HANDLING&&Ae(J.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(bt.tagNameCheck=J.CUSTOM_ELEMENT_HANDLING.tagNameCheck),J.CUSTOM_ELEMENT_HANDLING&&Ae(J.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(bt.attributeNameCheck=J.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),J.CUSTOM_ELEMENT_HANDLING&&typeof J.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(bt.allowCustomizedBuiltInElements=J.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ai&&(no=!1),eh&&(vr=!0),sc&&(ge=fi({},[...Rj]),_e=[],sc.html===!0&&(fi(ge,kj),fi(_e,Aj)),sc.svg===!0&&(fi(ge,$V),fi(_e,XV),fi(_e,YL)),sc.svgFilters===!0&&(fi(ge,YV),fi(_e,XV),fi(_e,YL)),sc.mathMl===!0&&(fi(ge,ZV),fi(_e,Pj),fi(_e,YL))),J.ADD_TAGS&&(ge===He&&(ge=Wv(ge)),fi(ge,J.ADD_TAGS,De)),J.ADD_ATTR&&(_e===xt&&(_e=Wv(_e)),fi(_e,J.ADD_ATTR,De)),J.ADD_URI_SAFE_ATTR&&fi(ac,J.ADD_URI_SAFE_ATTR,De),J.FORBID_CONTENTS&&(ol===ES&&(ol=Wv(ol)),fi(ol,J.FORBID_CONTENTS,De)),Lu&&(ge["#text"]=!0),br&&fi(ge,["html","head","body"]),ge.table&&(fi(ge,["tbody"]),delete je.tbody),J.TRUSTED_TYPES_POLICY){if(typeof J.TRUSTED_TYPES_POLICY.createHTML!="function")throw Gw('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof J.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Gw('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=J.TRUSTED_TYPES_POLICY,S=E.createHTML("")}else E===void 0&&(E=bre(m,i)),E!==null&&typeof S=="string"&&(S=E.createHTML(""));vs&&vs(J),K=J}},_i=fi({},["mi","mo","mn","ms","mtext"]),Fo=fi({},["foreignobject","desc","title","annotation-xml"]),yr=fi({},["title","style","font","a","script"]),vt=fi({},$V);fi(vt,YV),fi(vt,are);let P=fi({},ZV);fi(P,lre);let N=function(J){let Be=I(J);(!Be||!Be.tagName)&&(Be={namespaceURI:Sa,tagName:"template"});let Je=ZL(J.tagName),$i=ZL(Be.tagName);return Zr[J.namespaceURI]?J.namespaceURI===Ca?Be.namespaceURI===oo?Je==="svg":Be.namespaceURI===lc?Je==="svg"&&($i==="annotation-xml"||_i[$i]):!!vt[Je]:J.namespaceURI===lc?Be.namespaceURI===oo?Je==="math":Be.namespaceURI===Ca?Je==="math"&&Fo[$i]:!!P[Je]:J.namespaceURI===oo?Be.namespaceURI===Ca&&!Fo[$i]||Be.namespaceURI===lc&&!_i[$i]?!1:!P[Je]&&(yr[Je]||!vt[Je]):!!(Kl==="application/xhtml+xml"&&Zr[J.namespaceURI]):!1},V=function(J){Kw(t.removed,{element:J});try{J.parentNode.removeChild(J)}catch{J.remove()}},j=function(J,Be){try{Kw(t.removed,{attribute:Be.getAttributeNode(J),from:Be})}catch{Kw(t.removed,{attribute:null,from:Be})}if(Be.removeAttribute(J),J==="is"&&!_e[J])if(vr||eh)try{V(Be)}catch{}else try{Be.setAttribute(J,"")}catch{}},Q=function(J){let Be,Je;if(Jp)J="<remove></remove>"+J;else{let Xr=nre(J,/^[\r\n\t ]+/);Je=Xr&&Xr[0]}Kl==="application/xhtml+xml"&&Sa===oo&&(J='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+J+"</body></html>");let $i=E?E.createHTML(J):J;if(Sa===oo)try{Be=new p().parseFromString($i,Kl)}catch{}if(!Be||!Be.documentElement){Be=w.createDocument(Sa,"template",null);try{Be.documentElement.innerHTML=ku?S:$i}catch{}}let vo=Be.body||Be.documentElement;return J&&Je&&vo.insertBefore(n.createTextNode(Je),vo.childNodes[0]||null),Sa===oo?R.call(Be,br?"html":"body")[0]:br?Be.documentElement:vo},le=function(J){return D.call(J.ownerDocument||J,J,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},Ce=function(J){return J instanceof u&&(typeof J.nodeName!="string"||typeof J.textContent!="string"||typeof J.removeChild!="function"||!(J.attributes instanceof c)||typeof J.removeAttribute!="function"||typeof J.setAttribute!="function"||typeof J.namespaceURI!="string"||typeof J.insertBefore!="function"||typeof J.hasChildNodes!="function")},ze=function(J){return typeof a=="object"?J instanceof a:J&&typeof J=="object"&&typeof J.nodeType=="number"&&typeof J.nodeName=="string"},$e=function(J,Be,Je){H[J]&&ire(H[J],$i=>{$i.call(t,Be,Je,K)})},Vt=function(J){let Be;if($e("beforeSanitizeElements",J,null),Ce(J))return V(J),!0;let Je=De(J.nodeName);if($e("uponSanitizeElement",J,{tagName:Je,allowedTags:ge}),J.hasChildNodes()&&!ze(J.firstElementChild)&&(!ze(J.content)||!ze(J.content.firstElementChild))&&Pa(/<[/\w]/g,J.innerHTML)&&Pa(/<[/\w]/g,J.textContent))return V(J),!0;if(!ge[Je]||je[Je]){if(!je[Je]&&sn(Je)&&(bt.tagNameCheck instanceof RegExp&&Pa(bt.tagNameCheck,Je)||bt.tagNameCheck instanceof Function&&bt.tagNameCheck(Je)))return!1;if(Lu&&!ol[Je]){let $i=I(J)||J.parentNode,vo=y(J)||J.childNodes;if(vo&&$i){let Xr=vo.length;for(let Zn=Xr-1;Zn>=0;--Zn)$i.insertBefore(f(vo[Zn],!0),b(J))}}return V(J),!0}return J instanceof l&&!N(J)||(Je==="noscript"||Je==="noembed"||Je==="noframes")&&Pa(/<\/no(script|embed|frames)/i,J.innerHTML)?(V(J),!0):(Ai&&J.nodeType===3&&(Be=J.textContent,Be=cd(Be,z," "),Be=cd(Be,Z," "),Be=cd(Be,fe," "),J.textContent!==Be&&(Kw(t.removed,{element:J.cloneNode()}),J.textContent=Be)),$e("afterSanitizeElements",J,null),!1)},Ii=function(J,Be,Je){if(Mb&&(Be==="id"||Be==="name")&&(Je in n||Je in we))return!1;if(!(no&&!_n[Be]&&Pa(Ve,Be))){if(!(pn&&Pa(me,Be))){if(!_e[Be]||_n[Be]){if(!(sn(J)&&(bt.tagNameCheck instanceof RegExp&&Pa(bt.tagNameCheck,J)||bt.tagNameCheck instanceof Function&&bt.tagNameCheck(J))&&(bt.attributeNameCheck instanceof RegExp&&Pa(bt.attributeNameCheck,Be)||bt.attributeNameCheck instanceof Function&&bt.attributeNameCheck(Be))||Be==="is"&&bt.allowCustomizedBuiltInElements&&(bt.tagNameCheck instanceof RegExp&&Pa(bt.tagNameCheck,Je)||bt.tagNameCheck instanceof Function&&bt.tagNameCheck(Je))))return!1}else if(!ac[Be]){if(!Pa(Ie,cd(Je,xe,""))){if(!((Be==="src"||Be==="xlink:href"||Be==="href")&&J!=="script"&&ore(Je,"data:")===0&&lg[J])){if(!(No&&!Pa(ce,cd(Je,xe,"")))){if(Je)return!1}}}}}}return!0},sn=function(J){return J.indexOf("-")>0},ro=function(J){let Be,Je,$i,vo;$e("beforeSanitizeAttributes",J,null);let{attributes:Xr}=J;if(!Xr)return;let Zn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_e};for(vo=Xr.length;vo--;){Be=Xr[vo];let{name:cc,namespaceURI:OF}=Be;if(Je=cc==="value"?Be.value:rre(Be.value),$i=De(cc),Zn.attrName=$i,Zn.attrValue=Je,Zn.keepAttr=!0,Zn.forceKeepAttr=void 0,$e("uponSanitizeAttribute",J,Zn),Je=Zn.attrValue,Zn.forceKeepAttr||(j(cc,J),!Zn.keepAttr))continue;if(!zl&&Pa(/\/>/i,Je)){j(cc,J);continue}Ai&&(Je=cd(Je,z," "),Je=cd(Je,Z," "),Je=cd(Je,fe," "));let B9=De(J.nodeName);if(Ii(B9,$i,Je)){if(Ob&&($i==="id"||$i==="name")&&(j(cc,J),Je=ht+Je),E&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!OF)switch(m.getAttributeType(B9,$i)){case"TrustedHTML":{Je=E.createHTML(Je);break}case"TrustedScriptURL":{Je=E.createScriptURL(Je);break}}try{OF?J.setAttributeNS(OF,cc,Je):J.setAttribute(cc,Je),Lj(t.removed)}catch{}}}$e("afterSanitizeAttributes",J,null)},vn=function lt(J){let Be,Je=le(J);for($e("beforeSanitizeShadowDOM",J,null);Be=Je.nextNode();)$e("uponSanitizeShadowNode",Be,null),!Vt(Be)&&(Be.content instanceof o&&lt(Be.content),ro(Be));$e("afterSanitizeShadowDOM",J,null)};return t.sanitize=function(lt){let J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Be,Je,$i,vo;if(ku=!lt,ku&&(lt="<!-->"),typeof lt!="string"&&!ze(lt))if(typeof lt.toString=="function"){if(lt=lt.toString(),typeof lt!="string")throw Gw("dirty is not a string, aborting")}else throw Gw("toString is not a function");if(!t.isSupported)return lt;if(ag||Nt(J),t.removed=[],typeof lt=="string"&&(ih=!1),ih){if(lt.nodeName){let cc=De(lt.nodeName);if(!ge[cc]||je[cc])throw Gw("root node is forbidden and cannot be sanitized in-place")}}else if(lt instanceof a)Be=Q("<!---->"),Je=Be.ownerDocument.importNode(lt,!0),Je.nodeType===1&&Je.nodeName==="BODY"||Je.nodeName==="HTML"?Be=Je:Be.appendChild(Je);else{if(!vr&&!Ai&&!br&&lt.indexOf("<")===-1)return E&&th?E.createHTML(lt):lt;if(Be=Q(lt),!Be)return vr?null:th?S:""}Be&&Jp&&V(Be.firstChild);let Xr=le(ih?lt:Be);for(;$i=Xr.nextNode();)Vt($i)||($i.content instanceof o&&vn($i.content),ro($i));if(ih)return lt;if(vr){if(eh)for(vo=k.call(Be.ownerDocument);Be.firstChild;)vo.appendChild(Be.firstChild);else vo=Be;return(_e.shadowroot||_e.shadowrootmode)&&(vo=A.call(e,vo,!0)),vo}let Zn=br?Be.outerHTML:Be.innerHTML;return br&&ge["!doctype"]&&Be.ownerDocument&&Be.ownerDocument.doctype&&Be.ownerDocument.doctype.name&&Pa(Fj,Be.ownerDocument.doctype.name)&&(Zn="<!DOCTYPE "+Be.ownerDocument.doctype.name+`>
`+Zn),Ai&&(Zn=cd(Zn,z," "),Zn=cd(Zn,Z," "),Zn=cd(Zn,fe," ")),E&&th?E.createHTML(Zn):Zn},t.setConfig=function(lt){Nt(lt),ag=!0},t.clearConfig=function(){K=null,ag=!1},t.isValidAttribute=function(lt,J,Be){K||Nt({});let Je=De(lt),$i=De(J);return Ii(Je,$i,Be)},t.addHook=function(lt,J){typeof J=="function"&&(H[lt]=H[lt]||[],Kw(H[lt],J))},t.removeHook=function(lt){if(H[lt])return Lj(H[lt])},t.removeHooks=function(lt){H[lt]&&(H[lt]=[])},t.removeAllHooks=function(){H={}},t}var _c=Bj();var nLe=_c.version,oLe=_c.isSupported,qw=_c.sanitize,rLe=_c.setConfig,sLe=_c.clearConfig,aLe=_c.isValidAttribute,XL=_c.addHook,QL=_c.removeHook,lLe=_c.removeHooks,dLe=_c.removeAllHooks;function sr(r,t,e){return Math.min(Math.max(r,t),e)}function Wj(r,t){return(t+r%t)%t}var{registerWindow:Kj,getWindow:oe,getDocument:LLe,getWindows:hd,getWindowsCount:JL,getWindowId:oa,getWindowById:Ma,hasWindow:nW,onDidRegisterWindow:Wg,onWillUnregisterWindow:kLe,onDidUnregisterWindow:Gj}=function(){let r=new Map;UL(ne,1);let t={window:ne,disposables:new W};r.set(ne.vscodeWindowId,t);let e=new T,i=new T,n=new T;function o(s,a){return(typeof s=="number"?r.get(s):void 0)??(a?t:void 0)}return{onDidRegisterWindow:e.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(s){if(r.has(s.vscodeWindowId))return L.None;let a=new W,l={window:s,disposables:a.add(new W)};return r.set(s.vscodeWindowId,l),a.add(te(()=>{r.delete(s.vscodeWindowId),i.fire(s)})),a.add(M(s,G.BEFORE_UNLOAD,()=>{n.fire(s)})),e.fire(l),a},getWindows(){return r.values()},getWindowsCount(){return r.size},getWindowId(s){return s.vscodeWindowId},hasWindow(s){return r.has(s)},getWindowById:o,getWindow(s){let a=s;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;let l=s;return l?.view?l.view.window:ne},getDocument(s){return oe(s).document}}}();function ci(r){for(;r.firstChild;)r.firstChild.remove()}var tW=class{_handler;_node;_type;_options;constructor(t,e,i,n){this._node=t,this._type=e,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function M(r,t,e,i){return new tW(r,t,e,i)}function vre(r,t){return function(e){return t(new ri(r,e))}}function yre(r){return function(t){return r(new st(t))}}var Wi=function(t,e,i,n){let o=i;return e==="click"||e==="mousedown"||e==="contextmenu"?o=vre(oe(t),i):(e==="keydown"||e==="keypress"||e==="keyup")&&(o=yre(i)),M(t,e,o,n)};function md(r,t,e){return sv(r,t,e)}var oW,nn;var Uv=class extends kD{defaultTarget;constructor(t){super(),this.defaultTarget=t&&oe(t)}cancelAndSet(t,e,i){return super.cancelAndSet(t,e,i??this.defaultTarget)}},jw=class{_runner;priority;_canceled;constructor(t,e=0){this._runner=t,this.priority=e,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(t){Ke(t)}}static sort(t,e){return e.priority-t.priority}};(function(){let r=new Map,t=new Map,e=new Map,i=new Map,n=o=>{e.set(o,!1);let s=r.get(o)??[];for(t.set(o,s),r.set(o,[]),i.set(o,!0);s.length>0;)s.sort(jw.sort),s.shift().execute();i.set(o,!1)};nn=(o,s,a=0)=>{let l=oa(o),d=new jw(s,a),c=r.get(l);return c||(c=[],r.set(l,c)),c.push(d),e.get(l)||(e.set(l,!0),o.requestAnimationFrame(()=>n(l))),d},oW=(o,s,a)=>{let l=oa(o);if(i.get(l)){let d=new jw(s,a),c=t.get(l);return c||(c=[],t.set(l,c)),c.push(d),d}else return nn(o,s,a)}})();function rW(r,t){return nn(r,t,1e4)}function qj(r,t){return nn(r,t,-1e4)}function sW(r){return oe(r).getComputedStyle(r,null)}function gd(r,t){let e=oe(r),i=e.document;if(r!==i.body)return new dt(r.clientWidth,r.clientHeight);if(Xo&&e?.visualViewport)return new dt(e.visualViewport.width,e.visualViewport.height);if(e?.innerWidth&&e.innerHeight)return new dt(e.innerWidth,e.innerHeight);if(i.body&&i.body.clientWidth&&i.body.clientHeight)return new dt(i.body.clientWidth,i.body.clientHeight);if(i.documentElement&&i.documentElement.clientWidth&&i.documentElement.clientHeight)return new dt(i.documentElement.clientWidth,i.documentElement.clientHeight);if(t)return gd(t);throw new Error("Unable to figure out browser width and height")}var ns=class r{static convertToPixels(t,e){return parseFloat(e)||0}static getDimension(t,e,i){let n=sW(t),o=n?n.getPropertyValue(e):"0";return r.convertToPixels(t,o)}static getBorderLeftWidth(t){return r.getDimension(t,"border-left-width","borderLeftWidth")}static getBorderRightWidth(t){return r.getDimension(t,"border-right-width","borderRightWidth")}static getBorderTopWidth(t){return r.getDimension(t,"border-top-width","borderTopWidth")}static getBorderBottomWidth(t){return r.getDimension(t,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(t){return r.getDimension(t,"padding-left","paddingLeft")}static getPaddingRight(t){return r.getDimension(t,"padding-right","paddingRight")}static getPaddingTop(t){return r.getDimension(t,"padding-top","paddingTop")}static getPaddingBottom(t){return r.getDimension(t,"padding-bottom","paddingBottom")}static getMarginLeft(t){return r.getDimension(t,"margin-left","marginLeft")}static getMarginTop(t){return r.getDimension(t,"margin-top","marginTop")}static getMarginRight(t){return r.getDimension(t,"margin-right","marginRight")}static getMarginBottom(t){return r.getDimension(t,"margin-bottom","marginBottom")}},dt=class r{constructor(t,e){this.width=t;this.height=e}static None=new r(0,0);with(t=this.width,e=this.height){return t!==this.width||e!==this.height?new r(t,e):this}static is(t){return typeof t=="object"&&typeof t.height=="number"&&typeof t.width=="number"}static lift(t){return t instanceof r?t:new r(t.width,t.height)}static equals(t,e){return t===e?!0:!t||!e?!1:t.width===e.width&&t.height===e.height}};function $w(r){let t=r.offsetParent,e=r.offsetTop,i=r.offsetLeft;for(;(r=r.parentNode)!==null&&r!==r.ownerDocument.body&&r!==r.ownerDocument.documentElement;){e-=r.scrollTop;let n=$j(r)?null:sW(r);n&&(i-=n.direction!=="rtl"?r.scrollLeft:-r.scrollLeft),r===t&&(i+=ns.getBorderLeftWidth(r),e+=ns.getBorderTopWidth(r),e+=r.offsetTop,i+=r.offsetLeft,t=r.offsetParent)}return{left:i,top:e}}function ek(r,t,e){typeof t=="number"&&(r.style.width=`${t}px`),typeof e=="number"&&(r.style.height=`${e}px`)}function tk(r,t,e,i,n,o="absolute"){typeof t=="number"&&(r.style.top=`${t}px`),typeof e=="number"&&(r.style.right=`${e}px`),typeof i=="number"&&(r.style.bottom=`${i}px`),typeof n=="number"&&(r.style.left=`${n}px`),r.style.position=o}function To(r){let t=r.getBoundingClientRect(),e=oe(r);return{left:t.left+e.scrollX,top:t.top+e.scrollY,width:t.width,height:t.height}}function aW(r){let t=r,e=1;do{let i=sW(t).zoom;i!=null&&i!=="1"&&(e*=i),t=t.parentElement}while(t!==null&&t!==t.ownerDocument.documentElement);return e}function Hv(r){let t=ns.getMarginLeft(r)+ns.getMarginRight(r);return r.offsetWidth+t}function zv(r){let t=ns.getBorderLeftWidth(r)+ns.getBorderRightWidth(r),e=ns.getPaddingLeft(r)+ns.getPaddingRight(r);return r.offsetWidth-t-e}function ik(r){let t=ns.getBorderTopWidth(r)+ns.getBorderBottomWidth(r),e=ns.getPaddingTop(r)+ns.getPaddingBottom(r);return r.offsetHeight-t-e}function nk(r){let t=ns.getMarginTop(r)+ns.getMarginBottom(r);return r.offsetHeight+t}function Xi(r,t){return!!t?.contains(r)}var Ire="parentFlowToElementId";function Cre(r){let t=r.dataset[Ire];return typeof t=="string"?r.ownerDocument.getElementById(t):null}function jj(r,t){let e=r;for(;e;){if(e===t)return!0;if(Oi(e)){let i=Cre(e);if(i){e=i;continue}}e=e.parentNode}return!1}function lW(r,t,e){for(;r&&r.nodeType===r.ELEMENT_NODE;){if(r.classList.contains(t))return r;if(e){if(typeof e=="string"){if(r.classList.contains(e))return null}else if(r===e)return null}r=r.parentNode}return null}function ok(r,t,e){return!!lW(r,t,e)}function $j(r){return r&&!!r.host&&!!r.mode}function rk(r){return!!cp(r)}function cp(r){for(;r.parentNode;){if(r===r.ownerDocument?.body)return null;r=r.parentNode}return $j(r)?r:null}function An(){let r=Dc().activeElement;for(;r?.shadowRoot;)r=r.shadowRoot.activeElement;return r}function os(r){return An()===r}function Oa(r){return Xi(An(),r)}function Yw(r){return r.ownerDocument===Dc()}function Dc(){return JL()<=1?ne.document:Array.from(hd()).map(({window:t})=>t.document).find(t=>t.hasFocus())??ne.document}function uo(){return Dc().defaultView?.window??ne}var sk=new Map;function Yj(r){return sk.has(r)}function Ho(r=ne.document.head,t,e){let i=document.createElement("style");if(i.type="text/css",i.media="screen",t?.(i),r.appendChild(i),e&&e.add(te(()=>i.remove())),r===ne.document.head){let n=new Set;sk.set(i,n);for(let{window:o,disposables:s}of hd()){if(o===ne)continue;let a=s.add(Xj(i,n,o));e?.add(a)}}return i}function Zj(r){let t=new W;for(let[e,i]of sk)t.add(Xj(e,i,r));return t}function Xj(r,t,e){let i=new W,n=r.cloneNode(!0);e.document.head.appendChild(n),i.add(te(()=>n.remove()));for(let o of wre(r))n.sheet?.insertRule(o.cssText,n.sheet?.cssRules.length);return i.add(ak.observe(r,i,{childList:!0})(()=>{n.textContent=r.textContent})),t.add(n),i.add(te(()=>t.delete(n))),i}var ak=new class{mutationObservers=new Map;observe(r,t,e){let i=this.mutationObservers.get(r);i||(i=new Map,this.mutationObservers.set(r,i));let n=Xn(e),o=i.get(n);if(o)o.users+=1;else{let s=new T,a=new MutationObserver(d=>s.fire(d));a.observe(r,e);let l=o={users:1,observer:a,onDidMutate:s.event};t.add(te(()=>{l.users-=1,l.users===0&&(s.dispose(),a.disconnect(),i?.delete(n),i?.size===0&&this.mutationObservers.delete(r))})),i.set(n,o)}return o.onDidMutate}};function lk(r=ne.document.head){return Jj("meta",r)}function Qj(r=ne.document.head){return Jj("link",r)}function Jj(r,t=ne.document.head){let e=document.createElement(r);return t.appendChild(e),e}var eW=null;function Sre(){return eW||(eW=Ho()),eW}function wre(r){return r?.sheet?.rules?r.sheet.rules:r?.sheet?.cssRules?r.sheet.cssRules:[]}function Zw(r,t,e=Sre()){if(!(!e||!t)){e.sheet?.insertRule(`${r} {${t}}`,0);for(let i of sk.get(e)??[])Zw(r,t,i)}}function Oi(r){return r instanceof HTMLElement||r instanceof oe(r).HTMLElement}function e$(r){return r instanceof SVGElement||r instanceof oe(r).SVGElement}function Na(r){return r instanceof MouseEvent||r instanceof oe(r).MouseEvent}function bl(r){return r instanceof KeyboardEvent||r instanceof oe(r).KeyboardEvent}var G={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:dd?"webkitAnimationStart":"animationstart",ANIMATION_END:dd?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:dd?"webkitAnimationIteration":"animationiteration"};function t$(r){let t=r;return!!(t&&typeof t.preventDefault=="function"&&typeof t.stopPropagation=="function")}var Te={stop:(r,t)=>(r.preventDefault(),t&&r.stopPropagation(),r)};function i$(r){let t=[];for(let e=0;r&&r.nodeType===r.ELEMENT_NODE;e++)t[e]=r.scrollTop,r=r.parentNode;return t}function n$(r,t){for(let e=0;r&&r.nodeType===r.ELEMENT_NODE;e++)r.scrollTop!==t[e]&&(r.scrollTop=t[e]),r=r.parentNode}var iW=class r extends L{_onDidFocus=this._register(new T);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new T);onDidBlur=this._onDidBlur.event;_refreshStateHandler;static hasFocusWithin(t){if(Oi(t)){let e=cp(t),i=e?e.activeElement:t.ownerDocument.activeElement;return Xi(i,t)}else{let e=t;return Xi(e.document.activeElement,e.document)}}constructor(t){super();let e=r.hasFocusWithin(t),i=!1,n=()=>{i=!1,e||(e=!0,this._onDidFocus.fire())},o=()=>{e&&(i=!0,(Oi(t)?oe(t):t).setTimeout(()=>{i&&(i=!1,e=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{r.hasFocusWithin(t)!==e&&(e?o():n())},this._register(M(t,G.FOCUS,n,!0)),this._register(M(t,G.BLUR,o,!0)),Oi(t)&&(this._register(M(t,G.FOCUS_IN,()=>this._refreshStateHandler())),this._register(M(t,G.FOCUS_OUT,()=>this._refreshStateHandler())))}refreshState(){this._refreshStateHandler()}};function Un(r){return new iW(r)}function dk(r,t){return r.after(t),t}function Ee(r,...t){if(r.append(...t),t.length===1&&typeof t[0]!="string")return t[0]}function up(r,t){return r.insertBefore(t,r.firstChild),t}function Tn(r,...t){r.innerText="",Ee(r,...t)}var Ere=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;function o$(r,t,e,...i){let n=Ere.exec(t);if(!n)throw new Error("Bad use of emmet");let o=n[1]||"div",s;return r!=="http://www.w3.org/1999/xhtml"?s=document.createElementNS(r,o):s=document.createElement(o),n[3]&&(s.id=n[3]),n[4]&&(s.className=n[4].replace(/\./g," ").trim()),e&&Object.entries(e).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?s[a]=l:a==="selected"?l&&s.setAttribute(a,"true"):s.setAttribute(a,l))}),s.append(...i),s}function re(r,t,...e){return o$("http://www.w3.org/1999/xhtml",r,t,...e)}re.SVG=function(r,t,...e){return o$("http://www.w3.org/2000/svg",r,t,...e)};function rs(...r){for(let t of r)t.style.display="",t.removeAttribute("aria-hidden")}function ys(...r){for(let t of r)t.style.display="none",t.setAttribute("aria-hidden","true")}function r$(r){return new Promise(t=>{if(r.document.readyState==="complete"||r.document&&r.document.body!==null)t(void 0);else{let i=()=>{r.window.removeEventListener("DOMContentLoaded",i,!1),t()};r.window.addEventListener("DOMContentLoaded",i,!1)}})}function Kv(r,t){let e=r.devicePixelRatio*t;return Math.max(1,Math.floor(e))/r.devicePixelRatio}function dW(r){ne.open(r,"_blank","noopener")}var Uj=780,Hj=640;function cW(r){let t=Math.floor(ne.screenLeft+ne.innerWidth/2-Uj/2),e=Math.floor(ne.screenTop+ne.innerHeight/2-Hj/2);ne.open(r,"_blank",`width=${Uj},height=${Hj},top=${e},left=${t}`)}function s$(r,t=!0){let e=ne.open();return e?(t&&(e.opener=null),e.location.href=r,!0):!1}function a$(r,t){let e=()=>{t(),i=nn(r,e)},i=nn(r,e);return te(()=>i.dispose())}Jl.setPreferredWebSchema(/^https:/.test(ne.location.href)?"https":"http");function vl(r){return r?`url('${Da.uriToBrowserUri(r).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function Is(r,t){if(r!==void 0){let e=r.match(/^\s*var\((.+)\)$/);if(e){let i=e[1].split(",",2);return i.length===2&&(t=Is(i[1].trim(),t)),`var(${i[0]}, ${t})`}return r}return t}function l$(r,t=!1){let e=document.createElement("a");return XL("afterSanitizeAttributes",i=>{for(let n of["href","src"])if(i.hasAttribute(n)){let o=i.getAttribute(n);if(n==="href"&&o.startsWith("#"))continue;if(e.href=o,!r.includes(e.protocol.replace(/:$/,""))){if(t&&n==="src"&&e.href.startsWith("data:"))continue;i.removeAttribute(n)}}}),te(()=>{QL("afterSanitizeAttributes")})}var RLe=[he.http,he.https,he.command],d$=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),ALe=Object.freeze({ALLOWED_TAGS:["a","button","blockquote","code","div","h1","h2","h3","h4","h5","h6","hr","input","label","li","p","pre","select","small","span","strong","textarea","ul","ol"],ALLOWED_ATTR:["href","data-href","data-command","target","title","name","src","alt","class","id","role","tabindex","style","data-code","width","height","align","x-dispatch","required","checked","placeholder","type","start"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!0});function Tre(r){let t=new Uint16Array(r.length);for(let n=0;n<t.length;n++)t[n]=r.charCodeAt(n);let e="",i=new Uint8Array(t.buffer);for(let n=0;n<i.length;n++)e+=String.fromCharCode(i[n]);return e}function Gv(r){return btoa(Tre(r))}var pd=class r extends T{_subscriptions=new W;_keyStatus;static instance;constructor(){super(),this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(O.runAndSubscribe(Wg,({window:t,disposables:e})=>this.registerListeners(t,e),{window:ne,disposables:this._subscriptions}))}registerListeners(t,e){e.add(M(t,"keydown",i=>{if(i.defaultPrevented)return;let n=new st(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),e.add(M(t,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),e.add(M(t.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),e.add(M(t.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),e.add(M(t.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),e.add(M(t,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}get isModifierPressed(){return this._keyStatus.altKey||this._keyStatus.ctrlKey||this._keyStatus.metaKey||this._keyStatus.shiftKey}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return r.instance||(r.instance=new r),r.instance}dispose(){super.dispose(),this._subscriptions.dispose()}};var ra=class extends L{constructor(e,i){super();this.element=e;this.callbacks=i;this.registerListeners()}counter=0;dragStartTime=0;registerListeners(){this.callbacks.onDragStart&&this._register(M(this.element,G.DRAG_START,e=>{this.callbacks.onDragStart?.(e)})),this.callbacks.onDrag&&this._register(M(this.element,G.DRAG,e=>{this.callbacks.onDrag?.(e)})),this._register(M(this.element,G.DRAG_ENTER,e=>{this.counter++,this.dragStartTime=e.timeStamp,this.callbacks.onDragEnter?.(e)})),this._register(M(this.element,G.DRAG_OVER,e=>{e.preventDefault(),this.callbacks.onDragOver?.(e,e.timeStamp-this.dragStartTime)})),this._register(M(this.element,G.DRAG_LEAVE,e=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(e))})),this._register(M(this.element,G.DRAG_END,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(e)})),this._register(M(this.element,G.DROP,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(e)}))}},xre=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function gi(r,...t){let e,i;Array.isArray(t[0])?(e={},i=t[0]):(e=t[0]||{},i=t[1]);let n=xre.exec(r);if(!n||!n.groups)throw new Error("Bad use of h");let o=n.groups.tag||"div",s=document.createElement(o);n.groups.id&&(s.id=n.groups.id);let a=[];if(n.groups.class)for(let d of n.groups.class.split("."))d!==""&&a.push(d);if(e.className!==void 0)for(let d of e.className.split("."))d!==""&&a.push(d);a.length>0&&(s.className=a.join(" "));let l={};if(n.groups.name&&(l[n.groups.name]=s),i)for(let d of i)Oi(d)?s.appendChild(d):typeof d=="string"?s.append(d):"root"in d&&(Object.assign(l,d),s.appendChild(d.root));for(let[d,c]of Object.entries(e))if(d!=="className")if(d==="style")for(let[u,p]of Object.entries(c))s.style.setProperty(zj(u),typeof p=="number"?p+"px":""+p);else d==="tabIndex"?s.tabIndex=c:s.setAttribute(zj(d),c.toString());return l.root=s,l}function zj(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ck(r,t,e){for(let{name:i,value:n}of r.attributes)(!e||e.includes(i))&&t.setAttribute(i,n)}function _re(r,t,e){let i=r.getAttribute(e);i?t.setAttribute(e,i):t.removeAttribute(e)}function uk(r,t,e){ck(r,t,e);let i=new W;return i.add(ak.observe(r,i,{attributes:!0,attributeFilter:e})(n=>{for(let o of n)o.type==="attributes"&&o.attributeName&&_re(r,t,o.attributeName)})),i}function sa(r){return r.tagName.toLowerCase()==="input"||r.tagName.toLowerCase()==="textarea"||Oi(r)&&!!r.editContext}co((r,t)=>{let e=Av(r);t.addRule(`.monaco-workbench { background-color: ${e}; }`);let i=r.getColor(M3);if(i&&t.addRule(`.monaco-workbench ::selection { background-color: ${i}; }`),wt){let n=r.getColor(Rv);if(n){let o="monaco-workbench-meta-theme-color",s=ne.document.getElementById(o);s||(s=lk(),s.name="theme-color",s.id=o),s.content=n.toString()}}Eo&&t.addRule(`
			body.web {
				touch-action: none;
			}
			.monaco-workbench .monaco-editor .view-lines {
				user-select: text;
				-webkit-user-select: text;
			}
		`),Xo&&KL()&&t.addRule(`body { background-color: ${e}; }`)});var Pn=$("lifecycleService");function c$(r){switch(r){case 1:return"Starting";case 2:return"Ready";case 3:return"Restored";case 4:return"Eventually"}}function Cs(r){if(!r||typeof r!="object"||r instanceof RegExp)return r;let t=Array.isArray(r)?[]:{};return Object.entries(r).forEach(([e,i])=>{t[e]=i&&typeof i=="object"?Cs(i):i}),t}function u$(r){if(!r||typeof r!="object")return r;let t=[r];for(;t.length>0;){let e=t.shift();Object.freeze(e);for(let i in e)if(p$.call(e,i)){let n=e[i];typeof n=="object"&&!Object.isFrozen(n)&&!j7(n)&&t.push(n)}}return r}var p$=Object.prototype.hasOwnProperty;function pW(r,t){return uW(r,t,new Set)}function uW(r,t,e){if(Zi(r))return r;let i=t(r);if(typeof i<"u")return i;if(Array.isArray(r)){let n=[];for(let o of r)n.push(uW(o,t,e));return n}if(Mi(r)){if(e.has(r))throw new Error("Cannot clone recursive data-structure");e.add(r);let n={};for(let o in r)p$.call(r,o)&&(n[o]=uW(r[o],t,e));return e.delete(r),n}return r}function $t(r,t){if(r===t)return!0;if(r==null||t===null||t===void 0||typeof r!=typeof t||typeof r!="object"||Array.isArray(r)!==Array.isArray(t))return!1;let e,i;if(Array.isArray(r)){if(r.length!==t.length)return!1;for(e=0;e<r.length;e++)if(!$t(r[e],t[e]))return!1}else{let n=[];for(i in r)n.push(i);n.sort();let o=[];for(i in t)o.push(i);if(o.sort(),!$t(n,o))return!1;for(e=0;e<n.length;e++)if(!$t(r[n[e]],t[n[e]]))return!1}return!0}function hW(r){let t=new Set;return JSON.stringify(r,(e,i)=>{if(Mi(i)||Array.isArray(i)){if(t.has(i))return"[Circular]";t.add(i)}return typeof i=="bigint"?`[BigInt ${i.toString()}]`:i})}function h$(r,t){let e=Object.create(null);return!r||!t||Object.keys(t).forEach(n=>{let o=r[n],s=t[n];$t(o,s)||(e[n]=s)}),e}var gW=class r{constructor(t,e,i,n,o,s,a){this._forceIntegerValues=t;this._forceIntegerValues&&(e=e|0,i=i|0,n=n|0,o=o|0,s=s|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,e<0&&(e=0),n+e>i&&(n=i-e),n<0&&(n=0),o<0&&(o=0),a+o>s&&(a=s-o),a<0&&(a=0),this.width=e,this.scrollWidth=i,this.scrollLeft=n,this.height=o,this.scrollHeight=s,this.scrollTop=a}_scrollStateBrand=void 0;rawScrollLeft;rawScrollTop;width;scrollWidth;scrollLeft;height;scrollHeight;scrollTop;equals(t){return this.rawScrollLeft===t.rawScrollLeft&&this.rawScrollTop===t.rawScrollTop&&this.width===t.width&&this.scrollWidth===t.scrollWidth&&this.scrollLeft===t.scrollLeft&&this.height===t.height&&this.scrollHeight===t.scrollHeight&&this.scrollTop===t.scrollTop}withScrollDimensions(t,e){return new r(this._forceIntegerValues,typeof t.width<"u"?t.width:this.width,typeof t.scrollWidth<"u"?t.scrollWidth:this.scrollWidth,e?this.rawScrollLeft:this.scrollLeft,typeof t.height<"u"?t.height:this.height,typeof t.scrollHeight<"u"?t.scrollHeight:this.scrollHeight,e?this.rawScrollTop:this.scrollTop)}withScrollPosition(t){return new r(this._forceIntegerValues,this.width,this.scrollWidth,typeof t.scrollLeft<"u"?t.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof t.scrollTop<"u"?t.scrollTop:this.rawScrollTop)}createScrollEvent(t,e){let i=this.width!==t.width,n=this.scrollWidth!==t.scrollWidth,o=this.scrollLeft!==t.scrollLeft,s=this.height!==t.height,a=this.scrollHeight!==t.scrollHeight,l=this.scrollTop!==t.scrollTop;return{inSmoothScrolling:e,oldWidth:t.width,oldScrollWidth:t.scrollWidth,oldScrollLeft:t.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:t.height,oldScrollHeight:t.scrollHeight,oldScrollTop:t.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:o,heightChanged:s,scrollHeightChanged:a,scrollTopChanged:l}}},fd=class extends L{_scrollableBrand=void 0;_smoothScrollDuration;_scheduleAtNextAnimationFrame;_state;_smoothScrolling;_onScroll=this._register(new T);onScroll=this._onScroll.event;constructor(t){super(),this._smoothScrollDuration=t.smoothScrollDuration,this._scheduleAtNextAnimationFrame=t.scheduleAtNextAnimationFrame,this._state=new gW(t.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(t){this._smoothScrollDuration=t}validateScrollPosition(t){return this._state.withScrollPosition(t)}getScrollDimensions(){return this._state}setScrollDimensions(t,e){let i=this._state.withScrollDimensions(t,e);this._setState(i,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(t){let e=this._state.withScrollPosition(t);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(e,!1)}setScrollPositionSmooth(t,e){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(t);if(this._smoothScrolling){t={scrollLeft:typeof t.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:t.scrollLeft,scrollTop:typeof t.scrollTop>"u"?this._smoothScrolling.to.scrollTop:t.scrollTop};let i=this._state.withScrollPosition(t);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;e?n=new mk(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{let i=this._state.withScrollPosition(t);this._smoothScrolling=mk.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let t=this._smoothScrolling.tick(),e=this._state.withScrollPosition(t);if(this._setState(e,!0),!!this._smoothScrolling){if(t.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(t,e){let i=this._state;i.equals(t)||(this._state=t,this._onScroll.fire(this._state.createScrollEvent(i,e)))}},hk=class{scrollLeft;scrollTop;isDone;constructor(t,e,i){this.scrollLeft=t,this.scrollTop=e,this.isDone=i}};function mW(r,t){let e=t-r;return function(i){return r+e*kre(i)}}function Dre(r,t,e){return function(i){return i<e?r(i/e):t((i-e)/(1-e))}}var mk=class r{from;to;duration;startTime;animationFrameDisposable;scrollLeft;scrollTop;constructor(t,e,i,n){this.from=t,this.to=e,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(t,e,i){if(Math.abs(t-e)>2.5*i){let o,s;return t<e?(o=t+.75*i,s=e-.75*i):(o=t-.75*i,s=e+.75*i),Dre(mW(t,o),mW(s,e),.33)}return mW(t,e)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(t){this.to=t.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(t){let e=(t-this.startTime)/this.duration;if(e<1){let i=this.scrollLeft(e),n=this.scrollTop(e);return new hk(i,n,!1)}return new hk(this.to.scrollLeft,this.to.scrollTop,!0)}combine(t,e,i){return r.start(t,e,i)}static start(t,e,i){i=i+10;let n=Date.now()-10;return new r(t,e,n,i)}};function Lre(r){return Math.pow(r,3)}function kre(r){return 1-Lre(1-r)}var Lc=new class{_zoomLevel=0;_onDidChangeZoomLevel=new T;onDidChangeZoomLevel=this._onDidChangeZoomLevel.event;getZoomLevel(){return this._zoomLevel}setZoomLevel(r){r=Math.min(Math.max(-5,r),20),this._zoomLevel!==r&&(this._zoomLevel=r,this._onDidChangeZoomLevel.fire(this._zoomLevel))}};var Rre=be?1.5:1.35,fW=8,Ug=class r{_bareFontInfoBrand=void 0;static createFromValidatedSettings(t,e,i){let n=t.get(50),o=t.get(54),s=t.get(53),a=t.get(52),l=t.get(55),d=t.get(68),c=t.get(65);return r._create(n,o,s,a,l,d,c,e,i)}static createFromRawSettings(t,e,i=!1){let n=yl.fontFamily.validate(t.fontFamily),o=yl.fontWeight.validate(t.fontWeight),s=yl.fontSize.validate(t.fontSize),a=yl.fontLigatures2.validate(t.fontLigatures),l=yl.fontVariations.validate(t.fontVariations),d=yl.lineHeight.validate(t.lineHeight),c=yl.letterSpacing.validate(t.letterSpacing);return r._create(n,o,s,a,l,d,c,e,i)}static _create(t,e,i,n,o,s,a,l,d){s===0?s=Rre*i:s<fW&&(s=s*i),s=Math.round(s),s<fW&&(s=fW);let c=1+(d?0:Lc.getZoomLevel()*.1);return i*=c,s*=c,o===jv.TRANSLATE&&(e==="normal"||e==="bold"?o=jv.OFF:(o=`'wght' ${parseInt(e,10)}`,e="normal")),new r({pixelRatio:l,fontFamily:t,fontWeight:e,fontSize:i,fontFeatureSettings:n,fontVariationSettings:o,lineHeight:s,letterSpacing:a})}pixelRatio;fontFamily;fontWeight;fontSize;fontFeatureSettings;fontVariationSettings;lineHeight;letterSpacing;constructor(t){this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.fontVariationSettings=t.fontVariationSettings,this.lineHeight=t.lineHeight|0,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){let t=Ss.fontFamily,e=r._wrapInQuotes(this.fontFamily);return t&&this.fontFamily!==t?`${e}, ${t}`:e}static _wrapInQuotes(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}},bW=2,qv=class extends Ug{_editorStylingBrand=void 0;version=bW;isTrusted;isMonospace;typicalHalfwidthCharacterWidth;typicalFullwidthCharacterWidth;canUseHalfwidthRightwardsArrow;spaceWidth;middotWidth;wsmiddotWidth;maxDigitWidth;constructor(t,e){super(t),this.isTrusted=e,this.isMonospace=t.isMonospace,this.typicalHalfwidthCharacterWidth=t.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=t.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=t.canUseHalfwidthRightwardsArrow,this.spaceWidth=t.spaceWidth,this.middotWidth=t.middotWidth,this.wsmiddotWidth=t.wsmiddotWidth,this.maxDigitWidth=t.maxDigitWidth}equals(t){return this.fontFamily===t.fontFamily&&this.fontWeight===t.fontWeight&&this.fontSize===t.fontSize&&this.fontFeatureSettings===t.fontFeatureSettings&&this.fontVariationSettings===t.fontVariationSettings&&this.lineHeight===t.lineHeight&&this.letterSpacing===t.letterSpacing&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===t.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.maxDigitWidth===t.maxDigitWidth}};var kc={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var vW="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function Are(r=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(let e of vW)r.indexOf(e)>=0||(t+="\\"+e);return t+="\\s]+)",new RegExp(t,"g")}var gk=Are();function Xw(r){let t=gk;if(r&&r instanceof RegExp)if(r.global)t=r;else{let e="g";r.ignoreCase&&(e+="i"),r.multiline&&(e+="m"),r.unicode&&(e+="u"),t=new RegExp(r.source,e)}return t.lastIndex=0,t}var m$=new ao;m$.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Qw(r,t,e,i,n){if(t=Xw(t),n||(n=Lt.first(m$)),e.length>n.maxLen){let d=r-n.maxLen/2;return d<0?d=0:i+=d,e=e.substring(d,r+n.maxLen/2),Qw(r,t,e,i,n)}let o=Date.now(),s=r-1-i,a=-1,l=null;for(let d=1;!(Date.now()-o>=n.timeBudget);d++){let c=s-n.windowSize*d;t.lastIndex=Math.max(0,c);let u=Pre(t,e,s,a);if(!u&&l||(l=u,c<=0))break;a=c}if(l){let d={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return t.lastIndex=0,d}return null}function Pre(r,t,e,i){let n;for(;n=r.exec(t);){let o=n.index||0;if(o<=e&&r.lastIndex>=e)return n;if(i>0&&o>i)return null}return null}var zo=$("accessibilityService");var bke=new ie("accessibilityModeEnabled",!1);var g$="ACCESSIBLE_VIEW_SHOWN_";var xi={Configuration:"base.contributions.configuration"};var ss={properties:{},patternProperties:{}},$v={properties:{},patternProperties:{}},Hg={properties:{},patternProperties:{}},Rc={properties:{},patternProperties:{}},Ac={properties:{},patternProperties:{}},Il={properties:{},patternProperties:{}},pp="vscode://schemas/settings/resourceLanguage",b$="vscode://schemas/settings/configurationDefaults",fk=Ne.as(nd.JSONContribution),yW=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new T;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new T;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},fk.registerSchema(pp,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(t,e=!0){this.registerConfigurations([t],e)}registerConfigurations(t,e=!0){let i=new Set;this.doRegisterConfigurations(t,e,i),fk.registerSchema(pp,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(t){let e=new Set;this.doDeregisterConfigurations(t,e),fk.registerSchema(pp,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e})}updateConfigurations({add:t,remove:e}){let i=new Set;this.doDeregisterConfigurations(e,i),this.doRegisterConfigurations(t,!1,i),fk.registerSchema(pp,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(t){let e=new Set;this.doRegisterDefaultConfigurations(t,e),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e,defaultsOverrides:!0})}doRegisterDefaultConfigurations(t,e){this.registeredConfigurationDefaults.push(...t);let i=[];for(let{overrides:n,source:o}of t)for(let s in n){e.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=n[s];if(a.configurationDefaultOverrides.push({value:l,source:o}),Gr.test(s)){let d=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d,this.updateDefaultOverrideProperty(s,d,o),i.push(...Yv(s))}else{let d=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,o,a.configurationDefaultOverrideValue);if(!d)continue;a.configurationDefaultOverrideValue=d;let c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(t){let e=new Set;this.doDeregisterDefaultConfigurations(t,e),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(t,e){for(let i of t){let n=this.registeredConfigurationDefaults.indexOf(i);n!==-1&&this.registeredConfigurationDefaults.splice(n,1)}for(let{overrides:i,source:n}of t)for(let o in i){let s=this.configurationDefaultsOverrides.get(o);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>n?l.source?.id===n.id:l.value===i[o]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(o),Gr.test(o)){let l;for(let d of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(o,d.value,d.source,l);l&&!Xl(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(o,l,n)):(this.configurationDefaultsOverrides.delete(o),delete this.configurationProperties[o],delete this.defaultLanguageConfigurationOverridesNode.properties[o])}else{let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(o,c.value,c.source,l);s.configurationDefaultOverrideValue=l;let d=this.configurationProperties[o];d&&(this.updatePropertyDefaultValue(o,d),this.updateSchema(o,d))}e.add(o)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(t,e,i){let n={type:"object",default:e.value,description:h("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",xG(t)),$ref:pp,defaultDefaultValue:e.value,source:i,defaultValueSource:i};this.configurationProperties[t]=n,this.defaultLanguageConfigurationOverridesNode.properties[t]=n}mergeDefaultConfigurationsForOverrideIdentifier(t,e,i,n){let o=n?.value||{},s=n?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(e)){let l=e[a];if(Mi(l)&&(Vn(o[a])||Mi(o[a]))){if(o[a]={...o[a]??{},...l},i)for(let c in l)s.set(`${a}.${c}`,i)}else o[a]=l,i?s.set(a,i):s.delete(a)}return{value:o,source:s}}mergeDefaultConfigurationsForConfigurationProperty(t,e,i,n){let o=this.configurationProperties[t],s=n?.value??o?.defaultDefaultValue,a=i;if(Mi(e)&&(o!==void 0&&o.type==="object"||o===void 0&&(Vn(s)||Mi(s)))){if(a=n?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let d in e)i&&a.set(`${t}.${d}`,i);e={...Mi(s)?s:{},...e}}return{value:e,source:a}}deltaConfiguration(t){let e=!1,i=new Set;t.removedDefaults&&(this.doDeregisterDefaultConfigurations(t.removedDefaults,i),e=!0),t.addedDefaults&&(this.doRegisterDefaultConfigurations(t.addedDefaults,i),e=!0),t.removedConfigurations&&this.doDeregisterConfigurations(t.removedConfigurations,i),t.addedConfigurations&&this.doRegisterConfigurations(t.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:e})}notifyConfigurationSchemaUpdated(...t){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(t){this.doRegisterOverrideIdentifiers(t),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(t){for(let e of t)this.overrideIdentifiers.add(e);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(t,e,i){t.forEach(n=>{this.validateAndRegisterProperties(n,e,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}doDeregisterConfigurations(t,e){let i=n=>{if(n.properties)for(let o in n.properties){e.add(o);let s=this.configurationProperties[o];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[o],this.removeFromSchema(o,n.properties[o])}n.allOf?.forEach(o=>i(o))};for(let n of t){i(n);let o=this.configurationContributors.indexOf(n);o!==-1&&this.configurationContributors.splice(o,1)}}validateAndRegisterProperties(t,e=!0,i,n,o=3,s){o=Zi(t.scope)?o:t.scope;let a=t.properties;if(a)for(let d in a){let c=a[d];if(e&&Ore(d,c)){delete a[d];continue}if(c.source=i,c.defaultDefaultValue=a[d].default,this.updatePropertyDefaultValue(d,c),Gr.test(d)?c.scope=void 0:(c.scope=Zi(c.scope)?o:c.scope,c.restricted=Zi(c.restricted)?!!n?.includes(d):c.restricted),a[d].hasOwnProperty("included")&&!a[d].included){this.excludedConfigurationProperties[d]=a[d],delete a[d];continue}else this.configurationProperties[d]=a[d],a[d].policy?.name&&this.policyConfigurations.set(a[d].policy.name,d);!a[d].deprecationMessage&&a[d].markdownDeprecationMessage&&(a[d].deprecationMessage=a[d].markdownDeprecationMessage),s.add(d)}let l=t.allOf;if(l)for(let d of l)this.validateAndRegisterProperties(d,e,i,n,o,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let t=new Map;for(let[e,i]of this.configurationDefaultsOverrides)i.configurationDefaultOverrideValue&&t.set(e,i.configurationDefaultOverrideValue);return t}registerJSONConfiguration(t){let e=i=>{let n=i.properties;if(n)for(let s in n)this.updateSchema(s,n[s]);i.allOf?.forEach(e)};e(t)}updateSchema(t,e){switch(ss.properties[t]=e,e.scope){case 1:$v.properties[t]=e;break;case 2:Hg.properties[t]=e;break;case 6:Rc.properties[t]=e;break;case 3:Ac.properties[t]=e;break;case 4:Il.properties[t]=e;break;case 5:Il.properties[t]=e,this.resourceLanguageSettingsSchema.properties[t]=e;break}}removeFromSchema(t,e){switch(delete ss.properties[t],e.scope){case 1:delete $v.properties[t];break;case 2:delete Hg.properties[t];break;case 6:delete Rc.properties[t];break;case 3:delete Ac.properties[t];break;case 4:case 5:delete Il.properties[t],delete this.resourceLanguageSettingsSchema.properties[t];break}}updateOverridePropertyPatternKey(){for(let t of this.overrideIdentifiers.values()){let e=`[${t}]`,i={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:pp};this.updatePropertyDefaultValue(e,i),ss.properties[e]=i,$v.properties[e]=i,Hg.properties[e]=i,Rc.properties[e]=i,Ac.properties[e]=i,Il.properties[e]=i}}registerOverridePropertyPatternKey(){let t={type:"object",description:h("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:h("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:pp};ss.patternProperties[hp]=t,$v.patternProperties[hp]=t,Hg.patternProperties[hp]=t,Rc.patternProperties[hp]=t,Ac.patternProperties[hp]=t,Il.patternProperties[hp]=t,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(t,e){let i=this.configurationDefaultsOverrides.get(t)?.configurationDefaultOverrideValue,n,o;i&&(!e.disallowConfigurationDefault||!i.source)&&(n=i.value,o=i.source),Vn(n)&&(n=e.defaultDefaultValue,o=void 0),Vn(n)&&(n=Mre(e.type)),e.default=n,e.defaultValueSource=o}},v$="\\[([^\\]]+)\\]",f$=new RegExp(v$,"g"),hp=`^(${v$})+$`,Gr=new RegExp(hp);function Yv(r){let t=[];if(Gr.test(r)){let e=f$.exec(r);for(;e?.length;){let i=e[1].trim();i&&t.push(i),e=f$.exec(r)}}return yo(t)}function vk(r){return r.reduce((t,e)=>`${t}[${e}]`,"")}function Mre(r){switch(Array.isArray(r)?r[0]:r){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var bk=new yW;Ne.add(xi.Configuration,bk);function Ore(r,t){return r.trim()?Gr.test(r)?h("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",r):bk.getConfigurationProperties()[r]!==void 0?h("config.property.duplicate","Cannot register '{0}'. This property is already registered.",r):t.policy?.name&&bk.getPolicyConfigurations().get(t.policy?.name)!==void 0?h("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",r,t.policy?.name,bk.getPolicyConfigurations().get(t.policy?.name)):null:h("config.property.empty","Cannot register an empty property")}var yd=8,yk=class{_values;constructor(t){this._values=t}hasChanged(t){return this._values[t]}},Jw=class{stableMinimapLayoutInput;stableFitMaxMinimapScale;stableFitRemainingWidth;constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Li=class{id;name;defaultValue;schema;constructor(t,e,i,n){this.id=t,this.name=e,this.defaultValue=i,this.schema=n}applyUpdate(t,e){return Ik(t,e)}compute(t,e,i){return i}},Xv=class{constructor(t,e){this.newValue=t;this.didChange=e}};function Ik(r,t){if(typeof r!="object"||typeof t!="object"||!r||!t)return new Xv(t,r!==t);if(Array.isArray(r)||Array.isArray(t)){let i=Array.isArray(r)&&Array.isArray(t)&&ti(r,t);return new Xv(t,!i)}let e=!1;for(let i in t)if(t.hasOwnProperty(i)){let n=Ik(r[i],t[i]);n.didChange&&(r[i]=n.newValue,e=!0)}return new Xv(r,e)}var Kg=class{id;name;defaultValue;schema=void 0;constructor(t){this.id=t,this.name="_never_",this.defaultValue=void 0}applyUpdate(t,e){return Ik(t,e)}validate(t){return this.defaultValue}},Uh=class{id;name;defaultValue;schema;constructor(t,e,i,n){this.id=t,this.name=e,this.defaultValue=i,this.schema=n}applyUpdate(t,e){return Ik(t,e)}validate(t){return typeof t>"u"?this.defaultValue:t}compute(t,e,i){return i}};function Pe(r,t){return typeof r>"u"?t:r==="false"?!1:!!r}var Bt=class extends Uh{constructor(t,e,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(t,e,i,n)}validate(t){return Pe(t,this.defaultValue)}};function Hh(r,t,e,i){if(typeof r>"u")return t;let n=parseInt(r,10);return isNaN(n)?t:(n=Math.max(e,n),n=Math.min(i,n),n|0)}var wi=class r extends Uh{static clampedInt(t,e,i,n){return Hh(t,e,i,n)}minimum;maximum;constructor(t,e,i,n,o,s=void 0){typeof s<"u"&&(s.type="integer",s.default=i,s.minimum=n,s.maximum=o),super(t,e,i,s),this.minimum=n,this.maximum=o}validate(t){return r.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}};function I$(r,t,e,i){if(typeof r>"u")return t;let n=aa.float(r,t);return aa.clamp(n,e,i)}var aa=class r extends Uh{static clamp(t,e,i){return t<e?e:t>i?i:t}static float(t,e){if(typeof t=="number")return t;if(typeof t>"u")return e;let i=parseFloat(t);return isNaN(i)?e:i}validationFn;constructor(t,e,i,n,o){typeof o<"u"&&(o.type="number",o.default=i),super(t,e,i,o),this.validationFn=n}validate(t){return this.validationFn(r.float(t,this.defaultValue))}},Lr=class r extends Uh{static string(t,e){return typeof t!="string"?e:t}constructor(t,e,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(t,e,i,n)}validate(t){return r.string(t,this.defaultValue)}};function Qi(r,t,e,i){return typeof r!="string"?t:i&&r in i?i[r]:e.indexOf(r)===-1?t:r}var Ki=class extends Uh{_allowedValues;constructor(t,e,i,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=n,o.default=i),super(t,e,i,o),this._allowedValues=n}validate(t){return Qi(t,this.defaultValue,this._allowedValues)}},Zv=class extends Li{_allowedValues;_convert;constructor(t,e,i,n,o,s,a=void 0){typeof a<"u"&&(a.type="string",a.enum=o,a.default=n),super(t,e,i,a),this._allowedValues=o,this._convert=s}validate(t){return typeof t!="string"?this.defaultValue:this._allowedValues.indexOf(t)===-1?this.defaultValue:this._convert(t)}};function Nre(r){switch(r){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var IW=class extends Li{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[h("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),h("accessibilitySupport.on","Optimize for usage with a Screen Reader."),h("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(t){switch(t){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(t,e,i){return i===0?t.accessibilitySupport:i}},CW=class extends Li{constructor(){let t={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",t,{"editor.comments.insertSpace":{type:"boolean",default:t.insertSpace,description:h("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:t.ignoreEmptyLines,description:h("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{insertSpace:Pe(e.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Pe(e.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}};function Fre(r){switch(r){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}function Bre(r){switch(r){case"line":return 1;case"block":return 2;case"underline":return 3;case"line-thin":return 4;case"block-outline":return 5;case"underline-thin":return 6}}var SW=class extends Kg{constructor(){super(144)}compute(t,e,i){let n=["monaco-editor"];return e.get(40)&&n.push(e.get(40)),t.extraEditorClassName&&n.push(t.extraEditorClassName),e.get(75)==="default"?n.push("mouse-default"):e.get(75)==="copy"&&n.push("mouse-copy"),e.get(113)&&n.push("showUnused"),e.get(142)&&n.push("showDeprecated"),n.join(" ")}},wW=class extends Bt{constructor(){super(38,"emptySelectionClipboard",!0,{description:h("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(t,e,i){return i&&t.emptySelectionClipboard}},EW=class extends Li{constructor(){let t={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(42,"find",t,{"editor.find.cursorMoveOnType":{type:"boolean",default:t.cursorMoveOnType,description:h("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:t.seedSearchStringFromSelection,enumDescriptions:[h("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),h("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),h("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:h("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:t.autoFindInSelection,enumDescriptions:[h("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),h("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),h("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:t.globalFindClipboard,description:h("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:be},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:t.addExtraSpaceOnTop,description:h("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:t.loop,description:h("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{cursorMoveOnType:Pe(e.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":Qi(e.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":Qi(e.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Pe(e.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Pe(e.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Pe(e.loop,this.defaultValue.loop)}}},vd=class r extends Li{static OFF='"liga" off, "calt" off';static ON='"liga" on, "calt" on';constructor(){super(52,"fontLigatures",r.OFF,{anyOf:[{type:"boolean",description:h("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"||t.length===0?r.OFF:t==="true"?r.ON:t:t?r.ON:r.OFF}},jv=class r extends Li{static OFF="normal";static TRANSLATE="translate";constructor(){super(55,"fontVariations",r.OFF,{anyOf:[{type:"boolean",description:h("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"?r.OFF:t==="true"?r.TRANSLATE:t:t?r.TRANSLATE:r.OFF}compute(t,e,i){return t.fontInfo.fontVariationSettings}},TW=class extends Kg{constructor(){super(51)}compute(t,e,i){return t.fontInfo}},xW=class extends Uh{constructor(){super(53,"fontSize",Ss.fontSize,{type:"number",minimum:6,maximum:100,default:Ss.fontSize,description:h("fontSize","Controls the font size in pixels.")})}validate(t){let e=aa.float(t,this.defaultValue);return e===0?Ss.fontSize:aa.clamp(e,6,100)}compute(t,e,i){return t.fontInfo.fontSize}},_W=class r extends Li{static SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];static MINIMUM_VALUE=1;static MAXIMUM_VALUE=1e3;constructor(){super(54,"fontWeight",Ss.fontWeight,{anyOf:[{type:"number",minimum:r.MINIMUM_VALUE,maximum:r.MAXIMUM_VALUE,errorMessage:h("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:r.SUGGESTION_VALUES}],default:Ss.fontWeight,description:h("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(t){return t==="normal"||t==="bold"?t:String(wi.clampedInt(t,Ss.fontWeight,r.MINIMUM_VALUE,r.MAXIMUM_VALUE))}},DW=class extends Li{constructor(){let t={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},e={type:"string",enum:["peek","gotoAndPeek","goto"],default:t.multiple,enumDescriptions:[h("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),h("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),h("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(59,"gotoLocation",t,{"editor.gotoLocation.multiple":{deprecationMessage:h("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleTypeDefinitions":{description:h("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleDeclarations":{description:h("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleImplementations":{description:h("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...e},"editor.gotoLocation.multipleReferences":{description:h("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...e},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:t.alternativeDefinitionCommand,enum:i,description:h("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:t.alternativeTypeDefinitionCommand,enum:i,description:h("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:t.alternativeDeclarationCommand,enum:i,description:h("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:t.alternativeImplementationCommand,enum:i,description:h("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:t.alternativeReferenceCommand,enum:i,description:h("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{multiple:Qi(e.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:e.multipleDefinitions??Qi(e.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:e.multipleTypeDefinitions??Qi(e.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:e.multipleDeclarations??Qi(e.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:e.multipleImplementations??Qi(e.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:e.multipleReferences??Qi(e.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:e.multipleTests??Qi(e.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Lr.string(e.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Lr.string(e.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Lr.string(e.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Lr.string(e.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Lr.string(e.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Lr.string(e.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},LW=class extends Li{constructor(){let t={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(61,"hover",t,{"editor.hover.enabled":{type:"boolean",default:t.enabled,description:h("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:t.delay,minimum:0,maximum:1e4,description:h("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:t.sticky,description:h("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:t.hidingDelay,description:h("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:t.above,description:h("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),delay:wi.clampedInt(e.delay,this.defaultValue.delay,0,1e4),sticky:Pe(e.sticky,this.defaultValue.sticky),hidingDelay:wi.clampedInt(e.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Pe(e.above,this.defaultValue.above)}}};var eE=class r extends Kg{constructor(){super(147)}compute(t,e,i){return r.computeLayout(e,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(t){let e=t.height/t.lineHeight,i=Math.floor(t.paddingTop/t.lineHeight),n=Math.floor(t.paddingBottom/t.lineHeight);t.scrollBeyondLastLine&&(n=Math.max(n,e-1));let o=(i+t.viewLineCount+n)/(t.pixelRatio*t.height),s=Math.floor(t.viewLineCount/o);return{typicalViewportLineCount:e,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:o,minimapLineCount:s}}static _computeMinimapLayout(t,e){let i=t.outerWidth,n=t.outerHeight,o=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};let s=e.stableMinimapLayoutInput,a=s&&t.outerHeight===s.outerHeight&&t.lineHeight===s.lineHeight&&t.typicalHalfwidthCharacterWidth===s.typicalHalfwidthCharacterWidth&&t.pixelRatio===s.pixelRatio&&t.scrollBeyondLastLine===s.scrollBeyondLastLine&&t.paddingTop===s.paddingTop&&t.paddingBottom===s.paddingBottom&&t.minimap.enabled===s.minimap.enabled&&t.minimap.side===s.minimap.side&&t.minimap.size===s.minimap.size&&t.minimap.showSlider===s.minimap.showSlider&&t.minimap.renderCharacters===s.minimap.renderCharacters&&t.minimap.maxColumn===s.minimap.maxColumn&&t.minimap.scale===s.minimap.scale&&t.verticalScrollbarWidth===s.verticalScrollbarWidth&&t.isViewportWrapping===s.isViewportWrapping,l=t.lineHeight,d=t.typicalHalfwidthCharacterWidth,c=t.scrollBeyondLastLine,u=t.minimap.renderCharacters,p=o>=2?Math.round(t.minimap.scale*2):t.minimap.scale,m=t.minimap.maxColumn,g=t.minimap.size,f=t.minimap.side,b=t.verticalScrollbarWidth,y=t.viewLineCount,I=t.remainingWidth,E=t.isViewportWrapping,S=u?2:3,w=Math.floor(o*n),D=w/o,k=!1,R=!1,A=S*p,H=p/o,z=1;if(g==="fill"||g==="fit"){let{typicalViewportLineCount:Ie,extraLinesBeforeFirstLine:ge,extraLinesBeyondLastLine:He,desiredRatio:_e,minimapLineCount:xt}=r.computeContainedMinimapLineCount({viewLineCount:y,scrollBeyondLastLine:c,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:n,lineHeight:l,pixelRatio:o});if(y/xt>1)k=!0,R=!0,p=1,A=1,H=p/o;else{let je=!1,_n=p+1;if(g==="fit"){let pn=Math.ceil((ge+y+He)*A);E&&a&&I<=e.stableFitRemainingWidth?(je=!0,_n=e.stableFitMaxMinimapScale):je=pn>w}if(g==="fill"||je){k=!0;let pn=p;A=Math.min(l*o,Math.max(1,Math.floor(1/_e))),E&&a&&I<=e.stableFitRemainingWidth&&(_n=e.stableFitMaxMinimapScale),p=Math.min(_n,Math.max(1,Math.floor(A/S))),p>pn&&(z=Math.min(2,p/pn)),H=p/o/z,w=Math.ceil(Math.max(Ie,ge+y+He)*A),E?(e.stableMinimapLayoutInput=t,e.stableFitRemainingWidth=I,e.stableFitMaxMinimapScale=p):(e.stableMinimapLayoutInput=null,e.stableFitRemainingWidth=0)}}}let Z=Math.floor(m*H),fe=Math.min(Z,Math.max(0,Math.floor((I-b-2)*H/(d+H)))+yd),Ve=Math.floor(o*fe),me=Ve/o;Ve=Math.floor(Ve*z);let ce=u?1:2,xe=f==="left"?0:i-fe-b;return{renderMinimap:ce,minimapLeft:xe,minimapWidth:fe,minimapHeightIsEditorHeight:k,minimapIsSampling:R,minimapScale:p,minimapLineHeight:A,minimapCanvasInnerWidth:Ve,minimapCanvasInnerHeight:w,minimapCanvasOuterWidth:me,minimapCanvasOuterHeight:D}}static computeLayout(t,e){let i=e.outerWidth|0,n=e.outerHeight|0,o=e.lineHeight|0,s=e.lineNumbersDigitCount|0,a=e.typicalHalfwidthCharacterWidth,l=e.maxDigitWidth,d=e.pixelRatio,c=e.viewLineCount,u=t.get(139),p=u==="inherit"?t.get(138):u,m=p==="inherit"?t.get(134):p,g=t.get(137),f=e.isDominatedByLongLines,b=t.get(58),y=t.get(69).renderType!==0,I=t.get(70),E=t.get(107),S=t.get(85),w=t.get(74),D=t.get(105),k=D.verticalScrollbarSize,R=D.verticalHasArrows,A=D.arrowSize,H=D.horizontalScrollbarSize,z=t.get(44),Z=t.get(112)!=="never",fe=t.get(67);z&&Z&&(fe+=16);let Ve=0;if(y){let No=Math.max(s,I);Ve=Math.round(No*l)}let me=0;b&&(me=o*e.glyphMarginDecorationLaneCount);let ce=0,xe=ce+me,Ie=xe+Ve,ge=Ie+fe,He=i-me-Ve-fe,_e=!1,xt=!1,bt=-1;p==="inherit"&&f?(_e=!0,xt=!0):m==="on"||m==="bounded"?xt=!0:m==="wordWrapColumn"&&(bt=g);let je=r._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:o,typicalHalfwidthCharacterWidth:a,pixelRatio:d,scrollBeyondLastLine:E,paddingTop:S.top,paddingBottom:S.bottom,minimap:w,verticalScrollbarWidth:k,viewLineCount:c,remainingWidth:He,isViewportWrapping:xt},e.memory||new Jw);je.renderMinimap!==0&&je.minimapLeft===0&&(ce+=je.minimapWidth,xe+=je.minimapWidth,Ie+=je.minimapWidth,ge+=je.minimapWidth);let _n=He-je.minimapWidth,pn=Math.max(1,Math.floor((_n-k-2)/a)),no=R?A:0;return xt&&(bt=Math.max(1,pn),m==="bounded"&&(bt=Math.min(bt,g))),{width:i,height:n,glyphMarginLeft:ce,glyphMarginWidth:me,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount,lineNumbersLeft:xe,lineNumbersWidth:Ve,decorationsLeft:Ie,decorationsWidth:fe,contentLeft:ge,contentWidth:_n,minimap:je,viewportColumn:pn,isWordWrapMinified:_e,isViewportWrapping:xt,wrappingColumn:bt,verticalScrollbarWidth:k,horizontalScrollbarHeight:H,overviewRuler:{top:no,width:k,height:n-2*no,right:0}}}},kW=class extends Li{constructor(){super(141,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(t){return Qi(t,"simple",["simple","advanced"])}compute(t,e,i){return e.get(2)===2?"advanced":i}};var RW=class extends Li{constructor(){let t={enabled:"onCode"};super(66,"lightbulb",t,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:["off","onCode","on"],default:t.enabled,enumDescriptions:[h("editor.lightbulb.enabled.off","Disable the code action menu."),h("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),h("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(t){return!t||typeof t!="object"?this.defaultValue:{enabled:Qi(t.enabled,this.defaultValue.enabled,["off","onCode","on"])}}},AW=class extends Li{constructor(){let t={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(117,"stickyScroll",t,{"editor.stickyScroll.enabled":{type:"boolean",default:t.enabled,description:h("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:t.maxLineCount,minimum:1,maximum:20,description:h("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:t.defaultModel,description:h("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:t.scrollWithEditor,description:h("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),maxLineCount:wi.clampedInt(e.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:Qi(e.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Pe(e.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},PW=class extends Li{constructor(){let t={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(143,"inlayHints",t,{"editor.inlayHints.enabled":{type:"string",default:t.enabled,description:h("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h("editor.inlayHints.on","Inlay hints are enabled"),h("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",be?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",be?"Ctrl+Option":"Ctrl+Alt"),h("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:t.fontSize,markdownDescription:h("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:t.fontFamily,markdownDescription:h("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:t.padding,description:h("inlayHints.padding","Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:t.maximumLength,markdownDescription:h("inlayHints.maximumLength","Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return typeof e.enabled=="boolean"&&(e.enabled=e.enabled?"on":"off"),{enabled:Qi(e.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:wi.clampedInt(e.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Lr.string(e.fontFamily,this.defaultValue.fontFamily),padding:Pe(e.padding,this.defaultValue.padding),maximumLength:wi.clampedInt(e.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},MW=class extends Li{constructor(){super(67,"lineDecorationsWidth",10)}validate(t){return typeof t=="string"&&/^\d+(\.\d+)?ch$/.test(t)?-parseFloat(t.substring(0,t.length-2)):wi.clampedInt(t,this.defaultValue,0,1e3)}compute(t,e,i){return i<0?wi.clampedInt(-i*t.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}},OW=class extends aa{constructor(){super(68,"lineHeight",Ss.lineHeight,t=>aa.clamp(t,0,150),{markdownDescription:h("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(t,e,i){return t.fontInfo.lineHeight}},NW=class extends Li{constructor(){let t={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(74,"minimap",t,{"editor.minimap.enabled":{type:"boolean",default:t.enabled,description:h("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:t.autohide,description:h("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),h("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:t.size,description:h("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:t.side,description:h("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:t.showSlider,description:h("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:t.scale,minimum:1,maximum:3,enum:[1,2,3],description:h("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:t.renderCharacters,description:h("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:t.maxColumn,description:h("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:t.showRegionSectionHeaders,description:h("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:t.showMarkSectionHeaders,description:h("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:t.sectionHeaderFontSize,description:h("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:t.sectionHeaderLetterSpacing,description:h("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),autohide:Pe(e.autohide,this.defaultValue.autohide),size:Qi(e.size,this.defaultValue.size,["proportional","fill","fit"]),side:Qi(e.side,this.defaultValue.side,["right","left"]),showSlider:Qi(e.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Pe(e.renderCharacters,this.defaultValue.renderCharacters),scale:wi.clampedInt(e.scale,1,1,3),maxColumn:wi.clampedInt(e.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Pe(e.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Pe(e.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:aa.clamp(e.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:aa.clamp(e.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function Vre(r){return r==="ctrlCmd"?be?"metaKey":"ctrlKey":"altKey"}var FW=class extends Li{constructor(){super(85,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{top:wi.clampedInt(e.top,0,0,1e3),bottom:wi.clampedInt(e.bottom,0,0,1e3)}}},BW=class extends Li{constructor(){let t={enabled:!0,cycle:!0};super(87,"parameterHints",t,{"editor.parameterHints.enabled":{type:"boolean",default:t.enabled,description:h("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:t.cycle,description:h("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),cycle:Pe(e.cycle,this.defaultValue.cycle)}}},VW=class extends Kg{constructor(){super(145)}compute(t,e,i){return t.pixelRatio}},WW=class extends Li{constructor(){super(89,"placeholder",void 0)}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t:this.defaultValue}},UW=class extends Li{defaultValue;constructor(){let t={other:"on",comments:"off",strings:"off"},e=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h("on","Quick suggestions show inside the suggest widget"),h("inline","Quick suggestions show as ghost text"),h("off","Quick suggestions are disabled")]}];super(91,"quickSuggestions",t,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:e,default:t.strings,description:h("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:e,default:t.comments,description:h("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:e,default:t.other,description:h("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:t,markdownDescription:h("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=t}validate(t){if(typeof t=="boolean"){let d=t?"on":"off";return{comments:d,strings:d,other:d}}if(!t||typeof t!="object")return this.defaultValue;let{other:e,comments:i,strings:n}=t,o=["on","inline","off"],s,a,l;return typeof e=="boolean"?s=e?"on":"off":s=Qi(e,this.defaultValue.other,o),typeof i=="boolean"?a=i?"on":"off":a=Qi(i,this.defaultValue.comments,o),typeof n=="boolean"?l=n?"on":"off":l=Qi(n,this.defaultValue.strings,o),{other:s,comments:a,strings:l}}};var HW=class extends Li{constructor(){super(69,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h("lineNumbers.off","Line numbers are not rendered."),h("lineNumbers.on","Line numbers are rendered as absolute number."),h("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),h("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:h("lineNumbers","Controls the display of line numbers.")})}validate(t){let e=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof t<"u"&&(typeof t=="function"?(e=4,i=t):t==="interval"?e=3:t==="relative"?e=2:t==="on"?e=1:e=0),{renderType:e,renderFn:i}}};function Gg(r){let t=r.get(100);return t==="editable"?r.get(93):t!=="on"}var zW=class extends Li{constructor(){let t=[],e={type:"number",description:h("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(104,"rulers",t,{type:"array",items:{anyOf:[e,{type:["object"],properties:{column:e,color:{type:"string",description:h("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:t,description:h("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(t){if(Array.isArray(t)){let e=[];for(let i of t)if(typeof i=="number")e.push({column:wi.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){let n=i;e.push({column:wi.clampedInt(n.column,0,0,1e4),color:n.color})}return e.sort((i,n)=>i.column-n.column),e}return this.defaultValue}},KW=class extends Li{constructor(){super(94,"readOnlyMessage",void 0)}validate(t){return!t||typeof t!="object"?this.defaultValue:t}};function y$(r,t){if(typeof r!="string")return t;switch(r){case"hidden":return 2;case"visible":return 3;default:return 1}}var GW=class extends Li{constructor(){let t={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(105,"scrollbar",t,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),h("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),h("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),h("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),h("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:h("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:t.verticalScrollbarSize,description:h("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:t.horizontalScrollbarSize,description:h("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:t.scrollByPage,description:h("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:t.ignoreHorizontalScrollbarInContentHeight,description:h("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t,i=wi.clampedInt(e.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=wi.clampedInt(e.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:wi.clampedInt(e.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:y$(e.vertical,this.defaultValue.vertical),horizontal:y$(e.horizontal,this.defaultValue.horizontal),useShadows:Pe(e.useShadows,this.defaultValue.useShadows),verticalHasArrows:Pe(e.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Pe(e.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Pe(e.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Pe(e.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:wi.clampedInt(e.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:wi.clampedInt(e.verticalSliderSize,n,0,1e3),scrollByPage:Pe(e.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Pe(e.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},bd="inUntrustedWorkspace",zg={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},qW=class extends Li{constructor(){let t={nonBasicASCII:bd,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:bd,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(127,"unicodeHighlight",t,{[zg.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,bd],default:t.nonBasicASCII,description:h("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[zg.invisibleCharacters]:{restricted:!0,type:"boolean",default:t.invisibleCharacters,description:h("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[zg.ambiguousCharacters]:{restricted:!0,type:"boolean",default:t.ambiguousCharacters,description:h("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[zg.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,bd],default:t.includeComments,description:h("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[zg.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,bd],default:t.includeStrings,description:h("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[zg.allowedCharacters]:{restricted:!0,type:"object",default:t.allowedCharacters,description:h("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[zg.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:t.allowedLocales,description:h("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(t,e){let i=!1;e.allowedCharacters&&t&&($t(t.allowedCharacters,e.allowedCharacters)||(t={...t,allowedCharacters:e.allowedCharacters},i=!0)),e.allowedLocales&&t&&($t(t.allowedLocales,e.allowedLocales)||(t={...t,allowedLocales:e.allowedLocales},i=!0));let n=super.applyUpdate(t,e);return i?new Xv(n.newValue,!0):n}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{nonBasicASCII:Qv(e.nonBasicASCII,bd,[!0,!1,bd]),invisibleCharacters:Pe(e.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Pe(e.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:Qv(e.includeComments,bd,[!0,!1,bd]),includeStrings:Qv(e.includeStrings,bd,[!0,!1,bd]),allowedCharacters:this.validateBooleanMap(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(t.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(t,e){if(typeof t!="object"||!t)return e;let i={};for(let[n,o]of Object.entries(t))o===!0&&(i[n]=!0);return i}},jW=class extends Li{constructor(){let t={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!1};super(63,"inlineSuggest",t,{"editor.inlineSuggest.enabled":{type:"boolean",default:t.enabled,description:h("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:t.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),h("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),h("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:h("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:t.syntaxHighlightingEnabled,description:h("inlineSuggest.syntaxHighlightingEnabled","Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:t.suppressSuggestions,description:h("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:t.fontFamily,description:h("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),mode:Qi(e.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:Qi(e.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Pe(e.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Pe(e.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Lr.string(e.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:Pe(e.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled)}}},$W=class extends Li{constructor(){let t={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(64,"experimentalInlineEdit",t,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:t.enabled,description:h("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:t.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),h("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),h("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:h("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:t.fontFamily,description:h("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),showToolbar:Qi(e.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Lr.string(e.fontFamily,this.defaultValue.fontFamily),keepOnBlur:Pe(e.keepOnBlur,this.defaultValue.keepOnBlur)}}},YW=class extends Li{constructor(){let t={enabled:kc.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:kc.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",t,{"editor.bracketPairColorization.enabled":{type:"boolean",default:t.enabled,markdownDescription:h("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:t.independentColorPoolPerBracketType,description:h("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Pe(e.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},ZW=class extends Li{constructor(){let t={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",t,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairs.true","Enables bracket pair guides."),h("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),h("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:t.bracketPairs,description:h("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),h("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),h("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:t.bracketPairsHorizontal,description:h("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:t.highlightActiveBracketPair,description:h("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:t.indentation,description:h("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),h("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),h("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:t.highlightActiveIndentation,description:h("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{bracketPairs:Qv(e.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:Qv(e.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Pe(e.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Pe(e.indentation,this.defaultValue.indentation),highlightActiveIndentation:Qv(e.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function Qv(r,t,e){let i=e.indexOf(r);return i===-1?t:e[i]}var XW=class extends Li{constructor(){let t={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(120,"suggest",t,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),h("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:t.insertMode,description:h("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:t.filterGraceful,description:h("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:t.localityBonus,description:h("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:t.shareSuggestSelections,markdownDescription:h("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),h("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),h("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:t.selectionMode,markdownDescription:h("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:t.snippetsPreventQuickSuggestions,description:h("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:t.showIcons,description:h("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:t.showStatusBar,description:h("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:t.preview,description:h("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:t.showInlineDetails,description:h("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{insertMode:Qi(e.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Pe(e.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Pe(e.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Pe(e.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Pe(e.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:Qi(e.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Pe(e.showIcons,this.defaultValue.showIcons),showStatusBar:Pe(e.showStatusBar,this.defaultValue.showStatusBar),preview:Pe(e.preview,this.defaultValue.preview),previewMode:Qi(e.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Pe(e.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Pe(e.showMethods,this.defaultValue.showMethods),showFunctions:Pe(e.showFunctions,this.defaultValue.showFunctions),showConstructors:Pe(e.showConstructors,this.defaultValue.showConstructors),showDeprecated:Pe(e.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Pe(e.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Pe(e.showFields,this.defaultValue.showFields),showVariables:Pe(e.showVariables,this.defaultValue.showVariables),showClasses:Pe(e.showClasses,this.defaultValue.showClasses),showStructs:Pe(e.showStructs,this.defaultValue.showStructs),showInterfaces:Pe(e.showInterfaces,this.defaultValue.showInterfaces),showModules:Pe(e.showModules,this.defaultValue.showModules),showProperties:Pe(e.showProperties,this.defaultValue.showProperties),showEvents:Pe(e.showEvents,this.defaultValue.showEvents),showOperators:Pe(e.showOperators,this.defaultValue.showOperators),showUnits:Pe(e.showUnits,this.defaultValue.showUnits),showValues:Pe(e.showValues,this.defaultValue.showValues),showConstants:Pe(e.showConstants,this.defaultValue.showConstants),showEnums:Pe(e.showEnums,this.defaultValue.showEnums),showEnumMembers:Pe(e.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Pe(e.showKeywords,this.defaultValue.showKeywords),showWords:Pe(e.showWords,this.defaultValue.showWords),showColors:Pe(e.showColors,this.defaultValue.showColors),showFiles:Pe(e.showFiles,this.defaultValue.showFiles),showReferences:Pe(e.showReferences,this.defaultValue.showReferences),showFolders:Pe(e.showFolders,this.defaultValue.showFolders),showTypeParameters:Pe(e.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Pe(e.showSnippets,this.defaultValue.showSnippets),showUsers:Pe(e.showUsers,this.defaultValue.showUsers),showIssues:Pe(e.showIssues,this.defaultValue.showIssues)}}},QW=class extends Li{constructor(){super(115,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(t){return!t||typeof t!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Pe(t.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Pe(t.selectSubwords,this.defaultValue.selectSubwords)}}},JW=class extends Li{constructor(){let t=[];super(132,"wordSegmenterLocales",t,{anyOf:[{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(t){if(typeof t=="string"&&(t=[t]),Array.isArray(t)){let e=[];for(let i of t)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&e.push(i)}catch{}return e}return this.defaultValue}};var eU=class extends Li{constructor(){super(140,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),h("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),h("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),h("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:h("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(t){switch(t){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(t,e,i){return e.get(2)===2?0:i}},tU=class extends Kg{constructor(){super(148)}compute(t,e,i){let n=e.get(147);return{isDominatedByLongLines:t.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}},iU=class extends Li{constructor(){let t={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",t,{"editor.dropIntoEditor.enabled":{type:"boolean",default:t.enabled,markdownDescription:h("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),h("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),showDropSelector:Qi(e.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},nU=class extends Li{constructor(){let t={enabled:!0,showPasteSelector:"afterPaste"};super(86,"pasteAs",t,{"editor.pasteAs.enabled":{type:"boolean",default:t.enabled,markdownDescription:h("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),h("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;let e=t;return{enabled:Pe(e.enabled,this.defaultValue.enabled),showPasteSelector:Qi(e.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},Wre="Consolas, 'Courier New', monospace",Ure="Menlo, Monaco, 'Courier New', monospace",Hre="'Droid Sans Mono', 'monospace', monospace",Ss={fontFamily:be?Ure:_t?Hre:Wre,fontWeight:"normal",fontSize:be?12:14,lineHeight:0,letterSpacing:0},Jv=[];function se(r){return Jv[r.id]=r,r}var yl={acceptSuggestionOnCommitCharacter:se(new Bt(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:se(new Ki(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:se(new IW),accessibilityPageSize:se(new wi(3,"accessibilityPageSize",10,1,1073741824,{description:h("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:se(new Lr(4,"ariaLabel",h("editorViewAccessibleLabel","Editor content"))),ariaRequired:se(new Bt(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:se(new Bt(8,"screenReaderAnnounceInlineSuggestion",!0,{description:h("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:se(new Ki(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),h("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:se(new Ki(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),h("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:h("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:se(new Ki(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:se(new Ki(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:h("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:se(new Ki(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),h("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:se(new Zv(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],Nre,{enumDescriptions:[h("editor.autoIndent.none","The editor will not insert indentation automatically."),h("editor.autoIndent.keep","The editor will keep the current line's indentation."),h("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),h("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:se(new Bt(13,"automaticLayout",!1)),autoSurround:se(new Ki(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),h("editor.autoSurround.quotes","Surround with quotes but not brackets."),h("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:h("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:se(new YW),bracketPairGuides:se(new ZW),stickyTabStops:se(new Bt(118,"stickyTabStops",!1,{description:h("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:se(new Bt(17,"codeLens",!0,{description:h("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:se(new Lr(18,"codeLensFontFamily","",{description:h("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:se(new wi(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:se(new Bt(20,"colorDecorators",!0,{description:h("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:se(new Ki(150,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),h("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),h("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:h("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:se(new wi(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:se(new Bt(22,"columnSelection",!1,{description:h("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:se(new CW),contextmenu:se(new Bt(24,"contextmenu",!0)),copyWithSyntaxHighlighting:se(new Bt(25,"copyWithSyntaxHighlighting",!0,{description:h("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:se(new Zv(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],Fre,{description:h("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:se(new Ki(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),h("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:h("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:se(new Zv(28,"cursorStyle",1,"line",["line","block","underline","line-thin","block-outline","underline-thin"],Bre,{description:h("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:se(new wi(29,"cursorSurroundingLines",0,0,1073741824,{description:h("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:se(new Ki(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:h("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:se(new wi(31,"cursorWidth",0,0,1073741824,{markdownDescription:h("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:se(new Bt(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:se(new Bt(33,"disableMonospaceOptimizations",!1)),domReadOnly:se(new Bt(34,"domReadOnly",!1)),dragAndDrop:se(new Bt(35,"dragAndDrop",!0,{description:h("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:se(new wW),dropIntoEditor:se(new iU),experimentalEditContextEnabled:se(new Bt(37,"experimentalEditContextEnabled",!1,{description:h("experimentalEditContextEnabled","Sets whether the new experimental edit context should be used instead of the text area.")})),stickyScroll:se(new AW),experimentalWhitespaceRendering:se(new Ki(39,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),h("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),h("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:h("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:se(new Lr(40,"extraEditorClassName","")),fastScrollSensitivity:se(new aa(41,"fastScrollSensitivity",5,r=>r<=0?5:r,{markdownDescription:h("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:se(new EW),fixedOverflowWidgets:se(new Bt(43,"fixedOverflowWidgets",!1)),folding:se(new Bt(44,"folding",!0,{description:h("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:se(new Ki(45,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),h("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:h("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:se(new Bt(46,"foldingHighlight",!0,{description:h("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:se(new Bt(47,"foldingImportsByDefault",!1,{description:h("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:se(new wi(48,"foldingMaximumRegions",5e3,10,65e3,{description:h("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:se(new Bt(49,"unfoldOnClickAfterEndOfLine",!1,{description:h("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:se(new Lr(50,"fontFamily",Ss.fontFamily,{description:h("fontFamily","Controls the font family.")})),fontInfo:se(new TW),fontLigatures2:se(new vd),fontSize:se(new xW),fontWeight:se(new _W),fontVariations:se(new jv),formatOnPaste:se(new Bt(56,"formatOnPaste",!1,{description:h("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:se(new Bt(57,"formatOnType",!1,{description:h("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:se(new Bt(58,"glyphMargin",!0,{description:h("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:se(new DW),hideCursorInOverviewRuler:se(new Bt(60,"hideCursorInOverviewRuler",!1,{description:h("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:se(new LW),inDiffEditor:se(new Bt(62,"inDiffEditor",!1)),letterSpacing:se(new aa(65,"letterSpacing",Ss.letterSpacing,r=>aa.clamp(r,-5,20),{description:h("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:se(new RW),lineDecorationsWidth:se(new MW),lineHeight:se(new OW),lineNumbers:se(new HW),lineNumbersMinChars:se(new wi(70,"lineNumbersMinChars",5,1,300)),linkedEditing:se(new Bt(71,"linkedEditing",!1,{description:h("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:se(new Bt(72,"links",!0,{description:h("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:se(new Ki(73,"matchBrackets","always",["always","near","never"],{description:h("matchBrackets","Highlight matching brackets.")})),minimap:se(new NW),mouseStyle:se(new Ki(75,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:se(new aa(76,"mouseWheelScrollSensitivity",1,r=>r===0?1:r,{markdownDescription:h("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:se(new Bt(77,"mouseWheelZoom",!1,{markdownDescription:be?h("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:se(new Bt(78,"multiCursorMergeOverlapping",!0,{description:h("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:se(new Zv(79,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],Vre,{markdownEnumDescriptions:[h("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),h("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:se(new Ki(80,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h("multiCursorPaste.spread","Each cursor pastes a single line of the text."),h("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:h("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:se(new wi(81,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:se(new Ki(82,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h("occurrencesHighlight.off","Does not highlight occurrences."),h("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),h("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:se(new Bt(83,"overviewRulerBorder",!0,{description:h("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:se(new wi(84,"overviewRulerLanes",3,0,3)),padding:se(new FW),pasteAs:se(new nU),parameterHints:se(new BW),peekWidgetDefaultFocus:se(new Ki(88,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),h("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:h("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:se(new WW),definitionLinkOpensInPeek:se(new Bt(90,"definitionLinkOpensInPeek",!1,{description:h("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:se(new UW),quickSuggestionsDelay:se(new wi(92,"quickSuggestionsDelay",10,0,1073741824,{description:h("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:se(new Bt(93,"readOnly",!1)),readOnlyMessage:se(new KW),renameOnType:se(new Bt(95,"renameOnType",!1,{description:h("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:h("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:se(new Bt(96,"renderControlCharacters",!0,{description:h("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:se(new Ki(97,"renderFinalNewline",_t?"dimmed":"on",["off","on","dimmed"],{description:h("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:se(new Ki(98,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:h("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:se(new Bt(99,"renderLineHighlightOnlyWhenFocus",!1,{description:h("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:se(new Ki(100,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:se(new Ki(101,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),h("renderWhitespace.selection","Render whitespace characters only on selected text."),h("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:h("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:se(new wi(102,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:se(new Bt(103,"roundedSelection",!0,{description:h("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:se(new zW),scrollbar:se(new GW),scrollBeyondLastColumn:se(new wi(106,"scrollBeyondLastColumn",4,0,1073741824,{description:h("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:se(new Bt(107,"scrollBeyondLastLine",!0,{description:h("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:se(new Bt(108,"scrollPredominantAxis",!0,{description:h("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:se(new Bt(109,"selectionClipboard",!0,{description:h("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:_t})),selectionHighlight:se(new Bt(110,"selectionHighlight",!0,{description:h("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:se(new Bt(111,"selectOnLineNumbers",!0)),showFoldingControls:se(new Ki(112,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h("showFoldingControls.always","Always show the folding controls."),h("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),h("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:h("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:se(new Bt(113,"showUnused",!0,{description:h("showUnused","Controls fading out of unused code.")})),showDeprecated:se(new Bt(142,"showDeprecated",!0,{description:h("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:se(new PW),snippetSuggestions:se(new Ki(114,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),h("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),h("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),h("snippetSuggestions.none","Do not show snippet suggestions.")],description:h("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:se(new QW),smoothScrolling:se(new Bt(116,"smoothScrolling",!1,{description:h("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:se(new wi(119,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:se(new XW),inlineSuggest:se(new jW),inlineEdit:se(new $W),inlineCompletionsAccessibilityVerbose:se(new Bt(151,"inlineCompletionsAccessibilityVerbose",!1,{description:h("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:se(new wi(121,"suggestFontSize",0,0,1e3,{markdownDescription:h("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:se(new wi(122,"suggestLineHeight",0,0,1e3,{markdownDescription:h("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:se(new Bt(123,"suggestOnTriggerCharacters",!0,{description:h("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:se(new Ki(124,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h("suggestSelection.first","Always select the first suggestion."),h("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:se(new Ki(125,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),h("tabCompletion.off","Disable tab completions."),h("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h("tabCompletion","Enables tab completions.")})),tabIndex:se(new wi(126,"tabIndex",0,-1,1073741824)),unicodeHighlight:se(new qW),unusualLineTerminators:se(new Ki(128,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),h("unusualLineTerminators.off","Unusual line terminators are ignored."),h("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:h("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:se(new Bt(129,"useShadowDOM",!0)),useTabStops:se(new Bt(130,"useTabStops",!0,{description:h("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:se(new Ki(131,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h("wordBreak.normal","Use the default line break rule."),h("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:se(new JW),wordSeparators:se(new Lr(133,"wordSeparators",vW,{description:h("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:se(new Ki(134,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h("wordWrap.off","Lines will never wrap."),h("wordWrap.on","Lines will wrap at the viewport width."),h({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),h({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:se(new Lr(135,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:se(new Lr(136,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:se(new wi(137,"wordWrapColumn",80,1,1073741824,{markdownDescription:h({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:se(new Ki(138,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:se(new Ki(139,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:se(new SW),defaultColorDecorators:se(new Bt(149,"defaultColorDecorators",!1,{markdownDescription:h("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:se(new VW),tabFocusMode:se(new Bt(146,"tabFocusMode",!1,{markdownDescription:h("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:se(new eE),wrappingInfo:se(new tU),wrappingIndent:se(new eU),wrappingStrategy:se(new kW)};var U=class r{lineNumber;column;constructor(t,e){this.lineNumber=t,this.column=e}with(t=this.lineNumber,e=this.column){return t===this.lineNumber&&e===this.column?this:new r(t,e)}delta(t=0,e=0){return this.with(this.lineNumber+t,this.column+e)}equals(t){return r.equals(this,t)}static equals(t,e){return!t&&!e?!0:!!t&&!!e&&t.lineNumber===e.lineNumber&&t.column===e.column}isBefore(t){return r.isBefore(this,t)}static isBefore(t,e){return t.lineNumber<e.lineNumber?!0:e.lineNumber<t.lineNumber?!1:t.column<e.column}isBeforeOrEqual(t){return r.isBeforeOrEqual(this,t)}static isBeforeOrEqual(t,e){return t.lineNumber<e.lineNumber?!0:e.lineNumber<t.lineNumber?!1:t.column<=e.column}static compare(t,e){let i=t.lineNumber|0,n=e.lineNumber|0;if(i===n){let o=t.column|0,s=e.column|0;return o-s}return i-n}clone(){return new r(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(t){return new r(t.lineNumber,t.column)}static isIPosition(t){return t&&typeof t.lineNumber=="number"&&typeof t.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var F=class r{startLineNumber;startColumn;endLineNumber;endColumn;constructor(t,e,i,n){t>i||t===i&&e>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=t,this.endColumn=e):(this.startLineNumber=t,this.startColumn=e,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return r.isEmpty(this)}static isEmpty(t){return t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn}containsPosition(t){return r.containsPosition(this,t)}static containsPosition(t,e){return!(e.lineNumber<t.startLineNumber||e.lineNumber>t.endLineNumber||e.lineNumber===t.startLineNumber&&e.column<t.startColumn||e.lineNumber===t.endLineNumber&&e.column>t.endColumn)}static strictContainsPosition(t,e){return!(e.lineNumber<t.startLineNumber||e.lineNumber>t.endLineNumber||e.lineNumber===t.startLineNumber&&e.column<=t.startColumn||e.lineNumber===t.endLineNumber&&e.column>=t.endColumn)}containsRange(t){return r.containsRange(this,t)}static containsRange(t,e){return!(e.startLineNumber<t.startLineNumber||e.endLineNumber<t.startLineNumber||e.startLineNumber>t.endLineNumber||e.endLineNumber>t.endLineNumber||e.startLineNumber===t.startLineNumber&&e.startColumn<t.startColumn||e.endLineNumber===t.endLineNumber&&e.endColumn>t.endColumn)}strictContainsRange(t){return r.strictContainsRange(this,t)}static strictContainsRange(t,e){return!(e.startLineNumber<t.startLineNumber||e.endLineNumber<t.startLineNumber||e.startLineNumber>t.endLineNumber||e.endLineNumber>t.endLineNumber||e.startLineNumber===t.startLineNumber&&e.startColumn<=t.startColumn||e.endLineNumber===t.endLineNumber&&e.endColumn>=t.endColumn)}plusRange(t){return r.plusRange(this,t)}static plusRange(t,e){let i,n,o,s;return e.startLineNumber<t.startLineNumber?(i=e.startLineNumber,n=e.startColumn):e.startLineNumber===t.startLineNumber?(i=e.startLineNumber,n=Math.min(e.startColumn,t.startColumn)):(i=t.startLineNumber,n=t.startColumn),e.endLineNumber>t.endLineNumber?(o=e.endLineNumber,s=e.endColumn):e.endLineNumber===t.endLineNumber?(o=e.endLineNumber,s=Math.max(e.endColumn,t.endColumn)):(o=t.endLineNumber,s=t.endColumn),new r(i,n,o,s)}intersectRanges(t){return r.intersectRanges(this,t)}static intersectRanges(t,e){let i=t.startLineNumber,n=t.startColumn,o=t.endLineNumber,s=t.endColumn,a=e.startLineNumber,l=e.startColumn,d=e.endLineNumber,c=e.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),o>d?(o=d,s=c):o===d&&(s=Math.min(s,c)),i>o||i===o&&n>s?null:new r(i,n,o,s)}equalsRange(t){return r.equalsRange(this,t)}static equalsRange(t,e){return!t&&!e?!0:!!t&&!!e&&t.startLineNumber===e.startLineNumber&&t.startColumn===e.startColumn&&t.endLineNumber===e.endLineNumber&&t.endColumn===e.endColumn}getEndPosition(){return r.getEndPosition(this)}static getEndPosition(t){return new U(t.endLineNumber,t.endColumn)}getStartPosition(){return r.getStartPosition(this)}static getStartPosition(t){return new U(t.startLineNumber,t.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(t,e){return new r(this.startLineNumber,this.startColumn,t,e)}setStartPosition(t,e){return new r(t,e,this.endLineNumber,this.endColumn)}collapseToStart(){return r.collapseToStart(this)}static collapseToStart(t){return new r(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn)}collapseToEnd(){return r.collapseToEnd(this)}static collapseToEnd(t){return new r(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn)}delta(t){return new r(this.startLineNumber+t,this.startColumn,this.endLineNumber+t,this.endColumn)}static fromPositions(t,e=t){return new r(t.lineNumber,t.column,e.lineNumber,e.column)}static lift(t){return t?new r(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):null}static isIRange(t){return t&&typeof t.startLineNumber=="number"&&typeof t.startColumn=="number"&&typeof t.endLineNumber=="number"&&typeof t.endColumn=="number"}static areIntersectingOrTouching(t,e){return!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn||e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn)}static areIntersecting(t,e){return!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn||e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn)}static compareRangesUsingStarts(t,e){if(t&&e){let o=t.startLineNumber|0,s=e.startLineNumber|0;if(o===s){let a=t.startColumn|0,l=e.startColumn|0;if(a===l){let d=t.endLineNumber|0,c=e.endLineNumber|0;if(d===c){let u=t.endColumn|0,p=e.endColumn|0;return u-p}return d-c}return a-l}return o-s}return(t?1:0)-(e?1:0)}static compareRangesUsingEnds(t,e){return t.endLineNumber===e.endLineNumber?t.endColumn===e.endColumn?t.startLineNumber===e.startLineNumber?t.startColumn-e.startColumn:t.startLineNumber-e.startLineNumber:t.endColumn-e.endColumn:t.endLineNumber-e.endLineNumber}static spansMultipleLines(t){return t.endLineNumber>t.startLineNumber}toJSON(){return this}};var It=class r extends F{selectionStartLineNumber;selectionStartColumn;positionLineNumber;positionColumn;constructor(t,e,i,n){super(t,e,i,n),this.selectionStartLineNumber=t,this.selectionStartColumn=e,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(t){return r.selectionsEqual(this,t)}static selectionsEqual(t,e){return t.selectionStartLineNumber===e.selectionStartLineNumber&&t.selectionStartColumn===e.selectionStartColumn&&t.positionLineNumber===e.positionLineNumber&&t.positionColumn===e.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(t,e){return this.getDirection()===0?new r(this.startLineNumber,this.startColumn,t,e):new r(t,e,this.startLineNumber,this.startColumn)}getPosition(){return new U(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new U(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(t,e){return this.getDirection()===0?new r(t,e,this.endLineNumber,this.endColumn):new r(this.endLineNumber,this.endColumn,t,e)}static fromPositions(t,e=t){return new r(t.lineNumber,t.column,e.lineNumber,e.column)}static fromRange(t,e){return e===0?new r(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new r(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}static liftSelection(t){return new r(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn)}static selectionsArrEqual(t,e){if(t&&!e||!t&&e)return!1;if(!t&&!e)return!0;if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(!this.selectionsEqual(t[i],e[i]))return!1;return!0}static isISelection(t){return t&&typeof t.selectionStartLineNumber=="number"&&typeof t.selectionStartColumn=="number"&&typeof t.positionLineNumber=="number"&&typeof t.positionColumn=="number"}static createWithDirection(t,e,i,n,o){return o===0?new r(t,e,i,n):new r(i,n,t,e)}};var ey=class{static insert(t,e){return{range:new F(t.lineNumber,t.column,t.lineNumber,t.column),text:e,forceMoveMarkers:!0}}static delete(t){return{range:t,text:null}}static replace(t,e){return{range:t,text:e}}static replaceMove(t,e){return{range:t,text:e,forceMoveMarkers:!0}}};var oU;function C$(){return oU||(oU=new TextDecoder("UTF-16LE")),oU}var rU;function zre(){return rU||(rU=new TextDecoder("UTF-16BE")),rU}var sU;function aU(){return sU||(sU=Y9()?C$():zre()),sU}function S$(r,t,e){let i=new Uint16Array(r.buffer,t,e);return e>0&&(i[0]===65279||i[0]===65534)?Kre(r,t,e):C$().decode(i)}function Kre(r,t,e){let i=[],n=0;for(let o=0;o<e;o++){let s=AG(r,t);t+=2,i[n++]=String.fromCharCode(s)}return i.join("")}var Pc=class{_capacity;_buffer;_completedStrings;_bufferLength;constructor(t){this._capacity=t|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";let t=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return aU().decode(t)}_flushBuffer(){let t=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[t]:this._completedStrings[this._completedStrings.length]=t}appendCharCode(t){let e=this._capacity-this._bufferLength;e<=1&&(e===0||ln(t))&&this._flushBuffer(),this._buffer[this._bufferLength++]=t}appendASCIICharCode(t){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=t}appendString(t){let e=t.length;if(this._bufferLength+e>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=t;return}for(let i=0;i<e;i++)this._buffer[this._bufferLength++]=t.charCodeAt(i)}};function Ck(r){return r.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var la=class r{constructor(t,e,i,n){this.oldPosition=t;this.oldText=e;this.newPosition=i;this.newText=n}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Ck(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Ck(this.oldText)}")`:`(replace@${this.oldPosition} "${Ck(this.oldText)}" with "${Ck(this.newText)}")`}static _writeStringSize(t){return 4+2*t.length}static _writeString(t,e,i){let n=e.length;Uo(t,n,i),i+=4;for(let o=0;o<n;o++)PG(t,e.charCodeAt(o),i),i+=2;return i}static _readString(t,e){let i=Wo(t,e);return e+=4,S$(t,e,i)}writeSize(){return 8+r._writeStringSize(this.oldText)+r._writeStringSize(this.newText)}write(t,e){return Uo(t,this.oldPosition,e),e+=4,Uo(t,this.newPosition,e),e+=4,e=r._writeString(t,this.oldText,e),e=r._writeString(t,this.newText,e),e}static read(t,e,i){let n=Wo(t,e);e+=4;let o=Wo(t,e);e+=4;let s=r._readString(t,e);e+=r._writeStringSize(s);let a=r._readString(t,e);return e+=r._writeStringSize(a),i.push(new r(n,s,o,a)),e}};function w$(r,t){return r===null||r.length===0?t:new lU(r,t).compress()}var lU=class r{_prevEdits;_currEdits;_result;_resultLen;_prevLen;_prevDeltaOffset;_currLen;_currDeltaOffset;constructor(t,e){this._prevEdits=t,this._currEdits=e,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let t=0,e=0,i=this._getPrev(t),n=this._getCurr(e);for(;t<this._prevLen||e<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++e);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++t);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++e);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++t);continue}if(n.oldPosition<i.newPosition){let[d,c]=r._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(d),n=c;continue}if(i.newPosition<n.oldPosition){let[d,c]=r._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(d),i=c;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++t),n=this._getCurr(++e);else if(n.oldEnd<i.newEnd){let[d,c]=r._splitPrev(i,n.oldLength);a=d,l=n,i=c,n=this._getCurr(++e)}else{let[d,c]=r._splitCurr(n,i.newLength);a=i,l=d,i=this._getPrev(++t),n=c}this._result[this._resultLen++]=new la(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}let o=r._merge(this._result);return r._removeNoOps(o)}_acceptCurr(t){this._result[this._resultLen++]=r._rebaseCurr(this._prevDeltaOffset,t),this._currDeltaOffset+=t.newLength-t.oldLength}_getCurr(t){return t<this._currLen?this._currEdits[t]:null}_acceptPrev(t){this._result[this._resultLen++]=r._rebasePrev(this._currDeltaOffset,t),this._prevDeltaOffset+=t.newLength-t.oldLength}_getPrev(t){return t<this._prevLen?this._prevEdits[t]:null}static _rebaseCurr(t,e){return new la(e.oldPosition-t,e.oldText,e.newPosition,e.newText)}static _rebasePrev(t,e){return new la(e.oldPosition,e.oldText,e.newPosition+t,e.newText)}static _splitPrev(t,e){let i=t.newText.substr(0,e),n=t.newText.substr(e);return[new la(t.oldPosition,t.oldText,t.newPosition,i),new la(t.oldEnd,"",t.newPosition+e,n)]}static _splitCurr(t,e){let i=t.oldText.substr(0,e),n=t.oldText.substr(e);return[new la(t.oldPosition,i,t.newPosition,t.newText),new la(t.oldPosition+e,n,t.newEnd,"")]}static _merge(t){if(t.length===0)return t;let e=[],i=0,n=t[0];for(let o=1;o<t.length;o++){let s=t[o];n.oldEnd===s.oldPosition?n=new la(n.oldPosition,n.oldText+s.oldText,n.newPosition,n.newText+s.newText):(e[i++]=n,n=s)}return e[i++]=n,e}static _removeNoOps(t){if(t.length===0)return t;let e=[],i=0;for(let n=0;n<t.length;n++){let o=t[n];o.oldText!==o.newText&&(e[i++]=o)}return e}};var ty=class r{_asciiMap;_map;_defaultValue;constructor(t){let e=Ig(t);this._defaultValue=e,this._asciiMap=r._createAsciiMap(e),this._map=new Map}static _createAsciiMap(t){let e=new Uint8Array(256);return e.fill(t),e}set(t,e){let i=Ig(e);t>=0&&t<256?this._asciiMap[t]=i:this._map.set(t,i)}get(t){return t>=0&&t<256?this._asciiMap[t]:this._map.get(t)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}};var dU=class extends ty{intlSegmenterLocales;_segmenter=null;_cachedLine=null;_cachedSegments=[];constructor(t,e){super(0),this.intlSegmenterLocales=e,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=t.length;i<n;i++)this.set(t.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(t,e){let i=null;for(let n of this._getIntlSegmenterWordsOnLine(t)){if(n.index>e)break;i=n}return i}findNextIntlWordAtOrAfterOffset(t,e){for(let i of this._getIntlSegmenterWordsOnLine(t))if(!(i.index<e))return i;return null}_getIntlSegmenterWordsOnLine(t){return this._segmenter?this._cachedLine===t?this._cachedSegments:(this._cachedLine=t,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(t)),this._cachedSegments):[]}_filterWordSegments(t){let e=[];for(let i of t)this._isWordLike(i)&&e.push(i);return e}_isWordLike(t){return!!t.isWordLike}},E$=new $s(10);function Mc(r,t){let e=`${r}/${t.join(",")}`,i=E$.get(e);return i||(i=new dU(r,t),E$.set(e,i)),i}var iE=Object.freeze({create:r=>yo(r.map(t=>t.toString())).join(`\r
`),split:r=>r.split(`\r
`),parse:r=>iE.split(r).filter(t=>!t.startsWith("#"))});var T$=class r{constructor(t){this.value=t}static sep=".";static None=new r("@@none@@");static Empty=new r("");equals(t){return this.value===t.value}contains(t){return this.equals(t)||this.value===""||t.value.startsWith(this.value+r.sep)}intersects(t){return this.contains(t)||t.contains(this)}append(...t){return new r((this.value?[this.value,...t]:t).join(r.sep))}};var da=class{static getLanguageId(t){return(t&255)>>>0}static getTokenType(t){return(t&768)>>>8}static containsBalancedBrackets(t){return(t&1024)!==0}static getFontStyle(t){return(t&30720)>>>11}static getForeground(t){return(t&16744448)>>>15}static getBackground(t){return(t&4278190080)>>>24}static getClassNameFromMetadata(t){let i="mtk"+this.getForeground(t),n=this.getFontStyle(t);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(t,e){let i=this.getForeground(t),n=this.getFontStyle(t),o=`color: ${e[i]};`;n&1&&(o+="font-style: italic;"),n&2&&(o+="font-weight: bold;");let s="";return n&4&&(s+=" underline"),n&8&&(s+=" line-through"),s&&(o+=`text-decoration:${s};`),o}static getPresentationFromMetadata(t){let e=this.getForeground(t),i=this.getFontStyle(t);return{foreground:e,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}};var nE=class{_tokenizationSupports=new Map;_factories=new Map;_onDidChange=new T;onDidChange=this._onDidChange.event;_colorMap;constructor(){this._colorMap=null}handleChange(t){this._onDidChange.fire({changedLanguages:t,changedColorMap:!1})}register(t,e){return this._tokenizationSupports.set(t,e),this.handleChange([t]),te(()=>{this._tokenizationSupports.get(t)===e&&(this._tokenizationSupports.delete(t),this.handleChange([t]))})}get(t){return this._tokenizationSupports.get(t)||null}registerFactory(t,e){this._factories.get(t)?.dispose();let i=new cU(this,t,e);return this._factories.set(t,i),te(()=>{let n=this._factories.get(t);!n||n!==i||(this._factories.delete(t),n.dispose())})}async getOrCreate(t){let e=this.get(t);if(e)return e;let i=this._factories.get(t);return!i||i.isResolved?null:(await i.resolve(),this.get(t))}isResolved(t){if(this.get(t))return!0;let i=this._factories.get(t);return!!(!i||i.isResolved)}setColorMap(t){this._colorMap=t,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}},cU=class extends L{constructor(e,i,n){super();this._registry=e;this._languageId=i;this._factory=n}_isDisposed=!1;_resolvePromise=null;_isResolved=!1;get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){let e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}};function Es(r){let t=0,e=0,i=0,n=0;for(let o=0,s=r.length;o<s;o++){let a=r.charCodeAt(o);a===13?(t===0&&(e=o),t++,o+1<s&&r.charCodeAt(o+1)===10?(n|=2,o++):n|=3,i=o+1):a===10&&(n|=1,t===0&&(e=o),t++,i=o+1)}return t===0&&(e=r.length),[t,e,r.length-i,n]}var Xe=class r{constructor(t,e){this.start=t;this.endExclusive=e;if(t>e)throw new yt(`Invalid range: ${this.toString()}`)}static addRange(t,e){let i=0;for(;i<e.length&&e[i].endExclusive<t.start;)i++;let n=i;for(;n<e.length&&e[n].start<=t.endExclusive;)n++;if(i===n)e.splice(i,0,t);else{let o=Math.min(t.start,e[i].start),s=Math.max(t.endExclusive,e[n-1].endExclusive);e.splice(i,n-i,new r(o,s))}}static tryCreate(t,e){if(!(t>e))return new r(t,e)}static ofLength(t){return new r(0,t)}static ofStartAndLength(t,e){return new r(t,t+e)}static emptyAt(t){return new r(t,t)}get isEmpty(){return this.start===this.endExclusive}delta(t){return new r(this.start+t,this.endExclusive+t)}deltaStart(t){return new r(this.start+t,this.endExclusive)}deltaEnd(t){return new r(this.start,this.endExclusive+t)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(t){return this.start===t.start&&this.endExclusive===t.endExclusive}containsRange(t){return this.start<=t.start&&t.endExclusive<=this.endExclusive}contains(t){return this.start<=t&&t<this.endExclusive}join(t){return new r(Math.min(this.start,t.start),Math.max(this.endExclusive,t.endExclusive))}intersect(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);if(e<=i)return new r(e,i)}intersectionLength(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);return Math.max(0,i-e)}intersects(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);return e<i}intersectsOrTouches(t){let e=Math.max(this.start,t.start),i=Math.min(this.endExclusive,t.endExclusive);return e<=i}isBefore(t){return this.endExclusive<=t.start}isAfter(t){return this.start>=t.endExclusive}slice(t){return t.slice(this.start,this.endExclusive)}substring(t){return t.substring(this.start,this.endExclusive)}clip(t){if(this.isEmpty)throw new yt(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,t))}clipCyclic(t){if(this.isEmpty)throw new yt(`Invalid clipping range: ${this.toString()}`);return t<this.start?this.endExclusive-(this.start-t)%this.length:t>=this.endExclusive?this.start+(t-this.start)%this.length:t}map(t){let e=[];for(let i=this.start;i<this.endExclusive;i++)e.push(t(i));return e}forEach(t){for(let e=this.start;e<this.endExclusive;e++)t(e)}},Sk=class r{_sortedRanges=[];addRange(t){let e=0;for(;e<this._sortedRanges.length&&this._sortedRanges[e].endExclusive<t.start;)e++;let i=e;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=t.endExclusive;)i++;if(e===i)this._sortedRanges.splice(e,0,t);else{let n=Math.min(t.start,this._sortedRanges[e].start),o=Math.max(t.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(e,i-e,new Xe(n,o))}}toString(){return this._sortedRanges.map(t=>t.toString()).join(", ")}intersectsStrict(t){let e=0;for(;e<this._sortedRanges.length&&this._sortedRanges[e].endExclusive<=t.start;)e++;return e<this._sortedRanges.length&&this._sortedRanges[e].start<t.endExclusive}intersectWithRange(t){let e=new r;for(let i of this._sortedRanges){let n=i.intersect(t);n&&e.addRange(n)}return e}intersectWithRangeLength(t){return this.intersectWithRange(t).length}get length(){return this._sortedRanges.reduce((t,e)=>t+e.length,0)}};var uU=class r{constructor(t){this._tokenInfo=t}static create(t){return new r(t)}forEach(t){let e=0;for(let i of this._tokenInfo){let n=new Xe(e,e+i.length);t(n,i),e+=i.length}}slice(t){let e=[],i=0;for(let n of this._tokenInfo){let o=i,s=o+n.length;if(s>t.start){if(o>=t.endExclusive)break;let a=Math.max(0,t.start-o),l=Math.max(0,s-t.endExclusive);e.push(new wk(n.length-a-l,n.metadata))}i+=n.length}return r.create(e)}},wk=class{constructor(t,e){this.length=t;this.metadata=e}},Ek=class{_tokens=[];add(t,e){this._tokens.push(new wk(t,e))}build(){return uU.create(this._tokens)}};var Mn=class r{static createEmpty(t,e){let i=r.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=t.length,n[1]=i,new r(n,t,e)}static createFromTextAndMetadata(t,e){let i=0,n="",o=new Array;for(let{text:s,metadata:a}of t)o.push(i+s.length,a),i+=s.length,n+=s;return new r(new Uint32Array(o),n,e)}static convertToEndOffset(t,e){let n=(t.length>>>1)-1;for(let o=0;o<n;o++)t[o<<1]=t[o+1<<1];t[n<<1]=e}static findIndexInTokensArray(t,e){if(t.length<=2)return 0;let i=0,n=(t.length>>>1)-1;for(;i<n;){let o=i+Math.floor((n-i)/2),s=t[o<<1];if(s===e)return o+1;s<e?i=o+1:s>e&&(n=o)}return i}_lineTokensBrand=void 0;_tokens;_tokensCount;_text;languageIdCodec;static defaultTokenMetadata=(32768|2<<24)>>>0;constructor(t,e,i){this._tokens=t,this._tokensCount=this._tokens.length>>>1,this._text=e,this.languageIdCodec=i}equals(t){return t instanceof r?this.slicedEquals(t,0,this._tokensCount):!1}slicedEquals(t,e,i){if(this._text!==t._text||this._tokensCount!==t._tokensCount)return!1;let n=e<<1,o=n+(i<<1);for(let s=n;s<o;s++)if(this._tokens[s]!==t._tokens[s])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(t){return t>0?this._tokens[t-1<<1]:0}getMetadata(t){return this._tokens[(t<<1)+1]}getLanguageId(t){let e=this._tokens[(t<<1)+1],i=da.getLanguageId(e);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(t){let e=this._tokens[(t<<1)+1];return da.getTokenType(e)}getForeground(t){let e=this._tokens[(t<<1)+1];return da.getForeground(e)}getClassName(t){let e=this._tokens[(t<<1)+1];return da.getClassNameFromMetadata(e)}getInlineStyle(t,e){let i=this._tokens[(t<<1)+1];return da.getInlineStyleFromMetadata(i,e)}getPresentation(t){let e=this._tokens[(t<<1)+1];return da.getPresentationFromMetadata(e)}getEndOffset(t){return this._tokens[t<<1]}findTokenIndexAtOffset(t){return r.findIndexInTokensArray(this._tokens,t)}inflate(){return this}sliceAndInflate(t,e,i){return new pU(this,t,e,i)}withInserted(t){if(t.length===0)return this;let e=0,i=0,n="",o=new Array,s=0;for(;;){let a=e<this._tokensCount?this._tokens[e<<1]:-1,l=i<t.length?t[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(s,a);let d=this._tokens[(e<<1)+1];o.push(n.length,d),e++,s=a}else if(l){if(l.offset>s){n+=this._text.substring(s,l.offset);let d=this._tokens[(e<<1)+1];o.push(n.length,d),s=l.offset}n+=l.text,o.push(n.length,l.tokenMetadata),i++}else break}return new r(new Uint32Array(o),n,this.languageIdCodec)}getTokensInRange(t){let e=new Ek,i=this.findTokenIndexAtOffset(t.start),n=this.findTokenIndexAtOffset(t.endExclusive);for(let o=i;o<=n;o++){let a=new Xe(this.getStartOffset(o),this.getEndOffset(o)).intersectionLength(t);a>0&&e.add(a,this.getMetadata(o))}return e.build()}getTokenText(t){let e=this.getStartOffset(t),i=this.getEndOffset(t);return this._text.substring(e,i)}forEach(t){let e=this.getCount();for(let i=0;i<e;i++)t(i)}},pU=class r{_source;_startOffset;_endOffset;_deltaOffset;_firstTokenIndex;_tokensCount;languageIdCodec;constructor(t,e,i,n){this._source=t,this._startOffset=e,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=t.findTokenIndexAtOffset(e),this.languageIdCodec=t.languageIdCodec,this._tokensCount=0;for(let o=this._firstTokenIndex,s=t.getCount();o<s&&!(t.getStartOffset(o)>=i);o++)this._tokensCount++}getMetadata(t){return this._source.getMetadata(this._firstTokenIndex+t)}getLanguageId(t){return this._source.getLanguageId(this._firstTokenIndex+t)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(t){return t instanceof r?this._startOffset===t._startOffset&&this._endOffset===t._endOffset&&this._deltaOffset===t._deltaOffset&&this._source.slicedEquals(t._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(t){return this._source.getStandardTokenType(this._firstTokenIndex+t)}getForeground(t){return this._source.getForeground(this._firstTokenIndex+t)}getEndOffset(t){let e=this._source.getEndOffset(this._firstTokenIndex+t);return Math.min(this._endOffset,e)-this._startOffset+this._deltaOffset}getClassName(t){return this._source.getClassName(this._firstTokenIndex+t)}getInlineStyle(t,e){return this._source.getInlineStyle(this._firstTokenIndex+t,e)}getPresentation(t){return this._source.getPresentation(this._firstTokenIndex+t)}findTokenIndexAtOffset(t){return this._source.findTokenIndexAtOffset(t+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(t){let e=this._firstTokenIndex+t,i=this._source.getStartOffset(e),n=this._source.getEndOffset(e),o=this._source.getTokenText(e);return i<this._startOffset&&(o=o.substring(this._startOffset-i)),n>this._endOffset&&(o=o.substring(0,o.length-(n-this._endOffset))),o}forEach(t){for(let e=0;e<this.getCount();e++)t(e)}};var Oc=new Uint32Array(0).buffer,Ko=class r{static deleteBeginning(t,e){return t===null||t===Oc?t:r.delete(t,0,e)}static deleteEnding(t,e){if(t===null||t===Oc)return t;let i=Nc(t),n=i[i.length-2];return r.delete(t,e,n)}static delete(t,e,i){if(t===null||t===Oc||e===i)return t;let n=Nc(t),o=n.length>>>1;if(e===0&&n[n.length-2]===i)return Oc;let s=Mn.findIndexInTokensArray(n,e),a=s>0?n[s-1<<1]:0,l=n[s<<1];if(i<l){let m=i-e;for(let g=s;g<o;g++)n[g<<1]-=m;return t}let d,c;a!==e?(n[s<<1]=e,d=s+1<<1,c=e):(d=s<<1,c=a);let u=i-e;for(let m=s+1;m<o;m++){let g=n[m<<1]-u;g>c&&(n[d++]=g,n[d++]=n[(m<<1)+1],c=g)}if(d===n.length)return t;let p=new Uint32Array(d);return p.set(n.subarray(0,d),0),p.buffer}static append(t,e){if(e===Oc)return t;if(t===Oc)return e;if(t===null)return t;if(e===null)return null;let i=Nc(t),n=Nc(e),o=n.length>>>1,s=new Uint32Array(i.length+n.length);s.set(i,0);let a=i.length,l=i[i.length-2];for(let d=0;d<o;d++)s[a++]=n[d<<1]+l,s[a++]=n[(d<<1)+1];return s.buffer}static insert(t,e,i){if(t===null||t===Oc)return t;let n=Nc(t),o=n.length>>>1,s=Mn.findIndexInTokensArray(n,e);s>0&&n[s-1<<1]===e&&s--;for(let a=s;a<o;a++)n[a<<1]+=i;return t}};function Nc(r){return r instanceof Uint32Array?r:new Uint32Array(r)}var Ye=class r{static fromRange(t){return new r(t.startLineNumber,t.endLineNumber)}static fromRangeInclusive(t){return new r(t.startLineNumber,t.endLineNumber+1)}static subtract(t,e){return e?t.startLineNumber<e.startLineNumber&&e.endLineNumberExclusive<t.endLineNumberExclusive?[new r(t.startLineNumber,e.startLineNumber),new r(e.endLineNumberExclusive,t.endLineNumberExclusive)]:e.startLineNumber<=t.startLineNumber&&t.endLineNumberExclusive<=e.endLineNumberExclusive?[]:e.endLineNumberExclusive<t.endLineNumberExclusive?[new r(Math.max(e.endLineNumberExclusive,t.startLineNumber),t.endLineNumberExclusive)]:[new r(t.startLineNumber,Math.min(e.startLineNumber,t.endLineNumberExclusive))]:[t]}static joinMany(t){if(t.length===0)return[];let e=new Fa(t[0].slice());for(let i=1;i<t.length;i++)e=e.getUnion(new Fa(t[i].slice()));return e.ranges}static join(t){if(t.length===0)throw new yt("lineRanges cannot be empty");let e=t[0].startLineNumber,i=t[0].endLineNumberExclusive;for(let n=1;n<t.length;n++)e=Math.min(e,t[n].startLineNumber),i=Math.max(i,t[n].endLineNumberExclusive);return new r(e,i)}static ofLength(t,e){return new r(t,t+e)}static deserialize(t){return new r(t[0],t[1])}startLineNumber;endLineNumberExclusive;constructor(t,e){if(t>e)throw new yt(`startLineNumber ${t} cannot be after endLineNumberExclusive ${e}`);this.startLineNumber=t,this.endLineNumberExclusive=e}contains(t){return this.startLineNumber<=t&&t<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(t){return new r(this.startLineNumber+t,this.endLineNumberExclusive+t)}deltaLength(t){return new r(this.startLineNumber,this.endLineNumberExclusive+t)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(t){return new r(Math.min(this.startLineNumber,t.startLineNumber),Math.max(this.endLineNumberExclusive,t.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(t){let e=Math.max(this.startLineNumber,t.startLineNumber),i=Math.min(this.endLineNumberExclusive,t.endLineNumberExclusive);if(e<=i)return new r(e,i)}intersectsStrict(t){return this.startLineNumber<t.endLineNumberExclusive&&t.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(t){return this.startLineNumber<=t.endLineNumberExclusive&&t.startLineNumber<=this.endLineNumberExclusive}equals(t){return this.startLineNumber===t.startLineNumber&&this.endLineNumberExclusive===t.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new F(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new F(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(t){let e=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)e.push(t(i));return e}forEach(t){for(let e=this.startLineNumber;e<this.endLineNumberExclusive;e++)t(e)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(t){return this.startLineNumber<=t&&t<this.endLineNumberExclusive}toOffsetRange(){return new Xe(this.startLineNumber-1,this.endLineNumberExclusive-1)}},Fa=class r{constructor(t=[]){this._normalizedRanges=t}get ranges(){return this._normalizedRanges}addRange(t){if(t.length===0)return;let e=NS(this._normalizedRanges,n=>n.endLineNumberExclusive>=t.startLineNumber),i=Ou(this._normalizedRanges,n=>n.startLineNumber<=t.endLineNumberExclusive)+1;if(e===i)this._normalizedRanges.splice(e,0,t);else if(e===i-1){let n=this._normalizedRanges[e];this._normalizedRanges[e]=n.join(t)}else{let n=this._normalizedRanges[e].join(this._normalizedRanges[i-1]).join(t);this._normalizedRanges.splice(e,i-e,n)}}contains(t){let e=Mu(this._normalizedRanges,i=>i.startLineNumber<=t);return!!e&&e.endLineNumberExclusive>t}intersects(t){let e=Mu(this._normalizedRanges,i=>i.startLineNumber<t.endLineNumberExclusive);return!!e&&e.endLineNumberExclusive>t.startLineNumber}getUnion(t){if(this._normalizedRanges.length===0)return t;if(t._normalizedRanges.length===0)return this;let e=[],i=0,n=0,o=null;for(;i<this._normalizedRanges.length||n<t._normalizedRanges.length;){let s=null;if(i<this._normalizedRanges.length&&n<t._normalizedRanges.length){let a=this._normalizedRanges[i],l=t._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(s=a,i++):(s=l,n++)}else i<this._normalizedRanges.length?(s=this._normalizedRanges[i],i++):(s=t._normalizedRanges[n],n++);o===null?o=s:o.endLineNumberExclusive>=s.startLineNumber?o=new Ye(o.startLineNumber,Math.max(o.endLineNumberExclusive,s.endLineNumberExclusive)):(e.push(o),o=s)}return o!==null&&e.push(o),new r(e)}subtractFrom(t){let e=NS(this._normalizedRanges,s=>s.endLineNumberExclusive>=t.startLineNumber),i=Ou(this._normalizedRanges,s=>s.startLineNumber<=t.endLineNumberExclusive)+1;if(e===i)return new r([t]);let n=[],o=t.startLineNumber;for(let s=e;s<i;s++){let a=this._normalizedRanges[s];a.startLineNumber>o&&n.push(new Ye(o,a.startLineNumber)),o=a.endLineNumberExclusive}return o<t.endLineNumberExclusive&&n.push(new Ye(o,t.endLineNumberExclusive)),new r(n)}toString(){return this._normalizedRanges.map(t=>t.toString()).join(", ")}getIntersection(t){let e=[],i=0,n=0;for(;i<this._normalizedRanges.length&&n<t._normalizedRanges.length;){let o=this._normalizedRanges[i],s=t._normalizedRanges[n],a=o.intersect(s);a&&!a.isEmpty&&e.push(a),o.endLineNumberExclusive<s.endLineNumberExclusive?i++:n++}return new r(e)}getWithDelta(t){return new r(this._normalizedRanges.map(e=>e.delta(t)))}};var oE=class r{static deserialize(t,e,i){let n=new Uint32Array(t.buffer),o=Wo(t,e);e+=4;let s=Wo(t,e);e+=4;let a=[];for(let l=0;l<s;l++){let d=Wo(t,e);e+=4,a.push(n.subarray(e/4,e/4+d/4)),e+=d}return i.push(new r(o,a)),e}_startLineNumber;_tokens;get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(t,e){this._startLineNumber=t,this._tokens=e}getLineRange(){return new Ye(this._startLineNumber,this._startLineNumber+this._tokens.length)}getLineTokens(t){return this._tokens[t-this._startLineNumber]}appendLineTokens(t){this._tokens.push(t)}serializeSize(){let t=0;t+=4,t+=4;for(let e=0;e<this._tokens.length;e++){let i=this._tokens[e];if(!(i instanceof Uint32Array))throw new Error("Not supported!");t+=4,t+=i.byteLength}return t}serialize(t,e){Uo(t,this._startLineNumber,e),e+=4,Uo(t,this._tokens.length,e),e+=4;for(let i=0;i<this._tokens.length;i++){let n=this._tokens[i];if(!(n instanceof Uint32Array))throw new Error("Not supported!");Uo(t,n.byteLength,e),e+=4,t.set(new Uint8Array(n.buffer),e),e+=n.byteLength}return e}applyEdit(t,e){let[i,n]=Es(e);this._acceptDeleteRange(t),this._acceptInsertText(new U(t.startLineNumber,t.startColumn),i,n)}_acceptDeleteRange(t){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return;let e=t.startLineNumber-this._startLineNumber,i=t.endLineNumber-this._startLineNumber;if(i<0){let n=i-e;this._startLineNumber-=n;return}if(!(e>=this._tokens.length)){if(e<0&&i>=this._tokens.length){this._startLineNumber=0,this._tokens=[];return}if(e===i){this._tokens[e]=Ko.delete(this._tokens[e],t.startColumn-1,t.endColumn-1);return}if(e>=0)if(this._tokens[e]=Ko.deleteEnding(this._tokens[e],t.startColumn-1),i<this._tokens.length){let n=Ko.deleteBeginning(this._tokens[i],t.endColumn-1);this._tokens[e]=Ko.append(this._tokens[e],n),this._tokens.splice(e+1,i-e)}else this._tokens[e]=Ko.append(this._tokens[e],null),this._tokens=this._tokens.slice(0,e+1);else{let n=-e;this._startLineNumber-=n,this._tokens[i]=Ko.deleteBeginning(this._tokens[i],t.endColumn-1),this._tokens=this._tokens.slice(i)}}}_acceptInsertText(t,e,i){if(e===0&&i===0)return;let n=t.lineNumber-this._startLineNumber;if(n<0){this._startLineNumber+=e;return}if(!(n>=this._tokens.length)){if(e===0){this._tokens[n]=Ko.insert(this._tokens[n],t.column-1,i);return}this._tokens[n]=Ko.deleteEnding(this._tokens[n],t.column-1),this._tokens[n]=Ko.insert(this._tokens[n],t.column-1,i),this._insertLines(t.lineNumber,e)}}_insertLines(t,e){if(e===0)return;let i=[];for(let n=0;n<e;n++)i[n]=null;this._tokens=pc(this._tokens,t,i)}};var Tk=(n=>(n[n.Ignore=0]="Ignore",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n))(Tk||{});(a=>{let r="error",t="warning",e="warn",i="info",n="ignore";function o(l){return l?Qs(r,l)?3:Qs(t,l)||Qs(e,l)?2:Qs(i,l)?1:0:0}a.fromValue=o;function s(l){switch(l){case 3:return r;case 2:return t;case 1:return i;default:return n}}a.toString=s})(Tk||={});var xo=Tk;function mU(r){return r.scheme===he.vscodeRemote?r.authority:void 0}function xk(r){if(!r)return;let t=r.indexOf("+");return t<0?r:r.substr(0,t)}var _$=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var Ba=class{value;_lower;constructor(t){this.value=t,this._lower=t.toLowerCase()}static equals(t,e){if(typeof t>"u"||t===null)return typeof e>"u"||e===null;if(typeof e>"u"||e===null)return!1;if(typeof t=="string"||typeof e=="string"){let i=typeof t=="string"?t:t.value,n=typeof e=="string"?e:e.value;return Qs(i,n)}return t._lower===e._lower}static toKey(t){return typeof t=="string"?t.toLowerCase():t._lower}},rE=class{_set=new Set;get size(){return this._set.size}constructor(t){if(t)for(let e of t)this.add(e)}add(t){this._set.add(Ba.toKey(t))}delete(t){return this._set.delete(Ba.toKey(t))}has(t){return this._set.has(Ba.toKey(t))}};var OAe=$("IBuiltinExtensionsScannerService");var sE=(n=>(n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error",n))(sE||{});(o=>{function r(s,a){return a-s}o.compare=r;let t=Object.create(null);t[8]=h("sev.error","Error"),t[4]=h("sev.warning","Warning"),t[2]=h("sev.info","Info");function e(s){return t[s]||""}o.toString=e;function i(s){switch(s){case xo.Error:return 8;case xo.Warning:return 4;case xo.Info:return 2;case xo.Ignore:return 1}}o.fromSeverity=i;function n(s){switch(s){case 8:return xo.Error;case 4:return xo.Warning;case 2:return xo.Info;case 1:return xo.Ignore}}o.toSeverity=n})(sE||={});var jre;(i=>{let r="";function t(n){return e(n,!0)}i.makeKey=t;function e(n,o){let s=[r];return n.source?s.push(n.source.replace("\xA6","\\\xA6")):s.push(r),n.code?typeof n.code=="string"?s.push(n.code.replace("\xA6","\\\xA6")):s.push(n.code.value.replace("\xA6","\\\xA6")):s.push(r),n.severity!==void 0&&n.severity!==null?s.push(sE.toString(n.severity)):s.push(r),n.message&&o?s.push(n.message.replace("\xA6","\\\xA6")):s.push(r),n.startLineNumber!==void 0&&n.startLineNumber!==null?s.push(n.startLineNumber.toString()):s.push(r),n.startColumn!==void 0&&n.startColumn!==null?s.push(n.startColumn.toString()):s.push(r),n.endLineNumber!==void 0&&n.endLineNumber!==null?s.push(n.endLineNumber.toString()):s.push(r),n.endColumn!==void 0&&n.endColumn!==null?s.push(n.endColumn.toString()):s.push(r),s.push(r),s.join("\xA6")}i.makeKeyOptionalMessage=e})(jre||={});var D$=$("markerService");var _k=class{constructor(t,e){this.tokens=t;this.endState=e}_encodedTokenizationResultBrand=void 0};var $re;(n=>{let r=new Map;r.set(0,B.symbolMethod),r.set(1,B.symbolFunction),r.set(2,B.symbolConstructor),r.set(3,B.symbolField),r.set(4,B.symbolVariable),r.set(5,B.symbolClass),r.set(6,B.symbolStruct),r.set(7,B.symbolInterface),r.set(8,B.symbolModule),r.set(9,B.symbolProperty),r.set(10,B.symbolEvent),r.set(11,B.symbolOperator),r.set(12,B.symbolUnit),r.set(13,B.symbolValue),r.set(15,B.symbolEnum),r.set(14,B.symbolConstant),r.set(15,B.symbolEnum),r.set(16,B.symbolEnumMember),r.set(17,B.symbolKeyword),r.set(27,B.symbolSnippet),r.set(18,B.symbolText),r.set(19,B.symbolColor),r.set(20,B.symbolFile),r.set(21,B.symbolReference),r.set(22,B.symbolCustomColor),r.set(23,B.symbolFolder),r.set(24,B.symbolTypeParameter),r.set(25,B.account),r.set(26,B.issues);function t(o){let s=r.get(o);return s||(console.info("No codicon found for CompletionItemKind "+o),s=B.symbolProperty),s}n.toIcon=t;let e=new Map;e.set("method",0),e.set("function",1),e.set("constructor",2),e.set("field",3),e.set("variable",4),e.set("class",5),e.set("struct",6),e.set("interface",7),e.set("module",8),e.set("property",9),e.set("event",10),e.set("operator",11),e.set("unit",12),e.set("value",13),e.set("constant",14),e.set("enum",15),e.set("enum-member",16),e.set("enumMember",16),e.set("keyword",17),e.set("snippet",27),e.set("text",18),e.set("color",19),e.set("file",20),e.set("reference",21),e.set("customcolor",22),e.set("folder",23),e.set("type-parameter",24),e.set("typeParameter",24),e.set("account",25),e.set("issue",26);function i(o,s){let a=e.get(o);return typeof a>"u"&&!s&&(a=9),a}n.fromString=i})($re||={});var MPe={17:h("Array","array"),16:h("Boolean","boolean"),4:h("Class","class"),13:h("Constant","constant"),8:h("Constructor","constructor"),9:h("Enum","enumeration"),21:h("EnumMember","enumeration member"),23:h("Event","event"),7:h("Field","field"),0:h("File","file"),11:h("Function","function"),10:h("Interface","interface"),19:h("Key","key"),5:h("Method","method"),1:h("Module","module"),2:h("Namespace","namespace"),20:h("Null","null"),15:h("Number","number"),18:h("Object","object"),24:h("Operator","operator"),3:h("Package","package"),6:h("Property","property"),14:h("String","string"),22:h("Struct","struct"),25:h("TypeParameter","type parameter"),12:h("Variable","variable")};var gU;(e=>{let r=new Map;r.set(0,B.symbolFile),r.set(1,B.symbolModule),r.set(2,B.symbolNamespace),r.set(3,B.symbolPackage),r.set(4,B.symbolClass),r.set(5,B.symbolMethod),r.set(6,B.symbolProperty),r.set(7,B.symbolField),r.set(8,B.symbolConstructor),r.set(9,B.symbolEnum),r.set(10,B.symbolInterface),r.set(11,B.symbolFunction),r.set(12,B.symbolVariable),r.set(13,B.symbolConstant),r.set(14,B.symbolString),r.set(15,B.symbolNumber),r.set(16,B.symbolBoolean),r.set(17,B.symbolArray),r.set(18,B.symbolObject),r.set(19,B.symbolKey),r.set(20,B.symbolNull),r.set(21,B.symbolEnumMember),r.set(22,B.symbolStruct),r.set(23,B.symbolEvent),r.set(24,B.symbolOperator),r.set(25,B.symbolTypeParameter);function t(i){let n=r.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=B.symbolProperty),n}e.toIcon=t})(gU||={});var L$=class r{constructor(t){this.value=t}static Comment=new r("comment");static Imports=new r("imports");static Region=new r("region");static fromValue(t){switch(t){case"comment":return r.Comment;case"imports":return r.Imports;case"region":return r.Region}return new r(t)}};var Yre;(t=>{function r(e){return!e||typeof e!="object"?!1:typeof e.id=="string"&&typeof e.title=="string"}t.is=r})(Yre||={});var ca=new nE,aE=new nE;var Hn=$("languageService");function Fc(r,t){let e=r.getCount(),i=r.findTokenIndexAtOffset(t),n=r.getLanguageId(i),o=i;for(;o+1<e&&r.getLanguageId(o+1)===n;)o++;let s=i;for(;s>0&&r.getLanguageId(s-1)===n;)s--;return new fU(r,n,s,o+1,r.getStartOffset(s),r.getEndOffset(o))}var fU=class{_scopedLineTokensBrand=void 0;languageIdCodec;languageId;_actual;_firstTokenIndex;_lastTokenIndex;firstCharOffset;_lastCharOffset;constructor(t,e,i,n,o,s){this._actual=t,this.languageId=e,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=o,this._lastCharOffset=s,this.languageIdCodec=t.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(t){return this._actual.getLineContent().substring(0,this.firstCharOffset+t)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(t){return this._actual.findTokenIndexAtOffset(t+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(t){return this._actual.getStandardTokenType(t+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}},k$=(t=>(t[t.value=3]="value",t))(k$||{});function Cl(r){return(r&k$.value)!==0}var iy=class{open;close;_inString;_inComment;_inRegEx;_neutralCharacter=null;_neutralCharacterSearched=!1;constructor(t){if(this.open=t.open,this.close=t.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(t.notIn))for(let e=0,i=t.notIn.length;e<i;e++)switch(t.notIn[e]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(t){switch(t){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(t,e){if(t.getTokenCount()===0)return!0;let i=t.findTokenIndexAtOffset(e-2),n=t.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(t,e){for(let i=t;i<=e;i++){let n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}},Dk=class{autoClosingPairsOpenByStart;autoClosingPairsOpenByEnd;autoClosingPairsCloseByStart;autoClosingPairsCloseByEnd;autoClosingPairsCloseSingleChar;constructor(t){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(let e of t)lE(this.autoClosingPairsOpenByStart,e.open.charAt(0),e),lE(this.autoClosingPairsOpenByEnd,e.open.charAt(e.open.length-1),e),lE(this.autoClosingPairsCloseByStart,e.close.charAt(0),e),lE(this.autoClosingPairsCloseByEnd,e.close.charAt(e.close.length-1),e),e.close.length===1&&e.open.length===1&&lE(this.autoClosingPairsCloseSingleChar,e.close,e)}};function lE(r,t,e){r.has(t)?r.get(t).push(e):r.set(t,[e])}var bU=class r{_richEditBracketBrand=void 0;languageId;index;open;close;forwardRegex;reversedRegex;_openSet;_closeSet;constructor(t,e,i,n,o,s){this.languageId=t,this.index=e,this.open=i,this.close=n,this.forwardRegex=o,this.reversedRegex=s,this._openSet=r._toSet(this.open),this._closeSet=r._toSet(this.close)}isOpen(t){return this._openSet.has(t)}isClose(t){return this._closeSet.has(t)}static _toSet(t){let e=new Set;for(let i of t)e.add(i);return e}};function Zre(r){let t=r.length;r=r.map(s=>[s[0].toLowerCase(),s[1].toLowerCase()]);let e=[];for(let s=0;s<t;s++)e[s]=s;let i=(s,a)=>{let[l,d]=s,[c,u]=a;return l===c||l===u||d===c||d===u},n=(s,a)=>{let l=Math.min(s,a),d=Math.max(s,a);for(let c=0;c<t;c++)e[c]===d&&(e[c]=l)};for(let s=0;s<t;s++){let a=r[s];for(let l=s+1;l<t;l++){let d=r[l];i(a,d)&&n(e[s],e[l])}}let o=[];for(let s=0;s<t;s++){let a=[],l=[];for(let d=0;d<t;d++)if(e[d]===s){let[c,u]=r[d];a.push(c),l.push(u)}a.length>0&&o.push({open:a,close:l})}return o}var Lk=class{_richEditBracketsBrand=void 0;brackets;forwardRegex;reversedRegex;maxBracketLength;textIsBracket;textIsOpenBracket;constructor(t,e){let i=Zre(e);this.brackets=i.map((n,o)=>new bU(t,o,n.open,n.close,Xre(n.open,n.close,i,o),Qre(n.open,n.close,i,o))),this.forwardRegex=Jre(this.brackets),this.reversedRegex=ese(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(let n of this.brackets){for(let o of n.open)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,o.length);for(let o of n.close)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,o.length)}}};function R$(r,t,e,i){for(let n=0,o=t.length;n<o;n++){if(n===e)continue;let s=t[n];for(let a of s.open)a.indexOf(r)>=0&&i.push(a);for(let a of s.close)a.indexOf(r)>=0&&i.push(a)}}function A$(r,t){return r.length-t.length}function kk(r){if(r.length<=1)return r;let t=[],e=new Set;for(let i of r)e.has(i)||(t.push(i),e.add(i));return t}function Xre(r,t,e,i){let n=[];n=n.concat(r),n=n.concat(t);for(let o=0,s=n.length;o<s;o++)R$(n[o],e,i,n);return n=kk(n),n.sort(A$),n.reverse(),ny(n)}function Qre(r,t,e,i){let n=[];n=n.concat(r),n=n.concat(t);for(let o=0,s=n.length;o<s;o++)R$(n[o],e,i,n);return n=kk(n),n.sort(A$),n.reverse(),ny(n.map(vU))}function Jre(r){let t=[];for(let e of r){for(let i of e.open)t.push(i);for(let i of e.close)t.push(i)}return t=kk(t),ny(t)}function ese(r){let t=[];for(let e of r){for(let i of e.open)t.push(i);for(let i of e.close)t.push(i)}return t=kk(t),ny(t.map(vU))}function tse(r){let t=/^[\w ]+$/.test(r);return r=Jr(r),t?`\\b${r}\\b`:r}function ny(r,t){let e=`(${r.map(tse).join(")|(")})`;return dD(e,!0,t)}var vU=function(){function r(i){let n=new Uint16Array(i.length),o=0;for(let s=i.length-1;s>=0;s--)n[o++]=i.charCodeAt(s);return aU().decode(n)}let t=null,e=null;return function(n){return t!==n&&(t=n,e=r(t)),e}}(),as=class{static _findPrevBracketInText(t,e,i,n){let o=i.match(t);if(!o)return null;let s=i.length-(o.index||0),a=o[0].length,l=n+s;return new F(e,l-a+1,e,l+1)}static findPrevBracketInRange(t,e,i,n,o){let a=vU(i).substring(i.length-o,i.length-n);return this._findPrevBracketInText(t,e,a,n)}static findNextBracketInText(t,e,i,n){let o=i.match(t);if(!o)return null;let s=o.index||0,a=o[0].length;if(a===0)return null;let l=n+s;return new F(e,l+1,e,l+1+a)}static findNextBracketInRange(t,e,i,n,o){let s=i.substring(n,o);return this.findNextBracketInText(t,e,s,n)}};var Rk=class{constructor(t,e){this.languageId=t;let i=e.brackets?P$(e.brackets):[],n=new fh(a=>{let l=new Set;return{info:new yU(this,a,l),closing:l}}),o=new fh(a=>{let l=new Set,d=new Set;return{info:new IU(this,a,l,d),opening:l,openingColorized:d}});for(let[a,l]of i){let d=n.get(a),c=o.get(l);d.closing.add(c.info),c.opening.add(d.info)}let s=e.colorizedBracketPairs?P$(e.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(let[a,l]of s){let d=n.get(a),c=o.get(l);d.closing.add(c.info),c.openingColorized.add(d.info),c.opening.add(d.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...o.cachedValues].map(([a,l])=>[a,l.info]))}_openingBrackets;_closingBrackets;get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(t){return this._openingBrackets.get(t)}getClosingBracketInfo(t){return this._closingBrackets.get(t)}getBracketInfo(t){return this.getOpeningBracketInfo(t)||this.getClosingBracketInfo(t)}getBracketRegExp(t){let e=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return ny(e,t)}};function P$(r){return r.filter(([t,e])=>t!==""&&e!=="")}var Ak=class{constructor(t,e){this.config=t;this.bracketText=e}get languageId(){return this.config.languageId}},yU=class extends Ak{constructor(e,i,n){super(e,i);this.openedBrackets=n}isOpeningBracket=!0},IU=class extends Ak{constructor(e,i,n,o){super(e,i);this.openingBrackets=n;this.openingColorizedBrackets=o}isOpeningBracket=!1;closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}};var Ni=class r{static _nextVisibleColumn(t,e,i){return t===9?r.nextRenderTabStop(e,i):xa(t)||nw(t)?e+2:e+1}static visibleColumnFromColumn(t,e,i){let n=Math.min(e-1,t.length),o=t.substring(0,n),s=new wg(o),a=0;for(;!s.eol();){let l=Xb(o,n,s.offset);s.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static toStatusbarColumn(t,e,i){let n=t.substring(0,Math.min(e-1,t.length)),o=new Sg(n),s=0;for(;!o.eol();)o.nextCodePoint()===9?s=r.nextRenderTabStop(s,i):s=s+1;return s+1}static columnFromVisibleColumn(t,e,i){if(e<=0)return 1;let n=t.length,o=new wg(t),s=0,a=1;for(;!o.eol();){let l=Xb(t,n,o.offset);o.nextGraphemeLength();let d=this._nextVisibleColumn(l,s,i),c=o.offset+1;if(d>=e){let u=e-s;return d-e<u?c:a}s=d,a=c}return n+1}static nextRenderTabStop(t,e){return t+e-t%e}static nextIndentTabStop(t,e){return t+e-t%e}static prevRenderTabStop(t,e){return Math.max(0,t-1-(t-1)%e)}static prevIndentTabStop(t,e){return Math.max(0,t-1-(t-1)%e)}};var Ts=class r{constructor(t,e){this.lineCount=t;this.columnCount=e}static zero=new r(0,0);static lengthDiffNonNegative(t,e){return e.isLessThan(t)?r.zero:t.lineCount===e.lineCount?new r(0,e.columnCount-t.columnCount):new r(e.lineCount-t.lineCount,e.columnCount)}static betweenPositions(t,e){return t.lineNumber===e.lineNumber?new r(0,e.column-t.column):new r(e.lineNumber-t.lineNumber,e.column-1)}static ofRange(t){return r.betweenPositions(t.getStartPosition(),t.getEndPosition())}static ofText(t){let e=0,i=0;for(let n of t)n===`
`?(e++,i=0):i++;return new r(e,i)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(t){return this.lineCount!==t.lineCount?this.lineCount<t.lineCount:this.columnCount<t.columnCount}isGreaterThan(t){return this.lineCount!==t.lineCount?this.lineCount>t.lineCount:this.columnCount>t.columnCount}isGreaterThanOrEqualTo(t){return this.lineCount!==t.lineCount?this.lineCount>t.lineCount:this.columnCount>=t.columnCount}equals(t){return this.lineCount===t.lineCount&&this.columnCount===t.columnCount}compare(t){return this.lineCount!==t.lineCount?this.lineCount-t.lineCount:this.columnCount-t.columnCount}add(t){return t.lineCount===0?new r(this.lineCount,this.columnCount+t.columnCount):new r(this.lineCount+t.lineCount,t.columnCount)}createRange(t){return this.lineCount===0?new F(t.lineNumber,t.column,t.lineNumber,t.column+this.columnCount):new F(t.lineNumber,t.column,t.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new F(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(t){return this.lineCount===0?new U(t.lineNumber,t.column+this.columnCount):new U(t.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};function M$(r,t,e,i){return r!==e?Ji(e-r,i):Ji(0,i-t)}var _o=0;function oy(r){return r===0}var ua=2**26;function Ji(r,t){return r*ua+t}function qr(r){let t=r,e=Math.floor(t/ua),i=t-e*ua;return new Ts(e,i)}function O$(r){return Math.floor(r/ua)}function Gi(r,t){let e=r+t;return t>=ua&&(e=e-r%ua),e}function N$(r,t){return r.reduce((e,i)=>Gi(e,t(i)),_o)}function CU(r,t){return r===t}function jg(r,t){let e=r,i=t;if(i-e<=0)return _o;let o=Math.floor(e/ua),s=Math.floor(i/ua),a=i-s*ua;if(o===s){let l=e-o*ua;return Ji(0,a-l)}else return Ji(s-o,a)}function gp(r,t){return r<t}function zh(r,t){return r<=t}function ry(r,t){return r>=t}function Kh(r){return Ji(r.lineNumber-1,r.column-1)}function Gh(r,t){let e=r,i=Math.floor(e/ua),n=e-i*ua,o=t,s=Math.floor(o/ua),a=o-s*ua;return new F(i+1,n+1,s+1,a+1)}function F$(r){let t=ZS(r);return Ji(t.length-1,t[t.length-1].length)}var Pk=[],ar=class r{constructor(t,e){this.items=t;this.additionalItems=e}static cache=new Array(129);static create(t,e){if(t<=128&&e.length===0){let i=r.cache[t];return i||(i=new r(t,e),r.cache[t]=i),i}return new r(t,e)}static empty=r.create(0,Pk);static getEmpty(){return this.empty}add(t,e){let i=e.getKey(t),n=i>>5;if(n===0){let s=1<<i|this.items;return s===this.items?this:r.create(s,this.additionalItems)}n--;let o=this.additionalItems.slice(0);for(;o.length<n;)o.push(0);return o[n]|=1<<(i&31),r.create(this.items,o)}has(t,e){let i=e.getKey(t),n=i>>5;return n===0?(this.items&1<<i)!==0:(n--,((this.additionalItems[n]||0)&1<<(i&31))!==0)}merge(t){let e=this.items|t.items;if(this.additionalItems===Pk&&t.additionalItems===Pk)return e===this.items?this:e===t.items?t:r.create(e,Pk);let i=[];for(let n=0;n<Math.max(this.additionalItems.length,t.additionalItems.length);n++){let o=this.additionalItems[n]||0,s=t.additionalItems[n]||0;i.push(o|s)}return r.create(e,i)}intersects(t){if(this.items&t.items)return!0;for(let e=0;e<Math.min(this.additionalItems.length,t.additionalItems.length);e++)if(this.additionalItems[e]&t.additionalItems[e])return!0;return!1}equals(t){if(this.items!==t.items||this.additionalItems.length!==t.additionalItems.length)return!1;for(let e=0;e<this.additionalItems.length;e++)if(this.additionalItems[e]!==t.additionalItems[e])return!1;return!0}},SU={getKey(r){return r}},Mk=class{items=new Map;getKey(t){let e=this.items.get(t);return e===void 0&&(e=this.items.size,this.items.set(t,e)),e}reverseLookup(t){return[...this.items].find(([e,i])=>i===t)?.[0]}reverseLookupSet(t){let e=[];for(let[i]of this.items)t.has(i,this)&&e.push(i);return e}keys(){return this.items.keys()}};var Ok=class r{static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;static DEFAULT_AUTOCLOSE_BEFORE_WHITESPACE=` 
	`;_autoClosingPairs;_surroundingPairs;_autoCloseBeforeForQuotes;_autoCloseBeforeForBrackets;constructor(t){if(t.autoClosingPairs?this._autoClosingPairs=t.autoClosingPairs.map(e=>new iy(e)):t.brackets?this._autoClosingPairs=t.brackets.map(e=>new iy({open:e[0],close:e[1]})):this._autoClosingPairs=[],t.__electricCharacterSupport&&t.__electricCharacterSupport.docComment){let e=t.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new iy({open:e.open,close:e.close||""}))}this._autoCloseBeforeForQuotes=typeof t.autoCloseBefore=="string"?t.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof t.autoCloseBefore=="string"?t.autoCloseBefore:r.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=t.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(t){return t?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};var Nk=class{_richEditBrackets;constructor(t){this._richEditBrackets=t}getElectricCharacters(){let t=[];if(this._richEditBrackets)for(let e of this._richEditBrackets.brackets)for(let i of e.close){let n=i.charAt(i.length-1);t.push(n)}return yo(t)}onElectricCharacter(t,e,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;let n=e.findTokenIndexAtOffset(i-1);if(Cl(e.getStandardTokenType(n)))return null;let o=this._richEditBrackets.reversedRegex,s=e.getLineContent().substring(0,i-1)+t,a=as.findPrevBracketInRange(o,1,s,0,s.length);if(!a)return null;let l=s.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;let c=e.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:l}:null}};function Fk(r){return r.global&&(r.lastIndex=0),!0}var Bk=class{_indentationRules;constructor(t){this._indentationRules=t}shouldIncrease(t){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&Fk(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(t))}shouldDecrease(t){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&Fk(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(t))}shouldIndentNextLine(t){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&Fk(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(t))}shouldIgnore(t){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&Fk(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(t))}getIndentMetadata(t){let e=0;return this.shouldIncrease(t)&&(e+=1),this.shouldDecrease(t)&&(e+=2),this.shouldIndentNextLine(t)&&(e+=4),this.shouldIgnore(t)&&(e+=8),e}};var Vk=class r{_brackets;_regExpRules;constructor(t){t=t||{},t.brackets=t.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],t.brackets.forEach(e=>{let i=r._createOpenBracketRegExp(e[0]),n=r._createCloseBracketRegExp(e[1]);i&&n&&this._brackets.push({open:e[0],openRegExp:i,close:e[1],closeRegExp:n})}),this._regExpRules=t.onEnterRules||[]}onEnter(t,e,i,n){if(t>=3)for(let o=0,s=this._regExpRules.length;o<s;o++){let a=this._regExpRules[o];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:e}].every(d=>d.reg?(d.reg.lastIndex=0,d.reg.test(d.text)):!0))return a.action}if(t>=2&&i.length>0&&n.length>0)for(let o=0,s=this._brackets.length;o<s;o++){let a=this._brackets[o];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:2}}if(t>=2&&i.length>0){for(let o=0,s=this._brackets.length;o<s;o++)if(this._brackets[o].openRegExp.test(i))return{indentAction:1}}return null}static _createOpenBracketRegExp(t){let e=Jr(t);return/\B/.test(e.charAt(0))||(e="\\b"+e),e+="\\s*$",r._safeRegExp(e)}static _createCloseBracketRegExp(t){let e=Jr(t);return/\B/.test(e.charAt(e.length-1))||(e=e+"\\b"),e="^\\s*"+e,r._safeRegExp(e)}static _safeRegExp(t){try{return new RegExp(t)}catch(e){return Ke(e),null}}};var V$=[];function vi(r,t,e){t instanceof Xs||(t=new Xs(t,[],!!e)),V$.push([r,t])}function W$(){return V$}var Id=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),ise={".css":"text/css",".csv":"text/csv",".htm":"text/html",".html":"text/html",".ics":"text/calendar",".js":"text/javascript",".mjs":"text/javascript",".txt":"text/plain",".xml":"text/xml"},nse={".aac":"audio/x-aac",".avi":"video/x-msvideo",".bmp":"image/bmp",".flv":"video/x-flv",".gif":"image/gif",".ico":"image/x-icon",".jpe":"image/jpg",".jpeg":"image/jpg",".jpg":"image/jpg",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3a":"audio/mpeg",".mid":"audio/midi",".midi":"audio/midi",".mk3d":"video/x-matroska",".mks":"video/x-matroska",".mkv":"video/x-matroska",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp2a":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4a":"audio/mp4",".mp4v":"video/mp4",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpg4":"video/mp4",".mpga":"audio/mpeg",".oga":"audio/ogg",".ogg":"audio/ogg",".opus":"audio/opus",".ogv":"video/ogg",".png":"image/png",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".spx":"audio/ogg",".svg":"image/svg+xml",".tga":"image/x-tga",".tif":"image/tiff",".tiff":"image/tiff",".wav":"audio/x-wav",".webm":"video/webm",".webp":"image/webp",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".woff":"application/font-woff"};function U$(r){let t=Pu(r),e=ise[t.toLowerCase()];return e!==void 0?e:ose(r)}function ose(r){let t=Pu(r);return nse[t.toLowerCase()]}var rse={ModesRegistry:"editor.modesRegistry"},EU=class{_languages;_onDidChangeLanguages=new T;onDidChangeLanguages=this._onDidChangeLanguages.event;constructor(){this._languages=[]}registerLanguage(t){return this._languages.push(t),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let e=0,i=this._languages.length;e<i;e++)if(this._languages[e]===t){this._languages.splice(e,1);return}}}}getLanguages(){return this._languages}},H$=new EU;Ne.add(rse.ModesRegistry,H$);var Cd="plaintext",sse=".txt";H$.registerLanguage({id:Cd,extensions:[sse],aliases:[h("plainText.alias","Plain Text"),"text"],mimetypes:[Id.text]});Ne.as(xi.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);var cE=class{constructor(t){this.languageId=t}affects(t){return this.languageId?this.languageId===t:!0}},fp=$("languageConfigurationService"),dE=class extends L{constructor(e,i){super();this.configurationService=e;this.languageService=i;let n=new Set(Object.values(TU));this._register(this.configurationService.onDidChangeConfiguration(o=>{let s=o.change.keys.some(l=>n.has(l)),a=o.change.overrides.filter(([l,d])=>d.some(c=>n.has(c))).map(([l])=>l);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new cE(void 0));else for(let l of a)this.languageService.isRegisteredLanguageId(l)&&(this.configurations.delete(l),this.onDidChangeEmitter.fire(new cE(l)))})),this._register(this._registry.onDidChange(o=>{this.configurations.delete(o.languageId),this.onDidChangeEmitter.fire(new cE(o.languageId))}))}_serviceBrand;_registry=this._register(new _U);onDidChangeEmitter=this._register(new T);onDidChange=this.onDidChangeEmitter.event;configurations=new Map;register(e,i,n){return this._registry.register(e,i,n)}getLanguageConfiguration(e){let i=this.configurations.get(e);return i||(i=ase(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,i)),i}};dE=_([v(0,de),v(1,Hn)],dE);function ase(r,t,e,i){let n=t.getLanguageConfiguration(r);if(!n){if(!i.isRegisteredLanguageId(r))return new sy(r,{});n=new sy(r,{})}let o=lse(n.languageId,e),s=K$([n.underlyingConfig,o]);return new sy(n.languageId,s)}var TU={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function lse(r,t){let e=t.getValue(TU.brackets,{overrideIdentifier:r}),i=t.getValue(TU.colorizedBracketPairs,{overrideIdentifier:r});return{brackets:z$(e),colorizedBracketPairs:z$(i)}}function z$(r){if(Array.isArray(r))return r.map(t=>{if(!(!Array.isArray(t)||t.length!==2))return[t[0],t[1]]}).filter(t=>!!t)}function Hk(r,t,e){let i=r.getLineContent(t),n=Co(i);return n.length>e-1&&(n=n.substring(0,e-1)),n}var xU=class{constructor(t){this.languageId=t;this._entries=[],this._order=0,this._resolved=null}_entries;_order;_resolved=null;register(t,e){let i=new Wk(t,e,++this._order);return this._entries.push(i),this._resolved=null,te(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){let t=this._resolve();t&&(this._resolved=new sy(this.languageId,t))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(Wk.cmp),K$(this._entries.map(t=>t.configuration)))}};function K$(r){let t={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(let e of r)t={comments:e.comments||t.comments,brackets:e.brackets||t.brackets,wordPattern:e.wordPattern||t.wordPattern,indentationRules:e.indentationRules||t.indentationRules,onEnterRules:e.onEnterRules||t.onEnterRules,autoClosingPairs:e.autoClosingPairs||t.autoClosingPairs,surroundingPairs:e.surroundingPairs||t.surroundingPairs,autoCloseBefore:e.autoCloseBefore||t.autoCloseBefore,folding:e.folding||t.folding,colorizedBracketPairs:e.colorizedBracketPairs||t.colorizedBracketPairs,__electricCharacterSupport:e.__electricCharacterSupport||t.__electricCharacterSupport};return t}var Wk=class{constructor(t,e,i){this.configuration=t;this.priority=e;this.order=i}static cmp(t,e){return t.priority===e.priority?t.order-e.order:t.priority-e.priority}},Uk=class{constructor(t){this.languageId=t}},_U=class extends L{_entries=new Map;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;constructor(){super(),this._register(this.register(Cd,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(t,e,i=0){let n=this._entries.get(t);n||(n=new xU(t),this._entries.set(t,n));let o=n.register(e,i);return this._onDidChange.fire(new Uk(t)),te(()=>{o.dispose(),this._onDidChange.fire(new Uk(t))})}getLanguageConfiguration(t){return this._entries.get(t)?.getResolvedConfiguration()||null}},sy=class r{constructor(t,e){this.languageId=t;this.underlyingConfig=e;this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Vk(this.underlyingConfig):null,this.comments=r._handleComments(this.underlyingConfig),this.characterPair=new Ok(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||gk,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Bk(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new Rk(t,this.underlyingConfig)}_brackets;_electricCharacter;_onEnterSupport;comments;characterPair;wordDefinition;indentRulesSupport;indentationRules;foldingRules;bracketsNew;getWordDefinition(){return Xw(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new Lk(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new Nk(this.brackets)),this._electricCharacter}onEnter(t,e,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(t,e,i,n):null}getAutoClosingPairs(){return new Dk(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(t){return this.characterPair.getAutoCloseBeforeSet(t)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(t){let e=t.comments;if(!e)return null;let i={};if(e.lineComment&&(i.lineCommentToken=e.lineComment),e.blockComment){let[n,o]=e.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=o}return i}};vi(fp,dE,1);var DU=class r{constructor(t){this.map=t}static createFromLanguage(t,e){function i(o){return e.getKey(`${o.languageId}:::${o.bracketText}`)}let n=new Map;for(let o of t.bracketsNew.openingBrackets){let s=Ji(0,o.bracketText.length),a=i(o),l=ar.getEmpty().add(a,SU);n.set(o.bracketText,new Sd(s,1,a,l,uE.create(s,o,l)))}for(let o of t.bracketsNew.closingBrackets){let s=Ji(0,o.bracketText.length),a=ar.getEmpty(),l=o.getOpeningBrackets();for(let d of l)a=a.add(i(d),SU);n.set(o.bracketText,new Sd(s,2,i(l[0]),a,uE.create(s,o,a)))}return new r(n)}hasRegExp=!1;_regExpGlobal=null;getRegExpStr(){if(this.isEmpty)return null;{let t=[...this.map.keys()];return t.sort(),t.reverse(),t.map(e=>dse(e)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){let t=this.getRegExpStr();this._regExpGlobal=t?new RegExp(t,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(t){return this.map.get(t.toLowerCase())}findClosingTokenText(t){for(let[e,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(t))return e}get isEmpty(){return this.map.size===0}};function dse(r){let t=Jr(r);return/^[\w ]+/.test(r)&&(t=`\\b${t}`),/[\w ]+$/.test(r)&&(t=`${t}\\b`),t}var zk=class{constructor(t,e){this.denseKeyProvider=t;this.getLanguageConfiguration=e}languageIdToBracketTokens=new Map;didLanguageChange(t){return this.languageIdToBracketTokens.has(t)}getSingleLanguageBracketTokens(t){let e=this.languageIdToBracketTokens.get(t);return e||(e=DU.createFromLanguage(this.getLanguageConfiguration(t),this.denseKeyProvider),this.languageIdToBracketTokens.set(t,e)),e}getToken(t,e){return this.getSingleLanguageBracketTokens(e).getToken(t)}};var Sd=class{constructor(t,e,i,n,o){this.length=t;this.kind=e;this.bracketId=i;this.bracketIds=n;this.astNode=o}},Kk=class{constructor(t,e){this.textModel=t;this.bracketTokens=e;this.textBufferLineCount=t.getLineCount(),this.textBufferLastLineLength=t.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;reader=new LU(this.textModel,this.bracketTokens);_offset=_o;get offset(){return this._offset}get length(){return Ji(this.textBufferLineCount-1,this.textBufferLastLineLength)}getText(){return this.textModel.getValue()}skip(t){this.didPeek=!1,this._offset=Gi(this._offset,t);let e=qr(this._offset);this.reader.setPosition(e.lineCount,e.columnCount)}didPeek=!1;peeked=null;read(){let t;return this.peeked?(this.didPeek=!1,t=this.peeked):t=this.reader.read(),t&&(this._offset=Gi(this._offset,t.length)),t}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}},LU=class{constructor(t,e){this.textModel=t;this.bracketTokens=e;this.textBufferLineCount=t.getLineCount(),this.textBufferLastLineLength=t.getLineLength(this.textBufferLineCount)}textBufferLineCount;textBufferLastLineLength;lineIdx=0;line=null;lineCharOffset=0;lineTokens=null;lineTokenOffset=0;setPosition(t,e){t===this.lineIdx?(this.lineCharOffset=e,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=t,this.lineCharOffset=e,this.line=null),this.peekedToken=null}peekedToken=null;read(){if(this.peekedToken){let o=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=o.length,o}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));let t=this.lineIdx,e=this.lineCharOffset,i=0;for(;;){let o=this.lineTokens,s=o.getCount(),a=null;if(this.lineTokenOffset<s){let l=o.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<s&&l===o.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;let d=da.getTokenType(l)===0,c=da.containsBalancedBrackets(l),u=o.getEndOffset(this.lineTokenOffset);if(c&&d&&this.lineCharOffset<u){let p=o.getLanguageId(this.lineTokenOffset),m=this.line.substring(this.lineCharOffset,u),g=this.bracketTokens.getSingleLanguageBracketTokens(p),f=g.regExpGlobal;if(f){f.lastIndex=0;let b=f.exec(m);b&&(a=g.getToken(b[0]),a&&(this.lineCharOffset+=b.index))}}if(i+=u-this.lineCharOffset,a)if(t!==this.lineIdx||e!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}let n=M$(t,e,this.lineIdx,this.lineCharOffset);return new Sd(n,0,-1,ar.getEmpty(),new wd(n))}},Gk=class{constructor(t,e){this.text=t;let i=e.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,o=[],s,a=0,l=0,d=0,c=0,u=[];for(let g=0;g<60;g++)u.push(new Sd(Ji(0,g),0,-1,ar.getEmpty(),new wd(Ji(0,g))));let p=[];for(let g=0;g<60;g++)p.push(new Sd(Ji(1,g),0,-1,ar.getEmpty(),new wd(Ji(1,g))));if(n)for(n.lastIndex=0;(s=n.exec(t))!==null;){let g=s.index,f=s[0];if(f===`
`)a++,l=g+1;else{if(d!==g){let b;if(c===a){let y=g-d;if(y<u.length)b=u[y];else{let I=Ji(0,y);b=new Sd(I,0,-1,ar.getEmpty(),new wd(I))}}else{let y=a-c,I=g-l;if(y===1&&I<p.length)b=p[I];else{let E=Ji(y,I);b=new Sd(E,0,-1,ar.getEmpty(),new wd(E))}}o.push(b)}o.push(e.getToken(f)),d=g+f.length,c=a}}let m=t.length;if(d!==m){let g=c===a?Ji(0,m-d):Ji(a-c,m-l);o.push(new Sd(g,0,-1,ar.getEmpty(),new wd(g)))}this.length=Ji(a,m-l),this.tokens=o}_offset=_o;tokens;idx=0;get offset(){return this._offset}length;read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(t){throw new U_}getText(){return this.text}};var pE=class{_length;get length(){return this._length}constructor(t){this._length=t}},hE=class r extends pE{constructor(e,i,n,o,s){super(e);this.openingBracket=i;this.child=n;this.closingBracket=o;this.missingOpeningBracketIds=s}static create(e,i,n){let o=e.length;return i&&(o=Gi(o,i.length)),n&&(o=Gi(o,n.length)),new r(o,e,i,n,i?i.missingOpeningBracketIds:ar.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){let e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}flattenLists(){return r.create(this.openingBracket.flattenLists(),this.child&&this.child.flattenLists(),this.closingBracket&&this.closingBracket.flattenLists())}deepClone(){return new r(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,i){return this.child?this.child.computeMinIndentation(Gi(e,this.openingBracket.length),i):Number.MAX_SAFE_INTEGER}},pa=class r extends pE{constructor(e,i,n){super(e);this.listHeight=i;this._missingOpeningBracketIds=n}static create23(e,i,n,o=!1){let s=e.length,a=e.missingOpeningBracketIds;if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");if(s=Gi(s,i.length),a=a.merge(i.missingOpeningBracketIds),n){if(e.listHeight!==n.listHeight)throw new Error("Invalid list heights");s=Gi(s,n.length),a=a.merge(n.missingOpeningBracketIds)}return o?new kU(s,e.listHeight+1,e,i,n,a):new mE(s,e.listHeight+1,e,i,n,a)}static create(e,i=!1){if(e.length===0)return this.getEmpty();{let n=e[0].length,o=e[0].missingOpeningBracketIds;for(let s=1;s<e.length;s++)n=Gi(n,e[s].length),o=o.merge(e[s].missingOpeningBracketIds);return i?new qk(n,e[0].listHeight+1,e,o):new gE(n,e[0].listHeight+1,e,o)}}static getEmpty(){return new qk(_o,0,[],ar.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}cachedMinIndentation=-1;throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();let e=this.childrenLength;if(e===0)return;let i=this.getChild(e-1),n=i.kind===4?i.toMutable():i;return i!==n&&this.setChild(e-1,n),n}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;let i=this.getChild(0),n=i.kind===4?i.toMutable():i;return i!==n&&this.setChild(0,n),n}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let i=this;for(;i.kind===4;){let n=i.childrenLength;if(n===0)throw new yt;i=i.getChild(n-1)}return i.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();let e=this.childrenLength,i=this.getChild(0).length,n=this.getChild(0).missingOpeningBracketIds;for(let o=1;o<e;o++){let s=this.getChild(o);i=Gi(i,s.length),n=n.merge(s.missingOpeningBracketIds)}this._length=i,this._missingOpeningBracketIds=n,this.cachedMinIndentation=-1}flattenLists(){let e=[];for(let i of this.children){let n=i.flattenLists();n.kind===4?e.push(...n.children):e.push(n)}return r.create(e)}computeMinIndentation(e,i){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let n=Number.MAX_SAFE_INTEGER,o=e;for(let s=0;s<this.childrenLength;s++){let a=this.getChild(s);a&&(n=Math.min(n,a.computeMinIndentation(o,i)),o=Gi(o,a.length))}return this.cachedMinIndentation=n,n}},mE=class r extends pa{constructor(e,i,n,o,s,a){super(e,i,a);this._item1=n;this._item2=o;this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,i){switch(e){case 0:this._item1=i;return;case 1:this._item2=i;return;case 2:this._item3=i;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new r(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();let e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}},kU=class extends mE{toMutable(){return new mE(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},gE=class r extends pa{constructor(e,i,n,o){super(e,i,o);this._children=n}get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,i){this._children[e]=i}get children(){return this._children}deepClone(){let e=new Array(this._children.length);for(let i=0;i<this._children.length;i++)e[i]=this._children[i].deepClone();return new r(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();let e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();let e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}},qk=class extends gE{toMutable(){return new gE(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}},use=[],fE=class extends pE{get listHeight(){return 0}get childrenLength(){return 0}getChild(t){return null}get children(){return use}flattenLists(){return this}deepClone(){return this}},wd=class extends fE{get kind(){return 0}get missingOpeningBracketIds(){return ar.getEmpty()}canBeReused(t){return!0}computeMinIndentation(t,e){let i=qr(t),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,o=O$(Gi(t,this.length))+1,s=Number.MAX_SAFE_INTEGER;for(let a=n;a<=o;a++){let l=e.getLineFirstNonWhitespaceColumn(a),d=e.getLineContent(a);if(l===0)continue;let c=Ni.visibleColumnFromColumn(d,l,e.getOptions().tabSize);s=Math.min(s,c)}return s}},uE=class r extends fE{constructor(e,i,n){super(e);this.bracketInfo=i;this.bracketIds=n}static create(e,i,n){return new r(e,i,n)}get kind(){return 1}get missingOpeningBracketIds(){return ar.getEmpty()}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,i){return Number.MAX_SAFE_INTEGER}},jk=class extends fE{get kind(){return 3}missingOpeningBracketIds;constructor(t,e){super(e),this.missingOpeningBracketIds=t}canBeReused(t){return!t.intersects(this.missingOpeningBracketIds)}computeMinIndentation(t,e){return Number.MAX_SAFE_INTEGER}};var bE=class{constructor(t,e,i,n){this.range=t;this.nestingLevel=e;this.nestingLevelOfEqualBracketType=i;this.isInvalid=n}},RU=class{constructor(t,e,i,n,o,s){this.range=t;this.openingBracketRange=e;this.closingBracketRange=i;this.nestingLevel=n;this.nestingLevelOfEqualBracketType=o;this.bracketPairNode=s}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}get closingBracketInfo(){return this.bracketPairNode.closingBracket?.bracketInfo}},$k=class extends RU{constructor(e,i,n,o,s,a,l){super(e,i,n,o,s,a);this.minVisibleColumnIndentation=l}};var Yk=class{changeType=1},xs=class r{constructor(t,e,i,n,o){this.ownerId=t;this.lineNumber=e;this.column=i;this.options=n;this.order=o}static applyInjectedText(t,e){if(!e||e.length===0)return t;let i="",n=0;for(let o of e)i+=t.substring(n,o.column-1),n=o.column-1,i+=o.options.content;return i+=t.substring(n),i}static fromDecorations(t){let e=[];for(let i of t)i.options.before&&i.options.before.content.length>0&&e.push(new r(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&e.push(new r(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return e.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),e}withText(t){return new r(this.ownerId,this.lineNumber,this.column,{...this.options,content:t},this.order)}},vE=class{changeType=2;lineNumber;detail;injectedText;constructor(t,e,i){this.lineNumber=t,this.detail=e,this.injectedText=i}},Zk=class{changeType=3;fromLineNumber;toLineNumber;constructor(t,e){this.fromLineNumber=t,this.toLineNumber=e}},Xk=class{changeType=4;fromLineNumber;toLineNumber;detail;injectedTexts;constructor(t,e,i,n){this.injectedTexts=n,this.fromLineNumber=t,this.toLineNumber=e,this.detail=i}},Qk=class{changeType=5},$g=class r{changes;versionId;isUndoing;isRedoing;resultingSelection;constructor(t,e,i,n){this.changes=t,this.versionId=e,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(t){for(let e=0,i=this.changes.length;e<i;e++)if(this.changes[e].changeType===t)return!0;return!1}static merge(t,e){let i=[].concat(t.changes).concat(e.changes),n=e.versionId,o=t.isUndoing||e.isUndoing,s=t.isRedoing||e.isRedoing;return new r(i,n,o,s)}},ay=class{changes;constructor(t){this.changes=t}},qh=class r{constructor(t,e){this.rawContentChangedEvent=t;this.contentChangedEvent=e}merge(t){let e=$g.merge(this.rawContentChangedEvent,t.rawContentChangedEvent),i=r._mergeChangeEvents(this.contentChangedEvent,t.contentChangedEvent);return new r(e,i)}static _mergeChangeEvents(t,e){let i=[].concat(t.changes).concat(e.changes),n=e.eol,o=e.versionId,s=t.isUndoing||e.isUndoing,a=t.isRedoing||e.isRedoing,l=t.isFlush||e.isFlush,d=t.isEolChange&&e.isEolChange;return{changes:i,eol:n,isEolChange:d,versionId:o,isUndoing:s,isRedoing:a,isFlush:l}}};var Sl=class{constructor(t,e,i,n,o,s){this.visibleColumn=t;this.column=e;this.className=i;this.horizontalLine=n;this.forWrappedLinesAfterColumn=o;this.forWrappedLinesBeforeOrAtColumn=s;if(t!==-1==(e!==-1))throw new Error}},bp=class{constructor(t,e){this.top=t;this.endColumn=e}};var Jk=class r{constructor(t){this.edits=t;let e=-1;for(let i of t){if(!(i.replaceRange.start>=e))throw new yt(`Edits must be disjoint and sorted. Found ${i} after ${e}`);e=i.replaceRange.endExclusive}}static empty=new r([]);static fromJson(t){return new r(t.map(Ed.fromJson))}static replace(t,e){return new r([new Ed(t,e)])}static insert(t,e){return r.replace(Xe.emptyAt(t),e)}normalize(){let t=[],e;for(let i of this.edits)i.newText.length===0&&i.replaceRange.length===0||(e&&e.replaceRange.endExclusive===i.replaceRange.start?e=new Ed(e.replaceRange.join(i.replaceRange),e.newText+i.newText):(e&&t.push(e),e=i));return e&&t.push(e),new r(t)}toString(){return`[${this.edits.map(e=>e.toString()).join(", ")}]`}apply(t){let e=[],i=0;for(let n of this.edits)e.push(t.substring(i,n.replaceRange.start)),e.push(n.newText),i=n.replaceRange.endExclusive;return e.push(t.substring(i)),e.join("")}compose(t){return hse(this,t)}inverse(t){let e=[],i=0;for(let n of this.edits)e.push(new Ed(Xe.ofStartAndLength(n.replaceRange.start+i,n.newText.length),t.substring(n.replaceRange.start,n.replaceRange.endExclusive))),i+=n.newText.length-n.replaceRange.length;return new r(e)}getNewTextRanges(){let t=[],e=0;for(let i of this.edits)t.push(Xe.ofStartAndLength(i.replaceRange.start+e,i.newText.length)),e+=i.newText.length-i.replaceRange.length;return t}get isEmpty(){return this.edits.length===0}tryRebase(t){let e=[],i=0,n=0,o=0;for(;n<this.edits.length||i<t.edits.length;){let s=t.edits[i],a=this.edits[n];if(a)s?a.replaceRange.intersects(s.replaceRange)?n++:a.replaceRange.start<s.replaceRange.start?(e.push(new Ed(a.replaceRange.delta(o),a.newText)),n++):(i++,o+=s.newText.length-s.replaceRange.length):(e.push(new Ed(a.replaceRange.delta(o),a.newText)),n++);else break}return new r(e)}applyToOffset(t){let e=0;for(let i of this.edits)if(i.replaceRange.start<=t){if(t<i.replaceRange.endExclusive)return i.replaceRange.start+e;e+=i.newText.length-i.replaceRange.length}else break;return t+e}applyToOffsetRange(t){return new Xe(this.applyToOffset(t.start),this.applyToOffset(t.endExclusive))}applyInverseToOffset(t){let e=0;for(let i of this.edits){let n=i.newText.length;if(i.replaceRange.start<=t-e){if(t-e<i.replaceRange.start+n)return i.replaceRange.start;e+=n-i.replaceRange.length}else break}return t-e}},Ed=class r{constructor(t,e){this.replaceRange=t;this.newText=e}static fromJson(t){return new r(Xe.ofStartAndLength(t.pos,t.len),t.txt)}static insert(t,e){return new r(Xe.emptyAt(t),e)}toString(){return`${this.replaceRange} -> "${this.newText}"`}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function hse(r,t){if(r=r.normalize(),t=t.normalize(),r.isEmpty)return t;if(t.isEmpty)return r;let e=[...r.edits],i=[],n=0;for(let o of t.edits){for(;;){let d=e[0];if(!d||d.replaceRange.start+n+d.newText.length>=o.replaceRange.start)break;e.shift(),i.push(d),n+=d.newText.length-d.replaceRange.length}let s=n,a,l;for(;;){let d=e[0];if(!d||d.replaceRange.start+n>o.replaceRange.endExclusive)break;a||(a=d),l=d,e.shift(),n+=d.newText.length-d.replaceRange.length}if(!a)i.push(new Ed(o.replaceRange.delta(-n),o.newText));else{let d="",c=o.replaceRange.start-(a.replaceRange.start+s);c>0&&(d=a.newText.slice(0,c));let u=l.replaceRange.endExclusive+n-o.replaceRange.endExclusive;if(u>0){let g=new Ed(Xe.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-u));e.unshift(g),n-=g.newText.length-g.replaceRange.length}let p=d+o.newText,m=new Xe(Math.min(a.replaceRange.start,o.replaceRange.start-s),o.replaceRange.endExclusive-n);i.push(new Ed(m,p))}}for(;;){let o=e.shift();if(!o)break;i.push(o)}return new Jk(i).normalize()}var j$=$("undoRedoService");var G$=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r},q$=class r{static _ID=0;id;order;constructor(){this.id=r._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}static None=new r};var ly=class{_textModelResolvedOptionsBrand=void 0;tabSize;indentSize;_indentSizeIsTabSize;insertSpaces;defaultEOL;trimAutoWhitespace;bracketPairColorizationOptions;get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(t){this.tabSize=Math.max(1,t.tabSize|0),t.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,t.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!t.insertSpaces,this.defaultEOL=t.defaultEOL|0,this.trimAutoWhitespace=!!t.trimAutoWhitespace,this.bracketPairColorizationOptions=t.bracketPairColorizationOptions}equals(t){return this.tabSize===t.tabSize&&this._indentSizeIsTabSize===t._indentSizeIsTabSize&&this.indentSize===t.indentSize&&this.insertSpaces===t.insertSpaces&&this.defaultEOL===t.defaultEOL&&this.trimAutoWhitespace===t.trimAutoWhitespace&&$t(this.bracketPairColorizationOptions,t.bracketPairColorizationOptions)}createChangeEvent(t){return{tabSize:this.tabSize!==t.tabSize,indentSize:this.indentSize!==t.indentSize,insertSpaces:this.insertSpaces!==t.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==t.trimAutoWhitespace}}},jh=class{_findMatchBrand=void 0;range;matches;constructor(t,e){this.range=t,this.matches=e}};function $$(r){return r&&typeof r.read=="function"}var dy=class{constructor(t,e,i,n,o,s){this.identifier=t;this.range=e;this.text=i;this.forceMoveMarkers=n;this.isAutoWhitespaceEdit=o;this._isTracked=s}},eR=class{regex;wordSeparators;simpleSearch;constructor(t,e,i){this.regex=t,this.wordSeparators=e,this.simpleSearch=i}},tR=class{constructor(t,e,i){this.reverseEdits=t;this.changes=e;this.trimAutoWhitespaceLineNumbers=i}};function Y$(r){return r&&typeof r.id=="string"}var Yg={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var PU=$("textModelService");var Z$="";var $h=class extends L{_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;resolved=!1;async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};var Rr=$("modelService");var iR=$("ILanguageDetectionService"),MU="languageDetection";var Td=class extends $h{constructor(e,i,n,o,s){super();this.modelService=e;this.languageService=i;this.languageDetectionService=n;this.accessibilityService=o;s&&this.handleExistingModel(s)}static AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600;textEditorModelHandle=void 0;createdEditorModel;modelDisposeListener=this._register(new mt);autoDetectLanguageThrottler=this._register(new Zu(Td.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY));handleExistingModel(e){let i=this.modelService.getModel(e);if(!i)throw new Error(`Document with resource ${e.toString(!0)} does not exist`);this.textEditorModelHandle=e,this.registerModelDisposeListener(i)}registerModelDisposeListener(e){this.modelDisposeListener.value=e.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}_hasLanguageSetExplicitly=!1;get hasLanguageSetExplicitly(){return this._hasLanguageSetExplicitly}setLanguageId(e,i){this._hasLanguageSetExplicitly=!0,this.setLanguageIdInternal(e,i)}setLanguageIdInternal(e,i){this.isResolved()&&(!e||e===this.textEditorModel.getLanguageId()||this.textEditorModel.setLanguage(this.languageService.createById(e),i))}installModelListeners(e){let i=this._register(e.onDidChangeLanguage(n=>{n.source!==MU&&(this._hasLanguageSetExplicitly=!0,i.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??Cd))return;let e=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),i=this.getLanguageId();if(e&&e!==i&&!this.isDisposed()){this.setLanguageIdInternal(e,MU);let n=this.languageService.getLanguageName(e);this.accessibilityService.alert(h("languageAutoDetected","Language {0} was automatically detected and set as the language mode.",n??e))}}createTextEditorModel(e,i,n){let o=this.getFirstLineText(e),s=this.getOrCreateLanguage(i,this.languageService,n,o);return this.doCreateTextEditorModel(e,s,i)}doCreateTextEditorModel(e,i,n){let o=n&&this.modelService.getModel(n);return o?this.updateTextEditorModel(e,i.languageId):(o=this.modelService.createModel(e,i,n),this.createdEditorModel=!0,this.registerModelDisposeListener(o)),this.textEditorModelHandle=o.uri,o}getFirstLineText(e){let i=e;return typeof i.getFirstLineText=="function"?i.getFirstLineText(1e3):e.getLineContent(1).substr(0,1e3)}getOrCreateLanguage(e,i,n,o){return!n||n===Cd?i.createByFilepathOrFirstLine(e??null,o):i.createById(n)}updateTextEditorModel(e,i){this.isResolved()&&(e&&this.modelService.updateModel(this.textEditorModel,e),i&&i!==Cd&&this.textEditorModel.getLanguageId()!==i&&this.textEditorModel.setLanguage(this.languageService.createById(i)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};Td=_([v(0,Rr),v(1,Hn),v(2,iR),v(3,zo)],Td);var cy=$("workingCopyBackupService");var _s=$("textResourceConfigurationService"),KBe=$("textResourcePropertiesService");function gse(r,t,e){let i=0;for(let o=0;o<r.length;o++)r.charAt(o)==="	"?i=Ni.nextIndentTabStop(i,t):i++;let n="";if(!e){let o=Math.floor(i/t);i=i%t;for(let s=0;s<o;s++)n+="	"}for(let o=0;o<i;o++)n+=" ";return n}function nR(r,t,e){let i=Rn(r);return i===-1&&(i=r.length),gse(r.substring(0,i),t,e)+r.substring(i)}var wl=class r{constructor(t,e,i){this.startOffset=t;this.endOffset=e;this.newLength=i}static fromModelContentChanges(t){return t.map(i=>{let n=F.lift(i.range);return new r(Kh(n.getStartPosition()),Kh(n.getEndPosition()),F$(i.text))}).reverse()}toString(){return`[${qr(this.startOffset)}...${qr(this.endOffset)}) -> ${qr(this.newLength)}`}},oR=class{nextEditIdx=0;deltaOldToNewLineCount=0;deltaOldToNewColumnCount=0;deltaLineIdxInOld=-1;edits;constructor(t){this.edits=t.map(e=>OU.from(e))}getOffsetBeforeChange(t){return this.adjustNextEdit(t),this.translateCurToOld(t)}getDistanceToNextChange(t){this.adjustNextEdit(t);let e=this.edits[this.nextEditIdx],i=e?this.translateOldToCur(e.offsetObj):null;return i===null?null:jg(t,i)}translateOldToCur(t){return t.lineCount===this.deltaLineIdxInOld?Ji(t.lineCount+this.deltaOldToNewLineCount,t.columnCount+this.deltaOldToNewColumnCount):Ji(t.lineCount+this.deltaOldToNewLineCount,t.columnCount)}translateCurToOld(t){let e=qr(t);return e.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Ji(e.lineCount-this.deltaOldToNewLineCount,e.columnCount-this.deltaOldToNewColumnCount):Ji(e.lineCount-this.deltaOldToNewLineCount,e.columnCount)}adjustNextEdit(t){for(;this.nextEditIdx<this.edits.length;){let e=this.edits[this.nextEditIdx],i=this.translateOldToCur(e.endOffsetAfterObj);if(zh(i,t)){this.nextEditIdx++;let n=qr(i),o=qr(this.translateOldToCur(e.endOffsetBeforeObj)),s=n.lineCount-o.lineCount;this.deltaOldToNewLineCount+=s;let a=this.deltaLineIdxInOld===e.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-o.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=e.endOffsetBeforeObj.lineCount}else break}}},OU=class r{static from(t){return new r(t.startOffset,t.endOffset,t.newLength)}endOffsetBeforeObj;endOffsetAfterObj;offsetObj;constructor(t,e,i){this.endOffsetBeforeObj=qr(e),this.endOffsetAfterObj=qr(Gi(t,i)),this.offsetObj=qr(t)}};function J$(r){if(r.length===0)return null;if(r.length===1)return r[0];let t=0;function e(){if(t>=r.length)return null;let s=t,a=r[s].listHeight;for(t++;t<r.length&&r[t].listHeight===a;)t++;return t-s>=2?FU(s===0&&t===r.length?r:r.slice(s,t),!1):r[s]}let i=e(),n=e();if(!n)return i;for(let s=e();s;s=e())X$(i,n)<=X$(n,s)?(i=NU(i,n),n=s):n=NU(n,s);return NU(i,n)}function FU(r,t=!1){if(r.length===0)return null;if(r.length===1)return r[0];let e=r.length;for(;e>3;){let i=e>>1;for(let n=0;n<i;n++){let o=n<<1;r[n]=pa.create23(r[o],r[o+1],o+3===e?r[o+2]:null,t)}e=i}return pa.create23(r[0],r[1],e>=3?r[2]:null,t)}function X$(r,t){return Math.abs(r.listHeight-t.listHeight)}function NU(r,t){return r.listHeight===t.listHeight?pa.create23(r,t,null,!1):r.listHeight>t.listHeight?fse(r,t):bse(t,r)}function fse(r,t){r=r.toMutable();let e=r,i=[],n;for(;;){if(t.listHeight===e.listHeight){n=t;break}if(e.kind!==4)throw new Error("unexpected");i.push(e),e=e.makeLastElementMutable()}for(let o=i.length-1;o>=0;o--){let s=i[o];n?s.childrenLength>=3?n=pa.create23(s.unappendChild(),n,null,!1):(s.appendChildOfSameHeight(n),n=void 0):s.handleChildrenChanged()}return n?pa.create23(r,n,null,!1):r}function bse(r,t){r=r.toMutable();let e=r,i=[];for(;t.listHeight!==e.listHeight;){if(e.kind!==4)throw new Error("unexpected");i.push(e),e=e.makeFirstElementMutable()}let n=t;for(let o=i.length-1;o>=0;o--){let s=i[o];n?s.childrenLength>=3?n=pa.create23(n,s.unprependChild(),null,!1):(s.prependChildOfSameHeight(n),n=void 0):s.handleChildrenChanged()}return n?pa.create23(n,r,null,!1):r}var rR=class{nextNodes;offsets;idxs;lastOffset=_o;constructor(t){this.nextNodes=[t],this.offsets=[_o],this.idxs=[]}readLongestNodeAt(t,e){if(gp(t,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=t;;){let i=yE(this.nextNodes);if(!i)return;let n=yE(this.offsets);if(gp(t,n))return;if(gp(n,t))if(Gi(n,i.length)<=t)this.nextNodeAfterCurrent();else{let o=BU(i);o!==-1?(this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)):this.nextNodeAfterCurrent()}else{if(e(i))return this.nextNodeAfterCurrent(),i;{let o=BU(i);if(o===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)}}}}nextNodeAfterCurrent(){for(;;){let t=yE(this.offsets),e=yE(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;let i=yE(this.nextNodes),n=BU(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(Gi(t,e.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}};function BU(r,t=-1){for(;;){if(t++,t>=r.childrenLength)return-1;if(r.getChild(t))return t}}function yE(r){return r.length>0?r[r.length-1]:void 0}function WU(r,t,e,i){return new VU(r,t,e,i).parseDocument()}var VU=class{constructor(t,e,i,n){this.tokenizer=t;this.createImmutableLists=n;if(i&&n)throw new Error("Not supported");this.oldNodeReader=i?new rR(i):void 0,this.positionMapper=new oR(e)}oldNodeReader;positionMapper;_itemsConstructed=0;_itemsFromCache=0;get nodesConstructed(){return this._itemsConstructed}get nodesReused(){return this._itemsFromCache}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let t=this.parseList(ar.getEmpty(),0);return t||(t=pa.getEmpty()),t}parseList(t,e){let i=[];for(;;){let o=this.tryReadChildFromCache(t);if(!o){let s=this.tokenizer.peek();if(!s||s.kind===2&&s.bracketIds.intersects(t))break;o=this.parseChild(t,e+1)}o.kind===4&&o.childrenLength===0||i.push(o)}return this.oldNodeReader?J$(i):FU(i,this.createImmutableLists)}tryReadChildFromCache(t){if(this.oldNodeReader){let e=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(e===null||!oy(e)){let i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>e!==null&&!gp(n.length,e)?!1:n.canBeReused(t));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(t,e){this._itemsConstructed++;let i=this.tokenizer.read();switch(i.kind){case 2:return new jk(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(e>300)return new wd(i.length);let n=t.merge(i.bracketIds),o=this.parseList(n,e+1),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===i.bracketId||s.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),hE.create(i.astNode,o,s.astNode)):hE.create(i.astNode,o,null)}default:throw new Error("unexpected")}}};function uy(r,t){if(r.length===0)return t;if(t.length===0)return r;let e=new Sr(eY(r)),i=eY(t);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=e.dequeue();function o(d){if(d===void 0){let u=e.takeWhile(p=>!0)||[];return n&&u.unshift(n),u}let c=[];for(;n&&!oy(d);){let[u,p]=n.splitAt(d);c.push(u),d=jg(u.lengthAfter,d),n=p??e.dequeue()}return oy(d)||c.push(new IE(!1,d,d)),c}let s=[];function a(d,c,u){if(s.length>0&&CU(s[s.length-1].endOffset,d)){let p=s[s.length-1];s[s.length-1]=new wl(p.startOffset,c,Gi(p.newLength,u))}else s.push({startOffset:d,endOffset:c,newLength:u})}let l=_o;for(let d of i){let c=o(d.lengthBefore);if(d.modified){let u=N$(c,m=>m.lengthBefore),p=Gi(l,u);a(l,p,d.lengthAfter),l=p}else for(let u of c){let p=l;l=Gi(l,u.lengthBefore),u.modified&&a(p,l,u.lengthAfter)}}return s}var IE=class r{constructor(t,e,i){this.modified=t;this.lengthBefore=e;this.lengthAfter=i}splitAt(t){let e=jg(t,this.lengthAfter);return CU(e,_o)?[this,void 0]:this.modified?[new r(this.modified,this.lengthBefore,t),new r(this.modified,_o,e)]:[new r(this.modified,t,t),new r(this.modified,e,e)]}toString(){return`${this.modified?"M":"U"}:${qr(this.lengthBefore)} -> ${qr(this.lengthAfter)}`}};function eY(r){let t=[],e=_o;for(let i of r){let n=jg(e,i.startOffset);oy(n)||t.push(new IE(!1,n,n));let o=jg(i.startOffset,i.endOffset);t.push(new IE(!0,o,i.newLength)),e=i.endOffset}return t}var sR=class extends L{constructor(e,i){super();this.textModel=e;this.getLanguageConfiguration=i;if(e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{let n=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),o=new Gk(this.textModel.getValue(),n);this.initialAstWithoutTokens=WU(o,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}didChangeEmitter=new T;initialAstWithoutTokens;astWithTokens;denseKeyProvider=new Mk;brackets=new zk(this.denseKeyProvider,this.getLanguageConfiguration);didLanguageChange(e){return this.brackets.didLanguageChange(e)}onDidChange=this.didChangeEmitter.event;queuedTextEditsForInitialAstWithoutTokens=[];queuedTextEdits=[];handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){let e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){let i=e.map(n=>new wl(Ji(n.fromLineNumber-1,0),Ji(n.toLineNumber,0),Ji(n.toLineNumber-n.fromLineNumber+1,0)));this.handleEdits(i,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){let i=wl.fromModelContentChanges(e.changes);this.handleEdits(i,!1)}handleEdits(e,i){let n=uy(this.queuedTextEdits,e);this.queuedTextEdits=n,this.initialAstWithoutTokens&&!i&&(this.queuedTextEditsForInitialAstWithoutTokens=uy(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,i,n){let s=i,a=new Kk(this.textModel,this.brackets);return WU(a,e,s,n)}getBracketsInRange(e,i){this.flushQueue();let n=Ji(e.startLineNumber-1,e.startColumn-1),o=Ji(e.endLineNumber-1,e.endColumn-1);return new Fu(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens;UU(a,_o,a.length,n,o,s,0,0,new Map,i)})}getBracketPairsInRange(e,i){this.flushQueue();let n=Kh(e.getStartPosition()),o=Kh(e.getEndPosition());return new Fu(s=>{let a=this.initialAstWithoutTokens||this.astWithTokens,l=new HU(s,i,this.textModel);zU(a,_o,a.length,n,o,l,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();let i=this.initialAstWithoutTokens||this.astWithTokens;return iY(i,_o,i.length,Kh(e))}getFirstBracketBefore(e){this.flushQueue();let i=this.initialAstWithoutTokens||this.astWithTokens;return tY(i,_o,i.length,Kh(e))}};function tY(r,t,e,i){if(r.kind===4||r.kind===2){let n=[];for(let o of r.children)e=Gi(t,o.length),n.push({nodeOffsetStart:t,nodeOffsetEnd:e}),t=e;for(let o=n.length-1;o>=0;o--){let{nodeOffsetStart:s,nodeOffsetEnd:a}=n[o];if(gp(s,i)){let l=tY(r.children[o],s,a,i);if(l)return l}}return null}else{if(r.kind===3)return null;if(r.kind===1){let n=Gh(t,e);return{bracketInfo:r.bracketInfo,range:n}}}return null}function iY(r,t,e,i){if(r.kind===4||r.kind===2){for(let n of r.children){if(e=Gi(t,n.length),gp(i,e)){let o=iY(n,t,e,i);if(o)return o}t=e}return null}else{if(r.kind===3)return null;if(r.kind===1){let n=Gh(t,e);return{bracketInfo:r.bracketInfo,range:n}}}return null}function UU(r,t,e,i,n,o,s,a,l,d,c=!1){if(s>200)return!0;e:for(;;)switch(r.kind){case 4:{let u=r.childrenLength;for(let p=0;p<u;p++){let m=r.getChild(p);if(m){if(e=Gi(t,m.length),zh(t,n)&&ry(e,i)){if(ry(e,n)){r=m;continue e}if(!UU(m,t,e,i,n,o,s,0,l,d))return!1}t=e}}return!0}case 2:{let u=!d||!r.closingBracket||r.closingBracket.bracketInfo.closesColorized(r.openingBracket.bracketInfo),p=0;if(l){let g=l.get(r.openingBracket.text);g===void 0&&(g=0),p=g,u&&(g++,l.set(r.openingBracket.text,g))}let m=r.childrenLength;for(let g=0;g<m;g++){let f=r.getChild(g);if(f){if(e=Gi(t,f.length),zh(t,n)&&ry(e,i)){if(ry(e,n)&&f.kind!==1){r=f,u?(s++,a=p+1):a=p;continue e}if((u||f.kind!==1||!r.closingBracket)&&!UU(f,t,e,i,n,o,u?s+1:s,u?p+1:p,l,d,!r.closingBracket))return!1}t=e}}return l?.set(r.openingBracket.text,p),!0}case 3:{let u=Gh(t,e);return o(new bE(u,s-1,0,!0))}case 1:{let u=Gh(t,e);return o(new bE(u,s-1,a-1,c))}case 0:return!0}}var HU=class{constructor(t,e,i){this.push=t;this.includeMinIndentation=e;this.textModel=i}};function zU(r,t,e,i,n,o,s,a){if(s>200)return!0;let l=!0;if(r.kind===2){let d=0;if(a){let p=a.get(r.openingBracket.text);p===void 0&&(p=0),d=p,p++,a.set(r.openingBracket.text,p)}let c=Gi(t,r.openingBracket.length),u=-1;if(o.includeMinIndentation&&(u=r.computeMinIndentation(t,o.textModel)),l=o.push(new $k(Gh(t,e),Gh(t,c),r.closingBracket?Gh(Gi(c,r.child?.length||_o),e):void 0,s,d,r,u)),t=c,l&&r.child){let p=r.child;if(e=Gi(t,p.length),zh(t,n)&&ry(e,i)&&(l=zU(p,t,e,i,n,o,s+1,a),!l))return!1}a?.set(r.openingBracket.text,d)}else{let d=t;for(let c of r.children){let u=d;if(d=Gi(d,c.length),zh(u,n)&&zh(i,d)&&(l=zU(c,u,d,i,n,o,s,a),!l))return!1}}return l}var lR=class extends L{constructor(e,i){super();this.textModel=e;this.languageConfigurationService=i}bracketPairsTree=this._register(new mt);onDidChangeEmitter=new T;onDidChange=this.onDidChangeEmitter.event;get canBuildAST(){return this.textModel.getValueLength()<=5e6}bracketsRequested=!1;handleLanguageConfigurationServiceChange(e){(!e.languageId||this.bracketPairsTree.value?.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){this.bracketPairsTree.value?.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){this.bracketPairsTree.value?.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){let e=new W;this.bracketPairsTree.value=vse(e.add(new sR(this.textModel,i=>this.languageConfigurationService.getLanguageConfiguration(i))),e),e.add(this.bracketPairsTree.value.object.onDidChange(i=>this.onDidChangeEmitter.fire(i))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!1)||Fu.empty}getBracketPairsInRangeWithMinIndentation(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!0)||Fu.empty}getBracketsInRange(e,i=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(e,i)||Fu.empty}findMatchingBracketUp(e,i,n){let o=this.textModel.validatePosition(i),s=this.textModel.getLanguageIdAtPosition(o.lineNumber,o.column);if(this.canBuildAST){let a=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(e);if(!a)return null;let l=this.getBracketPairsInRange(F.fromPositions(i,i)).findLast(d=>a.closes(d.openingBracketInfo));return l?l.openingBracketRange:null}else{let a=e.toLowerCase(),l=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!l)return null;let d=l.textIsBracket[a];return d?aR(this._findMatchingBracketUp(d,o,GU(n))):null}}matchBracket(e,i){if(this.canBuildAST){let n=this.getBracketPairsInRange(F.fromPositions(e,e)).filter(o=>o.closingBracketRange!==void 0&&(o.openingBracketRange.containsPosition(e)||o.closingBracketRange.containsPosition(e))).findLastMaxBy(Qr(o=>o.openingBracketRange.containsPosition(e)?o.openingBracketRange:o.closingBracketRange,F.compareRangesUsingStarts));return n?[n.openingBracketRange,n.closingBracketRange]:null}else{let n=GU(i);return this._matchBracket(this.textModel.validatePosition(e),n)}}_establishBracketSearchOffsets(e,i,n,o){let s=i.getCount(),a=i.getLanguageId(o),l=Math.max(0,e.column-1-n.maxBracketLength);for(let c=o-1;c>=0;c--){let u=i.getEndOffset(c);if(u<=l)break;if(Cl(i.getStandardTokenType(c))||i.getLanguageId(c)!==a){l=u;break}}let d=Math.min(i.getLineContent().length,e.column-1+n.maxBracketLength);for(let c=o+1;c<s;c++){let u=i.getStartOffset(c);if(u>=d)break;if(Cl(i.getStandardTokenType(c))||i.getLanguageId(c)!==a){d=u;break}}return{searchStartOffset:l,searchEndOffset:d}}_matchBracket(e,i){let n=e.lineNumber,o=this.textModel.tokenization.getLineTokens(n),s=this.textModel.getLineContent(n),a=o.findTokenIndexAtOffset(e.column-1);if(a<0)return null;let l=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(a)).brackets;if(l&&!Cl(o.getStandardTokenType(a))){let{searchStartOffset:d,searchEndOffset:c}=this._establishBracketSearchOffsets(e,o,l,a),u=null;for(;;){let p=as.findNextBracketInRange(l.forwardRegex,n,s,d,c);if(!p)break;if(p.startColumn<=e.column&&e.column<=p.endColumn){let m=s.substring(p.startColumn-1,p.endColumn-1).toLowerCase(),g=this._matchFoundBracket(p,l.textIsBracket[m],l.textIsOpenBracket[m],i);if(g){if(g instanceof vp)return null;u=g}}d=p.endColumn-1}if(u)return u}if(a>0&&o.getStartOffset(a)===e.column-1){let d=a-1,c=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId(d)).brackets;if(c&&!Cl(o.getStandardTokenType(d))){let{searchStartOffset:u,searchEndOffset:p}=this._establishBracketSearchOffsets(e,o,c,d),m=as.findPrevBracketInRange(c.reversedRegex,n,s,u,p);if(m&&m.startColumn<=e.column&&e.column<=m.endColumn){let g=s.substring(m.startColumn-1,m.endColumn-1).toLowerCase(),f=this._matchFoundBracket(m,c.textIsBracket[g],c.textIsOpenBracket[g],i);if(f)return f instanceof vp?null:f}}}return null}_matchFoundBracket(e,i,n,o){if(!i)return null;let s=n?this._findMatchingBracketDown(i,e.getEndPosition(),o):this._findMatchingBracketUp(i,e.getStartPosition(),o);return s?s instanceof vp?s:[e,s]:null}_findMatchingBracketUp(e,i,n){let o=e.languageId,s=e.reversedRegex,a=-1,l=0,d=(c,u,p,m)=>{for(;;){if(n&&++l%100===0&&!n())return vp.INSTANCE;let g=as.findPrevBracketInRange(s,c,u,p,m);if(!g)break;let f=u.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(f)?a++:e.isClose(f)&&a--,a===0)return g;m=g.startColumn-1}return null};for(let c=i.lineNumber;c>=1;c--){let u=this.textModel.tokenization.getLineTokens(c),p=u.getCount(),m=this.textModel.getLineContent(c),g=p-1,f=m.length,b=m.length;c===i.lineNumber&&(g=u.findTokenIndexAtOffset(i.column-1),f=i.column-1,b=i.column-1);let y=!0;for(;g>=0;g--){let I=u.getLanguageId(g)===o&&!Cl(u.getStandardTokenType(g));if(I)y?f=u.getStartOffset(g):(f=u.getStartOffset(g),b=u.getEndOffset(g));else if(y&&f!==b){let E=d(c,m,f,b);if(E)return E}y=I}if(y&&f!==b){let I=d(c,m,f,b);if(I)return I}}return null}_findMatchingBracketDown(e,i,n){let o=e.languageId,s=e.forwardRegex,a=1,l=0,d=(u,p,m,g)=>{for(;;){if(n&&++l%100===0&&!n())return vp.INSTANCE;let f=as.findNextBracketInRange(s,u,p,m,g);if(!f)break;let b=p.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(b)?a++:e.isClose(b)&&a--,a===0)return f;m=f.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=i.lineNumber;u<=c;u++){let p=this.textModel.tokenization.getLineTokens(u),m=p.getCount(),g=this.textModel.getLineContent(u),f=0,b=0,y=0;u===i.lineNumber&&(f=p.findTokenIndexAtOffset(i.column-1),b=i.column-1,y=i.column-1);let I=!0;for(;f<m;f++){let E=p.getLanguageId(f)===o&&!Cl(p.getStandardTokenType(f));if(E)I||(b=p.getStartOffset(f)),y=p.getEndOffset(f);else if(I&&b!==y){let S=d(u,g,b,y);if(S)return S}I=E}if(I&&b!==y){let E=d(u,g,b,y);if(E)return E}}return null}findPrevBracket(e){let i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(i)||null;let n=null,o=null,s=null;for(let a=i.lineNumber;a>=1;a--){let l=this.textModel.tokenization.getLineTokens(a),d=l.getCount(),c=this.textModel.getLineContent(a),u=d-1,p=c.length,m=c.length;if(a===i.lineNumber){u=l.findTokenIndexAtOffset(i.column-1),p=i.column-1,m=i.column-1;let f=l.getLanguageId(u);n!==f&&(n=f,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,s=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let g=!0;for(;u>=0;u--){let f=l.getLanguageId(u);if(n!==f){if(o&&s&&g&&p!==m){let y=as.findPrevBracketInRange(o.reversedRegex,a,c,p,m);if(y)return this._toFoundBracket(s,y);g=!1}n=f,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,s=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}let b=!!o&&!Cl(l.getStandardTokenType(u));if(b)g?p=l.getStartOffset(u):(p=l.getStartOffset(u),m=l.getEndOffset(u));else if(s&&o&&g&&p!==m){let y=as.findPrevBracketInRange(o.reversedRegex,a,c,p,m);if(y)return this._toFoundBracket(s,y)}g=b}if(s&&o&&g&&p!==m){let f=as.findPrevBracketInRange(o.reversedRegex,a,c,p,m);if(f)return this._toFoundBracket(s,f)}}return null}findNextBracket(e){let i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(i)||null;let n=this.textModel.getLineCount(),o=null,s=null,a=null;for(let l=i.lineNumber;l<=n;l++){let d=this.textModel.tokenization.getLineTokens(l),c=d.getCount(),u=this.textModel.getLineContent(l),p=0,m=0,g=0;if(l===i.lineNumber){p=d.findTokenIndexAtOffset(i.column-1),m=i.column-1,g=i.column-1;let b=d.getLanguageId(p);o!==b&&(o=b,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew)}let f=!0;for(;p<c;p++){let b=d.getLanguageId(p);if(o!==b){if(a&&s&&f&&m!==g){let I=as.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(I)return this._toFoundBracket(a,I);f=!1}o=b,s=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew}let y=!!s&&!Cl(d.getStandardTokenType(p));if(y)f||(m=d.getStartOffset(p)),g=d.getEndOffset(p);else if(a&&s&&f&&m!==g){let I=as.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(I)return this._toFoundBracket(a,I)}f=y}if(a&&s&&f&&m!==g){let b=as.findNextBracketInRange(s.forwardRegex,l,u,m,g);if(b)return this._toFoundBracket(a,b)}}return null}findEnclosingBrackets(e,i){let n=this.textModel.validatePosition(e);if(this.canBuildAST){let g=F.fromPositions(n),f=this.getBracketPairsInRange(F.fromPositions(n,n)).findLast(b=>b.closingBracketRange!==void 0&&b.range.strictContainsRange(g));return f?[f.openingBracketRange,f.closingBracketRange]:null}let o=GU(i),s=this.textModel.getLineCount(),a=new Map,l=[],d=(g,f)=>{if(!a.has(g)){let b=[];for(let y=0,I=f?f.brackets.length:0;y<I;y++)b[y]=0;a.set(g,b)}l=a.get(g)},c=0,u=(g,f,b,y,I)=>{for(;;){if(o&&++c%100===0&&!o())return vp.INSTANCE;let E=as.findNextBracketInRange(g.forwardRegex,f,b,y,I);if(!E)break;let S=b.substring(E.startColumn-1,E.endColumn-1).toLowerCase(),w=g.textIsBracket[S];if(w&&(w.isOpen(S)?l[w.index]++:w.isClose(S)&&l[w.index]--,l[w.index]===-1))return this._matchFoundBracket(E,w,!1,o);y=E.endColumn-1}return null},p=null,m=null;for(let g=n.lineNumber;g<=s;g++){let f=this.textModel.tokenization.getLineTokens(g),b=f.getCount(),y=this.textModel.getLineContent(g),I=0,E=0,S=0;if(g===n.lineNumber){I=f.findTokenIndexAtOffset(n.column-1),E=n.column-1,S=n.column-1;let D=f.getLanguageId(I);p!==D&&(p=D,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m))}let w=!0;for(;I<b;I++){let D=f.getLanguageId(I);if(p!==D){if(m&&w&&E!==S){let R=u(m,g,y,E,S);if(R)return aR(R);w=!1}p=D,m=this.languageConfigurationService.getLanguageConfiguration(p).brackets,d(p,m)}let k=!!m&&!Cl(f.getStandardTokenType(I));if(k)w||(E=f.getStartOffset(I)),S=f.getEndOffset(I);else if(m&&w&&E!==S){let R=u(m,g,y,E,S);if(R)return aR(R)}w=k}if(m&&w&&E!==S){let D=u(m,g,y,E,S);if(D)return aR(D)}}return null}_toFoundBracket(e,i){if(!i)return null;let n=this.textModel.getValueInRange(i);n=n.toLowerCase();let o=e.getBracketInfo(n);return o?{range:i,bracketInfo:o}:null}};function vse(r,t){return{object:r,dispose:()=>t?.dispose()}}function GU(r){if(typeof r>"u")return()=>!0;{let t=Date.now();return()=>Date.now()-t<=r}}var vp=class r{static INSTANCE=new r;_searchCanceledBrand=void 0;constructor(){}};function aR(r){return r instanceof vp?null:r}var qU=x("editor.lineHighlightBackground",null,h("lineHighlight","Background color for the highlight of line at the cursor position.")),jU=x("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Le},h("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),XWe=x("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},h("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),QWe=x("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:oi,hcLight:oi},h("rangeHighlightBorder","Background color of the border around highlighted ranges.")),JWe=x("editor.symbolHighlightBackground",{dark:rd,light:rd,hcDark:null,hcLight:null},h("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),eUe=x("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:oi,hcLight:oi},h("symbolHighlightBorder","Background color of the border around highlighted symbols.")),py=x("editorCursor.foreground",{dark:"#AEAFAD",light:Y.black,hcDark:Y.white,hcLight:"#0F4A85"},h("caret","Color of the editor cursor.")),dR=x("editorCursor.background",null,h("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),cR=x("editorMultiCursor.primary.foreground",py,h("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),nY=x("editorMultiCursor.primary.background",dR,h("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),uR=x("editorMultiCursor.secondary.foreground",py,h("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),oY=x("editorMultiCursor.secondary.background",dR,h("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),pR=x("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},h("editorWhitespaces","Color of whitespace characters in the editor.")),rY=x("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:Y.white,hcLight:"#292929"},h("editorLineNumbers","Color of editor line numbers.")),yse=x("editorIndentGuide.background",pR,h("editorIndentGuides","Color of the editor indentation guides."),!1,h("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),Ise=x("editorIndentGuide.activeBackground",pR,h("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,h("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),sY=x("editorIndentGuide.background1",yse,h("editorIndentGuides1","Color of the editor indentation guides (1).")),aY=x("editorIndentGuide.background2","#00000000",h("editorIndentGuides2","Color of the editor indentation guides (2).")),lY=x("editorIndentGuide.background3","#00000000",h("editorIndentGuides3","Color of the editor indentation guides (3).")),dY=x("editorIndentGuide.background4","#00000000",h("editorIndentGuides4","Color of the editor indentation guides (4).")),cY=x("editorIndentGuide.background5","#00000000",h("editorIndentGuides5","Color of the editor indentation guides (5).")),uY=x("editorIndentGuide.background6","#00000000",h("editorIndentGuides6","Color of the editor indentation guides (6).")),pY=x("editorIndentGuide.activeBackground1",Ise,h("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),hY=x("editorIndentGuide.activeBackground2","#00000000",h("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),mY=x("editorIndentGuide.activeBackground3","#00000000",h("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),gY=x("editorIndentGuide.activeBackground4","#00000000",h("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),fY=x("editorIndentGuide.activeBackground5","#00000000",h("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),bY=x("editorIndentGuide.activeBackground6","#00000000",h("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),Cse=x("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:oi,hcLight:oi},h("editorActiveLineNumber","Color of editor active line number"),!1,h("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),tUe=x("editorLineNumber.activeForeground",Cse,h("editorActiveLineNumber","Color of editor active line number")),vY=x("editorLineNumber.dimmedForeground",null,h("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),iUe=x("editorRuler.foreground",{dark:"#5A5A5A",light:Y.lightgrey,hcDark:Y.white,hcLight:"#292929"},h("editorRuler","Color of the editor rulers.")),nUe=x("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},h("editorCodeLensForeground","Foreground color of editor CodeLens")),oUe=x("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},h("editorBracketMatchBackground","Background color behind matching brackets")),rUe=x("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Le,hcLight:Le},h("editorBracketMatchBorder","Color for matching brackets boxes")),yY=x("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},h("editorOverviewRulerBorder","Color of the overview ruler border.")),IY=x("editorOverviewRuler.background",null,h("editorOverviewRulerBackground","Background color of the editor overview ruler.")),sUe=x("editorGutter.background",Js,h("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),aUe=x("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:Y.fromHex("#fff").transparent(.8),hcLight:Le},h("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),CY=x("editorUnnecessaryCode.opacity",{dark:Y.fromHex("#000a"),light:Y.fromHex("#0007"),hcDark:null,hcLight:null},h("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),lUe=x("editorGhostText.border",{dark:null,light:null,hcDark:Y.fromHex("#fff").transparent(.8),hcLight:Y.fromHex("#292929").transparent(.8)},h("editorGhostTextBorder","Border color of ghost text in the editor.")),dUe=x("editorGhostText.foreground",{dark:Y.fromHex("#ffffff56"),light:Y.fromHex("#0007"),hcDark:null,hcLight:null},h("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),cUe=x("editorGhostText.background",null,h("editorGhostTextBackground","Background color of the ghost text in the editor.")),Sse=new Y(new Pt(0,122,204,.6)),uUe=x("editorOverviewRuler.rangeHighlightForeground",Sse,h("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),pUe=x("editorOverviewRuler.errorForeground",{dark:new Y(new Pt(255,18,18,.7)),light:new Y(new Pt(255,18,18,.7)),hcDark:new Y(new Pt(255,50,50,1)),hcLight:"#B5200D"},h("overviewRuleError","Overview ruler marker color for errors.")),hUe=x("editorOverviewRuler.warningForeground",{dark:is,light:is,hcDark:Cv,hcLight:Cv},h("overviewRuleWarning","Overview ruler marker color for warnings.")),mUe=x("editorOverviewRuler.infoForeground",{dark:ea,light:ea,hcDark:Sv,hcLight:Sv},h("overviewRuleInfo","Overview ruler marker color for infos.")),hR=x("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},h("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),mR=x("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},h("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),gR=x("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},h("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),fR=x("editorBracketHighlight.foreground4","#00000000",h("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),bR=x("editorBracketHighlight.foreground5","#00000000",h("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),vR=x("editorBracketHighlight.foreground6","#00000000",h("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),SY=x("editorBracketHighlight.unexpectedBracket.foreground",{dark:new Y(new Pt(255,18,18,.8)),light:new Y(new Pt(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},h("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),wY=x("editorBracketPairGuide.background1","#00000000",h("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),EY=x("editorBracketPairGuide.background2","#00000000",h("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),TY=x("editorBracketPairGuide.background3","#00000000",h("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),xY=x("editorBracketPairGuide.background4","#00000000",h("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),_Y=x("editorBracketPairGuide.background5","#00000000",h("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),DY=x("editorBracketPairGuide.background6","#00000000",h("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),LY=x("editorBracketPairGuide.activeBackground1","#00000000",h("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),kY=x("editorBracketPairGuide.activeBackground2","#00000000",h("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),RY=x("editorBracketPairGuide.activeBackground3","#00000000",h("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),AY=x("editorBracketPairGuide.activeBackground4","#00000000",h("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),PY=x("editorBracketPairGuide.activeBackground5","#00000000",h("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),MY=x("editorBracketPairGuide.activeBackground6","#00000000",h("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides.")),gUe=x("editorUnicodeHighlight.border",is,h("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),fUe=x("editorUnicodeHighlight.background",W3,h("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));co((r,t)=>{let e=r.getColor(Js),i=r.getColor(qU),n=i&&!i.isTransparent()?i:e;n&&t.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});var yR=class extends L{constructor(e){super();this.textModel=e;this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(i=>{this.onDidChangeEmitter.fire()}))}colorizationOptions;colorProvider=new IR;onDidChangeEmitter=new T;onDidChange=this.onDidChangeEmitter.event;handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,i,n,o){return o?[]:i===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(a=>({id:`bracket${a.range.toString()}-${a.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(a,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:a.range})).toArray():[]}getAllDecorations(e,i){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new F(1,1,this.textModel.getLineCount(),1),e,i):[]}},IR=class{unexpectedClosingBracketClassName="unexpected-closing-bracket";getInlineClassName(t,e){return t.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(e?t.nestingLevelOfEqualBracketType:t.nestingLevel)}getInlineClassNameOfLevel(t){return`bracket-highlighting-${t%30}`}};co((r,t)=>{let e=[hR,mR,gR,fR,bR,vR],i=new IR;t.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${r.getColor(SY)}; }`);let n=e.map(o=>r.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){let s=n[o%n.length];t.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(o)} { color: ${s}; }`)}});function hy(r){return r.toString()}var Ds=class r{constructor(t,e,i,n,o,s,a){this.beforeVersionId=t;this.afterVersionId=e;this.beforeEOL=i;this.afterEOL=n;this.beforeCursorState=o;this.afterCursorState=s;this.changes=a}static create(t,e){let i=t.getAlternativeVersionId(),n=ZU(t);return new r(i,i,n,n,e,e,[])}append(t,e,i,n,o){e.length>0&&(this.changes=w$(this.changes,e)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=o}static _writeSelectionsSize(t){return 4+4*4*(t?t.length:0)}static _writeSelections(t,e,i){if(Uo(t,e?e.length:0,i),i+=4,e)for(let n of e)Uo(t,n.selectionStartLineNumber,i),i+=4,Uo(t,n.selectionStartColumn,i),i+=4,Uo(t,n.positionLineNumber,i),i+=4,Uo(t,n.positionColumn,i),i+=4;return i}static _readSelections(t,e,i){let n=Wo(t,e);e+=4;for(let o=0;o<n;o++){let s=Wo(t,e);e+=4;let a=Wo(t,e);e+=4;let l=Wo(t,e);e+=4;let d=Wo(t,e);e+=4,i.push(new It(s,a,l,d))}return e}serialize(){let t=10+r._writeSelectionsSize(this.beforeCursorState)+r._writeSelectionsSize(this.afterCursorState)+4;for(let n of this.changes)t+=n.writeSize();let e=new Uint8Array(t),i=0;Uo(e,this.beforeVersionId,i),i+=4,Uo(e,this.afterVersionId,i),i+=4,TD(e,this.beforeEOL,i),i+=1,TD(e,this.afterEOL,i),i+=1,i=r._writeSelections(e,this.beforeCursorState,i),i=r._writeSelections(e,this.afterCursorState,i),Uo(e,this.changes.length,i),i+=4;for(let n of this.changes)i=n.write(e,i);return e.buffer}static deserialize(t){let e=new Uint8Array(t),i=0,n=Wo(e,i);i+=4;let o=Wo(e,i);i+=4;let s=ED(e,i);i+=1;let a=ED(e,i);i+=1;let l=[];i=r._readSelections(e,i,l);let d=[];i=r._readSelections(e,i,d);let c=Wo(e,i);i+=4;let u=[];for(let p=0;p<c;p++)i=la.read(e,i,u);return new r(n,o,s,a,l,d,u)}},CR=class{constructor(t,e,i,n){this.label=t;this.code=e;this.model=i,this._data=Ds.create(i,n)}model;_data;get type(){return 0}get resource(){return q.isUri(this.model)?this.model:this.model.uri}toString(){return(this._data instanceof Ds?this._data:Ds.deserialize(this._data)).changes.map(e=>e.toString()).join(", ")}matchesResource(t){return(q.isUri(this.model)?this.model:this.model.uri).toString()===t.toString()}setModel(t){this.model=t}canAppend(t){return this.model===t&&this._data instanceof Ds}append(t,e,i,n,o){this._data instanceof Ds&&this._data.append(t,e,i,n,o)}close(){this._data instanceof Ds&&(this._data=this._data.serialize())}open(){this._data instanceof Ds||(this._data=Ds.deserialize(this._data))}undo(){if(q.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Ds&&(this._data=this._data.serialize());let t=Ds.deserialize(this._data);this.model._applyUndo(t.changes,t.beforeEOL,t.beforeVersionId,t.beforeCursorState)}redo(){if(q.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Ds&&(this._data=this._data.serialize());let t=Ds.deserialize(this._data);this.model._applyRedo(t.changes,t.afterEOL,t.afterVersionId,t.afterCursorState)}heapSize(){return this._data instanceof Ds&&(this._data=this._data.serialize()),this._data.byteLength+168}},YU=class{constructor(t,e,i){this.label=t;this.code=e;this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(let n of this._editStackElementsArr){let o=hy(n.resource);this._editStackElementsMap.set(o,n)}this._delegate=null}type=1;_isOpen;_editStackElementsArr;_editStackElementsMap;_delegate;get resources(){return this._editStackElementsArr.map(t=>t.resource)}setDelegate(t){this._delegate=t}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}getMissingModels(){let t=[];for(let e of this._editStackElementsArr)q.isUri(e.model)&&t.push(e.model);return t}matchesResource(t){let e=hy(t);return this._editStackElementsMap.has(e)}setModel(t){let e=hy(q.isUri(t)?t:t.uri);this._editStackElementsMap.has(e)&&this._editStackElementsMap.get(e).setModel(t)}canAppend(t){if(!this._isOpen)return!1;let e=hy(t.uri);return this._editStackElementsMap.has(e)?this._editStackElementsMap.get(e).canAppend(t):!1}append(t,e,i,n,o){let s=hy(t.uri);this._editStackElementsMap.get(s).append(t,e,i,n,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(let t of this._editStackElementsArr)t.undo()}redo(){for(let t of this._editStackElementsArr)t.redo()}heapSize(t){let e=hy(t);return this._editStackElementsMap.has(e)?this._editStackElementsMap.get(e).heapSize():0}split(){return this._editStackElementsArr}toString(){let t=[];for(let e of this._editStackElementsArr)t.push(`${Tr(e.resource)}: ${e}`);return`{${t.join(", ")}}`}};function ZU(r){return r.getEOL()===`
`?0:1}function $U(r){return r?r instanceof CR||r instanceof YU:!1}var SR=class r{_model;_undoRedoService;constructor(t,e){this._model=t,this._undoRedoService=e}pushStackElement(){let t=this._undoRedoService.getLastElement(this._model.uri);$U(t)&&t.close()}popStackElement(){let t=this._undoRedoService.getLastElement(this._model.uri);$U(t)&&t.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(t,e){let i=this._undoRedoService.getLastElement(this._model.uri);if($U(i)&&i.canAppend(this._model))return i;let n=new CR(h("edit","Typing"),"undoredo.textBufferEdit",this._model,t);return this._undoRedoService.pushElement(n,e),n}pushEOL(t){let e=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(t),e.append(this._model,[],ZU(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(t,e,i,n){let o=this._getOrCreateEditStackElement(t,n),s=this._model.applyEdits(e,!0),a=r._computeCursorState(i,s),l=s.map((d,c)=>({index:c,textChange:d.textChange}));return l.sort((d,c)=>d.textChange.oldPosition===c.textChange.oldPosition?d.index-c.index:d.textChange.oldPosition-c.textChange.oldPosition),o.append(this._model,l.map(d=>d.textChange),ZU(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(t,e){try{return t?t(e):null}catch(i){return Ke(i),null}}};var my=class extends L{_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}};function NY(r,t){let e=0,i=0,n=r.length;for(;i<n;){let o=r.charCodeAt(i);if(o===32)e++;else if(o===9)e=e-e%t+t;else break;i++}return i===n?-1:e}var wR=class extends my{constructor(e,i){super();this.textModel=e;this.languageConfigurationService=i}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return NY(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,i,n){this.assertNotDisposed();let o=this.textModel.getLineCount();if(e<1||e>o)throw new yt("Illegal value for lineNumber");let s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=-2,d=-1,c=-2,u=-1,p=R=>{if(l!==-1&&(l===-2||l>R-1)){l=-1,d=-1;for(let A=R-2;A>=0;A--){let H=this._computeIndentLevel(A);if(H>=0){l=A,d=H;break}}}if(c===-2){c=-1,u=-1;for(let A=R;A<o;A++){let H=this._computeIndentLevel(A);if(H>=0){c=A,u=H;break}}}},m=-2,g=-1,f=-2,b=-1,y=R=>{if(m===-2){m=-1,g=-1;for(let A=R-2;A>=0;A--){let H=this._computeIndentLevel(A);if(H>=0){m=A,g=H;break}}}if(f!==-1&&(f===-2||f<R-1)){f=-1,b=-1;for(let A=R;A<o;A++){let H=this._computeIndentLevel(A);if(H>=0){f=A,b=H;break}}}},I=0,E=!0,S=0,w=!0,D=0,k=0;for(let R=0;E||w;R++){let A=e-R,H=e+R;R>1&&(A<1||A<i)&&(E=!1),R>1&&(H>o||H>n)&&(w=!1),R>5e4&&(E=!1,w=!1);let z=-1;if(E&&A>=1){let fe=this._computeIndentLevel(A-1);fe>=0?(c=A-1,u=fe,z=Math.ceil(fe/this.textModel.getOptions().indentSize)):(p(A),z=this._getIndentLevelForWhitespaceLine(a,d,u))}let Z=-1;if(w&&H<=o){let fe=this._computeIndentLevel(H-1);fe>=0?(m=H-1,g=fe,Z=Math.ceil(fe/this.textModel.getOptions().indentSize)):(y(H),Z=this._getIndentLevelForWhitespaceLine(a,g,b))}if(R===0){k=z;continue}if(R===1){if(H<=o&&Z>=0&&k+1===Z){E=!1,I=H,S=H,D=Z;continue}if(A>=1&&z>=0&&z-1===k){w=!1,I=A,S=A,D=z;continue}if(I=e,S=e,D=k,D===0)return{startLineNumber:I,endLineNumber:S,indent:D}}E&&(z>=D?I=A:E=!1),w&&(Z>=D?S=H:w=!1)}return{startLineNumber:I,endLineNumber:S,indent:D}}getLinesBracketGuides(e,i,n,o){let s=[];for(let p=e;p<=i;p++)s.push([]);let a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new F(e,1,i,this.textModel.getLineMaxColumn(i))).toArray(),d;if(n&&l.length>0){let p=(e<=n.lineNumber&&n.lineNumber<=i?l:this.textModel.bracketPairs.getBracketPairsInRange(F.fromPositions(n)).toArray()).filter(m=>F.strictContainsPosition(m.range,n));d=ug(p,m=>a||m.range.startLineNumber!==m.range.endLineNumber)?.range}let c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new CE;for(let p of l){if(!p.closingBracketRange)continue;let m=d&&p.range.equalsRange(d);if(!m&&!o.includeInactive)continue;let g=u.getInlineClassName(p.nestingLevel,p.nestingLevelOfEqualBracketType,c)+(o.highlightActive&&m?" "+u.activeClassName:""),f=p.openingBracketRange.getStartPosition(),b=p.closingBracketRange.getStartPosition(),y=o.horizontalGuides===2||o.horizontalGuides===1&&m;if(p.range.startLineNumber===p.range.endLineNumber){a&&y&&s[p.range.startLineNumber-e].push(new Sl(-1,p.openingBracketRange.getEndPosition().column,g,new bp(!1,b.column),-1,-1));continue}let I=this.getVisibleColumnFromPosition(b),E=this.getVisibleColumnFromPosition(p.openingBracketRange.getStartPosition()),S=Math.min(E,I,p.minVisibleColumnIndentation+1),w=!1;Rn(this.textModel.getLineContent(p.closingBracketRange.startLineNumber))<p.closingBracketRange.startColumn-1&&(w=!0);let R=Math.max(f.lineNumber,e),A=Math.min(b.lineNumber,i),H=w?1:0;for(let z=R;z<A+H;z++)s[z-e].push(new Sl(S,-1,g,null,z===f.lineNumber?f.column:-1,z===b.lineNumber?b.column:-1));y&&(f.lineNumber>=e&&E>S&&s[f.lineNumber-e].push(new Sl(S,-1,g,new bp(!1,f.column),-1,-1)),b.lineNumber<=i&&I>S&&s[b.lineNumber-e].push(new Sl(S,-1,g,new bp(!w,b.column),-1,-1)))}for(let p of s)p.sort((m,g)=>m.visibleColumn-g.visibleColumn);return s}getVisibleColumnFromPosition(e){return Ni.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,i){this.assertNotDisposed();let n=this.textModel.getLineCount();if(e<1||e>n)throw new Error("Illegal value for startLineNumber");if(i<1||i>n)throw new Error("Illegal value for endLineNumber");let o=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,a=!!(s&&s.offSide),l=new Array(i-e+1),d=-2,c=-1,u=-2,p=-1;for(let m=e;m<=i;m++){let g=m-e,f=this._computeIndentLevel(m-1);if(f>=0){d=m-1,c=f,l[g]=Math.ceil(f/o.indentSize);continue}if(d===-2){d=-1,c=-1;for(let b=m-2;b>=0;b--){let y=this._computeIndentLevel(b);if(y>=0){d=b,c=y;break}}}if(u!==-1&&(u===-2||u<m-1)){u=-1,p=-1;for(let b=m;b<n;b++){let y=this._computeIndentLevel(b);if(y>=0){u=b,p=y;break}}}l[g]=this._getIndentLevelForWhitespaceLine(a,c,p)}return l}_getIndentLevelForWhitespaceLine(e,i,n){let o=this.textModel.getOptions();return i===-1||n===-1?0:i<n?1+Math.floor(i/o.indentSize):i===n||e?Math.ceil(n/o.indentSize):1+Math.floor(n/o.indentSize)}},CE=class{activeClassName="indent-active";getInlineClassName(t,e,i){return this.getInlineClassNameOfLevel(i?e:t)}getInlineClassNameOfLevel(t){return`bracket-indent-guide lvl-${t%30}`}};var XU=class{spacesDiff=0;looksLikeAlignment=!1};function Ese(r,t,e,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let o;for(o=0;o<t&&o<i;o++){let p=r.charCodeAt(o),m=e.charCodeAt(o);if(p!==m)break}let s=0,a=0;for(let p=o;p<t;p++)r.charCodeAt(p)===32?s++:a++;let l=0,d=0;for(let p=o;p<i;p++)e.charCodeAt(p)===32?l++:d++;if(s>0&&a>0||l>0&&d>0)return;let c=Math.abs(a-d),u=Math.abs(s-l);if(c===0){n.spacesDiff=u,u>0&&0<=l-1&&l-1<r.length&&l<e.length&&e.charCodeAt(l)!==32&&r.charCodeAt(l-1)===32&&r.charCodeAt(r.length-1)===44&&(n.looksLikeAlignment=!0);return}if(u%c===0){n.spacesDiff=u/c;return}}function QU(r,t,e){let i=Math.min(r.getLineCount(),1e4),n=0,o=0,s="",a=0,l=[2,4,6,8,3,5,7],d=8,c=[0,0,0,0,0,0,0,0,0],u=new XU;for(let g=1;g<=i;g++){let f=r.getLineLength(g),b=r.getLineContent(g),y=f<=65536,I=!1,E=0,S=0,w=0;for(let k=0,R=f;k<R;k++){let A=y?b.charCodeAt(k):r.getLineCharCode(g,k);if(A===9)w++;else if(A===32)S++;else{I=!0,E=k;break}}if(!I||(w>0?n++:S>1&&o++,Ese(s,a,b,E,u),u.looksLikeAlignment&&!(e&&t===u.spacesDiff)))continue;let D=u.spacesDiff;D<=d&&c[D]++,s=b,a=E}let p=e;n!==o&&(p=n<o);let m=t;if(p){let g=p?0:.1*i;l.forEach(f=>{let b=c[f];b>g&&(g=b,m=f)}),m===4&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(m=2)}return{insertSpaces:p,tabSize:m}}function ls(r){return(r.metadata&1)>>>0}function Fi(r,t){r.metadata=r.metadata&254|t<<0}function Go(r){return(r.metadata&2)>>>1===1}function ki(r,t){r.metadata=r.metadata&253|(t?1:0)<<1}function KY(r){return(r.metadata&4)>>>2===1}function FY(r,t){r.metadata=r.metadata&251|(t?1:0)<<2}function GY(r){return(r.metadata&64)>>>6===1}function BY(r,t){r.metadata=r.metadata&191|(t?1:0)<<6}function Tse(r){return(r.metadata&24)>>>3}function VY(r,t){r.metadata=r.metadata&231|t<<3}function xse(r){return(r.metadata&32)>>>5===1}function WY(r,t){r.metadata=r.metadata&223|(t?1:0)<<5}var EE=class{metadata;parent;left;right;start;end;delta;maxEnd;id;ownerId;options;cachedVersionId;cachedAbsoluteStart;cachedAbsoluteEnd;range;constructor(t,e,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,Fi(this,1),this.start=e,this.end=i,this.delta=0,this.maxEnd=i,this.id=t,this.ownerId=0,this.options=null,FY(this,!1),BY(this,!1),VY(this,1),WY(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=i,this.range=null,ki(this,!1)}reset(t,e,i,n){this.start=e,this.end=i,this.maxEnd=i,this.cachedVersionId=t,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=i,this.range=n}setOptions(t){this.options=t;let e=this.options.className;FY(this,e==="squiggly-error"||e==="squiggly-warning"||e==="squiggly-info"),BY(this,this.options.glyphMarginClassName!==null),VY(this,this.options.stickiness),WY(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(t,e,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=e}detach(){this.parent=null,this.left=null,this.right=null}},At=new EE(null,0,0);At.parent=At;At.left=At;At.right=At;Fi(At,0);var fy=class{root;requestNormalizeDelta;constructor(){this.root=At,this.requestNormalizeDelta=!1}intervalSearch(t,e,i,n,o,s){return this.root===At?[]:Pse(this,t,e,i,n,o,s)}search(t,e,i,n){return this.root===At?[]:UY(this,t,e,i,n)}collectNodesFromOwner(t){return Rse(this,t)}collectNodesPostOrder(){return Ase(this)}insert(t){HY(this,t),this._normalizeDeltaIfNecessary()}delete(t){zY(this,t),this._normalizeDeltaIfNecessary()}resolveNode(t,e){let i=t,n=0;for(;t!==this.root;)t===t.parent.right&&(n+=t.parent.delta),t=t.parent;let o=i.start+n,s=i.end+n;i.setCachedOffsets(o,s,e)}acceptReplace(t,e,i,n){let o=Lse(this,t,t+e);for(let s=0,a=o.length;s<a;s++){let l=o[s];zY(this,l)}this._normalizeDeltaIfNecessary(),kse(this,t,t+e,i),this._normalizeDeltaIfNecessary();for(let s=0,a=o.length;s<a;s++){let l=o[s];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,Dse(l,t,t+e,i,n),l.maxEnd=l.end,HY(this,l)}this._normalizeDeltaIfNecessary()}getAllInOrder(){return UY(this,0,!1,0,!1)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,_se(this))}};function _se(r){let t=r.root,e=0;for(;t!==At;){if(t.left!==At&&!Go(t.left)){t=t.left;continue}if(t.right!==At&&!Go(t.right)){e+=t.delta,t=t.right;continue}t.start=e+t.start,t.end=e+t.end,t.delta=0,yp(t),ki(t,!0),ki(t.left,!1),ki(t.right,!1),t===t.parent.right&&(e-=t.parent.delta),t=t.parent}ki(r.root,!1)}function gy(r,t,e,i){return r<e?!0:r>e||i===1?!1:i===2?!0:t}function Dse(r,t,e,i,n){let o=Tse(r),s=o===0||o===2,a=o===1||o===2,l=e-t,d=i,c=Math.min(l,d),u=r.start,p=!1,m=r.end,g=!1;t<=u&&m<=e&&xse(r)&&(r.start=t,p=!0,r.end=t,g=!0);{let b=n?1:l>0?2:0;!p&&gy(u,s,t,b)&&(p=!0),!g&&gy(m,a,t,b)&&(g=!0)}if(c>0&&!n){let b=l>d?2:0;!p&&gy(u,s,t+c,b)&&(p=!0),!g&&gy(m,a,t+c,b)&&(g=!0)}{let b=n?1:0;!p&&gy(u,s,e,b)&&(r.start=t+d,p=!0),!g&&gy(m,a,e,b)&&(r.end=t+d,g=!0)}let f=d-l;p||(r.start=Math.max(0,u+f)),g||(r.end=Math.max(0,m+f)),r.start>r.end&&(r.end=r.start)}function Lse(r,t,e){let i=r.root,n=0,o=0,s=0,a=0,l=[],d=0;for(;i!==At;){if(Go(i)){ki(i.left,!1),ki(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!Go(i.left)){if(o=n+i.maxEnd,o<t){ki(i,!0);continue}if(i.left!==At){i=i.left;continue}}if(s=n+i.start,s>e){ki(i,!0);continue}if(a=n+i.end,a>=t&&(i.setCachedOffsets(s,a,0),l[d++]=i),ki(i,!0),i.right!==At&&!Go(i.right)){n+=i.delta,i=i.right;continue}}return ki(r.root,!1),l}function kse(r,t,e,i){let n=r.root,o=0,s=0,a=0,l=i-(e-t);for(;n!==At;){if(Go(n)){ki(n.left,!1),ki(n.right,!1),n===n.parent.right&&(o-=n.parent.delta),yp(n),n=n.parent;continue}if(!Go(n.left)){if(s=o+n.maxEnd,s<t){ki(n,!0);continue}if(n.left!==At){n=n.left;continue}}if(a=o+n.start,a>e){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(r.requestNormalizeDelta=!0),ki(n,!0);continue}if(ki(n,!0),n.right!==At&&!Go(n.right)){o+=n.delta,n=n.right;continue}}ki(r.root,!1)}function Rse(r,t){let e=r.root,i=[],n=0;for(;e!==At;){if(Go(e)){ki(e.left,!1),ki(e.right,!1),e=e.parent;continue}if(e.left!==At&&!Go(e.left)){e=e.left;continue}if(e.ownerId===t&&(i[n++]=e),ki(e,!0),e.right!==At&&!Go(e.right)){e=e.right;continue}}return ki(r.root,!1),i}function Ase(r){let t=r.root,e=[],i=0;for(;t!==At;){if(Go(t)){ki(t.left,!1),ki(t.right,!1),t=t.parent;continue}if(t.left!==At&&!Go(t.left)){t=t.left;continue}if(t.right!==At&&!Go(t.right)){t=t.right;continue}e[i++]=t,ki(t,!0)}return ki(r.root,!1),e}function UY(r,t,e,i,n){let o=r.root,s=0,a=0,l=0,d=[],c=0;for(;o!==At;){if(Go(o)){ki(o.left,!1),ki(o.right,!1),o===o.parent.right&&(s-=o.parent.delta),o=o.parent;continue}if(o.left!==At&&!Go(o.left)){o=o.left;continue}a=s+o.start,l=s+o.end,o.setCachedOffsets(a,l,i);let u=!0;if(t&&o.ownerId&&o.ownerId!==t&&(u=!1),e&&KY(o)&&(u=!1),n&&!GY(o)&&(u=!1),u&&(d[c++]=o),ki(o,!0),o.right!==At&&!Go(o.right)){s+=o.delta,o=o.right;continue}}return ki(r.root,!1),d}function Pse(r,t,e,i,n,o,s){let a=r.root,l=0,d=0,c=0,u=0,p=[],m=0;for(;a!==At;){if(Go(a)){ki(a.left,!1),ki(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Go(a.left)){if(d=l+a.maxEnd,d<t){ki(a,!0);continue}if(a.left!==At){a=a.left;continue}}if(c=l+a.start,c>e){ki(a,!0);continue}if(u=l+a.end,u>=t){a.setCachedOffsets(c,u,o);let g=!0;i&&a.ownerId&&a.ownerId!==i&&(g=!1),n&&KY(a)&&(g=!1),s&&!GY(a)&&(g=!1),g&&(p[m++]=a)}if(ki(a,!0),a.right!==At&&!Go(a.right)){l+=a.delta,a=a.right;continue}}return ki(r.root,!1),p}function HY(r,t){if(r.root===At)return t.parent=At,t.left=At,t.right=At,Fi(t,0),r.root=t,r.root;Mse(r,t),Yh(t.parent);let e=t;for(;e!==r.root&&ls(e.parent)===1;)if(e.parent===e.parent.parent.left){let i=e.parent.parent.right;ls(i)===1?(Fi(e.parent,0),Fi(i,0),Fi(e.parent.parent,1),e=e.parent.parent):(e===e.parent.right&&(e=e.parent,SE(r,e)),Fi(e.parent,0),Fi(e.parent.parent,1),wE(r,e.parent.parent))}else{let i=e.parent.parent.left;ls(i)===1?(Fi(e.parent,0),Fi(i,0),Fi(e.parent.parent,1),e=e.parent.parent):(e===e.parent.left&&(e=e.parent,wE(r,e)),Fi(e.parent,0),Fi(e.parent.parent,1),SE(r,e.parent.parent))}return Fi(r.root,0),t}function Mse(r,t){let e=0,i=r.root,n=t.start,o=t.end;for(;;)if(Nse(n,o,i.start+e,i.end+e)<0)if(i.left===At){t.start-=e,t.end-=e,t.maxEnd-=e,i.left=t;break}else i=i.left;else if(i.right===At){t.start-=e+i.delta,t.end-=e+i.delta,t.maxEnd-=e+i.delta,i.right=t;break}else e+=i.delta,i=i.right;t.parent=i,t.left=At,t.right=At,Fi(t,1)}function zY(r,t){let e,i;if(t.left===At?(e=t.right,i=t,e.delta+=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),e.start+=t.delta,e.end+=t.delta):t.right===At?(e=t.left,i=t):(i=Ose(t.right),e=i.right,e.start+=i.delta,e.end+=i.delta,e.delta+=i.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta,i.delta=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(r.requestNormalizeDelta=!0)),i===r.root){r.root=e,Fi(e,0),t.detach(),JU(),yp(e),r.root.parent=At;return}let n=ls(i)===1;if(i===i.parent.left?i.parent.left=e:i.parent.right=e,i===t?e.parent=i.parent:(i.parent===t?e.parent=i:e.parent=i.parent,i.left=t.left,i.right=t.right,i.parent=t.parent,Fi(i,ls(t)),t===r.root?r.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==At&&(i.left.parent=i),i.right!==At&&(i.right.parent=i)),t.detach(),n){Yh(e.parent),i!==t&&(Yh(i),Yh(i.parent)),JU();return}Yh(e),Yh(e.parent),i!==t&&(Yh(i),Yh(i.parent));let o;for(;e!==r.root&&ls(e)===0;)e===e.parent.left?(o=e.parent.right,ls(o)===1&&(Fi(o,0),Fi(e.parent,1),SE(r,e.parent),o=e.parent.right),ls(o.left)===0&&ls(o.right)===0?(Fi(o,1),e=e.parent):(ls(o.right)===0&&(Fi(o.left,0),Fi(o,1),wE(r,o),o=e.parent.right),Fi(o,ls(e.parent)),Fi(e.parent,0),Fi(o.right,0),SE(r,e.parent),e=r.root)):(o=e.parent.left,ls(o)===1&&(Fi(o,0),Fi(e.parent,1),wE(r,e.parent),o=e.parent.left),ls(o.left)===0&&ls(o.right)===0?(Fi(o,1),e=e.parent):(ls(o.left)===0&&(Fi(o.right,0),Fi(o,1),SE(r,o),o=e.parent.left),Fi(o,ls(e.parent)),Fi(e.parent,0),Fi(o.left,0),wE(r,e.parent),e=r.root));Fi(e,0),JU()}function Ose(r){for(;r.left!==At;)r=r.left;return r}function JU(){At.parent=At,At.delta=0,At.start=0,At.end=0}function SE(r,t){let e=t.right;e.delta+=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(r.requestNormalizeDelta=!0),e.start+=t.delta,e.end+=t.delta,t.right=e.left,e.left!==At&&(e.left.parent=t),e.parent=t.parent,t.parent===At?r.root=e:t===t.parent.left?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e,yp(t),yp(e)}function wE(r,t){let e=t.left;t.delta-=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(r.requestNormalizeDelta=!0),t.start-=e.delta,t.end-=e.delta,t.left=e.right,e.right!==At&&(e.right.parent=t),e.parent=t.parent,t.parent===At?r.root=e:t===t.parent.right?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e,yp(t),yp(e)}function qY(r){let t=r.end;if(r.left!==At){let e=r.left.maxEnd;e>t&&(t=e)}if(r.right!==At){let e=r.right.maxEnd+r.delta;e>t&&(t=e)}return t}function yp(r){r.maxEnd=qY(r)}function Yh(r){for(;r!==At;){let t=qY(r);if(r.maxEnd===t)return;r.maxEnd=t,r=r.parent}}function Nse(r,t,e,i){return r===e?t-i:r-e}var by=class{parent;left;right;color;piece;size_left;lf_left;constructor(t,e){this.piece=t,this.color=e,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==ct)return TR(this.right);let t=this;for(;t.parent!==ct&&t.parent.left!==t;)t=t.parent;return t.parent===ct?ct:t.parent}prev(){if(this.left!==ct)return tH(this.left);let t=this;for(;t.parent!==ct&&t.parent.right!==t;)t=t.parent;return t.parent===ct?ct:t.parent}detach(){this.parent=null,this.left=null,this.right=null}};var ct=new by(null,0);ct.parent=ct;ct.left=ct;ct.right=ct;ct.color=0;function TR(r){for(;r.left!==ct;)r=r.left;return r}function tH(r){for(;r.right!==ct;)r=r.right;return r}function iH(r){return r===ct?0:r.size_left+r.piece.length+iH(r.right)}function nH(r){return r===ct?0:r.lf_left+r.piece.lineFeedCnt+nH(r.right)}function eH(){ct.parent=ct}function xE(r,t){let e=t.right;e.size_left+=t.size_left+(t.piece?t.piece.length:0),e.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=e.left,e.left!==ct&&(e.left.parent=t),e.parent=t.parent,t.parent===ct?r.root=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}function _E(r,t){let e=t.left;t.left=e.right,e.right!==ct&&(e.right.parent=t),e.parent=t.parent,t.size_left-=e.size_left+(e.piece?e.piece.length:0),t.lf_left-=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),t.parent===ct?r.root=e:t===t.parent.right?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}function DE(r,t){let e,i;if(t.left===ct?(i=t,e=i.right):t.right===ct?(i=t,e=i.left):(i=TR(t.right),e=i.right),i===r.root){r.root=e,e.color=0,t.detach(),eH(),r.root.parent=ct;return}let n=i.color===1;if(i===i.parent.left?i.parent.left=e:i.parent.right=e,i===t?(e.parent=i.parent,TE(r,e)):(i.parent===t?e.parent=i:e.parent=i.parent,TE(r,e),i.left=t.left,i.right=t.right,i.parent=t.parent,i.color=t.color,t===r.root?r.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==ct&&(i.left.parent=i),i.right!==ct&&(i.right.parent=i),i.size_left=t.size_left,i.lf_left=t.lf_left,TE(r,i)),t.detach(),e.parent.left===e){let s=iH(e),a=nH(e);if(s!==e.parent.size_left||a!==e.parent.lf_left){let l=s-e.parent.size_left,d=a-e.parent.lf_left;e.parent.size_left=s,e.parent.lf_left=a,Bc(r,e.parent,l,d)}}if(TE(r,e.parent),n){eH();return}let o;for(;e!==r.root&&e.color===0;)e===e.parent.left?(o=e.parent.right,o.color===1&&(o.color=0,e.parent.color=1,xE(r,e.parent),o=e.parent.right),o.left.color===0&&o.right.color===0?(o.color=1,e=e.parent):(o.right.color===0&&(o.left.color=0,o.color=1,_E(r,o),o=e.parent.right),o.color=e.parent.color,e.parent.color=0,o.right.color=0,xE(r,e.parent),e=r.root)):(o=e.parent.left,o.color===1&&(o.color=0,e.parent.color=1,_E(r,e.parent),o=e.parent.left),o.left.color===0&&o.right.color===0?(o.color=1,e=e.parent):(o.left.color===0&&(o.right.color=0,o.color=1,xE(r,o),o=e.parent.left),o.color=e.parent.color,e.parent.color=0,o.left.color=0,_E(r,e.parent),e=r.root));e.color=0,eH()}function oH(r,t){for(TE(r,t);t!==r.root&&t.parent.color===1;)if(t.parent===t.parent.parent.left){let e=t.parent.parent.right;e.color===1?(t.parent.color=0,e.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,xE(r,t)),t.parent.color=0,t.parent.parent.color=1,_E(r,t.parent.parent))}else{let e=t.parent.parent.left;e.color===1?(t.parent.color=0,e.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,_E(r,t)),t.parent.color=0,t.parent.parent.color=1,xE(r,t.parent.parent))}r.root.color=0}function Bc(r,t,e,i){for(;t!==r.root&&t!==ct;)t.parent.left===t&&(t.parent.size_left+=e,t.parent.lf_left+=i),t=t.parent}function TE(r,t){let e=0,i=0;if(t!==r.root){for(;t!==r.root&&t===t.parent.right;)t=t.parent;if(t!==r.root)for(t=t.parent,e=iH(t.left)-t.size_left,i=nH(t.left)-t.lf_left,t.size_left+=e,t.lf_left+=i;t!==r.root&&(e!==0||i!==0);)t.parent.left===t&&(t.parent.size_left+=e,t.parent.lf_left+=i),t=t.parent}}var Fse=999,Cp=class{searchString;isRegex;matchCase;wordSeparators;constructor(t,e,i,n){this.searchString=t,this.isRegex=e,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let t;this.isRegex?t=Bse(this.searchString):t=this.searchString.indexOf(`
`)>=0;let e=null;try{e=dD(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:t,global:!0,unicode:!0})}catch{return null}if(!e)return null;let i=!this.isRegex&&!t;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new eR(e,this.wordSeparators?Mc(this.wordSeparators,[]):null,i?this.searchString:null)}};function Bse(r){if(!r||r.length===0)return!1;for(let t=0,e=r.length;t<e;t++){let i=r.charCodeAt(t);if(i===10)return!0;if(i===92){if(t++,t>=e)break;let n=r.charCodeAt(t);if(n===110||n===114||n===87)return!0}}return!1}function Zh(r,t,e){if(!e)return new jh(r,null);let i=[];for(let n=0,o=t.length;n<o;n++)i[n]=t[n];return new jh(r,i)}var xR=class{_lineFeedsOffsets;constructor(t){let e=[],i=0;for(let n=0,o=t.length;n<o;n++)t.charCodeAt(n)===10&&(e[i++]=n);this._lineFeedsOffsets=e}findLineFeedCountBeforeOffset(t){let e=this._lineFeedsOffsets,i=0,n=e.length-1;if(n===-1||t<=e[0])return 0;for(;i<n;){let o=i+((n-i)/2>>0);e[o]>=t?n=o-1:e[o+1]>=t?(i=o,n=o):i=o+1}return i+1}},Zg=class{static findMatches(t,e,i,n,o){let s=e.parseSearchRequest();return s?s.regex.multiline?this._doFindMatchesMultiline(t,i,new Ip(s.wordSeparators,s.regex),n,o):this._doFindMatchesLineByLine(t,i,s,n,o):[]}static _getMultilineMatchRange(t,e,i,n,o,s){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(o),a=e+o+l):a=e+o;let d;if(n){let m=n.findLineFeedCountBeforeOffset(o+s.length)-l;d=a+s.length+m}else d=a+s.length;let c=t.getPositionAt(a),u=t.getPositionAt(d);return new F(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(t,e,i,n,o){let s=t.getOffsetAt(e.getStartPosition()),a=t.getValueInRange(e,1),l=t.getEOL()===`\r
`?new xR(a):null,d=[],c=0,u;for(i.reset(0);u=i.next(a);)if(d[c++]=Zh(this._getMultilineMatchRange(t,s,a,l,u.index,u[0]),u,n),c>=o)return d;return d}static _doFindMatchesLineByLine(t,e,i,n,o){let s=[],a=0;if(e.startLineNumber===e.endLineNumber){let d=t.getLineContent(e.startLineNumber).substring(e.startColumn-1,e.endColumn-1);return a=this._findMatchesInLine(i,d,e.startLineNumber,e.startColumn-1,a,s,n,o),s}let l=t.getLineContent(e.startLineNumber).substring(e.startColumn-1);a=this._findMatchesInLine(i,l,e.startLineNumber,e.startColumn-1,a,s,n,o);for(let d=e.startLineNumber+1;d<e.endLineNumber&&a<o;d++)a=this._findMatchesInLine(i,t.getLineContent(d),d,0,a,s,n,o);if(a<o){let d=t.getLineContent(e.endLineNumber).substring(0,e.endColumn-1);a=this._findMatchesInLine(i,d,e.endLineNumber,0,a,s,n,o)}return s}static _findMatchesInLine(t,e,i,n,o,s,a,l){let d=t.wordSeparators;if(!a&&t.simpleSearch){let p=t.simpleSearch,m=p.length,g=e.length,f=-m;for(;(f=e.indexOf(p,f+m))!==-1;)if((!d||_R(d,e,g,f,m))&&(s[o++]=new jh(new F(i,f+1+n,i,f+1+m+n),null),o>=l))return o;return o}let c=new Ip(t.wordSeparators,t.regex),u;c.reset(0);do if(u=c.next(e),u&&(s[o++]=Zh(new F(i,u.index+1+n,i,u.index+1+u[0].length+n),u,a),o>=l))return o;while(u);return o}static findNextMatch(t,e,i,n){let o=e.parseSearchRequest();if(!o)return null;let s=new Ip(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(t,i,s,n):this._doFindNextMatchLineByLine(t,i,s,n)}static _doFindNextMatchMultiline(t,e,i,n){let o=new U(e.lineNumber,1),s=t.getOffsetAt(o),a=t.getLineCount(),l=t.getValueInRange(new F(o.lineNumber,o.column,a,t.getLineMaxColumn(a)),1),d=t.getEOL()===`\r
`?new xR(l):null;i.reset(e.column-1);let c=i.next(l);return c?Zh(this._getMultilineMatchRange(t,s,l,d,c.index,c[0]),c,n):e.lineNumber!==1||e.column!==1?this._doFindNextMatchMultiline(t,new U(1,1),i,n):null}static _doFindNextMatchLineByLine(t,e,i,n){let o=t.getLineCount(),s=e.lineNumber,a=t.getLineContent(s),l=this._findFirstMatchInLine(i,a,s,e.column,n);if(l)return l;for(let d=1;d<=o;d++){let c=(s+d-1)%o,u=t.getLineContent(c+1),p=this._findFirstMatchInLine(i,u,c+1,1,n);if(p)return p}return null}static _findFirstMatchInLine(t,e,i,n,o){t.reset(n-1);let s=t.next(e);return s?Zh(new F(i,s.index+1,i,s.index+1+s[0].length),s,o):null}static findPreviousMatch(t,e,i,n){let o=e.parseSearchRequest();if(!o)return null;let s=new Ip(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(t,i,s,n):this._doFindPreviousMatchLineByLine(t,i,s,n)}static _doFindPreviousMatchMultiline(t,e,i,n){let o=this._doFindMatchesMultiline(t,new F(1,1,e.lineNumber,e.column),i,n,10*Fse);if(o.length>0)return o[o.length-1];let s=t.getLineCount();return e.lineNumber!==s||e.column!==t.getLineMaxColumn(s)?this._doFindPreviousMatchMultiline(t,new U(s,t.getLineMaxColumn(s)),i,n):null}static _doFindPreviousMatchLineByLine(t,e,i,n){let o=t.getLineCount(),s=e.lineNumber,a=t.getLineContent(s).substring(0,e.column-1),l=this._findLastMatchInLine(i,a,s,n);if(l)return l;for(let d=1;d<=o;d++){let c=(o+s-d-1)%o,u=t.getLineContent(c+1),p=this._findLastMatchInLine(i,u,c+1,n);if(p)return p}return null}static _findLastMatchInLine(t,e,i,n){let o=null,s;for(t.reset(0);s=t.next(e);)o=Zh(new F(i,s.index+1,i,s.index+1+s[0].length),s,n);return o}};function Vse(r,t,e,i,n){if(i===0)return!0;let o=t.charCodeAt(i-1);if(r.get(o)!==0||o===13||o===10)return!0;if(n>0){let s=t.charCodeAt(i);if(r.get(s)!==0)return!0}return!1}function Wse(r,t,e,i,n){if(i+n===e)return!0;let o=t.charCodeAt(i+n);if(r.get(o)!==0||o===13||o===10)return!0;if(n>0){let s=t.charCodeAt(i+n-1);if(r.get(s)!==0)return!0}return!1}function _R(r,t,e,i,n){return Vse(r,t,e,i,n)&&Wse(r,t,e,i,n)}var Ip=class{_wordSeparators;_searchRegex;_prevMatchStartIndex;_prevMatchLength;constructor(t,e){this._wordSeparators=t,this._searchRegex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(t){this._searchRegex.lastIndex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(t){let e=t.length,i;do{if(this._prevMatchStartIndex+this._prevMatchLength===e||(i=this._searchRegex.exec(t),!i))return null;let n=i.index,o=i[0].length;if(n===this._prevMatchStartIndex&&o===this._prevMatchLength){if(o===0){Xb(t,e,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=o,!this._wordSeparators||_R(this._wordSeparators,t,e,n,o))return i}while(i);return null}};var Sp=65535;function jY(r){let t;return r[r.length-1]<65536?t=new Uint16Array(r.length):t=new Uint32Array(r.length),t.set(r,0),t}var sH=class{constructor(t,e,i,n,o){this.lineStarts=t;this.cr=e;this.lf=i;this.crlf=n;this.isBasicASCII=o}};function Vc(r,t=!0){let e=[0],i=1;for(let n=0,o=r.length;n<o;n++){let s=r.charCodeAt(n);s===13?n+1<o&&r.charCodeAt(n+1)===10?(e[i++]=n+2,n++):e[i++]=n+1:s===10&&(e[i++]=n+1)}return t?jY(e):e}function $Y(r,t){r.length=0,r[0]=0;let e=1,i=0,n=0,o=0,s=!0;for(let l=0,d=t.length;l<d;l++){let c=t.charCodeAt(l);c===13?l+1<d&&t.charCodeAt(l+1)===10?(o++,r[e++]=l+2,l++):(i++,r[e++]=l+1):c===10?(n++,r[e++]=l+1):s&&c!==9&&(c<32||c>126)&&(s=!1)}let a=new sH(jY(r),i,n,o,s);return r.length=0,a}var jr=class{bufferIndex;start;end;length;lineFeedCnt;constructor(t,e,i,n,o){this.bufferIndex=t,this.start=e,this.end=i,this.lineFeedCnt=n,this.length=o}},Wc=class{buffer;lineStarts;constructor(t,e){this.buffer=t,this.lineStarts=e}},aH=class{_pieces;_index;_tree;_BOM;constructor(t,e){this._pieces=[],this._tree=t,this._BOM=e,this._index=0,t.root!==ct&&t.iterate(t.root,i=>(i!==ct&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},lH=class{_limit;_cache;constructor(t){this._limit=t,this._cache=[]}get(t){for(let e=this._cache.length-1;e>=0;e--){let i=this._cache[e];if(i.nodeStartOffset<=t&&i.nodeStartOffset+i.node.piece.length>=t)return i}return null}get2(t){for(let e=this._cache.length-1;e>=0;e--){let i=this._cache[e];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<t&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=t)return i}return null}set(t){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(t)}validate(t){let e=!1,i=this._cache;for(let n=0;n<i.length;n++){let o=i[n];if(o.node.parent===null||o.nodeStartOffset>=t){i[n]=null,e=!0;continue}}if(e){let n=[];for(let o of i)o!==null&&n.push(o);this._cache=n}}},DR=class{root;_buffers;_lineCnt;_length;_EOL;_EOLLength;_EOLNormalized;_lastChangeBufferPos;_searchCache;_lastVisitedLine;constructor(t,e,i){this.create(t,e,i)}create(t,e,i){this._buffers=[new Wc("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=ct,this._lineCnt=1,this._length=0,this._EOL=e,this._EOLLength=e.length,this._EOLNormalized=i;let n=null;for(let o=0,s=t.length;o<s;o++)if(t[o].buffer.length>0){t[o].lineStarts||(t[o].lineStarts=Vc(t[o].buffer));let a=new jr(o+1,{line:0,column:0},{line:t[o].lineStarts.length-1,column:t[o].buffer.length-t[o].lineStarts[t[o].lineStarts.length-1]},t[o].lineStarts.length-1,t[o].buffer.length);this._buffers.push(t[o]),n=this.rbInsertRight(n,a)}this._searchCache=new lH(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(t){let e=Sp,i=e-Math.floor(e/3),n=i*2,o="",s=0,a=[];if(this.iterate(this.root,l=>{let d=this.getNodeContent(l),c=d.length;if(s<=i||s+c<n)return o+=d,s+=c,!0;let u=o.replace(/\r\n|\r|\n/g,t);return a.push(new Wc(u,Vc(u))),o=d,s=c,!0}),s>0){let l=o.replace(/\r\n|\r|\n/g,t);a.push(new Wc(l,Vc(l)))}this.create(a,t,!0)}getEOL(){return this._EOL}setEOL(t){this._EOL=t,this._EOLLength=this._EOL.length,this.normalizeEOL(t)}createSnapshot(t){return new aH(this,t)}equal(t){if(this.getLength()!==t.getLength()||this.getLineCount()!==t.getLineCount())return!1;let e=0;return this.iterate(this.root,n=>{if(n===ct)return!0;let o=this.getNodeContent(n),s=o.length,a=t.nodeAt(e),l=t.nodeAt(e+s),d=t.getValueInRange2(a,l);return e+=s,o===d})}getOffsetAt(t,e){let i=0,n=this.root;for(;n!==ct;)if(n.left!==ct&&n.lf_left+1>=t)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=t){i+=n.size_left;let o=this.getAccumulatedValue(n,t-n.lf_left-2);return i+=o+e-1}else t-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(t){t=Math.floor(t),t=Math.max(0,t);let e=this.root,i=0,n=t;for(;e!==ct;)if(e.size_left!==0&&e.size_left>=t)e=e.left;else if(e.size_left+e.piece.length>=t){let o=this.getIndexOf(e,t-e.size_left);if(i+=e.lf_left+o.index,o.index===0){let s=this.getOffsetAt(i+1,1),a=n-s;return new U(i+1,a+1)}return new U(i+1,o.remainder+1)}else if(t-=e.size_left+e.piece.length,i+=e.lf_left+e.piece.lineFeedCnt,e.right===ct){let o=this.getOffsetAt(i+1,1),s=n-t-o;return new U(i+1,s+1)}else e=e.right;return new U(1,1)}getValueInRange(t,e){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return"";let i=this.nodeAt2(t.startLineNumber,t.startColumn),n=this.nodeAt2(t.endLineNumber,t.endColumn),o=this.getValueInRange2(i,n);return e?e!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,e):e===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,e):o}getValueInRange2(t,e){if(t.node===e.node){let a=t.node,l=this._buffers[a.piece.bufferIndex].buffer,d=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(d+t.remainder,d+e.remainder)}let i=t.node,n=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start),s=n.substring(o+t.remainder,o+i.piece.length);for(i=i.next();i!==ct;){let a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===e.node){s+=a.substring(l,l+e.remainder);break}else s+=a.substr(l,i.piece.length);i=i.next()}return s}getLinesContent(){let t=[],e=0,i="",n=!1;return this.iterate(this.root,o=>{if(o===ct)return!0;let s=o.piece,a=s.length;if(a===0)return!0;let l=this._buffers[s.bufferIndex].buffer,d=this._buffers[s.bufferIndex].lineStarts,c=s.start.line,u=s.end.line,p=d[c]+s.start.column;if(n&&(l.charCodeAt(p)===10&&(p++,a--),t[e++]=i,i="",n=!1,a===0))return!0;if(c===u)return!this._EOLNormalized&&l.charCodeAt(p+a-1)===13?(n=!0,i+=l.substr(p,a-1)):i+=l.substr(p,a),!0;i+=this._EOLNormalized?l.substring(p,Math.max(p,d[c+1]-this._EOLLength)):l.substring(p,d[c+1]).replace(/(\r\n|\r|\n)$/,""),t[e++]=i;for(let m=c+1;m<u;m++)i=this._EOLNormalized?l.substring(d[m],d[m+1]-this._EOLLength):l.substring(d[m],d[m+1]).replace(/(\r\n|\r|\n)$/,""),t[e++]=i;return!this._EOLNormalized&&l.charCodeAt(d[u]+s.end.column-1)===13?(n=!0,s.end.column===0?e--:i=l.substr(d[u],s.end.column-1)):i=l.substr(d[u],s.end.column),!0}),n&&(t[e++]=i,i=""),t[e++]=i,t}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(t){return this._lastVisitedLine.lineNumber===t?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=t,t===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(t):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(t,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(t).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(t){if(t.remainder===t.node.piece.length){let e=t.node.next();if(!e)return 0;let i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);return i.buffer.charCodeAt(n)}else{let e=this._buffers[t.node.piece.bufferIndex],n=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start)+t.remainder;return e.buffer.charCodeAt(n)}}getLineCharCode(t,e){let i=this.nodeAt2(t,e+1);return this._getCharCode(i)}getLineLength(t){if(t===this.getLineCount()){let e=this.getOffsetAt(t,1);return this.getLength()-e}return this.getOffsetAt(t+1,1)-this.getOffsetAt(t,1)-this._EOLLength}getCharCode(t){let e=this.nodeAt(t);return this._getCharCode(e)}getNearestChunk(t){let e=this.nodeAt(t);if(e.remainder===e.node.piece.length){let i=e.node.next();if(!i||i===ct)return"";let n=this._buffers[i.piece.bufferIndex],o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.substring(o,o+i.piece.length)}else{let i=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start),o=n+e.remainder,s=n+e.node.piece.length;return i.buffer.substring(o,s)}}findMatchesInNode(t,e,i,n,o,s,a,l,d,c,u){let p=this._buffers[t.piece.bufferIndex],m=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start),g=this.offsetInBuffer(t.piece.bufferIndex,o),f=this.offsetInBuffer(t.piece.bufferIndex,s),b,y={line:0,column:0},I,E;e._wordSeparators?(I=p.buffer.substring(g,f),E=S=>S+g,e.reset(0)):(I=p.buffer,E=S=>S,e.reset(g));do if(b=e.next(I),b){if(E(b.index)>=f)return c;this.positionInBuffer(t,E(b.index)-m,y);let S=this.getLineFeedCnt(t.piece.bufferIndex,o,y),w=y.line===o.line?y.column-o.column+n:y.column+1,D=w+b[0].length;if(u[c++]=Zh(new F(i+S,w,i+S,D),b,l),E(b.index)+b[0].length>=f||c>=d)return c}while(b);return c}findMatchesLineByLine(t,e,i,n){let o=[],s=0,a=new Ip(e.wordSeparators,e.regex),l=this.nodeAt2(t.startLineNumber,t.startColumn);if(l===null)return[];let d=this.nodeAt2(t.endLineNumber,t.endColumn);if(d===null)return[];let c=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(d.node,d.remainder);if(l.node===d.node)return this.findMatchesInNode(l.node,a,t.startLineNumber,t.startColumn,c,u,e,i,n,s,o),o;let p=t.startLineNumber,m=l.node;for(;m!==d.node;){let f=this.getLineFeedCnt(m.piece.bufferIndex,c,m.piece.end);if(f>=1){let y=this._buffers[m.piece.bufferIndex].lineStarts,I=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),E=y[c.line+f],S=p===t.startLineNumber?t.startColumn:1;if(s=this.findMatchesInNode(m,a,p,S,c,this.positionInBuffer(m,E-I),e,i,n,s,o),s>=n)return o;p+=f}let b=p===t.startLineNumber?t.startColumn-1:0;if(p===t.endLineNumber){let y=this.getLineContent(p).substring(b,t.endColumn-1);return s=this._findMatchesInLine(e,a,y,t.endLineNumber,b,s,o,i,n),o}if(s=this._findMatchesInLine(e,a,this.getLineContent(p).substr(b),p,b,s,o,i,n),s>=n)return o;p++,l=this.nodeAt2(p,1),m=l.node,c=this.positionInBuffer(l.node,l.remainder)}if(p===t.endLineNumber){let f=p===t.startLineNumber?t.startColumn-1:0,b=this.getLineContent(p).substring(f,t.endColumn-1);return s=this._findMatchesInLine(e,a,b,t.endLineNumber,f,s,o,i,n),o}let g=p===t.startLineNumber?t.startColumn:1;return s=this.findMatchesInNode(d.node,a,p,g,c,u,e,i,n,s,o),o}_findMatchesInLine(t,e,i,n,o,s,a,l,d){let c=t.wordSeparators;if(!l&&t.simpleSearch){let p=t.simpleSearch,m=p.length,g=i.length,f=-m;for(;(f=i.indexOf(p,f+m))!==-1;)if((!c||_R(c,i,g,f,m))&&(a[s++]=new jh(new F(n,f+1+o,n,f+1+m+o),null),s>=d))return s;return s}let u;e.reset(0);do if(u=e.next(i),u&&(a[s++]=Zh(new F(n,u.index+1+o,n,u.index+1+u[0].length+o),u,l),s>=d))return s;while(u);return s}insert(t,e,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==ct){let{node:n,remainder:o,nodeStartOffset:s}=this.nodeAt(t),a=n.piece,l=a.bufferIndex,d=this.positionInBuffer(n,o);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&s+a.length===t&&e.length<Sp){this.appendToNode(n,e),this.computeBufferMetadata();return}if(s===t)this.insertContentToNodeLeft(e,n),this._searchCache.validate(t);else if(s+n.piece.length>t){let c=[],u=new jr(a.bufferIndex,d,a.end,this.getLineFeedCnt(a.bufferIndex,d,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,d));if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.nodeCharCodeAt(n,o)===10){let f={line:u.start.line+1,column:0};u=new jr(u.bufferIndex,f,u.end,this.getLineFeedCnt(u.bufferIndex,f,u.end),u.length-1),e+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(e))if(this.nodeCharCodeAt(n,o-1)===13){let f=this.positionInBuffer(n,o-1);this.deleteNodeTail(n,f),e="\r"+e,n.piece.length===0&&c.push(n)}else this.deleteNodeTail(n,d);else this.deleteNodeTail(n,d);let p=this.createNewPieces(e);u.length>0&&this.rbInsertRight(n,u);let m=n;for(let g=0;g<p.length;g++)m=this.rbInsertRight(m,p[g]);this.deleteNodes(c)}else this.insertContentToNodeRight(e,n)}else{let n=this.createNewPieces(e),o=this.rbInsertLeft(null,n[0]);for(let s=1;s<n.length;s++)o=this.rbInsertRight(o,n[s])}this.computeBufferMetadata()}delete(t,e){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",e<=0||this.root===ct)return;let i=this.nodeAt(t),n=this.nodeAt(t+e),o=i.node,s=n.node;if(o===s){let p=this.positionInBuffer(o,i.remainder),m=this.positionInBuffer(o,n.remainder);if(i.nodeStartOffset===t){if(e===o.piece.length){let g=o.next();DE(this,o),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(o,m),this._searchCache.validate(t),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(i.nodeStartOffset+o.piece.length===t+e){this.deleteNodeTail(o,p),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,p,m),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(o,i.remainder);this.deleteNodeTail(o,l),this._searchCache.validate(t),o.piece.length===0&&a.push(o);let d=this.positionInBuffer(s,n.remainder);this.deleteNodeHead(s,d),s.piece.length===0&&a.push(s);let c=o.next();for(let p=c;p!==ct&&p!==s;p=p.next())a.push(p);let u=o.piece.length===0?o.prev():o;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(t,e){let i=[];if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.startWithLF(e)){let s=e.piece,a={line:s.start.line+1,column:0},l=new jr(s.bufferIndex,a,s.end,this.getLineFeedCnt(s.bufferIndex,a,s.end),s.length-1);e.piece=l,t+=`
`,Bc(this,e,-1,-1),e.piece.length===0&&i.push(e)}let n=this.createNewPieces(t),o=this.rbInsertLeft(e,n[n.length-1]);for(let s=n.length-2;s>=0;s--)o=this.rbInsertLeft(o,n[s]);this.validateCRLFWithPrevNode(o),this.deleteNodes(i)}insertContentToNodeRight(t,e){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let i=this.createNewPieces(t),n=this.rbInsertRight(e,i[0]),o=n;for(let s=1;s<i.length;s++)o=this.rbInsertRight(o,i[s]);this.validateCRLFWithPrevNode(n)}positionInBuffer(t,e,i){let n=t.piece,o=t.piece.bufferIndex,s=this._buffers[o].lineStarts,l=s[n.start.line]+n.start.column+e,d=n.start.line,c=n.end.line,u=0,p=0,m=0;for(;d<=c&&(u=d+(c-d)/2|0,m=s[u],u!==c);)if(p=s[u+1],l<m)c=u-1;else if(l>=p)d=u+1;else break;return i?(i.line=u,i.column=l-m,null):{line:u,column:l-m}}getLineFeedCnt(t,e,i){if(i.column===0)return i.line-e.line;let n=this._buffers[t].lineStarts;if(i.line===n.length-1)return i.line-e.line;let o=n[i.line+1],s=n[i.line]+i.column;if(o>s+1)return i.line-e.line;let a=s-1;return this._buffers[t].buffer.charCodeAt(a)===13?i.line-e.line+1:i.line-e.line}offsetInBuffer(t,e){return this._buffers[t].lineStarts[e.line]+e.column}deleteNodes(t){for(let e=0;e<t.length;e++)DE(this,t[e])}createNewPieces(t){if(t.length>Sp){let c=[];for(;t.length>Sp;){let p=t.charCodeAt(Sp-1),m;p===13||p>=55296&&p<=56319?(m=t.substring(0,Sp-1),t=t.substring(Sp-1)):(m=t.substring(0,Sp),t=t.substring(Sp));let g=Vc(m);c.push(new jr(this._buffers.length,{line:0,column:0},{line:g.length-1,column:m.length-g[g.length-1]},g.length-1,m.length)),this._buffers.push(new Wc(m,g))}let u=Vc(t);return c.push(new jr(this._buffers.length,{line:0,column:0},{line:u.length-1,column:t.length-u[u.length-1]},u.length-1,t.length)),this._buffers.push(new Wc(t,u)),c}let e=this._buffers[0].buffer.length,i=Vc(t,!1),n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===e&&e!==0&&this.startWithLF(t)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let c=0;c<i.length;c++)i[c]+=e+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+t,e+=1}else{if(e!==0)for(let c=0;c<i.length;c++)i[c]+=e;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=t}let o=this._buffers[0].buffer.length,s=this._buffers[0].lineStarts.length-1,a=o-this._buffers[0].lineStarts[s],l={line:s,column:a},d=new jr(0,n,l,this.getLineFeedCnt(0,n,l),o-e);return this._lastChangeBufferPos=l,[d]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(t,e=0){let i=this.root,n="",o=this._searchCache.get2(t);if(o){i=o.node;let s=this.getAccumulatedValue(i,t-o.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(o.nodeStartLineNumber+i.piece.lineFeedCnt===t)n=a.substring(l+s,l+i.piece.length);else{let d=this.getAccumulatedValue(i,t-o.nodeStartLineNumber);return a.substring(l+s,l+d-e)}}else{let s=0,a=t;for(;i!==ct;)if(i.left!==ct&&i.lf_left>=t-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>t-1){let l=this.getAccumulatedValue(i,t-i.lf_left-2),d=this.getAccumulatedValue(i,t-i.lf_left-1),c=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return s+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:s,nodeStartLineNumber:a-(t-1-i.lf_left)}),c.substring(u+l,u+d-e)}else if(i.lf_left+i.piece.lineFeedCnt===t-1){let l=this.getAccumulatedValue(i,t-i.lf_left-2),d=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=d.substring(c+l,c+i.piece.length);break}else t-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==ct;){let s=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=s.substring(l,l+a-e),n}else{let a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=s.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let t=this.root,e=1,i=0;for(;t!==ct;)e+=t.lf_left+t.piece.lineFeedCnt,i+=t.size_left+t.piece.length,t=t.right;this._lineCnt=e,this._length=i,this._searchCache.validate(this._length)}getIndexOf(t,e){let i=t.piece,n=this.positionInBuffer(t,e),o=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===e){let s=this.getLineFeedCnt(t.piece.bufferIndex,i.start,n);if(s!==o)return{index:s,remainder:0}}return{index:o,remainder:n.column}}getAccumulatedValue(t,e){if(e<0)return 0;let i=t.piece,n=this._buffers[i.bufferIndex].lineStarts,o=i.start.line+e+1;return o>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[o]-n[i.start.line]-i.start.column}deleteNodeTail(t,e){let i=t.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.end),s=e,a=this.offsetInBuffer(i.bufferIndex,s),l=this.getLineFeedCnt(i.bufferIndex,i.start,s),d=l-n,c=a-o,u=i.length+c;t.piece=new jr(i.bufferIndex,i.start,s,l,u),Bc(this,t,c,d)}deleteNodeHead(t,e){let i=t.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.start),s=e,a=this.getLineFeedCnt(i.bufferIndex,s,i.end),l=this.offsetInBuffer(i.bufferIndex,s),d=a-n,c=o-l,u=i.length+c;t.piece=new jr(i.bufferIndex,s,i.end,a,u),Bc(this,t,c,d)}shrinkNode(t,e,i){let n=t.piece,o=n.start,s=n.end,a=n.length,l=n.lineFeedCnt,d=e,c=this.getLineFeedCnt(n.bufferIndex,n.start,d),u=this.offsetInBuffer(n.bufferIndex,e)-this.offsetInBuffer(n.bufferIndex,o);t.piece=new jr(n.bufferIndex,n.start,d,c,u),Bc(this,t,u-a,c-l);let p=new jr(n.bufferIndex,i,s,this.getLineFeedCnt(n.bufferIndex,i,s),this.offsetInBuffer(n.bufferIndex,s)-this.offsetInBuffer(n.bufferIndex,i)),m=this.rbInsertRight(t,p);this.validateCRLFWithPrevNode(m)}appendToNode(t,e){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let i=this.shouldCheckCRLF()&&this.startWithLF(e)&&this.endWithCR(t),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=e;let o=Vc(e,!1);for(let m=0;m<o.length;m++)o[m]+=n;if(i){let m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));let s=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[s],l={line:s,column:a},d=t.piece.length+e.length,c=t.piece.lineFeedCnt,u=this.getLineFeedCnt(0,t.piece.start,l),p=u-c;t.piece=new jr(t.piece.bufferIndex,t.piece.start,l,u,d),this._lastChangeBufferPos=l,Bc(this,t,e.length,p)}nodeAt(t){let e=this.root,i=this._searchCache.get(t);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:t-i.nodeStartOffset};let n=0;for(;e!==ct;)if(e.size_left>t)e=e.left;else if(e.size_left+e.piece.length>=t){n+=e.size_left;let o={node:e,remainder:t-e.size_left,nodeStartOffset:n};return this._searchCache.set(o),o}else t-=e.size_left+e.piece.length,n+=e.size_left+e.piece.length,e=e.right;return null}nodeAt2(t,e){let i=this.root,n=0;for(;i!==ct;)if(i.left!==ct&&i.lf_left>=t-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>t-1){let o=this.getAccumulatedValue(i,t-i.lf_left-2),s=this.getAccumulatedValue(i,t-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(o+e-1,s),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===t-1){let o=this.getAccumulatedValue(i,t-i.lf_left-2);if(o+e-1<=i.piece.length)return{node:i,remainder:o+e-1,nodeStartOffset:n};e-=i.piece.length-o;break}else t-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==ct;){if(i.piece.lineFeedCnt>0){let o=this.getAccumulatedValue(i,0),s=this.offsetOfNode(i);return{node:i,remainder:Math.min(e-1,o),nodeStartOffset:s}}else if(i.piece.length>=e-1){let o=this.offsetOfNode(i);return{node:i,remainder:e-1,nodeStartOffset:o}}else e-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(t,e){if(t.piece.lineFeedCnt<1)return-1;let i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start)+e;return i.buffer.charCodeAt(n)}offsetOfNode(t){if(!t)return 0;let e=t.size_left;for(;t!==this.root;)t.parent.right===t&&(e+=t.parent.size_left+t.parent.piece.length),t=t.parent;return e}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(t){if(typeof t=="string")return t.charCodeAt(0)===10;if(t===ct||t.piece.lineFeedCnt===0)return!1;let e=t.piece,i=this._buffers[e.bufferIndex].lineStarts,n=e.start.line,o=i[n]+e.start.column;return n===i.length-1||i[n+1]>o+1?!1:this._buffers[e.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(t){return typeof t=="string"?t.charCodeAt(t.length-1)===13:t===ct||t.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(t,t.piece.length-1)===13}validateCRLFWithPrevNode(t){if(this.shouldCheckCRLF()&&this.startWithLF(t)){let e=t.prev();this.endWithCR(e)&&this.fixCRLF(e,t)}}validateCRLFWithNextNode(t){if(this.shouldCheckCRLF()&&this.endWithCR(t)){let e=t.next();this.startWithLF(e)&&this.fixCRLF(t,e)}}fixCRLF(t,e){let i=[],n=this._buffers[t.piece.bufferIndex].lineStarts,o;t.piece.end.column===0?o={line:t.piece.end.line-1,column:n[t.piece.end.line]-n[t.piece.end.line-1]-1}:o={line:t.piece.end.line,column:t.piece.end.column-1};let s=t.piece.length-1,a=t.piece.lineFeedCnt-1;t.piece=new jr(t.piece.bufferIndex,t.piece.start,o,a,s),Bc(this,t,-1,-1),t.piece.length===0&&i.push(t);let l={line:e.piece.start.line+1,column:0},d=e.piece.length-1,c=this.getLineFeedCnt(e.piece.bufferIndex,l,e.piece.end);e.piece=new jr(e.piece.bufferIndex,l,e.piece.end,c,d),Bc(this,e,-1,-1),e.piece.length===0&&i.push(e);let u=this.createNewPieces(`\r
`);this.rbInsertRight(t,u[0]);for(let p=0;p<i.length;p++)DE(this,i[p])}adjustCarriageReturnFromNext(t,e){if(this.shouldCheckCRLF()&&this.endWithCR(t)){let i=e.next();if(this.startWithLF(i)){if(t+=`
`,i.piece.length===1)DE(this,i);else{let n=i.piece,o={line:n.start.line+1,column:0},s=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,o,n.end);i.piece=new jr(n.bufferIndex,o,n.end,a,s),Bc(this,i,-1,-1)}return!0}}return!1}iterate(t,e){if(t===ct)return e(ct);let i=this.iterate(t.left,e);return i&&e(t)&&this.iterate(t.right,e)}getNodeContent(t){if(t===ct)return"";let e=this._buffers[t.piece.bufferIndex],i=t.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),o=this.offsetInBuffer(i.bufferIndex,i.end);return e.buffer.substring(n,o)}getPieceContent(t){let e=this._buffers[t.bufferIndex],i=this.offsetInBuffer(t.bufferIndex,t.start),n=this.offsetInBuffer(t.bufferIndex,t.end);return e.buffer.substring(i,n)}rbInsertRight(t,e){let i=new by(e,1);if(i.left=ct,i.right=ct,i.parent=ct,i.size_left=0,i.lf_left=0,this.root===ct)this.root=i,i.color=0;else if(t.right===ct)t.right=i,i.parent=t;else{let o=TR(t.right);o.left=i,i.parent=o}return oH(this,i),i}rbInsertLeft(t,e){let i=new by(e,1);if(i.left=ct,i.right=ct,i.parent=ct,i.size_left=0,i.lf_left=0,this.root===ct)this.root=i,i.color=0;else if(t.left===ct)t.left=i,i.parent=t;else{let n=tH(t.left);n.right=i,i.parent=n}return oH(this,i),i}getContentOfSubTree(t){let e="";return this.iterate(t,i=>(e+=this.getNodeContent(i),!0)),e}};var vy=class r extends L{_pieceTree;_BOM;_mightContainRTL;_mightContainUnusualLineTerminators;_mightContainNonBasicASCII;_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;constructor(t,e,i,n,o,s,a){super(),this._BOM=e,this._mightContainNonBasicASCII=!s,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._pieceTree=new DR(t,i,a)}equals(t){return!(t instanceof r)||this._BOM!==t._BOM||this.getEOL()!==t.getEOL()?!1:this._pieceTree.equal(t._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(t){return this._pieceTree.createSnapshot(t?this._BOM:"")}getOffsetAt(t,e){return this._pieceTree.getOffsetAt(t,e)}getPositionAt(t){return this._pieceTree.getPositionAt(t)}getRangeAt(t,e){let i=t+e,n=this.getPositionAt(t),o=this.getPositionAt(i);return new F(n.lineNumber,n.column,o.lineNumber,o.column)}getValueInRange(t,e=0){if(t.isEmpty())return"";let i=this._getEndOfLine(e);return this._pieceTree.getValueInRange(t,i)}getValueLengthInRange(t,e=0){if(t.isEmpty())return 0;if(t.startLineNumber===t.endLineNumber)return t.endColumn-t.startColumn;let i=this.getOffsetAt(t.startLineNumber,t.startColumn),n=this.getOffsetAt(t.endLineNumber,t.endColumn),o=0,s=this._getEndOfLine(e),a=this.getEOL();if(s.length!==a.length){let l=s.length-a.length,d=t.endLineNumber-t.startLineNumber;o=l*d}return n-i+o}getCharacterCountInRange(t,e=0){if(this._mightContainNonBasicASCII){let i=0,n=t.startLineNumber,o=t.endLineNumber;for(let s=n;s<=o;s++){let a=this.getLineContent(s),l=s===n?t.startColumn-1:0,d=s===o?t.endColumn-1:a.length;for(let c=l;c<d;c++)ln(a.charCodeAt(c))?(i=i+1,c=c+1):i=i+1}return i+=this._getEndOfLine(e).length*(o-n),i}return this.getValueLengthInRange(t,e)}getNearestChunk(t){return this._pieceTree.getNearestChunk(t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(t){return this._pieceTree.getLineContent(t)}getLineCharCode(t,e){return this._pieceTree.getLineCharCode(t,e)}getCharCode(t){return this._pieceTree.getCharCode(t)}getLineLength(t){return this._pieceTree.getLineLength(t)}getLineMinColumn(t){return 1}getLineMaxColumn(t){return this.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){let e=Rn(this.getLineContent(t));return e===-1?0:e+1}getLineLastNonWhitespaceColumn(t){let e=Ta(this.getLineContent(t));return e===-1?0:e+2}_getEndOfLine(t){switch(t){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(t){this._pieceTree.setEOL(t)}applyEdits(t,e,i){let n=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,s=this._mightContainNonBasicASCII,a=!0,l=[];for(let f=0;f<t.length;f++){let b=t[f];a&&b._isTracked&&(a=!1);let y=b.range;if(b.text){let D=!0;s||(D=!iw(b.text),s=D),!n&&D&&(n=qu(b.text)),!o&&D&&(o=mD(b.text))}let I="",E=0,S=0,w=0;if(b.text){let D;[E,S,w,D]=Es(b.text);let k=this.getEOL(),R=k===`\r
`?2:1;D===0||D===R?I=b.text:I=b.text.replace(/\r\n|\r|\n/g,k)}l[f]={sortIndex:f,identifier:b.identifier||null,range:y,rangeOffset:this.getOffsetAt(y.startLineNumber,y.startColumn),rangeLength:this.getValueLengthInRange(y),text:I,eolCount:E,firstLineLength:S,lastLineLength:w,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}l.sort(r._sortOpsAscending);let d=!1;for(let f=0,b=l.length-1;f<b;f++){let y=l[f].range.getEndPosition(),I=l[f+1].range.getStartPosition();if(I.isBeforeOrEqual(y)){if(I.isBefore(y))throw new Error("Overlapping ranges are not allowed!");d=!0}}a&&(l=this._reduceOperations(l));let c=i||e?r._getInverseEditRanges(l):[],u=[];if(e)for(let f=0;f<l.length;f++){let b=l[f],y=c[f];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let I=y.startLineNumber;I<=y.endLineNumber;I++){let E="";I===y.startLineNumber&&(E=this.getLineContent(b.range.startLineNumber),Rn(E)!==-1)||u.push({lineNumber:I,oldContent:E})}}let p=null;if(i){let f=0;p=[];for(let b=0;b<l.length;b++){let y=l[b],I=c[b],E=this.getValueInRange(y.range),S=y.rangeOffset+f;f+=y.text.length-E.length,p[b]={sortIndex:y.sortIndex,identifier:y.identifier,range:I,text:E,textChange:new la(y.rangeOffset,E,S,y.text)}}d||p.sort((b,y)=>b.sortIndex-y.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=s;let m=this._doApplyEdits(l),g=null;if(e&&u.length>0){u.sort((f,b)=>b.lineNumber-f.lineNumber),g=[];for(let f=0,b=u.length;f<b;f++){let y=u[f].lineNumber;if(f>0&&u[f-1].lineNumber===y)continue;let I=u[f].oldContent,E=this.getLineContent(y);E.length===0||E===I||Rn(E)!==-1||g.push(y)}}return this._onDidChangeContent.fire(),new tR(p,m,g)}_reduceOperations(t){return t.length<1e3?t:[this._toSingleEditOperation(t)]}_toSingleEditOperation(t){let e=!1,i=t[0].range,n=t[t.length-1].range,o=new F(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn),s=i.startLineNumber,a=i.startColumn,l=[];for(let m=0,g=t.length;m<g;m++){let f=t[m],b=f.range;e=e||f.forceMoveMarkers,l.push(this.getValueInRange(new F(s,a,b.startLineNumber,b.startColumn))),f.text.length>0&&l.push(f.text),s=b.endLineNumber,a=b.endColumn}let d=l.join(""),[c,u,p]=Es(d);return{sortIndex:0,identifier:t[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:d,eolCount:c,firstLineLength:u,lastLineLength:p,forceMoveMarkers:e,isAutoWhitespaceEdit:!1}}_doApplyEdits(t){t.sort(r._sortOpsDescending);let e=[];for(let i=0;i<t.length;i++){let n=t[i],o=n.range.startLineNumber,s=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(o===a&&s===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);let d=new F(o,s,a,l);e.push({range:d,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return e}findMatchesLineByLine(t,e,i,n){return this._pieceTree.findMatchesLineByLine(t,e,i,n)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(t,e){let i=t.startLineNumber,n=t.startColumn,[o,s,a]=Es(e),l;if(e.length>0){let d=o+1;d===1?l=new F(i,n,i,n+s):l=new F(i,n,i+d-1,a+1)}else l=new F(i,n,i,n);return l}static _getInverseEditRanges(t){let e=[],i=0,n=0,o=null;for(let s=0,a=t.length;s<a;s++){let l=t[s],d,c;o?o.range.endLineNumber===l.range.startLineNumber?(d=i,c=n+(l.range.startColumn-o.range.endColumn)):(d=i+(l.range.startLineNumber-o.range.endLineNumber),c=l.range.startColumn):(d=l.range.startLineNumber,c=l.range.startColumn);let u;if(l.text.length>0){let p=l.eolCount+1;p===1?u=new F(d,c,d,c+l.firstLineLength):u=new F(d,c,d+p-1,l.lastLineLength+1)}else u=new F(d,c,d,c);i=u.endLineNumber,n=u.endColumn,e.push(u),o=l}return e}static _sortOpsAscending(t,e){let i=F.compareRangesUsingEnds(t.range,e.range);return i===0?t.sortIndex-e.sortIndex:i}static _sortOpsDescending(t,e){let i=F.compareRangesUsingEnds(t.range,e.range);return i===0?e.sortIndex-t.sortIndex:-i}};var dH=class{constructor(t,e,i,n,o,s,a,l,d){this._chunks=t;this._bom=e;this._cr=i;this._lf=n;this._crlf=o;this._containsRTL=s;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=d}_getEOL(t){let e=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return e===0?t===1?`
`:`\r
`:i>e/2?`\r
`:`
`}create(t){let e=this._getEOL(t),i=this._chunks;if(this._normalizeEOL&&(e===`\r
`&&(this._cr>0||this._lf>0)||e===`
`&&(this._cr>0||this._crlf>0)))for(let o=0,s=i.length;o<s;o++){let a=i[o].buffer.replace(/\r\n|\r|\n/g,e),l=Vc(a);i[o]=new Wc(a,l)}let n=new vy(i,this._bom,e,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}getFirstLineText(t){return this._chunks[0].buffer.substr(0,t).split(/\r\n|\r|\n/)[0]}},yy=class{chunks;BOM;_hasPreviousChar;_previousChar;_tmpLineStarts;cr;lf;crlf;containsRTL;containsUnusualLineTerminators;isBasicASCII;constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(t){if(t.length===0)return;this.chunks.length===0&&tG(t)&&(this.BOM=eG,t=t.substr(1));let e=t.charCodeAt(t.length-1);e===13||e>=55296&&e<=56319?(this._acceptChunk1(t.substr(0,t.length-1),!1),this._hasPreviousChar=!0,this._previousChar=e):(this._acceptChunk1(t,!1),this._hasPreviousChar=!1,this._previousChar=e)}_acceptChunk1(t,e){!e&&t.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+t):this._acceptChunk2(t))}_acceptChunk2(t){let e=$Y(this._tmpLineStarts,t);this.chunks.push(new Wc(t,e.lineStarts)),this.cr+=e.cr,this.lf+=e.lf,this.crlf+=e.crlf,e.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=qu(t)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=mD(t)))}finish(t=!0){return this._finish(),new dH(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,t)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let t=this.chunks[this.chunks.length-1];t.buffer+=String.fromCharCode(this._previousChar);let e=Vc(t.buffer);t.lineStarts=e,this._previousChar===13&&this.cr++}}};var YY=new class{clone(){return this}equals(r){return this===r}};function cH(r,t){let e=new Uint32Array(2);return e[0]=0,e[1]=(r<<0|0|0|32768|2<<24)>>>0,new _k(e,t===null?YY:t)}var LR=class{constructor(t){this._default=t}_store=[];get(t){return t<this._store.length?this._store[t]:this._default}set(t,e){for(;t>=this._store.length;)this._store[this._store.length]=this._default;this._store[t]=e}replace(t,e,i){if(t>=this._store.length)return;if(e===0){this.insert(t,i);return}else if(i===0){this.delete(t,e);return}let n=this._store.slice(0,t),o=this._store.slice(t+e),s=Hse(i,this._default);this._store=n.concat(s,o)}delete(t,e){e===0||t>=this._store.length||this._store.splice(t,e)}insert(t,e){if(e===0||t>=this._store.length)return;let i=[];for(let n=0;n<e;n++)i[n]=this._default;this._store=pc(this._store,t,i)}};function Hse(r,t){let e=[];for(let i=0;i<r;i++)e[i]=t;return e}var Qg=class{static deserialize(t){let e=0,i=Wo(t,e);e+=4;let n=[];for(let o=0;o<i;o++)e=oE.deserialize(t,e,n);return n}_tokens;constructor(){this._tokens=[]}add(t,e){if(this._tokens.length>0){let i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===t){i.appendLineTokens(e);return}}this._tokens.push(new oE(t,[e]))}finalize(){return this._tokens}serialize(){let t=this._serializeSize(),e=new Uint8Array(t);return this._serialize(e),e}_serializeSize(){let t=0;t+=4;for(let e=0;e<this._tokens.length;e++)t+=this._tokens[e].serializeSize();return t}_serialize(t){let e=0;Uo(t,this._tokens.length,e),e+=4;for(let i=0;i<this._tokens.length;i++)e=this._tokens[i].serialize(t,e)}};var uH=class{constructor(t,e){this.tokenizationSupport=e;this.store=new Cy(t)}initialState=this.tokenizationSupport.getInitialState();store;getStartState(t){return this.store.getStartState(t,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}},kR=class extends uH{constructor(e,i,n,o){super(e,i);this._textModel=n;this._languageIdCodec=o}updateTokensUntilLine(e,i){let n=this._textModel.getLanguageId();for(;;){let o=this.getFirstInvalidLine();if(!o||o.lineNumber>i)break;let s=this._textModel.getLineContent(o.lineNumber),a=Iy(this._languageIdCodec,n,this.tokenizationSupport,s,!0,o.startState);e.add(o.lineNumber,a.tokens),this.store.setEndState(o.lineNumber,a.endState)}}getTokenTypeIfInsertingCharacter(e,i){let n=this.getStartState(e.lineNumber);if(!n)return 0;let o=this._textModel.getLanguageId(),s=this._textModel.getLineContent(e.lineNumber),a=s.substring(0,e.column-1)+i+s.substring(e.column-1),l=Iy(this._languageIdCodec,o,this.tokenizationSupport,a,!0,n),d=new Mn(l.tokens,a,this._languageIdCodec);if(d.getCount()===0)return 0;let c=d.findTokenIndexAtOffset(e.column-1);return d.getStandardTokenType(c)}tokenizeLineWithEdit(e,i){let n=this.getStartState(e);if(!n)return{mainLineTokens:null,additionalLines:null};let o=this._textModel.getLineContent(e),s=i.lineEdit.apply(o),a=this._textModel.getLanguageIdAtPosition(e,0),l=Iy(this._languageIdCodec,a,this.tokenizationSupport,s,!0,n),d=null;if(i.additionalLines){d=[];let u=l.endState;for(let p of i.additionalLines){let m=Iy(this._languageIdCodec,a,this.tokenizationSupport,p,!0,u);d.push(new Mn(m.tokens,p,this._languageIdCodec)),u=m.endState}}return{mainLineTokens:new Mn(l.tokens,s,this._languageIdCodec),additionalLines:d}}hasAccurateTokensForLine(e){let i=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<i}isCheapToTokenize(e){let i=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<i||e===i&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,i,n){if(n<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,n),{heuristicTokens:!1};let o=this.guessStartState(i),s=this._textModel.getLanguageId();for(let a=i;a<=n;a++){let l=this._textModel.getLineContent(a),d=Iy(this._languageIdCodec,s,this.tokenizationSupport,l,!0,o);e.add(a,d.tokens),o=d.endState}return{heuristicTokens:!0}}guessStartState(e){let i=this._textModel.getLineFirstNonWhitespaceColumn(e),n=[],o=null;for(let l=e-1;i>1&&l>=1;l--){let d=this._textModel.getLineFirstNonWhitespaceColumn(l);if(d!==0&&d<i&&(n.push(this._textModel.getLineContent(l)),i=d,o=this.getStartState(l),o))break}o||(o=this.tokenizationSupport.getInitialState()),n.reverse();let s=this._textModel.getLanguageId(),a=o;for(let l of n)a=Iy(this._languageIdCodec,s,this.tokenizationSupport,l,!1,a).endState;return a}},Cy=class{constructor(t){this.lineCount=t;this._invalidEndStatesLineNumbers.addRange(new Xe(1,t+1))}_tokenizationStateStore=new pH;_invalidEndStatesLineNumbers=new hH;getEndState(t){return this._tokenizationStateStore.getEndState(t)}setEndState(t,e){if(!e)throw new yt("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(t);let i=this._tokenizationStateStore.setEndState(t,e);return i&&t<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Xe(t+1,t+2)),i}acceptChange(t,e){this.lineCount+=e-t.length,this._tokenizationStateStore.acceptChange(t,e),this._invalidEndStatesLineNumbers.addRangeAndResize(new Xe(t.startLineNumber,t.endLineNumberExclusive),e)}acceptChanges(t){for(let e of t){let[i]=Es(e.text);this.acceptChange(new Ye(e.range.startLineNumber,e.range.endLineNumber+1),i+1)}}invalidateEndStateRange(t){this._invalidEndStatesLineNumbers.addRange(new Xe(t.startLineNumber,t.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(t,e){return t===1?e:this.getEndState(t-1)}getFirstInvalidLine(t){let e=this.getFirstInvalidEndStateLineNumber();if(e===null)return null;let i=this.getStartState(e,t);if(!i)throw new yt("Start state must be defined");return{lineNumber:e,startState:i}}},pH=class{_lineEndStates=new LR(null);getEndState(t){return this._lineEndStates.get(t)}setEndState(t,e){let i=this._lineEndStates.get(t);return i&&i.equals(e)?!1:(this._lineEndStates.set(t,e),!0)}acceptChange(t,e){let i=t.length;e>0&&i>0&&(i--,e--),this._lineEndStates.replace(t.startLineNumber,i,e)}acceptChanges(t){for(let e of t){let[i]=Es(e.text);this.acceptChange(new Ye(e.range.startLineNumber,e.range.endLineNumber+1),i+1)}}},hH=class{_ranges=[];getRanges(){return this._ranges}get min(){return this._ranges.length===0?null:this._ranges[0].start}removeMin(){if(this._ranges.length===0)return null;let t=this._ranges[0];return t.start+1===t.endExclusive?this._ranges.shift():this._ranges[0]=new Xe(t.start+1,t.endExclusive),t.start}delete(t){let e=this._ranges.findIndex(i=>i.contains(t));if(e!==-1){let i=this._ranges[e];i.start===t?i.endExclusive===t+1?this._ranges.splice(e,1):this._ranges[e]=new Xe(t+1,i.endExclusive):i.endExclusive===t+1?this._ranges[e]=new Xe(i.start,t):this._ranges.splice(e,1,new Xe(i.start,t),new Xe(t+1,i.endExclusive))}}addRange(t){Xe.addRange(t,this._ranges)}addRangeAndResize(t,e){let i=0;for(;!(i>=this._ranges.length||t.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||t.endExclusive<this._ranges[n].start);)n++;let o=e-t.length;for(let s=n;s<this._ranges.length;s++)this._ranges[s]=this._ranges[s].delta(o);if(i===n){let s=new Xe(t.start,t.start+e);s.isEmpty||this._ranges.splice(i,0,s)}else{let s=Math.min(t.start,this._ranges[i].start),a=Math.max(t.endExclusive,this._ranges[n-1].endExclusive),l=new Xe(s,a+o);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(t=>t.toString()).join(" + ")}};function Iy(r,t,e,i,n,o){let s=null;if(e)try{s=e.tokenizeEncoded(i,n,o.clone())}catch(a){Ke(a)}return s||(s=cH(r.encodeLanguageId(t),o)),Mn.convertToEndOffset(s.tokens,i.length),s}var RR=class{constructor(t,e){this._tokenizerWithStateStore=t;this._backgroundTokenStore=e}_isDisposed=!1;dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_isScheduled=!1;_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,wh(t=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(t)}))}_backgroundTokenizeWithDeadline(t){let e=Date.now()+t.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<e?P_(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){let t=this._tokenizerWithStateStore._textModel.getLineCount(),e=new Qg,i=ll.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(e)>=t)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(e.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(t){let e=this._tokenizerWithStateStore?.getFirstInvalidLine();return e?(this._tokenizerWithStateStore.updateTokensUntilLine(t,e.lineNumber),e.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(t,e){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Ye(t,e))}};var AR=class{_onDidChangeVisibleRanges=new T;onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event;_views=new Set;attachView(){let t=new mH(e=>{this._onDidChangeVisibleRanges.fire({view:t,state:e})});return this._views.add(t),t}detachView(t){this._views.delete(t),this._onDidChangeVisibleRanges.fire({view:t,state:void 0})}},mH=class{constructor(t){this.handleStateChange=t}setVisibleLines(t,e){let i=t.map(n=>new Ye(n.startLineNumber,n.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:e})}},PR=class extends L{constructor(e){super();this._refreshTokens=e}runner=this._register(new Et(()=>this.update(),50));_computedLineRanges=[];_lineRanges=[];get lineRanges(){return this._lineRanges}update(){ti(this._computedLineRanges,this._lineRanges,(e,i)=>e.equals(i))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}},Sy=class extends L{constructor(e,i,n){super();this._languageIdCodec=e;this._textModel=i;this.getLanguageId=n}_backgroundTokenizationState=1;get backgroundTokenizationState(){return this._backgroundTokenizationState}_onDidChangeBackgroundTokenizationState=this._register(new T);onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;_onDidChangeTokens=this._register(new T);onDidChangeTokens=this._onDidChangeTokens.event;tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}};var ZY=$("treeSitterParserService");var LE=class extends Sy{constructor(e,i,n,o){super(i,n,o);this._treeSitterService=e;this._initialize()}_tokenizationSupport=null;_lastLanguageId;_initialize(){let e=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==e)&&(this._lastLanguageId=e,this._tokenizationSupport=aE.get(e))}getLineTokens(e){let i=this._textModel.getLineContent(e);if(this._tokenizationSupport){let n=this._tokenizationSupport.tokenizeEncoded(e,this._textModel);if(n)return new Mn(n,i,this._languageIdCodec)}return Mn.createEmpty(i,this._languageIdCodec)}resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(e){e.isFlush&&this.resetTokenization(!1)}forceTokenization(e){}hasAccurateTokensForLine(e){return!0}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,i,n){return 0}tokenizeLineWithEdit(e,i){return{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}};var kE=class r{_lineTokens;_len;_languageIdCodec;constructor(t){this._lineTokens=[],this._len=0,this._languageIdCodec=t}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(t,e,i){let n=null;if(e<this._len&&(n=this._lineTokens[e]),n!==null&&n!==Oc)return new Mn(Nc(n),i,this._languageIdCodec);let o=new Uint32Array(2);return o[0]=i.length,o[1]=XY(this._languageIdCodec.encodeLanguageId(t)),new Mn(o,i,this._languageIdCodec)}static _massageTokens(t,e,i){let n=i?Nc(i):null;if(e===0){let o=!1;if(n&&n.length>1&&(o=da.getLanguageId(n[1])!==t),!o)return Oc}if(!n||n.length===0){let o=new Uint32Array(2);return o[0]=e,o[1]=XY(t),o.buffer}return n[n.length-2]=e,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(t){for(;t>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(t,e){e!==0&&(t+e>this._len&&(e=this._len-t),this._lineTokens.splice(t,e),this._len-=e)}_insertLines(t,e){if(e===0)return;let i=[];for(let n=0;n<e;n++)i[n]=null;this._lineTokens=pc(this._lineTokens,t,i),this._len+=e}setTokens(t,e,i,n,o){let s=r._massageTokens(this._languageIdCodec.encodeLanguageId(t),i,n);this._ensureLine(e);let a=this._lineTokens[e];return this._lineTokens[e]=s,o?!r._equals(a,s):!1}static _equals(t,e){if(!t||!e)return!t&&!e;let i=Nc(t),n=Nc(e);if(i.length!==n.length)return!1;for(let o=0,s=i.length;o<s;o++)if(i[o]!==n[o])return!1;return!0}acceptEdit(t,e,i){this._acceptDeleteRange(t),this._acceptInsertText(new U(t.startLineNumber,t.startColumn),e,i)}_acceptDeleteRange(t){let e=t.startLineNumber-1;if(e>=this._len)return;if(t.startLineNumber===t.endLineNumber){if(t.startColumn===t.endColumn)return;this._lineTokens[e]=Ko.delete(this._lineTokens[e],t.startColumn-1,t.endColumn-1);return}this._lineTokens[e]=Ko.deleteEnding(this._lineTokens[e],t.startColumn-1);let i=t.endLineNumber-1,n=null;i<this._len&&(n=Ko.deleteBeginning(this._lineTokens[i],t.endColumn-1)),this._lineTokens[e]=Ko.append(this._lineTokens[e],n),this._deleteLines(t.startLineNumber,t.endLineNumber-t.startLineNumber)}_acceptInsertText(t,e,i){if(e===0&&i===0)return;let n=t.lineNumber-1;if(!(n>=this._len)){if(e===0){this._lineTokens[n]=Ko.insert(this._lineTokens[n],t.column-1,i);return}this._lineTokens[n]=Ko.deleteEnding(this._lineTokens[n],t.column-1),this._lineTokens[n]=Ko.insert(this._lineTokens[n],t.column-1,i),this._insertLines(t.lineNumber,e)}}setMultilineTokens(t,e){if(t.length===0)return{changes:[]};let i=[];for(let n=0,o=t.length;n<o;n++){let s=t[n],a=0,l=0,d=!1;for(let c=s.startLineNumber;c<=s.endLineNumber;c++)d?(this.setTokens(e.getLanguageId(),c-1,e.getLineLength(c),s.getLineTokens(c),!1),l=c):this.setTokens(e.getLanguageId(),c-1,e.getLineLength(c),s.getLineTokens(c),!0)&&(d=!0,a=c,l=c);d&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}};function XY(r){return(r<<0|0|0|32768|2<<24|1024)>>>0}var MR=class r{_pieces;_isComplete;_languageIdCodec;constructor(t){this._pieces=[],this._isComplete=!1,this._languageIdCodec=t}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(t,e){this._pieces=t||[],this._isComplete=e}setPartial(t,e){let i=t;if(e.length>0){let o=e[0].getRange(),s=e[e.length-1].getRange();if(!o||!s)return t;i=t.plusRange(o).plusRange(s)}let n=null;for(let o=0,s=this._pieces.length;o<s;o++){let a=this._pieces[o];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(o,1),o--,s--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};continue}let[l,d]=a.split(i);if(l.isEmpty()){n=n||{index:o};continue}d.isEmpty()||(this._pieces.splice(o,1,l,d),o++,s++,n=n||{index:o})}return n=n||{index:this._pieces.length},e.length>0&&(this._pieces=pc(this._pieces,n.index,e)),i}isComplete(){return this._isComplete}addSparseTokens(t,e){if(e.getLineContent().length===0)return e;let i=this._pieces;if(i.length===0)return e;let n=r._findFirstPieceWithLine(i,t),o=i[n].getLineTokens(t);if(!o)return e;let s=e.getCount(),a=o.getCount(),l=0,d=[],c=0,u=0,p=(m,g)=>{m!==u&&(u=m,d[c++]=m,d[c++]=g)};for(let m=0;m<a;m++){let g=o.getStartCharacter(m),f=o.getEndCharacter(m),b=o.getMetadata(m),y=((b&1?2048:0)|(b&2?4096:0)|(b&4?8192:0)|(b&8?16384:0)|(b&16?16744448:0)|(b&32?4278190080:0))>>>0,I=~y>>>0;for(;l<s&&e.getEndOffset(l)<=g;)p(e.getEndOffset(l),e.getMetadata(l)),l++;for(l<s&&e.getStartOffset(l)<g&&p(g,e.getMetadata(l));l<s&&e.getEndOffset(l)<f;)p(e.getEndOffset(l),e.getMetadata(l)&I|b&y),l++;if(l<s)p(f,e.getMetadata(l)&I|b&y),e.getEndOffset(l)===f&&l++;else{let E=Math.min(Math.max(0,l-1),s-1);p(f,e.getMetadata(E)&I|b&y)}}for(;l<s;)p(e.getEndOffset(l),e.getMetadata(l)),l++;return new Mn(new Uint32Array(d),e.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(t,e){let i=0,n=t.length-1;for(;i<n;){let o=i+Math.floor((n-i)/2);if(t[o].endLineNumber<e)i=o+1;else if(t[o].startLineNumber>e)n=o-1;else{for(;o>i&&t[o-1].startLineNumber<=e&&e<=t[o-1].endLineNumber;)o--;return o}}return i}acceptEdit(t,e,i,n,o){for(let s of this._pieces)s.acceptEdit(t,e,i,n,o)}};var wp=class extends my{constructor(e,i,n,o,s,a,l){super();this._textModel=e;this._bracketPairsTextModelPart=i;this._languageId=n;this._attachedViews=o;this._languageService=s;this._languageConfigurationService=a;this._treeSitterService=l;this._register(this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(O.filter(aE.onDidChange,d=>d.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}_semanticTokens=new MR(this._languageService.languageIdCodec);_onDidChangeLanguage=this._register(new T);onDidChangeLanguage=this._onDidChangeLanguage.event;_onDidChangeLanguageConfiguration=this._register(new T);onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event;_onDidChangeTokens=this._register(new T);onDidChangeTokens=this._onDidChangeTokens.event;_tokens;_tokensDisposables=this._register(new W);createGrammarTokens(){return this._register(new OR(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new LE(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(e){let i=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=e?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(n=>{this._emitModelTokensChangedEvent(n)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(n=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),i&&this._tokens.resetTokenization()}createPreferredTokenProvider(){aE.get(this._languageId)?this._tokens instanceof LE||this.createTokens(!0):this._tokens instanceof OR||this.createTokens(!1)}_hasListeners(){return this._onDidChangeLanguage.hasListeners()||this._onDidChangeLanguageConfiguration.hasListeners()||this._onDidChangeTokens.hasListeners()}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(let i of e.changes){let[n,o,s]=Es(i.text);this._semanticTokens.acceptEdit(i.range,n,o,s,i.text.length>0?i.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(e)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);let i=this._tokens.getLineTokens(e);return this._semanticTokens.addSparseTokens(e,i)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new yt("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this._tokens.forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this._tokens.hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this._tokens.isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this._tokens.tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,i,n){return this._tokens.getTokenTypeIfInsertingCharacter(e,i,n)}tokenizeLineWithEdit(e,i){return this._tokens.tokenizeLineWithEdit(e,i)}setSemanticTokens(e,i){this._semanticTokens.set(e,i),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,i){if(this.hasCompleteSemanticTokens())return;let n=this._textModel.validateRange(this._semanticTokens.setPartial(e,i));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:n.startLineNumber,toLineNumber:n.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();let i=this._textModel.validatePosition(e),n=this._textModel.getLineContent(i.lineNumber),o=this.getLineTokens(i.lineNumber),s=o.findTokenIndexAtOffset(i.column-1),[a,l]=wp._findLanguageBoundaries(o,s),d=Qw(i.column,this.getLanguageConfiguration(o.getLanguageId(s)).getWordDefinition(),n.substring(a,l),a);if(d&&d.startColumn<=e.column&&e.column<=d.endColumn)return d;if(s>0&&a===i.column-1){let[c,u]=wp._findLanguageBoundaries(o,s-1),p=Qw(i.column,this.getLanguageConfiguration(o.getLanguageId(s-1)).getWordDefinition(),n.substring(c,u),c);if(p&&p.startColumn<=e.column&&e.column<=p.endColumn)return p}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,i){let n=e.getLanguageId(i),o=0;for(let a=i;a>=0&&e.getLanguageId(a)===n;a--)o=e.getStartOffset(a);let s=e.getLineContent().length;for(let a=i,l=e.getCount();a<l&&e.getLanguageId(a)===n;a++)s=e.getEndOffset(a);return[o,s]}getWordUntilPosition(e){let i=this.getWordAtPosition(e);return i?{word:i.word.substr(0,e.column-i.startColumn),startColumn:i.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,i){let n=this._textModel.validatePosition(new U(e,i)),o=this.getLineTokens(n.lineNumber);return o.getLanguageId(o.findTokenIndexAtOffset(n.column-1))}setLanguageId(e,i="api"){if(this._languageId===e)return;let n={oldLanguage:this._languageId,newLanguage:e,source:i};this._languageId=e,this._bracketPairsTextModelPart.handleDidChangeLanguage(n),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(n),this._onDidChangeLanguageConfiguration.fire({})}};wp=_([v(4,Hn),v(5,fp),v(6,ZY)],wp);var OR=class extends Sy{_tokenizer=null;_defaultBackgroundTokenizer=null;_backgroundTokenizer=this._register(new mt);_tokens=new kE(this._languageIdCodec);_debugBackgroundTokens;_debugBackgroundStates;_debugBackgroundTokenizer=this._register(new mt);_attachedViewStates=this._register(new Bo);constructor(t,e,i,n){super(t,e,i),this._register(ca.onDidChange(o=>{let s=this.getLanguageId();o.changedLanguages.indexOf(s)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:o,state:s})=>{if(s){let a=this._attachedViewStates.get(o);a||(a=new PR(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(o,a)),a.handleStateChange(s)}else this._attachedViewStates.deleteAndDispose(o)}))}resetTokenization(t=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new Cy(this._textModel.getLineCount())),t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});let e=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];let o=ca.get(this.getLanguageId());if(!o)return[null,null];let s;try{s=o.getInitialState()}catch(a){return Ke(a),[null,null]}return[o,s]},[i,n]=e();if(i&&n?this._tokenizer=new kR(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){let o={setTokens:s=>{this.setTokens(s)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;let s=2;this._backgroundTokenizationState=s,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(s,a)=>{if(!this._tokenizer)return;let l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&s>=l&&this._tokenizer?.store.setEndState(s,a)}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,o)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new RR(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),i?.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new kE(this._languageIdCodec),this._debugBackgroundStates=new Cy(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:s=>{this._debugBackgroundTokens?.setMultilineTokens(s,this._textModel)},backgroundTokenizationFinished(){},setEndState:(s,a)=>{this._debugBackgroundStates?.setEndState(s,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(t){if(t.isFlush)this.resetTokenization(!1);else if(!t.isEolChange){for(let e of t.changes){let[i,n]=Es(e.text);this._tokens.acceptEdit(e.range,i,n),this._debugBackgroundTokens?.acceptEdit(e.range,i,n)}this._debugBackgroundStates?.acceptChanges(t.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(t.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(t){let{changes:e}=this._tokens.setMultilineTokens(t,this._textModel);return e.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:e}),{changes:e}}refreshAllVisibleLineTokens(){let t=Ye.joinMany([...this._attachedViewStates].map(([e,i])=>i.lineRanges));this.refreshRanges(t)}refreshRanges(t){for(let e of t)this.refreshRange(e.startLineNumber,e.endLineNumberExclusive-1)}refreshRange(t,e){if(!this._tokenizer)return;t=Math.max(1,Math.min(this._textModel.getLineCount(),t)),e=Math.min(this._textModel.getLineCount(),e);let i=new Qg,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,t,e),o=this.setTokens(i.finalize());if(n)for(let s of o.changes)this._backgroundTokenizer.value?.requestTokens(s.fromLineNumber,s.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(t){let e=new Qg;this._tokenizer?.updateTokensUntilLine(e,t),this.setTokens(e.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(t){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(t):!0}isCheapToTokenize(t){return this._tokenizer?this._tokenizer.isCheapToTokenize(t):!0}getLineTokens(t){let e=this._textModel.getLineContent(t),i=this._tokens.getTokens(this._textModel.getLanguageId(),t-1,e);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>t&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>t){let n=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),t-1,e);!i.equals(n)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(t)}return i}getTokenTypeIfInsertingCharacter(t,e,i){if(!this._tokenizer)return 0;let n=this._textModel.validatePosition(new U(t,e));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLineWithEdit(t,e){return this._tokenizer?(this.forceTokenization(t),this._tokenizer.tokenizeLineWithEdit(t,e)):{mainLineTokens:null,additionalLines:null}}get hasTokens(){return this._tokens.hasTokens}};function SH(r){let t=new yy;return t.acceptChunk(r),t.finish()}function tZ(r){return new Promise((t,e)=>{let i=new yy,n=!1;xg(r,{onData:o=>{i.acceptChunk(typeof o=="string"?o:o.toString())},onError:o=>{n||(n=!0,e(o))},onEnd:()=>{n||(n=!0,t(i.finish()))}})})}function zse(r){let t=new yy,e;for(;typeof(e=r.read())=="string";)t.acceptChunk(e);return t.finish()}function QY(r,t){let e;return typeof r=="string"?e=SH(r):$$(r)?e=zse(r):e=r,e.create(t)}var NR=0,Kse=999,Gse=1e4,fH=class{_source;_eos;constructor(t){this._source=t,this._eos=!1}read(){if(this._eos)return null;let t=[],e=0,i=0;do{let n=this._source.read();if(n===null)return this._eos=!0,e===0?null:t.join("");if(n.length>0&&(t[e++]=n,i+=n.length),i>=64*1024)return t.join("")}while(!0)}},RE=()=>{throw new Error("Invalid change accessor")};var Hc=class extends L{constructor(e,i,n,o=null,s,a,l,d){super();this._undoRedoService=s;this._languageService=a;this._languageConfigurationService=l;this.instantiationService=d;NR++,this.id="$model"+NR,this.isForSimpleWidget=n.isForSimpleWidget,typeof o>"u"||o===null?this._associatedResource=q.parse("inmemory://model/"+NR):this._associatedResource=o,this._attachedEditorCount=0;let{textBuffer:c,disposable:u}=QY(e,n.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=Hc.resolveOptions(this._buffer,n);let p=typeof i=="string"?i:i.languageId;typeof i!="string"&&(this._languageSelectionListener.value=i.onDidChange(()=>this._setLanguage(i.languageId))),this._bracketPairs=this._register(new lR(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new wR(this,this._languageConfigurationService)),this._decorationProvider=this._register(new yR(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(wp,this,this._bracketPairs,p,this._attachedViews);let m=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new F(1,1,m,this._buffer.getLineLength(m)+1),0);n.largeFileOptimizations?(this._isTooLargeForTokenization=g>Hc.LARGE_FILE_SIZE_THRESHOLD||m>Hc.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>Hc.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=g>Hc._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=gD(NR),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new BR,this._commandManager=new SR(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(p),this._register(this._languageConfigurationService.onDidChange(f=>{this._bracketPairs.handleLanguageConfigurationServiceChange(f),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(f)}))}static _MODEL_SYNC_LIMIT=50*1024*1024;static LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;static LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;static LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;static DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:kc.tabSize,indentSize:kc.indentSize,insertSpaces:kc.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:kc.trimAutoWhitespace,largeFileOptimizations:kc.largeFileOptimizations,bracketPairColorizationOptions:kc.bracketPairColorizationOptions};static resolveOptions(e,i){if(i.detectIndentation){let n=QU(e,i.tabSize,i.insertSpaces);return new ly({tabSize:n.tabSize,indentSize:"tabSize",insertSpaces:n.insertSpaces,trimAutoWhitespace:i.trimAutoWhitespace,defaultEOL:i.defaultEOL,bracketPairColorizationOptions:i.bracketPairColorizationOptions})}return new ly(i)}_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;_onDidChangeDecorations=this._register(new IH(e=>this.handleBeforeFireDecorationsChangedEvent(e)));onDidChangeDecorations=this._onDidChangeDecorations.event;get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}_onDidChangeOptions=this._register(new T);onDidChangeOptions=this._onDidChangeOptions.event;_onDidChangeAttached=this._register(new T);onDidChangeAttached=this._onDidChangeAttached.event;_onDidChangeInjectedText=this._register(new T);_eventEmitter=this._register(new CH);onDidChangeContent(e){return this._eventEmitter.slowEvent(i=>e(i.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return Ln(this._eventEmitter.fastEvent(i=>e(i)),this._onDidChangeInjectedText.event(i=>e(i)))}id;isForSimpleWidget;_associatedResource;_attachedEditorCount;_buffer;_bufferDisposable;_options;_languageSelectionListener=this._register(new mt);_isDisposed;__isDisposing;_isDisposing(){return this.__isDisposing}_versionId;_alternativeVersionId;_initialUndoRedoSnapshot;_isTooLargeForSyncing;_isTooLargeForTokenization;_isTooLargeForHeapOperation;_commandManager;_isUndoing;_isRedoing;_trimAutoWhitespaceLines;_instanceId;_deltaDecorationCallCnt=0;_lastDecorationId;_decorations;_decorationsTree;_decorationProvider;_tokenizationTextModelPart;get tokenization(){return this._tokenizationTextModelPart}_bracketPairs;get bracketPairs(){return this._bracketPairs}_guidesTextModelPart;get guides(){return this._guidesTextModelPart}_attachedViews=new AR;dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;let e=new vy([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=L.None}_hasListeners(){return this._onWillDispose.hasListeners()||this._onDidChangeDecorations.hasListeners()||this._tokenizationTextModelPart._hasListeners()||this._onDidChangeOptions.hasListeners()||this._onDidChangeAttached.hasListeners()||this._onDidChangeInjectedText.hasListeners()||this._eventEmitter.hasListeners()}_assertNotDisposed(){if(this._isDisposed)throw new yt("Model is disposed!")}equalsTextBuffer(e){return this._assertNotDisposed(),this._buffer.equals(e)}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(e,i){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(i),this._bracketPairs.handleDidChangeContent(i),this._eventEmitter.fire(new qh(e,i)))}setValue(e){if(this._assertNotDisposed(),e==null)throw dh();let{textBuffer:i,disposable:n}=QY(e,this._options.defaultEOL);this._setValueFromTextBuffer(i,n)}_createContentChanged2(e,i,n,o,s,a,l,d){return{changes:[{range:e,rangeOffset:i,rangeLength:n,text:o}],eol:this._buffer.getEOL(),isEolChange:d,versionId:this.getVersionId(),isUndoing:s,isRedoing:a,isFlush:l}}_setValueFromTextBuffer(e,i){this._assertNotDisposed();let n=this.getFullModelRange(),o=this.getValueLengthInRange(n),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=i,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new BR,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new $g([new Yk],this._versionId,!1,!1),this._createContentChanged2(new F(1,1,s,a),0,o,this.getValue(),!1,!1,!0,!1))}setEOL(e){this._assertNotDisposed();let i=e===1?`\r
`:`
`;if(this._buffer.getEOL()===i)return;let n=this.getFullModelRange(),o=this.getValueLengthInRange(n),s=this.getLineCount(),a=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(i),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new $g([new Qk],this._versionId,!1,!1),this._createContentChanged2(new F(1,1,s,a),0,o,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){let e=this.getVersionId(),i=this._decorationsTree.collectNodesPostOrder();for(let n=0,o=i.length;n<o;n++){let s=i[n],a=s.range,l=s.cachedAbsoluteStart-s.start,d=this._buffer.getOffsetAt(a.startLineNumber,a.startColumn),c=this._buffer.getOffsetAt(a.endLineNumber,a.endColumn);s.cachedAbsoluteStart=d,s.cachedAbsoluteEnd=c,s.cachedVersionId=e,s.start=d-l,s.end=c-l,yp(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,i=0,n=this._buffer.getLineCount();for(let o=1;o<=n;o++){let s=this._buffer.getLineLength(o);s>=Gse?i+=s:e+=s}return i>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();let i=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,n=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,o=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,s=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,a=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,l=new ly({tabSize:i,indentSize:n,insertSpaces:o,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:a});if(this._options.equals(l))return;let d=this._options.createChangeEvent(l);this._options=l,this._bracketPairs.handleDidChangeOptions(d),this._decorationProvider.handleDidChangeOptions(d),this._onDidChangeOptions.fire(d)}detectIndentation(e,i){this._assertNotDisposed();let n=QU(this._buffer,i,e);this.updateOptions({insertSpaces:n.insertSpaces,tabSize:n.tabSize,indentSize:n.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),nR(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){let i=this.findMatches(SB.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,i.map(n=>({range:n.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();let i=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(i.lineNumber,i.column)}getPositionAt(e){this._assertNotDisposed();let i=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(i)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,i=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new yt("Operation would exceed heap memory limits");let n=this.getFullModelRange(),o=this.getValueInRange(n,e);return i?this._buffer.getBOM()+o:o}createSnapshot(e=!1){return new fH(this._buffer.createSnapshot(e))}getValueLength(e,i=!1){this._assertNotDisposed();let n=this.getFullModelRange(),o=this.getValueLengthInRange(n,e);return i?this._buffer.getBOM().length+o:o}getValueInRange(e,i=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),i)}getValueLengthInRange(e,i=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),i)}getCharacterCountInRange(e,i=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),i)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new yt("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new yt("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new yt("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new yt("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new yt("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new yt("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){let i=this._buffer.getLineCount(),n=e.startLineNumber,o=e.startColumn,s=Math.floor(typeof n=="number"&&!isNaN(n)?n:1),a=Math.floor(typeof o=="number"&&!isNaN(o)?o:1);if(s<1)s=1,a=1;else if(s>i)s=i,a=this.getLineMaxColumn(s);else if(a<=1)a=1;else{let p=this.getLineMaxColumn(s);a>=p&&(a=p)}let l=e.endLineNumber,d=e.endColumn,c=Math.floor(typeof l=="number"&&!isNaN(l)?l:1),u=Math.floor(typeof d=="number"&&!isNaN(d)?d:1);if(c<1)c=1,u=1;else if(c>i)c=i,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{let p=this.getLineMaxColumn(c);u>=p&&(u=p)}return n===s&&o===a&&l===c&&d===u&&e instanceof F&&!(e instanceof It)?e:new F(s,a,c,u)}_isValidPosition(e,i,n){if(typeof e!="number"||typeof i!="number"||isNaN(e)||isNaN(i)||e<1||i<1||(e|0)!==e||(i|0)!==i)return!1;let o=this._buffer.getLineCount();if(e>o)return!1;if(i===1)return!0;let s=this.getLineMaxColumn(e);if(i>s)return!1;if(n===1){let a=this._buffer.getLineCharCode(e,i-2);if(ln(a))return!1}return!0}_validatePosition(e,i,n){let o=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),a=this._buffer.getLineCount();if(o<1)return new U(1,1);if(o>a)return new U(a,this.getLineMaxColumn(a));if(s<=1)return new U(o,1);let l=this.getLineMaxColumn(o);if(s>=l)return new U(o,l);if(n===1){let d=this._buffer.getLineCharCode(o,s-2);if(ln(d))return new U(o,s-1)}return new U(o,s)}validatePosition(e){let i=1;return this._assertNotDisposed(),e instanceof U&&this._isValidPosition(e.lineNumber,e.column,i)?e:this._validatePosition(e.lineNumber,e.column,i)}_isValidRange(e,i){let n=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn;if(!this._isValidPosition(n,o,0)||!this._isValidPosition(s,a,0))return!1;if(i===1){let l=o>1?this._buffer.getLineCharCode(n,o-2):0,d=a>1&&a<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,a-2):0,c=ln(l),u=ln(d);return!c&&!u}return!0}validateRange(e){let i=1;if(this._assertNotDisposed(),e instanceof F&&!(e instanceof It)&&this._isValidRange(e,i))return e;let n=this._validatePosition(e.startLineNumber,e.startColumn,0),o=this._validatePosition(e.endLineNumber,e.endColumn,0),s=n.lineNumber,a=n.column,l=o.lineNumber,d=o.column;if(i===1){let c=a>1?this._buffer.getLineCharCode(s,a-2):0,u=d>1&&d<=this._buffer.getLineLength(l)?this._buffer.getLineCharCode(l,d-2):0,p=ln(c),m=ln(u);return!p&&!m?new F(s,a,l,d):s===l&&a===d?new F(s,a-1,l,d-1):p&&m?new F(s,a-1,l,d+1):p?new F(s,a-1,l,d):new F(s,a,l,d+1)}return new F(s,a,l,d)}modifyPosition(e,i){this._assertNotDisposed();let n=this.getOffsetAt(e)+i;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,n)))}getFullModelRange(){this._assertNotDisposed();let e=this.getLineCount();return new F(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,i,n,o){return this._buffer.findMatchesLineByLine(e,i,n,o)}findMatches(e,i,n,o,s,a,l=Kse){this._assertNotDisposed();let d=null;i!==null&&(Array.isArray(i)||(i=[i]),i.every(p=>F.isIRange(p))&&(d=i.map(p=>this.validateRange(p)))),d===null&&(d=[this.getFullModelRange()]),d=d.sort((p,m)=>p.startLineNumber-m.startLineNumber||p.startColumn-m.startColumn);let c=[];c.push(d.reduce((p,m)=>F.areIntersecting(p,m)?p.plusRange(m):(c.push(p),m)));let u;if(!n&&e.indexOf(`
`)<0){let m=new Cp(e,n,o,s).parseSearchRequest();if(!m)return[];u=g=>this.findMatchesLineByLine(g,m,a,l)}else u=p=>Zg.findMatches(this,new Cp(e,n,o,s),p,a,l);return c.map(u).reduce((p,m)=>p.concat(m),[])}findNextMatch(e,i,n,o,s,a){this._assertNotDisposed();let l=this.validatePosition(i);if(!n&&e.indexOf(`
`)<0){let c=new Cp(e,n,o,s).parseSearchRequest();if(!c)return null;let u=this.getLineCount(),p=new F(l.lineNumber,l.column,u,this.getLineMaxColumn(u)),m=this.findMatchesLineByLine(p,c,a,1);return Zg.findNextMatch(this,new Cp(e,n,o,s),l,a),m.length>0||(p=new F(1,1,l.lineNumber,this.getLineMaxColumn(l.lineNumber)),m=this.findMatchesLineByLine(p,c,a,1),m.length>0)?m[0]:null}return Zg.findNextMatch(this,new Cp(e,n,o,s),l,a)}findPreviousMatch(e,i,n,o,s,a){this._assertNotDisposed();let l=this.validatePosition(i);return Zg.findPreviousMatch(this,new Cp(e,n,o,s),l,a)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof dy?e:new dy(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){let i=[];for(let n=0,o=e.length;n<o;n++)i[n]=this._validateEditOperation(e[n]);return i}pushEditOperations(e,i,n,o){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(i),n,o)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,i,n,o){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let s=i.map(l=>({range:this.validateRange(l.range),text:l.text})),a=!0;if(e)for(let l=0,d=e.length;l<d;l++){let c=e[l],u=!1;for(let p=0,m=s.length;p<m;p++){let g=s[p].range,f=g.startLineNumber>c.endLineNumber,b=c.startLineNumber>g.endLineNumber;if(!f&&!b){u=!0;break}}if(!u){a=!1;break}}if(a)for(let l=0,d=this._trimAutoWhitespaceLines.length;l<d;l++){let c=this._trimAutoWhitespaceLines[l],u=this.getLineMaxColumn(c),p=!0;for(let m=0,g=s.length;m<g;m++){let f=s[m].range,b=s[m].text;if(!(c<f.startLineNumber||c>f.endLineNumber)&&!(c===f.startLineNumber&&f.startColumn===u&&f.isEmpty()&&b&&b.length>0&&b.charAt(0)===`
`)&&!(c===f.startLineNumber&&f.startColumn===1&&f.isEmpty()&&b&&b.length>0&&b.charAt(b.length-1)===`
`)){p=!1;break}}if(p){let m=new F(c,1,c,u);i.push(new dy(null,m,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,i,n,o)}_applyUndo(e,i,n,o){let s=e.map(a=>{let l=this.getPositionAt(a.newPosition),d=this.getPositionAt(a.newEnd);return{range:new F(l.lineNumber,l.column,d.lineNumber,d.column),text:a.oldText}});this._applyUndoRedoEdits(s,i,!0,!1,n,o)}_applyRedo(e,i,n,o){let s=e.map(a=>{let l=this.getPositionAt(a.oldPosition),d=this.getPositionAt(a.oldEnd);return{range:new F(l.lineNumber,l.column,d.lineNumber,d.column),text:a.newText}});this._applyUndoRedoEdits(s,i,!1,!0,n,o)}_applyUndoRedoEdits(e,i,n,o,s,a){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=n,this._isRedoing=o,this.applyEdits(e,!1),this.setEOL(i),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(a),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,i=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();let n=this._validateEditOperations(e);return this._doApplyEdits(n,i)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,i){let n=this._buffer.getLineCount(),o=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,i),s=this._buffer.getLineCount(),a=o.changes;if(this._trimAutoWhitespaceLines=o.trimAutoWhitespaceLineNumbers,a.length!==0){for(let c=0,u=a.length;c<u;c++){let p=a[c];this._decorationsTree.acceptReplace(p.rangeOffset,p.rangeLength,p.text.length,p.forceMoveMarkers)}let l=[];this._increaseVersionId();let d=n;for(let c=0,u=a.length;c<u;c++){let p=a[c],[m]=Es(p.text);this._onDidChangeDecorations.fire();let g=p.range.startLineNumber,f=p.range.endLineNumber,b=f-g,y=m,I=Math.min(b,y),E=y-b,S=s-d-E+g,w=S,D=S+y,k=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new U(w,1)),this.getOffsetAt(new U(D,this.getLineMaxColumn(D))),0),R=xs.fromDecorations(k),A=new Sr(R);for(let H=I;H>=0;H--){let z=g+H,Z=S+H;A.takeFromEndWhile(Ve=>Ve.lineNumber>Z);let fe=A.takeFromEndWhile(Ve=>Ve.lineNumber===Z);l.push(new vE(z,this.getLineContent(Z),fe))}if(I<b){let H=g+I;l.push(new Zk(H+1,f))}if(I<y){let H=new Sr(R),z=g+I,Z=y-I,fe=s-d-Z+z+1,Ve=[],me=[];for(let ce=0;ce<Z;ce++){let xe=fe+ce;me[ce]=this.getLineContent(xe),H.takeWhile(Ie=>Ie.lineNumber<xe),Ve[ce]=H.takeWhile(Ie=>Ie.lineNumber===xe)}l.push(new Xk(z+1,g+y,me,Ve))}d+=E}this._emitContentChangedEvent(new $g(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return o.reverseEdits===null?void 0:o.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;let n=Array.from(e).map(o=>new vE(o,this.getLineContent(o),this._getInjectedTextInLine(o)));this._onDidChangeInjectedText.fire(new ay(n))}changeDecorations(e,i=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(i,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,i){let n={addDecoration:(s,a)=>this._deltaDecorationsImpl(e,[],[{range:s,options:a}])[0],changeDecoration:(s,a)=>{this._changeDecorationImpl(s,a)},changeDecorationOptions:(s,a)=>{this._changeDecorationOptionsImpl(s,eZ(a))},removeDecoration:s=>{this._deltaDecorationsImpl(e,[s],[])},deltaDecorations:(s,a)=>s.length===0&&a.length===0?[]:this._deltaDecorationsImpl(e,s,a)},o=null;try{o=i(n)}catch(s){Ke(s)}return n.addDecoration=RE,n.changeDecoration=RE,n.changeDecorationOptions=RE,n.removeDecoration=RE,n.deltaDecorations=RE,o}deltaDecorations(e,i,n=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&i.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Ke(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(n,e,i)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,i,n){let o=e?this._decorations[e]:null;if(!o)return i?this._deltaDecorationsImpl(0,[],[{range:i,options:JY[n]}],!0)[0]:null;if(!i)return this._decorationsTree.delete(o),delete this._decorations[o.id],null;let s=this._validateRangeRelaxedNoAllocations(i),a=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),l=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(o),o.reset(this.getVersionId(),a,l,s),o.setOptions(JY[n]),this._decorationsTree.insert(o),o.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;let i=this._decorationsTree.collectNodesFromOwner(e);for(let n=0,o=i.length;n<o;n++){let s=i[n];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(e){let i=this._decorations[e];return i?i.options:null}getDecorationRange(e){let i=this._decorations[e];return i?this._decorationsTree.getNodeRange(this,i):null}getLineDecorations(e,i=0,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,i,n)}getLinesDecorations(e,i,n=0,o=!1,s=!1){let a=this.getLineCount(),l=Math.min(a,Math.max(1,e)),d=Math.min(a,Math.max(1,i)),c=this.getLineMaxColumn(d),u=new F(l,1,d,c),p=this._getDecorationsInRange(u,n,o,s);return VS(p,this._decorationProvider.getDecorationsInRange(u,n,o)),p}getDecorationsInRange(e,i=0,n=!1,o=!1,s=!1){let a=this.validateRange(e),l=this._getDecorationsInRange(a,i,n,s);return VS(l,this._decorationProvider.getDecorationsInRange(a,i,n,o)),l}getOverviewRulerDecorations(e=0,i=!1){return this._decorationsTree.getAll(this,e,i,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){let i=this._buffer.getOffsetAt(e,1),n=i+this._buffer.getLineLength(e),o=this._decorationsTree.getInjectedTextInInterval(this,i,n,0);return xs.fromDecorations(o).filter(s=>s.lineNumber===e)}getAllDecorations(e=0,i=!1){let n=this._decorationsTree.getAll(this,e,i,!1,!1);return n=n.concat(this._decorationProvider.getAllDecorations(e,i)),n}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!0)}_getDecorationsInRange(e,i,n,o){let s=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),a=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,s,a,i,n,o)}getRangeAt(e,i){return this._buffer.getRangeAt(e,i-e)}_changeDecorationImpl(e,i){let n=this._decorations[e];if(!n)return;if(n.options.after){let l=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(n.options.before){let l=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}let o=this._validateRangeRelaxedNoAllocations(i),s=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),s,a,o),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber)}_changeDecorationOptionsImpl(e,i){let n=this._decorations[e];if(!n)return;let o=!!(n.options.overviewRuler&&n.options.overviewRuler.color),s=!!(i.overviewRuler&&i.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(i),n.options.after||i.after){let d=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(n.options.before||i.before){let d=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}let a=o!==s,l=jse(i)!==FR(n);a||l?(this._decorationsTree.delete(n),n.setOptions(i),this._decorationsTree.insert(n)):n.setOptions(i)}_deltaDecorationsImpl(e,i,n,o=!1){let s=this.getVersionId(),a=i.length,l=0,d=n.length,c=0;this._onDidChangeDecorations.beginDeferredEmit();try{let u=new Array(d);for(;l<a||c<d;){let p=null;if(l<a){do p=this._decorations[i[l++]];while(!p&&l<a);if(p){if(p.options.after){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.endLineNumber)}if(p.options.before){let m=this._decorationsTree.getNodeRange(this,p);this._onDidChangeDecorations.recordLineAffectedByInjectedText(m.startLineNumber)}this._decorationsTree.delete(p),o||this._onDidChangeDecorations.checkAffectedAndFire(p.options)}}if(c<d){if(!p){let I=++this._lastDecorationId,E=`${this._instanceId};${I}`;p=new EE(E,0,0),this._decorations[E]=p}let m=n[c],g=this._validateRangeRelaxedNoAllocations(m.range),f=eZ(m.options),b=this._buffer.getOffsetAt(g.startLineNumber,g.startColumn),y=this._buffer.getOffsetAt(g.endLineNumber,g.endColumn);p.ownerId=e,p.reset(s,b,y,g),p.setOptions(f),p.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.endLineNumber),p.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.startLineNumber),o||this._onDidChangeDecorations.checkAffectedAndFire(f),this._decorationsTree.insert(p),u[c]=p.id,c++}else p&&delete this._decorations[p.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,i){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,i)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,i)),this._setLanguage(e.languageId,i))}_setLanguage(e,i){this.tokenization.setLanguageId(e,i),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,i){return this.tokenization.getLanguageIdAtPosition(e,i)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,i){return e}getLineIndentColumn(e){return qse(this.getLineContent(e))+1}};Hc=_([v(4,j$),v(5,Hn),v(6,fp),v(7,ae)],Hc);function qse(r){let t=0;for(let e of r)if(e===" "||e==="	")t++;else break;return t}function gH(r){return!!(r.options.overviewRuler&&r.options.overviewRuler.color)}function jse(r){return!!r.after||!!r.before}function FR(r){return!!r.options.after||!!r.options.before}var BR=class{_decorationsTree0;_decorationsTree1;_injectedTextDecorationsTree;constructor(){this._decorationsTree0=new fy,this._decorationsTree1=new fy,this._injectedTextDecorationsTree=new fy}ensureAllNodesHaveRanges(t){this.getAll(t,0,!1,!1,!1)}_ensureNodesHaveRanges(t,e){for(let i of e)i.range===null&&(i.range=t.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return e}getAllInInterval(t,e,i,n,o,s){let a=t.getVersionId(),l=this._intervalSearch(e,i,n,o,a,s);return this._ensureNodesHaveRanges(t,l)}_intervalSearch(t,e,i,n,o,s){let a=this._decorationsTree0.intervalSearch(t,e,i,n,o,s),l=this._decorationsTree1.intervalSearch(t,e,i,n,o,s),d=this._injectedTextDecorationsTree.intervalSearch(t,e,i,n,o,s);return a.concat(l).concat(d)}getInjectedTextInInterval(t,e,i,n){let o=t.getVersionId(),s=this._injectedTextDecorationsTree.intervalSearch(e,i,n,!1,o,!1);return this._ensureNodesHaveRanges(t,s).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(t,e){let i=t.getVersionId(),n=this._injectedTextDecorationsTree.search(e,!1,i,!1);return this._ensureNodesHaveRanges(t,n).filter(o=>o.options.showIfCollapsed||!o.range.isEmpty())}getAll(t,e,i,n,o){let s=t.getVersionId(),a=this._search(e,i,n,s,o);return this._ensureNodesHaveRanges(t,a)}_search(t,e,i,n,o){if(i)return this._decorationsTree1.search(t,e,n,o);{let s=this._decorationsTree0.search(t,e,n,o),a=this._decorationsTree1.search(t,e,n,o),l=this._injectedTextDecorationsTree.search(t,e,n,o);return s.concat(a).concat(l)}}collectNodesFromOwner(t){let e=this._decorationsTree0.collectNodesFromOwner(t),i=this._decorationsTree1.collectNodesFromOwner(t),n=this._injectedTextDecorationsTree.collectNodesFromOwner(t);return e.concat(i).concat(n)}collectNodesPostOrder(){let t=this._decorationsTree0.collectNodesPostOrder(),e=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return t.concat(e).concat(i)}insert(t){FR(t)?this._injectedTextDecorationsTree.insert(t):gH(t)?this._decorationsTree1.insert(t):this._decorationsTree0.insert(t)}delete(t){FR(t)?this._injectedTextDecorationsTree.delete(t):gH(t)?this._decorationsTree1.delete(t):this._decorationsTree0.delete(t)}getNodeRange(t,e){let i=t.getVersionId();return e.cachedVersionId!==i&&this._resolveNode(e,i),e.range===null&&(e.range=t.getRangeAt(e.cachedAbsoluteStart,e.cachedAbsoluteEnd)),e.range}_resolveNode(t,e){FR(t)?this._injectedTextDecorationsTree.resolveNode(t,e):gH(t)?this._decorationsTree1.resolveNode(t,e):this._decorationsTree0.resolveNode(t,e)}acceptReplace(t,e,i,n){this._decorationsTree0.acceptReplace(t,e,i,n),this._decorationsTree1.acceptReplace(t,e,i,n),this._injectedTextDecorationsTree.acceptReplace(t,e,i,n)}};function Uc(r){return r.replace(/[^a-z0-9\-_]/gi," ")}var VR=class{color;darkColor;constructor(t){this.color=t.color||"",this.darkColor=t.darkColor||""}},bH=class extends VR{position;_resolvedColor;constructor(t){super(t),this._resolvedColor=null,this.position=typeof t.position=="number"?t.position:2}getColor(t){return this._resolvedColor||(t.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,t):this._resolvedColor=this._resolveColor(this.color,t)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(t,e){if(typeof t=="string")return t;let i=t?e.getColor(t.id):null;return i?i.toString():""}},vH=class{position;persistLane;constructor(t){this.position=t?.position??2,this.persistLane=t?.persistLane}},yH=class extends VR{position;sectionHeaderStyle;sectionHeaderText;_resolvedColor;constructor(t){super(t),this.position=t.position,this.sectionHeaderStyle=t.sectionHeaderStyle??null,this.sectionHeaderText=t.sectionHeaderText??null}getColor(t){return this._resolvedColor||(t.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,t):this._resolvedColor=this._resolveColor(this.color,t)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(t,e){return typeof t=="string"?Y.fromHex(t):e.getColor(t.id)}},WR=class r{static from(t){return t instanceof r?t:new r(t)}content;tokens;inlineClassName;inlineClassNameAffectsLetterSpacing;attachedData;cursorStops;constructor(t){this.content=t.content||"",this.tokens=t.tokens??null,this.inlineClassName=t.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=t.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=t.attachedData||null,this.cursorStops=t.cursorStops||null}},On=class r{static EMPTY;static register(t){return new r(t)}static createDynamic(t){return new r(t)}description;blockClassName;blockIsAfterEnd;blockDoesNotCollapse;blockPadding;stickiness;zIndex;className;shouldFillLineOnLineBreak;hoverMessage;glyphMarginHoverMessage;isWholeLine;showIfCollapsed;collapseOnReplaceEdit;overviewRuler;minimap;glyphMargin;glyphMarginClassName;linesDecorationsClassName;lineNumberClassName;lineNumberHoverMessage;linesDecorationsTooltip;firstLineDecorationClassName;marginClassName;inlineClassName;inlineClassNameAffectsLetterSpacing;beforeContentClassName;afterContentClassName;after;before;hideInCommentTokens;hideInStringTokens;constructor(t){this.description=t.description,this.blockClassName=t.blockClassName?Uc(t.blockClassName):null,this.blockDoesNotCollapse=t.blockDoesNotCollapse??null,this.blockIsAfterEnd=t.blockIsAfterEnd??null,this.blockPadding=t.blockPadding??null,this.stickiness=t.stickiness||0,this.zIndex=t.zIndex||0,this.className=t.className?Uc(t.className):null,this.shouldFillLineOnLineBreak=t.shouldFillLineOnLineBreak??null,this.hoverMessage=t.hoverMessage||null,this.glyphMarginHoverMessage=t.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=t.lineNumberHoverMessage||null,this.isWholeLine=t.isWholeLine||!1,this.showIfCollapsed=t.showIfCollapsed||!1,this.collapseOnReplaceEdit=t.collapseOnReplaceEdit||!1,this.overviewRuler=t.overviewRuler?new bH(t.overviewRuler):null,this.minimap=t.minimap?new yH(t.minimap):null,this.glyphMargin=t.glyphMarginClassName?new vH(t.glyphMargin):null,this.glyphMarginClassName=t.glyphMarginClassName?Uc(t.glyphMarginClassName):null,this.linesDecorationsClassName=t.linesDecorationsClassName?Uc(t.linesDecorationsClassName):null,this.lineNumberClassName=t.lineNumberClassName?Uc(t.lineNumberClassName):null,this.linesDecorationsTooltip=t.linesDecorationsTooltip?X7(t.linesDecorationsTooltip):null,this.firstLineDecorationClassName=t.firstLineDecorationClassName?Uc(t.firstLineDecorationClassName):null,this.marginClassName=t.marginClassName?Uc(t.marginClassName):null,this.inlineClassName=t.inlineClassName?Uc(t.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=t.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=t.beforeContentClassName?Uc(t.beforeContentClassName):null,this.afterContentClassName=t.afterContentClassName?Uc(t.afterContentClassName):null,this.after=t.after?WR.from(t.after):null,this.before=t.before?WR.from(t.before):null,this.hideInCommentTokens=t.hideInCommentTokens??!1,this.hideInStringTokens=t.hideInStringTokens??!1}};On.EMPTY=On.register({description:"empty"});var JY=[On.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),On.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),On.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),On.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function eZ(r){return r instanceof On?r:On.createDynamic(r)}var IH=class extends L{constructor(e){super();this.handleBeforeFire=e;this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}_actual=this._register(new T);event=this._actual.event;_deferredCnt;_shouldFireDeferred;_affectsMinimap;_affectsOverviewRuler;_affectedInjectedTextLines=null;_affectsGlyphMargin;_affectsLineNumber;hasListeners(){return this._actual.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||=!!e.minimap?.position,this._affectsOverviewRuler||=!!e.overviewRuler?.color,this._affectsGlyphMargin||=!!e.glyphMarginClassName,this._affectsLineNumber||=!!e.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);let e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}},CH=class extends L{_fastEmitter=this._register(new T);fastEvent=this._fastEmitter.event;_slowEmitter=this._register(new T);slowEvent=this._slowEmitter.event;_deferredCnt;_deferredEvent;constructor(){super(),this._deferredCnt=0,this._deferredEvent=null}hasListeners(){return this._fastEmitter.hasListeners()||this._slowEmitter.hasListeners()}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(t=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=t;let e=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}fire(t){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(t):this._deferredEvent=t;return}this._fastEmitter.fire(t),this._slowEmitter.fire(t)}};var Va=$("workingCopyService"),wH=class extends L{_onDidRegister=this._register(new T);onDidRegister=this._onDidRegister.event;_onDidUnregister=this._register(new T);onDidUnregister=this._onDidUnregister.event;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;_onDidSave=this._register(new T);onDidSave=this._onDidSave.event;get workingCopies(){return Array.from(this._workingCopies.values())}_workingCopies=new Set;mapResourceToWorkingCopies=new Ci;mapWorkingCopyToListeners=this._register(new Bo);registerWorkingCopy(t){let e=this.mapResourceToWorkingCopies.get(t.resource);if(e?.has(t.typeId))throw new Error(`Cannot register more than one working copy with the same resource ${t.resource.toString()} and type ${t.typeId}.`);this._workingCopies.add(t),e||(e=new Map,this.mapResourceToWorkingCopies.set(t.resource,e)),e.set(t.typeId,t);let i=new W;return i.add(t.onDidChangeContent(()=>this._onDidChangeContent.fire(t))),i.add(t.onDidChangeDirty(()=>this._onDidChangeDirty.fire(t))),i.add(t.onDidSave(n=>this._onDidSave.fire({workingCopy:t,...n}))),this.mapWorkingCopyToListeners.set(t,i),this._onDidRegister.fire(t),t.isDirty()&&this._onDidChangeDirty.fire(t),te(()=>{this.unregisterWorkingCopy(t),this._onDidUnregister.fire(t)})}unregisterWorkingCopy(t){this._workingCopies.delete(t);let e=this.mapResourceToWorkingCopies.get(t.resource);e?.delete(t.typeId)&&e.size===0&&this.mapResourceToWorkingCopies.delete(t.resource),t.isDirty()&&this._onDidChangeDirty.fire(t),this.mapWorkingCopyToListeners.deleteAndDispose(t)}has(t){return q.isUri(t)?this.mapResourceToWorkingCopies.has(t):this.mapResourceToWorkingCopies.get(t.resource)?.has(t.typeId)??!1}get(t){return this.mapResourceToWorkingCopies.get(t.resource)?.get(t.typeId)}getAll(t){let e=this.mapResourceToWorkingCopies.get(t);if(e)return Array.from(e.values())}get hasDirty(){for(let t of this._workingCopies)if(t.isDirty())return!0;return!1}get dirtyCount(){let t=0;for(let e of this._workingCopies)e.isDirty()&&t++;return t}get dirtyWorkingCopies(){return this.workingCopies.filter(t=>t.isDirty())}get modifiedCount(){let t=0;for(let e of this._workingCopies)e.isModified()&&t++;return t}get modifiedWorkingCopies(){return this.workingCopies.filter(t=>t.isModified())}isDirty(t,e){let i=this.mapResourceToWorkingCopies.get(t);if(i){if(typeof e=="string")return i.get(e)?.isDirty()??!1;for(let[,n]of i)if(n.isDirty())return!0}return!1}};vi(Va,wH,1);var qo=$("labelService");var qt=$("telemetryService"),L8e=$("customEndpointTelemetryService");var iZ="telemetry.telemetryLevel",nZ="telemetry.enableCrashReporter",oZ="telemetry.enableTelemetry";function HR(r,t=rt){return _B(r,t)?r.charAt(0).toUpperCase()+r.slice(1):r}var rZ="\u2026",AE="\\\\",PE="~";function zR(r,t=Gn){let e=new Array(r.length),i=!1;for(let n=0;n<r.length;n++){let o=r[n];if(o===""){e[n]=`.${t}`;continue}if(!o){e[n]=o;continue}i=!0;let s="",a=o;a.indexOf(AE)===0?(s=a.substr(0,a.indexOf(AE)+AE.length),a=a.substr(a.indexOf(AE)+AE.length)):a.indexOf(t)===0?(s=a.substr(0,a.indexOf(t)+t.length),a=a.substr(a.indexOf(t)+t.length)):a.indexOf(PE)===0&&(s=a.substr(0,a.indexOf(PE)+PE.length),a=a.substr(a.indexOf(PE)+PE.length));let l=a.split(t);for(let d=1;i&&d<=l.length;d++)for(let c=l.length-d;i&&c>=0;c--){i=!1;let u=l.slice(c,c+d).join(t);for(let p=0;!i&&p<r.length;p++)if(p!==n&&r[p]&&r[p].indexOf(u)>-1){let m=c+d===l.length,g=c>0&&r[p].indexOf(t)>-1?t+u:u,f=r[p].endsWith(g);i=!m||f}if(!i){let p="";(l[0].endsWith(":")||s!=="")&&(c===1&&(c=0,d++,u=l[0]+t+u),c>0&&(p=l[0]+t),p=s+p),c>0&&(p=p+rZ+t),p=p+u,c+d<l.length&&(p=p+t+rZ),e[n]=p}}i&&(e[n]=o)}return e}function aZ(r,t=Object.create(null)){let e=[],i=!1,n="";for(let o of r)if(o==="$"||i&&o==="{")n&&e.push({value:n,type:0}),n="",i=!0;else if(o==="}"&&i){let s=t[n];if(typeof s=="string")s.length&&e.push({value:s,type:1});else if(s){let a=e[e.length-1];(!a||a.type!==2)&&e.push({value:s.label,type:2})}n="",i=!1}else n+=o;return n&&!i&&e.push({value:n,type:0}),e.filter((o,s)=>{if(o.type===2){let a=e[s-1],l=e[s+1];return[a,l].every(d=>d&&(d.type===1||d.type===0)&&d.value.length>0)}return!0}).map(o=>o.value).join("")}function Ep(r,t){return be||t?r.replace(/\(&&\w\)|&&/g,"").replace(/&/g,be?"&":"&&"):r.replace(/&&|&/g,e=>e==="&"?"&&":"&")}function lZ(r){return r.replace(/&/g,"&&")}function dZ(r){if(r.endsWith("]")){let t=r.lastIndexOf(" [",r.length-2);if(t!==-1){let e=sZ(r.substring(0,t)),i=r.substring(t);return{name:e.name+i,parentPath:e.parentPath}}}return sZ(r)}function sZ(r){let t=r.indexOf("/")!==-1?Ft:hn,e=t.basename(r),i=t.dirname(r);return e.length?{name:e,parentPath:i}:{name:i,parentPath:""}}var Qn=$("productService"),cZ="vscode://schemas/vscode-product";var Ar=$("dialogService");var uZ=$("fileDialogService");var Tp=class extends OE{_onDidChangeDirty=this._register(new T);_onDidChangeLabel=this._register(new T);_onDidChangeCapabilities=this._register(new T);_onWillDispose=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;onDidChangeLabel=this._onDidChangeLabel.event;onDidChangeCapabilities=this._onDidChangeCapabilities.event;onWillDispose=this._onWillDispose.event;closeHandler;get editorId(){}get capabilities(){return 2}hasCapability(t){return t===0?this.capabilities===0:(this.capabilities&t)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(t){}getTitle(t){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(t,e){return this}async saveAs(t,e){return this}async revert(t,e){}async rename(t,e){}copy(){return this}canMove(t,e){return!0}matches(t){if(Do(t))return this===t;let e=t.options?.override;return this.editorId!==e&&e!==void 0&&this.editorId!==void 0?!1:Wn(this.resource,Ui.getCanonicalUri(t))}prefersEditorPane(t){return t.at(0)}toUntyped(t){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};var qn=class extends Tp{constructor(e,i,n,o,s){super();this.preferredName=e;this.preferredDescription=i;this.secondary=n;this.primary=o;this.editorService=s;this.registerListeners()}static ID="workbench.editorinputs.sidebysideEditorInput";get typeId(){return qn.ID}get capabilities(){let e=this.primary.capabilities;return e&=-33,this.secondary.hasCapability(16)&&(e|=16),this.secondary.hasCapability(8)&&(e|=8),e|=256,e}get resource(){if(this.hasIdenticalSides)return this.primary.resource}hasIdenticalSides=this.primary.matches(this.secondary);registerListeners(){this._register(O.once(O.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let e=this.getPreferredName();return e||(this.hasIdenticalSides?this.primary.getName():h("sideBySideLabels","{0} - {1}",this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(e){let i=this.getPreferredDescription();return i||(this.hasIdenticalSides?this.primary.getDescription(e):super.getDescription(e))}getPreferredDescription(){return this.preferredDescription}getTitle(e){let i;this.hasIdenticalSides?i=this.primary.getTitle(e)??this.getName():i=super.getTitle(e);let n=this.getPreferredTitle();return n&&(i=`${n} (${i})`),i}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(e,i){let n=await this.primary.save(e,i);return this.saveResultToEditor(n)}async saveAs(e,i){let n=await this.primary.saveAs(e,i);return this.saveResultToEditor(n)}saveResultToEditor(e){if(!e||!this.hasIdenticalSides)return e;if(this.primary.matches(e))return this;if(e instanceof Tp)return new qn(this.preferredName,this.preferredDescription,e,e,this.editorService);if(!Wa(e)&&!wy(e)&&!zc(e)&&!Kc(e))return{primary:e,secondary:e,label:this.preferredName,description:this.preferredDescription}}revert(e,i){return this.primary.revert(e,i)}async rename(e,i){if(!this.hasIdenticalSides)return;let n=await this.primary.rename(e,i);if(n){if(Do(n.editor))return{editor:new qn(this.preferredName,this.preferredDescription,n.editor,n.editor,this.editorService),options:{...n.options,viewState:KR(this,e,this.editorService)}};if(ha(n.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:n.editor,secondary:n.editor,options:{...n.options,viewState:KR(this,e,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(e){let i=this.primary.toUntyped(e),n=this.secondary.toUntyped(e);if(i&&n&&!Wa(i)&&!Wa(n)&&!wy(i)&&!wy(n)&&!zc(i)&&!zc(n)&&!Kc(i)&&!Kc(n)){let o={label:this.preferredName,description:this.preferredDescription,primary:i,secondary:n};return typeof e?.preserveViewState=="number"&&(o.options={viewState:KR(this,e.preserveViewState,this.editorService)}),o}}matches(e){return this===e?!0:EH(e)||Wa(e)?!1:e instanceof qn?this.primary.matches(e.primary)&&this.secondary.matches(e.secondary):zc(e)?this.primary.matches(e.primary)&&this.secondary.matches(e.secondary):!1}};qn=_([v(4,kt)],qn);var TH={LEFT:"left",RIGHT:"right",FIRST:"first",LAST:"last"};function Yse(r){let t=r;return!!(t&&typeof t=="object"&&Array.isArray(t.editors)&&Array.isArray(t.mru))}var Gc=class extends L{constructor(e,i,n){super();this.instantiationService=i;this.configurationService=n;Yse(e)?this._id=this.deserialize(e):this._id=Gc.IDS++,this.onConfigurationUpdated(),this.registerListeners()}static IDS=0;_onDidModelChange=this._register(new T({leakWarningThreshold:500}));onDidModelChange=this._onDidModelChange.event;_id;get id(){return this._id}editors=[];mru=[];editorListeners=new Set;locked=!1;selection=[];get active(){return this.selection[0]??null}preview=null;sticky=-1;transient=new Set;editorOpenPositioning;focusRecentEditorAfterClose;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e)))}onConfigurationUpdated(e){e&&!e.affectsConfiguration("workbench.editor.openPositioning")&&!e.affectsConfiguration("workbench.editor.focusRecentEditorAfterClose")||(this.editorOpenPositioning=this.configurationService.getValue("workbench.editor.openPositioning"),this.focusRecentEditorAfterClose=this.configurationService.getValue("workbench.editor.focusRecentEditorAfterClose"))}get count(){return this.editors.length}get stickyCount(){return this.sticky+1}getEditors(e,i){let n=e===0?this.mru.slice(0):this.editors.slice(0);return i?.excludeSticky?e===0?n.filter(o=>!this.isSticky(o)):n.slice(this.sticky+1):n}getEditorByIndex(e){return this.editors[e]}get activeEditor(){return this.active}isActive(e){return this.matches(this.active,e)}get previewEditor(){return this.preview}openEditor(e,i){let n=i?.sticky||typeof i?.index=="number"&&this.isSticky(i.index),o=i?.pinned||i?.sticky,s=!!i?.transient,a=i?.active||!this.activeEditor||!o&&this.preview===this.activeEditor,l=this.findEditor(e,i);if(l){let[d,c]=l;return this.doSetTransient(d,c,s===!1?!1:this.isTransient(d)),o&&this.doPin(d,c),this.setSelection(a?d:this.activeEditor,i?.inactiveSelection??[]),i&&typeof i.index=="number"&&this.moveEditor(d,i.index),n&&this.doStick(d,this.indexOf(d)),{editor:d,isNew:!1}}else{let d=e,c=this.indexOf(this.active),u;if(i&&typeof i.index=="number"?u=i.index:this.editorOpenPositioning===TH.FIRST?(u=0,!n&&this.isSticky(u)&&(u=this.sticky+1)):this.editorOpenPositioning===TH.LAST?u=this.editors.length:(this.editorOpenPositioning===TH.LEFT?c===0||!this.editors.length?u=0:u=c:u=c+1,!n&&this.isSticky(u)&&(u=this.sticky+1)),n&&(this.sticky++,this.isSticky(u)||(u=this.sticky)),(o||!this.preview)&&this.splice(u,!1,d),s&&this.doSetTransient(d,u,!0),!o){if(this.preview){let m=this.indexOf(this.preview);u>m&&u--,this.replaceEditor(this.preview,d,u,!a)}this.preview=d}this.registerEditorListeners(d);let p={kind:5,editor:d,editorIndex:u};return this._onDidModelChange.fire(p),this.setSelection(a?d:this.activeEditor,i?.inactiveSelection??[]),{editor:d,isNew:!0}}}registerEditorListeners(e){let i=new W;this.editorListeners.add(i),i.add(O.once(e.onWillDispose)(()=>{let n=this.editors.indexOf(e);if(n>=0){let o={kind:15,editor:e,editorIndex:n};this._onDidModelChange.fire(o)}})),i.add(e.onDidChangeDirty(()=>{let n={kind:14,editor:e,editorIndex:this.editors.indexOf(e)};this._onDidModelChange.fire(n)})),i.add(e.onDidChangeLabel(()=>{let n={kind:9,editor:e,editorIndex:this.editors.indexOf(e)};this._onDidModelChange.fire(n)})),i.add(e.onDidChangeCapabilities(()=>{let n={kind:10,editor:e,editorIndex:this.editors.indexOf(e)};this._onDidModelChange.fire(n)})),i.add(this.onDidModelChange(n=>{n.kind===6&&n.editor?.matches(e)&&(nt(i),this.editorListeners.delete(i))}))}replaceEditor(e,i,n,o=!0){let s=this.doCloseEditor(e,1,o);if(this.splice(n,!1,i),s){let a={kind:6,...s};this._onDidModelChange.fire(a)}}closeEditor(e,i=0,n=!0){let o=this.doCloseEditor(e,i,n);if(o){let s={kind:6,...o};return this._onDidModelChange.fire(s),o}}doCloseEditor(e,i,n){let o=this.indexOf(e);if(o===-1)return;let s=this.editors[o],a=this.isSticky(o),l=this.active===s;if(n&&l)if(this.mru.length>1){let d;this.focusRecentEditorAfterClose?d=this.mru[1]:o===this.editors.length-1?d=this.editors[o-1]:d=this.editors[o+1];let c=this.selection.filter(u=>u!==s&&u!==d);this.doSetSelection(d,this.editors.indexOf(d),c)}else this.doSetSelection(null,void 0,[]);else if(!l&&this.doIsSelected(s)){let d=this.selection.filter(c=>c!==s&&c!==this.activeEditor);this.doSetSelection(this.activeEditor,this.indexOf(this.activeEditor),d)}return this.preview===s&&(this.preview=null),this.transient.delete(s),this.splice(o,!0),{editor:s,sticky:a,editorIndex:o,context:i}}moveEditor(e,i){i>=this.editors.length?i=this.editors.length-1:i<0&&(i=0);let n=this.indexOf(e);if(n<0||i===n)return;let o=this.editors[n],s=this.sticky;this.isSticky(n)&&i>this.sticky?this.sticky--:!this.isSticky(n)&&i<=this.sticky&&this.sticky++,this.editors.splice(n,1),this.editors.splice(i,0,o);let a={kind:7,editor:o,oldEditorIndex:n,editorIndex:i};if(this._onDidModelChange.fire(a),s!==this.sticky){let l={kind:13,editor:o,editorIndex:i};this._onDidModelChange.fire(l)}return o}setActive(e){let i;return e?i=this.setEditorActive(e):this.setGroupActive(),i}setGroupActive(){this._onDidModelChange.fire({kind:0})}setEditorActive(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doSetSelection(n,o,[]),n}get selectedEditors(){return this.editors.filter(e=>this.doIsSelected(e))}isSelected(e){let i;return typeof e=="number"?i=this.editors[e]:i=this.findEditor(e)?.[0],!!i&&this.doIsSelected(i)}doIsSelected(e){return this.selection.includes(e)}setSelection(e,i){let n=this.findEditor(e);if(!n)return;let[o,s]=n,a=new Set;for(let l of i){let d=this.findEditor(l);if(!d)return;let[c]=d;c!==o&&a.add(c)}this.doSetSelection(o,s,Array.from(a))}doSetSelection(e,i,n){let o=this.activeEditor,s=this.selection,a;e?a=[e,...n]:a=[],this.selection=a;let l=e&&typeof i=="number"&&o!==e;if(l){let d=this.indexOf(e,this.mru);this.mru.splice(d,1),this.mru.unshift(e);let c={kind:8,editor:e,editorIndex:i};this._onDidModelChange.fire(c)}if(l||s.length!==a.length||s.some(d=>!a.includes(d))){let d={kind:4};this._onDidModelChange.fire(d)}}setIndex(e){this._onDidModelChange.fire({kind:1})}setLabel(e){this._onDidModelChange.fire({kind:2})}pin(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doPin(n,o),n}doPin(e,i){if(this.isPinned(e))return;this.setTransient(e,!1),this.preview=null;let n={kind:11,editor:e,editorIndex:i};this._onDidModelChange.fire(n)}unpin(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doUnpin(n,o),n}doUnpin(e,i){if(!this.isPinned(e))return;let n=this.preview;this.preview=e;let o={kind:11,editor:e,editorIndex:i};this._onDidModelChange.fire(o),n&&this.closeEditor(n,3)}isPinned(e){let i;return typeof e=="number"?i=this.editors[e]:i=e,!this.matches(this.preview,i)}stick(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doStick(n,o),n}doStick(e,i){if(this.isSticky(i))return;this.pin(e);let n=this.sticky+1;this.moveEditor(e,n),this.sticky++;let o={kind:13,editor:e,editorIndex:n};this._onDidModelChange.fire(o)}unstick(e){let i=this.findEditor(e);if(!i)return;let[n,o]=i;return this.doUnstick(n,o),n}doUnstick(e,i){if(!this.isSticky(i))return;let n=this.sticky;this.moveEditor(e,n),this.sticky--;let o={kind:13,editor:e,editorIndex:n};this._onDidModelChange.fire(o)}isSticky(e){if(this.sticky<0)return!1;let i;return typeof e=="number"?i=e:i=this.indexOf(e),i<0?!1:i<=this.sticky}setTransient(e,i){if(!i&&this.transient.size===0)return;let n=this.findEditor(e);if(!n)return;let[o,s]=n;return this.doSetTransient(o,s,i),o}doSetTransient(e,i,n){if(n){if(this.transient.has(e))return;this.transient.add(e)}else{if(!this.transient.has(e))return;this.transient.delete(e)}let o={kind:12,editor:e,editorIndex:i};this._onDidModelChange.fire(o)}isTransient(e){if(this.transient.size===0)return!1;let i;return typeof e=="number"?i=this.editors[e]:i=this.findEditor(e)?.[0],!!i&&this.transient.has(i)}splice(e,i,n){let o=this.editors[e];if(i&&this.isSticky(e)&&this.sticky--,n?this.editors.splice(e,i?1:0,n):this.editors.splice(e,i?1:0),!i&&n)this.mru.length===0?this.mru.push(n):this.mru.splice(1,0,n);else{let s=this.indexOf(o,this.mru);i&&!n?this.mru.splice(s,1):i&&n&&this.mru.splice(s,1,n)}}indexOf(e,i=this.editors,n){let o=-1;if(!e)return o;for(let s=0;s<i.length;s++){let a=i[s];if(this.matches(a,e,n))if(n?.supportSideBySide&&a instanceof qn&&!(e instanceof qn))o=s;else{o=s;break}}return o}findEditor(e,i){let n=this.indexOf(e,this.editors,i);if(n!==-1)return[this.editors[n],n]}isFirst(e,i=this.editors){return this.matches(i[0],e)}isLast(e,i=this.editors){return this.matches(i[i.length-1],e)}contains(e,i){return this.indexOf(e,this.editors,i)!==-1}matches(e,i,n){if(!e||!i)return!1;if(n?.supportSideBySide&&e instanceof qn&&!(i instanceof qn))switch(n.supportSideBySide){case 4:if(this.matches(e.primary,i,n)||this.matches(e.secondary,i,n))return!0;break;case 3:if(this.matches(e.primary,i,n)&&this.matches(e.secondary,i,n))return!0;break}let o=e===i;return n?.strictEquals?o:o||e.matches(i)}get isLocked(){return this.locked}lock(e){this.isLocked!==e&&(this.locked=e,this._onDidModelChange.fire({kind:3}))}clone(){let e=this.instantiationService.createInstance(Gc,void 0);e.editors=this.editors.slice(0),e.mru=this.mru.slice(0),e.preview=this.preview,e.selection=this.selection.slice(0),e.sticky=this.sticky;for(let i of e.editors)e.registerEditorListeners(i);return e}serialize(){let e=Ne.as(Ua.EditorFactory),i=[],n=[],o,s=this.sticky;for(let l=0;l<this.editors.length;l++){let d=this.editors[l],c=!1,u=e.getEditorSerializer(d);if(u){let p=u.canSerialize(d)?u.serialize(d):void 0;typeof p=="string"?(c=!0,n.push({id:d.typeId,value:p}),i.push(d),this.preview===d&&(o=i.length-1)):c=!1}!c&&this.isSticky(l)&&s--}let a=this.mru.map(l=>this.indexOf(l,i)).filter(l=>l>=0);return{id:this.id,locked:this.locked?!0:void 0,editors:n,mru:a,preview:o,sticky:s>=0?s:void 0}}deserialize(e){let i=Ne.as(Ua.EditorFactory);return typeof e.id=="number"?(this._id=e.id,Gc.IDS=Math.max(e.id+1,Gc.IDS)):this._id=Gc.IDS++,e.locked&&(this.locked=!0),this.editors=Ei(e.editors.map((n,o)=>{let s,a=i.getEditorSerializer(n.id);if(a){let l=a.deserialize(this.instantiationService,n.value);l instanceof Tp&&(s=l,this.registerEditorListeners(s))}return!s&&typeof e.sticky=="number"&&o<=e.sticky&&e.sticky--,s})),this.mru=Ei(e.mru.map(n=>this.editors[n])),this.selection=this.mru.length>0?[this.mru[0]]:[],typeof e.preview=="number"&&(this.preview=this.editors[e.preview]),typeof e.sticky=="number"&&(this.sticky=e.sticky),this._id}dispose(){nt(Array.from(this.editorListeners)),this.editorListeners.clear(),this.transient.clear(),super.dispose()}};Gc=_([v(1,ae),v(2,de)],Gc);var xH=class r{_coreKeybindings;_extensionKeybindings;_cachedMergedKeybindings;constructor(){this._coreKeybindings=new ao,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(t){if(Hs===1){if(t&&t.win)return t.win}else if(Hs===2){if(t&&t.mac)return t.mac}else if(t&&t.linux)return t.linux;return t}registerKeybindingRule(t){let e=r.bindToCurrentPlatform(t),i=new W;if(e&&e.primary){let n=qV(e.primary,Hs);n&&i.add(this._registerDefaultKeybinding(n,t.id,t.args,t.weight,0,t.when))}if(e&&Array.isArray(e.secondary))for(let n=0,o=e.secondary.length;n<o;n++){let s=e.secondary[n],a=qV(s,Hs);a&&i.add(this._registerDefaultKeybinding(a,t.id,t.args,t.weight,-n-1,t.when))}return i}setExtensionKeybindings(t){let e=[],i=0;for(let n of t)n.keybinding&&(e[i++]={keybinding:n.keybinding,command:n.id,commandArgs:n.args,when:n.when,weight1:n.weight,weight2:0,extensionId:n.extensionId||null,isBuiltinExtension:n.isBuiltinExtension||!1});this._extensionKeybindings=e,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(t){return Ln(this.registerKeybindingRule(t),En.registerCommand(t))}_registerDefaultKeybinding(t,e,i,n,o,s){let a=this._coreKeybindings.push({keybinding:t,command:e,commandArgs:i,when:s,weight1:n,weight2:o,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,te(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(Jse)),this._cachedMergedKeybindings.slice(0)}},Zt=new xH,Qse={EditorModes:"platform.keybindingsRegistry"};Ne.add(Qse.EditorModes,Zt);function Jse(r,t){if(r.weight1!==t.weight1)return r.weight1-t.weight1;if(r.command&&t.command){if(r.command<t.command)return-1;if(r.command>t.command)return 1}return r.weight2-t.weight2}function Ey(r){return r.command!==void 0}function pZ(r){return r.submenu!==void 0}var ee=class r{static _instances=new Map;static CommandPalette=new r("CommandPalette");static DebugBreakpointsContext=new r("DebugBreakpointsContext");static DebugCallStackContext=new r("DebugCallStackContext");static DebugConsoleContext=new r("DebugConsoleContext");static DebugVariablesContext=new r("DebugVariablesContext");static NotebookVariablesContext=new r("NotebookVariablesContext");static DebugHoverContext=new r("DebugHoverContext");static DebugWatchContext=new r("DebugWatchContext");static DebugToolBar=new r("DebugToolBar");static DebugToolBarStop=new r("DebugToolBarStop");static DebugCallStackToolbar=new r("DebugCallStackToolbar");static DebugCreateConfiguration=new r("DebugCreateConfiguration");static EditorContext=new r("EditorContext");static SimpleEditorContext=new r("SimpleEditorContext");static EditorContent=new r("EditorContent");static EditorLineNumberContext=new r("EditorLineNumberContext");static EditorContextCopy=new r("EditorContextCopy");static EditorContextPeek=new r("EditorContextPeek");static EditorContextShare=new r("EditorContextShare");static EditorTitle=new r("EditorTitle");static EditorTitleRun=new r("EditorTitleRun");static EditorTitleContext=new r("EditorTitleContext");static EditorTitleContextShare=new r("EditorTitleContextShare");static EmptyEditorGroup=new r("EmptyEditorGroup");static EmptyEditorGroupContext=new r("EmptyEditorGroupContext");static EditorTabsBarContext=new r("EditorTabsBarContext");static EditorTabsBarShowTabsSubmenu=new r("EditorTabsBarShowTabsSubmenu");static EditorTabsBarShowTabsZenModeSubmenu=new r("EditorTabsBarShowTabsZenModeSubmenu");static EditorActionsPositionSubmenu=new r("EditorActionsPositionSubmenu");static ExplorerContext=new r("ExplorerContext");static ExplorerContextShare=new r("ExplorerContextShare");static ExtensionContext=new r("ExtensionContext");static ExtensionEditorContextMenu=new r("ExtensionEditorContextMenu");static GlobalActivity=new r("GlobalActivity");static CommandCenter=new r("CommandCenter");static CommandCenterCenter=new r("CommandCenterCenter");static LayoutControlMenuSubmenu=new r("LayoutControlMenuSubmenu");static LayoutControlMenu=new r("LayoutControlMenu");static MenubarMainMenu=new r("MenubarMainMenu");static MenubarAppearanceMenu=new r("MenubarAppearanceMenu");static MenubarDebugMenu=new r("MenubarDebugMenu");static MenubarEditMenu=new r("MenubarEditMenu");static MenubarCopy=new r("MenubarCopy");static MenubarFileMenu=new r("MenubarFileMenu");static MenubarGoMenu=new r("MenubarGoMenu");static MenubarHelpMenu=new r("MenubarHelpMenu");static MenubarLayoutMenu=new r("MenubarLayoutMenu");static MenubarNewBreakpointMenu=new r("MenubarNewBreakpointMenu");static PanelAlignmentMenu=new r("PanelAlignmentMenu");static PanelPositionMenu=new r("PanelPositionMenu");static ActivityBarPositionMenu=new r("ActivityBarPositionMenu");static MenubarPreferencesMenu=new r("MenubarPreferencesMenu");static MenubarRecentMenu=new r("MenubarRecentMenu");static MenubarSelectionMenu=new r("MenubarSelectionMenu");static MenubarShare=new r("MenubarShare");static MenubarSwitchEditorMenu=new r("MenubarSwitchEditorMenu");static MenubarSwitchGroupMenu=new r("MenubarSwitchGroupMenu");static MenubarTerminalMenu=new r("MenubarTerminalMenu");static MenubarViewMenu=new r("MenubarViewMenu");static MenubarHomeMenu=new r("MenubarHomeMenu");static OpenEditorsContext=new r("OpenEditorsContext");static OpenEditorsContextShare=new r("OpenEditorsContextShare");static ProblemsPanelContext=new r("ProblemsPanelContext");static SCMInputBox=new r("SCMInputBox");static SCMChangesContext=new r("SCMChangesContext");static SCMChangeContext=new r("SCMChangeContext");static SCMResourceContext=new r("SCMResourceContext");static SCMResourceContextShare=new r("SCMResourceContextShare");static SCMResourceFolderContext=new r("SCMResourceFolderContext");static SCMResourceGroupContext=new r("SCMResourceGroupContext");static SCMSourceControl=new r("SCMSourceControl");static SCMSourceControlInline=new r("SCMSourceControlInline");static SCMSourceControlTitle=new r("SCMSourceControlTitle");static SCMHistoryTitle=new r("SCMHistoryTitle");static SCMTitle=new r("SCMTitle");static SearchContext=new r("SearchContext");static SearchActionMenu=new r("SearchActionContext");static StatusBarWindowIndicatorMenu=new r("StatusBarWindowIndicatorMenu");static StatusBarRemoteIndicatorMenu=new r("StatusBarRemoteIndicatorMenu");static StickyScrollContext=new r("StickyScrollContext");static TestItem=new r("TestItem");static TestItemGutter=new r("TestItemGutter");static TestProfilesContext=new r("TestProfilesContext");static TestMessageContext=new r("TestMessageContext");static TestMessageContent=new r("TestMessageContent");static TestPeekElement=new r("TestPeekElement");static TestPeekTitle=new r("TestPeekTitle");static TestCallStack=new r("TestCallStack");static TouchBarContext=new r("TouchBarContext");static TitleBarContext=new r("TitleBarContext");static TitleBarTitleContext=new r("TitleBarTitleContext");static TunnelContext=new r("TunnelContext");static TunnelPrivacy=new r("TunnelPrivacy");static TunnelProtocol=new r("TunnelProtocol");static TunnelPortInline=new r("TunnelInline");static TunnelTitle=new r("TunnelTitle");static TunnelLocalAddressInline=new r("TunnelLocalAddressInline");static TunnelOriginInline=new r("TunnelOriginInline");static ViewItemContext=new r("ViewItemContext");static ViewContainerTitle=new r("ViewContainerTitle");static ViewContainerTitleContext=new r("ViewContainerTitleContext");static ViewTitle=new r("ViewTitle");static ViewTitleContext=new r("ViewTitleContext");static CommentEditorActions=new r("CommentEditorActions");static CommentThreadTitle=new r("CommentThreadTitle");static CommentThreadActions=new r("CommentThreadActions");static CommentThreadAdditionalActions=new r("CommentThreadAdditionalActions");static CommentThreadTitleContext=new r("CommentThreadTitleContext");static CommentThreadCommentContext=new r("CommentThreadCommentContext");static CommentTitle=new r("CommentTitle");static CommentActions=new r("CommentActions");static CommentsViewThreadActions=new r("CommentsViewThreadActions");static InteractiveToolbar=new r("InteractiveToolbar");static InteractiveCellTitle=new r("InteractiveCellTitle");static InteractiveCellDelete=new r("InteractiveCellDelete");static InteractiveCellExecute=new r("InteractiveCellExecute");static InteractiveInputExecute=new r("InteractiveInputExecute");static InteractiveInputConfig=new r("InteractiveInputConfig");static ReplInputExecute=new r("ReplInputExecute");static IssueReporter=new r("IssueReporter");static NotebookToolbar=new r("NotebookToolbar");static NotebookStickyScrollContext=new r("NotebookStickyScrollContext");static NotebookCellTitle=new r("NotebookCellTitle");static NotebookCellDelete=new r("NotebookCellDelete");static NotebookCellInsert=new r("NotebookCellInsert");static NotebookCellBetween=new r("NotebookCellBetween");static NotebookCellListTop=new r("NotebookCellTop");static NotebookCellExecute=new r("NotebookCellExecute");static NotebookCellExecuteGoTo=new r("NotebookCellExecuteGoTo");static NotebookCellExecutePrimary=new r("NotebookCellExecutePrimary");static NotebookDiffCellInputTitle=new r("NotebookDiffCellInputTitle");static NotebookDiffCellMetadataTitle=new r("NotebookDiffCellMetadataTitle");static NotebookDiffCellOutputsTitle=new r("NotebookDiffCellOutputsTitle");static NotebookOutputToolbar=new r("NotebookOutputToolbar");static NotebookOutlineFilter=new r("NotebookOutlineFilter");static NotebookOutlineActionMenu=new r("NotebookOutlineActionMenu");static NotebookEditorLayoutConfigure=new r("NotebookEditorLayoutConfigure");static NotebookKernelSource=new r("NotebookKernelSource");static BulkEditTitle=new r("BulkEditTitle");static BulkEditContext=new r("BulkEditContext");static TimelineItemContext=new r("TimelineItemContext");static TimelineTitle=new r("TimelineTitle");static TimelineTitleContext=new r("TimelineTitleContext");static TimelineFilterSubMenu=new r("TimelineFilterSubMenu");static AccountsContext=new r("AccountsContext");static SidebarTitle=new r("SidebarTitle");static PanelTitle=new r("PanelTitle");static AuxiliaryBarTitle=new r("AuxiliaryBarTitle");static AuxiliaryBarHeader=new r("AuxiliaryBarHeader");static TerminalInstanceContext=new r("TerminalInstanceContext");static TerminalEditorInstanceContext=new r("TerminalEditorInstanceContext");static TerminalNewDropdownContext=new r("TerminalNewDropdownContext");static TerminalTabContext=new r("TerminalTabContext");static TerminalTabEmptyAreaContext=new r("TerminalTabEmptyAreaContext");static TerminalStickyScrollContext=new r("TerminalStickyScrollContext");static WebviewContext=new r("WebviewContext");static InlineCompletionsActions=new r("InlineCompletionsActions");static InlineEditsActions=new r("InlineEditsActions");static InlineEditActions=new r("InlineEditActions");static NewFile=new r("NewFile");static MergeInput1Toolbar=new r("MergeToolbar1Toolbar");static MergeInput2Toolbar=new r("MergeToolbar2Toolbar");static MergeBaseToolbar=new r("MergeBaseToolbar");static MergeInputResultToolbar=new r("MergeToolbarResultToolbar");static InlineSuggestionToolbar=new r("InlineSuggestionToolbar");static InlineEditToolbar=new r("InlineEditToolbar");static ChatContext=new r("ChatContext");static ChatCodeBlock=new r("ChatCodeblock");static ChatCompareBlock=new r("ChatCompareBlock");static ChatMessageTitle=new r("ChatMessageTitle");static ChatExecute=new r("ChatExecute");static ChatExecuteSecondary=new r("ChatExecuteSecondary");static ChatInputSide=new r("ChatInputSide");static AccessibleView=new r("AccessibleView");static MultiDiffEditorFileToolbar=new r("MultiDiffEditorFileToolbar");static DiffEditorHunkToolbar=new r("DiffEditorHunkToolbar");static DiffEditorSelectionToolbar=new r("DiffEditorSelectionToolbar");static for(t){return r._instances.get(t)??new r(t)}id;constructor(t){if(r._instances.has(t))throw new TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);r._instances.set(t,this),this.id=t}},Ri=$("menuService"),tf=class r{constructor(t){this.id=t;this.has=e=>e===t}static _all=new Map;static for(t){let e=this._all.get(t);return e||(e=new r(t),this._all.set(t,e)),e}static merge(t){let e=new Set;for(let i of t)i instanceof r&&e.add(i.id);return e}has},Ct=new class{_commands=new Map;_menuItems=new Map;_onDidChangeMenu=new sD({merge:tf.merge});onDidChangeMenu=this._onDidChangeMenu.event;addCommand(r){return this._commands.set(r.id,r),this._onDidChangeMenu.fire(tf.for(ee.CommandPalette)),te(()=>{this._commands.delete(r.id)&&this._onDidChangeMenu.fire(tf.for(ee.CommandPalette))})}getCommand(r){return this._commands.get(r)}getCommands(){let r=new Map;return this._commands.forEach((t,e)=>r.set(e,t)),r}appendMenuItem(r,t){let e=this._menuItems.get(r);e||(e=new ao,this._menuItems.set(r,e));let i=e.push(t);return this._onDidChangeMenu.fire(tf.for(r)),te(()=>{i(),this._onDidChangeMenu.fire(tf.for(r))})}appendMenuItems(r){let t=new W;for(let{id:e,item:i}of r)t.add(this.appendMenuItem(e,i));return t}getMenuItems(r){let t;return this._menuItems.has(r)?t=[...this._menuItems.get(r)]:t=[],r===ee.CommandPalette&&this._appendImplicitItems(t),t}_appendImplicitItems(r){let t=new Set;for(let e of r)Ey(e)&&(t.add(e.command.id),e.alt&&t.add(e.alt.id));this._commands.forEach((e,i)=>{t.has(i)||r.push({command:e})})}},jn=class extends mn{constructor(e,i,n){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,n,"submenu");this.item=e;this.hideActions=i}},po=class{constructor(t,e,i,n,o,s,a){this.hideActions=n;this.menuKeybinding=o;this._commandService=a;this.id=t.id,this.label=po.label(t,i),this.tooltip=(typeof t.tooltip=="string"?t.tooltip:t.tooltip?.value)??"",this.enabled=!t.precondition||s.contextMatchesRules(t.precondition),this.checked=void 0;let l;if(t.toggled){let d=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=s.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&ye.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=ye.isThemeIcon(t.icon)?t.icon:void 0),this.item=t,this.alt=e?new po(e,void 0,i,n,void 0,s,a):void 0,this._options=i,this.class=l&&ye.asClassName(l)}static label(t,e){return e?.renderShortTitle&&t.shortTitle?typeof t.shortTitle=="string"?t.shortTitle:t.shortTitle.value:typeof t.title=="string"?t.title:t.title.value}item;alt;_options;id;label;tooltip;class;enabled;checked;run(...t){let e=[];return this._options?.arg&&(e=[...e,this._options.arg]),this._options?.shouldForwardArgs&&(e=[...e,...t]),this._commandService.executeCommand(this.id,...e)}};po=_([v(5,ke),v(6,ni)],po);var We=class{constructor(t){this.desc=t}};function Me(r){let t=[],e=new r,{f1:i,menu:n,keybinding:o,...s}=e.desc;if(En.getCommand(s.id))throw new Error(`Cannot register two commands with the same id: ${s.id}`);if(t.push(En.registerCommand({id:s.id,handler:(a,...l)=>e.run(a,...l),metadata:s.metadata})),Array.isArray(n))for(let a of n)t.push(Ct.appendMenuItem(a.id,{command:{...s,precondition:a.precondition===null?void 0:s.precondition},...a}));else n&&t.push(Ct.appendMenuItem(n.id,{command:{...s,precondition:n.precondition===null?void 0:s.precondition},...n}));if(i&&(t.push(Ct.appendMenuItem(ee.CommandPalette,{command:s,when:s.precondition})),t.push(Ct.addCommand(s))),Array.isArray(o))for(let a of o)t.push(Zt.registerKeybindingRule({...a,id:s.id,when:s.precondition?X.and(s.precondition,a.when):a.when}));else o&&t.push(Zt.registerKeybindingRule({...o,id:s.id,when:s.precondition?X.and(s.precondition,o.when):o.when}));return{dispose(){nt(t)}}}var di=$("editorGroupsService");function NE(r){return r.getValue("workbench.editor.openSideBySideDirection")==="down"?1:3}var kt=$("editorService"),_H=-1,Xh=-2;var LH=class{constructor(t,e,i){this.id=t;this.dependencies=e;this.callback=i}};var kH=class r{static INSTANCE=new r;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(t,e,i)=>{typeof t!="string"&&(i=e,e=t,t=null),(typeof e!="object"||!Array.isArray(e))&&(i=e,e=null),this._defineCalls.push(new LH(t,e,i))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){if(t.startsWith(window.location.origin)||t.startsWith(`${he.vscodeFileResource}://${kB}`))return t;throw new Error(`[trusted_script_src] Invalid script url: ${t}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){return t}}))}async load(t){if(this._initialize(),this._state===3)return new Promise(s=>{let a=zr();console.log(`[amdX] Using external define("${a}", ["${t}"])`),globalThis.define(a,[t],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let e=await(this._isWebWorker?this._workerLoadScript(t):this._isRenderer?this._rendererLoadScript(t):this._nodeJSLoadScript(t));if(!e){console.warn(`Did not receive a define call from script ${t}`);return}let i={},n=[],o=[];if(Array.isArray(e.dependencies))for(let s of e.dependencies)s==="exports"?n.push(i):o.push(s);if(o.length>0)throw new Error(`Cannot resolve dependencies for script ${t}. The dependencies are: ${o.join(", ")}`);return typeof e.callback=="function"?e.callback(...n)??i:e.callback}_rendererLoadScript(t){return new Promise((e,i)=>{let n=document.createElement("script");n.setAttribute("async","async"),n.setAttribute("type","text/javascript");let o=()=>{n.removeEventListener("load",s),n.removeEventListener("error",a)},s=l=>{o(),e(this._defineCalls.pop())},a=l=>{o(),i(l)};n.addEventListener("load",s),n.addEventListener("error",a),this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),n.setAttribute("src",t),window.document.getElementsByTagName("head")[0].appendChild(n)})}async _workerLoadScript(t){return this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),await import(t),this._defineCalls.pop()}async _nodeJSLoadScript(t){try{let e=(await import("fs")).default,i=(await import("vm")).default,n=(await import("module")).default,o=q.parse(t).fsPath,s=e.readFileSync(o).toString(),a=n.wrap(s.replace(/^#!.*/,""));return new i.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(e){throw e}}},DH=new Map;async function RH(r,t,e){if(!0){e===void 0&&(e=!!(globalThis._VSCODE_PRODUCT_JSON??globalThis.vscode?.context?.configuration()?.product)?.commit);let i=t?`${r}/${t}`:r;if(DH.has(i))return DH.get(i);let n;if(/^\w[\w\d+.-]*:\/\//.test(i))n=i;else{let l=`${pG}/${i}`;n=Da.asBrowserUri(l).toString(!0)}let o=kH.INSTANCE.load(n);return DH.set(i,o),o}else return await import(r)}var PH="utf8";var Q3e=512*8,J3e=512*128;var AH={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:21,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:22,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:23},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:24},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:25,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:26,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:27,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:28,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:29},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:30},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:31},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:32},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:33},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:34},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:35},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:36,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:37},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:38,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:39,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:40,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:41},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:42},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:43},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:44},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:45,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:46},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:47}},e6e=(()=>{let r={};for(let t in AH)AH[t].guessableName&&(r[t]=AH[t]);return r})();var _d=class extends Td{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b){super(l,a,f,b);this.resource=e;this.hasAssociatedFilePath=i;this.initialValue=n;this.preferredLanguageId=o;this.preferredEncoding=s;this.workingCopyBackupService=d;this.textResourceConfigurationService=c;this.workingCopyService=u;this.textFileService=p;this.labelService=m;this.editorService=g;this._register(this.workingCopyService.registerWorkingCopy(this)),o&&this.setLanguageId(o),this.onConfigurationChange(void 0,!1),this.registerListeners()}static FIRST_LINE_NAME_MAX_LENGTH=40;static FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH=this.FIRST_LINE_NAME_MAX_LENGTH*10;static ACTIVE_EDITOR_LANGUAGE_ID="${activeEditorLanguage}";_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeName=this._register(new T);onDidChangeName=this._onDidChangeName.event;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new T);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidSave=this._register(new T);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new T);onDidRevert=this._onDidRevert.event;typeId=Z$;capabilities=2;configuredLabelFormat="content";cachedModelFirstLineWords=void 0;get name(){return this.configuredLabelFormat==="content"&&!this.hasAssociatedFilePath&&this.cachedModelFirstLineWords?this.cachedModelFirstLineWords:this.labelService.getUriBasenameLabel(this.resource)}registerListeners(){this._register(this.textResourceConfigurationService.onDidChangeConfiguration(e=>this.onConfigurationChange(e,!0)))}onConfigurationChange(e,i){if(!e||e.affectsConfiguration(this.resource,"files.encoding")){let n=this.textResourceConfigurationService.getValue(this.resource,"files.encoding");this.configuredEncoding!==n&&typeof n=="string"&&(this.configuredEncoding=n,i&&!this.preferredEncoding&&this._onDidChangeEncoding.fire())}if(!e||e.affectsConfiguration(this.resource,"workbench.editor.untitled.labelFormat")){let n=this.textResourceConfigurationService.getValue(this.resource,"workbench.editor.untitled.labelFormat");this.configuredLabelFormat!==n&&(n==="content"||n==="name")&&(this.configuredLabelFormat=n,i&&this._onDidChangeName.fire())}}setLanguageId(e,i){let n=e===_d.ACTIVE_EDITOR_LANGUAGE_ID?this.editorService.activeTextEditorLanguageId:e;this.preferredLanguageId=n,n&&super.setLanguageId(n,i)}getLanguageId(){return this.textEditorModel?this.textEditorModel.getLanguageId():this.preferredLanguageId}configuredEncoding;getEncoding(){return this.preferredEncoding||this.configuredEncoding}async setEncoding(e){let i=this.getEncoding();this.preferredEncoding=e,i!==this.preferredEncoding&&this._onDidChangeEncoding.fire()}dirty=this.hasAssociatedFilePath||!!this.initialValue;isDirty(){return this.dirty}isModified(){return this.isDirty()}setDirty(e){this.dirty!==e&&(this.dirty=e,this._onDidChangeDirty.fire())}async save(e){let i=await this.textFileService.save(this.resource,e);return i&&this._onDidSave.fire({reason:e?.reason,source:e?.source}),!!i}async revert(){this.ignoreDirtyOnModelContentChange=!0;try{this.updateTextEditorModel(SH(""))}finally{this.ignoreDirtyOnModelContentChange=!1}this.setDirty(!1),this._onDidRevert.fire()}async backup(e){let i;return this.isResolved()?i=await this.textFileService.getEncodedReadable(this.resource,this.createSnapshot()??void 0,{encoding:PH}):typeof this.initialValue=="string"&&(i=xD(qe.fromString(this.initialValue))),{content:i}}ignoreDirtyOnModelContentChange=!1;async resolve(){let e=!1,i=!1;if(this.textEditorModel)this.updateTextEditorModel(void 0,this.preferredLanguageId);else{let o,s=await this.workingCopyBackupService.resolve(this);s?(o=s.value,i=!0):o=NG(qe.fromString(this.initialValue||""));let a=await tZ(await this.textFileService.getDecodedStream(this.resource,o,{encoding:PH}));this.createTextEditorModel(a,this.resource,this.preferredLanguageId),e=!0}let n=Ue(this.textEditorModel);return this.installModelListeners(n),e&&((i||this.initialValue)&&this.updateNameFromFirstLine(n),this.setDirty(this.hasAssociatedFilePath||!!i||!!this.initialValue),(i||this.initialValue)&&this._onDidChangeContent.fire()),super.resolve()}installModelListeners(e){this._register(e.onDidChangeContent(i=>this.onModelContentChanged(e,i))),this._register(e.onDidChangeLanguage(()=>this.onConfigurationChange(void 0,!0))),super.installModelListeners(e)}onModelContentChanged(e,i){this.ignoreDirtyOnModelContentChange||(!this.hasAssociatedFilePath&&e.getLineCount()===1&&e.getLineLength(1)===0?this.setDirty(!1):this.setDirty(!0)),i.changes.some(n=>(n.range.startLineNumber===1||n.range.endLineNumber===1)&&n.range.startColumn<=_d.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH)&&this.updateNameFromFirstLine(e),this._onDidChangeContent.fire(),this.autoDetectLanguage()}updateNameFromFirstLine(e){if(this.hasAssociatedFilePath)return;let i,n=e.getValueInRange({startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:_d.FIRST_LINE_NAME_CANDIDATE_MAX_LENGTH+1}).trim().replace(/\s+/g," ").replace(/\u202E/g,"");n=n.substr(0,hD(n,_d.FIRST_LINE_NAME_MAX_LENGTH)[0]),n&&Xw().exec(n)&&(i=n),i!==this.cachedModelFirstLineWords&&(this.cachedModelFirstLineWords=i,this._onDidChangeName.fire())}isReadonly(){return!1}};_d=_([v(5,Hn),v(6,Rr),v(7,cy),v(8,_s),v(9,Va),v(10,qc),v(11,qo),v(12,kt),v(13,iR),v(14,zo)],_d);var mZ=$("untitledTextEditorService"),of=class extends L{constructor(e,i){super();this.instantiationService=e;this.configurationService=i}static UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidChangeEncoding=this._register(new T);onDidChangeEncoding=this._onDidChangeEncoding.event;_onDidCreate=this._register(new T);onDidCreate=this._onDidCreate.event;_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;_onDidChangeLabel=this._register(new T);onDidChangeLabel=this._onDidChangeLabel.event;mapResourceToModel=new Ci;get(e){return this.mapResourceToModel.get(e)}getValue(e){return this.get(e)?.textEditorModel?.getValue()}async resolve(e){let i=this.doCreateOrGet(e);return await i.resolve(),i}create(e){return this.doCreateOrGet(e)}doCreateOrGet(e=Object.create(null)){let i=this.massageOptions(e);return i.untitledResource&&this.mapResourceToModel.has(i.untitledResource)?this.mapResourceToModel.get(i.untitledResource):this.doCreate(i)}massageOptions(e){let i=Object.create(null);if(e.associatedResource?(i.untitledResource=q.from({scheme:he.untitled,authority:e.associatedResource.authority,fragment:e.associatedResource.fragment,path:e.associatedResource.path,query:e.associatedResource.query}),i.associatedResource=e.associatedResource):e.untitledResource?.scheme===he.untitled&&(i.untitledResource=e.untitledResource),e.languageId)i.languageId=e.languageId;else if(!i.associatedResource){let n=this.configurationService.getValue();n.files?.defaultLanguage&&(i.languageId=n.files.defaultLanguage)}return i.encoding=e.encoding,i.initialValue=e.initialValue,i}doCreate(e){let i=e.untitledResource;if(!i){let o=1;do i=q.from({scheme:he.untitled,path:`Untitled-${o}`}),o++;while(this.mapResourceToModel.has(i))}let n=this._register(this.instantiationService.createInstance(_d,i,!!e.associatedResource,e.initialValue,e.languageId,e.encoding));return this.registerModel(n),n}registerModel(e){let i=new W;i.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),i.add(e.onDidChangeName(()=>this._onDidChangeLabel.fire(e))),i.add(e.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(e))),i.add(e.onWillDispose(()=>this._onWillDispose.fire(e))),O.once(e.onWillDispose)(()=>{this.mapResourceToModel.delete(e.resource),i.dispose()}),this.mapResourceToModel.set(e.resource,e),this._onDidCreate.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e)}isUntitledWithAssociatedResource(e){return e.scheme===he.untitled&&e.path.length>1&&!of.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(e.path)}canDispose(e){return e.isDisposed()?!0:this.doCanDispose(e)}async doCanDispose(e){return e.isDirty()?(await O.toPromise(e.onDidChangeDirty),this.canDispose(e)):!0}};of=_([v(0,ae),v(1,de)],of);vi(mZ,of,1);var ui=xo,jt=$("notificationService");function Ty(r){if(r){let t=r;return typeof t.id=="string"&&typeof t.label=="string"}return!1}var rf=class{progress=new MH;onDidClose=O.None;onDidChangeVisibility=O.None;updateSeverity(t){}updateMessage(t){}updateActions(t){}close(){}},MH=class{infinite(){}done(){}total(t){}worked(t){}};var sf=$("progressService");var iae=Object.freeze({total(){},worked(){},done(){}}),gZ=class{constructor(t){this.callback=t}static None=Object.freeze({report(){}});_value;get value(){return this._value}report(t){this._value=t,this.callback(this._value)}};var GR=class extends L{deferred=new xr;reporter;lastStep;constructor(t,e){super(),e.withProgress(t,i=>(this.reporter=i,this.lastStep&&i.report(this.lastStep),this.deferred.p)),this._register(te(()=>this.deferred.complete()))}report(t){this.reporter?this.reporter.report(t):this.lastStep=t}};GR=_([v(1,sf)],GR);var qR=$("editorProgressService");var xy=class extends L{constructor(e,i){super();this.logService=e;this.configurationService=i}participants=new ao;addFileOperationParticipant(e){let i=this.participants.push(e);return te(()=>i())}async participate(e,i,n,o){let s=this.configurationService.getValue("files.participants.timeout");if(!(typeof s!="number"||s<=0))for(let a of this.participants)try{await a.participate(e,i,n,s,o)}catch(l){this.logService.warn(l)}}dispose(){this.participants.clear(),super.dispose()}};xy=_([v(0,Gt),v(1,de)],xy);var Ls=class extends L{constructor(e,i,n,o){super();this.getExpression=e;this.shouldUpdate=i;this.contextService=n;this.configurationService=o;this.updateExpressions(!1),this.registerListeners()}static NO_FOLDER=null;_onExpressionChange=this._register(new T);onExpressionChange=this._onExpressionChange.event;mapFolderToParsedExpression=new Map;mapFolderToConfiguredExpression=new Map;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{this.shouldUpdate(e)&&this.updateExpressions(!0)})),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.updateExpressions(!0)))}updateExpressions(e){let i=!1;for(let a of this.contextService.getWorkspace().folders){let l=a.uri.toString(),d=this.doGetExpression(a.uri),c=this.mapFolderToConfiguredExpression.get(l);d?(!c||!$t(c.expression,d.expression))&&(i=!0,this.mapFolderToParsedExpression.set(l,lv(d.expression)),this.mapFolderToConfiguredExpression.set(l,d)):c&&(i=!0,this.mapFolderToParsedExpression.delete(l),this.mapFolderToConfiguredExpression.delete(l))}let n=new Wb(this.contextService.getWorkspace().folders.map(a=>a.uri));for(let[a]of this.mapFolderToConfiguredExpression)a!==Ls.NO_FOLDER&&(n.has(q.parse(a))||(this.mapFolderToParsedExpression.delete(a),this.mapFolderToConfiguredExpression.delete(a),i=!0));let o=this.doGetExpression(void 0),s=this.mapFolderToConfiguredExpression.get(Ls.NO_FOLDER);o?(!s||!$t(s.expression,o.expression))&&(i=!0,this.mapFolderToParsedExpression.set(Ls.NO_FOLDER,lv(o.expression)),this.mapFolderToConfiguredExpression.set(Ls.NO_FOLDER,o)):s&&(i=!0,this.mapFolderToParsedExpression.delete(Ls.NO_FOLDER),this.mapFolderToConfiguredExpression.delete(Ls.NO_FOLDER)),e&&i&&this._onExpressionChange.fire()}doGetExpression(e){let i=this.getExpression(e);if(!i)return;let n=Object.keys(i);if(n.length===0)return;let o=!1,s=Object.create(null);for(let a of n){o||(o=cg(a));let l=a,d=lG(l,!0);if(d){let c=d.toLowerCase();d!==d.toLowerCase()&&(l=`${c}${l.substring(1)}`)}s[l]=i[a]}return{expression:s,hasAbsolutePath:o}}matches(e,i){if(this.mapFolderToParsedExpression.size===0)return!1;let n=this.contextService.getWorkspaceFolder(e),o,s;if(n&&this.mapFolderToParsedExpression.has(n.uri.toString())?(o=this.mapFolderToParsedExpression.get(n.uri.toString()),s=this.mapFolderToConfiguredExpression.get(n.uri.toString())):(o=this.mapFolderToParsedExpression.get(Ls.NO_FOLDER),s=this.mapFolderToConfiguredExpression.get(Ls.NO_FOLDER)),!o)return!1;let a;return n?a=bD(n.uri,e):a=this.uriToPath(e),typeof a=="string"&&o(a,void 0,i)?!0:a!==this.uriToPath(e)&&s?.hasAbsolutePath?!!o(this.uriToPath(e),void 0,i):!1}uriToPath(e){return e.scheme===he.file?e.fsPath:e.path}};Ls=_([v(2,Xt),v(3,de)],Ls);var nae=new ie("autoSaveAfterShortDelayContext",!1,!0);var af=$("filesConfigurationService"),ks=class extends L{constructor(e,i,n,o,s,a,l,d){super();this.contextKeyService=e;this.configurationService=i;this.contextService=n;this.environmentService=o;this.uriIdentityService=s;this.fileService=a;this.markerService=l;this.textResourceConfigurationService=d;let c=i.getValue();this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,c.files),this.currentFilesAssociationConfiguration=c?.files?.associations,this.currentHotExitConfiguration=c?.files?.hotExit||pv.ON_EXIT,this.onFilesConfigurationChange(c,!1),this.registerListeners()}static DEFAULT_AUTO_SAVE_MODE=wt?id.AFTER_DELAY:id.OFF;static DEFAULT_AUTO_SAVE_DELAY=1e3;static READONLY_MESSAGES={providerReadonly:{value:h("providerReadonly","Editor is read-only because the file system of the file is read-only."),isTrusted:!0},sessionReadonly:{value:h({key:"sessionReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only in this session. [Click here](command:{0}) to set writeable.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},configuredReadonly:{value:h({key:"configuredReadonly",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because the file was set read-only via settings. [Click here](command:{0}) to configure or [toggle for this session](command:{1}).",`workbench.action.openSettings?${encodeURIComponent('["files.readonly"]')}`,"workbench.action.files.toggleActiveEditorReadonlyInSession"),isTrusted:!0},fileLocked:{value:h({key:"fileLocked",comment:['Please do not translate the word "command", it is part of our internal syntax which must not change','{Locked="](command:{0})"}']},"Editor is read-only because of file permissions. [Click here](command:{0}) to set writeable anyway.","workbench.action.files.setActiveEditorWriteableInSession"),isTrusted:!0},fileReadonly:{value:h("fileReadonly","Editor is read-only because the file is read-only."),isTrusted:!0}};_onDidChangeAutoSaveConfiguration=this._register(new T);onDidChangeAutoSaveConfiguration=this._onDidChangeAutoSaveConfiguration.event;_onDidChangeAutoSaveDisabled=this._register(new T);onDidChangeAutoSaveDisabled=this._onDidChangeAutoSaveDisabled.event;_onDidChangeFilesAssociation=this._register(new T);onDidChangeFilesAssociation=this._onDidChangeFilesAssociation.event;_onDidChangeReadonly=this._register(new T);onDidChangeReadonly=this._onDidChangeReadonly.event;currentGlobalAutoSaveConfiguration;currentFilesAssociationConfiguration;currentHotExitConfiguration;autoSaveConfigurationCache=new $s(1e3);autoSaveDisabledOverrides=new Ci;autoSaveAfterShortDelayContext=nae.bindTo(this.contextKeyService);readonlyIncludeMatcher=this._register(new _g(()=>this.createReadonlyMatcher(m3)));readonlyExcludeMatcher=this._register(new _g(()=>this.createReadonlyMatcher(g3)));configuredReadonlyFromPermissions;sessionReadonlyOverrides=new Ci(e=>this.uriIdentityService.extUri.getComparisonKey(e));createReadonlyMatcher(e){let i=this._register(new Ls(n=>this.configurationService.getValue(e,{resource:n}),n=>n.affectsConfiguration(e),this.contextService,this.configurationService));return this._register(i.onExpressionChange(()=>this._onDidChangeReadonly.fire())),i}isReadonly(e,i){let n=this.fileService.getProvider(e.scheme);if(n&&p3(n))return n.readOnlyMessage??ks.READONLY_MESSAGES.providerReadonly;let o=this.sessionReadonlyOverrides.get(e);return typeof o=="boolean"?o===!0?ks.READONLY_MESSAGES.sessionReadonly:!1:this.uriIdentityService.extUri.isEqualOrParent(e,this.environmentService.userRoamingDataHome)||this.uriIdentityService.extUri.isEqual(e,this.contextService.getWorkspace().configuration??void 0)?!1:this.readonlyIncludeMatcher.value.matches(e)?this.readonlyExcludeMatcher.value.matches(e)?!1:ks.READONLY_MESSAGES.configuredReadonly:this.configuredReadonlyFromPermissions&&i?.locked?ks.READONLY_MESSAGES.fileLocked:i?.readonly?ks.READONLY_MESSAGES.fileReadonly:!1}async updateReadonly(e,i){if(i==="toggle"){let n;try{n=await this.fileService.resolve(e,{resolveMetadata:!0})}catch{}i=!this.isReadonly(e,n)}i==="reset"?this.sessionReadonlyOverrides.delete(e):this.sessionReadonlyOverrides.set(e,i),this._onDidChangeReadonly.fire()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("files")&&this.onFilesConfigurationChange(this.configurationService.getValue(),!0)}))}onFilesConfigurationChange(e,i){this.currentGlobalAutoSaveConfiguration=this.computeAutoSaveConfiguration(void 0,e.files),this.autoSaveConfigurationCache.clear(),this.autoSaveAfterShortDelayContext.set(this.getAutoSaveMode(void 0).mode===1),i&&this._onDidChangeAutoSaveConfiguration.fire();let n=e?.files?.associations;$t(this.currentFilesAssociationConfiguration,n)||(this.currentFilesAssociationConfiguration=n,i&&this._onDidChangeFilesAssociation.fire());let o=e?.files?.hotExit;o===pv.OFF||o===pv.ON_EXIT_AND_WINDOW_CLOSE?this.currentHotExitConfiguration=o:this.currentHotExitConfiguration=pv.ON_EXIT;let s=!!e?.files?.readonlyFromPermissions;s!==!!this.configuredReadonlyFromPermissions&&(this.configuredReadonlyFromPermissions=s,i&&this._onDidChangeReadonly.fire())}getAutoSaveConfiguration(e){let i=this.toResource(e);if(i){let n=this.autoSaveConfigurationCache.get(i);return n||(n=this.computeAutoSaveConfiguration(i,this.textResourceConfigurationService.getValue(i,"files")),this.autoSaveConfigurationCache.set(i,n)),n}return this.currentGlobalAutoSaveConfiguration}computeAutoSaveConfiguration(e,i){let n,o,s,a,l,d;switch(i?.autoSave??ks.DEFAULT_AUTO_SAVE_MODE){case id.AFTER_DELAY:{n="afterDelay",o=typeof i?.autoSaveDelay=="number"&&i.autoSaveDelay>=0?i.autoSaveDelay:ks.DEFAULT_AUTO_SAVE_DELAY,d=o<=ks.DEFAULT_AUTO_SAVE_DELAY;break}case id.ON_FOCUS_CHANGE:n="onFocusChange";break;case id.ON_WINDOW_CHANGE:n="onWindowChange";break}return i?.autoSaveWorkspaceFilesOnly===!0&&(s=!0,e&&!this.contextService.isInsideWorkspace(e)&&(l=!0,d=void 0)),i?.autoSaveWhenNoErrors===!0&&(a=!0,d=void 0),{autoSave:n,autoSaveDelay:o,autoSaveWorkspaceFilesOnly:s,autoSaveWhenNoErrors:a,isOutOfWorkspace:l,isShortAutoSaveDelay:d}}toResource(e){return e instanceof Tp?Ui.getOriginalUri(e,{supportSideBySide:1}):e}hasShortAutoSaveDelay(e){let i=this.toResource(e);return this.getAutoSaveConfiguration(i).isShortAutoSaveDelay?!i||!this.autoSaveDisabledOverrides.has(i):!1}getAutoSaveMode(e,i){let n=this.toResource(e);if(n&&this.autoSaveDisabledOverrides.has(n))return{mode:0,reason:4};let o=this.getAutoSaveConfiguration(n);if(typeof o.autoSave>"u")return{mode:0,reason:1};if(typeof i=="number"&&(o.autoSave==="afterDelay"&&i!==2||o.autoSave==="onFocusChange"&&i!==3&&i!==4||o.autoSave==="onWindowChange"&&i!==4))return{mode:0,reason:1};if(n){if(o.autoSaveWorkspaceFilesOnly&&o.isOutOfWorkspace)return{mode:0,reason:2};if(o.autoSaveWhenNoErrors&&this.markerService.read({resource:n,take:1,severities:8}).length>0)return{mode:0,reason:3}}switch(o.autoSave){case"afterDelay":return typeof o.autoSaveDelay=="number"&&o.autoSaveDelay<=ks.DEFAULT_AUTO_SAVE_DELAY?{mode:o.autoSaveWhenNoErrors?2:1}:{mode:2};case"onFocusChange":return{mode:3};case"onWindowChange":return{mode:4}}}async toggleAutoSave(){let e=this.configurationService.getValue("files.autoSave"),i;return[id.AFTER_DELAY,id.ON_FOCUS_CHANGE,id.ON_WINDOW_CHANGE].some(n=>n===e)?i=id.OFF:i=id.AFTER_DELAY,this.configurationService.updateValue("files.autoSave",i)}disableAutoSave(e){let i=this.toResource(e);if(!i)return L.None;let n=this.autoSaveDisabledOverrides.get(i)??0;return this.autoSaveDisabledOverrides.set(i,n+1),n===0&&this._onDidChangeAutoSaveDisabled.fire(i),te(()=>{let o=this.autoSaveDisabledOverrides.get(i)??0;o<=1?(this.autoSaveDisabledOverrides.delete(i),this._onDidChangeAutoSaveDisabled.fire(i)):this.autoSaveDisabledOverrides.set(i,o-1)})}get isHotExitEnabled(){return this.contextService.getWorkspace().transient?!1:this.currentHotExitConfiguration!==pv.OFF}get hotExitConfiguration(){return this.currentHotExitConfiguration}preventSaveConflicts(e,i){return this.configurationService.getValue("files.saveConflictResolution",{resource:e,overrideIdentifier:i})!=="overwriteFileOnDisk"}};ks=_([v(0,ke),v(1,de),v(2,Xt),v(3,tr),v(4,_r),v(5,ai),v(6,D$),v(7,_s)],ks);vi(af,ks,0);var OH=$("workingCopyEditorService"),FE=class extends L{constructor(e){super();this.editorService=e}_onDidRegisterHandler=this._register(new T);onDidRegisterHandler=this._onDidRegisterHandler.event;handlers=new Set;registerHandler(e){return this.handlers.add(e),this._onDidRegisterHandler.fire(e),te(()=>this.handlers.delete(e))}findEditor(e){for(let i of this.editorService.getEditors(0))if(this.isOpen(e,i.editor))return i}isOpen(e,i){for(let n of this.handlers)if(n.isOpen(e,i))return!0;return!1}};FE=_([v(0,kt)],FE);vi(OH,FE,1);var bZ=$("elevatedFileService");var _y=class extends L{constructor(e,i){super();this.resource=e;this.fileService=i;this._register(this.fileService.onDidFilesChange(n=>this.onDidFilesChange(n)))}_onDidChangeOrphaned=this._register(new T);onDidChangeOrphaned=this._onDidChangeOrphaned.event;orphaned=!1;isOrphaned(){return this.orphaned}async onDidFilesChange(e){let i=!1,n;if(this.orphaned?e.contains(this.resource,1)&&(n=!1,i=!0):e.contains(this.resource,2)&&(n=!0,i=!0),i&&this.orphaned!==n){let o=!1;n&&(await Sn(100,In.None),this.isDisposed()?o=!0:o=!await this.fileService.exists(this.resource)),this.orphaned!==o&&!this.isDisposed()&&this.setOrphaned(o)}}setOrphaned(e){this.orphaned!==e&&(this.orphaned=e,this._onDidChangeOrphaned.fire())}_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;isDisposed(){return this._store.isDisposed}dispose(){this.orphaned=!1,this._onWillDispose.fire(),super.dispose()}isModified(){return this.isDirty()}};_y=_([v(1,ai)],_y);var lf=class extends _y{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y){super(i,a);this.typeId=e;this.name=n;this.modelFactory=o;this.externalResolver=s;this.logService=l;this.workingCopyFileService=d;this.filesConfigurationService=c;this.workingCopyBackupService=u;this.notificationService=m;this.workingCopyEditorService=g;this.editorService=f;this.elevatedFileService=b;this.progressService=y;this._register(p.registerWorkingCopy(this)),this.registerListeners()}capabilities=0;_model=void 0;get model(){return this._model}_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;_onDidResolve=this._register(new T);onDidResolve=this._onDidResolve.event;_onDidChangeDirty=this._register(new T);onDidChangeDirty=this._onDidChangeDirty.event;_onDidSaveError=this._register(new T);onDidSaveError=this._onDidSaveError.event;_onDidSave=this._register(new T);onDidSave=this._onDidSave.event;_onDidRevert=this._register(new T);onDidRevert=this._onDidRevert.event;_onDidChangeReadonly=this._register(new T);onDidChangeReadonly=this._onDidChangeReadonly.event;registerListeners(){this._register(this.filesConfigurationService.onDidChangeReadonly(()=>this._onDidChangeReadonly.fire()))}dirty=!1;savedVersionId;isDirty(){return this.dirty}markModified(){this.setDirty(!0)}setDirty(e){if(!this.isResolved())return;let i=this.dirty;this.doSetDirty(e),e!==i&&this._onDidChangeDirty.fire()}doSetDirty(e){let i=this.dirty,n=this.inConflictMode,o=this.inErrorMode,s=this.savedVersionId;return e?this.dirty=!0:(this.dirty=!1,this.inConflictMode=!1,this.inErrorMode=!1,this.isResolved()&&(this.savedVersionId=this.model.versionId)),()=>{this.dirty=i,this.inConflictMode=n,this.inErrorMode=o,this.savedVersionId=s}}lastResolvedFileStat;isResolved(){return!!this.model}async resolve(e){if(this.trace("resolve() - enter"),this.isDisposed()){this.trace("resolve() - exit - without resolving because file working copy is disposed");return}if(!e?.contents&&(this.dirty||this.saveSequentializer.isRunning())){this.trace("resolve() - exit - without resolving because file working copy is dirty or being saved");return}return this.doResolve(e)}async doResolve(e){if(e?.contents)return this.resolveFromBuffer(e.contents);if(!(!this.isResolved()&&await this.resolveFromBackup()))return this.resolveFromFile(e)}async resolveFromBuffer(e){this.trace("resolveFromBuffer()");let i,n,o,s;try{let a=await this.fileService.stat(this.resource);i=a.mtime,n=a.ctime,o=a.size,s=a.etag,this.setOrphaned(!1)}catch(a){i=Date.now(),n=Date.now(),o=0,s=tp,this.setOrphaned(a.fileOperationResult===1)}return this.resolveFromContent({resource:this.resource,name:this.name,mtime:i,ctime:n,size:o,etag:s,value:e,readonly:!1,locked:!1},!0)}async resolveFromBackup(){let e=await this.workingCopyBackupService.resolve(this);return this.isResolved()?(this.trace("resolveFromBackup() - exit - withoutresolving because previously new file working copy got created meanwhile"),!0):e?(await this.doResolveFromBackup(e),!0):!1}async doResolveFromBackup(e){this.trace("doResolveFromBackup()"),await this.resolveFromContent({resource:this.resource,name:this.name,mtime:e.meta?e.meta.mtime:Date.now(),ctime:e.meta?e.meta.ctime:Date.now(),size:e.meta?e.meta.size:0,etag:e.meta?e.meta.etag:tp,value:e.value,readonly:!1,locked:!1},!0),e.meta&&e.meta.orphaned&&this.setOrphaned(!0)}async resolveFromFile(e){this.trace("resolveFromFile()");let i=e?.forceReadFromFile,n;i?n=tp:this.lastResolvedFileStat&&(n=this.lastResolvedFileStat.etag);let o=this.versionId;try{let s=await this.fileService.readFileStream(this.resource,{etag:n,limits:e?.limits});if(this.setOrphaned(!1),o!==this.versionId){this.trace("resolveFromFile() - exit - without resolving because file working copy content changed");return}await this.resolveFromContent(s,!1)}catch(s){let a=s.fileOperationResult;if(this.setOrphaned(a===1),this.isResolved()&&a===2){s instanceof Dh&&this.updateLastResolvedFileStat(s.stat);return}if(this.isResolved()&&a===1&&!i)return;throw s}}async resolveFromContent(e,i){if(this.trace("resolveFromContent() - enter"),this.isDisposed()){this.trace("resolveFromContent() - exit - because working copy is disposed");return}this.updateLastResolvedFileStat({resource:this.resource,name:e.name,mtime:e.mtime,ctime:e.ctime,size:e.size,etag:e.etag,readonly:e.readonly,locked:e.locked,isFile:!0,isDirectory:!1,isSymbolicLink:!1,children:void 0}),this.isResolved()?await this.doUpdateModel(e.value):await this.doCreateModel(e.value),this.setDirty(!!i),this._onDidResolve.fire()}async doCreateModel(e){this.trace("doCreateModel()"),this._model=this._register(await this.modelFactory.createModel(this.resource,e,In.None)),this.installModelListeners(this._model)}ignoreDirtyOnModelContentChange=!1;async doUpdateModel(e){this.trace("doUpdateModel()"),this.ignoreDirtyOnModelContentChange=!0;try{await this.model?.update(e,In.None)}finally{this.ignoreDirtyOnModelContentChange=!1}}installModelListeners(e){this._register(e.onDidChangeContent(i=>this.onModelContentChanged(e,i.isUndoing||i.isRedoing))),this._register(e.onWillDispose(()=>this.dispose()))}onModelContentChanged(e,i){if(this.trace("onModelContentChanged() - enter"),this.versionId++,this.trace(`onModelContentChanged() - new versionId ${this.versionId}`),i&&(this.lastContentChangeFromUndoRedo=Date.now()),!this.ignoreDirtyOnModelContentChange&&!this.isReadonly())if(e.versionId===this.savedVersionId){this.trace("onModelContentChanged() - model content changed back to last saved version");let n=this.dirty;this.setDirty(!1),n&&this._onDidRevert.fire()}else this.trace("onModelContentChanged() - model content changed and marked as dirty"),this.setDirty(!0);this._onDidChangeContent.fire()}async forceResolveFromFile(){this.isDisposed()||await this.externalResolver({forceReadFromFile:!0})}get backupDelay(){return this.model?.configuration?.backupDelay}async backup(e){let i;this.lastResolvedFileStat&&(i={mtime:this.lastResolvedFileStat.mtime,ctime:this.lastResolvedFileStat.ctime,size:this.lastResolvedFileStat.size,etag:this.lastResolvedFileStat.etag,orphaned:this.isOrphaned()});let n;return this.isResolved()&&(n=await uw(this.model.snapshot(2,e),e)),{meta:i,content:n}}versionId=0;static UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD=500;lastContentChangeFromUndoRedo=void 0;saveSequentializer=new AD;ignoreSaveFromSaveParticipants=!1;async save(e=Object.create(null)){return this.isResolved()?this.isReadonly()?(this.trace("save() - ignoring request for readonly resource"),!1):(this.hasState(3)||this.hasState(5))&&(e.reason===2||e.reason===3||e.reason===4)?(this.trace("save() - ignoring auto save request for file working copy that is in conflict or error"),!1):(this.trace("save() - enter"),await this.doSave(e),this.trace("save() - exit"),this.hasState(0)):!1}async doSave(e){typeof e.reason!="number"&&(e.reason=1);let i=this.versionId;if(this.trace(`doSave(${i}) - enter with versionId ${i}`),this.ignoreSaveFromSaveParticipants){this.trace(`doSave(${i}) - exit - refusing to save() recursively from save participant`);return}if(this.saveSequentializer.isRunning(i))return this.trace(`doSave(${i}) - exit - found a running save for versionId ${i}`),this.saveSequentializer.running;if(!e.force&&!this.dirty){this.trace(`doSave(${i}) - exit - because not dirty and/or versionId is different (this.isDirty: ${this.dirty}, this.versionId: ${this.versionId})`);return}if(this.saveSequentializer.isRunning())return this.trace(`doSave(${i}) - exit - because busy saving`),this.saveSequentializer.cancelRunning(),this.saveSequentializer.queue(()=>this.doSave(e));this.isResolved()&&this.model.pushStackElement();let n=new Cn;return this.progressService.withProgress({title:h("saveParticipants","Saving '{0}'",this.name),location:10,cancellable:!0,delay:this.isDirty()?3e3:5e3},o=>this.doSaveSequential(i,e,o,n),()=>{n.cancel()}).finally(()=>{n.dispose()})}doSaveSequential(e,i,n,o){return this.saveSequentializer.run(e,(async()=>{if(this.isResolved()&&!i.skipSaveParticipants&&this.workingCopyFileService.hasSaveParticipants)try{if(i.reason===2&&typeof this.lastContentChangeFromUndoRedo=="number"){let l=Date.now()-this.lastContentChangeFromUndoRedo;l<lf.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD&&await Sn(lf.UNDO_REDO_SAVE_PARTICIPANTS_AUTO_SAVE_THROTTLE_THRESHOLD-l)}if(!o.token.isCancellationRequested){this.ignoreSaveFromSaveParticipants=!0;try{await this.workingCopyFileService.runSaveParticipants(this,{reason:i.reason??1,savedFrom:i.from},n,o.token)}finally{this.ignoreSaveFromSaveParticipants=!1}}}catch(l){this.logService.error(`[stored file working copy] runSaveParticipants(${e}) - resulted in an error: ${l.toString()}`,this.resource.toString(),this.typeId)}if(o.token.isCancellationRequested||this.isDisposed()||!this.isResolved())return;e=this.versionId,this.inErrorMode=!1,n.report({message:h("saveTextFile","Writing into file...")}),this.trace(`doSave(${e}) - before write()`);let s=Ue(this.lastResolvedFileStat),a=this;return this.saveSequentializer.run(e,(async()=>{try{let l={mtime:s.mtime,etag:i.ignoreModifiedSince||!this.filesConfigurationService.preventSaveConflicts(s.resource)?tp:s.etag,unlock:i.writeUnlock},d;if(typeof a.model.save=="function")try{d=await a.model.save(l,o.token)}catch(c){if(o.token.isCancellationRequested)return;throw c}else{let c=await uw(a.model.snapshot(1,o.token),o.token);if(o.token.isCancellationRequested)return;o.dispose(),i?.writeElevated&&this.elevatedFileService.isSupported(s.resource)?d=await this.elevatedFileService.writeFileElevated(s.resource,Ue(c),l):d=await this.fileService.writeFile(s.resource,Ue(c),l)}this.handleSaveSuccess(d,e,i)}catch(l){this.handleSaveError(l,e,i)}})(),()=>o.cancel())})(),()=>o.cancel())}handleSaveSuccess(e,i,n){this.updateLastResolvedFileStat(e),i===this.versionId?(this.trace(`handleSaveSuccess(${i}) - setting dirty to false because versionId did not change`),this.setDirty(!1)):this.trace(`handleSaveSuccess(${i}) - not setting dirty to false because versionId did change meanwhile`),this.setOrphaned(!1),this._onDidSave.fire({reason:n.reason,stat:e,source:n.source})}handleSaveError(e,i,n){if((n.ignoreErrorHandler?this.logService.trace:this.logService.error).apply(this.logService,[`[stored file working copy] handleSaveError(${i}) - exit - resulted in a save error: ${e.toString()}`,this.resource.toString(),this.typeId]),n.ignoreErrorHandler)throw e;this.setDirty(!0),this.inErrorMode=!0,e.fileOperationResult===3&&(this.inConflictMode=!0),this.doHandleSaveError(e,n),this._onDidSaveError.fire()}doHandleSaveError(e,i){let n=e,o=[],s;if(n.fileOperationResult===3)s=h("staleSaveError","Failed to save '{0}': The content of the file is newer. Do you want to overwrite the file with your changes?",this.name),o.push(Ht({id:"fileWorkingCopy.overwrite",label:h("overwrite","Overwrite"),run:()=>this.save({...i,ignoreModifiedSince:!0,reason:1})})),o.push(Ht({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()}));else{let d=n.fileOperationResult===5,c=d&&n.options?.unlock,u=n.fileOperationResult===6,p=this.elevatedFileService.isSupported(this.resource);yw(e)&&o.push(...e.actions),p&&(u||c)?o.push(Ht({id:"fileWorkingCopy.saveElevated",label:c?rt?h("overwriteElevated","Overwrite as Admin..."):h("overwriteElevatedSudo","Overwrite as Sudo..."):rt?h("saveElevated","Retry as Admin..."):h("saveElevatedSudo","Retry as Sudo..."),run:()=>{this.save({...i,writeElevated:!0,writeUnlock:c,reason:1})}})):d?o.push(Ht({id:"fileWorkingCopy.unlock",label:h("overwrite","Overwrite"),run:()=>this.save({...i,writeUnlock:!0,reason:1})})):o.push(Ht({id:"fileWorkingCopy.retry",label:h("retry","Retry"),run:()=>this.save({...i,reason:1})})),o.push(Ht({id:"fileWorkingCopy.saveAs",label:h("saveAs","Save As..."),run:async()=>{let m=this.workingCopyEditorService.findEditor(this);m&&((await this.editorService.save(m,{saveAs:!0,reason:1})).success||this.doHandleSaveError(e,i))}})),o.push(Ht({id:"fileWorkingCopy.revert",label:h("revert","Revert"),run:()=>this.revert()})),d?c&&p?s=rt?h("readonlySaveErrorAdmin","Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",this.name):h("readonlySaveErrorSudo","Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",this.name):s=h("readonlySaveError","Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",this.name):p&&u?s=rt?h("permissionDeniedSaveError","Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",this.name):h("permissionDeniedSaveErrorSudo","Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",this.name):s=h({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",this.name,lo(e,!1))}let a=this.notificationService.notify({id:`${Xn(this.resource.toString())}`,severity:ui.Error,message:s,actions:{primary:o}}),l=this._register(O.once(O.any(this.onDidSave,this.onDidRevert))(()=>a.close()));this._register(O.once(a.onDidClose)(()=>l.dispose()))}updateLastResolvedFileStat(e){let i=this.isReadonly();this.lastResolvedFileStat?this.lastResolvedFileStat.mtime<=e.mtime?this.lastResolvedFileStat=e:this.lastResolvedFileStat={...this.lastResolvedFileStat,readonly:e.readonly,locked:e.locked}:this.lastResolvedFileStat=e,this.isReadonly()!==i&&this._onDidChangeReadonly.fire()}async revert(e){if(!this.isResolved()||!this.dirty&&!e?.force)return;this.trace("revert()");let i=this.dirty,n=this.doSetDirty(!1);if(!e?.soft)try{await this.forceResolveFromFile()}catch(s){if(s.fileOperationResult!==1)throw n(),s}this._onDidRevert.fire(),i&&this._onDidChangeDirty.fire()}inConflictMode=!1;inErrorMode=!1;hasState(e){switch(e){case 3:return this.inConflictMode;case 1:return this.dirty;case 5:return this.inErrorMode;case 4:return this.isOrphaned();case 2:return this.saveSequentializer.isRunning();case 0:return!this.dirty}}async joinState(e){return this.saveSequentializer.running}isReadonly(){return this.filesConfigurationService.isReadonly(this.resource,this.lastResolvedFileStat)}trace(e){this.logService.trace(`[stored file working copy] ${e}`,this.resource.toString(),this.typeId)}dispose(){this.trace("dispose()"),this.inConflictMode=!1,this.inErrorMode=!1,this._model=void 0,super.dispose()}};lf=_([v(5,ai),v(6,Gt),v(7,NH),v(8,af),v(9,cy),v(10,Va),v(11,jt),v(12,OH),v(13,kt),v(14,bZ),v(15,sf)],lf);var Dy=class extends L{constructor(e){super();this.logService=e}saveParticipants=[];get length(){return this.saveParticipants.length}addSaveParticipant(e){let i=Bu(this.saveParticipants,e);return te(()=>i())}async participate(e,i,n,o){e.model?.pushStackElement();for(let s of this.saveParticipants){if(o.isCancellationRequested||e.isDisposed())break;try{let a=s.participate(e,i,n,o);await uw(a,o)}catch(a){this.logService.warn(a)}}e.model?.pushStackElement()}dispose(){this.saveParticipants.splice(0,this.saveParticipants.length),super.dispose()}};Dy=_([v(0,Gt)],Dy);var NH=$("workingCopyFileService"),BE=class extends L{constructor(e,i,n,o){super();this.fileService=e;this.workingCopyService=i;this.instantiationService=n;this.uriIdentityService=o;this._register(this.registerWorkingCopyProvider(s=>this.workingCopyService.workingCopies.filter(a=>this.fileService.hasProvider(s)?this.uriIdentityService.extUri.isEqualOrParent(a.resource,s):this.uriIdentityService.extUri.isEqual(a.resource,s))))}_onWillRunWorkingCopyFileOperation=this._register(new $b);onWillRunWorkingCopyFileOperation=this._onWillRunWorkingCopyFileOperation.event;_onDidFailWorkingCopyFileOperation=this._register(new $b);onDidFailWorkingCopyFileOperation=this._onDidFailWorkingCopyFileOperation.event;_onDidRunWorkingCopyFileOperation=this._register(new $b);onDidRunWorkingCopyFileOperation=this._onDidRunWorkingCopyFileOperation.event;correlationIds=0;create(e,i,n){return this.doCreateFileOrFolder(e,!0,i,n)}createFolder(e,i,n){return this.doCreateFileOrFolder(e,!1,i,n)}async doCreateFileOrFolder(e,i,n,o){if(e.length===0)return[];if(i){let c=(await Vi.settled(e.map(u=>this.fileService.canCreateFile(u.resource,{overwrite:u.overwrite})))).find(u=>u instanceof Error);if(c instanceof Error)throw c}let s=e.map(d=>({target:d.resource}));await this.runFileOperationParticipants(s,0,o,n);let a={correlationId:this.correlationIds++,operation:0,files:s};await this._onWillRunWorkingCopyFileOperation.fireAsync(a,In.None);let l;try{i?l=await Vi.settled(e.map(d=>this.fileService.createFile(d.resource,d.contents,{overwrite:d.overwrite}))):l=await Vi.settled(e.map(d=>this.fileService.createFolder(d.resource)))}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(a,In.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(a,In.None),l}async move(e,i,n){return this.doMoveOrCopy(e,!0,i,n)}async copy(e,i,n){return this.doMoveOrCopy(e,!1,i,n)}async doMoveOrCopy(e,i,n,o){let s=[];for(let{file:{source:d,target:c},overwrite:u}of e){let p=await(i?this.fileService.canMove(d,c,u):this.fileService.canCopy(d,c,u));if(p instanceof Error)throw p}let a=e.map(d=>d.file);await this.runFileOperationParticipants(a,i?2:3,o,n);let l={correlationId:this.correlationIds++,operation:i?2:3,files:a};await this._onWillRunWorkingCopyFileOperation.fireAsync(l,In.None);try{for(let{file:{source:d,target:c},overwrite:u}of e){if(!this.uriIdentityService.extUri.isEqual(d,c)){let p=i?[...this.getDirty(d),...this.getDirty(c)]:this.getDirty(c);await Vi.settled(p.map(m=>m.revert({soft:!0})))}i?s.push(await this.fileService.move(d,c,u)):s.push(await this.fileService.copy(d,c,u))}}catch(d){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(l,In.None),d}return await this._onDidRunWorkingCopyFileOperation.fireAsync(l,In.None),s}async delete(e,i,n){for(let a of e){let l=await this.fileService.canDelete(a.resource,{recursive:a.recursive,useTrash:a.useTrash});if(l instanceof Error)throw l}let o=e.map(a=>({target:a.resource}));await this.runFileOperationParticipants(o,1,n,i);let s={correlationId:this.correlationIds++,operation:1,files:o};await this._onWillRunWorkingCopyFileOperation.fireAsync(s,In.None);for(let a of e){let l=this.getDirty(a.resource);await Vi.settled(l.map(d=>d.revert({soft:!0})))}try{for(let a of e)await this.fileService.del(a.resource,{recursive:a.recursive,useTrash:a.useTrash})}catch(a){throw await this._onDidFailWorkingCopyFileOperation.fireAsync(s,In.None),a}await this._onDidRunWorkingCopyFileOperation.fireAsync(s,In.None)}fileOperationParticipants=this._register(this.instantiationService.createInstance(xy));addFileOperationParticipant(e){return this.fileOperationParticipants.addFileOperationParticipant(e)}runFileOperationParticipants(e,i,n,o){return this.fileOperationParticipants.participate(e,i,n,o)}saveParticipants=this._register(this.instantiationService.createInstance(Dy));get hasSaveParticipants(){return this.saveParticipants.length>0}addSaveParticipant(e){return this.saveParticipants.addSaveParticipant(e)}runSaveParticipants(e,i,n,o){return this.saveParticipants.participate(e,i,n,o)}workingCopyProviders=[];registerWorkingCopyProvider(e){let i=Bu(this.workingCopyProviders,e);return te(i)}getDirty(e){let i=new Set;for(let n of this.workingCopyProviders)for(let o of n(e))o.isDirty()&&i.add(o);return Array.from(i)}};BE=_([v(0,ai),v(1,Va),v(2,ae),v(3,_r)],BE);vi(NH,BE,1);var qc=$("textFileService");var $R;(t=>t.DEFAULT={allowTrailingComma:!0})($R||={});function VH(r,t=!1){let e=0,i=r.length,n="",o=0,s=16,a=0;function l(f){let b=0,y=0;for(;b<f;){let I=r.charCodeAt(e);if(I>=48&&I<=57)y=y*16+I-48;else if(I>=65&&I<=70)y=y*16+I-65+10;else if(I>=97&&I<=102)y=y*16+I-97+10;else break;e++,b++}return b<f&&(y=-1),y}function d(f){e=f,n="",o=0,s=16,a=0}function c(){let f=e;if(r.charCodeAt(e)===48)e++;else for(e++;e<r.length&&Ly(r.charCodeAt(e));)e++;if(e<r.length&&r.charCodeAt(e)===46)if(e++,e<r.length&&Ly(r.charCodeAt(e)))for(e++;e<r.length&&Ly(r.charCodeAt(e));)e++;else return a=3,r.substring(f,e);let b=e;if(e<r.length&&(r.charCodeAt(e)===69||r.charCodeAt(e)===101))if(e++,(e<r.length&&r.charCodeAt(e)===43||r.charCodeAt(e)===45)&&e++,e<r.length&&Ly(r.charCodeAt(e))){for(e++;e<r.length&&Ly(r.charCodeAt(e));)e++;b=e}else a=3;return r.substring(f,b)}function u(){let f="",b=e;for(;;){if(e>=i){f+=r.substring(b,e),a=2;break}let y=r.charCodeAt(e);if(y===34){f+=r.substring(b,e),e++;break}if(y===92){if(f+=r.substring(b,e),e++,e>=i){a=2;break}switch(r.charCodeAt(e++)){case 34:f+='"';break;case 92:f+="\\";break;case 47:f+="/";break;case 98:f+="\b";break;case 102:f+="\f";break;case 110:f+=`
`;break;case 114:f+="\r";break;case 116:f+="	";break;case 117:{let E=l(4);E>=0?f+=String.fromCharCode(E):a=4;break}default:a=5}b=e;continue}if(y>=0&&y<=31)if(jR(y)){f+=r.substring(b,e),a=2;break}else a=6;e++}return f}function p(){if(n="",a=0,o=e,e>=i)return o=i,s=17;let f=r.charCodeAt(e);if(BH(f)){do e++,n+=String.fromCharCode(f),f=r.charCodeAt(e);while(BH(f));return s=15}if(jR(f))return e++,n+=String.fromCharCode(f),f===13&&r.charCodeAt(e)===10&&(e++,n+=`
`),s=14;switch(f){case 123:return e++,s=1;case 125:return e++,s=2;case 91:return e++,s=3;case 93:return e++,s=4;case 58:return e++,s=6;case 44:return e++,s=5;case 34:return e++,n=u(),s=10;case 47:{let b=e-1;if(r.charCodeAt(e+1)===47){for(e+=2;e<i&&!jR(r.charCodeAt(e));)e++;return n=r.substring(b,e),s=12}if(r.charCodeAt(e+1)===42){e+=2;let y=i-1,I=!1;for(;e<y;){if(r.charCodeAt(e)===42&&r.charCodeAt(e+1)===47){e+=2,I=!0;break}e++}return I||(e++,a=1),n=r.substring(b,e),s=13}return n+=String.fromCharCode(f),e++,s=16}case 45:if(n+=String.fromCharCode(f),e++,e===i||!Ly(r.charCodeAt(e)))return s=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return n+=c(),s=11;default:for(;e<i&&m(f);)e++,f=r.charCodeAt(e);if(o!==e){switch(n=r.substring(o,e),n){case"true":return s=8;case"false":return s=9;case"null":return s=7}return s=16}return n+=String.fromCharCode(f),e++,s=16}}function m(f){if(BH(f)||jR(f))return!1;switch(f){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function g(){let f;do f=p();while(f>=12&&f<=15);return f}return{setPosition:d,getPosition:()=>e,scan:t?g:p,getToken:()=>s,getTokenValue:()=>n,getTokenOffset:()=>o,getTokenLength:()=>e-o,getTokenError:()=>a}}function BH(r){return r===32||r===9||r===11||r===12||r===160||r===5760||r>=8192&&r<=8203||r===8239||r===8287||r===12288||r===65279}function jR(r){return r===10||r===13||r===8232||r===8233}function Ly(r){return r>=48&&r<=57}function WH(r,t=[],e=$R.DEFAULT){let i=null,n=[],o=[];function s(l){Array.isArray(n)?n.push(l):i!==null&&(n[i]=l)}return VE(r,{onObjectBegin:()=>{let l={};s(l),o.push(n),n=l,i=null},onObjectProperty:l=>{i=l},onObjectEnd:()=>{n=o.pop()},onArrayBegin:()=>{let l=[];s(l),o.push(n),n=l,i=null},onArrayEnd:()=>{n=o.pop()},onLiteralValue:s,onError:(l,d,c)=>{t.push({error:l,offset:d,length:c})}},e),n[0]}function IZ(r,t=[],e=$R.DEFAULT){let i={type:"array",offset:-1,length:-1,children:[],parent:void 0};function n(l){i.type==="property"&&(i.length=l-i.offset,i=i.parent)}function o(l){return i.children.push(l),l}VE(r,{onObjectBegin:l=>{i=o({type:"object",offset:l,length:-1,parent:i,children:[]})},onObjectProperty:(l,d,c)=>{i=o({type:"property",offset:d,length:-1,parent:i,children:[]}),i.children.push({type:"string",value:l,offset:d,length:c,parent:i})},onObjectEnd:(l,d)=>{i.length=l+d-i.offset,i=i.parent,n(l+d)},onArrayBegin:(l,d)=>{i=o({type:"array",offset:l,length:-1,parent:i,children:[]})},onArrayEnd:(l,d)=>{i.length=l+d-i.offset,i=i.parent,n(l+d)},onLiteralValue:(l,d,c)=>{o({type:oae(l),offset:d,length:c,parent:i,value:l}),n(d+c)},onSeparator:(l,d,c)=>{i.type==="property"&&(l===":"?i.colonOffset=d:l===","&&n(d))},onError:(l,d,c)=>{t.push({error:l,offset:d,length:c})}},e);let a=i.children[0];return a&&delete a.parent,a}function UH(r,t){if(!r)return;let e=r;for(let i of t)if(typeof i=="string"){if(e.type!=="object"||!Array.isArray(e.children))return;let n=!1;for(let o of e.children)if(Array.isArray(o.children)&&o.children[0].value===i){e=o.children[1],n=!0;break}if(!n)return}else{let n=i;if(e.type!=="array"||n<0||!Array.isArray(e.children)||n>=e.children.length)return;e=e.children[n]}return e}function VE(r,t,e=$R.DEFAULT){let i=VH(r,!1);function n(A){return A?()=>A(i.getTokenOffset(),i.getTokenLength()):()=>!0}function o(A){return A?H=>A(H,i.getTokenOffset(),i.getTokenLength()):()=>!0}let s=n(t.onObjectBegin),a=o(t.onObjectProperty),l=n(t.onObjectEnd),d=n(t.onArrayBegin),c=n(t.onArrayEnd),u=o(t.onLiteralValue),p=o(t.onSeparator),m=n(t.onComment),g=o(t.onError),f=e&&e.disallowComments,b=e&&e.allowTrailingComma;function y(){for(;;){let A=i.scan();switch(i.getTokenError()){case 4:I(14);break;case 5:I(15);break;case 3:I(13);break;case 1:f||I(11);break;case 2:I(12);break;case 6:I(16);break}switch(A){case 12:case 13:f?I(10):m();break;case 16:I(1);break;case 15:case 14:break;default:return A}}}function I(A,H=[],z=[]){if(g(A),H.length+z.length>0){let Z=i.getToken();for(;Z!==17;){if(H.indexOf(Z)!==-1){y();break}else if(z.indexOf(Z)!==-1)break;Z=y()}}}function E(A){let H=i.getTokenValue();return A?u(H):a(H),y(),!0}function S(){switch(i.getToken()){case 11:{let A=0;try{A=JSON.parse(i.getTokenValue()),typeof A!="number"&&(I(2),A=0)}catch{I(2)}u(A);break}case 7:u(null);break;case 8:u(!0);break;case 9:u(!1);break;default:return!1}return y(),!0}function w(){return i.getToken()!==10?(I(3,[],[2,5]),!1):(E(!1),i.getToken()===6?(p(":"),y(),R()||I(4,[],[2,5])):I(5,[],[2,5]),!0)}function D(){s(),y();let A=!1;for(;i.getToken()!==2&&i.getToken()!==17;){if(i.getToken()===5){if(A||I(4,[],[]),p(","),y(),i.getToken()===2&&b)break}else A&&I(6,[],[]);w()||I(4,[],[2,5]),A=!0}return l(),i.getToken()!==2?I(7,[2],[]):y(),!0}function k(){d(),y();let A=!1;for(;i.getToken()!==4&&i.getToken()!==17;){if(i.getToken()===5){if(A||I(4,[],[]),p(","),y(),i.getToken()===4&&b)break}else A&&I(6,[],[]);R()||I(4,[],[4,5]),A=!0}return c(),i.getToken()!==4?I(8,[4],[]):y(),!0}function R(){switch(i.getToken()){case 3:return k();case 1:return D();case 10:return E(!0);default:return S()}}return y(),i.getToken()===17?e.allowEmptyContent?!0:(I(4,[],[]),!1):R()?(i.getToken()!==17&&I(9,[],[]),!0):(I(4,[],[]),!1)}function oae(r){switch(typeof r){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":{if(r){if(Array.isArray(r))return"array"}else return"null";return"object"}default:return"null"}}var at=$("keybindingService");var WE=".vscode",UE="settings",CZ=`${WE}/${UE}.json`,SZ="vscode://schemas/settings/default",wZ="vscode://schemas/settings/user",EZ="vscode://schemas/settings/profile",TZ="vscode://schemas/settings/machine",xZ="vscode://schemas/settings/workspace",_Z="vscode://schemas/settings/folder";var yQe=[1],DZ=[2,3,4,5,6],zH=[3,4,5],LZ=[1,...zH],YR=[2,3,4,5,6],ky=[3,4,5,6],HE=[4,5,6],ds="tasks",jc="launch",ZR=Object.create(null);ZR[ds]=`${WE}/${ds}.json`;ZR[jc]=`${WE}/${jc}.json`;var KH=Object.create(null);KH[ds]=`${ds}.json`;var XR=de,kZ=`{
	"version": "2.0.0",
	"tasks": []
}`,Dd="workbench.settings.applyToAllProfiles";var GH=class extends $h{_currentResultGroups=new Map;updateResultGroup(t,e){return e?this._currentResultGroups.set(t,e):this._currentResultGroups.delete(t),this.removeDuplicateResults(),this.update()}removeDuplicateResults(){let t=new Set;[...this._currentResultGroups.keys()].sort((e,i)=>this._currentResultGroups.get(e).order-this._currentResultGroups.get(i).order).forEach(e=>{let i=this._currentResultGroups.get(e);i.result.filterMatches=i.result.filterMatches.filter(n=>!t.has(n.setting.key)),i.result.filterMatches.forEach(n=>t.add(n.setting.key))})}filterSettings(t,e,i){let n=this.filterGroups,o=[];for(let s of n){let a=e(s);for(let l of s.sections)for(let d of l.settings){let c=i(d,s);(a||c)&&o.push({setting:d,matches:c&&c.matches,matchType:c?.matchType??0,score:c?.score??0})}}return o}getPreference(t){for(let e of this.settingsGroups)for(let i of e.sections)for(let n of i.settings)if(t===n.key)return n}collectMetadata(t){let e=Object.create(null),i=!1;return t.forEach(n=>{n.result.metadata&&(e[n.id]=n.result.metadata,i=!0)}),i?e:null}get filterGroups(){return this.settingsGroups}};var QR=class extends GH{constructor(e,i){super();this._defaultSettings=e;this._register(i.onDidChangeConfiguration(n=>{n.source===7&&(this.dirty=!0,this._onDidChangeGroups.fire())})),this._register(Ne.as(xi.Configuration).onDidSchemaChange(n=>{this.dirty=!0,this._onDidChangeGroups.fire()}))}_onDidChangeGroups=this._register(new T);onDidChangeGroups=this._onDidChangeGroups.event;additionalGroups=[];dirty=!1;get filterGroups(){return this.settingsGroups.slice(1)}get settingsGroups(){let e=this._defaultSettings.getSettingsGroups(this.dirty);return this.dirty=!1,[...e,...this.additionalGroups]}setAdditionalGroups(e){this.additionalGroups=e}findValueMatches(e,i){return[]}update(){throw new Error("Not supported")}};QR=_([v(1,de)],QR);function rae(r){return"// "+h("defaultKeybindingsHeader","Override key bindings by placing them into your key bindings file.")+`
`+r.getDefaultKeybindingsContent()}var JR=class{constructor(t,e){this._uri=t;this.keybindingService=e}_content;get uri(){return this._uri}get content(){return this._content||(this._content=rae(this.keybindingService)),this._content}getPreference(){return null}dispose(){}};JR=_([v(1,at)],JR);var Ld=$("preferencesService");var Ua={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},Ry={id:"default",displayName:h("promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:h("builtinProviderDisplayName","Built-in")},AZ="workbench.editor.sidebysideEditor",eA="workbench.editors.textDiffEditor",PZ="workbench.editors.binaryResourceDiffEditor";function ZH(r){let t=r;return!!t&&typeof t.getSelection=="function"&&!!t.onDidChangeSelection}function KR(r,t,e){for(let i of e.visibleEditorPanes)if(i.group.id===t&&r.matches(i.input))return i.getViewState()}function ha(r){if(Do(r))return!1;let t=r;return q.isUri(t?.resource)}function Wa(r){if(Do(r))return!1;let t=r;return t?.original!==void 0&&t.modified!==void 0}function wy(r){if(Do(r))return!1;let t=r;return!t||t.resources&&!Array.isArray(t.resources)?!1:!!t.resources||!!t.multiDiffSource}function zc(r){if(Do(r)||Wa(r))return!1;let t=r;return t?.primary!==void 0&&t.secondary!==void 0}function Kc(r){if(Do(r))return!1;let t=r;return q.isUri(t?.base?.resource)&&q.isUri(t?.input1?.resource)&&q.isUri(t?.input2?.resource)&&q.isUri(t?.result?.resource)}var jH=class{mapIdToSaveSource=new Map;registerSource(t,e){let i=this.mapIdToSaveSource.get(t);return i||(i={source:t,label:e},this.mapIdToSaveSource.set(t,i)),i.source}getSourceLabel(t){return this.mapIdToSaveSource.get(t)?.label??t}},utt=new jH;var OE=class extends L{};function Do(r){return r instanceof OE}function sae(r){let t=r;return q.isUri(t?.preferredResource)}function aae(r){let t=r;return Do(t?.primary)&&Do(t?.secondary)}function EH(r){let t=r;return Do(t?.modified)&&Do(t?.original)}function MZ(r,t,e,i,n){return lae(i,[Ht({id:"workbench.action.openLargeFile",label:h("openLargeFile","Open Anyway"),run:()=>{let o={...e,limits:{size:Number.MAX_VALUE}};r.openEditor(t,o)}}),Ht({id:"workbench.action.configureEditorLargeFileConfirmation",label:h("configureEditorLargeFileConfirmation","Configure Limit"),run:()=>n.openUserSettings({query:"workbench.editorLargeFileConfirmation"})})],{forceMessage:!0,forceSeverity:xo.Warning})}function tA(r){let t=r;return typeof t?.groupId=="number"&&Do(t.editor)}var $H=class{getOriginalUri(t,e){if(!t)return;if(Kc(t))return Ui.getOriginalUri(t.result,e);if(e?.supportSideBySide){let{primary:n,secondary:o}=this.getSideEditors(t);if(n&&o){if(e?.supportSideBySide===3)return{primary:this.getOriginalUri(n,{filterByScheme:e.filterByScheme}),secondary:this.getOriginalUri(o,{filterByScheme:e.filterByScheme})};if(e?.supportSideBySide===4)return this.getOriginalUri(n,{filterByScheme:e.filterByScheme})??this.getOriginalUri(o,{filterByScheme:e.filterByScheme});t=e.supportSideBySide===1?n:o}}if(Wa(t)||wy(t)||zc(t)||Kc(t))return;let i=sae(t)?t.preferredResource:t.resource;return!i||!e||!e.filterByScheme?i:this.filterUri(i,e.filterByScheme)}getSideEditors(t){return aae(t)||zc(t)?{primary:t.primary,secondary:t.secondary}:EH(t)||Wa(t)?{primary:t.modified,secondary:t.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(t,e){if(!t)return;if(Kc(t))return Ui.getCanonicalUri(t.result,e);if(e?.supportSideBySide){let{primary:n,secondary:o}=this.getSideEditors(t);if(n&&o){if(e?.supportSideBySide===3)return{primary:this.getCanonicalUri(n,{filterByScheme:e.filterByScheme}),secondary:this.getCanonicalUri(o,{filterByScheme:e.filterByScheme})};if(e?.supportSideBySide===4)return this.getCanonicalUri(n,{filterByScheme:e.filterByScheme})??this.getCanonicalUri(o,{filterByScheme:e.filterByScheme});t=e.supportSideBySide===1?n:o}}if(Wa(t)||wy(t)||zc(t)||Kc(t))return;let i=t.resource;return!i||!e||!e.filterByScheme?i:this.filterUri(i,e.filterByScheme)}filterUri(t,e){if(Array.isArray(e)){if(e.some(i=>t.scheme===i))return t}else if(e===t.scheme)return t}};function iA(r,t,e,i){if(!r.isSticky(t))return!1;switch(i.preventPinnedEditorClose){case"keyboardAndMouse":return e===2||e===1;case"mouse":return e===2;case"keyboard":return e===1}return!1}var Ui=new $H;var YH=class{instantiationService;fileEditorFactory;editorSerializerConstructors=new Map;editorSerializerInstances=new Map;start(t){let e=this.instantiationService=t.get(ae);for(let[i,n]of this.editorSerializerConstructors)this.createEditorSerializer(i,n,e);this.editorSerializerConstructors.clear()}createEditorSerializer(t,e,i){let n=i.createInstance(e);this.editorSerializerInstances.set(t,n)}registerFileEditorFactory(t){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=t}getFileEditorFactory(){return Ue(this.fileEditorFactory)}registerEditorSerializer(t,e){if(this.editorSerializerConstructors.has(t)||this.editorSerializerInstances.has(t))throw new Error(`A editor serializer with type ID '${t}' was already registered.`);return this.instantiationService?this.createEditorSerializer(t,e,this.instantiationService):this.editorSerializerConstructors.set(t,e),te(()=>{this.editorSerializerConstructors.delete(t),this.editorSerializerInstances.delete(t)})}getEditorSerializer(t){return this.editorSerializerInstances.get(typeof t=="string"?t:t.typeId)}};Ne.add(Ua.EditorFactory,new YH);async function Ay(r,t,e){return!r||!r.length?[]:await Promise.all(r.map(async i=>{let n=q.revive(i.fileUri);if(!n){e.info("Cannot resolve the path because it is not valid.",i);return}if(!await t.canHandleResource(n)){e.info("Cannot resolve the path because it cannot be handled",i);return}let s=i.exists,a=i.type;if(typeof s!="boolean"||typeof a!="number")try{a=(await t.stat(n)).isDirectory?2:0,s=!0}catch(d){e.error(d),s=!1}if(!s&&i.openOnlyIfExists){e.info("Cannot resolve the path because it does not exist",i);return}if(a===2){e.info("Cannot resolve the path because it is a directory",i);return}let l={...i.options,pinned:!0};return s?{resource:n,options:l}:{resource:n,options:l,forceUntitled:!0}}))}function zE(r){let t=r;if(!t)return!1;let e=t;if(e.modified)return zE(e.modified);let i=t;return!!(i.contributionsState&&i.viewState&&Array.isArray(i.cursorState))}function lae(r,t,e){let i=v3(r,t);return i.forceMessage=e?.forceMessage,i.forceSeverity=e?.forceSeverity,i.allowDialog=e?.allowDialog,i}var OZ=$("editorPaneService");var Qh;(t=>t.Workbench="workbench.contributions.kind")(Qh||={});var kd=(n=>(n[n.BlockStartup=1]="BlockStartup",n[n.BlockRestore=2]="BlockRestore",n[n.AfterRestored=3]="AfterRestored",n[n.Eventually=4]="Eventually",n))(kd||{});function NZ(r){let t=r;return!!t&&typeof t.editorTypeId=="string"}function dae(r){switch(r){case 3:return kd.AfterRestored;case 4:return kd.Eventually}}function FZ(r){switch(r){case kd.BlockStartup:return 1;case kd.BlockRestore:return 2;case kd.AfterRestored:return 3;case kd.Eventually:return 4}}var df=class r extends L{static INSTANCE=new r;static BLOCK_BEFORE_RESTORE_WARN_THRESHOLD=20;static BLOCK_AFTER_RESTORE_WARN_THRESHOLD=100;instantiationService;lifecycleService;logService;environmentService;editorPaneService;contributionsByPhase=new Map;contributionsByEditor=new Map;contributionsById=new Map;instancesById=new Map;instanceDisposables=this._register(new W);timingsByPhase=new Map;get timings(){return this.timingsByPhase}pendingRestoredContributions=new xr;whenRestored=this.pendingRestoredContributions.p;registerWorkbenchContribution2(t,e,i){let n={id:t,ctor:e};this.instantiationService&&this.lifecycleService&&this.logService&&this.environmentService&&this.editorPaneService&&(typeof i=="number"&&this.lifecycleService.phase>=i||typeof t=="string"&&NZ(i)&&this.editorPaneService.didInstantiateEditorPane(i.editorTypeId))?this.safeCreateContribution(this.instantiationService,this.logService,this.environmentService,n,typeof i=="number"?FZ(i):this.lifecycleService.phase):(typeof i=="number"&&ql(this.contributionsByPhase,FZ(i),[]).push(n),typeof t=="string"&&(this.contributionsById.has(t)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${t}'`):this.contributionsById.set(t,n),NZ(i)&&ql(this.contributionsByEditor,i.editorTypeId,[]).push(n)))}registerWorkbenchContribution(t,e){this.registerWorkbenchContribution2(void 0,t,dae(e))}getWorkbenchContribution(t){if(this.instancesById.has(t))return this.instancesById.get(t);let e=this.instantiationService,i=this.lifecycleService,n=this.logService,o=this.environmentService;if(!e||!i||!n||!o)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${t}'): cannot be called before registry started`);let s=this.contributionsById.get(t);if(!s)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${t}'): contribution with that identifier is unknown.`);i.phase<3&&n.warn(`IWorkbenchContributionsRegistry#getContribution('${t}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(e,n,o,s,i.phase);let a=this.instancesById.get(t);if(!a)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${t}'): failed to create contribution.`);return a}start(t){let e=this.instantiationService=t.get(ae),i=this.lifecycleService=t.get(Pn),n=this.logService=t.get(Gt),o=this.environmentService=t.get(tr),s=this.editorPaneService=t.get(OZ);this._register(i.onDidShutdown(()=>{this.instanceDisposables.clear()}));for(let a of[1,2,3,4])this.instantiateByPhase(e,i,n,o,a);for(let a of this.contributionsByEditor.keys())s.didInstantiateEditorPane(a)&&this.onEditor(a,e,i,n,o);this._register(s.onWillInstantiateEditorPane(a=>this.onEditor(a.typeId,e,i,n,o)))}onEditor(t,e,i,n,o){let s=this.contributionsByEditor.get(t);if(s){this.contributionsByEditor.delete(t);for(let a of s)this.safeCreateContribution(e,n,o,a,i.phase)}}instantiateByPhase(t,e,i,n,o){e.phase>=o?this.doInstantiateByPhase(t,i,n,o):e.when(o).then(()=>this.doInstantiateByPhase(t,i,n,o))}async doInstantiateByPhase(t,e,i,n){let o=this.contributionsByPhase.get(n);if(o)switch(this.contributionsByPhase.delete(n),n){case 1:case 2:{Dt(`code/willCreateWorkbenchContributions/${n}`);for(let s of o)this.safeCreateContribution(t,e,i,s,n);Dt(`code/didCreateWorkbenchContributions/${n}`);break}case 3:case 4:{n===4&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(o,t,e,i,n);break}}}doInstantiateWhenIdle(t,e,i,n,o){Dt(`code/willCreateWorkbenchContributions/${o}`);let s=0,a=o===4?3e3:500,l=d=>{for(;s<t.length;){let c=t[s++];if(this.safeCreateContribution(e,i,n,c,o),d.timeRemaining()<1){wh(l,a);break}}s===t.length&&(Dt(`code/didCreateWorkbenchContributions/${o}`),o===3&&this.pendingRestoredContributions.complete())};wh(l,a)}safeCreateContribution(t,e,i,n,o){if(typeof n.id=="string"&&this.instancesById.has(n.id))return;let s=Date.now();try{typeof n.id=="string"&&Dt(`code/willCreateWorkbenchContribution/${o}/${n.id}`);let a=t.createInstance(n.ctor);typeof n.id=="string"&&(this.instancesById.set(n.id,a),this.contributionsById.delete(n.id)),fg(a)&&this.instanceDisposables.add(a)}catch(a){e.error(`Unable to create workbench contribution '${n.id??n.ctor.name}'.`,a)}finally{typeof n.id=="string"&&Dt(`code/didCreateWorkbenchContribution/${o}/${n.id}`)}if(typeof n.id=="string"||!i.isBuilt){let a=Date.now()-s;if(a>(o<3?r.BLOCK_BEFORE_RESTORE_WARN_THRESHOLD:r.BLOCK_AFTER_RESTORE_WARN_THRESHOLD)&&e.warn(`Creation of workbench contribution '${n.id??n.ctor.name}' took ${a}ms.`),typeof n.id=="string"){let l=this.timingsByPhase.get(o);l||(l=[],this.timingsByPhase.set(o,l)),l.push([n.id,a])}}}},nA=df.INSTANCE.registerWorkbenchContribution2.bind(df.INSTANCE),BZ=df.INSTANCE.getWorkbenchContribution.bind(df.INSTANCE);Ne.add(Qh.Workbench,df.INSTANCE);var VZ=$("layoutService");function oA(r){return JSON.stringify(r,cae)}function Py(r){let t=JSON.parse(r);return t=Jh(t),t}function cae(r,t){return t instanceof RegExp?{$mid:2,source:t.source,flags:t.flags}:t}function Jh(r,t=0){if(!r||t>200)return r;if(typeof r=="object"){switch(r.$mid){case 1:return q.revive(r);case 2:return new RegExp(r.source,r.flags);case 17:return new Date(r.source)}if(r instanceof qe||r instanceof Uint8Array)return r;if(Array.isArray(r))for(let e=0;e<r.length;++e)r[e]=Jh(r[e],t+1);else for(let e in r)Object.hasOwnProperty.call(r,e)&&(r[e]=Jh(r[e],t+1))}return r}var $c=class r extends L{constructor(e,i=Object.create(null)){super();this.database=e;this.options=i;this.registerListeners()}static DEFAULT_FLUSH_DELAY=100;_onDidChangeStorage=this._register(new hh);onDidChangeStorage=this._onDidChangeStorage.event;state=0;cache=new Map;flushDelayer=this._register(new Zu(r.DEFAULT_FLUSH_DELAY));pendingDeletes=new Set;pendingInserts=new Map;pendingClose=void 0;whenFlushedCallbacks=[];registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){this._onDidChangeStorage.pause();try{e.changed?.forEach((i,n)=>this.acceptExternal(n,i)),e.deleted?.forEach(i=>this.acceptExternal(i,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,i){if(this.state===2)return;let n=!1;Zi(i)?n=this.cache.delete(e):this.cache.get(e)!==i&&(this.cache.set(e,i),n=!0),n&&this._onDidChangeStorage.fire({key:e,external:!0})}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===0&&(this.state=1,this.options.hint!==0&&(this.cache=await this.database.getItems()))}get(e,i){let n=this.cache.get(e);return Zi(n)?i:n}getBoolean(e,i){let n=this.get(e);return Zi(n)?i:n==="true"}getNumber(e,i){let n=this.get(e);return Zi(n)?i:parseInt(n,10)}getObject(e,i){let n=this.get(e);return Zi(n)?i:Py(n)}async set(e,i,n=!1){if(this.state===2)return;if(Zi(i))return this.delete(e,n);let o=Mi(i)||Array.isArray(i)?oA(i):String(i);if(this.cache.get(e)!==o)return this.cache.set(e,o),this.pendingInserts.set(e,o),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:n}),this.doFlush()}async delete(e,i=!1){if(!(this.state===2||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async optimize(){if(this.state!==2)return await this.flush(0),this.database.optimize()}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=2;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;let e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async flush(e){if(!(this.state===2||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===1?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}isInMemory(){return this.options.hint===1}},My=class{onDidChangeItemsExternal=O.None;items=new Map;async getItems(){return this.items}async updateItems(t){t.insert?.forEach((e,i)=>this.items.set(i,e)),t.delete?.forEach(e=>this.items.delete(e))}async optimize(){}async close(){}};var uae="__$__isNewStorageMarker",rA="__$__targetStorageMarker",tt=$("storageService");function pae(r){let t=r.get(rA);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}var KE=class r extends L{constructor(e={flushInterval:r.DEFAULT_FLUSH_INTERVAL}){super();this.options=e}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new hh);_onDidChangeTarget=this._register(new hh);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new T);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new Et(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new mt);onDidChangeValue(e,i,n){return O.filter(this._onDidChangeValue.event,o=>o.scope===e&&(i===void 0||o.key===i),n)}doFlushWhenIdle(){this.runFlushWhenIdle.value=wh(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){nt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{Dt("code/willInitStorage");try{await this.doInitialize()}finally{Dt("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(e,i){let{key:n,external:o}=i;if(n===rA){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:n,target:this.getKeyTargets(e)[n],external:o})}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,i,n){return this.getStorage(i)?.get(e,n)}getBoolean(e,i,n){return this.getStorage(i)?.getBoolean(e,n)}getNumber(e,i,n){return this.getStorage(i)?.getNumber(e,n)}getObject(e,i,n){return this.getStorage(i)?.getObject(e,n)}storeAll(e,i){this.withPausedEmitters(()=>{for(let n of e)this.store(n.key,n.value,n.scope,n.target,i)})}store(e,i,n,o,s=!1){if(Zi(i)){this.remove(e,n,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,n,o),this.getStorage(n)?.set(e,i,s)})}remove(e,i,n=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(e,i,void 0),this.getStorage(i)?.delete(e,n)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(e,i){let n=[],o=this.getKeyTargets(e);for(let s of Object.keys(o))o[s]===i&&n.push(s);return n}updateKeyTarget(e,i,n,o=!1){let s=this.getKeyTargets(i);typeof n=="number"?s[e]!==n&&(s[e]=n,this.getStorage(i)?.set(rA,JSON.stringify(s),o)):typeof s[e]=="number"&&(delete s[e],this.getStorage(i)?.set(rA,JSON.stringify(s),o))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){let i=this.getStorage(e);return i?pae(i):Object.create(null)}isNew(e){return this.getBoolean(uae,e)===!0}async flush(e=0){this._onWillSaveState.fire({reason:e});let i=this.getStorage(-1),n=this.getStorage(0),o=this.getStorage(1);switch(e){case 0:await Vi.settled([i?.whenFlushed()??Promise.resolve(),n?.whenFlushed()??Promise.resolve(),o?.whenFlushed()??Promise.resolve()]);break;case 1:await Vi.settled([i?.flush(0)??Promise.resolve(),n?.flush(0)??Promise.resolve(),o?.flush(0)??Promise.resolve()]);break}}async log(){let e=this.getStorage(-1)?.items??new Map,i=this.getStorage(0)?.items??new Map,n=this.getStorage(1)?.items??new Map;return hae(e,i,n,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(e){return await this.flush(),this.getStorage(e)?.optimize()}async switch(e,i){return this.emitWillSaveState(0),TL(e)?this.switchToProfile(e,i):this.switchToWorkspace(e,i)}canSwitchProfile(e,i){return!(e.id===i.id||sA(i)&&sA(e))}switchData(e,i,n){this.withPausedEmitters(()=>{let o=new Set;for(let[s,a]of e)o.add(s),i.get(s)!==a&&this.emitDidChangeValue(n,{key:s,external:!0});for(let[s]of i.items)o.has(s)||this.emitDidChangeValue(n,{key:s,external:!0})})}};function sA(r){return r.isDefault||!!r.useDefaultFlags?.globalState}var aA=class extends KE{applicationStorage=this._register(new $c(new My,{hint:1}));profileStorage=this._register(new $c(new My,{hint:1}));workspaceStorage=this._register(new $c(new My,{hint:1}));constructor(){super(),this._register(this.workspaceStorage.onDidChangeStorage(t=>this.emitDidChangeValue(1,t))),this._register(this.profileStorage.onDidChangeStorage(t=>this.emitDidChangeValue(0,t))),this._register(this.applicationStorage.onDidChangeStorage(t=>this.emitDidChangeValue(-1,t)))}getStorage(t){switch(t){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}getLogDetails(t){switch(t){case-1:return"inMemory (application)";case 0:return"inMemory (profile)";default:return"inMemory (workspace)"}}async doInitialize(){}async switchToProfile(){}async switchToWorkspace(){}shouldFlushWhenIdle(){return!1}hasScope(t){return!1}};async function hae(r,t,e,i,n,o){let s=f=>{try{return JSON.parse(f)}catch{return f}},a=new Map,l=new Map;r.forEach((f,b)=>{a.set(b,f),l.set(b,s(f))});let d=new Map,c=new Map;t.forEach((f,b)=>{d.set(b,f),c.set(b,s(f))});let u=new Map,p=new Map;e.forEach((f,b)=>{u.set(b,f),p.set(b,s(f))}),console.group(i!==n?`Storage: Application (path: ${i})`:`Storage: Application & Profile (path: ${i}, default profile)`);let m=[];if(a.forEach((f,b)=>{m.push({key:b,value:f})}),console.table(m),console.groupEnd(),console.log(l),i!==n){console.group(`Storage: Profile (path: ${n}, profile specific)`);let f=[];d.forEach((b,y)=>{f.push({key:y,value:b})}),console.table(f),console.groupEnd(),console.log(c)}console.group(`Storage: Workspace (path: ${o})`);let g=[];u.forEach((f,b)=>{g.push({key:b,value:f})}),console.table(g),console.groupEnd(),console.log(p)}var em=class r{constructor(t,e){this.storageService=e;this.id=r.COMMON_PREFIX+t}static applicationMementos=new Map;static profileMementos=new Map;static workspaceMementos=new Map;static COMMON_PREFIX="memento/";id;getMemento(t,e){switch(t){case 1:{let i=r.workspaceMementos.get(this.id);return i||(i=new GE(this.id,t,e,this.storageService),r.workspaceMementos.set(this.id,i)),i.getMemento()}case 0:{let i=r.profileMementos.get(this.id);return i||(i=new GE(this.id,t,e,this.storageService),r.profileMementos.set(this.id,i)),i.getMemento()}case-1:{let i=r.applicationMementos.get(this.id);return i||(i=new GE(this.id,t,e,this.storageService),r.applicationMementos.set(this.id,i)),i.getMemento()}}}onDidChangeValue(t,e){return this.storageService.onDidChangeValue(t,this.id,e)}saveMemento(){r.workspaceMementos.get(this.id)?.save(),r.profileMementos.get(this.id)?.save(),r.applicationMementos.get(this.id)?.save()}reloadMemento(t){let e;switch(t){case-1:e=r.applicationMementos.get(this.id);break;case 0:e=r.profileMementos.get(this.id);break;case 1:e=r.workspaceMementos.get(this.id);break}e?.reload()}static clear(t){switch(t){case 1:r.workspaceMementos.clear();break;case 0:r.profileMementos.clear();break;case-1:r.applicationMementos.clear();break}}},GE=class{constructor(t,e,i,n){this.id=t;this.scope=e;this.target=i;this.storageService=n;this.mementoObj=this.doLoad()}mementoObj;doLoad(){try{return this.storageService.getObject(this.id,this.scope,{})}catch(t){Ke(`[memento]: failed to parse contents: ${t} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id,this.scope)})`)}return{}}getMemento(){return this.mementoObj}reload(){for(let t of Object.getOwnPropertyNames(this.mementoObj))delete this.mementoObj[t];Object.assign(this.mementoObj,this.doLoad())}save(){Xl(this.mementoObj)?this.storageService.remove(this.id,this.scope):this.storageService.store(this.id,this.mementoObj,this.scope,this.target)}};var _p=class extends ia{constructor(e,i,n){super(i);this.id=e;this.memento=new em(this.id,n),this._register(n.onWillSaveState(()=>{this.saveState(),this.memento.saveMemento()}))}memento;getId(){return this.id}getMemento(e,i){return this.memento.getMemento(e,i)}reloadMemento(e){return this.memento.reloadMemento(e)}onDidChangeMementoValue(e,i){return this.memento.onDidChangeValue(e,i)}saveState(){}};function ue(r,t,e){let i=null,n=null;if(typeof e.value=="function"?(i="value",n=e.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof e.get=="function"&&(i="get",n=e.get),!n)throw new Error("not supported");let o=`$memoize$${t}`;e[i]=function(...s){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,s)}),this[o]}}var it;(o=>(o.Tap="-monaco-gesturetap",o.Change="-monaco-gesturechange",o.Start="-monaco-gesturestart",o.End="-monaco-gesturesend",o.Contextmenu="-monaco-gesturecontextmenu"))(it||={});var Pr=class Pr extends L{static SCROLL_FRICTION=-.005;static INSTANCE;static HOLD_DELAY=700;dispatched=!1;targets=new ao;ignoreTargets=new ao;handle;activeTouches;_lastSetTapCountTime;static CLEAR_TAP_COUNT_TIME=400;constructor(){super(),this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(O.runAndSubscribe(Wg,({window:t,disposables:e})=>{e.add(M(t.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),e.add(M(t.document,"touchend",i=>this.onTouchEnd(t,i))),e.add(M(t.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:ne,disposables:this._store}))}static addTarget(t){if(!Pr.isTouchDevice())return L.None;Pr.INSTANCE||(Pr.INSTANCE=mc(new Pr));let e=Pr.INSTANCE.targets.push(t);return te(e)}static ignoreTarget(t){if(!Pr.isTouchDevice())return L.None;Pr.INSTANCE||(Pr.INSTANCE=mc(new Pr));let e=Pr.INSTANCE.ignoreTargets.push(t);return te(e)}static isTouchDevice(){return"ontouchstart"in ne||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(t){let e=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=t.targetTouches.length;i<n;i++){let o=t.targetTouches.item(i);this.activeTouches[o.identifier]={id:o.identifier,initialTarget:o.target,initialTimeStamp:e,initialPageX:o.pageX,initialPageY:o.pageY,rollingTimestamps:[e],rollingPageX:[o.pageX],rollingPageY:[o.pageY]};let s=this.newGestureEvent(it.Start,o.target);s.pageX=o.pageX,s.pageY=o.pageY,this.dispatchEvent(s)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}onTouchEnd(t,e){let i=Date.now(),n=Object.keys(this.activeTouches).length;for(let o=0,s=e.changedTouches.length;o<s;o++){let a=e.changedTouches.item(o);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}let l=this.activeTouches[a.identifier],d=Date.now()-l.initialTimeStamp;if(d<Pr.HOLD_DELAY&&Math.abs(l.initialPageX-Vr(l.rollingPageX))<30&&Math.abs(l.initialPageY-Vr(l.rollingPageY))<30){let c=this.newGestureEvent(it.Tap,l.initialTarget);c.pageX=Vr(l.rollingPageX),c.pageY=Vr(l.rollingPageY),this.dispatchEvent(c)}else if(d>=Pr.HOLD_DELAY&&Math.abs(l.initialPageX-Vr(l.rollingPageX))<30&&Math.abs(l.initialPageY-Vr(l.rollingPageY))<30){let c=this.newGestureEvent(it.Contextmenu,l.initialTarget);c.pageX=Vr(l.rollingPageX),c.pageY=Vr(l.rollingPageY),this.dispatchEvent(c)}else if(n===1){let c=Vr(l.rollingPageX),u=Vr(l.rollingPageY),p=Vr(l.rollingTimestamps)-l.rollingTimestamps[0],m=c-l.rollingPageX[0],g=u-l.rollingPageY[0],f=[...this.targets].filter(b=>l.initialTarget instanceof Node&&b.contains(l.initialTarget));this.inertia(t,f,i,Math.abs(m)/p,m>0?1:-1,c,Math.abs(g)/p,g>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(it.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(t,e){let i=document.createEvent("CustomEvent");return i.initEvent(t,!1,!0),i.initialTarget=e,i.tapCount=0,i}dispatchEvent(t){if(t.type===it.Tap){let e=new Date().getTime(),i=0;e-this._lastSetTapCountTime>Pr.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=e,t.tapCount=i}else(t.type===it.Change||t.type===it.Contextmenu)&&(this._lastSetTapCountTime=0);if(t.initialTarget instanceof Node){for(let i of this.ignoreTargets)if(i.contains(t.initialTarget))return;let e=[];for(let i of this.targets)if(i.contains(t.initialTarget)){let n=0,o=t.initialTarget;for(;o&&o!==i;)n++,o=o.parentElement;e.push([n,i])}e.sort((i,n)=>i[0]-n[0]);for(let[i,n]of e)n.dispatchEvent(t),this.dispatched=!0}}inertia(t,e,i,n,o,s,a,l,d){this.handle=nn(t,()=>{let c=Date.now(),u=c-i,p=0,m=0,g=!0;n+=Pr.SCROLL_FRICTION*u,a+=Pr.SCROLL_FRICTION*u,n>0&&(g=!1,p=o*n*u),a>0&&(g=!1,m=l*a*u);let f=this.newGestureEvent(it.Change);f.translationX=p,f.translationY=m,e.forEach(b=>b.dispatchEvent(f)),g||this.inertia(t,e,c,n,o,s+p,a,l,d+m)})}onTouchMove(t){let e=Date.now();for(let i=0,n=t.changedTouches.length;i<n;i++){let o=t.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("end of an UNKNOWN touch",o);continue}let s=this.activeTouches[o.identifier],a=this.newGestureEvent(it.Change,s.initialTarget);a.translationX=o.pageX-Vr(s.rollingPageX),a.translationY=o.pageY-Vr(s.rollingPageY),a.pageX=o.pageX,a.pageY=o.pageY,this.dispatchEvent(a),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(o.pageX),s.rollingPageY.push(o.pageY),s.rollingTimestamps.push(e)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}};_([ue],Pr,"isTouchDevice",1);var Wt=Pr;var Ge=class{emitter;get event(){return this.emitter.event}constructor(t,e,i){let n=o=>this.emitter.fire(o);this.emitter=new T({onWillAddFirstListener:()=>t.addEventListener(e,n,i),onDidRemoveLastListener:()=>t.removeEventListener(e,n,i)})}dispose(){this.emitter.dispose()}};var mae=!1;var gae=4,fae=new T;var bae=300,vae=new T;var qE=class{constructor(t){this.el=t}disposables=new W;get onPointerMove(){return this.disposables.add(new Ge(oe(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Ge(oe(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}};_([ue],qE.prototype,"onPointerMove",1),_([ue],qE.prototype,"onPointerUp",1);var jE=class{constructor(t){this.el=t}disposables=new W;get onPointerMove(){return this.disposables.add(new Ge(this.el,it.Change)).event}get onPointerUp(){return this.disposables.add(new Ge(this.el,it.End)).event}dispose(){this.disposables.dispose()}};_([ue],jE.prototype,"onPointerMove",1),_([ue],jE.prototype,"onPointerUp",1);var Oy=class{constructor(t){this.factory=t}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}};_([ue],Oy.prototype,"onPointerMove",1),_([ue],Oy.prototype,"onPointerUp",1);var WZ="pointer-events-disabled",uf=class r extends L{el;layoutProvider;orientation;size;hoverDelay=bae;hoverDelayer=this._register(new bs(this.hoverDelay));_state=3;onDidEnablementChange=this._register(new T);_onDidStart=this._register(new T);_onDidChange=this._register(new T);_onDidReset=this._register(new T);_onDidEnd=this._register(new T);orthogonalStartSashDisposables=this._register(new W);_orthogonalStartSash;orthogonalStartDragHandleDisposables=this._register(new W);_orthogonalStartDragHandle;orthogonalEndSashDisposables=this._register(new W);_orthogonalEndSash;orthogonalEndDragHandleDisposables=this._register(new W);_orthogonalEndDragHandle;get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(t){this._state!==t&&(this.el.classList.toggle("disabled",t===0),this.el.classList.toggle("minimum",t===1),this.el.classList.toggle("maximum",t===2),this._state=t,this.onDidEnablementChange.fire(t))}onDidStart=this._onDidStart.event;onDidChange=this._onDidChange.event;onDidReset=this._onDidReset.event;onDidEnd=this._onDidEnd.event;linkedSash=void 0;set orthogonalStartSash(t){if(this._orthogonalStartSash!==t){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),t){let e=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=Ee(this.el,re(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(te(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new Ge(this._orthogonalStartDragHandle,"mouseenter")).event(()=>r.onMouseEnter(t),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new Ge(this._orthogonalStartDragHandle,"mouseleave")).event(()=>r.onMouseLeave(t),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(t.onDidEnablementChange.event(e,this)),e(t.state)}this._orthogonalStartSash=t}}set orthogonalEndSash(t){if(this._orthogonalEndSash!==t){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),t){let e=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=Ee(this.el,re(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(te(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new Ge(this._orthogonalEndDragHandle,"mouseenter")).event(()=>r.onMouseEnter(t),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new Ge(this._orthogonalEndDragHandle,"mouseleave")).event(()=>r.onMouseLeave(t),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(t.onDidEnablementChange.event(e,this)),e(t.state)}this._orthogonalEndSash=t}}constructor(t,e,i){super(),this.el=Ee(t,re(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),be&&this.el.classList.add("mac");let n=this._register(new Ge(this.el,"mousedown")).event;this._register(n(u=>this.onPointerStart(u,new qE(t)),this));let o=this._register(new Ge(this.el,"dblclick")).event;this._register(o(this.onPointerDoublePress,this));let s=this._register(new Ge(this.el,"mouseenter")).event;this._register(s(()=>r.onMouseEnter(this)));let a=this._register(new Ge(this.el,"mouseleave")).event;this._register(a(()=>r.onMouseLeave(this))),this._register(Wt.addTarget(this.el));let l=this._register(new Ge(this.el,it.Start)).event;this._register(l(u=>this.onPointerStart(u,new jE(this.el)),this));let d=this._register(new Ge(this.el,it.Tap)).event,c;this._register(d(u=>{if(c){clearTimeout(c),c=void 0,this.onPointerDoublePress(u);return}clearTimeout(c),c=setTimeout(()=>c=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=gae,this._register(fae.event(u=>{this.size=u,this.layout()}))),this._register(vae.event(u=>this.hoverDelay=u)),this.layoutProvider=e,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",mae),this.layout()}onPointerStart(t,e){Te.stop(t);let i=!1;if(!t.__orthogonalSashEvent){let g=this.getOrthogonalSash(t);g&&(i=!0,t.__orthogonalSashEvent=!0,g.onPointerStart(t,new Oy(e)))}if(this.linkedSash&&!t.__linkedSashEvent&&(t.__linkedSashEvent=!0,this.linkedSash.onPointerStart(t,new Oy(e))),!this.state)return;let n=this.el.ownerDocument.getElementsByTagName("iframe");for(let g of n)g.classList.add(WZ);let o=t.pageX,s=t.pageY,a=t.altKey,l={startX:o,currentX:o,startY:s,currentY:s,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);let d=Ho(this.el),c=()=>{let g="";i?g="all-scroll":this.orientation===1?this.state===1?g="s-resize":this.state===2?g="n-resize":g=be?"row-resize":"ns-resize":this.state===1?g="e-resize":this.state===2?g="w-resize":g=be?"col-resize":"ew-resize",d.textContent=`* { cursor: ${g} !important; }`},u=new W;c(),i||this.onDidEnablementChange.event(c,null,u);let p=g=>{Te.stop(g,!1);let f={startX:o,currentX:g.pageX,startY:s,currentY:g.pageY,altKey:a};this._onDidChange.fire(f)},m=g=>{Te.stop(g,!1),d.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(let f of n)f.classList.remove(WZ)};e.onPointerMove(p,null,u),e.onPointerUp(m,null,u),u.add(e)}onPointerDoublePress(t){let e=this.getOrthogonalSash(t);e&&e._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(t,e=!1){t.el.classList.contains("active")?(t.hoverDelayer.cancel(),t.el.classList.add("hover")):t.hoverDelayer.trigger(()=>t.el.classList.add("hover"),t.hoverDelay).then(void 0,()=>{}),!e&&t.linkedSash&&r.onMouseEnter(t.linkedSash,!0)}static onMouseLeave(t,e=!1){t.hoverDelayer.cancel(),t.el.classList.remove("hover"),!e&&t.linkedSash&&r.onMouseLeave(t.linkedSash,!0)}clearSashHoverState(){r.onMouseLeave(this)}layout(){if(this.orientation===0){let t=this.layoutProvider;this.el.style.left=t.getVerticalSashLeft(this)-this.size/2+"px",t.getVerticalSashTop&&(this.el.style.top=t.getVerticalSashTop(this)+"px"),t.getVerticalSashHeight&&(this.el.style.height=t.getVerticalSashHeight(this)+"px")}else{let t=this.layoutProvider;this.el.style.top=t.getHorizontalSashTop(this)-this.size/2+"px",t.getHorizontalSashLeft&&(this.el.style.left=t.getHorizontalSashLeft(this)+"px"),t.getHorizontalSashWidth&&(this.el.style.width=t.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(t){let e=t.initialTarget??t.target;if(!(!e||!Oi(e))&&e.classList.contains("orthogonal-drag-handle"))return e.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}};var pf=class{constructor(t){this.domNode=t}_maxWidth="";_width="";_height="";_top="";_left="";_bottom="";_right="";_paddingTop="";_paddingLeft="";_paddingBottom="";_paddingRight="";_fontFamily="";_fontWeight="";_fontSize="";_fontStyle="";_fontFeatureSettings="";_fontVariationSettings="";_textDecoration="";_lineHeight="";_letterSpacing="";_className="";_display="";_position="";_visibility="";_color="";_backgroundColor="";_layerHint=!1;_contain="none";_boxShadow="";setMaxWidth(t){let e=ma(t);this._maxWidth!==e&&(this._maxWidth=e,this.domNode.style.maxWidth=this._maxWidth)}setWidth(t){let e=ma(t);this._width!==e&&(this._width=e,this.domNode.style.width=this._width)}setHeight(t){let e=ma(t);this._height!==e&&(this._height=e,this.domNode.style.height=this._height)}setTop(t){let e=ma(t);this._top!==e&&(this._top=e,this.domNode.style.top=this._top)}setLeft(t){let e=ma(t);this._left!==e&&(this._left=e,this.domNode.style.left=this._left)}setBottom(t){let e=ma(t);this._bottom!==e&&(this._bottom=e,this.domNode.style.bottom=this._bottom)}setRight(t){let e=ma(t);this._right!==e&&(this._right=e,this.domNode.style.right=this._right)}setPaddingTop(t){let e=ma(t);this._paddingTop!==e&&(this._paddingTop=e,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(t){let e=ma(t);this._paddingLeft!==e&&(this._paddingLeft=e,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(t){let e=ma(t);this._paddingBottom!==e&&(this._paddingBottom=e,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(t){let e=ma(t);this._paddingRight!==e&&(this._paddingRight=e,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(t){let e=ma(t);this._fontSize!==e&&(this._fontSize=e,this.domNode.style.fontSize=this._fontSize)}setFontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(t){this._fontFeatureSettings!==t&&(this._fontFeatureSettings=t,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(t){this._fontVariationSettings!==t&&(this._fontVariationSettings=t,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(t){this._textDecoration!==t&&(this._textDecoration=t,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(t){let e=ma(t);this._lineHeight!==e&&(this._lineHeight=e,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(t){let e=ma(t);this._letterSpacing!==e&&(this._letterSpacing=e,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(t){this._className!==t&&(this._className=t,this.domNode.className=this._className)}toggleClassName(t,e){this.domNode.classList.toggle(t,e),this._className=this.domNode.className}setDisplay(t){this._display!==t&&(this._display=t,this.domNode.style.display=this._display)}setPosition(t){this._position!==t&&(this._position=t,this.domNode.style.position=this._position)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this.domNode.style.visibility=this._visibility)}setColor(t){this._color!==t&&(this._color=t,this.domNode.style.color=this._color)}setBackgroundColor(t){this._backgroundColor!==t&&(this._backgroundColor=t,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(t){this._layerHint!==t&&(this._layerHint=t,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(t){this._boxShadow!==t&&(this._boxShadow=t,this.domNode.style.boxShadow=t)}setContain(t){this._contain!==t&&(this._contain=t,this.domNode.style.contain=this._contain)}setAttribute(t,e){this.domNode.setAttribute(t,e)}removeAttribute(t){this.domNode.removeAttribute(t)}appendChild(t){this.domNode.appendChild(t.domNode)}removeChild(t){this.domNode.removeChild(t.domNode)}};function ma(r){return typeof r=="number"?`${r}px`:r}function ut(r){return new pf(r)}var Yc=class{_hooks=new W;_pointerMoveCallback=null;_onStopCallback=null;dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(t,e){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let i=this._onStopCallback;this._onStopCallback=null,t&&i&&i(e)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(t,e,i,n,o){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=o;let s=t;try{t.setPointerCapture(e),this._hooks.add(te(()=>{try{t.releasePointerCapture(e)}catch{}}))}catch{s=oe(t)}this._hooks.add(M(s,G.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(M(s,G.POINTER_UP,a=>this.stopMonitoring(!0)))}};var eo=class extends L{onclick(t,e){this._register(M(t,G.CLICK,i=>e(new ri(oe(t),i))))}onmousedown(t,e){this._register(M(t,G.MOUSE_DOWN,i=>e(new ri(oe(t),i))))}onmouseover(t,e){this._register(M(t,G.MOUSE_OVER,i=>e(new ri(oe(t),i))))}onmouseleave(t,e){this._register(M(t,G.MOUSE_LEAVE,i=>e(new ri(oe(t),i))))}onkeydown(t,e){this._register(M(t,G.KEY_DOWN,i=>e(new st(i))))}onkeyup(t,e){this._register(M(t,G.KEY_UP,i=>e(new st(i))))}oninput(t,e){this._register(M(t,G.INPUT,e))}onblur(t,e){this._register(M(t,G.BLUR,e))}onfocus(t,e){this._register(M(t,G.FOCUS,e))}onchange(t,e){this._register(M(t,G.CHANGE,e))}ignoreGesture(t){return Wt.ignoreTarget(t)}};var tm=11,lA=class extends eo{_onActivate;bgDomNode;domNode;_pointerdownRepeatTimer;_pointerdownScheduleRepeatTimer;_pointerMoveMonitor;constructor(t){super(),this._onActivate=t.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=t.bgWidth+"px",this.bgDomNode.style.height=t.bgHeight+"px",typeof t.top<"u"&&(this.bgDomNode.style.top="0px"),typeof t.left<"u"&&(this.bgDomNode.style.left="0px"),typeof t.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof t.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=t.className,this.domNode.classList.add(...ye.asClassNameArray(t.icon)),this.domNode.style.position="absolute",this.domNode.style.width=tm+"px",this.domNode.style.height=tm+"px",typeof t.top<"u"&&(this.domNode.style.top=t.top+"px"),typeof t.left<"u"&&(this.domNode.style.left=t.left+"px"),typeof t.bottom<"u"&&(this.domNode.style.bottom=t.bottom+"px"),typeof t.right<"u"&&(this.domNode.style.right=t.right+"px"),this._pointerMoveMonitor=this._register(new Yc),this._register(Wi(this.bgDomNode,G.POINTER_DOWN,e=>this._arrowPointerDown(e))),this._register(Wi(this.domNode,G.POINTER_DOWN,e=>this._arrowPointerDown(e))),this._pointerdownRepeatTimer=this._register(new Uv),this._pointerdownScheduleRepeatTimer=this._register(new td)}_arrowPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let e=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,oe(t))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(e,200),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),t.preventDefault()}};var im=class r{_scrollbarSize;_oppositeScrollbarSize;_arrowSize;_visibleSize;_scrollSize;_scrollPosition;_computedAvailableSize;_computedIsNeeded;_computedSliderSize;_computedSliderRatio;_computedSliderPosition;constructor(t,e,i,n,o,s){this._scrollbarSize=Math.round(e),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(t),this._visibleSize=n,this._scrollSize=o,this._scrollPosition=s,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new r(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(t){let e=Math.round(t);return this._visibleSize!==e?(this._visibleSize=e,this._refreshComputedValues(),!0):!1}setScrollSize(t){let e=Math.round(t);return this._scrollSize!==e?(this._scrollSize=e,this._refreshComputedValues(),!0):!1}setScrollPosition(t){let e=Math.round(t);return this._scrollPosition!==e?(this._scrollPosition=e,this._refreshComputedValues(),!0):!1}setScrollbarSize(t){this._scrollbarSize=Math.round(t)}setOppositeScrollbarSize(t){this._oppositeScrollbarSize=Math.round(t)}static _computeValues(t,e,i,n,o){let s=Math.max(0,i-t),a=Math.max(0,s-2*e),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};let d=Math.round(Math.max(20,Math.floor(i*a/n))),c=(a-d)/(n-i),u=o*c;return{computedAvailableSize:Math.round(s),computedIsNeeded:l,computedSliderSize:Math.round(d),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){let t=r._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=t.computedAvailableSize,this._computedIsNeeded=t.computedIsNeeded,this._computedSliderSize=t.computedSliderSize,this._computedSliderRatio=t.computedSliderRatio,this._computedSliderPosition=t.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(t){if(!this._computedIsNeeded)return 0;let e=t-this._arrowSize-this._computedSliderSize/2;return Math.round(e/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(t){if(!this._computedIsNeeded)return 0;let e=t-this._arrowSize,i=this._scrollPosition;return e<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(t){if(!this._computedIsNeeded)return 0;let e=this._computedSliderPosition+t;return Math.round(e/this._computedSliderRatio)}};var dA=class extends L{_visibility;_visibleClassName;_invisibleClassName;_domNode;_rawShouldBeVisible;_shouldBeVisible;_isNeeded;_isVisible;_revealTimer;constructor(t,e,i){super(),this._visibility=t,this._visibleClassName=e,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new td)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this._updateShouldBeVisible())}setShouldBeVisible(t){this._rawShouldBeVisible=t,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let t=this._applyVisibilitySetting();this._shouldBeVisible!==t&&(this._shouldBeVisible=t,this.ensureVisibility())}setIsNeeded(t){this._isNeeded!==t&&(this._isNeeded=t,this.ensureVisibility())}setDomNode(t){this._domNode=t,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(t){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(t?" fade":"")))}};var yae=140,Ny=class extends eo{_host;_scrollable;_scrollByPage;_lazyRender;_scrollbarState;_visibilityController;_pointerMoveMonitor;domNode;slider;_shouldRender;constructor(t){super(),this._lazyRender=t.lazyRender,this._host=t.host,this._scrollable=t.scrollable,this._scrollByPage=t.scrollByPage,this._scrollbarState=t.scrollbarState,this._visibilityController=this._register(new dA(t.visibility,"visible scrollbar "+t.extraScrollbarClassName,"invisible scrollbar "+t.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Yc),this._shouldRender=!0,this.domNode=ut(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(M(this.domNode.domNode,G.POINTER_DOWN,e=>this._domNodePointerDown(e)))}_createArrow(t){let e=this._register(new lA(t));this.domNode.domNode.appendChild(e.bgDomNode),this.domNode.domNode.appendChild(e.domNode)}_createSlider(t,e,i,n){this.slider=ut(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(t),this.slider.setLeft(e),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(M(this.slider.domNode,G.POINTER_DOWN,o=>{o.button===0&&(o.preventDefault(),this._sliderPointerDown(o))})),this.onclick(this.slider.domNode,o=>{o.leftButton&&o.stopPropagation()})}_onElementSize(t){return this._scrollbarState.setVisibleSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(t){return this._scrollbarState.setScrollSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(t){return this._scrollbarState.setScrollPosition(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(t){t.target===this.domNode.domNode&&this._onPointerDown(t)}delegatePointerDown(t){let e=this.domNode.domNode.getClientRects()[0].top,i=e+this._scrollbarState.getSliderPosition(),n=e+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderPointerPosition(t);i<=o&&o<=n?t.button===0&&(t.preventDefault(),this._sliderPointerDown(t)):this._onPointerDown(t)}_onPointerDown(t){let e,i;if(t.target===this.domNode.domNode&&typeof t.offsetX=="number"&&typeof t.offsetY=="number")e=t.offsetX,i=t.offsetY;else{let o=To(this.domNode.domNode);e=t.pageX-o.left,i=t.pageY-o.top}let n=this._pointerDownRelativePosition(e,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),t.button===0&&(t.preventDefault(),this._sliderPointerDown(t))}_sliderPointerDown(t){if(!t.target||!(t.target instanceof Element))return;let e=this._sliderPointerPosition(t),i=this._sliderOrthogonalPointerPosition(t),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,o=>{let s=this._sliderOrthogonalPointerPosition(o),a=Math.abs(s-i);if(rt&&a>yae){this._setDesiredScrollPositionNow(n.getScrollPosition());return}let d=this._sliderPointerPosition(o)-e;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(t){let e={};this.writeScrollPosition(e,t),this._scrollable.setScrollPositionNow(e)}updateScrollbarSize(t){this._updateScrollbarSize(t),this._scrollbarState.setScrollbarSize(t),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}};var cA=class extends Ny{constructor(t,e,i){let n=t.getScrollDimensions(),o=t.getCurrentScrollPosition();if(super({lazyRender:e.lazyRender,host:i,scrollbarState:new im(e.horizontalHasArrows?e.arrowSize:0,e.horizontal===2?0:e.horizontalScrollbarSize,e.vertical===2?0:e.verticalScrollbarSize,n.width,n.scrollWidth,o.scrollLeft),visibility:e.horizontal,extraScrollbarClassName:"horizontal",scrollable:t,scrollByPage:e.scrollByPage}),e.horizontalHasArrows){let s=(e.arrowSize-tm)/2,a=(e.horizontalScrollbarSize-tm)/2;this._createArrow({className:"scra",icon:B.scrollbarButtonLeft,top:a,left:s,bottom:void 0,right:void 0,bgWidth:e.arrowSize,bgHeight:e.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Aa(null,1,0))}),this._createArrow({className:"scra",icon:B.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:s,bgWidth:e.arrowSize,bgHeight:e.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Aa(null,-1,0))})}this._createSlider(Math.floor((e.horizontalScrollbarSize-e.horizontalSliderSize)/2),0,void 0,e.horizontalSliderSize)}_updateSlider(t,e){this.slider.setWidth(t),this.slider.setLeft(e)}_renderDomNode(t,e){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(t.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,e){return t}_sliderPointerPosition(t){return t.pageX}_sliderOrthogonalPointerPosition(t){return t.pageY}_updateScrollbarSize(t){this.slider.setHeight(t)}writeScrollPosition(t,e){t.scrollLeft=e}updateOptions(t){this.updateScrollbarSize(t.horizontal===2?0:t.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._visibilityController.setVisibility(t.horizontal),this._scrollByPage=t.scrollByPage}};var uA=class extends Ny{constructor(t,e,i){let n=t.getScrollDimensions(),o=t.getCurrentScrollPosition();if(super({lazyRender:e.lazyRender,host:i,scrollbarState:new im(e.verticalHasArrows?e.arrowSize:0,e.vertical===2?0:e.verticalScrollbarSize,0,n.height,n.scrollHeight,o.scrollTop),visibility:e.vertical,extraScrollbarClassName:"vertical",scrollable:t,scrollByPage:e.scrollByPage}),e.verticalHasArrows){let s=(e.arrowSize-tm)/2,a=(e.verticalScrollbarSize-tm)/2;this._createArrow({className:"scra",icon:B.scrollbarButtonUp,top:s,left:a,bottom:void 0,right:void 0,bgWidth:e.verticalScrollbarSize,bgHeight:e.arrowSize,onActivate:()=>this._host.onMouseWheel(new Aa(null,0,1))}),this._createArrow({className:"scra",icon:B.scrollbarButtonDown,top:void 0,left:a,bottom:s,right:void 0,bgWidth:e.verticalScrollbarSize,bgHeight:e.arrowSize,onActivate:()=>this._host.onMouseWheel(new Aa(null,0,-1))})}this._createSlider(0,Math.floor((e.verticalScrollbarSize-e.verticalSliderSize)/2),e.verticalSliderSize,void 0)}_updateSlider(t,e){this.slider.setHeight(t),this.slider.setTop(e)}_renderDomNode(t,e){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(t.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,e){return e}_sliderPointerPosition(t){return t.pageY}_sliderOrthogonalPointerPosition(t){return t.pageX}_updateScrollbarSize(t){this.slider.setWidth(t)}writeScrollPosition(t,e){t.scrollTop=e}updateOptions(t){this.updateScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(t.vertical),this._scrollByPage=t.scrollByPage}};var Iae=500,UZ=50,HZ=!0,XH=class{timestamp;deltaX;deltaY;score;constructor(t,e,i){this.timestamp=t,this.deltaX=e,this.deltaY=i,this.score=0}},$E=class r{static INSTANCE=new r;_capacity;_memory;_front;_rear;constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let t=1,e=0,i=1,n=this._rear;do{let o=n===this._front?t:Math.pow(2,-i);if(t-=o,e+=this._memory[n].score*o,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return e<=.5}acceptStandardWheelEvent(t){if(xc){let e=oe(t.browserEvent),i=ap(e);this.accept(Date.now(),t.deltaX*i,t.deltaY*i)}else this.accept(Date.now(),t.deltaX,t.deltaY)}accept(t,e,i){let n=null,o=new XH(t,e,i);this._front===-1&&this._rear===-1?(this._memory[0]=o,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=o),o.score=this._computeScore(o,n)}_computeScore(t,e){if(Math.abs(t.deltaX)>0&&Math.abs(t.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(t.deltaX)||!this._isAlmostInt(t.deltaY))&&(i+=.25),e){let n=Math.abs(t.deltaX),o=Math.abs(t.deltaY),s=Math.abs(e.deltaX),a=Math.abs(e.deltaY),l=Math.max(Math.min(n,s),1),d=Math.max(Math.min(o,a),1),c=Math.max(n,s),u=Math.max(o,a);c%l===0&&u%d===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(t){return Math.abs(Math.round(t)-t)<.01}},YE=class extends eo{_options;_scrollable;_verticalScrollbar;_horizontalScrollbar;_domNode;_leftShadowDomNode;_topShadowDomNode;_topLeftShadowDomNode;_listenOnDomNode;_mouseWheelToDispose;_isDragging;_mouseIsOver;_hideTimeout;_shouldRender;_revealOnScroll;_onScroll=this._register(new T);onScroll=this._onScroll.event;_onWillScroll=this._register(new T);onWillScroll=this._onWillScroll.event;get options(){return this._options}constructor(t,e,i){super(),t.style.overflow="hidden",this._options=Cae(e),this._scrollable=i,this._register(this._scrollable.onScroll(o=>{this._onWillScroll.fire(o),this._onDidScroll(o),this._onScroll.fire(o)}));let n={onMouseWheel:o=>this._onMouseWheel(o),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new uA(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new cA(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(t),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=ut(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=ut(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=ut(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,o=>this._onMouseOver(o)),this.onmouseleave(this._listenOnDomNode,o=>this._onMouseLeave(o)),this._hideTimeout=this._register(new td),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=nt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(t){this._verticalScrollbar.delegatePointerDown(t)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(t){this._scrollable.setScrollDimensions(t,!1)}updateClassName(t){this._options.className=t,be&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(t){typeof t.handleMouseWheel<"u"&&(this._options.handleMouseWheel=t.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof t.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=t.mouseWheelScrollSensitivity),typeof t.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=t.fastScrollSensitivity),typeof t.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=t.scrollPredominantAxis),typeof t.horizontal<"u"&&(this._options.horizontal=t.horizontal),typeof t.vertical<"u"&&(this._options.vertical=t.vertical),typeof t.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=t.horizontalScrollbarSize),typeof t.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=t.verticalScrollbarSize),typeof t.scrollByPage<"u"&&(this._options.scrollByPage=t.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(t){this._revealOnScroll=t}delegateScrollFromMouseWheelEvent(t){this._onMouseWheel(new Aa(t))}_setListeningToMouseWheel(t){if(this._mouseWheelToDispose.length>0!==t&&(this._mouseWheelToDispose=nt(this._mouseWheelToDispose),t)){let i=n=>{this._onMouseWheel(new Aa(n))};this._mouseWheelToDispose.push(M(this._listenOnDomNode,G.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(t){if(t.browserEvent?.defaultPrevented)return;let e=$E.INSTANCE;HZ&&e.acceptStandardWheelEvent(t);let i=!1;if(t.deltaY||t.deltaX){let o=t.deltaY*this._options.mouseWheelScrollSensitivity,s=t.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+o===0?s=o=0:Math.abs(o)>=Math.abs(s)?s=0:o=0),this._options.flipAxes&&([o,s]=[s,o]);let a=!be&&t.browserEvent&&t.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!s&&(s=o,o=0),t.browserEvent&&t.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),d={};if(o){let c=UZ*o,u=l.scrollTop-(c<0?Math.floor(c):Math.ceil(c));this._verticalScrollbar.writeScrollPosition(d,u)}if(s){let c=UZ*s,u=l.scrollLeft-(c<0?Math.floor(c):Math.ceil(c));this._horizontalScrollbar.writeScrollPosition(d,u)}d=this._scrollable.validateScrollPosition(d),(l.scrollLeft!==d.scrollLeft||l.scrollTop!==d.scrollTop)&&(HZ&&this._options.mouseWheelSmoothScroll&&e.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(t.preventDefault(),t.stopPropagation())}_onDidScroll(t){this._shouldRender=this._horizontalScrollbar.onDidScroll(t)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(t)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let t=this._scrollable.getCurrentScrollPosition(),e=t.scrollTop>0,i=t.scrollLeft>0,n=i?" left":"",o=e?" top":"",s=i||e?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${o}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(t){this._mouseIsOver=!1,this._hide()}_onMouseOver(t){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),Iae)}},Fy=class extends YE{constructor(t,e){e=e||{},e.mouseWheelSmoothScroll=!1;let i=new fd({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>nn(oe(t),n)});super(t,e,i),this._register(i)}setScrollPosition(t){this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},nm=class extends YE{constructor(t,e,i){super(t,e,i)}setScrollPosition(t){t.reuseAnimation?this._scrollable.setScrollPositionSmooth(t,t.reuseAnimation):this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}},Rd=class extends YE{_element;constructor(t,e){e=e||{},e.mouseWheelSmoothScroll=!1;let i=new fd({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>nn(oe(t),n)});super(t,e,i),this._register(i),this._element=t,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(t){this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}};function Cae(r){let t={lazyRender:typeof r.lazyRender<"u"?r.lazyRender:!1,className:typeof r.className<"u"?r.className:"",useShadows:typeof r.useShadows<"u"?r.useShadows:!0,handleMouseWheel:typeof r.handleMouseWheel<"u"?r.handleMouseWheel:!0,flipAxes:typeof r.flipAxes<"u"?r.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof r.consumeMouseWheelIfScrollbarIsNeeded<"u"?r.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof r.alwaysConsumeMouseWheel<"u"?r.alwaysConsumeMouseWheel:!1,scrollYToX:typeof r.scrollYToX<"u"?r.scrollYToX:!1,mouseWheelScrollSensitivity:typeof r.mouseWheelScrollSensitivity<"u"?r.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof r.fastScrollSensitivity<"u"?r.fastScrollSensitivity:5,scrollPredominantAxis:typeof r.scrollPredominantAxis<"u"?r.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof r.mouseWheelSmoothScroll<"u"?r.mouseWheelSmoothScroll:!0,arrowSize:typeof r.arrowSize<"u"?r.arrowSize:11,listenOnDomNode:typeof r.listenOnDomNode<"u"?r.listenOnDomNode:null,horizontal:typeof r.horizontal<"u"?r.horizontal:1,horizontalScrollbarSize:typeof r.horizontalScrollbarSize<"u"?r.horizontalScrollbarSize:10,horizontalSliderSize:typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:0,horizontalHasArrows:typeof r.horizontalHasArrows<"u"?r.horizontalHasArrows:!1,vertical:typeof r.vertical<"u"?r.vertical:1,verticalScrollbarSize:typeof r.verticalScrollbarSize<"u"?r.verticalScrollbarSize:10,verticalHasArrows:typeof r.verticalHasArrows<"u"?r.verticalHasArrows:!1,verticalSliderSize:typeof r.verticalSliderSize<"u"?r.verticalSliderSize:0,scrollByPage:typeof r.scrollByPage<"u"?r.scrollByPage:!1};return t.horizontalSliderSize=typeof r.horizontalSliderSize<"u"?r.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=typeof r.verticalSliderSize<"u"?r.verticalSliderSize:t.verticalScrollbarSize,be&&(t.className+=" mac"),t}var wae={separatorBorder:Y.transparent};var pA=class{constructor(t,e,i,n){this.container=t;this.view=e;this.disposable=n;typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,t.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}_size;set size(t){this._size=t}get size(){return this._size}_cachedVisibleSize=void 0;get cachedVisibleSize(){return this._cachedVisibleSize}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(t,e){if(t!==this.visible){t?(this.size=sr(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof e=="number"?e:this.size,this.size=0),this.container.classList.toggle("visible",t);try{this.view.setVisible?.(t)}catch(i){console.error("Splitview: Failed to set visible view"),console.error(i)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(t){this.container.style.pointerEvents=t?"":"none"}layout(t,e){this.layoutContainer(t);try{this.view.layout(this.size,t,e)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}},QH=class extends pA{layoutContainer(t){this.container.style.top=`${t}px`,this.container.style.height=`${this.size}px`}},JH=class extends pA{layoutContainer(t){this.container.style.left=`${t}px`,this.container.style.width=`${this.size}px`}};var lr;(n=>{n.Distribute={type:"distribute"};function t(o){return{type:"split",index:o}}n.Split=t;function e(o){return{type:"auto",index:o}}n.Auto=e;function i(o){return{type:"invisible",cachedVisibleSize:o}}n.Invisible=i})(lr||={});var El=class extends L{orientation;el;sashContainer;viewContainer;scrollable;scrollableElement;size=0;layoutContext;_contentSize=0;proportions=void 0;viewItems=[];sashItems=[];sashDragState;state=0;inverseAltBehavior;proportionalLayout;getSashOrthogonalSize;_onDidSashChange=this._register(new T);_onDidSashReset=this._register(new T);_orthogonalStartSash;_orthogonalEndSash;_startSnappingEnabled=!0;_endSnappingEnabled=!0;get contentSize(){return this._contentSize}onDidSashChange=this._onDidSashChange.event;onDidSashReset=this._onDidSashReset.event;onDidScroll;get length(){return this.viewItems.length}get minimumSize(){return this.viewItems.reduce((t,e)=>t+e.minimumSize,0)}get maximumSize(){return this.length===0?Number.POSITIVE_INFINITY:this.viewItems.reduce((t,e)=>t+e.maximumSize,0)}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(t){for(let e of this.sashItems)e.sash.orthogonalStartSash=t;this._orthogonalStartSash=t}set orthogonalEndSash(t){for(let e of this.sashItems)e.sash.orthogonalEndSash=t;this._orthogonalEndSash=t}get sashes(){return this.sashItems.map(t=>t.sash)}set startSnappingEnabled(t){this._startSnappingEnabled!==t&&(this._startSnappingEnabled=t,this.updateSashEnablement())}set endSnappingEnabled(t){this._endSnappingEnabled!==t&&(this._endSnappingEnabled=t,this.updateSashEnablement())}constructor(t,e={}){super(),this.orientation=e.orientation??0,this.inverseAltBehavior=e.inverseAltBehavior??!1,this.proportionalLayout=e.proportionalLayout??!0,this.getSashOrthogonalSize=e.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),t.appendChild(this.el),this.sashContainer=Ee(this.el,re(".sash-container")),this.viewContainer=re(".split-view-container"),this.scrollable=this._register(new fd({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>nn(oe(this.el),n)})),this.scrollableElement=this._register(new nm(this.viewContainer,{vertical:this.orientation===0?e.scrollbarVisibility??1:2,horizontal:this.orientation===1?e.scrollbarVisibility??1:2},this.scrollable));let i=this._register(new Ge(this.viewContainer,"scroll")).event;this._register(i(n=>{let o=this.scrollableElement.getScrollPosition(),s=Math.abs(this.viewContainer.scrollLeft-o.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-o.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(s!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:s,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),Ee(this.el,this.scrollableElement.getDomNode()),this.style(e.styles||wae),e.descriptor&&(this.size=e.descriptor.size,e.descriptor.views.forEach((n,o)=>{let s=Vn(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,s,o,!0)}),this._contentSize=this.viewItems.reduce((n,o)=>n+o.size,0),this.saveProportions())}style(t){t.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",t.separatorBorder.toString()))}addView(t,e,i=this.viewItems.length,n){this.doAddView(t,e,i,n)}removeView(t,e){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{e?.type==="auto"&&(this.areViewsDistributed()?e={type:"distribute"}:e={type:"split",index:e.index});let i=e?.type==="split"?this.viewItems[e.index]:void 0,n=this.viewItems.splice(t,1)[0];if(i&&(i.size+=n.size),this.viewItems.length>=1){let s=Math.max(t-1,0);this.sashItems.splice(s,1)[0].disposable.dispose()}this.relayout(),e?.type==="distribute"&&this.distributeViewSizes();let o=n.view;return n.dispose(),o}finally{this.state=0}}removeAllViews(){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let t=this.viewItems.splice(0,this.viewItems.length);for(let i of t)i.dispose();let e=this.sashItems.splice(0,this.sashItems.length);for(let i of e)i.disposable.dispose();return this.relayout(),t.map(i=>i.view)}finally{this.state=0}}moveView(t,e){if(this.state!==0)throw new Error("Cant modify splitview");let i=this.getViewCachedVisibleSize(t),n=typeof i>"u"?this.getViewSize(t):lr.Invisible(i),o=this.removeView(t);this.addView(o,n,e)}swapViews(t,e){if(this.state!==0)throw new Error("Cant modify splitview");if(t>e)return this.swapViews(e,t);let i=this.getViewSize(t),n=this.getViewSize(e),o=this.removeView(e),s=this.removeView(t);this.addView(o,i,t),this.addView(s,n,e)}isViewVisible(t){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[t].visible}setViewVisible(t,e){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");this.viewItems[t].setVisible(e),this.distributeEmptySpace(t),this.layoutViews(),this.saveProportions()}getViewCachedVisibleSize(t){if(t<0||t>=this.viewItems.length)throw new Error("Index out of bounds");return this.viewItems[t].cachedVisibleSize}layout(t,e){let i=Math.max(this.size,this._contentSize);if(this.size=t,this.layoutContext=e,this.proportions){let n=0;for(let o=0;o<this.viewItems.length;o++){let s=this.viewItems[o],a=this.proportions[o];typeof a=="number"?n+=a:t-=s.size}for(let o=0;o<this.viewItems.length;o++){let s=this.viewItems[o],a=this.proportions[o];typeof a=="number"&&n>0&&(s.size=sr(Math.round(a*t/n),s.minimumSize,s.maximumSize))}}else{let n=Io(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,t-i,void 0,o,s)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(t=>t.proportionalLayout&&t.visible?t.size/this._contentSize:void 0))}onSashStart({sash:t,start:e,alt:i}){for(let a of this.viewItems)a.enabled=!1;let n=this.sashItems.findIndex(a=>a.sash===t),o=Ln(M(this.el.ownerDocument.body,"keydown",a=>s(this.sashDragState.current,a.altKey)),M(this.el.ownerDocument.body,"keyup",()=>s(this.sashDragState.current,!1))),s=(a,l)=>{let d=this.viewItems.map(g=>g.size),c=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){let f=this.viewItems[n];c=(f.minimumSize-f.size)/2,u=(f.maximumSize-f.size)/2}else{let f=this.viewItems[n+1];c=(f.size-f.maximumSize)/2,u=(f.size-f.minimumSize)/2}let p,m;if(!l){let g=Io(n,-1),f=Io(n+1,this.viewItems.length),b=g.reduce((R,A)=>R+(this.viewItems[A].minimumSize-d[A]),0),y=g.reduce((R,A)=>R+(this.viewItems[A].viewMaximumSize-d[A]),0),I=f.length===0?Number.POSITIVE_INFINITY:f.reduce((R,A)=>R+(d[A]-this.viewItems[A].minimumSize),0),E=f.length===0?Number.NEGATIVE_INFINITY:f.reduce((R,A)=>R+(d[A]-this.viewItems[A].viewMaximumSize),0),S=Math.max(b,E),w=Math.min(I,y),D=this.findFirstSnapIndex(g),k=this.findFirstSnapIndex(f);if(typeof D=="number"){let R=this.viewItems[D],A=Math.floor(R.viewMinimumSize/2);p={index:D,limitDelta:R.visible?S-A:S+A,size:R.size}}if(typeof k=="number"){let R=this.viewItems[k],A=Math.floor(R.viewMinimumSize/2);m={index:k,limitDelta:R.visible?w+A:w-A,size:R.size}}}this.sashDragState={start:a,current:a,index:n,sizes:d,minDelta:c,maxDelta:u,alt:l,snapBefore:p,snapAfter:m,disposable:o}};s(e,i)}onSashChange({current:t}){let{index:e,start:i,sizes:n,alt:o,minDelta:s,maxDelta:a,snapBefore:l,snapAfter:d}=this.sashDragState;this.sashDragState.current=t;let c=t-i,u=this.resize(e,c,n,void 0,void 0,s,a,l,d);if(o){let p=e===this.sashItems.length-1,m=this.viewItems.map(E=>E.size),g=p?e:e+1,f=this.viewItems[g],b=f.size-f.maximumSize,y=f.size-f.minimumSize,I=p?e-1:e+1;this.resize(I,-u,m,void 0,void 0,b,y)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(t){this._onDidSashChange.fire(t),this.sashDragState.disposable.dispose(),this.saveProportions();for(let e of this.viewItems)e.enabled=!0}onViewChange(t,e){let i=this.viewItems.indexOf(t);i<0||i>=this.viewItems.length||(e=typeof e=="number"?e:t.size,e=sr(e,t.minimumSize,t.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((t.size-e)/2)),this.distributeEmptySpace(),this.layoutViews()):(t.size=e,this.relayout([i],void 0)))}resizeView(t,e){if(!(t<0||t>=this.viewItems.length)){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let i=Io(this.viewItems.length).filter(a=>a!==t),n=[...i.filter(a=>this.viewItems[a].priority===1),t],o=i.filter(a=>this.viewItems[a].priority===2),s=this.viewItems[t];e=Math.round(e),e=sr(e,s.minimumSize,Math.min(s.maximumSize,this.size)),s.size=e,this.relayout(n,o)}finally{this.state=0}}}isViewExpanded(t){if(t<0||t>=this.viewItems.length)return!1;for(let e of this.viewItems)if(e!==this.viewItems[t]&&e.size>e.minimumSize)return!1;return!0}distributeViewSizes(){let t=[],e=0;for(let a of this.viewItems)a.maximumSize-a.minimumSize>0&&(t.push(a),e+=a.size);let i=Math.floor(e/t.length);for(let a of t)a.size=sr(i,a.minimumSize,a.maximumSize);let n=Io(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);this.relayout(o,s)}getViewSize(t){return t<0||t>=this.viewItems.length?-1:this.viewItems[t].size}doAddView(t,e,i=this.viewItems.length,n){if(this.state!==0)throw new Error("Cant modify splitview");this.state=1;try{let o=re(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(o):this.viewContainer.insertBefore(o,this.viewContainer.children.item(i));let s=t.onDidChange(p=>this.onViewChange(c,p)),a=te(()=>o.remove()),l=Ln(s,a),d;typeof e=="number"?d=e:(e.type==="auto"&&(this.areViewsDistributed()?e={type:"distribute"}:e={type:"split",index:e.index}),e.type==="split"?d=this.getViewSize(e.index)/2:e.type==="invisible"?d={cachedVisibleSize:e.cachedVisibleSize}:d=t.minimumSize);let c=this.orientation===0?new QH(o,t,d,l):new JH(o,t,d,l);if(this.viewItems.splice(i,0,c),this.viewItems.length>1){let p={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},m=this.orientation===0?new uf(this.sashContainer,{getHorizontalSashTop:R=>this.getSashPosition(R),getHorizontalSashWidth:this.getSashOrthogonalSize},{...p,orientation:1}):new uf(this.sashContainer,{getVerticalSashLeft:R=>this.getSashPosition(R),getVerticalSashHeight:this.getSashOrthogonalSize},{...p,orientation:0}),g=this.orientation===0?R=>({sash:m,start:R.startY,current:R.currentY,alt:R.altKey}):R=>({sash:m,start:R.startX,current:R.currentX,alt:R.altKey}),b=O.map(m.onDidStart,g)(this.onSashStart,this),I=O.map(m.onDidChange,g)(this.onSashChange,this),S=O.map(m.onDidEnd,()=>this.sashItems.findIndex(R=>R.sash===m))(this.onSashEnd,this),w=m.onDidReset(()=>{let R=this.sashItems.findIndex(fe=>fe.sash===m),A=Io(R,-1),H=Io(R+1,this.viewItems.length),z=this.findFirstSnapIndex(A),Z=this.findFirstSnapIndex(H);typeof z=="number"&&!this.viewItems[z].visible||typeof Z=="number"&&!this.viewItems[Z].visible||this._onDidSashReset.fire(R)}),D=Ln(b,I,S,w,m),k={sash:m,disposable:D};this.sashItems.splice(i-1,0,k)}o.appendChild(t.element);let u;typeof e!="number"&&e.type==="split"&&(u=[e.index]),n||this.relayout([i],u),!n&&typeof e!="number"&&e.type==="distribute"&&this.distributeViewSizes()}finally{this.state=0}}relayout(t,e){let i=this.viewItems.reduce((n,o)=>n+o.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,t,e),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(t,e,i=this.viewItems.map(c=>c.size),n,o,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,d){if(t<0||t>=this.viewItems.length)return 0;let c=Io(t,-1),u=Io(t+1,this.viewItems.length);if(o)for(let k of o)q_(c,k),q_(u,k);if(n)for(let k of n)BS(c,k),BS(u,k);let p=c.map(k=>this.viewItems[k]),m=c.map(k=>i[k]),g=u.map(k=>this.viewItems[k]),f=u.map(k=>i[k]),b=c.reduce((k,R)=>k+(this.viewItems[R].minimumSize-i[R]),0),y=c.reduce((k,R)=>k+(this.viewItems[R].maximumSize-i[R]),0),I=u.length===0?Number.POSITIVE_INFINITY:u.reduce((k,R)=>k+(i[R]-this.viewItems[R].minimumSize),0),E=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((k,R)=>k+(i[R]-this.viewItems[R].maximumSize),0),S=Math.max(b,E,s),w=Math.min(I,y,a),D=!1;if(l){let k=this.viewItems[l.index],R=e>=l.limitDelta;D=R!==k.visible,k.setVisible(R,l.size)}if(!D&&d){let k=this.viewItems[d.index],R=e<d.limitDelta;D=R!==k.visible,k.setVisible(R,d.size)}if(D)return this.resize(t,e,i,n,o,s,a);e=sr(e,S,w);for(let k=0,R=e;k<p.length;k++){let A=p[k],H=sr(m[k]+R,A.minimumSize,A.maximumSize),z=H-m[k];R-=z,A.size=H}for(let k=0,R=e;k<g.length;k++){let A=g[k],H=sr(f[k]-R,A.minimumSize,A.maximumSize),z=H-f[k];R+=z,A.size=H}return e}distributeEmptySpace(t){let e=this.viewItems.reduce((a,l)=>a+l.size,0),i=this.size-e,n=Io(this.viewItems.length-1,-1),o=n.filter(a=>this.viewItems[a].priority===1),s=n.filter(a=>this.viewItems[a].priority===2);for(let a of s)q_(n,a);for(let a of o)BS(n,a);typeof t=="number"&&BS(n,t);for(let a=0;i!==0&&a<n.length;a++){let l=this.viewItems[n[a]],d=sr(l.size+i,l.minimumSize,l.maximumSize),c=d-l.size;i-=c,l.size=d}}layoutViews(){this._contentSize=this.viewItems.reduce((e,i)=>e+i.size,0);let t=0;for(let e of this.viewItems)e.layout(t,this.layoutContext),t+=e.size;this.sashItems.forEach(e=>e.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let t=!1,e=this.viewItems.map(l=>t=l.size-l.minimumSize>0||t);t=!1;let i=this.viewItems.map(l=>t=l.maximumSize-l.size>0||t),n=[...this.viewItems].reverse();t=!1;let o=n.map(l=>t=l.size-l.minimumSize>0||t).reverse();t=!1;let s=n.map(l=>t=l.maximumSize-l.size>0||t).reverse(),a=0;for(let l=0;l<this.sashItems.length;l++){let{sash:d}=this.sashItems[l],c=this.viewItems[l];a+=c.size;let u=!(e[l]&&s[l+1]),p=!(i[l]&&o[l+1]);if(u&&p){let m=Io(l,-1),g=Io(l+1,this.viewItems.length),f=this.findFirstSnapIndex(m),b=this.findFirstSnapIndex(g),y=typeof f=="number"&&!this.viewItems[f].visible,I=typeof b=="number"&&!this.viewItems[b].visible;y&&o[l]&&(a>0||this.startSnappingEnabled)?d.state=1:I&&e[l]&&(a<this._contentSize||this.endSnappingEnabled)?d.state=2:d.state=0}else u&&!p?d.state=1:!u&&p?d.state=2:d.state=3}}getSashPosition(t){let e=0;for(let i=0;i<this.sashItems.length;i++)if(e+=this.viewItems[i].size,this.sashItems[i].sash===t)return e;return 0}findFirstSnapIndex(t){for(let e of t){let i=this.viewItems[e];if(i.visible&&i.snap)return e}for(let e of t){let i=this.viewItems[e];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return e}}areViewsDistributed(){let t,e;for(let i of this.viewItems)if(t=t===void 0?i.size:Math.min(t,i.size),e=e===void 0?i.size:Math.max(e,i.size),e-t>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),nt(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}};var Eae={separatorBorder:Y.transparent};function Pd(r){return r===0?1:0}var e2=class{constructor(t){this.isLayoutEnabled=t}};function Tae(r,t){return t===1?{left:r.start,right:r.end,top:r.orthogonalStart,bottom:r.orthogonalEnd}:{top:r.start,bottom:r.end,left:r.orthogonalStart,right:r.orthogonalEnd}}function xae(r,t){return t===1?{start:r.left,end:r.right,orthogonalStart:r.top,orthogonalEnd:r.bottom}:{start:r.top,end:r.bottom,orthogonalStart:r.left,orthogonalEnd:r.right}}function Ad(r,t){if(Math.abs(r)>t)throw new Error("Invalid index");return Wj(r,t+1)}var to=class r{constructor(t,e,i,n,o=0,s=0,a=!1,l){this.orientation=t;this.layoutController=e;this.splitviewProportionalLayout=n;if(this._styles=i,this._size=o,this._orthogonalSize=s,this.element=re(".monaco-grid-branch-node"),!l)this.splitview=new El(this.element,{orientation:t,styles:i,proportionalLayout:n}),this.splitview.layout(o,{orthogonalSize:s,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:o,absoluteOrthogonalSize:s});else{let c={views:l.map(p=>({view:p.node,size:p.node.size,visible:p.visible!==!1})),size:this.orthogonalSize},u={proportionalLayout:n,orientation:t,styles:i};this.children=l.map(p=>p.node),this.splitview=new El(this.element,{...u,descriptor:c}),this.children.forEach((p,m)=>{let g=m===0,f=m===this.children.length;p.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:g?this.boundarySashes.start:this.splitview.sashes[m-1],orthogonalEnd:f?this.boundarySashes.end:this.splitview.sashes[m]}})}let d=O.map(this.splitview.onDidSashReset,c=>[c]);this.splitviewSashResetDisposable=d(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}element;children=[];splitview;_size;get size(){return this._size}_orthogonalSize;get orthogonalSize(){return this._orthogonalSize}_absoluteOffset=0;get absoluteOffset(){return this._absoluteOffset}_absoluteOrthogonalOffset=0;get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}absoluteOrthogonalSize=0;_styles;get styles(){return this._styles}get width(){return this.orientation===1?this.size:this.orthogonalSize}get height(){return this.orientation===1?this.orthogonalSize:this.size}get top(){return this.orientation===1?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return this.orientation===1?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return this.children.length===0?0:Math.max(...this.children.map((t,e)=>this.splitview.isViewVisible(e)?t.minimumOrthogonalSize:0))}get maximumSize(){return Math.min(...this.children.map((t,e)=>this.splitview.isViewVisible(e)?t.maximumOrthogonalSize:Number.POSITIVE_INFINITY))}get priority(){if(this.children.length===0)return 0;let t=this.children.map(e=>typeof e.priority>"u"?0:e.priority);return t.some(e=>e===2)?2:t.some(e=>e===1)?1:0}get proportionalLayout(){return this.children.length===0?!0:this.children.every(t=>t.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return this.orientation===1?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===1?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===1?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===1?this.maximumSize:this.maximumOrthogonalSize}_onDidChange=new T;onDidChange=this._onDidChange.event;_onDidVisibilityChange=new T;onDidVisibilityChange=this._onDidVisibilityChange.event;childrenVisibilityChangeDisposable=new W;_onDidScroll=new T;onDidScrollDisposable=L.None;onDidScroll=this._onDidScroll.event;childrenChangeDisposable=L.None;_onDidSashReset=new T;onDidSashReset=this._onDidSashReset.event;splitviewSashResetDisposable=L.None;childrenSashResetDisposable=L.None;_boundarySashes={};get boundarySashes(){return this._boundarySashes}set boundarySashes(t){if(!(this._boundarySashes.start===t.start&&this._boundarySashes.end===t.end&&this._boundarySashes.orthogonalStart===t.orthogonalStart&&this._boundarySashes.orthogonalEnd===t.orthogonalEnd)){this._boundarySashes=t,this.splitview.orthogonalStartSash=t.orthogonalStart,this.splitview.orthogonalEndSash=t.orthogonalEnd;for(let e=0;e<this.children.length;e++){let i=this.children[e],n=e===0,o=e===this.children.length-1;i.boundarySashes={start:t.orthogonalStart,end:t.orthogonalEnd,orthogonalStart:n?t.start:i.boundarySashes.orthogonalStart,orthogonalEnd:o?t.end:i.boundarySashes.orthogonalEnd}}}}_edgeSnapping=!1;get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(t){if(this._edgeSnapping!==t){this._edgeSnapping=t;for(let e of this.children)e instanceof r&&(e.edgeSnapping=t);this.updateSplitviewEdgeSnappingEnablement()}}style(t){this._styles=t,this.splitview.style(t);for(let e of this.children)e instanceof r&&e.style(t)}layout(t,e,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=i.orthogonalSize,this._orthogonalSize=t,this._absoluteOffset=i.absoluteOffset+e,this._absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=i.absoluteOrthogonalSize,this.splitview.layout(i.orthogonalSize,{orthogonalSize:t,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:i.absoluteOrthogonalSize,absoluteOrthogonalSize:i.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(t){for(let e of this.children)e.setVisible(t)}addChild(t,e,i,n){i=Ad(i,this.children.length),this.splitview.addView(t,e,i,n),this.children.splice(i,0,t),this.updateBoundarySashes(),this.onDidChildrenChange()}removeChild(t,e){t=Ad(t,this.children.length);let i=this.splitview.removeView(t,e);return this.children.splice(t,1),this.updateBoundarySashes(),this.onDidChildrenChange(),i}removeAllChildren(){let t=this.splitview.removeAllViews();return this.children.splice(0,this.children.length),this.updateBoundarySashes(),this.onDidChildrenChange(),t}moveChild(t,e){t=Ad(t,this.children.length),e=Ad(e,this.children.length),t!==e&&(t<e&&(e-=1),this.splitview.moveView(t,e),this.children.splice(e,0,this.children.splice(t,1)[0]),this.updateBoundarySashes(),this.onDidChildrenChange())}swapChildren(t,e){t=Ad(t,this.children.length),e=Ad(e,this.children.length),t!==e&&(this.splitview.swapViews(t,e),[this.children[t].boundarySashes,this.children[e].boundarySashes]=[this.children[t].boundarySashes,this.children[e].boundarySashes],[this.children[t],this.children[e]]=[this.children[e],this.children[t]],this.onDidChildrenChange())}resizeChild(t,e){t=Ad(t,this.children.length),this.splitview.resizeView(t,e)}isChildExpanded(t){return this.splitview.isViewExpanded(t)}distributeViewSizes(t=!1){if(this.splitview.distributeViewSizes(),t)for(let e of this.children)e instanceof r&&e.distributeViewSizes(!0)}getChildSize(t){return t=Ad(t,this.children.length),this.splitview.getViewSize(t)}isChildVisible(t){return t=Ad(t,this.children.length),this.splitview.isViewVisible(t)}setChildVisible(t,e){if(t=Ad(t,this.children.length),this.splitview.isViewVisible(t)===e)return;let i=this.splitview.contentSize===0;this.splitview.setViewVisible(t,e);let n=this.splitview.contentSize===0;(e&&i||!e&&n)&&this._onDidVisibilityChange.fire(e)}getChildCachedVisibleSize(t){return t=Ad(t,this.children.length),this.splitview.getViewCachedVisibleSize(t)}updateBoundarySashes(){for(let t=0;t<this.children.length;t++)this.children[t].boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:t===0?this.boundarySashes.start:this.splitview.sashes[t-1],orthogonalEnd:t===this.children.length-1?this.boundarySashes.end:this.splitview.sashes[t]}}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){let t=O.map(O.any(...this.children.map(n=>n.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=t(this._onDidChange.fire,this._onDidChange);let e=O.any(...this.children.map((n,o)=>O.map(n.onDidSashReset,s=>[o,...s])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=e(this._onDidSashReset.fire,this._onDidSashReset);let i=O.any(O.signal(this.splitview.onDidScroll),...this.children.map(n=>n.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=i(this._onDidScroll.fire,this._onDidScroll),this.childrenVisibilityChangeDisposable.clear(),this.children.forEach((n,o)=>{n instanceof r&&this.childrenVisibilityChangeDisposable.add(n.onDidVisibilityChange(s=>{this.setChildVisible(o,s)}))})}trySet2x2(t){if(this.children.length!==2||t.children.length!==2)return L.None;if(this.getChildSize(0)!==t.getChildSize(0))return L.None;let[e,i]=this.children,[n,o]=t.children;if(!(e instanceof io)||!(i instanceof io))return L.None;if(!(n instanceof io)||!(o instanceof io))return L.None;this.orientation===0?(i.linkedWidthNode=n.linkedHeightNode=e,e.linkedWidthNode=o.linkedHeightNode=i,o.linkedWidthNode=e.linkedHeightNode=n,n.linkedWidthNode=i.linkedHeightNode=o):(n.linkedWidthNode=i.linkedHeightNode=e,o.linkedWidthNode=e.linkedHeightNode=i,e.linkedWidthNode=o.linkedHeightNode=n,i.linkedWidthNode=n.linkedHeightNode=o);let s=this.splitview.sashes[0],a=t.splitview.sashes[0];return s.linkedSash=a,a.linkedSash=s,this._onDidChange.fire(void 0),t._onDidChange.fire(void 0),te(()=>{s.linkedSash=a.linkedSash=void 0,e.linkedHeightNode=e.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,n.linkedHeightNode=n.linkedWidthNode=void 0,o.linkedHeightNode=o.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(let t of this.children)t.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this._onDidVisibilityChange.dispose(),this.childrenVisibilityChangeDisposable.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.onDidScrollDisposable.dispose(),this.splitview.dispose()}};function _ae(r){let[t,e]=O.split(r.onDidChange,Vn);return O.any(e,O.map(O.latch(O.map(t,i=>[r.minimumWidth,r.maximumWidth,r.minimumHeight,r.maximumHeight]),ti),i=>{}))}var io=class{constructor(t,e,i,n,o=0){this.view=t;this.orientation=e;this.layoutController=i;this._orthogonalSize=n,this._size=o;let s=_ae(t);this._onDidViewChange=O.map(s,a=>a&&(this.orientation===0?a.width:a.height),this.disposables),this.onDidChange=O.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}_size=0;get size(){return this._size}_orthogonalSize;get orthogonalSize(){return this._orthogonalSize}absoluteOffset=0;absoluteOrthogonalOffset=0;onDidScroll=O.None;onDidSashReset=O.None;_onDidLinkedWidthNodeChange=new Er;_linkedWidthNode=void 0;get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(t){this._onDidLinkedWidthNodeChange.input=t?t._onDidViewChange:O.None,this._linkedWidthNode=t,this._onDidSetLinkedNode.fire(void 0)}_onDidLinkedHeightNodeChange=new Er;_linkedHeightNode=void 0;get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(t){this._onDidLinkedHeightNodeChange.input=t?t._onDidViewChange:O.None,this._linkedHeightNode=t,this._onDidSetLinkedNode.fire(void 0)}_onDidSetLinkedNode=new T;_onDidViewChange;onDidChange;disposables=new W;get width(){return this.orientation===1?this.orthogonalSize:this.size}get height(){return this.orientation===1?this.size:this.orthogonalSize}get top(){return this.orientation===1?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return this.orientation===1?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return this.orientation===1?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===1?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return this.view.snap}get minimumOrthogonalSize(){return this.orientation===1?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===1?this.maximumWidth:this.maximumHeight}_boundarySashes={};get boundarySashes(){return this._boundarySashes}set boundarySashes(t){this._boundarySashes=t,this.view.setBoundarySashes?.(Tae(t,this.orientation))}layout(t,e,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=t,this._orthogonalSize=i.orthogonalSize,this.absoluteOffset=i.absoluteOffset+e,this.absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}cachedWidth=0;cachedHeight=0;cachedTop=0;cachedLeft=0;_layout(t,e,i,n){this.cachedWidth===t&&this.cachedHeight===e&&this.cachedTop===i&&this.cachedLeft===n||(this.cachedWidth=t,this.cachedHeight=e,this.cachedTop=i,this.cachedLeft=n,this.view.layout(t,e,i,n))}setVisible(t){this.view.setVisible?.(t)}dispose(){this.disposables.dispose()}};function zZ(r,t,e){if(r instanceof to){let i=new to(Pd(r.orientation),r.layoutController,r.styles,r.splitviewProportionalLayout,t,e,r.edgeSnapping),n=0;for(let o=r.children.length-1;o>=0;o--){let s=r.children[o],a=s instanceof to?s.orthogonalSize:s.size,l=r.size===0?0:Math.round(t*a/r.size);n+=l,o===0&&(l+=t-n),i.addChild(zZ(s,e,l),l,0,!0)}return r.dispose(),i}else{let i=new io(r.view,Pd(r.orientation),r.layoutController,e);return r.dispose(),i}}var hf=class r{element;styles;proportionalLayout;_root;onDidSashResetRelay=new Er;_onDidScroll=new Er;_onDidChange=new Er;_boundarySashes={};layoutController;disposable2x2=L.None;get root(){return this._root}set root(t){let e=this._root;e&&(e.element.remove(),e.dispose()),this._root=t,this.element.appendChild(t.element),this.onDidSashResetRelay.input=t.onDidSashReset,this._onDidChange.input=O.map(t.onDidChange,()=>{}),this._onDidScroll.input=t.onDidScroll}onDidSashReset=this.onDidSashResetRelay.event;onDidScroll=this._onDidScroll.event;onDidChange=this._onDidChange.event;get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(t){if(this._root.orientation===t)return;let{size:e,orthogonalSize:i,absoluteOffset:n,absoluteOrthogonalOffset:o}=this._root;this.root=zZ(this._root,i,e),this.root.layout(e,0,{orthogonalSize:i,absoluteOffset:o,absoluteOrthogonalOffset:n,absoluteSize:e,absoluteOrthogonalSize:i}),this.boundarySashes=this.boundarySashes}set boundarySashes(t){this._boundarySashes=t,this.root.boundarySashes=xae(t,this.orientation)}set edgeSnapping(t){this.root.edgeSnapping=t}maximizedNode=void 0;_onDidChangeViewMaximized=new T;onDidChangeViewMaximized=this._onDidChangeViewMaximized.event;constructor(t={}){this.element=re(".monaco-grid-view"),this.styles=t.styles||Eae,this.proportionalLayout=typeof t.proportionalLayout<"u"?!!t.proportionalLayout:!0,this.layoutController=new e2(!1),this.root=new to(0,this.layoutController,this.styles,this.proportionalLayout)}style(t){this.styles=t,this.root.style(t)}layout(t,e,i=0,n=0){this.layoutController.isLayoutEnabled=!0;let[o,s,a,l]=this.root.orientation===1?[e,t,i,n]:[t,e,n,i];this.root.layout(o,0,{orthogonalSize:s,absoluteOffset:a,absoluteOrthogonalOffset:l,absoluteSize:o,absoluteOrthogonalSize:s})}addView(t,e,i){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=L.None;let[n,o]=Dn(i),[s,a]=this.getNode(n);if(a instanceof to){let l=new io(t,Pd(a.orientation),this.layoutController,a.orthogonalSize);try{a.addChild(l,e,o)}catch(d){throw l.dispose(),d}}else{let[,l]=Dn(s),[,d]=Dn(n),c=0,u=l.getChildCachedVisibleSize(d);typeof u=="number"&&(c=lr.Invisible(u)),l.removeChild(d).dispose();let m=new to(a.orientation,a.layoutController,this.styles,this.proportionalLayout,a.size,a.orthogonalSize,l.edgeSnapping);l.addChild(m,a.size,d);let g=new io(a.view,l.orientation,this.layoutController,a.size);m.addChild(g,c,0),typeof e!="number"&&e.type==="split"&&(e=lr.Split(0));let f=new io(t,l.orientation,this.layoutController,a.size);m.addChild(f,e,o)}this.trySet2x2()}removeView(t,e){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=L.None;let[i,n]=Dn(t),[o,s]=this.getNode(i);if(!(s instanceof to))throw new Error("Invalid location");let a=s.children[n];if(!(a instanceof io))throw new Error("Invalid location");if(s.removeChild(n,e),a.dispose(),s.children.length===0)throw new Error("Invalid grid state");if(s.children.length>1)return this.trySet2x2(),a.view;if(o.length===0){let m=s.children[0];return m instanceof io||(s.removeChild(0),s.dispose(),this.root=m,this.boundarySashes=this.boundarySashes,this.trySet2x2()),a.view}let[,l]=Dn(o),[,d]=Dn(i),c=s.isChildVisible(0),u=s.removeChild(0),p=l.children.map((m,g)=>l.getChildSize(g));if(l.removeChild(d,e),s.dispose(),u instanceof to){p.splice(d,1,...u.children.map(g=>g.size));let m=u.removeAllChildren();for(let g=0;g<m.length;g++)l.addChild(m[g],m[g].size,d+g)}else{let m=new io(u.view,Pd(u.orientation),this.layoutController,u.size),g=c?u.orthogonalSize:lr.Invisible(u.orthogonalSize);l.addChild(m,g,d)}u.dispose();for(let m=0;m<p.length;m++)l.resizeChild(m,p[m]);return this.trySet2x2(),a.view}moveView(t,e,i){this.hasMaximizedView()&&this.exitMaximizedView();let[,n]=this.getNode(t);if(!(n instanceof to))throw new Error("Invalid location");n.moveChild(e,i),this.trySet2x2()}swapViews(t,e){this.hasMaximizedView()&&this.exitMaximizedView();let[i,n]=Dn(t),[,o]=this.getNode(i);if(!(o instanceof to))throw new Error("Invalid from location");let s=o.getChildSize(n),a=o.children[n];if(!(a instanceof io))throw new Error("Invalid from location");let[l,d]=Dn(e),[,c]=this.getNode(l);if(!(c instanceof to))throw new Error("Invalid to location");let u=c.getChildSize(d),p=c.children[d];if(!(p instanceof io))throw new Error("Invalid to location");o===c?o.swapChildren(n,d):(o.removeChild(n),c.removeChild(d),o.addChild(p,s,n),c.addChild(a,u,d)),this.trySet2x2()}resizeView(t,e){this.hasMaximizedView()&&this.exitMaximizedView();let[i,n]=Dn(t),[o,s]=this.getNode(i);if(!(s instanceof to))throw new Error("Invalid location");if(!e.width&&!e.height)return;let[a,l]=s.orientation===1?[e.width,e.height]:[e.height,e.width];if(typeof l=="number"&&o.length>0){let[,d]=Dn(o),[,c]=Dn(i);d.resizeChild(c,l)}typeof a=="number"&&s.resizeChild(n,a),this.trySet2x2()}getViewSize(t){if(!t)return{width:this.root.width,height:this.root.height};let[,e]=this.getNode(t);return{width:e.width,height:e.height}}getViewCachedVisibleSize(t){let[e,i]=Dn(t),[,n]=this.getNode(e);if(!(n instanceof to))throw new Error("Invalid location");return n.getChildCachedVisibleSize(i)}expandView(t){this.hasMaximizedView()&&this.exitMaximizedView();let[e,i]=this.getNode(t);if(!(i instanceof io))throw new Error("Invalid location");for(let n=0;n<e.length;n++)e[n].resizeChild(t[n],Number.POSITIVE_INFINITY)}isViewExpanded(t){if(this.hasMaximizedView())return!1;let[e,i]=this.getNode(t);if(!(i instanceof io))throw new Error("Invalid location");for(let n=0;n<e.length;n++)if(!e[n].isChildExpanded(t[n]))return!1;return!0}maximizeView(t){let[,e]=this.getNode(t);if(!(e instanceof io))throw new Error("Location is not a LeafNode");if(this.maximizedNode===e)return;this.hasMaximizedView()&&this.exitMaximizedView();function i(n,o){for(let s=0;s<n.children.length;s++){let a=n.children[s];a instanceof io?a!==o&&n.setChildVisible(s,!1):i(a,o)}}i(this.root,e),this.maximizedNode=e,this._onDidChangeViewMaximized.fire(!0)}exitMaximizedView(){if(!this.maximizedNode)return;this.maximizedNode=void 0;function t(e){for(let i=e.children.length-1;i>=0;i--){let n=e.children[i];n instanceof io?e.setChildVisible(i,!0):t(n)}}t(this.root),this._onDidChangeViewMaximized.fire(!1)}hasMaximizedView(){return this.maximizedNode!==void 0}isViewMaximized(t){let[,e]=this.getNode(t);if(!(e instanceof io))throw new Error("Location is not a LeafNode");return e===this.maximizedNode}distributeViewSizes(t){if(this.hasMaximizedView()&&this.exitMaximizedView(),!t){this.root.distributeViewSizes(!0);return}let[,e]=this.getNode(t);if(!(e instanceof to))throw new Error("Invalid location");e.distributeViewSizes(),this.trySet2x2()}isViewVisible(t){let[e,i]=Dn(t),[,n]=this.getNode(e);if(!(n instanceof to))throw new Error("Invalid from location");return n.isChildVisible(i)}setViewVisible(t,e){if(this.hasMaximizedView()){this.exitMaximizedView();return}let[i,n]=Dn(t),[,o]=this.getNode(i);if(!(o instanceof to))throw new Error("Invalid from location");o.setChildVisible(n,e)}getView(t){let e=t?this.getNode(t)[1]:this._root;return this._getViews(e,this.orientation)}static deserialize(t,e,i={}){if(typeof t.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof t.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof t.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");if(t.root?.type!=="branch")throw new Error("Invalid JSON: 'root' property must have 'type' value of branch.");let n=t.orientation,o=t.height,s=new r(i);return s._deserialize(t.root,n,e,o),s}_deserialize(t,e,i,n){this.root=this._deserializeNode(t,e,i,n)}_deserializeNode(t,e,i,n){let o;if(t.type==="branch"){let a=t.data.map(l=>({node:this._deserializeNode(l,Pd(e),i,t.size),visible:l.visible}));o=new to(e,this.layoutController,this.styles,this.proportionalLayout,t.size,n,void 0,a)}else o=new io(i.fromJSON(t.data),e,this.layoutController,n,t.size),t.maximized&&!this.maximizedNode&&(this.maximizedNode=o,this._onDidChangeViewMaximized.fire(!0));return o}_getViews(t,e,i){let n={top:t.top,left:t.left,width:t.width,height:t.height};if(t instanceof io)return{view:t.view,box:n,cachedVisibleSize:i,maximized:this.maximizedNode===t};let o=[];for(let s=0;s<t.children.length;s++){let a=t.children[s],l=t.getChildCachedVisibleSize(s);o.push(this._getViews(a,Pd(e),l))}return{children:o,box:n}}getNode(t,e=this.root,i=[]){if(t.length===0)return[i,e];if(!(e instanceof to))throw new Error("Invalid location");let[n,...o]=t;if(n<0||n>=e.children.length)throw new Error("Invalid location");let s=e.children[n];return i.push(e),this.getNode(o,s,i)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=L.None,this.root.children.length!==2)return;let[t,e]=this.root.children;!(t instanceof to)||!(e instanceof to)||(this.disposable2x2=t.trySet2x2(e))}getViewMap(t,e){e||(e=this.root),e instanceof to?e.children.forEach(i=>this.getViewMap(t,i)):t.set(e.view,e.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element.remove()}};function Dae(r){switch(r){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}}function gA(r){return!!r.children}function GZ(r,t){if(t.length===0)return r;if(!gA(r))throw new Error("Invalid location");let[e,...i]=t;return GZ(r.children[e],i)}function Lae(r,t){return!(r.start>=t.end||t.start>=r.end)}function qZ(r,t){let e=n2(t),i=t===0?r.top:t===3?r.left+r.width:t===1?r.top+r.height:r.left,n={start:e===1?r.top:r.left,end:e===1?r.top+r.height:r.left+r.width};return{offset:i,range:n}}function kae(r,t,e){let i=[];function n(o,s,a){if(gA(o))for(let l of o.children)n(l,s,a);else{let{offset:l,range:d}=qZ(o.box,s);l===a.offset&&Lae(d,a.range)&&i.push(o)}}return n(r,t,e),i}function t2(r,t){return t.length%2===0?Pd(r):r}function n2(r){return r===0||r===1?0:1}function KZ(r,t,e){let i=t2(r,t),n=n2(e);if(i===n){let[o,s]=Dn(t);return(e===3||e===1)&&(s+=1),[...o,s]}else{let o=e===3||e===1?1:0;return[...t,o]}}function Rae(r){let t=r.parentElement;if(!t)throw new Error("Invalid grid element");let e=t.firstElementChild,i=0;for(;e!==r&&e!==t.lastElementChild&&e;)e=e.nextElementSibling,i++;return i}function jZ(r){let t=r.parentElement;if(!t)throw new Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(t.className))return[];let e=Rae(t),i=t.parentElement.parentElement.parentElement.parentElement;return[...jZ(i),e]}var om;(n=>{n.Distribute={type:"distribute"},n.Split={type:"split"},n.Auto={type:"auto"};function i(o){return{type:"invisible",cachedVisibleSize:o}}n.Invisible=i})(om||={});var i2=class extends L{gridview;views=new Map;get orientation(){return this.gridview.orientation}set orientation(t){this.gridview.orientation=t}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}onDidChange;onDidScroll;get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(t){this.gridview.boundarySashes=t}set edgeSnapping(t){this.gridview.edgeSnapping=t}get element(){return this.gridview.element}didLayout=!1;onDidChangeViewMaximized;constructor(t,e={}){super(),t instanceof hf?(this.gridview=t,this.gridview.getViewMap(this.views)):this.gridview=new hf(e),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),t instanceof hf||this._addView(t,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll,this.onDidChangeViewMaximized=this.gridview.onDidChangeViewMaximized}style(t){this.gridview.style(t)}layout(t,e,i=0,n=0){this.gridview.layout(t,e,i,n),this.didLayout=!0}addView(t,e,i,n){if(this.views.has(t))throw new Error("Can't add same view twice");let o=n2(n);this.views.size===1&&this.orientation!==o&&(this.orientation=o);let s=this.getViewLocation(i),a=KZ(this.gridview.orientation,s,n),l;if(typeof e=="number")l=e;else if(e.type==="split"){let[,d]=Dn(s);l=lr.Split(d)}else if(e.type==="distribute")l=lr.Distribute;else if(e.type==="auto"){let[,d]=Dn(s);l=lr.Auto(d)}else l=e;this._addView(t,l,a)}addViewAt(t,e,i){if(this.views.has(t))throw new Error("Can't add same view twice");let n;typeof e=="number"?n=e:e.type==="distribute"?n=lr.Distribute:n=e,this._addView(t,n,i)}_addView(t,e,i){this.views.set(t,t.element),this.gridview.addView(t,e,i)}removeView(t,e){if(this.views.size===1)throw new Error("Can't remove last view");let i=this.getViewLocation(t),n;if(e?.type==="distribute")n=lr.Distribute;else if(e?.type==="auto"){let o=i[i.length-1];n=lr.Auto(o===0?1:o-1)}this.gridview.removeView(i,n),this.views.delete(t)}moveView(t,e,i,n){let o=this.getViewLocation(t),[s,a]=Dn(o),l=this.getViewLocation(i),d=KZ(this.gridview.orientation,l,n),[c,u]=Dn(d);ti(s,c)?this.gridview.moveView(s,a,u):(this.removeView(t,typeof e=="number"?void 0:e),this.addView(t,e,i,n))}moveViewTo(t,e){let i=this.getViewLocation(t),[n,o]=Dn(i),[s,a]=Dn(e);if(ti(n,s))this.gridview.moveView(n,o,a);else{let l=this.getViewSize(t),d=t2(this.gridview.orientation,i),c=this.getViewCachedVisibleSize(t),u=typeof c>"u"?d===1?l.width:l.height:om.Invisible(c);this.removeView(t),this.addViewAt(t,u,e)}}swapViews(t,e){let i=this.getViewLocation(t),n=this.getViewLocation(e);return this.gridview.swapViews(i,n)}resizeView(t,e){let i=this.getViewLocation(t);return this.gridview.resizeView(i,e)}isViewExpanded(t){let e=this.getViewLocation(t);return this.gridview.isViewExpanded(e)}isViewMaximized(t){let e=this.getViewLocation(t);return this.gridview.isViewMaximized(e)}hasMaximizedView(){return this.gridview.hasMaximizedView()}getViewSize(t){if(!t)return this.gridview.getViewSize();let e=this.getViewLocation(t);return this.gridview.getViewSize(e)}getViewCachedVisibleSize(t){let e=this.getViewLocation(t);return this.gridview.getViewCachedVisibleSize(e)}maximizeView(t){if(this.views.size<2)throw new Error("At least two views are required to maximize a view");let e=this.getViewLocation(t);this.gridview.maximizeView(e)}exitMaximizedView(){this.gridview.exitMaximizedView()}expandView(t){let e=this.getViewLocation(t);this.gridview.expandView(e)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(t){let e=this.getViewLocation(t);return this.gridview.isViewVisible(e)}setViewVisible(t,e){let i=this.getViewLocation(t);this.gridview.setViewVisible(i,e)}getViews(){return this.gridview.getView()}getNeighborViews(t,e,i=!1){if(!this.didLayout)throw new Error("Can't call getNeighborViews before first layout");let n=this.getViewLocation(t),o=this.getViews(),s=GZ(o,n),a=qZ(s.box,e);return i&&(e===0&&s.box.top===0?a={offset:o.box.top+o.box.height,range:a.range}:e===3&&s.box.left+s.box.width===o.box.width?a={offset:0,range:a.range}:e===1&&s.box.top+s.box.height===o.box.height?a={offset:0,range:a.range}:e===2&&s.box.left===0&&(a={offset:o.box.left+o.box.width,range:a.range})),kae(o,Dae(e),a).map(l=>l.view)}getViewLocation(t){let e=this.views.get(t);if(!e)throw new Error("View not found");return jZ(e)}onDidSashReset(t){let e=o=>{let s=this.gridview.getView(o);if(gA(s))return!1;let a=t2(this.orientation,o),l=a===1?s.view.preferredWidth:s.view.preferredHeight;if(typeof l!="number")return!1;let d=a===1?{width:Math.round(l)}:{height:Math.round(l)};return this.gridview.resizeView(o,d),!0};if(e(t))return;let[i,n]=Dn(t);e([...i,n+1])||this.gridview.distributeViewSizes(i)}},mA=class r extends i2{static serializeNode(t,e){let i=e===0?t.box.width:t.box.height;if(!gA(t)){let o={type:"leaf",data:t.view.toJSON(),size:i};return typeof t.cachedVisibleSize=="number"?(o.size=t.cachedVisibleSize,o.visible=!1):t.maximized&&(o.maximized=!0),o}let n=t.children.map(o=>r.serializeNode(o,Pd(e)));return n.some(o=>o.visible!==!1)?{type:"branch",data:n,size:i}:{type:"branch",data:n,size:i,visible:!1}}static deserialize(t,e,i={}){if(typeof t.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof t.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof t.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");let n=hf.deserialize(t,e,i);return new r(n,i)}static from(t,e={}){return r.deserialize(Aae(t),{fromJSON:i=>i},e)}initialLayoutContext=!0;serialize(){return{root:r.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(t,e,i=0,n=0){super.layout(t,e,i,n),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}};function $Z(r){return!!r.groups}function YZ(r,t){if(!t&&r.groups&&r.groups.length<=1&&(r.groups=void 0),!$Z(r))return;let e=0,i=0;for(let a of r.groups)YZ(a,!1),a.size&&(e+=a.size,i++);let n=i>0?e:1,o=r.groups.length-i,s=n/o;for(let a of r.groups)a.size||(a.size=s)}function ZZ(r){return $Z(r)?{type:"branch",data:r.groups.map(t=>ZZ(t)),size:r.size}:{type:"leaf",data:r.data,size:r.size}}function XZ(r,t){if(r.type==="branch"){let e=r.data.map(i=>XZ(i,Pd(t)));if(t===0){let i=r.size||(e.length===0?void 0:Math.max(...e.map(o=>o.width||0))),n=e.length===0?void 0:e.reduce((o,s)=>o+(s.height||0),0);return{width:i,height:n}}else{let i=e.length===0?void 0:e.reduce((o,s)=>o+(s.width||0),0),n=r.size||(e.length===0?void 0:Math.max(...e.map(o=>o.height||0)));return{width:i,height:n}}}else{let e=t===0?r.size:void 0,i=t===0?void 0:r.size;return{width:e,height:i}}}function Aae(r){YZ(r,!0);let t=ZZ(r),{width:e,height:i}=XZ(t,r.orientation);return{root:t,orientation:r.orientation,width:e||1,height:i||1}}var xl=class extends _p{constructor(e,i,n,o,s){super(e,n,o);this.options=i;this.layoutService=s;this._register(s.registerPart(this))}_dimension;get dimension(){return this._dimension}_contentPosition;get contentPosition(){return this._contentPosition}_onDidVisibilityChange=this._register(new T);onDidVisibilityChange=this._onDidVisibilityChange.event;parent;headerArea;titleArea;contentArea;footerArea;partLayout;onThemeChange(e){this.parent&&super.onThemeChange(e)}create(e,i){this.parent=e,this.titleArea=this.createTitleArea(e,i),this.contentArea=this.createContentArea(e,i),this.partLayout=new o2(this.options,this.contentArea),this.updateStyles()}getContainer(){return this.parent}createTitleArea(e,i){}getTitleArea(){return this.titleArea}createContentArea(e,i){}getContentArea(){return this.contentArea}setHeaderArea(e){if(this.headerArea)throw new Error("Header already exists");!this.parent||!this.titleArea||(up(this.parent,e),e.classList.add("header-or-footer"),e.classList.add("header"),this.headerArea=e,this.partLayout?.setHeaderVisibility(!0),this.relayout())}setFooterArea(e){if(this.footerArea)throw new Error("Footer already exists");!this.parent||!this.titleArea||(this.parent.appendChild(e),e.classList.add("header-or-footer"),e.classList.add("footer"),this.footerArea=e,this.partLayout?.setFooterVisibility(!0),this.relayout())}removeHeaderArea(){this.headerArea&&(this.headerArea.remove(),this.headerArea=void 0,this.partLayout?.setHeaderVisibility(!1),this.relayout())}removeFooterArea(){this.footerArea&&(this.footerArea.remove(),this.footerArea=void 0,this.partLayout?.setFooterVisibility(!1),this.relayout())}relayout(){this.dimension&&this.contentPosition&&this.layout(this.dimension.width,this.dimension.height,this.contentPosition.top,this.contentPosition.left)}layoutContents(e,i){return Ue(this.partLayout).layout(e,i)}_onDidChange=this._register(new T);get onDidChange(){return this._onDidChange.event}element;layout(e,i,n,o){this._dimension=new dt(e,i),this._contentPosition={top:n,left:o}}setVisible(e){this._onDidVisibilityChange.fire(e)}},o2=class r{constructor(t,e){this.options=t;this.contentArea=e}static HEADER_HEIGHT=35;static TITLE_HEIGHT=35;static Footer_HEIGHT=35;headerVisible=!1;footerVisible=!1;layout(t,e){let i;this.options.hasTitle?i=new dt(t,Math.min(e,r.TITLE_HEIGHT)):i=dt.None;let n;this.headerVisible?n=new dt(t,Math.min(e,r.HEADER_HEIGHT)):n=dt.None;let o;this.footerVisible?o=new dt(t,Math.min(e,r.Footer_HEIGHT)):o=dt.None;let s=t;this.options&&typeof this.options.borderWidth=="function"&&(s-=this.options.borderWidth());let a=new dt(s,e-i.height-n.height-o.height);return this.contentArea&&ek(this.contentArea,a.width,a.height),{headerSize:n,titleSize:i,contentSize:a,footerSize:o}}setFooterVisibility(t){this.footerVisible=t}setHeaderVisibility(t){this.headerVisible=t}},By=class extends _p{_parts=new Set;get parts(){return Array.from(this._parts)}registerPart(t){return this._parts.add(t),te(()=>this.unregisterPart(t))}unregisterPart(t){this._parts.delete(t)}getPart(t){return this.getPartByDocument(t.ownerDocument)}getPartByDocument(t){if(this._parts.size>1){for(let e of this._parts)if(e.element?.ownerDocument===t)return e}return this.mainPart}get activePart(){return this.getPartByDocument(Dc())}};var Qe=VZ;function ho(r){return r===2||r===3}function Mr(r){switch(r){case 0:return"left";case 1:return"right";case 2:return"bottom";case 3:return"top";default:return"bottom"}}var Pae={[Mr(0)]:0,[Mr(1)]:1,[Mr(2)]:2,[Mr(3)]:3};function mf(r){return Pae[r]}function r2(r){switch(r){case 0:return"always";case 1:return"never";case 2:return"preserve";default:return"preserve"}}var Mae={[r2(0)]:0,[r2(1)]:1,[r2(2)]:2};function JZ(r){return Mae[r]}function rm(r,t,e,i){if(!np(r))return!1;if(i)return!r.getValue("zenMode.fullScreen");let n=ld(t),o=Dr(r);if(!wt){let a=r.getValue("window.customTitleBarVisibility");if(a==="never"&&o||a==="windowed"&&n)return!1}if(!Oae(r))return!0;if(o)return!1;if(be&&Pi)return!n;if(Pi&&!n||Vg()&&!n)return!0;switch(HL(t)?"hidden":na(r)){case"classic":return!n||!!e;case"compact":case"hidden":return!1;case"toggle":return!!e;case"visible":return!0;default:return wt?!1:!n||!!e}}function Oae(r){if(r.getValue("window.commandCenter"))return!1;let t=r.getValue("workbench.activityBar.location");if(t==="top"||t==="bottom")return!1;let e=r.getValue("workbench.editor.editorActionsLocation"),i=r.getValue("workbench.editor.showTabs");return!(e==="titleBar"||e==="default"&&i==="none"||r.getValue("workbench.layoutControl.enabled"))}var fA=class{constructor(t){this.nodes=t}toString(){return this.nodes.map(t=>typeof t=="string"?t:t.label).join("")}};_([ue],fA.prototype,"toString",1);var Nae=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function bA(r){let t=[],e=0,i;for(;i=Nae.exec(r);){i.index-e>0&&t.push(r.substring(e,i.index));let[,n,o,,s]=i;s?t.push({label:n,href:o,title:s}):t.push({label:n,href:o}),e=i.index+i[0].length}return e<r.length&&t.push(r.substring(e)),new fA(t)}var a2=class extends L{constructor(e,i){super();this.item=e;this.onClose=i;this.registerListeners()}_onDidClose=this._register(new T);onDidClose=this._onDidClose.event;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;registerListeners(){this._register(this.item.onDidChangeVisibility(e=>this._onDidChangeVisibility.fire(e))),O.once(this.item.onDidClose)(()=>{this._onDidClose.fire(),this.dispose()})}get progress(){return this.item.progress}updateSeverity(e){this.item.updateSeverity(e)}updateMessage(e){this.item.updateMessage(e)}updateActions(e){this.item.updateActions(e)}close(){this.onClose(this.item),this.dispose()}},vA=class r extends L{static NO_OP_NOTIFICATION=new rf;_onDidChangeNotification=this._register(new T);onDidChangeNotification=this._onDidChangeNotification.event;_onDidChangeStatusMessage=this._register(new T);onDidChangeStatusMessage=this._onDidChangeStatusMessage.event;_onDidChangeFilter=this._register(new T);onDidChangeFilter=this._onDidChangeFilter.event;_notifications=[];get notifications(){return this._notifications}_statusMessage;get statusMessage(){return this._statusMessage}filter={global:0,sources:new Map};setFilter(t){let e=!1;typeof t.global=="number"&&(e=this.filter.global!==t.global,this.filter.global=t.global);let i=!1;t.sources&&(i=!w7(this.filter.sources,t.sources),this.filter.sources=t.sources),(e||i)&&this._onDidChangeFilter.fire({global:e?t.global:void 0,sources:i?t.sources:void 0})}addNotification(t){let e=this.createViewItem(t);return e?(this.findNotification(e)?.close(),this._notifications.splice(0,0,e),this._onDidChangeNotification.fire({item:e,index:0,kind:0}),new a2(e,n=>this.onClose(n))):r.NO_OP_NOTIFICATION}onClose(t){let e=this.findNotification(t);e&&e!==t?e.close():t.close()}findNotification(t){return this._notifications.find(e=>e.equals(t))}createViewItem(t){let e=Vy.create(t,this.filter);if(!e)return;let i=(s,a)=>{let l=this._notifications.indexOf(e);l>=0&&this._onDidChangeNotification.fire({item:e,index:l,kind:s,detail:a})},n=e.onDidChangeExpansion(()=>i(2)),o=e.onDidChangeContent(s=>i(1,s.kind));return O.once(e.onDidClose)(()=>{n.dispose(),o.dispose();let s=this._notifications.indexOf(e);s>=0&&(this._notifications.splice(s,1),this._onDidChangeNotification.fire({item:e,index:s,kind:3}))}),e}showStatusMessage(t,e){let i=d2.create(t,e);return i?(this._statusMessage=i,this._onDidChangeStatusMessage.fire({kind:0,item:i}),te(()=>{this._statusMessage===i&&(this._statusMessage=void 0,this._onDidChangeStatusMessage.fire({kind:1,item:i}))})):L.None}};function XE(r){return r instanceof Vy}var l2=class extends L{_state;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;constructor(){super(),this._state=Object.create(null)}get state(){return this._state}infinite(){this._state.infinite||(this._state.infinite=!0,this._state.total=void 0,this._state.worked=void 0,this._state.done=void 0,this._onDidChange.fire())}done(){this._state.done||(this._state.done=!0,this._state.infinite=void 0,this._state.total=void 0,this._state.worked=void 0,this._onDidChange.fire())}total(t){this._state.total!==t&&(this._state.total=t,this._state.infinite=void 0,this._state.done=void 0,this._onDidChange.fire())}worked(t){typeof this._state.worked=="number"?this._state.worked+=t:this._state.worked=t,this._state.infinite=void 0,this._state.done=void 0,this._onDidChange.fire()}},Vy=class r extends L{constructor(e,i,n,o,s,a,l,d){super();this.id=e;this._severity=i;this._sticky=n;this._priority=o;this._message=s;this._source=a;l&&this.setProgress(l),this.setActions(d)}static MAX_MESSAGE_LENGTH=1e3;_expanded;_visible=!1;_actions;_progress;_onDidChangeExpansion=this._register(new T);onDidChangeExpansion=this._onDidChangeExpansion.event;_onDidClose=this._register(new T);onDidClose=this._onDidClose.event;_onDidChangeContent=this._register(new T);onDidChangeContent=this._onDidChangeContent.event;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;static create(e,i){if(!e||!e.message||al(e.message))return;let n;typeof e.severity=="number"?n=e.severity:n=ui.Info;let o=r.parseNotificationMessage(e.message);if(!o)return;let s;e.actions?s=e.actions:yw(e.message)&&(s={primary:e.message.actions});let a=e.priority??0;return a===0&&n!==ui.Error&&(i.global===1?a=1:Ty(e.source)&&i.sources.get(e.source.id)===1&&(a=1)),new r(e.id,n,e.sticky,a,o,e.source,e.progress,s)}static parseNotificationMessage(e){let i;if(e instanceof Error?i=lo(e,!1):typeof e=="string"&&(i=e),!i)return;let n=i;i.length>r.MAX_MESSAGE_LENGTH&&(i=`${i.substr(0,r.MAX_MESSAGE_LENGTH)}...`),i=i.replace(/(\r\n|\n|\r)/gm," ").trim();let o=bA(i);return{raw:n,linkedText:o,original:e}}setProgress(e){e.infinite?this.progress.infinite():e.total&&(this.progress.total(e.total),e.worked&&this.progress.worked(e.worked))}setActions(e={primary:[],secondary:[]}){this._actions={primary:Array.isArray(e.primary)?e.primary:[],secondary:Array.isArray(e.secondary)?e.secondary:[]},this._expanded=e.primary&&e.primary.length>0}get canCollapse(){return!this.hasActions}get expanded(){return!!this._expanded}get severity(){return this._severity}get sticky(){if(this._sticky)return!0;let e=this.hasActions;return!!(e&&this._severity===ui.Error||!e&&this._expanded||this._progress&&!this._progress.state.done)}get priority(){return this._priority}get hasActions(){return!this._actions||!this._actions.primary?!1:this._actions.primary.length>0}get hasProgress(){return!!this._progress}get progress(){return this._progress||(this._progress=this._register(new l2),this._register(this._progress.onDidChange(()=>this._onDidChangeContent.fire({kind:3})))),this._progress}get message(){return this._message}get source(){return typeof this._source=="string"?this._source:this._source?this._source.label:void 0}get sourceId(){return this._source&&typeof this._source!="string"&&"id"in this._source?this._source.id:void 0}get actions(){return this._actions}get visible(){return this._visible}updateSeverity(e){e!==this._severity&&(this._severity=e,this._onDidChangeContent.fire({kind:0}))}updateMessage(e){let i=r.parseNotificationMessage(e);!i||i.raw===this._message.raw||(this._message=i,this._onDidChangeContent.fire({kind:1}))}updateActions(e){this.setActions(e),this._onDidChangeContent.fire({kind:2})}updateVisibility(e){this._visible!==e&&(this._visible=e,this._onDidChangeVisibility.fire(e))}expand(){this._expanded||!this.canCollapse||(this._expanded=!0,this._onDidChangeExpansion.fire())}collapse(e){!this._expanded||!this.canCollapse||(this._expanded=!1,e||this._onDidChangeExpansion.fire())}toggle(){this._expanded?this.collapse():this.expand()}close(){this._onDidClose.fire(),this.dispose()}equals(e){if(this.hasProgress||e.hasProgress)return!1;if(typeof this.id=="string"||typeof e.id=="string")return this.id===e.id;if(typeof this._source=="object"){if(this._source.label!==e.source||this._source.id!==e.sourceId)return!1}else if(this._source!==e.source)return!1;if(this._message.raw!==e.message.raw)return!1;let i=this._actions&&this._actions.primary||[],n=e.actions&&e.actions.primary||[];return ti(i,n,(o,s)=>o.id+o.label===s.id+s.label)}},gf=class r extends ot{_onDidRun=this._register(new T);onDidRun=this._onDidRun.event;_keepOpen;_menu;constructor(t,e){super(t,e.label,void 0,!0,async()=>{e.run(),this._onDidRun.fire()}),this._keepOpen=!!e.keepOpen,this._menu=!e.isSecondary&&e.menu?e.menu.map((i,n)=>new r(`${t}.${n}`,i)):void 0}get menu(){return this._menu}get keepOpen(){return this._keepOpen}},d2=class{static create(t,e){if(!t||al(t))return;let i;if(t instanceof Error?i=lo(t,!1):typeof t=="string"&&(i=t),!!i)return{message:i,options:e}}};var Zc=class extends L{constructor(e){super();this.storageService=e;this.updateFilters(),this.registerListeners()}model=this._register(new vA);_onDidAddNotification=this._register(new T);onDidAddNotification=this._onDidAddNotification.event;_onDidRemoveNotification=this._register(new T);onDidRemoveNotification=this._onDidRemoveNotification.event;registerListeners(){this._register(this.model.onDidChangeNotification(e=>{switch(e.kind){case 0:case 3:{let i=typeof e.item.sourceId=="string"&&typeof e.item.source=="string"?{id:e.item.sourceId,label:e.item.source}:e.item.source,n={message:e.item.message.original,severity:e.item.severity,source:i,priority:e.item.priority};e.kind===0&&(Ty(i)&&(this.mapSourceToFilter.has(i.id)?this.updateSourceFilter(i):this.setFilter({...i,filter:0})),this._onDidAddNotification.fire(n)),e.kind===3&&this._onDidRemoveNotification.fire(n);break}}}))}static GLOBAL_FILTER_SETTINGS_KEY="notifications.doNotDisturbMode";static PER_SOURCE_FILTER_SETTINGS_KEY="notifications.perSourceDoNotDisturbMode";_onDidChangeFilter=this._register(new T);onDidChangeFilter=this._onDidChangeFilter.event;globalFilterEnabled=this.storageService.getBoolean(Zc.GLOBAL_FILTER_SETTINGS_KEY,-1,!1);mapSourceToFilter=(()=>{let e=new Map;for(let i of this.storageService.getObject(Zc.PER_SOURCE_FILTER_SETTINGS_KEY,-1,[]))e.set(i.id,i);return e})();setFilter(e){if(typeof e=="number"){if(this.globalFilterEnabled===(e===1))return;this.globalFilterEnabled=e===1,this.storageService.store(Zc.GLOBAL_FILTER_SETTINGS_KEY,this.globalFilterEnabled,-1,1),this.updateFilters(),this._onDidChangeFilter.fire()}else{let i=this.mapSourceToFilter.get(e.id);if(i?.filter===e.filter&&i.label===e.label)return;this.mapSourceToFilter.set(e.id,{id:e.id,label:e.label,filter:e.filter}),this.saveSourceFilters(),this.updateFilters()}}getFilter(e){return e?this.mapSourceToFilter.get(e.id)?.filter??0:this.globalFilterEnabled?1:0}updateSourceFilter(e){let i=this.mapSourceToFilter.get(e.id);i&&i.label!==e.label&&(this.mapSourceToFilter.set(e.id,{id:e.id,label:e.label,filter:i.filter}),this.saveSourceFilters())}saveSourceFilters(){this.storageService.store(Zc.PER_SOURCE_FILTER_SETTINGS_KEY,JSON.stringify([...this.mapSourceToFilter.values()]),-1,1)}getFilters(){return[...this.mapSourceToFilter.values()]}updateFilters(){this.model.setFilter({global:this.globalFilterEnabled?1:0,sources:new Map([...this.mapSourceToFilter.values()].map(e=>[e.id,e.filter]))})}removeFilter(e){this.mapSourceToFilter.delete(e)&&(this.saveSourceFilters(),this.updateFilters())}info(e){if(Array.isArray(e)){for(let i of e)this.info(i);return}this.model.addNotification({severity:ui.Info,message:e})}warn(e){if(Array.isArray(e)){for(let i of e)this.warn(i);return}this.model.addNotification({severity:ui.Warning,message:e})}error(e){if(Array.isArray(e)){for(let i of e)this.error(i);return}this.model.addNotification({severity:ui.Error,message:e})}notify(e){let i=new W;if(e.neverShowAgain){let o=this.toStorageScope(e.neverShowAgain),s=e.neverShowAgain.id;if(this.storageService.getBoolean(s,o))return new rf;let a=i.add(new ot("workbench.notification.neverShowAgain",h("neverShowAgain","Don't Show Again"),void 0,!0,async()=>{n.close(),this.storageService.store(s,!0,o,0)})),l={primary:e.actions?.primary||[],secondary:e.actions?.secondary||[]};e.neverShowAgain.isSecondary?l.secondary=[...l.secondary,a]:l.primary=[a,...l.primary],e.actions=l}let n=this.model.addNotification(e);return O.once(n.onDidClose)(()=>i.dispose()),n}toStorageScope(e){switch(e.scope){case 2:return-1;case 1:return 0;case 0:return 1;default:return-1}}prompt(e,i,n,o){let s=new W;if(o?.neverShowAgain){let p=this.toStorageScope(o.neverShowAgain),m=o.neverShowAgain.id;if(this.storageService.getBoolean(m,p))return new rf;let g={label:h("neverShowAgain","Don't Show Again"),run:()=>this.storageService.store(m,!0,p,0),isSecondary:o.neverShowAgain.isSecondary};o.neverShowAgain.isSecondary?n=[...n,g]:n=[g,...n]}let a=!1,l=[],d=[];n.forEach((p,m)=>{let g=new gf(`workbench.dialog.choice.${m}`,p);p.isSecondary?d.push(g):l.push(g),s.add(g.onDidRun(()=>{a=!0,p.keepOpen||u.close()})),s.add(g)});let c={primary:l,secondary:d},u=this.notify({severity:e,message:i,actions:c,sticky:o?.sticky,priority:o?.priority});return O.once(u.onDidClose)(()=>{s.dispose(),o&&typeof o.onCancel=="function"&&!a&&o.onCancel()}),u}status(e,i){return this.model.showStatusMessage(e,i)}};Zc=_([v(0,tt)],Zc);vi(jt,Zc,1);var jo;(n=>{function r(o,s){if(o.start>=s.end||s.start>=o.end)return{start:0,end:0};let a=Math.max(o.start,s.start),l=Math.min(o.end,s.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}n.intersect=r;function t(o){return o.end-o.start<=0}n.isEmpty=t;function e(o,s){return!t(r(o,s))}n.intersects=e;function i(o,s){let a=[],l={start:o.start,end:Math.min(s.start,o.end)},d={start:Math.max(s.end,o.start),end:o.end};return t(l)||a.push(l),t(d)||a.push(d),a}n.relativeComplement=i})(jo||={});function c2(r,t,e){let i=e.mode===1?e.offset:e.offset+e.size,n=e.mode===1?e.offset+e.size:e.offset;return e.position===0?t<=r-i?i:t<=n?n-t:Math.max(r-t,0):t<=n?n-t:t<=r-i?i:0}var IA=class extends L{timeout;constructor(t,e){super(),this._register(M(t,"dragover",i=>{i.preventDefault(),this.timeout||(this.timeout=setTimeout(()=>{e(),this.timeout=null},800))})),["dragleave","drop","dragend"].forEach(i=>{this._register(M(t,i,()=>{this.clearDragTimeout()}))})}clearDragTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}dispose(){super.dispose(),this.clearDragTimeout()}},cs={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Id.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};function CA(r,t,e,i,n){let o=document.createElement("div");o.className=e,o.textContent=t,n&&(o.style.color=n),i&&(o.style.background=i),r.dataTransfer&&(oe(r).document.body.appendChild(o),r.dataTransfer.setDragImage(o,-10,-10),setTimeout(()=>o.remove(),0))}function eX(r,t){let e=[];for(let i of t){if(r.start>=i.range.end)continue;if(r.end<i.range.start)break;let n=jo.intersect(r,i.range);jo.isEmpty(n)||e.push({range:n,size:i.size})}return e}function wA({start:r,end:t},e){return{start:r+e,end:t+e}}function Bae(r){let t=[],e=null;for(let i of r){let n=i.range.start,o=i.range.end,s=i.size;if(e&&s===e.size){e.range.end=o;continue}e={range:{start:n,end:o},size:s},t.push(e)}return t}function Vae(...r){return Bae(r.reduce((t,e)=>t.concat(e),[]))}var SA=class{groups=[];_size=0;_paddingTop=0;get paddingTop(){return this._paddingTop}set paddingTop(t){this._size=this._size+t-this._paddingTop,this._paddingTop=t}constructor(t){this._paddingTop=t??0,this._size=this._paddingTop}splice(t,e,i=[]){let n=i.length-e,o=eX({start:0,end:t},this.groups),s=eX({start:t+e,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:wA(l.range,n),size:l.size})),a=i.map((l,d)=>({range:{start:t+d,end:t+d+1},size:l.size}));this.groups=Vae(o,a,s),this._size=this._paddingTop+this.groups.reduce((l,d)=>l+d.size*(d.range.end-d.range.start),0)}get count(){let t=this.groups.length;return t?this.groups[t-1].range.end:0}get size(){return this._size}indexAt(t){if(t<0)return-1;if(t<this._paddingTop)return 0;let e=0,i=this._paddingTop;for(let n of this.groups){let o=n.range.end-n.range.start,s=i+o*n.size;if(t<s)return e+Math.floor((t-i)/n.size);e+=o,i=s}return e}indexAfter(t){return Math.min(this.indexAt(t)+1,this.count)}positionAt(t){if(t<0)return-1;let e=0,i=0;for(let n of this.groups){let o=n.range.end-n.range.start,s=i+o;if(t<s)return this._paddingTop+e+(t-i)*n.size;e+=o*n.size,i=s}return-1}};var EA=class{constructor(t){this.renderers=t}cache=new Map;transactionNodesPendingRemoval=new Set;inTransaction=!1;alloc(t){let e=this.getTemplateCache(t).pop(),i=!1;if(e)i=this.transactionNodesPendingRemoval.has(e.domNode),i&&this.transactionNodesPendingRemoval.delete(e.domNode);else{let n=re(".monaco-list-row"),s=this.getRenderer(t).renderTemplate(n);e={domNode:n,templateId:t,templateData:s}}return{row:e,isReusingConnectedDomNode:i}}release(t){t&&this.releaseRow(t)}transact(t){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{t()}finally{for(let e of this.transactionNodesPendingRemoval)this.doRemoveNode(e);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(t){let{domNode:e,templateId:i}=t;e&&(this.inTransaction?this.transactionNodesPendingRemoval.add(e):this.doRemoveNode(e)),this.getTemplateCache(i).push(t)}doRemoveNode(t){t.classList.remove("scrolling"),t.remove()}getTemplateCache(t){let e=this.cache.get(t);return e||(e=[],this.cache.set(t,e)),e}dispose(){this.cache.forEach((t,e)=>{for(let i of t)this.getRenderer(e).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(t){let e=this.renderers.get(t);if(!e)throw new Error(`No renderer found for ${t}`);return e}};var tX=2e4,bf,TA,u2,xA,p2;function iX(r){bf=document.createElement("div"),bf.className="monaco-aria-container";let t=()=>{let i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),bf.appendChild(i),i};TA=t(),u2=t();let e=()=>{let i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),bf.appendChild(i),i};xA=e(),p2=e(),r.appendChild(bf)}function Xc(r){bf&&(TA.textContent!==r?(ci(u2),_A(TA,r)):(ci(TA),_A(u2,r)))}function QE(r){bf&&(xA.textContent!==r?(ci(p2),_A(xA,r)):(ci(xA),_A(p2,r)))}function _A(r,t){ci(r),t.length>tX&&(t=t.substr(0,tX)),r.textContent=t,r.style.visibility="hidden",r.style.visibility="visible"}var vf={CurrentDragAndDropData:void 0};var Qc={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(r){return[r]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0},Dp=class{elements;_context;get context(){return this._context}set context(t){this._context=t}constructor(t){this.elements=t}update(){}getData(){return this.elements}},h2=class{elements;constructor(t){this.elements=t}update(){}getData(){return this.elements}},m2=class{types;files;constructor(){this.types=[],this.files=[]}update(t){if(t.types&&this.types.splice(0,this.types.length,...t.types),t.files){this.files.splice(0,this.files.length);for(let e=0;e<t.files.length;e++){let i=t.files.item(e);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}};function Uae(r,t){return Array.isArray(r)&&Array.isArray(t)?ti(r,t):r===t}var g2=class{getSetSize;getPosInSet;getRole;isChecked;constructor(t){t?.getSetSize?this.getSetSize=t.getSetSize.bind(t):this.getSetSize=(e,i,n)=>n,t?.getPosInSet?this.getPosInSet=t.getPosInSet.bind(t):this.getPosInSet=(e,i)=>i+1,t?.getRole?this.getRole=t.getRole.bind(t):this.getRole=e=>"listitem",t?.isChecked?this.isChecked=t.isChecked.bind(t):this.isChecked=e=>{}}},ga=class ga{constructor(t,e,i,n=Qc){this.virtualDelegate=e;if(n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(let s of i)this.renderers.set(s.templateId,s);this.cache=this.disposables.add(new EA(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??Qc.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new g2(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??Qc.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Wt.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new fd({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:s=>nn(oe(this.domNode),s)})),this.scrollableElement=this.disposables.add(new nm(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??Qc.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??Qc.verticalScrollMode,useShadows:n.useShadows??Qc.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),t.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(M(this.rowsContainer,it.Change,s=>this.onTouchChange(s))),this.disposables.add(M(this.scrollableElement.getDomNode(),"scroll",s=>s.target.scrollTop=0)),this.disposables.add(M(this.domNode,"dragover",s=>this.onDragOver(this.toDragEvent(s)))),this.disposables.add(M(this.domNode,"drop",s=>this.onDrop(this.toDragEvent(s)))),this.disposables.add(M(this.domNode,"dragleave",s=>this.onDragLeave(this.toDragEvent(s)))),this.disposables.add(M(this.domNode,"dragend",s=>this.onDragEnd(s))),this.setRowLineHeight=n.setRowLineHeight??Qc.setRowLineHeight,this.setRowHeight=n.setRowHeight??Qc.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??Qc.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(Qc.dnd),this.layout(n.initialSize?.height,n.initialSize?.width)}static InstanceCount=0;domId=`list_id_${++ga.InstanceCount}`;domNode;items;itemId;rangeMap;cache;renderers=new Map;lastRenderTop;lastRenderHeight;renderWidth=0;rowsContainer;scrollable;scrollableElement;_scrollHeight=0;scrollableElementUpdateDisposable=null;scrollableElementWidthDelayer=new bs(50);splicing=!1;dragOverAnimationDisposable;dragOverAnimationStopDisposable=L.None;dragOverMouseY=0;setRowLineHeight;setRowHeight;supportDynamicHeights;paddingBottom;accessibilityProvider;scrollWidth;dnd;canDrop=!1;currentDragData;currentDragFeedback;currentDragFeedbackPosition;currentDragFeedbackDisposable=L.None;onDragLeaveTimeout=L.None;disposables=new W;_onDidChangeContentHeight=new T;_onDidChangeContentWidth=new T;onDidChangeContentHeight=O.latch(this._onDidChangeContentHeight.event,void 0,this.disposables);onDidChangeContentWidth=O.latch(this._onDidChangeContentWidth.event,void 0,this.disposables);get contentHeight(){return this.rangeMap.size}get contentWidth(){return this.scrollWidth??0}get onDidScroll(){return this.scrollableElement.onScroll}get onWillScroll(){return this.scrollableElement.onWillScroll}get containerDomNode(){return this.rowsContainer}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}_horizontalScrolling=!1;get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(t){if(t!==this._horizontalScrolling){if(t&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=t,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(let e of this.items)this.measureItemWidth(e);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:zv(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(t){t.paddingBottom!==void 0&&(this.paddingBottom=t.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),t.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(t.smoothScrolling?125:0),t.horizontalScrolling!==void 0&&(this.horizontalScrolling=t.horizontalScrolling);let e;if(t.scrollByPage!==void 0&&(e={...e??{},scrollByPage:t.scrollByPage}),t.mouseWheelScrollSensitivity!==void 0&&(e={...e??{},mouseWheelScrollSensitivity:t.mouseWheelScrollSensitivity}),t.fastScrollSensitivity!==void 0&&(e={...e??{},fastScrollSensitivity:t.fastScrollSensitivity}),e&&this.scrollableElement.updateOptions(e),t.paddingTop!==void 0&&t.paddingTop!==this.rangeMap.paddingTop){let i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=t.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=t.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}delegateScrollFromMouseWheelEvent(t){this.scrollableElement.delegateScrollFromMouseWheelEvent(t)}delegateVerticalScrollbarPointerDown(t){this.scrollableElement.delegateVerticalScrollbarPointerDown(t)}updateElementHeight(t,e,i){if(t<0||t>=this.items.length)return;let n=this.items[t].size;if(typeof e>"u"){if(!this.supportDynamicHeights){console.warn("Dynamic heights not supported",new Error().stack);return}this.items[t].lastDynamicHeightWidth=void 0,e=n+this.probeDynamicHeight(t)}if(n===e)return;let o=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=0;t<o.start||i!==null&&i>t&&i<o.end?s=e-n:s=0,this.rangeMap.splice(t,1,[{size:e}]),this.items[t].size=e,this.render(o,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}createRangeMap(t){return new SA(t)}splice(t,e,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(t,e,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(t,e,i=[]){let n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),o={start:t,end:t+e},s=jo.intersect(n,o),a=new Map;for(let w=s.end-1;w>=s.start;w--){let D=this.items[w];if(D.dragStartDisposable.dispose(),D.checkedDisposable.dispose(),D.row){let k=a.get(D.templateId);k||(k=[],a.set(D.templateId,k));let R=this.renderers.get(D.templateId);R&&R.disposeElement&&R.disposeElement(D.element,w,D.row.templateData,D.size),k.unshift(D.row)}D.row=null,D.stale=!0}let l={start:t+e,end:this.items.length},d=jo.intersect(l,n),c=jo.relativeComplement(l,n),u=i.map(w=>({id:String(this.itemId++),element:w,templateId:this.virtualDelegate.getTemplateId(w),size:this.virtualDelegate.getHeight(w),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(w),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:L.None,checkedDisposable:L.None,stale:!1})),p;t===0&&e>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),p=this.items,this.items=u):(this.rangeMap.splice(t,e,u),p=this.items.splice(t,e,...u));let m=i.length-e,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),f=wA(d,m),b=jo.intersect(g,f);for(let w=b.start;w<b.end;w++)this.updateItemInDOM(this.items[w],w);let y=jo.relativeComplement(f,g);for(let w of y)for(let D=w.start;D<w.end;D++)this.removeItemFromDOM(D);let I=c.map(w=>wA(w,m)),S=[{start:t,end:t+i.length},...I].map(w=>jo.intersect(g,w)).reverse();for(let w of S)for(let D=w.end-1;D>=w.start;D--){let k=this.items[D],A=a.get(k.templateId)?.pop();this.insertItemInDOM(D,A)}for(let w of a.values())for(let D of w)this.cache.release(D);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),p.map(w=>w.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=nn(oe(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let t=0;for(let e of this.items)typeof e.width<"u"&&(t=Math.max(t,e.width));this.scrollWidth=t,this.scrollableElement.setScrollDimensions({scrollWidth:t===0?0:t+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}updateWidth(t){if(!this.horizontalScrolling||typeof this.scrollWidth>"u")return;let e=this.items[t];this.measureItemWidth(e),typeof e.width<"u"&&e.width>this.scrollWidth&&(this.scrollWidth=e.width,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth+10}),this._onDidChangeContentWidth.fire(this.scrollWidth))}rerender(){if(this.supportDynamicHeights){for(let t of this.items)t.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}get firstMostlyVisibleIndex(){let t=this.firstVisibleIndex,e=this.rangeMap.positionAt(t),i=this.rangeMap.positionAt(t+1);return i!==-1&&(i-e)/2+e<this.scrollTop?t+1:t}get lastVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).end-1}element(t){return this.items[t].element}indexOf(t){return this.items.findIndex(e=>e.element===t)}domElement(t){let e=this.items[t].row;return e&&e.domNode}elementHeight(t){return this.items[t].size}elementTop(t){return this.rangeMap.positionAt(t)}indexAt(t){return this.rangeMap.indexAt(t)}indexAfter(t){return this.rangeMap.indexAfter(t)}layout(t,e){let i={height:typeof t=="number"?t:ik(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof e<"u"&&(this.renderWidth=e,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof e=="number"?e:zv(this.domNode)})}render(t,e,i,n,o,s=!1){let a=this.getRenderRange(e,i),l=jo.relativeComplement(a,t).reverse(),d=jo.relativeComplement(t,a);if(s){let c=jo.intersect(t,a);for(let u=c.start;u<c.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(let c of d)for(let u=c.start;u<c.end;u++)this.removeItemFromDOM(u);for(let c of l)for(let u=c.end-1;u>=c.start;u--)this.insertItemInDOM(u)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${e}px`,this.horizontalScrolling&&o!==void 0&&(this.rowsContainer.style.width=`${Math.max(o,this.renderWidth)}px`),this.lastRenderTop=e,this.lastRenderHeight=i}insertItemInDOM(t,e){let i=this.items[t];if(!i.row)if(e)i.row=e,i.stale=!0;else{let l=this.cache.alloc(i.templateId);i.row=l.row,i.stale||=l.isReusingConnectedDomNode}let n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);let o=this.accessibilityProvider.isChecked(i.element);if(typeof o=="boolean")i.row.domNode.setAttribute("aria-checked",String(!!o));else if(o){let l=d=>i.row.domNode.setAttribute("aria-checked",String(!!d));l(o.value),i.checkedDisposable=o.onDidChange(()=>l(o.value))}if(i.stale||!i.row.domNode.parentElement){let l=this.items.at(t+1)?.row?.domNode??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(i.row.domNode,l),i.stale=!1}this.updateItemInDOM(i,t);let s=this.renderers.get(i.templateId);if(!s)throw new Error(`No renderer found for template id ${i.templateId}`);s?.renderElement(i.element,t,i.row.templateData,i.size);let a=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!a,a&&(i.dragStartDisposable=M(i.row.domNode,"dragstart",l=>this.onDragStart(i.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(t){if(!t.row||!t.row.domNode)return;t.row.domNode.style.width="fit-content",t.width=zv(t.row.domNode);let e=oe(t.row.domNode).getComputedStyle(t.row.domNode);e.paddingLeft&&(t.width+=parseFloat(e.paddingLeft)),e.paddingRight&&(t.width+=parseFloat(e.paddingRight)),t.row.domNode.style.width=""}updateItemInDOM(t,e){t.row.domNode.style.top=`${this.elementTop(e)}px`,this.setRowHeight&&(t.row.domNode.style.height=`${t.size}px`),this.setRowLineHeight&&(t.row.domNode.style.lineHeight=`${t.size}px`),t.row.domNode.setAttribute("data-index",`${e}`),t.row.domNode.setAttribute("data-last-element",e===this.length-1?"true":"false"),t.row.domNode.setAttribute("data-parity",e%2===0?"even":"odd"),t.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t.element,e,this.length))),t.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t.element,e))),t.row.domNode.setAttribute("id",this.getElementDomId(e)),t.row.domNode.classList.toggle("drop-target",t.dropTarget)}removeItemFromDOM(t){let e=this.items[t];if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){let i=this.renderers.get(e.templateId);i&&i.disposeElement&&i.disposeElement(e.element,t,e.row.templateData,e.size),this.cache.release(e.row),e.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(t,e){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:t,reuseAnimation:e})}getScrollLeft(){return this.scrollableElement.getScrollPosition().scrollLeft}setScrollLeft(t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollWidth:this.scrollWidth})),this.scrollableElement.setScrollPosition({scrollLeft:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(t){this.setScrollTop(t)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return O.map(this.disposables.add(new Ge(this.domNode,"click")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseDblClick(){return O.map(this.disposables.add(new Ge(this.domNode,"dblclick")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseMiddleClick(){return O.filter(O.map(this.disposables.add(new Ge(this.domNode,"auxclick")).event,t=>this.toMouseEvent(t),this.disposables),t=>t.browserEvent.button===1,this.disposables)}get onMouseUp(){return O.map(this.disposables.add(new Ge(this.domNode,"mouseup")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseDown(){return O.map(this.disposables.add(new Ge(this.domNode,"mousedown")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseOver(){return O.map(this.disposables.add(new Ge(this.domNode,"mouseover")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseMove(){return O.map(this.disposables.add(new Ge(this.domNode,"mousemove")).event,t=>this.toMouseEvent(t),this.disposables)}get onMouseOut(){return O.map(this.disposables.add(new Ge(this.domNode,"mouseout")).event,t=>this.toMouseEvent(t),this.disposables)}get onContextMenu(){return O.any(O.map(this.disposables.add(new Ge(this.domNode,"contextmenu")).event,t=>this.toMouseEvent(t),this.disposables),O.map(this.disposables.add(new Ge(this.domNode,it.Contextmenu)).event,t=>this.toGestureEvent(t),this.disposables))}get onTouchStart(){return O.map(this.disposables.add(new Ge(this.domNode,"touchstart")).event,t=>this.toTouchEvent(t),this.disposables)}get onTap(){return O.map(this.disposables.add(new Ge(this.rowsContainer,it.Tap)).event,t=>this.toGestureEvent(t),this.disposables)}toMouseEvent(t){let e=this.getItemIndexFromEventTarget(t.target||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element;return{browserEvent:t,index:e,element:n}}toTouchEvent(t){let e=this.getItemIndexFromEventTarget(t.target||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element;return{browserEvent:t,index:e,element:n}}toGestureEvent(t){let e=this.getItemIndexFromEventTarget(t.initialTarget||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element;return{browserEvent:t,index:e,element:n}}toDragEvent(t){let e=this.getItemIndexFromEventTarget(t.target||null),i=typeof e>"u"?void 0:this.items[e],n=i&&i.element,o=this.getTargetSector(t,e);return{browserEvent:t,index:e,element:n,sector:o}}onScroll(t){try{let e=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(e,t.scrollTop,t.height,t.scrollLeft,t.scrollWidth),this.supportDynamicHeights&&this._rerender(t.scrollTop,t.height,t.inSmoothScrolling)}catch(e){throw console.error("Got bad scroll event:",t),e}}onTouchChange(t){t.preventDefault(),t.stopPropagation(),this.scrollTop-=t.translationY}onDragStart(t,e,i){if(!i.dataTransfer)return;let n=this.dnd.getDragElements(t);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(cs.TEXT,e),i.dataTransfer.setDragImage){let o;this.dnd.getDragLabel&&(o=this.dnd.getDragLabel(n,i)),typeof o>"u"&&(o=String(n.length));let s=re(".monaco-drag-image");s.textContent=o,(d=>{for(;d&&!d.classList.contains("monaco-workbench");)d=d.parentElement;return d||this.domNode.ownerDocument})(this.domNode).appendChild(s),i.dataTransfer.setDragImage(s,-10,-10),setTimeout(()=>s.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new Dp(n),vf.CurrentDragAndDropData=new h2(n),this.dnd.onDragStart?.(this.currentDragData,i)}onDragOver(t){if(t.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),vf.CurrentDragAndDropData&&vf.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(t.browserEvent),!t.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(vf.CurrentDragAndDropData)this.currentDragData=vf.CurrentDragAndDropData;else{if(!t.browserEvent.dataTransfer.types)return!1;this.currentDragData=new m2}let e=this.dnd.onDragOver(this.currentDragData,t.element,t.index,t.sector,t.browserEvent);if(this.canDrop=typeof e=="boolean"?e:e.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;t.browserEvent.dataTransfer.dropEffect=typeof e!="boolean"&&e.effect?.type===0?"copy":"move";let i;typeof e!="boolean"&&e.feedback?i=e.feedback:typeof t.index>"u"?i=[-1]:i=[t.index],i=yo(i).filter(o=>o>=-1&&o<this.length).sort((o,s)=>o-s),i=i[0]===-1?[-1]:i;let n=typeof e!="boolean"&&e.effect&&e.effect.position?e.effect.position:"drop-target";if(Uae(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=te(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(let o of i){let s=this.items[o];s.dropTarget=!0,s.row?.domNode.classList.add(n)}this.currentDragFeedbackDisposable=te(()=>{for(let o of i){let s=this.items[o];s.dropTarget=!1,s.row?.domNode.classList.remove(n)}})}return!0}onDragLeave(t){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=pw(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,t.element,t.index,t.browserEvent)}onDrop(t){if(!this.canDrop)return;let e=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,vf.CurrentDragAndDropData=void 0,!(!e||!t.browserEvent.dataTransfer)&&(t.browserEvent.preventDefault(),e.update(t.browserEvent.dataTransfer),this.dnd.drop(e,t.element,t.index,t.sector,t.browserEvent))}onDragEnd(t){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,vf.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(t)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=L.None}setupDragAndDropScrollTopAnimation(t){if(!this.dragOverAnimationDisposable){let e=$w(this.domNode).top;this.dragOverAnimationDisposable=a$(oe(this.domNode),this.animateDragAndDropScrollTop.bind(this,e))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=pw(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=t.pageY}animateDragAndDropScrollTop(t){if(this.dragOverMouseY===void 0)return;let e=this.dragOverMouseY-t,i=this.renderHeight-35;e<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(e-35))):e>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(e-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(t,e){if(e===void 0)return;let i=t.offsetY/this.items[e].size,n=Math.floor(i/.25);return sr(n,0,3)}getItemIndexFromEventTarget(t){let e=this.scrollableElement.getDomNode(),i=t;for(;(Oi(i)||e$(i))&&i!==this.rowsContainer&&e.contains(i);){let n=i.getAttribute("data-index");if(n){let o=Number(n);if(!isNaN(o))return o}i=i.parentElement}}getRenderRange(t,e){return{start:this.rangeMap.indexAt(t),end:this.rangeMap.indexAfter(t+e-1)}}_rerender(t,e,i){let n=this.getRenderRange(t,e),o,s;t===this.elementTop(n.start)?(o=n.start,s=0):n.end-n.start>1&&(o=n.start+1,s=this.elementTop(o)-t);let a=0;for(;;){let l=this.getRenderRange(t,e),d=!1;for(let c=l.start;c<l.end;c++){let u=this.probeDynamicHeight(c);u!==0&&this.rangeMap.splice(c,1,[this.items[c]]),a+=u,d=d||u!==0}if(!d){a!==0&&this.eventuallyUpdateScrollDimensions();let c=jo.relativeComplement(n,l);for(let p of c)for(let m=p.start;m<p.end;m++)this.items[m].row&&this.removeItemFromDOM(m);let u=jo.relativeComplement(l,n).reverse();for(let p of u)for(let m=p.end-1;m>=p.start;m--)this.insertItemInDOM(m);for(let p=l.start;p<l.end;p++)this.items[p].row&&this.updateItemInDOM(this.items[p],p);if(typeof o=="number"){let p=this.scrollable.getFutureScrollPosition().scrollTop-t,m=this.elementTop(o)-s+p;this.setScrollTop(m,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(t){let e=this.items[t];if(this.virtualDelegate.getDynamicHeight){let s=this.virtualDelegate.getDynamicHeight(e.element);if(s!==null){let a=e.size;return e.size=s,e.lastDynamicHeightWidth=this.renderWidth,s-a}}if(!e.hasDynamicHeight||e.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(e.element))return 0;let i=e.size;if(e.row)return e.row.domNode.style.height="",e.size=e.row.domNode.offsetHeight,e.size===0&&!Xi(e.row.domNode,oe(e.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),e.lastDynamicHeightWidth=this.renderWidth,e.size-i;let{row:n}=this.cache.alloc(e.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);let o=this.renderers.get(e.templateId);if(!o)throw new yt("Missing renderer for templateId: "+e.templateId);return o.renderElement(e.element,t,n.templateData,void 0),e.size=n.domNode.offsetHeight,o.disposeElement?.(e.element,t,n.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(e.element,e.size),e.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),e.size-i}getElementDomId(t){return`${this.domId}_${t}`}dispose(){for(let t of this.items)if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){let e=this.renderers.get(t.row.templateId);e&&(e.disposeElement?.(t.element,-1,t.row.templateData,void 0),e.disposeTemplate(t.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};_([ue],ga.prototype,"onMouseClick",1),_([ue],ga.prototype,"onMouseDblClick",1),_([ue],ga.prototype,"onMouseMiddleClick",1),_([ue],ga.prototype,"onMouseUp",1),_([ue],ga.prototype,"onMouseDown",1),_([ue],ga.prototype,"onMouseOver",1),_([ue],ga.prototype,"onMouseMove",1),_([ue],ga.prototype,"onMouseOut",1),_([ue],ga.prototype,"onContextMenu",1),_([ue],ga.prototype,"onTouchStart",1),_([ue],ga.prototype,"onTap",1);var DA=ga;var Jc=class extends Error{constructor(t,e){super(`ListError [${t}] ${e}`)}};var LA=class{constructor(t){this.spliceables=t}splice(t,e,i){this.spliceables.forEach(n=>n.splice(t,e,i))}};var f2=class{constructor(t){this.trait=t}renderedElements=[];get templateId(){return`template:${this.trait.name}`}renderTemplate(t){return t}renderElement(t,e,i){let n=this.renderedElements.findIndex(o=>o.templateData===i);if(n>=0){let o=this.renderedElements[n];this.trait.unrender(i),o.index=e}else{let o={index:e,templateData:i};this.renderedElements.push(o)}this.trait.renderIndex(e,i)}splice(t,e,i){let n=[];for(let o of this.renderedElements)o.index<t?n.push(o):o.index>=t+e&&n.push({index:o.index+i-e,templateData:o.templateData});this.renderedElements=n}renderIndexes(t){for(let{index:e,templateData:i}of this.renderedElements)t.indexOf(e)>-1&&this.trait.renderIndex(e,i)}disposeTemplate(t){let e=this.renderedElements.findIndex(i=>i.templateData===t);e<0||this.renderedElements.splice(e,1)}},Uy=class{constructor(t){this._trait=t}indexes=[];sortedIndexes=[];_onChange=new T;onChange=this._onChange.event;get name(){return this._trait}get renderer(){return new f2(this)}splice(t,e,i){let n=i.length-e,o=t+e,s=[],a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<t;)s.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&s.push(l+t);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=o;)s.push(this.sortedIndexes[a++]+n);this.renderer.splice(t,e,i.length),this._set(s,s)}renderIndex(t,e){e.classList.toggle(this._trait,this.contains(t))}unrender(t){t.classList.remove(this._trait)}set(t,e){return this._set(t,[...t].sort(oX),e)}_set(t,e,i){let n=this.indexes,o=this.sortedIndexes;this.indexes=t,this.sortedIndexes=e;let s=I2(o,t);return this.renderer.renderIndexes(s),this._onChange.fire({indexes:t,browserEvent:i}),n}get(){return this.indexes}contains(t){return g7(this.sortedIndexes,t,oX)>=0}dispose(){nt(this._onChange)}};_([ue],Uy.prototype,"renderer",1);var b2=class extends Uy{constructor(e){super("selected");this.setAriaSelected=e}renderIndex(e,i){super.renderIndex(e,i),this.setAriaSelected&&(this.contains(e)?i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false"))}},JE=class{constructor(t,e,i){this.trait=t;this.view=e;this.identityProvider=i}splice(t,e,i){if(!this.identityProvider)return this.trait.splice(t,e,new Array(i.length).fill(!1));let n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(t,e,new Array(i.length).fill(!1));let o=new Set(n),s=i.map(a=>o.has(this.identityProvider.getId(a).toString()));this.trait.splice(t,e,s)}};function tT(r,t){return r.classList.contains(t)?!0:r.classList.contains("monaco-list")||!r.parentElement?!1:tT(r.parentElement,t)}function Wy(r){return tT(r,"monaco-editor")}function rX(r){return tT(r,"monaco-custom-toggle")}function sX(r){return tT(r,"action-item")}function Hy(r){return tT(r,"monaco-tree-sticky-row")}function zy(r){return r.classList.contains("monaco-tree-sticky-container")}function E2(r){return r.tagName==="A"&&r.classList.contains("monaco-button")||r.tagName==="DIV"&&r.classList.contains("monaco-button-dropdown")?!0:r.classList.contains("monaco-list")||!r.parentElement?!1:E2(r.parentElement)}var kA=class{constructor(t,e,i){this.list=t;this.view=e;this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(be?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}disposables=new W;multipleSelectionDisposables=new W;multipleSelectionSupport;get onKeyDown(){return O.chain(this.disposables.add(new Ge(this.view.domNode,"keydown")).event,t=>t.filter(e=>!sa(e.target)).map(e=>new st(e)))}updateOptions(t){t.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=t.multipleSelectionSupport)}onEnter(t){t.preventDefault(),t.stopPropagation(),this.list.setSelection(this.list.getFocus(),t.browserEvent)}onUpArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusPrevious(1,!1,t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onDownArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusNext(1,!1,t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onPageUpArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusPreviousPage(t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onPageDownArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusNextPage(t.browserEvent);let e=this.list.getFocus()[0];this.list.setAnchor(e),this.list.reveal(e),this.view.domNode.focus()}onCtrlA(t){t.preventDefault(),t.stopPropagation(),this.list.setSelection(Io(this.list.length),t.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(t){this.list.getSelection().length&&(t.preventDefault(),t.stopPropagation(),this.list.setSelection([],t.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}};_([ue],kA.prototype,"onKeyDown",1);var Kae=new class{mightProducePrintableCharacter(r){return r.ctrlKey||r.metaKey||r.altKey?!1:r.keyCode>=31&&r.keyCode<=56||r.keyCode>=21&&r.keyCode<=30||r.keyCode>=98&&r.keyCode<=107||r.keyCode>=85&&r.keyCode<=95}},v2=class{constructor(t,e,i,n,o){this.list=t;this.view=e;this.keyboardNavigationLabelProvider=i;this.keyboardNavigationEventFilter=n;this.delegate=o;this.updateOptions(t.options)}enabled=!1;state=0;mode=0;triggered=!1;previouslyFocused=-1;enabledDisposables=new W;disposables=new W;updateOptions(t){t.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=t.typeNavigationMode??0}trigger(){this.triggered=!this.triggered}enable(){if(this.enabled)return;let t=!1,e=O.chain(this.enabledDisposables.add(new Ge(this.view.domNode,"keydown")).event,o=>o.filter(s=>!sa(s.target)).filter(()=>this.mode===0||this.triggered).map(s=>new st(s)).filter(s=>t||this.keyboardNavigationEventFilter(s)).filter(s=>this.delegate.mightProducePrintableCharacter(s)).forEach(s=>Te.stop(s,!0)).map(s=>s.browserEvent.key)),i=O.debounce(e,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);O.reduce(O.any(e,i),(o,s)=>s===null?null:(o||"")+s,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),e(()=>t=!0,void 0,this.enabledDisposables),i(()=>t=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){let t=this.list.getFocus();if(t.length>0&&t[0]===this.previouslyFocused){let e=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(t[0]));typeof e=="string"?Xc(e):e&&Xc(e.get())}this.previouslyFocused=-1}onInput(t){if(!t){this.state=0,this.triggered=!1;return}let e=this.list.getFocus(),i=e.length>0?e[0]:0,n=this.state===0?1:0;this.state=1;for(let o=0;o<this.list.length;o++){let s=(i+o+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(s)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(Dg(t,l)){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}let d=n3(t,l);if(d&&d[0].end-d[0].start>1&&d.length===1){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}}}else if(typeof l>"u"||Dg(t,l)){this.previouslyFocused=i,this.list.setFocus([s]),this.list.reveal(s);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}},y2=class{constructor(t,e){this.list=t;this.view=e;let i=O.chain(this.disposables.add(new Ge(e.domNode,"keydown")).event,o=>o.filter(s=>!sa(s.target)).map(s=>new st(s)));O.chain(i,o=>o.filter(s=>s.keyCode===2&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey))(this.onTab,this,this.disposables)}disposables=new W;onTab(t){if(t.target!==this.view.domNode)return;let e=this.list.getFocus();if(e.length===0)return;let i=this.view.domElement(e[0]);if(!i)return;let n=i.querySelector("[tabIndex]");if(!n||!Oi(n)||n.tabIndex===-1)return;let o=oe(n).getComputedStyle(n);o.visibility==="hidden"||o.display==="none"||(t.preventDefault(),t.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}};function T2(r){return be?r.browserEvent.metaKey:r.browserEvent.ctrlKey}function x2(r){return r.browserEvent.shiftKey}function Gae(r){return Na(r)&&r.button===2}var nX={isSelectionSingleChangeEvent:T2,isSelectionRangeChangeEvent:x2},eT=class{constructor(t){this.list=t;t.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||nX),this.mouseSupport=typeof t.options.mouseSupport>"u"||!!t.options.mouseSupport,this.mouseSupport&&(t.onMouseDown(this.onMouseDown,this,this.disposables),t.onContextMenu(this.onContextMenu,this,this.disposables),t.onMouseDblClick(this.onDoubleClick,this,this.disposables),t.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Wt.addTarget(t.getHTMLElement()))),O.any(t.onMouseClick,t.onMouseMiddleClick,t.onTap)(this.onViewPointer,this,this.disposables)}multipleSelectionController;mouseSupport;disposables=new W;_onPointer=new T;onPointer=this._onPointer.event;updateOptions(t){t.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,t.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||nX))}isSelectionSingleChangeEvent(t){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(t):!1}isSelectionRangeChangeEvent(t){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(t):!1}isSelectionChangeEvent(t){return this.isSelectionSingleChangeEvent(t)||this.isSelectionRangeChangeEvent(t)}onMouseDown(t){Wy(t.browserEvent.target)||An()!==t.browserEvent.target&&this.list.domFocus()}onContextMenu(t){if(sa(t.browserEvent.target)||Wy(t.browserEvent.target))return;let e=typeof t.index>"u"?[]:[t.index];this.list.setFocus(e,t.browserEvent)}onViewPointer(t){if(!this.mouseSupport||sa(t.browserEvent.target)||Wy(t.browserEvent.target)||t.browserEvent.isHandledByList)return;t.browserEvent.isHandledByList=!0;let e=t.index;if(typeof e>"u"){this.list.setFocus([],t.browserEvent),this.list.setSelection([],t.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(t))return this.changeSelection(t);this.list.setFocus([e],t.browserEvent),this.list.setAnchor(e),Gae(t.browserEvent)||this.list.setSelection([e],t.browserEvent),this._onPointer.fire(t)}onDoubleClick(t){if(sa(t.browserEvent.target)||Wy(t.browserEvent.target)||this.isSelectionChangeEvent(t)||t.browserEvent.isHandledByList)return;t.browserEvent.isHandledByList=!0;let e=this.list.getFocus();this.list.setSelection(e,t.browserEvent)}changeSelection(t){let e=t.index,i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(t)){typeof i>"u"&&(i=this.list.getFocus()[0]??e,this.list.setAnchor(i));let n=Math.min(i,e),o=Math.max(i,e),s=Io(n,o+1),a=this.list.getSelection(),l=jae(I2(a,[i]),i);if(l.length===0)return;let d=I2(s,$ae(a,l));this.list.setSelection(d,t.browserEvent),this.list.setFocus([e],t.browserEvent)}else if(this.isSelectionSingleChangeEvent(t)){let n=this.list.getSelection(),o=n.filter(s=>s!==e);this.list.setFocus([e]),this.list.setAnchor(e),n.length===o.length?this.list.setSelection([...o,e],t.browserEvent):this.list.setSelection(o,t.browserEvent)}}dispose(){this.disposables.dispose()}},RA=class{constructor(t,e){this.styleElement=t;this.selectorSuffix=e}style(t){let e=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];t.listBackground&&i.push(`.monaco-list${e} .monaco-list-rows { background: ${t.listBackground}; }`),t.listFocusBackground&&(i.push(`.monaco-list${e}:focus .monaco-list-row.focused { background-color: ${t.listFocusBackground}; }`),i.push(`.monaco-list${e}:focus .monaco-list-row.focused:hover { background-color: ${t.listFocusBackground}; }`)),t.listFocusForeground&&i.push(`.monaco-list${e}:focus .monaco-list-row.focused { color: ${t.listFocusForeground}; }`),t.listActiveSelectionBackground&&(i.push(`.monaco-list${e}:focus .monaco-list-row.selected { background-color: ${t.listActiveSelectionBackground}; }`),i.push(`.monaco-list${e}:focus .monaco-list-row.selected:hover { background-color: ${t.listActiveSelectionBackground}; }`)),t.listActiveSelectionForeground&&i.push(`.monaco-list${e}:focus .monaco-list-row.selected { color: ${t.listActiveSelectionForeground}; }`),t.listActiveSelectionIconForeground&&i.push(`.monaco-list${e}:focus .monaco-list-row.selected .codicon { color: ${t.listActiveSelectionIconForeground}; }`),t.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image,
				.monaco-list${e}:focus .monaco-list-row.selected.focused { background-color: ${t.listFocusAndSelectionBackground}; }
			`),t.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image,
				.monaco-list${e}:focus .monaco-list-row.selected.focused { color: ${t.listFocusAndSelectionForeground}; }
			`),t.listInactiveFocusForeground&&(i.push(`.monaco-list${e} .monaco-list-row.focused { color:  ${t.listInactiveFocusForeground}; }`),i.push(`.monaco-list${e} .monaco-list-row.focused:hover { color:  ${t.listInactiveFocusForeground}; }`)),t.listInactiveSelectionIconForeground&&i.push(`.monaco-list${e} .monaco-list-row.focused .codicon { color:  ${t.listInactiveSelectionIconForeground}; }`),t.listInactiveFocusBackground&&(i.push(`.monaco-list${e} .monaco-list-row.focused { background-color:  ${t.listInactiveFocusBackground}; }`),i.push(`.monaco-list${e} .monaco-list-row.focused:hover { background-color:  ${t.listInactiveFocusBackground}; }`)),t.listInactiveSelectionBackground&&(i.push(`.monaco-list${e} .monaco-list-row.selected { background-color:  ${t.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${e} .monaco-list-row.selected:hover { background-color:  ${t.listInactiveSelectionBackground}; }`)),t.listInactiveSelectionForeground&&i.push(`.monaco-list${e} .monaco-list-row.selected { color: ${t.listInactiveSelectionForeground}; }`),t.listHoverBackground&&i.push(`.monaco-list${e}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${t.listHoverBackground}; }`),t.listHoverForeground&&i.push(`.monaco-list${e}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${t.listHoverForeground}; }`);let n=Is(t.listFocusAndSelectionOutline,Is(t.listSelectionOutline,t.listFocusOutline??""));n&&i.push(`.monaco-list${e}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),t.listFocusOutline&&i.push(`
				.monaco-drag-image,
				.monaco-list${e}:focus .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }
			`);let o=Is(t.listSelectionOutline,t.listInactiveFocusOutline??"");o&&i.push(`.monaco-list${e} .monaco-list-row.focused.selected { outline: 1px dotted ${o}; outline-offset: -1px; }`),t.listSelectionOutline&&i.push(`.monaco-list${e} .monaco-list-row.selected { outline: 1px dotted ${t.listSelectionOutline}; outline-offset: -1px; }`),t.listInactiveFocusOutline&&i.push(`.monaco-list${e} .monaco-list-row.focused { outline: 1px dotted ${t.listInactiveFocusOutline}; outline-offset: -1px; }`),t.listHoverOutline&&i.push(`.monaco-list${e} .monaco-list-row:hover { outline: 1px dashed ${t.listHoverOutline}; outline-offset: -1px; }`),t.listDropOverBackground&&i.push(`
				.monaco-list${e}.drop-target,
				.monaco-list${e} .monaco-list-rows.drop-target,
				.monaco-list${e} .monaco-list-row.drop-target { background-color: ${t.listDropOverBackground} !important; color: inherit !important; }
			`),t.listDropBetweenBackground&&(i.push(`
			.monaco-list${e} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${e} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${t.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${e} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${e} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${t.listDropBetweenBackground};
			}`)),t.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${t.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),t.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${t.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}},AA={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:Y.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:Y.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:Y.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},qae={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function jae(r,t){let e=r.indexOf(t);if(e===-1)return[];let i=[],n=e-1;for(;n>=0&&r[n]===t-(e-n);)i.push(r[n--]);for(i.reverse(),n=e;n<r.length&&r[n]===t+(n-e);)i.push(r[n++]);return i}function I2(r,t){let e=[],i=0,n=0;for(;i<r.length||n<t.length;)if(i>=r.length)e.push(t[n++]);else if(n>=t.length)e.push(r[i++]);else if(r[i]===t[n]){e.push(r[i]),i++,n++;continue}else r[i]<t[n]?e.push(r[i++]):e.push(t[n++]);return e}function $ae(r,t){let e=[],i=0,n=0;for(;i<r.length||n<t.length;)if(i>=r.length)e.push(t[n++]);else if(n>=t.length)e.push(r[i++]);else if(r[i]===t[n]){i++,n++;continue}else r[i]<t[n]?e.push(r[i++]):n++;return e}var oX=(r,t)=>r-t,C2=class{constructor(t,e){this._templateId=t;this.renderers=e}get templateId(){return this._templateId}renderTemplate(t){return this.renderers.map(e=>e.renderTemplate(t))}renderElement(t,e,i,n){let o=0;for(let s of this.renderers)s.renderElement(t,e,i[o++],n)}disposeElement(t,e,i,n){let o=0;for(let s of this.renderers)s.disposeElement?.(t,e,i[o],n),o+=1}disposeTemplate(t){let e=0;for(let i of this.renderers)i.disposeTemplate(t[e++])}},S2=class{constructor(t){this.accessibilityProvider=t}templateId="a18n";renderTemplate(t){return{container:t,disposables:new W}}renderElement(t,e,i){let n=this.accessibilityProvider.getAriaLabel(t),o=n&&typeof n!="string"?n:uh(n);i.disposables.add(Ut(a=>{this.setAriaLabel(a.readObservable(o),i.container)}));let s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);typeof s=="number"?i.container.setAttribute("aria-level",`${s}`):i.container.removeAttribute("aria-level")}setAriaLabel(t,e){t?e.setAttribute("aria-label",t):e.removeAttribute("aria-label")}disposeElement(t,e,i,n){i.disposables.clear()}disposeTemplate(t){t.disposables.dispose()}},w2=class{constructor(t,e){this.list=t;this.dnd=e}getDragElements(t){let e=this.list.getSelectedElements();return e.indexOf(t)>-1?e:[t]}getDragURI(t){return this.dnd.getDragURI(t)}getDragLabel(t,e){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t,e)}onDragStart(t,e){this.dnd.onDragStart?.(t,e)}onDragOver(t,e,i,n,o){return this.dnd.onDragOver(t,e,i,n,o)}onDragLeave(t,e,i,n){this.dnd.onDragLeave?.(t,e,i,n)}onDragEnd(t){this.dnd.onDragEnd?.(t)}drop(t,e,i,n,o){this.dnd.drop(t,e,i,n,o)}dispose(){this.dnd.dispose()}},Lo=class{constructor(t,e,i,n,o=qae){this.user=t;this._options=o;let s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new b2(s!=="listbox");let a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=o.accessibilityProvider,this.accessibilityProvider&&(a.push(new S2(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(d=>new C2(d.templateId,[...a,d]));let l={...o,dnd:o.dnd&&new w2(this,o.dnd)};if(this.view=this.createListView(e,i,n,l),this.view.domNode.setAttribute("role",s),o.styleController)this.styleController=o.styleController(this.view.domId);else{let d=Ho(this.view.domNode);this.styleController=new RA(d,this.view.domId)}if(this.spliceable=new LA([new JE(this.focus,this.view,o.identityProvider),new JE(this.selection,this.view,o.identityProvider),new JE(this.anchor,this.view,o.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new y2(this,this.view)),(typeof o.keyboardSupport!="boolean"||o.keyboardSupport)&&(this.keyboardController=new kA(this,this.view,o),this.disposables.add(this.keyboardController)),o.keyboardNavigationLabelProvider){let d=o.keyboardNavigationDelegate||Kae;this.typeNavigationController=new v2(this,this.view,o.keyboardNavigationLabelProvider,o.keyboardNavigationEventFilter??(()=>!0),d),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(o),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}focus=new Uy("focused");selection;anchor=new Uy("anchor");eventBufferer=new mh;view;spliceable;styleController;typeNavigationController;accessibilityProvider;keyboardController;mouseController;_ariaLabel="";disposables=new W;get onDidChangeFocus(){return O.map(this.eventBufferer.wrapEvent(this.focus.onChange),t=>this.toListEvent(t),this.disposables)}get onDidChangeSelection(){return O.map(this.eventBufferer.wrapEvent(this.selection.onChange),t=>this.toListEvent(t),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseUp(){return this.view.onMouseUp}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseMove(){return this.view.onMouseMove}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let t=!1,e=O.chain(this.disposables.add(new Ge(this.view.domNode,"keydown")).event,o=>o.map(s=>new st(s)).filter(s=>t=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Te.stop(s,!0)).filter(()=>!1)),i=O.chain(this.disposables.add(new Ge(this.view.domNode,"keyup")).event,o=>o.forEach(()=>t=!1).map(s=>new st(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(s=>Te.stop(s,!0)).map(({browserEvent:s})=>{let a=this.getFocus(),l=a.length?a[0]:void 0,d=typeof l<"u"?this.view.element(l):void 0,c=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:d,anchor:c,browserEvent:s}})),n=O.chain(this.view.onContextMenu,o=>o.filter(s=>!t).map(({element:s,index:a,browserEvent:l})=>({element:s,index:a,anchor:new ri(oe(this.view.domNode),l),browserEvent:l})));return O.any(e,i,n)}get onKeyDown(){return this.disposables.add(new Ge(this.view.domNode,"keydown")).event}get onKeyUp(){return this.disposables.add(new Ge(this.view.domNode,"keyup")).event}get onKeyPress(){return this.disposables.add(new Ge(this.view.domNode,"keypress")).event}get onDidFocus(){return O.signal(this.disposables.add(new Ge(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return O.signal(this.disposables.add(new Ge(this.view.domNode,"blur",!0)).event)}_onDidDispose=new T;onDidDispose=this._onDidDispose.event;createListView(t,e,i,n){return new DA(t,e,i,n)}createMouseController(t){return new eT(this)}updateOptions(t={}){this._options={...this._options,...t},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(t),this.keyboardController?.updateOptions(t),this.view.updateOptions(t)}get options(){return this._options}splice(t,e,i=[]){if(t<0||t>this.view.length)throw new Jc(this.user,`Invalid start index: ${t}`);if(e<0)throw new Jc(this.user,`Invalid delete count: ${e}`);e===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(t,e,i))}updateWidth(t){this.view.updateWidth(t)}updateElementHeight(t,e){this.view.updateElementHeight(t,e,null)}rerender(){this.view.rerender()}element(t){return this.view.element(t)}indexOf(t){return this.view.indexOf(t)}indexAt(t){return this.view.indexAt(t)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.getScrollTop()}set scrollTop(t){this.view.setScrollTop(t)}get scrollLeft(){return this.view.getScrollLeft()}set scrollLeft(t){this.view.setScrollLeft(t)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get firstMostlyVisibleIndex(){return this.view.firstMostlyVisibleIndex}get lastVisibleIndex(){return this.view.lastVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(t){this._ariaLabel=t,this.view.domNode.setAttribute("aria-label",t)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(t,e){this.view.layout(t,e)}triggerTypeNavigation(){this.typeNavigationController?.trigger()}setSelection(t,e){for(let i of t)if(i<0||i>=this.length)throw new Jc(this.user,`Invalid index ${i}`);this.selection.set(t,e)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(t=>this.view.element(t))}setAnchor(t){if(typeof t>"u"){this.anchor.set([]);return}if(t<0||t>=this.length)throw new Jc(this.user,`Invalid index ${t}`);this.anchor.set([t])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){let t=this.getAnchor();return typeof t>"u"?void 0:this.element(t)}setFocus(t,e){for(let i of t)if(i<0||i>=this.length)throw new Jc(this.user,`Invalid index ${i}`);this.focus.set(t,e)}focusNext(t=1,e=!1,i,n){if(this.length===0)return;let o=this.focus.get(),s=this.findNextIndex(o.length>0?o[0]+t:0,e,n);s>-1&&this.setFocus([s],i)}focusPrevious(t=1,e=!1,i,n){if(this.length===0)return;let o=this.focus.get(),s=this.findPreviousIndex(o.length>0?o[0]-t:0,e,n);s>-1&&this.setFocus([s],i)}async focusNextPage(t,e){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;let n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){let o=this.findPreviousIndex(i,!1,e);o>-1&&n!==o?this.setFocus([o],t):this.setFocus([i],t)}else{let o=this.view.getScrollTop(),s=o+this.view.renderHeight;i>n&&(s-=this.view.elementHeight(i)),this.view.setScrollTop(s),this.view.getScrollTop()!==o&&(this.setFocus([]),await Sn(0),await this.focusNextPage(t,e))}}async focusPreviousPage(t,e,i=()=>0){let n,o=i(),s=this.view.getScrollTop()+o;s===0?n=this.view.indexAt(s):n=this.view.indexAfter(s-1);let a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){let l=this.findNextIndex(n,!1,e);l>-1&&a!==l?this.setFocus([l],t):this.setFocus([n],t)}else{let l=s;this.view.setScrollTop(s-this.view.renderHeight-o),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await Sn(0),await this.focusPreviousPage(t,e,i))}}focusLast(t,e){if(this.length===0)return;let i=this.findPreviousIndex(this.length-1,!1,e);i>-1&&this.setFocus([i],t)}focusFirst(t,e){this.focusNth(0,t,e)}focusNth(t,e,i){if(this.length===0)return;let n=this.findNextIndex(t,!1,i);n>-1&&this.setFocus([n],e)}findNextIndex(t,e=!1,i){for(let n=0;n<this.length;n++){if(t>=this.length&&!e)return-1;if(t=t%this.length,!i||i(this.element(t)))return t;t++}return-1}findPreviousIndex(t,e=!1,i){for(let n=0;n<this.length;n++){if(t<0&&!e)return-1;if(t=(this.length+t%this.length)%this.length,!i||i(this.element(t)))return t;t--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(t=>this.view.element(t))}reveal(t,e,i=0){if(t<0||t>=this.length)throw new Jc(this.user,`Invalid index ${t}`);let n=this.view.getScrollTop(),o=this.view.elementTop(t),s=this.view.elementHeight(t);if(Vo(e)){let a=s-this.view.renderHeight+i;this.view.setScrollTop(a*sr(e,0,1)+o-i)}else{let a=o+s,l=n+this.view.renderHeight;o<n+i&&a>=l||(o<n+i||a>=l&&s>=this.view.renderHeight?this.view.setScrollTop(o-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(t,e=0){if(t<0||t>=this.length)throw new Jc(this.user,`Invalid index ${t}`);let i=this.view.getScrollTop(),n=this.view.elementTop(t),o=this.view.elementHeight(t);if(n<i+e||n+o>i+this.view.renderHeight)return null;let s=o-this.view.renderHeight+e;return Math.abs((i+e-n)/s)}isDOMFocused(){return os(this.view.domNode)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(t){return this.view.getElementDomId(t)}getElementTop(t){return this.view.elementTop(t)}style(t){this.styleController.style(t)}toListEvent({indexes:t,browserEvent:e}){return{indexes:t,elements:t.map(i=>this.view.element(i)),browserEvent:e}}_onFocusChange(){let t=this.focus.get();this.view.domNode.classList.toggle("element-focused",t.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){let t=this.focus.get();if(t.length>0){let e;this.accessibilityProvider?.getActiveDescendantId&&(e=this.accessibilityProvider.getActiveDescendantId(this.view.element(t[0]))),this.view.domNode.setAttribute("aria-activedescendant",e||this.view.getElementDomId(t[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){let t=this.selection.get();this.view.domNode.classList.toggle("selection-none",t.length===0),this.view.domNode.classList.toggle("selection-single",t.length===1),this.view.domNode.classList.toggle("selection-multiple",t.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}};_([ue],Lo.prototype,"onDidChangeFocus",1),_([ue],Lo.prototype,"onDidChangeSelection",1),_([ue],Lo.prototype,"onContextMenu",1),_([ue],Lo.prototype,"onKeyDown",1),_([ue],Lo.prototype,"onKeyUp",1),_([ue],Lo.prototype,"onKeyPress",1),_([ue],Lo.prototype,"onDidFocus",1),_([ue],Lo.prototype,"onDidBlur",1);var _2=class{constructor(t,e){this.renderer=t;this.modelProvider=e}get templateId(){return this.renderer.templateId}renderTemplate(t){return{data:this.renderer.renderTemplate(t),disposable:L.None}}renderElement(t,e,i,n){if(i.disposable?.dispose(),!i.data)return;let o=this.modelProvider();if(o.isResolved(t))return this.renderer.renderElement(o.get(t),t,i.data,n);let s=new Cn,a=o.resolve(t,s.token);i.disposable={dispose:()=>s.cancel()},this.renderer.renderPlaceholder(t,i.data),a.then(l=>this.renderer.renderElement(l,t,i.data,n))}disposeTemplate(t){t.disposable&&(t.disposable.dispose(),t.disposable=void 0),t.data&&(this.renderer.disposeTemplate(t.data),t.data=void 0)}},D2=class{constructor(t,e){this.modelProvider=t;this.accessibilityProvider=e}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(t){let e=this.modelProvider();return e.isResolved(t)?this.accessibilityProvider.getAriaLabel(e.get(t)):null}};function Yae(r,t){return{...t,accessibilityProvider:t.accessibilityProvider&&new D2(r,t.accessibilityProvider)}}var PA=class{list;_model;constructor(t,e,i,n,o={}){let s=()=>this.model,a=n.map(l=>new _2(l,s));this.list=new Lo(t,e,i,a,Yae(s,o))}updateOptions(t){this.list.updateOptions(t)}getHTMLElement(){return this.list.getHTMLElement()}isDOMFocused(){return os(this.getHTMLElement())}domFocus(){this.list.domFocus()}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseClick(){return O.map(this.list.onMouseClick,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onMouseDblClick(){return O.map(this.list.onMouseDblClick,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onTap(){return O.map(this.list.onTap,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onPointer(){return O.map(this.list.onPointer,({element:t,index:e,browserEvent:i})=>({element:t===void 0?void 0:this._model.get(t),index:e,browserEvent:i}))}get onDidChangeFocus(){return O.map(this.list.onDidChangeFocus,({elements:t,indexes:e,browserEvent:i})=>({elements:t.map(n=>this._model.get(n)),indexes:e,browserEvent:i}))}get onDidChangeSelection(){return O.map(this.list.onDidChangeSelection,({elements:t,indexes:e,browserEvent:i})=>({elements:t.map(n=>this._model.get(n)),indexes:e,browserEvent:i}))}get onContextMenu(){return O.map(this.list.onContextMenu,({element:t,index:e,anchor:i,browserEvent:n})=>typeof t>"u"?{element:t,index:e,anchor:i,browserEvent:n}:{element:this._model.get(t),index:e,anchor:i,browserEvent:n})}get model(){return this._model}set model(t){this._model=t,this.list.splice(0,this.list.length,Io(t.length))}get length(){return this.list.length}get scrollTop(){return this.list.scrollTop}set scrollTop(t){this.list.scrollTop=t}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(t){this.list.scrollLeft=t}setAnchor(t){this.list.setAnchor(t)}getAnchor(){return this.list.getAnchor()}setFocus(t){this.list.setFocus(t)}focusNext(t,e){this.list.focusNext(t,e)}focusPrevious(t,e){this.list.focusPrevious(t,e)}focusNextPage(){return this.list.focusNextPage()}focusPreviousPage(){return this.list.focusPreviousPage()}focusLast(){this.list.focusLast()}focusFirst(){this.list.focusFirst()}getFocus(){return this.list.getFocus()}setSelection(t,e){this.list.setSelection(t,e)}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(t=>this.model.get(t))}layout(t,e){this.list.layout(t,e)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}reveal(t,e){this.list.reveal(t,e)}style(t){this.list.style(t)}dispose(){this.list.dispose()}};var aX={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function lX(r){aX=r}function $n(){return aX}var Zae=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}}),MA=Zae,Xae=new an(()=>MA("mouse",!1)),Qae=new an(()=>MA("element",!1));function dX(r){MA=r}function zt(r){return r==="element"?Qae.value:Xae.value}function Ha(){return MA("element",!0)}var OA=class r{constructor(t,e,i){this.columns=t;this.getColumnSize=i;let n=new Map(e.map(o=>[o.templateId,o]));this.renderers=[];for(let o of t){let s=n.get(o.templateId);if(!s)throw new Error(`Table cell renderer for template id ${o.templateId} not found.`);this.renderers.push(s)}}static TemplateId="row";templateId=r.TemplateId;renderers;renderedTemplates=new Set;renderTemplate(t){let e=Ee(t,re(".monaco-table-tr")),i=[],n=[];for(let s=0;s<this.columns.length;s++){let a=this.renderers[s],l=Ee(e,re(".monaco-table-td",{"data-col-index":s}));l.style.width=`${this.getColumnSize(s)}px`,i.push(l),n.push(a.renderTemplate(l))}let o={container:t,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(o),o}renderElement(t,e,i,n){for(let o=0;o<this.columns.length;o++){let a=this.columns[o].project(t);this.renderers[o].renderElement(a,e,i.cellTemplateData[o],n)}}disposeElement(t,e,i,n){for(let o=0;o<this.columns.length;o++){let s=this.renderers[o];if(s.disposeElement){let l=this.columns[o].project(t);s.disposeElement(l,e,i.cellTemplateData[o],n)}}}disposeTemplate(t){for(let e=0;e<this.columns.length;e++)this.renderers[e].disposeTemplate(t.cellTemplateData[e]);ci(t.container),this.renderedTemplates.delete(t)}layoutColumn(t,e){for(let{cellContainers:i}of this.renderedTemplates)i[t].style.width=`${e}px`}};function Jae(r){return{getHeight(t){return r.getHeight(t)},getTemplateId(){return OA.TemplateId}}}var L2=class extends L{constructor(e,i){super();this.column=e;this.index=i;this.element=re(".monaco-table-th",{"data-col-index":i},e.label),e.tooltip&&this._register($n().setupManagedHover(zt("mouse"),this.element,e.tooltip))}element;get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??O.None}_onDidLayout=new T;onDidLayout=this._onDidLayout.event;layout(e){this._onDidLayout.fire([this.index,e])}},NA=class r{constructor(t,e,i,n,o,s){this.virtualDelegate=i;this.columns=n;this.domNode=Ee(e,re(`.monaco-table.${this.domId}`));let a=n.map((c,u)=>this.disposables.add(new L2(c,u))),l={size:a.reduce((c,u)=>c+u.column.weight,0),views:a.map(c=>({size:c.column.weight,view:c}))};this.splitview=this.disposables.add(new El(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;let d=new OA(n,o,c=>this.splitview.getViewSize(c));this.list=this.disposables.add(new Lo(t,this.domNode,Jae(i),[d],s)),O.any(...a.map(c=>c.onDidLayout))(([c,u])=>d.layoutColumn(c,u),null,this.disposables),this.splitview.onDidSashReset(c=>{let u=n.reduce((m,g)=>m+g.weight,0),p=n[c].weight/u*this.cachedWidth;this.splitview.resizeView(c,p)},null,this.disposables),this.styleElement=Ho(this.domNode),this.style(AA)}static InstanceCount=0;domId=`table_id_${++r.InstanceCount}`;domNode;splitview;list;styleElement;disposables=new W;cachedWidth=0;cachedHeight=0;get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseClick(){return this.list.onMouseClick}get onMouseDblClick(){return this.list.onMouseDblClick}get onMouseMiddleClick(){return this.list.onMouseMiddleClick}get onPointer(){return this.list.onPointer}get onMouseUp(){return this.list.onMouseUp}get onMouseDown(){return this.list.onMouseDown}get onMouseOver(){return this.list.onMouseOver}get onMouseMove(){return this.list.onMouseMove}get onMouseOut(){return this.list.onMouseOut}get onTouchStart(){return this.list.onTouchStart}get onTap(){return this.list.onTap}get onContextMenu(){return this.list.onContextMenu}get onDidFocus(){return this.list.onDidFocus}get onDidBlur(){return this.list.onDidBlur}get scrollTop(){return this.list.scrollTop}set scrollTop(t){this.list.scrollTop=t}get scrollLeft(){return this.list.scrollLeft}set scrollLeft(t){this.list.scrollLeft=t}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}getColumnLabels(){return this.columns.map(t=>t.label)}resizeColumn(t,e){let i=Math.round(e/100*this.cachedWidth);this.splitview.resizeView(t,i)}updateOptions(t){this.list.updateOptions(t)}splice(t,e,i=[]){this.list.splice(t,e,i)}rerender(){this.list.rerender()}row(t){return this.list.element(t)}indexOf(t){return this.list.indexOf(t)}get length(){return this.list.length}getHTMLElement(){return this.domNode}layout(t,e){t=t??ik(this.domNode),e=e??zv(this.domNode),this.cachedWidth=e,this.cachedHeight=t,this.splitview.layout(e);let i=t-this.virtualDelegate.headerRowHeight;this.list.getHTMLElement().style.height=`${i}px`,this.list.layout(i,e)}triggerTypeNavigation(){this.list.triggerTypeNavigation()}style(t){let e=[];e.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=e.join(`
`),this.list.style(t)}domFocus(){this.list.domFocus()}setAnchor(t){this.list.setAnchor(t)}getAnchor(){return this.list.getAnchor()}getSelectedElements(){return this.list.getSelectedElements()}setSelection(t,e){this.list.setSelection(t,e)}getSelection(){return this.list.getSelection()}setFocus(t,e){this.list.setFocus(t,e)}focusNext(t=1,e=!1,i){this.list.focusNext(t,e,i)}focusPrevious(t=1,e=!1,i){this.list.focusPrevious(t,e,i)}focusNextPage(t){return this.list.focusNextPage(t)}focusPreviousPage(t){return this.list.focusPreviousPage(t)}focusFirst(t){this.list.focusFirst(t)}focusLast(t){this.list.focusLast(t)}getFocus(){return this.list.getFocus()}getFocusedElements(){return this.list.getFocusedElements()}getRelativeTop(t){return this.list.getRelativeTop(t)}reveal(t,e){this.list.reveal(t,e)}dispose(){this.disposables.dispose()}};function cX(r,t={}){let e=FA(t);return e.textContent=r,e}function uX(r,t={}){let e=FA(t);return pX(e,ele(r,!!t.renderCodeSegments),t.actionHandler,t.renderCodeSegments),e}function FA(r){let t=r.inline?"span":"div",e=document.createElement(t);return r.className&&(e.className=r.className),e}var k2=class{source;index;constructor(t){this.source=t,this.index=0}eos(){return this.index>=this.source.length}next(){let t=this.peek();return this.advance(),t}peek(){return this.source[this.index]}advance(){this.index++}};function pX(r,t,e,i){let n;if(t.type===2)n=document.createTextNode(t.content||"");else if(t.type===3)n=document.createElement("b");else if(t.type===4)n=document.createElement("i");else if(t.type===7&&i)n=document.createElement("code");else if(t.type===5&&e){let o=document.createElement("a");e.disposables.add(Wi(o,"click",s=>{e.callback(String(t.index),s)})),n=o}else t.type===8?n=document.createElement("br"):t.type===1&&(n=r);n&&r!==n&&r.appendChild(n),n&&Array.isArray(t.children)&&t.children.forEach(o=>{pX(n,o,e,i)})}function ele(r,t){let e={type:1,children:[]},i=0,n=e,o=[],s=new k2(r);for(;!s.eos();){let a=s.next(),l=a==="\\"&&R2(s.peek(),t)!==0;if(l&&(a=s.next()),!l&&tle(a,t)&&a===s.peek()){s.advance(),n.type===2&&(n=o.pop());let d=R2(a,t);if(n.type===d||n.type===5&&d===6)n=o.pop();else{let c={type:d,children:[]};d===5&&(c.index=i,i++),n.children.push(c),o.push(n),n=c}}else if(a===`
`)n.type===2&&(n=o.pop()),n.children.push({type:8});else if(n.type!==2){let d={type:2,content:a};n.children.push(d),o.push(n),n=d}else n.content+=a}return n.type===2&&(n=o.pop()),o.length,e}function tle(r,t){return R2(r,t)!==0}function R2(r,t){switch(r){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return t?7:0;default:return 0}}var ile=new RegExp(`(\\\\)?\\$\\((${ye.iconNameExpression}(?:${ye.iconModifierExpression})?)\\)`,"g");function Rs(r){let t=new Array,e,i=0,n=0;for(;(e=ile.exec(r))!==null;){n=e.index||0,i<n&&t.push(r.substring(i,n)),i=(e.index||0)+e[0].length;let[,o,s]=e;t.push(o?`$(${s})`:Md({id:s}))}return i<r.length&&t.push(r.substring(i)),t}function Md(r){let t=re("span");return t.classList.add(...ye.asClassNameArray(r)),t}var A2=class{_prefix;_lastId;constructor(t){this._prefix=t,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}},iT=new A2("id#");var cr={};(function(){function r(t,e){e(cr)}r.amd=!0,function(t,e){typeof r=="function"&&r.amd?r(["exports"],e):typeof exports=="object"&&typeof module<"u"?e(exports):(t=typeof globalThis<"u"?globalThis:t||self,e(t.marked={}))}(this,function(t){"use strict";function e(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}t.defaults=e();function i(vt){t.defaults=vt}let n=/[&<>"']/,o=new RegExp(n.source,"g"),s=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(s.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=vt=>l[vt];function c(vt,P){if(P){if(n.test(vt))return vt.replace(o,d)}else if(s.test(vt))return vt.replace(a,d);return vt}let u=/(^|[^\[])\^/g;function p(vt,P){let N=typeof vt=="string"?vt:vt.source;P=P||"";let V={replace:(j,Q)=>{let le=typeof Q=="string"?Q:Q.source;return le=le.replace(u,"$1"),N=N.replace(j,le),V},getRegex:()=>new RegExp(N,P)};return V}function m(vt){try{vt=encodeURI(vt).replace(/%25/g,"%")}catch{return null}return vt}let g={exec:()=>null};function f(vt,P){let N=vt.replace(/\|/g,(Q,le,Ce)=>{let ze=!1,$e=le;for(;--$e>=0&&Ce[$e]==="\\";)ze=!ze;return ze?"|":" |"}),V=N.split(/ \|/),j=0;if(V[0].trim()||V.shift(),V.length>0&&!V[V.length-1].trim()&&V.pop(),P)if(V.length>P)V.splice(P);else for(;V.length<P;)V.push("");for(;j<V.length;j++)V[j]=V[j].trim().replace(/\\\|/g,"|");return V}function b(vt,P,N){let V=vt.length;if(V===0)return"";let j=0;for(;j<V;){let Q=vt.charAt(V-j-1);if(Q===P&&!N)j++;else if(Q!==P&&N)j++;else break}return vt.slice(0,V-j)}function y(vt,P){if(vt.indexOf(P[1])===-1)return-1;let N=0;for(let V=0;V<vt.length;V++)if(vt[V]==="\\")V++;else if(vt[V]===P[0])N++;else if(vt[V]===P[1]&&(N--,N<0))return V;return-1}function I(vt,P,N,V){let j=P.href,Q=P.title?c(P.title):null,le=vt[1].replace(/\\([\[\]])/g,"$1");if(vt[0].charAt(0)!=="!"){V.state.inLink=!0;let Ce={type:"link",raw:N,href:j,title:Q,text:le,tokens:V.inlineTokens(le)};return V.state.inLink=!1,Ce}return{type:"image",raw:N,href:j,title:Q,text:c(le)}}function E(vt,P){let N=vt.match(/^(\s+)(?:```)/);if(N===null)return P;let V=N[1];return P.split(`
`).map(j=>{let Q=j.match(/^\s+/);if(Q===null)return j;let[le]=Q;return le.length>=V.length?j.slice(V.length):j}).join(`
`)}class S{options;rules;lexer;constructor(P){this.options=P||t.defaults}space(P){let N=this.rules.block.newline.exec(P);if(N&&N[0].length>0)return{type:"space",raw:N[0]}}code(P){let N=this.rules.block.code.exec(P);if(N){let V=N[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:N[0],codeBlockStyle:"indented",text:this.options.pedantic?V:b(V,`
`)}}}fences(P){let N=this.rules.block.fences.exec(P);if(N){let V=N[0],j=E(V,N[3]||"");return{type:"code",raw:V,lang:N[2]?N[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):N[2],text:j}}}heading(P){let N=this.rules.block.heading.exec(P);if(N){let V=N[2].trim();if(/#$/.test(V)){let j=b(V,"#");(this.options.pedantic||!j||/ $/.test(j))&&(V=j.trim())}return{type:"heading",raw:N[0],depth:N[1].length,text:V,tokens:this.lexer.inline(V)}}}hr(P){let N=this.rules.block.hr.exec(P);if(N)return{type:"hr",raw:b(N[0],`
`)}}blockquote(P){let N=this.rules.block.blockquote.exec(P);if(N){let V=b(N[0],`
`).split(`
`),j="",Q="",le=[];for(;V.length>0;){let Ce=!1,ze=[],$e;for($e=0;$e<V.length;$e++)if(/^ {0,3}>/.test(V[$e]))ze.push(V[$e]),Ce=!0;else if(!Ce)ze.push(V[$e]);else break;V=V.slice($e);let Vt=ze.join(`
`),Ii=Vt.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");j=j?`${j}
${Vt}`:Vt,Q=Q?`${Q}
${Ii}`:Ii;let sn=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(Ii,le,!0),this.lexer.state.top=sn,V.length===0)break;let ro=le[le.length-1];if(ro?.type==="code")break;if(ro?.type==="blockquote"){let vn=ro,lt=vn.raw+`
`+V.join(`
`),J=this.blockquote(lt);le[le.length-1]=J,j=j.substring(0,j.length-vn.raw.length)+J.raw,Q=Q.substring(0,Q.length-vn.text.length)+J.text;break}else if(ro?.type==="list"){let vn=ro,lt=vn.raw+`
`+V.join(`
`),J=this.list(lt);le[le.length-1]=J,j=j.substring(0,j.length-ro.raw.length)+J.raw,Q=Q.substring(0,Q.length-vn.raw.length)+J.raw,V=lt.substring(le[le.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:j,tokens:le,text:Q}}}list(P){let N=this.rules.block.list.exec(P);if(N){let V=N[1].trim(),j=V.length>1,Q={type:"list",raw:"",ordered:j,start:j?+V.slice(0,-1):"",loose:!1,items:[]};V=j?`\\d{1,9}\\${V.slice(-1)}`:`\\${V}`,this.options.pedantic&&(V=j?V:"[*+-]");let le=new RegExp(`^( {0,3}${V})((?:[	 ][^\\n]*)?(?:\\n|$))`),Ce=!1;for(;P;){let ze=!1,$e="",Vt="";if(!(N=le.exec(P))||this.rules.block.hr.test(P))break;$e=N[0],P=P.substring($e.length);let Ii=N[2].split(`
`,1)[0].replace(/^\t+/,Be=>" ".repeat(3*Be.length)),sn=P.split(`
`,1)[0],ro=!Ii.trim(),vn=0;if(this.options.pedantic?(vn=2,Vt=Ii.trimStart()):ro?vn=N[1].length+1:(vn=N[2].search(/[^ ]/),vn=vn>4?1:vn,Vt=Ii.slice(vn),vn+=N[1].length),ro&&/^ *$/.test(sn)&&($e+=sn+`
`,P=P.substring(sn.length+1),ze=!0),!ze){let Be=new RegExp(`^ {0,${Math.min(3,vn-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Je=new RegExp(`^ {0,${Math.min(3,vn-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),$i=new RegExp(`^ {0,${Math.min(3,vn-1)}}(?:\`\`\`|~~~)`),vo=new RegExp(`^ {0,${Math.min(3,vn-1)}}#`);for(;P;){let Xr=P.split(`
`,1)[0];if(sn=Xr,this.options.pedantic&&(sn=sn.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),$i.test(sn)||vo.test(sn)||Be.test(sn)||Je.test(P))break;if(sn.search(/[^ ]/)>=vn||!sn.trim())Vt+=`
`+sn.slice(vn);else{if(ro||Ii.search(/[^ ]/)>=4||$i.test(Ii)||vo.test(Ii)||Je.test(Ii))break;Vt+=`
`+sn}!ro&&!sn.trim()&&(ro=!0),$e+=Xr+`
`,P=P.substring(Xr.length+1),Ii=sn.slice(vn)}}Q.loose||(Ce?Q.loose=!0:/\n *\n *$/.test($e)&&(Ce=!0));let lt=null,J;this.options.gfm&&(lt=/^\[[ xX]\] /.exec(Vt),lt&&(J=lt[0]!=="[ ] ",Vt=Vt.replace(/^\[[ xX]\] +/,""))),Q.items.push({type:"list_item",raw:$e,task:!!lt,checked:J,loose:!1,text:Vt,tokens:[]}),Q.raw+=$e}Q.items[Q.items.length-1].raw=Q.items[Q.items.length-1].raw.trimEnd(),Q.items[Q.items.length-1].text=Q.items[Q.items.length-1].text.trimEnd(),Q.raw=Q.raw.trimEnd();for(let ze=0;ze<Q.items.length;ze++)if(this.lexer.state.top=!1,Q.items[ze].tokens=this.lexer.blockTokens(Q.items[ze].text,[]),!Q.loose){let $e=Q.items[ze].tokens.filter(Ii=>Ii.type==="space"),Vt=$e.length>0&&$e.some(Ii=>/\n.*\n/.test(Ii.raw));Q.loose=Vt}if(Q.loose)for(let ze=0;ze<Q.items.length;ze++)Q.items[ze].loose=!0;return Q}}html(P){let N=this.rules.block.html.exec(P);if(N)return{type:"html",block:!0,raw:N[0],pre:N[1]==="pre"||N[1]==="script"||N[1]==="style",text:N[0]}}def(P){let N=this.rules.block.def.exec(P);if(N){let V=N[1].toLowerCase().replace(/\s+/g," "),j=N[2]?N[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",Q=N[3]?N[3].substring(1,N[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):N[3];return{type:"def",tag:V,raw:N[0],href:j,title:Q}}}table(P){let N=this.rules.block.table.exec(P);if(!N||!/[:|]/.test(N[2]))return;let V=f(N[1]),j=N[2].replace(/^\||\| *$/g,"").split("|"),Q=N[3]&&N[3].trim()?N[3].replace(/\n[ \t]*$/,"").split(`
`):[],le={type:"table",raw:N[0],header:[],align:[],rows:[]};if(V.length===j.length){for(let Ce of j)/^ *-+: *$/.test(Ce)?le.align.push("right"):/^ *:-+: *$/.test(Ce)?le.align.push("center"):/^ *:-+ *$/.test(Ce)?le.align.push("left"):le.align.push(null);for(let Ce=0;Ce<V.length;Ce++)le.header.push({text:V[Ce],tokens:this.lexer.inline(V[Ce]),header:!0,align:le.align[Ce]});for(let Ce of Q)le.rows.push(f(Ce,le.header.length).map((ze,$e)=>({text:ze,tokens:this.lexer.inline(ze),header:!1,align:le.align[$e]})));return le}}lheading(P){let N=this.rules.block.lheading.exec(P);if(N)return{type:"heading",raw:N[0],depth:N[2].charAt(0)==="="?1:2,text:N[1],tokens:this.lexer.inline(N[1])}}paragraph(P){let N=this.rules.block.paragraph.exec(P);if(N){let V=N[1].charAt(N[1].length-1)===`
`?N[1].slice(0,-1):N[1];return{type:"paragraph",raw:N[0],text:V,tokens:this.lexer.inline(V)}}}text(P){let N=this.rules.block.text.exec(P);if(N)return{type:"text",raw:N[0],text:N[0],tokens:this.lexer.inline(N[0])}}escape(P){let N=this.rules.inline.escape.exec(P);if(N)return{type:"escape",raw:N[0],text:c(N[1])}}tag(P){let N=this.rules.inline.tag.exec(P);if(N)return!this.lexer.state.inLink&&/^<a /i.test(N[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(N[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(N[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(N[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:N[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:N[0]}}link(P){let N=this.rules.inline.link.exec(P);if(N){let V=N[2].trim();if(!this.options.pedantic&&/^</.test(V)){if(!/>$/.test(V))return;let le=b(V.slice(0,-1),"\\");if((V.length-le.length)%2===0)return}else{let le=y(N[2],"()");if(le>-1){let ze=(N[0].indexOf("!")===0?5:4)+N[1].length+le;N[2]=N[2].substring(0,le),N[0]=N[0].substring(0,ze).trim(),N[3]=""}}let j=N[2],Q="";if(this.options.pedantic){let le=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(j);le&&(j=le[1],Q=le[3])}else Q=N[3]?N[3].slice(1,-1):"";return j=j.trim(),/^</.test(j)&&(this.options.pedantic&&!/>$/.test(V)?j=j.slice(1):j=j.slice(1,-1)),I(N,{href:j&&j.replace(this.rules.inline.anyPunctuation,"$1"),title:Q&&Q.replace(this.rules.inline.anyPunctuation,"$1")},N[0],this.lexer)}}reflink(P,N){let V;if((V=this.rules.inline.reflink.exec(P))||(V=this.rules.inline.nolink.exec(P))){let j=(V[2]||V[1]).replace(/\s+/g," "),Q=N[j.toLowerCase()];if(!Q){let le=V[0].charAt(0);return{type:"text",raw:le,text:le}}return I(V,Q,V[0],this.lexer)}}emStrong(P,N,V=""){let j=this.rules.inline.emStrongLDelim.exec(P);if(!j||j[3]&&V.match(/[\p{L}\p{N}]/u))return;if(!(j[1]||j[2]||"")||!V||this.rules.inline.punctuation.exec(V)){let le=[...j[0]].length-1,Ce,ze,$e=le,Vt=0,Ii=j[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(Ii.lastIndex=0,N=N.slice(-1*P.length+le);(j=Ii.exec(N))!=null;){if(Ce=j[1]||j[2]||j[3]||j[4]||j[5]||j[6],!Ce)continue;if(ze=[...Ce].length,j[3]||j[4]){$e+=ze;continue}else if((j[5]||j[6])&&le%3&&!((le+ze)%3)){Vt+=ze;continue}if($e-=ze,$e>0)continue;ze=Math.min(ze,ze+$e+Vt);let sn=[...j[0]][0].length,ro=P.slice(0,le+j.index+sn+ze);if(Math.min(le,ze)%2){let lt=ro.slice(1,-1);return{type:"em",raw:ro,text:lt,tokens:this.lexer.inlineTokens(lt)}}let vn=ro.slice(2,-2);return{type:"strong",raw:ro,text:vn,tokens:this.lexer.inlineTokens(vn)}}}}codespan(P){let N=this.rules.inline.code.exec(P);if(N){let V=N[2].replace(/\n/g," "),j=/[^ ]/.test(V),Q=/^ /.test(V)&&/ $/.test(V);return j&&Q&&(V=V.substring(1,V.length-1)),V=c(V,!0),{type:"codespan",raw:N[0],text:V}}}br(P){let N=this.rules.inline.br.exec(P);if(N)return{type:"br",raw:N[0]}}del(P){let N=this.rules.inline.del.exec(P);if(N)return{type:"del",raw:N[0],text:N[2],tokens:this.lexer.inlineTokens(N[2])}}autolink(P){let N=this.rules.inline.autolink.exec(P);if(N){let V,j;return N[2]==="@"?(V=c(N[1]),j="mailto:"+V):(V=c(N[1]),j=V),{type:"link",raw:N[0],text:V,href:j,tokens:[{type:"text",raw:V,text:V}]}}}url(P){let N;if(N=this.rules.inline.url.exec(P)){let V,j;if(N[2]==="@")V=c(N[0]),j="mailto:"+V;else{let Q;do Q=N[0],N[0]=this.rules.inline._backpedal.exec(N[0])?.[0]??"";while(Q!==N[0]);V=c(N[0]),N[1]==="www."?j="http://"+N[0]:j=N[0]}return{type:"link",raw:N[0],text:V,href:j,tokens:[{type:"text",raw:V,text:V}]}}}inlineText(P){let N=this.rules.inline.text.exec(P);if(N){let V;return this.lexer.state.inRawBlock?V=N[0]:V=c(N[0]),{type:"text",raw:N[0],text:V}}}}let w=/^(?: *(?:\n|$))+/,D=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,k=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,R=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,A=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,H=/(?:[*+-]|\d{1,9}[.)])/,z=p(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,H).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Z=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,fe=/^[^\n]+/,Ve=/(?!\s*\])(?:\\.|[^\[\]\\])+/,me=p(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Ve).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ce=p(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,H).getRegex(),xe="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ie=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ge=p("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Ie).replace("tag",xe).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),He=p(Z).replace("hr",R).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xe).getRegex(),xt={blockquote:p(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",He).getRegex(),code:D,def:me,fences:k,heading:A,hr:R,html:ge,lheading:z,list:ce,newline:w,paragraph:He,table:g,text:fe},bt=p("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",R).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xe).getRegex(),je={...xt,table:bt,paragraph:p(Z).replace("hr",R).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",bt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xe).getRegex()},_n={...xt,html:p(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ie).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:g,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:p(Z).replace("hr",R).replace("heading",` *#{1,6} *[^
]`).replace("lheading",z).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},pn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,no=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,No=/^( {2,}|\\)\n(?!\s*$)/,zl=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ai="\\p{P}\\p{S}",br=p(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Ai).getRegex(),ag=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Jp=p(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Ai).getRegex(),vr=p("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Ai).getRegex(),eh=p("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Ai).getRegex(),th=p(/\\([punct])/,"gu").replace(/punct/g,Ai).getRegex(),Mb=p(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ob=p(Ie).replace("(?:-->|$)","-->").getRegex(),ht=p("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ob).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Lu=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ih=p(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Lu).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),sc=p(/^!?\[(label)\]\[(ref)\]/).replace("label",Lu).replace("ref",Ve).getRegex(),ol=p(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ve).getRegex(),ES=p("reflink|nolink(?!\\()","g").replace("reflink",sc).replace("nolink",ol).getRegex(),lg={_backpedal:g,anyPunctuation:th,autolink:Mb,blockSkip:ag,br:No,code:no,del:g,emStrongLDelim:Jp,emStrongRDelimAst:vr,emStrongRDelimUnd:eh,escape:pn,link:ih,nolink:ol,punctuation:br,reflink:sc,reflinkSearch:ES,tag:ht,text:zl,url:g},TS={...lg,link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",Lu).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Lu).getRegex()},ac={...lg,escape:p(pn).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},xS={...ac,br:p(No).replace("{2,}","*").getRegex(),text:p(ac.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},lc={normal:xt,gfm:je,pedantic:_n},Ca={normal:lg,gfm:ac,breaks:xS,pedantic:TS};class oo{tokens;options;state;tokenizer;inlineQueue;constructor(P){this.tokens=[],this.tokens.links=Object.create(null),this.options=P||t.defaults,this.options.tokenizer=this.options.tokenizer||new S,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let N={block:lc.normal,inline:Ca.normal};this.options.pedantic?(N.block=lc.pedantic,N.inline=Ca.pedantic):this.options.gfm&&(N.block=lc.gfm,this.options.breaks?N.inline=Ca.breaks:N.inline=Ca.gfm),this.tokenizer.rules=N}static get rules(){return{block:lc,inline:Ca}}static lex(P,N){return new oo(N).lex(P)}static lexInline(P,N){return new oo(N).inlineTokens(P)}lex(P){P=P.replace(/\r\n|\r/g,`
`),this.blockTokens(P,this.tokens);for(let N=0;N<this.inlineQueue.length;N++){let V=this.inlineQueue[N];this.inlineTokens(V.src,V.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(P,N=[],V=!1){this.options.pedantic?P=P.replace(/\t/g,"    ").replace(/^ +$/gm,""):P=P.replace(/^( *)(\t+)/gm,(Ce,ze,$e)=>ze+"    ".repeat($e.length));let j,Q,le;for(;P;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(Ce=>(j=Ce.call({lexer:this},P,N))?(P=P.substring(j.raw.length),N.push(j),!0):!1))){if(j=this.tokenizer.space(P)){P=P.substring(j.raw.length),j.raw.length===1&&N.length>0?N[N.length-1].raw+=`
`:N.push(j);continue}if(j=this.tokenizer.code(P)){P=P.substring(j.raw.length),Q=N[N.length-1],Q&&(Q.type==="paragraph"||Q.type==="text")?(Q.raw+=`
`+j.raw,Q.text+=`
`+j.text,this.inlineQueue[this.inlineQueue.length-1].src=Q.text):N.push(j);continue}if(j=this.tokenizer.fences(P)){P=P.substring(j.raw.length),N.push(j);continue}if(j=this.tokenizer.heading(P)){P=P.substring(j.raw.length),N.push(j);continue}if(j=this.tokenizer.hr(P)){P=P.substring(j.raw.length),N.push(j);continue}if(j=this.tokenizer.blockquote(P)){P=P.substring(j.raw.length),N.push(j);continue}if(j=this.tokenizer.list(P)){P=P.substring(j.raw.length),N.push(j);continue}if(j=this.tokenizer.html(P)){P=P.substring(j.raw.length),N.push(j);continue}if(j=this.tokenizer.def(P)){P=P.substring(j.raw.length),Q=N[N.length-1],Q&&(Q.type==="paragraph"||Q.type==="text")?(Q.raw+=`
`+j.raw,Q.text+=`
`+j.raw,this.inlineQueue[this.inlineQueue.length-1].src=Q.text):this.tokens.links[j.tag]||(this.tokens.links[j.tag]={href:j.href,title:j.title});continue}if(j=this.tokenizer.table(P)){P=P.substring(j.raw.length),N.push(j);continue}if(j=this.tokenizer.lheading(P)){P=P.substring(j.raw.length),N.push(j);continue}if(le=P,this.options.extensions&&this.options.extensions.startBlock){let Ce=1/0,ze=P.slice(1),$e;this.options.extensions.startBlock.forEach(Vt=>{$e=Vt.call({lexer:this},ze),typeof $e=="number"&&$e>=0&&(Ce=Math.min(Ce,$e))}),Ce<1/0&&Ce>=0&&(le=P.substring(0,Ce+1))}if(this.state.top&&(j=this.tokenizer.paragraph(le))){Q=N[N.length-1],V&&Q?.type==="paragraph"?(Q.raw+=`
`+j.raw,Q.text+=`
`+j.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=Q.text):N.push(j),V=le.length!==P.length,P=P.substring(j.raw.length);continue}if(j=this.tokenizer.text(P)){P=P.substring(j.raw.length),Q=N[N.length-1],Q&&Q.type==="text"?(Q.raw+=`
`+j.raw,Q.text+=`
`+j.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=Q.text):N.push(j);continue}if(P){let Ce="Infinite loop on byte: "+P.charCodeAt(0);if(this.options.silent){console.error(Ce);break}else throw new Error(Ce)}}return this.state.top=!0,N}inline(P,N=[]){return this.inlineQueue.push({src:P,tokens:N}),N}inlineTokens(P,N=[]){let V,j,Q,le=P,Ce,ze,$e;if(this.tokens.links){let Vt=Object.keys(this.tokens.links);if(Vt.length>0)for(;(Ce=this.tokenizer.rules.inline.reflinkSearch.exec(le))!=null;)Vt.includes(Ce[0].slice(Ce[0].lastIndexOf("[")+1,-1))&&(le=le.slice(0,Ce.index)+"["+"a".repeat(Ce[0].length-2)+"]"+le.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(Ce=this.tokenizer.rules.inline.blockSkip.exec(le))!=null;)le=le.slice(0,Ce.index)+"["+"a".repeat(Ce[0].length-2)+"]"+le.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(Ce=this.tokenizer.rules.inline.anyPunctuation.exec(le))!=null;)le=le.slice(0,Ce.index)+"++"+le.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;P;)if(ze||($e=""),ze=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(Vt=>(V=Vt.call({lexer:this},P,N))?(P=P.substring(V.raw.length),N.push(V),!0):!1))){if(V=this.tokenizer.escape(P)){P=P.substring(V.raw.length),N.push(V);continue}if(V=this.tokenizer.tag(P)){P=P.substring(V.raw.length),j=N[N.length-1],j&&V.type==="text"&&j.type==="text"?(j.raw+=V.raw,j.text+=V.text):N.push(V);continue}if(V=this.tokenizer.link(P)){P=P.substring(V.raw.length),N.push(V);continue}if(V=this.tokenizer.reflink(P,this.tokens.links)){P=P.substring(V.raw.length),j=N[N.length-1],j&&V.type==="text"&&j.type==="text"?(j.raw+=V.raw,j.text+=V.text):N.push(V);continue}if(V=this.tokenizer.emStrong(P,le,$e)){P=P.substring(V.raw.length),N.push(V);continue}if(V=this.tokenizer.codespan(P)){P=P.substring(V.raw.length),N.push(V);continue}if(V=this.tokenizer.br(P)){P=P.substring(V.raw.length),N.push(V);continue}if(V=this.tokenizer.del(P)){P=P.substring(V.raw.length),N.push(V);continue}if(V=this.tokenizer.autolink(P)){P=P.substring(V.raw.length),N.push(V);continue}if(!this.state.inLink&&(V=this.tokenizer.url(P))){P=P.substring(V.raw.length),N.push(V);continue}if(Q=P,this.options.extensions&&this.options.extensions.startInline){let Vt=1/0,Ii=P.slice(1),sn;this.options.extensions.startInline.forEach(ro=>{sn=ro.call({lexer:this},Ii),typeof sn=="number"&&sn>=0&&(Vt=Math.min(Vt,sn))}),Vt<1/0&&Vt>=0&&(Q=P.substring(0,Vt+1))}if(V=this.tokenizer.inlineText(Q)){P=P.substring(V.raw.length),V.raw.slice(-1)!=="_"&&($e=V.raw.slice(-1)),ze=!0,j=N[N.length-1],j&&j.type==="text"?(j.raw+=V.raw,j.text+=V.text):N.push(V);continue}if(P){let Vt="Infinite loop on byte: "+P.charCodeAt(0);if(this.options.silent){console.error(Vt);break}else throw new Error(Vt)}}return N}}class Sa{options;parser;constructor(P){this.options=P||t.defaults}space(P){return""}code({text:P,lang:N,escaped:V}){let j=(N||"").match(/^\S*/)?.[0],Q=P.replace(/\n$/,"")+`
`;return j?'<pre><code class="language-'+c(j)+'">'+(V?Q:c(Q,!0))+`</code></pre>
`:"<pre><code>"+(V?Q:c(Q,!0))+`</code></pre>
`}blockquote({tokens:P}){return`<blockquote>
${this.parser.parse(P)}</blockquote>
`}html({text:P}){return P}heading({tokens:P,depth:N}){return`<h${N}>${this.parser.parseInline(P)}</h${N}>
`}hr(P){return`<hr>
`}list(P){let N=P.ordered,V=P.start,j="";for(let Ce=0;Ce<P.items.length;Ce++){let ze=P.items[Ce];j+=this.listitem(ze)}let Q=N?"ol":"ul",le=N&&V!==1?' start="'+V+'"':"";return"<"+Q+le+`>
`+j+"</"+Q+`>
`}listitem(P){let N="";if(P.task){let V=this.checkbox({checked:!!P.checked});P.loose?P.tokens.length>0&&P.tokens[0].type==="paragraph"?(P.tokens[0].text=V+" "+P.tokens[0].text,P.tokens[0].tokens&&P.tokens[0].tokens.length>0&&P.tokens[0].tokens[0].type==="text"&&(P.tokens[0].tokens[0].text=V+" "+P.tokens[0].tokens[0].text)):P.tokens.unshift({type:"text",raw:V+" ",text:V+" "}):N+=V+" "}return N+=this.parser.parse(P.tokens,!!P.loose),`<li>${N}</li>
`}checkbox({checked:P}){return"<input "+(P?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:P}){return`<p>${this.parser.parseInline(P)}</p>
`}table(P){let N="",V="";for(let Q=0;Q<P.header.length;Q++)V+=this.tablecell(P.header[Q]);N+=this.tablerow({text:V});let j="";for(let Q=0;Q<P.rows.length;Q++){let le=P.rows[Q];V="";for(let Ce=0;Ce<le.length;Ce++)V+=this.tablecell(le[Ce]);j+=this.tablerow({text:V})}return j&&(j=`<tbody>${j}</tbody>`),`<table>
<thead>
`+N+`</thead>
`+j+`</table>
`}tablerow({text:P}){return`<tr>
${P}</tr>
`}tablecell(P){let N=this.parser.parseInline(P.tokens),V=P.header?"th":"td";return(P.align?`<${V} align="${P.align}">`:`<${V}>`)+N+`</${V}>
`}strong({tokens:P}){return`<strong>${this.parser.parseInline(P)}</strong>`}em({tokens:P}){return`<em>${this.parser.parseInline(P)}</em>`}codespan({text:P}){return`<code>${P}</code>`}br(P){return"<br>"}del({tokens:P}){return`<del>${this.parser.parseInline(P)}</del>`}link({href:P,title:N,tokens:V}){let j=this.parser.parseInline(V),Q=m(P);if(Q===null)return j;P=Q;let le='<a href="'+P+'"';return N&&(le+=' title="'+N+'"'),le+=">"+j+"</a>",le}image({href:P,title:N,text:V}){let j=m(P);if(j===null)return V;P=j;let Q=`<img src="${P}" alt="${V}"`;return N&&(Q+=` title="${N}"`),Q+=">",Q}text(P){return"tokens"in P&&P.tokens?this.parser.parseInline(P.tokens):P.text}}class ku{strong({text:P}){return P}em({text:P}){return P}codespan({text:P}){return P}del({text:P}){return P}html({text:P}){return P}text({text:P}){return P}link({text:P}){return""+P}image({text:P}){return""+P}br(){return""}}class Zr{options;renderer;textRenderer;constructor(P){this.options=P||t.defaults,this.options.renderer=this.options.renderer||new Sa,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ku}static parse(P,N){return new Zr(N).parse(P)}static parseInline(P,N){return new Zr(N).parseInline(P)}parse(P,N=!0){let V="";for(let j=0;j<P.length;j++){let Q=P[j];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Q.type]){let Ce=Q,ze=this.options.extensions.renderers[Ce.type].call({parser:this},Ce);if(ze!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Ce.type)){V+=ze||"";continue}}let le=Q;switch(le.type){case"space":{V+=this.renderer.space(le);continue}case"hr":{V+=this.renderer.hr(le);continue}case"heading":{V+=this.renderer.heading(le);continue}case"code":{V+=this.renderer.code(le);continue}case"table":{V+=this.renderer.table(le);continue}case"blockquote":{V+=this.renderer.blockquote(le);continue}case"list":{V+=this.renderer.list(le);continue}case"html":{V+=this.renderer.html(le);continue}case"paragraph":{V+=this.renderer.paragraph(le);continue}case"text":{let Ce=le,ze=this.renderer.text(Ce);for(;j+1<P.length&&P[j+1].type==="text";)Ce=P[++j],ze+=`
`+this.renderer.text(Ce);N?V+=this.renderer.paragraph({type:"paragraph",raw:ze,text:ze,tokens:[{type:"text",raw:ze,text:ze}]}):V+=ze;continue}default:{let Ce='Token with "'+le.type+'" type was not found.';if(this.options.silent)return console.error(Ce),"";throw new Error(Ce)}}}return V}parseInline(P,N){N=N||this.renderer;let V="";for(let j=0;j<P.length;j++){let Q=P[j];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Q.type]){let Ce=this.options.extensions.renderers[Q.type].call({parser:this},Q);if(Ce!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Q.type)){V+=Ce||"";continue}}let le=Q;switch(le.type){case"escape":{V+=N.text(le);break}case"html":{V+=N.html(le);break}case"link":{V+=N.link(le);break}case"image":{V+=N.image(le);break}case"strong":{V+=N.strong(le);break}case"em":{V+=N.em(le);break}case"codespan":{V+=N.codespan(le);break}case"br":{V+=N.br(le);break}case"del":{V+=N.del(le);break}case"text":{V+=N.text(le);break}default:{let Ce='Token with "'+le.type+'" type was not found.';if(this.options.silent)return console.error(Ce),"";throw new Error(Ce)}}}return V}}class nh{options;constructor(P){this.options=P||t.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(P){return P}postprocess(P){return P}processAllTokens(P){return P}}class Kl{defaults=e();options=this.setOptions;parse=this.parseMarkdown(oo.lex,Zr.parse);parseInline=this.parseMarkdown(oo.lexInline,Zr.parseInline);Parser=Zr;Renderer=Sa;TextRenderer=ku;Lexer=oo;Tokenizer=S;Hooks=nh;constructor(...P){this.use(...P)}walkTokens(P,N){let V=[];for(let j of P)switch(V=V.concat(N.call(this,j)),j.type){case"table":{let Q=j;for(let le of Q.header)V=V.concat(this.walkTokens(le.tokens,N));for(let le of Q.rows)for(let Ce of le)V=V.concat(this.walkTokens(Ce.tokens,N));break}case"list":{let Q=j;V=V.concat(this.walkTokens(Q.items,N));break}default:{let Q=j;this.defaults.extensions?.childTokens?.[Q.type]?this.defaults.extensions.childTokens[Q.type].forEach(le=>{let Ce=Q[le].flat(1/0);V=V.concat(this.walkTokens(Ce,N))}):Q.tokens&&(V=V.concat(this.walkTokens(Q.tokens,N)))}}return V}use(...P){let N=this.defaults.extensions||{renderers:{},childTokens:{}};return P.forEach(V=>{let j={...V};if(j.async=this.defaults.async||j.async||!1,V.extensions&&(V.extensions.forEach(Q=>{if(!Q.name)throw new Error("extension name required");if("renderer"in Q){let le=N.renderers[Q.name];le?N.renderers[Q.name]=function(...Ce){let ze=Q.renderer.apply(this,Ce);return ze===!1&&(ze=le.apply(this,Ce)),ze}:N.renderers[Q.name]=Q.renderer}if("tokenizer"in Q){if(!Q.level||Q.level!=="block"&&Q.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let le=N[Q.level];le?le.unshift(Q.tokenizer):N[Q.level]=[Q.tokenizer],Q.start&&(Q.level==="block"?N.startBlock?N.startBlock.push(Q.start):N.startBlock=[Q.start]:Q.level==="inline"&&(N.startInline?N.startInline.push(Q.start):N.startInline=[Q.start]))}"childTokens"in Q&&Q.childTokens&&(N.childTokens[Q.name]=Q.childTokens)}),j.extensions=N),V.renderer){let Q=this.defaults.renderer||new Sa(this.defaults);for(let le in V.renderer){if(!(le in Q))throw new Error(`renderer '${le}' does not exist`);if(["options","parser"].includes(le))continue;let Ce=le,ze=V.renderer[Ce],$e=Q[Ce];Q[Ce]=(...Vt)=>{let Ii=ze.apply(Q,Vt);return Ii===!1&&(Ii=$e.apply(Q,Vt)),Ii||""}}j.renderer=Q}if(V.tokenizer){let Q=this.defaults.tokenizer||new S(this.defaults);for(let le in V.tokenizer){if(!(le in Q))throw new Error(`tokenizer '${le}' does not exist`);if(["options","rules","lexer"].includes(le))continue;let Ce=le,ze=V.tokenizer[Ce],$e=Q[Ce];Q[Ce]=(...Vt)=>{let Ii=ze.apply(Q,Vt);return Ii===!1&&(Ii=$e.apply(Q,Vt)),Ii}}j.tokenizer=Q}if(V.hooks){let Q=this.defaults.hooks||new nh;for(let le in V.hooks){if(!(le in Q))throw new Error(`hook '${le}' does not exist`);if(le==="options")continue;let Ce=le,ze=V.hooks[Ce],$e=Q[Ce];nh.passThroughHooks.has(le)?Q[Ce]=Vt=>{if(this.defaults.async)return Promise.resolve(ze.call(Q,Vt)).then(sn=>$e.call(Q,sn));let Ii=ze.call(Q,Vt);return $e.call(Q,Ii)}:Q[Ce]=(...Vt)=>{let Ii=ze.apply(Q,Vt);return Ii===!1&&(Ii=$e.apply(Q,Vt)),Ii}}j.hooks=Q}if(V.walkTokens){let Q=this.defaults.walkTokens,le=V.walkTokens;j.walkTokens=function(Ce){let ze=[];return ze.push(le.call(this,Ce)),Q&&(ze=ze.concat(Q.call(this,Ce))),ze}}this.defaults={...this.defaults,...j}}),this}setOptions(P){return this.defaults={...this.defaults,...P},this}lexer(P,N){return oo.lex(P,N??this.defaults)}parser(P,N){return Zr.parse(P,N??this.defaults)}parseMarkdown(P,N){return(j,Q)=>{let le={...Q},Ce={...this.defaults,...le},ze=this.onError(!!Ce.silent,!!Ce.async);if(this.defaults.async===!0&&le.async===!1)return ze(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof j>"u"||j===null)return ze(new Error("marked(): input parameter is undefined or null"));if(typeof j!="string")return ze(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(j)+", string expected"));if(Ce.hooks&&(Ce.hooks.options=Ce),Ce.async)return Promise.resolve(Ce.hooks?Ce.hooks.preprocess(j):j).then($e=>P($e,Ce)).then($e=>Ce.hooks?Ce.hooks.processAllTokens($e):$e).then($e=>Ce.walkTokens?Promise.all(this.walkTokens($e,Ce.walkTokens)).then(()=>$e):$e).then($e=>N($e,Ce)).then($e=>Ce.hooks?Ce.hooks.postprocess($e):$e).catch(ze);try{Ce.hooks&&(j=Ce.hooks.preprocess(j));let $e=P(j,Ce);Ce.hooks&&($e=Ce.hooks.processAllTokens($e)),Ce.walkTokens&&this.walkTokens($e,Ce.walkTokens);let Vt=N($e,Ce);return Ce.hooks&&(Vt=Ce.hooks.postprocess(Vt)),Vt}catch($e){return ze($e)}}}onError(P,N){return V=>{if(V.message+=`
Please report this to https://github.com/markedjs/marked.`,P){let j="<p>An error occurred:</p><pre>"+c(V.message+"",!0)+"</pre>";return N?Promise.resolve(j):j}if(N)return Promise.reject(V);throw V}}}let dc=new Kl;function Oe(vt,P){return dc.parse(vt,P)}Oe.options=Oe.setOptions=function(vt){return dc.setOptions(vt),Oe.defaults=dc.defaults,i(Oe.defaults),Oe},Oe.getDefaults=e,Oe.defaults=t.defaults,Oe.use=function(...vt){return dc.use(...vt),Oe.defaults=dc.defaults,i(Oe.defaults),Oe},Oe.walkTokens=function(vt,P){return dc.walkTokens(vt,P)},Oe.parseInline=dc.parseInline,Oe.Parser=Zr,Oe.parser=Zr.parse,Oe.Renderer=Sa,Oe.TextRenderer=ku,Oe.Lexer=oo,Oe.lexer=oo.lex,Oe.Tokenizer=S,Oe.Hooks=nh,Oe.parse=Oe;let De=Oe.options,K=Oe.setOptions,we=Oe.use,Ae=Oe.walkTokens,Nt=Oe.parseInline,_i=Oe,Fo=Zr.parse,yr=oo.lex;t.Hooks=nh,t.Lexer=oo,t.Marked=Kl,t.Parser=Zr,t.Renderer=Sa,t.TextRenderer=ku,t.Tokenizer=S,t.getDefaults=e,t.lexer=yr,t.marked=Oe,t.options=De,t.parse=_i,t.parseInline=Nt,t.parser=Fo,t.setOptions=K,t.use=we,t.walkTokens=Ae})})();var Apt=cr.Hooks||exports.Hooks,Ppt=cr.Lexer||exports.Lexer,Mpt=cr.Marked||exports.Marked,Opt=cr.Parser||exports.Parser,P2=cr.Renderer||exports.Renderer,Npt=cr.TextRenderer||exports.TextRenderer,Fpt=cr.Tokenizer||exports.Tokenizer,hX=cr.defaults||exports.defaults,Bpt=cr.getDefaults||exports.getDefaults,nT=cr.lexer||exports.lexer,Vpt=cr.marked||exports.marked,Wpt=cr.options||exports.options,M2=cr.parse||exports.parse,Upt=cr.parseInline||exports.parseInline,mX=cr.parser||exports.parser,Hpt=cr.setOptions||exports.setOptions,zpt=cr.use||exports.use,Kpt=cr.walkTokens||exports.walkTokens;var O2=Object.freeze({image:({href:r,title:t,text:e})=>{let i=[],n=[];return r&&({href:r,dimensions:i}=c3(r),n.push(`src="${gw(r)}"`)),e&&n.push(`alt="${gw(e)}"`),t&&n.push(`title="${gw(t)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:r}){return`<p>${this.parser.parseInline(r)}</p>`},link({href:r,title:t,tokens:e}){let i=this.parser.parseInline(e);return typeof r!="string"?"":(r===i&&(i=KD(i)),t=typeof t=="string"?gw(KD(t)):"",r=KD(r),r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${r}" title="${t||r}" draggable="false">${i}</a>`)}});function VA(r,t={},e={}){let i=new W,n=!1,o=FA(t),s=function(f){let b;try{b=Py(decodeURIComponent(f))}catch{}return b?(b=pW(b,y=>{if(r.uris&&r.uris[y])return q.revive(r.uris[y])}),encodeURIComponent(JSON.stringify(b))):f},a=function(f,b){let y=r.uris&&r.uris[f],I=q.revive(y);return b?f.startsWith(he.data+":")?f:(I||(I=q.parse(f)),Da.uriToBrowserUri(I).toString(!0)):!I||q.parse(f).toString()===I.toString()?f:(I.query&&(I=I.with({query:s(I.query)})),I.toString())},l=new P2;l.image=O2.image,l.link=O2.link,l.paragraph=O2.paragraph;let d=[],c=[];if(t.codeBlockRendererSync?l.code=({text:f,lang:b})=>{let y=iT.nextId(),I=t.codeBlockRendererSync(gX(b),f);return c.push([y,I]),`<div class="code" data-code="${y}">${Ku(f)}</div>`}:t.codeBlockRenderer&&(l.code=({text:f,lang:b})=>{let y=iT.nextId(),I=t.codeBlockRenderer(gX(b),f);return d.push(I.then(E=>[y,E])),`<div class="code" data-code="${y}">${Ku(f)}</div>`}),t.actionHandler){let f=function(I){let E=I.target.closest("a[data-href]");if(Oi(E))try{let S=E.dataset.href;S&&(r.baseUri&&(S=N2(q.from(r.baseUri),S)),t.actionHandler.callback(S,I))}catch(S){Ke(S)}finally{I.preventDefault()}},b=t.actionHandler.disposables.add(new Ge(o,"click")),y=t.actionHandler.disposables.add(new Ge(o,"auxclick"));t.actionHandler.disposables.add(O.any(b.event,y.event)(I=>{let E=new ri(oe(o),I);!E.leftButton&&!E.middleButton||f(E)})),t.actionHandler.disposables.add(M(o,"keydown",I=>{let E=new st(I);!E.equals(10)&&!E.equals(3)||f(E)}))}r.supportHtml||(l.html=({text:f})=>t.sanitizerOptions?.replaceWithPlaintext?Ku(f):(r.isTrusted?f.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?f:""),e.renderer=l;let u=r.value??"";u.length>1e5&&(u=`${u.substr(0,1e5)}\u2026`),r.supportThemeIcons&&(u=d3(u));let p;if(t.fillInIncompleteTokens){let f={...hX,...e},b=nT(u,f),y=gle(b);p=mX(y,f)}else p=M2(u,{...e,async:!1});r.supportThemeIcons&&(p=Rs(p).map(b=>typeof b=="string"?b:b.outerHTML).join(""));let g=new DOMParser().parseFromString(F2({isTrusted:r.isTrusted,...t.sanitizerOptions},p),"text/html");if(g.body.querySelectorAll("img, audio, video, source").forEach(f=>{let b=f.getAttribute("src");if(b){let y=b;try{r.baseUri&&(y=N2(q.from(r.baseUri),y))}catch{}if(f.setAttribute("src",a(y,!0)),t.remoteImageIsAllowed){let I=q.parse(y);I.scheme!==he.file&&I.scheme!==he.data&&!t.remoteImageIsAllowed(I)&&f.replaceWith(re("",void 0,f.outerHTML))}}}),g.body.querySelectorAll("a").forEach(f=>{let b=f.getAttribute("href");if(f.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!r.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))f.replaceWith(...f.childNodes);else{let y=a(b,!1);r.baseUri&&(y=N2(q.from(r.baseUri),b)),f.dataset.href=y}}),o.innerHTML=F2({isTrusted:r.isTrusted,...t.sanitizerOptions},g.body.innerHTML),d.length>0)Promise.all(d).then(f=>{if(n)return;let b=new Map(f),y=o.querySelectorAll("div[data-code]");for(let I of y){let E=b.get(I.dataset.code??"");E&&Tn(I,E)}t.asyncRenderCallback?.()});else if(c.length>0){let f=new Map(c),b=o.querySelectorAll("div[data-code]");for(let y of b){let I=f.get(y.dataset.code??"");I&&Tn(y,I)}}if(t.asyncRenderCallback)for(let f of o.getElementsByTagName("img")){let b=i.add(M(f,"load",()=>{b.dispose(),t.asyncRenderCallback()}))}return{element:o,dispose:()=>{n=!0,i.dispose()}}}function gX(r){if(!r)return"";let t=r.split(/[\s+|:|,|\{|\?]/,1);return t.length?t[0]:r}function N2(r,t){return/^\w[\w\d+.-]*:/.test(t)?t:r.path.endsWith("/")?RB(r,t).toString():RB(er(r),t).toString()}var ole=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function F2(r,t){let{config:e,allowedSchemes:i}=sle(r),n=new W;n.add(fX("uponSanitizeAttribute",(o,s)=>{if(s.attrName==="style"||s.attrName==="class"){if(o.tagName==="SPAN"){if(s.attrName==="style"){s.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(s.attrValue);return}else if(s.attrName==="class"){s.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(s.attrValue);return}}s.keepAttr=!1;return}else if(o.tagName==="INPUT"&&o.attributes.getNamedItem("type")?.value==="checkbox"){if(s.attrName==="type"&&s.attrValue==="checkbox"||s.attrName==="disabled"||s.attrName==="checked"){s.keepAttr=!0;return}s.keepAttr=!1}})),n.add(fX("uponSanitizeElement",(o,s)=>{if(s.tagName==="input"&&(o.attributes.getNamedItem("type")?.value==="checkbox"?o.setAttribute("disabled",""):r.replaceWithPlaintext||o.remove()),r.replaceWithPlaintext&&!s.allowedTags[s.tagName]&&s.tagName!=="body"&&o.parentElement){let a,l;if(s.tagName==="#comment")a=`<!--${o.textContent}-->`;else{let p=ole.includes(s.tagName),m=o.attributes.length?" "+Array.from(o.attributes).map(g=>`${g.name}="${g.value}"`).join(" "):"";a=`<${s.tagName}${m}>`,p||(l=`</${s.tagName}>`)}let d=document.createDocumentFragment(),c=o.parentElement.ownerDocument.createTextNode(a);d.appendChild(c);let u=l?o.parentElement.ownerDocument.createTextNode(l):void 0;for(;o.firstChild;)d.appendChild(o.firstChild);u&&d.appendChild(u),o.parentElement.replaceChild(d,o)}})),n.add(l$(i));try{return qw(t,{...e,RETURN_TRUSTED_TYPE:!0})}finally{n.dispose()}}var rle=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function sle(r){let t=[he.http,he.https,he.mailto,he.data,he.file,he.vscodeFileResource,he.vscodeRemote,he.vscodeRemoteResource];return r.isTrusted&&t.push(he.command),{config:{ALLOWED_TAGS:r.allowedTags??[...d$],ALLOWED_ATTR:rle,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:t}}function B2(r){return typeof r=="string"?r:ale(r)}function ale(r,t){let e=r.value??"";e.length>1e5&&(e=`${e.substr(0,1e5)}\u2026`);let i=M2(e,{async:!1,renderer:t?cle.value:dle.value}).replace(/&(#\d+|[a-zA-Z]+);/g,n=>lle.get(n)??n);return F2({isTrusted:!1},i).toString()}var lle=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function bX(){let r=new P2;return r.code=({text:t})=>t,r.blockquote=({text:t})=>t+`
`,r.html=t=>"",r.heading=function({tokens:t}){return this.parser.parseInline(t)+`
`},r.hr=()=>"",r.list=function({items:t}){return t.map(e=>this.listitem(e)).join(`
`)+`
`},r.listitem=({text:t})=>t+`
`,r.paragraph=function({tokens:t}){return this.parser.parseInline(t)+`
`},r.table=function({header:t,rows:e}){return t.map(i=>this.tablecell(i)).join(" ")+`
`+e.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},r.tablerow=({text:t})=>t,r.tablecell=function({tokens:t}){return this.parser.parseInline(t)},r.strong=({text:t})=>t,r.em=({text:t})=>t,r.codespan=({text:t})=>t,r.br=t=>`
`,r.del=({text:t})=>t,r.image=t=>"",r.text=({text:t})=>t,r.link=({text:t})=>t,r}var dle=new an(r=>bX()),cle=new an(()=>{let r=bX();return r.code=({text:t})=>`
\`\`\`
${t}
\`\`\`
`,r});function BA(r){let t="";return r.forEach(e=>{t+=e.raw}),t}function vX(r){if(r.tokens)for(let t=r.tokens.length-1;t>=0;t--){let e=r.tokens[t];if(e.type==="text"){let i=e.raw.split(`
`),n=i[i.length-1];if(n.includes("`"))return ble(r);if(n.includes("**"))return wle(r);if(n.match(/\*\w/))return vle(r);if(n.match(/(^|\s)__\w/))return Ele(r);if(n.match(/(^|\s)_\w/))return yle(r);if(ule(n)||ple(n)&&r.tokens.slice(0,t).some(o=>o.type==="text"&&o.raw.match(/\[[^\]]*$/))){let o=r.tokens.slice(t+1);return o[0]?.type==="link"&&o[1]?.type==="text"&&o[1].raw.match(/^ *"[^"]*$/)||n.match(/^[^"]* +"[^"]*$/)?Cle(r):Ile(r)}else if(n.match(/(^|\s)\[\w*/))return Sle(r)}}}function ule(r){return!!r.match(/(^|\s)\[.*\]\(\w*/)}function ple(r){return!!r.match(/^[^\[]*\]\([^\)]*$/)}function hle(r){let t=r.items[r.items.length-1],e=t.tokens?t.tokens[t.tokens.length-1]:void 0,i;if(e?.type==="text"&&!("inRawBlock"in t)&&(i=vX(e)),!i||i.type!=="paragraph")return;let n=BA(r.items.slice(0,-1)),o=t.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!o)return;let s=o+BA(t.tokens.slice(0,-1))+i.raw,a=nT(n+s)[0];if(a.type==="list")return a}var mle=3;function gle(r){for(let t=0;t<mle;t++){let e=fle(r);if(e)r=e;else break}return r}function fle(r){let t,e;for(t=0;t<r.length;t++){let i=r[t];if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){e=Tle(r.slice(t));break}if(t===r.length-1&&i.type==="list"){let n=hle(i);if(n){e=[n];break}}if(t===r.length-1&&i.type==="paragraph"){let n=vX(i);if(n){e=[n];break}}}if(e){let i=[...r.slice(0,t),...e];return i.links=r.links,i}return null}function ble(r){return sm(r,"`")}function vle(r){return sm(r,"*")}function yle(r){return sm(r,"_")}function Ile(r){return sm(r,")")}function Cle(r){return sm(r,'")')}function Sle(r){return sm(r,"](https://microsoft.com)")}function wle(r){return sm(r,"**")}function Ele(r){return sm(r,"__")}function sm(r,t){let e=BA(Array.isArray(r)?r:[r]);return nT(e+t)[0]}function Tle(r){let t=BA(r),e=t.split(`
`),i,n=!1;for(let o=0;o<e.length;o++){let s=e[o].trim();if(typeof i>"u"&&s.match(/^\s*\|/)){let a=s.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(s.match(/^\s*\|/)){if(o!==e.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){let o=n?e.slice(0,-1).join(`
`):t,s=!!o.match(/\|\s*$/),a=o+(s?"":"|")+`
|${" --- |".repeat(i)}`;return nT(a)}}function fX(r,t){return XL(r,t),te(()=>QL(r))}var yf=re,yX="selectOption.entry.template",V2=class{get templateId(){return yX}renderTemplate(t){let e=Object.create(null);return e.root=t,e.text=Ee(t,yf(".option-text")),e.detail=Ee(t,yf(".option-detail")),e.decoratorRight=Ee(t,yf(".option-decorator-right")),e}renderElement(t,e,i){let n=i,o=t.text,s=t.detail,a=t.decoratorRight,l=t.isDisabled;n.text.textContent=o,n.detail.textContent=s||"",n.decoratorRight.innerText=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(t){}},WA=class r extends L{static DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;static DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;static DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;_isVisible;selectBoxOptions;selectElement;container;options=[];selected;_onDidSelect;styles;listRenderer;contextViewProvider;selectDropDownContainer;styleElement;selectList;selectDropDownListContainer;widthControlElement;_currentSelection=0;_dropDownPosition;_hasDetails=!1;selectionDetailsPane;_skipLayout=!1;_cachedMaxDetailsHeight;_hover;_sticky=!1;constructor(t,e,i,n,o){super(),this._isVisible=!1,this.styles=n,this.selectBoxOptions=o||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=r.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new T,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=e||0,t&&this.setOptions(t,e),this.initStyleSheet()}setTitle(t){!this._hover&&t?this._hover=this._register($n().setupManagedHover(zt("mouse"),this.selectElement,t)):this._hover&&this._hover.update(t)}getHeight(){return 22}getTemplateId(){return yX}constructSelectDropDown(t){this.contextViewProvider=t,this.selectDropDownContainer=re(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Ee(this.selectDropDownContainer,yf(".select-box-details-pane"));let e=Ee(this.selectDropDownContainer,yf(".select-box-dropdown-container-width-control")),i=Ee(e,yf(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Ee(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Ho(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(M(this.selectDropDownContainer,G.DRAG_START,n=>{Te.stop(n,!0)}))}registerListeners(){this._register(Wi(this.selectElement,"change",e=>{this.selected=e.target.selectedIndex,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(M(this.selectElement,G.CLICK,e=>{Te.stop(e),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(M(this.selectElement,G.MOUSE_DOWN,e=>{Te.stop(e)}));let t;this._register(M(this.selectElement,"touchstart",e=>{t=this._isVisible})),this._register(M(this.selectElement,"touchend",e=>{Te.stop(e),t?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(M(this.selectElement,G.KEY_DOWN,e=>{let i=new st(e),n=!1;be?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),Te.stop(e,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(t,e){ti(this.options,t)||(this.options=t,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),e!==void 0&&(this.select(e),this._currentSelection=this.selected)}setEnabled(t){this.selectElement.disabled=!t}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(t){t>=0&&t<this.options.length?this.selected=t:t>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}setAriaLabel(t){this.selectBoxOptions.ariaLabel=t,this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(t){this.selectElement.tabIndex=t?0:-1}render(t){this.container=t,t.classList.add("select-container"),t.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){let t=[];this.styles.listFocusBackground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(t.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),t.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),t.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=t.join(`
`)}styleSelectElement(){let t=this.styles.selectBackground??"",e=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=t,this.selectElement.style.color=e,this.selectElement.style.borderColor=i}styleList(){let t=this.styles.selectBackground??"",e=Is(this.styles.selectListBackground,t);this.selectDropDownListContainer.style.backgroundColor=e,this.selectionDetailsPane.style.backgroundColor=e;let i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(t,e,i){let n=document.createElement("option");return n.value=t,n.text=t,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:t=>this.renderSelectDropDown(t,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:t=>this.renderSelectDropDown(t),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(t){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),t&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(t,e){return t.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(e),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let t=0;return this.options.forEach((e,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>t&&(t=this.selectionDetailsPane.offsetHeight)}),t}layoutSelectDropDown(t){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");let e=oe(this.selectElement),i=To(this.selectElement),n=oe(this.selectElement).getComputedStyle(this.selectElement),o=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),s=e.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,d=this.setWidthControlElement(this.widthControlElement),c=Math.max(d,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());let p=this._hasDetails?this._cachedMaxDetailsHeight:0,m=u+o+p,g=Math.floor((s-o-p)/this.getHeight()),f=Math.floor((a-o-p)/this.getHeight());if(t)return i.top+i.height>e.innerHeight-22||i.top<r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||g<1&&f<1?!1:(g<r.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&f>g&&this.options.length>g?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>e.innerHeight-22||i.top<r.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&g<1||this._dropDownPosition===1&&f<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&g+f<1)return this.hideSelectDropDown(!0),!1;m>s&&(u=g*this.getHeight())}else m>a&&(u=f*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+o+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+o+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(t){let e=0;if(t){let i=0,n=0;this.options.forEach((o,s)=>{let a=o.detail?o.detail.length:0,l=o.decoratorRight?o.decoratorRight.length:0,d=o.text.length+a+l;d>n&&(i=s,n=d)}),t.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),e=Hv(t)}return e}createSelectList(t){if(this.selectList)return;this.selectDropDownListContainer=Ee(t,yf(".select-box-dropdown-list-container")),this.listRenderer=new V2,this.selectList=this._register(new Lo("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let o=n.text;return n.detail&&(o+=`. ${n.detail}`),n.decoratorRight&&(o+=`. ${n.decoratorRight}`),n.description&&(o+=`. ${n.description}`),o},getWidgetAriaLabel:()=>h({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>be?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);let e=this._register(new Ge(this.selectDropDownListContainer,"keydown")),i=O.chain(e.event,n=>n.filter(()=>this.selectList.length>0).map(o=>new st(o)));this._register(O.chain(i,n=>n.filter(o=>o.keyCode===3))(this.onEnter,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===2))(this.onEnter,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===9))(this.onEscape,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===16))(this.onUpArrow,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===18))(this.onDownArrow,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===12))(this.onPageDown,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===11))(this.onPageUp,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===14))(this.onHome,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode===13))(this.onEnd,this)),this._register(O.chain(i,n=>n.filter(o=>o.keyCode>=21&&o.keyCode<=56||o.keyCode>=85&&o.keyCode<=113))(this.onCharacter,this)),this._register(M(this.selectList.getHTMLElement(),G.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(M(this.selectDropDownContainer,G.FOCUS_OUT,n=>{!this._isVisible||Xi(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(t){if(!this.selectList.length)return;Te.stop(t);let e=t.target;if(!e||e.classList.contains("slider"))return;let i=e.closest(".monaco-list-row");if(!i)return;let n=Number(i.getAttribute("data-index")),o=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!o&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(t,e){let i=o=>{for(let s=0;s<o.childNodes.length;s++){let a=o.childNodes.item(s);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=VA({value:t,supportThemeIcons:!0},{actionHandler:e});return n.element.classList.add("select-box-description-markdown"),i(n.element),n.element}onListFocus(t){!this._isVisible||!this._hasDetails||this.updateDetail(t.indexes[0])}updateDetail(t){this.selectionDetailsPane.innerText="";let e=this.options[t],i=e?.description??"",n=e?.descriptionIsMarkdown??!1;if(i){if(n){let o=e.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(i,o))}else this.selectionDetailsPane.innerText=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(t){Te.stop(t),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(t){Te.stop(t),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(t){if(this.selected<this.options.length-1){Te.stop(t,!0);let e=this.options[this.selected+1].isDisabled;if(e&&this.options.length>this.selected+2)this.selected+=2;else{if(e)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(t){this.selected>0&&(Te.stop(t,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(t){Te.stop(t),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(t){Te.stop(t),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(t){Te.stop(t),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(t){Te.stop(t),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(t){let e=Hw.toString(t.keyCode),i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===e&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),Te.stop(t);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};var UA=class extends L{selectElement;selectBoxOptions;options;selected=0;_onDidSelect;styles;constructor(t,e,i,n){super(),this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new T),this.styles=i,this.registerListeners(),this.setOptions(t,e)}registerListeners(){this._register(Wt.addTarget(this.selectElement)),[it.Tap].forEach(t=>{this._register(M(this.selectElement,t,e=>{this.selectElement.focus()}))}),this._register(Wi(this.selectElement,"click",t=>{Te.stop(t,!0)})),this._register(Wi(this.selectElement,"change",t=>{this.selectElement.title=t.target.value,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value})})),this._register(Wi(this.selectElement,"keydown",t=>{let e=!1;be?(t.keyCode===18||t.keyCode===16||t.keyCode===10)&&(e=!0):(t.keyCode===18&&t.altKey||t.keyCode===10||t.keyCode===3)&&(e=!0),e&&t.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(t,e){(!this.options||!ti(this.options,t))&&(this.options=t,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),e!==void 0&&this.select(e)}select(t){this.options.length===0?this.selected=0:t>=0&&t<this.options.length?this.selected=t:t>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}setAriaLabel(t){this.selectBoxOptions.ariaLabel=t,this.selectElement.setAttribute("aria-label",t)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setEnabled(t){this.selectElement.disabled=!t}setFocusable(t){this.selectElement.tabIndex=t?0:-1}render(t){t.classList.add("select-container"),t.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}style(t){this.styles=t,this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(t,e,i){let n=document.createElement("option");return n.value=t,n.text=t,n.disabled=!!i,n}};var wmt={...AA,selectBackground:"#3C3C3C",selectForeground:"#F0F0F0",selectBorder:"#3C3C3C",decoratorRightForeground:void 0,selectListBackground:void 0,selectListBorder:void 0,focusBorder:void 0},HA=class extends eo{selectBoxDelegate;constructor(t,e,i,n,o){super(),be&&!o?.useCustomDrawn?this.selectBoxDelegate=new UA(t,e,n,o):this.selectBoxDelegate=new WA(t,e,i,n,o),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(t,e){this.selectBoxDelegate.setOptions(t,e)}select(t){this.selectBoxDelegate.select(t)}setAriaLabel(t){this.selectBoxDelegate.setAriaLabel(t)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(t){this.selectBoxDelegate.setFocusable(t)}setEnabled(t){this.selectBoxDelegate.setEnabled(t)}render(t){this.selectBoxDelegate.render(t)}};var IX={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};var Od=class extends eo{_onChange=this._register(new T);onChange=this._onChange.event;_onKeyDown=this._register(new T);onKeyDown=this._onKeyDown.event;_opts;_icon;domNode;_checked;_hover;constructor(t){super(),this._opts=t,this._checked=this._opts.isChecked;let e=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,e.push(...ye.asClassNameArray(this._icon))),this._opts.actionClassName&&e.push(...this._opts.actionClassName.split(" ")),this._checked&&e.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register($n().setupManagedHover(t.hoverDelegate??zt("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...e),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(t){this._checked=t,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(t){this._icon&&this.domNode.classList.remove(...ye.asClassNameArray(this._icon)),this._icon=t,this._icon&&this.domNode.classList.add(...ye.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}setTitle(t){this._hover.update(t),this.domNode.setAttribute("aria-label",t)}set visible(t){this.domNode.style.display=t?"":"none"}get visible(){return this.domNode.style.display!=="none"}};var zn=class extends L{constructor(e,i,n={}){super();this.options=n;this._context=e||this,this._action=i,i instanceof ot&&this._register(i.onDidChange(o=>{this.element&&this.handleActionChangeEvent(o)}))}element;_context;_action;customHover;get action(){return this._action}_actionRunner;handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new wn)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){let i=this.element=e;this._register(Wt.addTarget(e));let n=this.options&&this.options.draggable;n&&(e.draggable=!0,dn&&this._register(M(e,G.DRAG_START,o=>o.dataTransfer?.setData(cs.TEXT,this._action.label)))),this._register(M(i,it.Tap,o=>this.onClick(o,!0))),this._register(M(i,G.MOUSE_DOWN,o=>{n||Te.stop(o,!0),this._action.enabled&&o.button===0&&i.classList.add("active")})),be&&this._register(M(i,G.CONTEXT_MENU,o=>{o.button===0&&o.ctrlKey===!0&&this.onClick(o)})),this._register(M(i,G.CLICK,o=>{Te.stop(o,!0),this.options&&this.options.isMenu||this.onClick(o)})),this._register(M(i,G.DBLCLICK,o=>{Te.stop(o,!0)})),[G.MOUSE_UP,G.MOUSE_OUT].forEach(o=>{this._register(M(i,o,s=>{Te.stop(s),i.classList.remove("active")}))})}onClick(e,i=!1){Te.stop(e,!0);let n=Zi(this._context)?this.options?.useEventAsContext?e:{preserveFocus:i}:this._context;this.actionRunner.run(this._action,n)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}isFocused(){return!!this.element?.classList.contains("focused")}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;let e=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=e;else if(!this.customHover&&e!==""){let i=this.options.hoverDelegate??zt("element");this.customHover=this._store.add($n().setupManagedHover(i,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){let e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}},Nd=class extends zn{label;options;cssClass;constructor(t,e,i){super(t,e,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(t){super.render(t),Yb(this.element);let e=document.createElement("a");if(e.classList.add("action-label"),e.setAttribute("role",this.getDefaultAriaRole()),this.label=e,this.element.appendChild(e),this.options.label&&this.options.keybinding){let i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===pt.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}isFocused(){return!!this.label&&this.label?.tabIndex===0}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(t){this.label&&(this.label.tabIndex=t?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let t=null;return this.action.tooltip?t=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(t=this.action.label,this.options.keybinding&&(t=h({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",t,this.options.keybinding))),t??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){let t=this.getTooltip()??"";this.label.setAttribute("aria-label",t)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}},zA=class extends zn{selectBox;constructor(t,e,i,n,o,s,a){super(t,e),this.selectBox=new HA(i,n,o,s,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}setOptions(t,e){this.selectBox.setOptions(t,e)}select(t){this.selectBox.select(t)}registerListeners(){this._register(this.selectBox.onDidSelect(t=>this.runAction(t.selected,t.index)))}runAction(t,e){this.actionRunner.run(this._action,this.getActionContext(t,e))}getActionContext(t,e){return t}setFocusable(t){this.selectBox.setFocusable(t)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(t){this.selectBox.render(t)}};var gn=class extends L{options;_hoverDelegate;_actionRunner;_actionRunnerDisposables=this._register(new W);_context;_orientation;_triggerKeys;viewItems;viewItemDisposables=this._register(new Bo);previouslyFocusedItem;focusedItem;focusTracker;triggerKeyDown=!1;focusable=!0;domNode;actionsList;_onDidBlur=this._register(new T);onDidBlur=this._onDidBlur.event;_onDidCancel=this._register(new T({onWillAddFirstListener:()=>this.cancelHasListener=!0}));onDidCancel=this._onDidCancel.event;cancelHasListener=!1;_onDidRun=this._register(new T);onDidRun=this._onDidRun.event;_onWillRun=this._register(new T);onWillRun=this._onWillRun.event;constructor(t,e={}){super(),this.options=e,this._context=e.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=e.hoverDelegate??this._register(Ha()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new wn,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(o=>this._onDidRun.fire(o))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(o=>this._onWillRun.fire(o))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(M(this.domNode,G.KEY_DOWN,o=>{let s=new st(o),a=!0,l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(s.equals(i[0])||s.equals(i[1]))?a=this.focusPrevious():n&&(s.equals(n[0])||s.equals(n[1]))?a=this.focusNext():s.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():s.equals(14)?a=this.focusFirst():s.equals(13)?a=this.focusLast():s.equals(2)&&l instanceof zn&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(s)?this._triggerKeys.keyDown?this.doTrigger(s):this.triggerKeyDown=!0:a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(M(this.domNode,G.KEY_UP,o=>{let s=new st(o);this.isTriggerKeyEvent(s)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(s)),s.preventDefault(),s.stopPropagation()):(s.equals(2)||s.equals(1026)||s.equals(16)||s.equals(18)||s.equals(15)||s.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Un(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(An()===this.domNode||!Xi(An(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),t.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setAriaLabel(t){t?this.actionsList.setAttribute("aria-label",t):this.actionsList.removeAttribute("aria-label")}setFocusable(t){if(this.focusable=t,this.focusable){let e=this.viewItems.find(i=>i instanceof zn&&i.isEnabled());e instanceof zn&&e.setFocusable(!0)}else this.viewItems.forEach(e=>{e instanceof zn&&e.setFocusable(!1)})}isTriggerKeyEvent(t){let e=!1;return this._triggerKeys.keys.forEach(i=>{e=e||t.equals(i)}),e}updateFocusedItem(){for(let t=0;t<this.actionsList.children.length;t++){let e=this.actionsList.children[t];if(Xi(An(),e)){this.focusedItem=t,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(t){this._context=t,this.viewItems.forEach(e=>e.setActionContext(t))}get actionRunner(){return this._actionRunner}set actionRunner(t){this._actionRunner=t,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(e=>this._onDidRun.fire(e))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(e=>this._onWillRun.fire(e))),this.viewItems.forEach(e=>e.actionRunner=t)}getContainer(){return this.domNode}hasAction(t){return this.viewItems.findIndex(e=>e.action.id===t.id)!==-1}getAction(t){if(typeof t=="number")return this.viewItems[t]?.action;if(Oi(t)){for(;t.parentElement!==this.actionsList;){if(!t.parentElement)return;t=t.parentElement}for(let e=0;e<this.actionsList.childNodes.length;e++)if(this.actionsList.childNodes[e]===t)return this.viewItems[e].action}}push(t,e={}){let i=Array.isArray(t)?t:[t],n=Vo(e.index)?e.index:null;i.forEach(o=>{let s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");let a,l={hoverDelegate:this._hoverDelegate,...e,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(o,l)),a||(a=new Nd(this.context,o,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,M(s,G.CONTEXT_MENU,d=>{Te.stop(d,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(s),this.focusable&&a instanceof zn&&this.viewItems.length===0&&a.setFocusable(!0),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(s),this.viewItems.push(a)):(this.actionsList.insertBefore(s,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(t){if(t>=0&&t<this.actionsList.children.length){let e=this.actionsList.children.item(t);if(e)return e.clientWidth}return 0}getHeight(t){if(t>=0&&t<this.actionsList.children.length){let e=this.actionsList.children.item(t);if(e)return e.clientHeight}return 0}pull(t){t>=0&&t<this.viewItems.length&&(this.actionsList.childNodes[t].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[t]),nt(this.viewItems.splice(t,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=nt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),ci(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(t){let e=!1,i;if(t===void 0?e=!0:typeof t=="number"?i=t:typeof t=="boolean"&&(e=t),e&&typeof this.focusedItem>"u"){let n=this.viewItems.findIndex(o=>o.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(t,e){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;let i=this.focusedItem,n;do{if(!t&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===pt.ID));return this.updateFocus(void 0,void 0,e),!0}focusPrevious(t){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;let e=this.focusedItem,i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!t&&this.options.preventLoopNavigation)return this.focusedItem=e,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==e&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===pt.ID));return this.updateFocus(!0),!0}updateFocus(t,e,i=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:e}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();let n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let o=!0;yg(n.focus)||(o=!1),this.options.focusOnlyEnabledItems&&yg(n.isEnabled)&&!n.isEnabled()&&(o=!1),n.action.id===pt.ID&&(o=!1),o?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(t),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:e}),this.previouslyFocusedItem=void 0),o&&n.showHover?.()}}doTrigger(t){if(typeof this.focusedItem>"u")return;let e=this.viewItems[this.focusedItem];if(e instanceof zn){let i=e._context===null||e._context===void 0?t:e._context;this.run(e._action,i)}}async run(t,e){await this._actionRunner.run(t,e)}dispose(){this._context=void 0,this.viewItems=nt(this.viewItems),this.getContainer().remove(),super.dispose()}};function Or(r){if(!r.length)return r;let t=-1;for(let i=0;i<r.length;i++)if(r[i].id!==pt.ID){t=i;break}if(t===-1)return[];r=r.slice(t);for(let i=r.length-1;i>=0&&r[i].id===pt.ID;i--)r.splice(i,1);let e=!1;for(let i=r.length-1;i>=0;i--){let n=r[i].id===pt.ID;n&&!e?r.splice(i,1):n?n&&(e=!1):e=!0}return r}var xle=h("caseDescription","Match Case"),_le=h("wordsDescription","Match Whole Word"),Dle=h("regexDescription","Use Regular Expression"),KA=class extends Od{constructor(t){super({icon:B.caseSensitive,title:xle+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??zt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},GA=class extends Od{constructor(t){super({icon:B.wholeWord,title:_le+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??zt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},qA=class extends Od{constructor(t){super({icon:B.regex,title:Dle+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??zt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}};var jA=class{constructor(t,e=0,i=t.length,n=e-1){this.items=t;this.start=e;this.end=i;this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}};var $A=class{_history;_limit;_navigator;constructor(t=[],e=10){this._initialize(t),this._limit=e,this._onChange()}getHistory(){return this._elements}add(t){this._history.delete(t),this._history.add(t),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isFirst(){return this._currentPosition()===0}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(t){return this._history.has(t)}clear(){this._initialize([]),this._onChange()}_onChange(){this._reduceToLimit();let t=this._elements;this._navigator=new jA(t,0,t.length,t.length)}_reduceToLimit(){let t=this._elements;t.length>this._limit&&this._initialize(t.slice(t.length-this._limit))}_currentPosition(){let t=this._navigator.current();return t?this._elements.indexOf(t):-1}_initialize(t){this._history=new Set;for(let e of t)this._history.add(e)}get _elements(){let t=[];return this._history.forEach(e=>t.push(e)),t}};var oT=re;var CX={inputBackground:"#3C3C3C",inputForeground:"#CCCCCC",inputValidationInfoBorder:"#55AAFF",inputValidationInfoBackground:"#063B49",inputValidationWarningBorder:"#B89500",inputValidationWarningBackground:"#352A05",inputValidationErrorBorder:"#BE1100",inputValidationErrorBackground:"#5A1D1D",inputBorder:void 0,inputValidationErrorForeground:void 0,inputValidationInfoForeground:void 0,inputValidationWarningForeground:void 0},YA=class extends eo{contextViewProvider;element;input;actionbar;options;message;placeholder;tooltip;ariaLabel;validation;state="idle";mirror;cachedHeight;cachedContentHeight;maxHeight=Number.POSITIVE_INFINITY;scrollableElement;hover;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_onDidHeightChange=this._register(new T);onDidHeightChange=this._onDidHeightChange.event;constructor(t,e,i){super(),this.contextViewProvider=e,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Ee(t,oT(".monaco-inputbox.idle"));let n=this.options.flexibleHeight?"textarea":"input",o=Ee(this.element,oT(".ibwrapper"));if(this.input=Ee(o,oT(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Ee(o,oT("div.mirror")),this.mirror.innerText="\xA0",this.scrollableElement=new Fy(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Ee(t,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));let s=this._register(new Ge(t.ownerDocument,"selectionchange")),a=O.filter(s.event,()=>t.ownerDocument.getSelection()?.anchorNode===o);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new gn(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(t){this.placeholder=t,this.input.setAttribute("placeholder",t)}setTooltip(t){this.tooltip=t,this.hover?this.hover.update(t):this.hover=this._register($n().setupManagedHover(zt("mouse"),this.input,t))}setAriaLabel(t){this.ariaLabel=t,t?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get mirrorElement(){return this.mirror}get inputElement(){return this.input}get value(){return this.input.value}set value(t){this.input.value!==t&&(this.input.value=t,this.onValueChange())}get step(){return this.input.step}set step(t){this.input.step=t}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:nk(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return os(this.input)}select(t=null){this.input.select(),t&&(this.input.setSelectionRange(t.start,t.end),t.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){let t=this.input.selectionStart;if(t===null)return null;let e=this.input.selectionEnd??t;return{start:t,end:e}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}setEnabled(t){t?this.enable():this.disable()}get width(){return Hv(this.input)}set width(t){if(this.options.flexibleHeight&&this.options.flexibleWidth){let e=0;if(this.mirror){let i=parseFloat(this.mirror.style.paddingLeft||"")||0,n=parseFloat(this.mirror.style.paddingRight||"")||0;e=i+n}this.input.style.width=t-e+"px"}else this.input.style.width=t+"px";this.mirror&&(this.mirror.style.width=t+"px")}set paddingRight(t){this.input.style.width=`calc(100% - ${t}px)`,this.mirror&&(this.mirror.style.paddingRight=t+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;let t=this.cachedContentHeight,e=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:t,height:e}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(t,e){if(this.state==="open"&&$t(this.message,t))return;this.message=t,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(t.type));let i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Is(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||e)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let t=null;return this.validation&&(t=this.validation(this.value),t?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(t)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),t?.type}stylesForType(t){let e=this.options.inputBoxStyles;switch(t){case 1:return{border:e.inputValidationInfoBorder,background:e.inputValidationInfoBackground,foreground:e.inputValidationInfoForeground};case 2:return{border:e.inputValidationWarningBorder,background:e.inputValidationWarningBackground,foreground:e.inputValidationWarningForeground};default:return{border:e.inputValidationErrorBorder,background:e.inputValidationErrorBackground,foreground:e.inputValidationErrorForeground}}}classForType(t){switch(t){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let t,e=()=>t.style.width=Hv(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;t=Ee(n,oT(".monaco-inputbox-container")),e();let o={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?uX(this.message.content,o):cX(this.message.content,o);s.classList.add(this.classForType(this.message.type));let a=this.stylesForType(this.message.type);return s.style.backgroundColor=a.background??"",s.style.color=a.foreground??"",s.style.border=a.border?`1px solid ${a.border}`:"",Ee(t,s),null},onHide:()=>{this.state="closed"},layout:e});let i;this.message.type===3?i=h("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=h("alertWarningMessage","Warning: {0}",this.message.content):i=h("alertInfoMessage","Info: {0}",this.message.content),Xc(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;let t=this.value,i=t.charCodeAt(t.length-1)===10?" ":"";(t+i).replace(/\u000c/g,"")?this.mirror.textContent=t+i:this.mirror.innerText="\xA0",this.layout()}applyStyles(){let t=this.options.inputBoxStyles,e=t.inputBackground??"",i=t.inputForeground??"",n=t.inputBorder??"";this.element.style.backgroundColor=e,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Is(n,"transparent")}`}layout(){if(!this.mirror)return;let t=this.cachedContentHeight;this.cachedContentHeight=nk(this.mirror),t!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(t){let e=this.inputElement,i=e.selectionStart,n=e.selectionEnd,o=e.value;i!==null&&n!==null&&(this.value=o.substr(0,i)+t+o.substr(n),e.setSelectionRange(i+1,i+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}},am=class extends YA{history;observer;_onDidFocus=this._register(new T);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new T);onDidBlur=this._onDidBlur.event;constructor(t,e,i){let n=h({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," or {0} for history","\u21C5"),o=h({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is \u21C5 to represent the up and down arrow keys.']}," ({0} for history)","\u21C5");super(t,e,i),this.history=new $A(i.history,100);let s=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(o)&&this.history.getHistory().length){let a=this.placeholder.endsWith(")")?n:o,l=this.placeholder+a;i.showPlaceholderOnFocus&&!os(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(d=>{d.target.textContent||s()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>s()),this.onblur(this.input,()=>{let a=l=>{if(this.placeholder.endsWith(l)){let d=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};a(o)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(t){this.value&&(t||this.value!==this.getCurrentValue())&&this.history.add(this.value)}prependHistory(t){let e=this.getHistory();this.clearHistory(),t.forEach(i=>{this.history.add(i)}),e.forEach(i=>{this.history.add(i)})}getHistory(){return this.history.getHistory()}isAtFirstInHistory(){return this.history.isFirst()}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let t=this.getNextValue();t&&(t=t===this.value?this.getNextValue():t),this.value=t??"",QE(this.value?this.value:h("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let t=this.getPreviousValue();t&&(t=t===this.value?this.getPreviousValue():t),t&&(this.value=t,QE(this.value))}clearHistory(){this.history.clear()}setPlaceHolder(t){super.setPlaceHolder(t),this.setTooltip(t)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let t=this.history.current();return t||(t=this.history.last(),this.history.next()),t}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}};var Lle=h("defaultLabel","input"),Gy=class extends eo{static OPTION_CHANGE="optionChange";placeholder;validation;label;showCommonFindToggles;fixFocusOnOptionClickEnabled=!0;imeSessionInProgress=!1;additionalTogglesDisposables=this._register(new mt);controls;regex;wholeWords;caseSensitive;additionalToggles=[];domNode;inputBox;_onDidOptionChange=this._register(new T);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new T);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new T);onMouseDown=this._onMouseDown.event;_onInput=this._register(new T);onInput=this._onInput.event;_onKeyUp=this._register(new T);onKeyUp=this._onKeyUp.event;_onCaseSensitiveKeyDown=this._register(new T);onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event;_onRegexKeyDown=this._register(new T);onRegexKeyDown=this._onRegexKeyDown.event;constructor(t,e,i){super(),this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||Lle,this.showCommonFindToggles=!!i.showCommonFindToggles;let n=i.appendCaseSensitiveLabel||"",o=i.appendWholeWordsLabel||"",s=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,d=!!i.flexibleWidth,c=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new am(this.domNode,e,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:i.inputBoxStyles}));let u=this._register(Ha());if(this.showCommonFindToggles){this.regex=this._register(new qA({appendTitle:s,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.regex.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(m=>{this._onRegexKeyDown.fire(m)})),this.wholeWords=this._register(new GA({appendTitle:o,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.wholeWords.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new KA({appendTitle:n,isChecked:!1,hoverDelegate:u,...i.toggleStyles})),this._register(this.caseSensitive.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(m=>{this._onCaseSensitiveKeyDown.fire(m)}));let p=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let g=p.indexOf(this.domNode.ownerDocument.activeElement);if(g>=0){let f=-1;m.equals(17)?f=(g+1)%p.length:m.equals(15)&&(g===0?f=p.length-1:f=g-1),m.equals(9)?(p[g].blur(),this.inputBox.focus()):f>=0&&p[f].focus(),Te.stop(m,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),t?.appendChild(this.domNode),this._register(M(this.inputBox.inputElement,"compositionstart",p=>{this.imeSessionInProgress=!0})),this._register(M(this.inputBox.inputElement,"compositionend",p=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,p=>this._onKeyDown.fire(p)),this.onkeyup(this.inputBox.inputElement,p=>this._onKeyUp.fire(p)),this.oninput(this.inputBox.inputElement,p=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,p=>this._onMouseDown.fire(p))}get isImeSessionInProgress(){return this.imeSessionInProgress}get onDidChange(){return this.inputBox.onDidChange}layout(t){this.inputBox.layout(),this.updateInputBoxPadding(t.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(let t of this.additionalToggles)t.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(let t of this.additionalToggles)t.disable()}setFocusInputOnOptionClick(t){this.fixFocusOnOptionClickEnabled=t}setEnabled(t){t?this.enable():this.disable()}setAdditionalToggles(t){for(let e of this.additionalToggles)e.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new W;for(let e of t??[])this.additionalTogglesDisposables.value.add(e),this.controls.appendChild(e.domNode),this.additionalTogglesDisposables.value.add(e.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(e);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(t=!1){t?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((e,i)=>e+i.width(),0)}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(t){this.inputBox.value!==t&&(this.inputBox.value=t)}onSearchSubmit(){this.inputBox.addToHistory()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(t){this.caseSensitive&&(this.caseSensitive.checked=t)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(t){this.wholeWords&&(this.wholeWords.checked=t)}getRegex(){return this.regex?.checked??!1}setRegex(t){this.regex&&(this.regex.checked=t,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}focusOnRegex(){this.regex?.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(t){this.inputBox.showMessage(t)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}};var cn=class extends Error{constructor(t,e){super(`TreeError [${t}] ${e}`)}},If=class{constructor(t){this.fn=t}_map=new WeakMap;map(t){let e=this._map.get(t);return e||(e=this.fn(t),this._map.set(t,e)),e}};var Fd=class{originalStart;originalLength;modifiedStart;modifiedLength;constructor(t,e,i,n){this.originalStart=t,this.originalLength=e,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}};var lm=class{static Assert(t,e){if(!t)throw new Error(e)}},dm=class{static Copy(t,e,i,n,o){for(let s=0;s<o;s++)i[n+s]=t[e+s]}static Copy2(t,e,i,n,o){for(let s=0;s<o;s++)i[n+s]=t[e+s]}};var ZA=class{m_changes;m_originalStart;m_modifiedStart;m_originalCount;m_modifiedCount;constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Fd(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(t,e){this.m_originalStart=Math.min(this.m_originalStart,t),this.m_modifiedStart=Math.min(this.m_modifiedStart,e),this.m_originalCount++}AddModifiedElement(t,e){this.m_originalStart=Math.min(this.m_originalStart,t),this.m_modifiedStart=Math.min(this.m_modifiedStart,e),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},rT=class r{ContinueProcessingPredicate;_originalSequence;_modifiedSequence;_hasStrings;_originalStringElements;_originalElementsOrHash;_modifiedStringElements;_modifiedElementsOrHash;m_forwardHistory;m_reverseHistory;constructor(t,e,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=t,this._modifiedSequence=e;let[n,o,s]=r._getElements(t),[a,l,d]=r._getElements(e);this._hasStrings=s&&d,this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(t){return t.length>0&&typeof t[0]=="string"}static _getElements(t){let e=t.getElements();if(r._isStringArray(e)){let i=new Int32Array(e.length);for(let n=0,o=e.length;n<o;n++)i[n]=XD(e[n],0);return[e,i,!0]}return e instanceof Int32Array?[[],e,!1]:[[],new Int32Array(e),!1]}ElementsAreEqual(t,e){return this._originalElementsOrHash[t]!==this._modifiedElementsOrHash[e]?!1:this._hasStrings?this._originalStringElements[t]===this._modifiedStringElements[e]:!0}ElementsAreStrictEqual(t,e){if(!this.ElementsAreEqual(t,e))return!1;let i=r._getStrictElement(this._originalSequence,t),n=r._getStrictElement(this._modifiedSequence,e);return i===n}static _getStrictElement(t,e){return typeof t.getStrictElement=="function"?t.getStrictElement(e):null}OriginalElementsAreEqual(t,e){return this._originalElementsOrHash[t]!==this._originalElementsOrHash[e]?!1:this._hasStrings?this._originalStringElements[t]===this._originalStringElements[e]:!0}ModifiedElementsAreEqual(t,e){return this._modifiedElementsOrHash[t]!==this._modifiedElementsOrHash[e]?!1:this._hasStrings?this._modifiedStringElements[t]===this._modifiedStringElements[e]:!0}ComputeDiff(t){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,t)}_ComputeDiff(t,e,i,n,o){let s=[!1],a=this.ComputeDiffRecursive(t,e,i,n,s);return o&&(a=this.PrettifyChanges(a)),{quitEarly:s[0],changes:a}}ComputeDiffRecursive(t,e,i,n,o){for(o[0]=!1;t<=e&&i<=n&&this.ElementsAreEqual(t,i);)t++,i++;for(;e>=t&&n>=i&&this.ElementsAreEqual(e,n);)e--,n--;if(t>e||i>n){let u;return i<=n?(lm.Assert(t===e+1,"originalStart should only be one more than originalEnd"),u=[new Fd(t,0,i,n-i+1)]):t<=e?(lm.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),u=[new Fd(t,e-t+1,i,0)]):(lm.Assert(t===e+1,"originalStart should only be one more than originalEnd"),lm.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}let s=[0],a=[0],l=this.ComputeRecursionPoint(t,e,i,n,s,a,o),d=s[0],c=a[0];if(l!==null)return l;if(!o[0]){let u=this.ComputeDiffRecursive(t,d,i,c,o),p=[];return o[0]?p=[new Fd(d+1,e-(d+1)+1,c+1,n-(c+1)+1)]:p=this.ComputeDiffRecursive(d+1,e,c+1,n,o),this.ConcatenateChanges(u,p)}return[new Fd(t,e-t+1,i,n-i+1)]}WALKTRACE(t,e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y,I){let E=null,S=null,w=new ZA,D=e,k=i,R=m[0]-b[0]-n,A=-1073741824,H=this.m_forwardHistory.length-1;do{let z=R+t;z===D||z<k&&d[z-1]<d[z+1]?(u=d[z+1],g=u-R-n,u<A&&w.MarkNextChange(),A=u,w.AddModifiedElement(u+1,g),R=z+1-t):(u=d[z-1]+1,g=u-R-n,u<A&&w.MarkNextChange(),A=u-1,w.AddOriginalElement(u,g+1),R=z-1-t),H>=0&&(d=this.m_forwardHistory[H],t=d[0],D=1,k=d.length-1)}while(--H>=-1);if(E=w.getReverseChanges(),I[0]){let z=m[0]+1,Z=b[0]+1;if(E!==null&&E.length>0){let fe=E[E.length-1];z=Math.max(z,fe.getOriginalEnd()),Z=Math.max(Z,fe.getModifiedEnd())}S=[new Fd(z,p-z+1,Z,f-Z+1)]}else{w=new ZA,D=s,k=a,R=m[0]-b[0]-l,A=1073741824,H=y?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let z=R+o;z===D||z<k&&c[z-1]>=c[z+1]?(u=c[z+1]-1,g=u-R-l,u>A&&w.MarkNextChange(),A=u+1,w.AddOriginalElement(u+1,g+1),R=z+1-o):(u=c[z-1],g=u-R-l,u>A&&w.MarkNextChange(),A=u,w.AddModifiedElement(u+1,g+1),R=z-1-o),H>=0&&(c=this.m_reverseHistory[H],o=c[0],D=1,k=c.length-1)}while(--H>=-1);S=w.getChanges()}return this.ConcatenateChanges(E,S)}ComputeRecursionPoint(t,e,i,n,o,s,a){let l=0,d=0,c=0,u=0,p=0,m=0;t--,i--,o[0]=0,s[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let g=e-t+(n-i),f=g+1,b=new Int32Array(f),y=new Int32Array(f),I=n-i,E=e-t,S=t-i,w=e-n,k=(E-I)%2===0;b[I]=t,y[E]=e,a[0]=!1;for(let R=1;R<=g/2+1;R++){let A=0,H=0;c=this.ClipDiagonalBound(I-R,R,I,f),u=this.ClipDiagonalBound(I+R,R,I,f);for(let Z=c;Z<=u;Z+=2){Z===c||Z<u&&b[Z-1]<b[Z+1]?l=b[Z+1]:l=b[Z-1]+1,d=l-(Z-I)-S;let fe=l;for(;l<e&&d<n&&this.ElementsAreEqual(l+1,d+1);)l++,d++;if(b[Z]=l,l+d>A+H&&(A=l,H=d),!k&&Math.abs(Z-E)<=R-1&&l>=y[Z])return o[0]=l,s[0]=d,fe<=y[Z]&&R<=1448?this.WALKTRACE(I,c,u,S,E,p,m,w,b,y,l,e,o,d,n,s,k,a):null}let z=(A-t+(H-i)-R)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(A,z))return a[0]=!0,o[0]=A,s[0]=H,z>0&&R<=1448?this.WALKTRACE(I,c,u,S,E,p,m,w,b,y,l,e,o,d,n,s,k,a):(t++,i++,[new Fd(t,e-t+1,i,n-i+1)]);p=this.ClipDiagonalBound(E-R,R,E,f),m=this.ClipDiagonalBound(E+R,R,E,f);for(let Z=p;Z<=m;Z+=2){Z===p||Z<m&&y[Z-1]>=y[Z+1]?l=y[Z+1]-1:l=y[Z-1],d=l-(Z-E)-w;let fe=l;for(;l>t&&d>i&&this.ElementsAreEqual(l,d);)l--,d--;if(y[Z]=l,k&&Math.abs(Z-I)<=R&&l<=b[Z])return o[0]=l,s[0]=d,fe>=b[Z]&&R<=1448?this.WALKTRACE(I,c,u,S,E,p,m,w,b,y,l,e,o,d,n,s,k,a):null}if(R<=1447){let Z=new Int32Array(u-c+2);Z[0]=I-c+1,dm.Copy2(b,c,Z,1,u-c+1),this.m_forwardHistory.push(Z),Z=new Int32Array(m-p+2),Z[0]=E-p+1,dm.Copy2(y,p,Z,1,m-p+1),this.m_reverseHistory.push(Z)}}return this.WALKTRACE(I,c,u,S,E,p,m,w,b,y,l,e,o,d,n,s,k,a)}PrettifyChanges(t){for(let e=0;e<t.length;e++){let i=t[e],n=e<t.length-1?t[e+1].originalStart:this._originalElementsOrHash.length,o=e<t.length-1?t[e+1].modifiedStart:this._modifiedElementsOrHash.length,s=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<o&&(!s||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){let d=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!d)break;i.originalStart++,i.modifiedStart++}let l=[null];if(e<t.length-1&&this.ChangesOverlap(t[e],t[e+1],l)){t[e]=l[0],t.splice(e+1,1),e--;continue}}for(let e=t.length-1;e>=0;e--){let i=t[e],n=0,o=0;if(e>0){let u=t[e-1];n=u.originalStart+u.originalLength,o=u.modifiedStart+u.modifiedLength}let s=i.originalLength>0,a=i.modifiedLength>0,l=0,d=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let u=1;;u++){let p=i.originalStart-u,m=i.modifiedStart-u;if(p<n||m<o||s&&!this.OriginalElementsAreEqual(p,p+i.originalLength)||a&&!this.ModifiedElementsAreEqual(m,m+i.modifiedLength))break;let f=(p===n&&m===o?5:0)+this._boundaryScore(p,i.originalLength,m,i.modifiedLength);f>d&&(d=f,l=u)}i.originalStart-=l,i.modifiedStart-=l;let c=[null];if(e>0&&this.ChangesOverlap(t[e-1],t[e],c)){t[e-1]=c[0],t.splice(e,1),e++;continue}}if(this._hasStrings)for(let e=1,i=t.length;e<i;e++){let n=t[e-1],o=t[e],s=o.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=o.originalStart+o.originalLength,d=l-a,c=n.modifiedStart,u=o.modifiedStart+o.modifiedLength,p=u-c;if(s<5&&d<20&&p<20){let m=this._findBetterContiguousSequence(a,d,c,p,s);if(m){let[g,f]=m;(g!==n.originalStart+n.originalLength||f!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=g-n.originalStart,n.modifiedLength=f-n.modifiedStart,o.originalStart=g+s,o.modifiedStart=f+s,o.originalLength=l-o.originalStart,o.modifiedLength=u-o.modifiedStart)}}}return t}_findBetterContiguousSequence(t,e,i,n,o){if(e<o||n<o)return null;let s=t+e-o+1,a=i+n-o+1,l=0,d=0,c=0;for(let u=t;u<s;u++)for(let p=i;p<a;p++){let m=this._contiguousSequenceScore(u,p,o);m>0&&m>l&&(l=m,d=u,c=p)}return l>0?[d,c]:null}_contiguousSequenceScore(t,e,i){let n=0;for(let o=0;o<i;o++){if(!this.ElementsAreEqual(t+o,e+o))return 0;n+=this._originalStringElements[t+o].length}return n}_OriginalIsBoundary(t){return t<=0||t>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[t])}_OriginalRegionIsBoundary(t,e){if(this._OriginalIsBoundary(t)||this._OriginalIsBoundary(t-1))return!0;if(e>0){let i=t+e;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(t){return t<=0||t>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[t])}_ModifiedRegionIsBoundary(t,e){if(this._ModifiedIsBoundary(t)||this._ModifiedIsBoundary(t-1))return!0;if(e>0){let i=t+e;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(t,e,i,n){let o=this._OriginalRegionIsBoundary(t,e)?1:0,s=this._ModifiedRegionIsBoundary(i,n)?1:0;return o+s}ConcatenateChanges(t,e){let i=[];if(t.length===0||e.length===0)return e.length>0?e:t;if(this.ChangesOverlap(t[t.length-1],e[0],i)){let n=new Array(t.length+e.length-1);return dm.Copy(t,0,n,0,t.length-1),n[t.length-1]=i[0],dm.Copy(e,1,n,t.length,e.length-1),n}else{let n=new Array(t.length+e.length);return dm.Copy(t,0,n,0,t.length),dm.Copy(e,0,n,t.length,e.length),n}}ChangesOverlap(t,e,i){if(lm.Assert(t.originalStart<=e.originalStart,"Left change is not less than or equal to right change"),lm.Assert(t.modifiedStart<=e.modifiedStart,"Left change is not less than or equal to right change"),t.originalStart+t.originalLength>=e.originalStart||t.modifiedStart+t.modifiedLength>=e.modifiedStart){let n=t.originalStart,o=t.originalLength,s=t.modifiedStart,a=t.modifiedLength;return t.originalStart+t.originalLength>=e.originalStart&&(o=e.originalStart+e.originalLength-t.originalStart),t.modifiedStart+t.modifiedLength>=e.modifiedStart&&(a=e.modifiedStart+e.modifiedLength-t.modifiedStart),i[0]=new Fd(n,o,s,a),!0}else return i[0]=null,!1}ClipDiagonalBound(t,e,i,n){if(t>=0&&t<n)return t;let o=i,s=n-i-1,a=e%2===0;if(t<0){let l=o%2===0;return a===l?0:1}else{let l=s%2===0;return a===l?n-1:n-2}}};function sT(r){return typeof r=="object"&&"visibility"in r&&"data"in r}function Cf(r){switch(r){case!0:return 1;case!1:return 0;default:return r}}function W2(r){return typeof r.collapsible=="boolean"}var XA=class{constructor(t,e,i={}){this.user=t;this.collapseByDefault=typeof i.collapseByDefault>"u"?!1:i.collapseByDefault,this.allowNonCollapsibleParents=i.allowNonCollapsibleParents??!1,this.filter=i.filter,this.autoExpandSingleChildren=typeof i.autoExpandSingleChildren>"u"?!1:i.autoExpandSingleChildren,this.root={parent:void 0,element:e,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}rootRef=[];root;eventBufferer=new mh;_onDidSpliceModel=new T;onDidSpliceModel=this._onDidSpliceModel.event;_onDidSpliceRenderedNodes=new T;onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event;_onDidChangeCollapseState=new T;onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event);_onDidChangeRenderNodeCount=new T;onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event);collapseByDefault;allowNonCollapsibleParents;filter;autoExpandSingleChildren;refilterDelayer=new bs(iD);splice(t,e,i=Lt.empty(),n={}){if(t.length===0)throw new cn(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,t,e,i,n):this.spliceSimple(t,e,i,n)}spliceSmart(t,e,i,n=Lt.empty(),o,s=o.diffDepth??0){let{parentNode:a}=this.getParentNodeWithListIndex(e);if(!a.lastDiffIds)return this.spliceSimple(e,i,n,o);let l=[...n],d=e[e.length-1],c=new rT({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,d),...l,...a.children.slice(d+i)].map(f=>t.getId(f.element).toString())}).ComputeDiff(!1);if(c.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(e,i,l,o);let u=e.slice(0,-1),p=(f,b,y)=>{if(s>0)for(let I=0;I<y;I++)f--,b--,this.spliceSmart(t,[...u,f,0],Number.MAX_SAFE_INTEGER,l[b].children,o,s-1)},m=Math.min(a.children.length,d+i),g=l.length;for(let f of c.changes.sort((b,y)=>y.originalStart-b.originalStart))p(m,g,m-(f.originalStart+f.originalLength)),m=f.originalStart,g=f.modifiedStart-d,this.spliceSimple([...u,m],f.originalLength,Lt.slice(l,g,g+f.modifiedLength),o);p(m,g,m)}spliceSimple(t,e,i=Lt.empty(),{onDidCreateNode:n,onDidDeleteNode:o,diffIdentityProvider:s}){let{parentNode:a,listIndex:l,revealed:d,visible:c}=this.getParentNodeWithListIndex(t),u=[],p=Lt.map(i,w=>this.createTreeNode(w,a,a.visible?1:0,d,u,n)),m=t[t.length-1],g=0;for(let w=m;w>=0&&w<a.children.length;w--){let D=a.children[w];if(D.visible){g=D.visibleChildIndex;break}}let f=[],b=0,y=0;for(let w of p)f.push(w),y+=w.renderNodeCount,w.visible&&(w.visibleChildIndex=g+b++);let I=JF(a.children,m,e,f);s?a.lastDiffIds?JF(a.lastDiffIds,m,e,f.map(w=>s.getId(w.element).toString())):a.lastDiffIds=a.children.map(w=>s.getId(w.element).toString()):a.lastDiffIds=void 0;let E=0;for(let w of I)w.visible&&E++;if(E!==0)for(let w=m+f.length;w<a.children.length;w++){let D=a.children[w];D.visible&&(D.visibleChildIndex-=E)}if(a.visibleChildrenCount+=b-E,d&&c){let w=I.reduce((D,k)=>D+(k.visible?k.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,y-w),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:w,elements:u})}if(I.length>0&&o){let w=D=>{o(D),D.children.forEach(w)};I.forEach(w)}this._onDidSpliceModel.fire({insertedNodes:f,deletedNodes:I});let S=a;for(;S;){if(S.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}S=S.parent}}rerender(t){if(t.length===0)throw new cn(this.user,"Invalid tree location");let{node:e,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(t);e.visible&&n&&this._onDidSpliceRenderedNodes.fire({start:i,deleteCount:1,elements:[e]})}has(t){return this.hasTreeNode(t)}getListIndex(t){let{listIndex:e,visible:i,revealed:n}=this.getTreeNodeWithListIndex(t);return i&&n?e:-1}getListRenderCount(t){return this.getTreeNode(t).renderNodeCount}isCollapsible(t){return this.getTreeNode(t).collapsible}setCollapsible(t,e){let i=this.getTreeNode(t);typeof e>"u"&&(e=!i.collapsible);let n={collapsible:e};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(t,n))}isCollapsed(t){return this.getTreeNode(t).collapsed}setCollapsed(t,e,i){let n=this.getTreeNode(t);typeof e>"u"&&(e=!n.collapsed);let o={collapsed:e,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(t,o))}_setCollapseState(t,e){let{node:i,listIndex:n,revealed:o}=this.getTreeNodeWithListIndex(t),s=this._setListNodeCollapseState(i,n,o,e);if(i!==this.root&&this.autoExpandSingleChildren&&s&&!W2(e)&&i.collapsible&&!i.collapsed&&!e.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...t,a],e)}return s}_setListNodeCollapseState(t,e,i,n){let o=this._setNodeCollapseState(t,n,!1);if(!i||!t.visible||!o)return o;let s=t.renderNodeCount,a=this.updateNodeAfterCollapseChange(t),l=s-(e===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:e+1,deleteCount:l,elements:a.slice(1)}),o}_setNodeCollapseState(t,e,i){let n;if(t===this.root?n=!1:(W2(e)?(n=t.collapsible!==e.collapsible,t.collapsible=e.collapsible):t.collapsible?(n=t.collapsed!==e.collapsed,t.collapsed=e.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:t,deep:i})),!W2(e)&&e.recursive)for(let o of t.children)n=this._setNodeCollapseState(o,e,!0)||n;return n}expandTo(t){this.eventBufferer.bufferEvents(()=>{let e=this.getTreeNode(t);for(;e.parent;)e=e.parent,t=t.slice(0,t.length-1),e.collapsed&&this._setCollapseState(t,{collapsed:!1,recursive:!1})})}refilter(){let t=this.root.renderNodeCount,e=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:t,elements:e}),this.refilterDelayer.cancel()}createTreeNode(t,e,i,n,o,s){let a={parent:e,element:t.element,children:[],depth:e.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof t.collapsible=="boolean"?t.collapsible:typeof t.collapsed<"u",collapsed:typeof t.collapsed>"u"?this.collapseByDefault:t.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&o.push(a);let d=t.children||Lt.empty(),c=n&&l!==0&&!a.collapsed,u=0,p=1;for(let m of d){let g=this.createTreeNode(m,a,l,c,o,s);a.children.push(g),p+=g.renderNodeCount,g.visible&&(g.visibleChildIndex=u++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=u,a.visible=l===2?u>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=p):(a.renderNodeCount=0,n&&o.pop()),s?.(a),a}updateNodeAfterCollapseChange(t){let e=t.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(t,i),this._updateAncestorsRenderNodeCount(t.parent,i.length-e),i}_updateNodeAfterCollapseChange(t,e){if(t.visible===!1)return 0;if(e.push(t),t.renderNodeCount=1,!t.collapsed)for(let i of t.children)t.renderNodeCount+=this._updateNodeAfterCollapseChange(i,e);return this._onDidChangeRenderNodeCount.fire(t),t.renderNodeCount}updateNodeAfterFilterChange(t){let e=t.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(t,t.visible?1:0,i),this._updateAncestorsRenderNodeCount(t.parent,i.length-e),i}_updateNodeAfterFilterChange(t,e,i,n=!0){let o;if(t!==this.root){if(o=this._filterNode(t,e),o===0)return t.visible=!1,t.renderNodeCount=0,!1;n&&i.push(t)}let s=i.length;t.renderNodeCount=t===this.root?0:1;let a=!1;if(!t.collapsed||o!==0){let l=0;for(let d of t.children)a=this._updateNodeAfterFilterChange(d,o,i,n&&!t.collapsed)||a,d.visible&&(d.visibleChildIndex=l++);t.visibleChildrenCount=l}else t.visibleChildrenCount=0;return t!==this.root&&(t.visible=o===2?a:o===1,t.visibility=o),t.visible?t.collapsed||(t.renderNodeCount+=i.length-s):(t.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(t),t.visible}_updateAncestorsRenderNodeCount(t,e){if(e!==0)for(;t;)t.renderNodeCount+=e,this._onDidChangeRenderNodeCount.fire(t),t=t.parent}_filterNode(t,e){let i=this.filter?this.filter.filter(t.element,e):1;return typeof i=="boolean"?(t.filterData=void 0,i?1:0):sT(i)?(t.filterData=i.data,Cf(i.visibility)):(t.filterData=void 0,Cf(i))}hasTreeNode(t,e=this.root){if(!t||t.length===0)return!0;let[i,...n]=t;return i<0||i>e.children.length?!1:this.hasTreeNode(n,e.children[i])}getTreeNode(t,e=this.root){if(!t||t.length===0)return e;let[i,...n]=t;if(i<0||i>e.children.length)throw new cn(this.user,"Invalid tree location");return this.getTreeNode(n,e.children[i])}getTreeNodeWithListIndex(t){if(t.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};let{parentNode:e,listIndex:i,revealed:n,visible:o}=this.getParentNodeWithListIndex(t),s=t[t.length-1];if(s<0||s>e.children.length)throw new cn(this.user,"Invalid tree location");let a=e.children[s];return{node:a,listIndex:i,revealed:n,visible:o&&a.visible}}getParentNodeWithListIndex(t,e=this.root,i=0,n=!0,o=!0){let[s,...a]=t;if(s<0||s>e.children.length)throw new cn(this.user,"Invalid tree location");for(let l=0;l<s;l++)i+=e.children[l].renderNodeCount;return n=n&&!e.collapsed,o=o&&e.visible,a.length===0?{parentNode:e,listIndex:i,revealed:n,visible:o}:this.getParentNodeWithListIndex(a,e.children[s],i+1,n,o)}getNode(t=[]){return this.getTreeNode(t)}getNodeLocation(t){let e=[],i=t;for(;i.parent;)e.push(i.parent.children.indexOf(i)),i=i.parent;return e.reverse()}getParentNodeLocation(t){if(t.length!==0)return t.length===1?[]:Dn(t)[0]}getFirstElementChild(t){let e=this.getTreeNode(t);if(e.children.length!==0)return e.children[0].element}getLastElementAncestor(t=[]){let e=this.getTreeNode(t);if(e.children.length!==0)return this._getLastElementAncestor(e)}_getLastElementAncestor(t){return t.children.length===0?t.element:this._getLastElementAncestor(t.children[t.children.length-1])}};var H2=class extends Dp{constructor(e){super(e.elements.map(i=>i.element));this.data=e}set context(e){this.data.context=e}get context(){return this.data.context}};function U2(r){return r instanceof Dp?new H2(r):r}var z2=class{constructor(t,e){this.modelProvider=t;this.dnd=e}autoExpandNode;autoExpandDisposable=L.None;disposables=new W;getDragURI(t){return this.dnd.getDragURI(t.element)}getDragLabel(t,e){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t.map(i=>i.element),e)}onDragStart(t,e){this.dnd.onDragStart?.(U2(t),e)}onDragOver(t,e,i,n,o,s=!0){let a=this.dnd.onDragOver(U2(t),e&&e.element,i,n,o),l=this.autoExpandNode!==e;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=e),typeof e>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=pw(()=>{let m=this.modelProvider(),g=m.getNodeLocation(e);m.isCollapsed(g)&&m.setCollapsed(g,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!s){let m=typeof a=="boolean"?a:a.accept,g=typeof a=="boolean"?void 0:a.effect;return{accept:m,effect:g,feedback:[i]}}return a}if(a.bubble===1){let m=this.modelProvider(),g=m.getNodeLocation(e),f=m.getParentNodeLocation(g),b=m.getNode(f),y=f&&m.getListIndex(f);return this.onDragOver(t,b,y,n,o,!1)}let d=this.modelProvider(),c=d.getNodeLocation(e),u=d.getListIndex(c),p=d.getListRenderCount(c);return{...a,feedback:Io(u,u+p)}}drop(t,e,i,n,o){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(U2(t),e&&e.element,i,n,o)}onDragEnd(t){this.dnd.onDragEnd?.(t)}dispose(){this.disposables.dispose(),this.dnd.dispose()}};function kle(r,t){return t&&{...t,identityProvider:t.identityProvider&&{getId(e){return t.identityProvider.getId(e.element)}},dnd:t.dnd&&new z2(r,t.dnd),multipleSelectionController:t.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return t.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return t.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:t.accessibilityProvider&&{...t.accessibilityProvider,getSetSize(e){let i=r(),n=i.getNodeLocation(e),o=i.getParentNodeLocation(n);return i.getNode(o).visibleChildrenCount},getPosInSet(e){return e.visibleChildIndex+1},isChecked:t.accessibilityProvider&&t.accessibilityProvider.isChecked?e=>t.accessibilityProvider.isChecked(e.element):void 0,getRole:t.accessibilityProvider&&t.accessibilityProvider.getRole?e=>t.accessibilityProvider.getRole(e.element):()=>"treeitem",getAriaLabel(e){return t.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return t.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:t.accessibilityProvider&&t.accessibilityProvider.getWidgetRole?()=>t.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:t.accessibilityProvider&&t.accessibilityProvider.getAriaLevel?e=>t.accessibilityProvider.getAriaLevel(e.element):e=>e.depth,getActiveDescendantId:t.accessibilityProvider.getActiveDescendantId&&(e=>t.accessibilityProvider.getActiveDescendantId(e.element))},keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}}}}var jy=class{constructor(t){this.delegate=t}getHeight(t){return this.delegate.getHeight(t.element)}getTemplateId(t){return this.delegate.getTemplateId(t.element)}hasDynamicHeight(t){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(t.element)}setDynamicHeight(t,e){this.delegate.setDynamicHeight?.(t.element,e)}},K2=class r{focus;selection;expanded;scrollTop;static lift(t){return t instanceof r?t:new r(t)}static empty(t=0){return new r({focus:[],selection:[],expanded:Object.create(null),scrollTop:t})}constructor(t){if(this.focus=new Set(t.focus),this.selection=new Set(t.selection),t.expanded instanceof Array){this.expanded=Object.create(null);for(let e of t.expanded)this.expanded[e]=1}else this.expanded=t.expanded;this.expanded=t.expanded,this.scrollTop=t.scrollTop}toJSON(){return{focus:Array.from(this.focus),selection:Array.from(this.selection),expanded:this.expanded,scrollTop:this.scrollTop}}};var G2=class{constructor(t,e=[]){this._elements=e;this.onDidChange=O.forEach(t,i=>this._elements=i,this.disposables)}disposables=new W;onDidChange;get elements(){return this._elements}dispose(){this.disposables.dispose()}},q2=class r{constructor(t,e,i,n,o,s={}){this.renderer=t;this.model=e;this.activeNodes=n;this.renderedIndentGuides=o;this.templateId=t.templateId,this.updateOptions(s),O.map(i,a=>a.node)(this.onDidChangeNodeTwistieState,this,this.disposables),t.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}static DefaultIndent=8;templateId;renderedElements=new Map;renderedNodes=new Map;indent=r.DefaultIndent;hideTwistiesOfChildlessElements=!1;shouldRenderIndentGuides=!1;activeIndentNodes=new Set;indentGuidesDisposable=L.None;disposables=new W;updateOptions(t={}){if(typeof t.indent<"u"){let e=sr(t.indent,0,40);if(e!==this.indent){this.indent=e;for(let[i,n]of this.renderedNodes)this.renderTreeElement(i,n)}}if(typeof t.renderIndentGuides<"u"){let e=t.renderIndentGuides!=="none";if(e!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=e;for(let[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),e){let i=new W;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof t.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=t.hideTwistiesOfChildlessElements)}renderTemplate(t){let e=Ee(t,re(".monaco-tl-row")),i=Ee(e,re(".monaco-tl-indent")),n=Ee(e,re(".monaco-tl-twistie")),o=Ee(e,re(".monaco-tl-contents")),s=this.renderer.renderTemplate(o);return{container:t,indent:i,twistie:n,indentGuidesDisposable:L.None,templateData:s}}renderElement(t,e,i,n){this.renderedNodes.set(t,i),this.renderedElements.set(t.element,t),this.renderTreeElement(t,i),this.renderer.renderElement(t,e,i.templateData,n)}disposeElement(t,e,i,n){i.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(t,e,i.templateData,n),typeof n=="number"&&(this.renderedNodes.delete(t),this.renderedElements.delete(t.element))}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}onDidChangeTwistieState(t){let e=this.renderedElements.get(t);e&&this.onDidChangeNodeTwistieState(e)}onDidChangeNodeTwistieState(t){let e=this.renderedNodes.get(t);e&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(t,e))}renderTreeElement(t,e){let i=r.DefaultIndent+(t.depth-1)*this.indent;e.twistie.style.paddingLeft=`${i}px`,e.indent.style.width=`${i+this.indent-16}px`,t.collapsible?e.container.setAttribute("aria-expanded",String(!t.collapsed)):e.container.removeAttribute("aria-expanded"),e.twistie.classList.remove(...ye.asClassNameArray(B.treeItemExpanded));let n=!1;this.renderer.renderTwistie&&(n=this.renderer.renderTwistie(t.element,e.twistie)),t.collapsible&&(!this.hideTwistiesOfChildlessElements||t.visibleChildrenCount>0)?(n||e.twistie.classList.add(...ye.asClassNameArray(B.treeItemExpanded)),e.twistie.classList.add("collapsible"),e.twistie.classList.toggle("collapsed",t.collapsed)):e.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(t,e)}_renderIndentGuides(t,e){if(ci(e.indent),e.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;let i=new W;for(;;){let n=this.model.getNodeLocation(t),o=this.model.getParentNodeLocation(n);if(!o)break;let s=this.model.getNode(o),a=re(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(s)&&a.classList.add("active"),e.indent.childElementCount===0?e.indent.appendChild(a):e.indent.insertBefore(a,e.indent.firstElementChild),this.renderedIndentGuides.add(s,a),i.add(te(()=>this.renderedIndentGuides.delete(s,a))),t=s}e.indentGuidesDisposable=i}_onDidChangeActiveNodes(t){if(!this.shouldRenderIndentGuides)return;let e=new Set;t.forEach(i=>{let n=this.model.getNodeLocation(i);try{let o=this.model.getParentNodeLocation(n);i.collapsible&&i.children.length>0&&!i.collapsed?e.add(i):o&&e.add(this.model.getNode(o))}catch{}}),this.activeIndentNodes.forEach(i=>{e.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.remove("active"))}),e.forEach(i=>{this.activeIndentNodes.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.add("active"))}),this.activeIndentNodes=e}setModel(t){this.model=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),nt(this.disposables)}},j2=class{constructor(t,e,i){this.tree=t;this.keyboardNavigationLabelProvider=e;this._filter=i;t.onWillRefilter(this.reset,this,this.disposables)}_totalCount=0;get totalCount(){return this._totalCount}_matchCount=0;get matchCount(){return this._matchCount}_pattern="";_lowercasePattern="";disposables=new W;set pattern(t){this._pattern=t,this._lowercasePattern=t.toLowerCase()}filter(t,e){let i=1;if(this._filter){let s=this._filter.filter(t,e);if(typeof s=="boolean"?i=s?1:0:sT(s)?i=Cf(s.visibility):i=s,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:Lg.Default,visibility:i};let n=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t),o=Array.isArray(n)?n:[n];for(let s of o){let a=s&&s.toString();if(typeof a>"u")return{data:Lg.Default,visibility:i};let l;if(this.tree.findMatchType===1){let d=a.toLowerCase().indexOf(this._lowercasePattern);if(d>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let c=this._lowercasePattern.length;c>0;c--)l.push(d+c-1)}}else l=WD(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,o.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===1?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(t):2:{data:Lg.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){nt(this.disposables)}},$2=class extends Od{constructor(t){super({icon:B.listFilter,title:h("filter","Filter"),isChecked:t.isChecked??!1,hoverDelegate:t.hoverDelegate??zt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},Y2=class extends Od{constructor(t){super({icon:B.searchFuzzy,title:h("fuzzySearch","Fuzzy Match"),isChecked:t.isChecked??!1,hoverDelegate:t.hoverDelegate??zt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},Rle={inputBoxStyles:CX,toggleStyles:IX,listFilterWidgetBackground:void 0,listFilterWidgetNoMatchesOutline:void 0,listFilterWidgetOutline:void 0,listFilterWidgetShadow:void 0};var Z2=class extends L{constructor(e,i,n,o,s,a){super();this.tree=i;e.appendChild(this.elements.root),this._register(te(()=>this.elements.root.remove()));let l=a?.styles??Rle;l.listFilterWidgetBackground&&(this.elements.root.style.backgroundColor=l.listFilterWidgetBackground),l.listFilterWidgetShadow&&(this.elements.root.style.boxShadow=`0 0 8px 2px ${l.listFilterWidgetShadow}`);let d=this._register(Ha());this.modeToggle=this._register(new $2({...l.toggleStyles,isChecked:o===1,hoverDelegate:d})),this.matchTypeToggle=this._register(new Y2({...l.toggleStyles,isChecked:s===0,hoverDelegate:d})),this.onDidChangeMode=O.map(this.modeToggle.onChange,()=>this.modeToggle.checked?1:0,this._store),this.onDidChangeMatchType=O.map(this.matchTypeToggle.onChange,()=>this.matchTypeToggle.checked?0:1,this._store),this.findInput=this._register(new Gy(this.elements.findInput,n,{label:h("type to search","Type to search"),additionalToggles:[this.modeToggle,this.matchTypeToggle],showCommonFindToggles:!1,inputBoxStyles:l.inputBoxStyles,toggleStyles:l.toggleStyles,history:a?.history})),this.actionbar=this._register(new gn(this.elements.actionbar)),this.mode=o;let c=this._register(new Ge(this.findInput.inputBox.inputElement,"keydown")),u=O.chain(c.event,f=>f.map(b=>new st(b)));this._register(u(f=>{if(f.equals(3)){f.preventDefault(),f.stopPropagation(),this.findInput.inputBox.addToHistory(),this.tree.domFocus();return}if(f.equals(18)){f.preventDefault(),f.stopPropagation(),this.findInput.inputBox.isAtLastInHistory()||this.findInput.inputBox.isNowhereInHistory()?(this.findInput.inputBox.addToHistory(),this.tree.domFocus()):this.findInput.inputBox.showNextValue();return}if(f.equals(16)){f.preventDefault(),f.stopPropagation(),this.findInput.inputBox.showPreviousValue();return}}));let p=this._register(new ot("close",h("close","Close"),"codicon codicon-close",!0,()=>this.dispose()));this.actionbar.push(p,{icon:!0,label:!1});let m=this._register(new Ge(this.elements.grab,"mousedown"));this._register(m.event(f=>{let b=new W,y=b.add(new Ge(oe(f),"mousemove")),I=b.add(new Ge(oe(f),"mouseup")),E=this.right,S=f.pageX,w=this.top,D=f.pageY;this.elements.grab.classList.add("grabbing");let k=this.elements.root.style.transition;this.elements.root.style.transition="unset";let R=A=>{let H=A.pageX-S;this.right=E-H;let z=A.pageY-D;this.top=w+z,this.layout()};b.add(y.event(R)),b.add(I.event(A=>{R(A),this.elements.grab.classList.remove("grabbing"),this.elements.root.style.transition=k,b.dispose()}))}));let g=O.chain(this._register(new Ge(this.elements.grab,"keydown")).event,f=>f.map(b=>new st(b)));this._register(g(f=>{let b,y;if(f.keyCode===15?b=Number.POSITIVE_INFINITY:f.keyCode===17?b=0:f.keyCode===10&&(b=this.right===0?Number.POSITIVE_INFINITY:0),f.keyCode===16?y=0:f.keyCode===18&&(y=Number.POSITIVE_INFINITY),b!==void 0&&(f.preventDefault(),f.stopPropagation(),this.right=b,this.layout()),y!==void 0){f.preventDefault(),f.stopPropagation(),this.top=y;let I=this.elements.root.style.transition;this.elements.root.style.transition="unset",this.layout(),setTimeout(()=>{this.elements.root.style.transition=I},0)}})),this.onDidChangeValue=this.findInput.onDidChange}elements=gi(".monaco-tree-type-filter",[gi(".monaco-tree-type-filter-grab.codicon.codicon-debug-gripper@grab",{tabIndex:0}),gi(".monaco-tree-type-filter-input@findInput"),gi(".monaco-tree-type-filter-actionbar@actionbar")]);set mode(e){this.modeToggle.checked=e===1,this.findInput.inputBox.setPlaceHolder(e===1?h("type to filter","Type to filter"):h("type to search","Type to search"))}set matchType(e){this.matchTypeToggle.checked=e===0}get value(){return this.findInput.inputBox.value}set value(e){this.findInput.inputBox.value=e}modeToggle;matchTypeToggle;findInput;actionbar;width=0;right=0;top=0;_onDidDisable=new T;onDidDisable=this._onDidDisable.event;onDidChangeValue;onDidChangeMode;onDidChangeMatchType;getHistory(){return this.findInput.inputBox.getHistory()}focus(){this.findInput.focus()}select(){this.findInput.select(),this.findInput.inputBox.addToHistory(!0)}layout(e=this.width){this.width=e,this.right=sr(this.right,0,Math.max(0,e-212)),this.elements.root.style.right=`${this.right}px`,this.top=sr(this.top,0,24),this.elements.root.style.top=`${this.top}px`}showMessage(e){this.findInput.showMessage(e)}clearMessage(){this.findInput.clearMessage()}async dispose(){this._onDidDisable.fire(),this.elements.root.classList.add("disabled"),await Sn(300),super.dispose()}},X2=class{constructor(t,e,i,n,o={}){this.tree=t;this.view=e;this.filter=i;this.contextViewProvider=n;this.options=o;this._mode=t.options.defaultFindMode??0,this._matchType=t.options.defaultFindMatchType??0}_history;_pattern="";get pattern(){return this._pattern}previousPattern="";_mode;get mode(){return this._mode}set mode(t){t!==this._mode&&(this._mode=t,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(t))}_matchType;get matchType(){return this._matchType}set matchType(t){t!==this._matchType&&(this._matchType=t,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(t))}widget;width=0;_onDidChangeMode=new T;onDidChangeMode=this._onDidChangeMode.event;_onDidChangeMatchType=new T;onDidChangeMatchType=this._onDidChangeMatchType.event;_onDidChangePattern=new T;onDidChangePattern=this._onDidChangePattern.event;_onDidChangeOpenState=new T;onDidChangeOpenState=this._onDidChangeOpenState.event;enabledDisposables=new W;disposables=new W;updateOptions(t={}){t.defaultFindMode!==void 0&&(this.mode=t.defaultFindMode),t.defaultFindMatchType!==void 0&&(this.matchType=t.defaultFindMatchType)}isOpened(){return!!this.widget}open(){if(this.widget){this.widget.focus(),this.widget.select();return}this.widget=new Z2(this.view.getHTMLElement(),this.tree,this.contextViewProvider,this.mode,this.matchType,{...this.options,history:this._history}),this.enabledDisposables.add(this.widget),this.widget.onDidChangeValue(this.onDidChangeValue,this,this.enabledDisposables),this.widget.onDidChangeMode(t=>this.mode=t,void 0,this.enabledDisposables),this.widget.onDidChangeMatchType(t=>this.matchType=t,void 0,this.enabledDisposables),this.widget.onDidDisable(this.close,this,this.enabledDisposables),this.widget.layout(this.width),this.widget.focus(),this.widget.value=this.previousPattern,this.widget.select(),this._onDidChangeOpenState.fire(!0)}close(){this.widget&&(this._history=this.widget.getHistory(),this.widget=void 0,this.enabledDisposables.clear(),this.previousPattern=this.pattern,this.onDidChangeValue(""),this.tree.domFocus(),this._onDidChangeOpenState.fire(!1))}onDidChangeValue(t){this._pattern=t,this._onDidChangePattern.fire(t),this.filter.pattern=t,this.tree.refilter(),t&&this.tree.focusNext(0,!0,void 0,i=>!Lg.isDefault(i.filterData));let e=this.tree.getFocus();if(e.length>0){let i=e[0];this.tree.getRelativeTop(i)===null&&this.tree.reveal(i,.5)}this.render()}render(){let t=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&t?(Xc(h("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:h("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&Xc(h("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(t){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Lg.isDefault(t.filterData)}layout(t){this.width=t,this.widget?.layout(t)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function Ale(r,t){return r.position===t.position&&wX(r,t)}function wX(r,t){return r.node.element===t.node.element&&r.startIndex===t.startIndex&&r.height===t.height&&r.endIndex===t.endIndex}var Q2=class{constructor(t=[]){this.stickyNodes=t}get count(){return this.stickyNodes.length}equal(t){return ti(this.stickyNodes,t.stickyNodes,Ale)}lastNodePartiallyVisible(){if(this.count===0)return!1;let t=this.stickyNodes[this.count-1];if(this.count===1)return t.position!==0;let e=this.stickyNodes[this.count-2];return e.position+e.height!==t.position}animationStateChanged(t){if(!ti(this.stickyNodes,t.stickyNodes,wX)||this.count===0)return!1;let e=this.stickyNodes[this.count-1],i=t.stickyNodes[t.count-1];return e.position!==i.position}},J2=class{constrainStickyScrollNodes(t,e,i){for(let n=0;n<t.length;n++){let o=t[n];if(o.position+o.height>i||n>=e)return t.slice(0,n)}return t}},JA=class extends L{constructor(e,i,n,o,s,a={}){super();this.tree=e;this.model=i;this.view=n;this.treeDelegate=s;let l=this.validateStickySettings(a);this.stickyScrollMaxItemCount=l.stickyScrollMaxItemCount,this.stickyScrollDelegate=a.stickyScrollDelegate??new J2,this._widget=this._register(new ez(n.getScrollableElement(),n,e,o,s,a.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(n.onDidScroll(()=>this.update())),this._register(n.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this.update()}onDidChangeHasFocus;onContextMenu;stickyScrollDelegate;stickyScrollMaxItemCount;maxWidgetViewRatio=.4;_widget;get height(){return this._widget.height}get count(){return this._widget.count}getNode(e){return this._widget.getNode(e)}getNodeAtHeight(e){let i;if(e===0?i=this.view.firstVisibleIndex:i=this.view.indexAt(e+this.view.scrollTop),!(i<0||i>=this.view.length))return this.view.element(i)}update(){let e=this.getNodeAtHeight(0);if(!e||this.tree.scrollTop===0){this._widget.setState(void 0);return}let i=this.findStickyState(e);this._widget.setState(i)}findStickyState(e){let i=[],n=e,o=0,s=this.getNextStickyNode(n,void 0,o);for(;s&&(i.push(s),o+=s.height,!(i.length<=this.stickyScrollMaxItemCount&&(n=this.getNextVisibleNode(s),!n)));)s=this.getNextStickyNode(n,s.node,o);let a=this.constrainStickyNodes(i);return a.length?new Q2(a):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,i,n){let o=this.getAncestorUnderPrevious(e,i);if(o&&!(o===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,n))))return this.createStickyScrollNode(o,n)}nodeTopAlignsWithStickyNodesBottom(e,i){let n=this.getNodeIndex(e),o=this.view.getElementTop(n),s=i;return this.view.scrollTop===o-s}createStickyScrollNode(e,i){let n=this.treeDelegate.getHeight(e),{startIndex:o,endIndex:s}=this.getNodeRange(e),a=this.calculateStickyNodePosition(s,i,n);return{node:e,position:a,height:n,startIndex:o,endIndex:s}}getAncestorUnderPrevious(e,i=void 0){let n=e,o=this.getParentNode(n);for(;o;){if(o===i)return n;n=o,o=this.getParentNode(n)}if(i===void 0)return n}calculateStickyNodePosition(e,i,n){let o=this.view.getRelativeTop(e);if(o===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){let c=this.treeDelegate.getHeight(this.view.element(e)),u=this.view.getRelativeTop(e+1);o=u?u-c/this.view.renderHeight:null}if(o===null)return i;let s=this.view.element(e),a=this.treeDelegate.getHeight(s),d=o*this.view.renderHeight+a;return i+n>d&&i<=d?d-n:i}constrainStickyNodes(e){if(e.length===0)return[];let i=this.view.renderHeight*this.maxWidgetViewRatio,n=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&n.position+n.height<=i)return e;let o=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,i);if(!o.length)return[];let s=o[o.length-1];if(o.length>this.stickyScrollMaxItemCount||s.position+s.height>i)throw new Error("stickyScrollDelegate violates constraints");return o}getParentNode(e){let i=this.model.getNodeLocation(e),n=this.model.getParentNodeLocation(i);return n?this.model.getNode(n):void 0}nodeIsUncollapsedParent(e){let i=this.model.getNodeLocation(e);return this.model.getListRenderCount(i)>1}getNodeIndex(e){let i=this.model.getNodeLocation(e);return this.model.getListIndex(i)}getNodeRange(e){let i=this.model.getNodeLocation(e),n=this.model.getListIndex(i);if(n<0)throw new Error("Node not found in tree");let o=this.model.getListRenderCount(i),s=n+o-1;return{startIndex:n,endIndex:s}}nodePositionTopBelowWidget(e){let i=[],n=this.getParentNode(e);for(;n;)i.push(n),n=this.getParentNode(n);let o=0;for(let s=0;s<i.length&&s<this.stickyScrollMaxItemCount;s++)o+=this.treeDelegate.getHeight(i[s]);return o}getFocus(){return this._widget.getFocus()}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(!e.stickyScrollMaxItemCount)return;let i=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==i.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=i.stickyScrollMaxItemCount,this.update())}validateStickySettings(e){let i=7;return typeof e.stickyScrollMaxItemCount=="number"&&(i=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:i}}setModel(e){this.model=e}},ez=class{constructor(t,e,i,n,o,s){this.view=e;this.tree=i;this.treeRenderers=n;this.treeDelegate=o;this.accessibilityProvider=s;this._rootDomNode=re(".monaco-tree-sticky-container.empty"),t.appendChild(this._rootDomNode);let a=re(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new tz(this._rootDomNode,e),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}_rootDomNode;_previousState;_previousElements=[];_previousStateDisposables=new W;stickyScrollFocus;onDidChangeHasFocus;onContextMenu;get height(){if(!this._previousState)return 0;let t=this._previousState.stickyNodes[this._previousState.count-1];return t.position+t.height}get count(){return this._previousState?.count??0}getNode(t){return this._previousState?.stickyNodes.find(e=>e.node===t)}setState(t){let e=!!this._previousState&&this._previousState.count>0,i=!!t&&t.count>0;if(!e&&!i||e&&i&&this._previousState.equal(t))return;if(e!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}let n=t.stickyNodes[t.count-1];if(this._previousState&&t.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${n.position}px`;else{this._previousStateDisposables.clear();let o=Array(t.count);for(let s=t.count-1;s>=0;s--){let a=t.stickyNodes[s],{element:l,disposable:d}=this.createElement(a,s,t.count);o[s]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(d)}this.stickyScrollFocus.updateElements(o,t),this._previousElements=o}this._previousState=t,this._rootDomNode.style.height=`${n.position+n.height}px`}createElement(t,e,i){let n=t.startIndex,o=document.createElement("div");o.style.top=`${t.position}px`,this.tree.options.setRowHeight!==!1&&(o.style.height=`${t.height}px`),this.tree.options.setRowLineHeight!==!1&&(o.style.lineHeight=`${t.height}px`),o.classList.add("monaco-tree-sticky-row"),o.classList.add("monaco-list-row"),o.setAttribute("data-index",`${n}`),o.setAttribute("data-parity",n%2===0?"even":"odd"),o.setAttribute("id",this.view.getElementID(n));let s=this.setAccessibilityAttributes(o,t.node.element,e,i),a=this.treeDelegate.getTemplateId(t.node),l=this.treeRenderers.find(p=>p.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let d=t.node;d===this.tree.getNode(this.tree.getNodeLocation(t.node))&&(d=new Proxy(t.node,{}));let c=l.renderTemplate(o);l.renderElement(d,t.startIndex,c,t.height);let u=te(()=>{s.dispose(),l.disposeElement(d,t.startIndex,c,t.height),l.disposeTemplate(c),o.remove()});return{element:o,disposable:u}}setAccessibilityAttributes(t,e,i,n){if(!this.accessibilityProvider)return L.None;this.accessibilityProvider.getSetSize&&t.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e,i,n))),this.accessibilityProvider.getPosInSet&&t.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e,i))),this.accessibilityProvider.getRole&&t.setAttribute("role",this.accessibilityProvider.getRole(e)??"treeitem");let o=this.accessibilityProvider.getAriaLabel(e),s=o&&typeof o!="string"?o:uh(o),a=Ut(d=>{let c=d.readObservable(s);c?t.setAttribute("aria-label",c):t.removeAttribute("aria-label")});typeof o=="string"||o&&t.setAttribute("aria-label",o.get());let l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);return typeof l=="number"&&t.setAttribute("aria-level",`${l}`),t.setAttribute("aria-selected",String(!1)),a}setVisible(t){this._rootDomNode.classList.toggle("empty",!t),t||this.stickyScrollFocus.updateElements([],void 0)}getFocus(){return this.stickyScrollFocus.getFocus()}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}},tz=class extends L{constructor(e,i){super();this.container=e;this.view=i;this._register(M(this.container,"focus",()=>this.onFocus())),this._register(M(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(n=>this.onKeyDown(n))),this._register(this.view.onMouseDown(n=>this.onMouseDown(n))),this._register(this.view.onContextMenu(n=>this.handleContextMenu(n)))}focusedIndex=-1;elements=[];state;_onDidChangeHasFocus=new T;onDidChangeHasFocus=this._onDidChangeHasFocus.event;_onContextMenu=new T;onContextMenu=this._onContextMenu.event;_domHasFocus=!1;get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}handleContextMenu(e){let i=e.browserEvent.target;if(!zy(i)&&!Hy(i)){this.focusedLast()&&this.view.domFocus();return}if(!bl(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");let a=this.state.stickyNodes.findIndex(l=>l.node.element===e.element?.element);if(a===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(a);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");let o=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:o,anchor:s,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){let i=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([i]),this.scrollNodeUnderWidget(i,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){let i=e.browserEvent.target;!zy(i)&&!Hy(i)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,i){if(i&&i.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(i&&i.count!==e.length)throw new Error("Sticky scroll focus received illigel state");let n=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=i,i){let o=sr(n,0,i.count-1);this.setFocus(o)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=i?0:-1}setFocusedElement(e){let i=this.state;if(!i)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<i.count-1)&&i.lastNodePartiallyVisible()){let n=i.stickyNodes[e];this.scrollNodeUnderWidget(n.endIndex+1,i)}}scrollNodeUnderWidget(e,i){let n=i.stickyNodes[i.count-1],o=i.count>1?i.stickyNodes[i.count-2]:void 0,s=this.view.getElementTop(e),a=o?o.position+o.height+n.height:n.height;this.view.scrollTop=s-a}getFocus(){if(!(!this.state||this.focusedIndex===-1))return this.state.stickyNodes[this.focusedIndex].node.element}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");let i=this.focusedIndex;i>=0&&this.toggleElementFocus(this.elements[i],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,i){this.toggleElementActiveFocus(e,i&&this.domHasFocus),this.toggleElementPassiveFocus(e,i)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,i){e.classList.toggle("focused",i)}toggleElementPassiveFocus(e,i){e.classList.toggle("passive-focused",i)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}};function qy(r){let t=0;return ok(r.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?t=1:ok(r.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?t=2:ok(r.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(t=3),{browserEvent:r.browserEvent,element:r.element?r.element.element:null,target:t}}function Ple(r){let t=zy(r.browserEvent.target);return{element:r.element?r.element.element:null,browserEvent:r.browserEvent,anchor:r.anchor,isStickyScroll:t}}function QA(r,t){t(r),r.children.forEach(e=>QA(e,t))}var aT=class{constructor(t,e){this.getFirstViewElementWithTrait=t;this.identityProvider=e}nodes=[];elements;_onDidChange=new T;onDidChange=this._onDidChange.event;_nodeSet;get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(t,e){!e?.__forceEvent&&ti(this.nodes,t)||this._set(t,!1,e)}_set(t,e,i){if(this.nodes=[...t],this.elements=void 0,this._nodeSet=void 0,!e){let n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(t=>t.element)),[...this.elements]}getNodes(){return this.nodes}has(t){return this.nodeSet.has(t)}onDidModelSplice({insertedNodes:t,deletedNodes:e}){if(!this.identityProvider){let l=this.createNodeSet(),d=c=>l.delete(c);e.forEach(c=>QA(c,d)),this.set([...l.values()]);return}let i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());e.forEach(l=>QA(l,n));let o=new Map,s=l=>o.set(this.identityProvider.getId(l.element).toString(),l);t.forEach(l=>QA(l,s));let a=[];for(let l of this.nodes){let d=this.identityProvider.getId(l.element).toString();if(!i.has(d))a.push(l);else{let u=o.get(d);u&&u.visible&&a.push(u)}}if(this.nodes.length>0&&a.length===0){let l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){let t=new Set;for(let e of this.nodes)t.add(e);return t}},iz=class extends eT{constructor(e,i,n){super(e);this.tree=i;this.stickyScrollProvider=n}onViewPointer(e){if(E2(e.browserEvent.target)||sa(e.browserEvent.target)||Wy(e.browserEvent.target)||e.browserEvent.isHandledByList)return;let i=e.element;if(!i)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);let n=e.browserEvent.target,o=n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,s=Hy(e.browserEvent.target),a=!1;if(s?a=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?a=this.tree.expandOnlyOnTwistieClick(i.element):a=!!this.tree.expandOnlyOnTwistieClick,s)this.handleStickyScrollMouseEvent(e,i);else{if(a&&!o&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(i.collapsible&&(!s||o)){let l=this.tree.getNodeLocation(i),d=e.browserEvent.altKey;if(this.tree.setFocus([l]),this.tree.toggleCollapsed(l,d),o){e.browserEvent.isHandledByList=!0;return}}s||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,i){if(rX(e.browserEvent.target)||sX(e.browserEvent.target))return;let n=this.stickyScrollProvider();if(!n)throw new Error("Sticky scroll controller not found");let o=this.list.indexOf(i),s=this.list.getElementTop(o),a=n.nodePositionTopBelowWidget(i);this.tree.scrollTop=s-a,this.list.domFocus(),this.list.setFocus([o]),this.list.setSelection([o])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){let i=e.browserEvent.target;if(!zy(i)&&!Hy(i)){super.onMouseDown(e);return}}onContextMenu(e){let i=e.browserEvent.target;if(!zy(i)&&!Hy(i)){super.onContextMenu(e);return}}},nz=class extends Lo{constructor(e,i,n,o,s,a,l,d){super(e,i,n,o,d);this.focusTrait=s;this.selectionTrait=a;this.anchorTrait=l}createMouseController(e){return new iz(this,e.tree,e.stickyScrollProvider)}splice(e,i,n=[]){if(super.splice(e,i,n),n.length===0)return;let o=[],s=[],a;n.forEach((l,d)=>{this.focusTrait.has(l)&&o.push(e+d),this.selectionTrait.has(l)&&s.push(e+d),this.anchorTrait.has(l)&&(a=e+d)}),o.length>0&&super.setFocus(yo([...super.getFocus(),...o])),s.length>0&&super.setSelection(yo([...super.getSelection(),...s])),typeof a=="number"&&super.setAnchor(a)}setFocus(e,i,n=!1){super.setFocus(e,i),n||this.focusTrait.set(e.map(o=>this.element(o)),i)}setSelection(e,i,n=!1){super.setSelection(e,i),n||this.selectionTrait.set(e.map(o=>this.element(o)),i)}setAnchor(e,i=!1){super.setAnchor(e),i||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}};var $y=class{constructor(t,e,i,n,o={}){this._user=t;this._options=o;let s;o.keyboardNavigationLabelProvider&&(s=new j2(this,o.keyboardNavigationLabelProvider,o.filter),o={...o,filter:s},this.disposables.add(s)),this.model=this.createModel(t,o),this.treeDelegate=new jy(i);let a=this.disposables.add(new G2(this.onDidChangeActiveNodesRelay.event)),l=new Vu;this.renderers=n.map(d=>new q2(d,this.model,this.onDidChangeCollapseStateRelay.event,a,l,o));for(let d of this.renderers)this.disposables.add(d);if(this.focus=new aT(()=>this.view.getFocusedElements()[0],o.identityProvider),this.selection=new aT(()=>this.view.getSelectedElements()[0],o.identityProvider),this.anchor=new aT(()=>this.view.getAnchorElement(),o.identityProvider),this.view=new nz(t,e,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...kle(()=>this.model,o),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),o.keyboardSupport!==!1){let d=O.chain(this.view.onKeyDown,c=>c.filter(u=>!sa(u.target)).map(u=>new st(u)));O.chain(d,c=>c.filter(u=>u.keyCode===15))(this.onLeftArrow,this,this.disposables),O.chain(d,c=>c.filter(u=>u.keyCode===17))(this.onRightArrow,this,this.disposables),O.chain(d,c=>c.filter(u=>u.keyCode===10))(this.onSpace,this,this.disposables)}if((o.findWidgetEnabled??!0)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider){let d=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new X2(this,this.view,s,o.contextViewProvider,d),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType,this.disposables.add(this.onDidSpliceModelRelay.event(()=>{!this.findController.isOpened()||this.findController.pattern.length===0||(this.refilter(),this.findController.render())}))}else this.onDidChangeFindMode=O.None,this.onDidChangeFindMatchType=O.None;o.enableStickyScroll&&(this.stickyScrollController=new JA(this,this.model,this.view,this.renderers,this.treeDelegate,o),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=Ho(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}view;renderers;model;treeDelegate;focus;selection;anchor;eventBufferer=new mh;findController;onDidChangeFindOpenState=O.None;onDidChangeStickyScrollFocused=O.None;focusNavigationFilter;stickyScrollController;styleElement;disposables=new W;get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseClick(){return O.map(this.view.onMouseClick,qy)}get onMouseDblClick(){return O.filter(O.map(this.view.onMouseDblClick,qy),t=>t.target!==3)}get onMouseOver(){return O.map(this.view.onMouseOver,qy)}get onMouseOut(){return O.map(this.view.onMouseOut,qy)}get onContextMenu(){return O.any(O.filter(O.map(this.view.onContextMenu,Ple),t=>!t.isStickyScroll),this.stickyScrollController?.onContextMenu??O.None)}get onTap(){return O.map(this.view.onTap,qy)}get onPointer(){return O.map(this.view.onPointer,qy)}get onKeyDown(){return this.view.onKeyDown}get onKeyUp(){return this.view.onKeyUp}get onKeyPress(){return this.view.onKeyPress}get onDidFocus(){return this.view.onDidFocus}get onDidBlur(){return this.view.onDidBlur}onDidSwapModel=this.disposables.add(new T);onDidChangeModelRelay=this.disposables.add(new Er);onDidSpliceModelRelay=this.disposables.add(new Er);onDidChangeCollapseStateRelay=this.disposables.add(new Er);onDidChangeRenderNodeCountRelay=this.disposables.add(new Er);onDidChangeActiveNodesRelay=this.disposables.add(new Er);get onDidChangeModel(){return O.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}_onWillRefilter=new T;onWillRefilter=this._onWillRefilter.event;get findMode(){return this.findController?.mode??0}set findMode(t){this.findController&&(this.findController.mode=t)}onDidChangeFindMode;get findMatchType(){return this.findController?.matchType??0}set findMatchType(t){this.findController&&(this.findController.matchType=t)}onDidChangeFindMatchType;get onDidChangeFindPattern(){return this.findController?this.findController.onDidChangePattern:O.None}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}_onDidUpdateOptions=new T;onDidUpdateOptions=this._onDidUpdateOptions.event;get onDidDispose(){return this.view.onDidDispose}updateOptions(t={}){this._options={...this._options,...t};for(let e of this.renderers)e.updateOptions(t);this.view.updateOptions(this._options),this.findController?.updateOptions(t),this.updateStickyScroll(t),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides==="always")}get options(){return this._options}updateStickyScroll(t){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new JA(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=O.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(t)}updateWidth(t){let e=this.model.getListIndex(t);e!==-1&&this.view.updateWidth(e)}getHTMLElement(){return this.view.getHTMLElement()}get contentHeight(){return this.view.contentHeight}get contentWidth(){return this.view.contentWidth}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.view.onDidChangeContentWidth}get scrollTop(){return this.view.scrollTop}set scrollTop(t){this.view.scrollTop=t}get scrollLeft(){return this.view.scrollLeft}set scrollLeft(t){this.view.scrollLeft=t}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleElement(){let t=this.view.firstVisibleIndex;return this.stickyScrollController&&(t+=this.stickyScrollController.count),t<0||t>=this.view.length?void 0:this.view.element(t).element}get lastVisibleElement(){let t=this.view.lastVisibleIndex;return this.view.element(t).element}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(t){this.view.ariaLabel=t}get selectionSize(){return this.selection.getNodes().length}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}isDOMFocused(){return os(this.getHTMLElement())}layout(t,e){this.view.layout(t,e),Vo(e)&&this.findController?.layout(e)}style(t){let e=`.${this.view.domId}`,i=[];t.treeIndentGuidesStroke&&(i.push(`.monaco-list${e}:hover .monaco-tl-indent > .indent-guide, .monaco-list${e}.always .monaco-tl-indent > .indent-guide  { border-color: ${t.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${e} .monaco-tl-indent > .indent-guide.active { border-color: ${t.treeIndentGuidesStroke}; }`));let n=t.treeStickyScrollBackground??t.listBackground;n&&(i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),t.treeStickyScrollBorder&&i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${t.treeStickyScrollBorder}; }`),t.treeStickyScrollShadow&&i.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${t.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),t.listFocusForeground&&(i.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${t.listFocusForeground}; }`),i.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));let o=Is(t.listFocusAndSelectionOutline,Is(t.listSelectionOutline,t.listFocusOutline??""));o&&(i.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${o}; outline-offset: -1px;}`),i.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),t.listFocusOutline&&(i.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(t)}getParentElement(t){let e=this.model.getParentNodeLocation(t);return this.model.getNode(e).element}getFirstElementChild(t){return this.model.getFirstElementChild(t)}getNode(t){return this.model.getNode(t)}getNodeLocation(t){return this.model.getNodeLocation(t)}collapse(t,e=!1){return this.model.setCollapsed(t,!0,e)}expand(t,e=!1){return this.model.setCollapsed(t,!1,e)}toggleCollapsed(t,e=!1){return this.model.setCollapsed(t,void 0,e)}expandAll(){this.model.setCollapsed(this.model.rootRef,!1,!0)}collapseAll(){this.model.setCollapsed(this.model.rootRef,!0,!0)}isCollapsible(t){return this.model.isCollapsible(t)}setCollapsible(t,e){return this.model.setCollapsible(t,e)}isCollapsed(t){return this.model.isCollapsed(t)}expandTo(t){this.model.expandTo(t)}triggerTypeNavigation(){this.view.triggerTypeNavigation()}openFind(){this.findController?.open()}closeFind(){this.findController?.close()}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setAnchor(t){if(typeof t>"u")return this.view.setAnchor(void 0);this.eventBufferer.bufferEvents(()=>{let e=this.model.getNode(t);this.anchor.set([e]);let i=this.model.getListIndex(t);i>-1&&this.view.setAnchor(i,!0)})}getAnchor(){return this.anchor.get().at(0)}setSelection(t,e){this.eventBufferer.bufferEvents(()=>{let i=t.map(o=>this.model.getNode(o));this.selection.set(i,e);let n=t.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setSelection(n,e,!0)})}getSelection(){return this.selection.get()}setFocus(t,e){this.eventBufferer.bufferEvents(()=>{let i=t.map(o=>this.model.getNode(o));this.focus.set(i,e);let n=t.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setFocus(n,e,!0)})}focusNext(t=1,e=!1,i,n=bl(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(t,e,i,n)}focusPrevious(t=1,e=!1,i,n=bl(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(t,e,i,n)}focusNextPage(t,e=bl(t)&&t.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(t,e)}focusPreviousPage(t,e=bl(t)&&t.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(t,e,()=>this.stickyScrollController?.height??0)}focusLast(t,e=bl(t)&&t.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(t,e)}focusFirst(t,e=bl(t)&&t.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(t,e)}getFocus(){return this.focus.get()}getStickyScrollFocus(){let t=this.stickyScrollController?.getFocus();return t!==void 0?[t]:[]}getFocusedPart(){return this.stickyScrollController?.focusedLast()?1:0}reveal(t,e){this.model.expandTo(t);let i=this.model.getListIndex(t);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,e);else{let n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(t));this.view.reveal(i,e,n)}}getRelativeTop(t){let e=this.model.getListIndex(t);if(e===-1)return null;let i=this.stickyScrollController?.getNode(this.getNode(t));return this.view.getRelativeTop(e,i?.position??this.stickyScrollController?.height)}getViewState(t=this.options.identityProvider){if(!t)throw new cn(this._user,"Can't get tree view state without an identity provider");let e=s=>t.getId(s).toString(),i=K2.empty(this.scrollTop);for(let s of this.getFocus())i.focus.add(e(s));for(let s of this.getSelection())i.selection.add(e(s));let n=this.model.getNode(),o=[n];for(;o.length>0;){let s=o.shift();s!==n&&s.collapsible&&(i.expanded[e(s.element)]=s.collapsed?0:1),o.push(...s.children)}return i}onLeftArrow(t){t.preventDefault(),t.stopPropagation();let e=this.view.getFocusedElements();if(e.length===0)return;let i=e[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){let s=this.model.getParentNodeLocation(n);if(!s)return;let a=this.model.getListIndex(s);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(t){t.preventDefault(),t.stopPropagation();let e=this.view.getFocusedElements();if(e.length===0)return;let i=e[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;let[s]=this.view.getFocus(),a=s+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(t){t.preventDefault(),t.stopPropagation();let e=this.view.getFocusedElements();if(e.length===0)return;let i=e[0],n=this.model.getNodeLocation(i),o=t.browserEvent.altKey;this.model.setCollapsed(n,void 0,o)}modelDisposables=new W;setupModel(t){this.modelDisposables.clear(),this.modelDisposables.add(t.onDidSpliceRenderedNodes(({start:o,deleteCount:s,elements:a})=>this.view.splice(o,s,a)));let e=O.forEach(t.onDidSpliceModel,o=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(o),this.selection.onDidModelSplice(o)})},this.modelDisposables);e(()=>null,null,this.modelDisposables);let i=this.modelDisposables.add(new T),n=this.modelDisposables.add(new bs(0));this.modelDisposables.add(O.any(e,this.focus.onDidChange,this.selection.onDidChange)(()=>{n.trigger(()=>{let o=new Set;for(let s of this.focus.getNodes())o.add(s);for(let s of this.selection.getNodes())o.add(s);i.fire([...o.values()])})})),this.onDidChangeActiveNodesRelay.input=i.event,this.onDidChangeModelRelay.input=O.signal(t.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=t.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=t.onDidChangeRenderNodeCount}setModel(t){let e=this.model;this.model=t,this.setupModel(t),this.renderers.forEach(i=>i.setModel(t)),this.stickyScrollController?.setModel(t),this.focus.set([]),this.selection.set([]),this.anchor.set([]),this.view.splice(0,e.getListRenderCount(e.rootRef)),this.model.refilter(),this.onDidSwapModel.fire()}getModel(){return this.model}navigate(t){return new oz(this.view,this.model,t)}dispose(){nt(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose(),this.modelDisposables.dispose()}},oz=class{constructor(t,e,i){this.view=t;this.model=e;i?this.index=this.model.getListIndex(i):this.index=-1}index;current(){return this.index<0||this.index>=this.view.length?null:this.view.element(this.index).element}previous(){return this.index--,this.current()}next(){return this.index++,this.current()}first(){return this.index=0,this.current()}last(){return this.index=this.view.length-1,this.current()}};var cm=class{constructor(t,e={}){this.user=t;this.model=new XA(t,null,e),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,e.sorter&&(this.sorter={compare(i,n){return e.sorter.compare(i.element,n.element)}}),this.identityProvider=e.identityProvider}rootRef=null;model;nodes=new Map;nodesByIdentity=new Map;identityProvider;sorter;onDidSpliceModel;onDidSpliceRenderedNodes;onDidChangeCollapseState;onDidChangeRenderNodeCount;get size(){return this.nodes.size}setChildren(t,e=Lt.empty(),i={}){let n=this.getElementLocation(t);this._setChildren(n,this.preserveCollapseState(e),i)}_setChildren(t,e=Lt.empty(),i){let n=new Set,o=new Set,s=l=>{if(l.element===null)return;let d=l;if(n.add(d.element),this.nodes.set(d.element,d),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();o.add(c),this.nodesByIdentity.set(c,d)}i.onDidCreateNode?.(d)},a=l=>{if(l.element===null)return;let d=l;if(n.has(d.element)||this.nodes.delete(d.element),this.identityProvider){let c=this.identityProvider.getId(d.element).toString();o.has(c)||this.nodesByIdentity.delete(c)}i.onDidDeleteNode?.(d)};this.model.splice([...t,0],Number.MAX_VALUE,e,{...i,onDidCreateNode:s,onDidDeleteNode:a})}preserveCollapseState(t=Lt.empty()){return this.sorter&&(t=[...t].sort(this.sorter.compare.bind(this.sorter))),Lt.map(t,e=>{let i=this.nodes.get(e.element);if(!i&&this.identityProvider){let s=this.identityProvider.getId(e.element).toString();i=this.nodesByIdentity.get(s)}if(!i){let s;return typeof e.collapsed>"u"?s=void 0:e.collapsed===1||e.collapsed===3?s=!0:e.collapsed===0||e.collapsed===2?s=!1:s=!!e.collapsed,{...e,children:this.preserveCollapseState(e.children),collapsed:s}}let n=typeof e.collapsible=="boolean"?e.collapsible:i.collapsible,o;return typeof e.collapsed>"u"||e.collapsed===3||e.collapsed===2?o=i.collapsed:e.collapsed===1?o=!0:e.collapsed===0?o=!1:o=!!e.collapsed,{...e,collapsible:n,collapsed:o,children:this.preserveCollapseState(e.children)}})}rerender(t){let e=this.getElementLocation(t);this.model.rerender(e)}resort(t=null,e=!0){if(!this.sorter)return;let i=this.getElementLocation(t),n=this.model.getNode(i);this._setChildren(i,this.resortChildren(n,e),{})}resortChildren(t,e,i=!0){let n=[...t.children];return(e||i)&&(n=n.sort(this.sorter.compare.bind(this.sorter))),Lt.map(n,o=>({element:o.element,collapsible:o.collapsible,collapsed:o.collapsed,children:this.resortChildren(o,e,!1)}))}getFirstElementChild(t=null){let e=this.getElementLocation(t);return this.model.getFirstElementChild(e)}getLastElementAncestor(t=null){let e=this.getElementLocation(t);return this.model.getLastElementAncestor(e)}has(t){return this.nodes.has(t)}getListIndex(t){let e=this.getElementLocation(t);return this.model.getListIndex(e)}getListRenderCount(t){let e=this.getElementLocation(t);return this.model.getListRenderCount(e)}isCollapsible(t){let e=this.getElementLocation(t);return this.model.isCollapsible(e)}setCollapsible(t,e){let i=this.getElementLocation(t);return this.model.setCollapsible(i,e)}isCollapsed(t){let e=this.getElementLocation(t);return this.model.isCollapsed(e)}setCollapsed(t,e,i){let n=this.getElementLocation(t);return this.model.setCollapsed(n,e,i)}expandTo(t){let e=this.getElementLocation(t);this.model.expandTo(e)}refilter(){this.model.refilter()}getNode(t=null){if(t===null)return this.model.getNode(this.model.rootRef);let e=this.nodes.get(t);if(!e)throw new cn(this.user,`Tree element not found: ${t}`);return e}getNodeLocation(t){return t.element}getParentNodeLocation(t){if(t===null)throw new cn(this.user,"Invalid getParentNodeLocation call");let e=this.nodes.get(t);if(!e)throw new cn(this.user,`Tree element not found: ${t}`);let i=this.model.getNodeLocation(e),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(t){if(t===null)return[];let e=this.nodes.get(t);if(!e)throw new cn(this.user,`Tree element not found: ${t}`);return this.model.getNodeLocation(e)}};function eP(r){let t=[r.element],e=r.incompressible||!1;return{element:{elements:t,incompressible:e},children:Lt.map(Lt.from(r.children),eP),collapsible:r.collapsible,collapsed:r.collapsed}}function tP(r){let t=[r.element],e=r.incompressible||!1,i,n;for(;[n,i]=Lt.consume(Lt.from(r.children),2),!(n.length!==1||n[0].incompressible);)r=n[0],t.push(r.element);return{element:{elements:t,incompressible:e},children:Lt.map(Lt.concat(n,i),tP),collapsible:r.collapsible,collapsed:r.collapsed}}function rz(r,t=0){let e;return t<r.element.elements.length-1?e=[rz(r,t+1)]:e=Lt.map(Lt.from(r.children),i=>rz(i,0)),t===0&&r.element.incompressible?{element:r.element.elements[t],children:e,incompressible:!0,collapsible:r.collapsible,collapsed:r.collapsed}:{element:r.element.elements[t],children:e,collapsible:r.collapsible,collapsed:r.collapsed}}function EX(r){return rz(r,0)}function TX(r,t,e){return r.element===t?{...r,children:e}:{...r,children:Lt.map(Lt.from(r.children),i=>TX(i,t,e))}}var Ole=r=>({getId(t){return t.elements.map(e=>r.getId(e).toString()).join("\0")}}),sz=class{constructor(t,e={}){this.user=t;this.model=new cm(t,e),this.enabled=typeof e.compressionEnabled>"u"?!0:e.compressionEnabled,this.identityProvider=e.identityProvider}rootRef=null;get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}model;nodes=new Map;enabled;identityProvider;get size(){return this.nodes.size}setChildren(t,e=Lt.empty(),i){let n=i.diffIdentityProvider&&Ole(i.diffIdentityProvider);if(t===null){let g=Lt.map(e,this.enabled?tP:eP);this._setChildren(null,g,{diffIdentityProvider:n,diffDepth:1/0});return}let o=this.nodes.get(t);if(!o)throw new cn(this.user,"Unknown compressed tree node");let s=this.model.getNode(o),a=this.model.getParentNodeLocation(o),l=this.model.getNode(a),d=EX(s),c=TX(d,t,e),u=(this.enabled?tP:eP)(c),p=i.diffIdentityProvider?(g,f)=>i.diffIdentityProvider.getId(g)===i.diffIdentityProvider.getId(f):void 0;if(ti(u.element.elements,s.element.elements,p)){this._setChildren(o,u.children||Lt.empty(),{diffIdentityProvider:n,diffDepth:1});return}let m=l.children.map(g=>g===s?u:g);this._setChildren(l.element,m,{diffIdentityProvider:n,diffDepth:s.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(t){if(t===this.enabled)return;this.enabled=t;let i=this.model.getNode().children,n=Lt.map(i,EX),o=Lt.map(n,t?tP:eP);this._setChildren(null,o,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(t,e,i){let n=new Set,o=a=>{for(let l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},s=a=>{for(let l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(t,e,{...i,onDidCreateNode:o,onDidDeleteNode:s})}has(t){return this.nodes.has(t)}getListIndex(t){let e=this.getCompressedNode(t);return this.model.getListIndex(e)}getListRenderCount(t){let e=this.getCompressedNode(t);return this.model.getListRenderCount(e)}getNode(t){if(typeof t>"u")return this.model.getNode();let e=this.getCompressedNode(t);return this.model.getNode(e)}getNodeLocation(t){let e=this.model.getNodeLocation(t);return e===null?null:e.elements[e.elements.length-1]}getParentNodeLocation(t){let e=this.getCompressedNode(t),i=this.model.getParentNodeLocation(e);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(t){let e=this.getCompressedNode(t);return this.model.getFirstElementChild(e)}getLastElementAncestor(t){let e=typeof t>"u"?void 0:this.getCompressedNode(t);return this.model.getLastElementAncestor(e)}isCollapsible(t){let e=this.getCompressedNode(t);return this.model.isCollapsible(e)}setCollapsible(t,e){let i=this.getCompressedNode(t);return this.model.setCollapsible(i,e)}isCollapsed(t){let e=this.getCompressedNode(t);return this.model.isCollapsed(e)}setCollapsed(t,e,i){let n=this.getCompressedNode(t);return this.model.setCollapsed(n,e,i)}expandTo(t){let e=this.getCompressedNode(t);this.model.expandTo(e)}rerender(t){let e=this.getCompressedNode(t);this.model.rerender(e)}refilter(){this.model.refilter()}resort(t=null,e=!0){let i=this.getCompressedNode(t);this.model.resort(i,e)}getCompressedNode(t){if(t===null)return null;let e=this.nodes.get(t);if(!e)throw new cn(this.user,`Tree element not found: ${t}`);return e}},Nle=r=>r[r.length-1],az=class r{constructor(t,e){this.unwrapper=t;this.node=e}get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(t=>new r(this.unwrapper,t))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}};function Fle(r,t){return{...t,identityProvider:t.identityProvider&&{getId(e){return t.identityProvider.getId(r(e))}},sorter:t.sorter&&{compare(e,i){return t.sorter.compare(e.elements[0],i.elements[0])}},filter:t.filter&&{filter(e,i){return t.filter.filter(r(e),i)}}}}var iP=class{rootRef=null;get onDidSpliceModel(){return O.map(this.model.onDidSpliceModel,({insertedNodes:t,deletedNodes:e})=>({insertedNodes:t.map(i=>this.nodeMapper.map(i)),deletedNodes:e.map(i=>this.nodeMapper.map(i))}))}get onDidSpliceRenderedNodes(){return O.map(this.model.onDidSpliceRenderedNodes,({start:t,deleteCount:e,elements:i})=>({start:t,deleteCount:e,elements:i.map(n=>this.nodeMapper.map(n))}))}get onDidChangeCollapseState(){return O.map(this.model.onDidChangeCollapseState,({node:t,deep:e})=>({node:this.nodeMapper.map(t),deep:e}))}get onDidChangeRenderNodeCount(){return O.map(this.model.onDidChangeRenderNodeCount,t=>this.nodeMapper.map(t))}elementMapper;nodeMapper;model;constructor(t,e={}){this.elementMapper=e.elementMapper||Nle;let i=n=>this.elementMapper(n.elements);this.nodeMapper=new If(n=>new az(i,n)),this.model=new sz(t,Fle(i,e))}setChildren(t,e=Lt.empty(),i={}){this.model.setChildren(t,e,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(t){this.model.setCompressionEnabled(t)}has(t){return this.model.has(t)}getListIndex(t){return this.model.getListIndex(t)}getListRenderCount(t){return this.model.getListRenderCount(t)}getNode(t){return this.nodeMapper.map(this.model.getNode(t))}getNodeLocation(t){return t.element}getParentNodeLocation(t){return this.model.getParentNodeLocation(t)}getFirstElementChild(t){let e=this.model.getFirstElementChild(t);return e===null||typeof e>"u"?e:this.elementMapper(e.elements)}getLastElementAncestor(t){let e=this.model.getLastElementAncestor(t);return e===null||typeof e>"u"?e:this.elementMapper(e.elements)}isCollapsible(t){return this.model.isCollapsible(t)}setCollapsible(t,e){return this.model.setCollapsible(t,e)}isCollapsed(t){return this.model.isCollapsed(t)}setCollapsed(t,e,i){return this.model.setCollapsed(t,e,i)}expandTo(t){return this.model.expandTo(t)}rerender(t){return this.model.rerender(t)}refilter(){return this.model.refilter()}resort(t=null,e=!0){return this.model.resort(t,e)}getCompressedTreeNode(t=null){return this.model.getNode(t)}};var Sf=class extends $y{constructor(e,i,n,o,s={}){super(e,i,n,o,s);this.user=e}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(e,i=Lt.empty(),n){this.model.setChildren(e,i,n)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}updateElementHeight(e,i){let n=this.model.getListIndex(e);if(n===-1)throw new cn(this.user,"updateElementHeight failed - index not found");this.view.updateElementHeight(n,i)}resort(e,i=!0){this.model.resort(e,i)}hasElement(e){return this.model.has(e)}createModel(e,i){return new cm(e,i)}},nP=class{constructor(t,e,i){this._compressedTreeNodeProvider=t;this.stickyScrollDelegate=e;this.renderer=i;this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}templateId;onDidChangeTwistieState;get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(t){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(t)}}renderElement(t,e,i,n){let o=this.stickyScrollDelegate.getCompressedNode(t);o||(o=this.compressedTreeNodeProvider.getCompressedTreeNode(t.element)),o.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(t,e,i.data,n)):(i.compressedTreeNode=o,this.renderer.renderCompressedElements(o,e,i.data,n))}disposeElement(t,e,i,n){i.compressedTreeNode?this.renderer.disposeCompressedElements?.(i.compressedTreeNode,e,i.data,n):this.renderer.disposeElement?.(t,e,i.data,n)}disposeTemplate(t){this.renderer.disposeTemplate(t.data)}renderTwistie(t,e){return this.renderer.renderTwistie?this.renderer.renderTwistie(t,e):!1}};_([ue],nP.prototype,"compressedTreeNodeProvider",1);var lz=class{constructor(t){this.modelProvider=t}compressedStickyNodes=new Map;getCompressedNode(t){return this.compressedStickyNodes.get(t)}constrainStickyScrollNodes(t,e,i){if(this.compressedStickyNodes.clear(),t.length===0)return[];for(let n=0;n<t.length;n++){let o=t[n],s=o.position+o.height;if(n+1<t.length&&s+t[n+1].height>i||n>=e-1&&e<t.length){let l=t.slice(0,n),d=t.slice(n),c=this.compressStickyNodes(d);return[...l,c]}}return t}compressStickyNodes(t){if(t.length===0)throw new Error("Can't compress empty sticky nodes");let e=this.modelProvider();if(!e.isCompressionEnabled())return t[0];let i=[];for(let d=0;d<t.length;d++){let c=t[d],u=e.getCompressedTreeNode(c.node.element);if(u.element){if(d!==0&&u.element.incompressible)break;i.push(...u.element.elements)}}if(i.length<2)return t[0];let n=t[t.length-1],o={elements:i,incompressible:!1},s={...n.node,children:[],element:o},a=new Proxy(t[0].node,{}),l={node:a,startIndex:t[0].startIndex,endIndex:n.endIndex,position:t[0].position,height:t[0].height};return this.compressedStickyNodes.set(a,s),l}};function Ble(r,t){return t&&{...t,keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(e){let i;try{i=r().getCompressedTreeNode(e)}catch{return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e)}return i.element.elements.length===1?t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e):t.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}var Yy=class extends Sf{constructor(t,e,i,n,o={}){let s=()=>this,a=new lz(()=>this.model),l=n.map(d=>new nP(s,a,d));super(t,e,i,l,{...Ble(s,o),stickyScrollDelegate:a})}setChildren(t,e=Lt.empty(),i){this.model.setChildren(t,e,i)}createModel(t,e){return new iP(t,e)}updateOptions(t={}){super.updateOptions(t),typeof t.compressionEnabled<"u"&&this.model.setCompressionEnabled(t.compressionEnabled)}getCompressedTreeNode(t=null){return this.model.getCompressedTreeNode(t)}};function dz(r){return{...r,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function uz(r,t){return t.parent?t.parent===r?!0:uz(r,t.parent):!1}function Vle(r,t){return r===t||uz(r,t)||uz(t,r)}var pz=class r{constructor(t){this.node=t}get element(){return this.node.element.element}get children(){return this.node.children.map(t=>new r(t))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},hz=class{constructor(t,e,i){this.renderer=t;this.nodeMapper=e;this.onDidChangeTwistieState=i;this.templateId=t.templateId}templateId;renderedNodes=new Map;renderTemplate(t){return{templateData:this.renderer.renderTemplate(t)}}renderElement(t,e,i,n){this.renderer.renderElement(this.nodeMapper.map(t),e,i.templateData,n)}renderTwistie(t,e){return t.slow?(e.classList.add(...ye.asClassNameArray(B.treeItemLoading)),!0):(e.classList.remove(...ye.asClassNameArray(B.treeItemLoading)),!1)}disposeElement(t,e,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(t),e,i.templateData,n)}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}dispose(){this.renderedNodes.clear()}};function xX(r){return{browserEvent:r.browserEvent,elements:r.elements.map(t=>t.element)}}function oP(r){return{browserEvent:r.browserEvent,element:r.element&&r.element.element,target:r.target}}function Wle(r){return{browserEvent:r.browserEvent,element:r.element&&r.element.element,anchor:r.anchor,isStickyScroll:r.isStickyScroll}}var mz=class extends Dp{constructor(e){super(e.elements.map(i=>i.element));this.data=e}set context(e){this.data.context=e}get context(){return this.data.context}};function cz(r){return r instanceof Dp?new mz(r):r}var gz=class{constructor(t){this.dnd=t}getDragURI(t){return this.dnd.getDragURI(t.element)}getDragLabel(t,e){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t.map(i=>i.element),e)}onDragStart(t,e){this.dnd.onDragStart?.(cz(t),e)}onDragOver(t,e,i,n,o,s=!0){return this.dnd.onDragOver(cz(t),e&&e.element,i,n,o)}drop(t,e,i,n,o){this.dnd.drop(cz(t),e&&e.element,i,n,o)}onDragEnd(t){this.dnd.onDragEnd?.(t)}dispose(){this.dnd.dispose()}};function _X(r){return r&&{...r,collapseByDefault:!0,identityProvider:r.identityProvider&&{getId(t){return r.identityProvider.getId(t.element)}},dnd:r.dnd&&new gz(r.dnd),multipleSelectionController:r.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return r.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return r.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:r.accessibilityProvider&&{...r.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:r.accessibilityProvider.getRole?t=>r.accessibilityProvider.getRole(t.element):()=>"treeitem",isChecked:r.accessibilityProvider.isChecked?t=>!!r.accessibilityProvider?.isChecked(t.element):void 0,getAriaLabel(t){return r.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return r.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:r.accessibilityProvider.getWidgetRole?()=>r.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:r.accessibilityProvider.getAriaLevel&&(t=>r.accessibilityProvider.getAriaLevel(t.element)),getActiveDescendantId:r.accessibilityProvider.getActiveDescendantId&&(t=>r.accessibilityProvider.getActiveDescendantId(t.element))},filter:r.filter&&{filter(t,e){return r.filter.filter(t.element,e)}},keyboardNavigationLabelProvider:r.keyboardNavigationLabelProvider&&{...r.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return r.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof r.expandOnlyOnTwistieClick>"u"?void 0:typeof r.expandOnlyOnTwistieClick!="function"?r.expandOnlyOnTwistieClick:t=>r.expandOnlyOnTwistieClick(t.element),defaultFindVisibility:t=>t.hasChildren&&t.stale?1:typeof r.defaultFindVisibility=="number"?r.defaultFindVisibility:typeof r.defaultFindVisibility>"u"?2:r.defaultFindVisibility(t.element)}}function fz(r,t){t(r),r.children.forEach(e=>fz(e,t))}var lT=class{constructor(t,e,i,n,o,s={}){this.user=t;this.dataSource=o;this.identityProvider=s.identityProvider,this.autoExpandSingleChildren=typeof s.autoExpandSingleChildren>"u"?!1:s.autoExpandSingleChildren,this.sorter=s.sorter,this.getDefaultCollapseState=a=>s.collapseByDefault?s.collapseByDefault(a)?3:2:void 0,this.tree=this.createTree(t,e,i,n,s),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=dz({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}tree;root;nodes=new Map;sorter;getDefaultCollapseState;subTreeRefreshPromises=new Map;refreshPromises=new Map;identityProvider;autoExpandSingleChildren;_onDidRender=new T;_onDidChangeNodeSlowState=new T;nodeMapper=new If(t=>new pz(t));disposables=new W;get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return O.map(this.tree.onDidChangeFocus,xX)}get onDidChangeSelection(){return O.map(this.tree.onDidChangeSelection,xX)}get onKeyDown(){return this.tree.onKeyDown}get onMouseClick(){return O.map(this.tree.onMouseClick,oP)}get onMouseDblClick(){return O.map(this.tree.onMouseDblClick,oP)}get onContextMenu(){return O.map(this.tree.onContextMenu,Wle)}get onTap(){return O.map(this.tree.onTap,oP)}get onPointer(){return O.map(this.tree.onPointer,oP)}get onDidFocus(){return this.tree.onDidFocus}get onDidBlur(){return this.tree.onDidBlur}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidUpdateOptions(){return this.tree.onDidUpdateOptions}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get findMode(){return this.tree.findMode}set findMode(t){this.tree.findMode=t}onDidChangeFindMode;get findMatchType(){return this.tree.findMatchType}set findMatchType(t){this.tree.findMatchType=t}onDidChangeFindMatchType;get expandOnlyOnTwistieClick(){if(typeof this.tree.expandOnlyOnTwistieClick=="boolean")return this.tree.expandOnlyOnTwistieClick;let t=this.tree.expandOnlyOnTwistieClick;return e=>t(this.nodes.get(e===this.root.element?null:e)||null)}get onDidDispose(){return this.tree.onDidDispose}createTree(t,e,i,n,o){let s=new jy(i),a=n.map(d=>new hz(d,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=_X(o)||{};return new Sf(t,e,s,a,l)}updateOptions(t={}){this.tree.updateOptions(t)}get options(){return this.tree.options}getHTMLElement(){return this.tree.getHTMLElement()}get contentHeight(){return this.tree.contentHeight}get contentWidth(){return this.tree.contentWidth}get onDidChangeContentHeight(){return this.tree.onDidChangeContentHeight}get onDidChangeContentWidth(){return this.tree.onDidChangeContentWidth}get scrollTop(){return this.tree.scrollTop}set scrollTop(t){this.tree.scrollTop=t}get scrollLeft(){return this.tree.scrollLeft}set scrollLeft(t){this.tree.scrollLeft=t}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}get lastVisibleElement(){return this.tree.lastVisibleElement.element}get ariaLabel(){return this.tree.ariaLabel}set ariaLabel(t){this.tree.ariaLabel=t}domFocus(){this.tree.domFocus()}layout(t,e){this.tree.layout(t,e)}style(t){this.tree.style(t)}getInput(){return this.root.element}async setInput(t,e){this.refreshPromises.forEach(n=>n.cancel()),this.refreshPromises.clear(),this.root.element=t;let i=e&&{viewState:e,focus:[],selection:[]};await this._updateChildren(t,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),e&&typeof e.scrollTop=="number"&&(this.scrollTop=e.scrollTop)}async updateChildren(t=this.root.element,e=!0,i=!1,n){await this._updateChildren(t,e,i,void 0,n)}async _updateChildren(t=this.root.element,e=!0,i=!1,n,o){if(typeof this.root.element>"u")throw new cn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await O.toPromise(this._onDidRender.event));let s=this.getDataNode(t);if(await this.refreshAndRenderNode(s,e,n,o),i)try{this.tree.rerender(s)}catch{}}resort(t=this.root.element,e=!0){this.tree.resort(this.getDataNode(t),e)}hasNode(t){return t===this.root.element||this.nodes.has(t)}rerender(t){if(t===void 0||t===this.root.element){this.tree.rerender();return}let e=this.getDataNode(t);this.tree.rerender(e)}updateElementHeight(t,e){let i=this.getDataNode(t);this.tree.updateElementHeight(i,e)}updateWidth(t){let e=this.getDataNode(t);this.tree.updateWidth(e)}getNode(t=this.root.element){let e=this.getDataNode(t),i=this.tree.getNode(e===this.root?null:e);return this.nodeMapper.map(i)}collapse(t,e=!1){let i=this.getDataNode(t);return this.tree.collapse(i===this.root?null:i,e)}async expand(t,e=!1){if(typeof this.root.element>"u")throw new cn(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await O.toPromise(this._onDidRender.event));let i=this.getDataNode(t);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await this.root.refreshPromise,await O.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;let n=this.tree.expand(i===this.root?null:i,e);return i.refreshPromise&&(await this.root.refreshPromise,await O.toPromise(this._onDidRender.event)),n}toggleCollapsed(t,e=!1){return this.tree.toggleCollapsed(this.getDataNode(t),e)}expandAll(){this.tree.expandAll()}async expandTo(t){if(!this.dataSource.getParent)throw new Error("Can't expand to element without getParent method");let e=[];for(;!this.hasNode(t);)t=this.dataSource.getParent(t),t!==this.root.element&&e.push(t);for(let i of Lt.reverse(e))await this.expand(i);this.tree.expandTo(this.getDataNode(t))}collapseAll(){this.tree.collapseAll()}isCollapsible(t){return this.tree.isCollapsible(this.getDataNode(t))}isCollapsed(t){return this.tree.isCollapsed(this.getDataNode(t))}triggerTypeNavigation(){this.tree.triggerTypeNavigation()}openFind(){this.tree.openFind()}closeFind(){this.tree.closeFind()}refilter(){this.tree.refilter()}setAnchor(t){this.tree.setAnchor(typeof t>"u"?void 0:this.getDataNode(t))}getAnchor(){return this.tree.getAnchor()?.element}setSelection(t,e){let i=t.map(n=>this.getDataNode(n));this.tree.setSelection(i,e)}getSelection(){return this.tree.getSelection().map(e=>e.element)}setFocus(t,e){let i=t.map(n=>this.getDataNode(n));this.tree.setFocus(i,e)}focusNext(t=1,e=!1,i){this.tree.focusNext(t,e,i)}focusPrevious(t=1,e=!1,i){this.tree.focusPrevious(t,e,i)}focusNextPage(t){return this.tree.focusNextPage(t)}focusPreviousPage(t){return this.tree.focusPreviousPage(t)}focusLast(t){this.tree.focusLast(t)}focusFirst(t){this.tree.focusFirst(t)}getFocus(){return this.tree.getFocus().map(e=>e.element)}getStickyScrollFocus(){return this.tree.getStickyScrollFocus().map(e=>e.element)}getFocusedPart(){return this.tree.getFocusedPart()}reveal(t,e){this.tree.reveal(this.getDataNode(t),e)}getRelativeTop(t){return this.tree.getRelativeTop(this.getDataNode(t))}getParentElement(t){let e=this.tree.getParentElement(this.getDataNode(t));return e&&e.element}getFirstElementChild(t=this.root.element){let e=this.getDataNode(t),i=this.tree.getFirstElementChild(e===this.root?null:e);return i&&i.element}getDataNode(t){let e=this.nodes.get(t===this.root.element?null:t);if(!e)throw new cn(this.user,`Data tree node not found: ${t}`);return e}async refreshAndRenderNode(t,e,i,n){await this.refreshNode(t,e,i),!this.disposables.isDisposed&&this.render(t,i,n)}async refreshNode(t,e,i){let n;if(this.subTreeRefreshPromises.forEach((o,s)=>{!n&&Vle(s,t)&&(n=o.then(()=>this.refreshNode(t,e,i)))}),n)return n;if(t!==this.root&&this.tree.getNode(t).collapsed){t.hasChildren=!!this.dataSource.hasChildren(t.element),t.stale=!0,this.setChildren(t,[],e,i);return}return this.doRefreshSubTree(t,e,i)}async doRefreshSubTree(t,e,i){let n;t.refreshPromise=new Promise(o=>n=o),this.subTreeRefreshPromises.set(t,t.refreshPromise),t.refreshPromise.finally(()=>{t.refreshPromise=void 0,this.subTreeRefreshPromises.delete(t)});try{let o=await this.doRefreshNode(t,e,i);t.stale=!1,await Vi.settled(o.map(s=>this.doRefreshSubTree(s,e,i)))}finally{n()}}async doRefreshNode(t,e,i){t.hasChildren=!!this.dataSource.hasChildren(t.element);let n;if(!t.hasChildren)n=Promise.resolve(Lt.empty());else{let o=this.doGetChildren(t);if(vB(o))n=Promise.resolve(o);else{let s=Sn(800);s.then(()=>{t.slow=!0,this._onDidChangeNodeSlowState.fire(t)},a=>null),n=o.finally(()=>s.cancel())}}try{let o=await n;return this.setChildren(t,o,e,i)}catch(o){if(t!==this.root&&this.tree.hasElement(t)&&this.tree.collapse(t),al(o))return[];throw o}finally{t.slow&&(t.slow=!1,this._onDidChangeNodeSlowState.fire(t))}}doGetChildren(t){let e=this.refreshPromises.get(t);if(e)return e;let i=this.dataSource.getChildren(t.element);return vB(i)?this.processChildren(i):(e=Sh(async()=>this.processChildren(await i)),this.refreshPromises.set(t,e),e.finally(()=>{this.refreshPromises.delete(t)}))}_onDidChangeCollapseState({node:t,deep:e}){t.element!==null&&!t.collapsed&&t.element.stale&&(e?this.collapse(t.element.element):this.refreshAndRenderNode(t.element,!1).catch(Ke))}setChildren(t,e,i,n){let o=[...e];if(t.children.length===0&&o.length===0)return[];let s=new Map,a=new Map;for(let c of t.children)s.set(c.element,c),this.identityProvider&&a.set(c.id,{node:c,collapsed:this.tree.hasElement(c)&&this.tree.isCollapsed(c)});let l=[],d=o.map(c=>{let u=!!this.dataSource.hasChildren(c);if(!this.identityProvider){let f=dz({element:c,parent:t,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return u&&f.defaultCollapseState===2&&l.push(f),f}let p=this.identityProvider.getId(c).toString(),m=a.get(p);if(m){let f=m.node;return s.delete(f.element),this.nodes.delete(f.element),this.nodes.set(c,f),f.element=c,f.hasChildren=u,i?m.collapsed?(f.children.forEach(b=>fz(b,y=>this.nodes.delete(y.element))),f.children.splice(0,f.children.length),f.stale=!0):l.push(f):u&&!m.collapsed&&l.push(f),f}let g=dz({element:c,parent:t,id:p,hasChildren:u,defaultCollapseState:this.getDefaultCollapseState(c)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(p)>-1&&n.focus.push(g),n&&n.viewState.selection&&n.viewState.selection.indexOf(p)>-1&&n.selection.push(g),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(p)>-1||u&&g.defaultCollapseState===2)&&l.push(g),g});for(let c of s.values())fz(c,u=>this.nodes.delete(u.element));for(let c of d)this.nodes.set(c.element,c);return t.children.splice(0,t.children.length,...d),t!==this.root&&this.autoExpandSingleChildren&&d.length===1&&l.length===0&&(d[0].forceExpanded=!0,l.push(d[0])),l}render(t,e,i){let n=t.children.map(s=>this.asTreeElement(s,e)),o=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(s){return i.diffIdentityProvider.getId(s.element)}}};this.tree.setChildren(t===this.root?null:t,n,o),t!==this.root&&this.tree.setCollapsible(t,t.hasChildren),this._onDidRender.fire()}asTreeElement(t,e){if(t.stale)return{element:t,collapsible:t.hasChildren,collapsed:!0};let i;return e&&e.viewState.expanded&&t.id&&e.viewState.expanded.indexOf(t.id)>-1?i=!1:t.forceExpanded?(i=!1,t.forceExpanded=!1):i=t.defaultCollapseState,{element:t,children:t.hasChildren?Lt.map(t.children,n=>this.asTreeElement(n,e)):[],collapsible:t.hasChildren,collapsed:i}}processChildren(t){return this.sorter&&(t=[...t].sort(this.sorter.compare.bind(this.sorter))),t}getViewState(){if(!this.identityProvider)throw new cn(this.user,"Can't get tree view state without an identity provider");let t=a=>this.identityProvider.getId(a).toString(),e=this.getFocus().map(t),i=this.getSelection().map(t),n=[],o=this.tree.getNode(),s=[o];for(;s.length>0;){let a=s.pop();a!==o&&a.collapsible&&!a.collapsed&&n.push(t(a.element.element)),s.push(...a.children)}return{focus:e,selection:i,expanded:n,scrollTop:this.scrollTop}}dispose(){this.disposables.dispose(),this.tree.dispose()}},bz=class r{constructor(t){this.node=t}get element(){return{elements:this.node.element.elements.map(t=>t.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(t=>new r(t))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}},vz=class{constructor(t,e,i,n){this.renderer=t;this.nodeMapper=e;this.compressibleNodeMapperProvider=i;this.onDidChangeTwistieState=n;this.templateId=t.templateId}templateId;renderedNodes=new Map;disposables=[];renderTemplate(t){return{templateData:this.renderer.renderTemplate(t)}}renderElement(t,e,i,n){this.renderer.renderElement(this.nodeMapper.map(t),e,i.templateData,n)}renderCompressedElements(t,e,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(t),e,i.templateData,n)}renderTwistie(t,e){return t.slow?(e.classList.add(...ye.asClassNameArray(B.treeItemLoading)),!0):(e.classList.remove(...ye.asClassNameArray(B.treeItemLoading)),!1)}disposeElement(t,e,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(t),e,i.templateData,n)}disposeCompressedElements(t,e,i,n){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(t),e,i.templateData,n)}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=nt(this.disposables)}};function Ule(r){let t=r&&_X(r);return t&&{...t,keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(e){return r.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(e.map(i=>i.element))}}}}var rP=class extends lT{constructor(e,i,n,o,s,a,l={}){super(e,i,n,s,a,l);this.compressionDelegate=o;this.filter=l.filter}compressibleNodeMapper=new If(e=>new bz(e));filter;createTree(e,i,n,o,s){let a=new jy(n),l=o.map(c=>new vz(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),d=Ule(s)||{};return new Yy(e,i,a,l,d)}asTreeElement(e,i){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,i)}}updateOptions(e={}){this.tree.updateOptions(e)}getViewState(){if(!this.identityProvider)throw new cn(this.user,"Can't get tree view state without an identity provider");let e=l=>this.identityProvider.getId(l).toString(),i=this.getFocus().map(e),n=this.getSelection().map(e),o=[],s=this.tree.getCompressedTreeNode(),a=[s];for(;a.length>0;){let l=a.pop();if(l!==s&&l.collapsible&&!l.collapsed)for(let d of l.element.elements)o.push(e(d.element));a.push(...l.children)}return{focus:i,selection:n,expanded:o,scrollTop:this.scrollTop}}render(e,i,n){if(!this.identityProvider)return super.render(e,i);let o=g=>this.identityProvider.getId(g).toString(),s=g=>{let f=new Set;for(let b of g){let y=this.tree.getCompressedTreeNode(b===this.root?null:b);if(y.element)for(let I of y.element.elements)f.add(o(I.element))}return f},a=s(this.tree.getSelection()),l=s(this.tree.getFocus());super.render(e,i,n);let d=this.getSelection(),c=!1,u=this.getFocus(),p=!1,m=g=>{let f=g.element;if(f)for(let b=0;b<f.elements.length;b++){let y=o(f.elements[b].element),I=f.elements[f.elements.length-1].element;a.has(y)&&d.indexOf(I)===-1&&(d.push(I),c=!0),l.has(y)&&u.indexOf(I)===-1&&(u.push(I),p=!0)}g.children.forEach(m)};m(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(d),p&&this.setFocus(u)}processChildren(e){return this.filter&&(e=Lt.filter(e,i=>{let n=this.filter.filter(i,1),o=Hle(n);if(o===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return o===1})),super.processChildren(e)}};function Hle(r){return typeof r=="boolean"?r?1:0:sT(r)?Cf(r.visibility):Cf(r)}var sP=class extends $y{constructor(e,i,n,o,s,a={}){super(e,i,n,o,a);this.user=e;this.dataSource=s;this.identityProvider=a.identityProvider}input;identityProvider;nodesByIdentity=new Map;getInput(){return this.input}setInput(e,i){if(i&&!this.identityProvider)throw new cn(this.user,"Can't restore tree view state without an identity provider");if(this.input=e,!e){this.nodesByIdentity.clear(),this.model.setChildren(null,Lt.empty());return}if(!i){this._refresh(e);return}let n=[],o=[],s=l=>{let d=this.identityProvider.getId(l).toString();return!i.expanded[d]},a=l=>{let d=this.identityProvider.getId(l.element).toString();i.focus.has(d)&&n.push(l.element),i.selection.has(d)&&o.push(l.element)};this._refresh(e,s,a),this.setFocus(n),this.setSelection(o),i&&typeof i.scrollTop=="number"&&(this.scrollTop=i.scrollTop)}updateChildren(e=this.input){if(typeof this.input>"u")throw new cn(this.user,"Tree input not set");let i;this.identityProvider&&(i=n=>{let o=this.identityProvider.getId(n).toString(),s=this.nodesByIdentity.get(o);if(s)return s.collapsed}),this._refresh(e,i)}resort(e=this.input,i=!0){this.model.resort(e===this.input?null:e,i)}refresh(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}_refresh(e,i,n){let o;if(this.identityProvider){let s=new Set,a=n;n=l=>{let d=this.identityProvider.getId(l.element).toString();s.add(d),this.nodesByIdentity.set(d,l),a?.(l)},o=l=>{let d=this.identityProvider.getId(l.element).toString();s.has(d)||this.nodesByIdentity.delete(d)}}this.model.setChildren(e===this.input?null:e,this.iterate(e,i).elements,{onDidCreateNode:n,onDidDeleteNode:o})}iterate(e,i){let n=[...this.dataSource.getChildren(e)];return{elements:Lt.map(n,s=>{let{elements:a,size:l}=this.iterate(s,i),d=this.dataSource.hasChildren?this.dataSource.hasChildren(s):void 0,c=l===0?void 0:i&&i(s);return{element:s,children:a,collapsible:d,collapsed:c}}),size:n.length}}createModel(e,i){return new cm(e,i)}};var DX=new ie("isMac",be,h("isMac","Whether the operating system is macOS")),LX=new ie("isLinux",_t,h("isLinux","Whether the operating system is Linux")),kX=new ie("isWindows",rt,h("isWindows","Whether the operating system is Windows")),Zy=new ie("isWeb",wt,h("isWeb","Whether the platform is a web browser")),eu=new ie("isMacNative",be&&!wt,h("isMacNative","Whether the operating system is macOS on a non-browser platform")),aP=new ie("isIOS",Xo,h("isIOS","Whether the operating system is iOS")),RX=new ie("isMobile",R_,h("isMobile","Whether the platform is a mobile web browser")),dT=new ie("isDevelopment",!1,!0),AX=new ie("productQualityType","",h("productQualityType","Quality type of VS Code")),yz="inputFocus",PX=new ie(yz,!1,h("inputFocus","Whether keyboard focus is inside an input box"));var um=$("contextViewService"),Mt=$("contextMenuService");var Xy=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,wf=/(&amp;)?(&amp;)([^\s&])/g;var uT=class r extends gn{constructor(e,i,n,o){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");let s=document.createElement("div");s.classList.add("monaco-menu"),s.setAttribute("role","presentation");super(s,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,n,a),context:n.context,actionRunner:n.actionRunner,ariaLabel:n.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...be||_t?[10]:[]],keyDown:!0}});this.menuStyles=o;this.menuElement=s,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,o),this._register(Wt.addTarget(s)),this._register(M(s,G.KEY_DOWN,c=>{new st(c).equals(2)&&c.preventDefault()})),n.enableMnemonics&&this._register(M(s,G.KEY_DOWN,c=>{let u=c.key.toLocaleLowerCase();if(this.mnemonics.has(u)){Te.stop(c,!0);let p=this.mnemonics.get(u);if(p.length===1&&(p[0]instanceof cT&&p[0].container&&this.focusItemByElement(p[0].container),p[0].onClick(c)),p.length>1){let m=p.shift();m&&m.container&&(this.focusItemByElement(m.container),p.push(m)),this.mnemonics.set(u,p)}}})),_t&&this._register(M(s,G.KEY_DOWN,c=>{let u=new st(c);u.equals(14)||u.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),Te.stop(c,!0)):(u.equals(13)||u.equals(12))&&(this.focusedItem=0,this.focusPrevious(),Te.stop(c,!0))})),this._register(M(this.domNode,G.MOUSE_OUT,c=>{let u=c.relatedTarget;Xi(u,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(M(this.actionsList,G.MOUSE_OVER,c=>{let u=c.target;if(!(!u||!Xi(u,this.actionsList)||u===this.actionsList)){for(;u.parentElement!==this.actionsList&&u.parentElement!==null;)u=u.parentElement;if(u.classList.contains("action-item")){let p=this.focusedItem;this.setFocusedItem(u),p!==this.focusedItem&&this.updateFocus()}}})),this._register(Wt.addTarget(this.actionsList)),this._register(M(this.actionsList,it.Tap,c=>{let u=c.initialTarget;if(!(!u||!Xi(u,this.actionsList)||u===this.actionsList)){for(;u.parentElement!==this.actionsList&&u.parentElement!==null;)u=u.parentElement;if(u.classList.contains("action-item")){let p=this.focusedItem;this.setFocusedItem(u),p!==this.focusedItem&&this.updateFocus()}}}));let a={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new Rd(s,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));let l=this.scrollableElement.getDomNode();l.style.position="",this.styleScrollElement(l,o),this._register(M(s,it.Change,c=>{Te.stop(c,!0);let u=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:u-c.translationY})})),this._register(M(l,G.MOUSE_UP,c=>{c.preventDefault()}));let d=oe(e);s.style.maxHeight=`${Math.max(10,d.innerHeight-e.getBoundingClientRect().top-35)}px`,i=i.filter((c,u)=>n.submenuIds?.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof pt&&(u===i.length-1||u===0||i[u-1]instanceof pt))),this.push(i,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof lP)).forEach((c,u,p)=>{c.updatePositionInSet(u+1,p.length)})}mnemonics;scrollableElement;menuElement;static globalStyleSheet;styleSheet;initializeOrUpdateStyleSheet(e,i){this.styleSheet||(rk(e)?this.styleSheet=Ho(e):(r.globalStyleSheet||(r.globalStyleSheet=Ho()),this.styleSheet=r.globalStyleSheet)),this.styleSheet.textContent=zle(i,rk(e))}styleScrollElement(e,i){let n=i.foregroundColor??"",o=i.backgroundColor??"",s=i.borderColor?`1px solid ${i.borderColor}`:"",a="5px",l=i.shadowColor?`0 2px 8px ${i.shadowColor}`:"";e.style.outline=s,e.style.borderRadius=a,e.style.color=n,e.style.backgroundColor=o,e.style.boxShadow=l}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}get scrollOffset(){return this.menuElement.scrollTop}trigger(e){if(e<=this.viewItems.length&&e>=0){let i=this.viewItems[e];if(i instanceof cT)super.focus(e),i.open(!0);else if(i instanceof pT)super.run(i._action,i._context);else return}}focusItemByElement(e){let i=this.focusedItem;this.setFocusedItem(e),i!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let i=0;i<this.actionsList.children.length;i++){let n=this.actionsList.children[i];if(e===n){this.focusedItem=i;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,i,n){if(e instanceof pt)return new lP(i.context,e,{icon:!0},this.menuStyles);if(e instanceof mn){let o=new cT(e,e.actions,n,{...i,submenuIds:new Set([...i.submenuIds||[],e.id])},this.menuStyles);if(i.enableMnemonics){let s=o.getMnemonic();if(s&&o.isEnabled()){let a=[];this.mnemonics.has(s)&&(a=this.mnemonics.get(s)),a.push(o),this.mnemonics.set(s,a)}}return o}else{let o={enableMnemonics:i.enableMnemonics,useEventAsContext:i.useEventAsContext};if(i.getKeyBinding){let a=i.getKeyBinding(e);if(a){let l=a.getLabel();l&&(o.keybinding=l)}}let s=new pT(i.context,e,o,this.menuStyles);if(i.enableMnemonics){let a=s.getMnemonic();if(a&&s.isEnabled()){let l=[];this.mnemonics.has(a)&&(l=this.mnemonics.get(a)),l.push(s),this.mnemonics.set(a,l)}}return s}}},pT=class extends zn{constructor(e,i,n,o){n.isMenu=!0;super(i,i,n);this.menuStyle=o;if(this.options=n,this.options.icon=n.icon!==void 0?n.icon:!1,this.options.label=n.label!==void 0?n.label:!0,this.cssClass="",this.options.label&&n.enableMnemonics){let s=this.action.label;if(s){let a=Xy.exec(s);a&&(this.mnemonic=(a[1]?a[1]:a[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Et(()=>{this.element&&(this._register(M(this.element,G.MOUSE_UP,s=>{if(Te.stop(s,!0),dn){if(new ri(oe(this.element),s).rightButton)return;this.onClick(s)}else setTimeout(()=>{this.onClick(s)},0)})),this._register(M(this.element,G.CONTEXT_MENU,s=>{Te.stop(s,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}container;options;item;runOnceToEnableMouseUp;label;check;mnemonic;cssClass;render(e){super.render(e),this.element&&(this.container=e,this.item=Ee(this.element,re("a.action-menu-item")),this._action.id===pt.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=Ee(this.item,re("span.menu-item-check"+ye.asCSSSelector(B.menuSelection))),this.check.setAttribute("role","none"),this.label=Ee(this.item,re("span.action-label")),this.options.label&&this.options.keybinding&&(Ee(this.item,re("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item?.focus(),this.applyStyle()}updatePositionInSet(e,i){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${i}`))}updateLabel(){if(this.label&&this.options.label){ci(this.label);let e=HD(this.action.label);if(e){let i=dP(e);this.options.enableMnemonics||(e=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));let n=Xy.exec(e);if(n){e=Ku(e),wf.lastIndex=0;let o=wf.exec(e);for(;o&&o[1];)o=wf.exec(e);let s=a=>a.replace(/&amp;&amp;/g,"&amp;");o?this.label.append(vh(s(e.substr(0,o.index))," "),re("u",{"aria-hidden":"true"},o[3]),Gu(s(e.substr(o.index+o[0].length))," ")):this.label.innerText=s(e).trim(),this.item?.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.innerText=e.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;let e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){let e=this.element&&this.element.classList.contains("focused"),i=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,n=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,o=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",s=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=i??"",this.item.style.backgroundColor=n??"",this.item.style.outline=o,this.item.style.outlineOffset=s),this.check&&(this.check.style.color=i??"")}},cT=class extends pT{constructor(e,i,n,o,s){super(e,e,o,s);this.submenuActions=i;this.parentData=n;this.submenuOptions=o;this.expandDirection=o&&o.expandDirection!==void 0?o.expandDirection:{horizontal:0,vertical:1},this.showScheduler=new Et(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new Et(()=>{this.element&&!Xi(An(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}mysubmenu=null;submenuContainer;submenuIndicator;submenuDisposables=this._register(new W);mouseOver=!1;showScheduler;hideScheduler;expandDirection;render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=Ee(this.item,re("span.submenu-indicator"+ye.asCSSSelector(B.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(M(this.element,G.KEY_UP,i=>{let n=new st(i);(n.equals(17)||n.equals(3))&&(Te.stop(i,!0),this.createSubmenu(!0))})),this._register(M(this.element,G.KEY_DOWN,i=>{let n=new st(i);An()===this.item&&(n.equals(17)||n.equals(3))&&Te.stop(i,!0)})),this._register(M(this.element,G.MOUSE_OVER,i=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(M(this.element,G.MOUSE_LEAVE,i=>{this.mouseOver=!1})),this._register(M(this.element,G.FOCUS_OUT,i=>{this.element&&!Xi(An(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}open(e){this.cleanupExistingSubmenu(!1),this.createSubmenu(e)}onClick(e){Te.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,i,n,o){let s={top:0,left:0};return s.left=c2(e.width,i.width,{position:o.horizontal===0?0:1,offset:n.left,size:n.width}),s.left>=n.left&&s.left<n.left+n.width&&(n.left+10+i.width<=e.width&&(s.left=n.left+10),n.top+=10,n.height=0),s.top=c2(e.height,i.height,{position:0,offset:n.top,size:0}),s.top+i.height===n.top&&s.top+n.height+i.height<=e.height&&(s.top+=n.height),s}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=Ee(this.element,re("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");let i=oe(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),n=parseFloat(i.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new uT(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new YD],this.submenuOptions,this.menuStyle);let o=this.element.getBoundingClientRect(),s={top:o.top-n,left:o.left,height:o.height+2*n,width:o.width},a=this.submenuContainer.getBoundingClientRect(),l=oe(this.element),{top:d,left:c}=this.calculateSubmenuMenuLayout(new dt(l.innerWidth,l.innerHeight),dt.lift(a),s,this.expandDirection);this.submenuContainer.style.left=`${c-a.left}px`,this.submenuContainer.style.top=`${d-a.top}px`,this.submenuDisposables.add(M(this.submenuContainer,G.KEY_UP,u=>{new st(u).equals(15)&&(Te.stop(u,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(M(this.submenuContainer,G.KEY_DOWN,u=>{new st(u).equals(15)&&Te.stop(u,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){this.item&&this.item?.setAttribute("aria-expanded",e)}applyStyle(){super.applyStyle();let i=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=i??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}},lP=class extends Nd{constructor(e,i,n,o){super(e,i,n);this.menuStyles=o}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}};function dP(r){let t=Xy,e=t.exec(r);if(!e)return r;let i=!e[1];return r.replace(t,i?"$2$3":"").trim()}function MX(r){let t=UD()[r.id];return`.codicon-${r.id}:before { content: '\\${t.toString(16)}'; }`}function zle(r,t){let e=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${MX(B.menuSelection)}
${MX(B.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(t){e+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;let i=r.scrollbarShadow;i&&(e+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);let n=r.scrollbarSliderBackground;n&&(e+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);let o=r.scrollbarSliderHoverBackground;o&&(e+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${o};
				}
			`);let s=r.scrollbarSliderActiveBackground;s&&(e+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${s};
				}
			`)}return e}var Iz=class extends wn{_element;boxContainer;_label;contents;visible;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;hover;constructor(t,e){super(),this._element=Ee(t,re(".monaco-dropdown")),this._label=Ee(this._element,re(".dropdown-label"));let i=e.labelRenderer;i||(i=o=>(o.textContent=e.label||"",null));for(let o of[G.CLICK,G.MOUSE_DOWN,it.Tap])this._register(M(this.element,o,s=>Te.stop(s,!0)));for(let o of[G.MOUSE_DOWN,it.Tap])this._register(M(this._label,o,s=>{Na(s)&&(s.detail>1||s.button!==0)||(this.visible?this.hide():this.show())}));this._register(M(this._label,G.KEY_UP,o=>{let s=new st(o);(s.equals(3)||s.equals(10))&&(Te.stop(o,!0),this.visible?this.hide():this.show())}));let n=i(this._label);n&&this._register(n),this._register(Wt.addTarget(this._label))}get element(){return this._element}get label(){return this._label}set tooltip(t){this._label&&(!this.hover&&t!==""?this.hover=this._register($n().setupManagedHover(zt("mouse"),this._label,t)):this.hover&&this.hover.update(t))}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}isVisible(){return!!this.visible}onEvent(t,e){this.hide()}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}},cP=class extends Iz{constructor(e,i){super(e,i);this._options=i;this.actions=i.actions||[]}_menuOptions;_actions=[];set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,i)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,i):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}};var Vwt={buttonBackground:"#0E639C",buttonHoverBackground:"#006BB3",buttonSeparator:Y.white.toString(),buttonForeground:Y.white.toString(),buttonBorder:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0},Lp=class extends L{options;_element;_label="";_labelElement;_labelShortElement;_hover;_onDidClick=this._register(new T);get onDidClick(){return this._onDidClick.event}_onDidEscape=this._register(new T);get onDidEscape(){return this._onDidEscape.event}focusTracker;constructor(t,e){super(),this.options=e,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!e.secondary);let i=e.secondary?e.buttonSecondaryBackground:e.buttonBackground,n=e.secondary?e.buttonSecondaryForeground:e.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",e.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof e.title=="string"&&this.setTitle(e.title),typeof e.ariaLabel=="string"&&this._element.setAttribute("aria-label",e.ariaLabel),t.appendChild(this._element),this._register(Wt.addTarget(this._element)),[G.CLICK,it.Tap].forEach(o=>{this._register(M(this._element,o,s=>{if(!this.enabled){Te.stop(s);return}this._onDidClick.fire(s)}))}),this._register(M(this._element,G.KEY_DOWN,o=>{let s=new st(o),a=!1;this.enabled&&(s.equals(3)||s.equals(10))?(this._onDidClick.fire(o),a=!0):s.equals(9)&&(this._onDidEscape.fire(o),this._element.blur(),a=!0),a&&Te.stop(s,!0)})),this._register(M(this._element,G.MOUSE_OVER,o=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(M(this._element,G.MOUSE_OUT,o=>{this.updateBackground(!1)})),this.focusTracker=this._register(Un(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(t){let e=[];for(let i of Rs(t))if(typeof i=="string"){if(i=i.trim(),i==="")continue;let n=document.createElement("span");n.textContent=i,e.push(n)}else e.push(i);return e}updateBackground(t){let e;this.options.secondary?e=t?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:e=t?this.options.buttonHoverBackground:this.options.buttonBackground,e&&(this._element.style.backgroundColor=e)}get element(){return this._element}set label(t){if(this._label===t||xh(this._label)&&xh(t)&&zD(this._label,t))return;this._element.classList.add("monaco-text-button");let e=this.options.supportShortLabel?this._labelElement:this._element;if(xh(t)){let n=VA(t,{inline:!0});n.dispose();let o=n.element.querySelector("p")?.innerHTML;if(o){let s=qw(o,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});e.innerHTML=s}else Tn(e)}else this.options.supportIcons?Tn(e,...this.getContentElements(t)):e.textContent=t;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=B2(t)),this.setTitle(i),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",i),this._label=t}get label(){return this._label}set labelShort(t){!this.options.supportShortLabel||!this._labelShortElement||(this.options.supportIcons?Tn(this._labelShortElement,...this.getContentElements(t)):this._labelShortElement.textContent=t)}set icon(t){this._element.classList.add(...ye.asClassNameArray(t))}set enabled(t){t?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}set checked(t){t?(this._element.classList.add("checked"),this._element.setAttribute("aria-checked","true")):(this._element.classList.remove("checked"),this._element.setAttribute("aria-checked","false"))}get checked(){return this._element.classList.contains("checked")}setTitle(t){!this._hover&&t!==""?this._hover=this._register($n().setupManagedHover(this.options.hoverDelegate??zt("mouse"),this._element,t)):this._hover&&this._hover.update(t)}focus(){this._element.focus()}hasFocus(){return os(this._element)}},Cz=class extends L{button;action;dropdownButton;separatorContainer;separator;element;_onDidClick=this._register(new T);onDidClick=this._onDidClick.event;constructor(t,e){super(),this.element=document.createElement("div"),this.element.classList.add("monaco-button-dropdown"),t.appendChild(this.element),this.button=this._register(new Lp(this.element,e)),this._register(this.button.onDidClick(o=>this._onDidClick.fire(o))),this.action=this._register(new ot("primaryAction",B2(this.button.label),void 0,!0,async()=>this._onDidClick.fire(void 0))),this.separatorContainer=document.createElement("div"),this.separatorContainer.classList.add("monaco-button-dropdown-separator"),this.separator=document.createElement("div"),this.separatorContainer.appendChild(this.separator),this.element.appendChild(this.separatorContainer);let i=e.buttonBorder;i&&(this.separatorContainer.style.borderTop="1px solid "+i,this.separatorContainer.style.borderBottom="1px solid "+i);let n=e.secondary?e.buttonSecondaryBackground:e.buttonBackground;this.separatorContainer.style.backgroundColor=n??"",this.separator.style.backgroundColor=e.buttonSeparator??"",this.dropdownButton=this._register(new Lp(this.element,{...e,title:!1,supportIcons:!0})),this._register($n().setupManagedHover(zt("mouse"),this.dropdownButton.element,h("button dropdown more actions","More Actions..."))),this.dropdownButton.element.setAttribute("aria-haspopup","true"),this.dropdownButton.element.setAttribute("aria-expanded","false"),this.dropdownButton.element.classList.add("monaco-dropdown-button"),this.dropdownButton.icon=B.dropDownButton,this._register(this.dropdownButton.onDidClick(o=>{let s=Array.isArray(e.actions)?e.actions:e.actions.getActions();e.contextMenuProvider.showContextMenu({getAnchor:()=>this.dropdownButton.element,getActions:()=>e.addPrimaryActionToDropdown===!1?[...s]:[this.action,...s],actionRunner:e.actionRunner,onHide:()=>this.dropdownButton.element.setAttribute("aria-expanded","false")}),this.dropdownButton.element.setAttribute("aria-expanded","true")}))}dispose(){super.dispose(),this.element.remove()}set label(t){this.button.label=t,this.action.label=t}set icon(t){this.button.icon=t}set enabled(t){this.button.enabled=t,this.dropdownButton.enabled=t,this.element.classList.toggle("disabled",!t)}get enabled(){return this.button.enabled}set checked(t){this.button.checked=t}get checked(){return this.button.checked}focus(){this.button.focus()}hasFocus(){return this.button.hasFocus()||this.dropdownButton.hasFocus()}},uP=class{constructor(t,e){this.options=e;this._element=document.createElement("div"),this._element.classList.add("monaco-description-button"),this._button=new Lp(this._element,e),this._descriptionElement=document.createElement("div"),this._descriptionElement.classList.add("monaco-button-description"),this._element.appendChild(this._descriptionElement),t.appendChild(this._element)}_button;_element;_descriptionElement;get onDidClick(){return this._button.onDidClick}get element(){return this._element}set label(t){this._button.label=t}set icon(t){this._button.icon=t}get enabled(){return this._button.enabled}set enabled(t){this._button.enabled=t}set checked(t){this._button.checked=t}get checked(){return this._button.checked}focus(){this._button.focus()}hasFocus(){return this._button.hasFocus()}dispose(){this._button.dispose()}set description(t){this.options.supportIcons?Tn(this._descriptionElement,...Rs(t)):this._descriptionElement.textContent=t}},hT=class{constructor(t){this.container=t}_buttons=[];_buttonStore=new W;dispose(){this._buttonStore.dispose()}get buttons(){return this._buttons}clear(){this._buttonStore.clear(),this._buttons.length=0}addButton(t){let e=this._buttonStore.add(new Lp(this.container,t));return this.pushButton(e),e}addButtonWithDescription(t){let e=this._buttonStore.add(new uP(this.container,t));return this.pushButton(e),e}addButtonWithDropdown(t){let e=this._buttonStore.add(new Cz(this.container,t));return this.pushButton(e),e}pushButton(t){this._buttons.push(t);let e=this._buttons.length-1;this._buttonStore.add(M(t.element,G.KEY_DOWN,i=>{let n=new st(i),o=!0,s;n.equals(15)?s=e>0?e-1:this._buttons.length-1:n.equals(17)?s=e===this._buttons.length-1?0:e+1:o=!1,o&&typeof s=="number"&&(this._buttons[s].focus(),Te.stop(i,!0))}))}};var Qy=class{modifierLabels;constructor(t,e,i=e){this.modifierLabels=[null],this.modifierLabels[2]=t,this.modifierLabels[1]=e,this.modifierLabels[3]=i}toLabel(t,e,i){if(e.length===0)return null;let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=i(a);if(l===null)return null;n[o]=Kle(a,l,this.modifierLabels[t])}return n.join(" ")}},Sz=new Qy({ctrlKey:"\u2303",shiftKey:"\u21E7",altKey:"\u2325",metaKey:"\u2318",separator:""},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:h({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),Kwt=new Qy({ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:h({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:h({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:h({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:h({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:h({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),Gwt=new Qy({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),qwt=new Qy({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function Kle(r,t,e){if(t===null)return"";let i=[];return r.ctrlKey&&i.push(e.ctrlKey),r.shiftKey&&i.push(e.shiftKey),r.altKey&&i.push(e.altKey),r.metaKey&&i.push(e.metaKey),t!==""&&i.push(t),i.join(e.separator)}var Gle=()=>({msLoopTime:-1,msDelayTime:-1,dispose:()=>{}}),OX=Gle;function NX(r){OX=r}function FX(r,t){return OX(r,t)}var wz="done",Ez="active",pP="infinite",hP="infinite-long-running",Tz="discrete";var pm=class r extends L{static LONG_RUNNING_INFINITE_THRESHOLD=1e4;static PROGRESS_SIGNAL_DEFAULT_DELAY=3e3;workedVal;element;bit;totalWork;showDelayedScheduler;longRunningScheduler;progressSignal=this._register(new mt);constructor(t,e){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new Et(()=>rs(this.element),0)),this.longRunningScheduler=this._register(new Et(()=>this.infiniteLongRunning(),r.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(t,e)}create(t,e){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),t.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=e?.progressBarBackground||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(Ez,pP,hP,Tz),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}done(){return this.doDone(!0)}stop(){return this.doDone(!1)}doDone(t){return this.element.classList.add(wz),this.element.classList.contains(pP)?(this.bit.style.opacity="0",t?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",t?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(Tz,wz,hP),this.element.classList.add(Ez,pP),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(hP)}total(t){return this.workedVal=0,this.totalWork=t,this.element.setAttribute("aria-valuemax",t.toString()),this}hasTotal(){return Vo(this.totalWork)}worked(t){return t=Math.max(1,Number(t)),this.doSetWorked(this.workedVal+t)}setWorked(t){return t=Math.max(1,Number(t)),this.doSetWorked(t)}doSetWorked(t){let e=this.totalWork||100;return this.workedVal=t,this.workedVal=Math.min(e,this.workedVal),this.element.classList.remove(pP,hP,wz),this.element.classList.add(Ez,Tz),this.element.setAttribute("aria-valuenow",t.toString()),this.bit.style.width=100*(this.workedVal/e)+"%",this}getContainer(){return this.element}show(t){this.showDelayedScheduler.cancel(),this.progressSignal.value=FX(r.PROGRESS_SIGNAL_DEFAULT_DELAY),typeof t=="number"?this.showDelayedScheduler.schedule(t):rs(this.element)}hide(){ys(this.element),this.showDelayedScheduler.cancel(),this.progressSignal.clear()}};var Jy=class{},mP=class{_disposables=new W;_domNode;_scrollable;_onDidSelectItem=new T;_onDidFocusItem=new T;_onDidChangeFocus=new T;onDidSelectItem=this._onDidSelectItem.event;onDidFocusItem=this._onDidFocusItem.event;onDidChangeFocus=this._onDidChangeFocus.event;_items=new Array;_nodes=new Array;_freeNodes=new Array;_separatorIcon;_enabled=!0;_focusedItemIdx=-1;_selectedItemIdx=-1;_pendingDimLayout;_pendingLayout;_dimension;constructor(t,e,i,n){this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new Rd(this._domNode,{vertical:2,horizontal:1,horizontalScrollbarSize:e,useShadows:!1,scrollYToX:!0}),this._separatorIcon=i,this._disposables.add(this._scrollable),this._disposables.add(Wi(this._domNode,"click",a=>this._onClick(a))),t.appendChild(this._scrollable.getDomNode());let o=Ho(this._domNode);this._style(o,n);let s=Un(this._domNode);this._disposables.add(s),this._disposables.add(s.onDidBlur(a=>this._onDidChangeFocus.fire(!1))),this._disposables.add(s.onDidFocus(a=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(t){this._scrollable.updateOptions({horizontalScrollbarSize:t})}dispose(){this._disposables.dispose(),this._pendingLayout?.dispose(),this._pendingDimLayout?.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(t){t&&dt.equals(t,this._dimension)||(t?(this._pendingDimLayout?.dispose(),this._pendingDimLayout=this._updateDimensions(t)):(this._pendingLayout?.dispose(),this._pendingLayout=this._updateScrollbar()))}_updateDimensions(t){let e=new W;return e.add(qj(oe(this._domNode),()=>{this._dimension=t,this._domNode.style.width=`${t.width}px`,this._domNode.style.height=`${t.height}px`,e.add(this._updateScrollbar())})),e}_updateScrollbar(){return rW(oe(this._domNode),()=>{rW(oe(this._domNode),()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(t,e){let i="";e.breadcrumbsBackground&&(i+=`.monaco-breadcrumbs { background-color: ${e.breadcrumbsBackground}}`),e.breadcrumbsForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item { color: ${e.breadcrumbsForeground}}
`),e.breadcrumbsFocusForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ${e.breadcrumbsFocusForeground}}
`),e.breadcrumbsFocusAndSelectionForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ${e.breadcrumbsFocusAndSelectionForeground}}
`),e.breadcrumbsHoverForeground&&(i+=`.monaco-breadcrumbs:not(.disabled	) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ${e.breadcrumbsHoverForeground}}
`),t.innerText=i}setEnabled(t){this._enabled=t,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){let t=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;t>=0&&t<this._items.length?this._focus(t,void 0):this._domNode.focus()}isDOMFocused(){return Oa(this._domNode)}getFocused(){return this._items[this._focusedItemIdx]}setFocused(t,e){this._focus(this._items.indexOf(t),e)}focusPrev(t){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,t)}focusNext(t){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,t)}_focus(t,e){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let n=this._nodes[i];i!==t?n.classList.remove("focused"):(this._focusedItemIdx=i,n.classList.add("focused"),n.focus())}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:e})}reveal(t){let e=this._items.indexOf(t);e>=0&&this._reveal(e,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(t,e){if(t<0||t>=this._nodes.length)return;let i=this._nodes[t];if(!i)return;let{width:n}=this._scrollable.getScrollDimensions(),{scrollLeft:o}=this._scrollable.getScrollPosition();(!e||i.offsetLeft>o+n||i.offsetLeft<o)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(t,e){this._select(this._items.indexOf(t),e)}_select(t,e){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let n=this._nodes[i];i!==t?n.classList.remove("selected"):(this._selectedItemIdx=i,n.classList.add("selected"))}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:e})}getItems(){return this._items}setItems(t){let e,i=[];try{e=b7(this._items,t,(n,o)=>n.equals(o)),i=this._items.splice(e,this._items.length-e,...t.slice(e)),this._render(e),nt(i),this._focus(-1,void 0)}catch(n){let o=new Error(`BreadcrumbsItem#setItems: newItems: ${t.length}, prefix: ${e}, removed: ${i.length}`);throw o.name=n.name,o.stack=n.stack,o}}_render(t){let e=!1;for(;t<this._items.length&&t<this._nodes.length;t++){let i=this._items[t],n=this._nodes[t];this._renderItem(i,n),e=!0}for(;t<this._nodes.length;){let i=this._nodes.pop();i&&(this._freeNodes.push(i),i.remove(),e=!0)}for(;t<this._items.length;t++){let i=this._items[t],n=this._freeNodes.length>0?this._freeNodes.pop():document.createElement("div");n&&(this._renderItem(i,n),this._domNode.appendChild(n),this._nodes.push(n),e=!0)}e&&this.layout(void 0)}_renderItem(t,e){ci(e),e.className="";try{t.render(e)}catch(n){e.innerText="<<RENDER ERROR>>",console.error(n)}e.tabIndex=-1,e.setAttribute("role","listitem"),e.classList.add("monaco-breadcrumb-item");let i=re(ye.asCSSSelector(this._separatorIcon));e.appendChild(i)}_onClick(t){if(this._enabled)for(let e=t.target;e;e=e.parentElement){let i=this._nodes.indexOf(e);if(i>=0){this._focus(i,t),this._select(i,t);break}}}};function qle(r,t){let e={...t};for(let i in r){let n=r[i];e[i]=n!==void 0?Se(n):void 0}return e}var ext={keybindingLabelBackground:Se(R6),keybindingLabelForeground:Se(A6),keybindingLabelBorder:Se(P6),keybindingLabelBottomBorder:Se(M6),keybindingLabelShadow:Se(pl)};var gP={buttonForeground:Se(_V),buttonSeparator:Se(b6),buttonBackground:Se(wv),buttonHoverBackground:Se(v6),buttonSecondaryForeground:Se(I6),buttonSecondaryBackground:Se(IL),buttonSecondaryHoverBackground:Se(C6),buttonBorder:Se(y6)};var eI={progressBarBackground:Se(O3)};var jle={inputActiveOptionBorder:Se(EV),inputActiveOptionForeground:Se(xV),inputActiveOptionBackground:Se(TV)},txt={activeForeground:Se(Ev),activeBackground:Se(S6),activeBorder:Se(w6),inactiveForeground:Se(E6),inactiveBackground:Se(T6),inactiveBorder:Se(x6),inactiveHoverBackground:Se(_6)};var ixt={checkboxBackground:Se(D6),checkboxBorder:Se(k6),checkboxForeground:Se(L6)};var nxt={dialogBackground:Se(nr),dialogForeground:Se(Sc),dialogShadow:Se(pl),dialogBorder:Se(Le),errorIconForeground:Se(J3),warningIconForeground:Se(e6),infoIconForeground:Se(t6),textLinkForeground:Se(mL)};var xz={inputBackground:Se(r6),inputForeground:Se(s6),inputBorder:Se(Tv),inputValidationInfoBorder:Se(d6),inputValidationInfoBackground:Se(a6),inputValidationInfoForeground:Se(l6),inputValidationWarningBorder:Se(p6),inputValidationWarningBackground:Se(c6),inputValidationWarningForeground:Se(u6),inputValidationErrorBorder:Se(g6),inputValidationErrorBackground:Se(h6),inputValidationErrorForeground:Se(m6)};var BX={listFilterWidgetBackground:Se(q6),listFilterWidgetOutline:Se(j6),listFilterWidgetNoMatchesOutline:Se($6),listFilterWidgetShadow:Se(Y6),inputBoxStyles:xz,toggleStyles:jle},oxt={badgeBackground:Se(ul),badgeForeground:Se(Mh),badgeBorder:Se(Le)};var fP={breadcrumbsBackground:Se(Z3),breadcrumbsForeground:Se(Y3),breadcrumbsHoverForeground:Se(IV),breadcrumbsFocusForeground:Se(IV),breadcrumbsFocusAndSelectionForeground:Se(X3)};var tI={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:Se(O6),listFocusForeground:Se(N6),listFocusOutline:Se(F6),listActiveSelectionBackground:Se(or),listActiveSelectionForeground:Se(ta),listActiveSelectionIconForeground:Se(SL),listFocusAndSelectionOutline:Se(B6),listFocusAndSelectionBackground:Se(or),listFocusAndSelectionForeground:Se(ta),listInactiveSelectionBackground:Se(V6),listInactiveSelectionIconForeground:Se(U6),listInactiveSelectionForeground:Se(W6),listInactiveFocusBackground:Se(H6),listInactiveFocusOutline:Se(z6),listHoverBackground:Se(DV),listHoverForeground:Se(LV),listDropOverBackground:Se(K6),listDropBetweenBackground:Se(G6),listSelectionOutline:Se(oi),listHoverOutline:Se(oi),treeIndentGuidesStroke:Se(_v),treeInactiveIndentGuidesStroke:Se(Z6),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:Se(Oh),tableColumnsBorder:Se(X6),tableOddRowsBackgroundColor:Se(Q6)};function mT(r){return qle(r,tI)}var VX={selectBackground:Se(xv),selectListBackground:Se(f6),selectForeground:Se(Pw),decoratorRightForeground:Se(aq),selectBorder:Se(Mw),focusBorder:Se(ir),listFocusBackground:Se(cq),listInactiveSelectionIconForeground:Se(dq),listFocusForeground:Se(lq),listFocusOutline:k3(oi,Y.transparent.toString()),listHoverBackground:Se(DV),listHoverForeground:Se(LV),listHoverOutline:Se(oi),selectListBorder:Se(yV),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0};var WX={shadowColor:Se(pl),borderColor:Se(J6),foregroundColor:Se(eq),backgroundColor:Se(tq),selectionForegroundColor:Se(iq),selectionBackgroundColor:Se(nq),selectionBorderColor:Se(oq),separatorColor:Se(rq),scrollbarShadow:Se(Oh),scrollbarSliderBackground:Se(gL),scrollbarSliderHoverBackground:Se(fL),scrollbarSliderActiveBackground:Se(bL)};var ko=$("listService");var gT=new ie("listScrollAtBoundary","none"),T_t=X.or(gT.isEqualTo("top"),gT.isEqualTo("both")),x_t=X.or(gT.isEqualTo("bottom"),gT.isEqualTo("both")),UX=new ie("listFocus",!0),HX=new ie("treestickyScrollFocused",!1),LP=new ie("listSupportsMultiselect",!0),kP=X.and(UX,X.not(yz),HX.negate()),kz=new ie("listHasSelectionOrFocus",!1),Rz=new ie("listDoubleSelection",!1),Az=new ie("listMultiSelection",!1),RP=new ie("listSelectionNavigation",!1),$le=new ie("listSupportsFind",!0),Yle=new ie("treeElementCanCollapse",!1),Zle=new ie("treeElementHasParent",!1),Xle=new ie("treeElementCanExpand",!1),Qle=new ie("treeElementHasChild",!1),Jle=new ie("treeFindOpen",!1),zX="listTypeNavigationMode",KX="listAutomaticKeyboardNavigation";function AP(r,t){let e=r.createScoped(t.getHTMLElement());return UX.bindTo(e),e}function PP(r,t){let e=gT.bindTo(r),i=()=>{let n=t.scrollTop===0,o=t.scrollHeight-t.renderHeight-t.scrollTop<1;n&&o?e.set("both"):n?e.set("top"):o?e.set("bottom"):e.set("none")};return i(),t.onDidScroll(i)}var Ef="workbench.list.multiSelectModifier",SP="workbench.list.openMode",za="workbench.list.horizontalScrolling",Pz="workbench.list.defaultFindMode",Mz="workbench.list.typeNavigationMode",wP="workbench.list.keyboardNavigation",Bd="workbench.list.scrollByPage",Oz="workbench.list.defaultFindMatchType",fT="workbench.tree.indent",EP="workbench.tree.renderIndentGuides",Vd="workbench.list.smoothScrolling",iu="workbench.list.mouseWheelScrollSensitivity",nu="workbench.list.fastScrollSensitivity",TP="workbench.tree.expandMode",xP="workbench.tree.enableStickyScroll",_P="workbench.tree.stickyScrollMaxItemCount";function ou(r){return r.getValue(Ef)==="alt"}var _z=class extends L{constructor(e){super();this.configurationService=e;this.useAltAsMultipleSelectionModifier=ou(e),this.registerListeners()}useAltAsMultipleSelectionModifier;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Ef)&&(this.useAltAsMultipleSelectionModifier=ou(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:T2(e)}isSelectionRangeChangeEvent(e){return x2(e)}};function MP(r,t){let e=r.get(de),i=r.get(at),n=new W;return[{...t,keyboardNavigationDelegate:{mightProducePrintableCharacter(s){return i.mightProducePrintableCharacter(s)}},smoothScrolling:!!e.getValue(Vd),mouseWheelScrollSensitivity:e.getValue(iu),fastScrollSensitivity:e.getValue(nu),multipleSelectionController:t.multipleSelectionController??n.add(new _z(e)),keyboardNavigationEventFilter:ede(i),scrollByPage:!!e.getValue(Bd)},n]}var tu=class extends Lo{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let c=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(za),[u,p]=d.invokeFunction(MP,o);super(t,e,i,n,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables.add(p),this.contextKeyService=AP(s,this),this.disposables.add(PP(this.contextKeyService,this)),this.listSupportsMultiSelect=LP.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),RP.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=kz.bindTo(this.contextKeyService),this.listDoubleSelection=Rz.bindTo(this.contextKeyService),this.listMultiSelection=Az.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=ou(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let g=this.getSelection(),f=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||f.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let g=this.getSelection(),f=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||f.length>0)})),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(Ef)&&(this._useAltAsMultipleSelectionModifier=ou(l));let f={};if(g.affectsConfiguration(za)&&this.horizontalScrolling===void 0){let b=!!l.getValue(za);f={...f,horizontalScrolling:b}}if(g.affectsConfiguration(Bd)){let b=!!l.getValue(Bd);f={...f,scrollByPage:b}}if(g.affectsConfiguration(Vd)){let b=!!l.getValue(Vd);f={...f,smoothScrolling:b}}if(g.affectsConfiguration(iu)){let b=l.getValue(iu);f={...f,mouseWheelScrollSensitivity:b}}if(g.affectsConfiguration(nu)){let b=l.getValue(nu);f={...f,fastScrollSensitivity:b}}Object.keys(f).length>0&&this.updateOptions(f)})),this.navigator=new DP(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?mT(t):tI)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}};tu=_([v(5,ke),v(6,ko),v(7,de),v(8,ae)],tu);var bP=class extends PA{contextKeyService;disposables;listSupportsMultiSelect;_useAltAsMultipleSelectionModifier;horizontalScrolling;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let c=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(za),[u,p]=d.invokeFunction(MP,o);super(t,e,i,n,{keyboardSupport:!1,...u,horizontalScrolling:c}),this.disposables=new W,this.disposables.add(p),this.contextKeyService=AP(s,this),this.disposables.add(PP(this.contextKeyService,this.widget)),this.horizontalScrolling=o.horizontalScrolling,this.listSupportsMultiSelect=LP.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),RP.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this._useAltAsMultipleSelectionModifier=ou(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(Ef)&&(this._useAltAsMultipleSelectionModifier=ou(l));let f={};if(g.affectsConfiguration(za)&&this.horizontalScrolling===void 0){let b=!!l.getValue(za);f={...f,horizontalScrolling:b}}if(g.affectsConfiguration(Bd)){let b=!!l.getValue(Bd);f={...f,scrollByPage:b}}if(g.affectsConfiguration(Vd)){let b=!!l.getValue(Vd);f={...f,smoothScrolling:b}}if(g.affectsConfiguration(iu)){let b=l.getValue(iu);f={...f,mouseWheelScrollSensitivity:b}}if(g.affectsConfiguration(nu)){let b=l.getValue(nu);f={...f,fastScrollSensitivity:b}}Object.keys(f).length>0&&this.updateOptions(f)})),this.navigator=new DP(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?mT(t):tI)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};bP=_([v(5,ke),v(6,ko),v(7,de),v(8,ae)],bP);var vP=class extends NA{contextKeyService;listSupportsMultiSelect;listHasSelectionOrFocus;listDoubleSelection;listMultiSelection;horizontalScrolling;_useAltAsMultipleSelectionModifier;navigator;get onDidOpen(){return this.navigator.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c){let u=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!d.getValue(za),[p,m]=c.invokeFunction(MP,s);super(t,e,i,n,o,{keyboardSupport:!1,...p,horizontalScrolling:u}),this.disposables.add(m),this.contextKeyService=AP(a,this),this.disposables.add(PP(this.contextKeyService,this)),this.listSupportsMultiSelect=LP.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),RP.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this.listHasSelectionOrFocus=kz.bindTo(this.contextKeyService),this.listDoubleSelection=Rz.bindTo(this.contextKeyService),this.listMultiSelection=Az.bindTo(this.contextKeyService),this.horizontalScrolling=s.horizontalScrolling,this._useAltAsMultipleSelectionModifier=ou(d),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(s.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{let f=this.getSelection(),b=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(f.length>0||b.length>0),this.listMultiSelection.set(f.length>1),this.listDoubleSelection.set(f.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{let f=this.getSelection(),b=this.getFocus();this.listHasSelectionOrFocus.set(f.length>0||b.length>0)})),this.disposables.add(d.onDidChangeConfiguration(f=>{f.affectsConfiguration(Ef)&&(this._useAltAsMultipleSelectionModifier=ou(d));let b={};if(f.affectsConfiguration(za)&&this.horizontalScrolling===void 0){let y=!!d.getValue(za);b={...b,horizontalScrolling:y}}if(f.affectsConfiguration(Bd)){let y=!!d.getValue(Bd);b={...b,scrollByPage:y}}if(f.affectsConfiguration(Vd)){let y=!!d.getValue(Vd);b={...b,smoothScrolling:y}}if(f.affectsConfiguration(iu)){let y=d.getValue(iu);b={...b,mouseWheelScrollSensitivity:y}}if(f.affectsConfiguration(nu)){let y=d.getValue(nu);b={...b,fastScrollSensitivity:y}}Object.keys(b).length>0&&this.updateOptions(b)})),this.navigator=new Dz(this,{configurationService:d,...s}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?mT(t):tI)}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}dispose(){this.disposables.dispose(),super.dispose()}};vP=_([v(6,ke),v(7,ko),v(8,de),v(9,ae)],vP);var bT=class extends L{constructor(e,i){super();this.widget=e;this._register(O.filter(this.widget.onDidChangeSelection,n=>bl(n.browserEvent))(n=>this.onSelectionFromKeyboard(n))),this._register(this.widget.onPointer(n=>this.onPointer(n.element,n.browserEvent))),this._register(this.widget.onMouseDblClick(n=>this.onMouseDblClick(n.element,n.browserEvent))),typeof i?.openOnSingleClick!="boolean"&&i?.configurationService?(this.openOnSingleClick=i?.configurationService.getValue(SP)!=="doubleClick",this._register(i?.configurationService.onDidChangeConfiguration(n=>{n.affectsConfiguration(SP)&&(this.openOnSingleClick=i?.configurationService.getValue(SP)!=="doubleClick")}))):this.openOnSingleClick=i?.openOnSingleClick??!0}openOnSingleClick;_onDidOpen=this._register(new T);onDidOpen=this._onDidOpen.event;onSelectionFromKeyboard(e){if(e.elements.length!==1)return;let i=e.browserEvent,n=typeof i.preserveFocus=="boolean"?i.preserveFocus:!0,o=typeof i.pinned=="boolean"?i.pinned:!n;this._open(this.getSelectedElement(),n,o,!1,e.browserEvent)}onPointer(e,i){if(!this.openOnSingleClick||i.detail===2)return;let o=i.button===1,s=!0,a=o,l=i.ctrlKey||i.metaKey||i.altKey;this._open(e,s,a,l,i)}onMouseDblClick(e,i){if(!i)return;let n=i.target;if(n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&i.offsetX<16)return;let s=!1,a=!0,l=i.ctrlKey||i.metaKey||i.altKey;this._open(e,s,a,l,i)}_open(e,i,n,o,s){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:i,pinned:n,revealIfVisible:!0},sideBySide:o,element:e,browserEvent:s})}},DP=class extends bT{widget;constructor(t,e){super(t,e),this.widget=t}getSelectedElement(){return this.widget.getSelectedElements()[0]}},Dz=class extends bT{constructor(t,e){super(t,e)}getSelectedElement(){return this.widget.getSelectedElements()[0]}},Lz=class extends bT{constructor(t,e){super(t,e)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}};function ede(r){let t=!1;return e=>{if(e.toKeyCodeChord().isModifierKey())return!1;if(t)return t=!1,!1;let i=r.softDispatch(e,e.target);return i.kind===1?(t=!0,!1):(t=!1,i.kind===0)}}var yP=class extends Sf{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(vT,o);super(t,e,i,n,c),this.disposables.add(p),this.internals=new kp(this,o,u,o.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(t){super.updateOptions(t),this.internals.updateOptions(t)}};yP=_([v(5,ae),v(6,ke),v(7,ko),v(8,de)],yP);var IP=class extends Yy{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d){let{options:c,getTypeNavigationMode:u,disposable:p}=s.invokeFunction(vT,o);super(t,e,i,n,c),this.disposables.add(p),this.internals=new kp(this,o,u,o.overrideStyles,a,l,d),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};IP=_([v(5,ae),v(6,ke),v(7,ko),v(8,de)],IP);var hm=class extends sP{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:m}=a.invokeFunction(vT,s);super(t,e,i,n,o,u),this.disposables.add(m),this.internals=new kp(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles!==void 0&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};hm=_([v(6,ae),v(7,ke),v(8,ko),v(9,de)],hm);var mm=class extends lT{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c){let{options:u,getTypeNavigationMode:p,disposable:m}=a.invokeFunction(vT,s);super(t,e,i,n,o,u),this.disposables.add(m),this.internals=new kp(this,s,p,s.overrideStyles,l,d,c),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};mm=_([v(6,ae),v(7,ke),v(8,ko),v(9,de)],mm);var CP=class extends rP{internals;get contextKeyService(){return this.internals.contextKeyService}get useAltAsMultipleSelectionModifier(){return this.internals.useAltAsMultipleSelectionModifier}get onDidOpen(){return this.internals.onDidOpen}constructor(t,e,i,n,o,s,a,l,d,c,u){let{options:p,getTypeNavigationMode:m,disposable:g}=l.invokeFunction(vT,a);super(t,e,i,n,o,s,p),this.disposables.add(g),this.internals=new kp(this,a,m,a.overrideStyles,d,c,u),this.disposables.add(this.internals)}updateOptions(t){super.updateOptions(t),this.internals.updateOptions(t)}};CP=_([v(7,ae),v(8,ke),v(9,ko),v(10,de)],CP);function GX(r){let t=r.getValue(Pz);if(t==="highlight")return 0;if(t==="filter")return 1;let e=r.getValue(wP);if(e==="simple"||e==="highlight")return 0;if(e==="filter")return 1}function qX(r){let t=r.getValue(Oz);if(t==="fuzzy")return 0;if(t==="contiguous")return 1}function vT(r,t){let e=r.get(de),i=r.get(um),n=r.get(ke),o=r.get(ae),s=()=>{let p=n.getContextKeyValue(zX);if(p==="automatic")return 0;if(p==="trigger")return 1;if(n.getContextKeyValue(KX)===!1)return 1;let g=e.getValue(Mz);if(g==="automatic")return 0;if(g==="trigger")return 1},a=t.horizontalScrolling!==void 0?t.horizontalScrolling:!!e.getValue(za),[l,d]=o.invokeFunction(MP,t),c=t.paddingBottom,u=t.renderIndentGuides!==void 0?t.renderIndentGuides:e.getValue(EP);return{getTypeNavigationMode:s,disposable:d,options:{keyboardSupport:!1,...l,indent:typeof e.getValue(fT)=="number"?e.getValue(fT):void 0,renderIndentGuides:u,smoothScrolling:!!e.getValue(Vd),defaultFindMode:GX(e),defaultFindMatchType:qX(e),horizontalScrolling:a,scrollByPage:!!e.getValue(Bd),paddingBottom:c,hideTwistiesOfChildlessElements:t.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:t.expandOnlyOnTwistieClick??e.getValue(TP)==="doubleClick",contextViewProvider:i,findWidgetStyles:BX,enableStickyScroll:!!e.getValue(xP),stickyScrollMaxItemCount:Number(e.getValue(_P))}}}var kp=class{constructor(t,e,i,n,o,s,a){this.tree=t;this.contextKeyService=AP(o,t),this.disposables.push(PP(this.contextKeyService,t)),this.listSupportsMultiSelect=LP.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(e.multipleSelectionSupport!==!1),RP.bindTo(this.contextKeyService).set(!!e.selectionNavigation),this.listSupportFindWidget=$le.bindTo(this.contextKeyService),this.listSupportFindWidget.set(e.findWidgetEnabled??!0),this.hasSelectionOrFocus=kz.bindTo(this.contextKeyService),this.hasDoubleSelection=Rz.bindTo(this.contextKeyService),this.hasMultiSelection=Az.bindTo(this.contextKeyService),this.treeElementCanCollapse=Yle.bindTo(this.contextKeyService),this.treeElementHasParent=Zle.bindTo(this.contextKeyService),this.treeElementCanExpand=Xle.bindTo(this.contextKeyService),this.treeElementHasChild=Qle.bindTo(this.contextKeyService),this.treeFindOpen=Jle.bindTo(this.contextKeyService),this.treeStickyScrollFocused=HX.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=ou(a),this.updateStyleOverrides(n);let d=()=>{let u=t.getFocus()[0];if(!u)return;let p=t.getNode(u);this.treeElementCanCollapse.set(p.collapsible&&!p.collapsed),this.treeElementHasParent.set(!!t.getParentElement(u)),this.treeElementCanExpand.set(p.collapsible&&p.collapsed),this.treeElementHasChild.set(!!t.getFirstElementChild(u))},c=new Set;c.add(zX),c.add(KX),this.disposables.push(this.contextKeyService,s.register(t),t.onDidChangeSelection(()=>{let u=t.getSelection(),p=t.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(u.length>0||p.length>0),this.hasMultiSelection.set(u.length>1),this.hasDoubleSelection.set(u.length===2)})}),t.onDidChangeFocus(()=>{let u=t.getSelection(),p=t.getFocus();this.hasSelectionOrFocus.set(u.length>0||p.length>0),d()}),t.onDidChangeCollapseState(d),t.onDidChangeModel(d),t.onDidChangeFindOpenState(u=>this.treeFindOpen.set(u)),t.onDidChangeStickyScrollFocused(u=>this.treeStickyScrollFocused.set(u)),a.onDidChangeConfiguration(u=>{let p={};if(u.affectsConfiguration(Ef)&&(this._useAltAsMultipleSelectionModifier=ou(a)),u.affectsConfiguration(fT)){let m=a.getValue(fT);p={...p,indent:m}}if(u.affectsConfiguration(EP)&&e.renderIndentGuides===void 0){let m=a.getValue(EP);p={...p,renderIndentGuides:m}}if(u.affectsConfiguration(Vd)){let m=!!a.getValue(Vd);p={...p,smoothScrolling:m}}if(u.affectsConfiguration(Pz)||u.affectsConfiguration(wP)){let m=GX(a);p={...p,defaultFindMode:m}}if(u.affectsConfiguration(Mz)||u.affectsConfiguration(wP)){let m=i();p={...p,typeNavigationMode:m}}if(u.affectsConfiguration(Oz)){let m=qX(a);p={...p,defaultFindMatchType:m}}if(u.affectsConfiguration(za)&&e.horizontalScrolling===void 0){let m=!!a.getValue(za);p={...p,horizontalScrolling:m}}if(u.affectsConfiguration(Bd)){let m=!!a.getValue(Bd);p={...p,scrollByPage:m}}if(u.affectsConfiguration(TP)&&e.expandOnlyOnTwistieClick===void 0&&(p={...p,expandOnlyOnTwistieClick:a.getValue(TP)==="doubleClick"}),u.affectsConfiguration(xP)){let m=a.getValue(xP);p={...p,enableStickyScroll:m}}if(u.affectsConfiguration(_P)){let m=Math.max(1,a.getValue(_P));p={...p,stickyScrollMaxItemCount:m}}if(u.affectsConfiguration(iu)){let m=a.getValue(iu);p={...p,mouseWheelScrollSensitivity:m}}if(u.affectsConfiguration(nu)){let m=a.getValue(nu);p={...p,fastScrollSensitivity:m}}Object.keys(p).length>0&&t.updateOptions(p)}),this.contextKeyService.onDidChangeContext(u=>{u.affectsSome(c)&&t.updateOptions({typeNavigationMode:i()})})),this.navigator=new Lz(t,{configurationService:a,...e}),this.disposables.push(this.navigator)}contextKeyService;listSupportsMultiSelect;listSupportFindWidget;hasSelectionOrFocus;hasDoubleSelection;hasMultiSelection;treeElementCanCollapse;treeElementHasParent;treeElementCanExpand;treeElementHasChild;treeFindOpen;treeStickyScrollFocused;_useAltAsMultipleSelectionModifier;disposables=[];navigator;get onDidOpen(){return this.navigator.onDidOpen}get useAltAsMultipleSelectionModifier(){return this._useAltAsMultipleSelectionModifier}updateOptions(t){t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyleOverrides(t){this.tree.style(t?mT(t):tI)}dispose(){this.disposables=nt(this.disposables)}};kp=_([v(4,ke),v(5,ko),v(6,de)],kp);var tde=Ne.as(xi.Configuration);tde.registerConfiguration({id:"workbench",order:7,title:h("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[Ef]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[h("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),h("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:h({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[SP]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:h({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[za]:{type:"boolean",default:!1,description:h("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Bd]:{type:"boolean",default:!1,description:h("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[fT]:{type:"number",default:8,minimum:4,maximum:40,description:h("tree indent setting","Controls tree indentation in pixels.")},[EP]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:h("render tree indent guides","Controls whether the tree should render indent guides.")},[Vd]:{type:"boolean",default:!1,description:h("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[iu]:{type:"number",default:1,markdownDescription:h("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[nu]:{type:"number",default:5,markdownDescription:h("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[Pz]:{type:"string",enum:["highlight","filter"],enumDescriptions:[h("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),h("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:h("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[wP]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[h("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),h("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),h("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:h("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:h("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[Oz]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[h("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),h("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:h("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[TP]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:h("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[xP]:{type:"boolean",default:!0,description:h("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[_P]:{type:"number",minimum:1,default:7,markdownDescription:h("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[Mz]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:h("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});function yT(r,t,e){return{id:Xn(r.toString()).toString(),silent:e,source:t||"core"}}var iI=class extends L{constructor(e,i){super();this.telemetryService=e;this.notificationService=i;this.registerListeners()}registerListeners(){this._register(this.notificationService.onDidAddNotification(e=>{let i=e.source&&typeof e.source!="string"?e.source.id:e.source;this.telemetryService.publicLog2("notification:show",yT(e.message,i,e.priority===1))})),this._register(this.notificationService.onDidRemoveNotification(e=>{let i=e.source&&typeof e.source!="string"?e.source.id:e.source;this.telemetryService.publicLog2("notification:close",yT(e.message,i,e.priority===1))}))}};iI=_([v(0,qt),v(1,jt)],iI);function rI(r){switch(r){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function NP(r){switch(r){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function nI(r){let t=0;for(let e=0;;e+=7){let i=r.read(1);if(t|=(i.buffer[0]&127)<<e,!(i.buffer[0]&128))return t}}var ide=gm(0);function oI(r,t){if(t===0){r.write(ide);return}let e=0;for(let n=t;n!==0;n=n>>>7)e++;let i=qe.alloc(e);for(let n=0;t!==0;n++)i.buffer[n]=t&127,t=t>>>7,t>0&&(i.buffer[n]|=128);r.write(i)}var FP=class{constructor(t){this.buffer=t}pos=0;read(t){let e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=e.byteLength,e}},IT=class{buffers=[];get buffer(){return qe.concat(this.buffers)}write(t){this.buffers.push(t)}};function gm(r){let t=qe.alloc(1);return t.writeUInt8(r,0),t}var Tf={Undefined:gm(0),String:gm(1),Buffer:gm(2),VSBuffer:gm(3),Array:gm(4),Object:gm(5),Uint:gm(6)},nde=typeof Buffer<"u";function sI(r,t){if(typeof t>"u")r.write(Tf.Undefined);else if(typeof t=="string"){let e=qe.fromString(t);r.write(Tf.String),oI(r,e.byteLength),r.write(e)}else if(nde&&Buffer.isBuffer(t)){let e=qe.wrap(t);r.write(Tf.Buffer),oI(r,e.byteLength),r.write(e)}else if(t instanceof qe)r.write(Tf.VSBuffer),oI(r,t.byteLength),r.write(t);else if(Array.isArray(t)){r.write(Tf.Array),oI(r,t.length);for(let e of t)sI(r,e)}else if(typeof t=="number"&&(t|0)===t)r.write(Tf.Uint),oI(r,t);else{let e=qe.fromString(JSON.stringify(t));r.write(Tf.Object),oI(r,e.byteLength),r.write(e)}}function CT(r){switch(r.read(1).readUInt8(0)){case 0:return;case 1:return r.read(nI(r)).toString();case 2:return r.read(nI(r)).buffer;case 3:return r.read(nI(r));case 4:{let e=nI(r),i=[];for(let n=0;n<e;n++)i.push(CT(r));return i}case 5:return JSON.parse(r.read(nI(r)).toString());case 6:return nI(r)}}var Nz=class{constructor(t,e,i=null,n=1e3){this.protocol=t;this.ctx=e;this.logger=i;this.timeoutDelay=n;this.protocolListener=this.protocol.onMessage(o=>this.onRawMessage(o)),this.sendResponse({type:200})}channels=new Map;activeRequests=new Map;protocolListener;pendingRequests=new Map;registerChannel(t,e){this.channels.set(t,e),setTimeout(()=>this.flushPendingRequests(t),0)}sendResponse(t){switch(t.type){case 200:{let e=this.send([t.type]);this.logger?.logOutgoing(e,0,1,NP(t.type));return}case 201:case 202:case 204:case 203:{let e=this.send([t.type,t.id],t.data);this.logger?.logOutgoing(e,t.id,1,NP(t.type),t.data);return}}}send(t,e=void 0){let i=new IT;return sI(i,t),sI(i,e),this.sendBuffer(i.buffer)}sendBuffer(t){try{return this.protocol.send(t),t.byteLength}catch{return 0}}onRawMessage(t){let e=new FP(t),i=CT(e),n=CT(e),o=i[0];switch(o){case 100:return this.logger?.logIncoming(t.byteLength,i[1],1,`${rI(o)}: ${i[2]}.${i[3]}`,n),this.onPromise({type:o,id:i[1],channelName:i[2],name:i[3],arg:n});case 102:return this.logger?.logIncoming(t.byteLength,i[1],1,`${rI(o)}: ${i[2]}.${i[3]}`,n),this.onEventListen({type:o,id:i[1],channelName:i[2],name:i[3],arg:n});case 101:return this.logger?.logIncoming(t.byteLength,i[1],1,`${rI(o)}`),this.disposeActiveRequest({type:o,id:i[1]});case 103:return this.logger?.logIncoming(t.byteLength,i[1],1,`${rI(o)}`),this.disposeActiveRequest({type:o,id:i[1]})}}onPromise(t){let e=this.channels.get(t.channelName);if(!e){this.collectPendingRequest(t);return}let i=new Cn,n;try{n=e.call(this.ctx,t.name,t.arg,i.token)}catch(a){n=Promise.reject(a)}let o=t.id;n.then(a=>{this.sendResponse({id:o,data:a,type:201})},a=>{a instanceof Error?this.sendResponse({id:o,data:{message:a.message,name:a.name,stack:a.stack?a.stack.split(`
`):void 0},type:202}):this.sendResponse({id:o,data:a,type:203})}).finally(()=>{s.dispose(),this.activeRequests.delete(t.id)});let s=te(()=>i.cancel());this.activeRequests.set(t.id,s)}onEventListen(t){let e=this.channels.get(t.channelName);if(!e){this.collectPendingRequest(t);return}let i=t.id,o=e.listen(this.ctx,t.name,t.arg)(s=>this.sendResponse({id:i,data:s,type:204}));this.activeRequests.set(t.id,o)}disposeActiveRequest(t){let e=this.activeRequests.get(t.id);e&&(e.dispose(),this.activeRequests.delete(t.id))}collectPendingRequest(t){let e=this.pendingRequests.get(t.channelName);e||(e=[],this.pendingRequests.set(t.channelName,e));let i=setTimeout(()=>{console.error(`Unknown channel: ${t.channelName}`),t.type===100&&this.sendResponse({id:t.id,data:{name:"Unknown channel",message:`Channel name '${t.channelName}' timed out after ${this.timeoutDelay}ms`,stack:void 0},type:202})},this.timeoutDelay);e.push({request:t,timeoutTimer:i})}flushPendingRequests(t){let e=this.pendingRequests.get(t);if(e){for(let i of e)switch(clearTimeout(i.timeoutTimer),i.request.type){case 100:this.onPromise(i.request);break;case 102:this.onEventListen(i.request);break}this.pendingRequests.delete(t)}}dispose(){this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),nt(this.activeRequests.values()),this.activeRequests.clear()}};var OP=class{constructor(t,e=null){this.protocol=t;this.protocolListener=this.protocol.onMessage(i=>this.onBuffer(i)),this.logger=e}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new T;onDidInitialize=this._onDidInitialize.event;getChannel(t){let e=this;return{call(i,n,o){return e.isDisposed?Promise.reject(new Cr):e.requestPromise(t,i,n,o)},listen(i,n){return e.isDisposed?O.None:e.requestEvent(t,i,n)}}}requestPromise(t,e,i,n=In.None){let o=this.lastRequestId++,a={id:o,type:100,channelName:t,name:e,arg:i};if(n.isCancellationRequested)return Promise.reject(new Cr);let l;return new Promise((c,u)=>{if(n.isCancellationRequested)return u(new Cr);let p=()=>{let b=y=>{switch(y.type){case 201:this.handlers.delete(o),c(y.data);break;case 202:{this.handlers.delete(o);let I=new Error(y.data.message);I.stack=Array.isArray(y.data.stack)?y.data.stack.join(`
`):y.data.stack,I.name=y.data.name,u(I);break}case 203:this.handlers.delete(o),u(y.data);break}};this.handlers.set(o,b),this.sendRequest(a)},m=null;this.state===1?p():(m=Sh(b=>this.whenInitialized()),m.then(()=>{m=null,p()}));let g=()=>{m?(m.cancel(),m=null):this.sendRequest({id:o,type:101}),u(new Cr)},f=n.onCancellationRequested(g);l=Ln(te(g),f),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(t,e,i){let n=this.lastRequestId++,s={id:n,type:102,channelName:t,name:e,arg:i},a=null,l=new T({onWillAddFirstListener:()=>{a=Sh(c=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:n,type:103}))}}),d=c=>l.fire(c.data);return this.handlers.set(n,d),l.event}sendRequest(t){switch(t.type){case 100:case 102:{let e=this.send([t.type,t.id,t.channelName,t.name],t.arg);this.logger?.logOutgoing(e,t.id,0,`${rI(t.type)}: ${t.channelName}.${t.name}`,t.arg);return}case 101:case 103:{let e=this.send([t.type,t.id]);this.logger?.logOutgoing(e,t.id,0,rI(t.type));return}}}send(t,e=void 0){let i=new IT;return sI(i,t),sI(i,e),this.sendBuffer(i.buffer)}sendBuffer(t){try{return this.protocol.send(t),t.byteLength}catch{return 0}}onBuffer(t){let e=new FP(t),i=CT(e),n=CT(e),o=i[0];switch(o){case 200:return this.logger?.logIncoming(t.byteLength,0,0,NP(o)),this.onResponse({type:i[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(t.byteLength,i[1],0,NP(o),n),this.onResponse({type:i[0],id:i[1],data:n})}}onResponse(t){if(t.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(t.id)?.(t)}get onDidInitializePromise(){return O.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),nt(this.activeRequests.values()),this.activeRequests.clear()}};_([ue],OP.prototype,"onDidInitializePromise",1);var fm=class{channelClient;channelServer;constructor(t,e,i=null){let n=new IT;sI(n,e),t.send(n.buffer),this.channelClient=new OP(t,i),this.channelServer=new Nz(t,e,i)}getChannel(t){return this.channelClient.getChannel(t)}registerChannel(t,e){this.channelServer.registerChannel(t,e)}dispose(){this.channelClient.dispose(),this.channelServer.dispose()}};function aI(r){return{call(t,e,i){return r.then(n=>n.call(t,e,i))},listen(t,e){let i=new Er;return r.then(n=>i.input=n.listen(t,e)),i.event}}}var Wd;(n=>{function r(o,s,a){let l=o,d=a&&a.disableMarshalling,c=new Map;for(let u in l)e(u)&&c.set(u,O.buffer(l[u],!0,void 0,s));return new class{listen(u,p,m){let g=c.get(p);if(g)return g;let f=l[p];if(typeof f=="function"){if(i(p))return f.call(l,m);if(e(p))return c.set(p,O.buffer(l[p],!0,void 0,s)),c.get(p)}throw new Br(`Event not found: ${p}`)}call(u,p,m){let g=l[p];if(typeof g=="function"){if(!d&&Array.isArray(m))for(let b=0;b<m.length;b++)m[b]=Jh(m[b]);let f=g.apply(l,m);return f instanceof Promise||(f=Promise.resolve(f)),f}throw new Br(`Method not found: ${p}`)}}}n.fromService=r;function t(o,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,d){if(typeof d=="string")return s?.properties?.has(d)?s.properties.get(d):i(d)?function(c){return o.listen(d,c)}:e(d)?o.listen(d):async function(...c){let u;s&&!Zi(s.context)?u=[s.context,...c]:u=c;let p=await o.call(d,u);return a?p:Jh(p)};throw new Br(`Property not found: ${String(d)}`)}})}n.toService=t;function e(o){return o[0]==="o"&&o[1]==="n"&&vc(o.charCodeAt(2))}function i(o){return/^onDynamic/.test(o)&&vc(o.charCodeAt(9))}})(Wd||={});var ode="diagnosticsService",yDt=$(ode);var WP;(s=>{s.enableDiagnostics=!1,s.records=[];let e=new WeakMap,i=0;function n(a,l){if(!e.has(a)){let d=String(++i);e.set(a,d)}return e.get(a)}function o(a,l,d,c){}s.traceSocketEvent=o})(WP||={});var Fz=null;function bm(){return Fz||(Fz=qe.alloc(0)),Fz}var Bz=class{_chunks;_totalLength;get byteLength(){return this._totalLength}constructor(){this._chunks=[],this._totalLength=0}acceptChunk(t){this._chunks.push(t),this._totalLength+=t.byteLength}read(t){return this._read(t,!0)}peek(t){return this._read(t,!1)}_read(t,e){if(t===0)return bm();if(t>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===t){let s=this._chunks[0];return e&&(this._chunks.shift(),this._totalLength-=t),s}if(this._chunks[0].byteLength>t){let s=this._chunks[0].slice(0,t);return e&&(this._chunks[0]=this._chunks[0].slice(t),this._totalLength-=t),s}let i=qe.alloc(t),n=0,o=0;for(;t>0;){let s=this._chunks[o];if(s.byteLength>t){let a=s.slice(0,t);i.set(a,n),n+=t,e&&(this._chunks[o]=s.slice(t),this._totalLength-=t),t-=t}else i.set(s,n),n+=s.byteLength,e?(this._chunks.shift(),this._totalLength-=s.byteLength):o++,t-=s.byteLength}return i}};function jX(r){switch(r){case 0:return"None";case 1:return"Regular";case 2:return"Control";case 3:return"Ack";case 5:return"Disconnect";case 6:return"ReplayRequest";case 7:return"PauseWriting";case 8:return"ResumeWriting";case 9:return"KeepAlive"}}var Ka=class{constructor(t,e,i,n){this.type=t;this.id=e;this.ack=i;this.data=n;this.writtenTime=0}writtenTime;get size(){return this.data.byteLength}},ST=class extends L{_socket;_isDisposed;_incomingData;lastReadTime;_onMessage=this._register(new T);onMessage=this._onMessage.event;_state={readHead:!0,readLen:13,messageType:0,id:0,ack:0};constructor(t){super(),this._socket=t,this._isDisposed=!1,this._incomingData=new Bz,this._register(this._socket.onData(e=>this.acceptChunk(e))),this.lastReadTime=Date.now()}acceptChunk(t){if(!(!t||t.byteLength===0))for(this.lastReadTime=Date.now(),this._incomingData.acceptChunk(t);this._incomingData.byteLength>=this._state.readLen;){let e=this._incomingData.read(this._state.readLen);if(this._state.readHead)this._state.readHead=!1,this._state.readLen=e.readUInt32BE(9),this._state.messageType=e.readUInt8(0),this._state.id=e.readUInt32BE(1),this._state.ack=e.readUInt32BE(5),this._socket.traceSocketEvent("protocolHeaderRead",{messageType:jX(this._state.messageType),id:this._state.id,ack:this._state.ack,messageSize:this._state.readLen});else{let i=this._state.messageType,n=this._state.id,o=this._state.ack;if(this._state.readHead=!0,this._state.readLen=13,this._state.messageType=0,this._state.id=0,this._state.ack=0,this._socket.traceSocketEvent("protocolMessageRead",e),this._onMessage.fire(new Ka(i,n,o,e)),this._isDisposed)break}}}readEntireBuffer(){return this._incomingData.read(this._incomingData.byteLength)}dispose(){this._isDisposed=!0,super.dispose()}},wT=class{_isDisposed;_isPaused;_socket;_data;_totalLength;lastWriteTime;constructor(t){this._isDisposed=!1,this._isPaused=!1,this._socket=t,this._data=[],this._totalLength=0,this.lastWriteTime=0}dispose(){try{this.flush()}catch{}this._isDisposed=!0}drain(){return this.flush(),this._socket.drain()}flush(){this._writeNow()}pause(){this._isPaused=!0}resume(){this._isPaused=!1,this._scheduleWriting()}write(t){if(this._isDisposed)return;t.writtenTime=Date.now(),this.lastWriteTime=Date.now();let e=qe.alloc(13);e.writeUInt8(t.type,0),e.writeUInt32BE(t.id,1),e.writeUInt32BE(t.ack,5),e.writeUInt32BE(t.data.byteLength,9),this._socket.traceSocketEvent("protocolHeaderWrite",{messageType:jX(t.type),id:t.id,ack:t.ack,messageSize:t.data.byteLength}),this._socket.traceSocketEvent("protocolMessageWrite",t.data),this._writeSoon(e,t.data)}_bufferAdd(t,e){let i=this._totalLength===0;return this._data.push(t,e),this._totalLength+=t.byteLength+e.byteLength,i}_bufferTake(){let t=qe.concat(this._data,this._totalLength);return this._data.length=0,this._totalLength=0,t}_writeSoon(t,e){this._bufferAdd(t,e)&&this._scheduleWriting()}_writeNowTimeout=null;_scheduleWriting(){this._writeNowTimeout||(this._writeNowTimeout=setTimeout(()=>{this._writeNowTimeout=null,this._writeNow()}))}_writeNow(){if(this._totalLength===0||this._isPaused)return;let t=this._bufferTake();this._socket.traceSocketEvent("protocolWrite",{byteLength:t.byteLength}),this._socket.write(t)}},Vz=class extends L{_socket;_socketWriter;_socketReader;_onMessage=new T;onMessage=this._onMessage.event;_onDidDispose=new T;onDidDispose=this._onDidDispose.event;constructor(t){super(),this._socket=t,this._socketWriter=this._register(new wT(this._socket)),this._socketReader=this._register(new ST(this._socket)),this._register(this._socketReader.onMessage(e=>{e.type===1&&this._onMessage.fire(e.data)})),this._register(this._socket.onClose(()=>this._onDidDispose.fire()))}drain(){return this._socketWriter.drain()}getSocket(){return this._socket}sendDisconnect(){}send(t){this._socketWriter.write(new Ka(1,0,0,t))}},BP=class r extends fm{constructor(e,i,n=null){super(e,i,n);this.protocol=e}static fromSocket(e,i){return new r(new Vz(e),i)}get onDidDispose(){return this.protocol.onDidDispose}dispose(){super.dispose();let e=this.protocol.getSocket();this.protocol.sendDisconnect(),this.protocol.dispose(),e.end()}},xf=class{_emitter;event;_hasListeners=!1;_isDeliveringMessages=!1;_bufferedMessages=[];constructor(){this._emitter=new T({onWillAddFirstListener:()=>{this._hasListeners=!0,queueMicrotask(()=>this._deliverMessages())},onDidRemoveLastListener:()=>{this._hasListeners=!1}}),this.event=this._emitter.event}_deliverMessages(){if(!this._isDeliveringMessages){for(this._isDeliveringMessages=!0;this._hasListeners&&this._bufferedMessages.length>0;)this._emitter.fire(this._bufferedMessages.shift());this._isDeliveringMessages=!1}}fire(t){this._hasListeners?this._bufferedMessages.length>0?this._bufferedMessages.push(t):this._emitter.fire(t):this._bufferedMessages.push(t)}flushBuffer(){this._bufferedMessages=[]}},Wz=class{data;next;constructor(t){this.data=t,this.next=null}},Uz=class{_first;_last;constructor(){this._first=null,this._last=null}length(){let t=0,e=this._first;for(;e;)e=e.next,t++;return t}peek(){return this._first?this._first.data:null}toArray(){let t=[],e=0,i=this._first;for(;i;)t[e++]=i.data,i=i.next;return t}pop(){if(this._first){if(this._first===this._last){this._first=null,this._last=null;return}this._first=this._first.next}}push(t){let e=new Wz(t);if(!this._first){this._first=e,this._last=e;return}this._last.next=e,this._last=e}},Hz=class r{static _HISTORY_LENGTH=10;static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}lastRuns;constructor(){this.lastRuns=[];let t=Date.now();for(let e=0;e<r._HISTORY_LENGTH;e++)this.lastRuns[e]=t-1e3*e;setInterval(()=>{for(let e=r._HISTORY_LENGTH;e>=1;e--)this.lastRuns[e]=this.lastRuns[e-1];this.lastRuns[0]=Date.now()},1e3)}load(){let t=Date.now(),e=(1+r._HISTORY_LENGTH)*1e3,i=0;for(let n=0;n<r._HISTORY_LENGTH;n++)t-this.lastRuns[n]<=e&&i++;return 1-i/r._HISTORY_LENGTH}hasHighLoad(){return this.load()>=.5}},VP=class{_isReconnecting;_didSendDisconnect;_outgoingUnackMsg;_outgoingMsgId;_outgoingAckId;_outgoingAckTimeout;_incomingMsgId;_incomingAckId;_incomingMsgLastTime;_incomingAckTimeout;_keepAliveInterval;_lastReplayRequestTime;_lastSocketTimeoutTime;_socket;_socketWriter;_socketReader;_socketDisposables;_loadEstimator;_shouldSendKeepAlive;_onControlMessage=new xf;onControlMessage=this._onControlMessage.event;_onMessage=new xf;onMessage=this._onMessage.event;_onDidDispose=new xf;onDidDispose=this._onDidDispose.event;_onSocketClose=new xf;onSocketClose=this._onSocketClose.event;_onSocketTimeout=new xf;onSocketTimeout=this._onSocketTimeout.event;get unacknowledgedCount(){return this._outgoingMsgId-this._outgoingAckId}constructor(t){this._loadEstimator=t.loadEstimator??Hz.getInstance(),this._shouldSendKeepAlive=t.sendKeepAlive??!0,this._isReconnecting=!1,this._outgoingUnackMsg=new Uz,this._outgoingMsgId=0,this._outgoingAckId=0,this._outgoingAckTimeout=null,this._incomingMsgId=0,this._incomingAckId=0,this._incomingMsgLastTime=0,this._incomingAckTimeout=null,this._lastReplayRequestTime=0,this._lastSocketTimeoutTime=Date.now(),this._socketDisposables=new W,this._socket=t.socket,this._socketWriter=this._socketDisposables.add(new wT(this._socket)),this._socketReader=this._socketDisposables.add(new ST(this._socket)),this._socketDisposables.add(this._socketReader.onMessage(e=>this._receiveMessage(e))),this._socketDisposables.add(this._socket.onClose(e=>this._onSocketClose.fire(e))),t.initialChunk&&this._socketReader.acceptChunk(t.initialChunk),this._shouldSendKeepAlive?this._keepAliveInterval=setInterval(()=>{this._sendKeepAlive()},5e3):this._keepAliveInterval=null}dispose(){this._outgoingAckTimeout&&(clearTimeout(this._outgoingAckTimeout),this._outgoingAckTimeout=null),this._incomingAckTimeout&&(clearTimeout(this._incomingAckTimeout),this._incomingAckTimeout=null),this._keepAliveInterval&&(clearInterval(this._keepAliveInterval),this._keepAliveInterval=null),this._socketDisposables.dispose()}drain(){return this._socketWriter.drain()}sendDisconnect(){if(!this._didSendDisconnect){this._didSendDisconnect=!0;let t=new Ka(5,0,0,bm());this._socketWriter.write(t),this._socketWriter.flush()}}sendPause(){let t=new Ka(7,0,0,bm());this._socketWriter.write(t)}sendResume(){let t=new Ka(8,0,0,bm());this._socketWriter.write(t)}pauseSocketWriting(){this._socketWriter.pause()}getSocket(){return this._socket}getMillisSinceLastIncomingData(){return Date.now()-this._socketReader.lastReadTime}beginAcceptReconnection(t,e){this._isReconnecting=!0,this._socketDisposables.dispose(),this._socketDisposables=new W,this._onControlMessage.flushBuffer(),this._onSocketClose.flushBuffer(),this._onSocketTimeout.flushBuffer(),this._socket.dispose(),this._lastReplayRequestTime=0,this._lastSocketTimeoutTime=Date.now(),this._socket=t,this._socketWriter=this._socketDisposables.add(new wT(this._socket)),this._socketReader=this._socketDisposables.add(new ST(this._socket)),this._socketDisposables.add(this._socketReader.onMessage(i=>this._receiveMessage(i))),this._socketDisposables.add(this._socket.onClose(i=>this._onSocketClose.fire(i))),this._socketReader.acceptChunk(e)}endAcceptReconnection(){this._isReconnecting=!1,this._incomingAckId=this._incomingMsgId;let t=new Ka(3,0,this._incomingAckId,bm());this._socketWriter.write(t);let e=this._outgoingUnackMsg.toArray();for(let i=0,n=e.length;i<n;i++)this._socketWriter.write(e[i]);this._recvAckCheck()}acceptDisconnect(){this._onDidDispose.fire()}_receiveMessage(t){if(t.ack>this._outgoingAckId){this._outgoingAckId=t.ack;do{let e=this._outgoingUnackMsg.peek();if(e&&e.id<=t.ack)this._outgoingUnackMsg.pop();else break}while(!0)}switch(t.type){case 0:break;case 1:{if(t.id>this._incomingMsgId)if(t.id!==this._incomingMsgId+1){let e=Date.now();e-this._lastReplayRequestTime>1e4&&(this._lastReplayRequestTime=e,this._socketWriter.write(new Ka(6,0,0,bm())))}else this._incomingMsgId=t.id,this._incomingMsgLastTime=Date.now(),this._sendAckCheck(),this._onMessage.fire(t.data);break}case 2:{this._onControlMessage.fire(t.data);break}case 3:break;case 5:{this._onDidDispose.fire();break}case 6:{let e=this._outgoingUnackMsg.toArray();for(let i=0,n=e.length;i<n;i++)this._socketWriter.write(e[i]);this._recvAckCheck();break}case 7:{this._socketWriter.pause();break}case 8:{this._socketWriter.resume();break}case 9:break}}readEntireBuffer(){return this._socketReader.readEntireBuffer()}flush(){this._socketWriter.flush()}send(t){let e=++this._outgoingMsgId;this._incomingAckId=this._incomingMsgId;let i=new Ka(1,e,this._incomingAckId,t);this._outgoingUnackMsg.push(i),this._isReconnecting||(this._socketWriter.write(i),this._recvAckCheck())}sendControl(t){let e=new Ka(2,0,0,t);this._socketWriter.write(e)}_sendAckCheck(){if(this._incomingMsgId<=this._incomingAckId||this._incomingAckTimeout)return;let t=Date.now()-this._incomingMsgLastTime;if(t>=2e3){this._sendAck();return}this._incomingAckTimeout=setTimeout(()=>{this._incomingAckTimeout=null,this._sendAckCheck()},2e3-t+5)}_recvAckCheck(){if(this._outgoingMsgId<=this._outgoingAckId||this._outgoingAckTimeout||this._isReconnecting)return;let t=this._outgoingUnackMsg.peek(),e=Date.now()-t.writtenTime,i=Date.now()-this._socketReader.lastReadTime,n=Date.now()-this._lastSocketTimeoutTime;if(e>=2e4&&i>=2e4&&n>=2e4&&!this._loadEstimator.hasHighLoad()){this._lastSocketTimeoutTime=Date.now(),this._onSocketTimeout.fire({unacknowledgedMsgCount:this._outgoingUnackMsg.length(),timeSinceOldestUnacknowledgedMsg:e,timeSinceLastReceivedSomeData:i});return}let o=Math.max(2e4-e,2e4-i,2e4-n,500);this._outgoingAckTimeout=setTimeout(()=>{this._outgoingAckTimeout=null,this._recvAckCheck()},o)}_sendAck(){if(this._incomingMsgId<=this._incomingAckId)return;this._incomingAckId=this._incomingMsgId;let t=new Ka(3,0,this._incomingAckId,bm());this._socketWriter.write(t)}_sendKeepAlive(){this._incomingAckId=this._incomingMsgId;let t=new Ka(9,0,this._incomingAckId,bm());this._socketWriter.write(t)}};var Ud=$("remoteAuthorityResolverService");var _l=class r extends Br{static isNotAvailable(t){return t instanceof r&&t._code==="NotAvailable"}static isTemporarilyNotAvailable(t){return t instanceof r&&t._code==="TemporarilyNotAvailable"}static isNoResolverFound(t){return t instanceof r&&t._code==="NoResolverFound"}static isInvalidAuthority(t){return t instanceof r&&t._code==="InvalidAuthority"}static isHandled(t){return t instanceof r&&t.isHandled}_message;_code;_detail;isHandled;constructor(t,e="Unknown",i){super(t),this._message=t,this._code=e,this._detail=i,this.isHandled=e==="NotAvailable"&&i===!0,Object.setPrototypeOf(this,r.prototype)}};var lI=$("remoteSocketFactoryService"),UP=class{factories={};register(t,e){return this.factories[t]??=[],this.factories[t].push(e),te(()=>{let i=this.factories[t]?.indexOf(e);typeof i=="number"&&i>=0&&this.factories[t]?.splice(i,1)})}getSocketFactory(t){return(this.factories[t.type]||[]).find(i=>i.supports(t))}connect(t,e,i,n){let o=this.getSocketFactory(t);if(!o)throw new Error(`No socket factory found for ${t}`);return o.connect(t,e,i,n)}};var rde="signService",dI=$(rde);var ade=30*1e3;function Kz(r){switch(r){case 1:return"Management";case 2:return"ExtensionHost";case 3:return"Tunnel"}}function $X(r){let t=new Cn;return setTimeout(()=>t.cancel(),r),t.token}function lde(r,t){if(r.isCancellationRequested||t.isCancellationRequested)return In.Cancelled;let e=new Cn;return r.onCancellationRequested(()=>e.cancel()),t.onCancellationRequested(()=>e.cancel()),e.token}var cI=class{_state;_disposables;promise;_resolvePromise;_rejectPromise;get didTimeout(){return this._state==="timedout"}constructor(t){this._state="pending",this._disposables=new W,{promise:this.promise,resolve:this._resolvePromise,reject:this._rejectPromise}=av(),t.isCancellationRequested?this._timeout():this._disposables.add(t.onCancellationRequested(()=>this._timeout()))}registerDisposable(t){this._state==="pending"?this._disposables.add(t):t.dispose()}_timeout(){this._state==="pending"&&(this._disposables.dispose(),this._state="timedout",this._rejectPromise(this._createTimeoutError()))}_createTimeoutError(){let t=new Error("Time limit reached");return t.code="ETIMEDOUT",t.syscall="connect",t}resolve(t){this._state==="pending"&&(this._disposables.dispose(),this._state="resolved",this._resolvePromise(t))}reject(t){this._state==="pending"&&(this._disposables.dispose(),this._state="rejected",this._rejectPromise(t))}};function dde(r,t){let e=new cI(t);return e.registerDisposable(r.onControlMessage(i=>{let n=JSON.parse(i.toString()),o=QX(n);o?e.reject(o):e.resolve(n)})),e.promise}function cde(r,t,e,i,n,o,s,a){let l=new cI(a),d=ll.create(!1);return r.info(`Creating a socket (${s})...`),Dt(`code/willCreateSocket/${o}`),t.connect(e,i,n,s).then(c=>{l.didTimeout?(Dt(`code/didCreateSocketError/${o}`),r.info(`Creating a socket (${s}) finished after ${d.elapsed()} ms, but this is too late and has timed out already.`),c?.dispose()):(Dt(`code/didCreateSocketOK/${o}`),r.info(`Creating a socket (${s}) was successful after ${d.elapsed()} ms.`),l.resolve(c))},c=>{Dt(`code/didCreateSocketError/${o}`),r.info(`Creating a socket (${s}) returned an error after ${d.elapsed()} ms.`),r.error(c),l.reject(c)}),l.promise}function zz(r,t){let e=new cI(t);return r.then(i=>{e.didTimeout||e.resolve(i)},i=>{e.didTimeout||e.reject(i)}),e.promise}async function ude(r,t,e,i){let n=JX(r,t);r.logService.trace(`${n} 1/6. invoking socketFactory.connect().`);let o;try{o=await cde(r.logService,r.remoteSocketFactoryService,r.connectTo,Jl.getServerRootPath(),`reconnectionToken=${r.reconnectionToken}&reconnection=${r.reconnectionProtocol?"true":"false"}`,Kz(t),`renderer-${Kz(t)}-${r.reconnectionToken}`,i)}catch(c){throw r.logService.error(`${n} socketFactory.connect() failed or timed out. Error:`),r.logService.error(c),c}r.logService.trace(`${n} 2/6. socketFactory.connect() was successful.`);let s,a;r.reconnectionProtocol?(r.reconnectionProtocol.beginAcceptReconnection(o,null),s=r.reconnectionProtocol,a=!1):(s=new VP({socket:o}),a=!0),r.logService.trace(`${n} 3/6. sending AuthRequest control message.`);let l=await zz(r.signService.createNewMessage(zr()),i),d={type:"auth",auth:r.connectionToken||"00000000000000000000",data:l.data};s.sendControl(qe.fromString(JSON.stringify(d)));try{let c=await dde(s,lde(i,$X(1e4)));if(c.type!=="sign"||typeof c.data!="string"){let g=new Error("Unexpected handshake message");throw g.code="VSCODE_CONNECTION_ERROR",g}if(r.logService.trace(`${n} 4/6. received SignRequest control message.`),!await zz(r.signService.validate(l,c.signedData),i)){let g=new Error("Refused to connect to unsupported server");throw g.code="VSCODE_CONNECTION_ERROR",g}let p=await zz(r.signService.sign(c.data),i),m={type:"connectionType",commit:r.commit,signedData:p,desiredConnectionType:t};return e&&(m.args=e),r.logService.trace(`${n} 5/6. sending ConnectionTypeRequest control message.`),s.sendControl(qe.fromString(JSON.stringify(m))),{protocol:s,ownsProtocol:a}}catch(c){throw c&&c.code==="ETIMEDOUT"&&(r.logService.error(`${n} the handshake timed out. Error:`),r.logService.error(c)),c&&c.code==="VSCODE_CONNECTION_ERROR"&&(r.logService.error(`${n} received error control message when negotiating connection. Error:`),r.logService.error(c)),a&&Zz(s),c}}async function pde(r,t,e,i){let n=Date.now(),o=JX(r,t),{protocol:s,ownsProtocol:a}=await ude(r,t,e,i),l=new cI(i);return l.registerDisposable(s.onControlMessage(d=>{let c=JSON.parse(d.toString()),u=QX(c);u?(r.logService.error(`${o} received error control message when negotiating connection. Error:`),r.logService.error(u),a&&Zz(s),l.reject(u)):(r.reconnectionProtocol?.endAcceptReconnection(),r.logService.trace(`${o} 6/6. handshake finished, connection is up and running after ${bde(n)}!`),l.resolve({protocol:s,firstMessage:c}))})),l.promise}async function YX(r,t){let{protocol:e}=await pde(r,1,void 0,t);return{protocol:e}}async function ZX(r,t,e){let{connectTo:i,connectionToken:n}=await r.addressProvider.getAddress();return{commit:r.commit,quality:r.quality,connectTo:i,connectionToken:n,reconnectionToken:t,reconnectionProtocol:e,remoteSocketFactoryService:r.remoteSocketFactoryService,signService:r.signService,logService:r.logService}}async function XX(r,t,e){return hde(r,async i=>{let{protocol:n}=await YX(i,In.None);return new Yz(r,t,e,i.reconnectionToken,n)})}async function hde(r,t){for(let i=1;;i++)try{let n=zr(),o=await ZX(r,n,null);return await t(o)}catch(n){if(i<5)r.logService.error(`[remote-connection][attempt ${i}] An error occurred in initial connection! Will retry... Error:`),r.logService.error(n);else throw r.logService.error(`[remote-connection][attempt ${i}]  An error occurred in initial connection! It will be treated as a permanent error. Error:`),r.logService.error(n),KP.triggerPermanentFailure(0,0,_l.isHandled(n)),n}}function mde(r){return Sh(t=>new Promise((e,i)=>{let n=setTimeout(e,r*1e3);t.onCancellationRequested(()=>{clearTimeout(n),e()})}))}var Gz=class{constructor(t,e){this.reconnectionToken=t;this.millisSinceLastIncomingData=e}type=0},qz=class{constructor(t,e,i,n){this.reconnectionToken=t;this.millisSinceLastIncomingData=e;this.durationSeconds=i;this.cancellableTimer=n}type=1;skipWait(){this.cancellableTimer.cancel()}},jz=class{constructor(t,e,i){this.reconnectionToken=t;this.millisSinceLastIncomingData=e;this.attempt=i}type=2},zP=class{constructor(t,e,i){this.reconnectionToken=t;this.millisSinceLastIncomingData=e;this.attempt=i}type=4},$z=class{constructor(t,e,i,n){this.reconnectionToken=t;this.millisSinceLastIncomingData=e;this.attempt=i;this.handled=n}type=3},KP=class r extends L{constructor(e,i,n,o,s){super();this._connectionType=e;this._options=i;this.reconnectionToken=n;this.protocol=o;this._reconnectionFailureIsFatal=s;this._onDidStateChange.fire(new zP(this.reconnectionToken,0,0)),this._register(o.onSocketClose(a=>{let l=HP(this._connectionType,this.reconnectionToken,!0);a?a.type===0?(this._options.logService.info(`${l} received socket close event (hadError: ${a.hadError}).`),a.error&&this._options.logService.error(a.error)):(this._options.logService.info(`${l} received socket close event (wasClean: ${a.wasClean}, code: ${a.code}, reason: ${a.reason}).`),a.event&&this._options.logService.error(a.event)):this._options.logService.info(`${l} received socket close event.`),this._beginReconnecting()})),this._register(o.onSocketTimeout(a=>{let l=HP(this._connectionType,this.reconnectionToken,!0);this._options.logService.info(`${l} received socket timeout event (unacknowledgedMsgCount: ${a.unacknowledgedMsgCount}, timeSinceOldestUnacknowledgedMsg: ${a.timeSinceOldestUnacknowledgedMsg}, timeSinceLastReceivedSomeData: ${a.timeSinceLastReceivedSomeData}).`),this._beginReconnecting()})),r._instances.push(this),this._register(te(()=>{let a=r._instances.indexOf(this);a>=0&&r._instances.splice(a,1)})),this._isPermanentFailure&&this._gotoPermanentFailure(r._permanentFailureMillisSinceLastIncomingData,r._permanentFailureAttempt,r._permanentFailureHandled)}static triggerPermanentFailure(e,i,n){this._permanentFailure=!0,this._permanentFailureMillisSinceLastIncomingData=e,this._permanentFailureAttempt=i,this._permanentFailureHandled=n,this._instances.forEach(o=>o._gotoPermanentFailure(this._permanentFailureMillisSinceLastIncomingData,this._permanentFailureAttempt,this._permanentFailureHandled))}static debugTriggerReconnection(){this._instances.forEach(e=>e._beginReconnecting())}static debugPauseSocketWriting(){this._instances.forEach(e=>e._pauseSocketWriting())}static _permanentFailure=!1;static _permanentFailureMillisSinceLastIncomingData=0;static _permanentFailureAttempt=0;static _permanentFailureHandled=!1;static _instances=[];_onDidStateChange=this._register(new T);onDidStateChange=this._onDidStateChange.event;_permanentFailure=!1;get _isPermanentFailure(){return this._permanentFailure||r._permanentFailure}_isReconnecting=!1;_isDisposed=!1;dispose(){super.dispose(),this._isDisposed=!0}async _beginReconnecting(){if(!this._isReconnecting)try{this._isReconnecting=!0,await this._runReconnectingLoop()}finally{this._isReconnecting=!1}}async _runReconnectingLoop(){if(this._isPermanentFailure||this._isDisposed)return;let e=HP(this._connectionType,this.reconnectionToken,!0);this._options.logService.info(`${e} starting reconnecting loop. You can get more information with the trace log level.`),this._onDidStateChange.fire(new Gz(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData()));let i=[0,5,5,10,10,10,10,10,30],n=-1;do{n++;let o=n<i.length?i[n]:i[i.length-1];try{if(o>0){let a=mde(o);this._onDidStateChange.fire(new qz(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),o,a)),this._options.logService.info(`${e} waiting for ${o} seconds before reconnecting...`);try{await a}catch{}}if(this._isPermanentFailure){this._options.logService.error(`${e} permanent failure occurred while running the reconnecting loop.`);break}this._onDidStateChange.fire(new jz(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1)),this._options.logService.info(`${e} resolving connection...`);let s=await ZX(this._options,this.reconnectionToken,this.protocol);this._options.logService.info(`${e} connecting to ${s.connectTo}...`),await this._reconnect(s,$X(ade)),this._options.logService.info(`${e} reconnected!`),this._onDidStateChange.fire(new zP(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1));break}catch(s){if(s.code==="VSCODE_CONNECTION_ERROR"){this._options.logService.error(`${e} A permanent error occurred in the reconnecting loop! Will give up now! Error:`),this._options.logService.error(s),this._onReconnectionPermanentFailure(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(n>360){this._options.logService.error(`${e} An error occurred while reconnecting, but it will be treated as a permanent error because the reconnection grace time has expired! Will give up now! Error:`),this._options.logService.error(s),this._onReconnectionPermanentFailure(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(_l.isTemporarilyNotAvailable(s)){this._options.logService.info(`${e} A temporarily not available error occurred while trying to reconnect, will try again...`),this._options.logService.trace(s);continue}if((s.code==="ETIMEDOUT"||s.code==="ENETUNREACH"||s.code==="ECONNREFUSED"||s.code==="ECONNRESET")&&s.syscall==="connect"){this._options.logService.info(`${e} A network error occurred while trying to reconnect, will try again...`),this._options.logService.trace(s);continue}if(al(s)){this._options.logService.info(`${e} A promise cancelation error occurred while trying to reconnect, will try again...`),this._options.logService.trace(s);continue}if(s instanceof _l){this._options.logService.error(`${e} A RemoteAuthorityResolverError occurred while trying to reconnect. Will give up now! Error:`),this._options.logService.error(s),this._onReconnectionPermanentFailure(this.protocol.getMillisSinceLastIncomingData(),n+1,_l.isHandled(s));break}this._options.logService.error(`${e} An unknown error occurred while trying to reconnect, since this is an unknown case, it will be treated as a permanent error! Will give up now! Error:`),this._options.logService.error(s),this._onReconnectionPermanentFailure(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}}while(!this._isPermanentFailure&&!this._isDisposed)}_onReconnectionPermanentFailure(e,i,n){this._reconnectionFailureIsFatal?r.triggerPermanentFailure(e,i,n):this._gotoPermanentFailure(e,i,n)}_gotoPermanentFailure(e,i,n){this._onDidStateChange.fire(new $z(this.reconnectionToken,e,i,n)),Zz(this.protocol)}_pauseSocketWriting(){this.protocol.pauseSocketWriting()}},Yz=class extends KP{client;constructor(t,e,i,n,o){super(1,t,n,o,!0),this.client=this._register(new BP(o,{remoteAuthority:e,clientId:i},t.ipcLogger))}async _reconnect(t,e){await YX(t,e)}};function Zz(r){try{r.acceptDisconnect();let t=r.getSocket();r.dispose(),t.dispose()}catch(t){Ke(t)}}function QX(r){if(r&&r.type==="error"){let t=new Error(`Connection error: ${r.reason}`);return t.code="VSCODE_CONNECTION_ERROR",t}return null}function gde(r,t){for(;r.length<t;)r+=" ";return r}function fde(r,t){return`[remote-connection][${gde(Kz(r),13)}][${t.substr(0,5)}\u2026]`}function HP(r,t,e){return`${fde(r,t)}[${e?"reconnect":"initial"}]`}function JX(r,t){return`${HP(t,r.reconnectionToken,!!r.reconnectionProtocol)}[${r.connectTo}]`}function bde(r){return`${Date.now()-r} ms`}var vm=$("remoteAgentService"),VLt=new class{maxSampleCount=5;sampleDelay=2e3;initial=[];maxInitialCount=3;average=[];maxAverageCount=100;highLatencyMultiple=2;highLatencyMinThreshold=500;highLatencyMaxThreshold=1500;lastMeasurement=void 0;get latency(){return this.lastMeasurement}async measure(r){let t=1/0;for(let i=0;i<this.maxSampleCount;i++){let n=await r.getRoundTripTime();if(n===void 0)return;t=Math.min(t,n/2),await Sn(this.sampleDelay)}this.average.push(t),this.average.length>this.maxAverageCount&&this.average.shift();let e;return this.initial.length<this.maxInitialCount?this.initial.push(t):e=this.initial.reduce((i,n)=>i+n,0)/this.initial.length,this.lastMeasurement={initial:e,current:t,average:this.average.reduce((i,n)=>i+n,0)/this.average.length,high:typeof e>"u"?!1:t>this.highLatencyMaxThreshold||t>this.highLatencyMinThreshold&&t>e*this.highLatencyMultiple},this.lastMeasurement}};var ckt=Object.freeze({id:"application",order:100,title:h("applicationConfigurationTitle","Application"),type:"object"}),pI=Object.freeze({id:"workbench",order:7,title:h("workbenchConfigurationTitle","Workbench"),type:"object"}),vde=Object.freeze({id:"security",scope:1,title:h("securityConfigurationTitle","Security"),type:"object",order:7}),ukt=Object.freeze({id:"problems",title:h("problemsConfigurationTitle","Problems"),type:"object",order:101}),yde=Object.freeze({id:"window",order:8,title:h("windowConfigurationTitle","Window"),type:"object"}),Ide={ConfigurationMigration:"base.contributions.configuration.migration"},Xz=class{migrations=[];_onDidRegisterConfigurationMigrations=new T;onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event;registerConfigurationMigrations(t){this.migrations.push(...t)}},jP=new Xz;Ne.add(Ide.ConfigurationMigration,jP);var GP=class extends L{constructor(e,i){super();this.configurationService=e;this.workspaceService=i;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async n=>{for(let o of n.added)await this.migrateConfigurationsForFolder(o,jP.migrations)})),this.migrateConfigurations(jP.migrations),this._register(jP.onDidRegisterConfigurationMigration(n=>this.migrateConfigurations(n)))}static ID="workbench.contrib.configurationMigration";async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(let i of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(i,e)}async migrateConfigurationsForFolder(e,i){await Promise.all([i.map(n=>this.migrateConfigurationsForFolderAndOverride(n,e?.uri))])}async migrateConfigurationsForFolderAndOverride(e,i){let n=this.configurationService.inspect(e.key,{resource:i}),o=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(let[s,a]of o){let l=n[s];if(!l)continue;let d=[];if(l.value!==void 0){let c=await this.runMigration(e,s,l.value,i,void 0);for(let u of c??[])d.push([u,[]])}for(let{identifiers:c,value:u}of l.overrides??[])if(u!==void 0){let p=await this.runMigration(e,s,u,i,c);for(let m of p??[])d.push([m,c])}d.length&&await Promise.allSettled(d.map(async([[c,u],p])=>this.configurationService.updateValue(c,u.value,{resource:i,overrideIdentifiers:p},a)))}}async runMigration(e,i,n,o,s){let a=d=>{let u=this.configurationService.inspect(d,{resource:o})[i];if(u)return s?u.overrides?.find(({identifiers:p})=>$t(p,s))?.value:u.value},l=await e.migrateFn(n,a);return Array.isArray(l)?l:[[e.key,l]]}};GP=_([v(0,de),v(1,Xt)],GP);var uI=class extends L{constructor(e){super();this.remoteAgentService=e;this.create()}static ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration";_ready=new xr;ready=this._ready.p;async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!rt&&(await this.remoteAgentService.getEnvironment())?.os!==1)return;Ne.as(xi.Configuration).registerConfiguration({...vde,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h("security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:h("security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h("security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}};uI=_([v(0,vm)],uI);var ET="window.newWindowProfile",qP=class extends L{constructor(e,i){super();this.userDataProfilesService=e;this.configurationService=i;this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(n=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(i.onDidChangeConfiguration(n=>{n.source!==7&&n.affectsConfiguration(ET)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}static ID="workbench.contrib.dynamicWindowConfiguration";configurationNode;newWindowProfile;registerNewWindowProfileConfiguration(){let e=Ne.as(xi.Configuration),i={...yde,properties:{[ET]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(n=>n.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(n=>""),h("active window","Active Window")],description:h("newWindowProfile","Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:1}}};this.configurationNode?e.updateConfigurations({add:[i],remove:[this.configurationNode]}):e.registerConfiguration(i),this.configurationNode=i}setNewWindowProfile(){let e=this.configurationService.getValue(ET);this.newWindowProfile=e?this.userDataProfilesService.profiles.find(i=>i.name===e):void 0}checkAndResetNewWindowProfileConfig(){let e=this.configurationService.getValue(ET);if(!e)return;let i=this.newWindowProfile?this.userDataProfilesService.profiles.find(n=>n.id===this.newWindowProfile.id):void 0;e!==i?.name&&this.configurationService.updateValue(ET,i?.name)}};qP=_([v(0,Dv),v(1,de)],qP);var hI=$("editorResolverService");var Cde=Ne.as(xi.Configuration),Sde={...pI,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h("editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};Cde.registerConfiguration(Sde);var eQ=new ie("workbenchState",void 0,{type:"string",description:h("workbenchState","The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")}),tQ=new ie("workspaceFolderCount",0,h("workspaceFolderCount","The number of root folders in the workspace")),iQ=new ie("openFolderWorkspaceSupport",!0,!0),nQ=new ie("enterMultiRootWorkspaceSupport",!0,!0),oQ=new ie("emptyWorkspaceSupport",!0,!0),rQ=new ie("dirtyWorkingCopies",!1,h("dirtyWorkingCopies","Whether there are any working copies with unsaved changes")),sQ=new ie("remoteName","",h("remoteName","The name of the remote the window is connected to or an empty string if not connected to any remote")),aQ=new ie("virtualWorkspace","",h("virtualWorkspace","The scheme of the current workspace is from a virtual file system or an empty string.")),lQ=new ie("temporaryWorkspace",!1,h("temporaryWorkspace","The scheme of the current workspace is from a temporary file system.")),Ga=new ie("isFullscreen",!1,h("isFullscreen","Whether the main window is in fullscreen mode")),ps=new ie("isAuxiliaryWindowFocusedContext",!1,h("isAuxiliaryWindowFocusedContext","Whether an auxiliary window is focused")),dQ=new ie("hasWebFileSystemAccess",!1,!0),cQ=new ie("embedderIdentifier",void 0,h("embedderIdentifier","The identifier of the embedder according to the product service, if one is defined")),uRt=new ie("activeEditorIsDirty",!1,h("activeEditorIsDirty","Whether the active editor has unsaved changes")),uQ=new ie("activeEditorIsNotPreview",!1,h("activeEditorIsNotPreview","Whether the active editor is not in preview mode")),pQ=new ie("activeEditorIsFirstInGroup",!1,h("activeEditorIsFirstInGroup","Whether the active editor is the first one in its group")),hQ=new ie("activeEditorIsLastInGroup",!1,h("activeEditorIsLastInGroup","Whether the active editor is the last one in its group")),Qz=new ie("activeEditorIsPinned",!1,h("activeEditorIsPinned","Whether the active editor is pinned")),pRt=new ie("activeEditorIsReadonly",!1,h("activeEditorIsReadonly","Whether the active editor is read-only")),wde=new ie("activeCompareEditorCanSwap",!1,h("activeCompareEditorCanSwap","Whether the active compare editor can swap sides")),hRt=new ie("activeEditorCanToggleReadonly",!0,h("activeEditorCanToggleReadonly","Whether the active editor can toggle between being read-only or writeable")),mRt=new ie("activeEditorCanRevert",!1,h("activeEditorCanRevert","Whether the active editor can revert")),Jz=new ie("activeEditorCanSplitInGroup",!0),Ede=new ie("activeEditor",null,{type:"string",description:h("activeEditor","The identifier of the active editor")}),e5=new ie("activeEditorAvailableEditorIds","",h("activeEditorAvailableEditorIds","The available editor identifiers that are usable for the active editor")),Tde=new ie("textCompareEditorVisible",!1,h("textCompareEditorVisible","Whether a text compare editor is visible")),mQ=new ie("textCompareEditorActive",!1,h("textCompareEditorActive","Whether a text compare editor is active")),t5=new ie("sideBySideEditorActive",!1,h("sideBySideEditorActive","Whether a side by side editor is active")),gRt=new ie("groupEditorsCount",0,h("groupEditorsCount","The number of opened editor groups")),$P=new ie("activeEditorGroupEmpty",!1,h("activeEditorGroupEmpty","Whether the active editor group is empty")),gQ=new ie("activeEditorGroupIndex",0,h("activeEditorGroupIndex","The index of the active editor group")),fQ=new ie("activeEditorGroupLast",!1,h("activeEditorGroupLast","Whether the active editor group is the last group")),TT=new ie("activeEditorGroupLocked",!1,h("activeEditorGroupLocked","Whether the active editor group is locked")),xT=new ie("multipleEditorGroups",!1,h("multipleEditorGroups","Whether there are multiple editor groups opened")),fRt=xT.toNegated(),bRt=new ie("multipleEditorsSelectedInGroup",!1,h("multipleEditorsSelectedInGroup","Whether multiple editors have been selected in an editor group")),vRt=new ie("twoEditorsSelectedInGroup",!1,h("twoEditorsSelectedInGroup","Whether exactly two editors have been selected in an editor group")),yRt=new ie("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,h("SelectedEditorsInGroupFileOrUntitledResourceContextKey","Whether all selected editors in a group have a file or untitled resource associated")),bQ=new ie("editorPartMultipleEditorGroups",!1,h("editorPartMultipleEditorGroups","Whether there are multiple editor groups opened in an editor part")),IRt=bQ.toNegated(),xde=new ie("editorPartMaximizedEditorGroup",!1,h("editorPartEditorGroupMaximized","Editor Part has a maximized group")),CRt=new ie("isAuxiliaryEditorPart",!1,h("isAuxiliaryEditorPart","Editor Part is in an auxiliary window")),vQ=new ie("editorIsOpen",!1,h("editorIsOpen","Whether an editor is open")),As=new ie("inZenMode",!1,h("inZenMode","Whether Zen mode is enabled")),_T=new ie("isCenteredLayout",!1,h("isMainEditorCenteredLayout","Whether centered layout is enabled for the main editor")),yQ=new ie("splitEditorsVertically",!1,h("splitEditorsVertically","Whether editors split vertically")),YP=new ie("mainEditorAreaVisible",!0,h("mainEditorAreaVisible","Whether the editor area in the main window is visible")),IQ=new ie("editorTabsVisible",!0,h("editorTabsVisible","Whether editor tabs are visible")),su=new ie("sideBarVisible",!1,h("sideBarVisible","Whether the sidebar is visible")),CQ=new ie("sideBarFocus",!1,h("sideBarFocus","Whether the sidebar has keyboard focus")),SQ=new ie("activeViewlet","",h("activeViewlet","The identifier of the active viewlet")),ym=new ie("statusBarFocused",!1,h("statusBarFocused","Whether the status bar has keyboard focus")),Im=new ie("titleBarStyle",_t?"native":"custom",h("titleBarStyle","Style of the window title bar")),_f=new ie("titleBarVisible",!1,h("titleBarVisible","Whether the title bar is visible")),SRt=new ie("bannerFocused",!1,h("bannerFocused","Whether the banner has keyboard focus")),Ps=new ie("notificationFocus",!0,h("notificationFocus","Whether a notification has keyboard focus")),mI=new ie("notificationCenterVisible",!1,h("notificationCenterVisible","Whether the notifications center is visible")),Hd=new ie("notificationToastsVisible",!1,h("notificationToastsVisible","Whether a notification toast is visible")),wQ=new ie("activeAuxiliary","",h("activeAuxiliary","The identifier of the active auxiliary panel")),EQ=new ie("auxiliaryBarFocus",!1,h("auxiliaryBarFocus","Whether the auxiliary bar has keyboard focus")),Dl=new ie("auxiliaryBarVisible",!1,h("auxiliaryBarVisible","Whether the auxiliary bar is visible")),TQ=new ie("activePanel","",h("activePanel","The identifier of the active panel")),xQ=new ie("panelFocus",!1,h("panelFocus","Whether the panel has keyboard focus")),au=new ie("panelPosition","bottom",h("panelPosition","The position of the panel, always 'bottom'")),Ll=new ie("panelAlignment","center",h("panelAlignment","The alignment of the panel, either 'center', 'left', 'right' or 'justify'")),Rp=new ie("panelVisible",!1,h("panelVisible","Whether the panel is visible")),ZP=new ie("panelMaximized",!1,h("panelMaximized","Whether the panel is maximized")),kl=new ie("focusedView","",h("focusedView","The identifier of the view that has keyboard focus"));var us=class{constructor(t,e,i,n){this._contextKeyService=t;this._fileService=e;this._languageService=i;this._modelService=n;this._schemeKey=us.Scheme.bindTo(this._contextKeyService),this._filenameKey=us.Filename.bindTo(this._contextKeyService),this._dirnameKey=us.Dirname.bindTo(this._contextKeyService),this._pathKey=us.Path.bindTo(this._contextKeyService),this._langIdKey=us.LangId.bindTo(this._contextKeyService),this._resourceKey=us.Resource.bindTo(this._contextKeyService),this._extensionKey=us.Extension.bindTo(this._contextKeyService),this._hasResource=us.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=us.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(e.onDidChangeFileSystemProviderRegistrations(()=>{let o=this.get();this._isFileSystemResource.set(!!(o&&e.hasProvider(o)))})),this._disposables.add(n.onModelAdded(o=>{Wn(o.uri,this.get())&&this._setLangId()})),this._disposables.add(n.onModelLanguageChanged(o=>{Wn(o.model.uri,this.get())&&this._setLangId()}))}static Scheme=new ie("resourceScheme",void 0,{type:"string",description:h("resourceScheme","The scheme of the resource")});static Filename=new ie("resourceFilename",void 0,{type:"string",description:h("resourceFilename","The file name of the resource")});static Dirname=new ie("resourceDirname",void 0,{type:"string",description:h("resourceDirname","The folder name the resource is contained in")});static Path=new ie("resourcePath",void 0,{type:"string",description:h("resourcePath","The full path of the resource")});static LangId=new ie("resourceLangId",void 0,{type:"string",description:h("resourceLangId","The language identifier of the resource")});static Resource=new ie("resource",void 0,{type:"URI",description:h("resource","The full value of the resource including scheme and path")});static Extension=new ie("resourceExtname",void 0,{type:"string",description:h("resourceExtname","The extension name of the resource")});static HasResource=new ie("resourceSet",void 0,{type:"boolean",description:h("resourceSet","Whether a resource is present or not")});static IsFileSystemResource=new ie("isFileSystemResource",void 0,{type:"boolean",description:h("isFileSystemResource","Whether the resource is backed by a file system provider")});_disposables=new W;_value;_resourceKey;_schemeKey;_filenameKey;_dirnameKey;_pathKey;_langIdKey;_extensionKey;_hasResource;_isFileSystemResource;dispose(){this._disposables.dispose()}_setLangId(){let t=this.get();if(!t){this._langIdKey.set(null);return}let e=this._modelService.getModel(t)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(t);this._langIdKey.set(e)}set(t){t=t??void 0,!Wn(this._value,t)&&(this._value=t,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(t?t.toString():null),this._schemeKey.set(t?t.scheme:null),this._filenameKey.set(t?Tr(t):null),this._dirnameKey.set(t?this.uriToPath(er(t)):null),this._pathKey.set(t?this.uriToPath(t):null),this._setLangId(),this._extensionKey.set(t?aw(t):null),this._hasResource.set(!!t),this._isFileSystemResource.set(t?this._fileService.hasProvider(t):!1)}))}uriToPath(t){return t.scheme===he.file?t.fsPath:t.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};us=_([v(0,ke),v(1,ai),v(2,Hn),v(3,Rr)],us);function _Q(r,t,e){if(!t){r.set("");return}let i=t.resource;if(i?.scheme===he.untitled&&t.editorId!==Ry.id)r.set("");else{let n=i?e.getEditors(i).map(o=>o.id):[];r.set(n.join(","))}}var _de={Quickaccess:"workbench.contributions.quickaccess"},i5=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(t){return t.prefix.length===0?this.defaultProvider=t:this.providers.push(t),this.providers.sort((e,i)=>i.prefix.length-e.prefix.length),te(()=>{this.providers.splice(this.providers.indexOf(t),1),this.defaultProvider===t&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return Ei([this.defaultProvider,...this.providers])}getQuickAccessProvider(t){return t&&this.providers.find(i=>t.startsWith(i.prefix))||void 0||this.defaultProvider}clear(){let t=[...this.providers],e=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=t,this.defaultProvider=e}}};Ne.add(_de.Quickaccess,new i5);var DQ=new an(()=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}}),WRt=new an(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),URt=new an(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));function n5(r,t,e=!1){let i=r||"",n=t||"",o=DQ.value.collator.compare(i,n);return DQ.value.collatorIsNumeric&&o===0&&i!==n?i<n?-1:1:o}function XP(r,t,e){let i=r.toLowerCase(),n=t.toLowerCase(),o=Dde(r,t,e);if(o)return o;let s=i.endsWith(e),a=n.endsWith(e);if(s!==a)return s?-1:1;let l=n5(i,n);return l!==0?l:i.localeCompare(n)}function Dde(r,t,e){let i=r.toLowerCase(),n=t.toLowerCase(),o=i.startsWith(e),s=n.startsWith(e);if(o!==s)return o?-1:1;if(o&&s){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var JP=0,LQ=[JP,[]];function kQ(r,t,e,i){if(!r||!t)return LQ;let n=r.length,o=t.length;if(n<o)return LQ;let s=r.toLowerCase();return Lde(t,e,o,r,s,n,i)}function Lde(r,t,e,i,n,o,s){let a=[],l=[];for(let p=0;p<e;p++){let m=p*o,g=m-o,f=p>0,b=r[p],y=t[p];for(let I=0;I<o;I++){let E=I>0,S=m+I,w=S-1,D=g+I-1,k=E?a[w]:0,R=f&&E?a[D]:0,A=f&&E?l[D]:0,H;!R&&f?H=0:H=kde(b,y,i,n,I,A),H&&R+H>=k&&(s||f||n.startsWith(t,I))?(l[S]=A+1,a[S]=R+H):(l[S]=JP,a[S]=k)}}let d=[],c=e-1,u=o-1;for(;c>=0&&u>=0;){let p=c*o+u;l[p]===JP||(d.push(u),c--),u--}return[a[e*o-1],d.reverse()]}function kde(r,t,e,i,n,o){let s=0;if(!Rde(t,i[n]))return s;if(s+=1,o>0&&(s+=o*5),r===e[n]&&(s+=1),n===0)s+=8;else{let a=Ade(e.charCodeAt(n-1));a?s+=a:dv(e.charCodeAt(n))&&o===0&&(s+=2)}return s}function Rde(r,t){return r===t?!0:r==="/"||r==="\\"?t==="/"||t==="\\":!1}function Ade(r){switch(r){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var eM=Object.freeze({score:0}),QP=1<<18,o5=1<<17,r5=65536;function Pde(r,t,e,i){let n=i.values?i.values:[i];return Xn({[i.normalized]:{values:n.map(s=>({value:s.normalized,expectContiguousMatch:s.expectContiguousMatch})),label:r,description:t,allowNonContiguousMatches:e}})}function tM(r,t,e,i,n){if(!r||!t.normalized)return eM;let o=i.getItemLabel(r);if(!o)return eM;let s=i.getItemDescription(r),a=Pde(o,s,e,t),l=n[a];if(l)return l;let d=Mde(o,s,i.getItemPath(r),t,e);return n[a]=d,d}function Mde(r,t,e,i,n){let o=!e||!i.containsPathSeparator;return e&&(_t?i.pathNormalized===e:Qs(i.pathNormalized,e))?{score:QP,labelMatch:[{start:0,end:r.length}],descriptionMatch:t?[{start:0,end:t.length}]:void 0}:i.values&&i.values.length>1?Ode(r,t,e,i.values,o,n):NQ(r,t,e,i,o,n)}function Ode(r,t,e,i,n,o){let s=0,a=[],l=[];for(let d of i){let{score:c,labelMatch:u,descriptionMatch:p}=NQ(r,t,e,d,n,o);if(c===JP)return eM;s+=c,u&&a.push(...u),p&&l.push(...p)}return{score:s,labelMatch:AQ(a),descriptionMatch:AQ(l)}}function NQ(r,t,e,i,n,o){if(n||!t){let[s,a]=kQ(r,i.normalized,i.normalizedLowercase,o&&!i.expectContiguousMatch);if(s){let l=Dg(i.normalized,r),d;if(l){d=o5;let c=Math.round(i.normalized.length/r.length*100);d+=c}else d=r5;return{score:d+s,labelMatch:l||RQ(a)}}}if(t){let s=t;e&&(s=`${t}${Gn}`);let a=s.length,l=`${s}${r}`,[d,c]=kQ(l,i.normalized,i.normalizedLowercase,o&&!i.expectContiguousMatch);if(d){let u=RQ(c),p=[],m=[];return u.forEach(g=>{g.start<a&&g.end>a?(p.push({start:0,end:g.end-a}),m.push({start:g.start,end:a})):g.start>=a?p.push({start:g.start-a,end:g.end-a}):m.push(g)}),{score:d,labelMatch:p,descriptionMatch:m}}}return eM}function RQ(r){let t=[];if(!r)return t;let e;for(let i of r)e&&e.end===i?e.end+=1:(e={start:i,end:i+1},t.push(e));return t}function AQ(r){let t=r.sort((n,o)=>n.start-o.start),e=[],i;for(let n of t)!i||!Nde(i,n)?(i=n,e.push(n)):(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end));return e}function Nde(r,t){return!(r.end<t.start||t.end<r.start)}function FQ(r,t,e,i,n,o){let s=tM(r,e,i,n,o),a=tM(t,e,i,n,o),l=s.score,d=a.score;if((l===QP||d===QP)&&l!==d)return l===QP?-1:1;if(l>r5||d>r5){if(l!==d)return l>d?-1:1;if(l<o5&&d<o5){let b=Fde(s.labelMatch,a.labelMatch);if(b!==0)return b}let g=n.getItemLabel(r)||"",f=n.getItemLabel(t)||"";if(g.length!==f.length)return g.length-f.length}if(l!==d)return l>d?-1:1;let c=Array.isArray(s.labelMatch)&&s.labelMatch.length>0,u=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(c&&!u)return-1;if(u&&!c)return 1;let p=PQ(r,s,n),m=PQ(t,a,n);return p&&m&&p!==m?m>p?-1:1:Bde(r,t,e,n)}function PQ(r,t,e){let i=-1,n=-1;if(t.descriptionMatch&&t.descriptionMatch.length?i=t.descriptionMatch[0].start:t.labelMatch&&t.labelMatch.length&&(i=t.labelMatch[0].start),t.labelMatch&&t.labelMatch.length){if(n=t.labelMatch[t.labelMatch.length-1].end,t.descriptionMatch&&t.descriptionMatch.length){let o=e.getItemDescription(r);o&&(n+=o.length)}}else t.descriptionMatch&&t.descriptionMatch.length&&(n=t.descriptionMatch[t.descriptionMatch.length-1].end);return n-i}function Fde(r,t){if(!r&&!t||(!r||!r.length)&&(!t||!t.length))return 0;if(!t||!t.length)return-1;if(!r||!r.length)return 1;let e=r[0].start,n=r[r.length-1].end-e,o=t[0].start,a=t[t.length-1].end-o;return n===a?0:a<n?1:-1}function Bde(r,t,e,i){let n=i.getItemLabel(r)||"",o=i.getItemLabel(t)||"",s=i.getItemDescription(r),a=i.getItemDescription(t),l=n.length+(s?s.length:0),d=o.length+(a?a.length:0);if(l!==d)return l-d;let c=i.getItemPath(r),u=i.getItemPath(t);return c&&u&&c.length!==u.length?c.length-u.length:n!==o?XP(n,o,e.normalized):s&&a&&s!==a?XP(s,a,e.normalized):c&&u&&c!==u?XP(c,u,e.normalized):0}function MQ(r){return r.startsWith('"')&&r.endsWith('"')}var Vde=" ";function BQ(r){typeof r!="string"&&(r="");let t=r.toLowerCase(),{pathNormalized:e,normalized:i,normalizedLowercase:n}=OQ(r),o=e.indexOf(Gn)>=0,s=MQ(r),a,l=r.split(Vde);if(l.length>1)for(let d of l){let c=MQ(d),{pathNormalized:u,normalized:p,normalizedLowercase:m}=OQ(d);p&&(a||(a=[]),a.push({original:d,originalLowercase:d.toLowerCase(),pathNormalized:u,normalized:p,normalizedLowercase:m,expectContiguousMatch:c}))}return{original:r,originalLowercase:t,pathNormalized:e,normalized:i,normalizedLowercase:n,values:a,containsPathSeparator:o,expectContiguousMatch:s}}function OQ(r){let t;rt?t=r.replace(/\//g,Gn):t=r.replace(/\\/g,Gn);let e=J7(t).replace(/\s|"/g,"");return{pathNormalized:t,normalized:e,normalizedLowercase:e.toLowerCase()}}var s5=class{constructor(t){this.options=t}getItemLabel(t){return t.label}getItemDescription(t){if(!this.options?.skipDescription)return t.description}getItemPath(t){if(!this.options?.skipPath)return t.resource?.scheme===he.file?t.resource.fsPath:t.resource?.path}},a5=new s5,$o=$("quickInputService");function VQ(r,t,e){return P7({debugName:()=>`Configuration Key "${r}"`},i=>e.onDidChangeConfiguration(n=>{n.affectsConfiguration(r)&&i(n)}),()=>e.getValue(r)??t)}function lu(r,t,e){let i=r.bindTo(t);return Wu({debugName:()=>`Set Context Key "${r.key}"`},n=>{i.set(e(n))})}var Rl=$("accessibilitySignalService"),ZAt=Symbol("AcknowledgeDocCommentsToken"),iM=class extends L{constructor(e,i,n){super();this.configurationService=e;this.accessibilityService=i;this.telemetryService=n}_serviceBrand;sounds=new Map;screenReaderAttached=Ti(this,this.accessibilityService.onDidChangeScreenReaderOptimized,()=>this.accessibilityService.isScreenReaderOptimized());sentTelemetry=new Set;getEnabledState(e,i,n){return new Q_(this._signalEnabledState.get({signal:e,userGesture:i,modality:n}))}async playSignal(e,i={}){let n=i.modality==="announcement"||i.modality===void 0,o=e.announcementMessage;n&&this.isAnnouncementEnabled(e,i.userGesture)&&o&&this.accessibilityService.status(o),(i.modality==="sound"||i.modality===void 0)&&this.isSoundEnabled(e,i.userGesture)&&(this.sendSignalTelemetry(e,i.source),await this.playSound(e.sound.getSound(),i.allowManyInParallel))}async playSignals(e){for(let s of e)this.sendSignalTelemetry("signal"in s?s.signal:s,"source"in s?s.source:void 0);let i=e.map(s=>"signal"in s?s.signal:s),n=i.filter(s=>this.isAnnouncementEnabled(s)).map(s=>s.announcementMessage);n.length&&this.accessibilityService.status(n.join(", "));let o=new Set(i.filter(s=>this.isSoundEnabled(s)).map(s=>s.sound.getSound()));await Promise.all(Array.from(o).map(s=>this.playSound(s,!0)))}sendSignalTelemetry(e,i){let n=this.accessibilityService.isScreenReaderOptimized(),o=e.name+(i?`::${i}`:"")+(n?"{screenReaderOptimized}":"");this.sentTelemetry.has(o)||this.getVolumeInPercent()===0||(this.sentTelemetry.add(o),this.telemetryService.publicLog2("signal.played",{signal:e.name,source:i??"",isScreenReaderOptimized:n}))}getVolumeInPercent(){let e=this.configurationService.getValue("accessibility.signalOptions.volume");return typeof e!="number"?50:Math.max(Math.min(e,100),0)}playingSounds=new Set;async playSound(e,i=!1){if(!i&&this.playingSounds.has(e))return;this.playingSounds.add(e);let n=Da.asBrowserUri(`vs/platform/accessibilitySignal/browser/media/${e.fileName}`).toString(!0);try{let o=this.sounds.get(n);if(o)o.volume=this.getVolumeInPercent()/100,o.currentTime=0,await o.play();else{let s=await Wde(n,this.getVolumeInPercent()/100);this.sounds.set(n,s)}}catch(o){o.message.includes("play() can only be initiated by a user gesture")||console.error("Error while playing sound",o)}finally{this.playingSounds.delete(e)}}playSignalLoop(e,i){let n=!0,o=()=>{n&&this.playSignal(e,{allowManyInParallel:!0}).finally(()=>{setTimeout(()=>{n&&o()},i)})};return o(),te(()=>n=!1)}_signalConfigValue=new fh(e=>VQ(e.settingsKey,{sound:"off",announcement:"off"},this.configurationService));_signalEnabledState=new fh({getCacheKey:_7},e=>et(i=>{let n=this._signalConfigValue.get(e.signal).read(i);return!!((e.modality==="sound"||e.modality===void 0)&&WQ(n.sound,()=>this.screenReaderAttached.read(i),e.userGesture)||(e.modality==="announcement"||e.modality===void 0)&&WQ(n.announcement,()=>this.screenReaderAttached.read(i),e.userGesture))}).recomputeInitiallyAndOnChange(this._store));isAnnouncementEnabled(e,i){return e.announcementMessage?this._signalEnabledState.get({signal:e,userGesture:!!i,modality:"announcement"}).get():!1}isSoundEnabled(e,i){return this._signalEnabledState.get({signal:e,userGesture:!!i,modality:"sound"}).get()}onSoundEnabledChanged(e){return this.getEnabledState(e,!1).onDidChange}getDelayMs(e,i,n){if(!this.configurationService.getValue("accessibility.signalOptions.debouncePositionChanges"))return 0;let o;return e.name===mo.errorAtPosition.name&&n==="positional"?o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.errorAtPosition"):e.name===mo.warningAtPosition.name&&n==="positional"?o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.warningAtPosition"):o=this.configurationService.getValue("accessibility.signalOptions.experimental.delays.general"),i==="sound"?o.sound:o.announcement}};iM=_([v(0,de),v(1,zo),v(2,qt)],iM);function WQ(r,t,e){return r==="on"||r==="always"||r==="auto"&&t()||r==="userGesture"&&e}function Wde(r,t){return new Promise((e,i)=>{let n=new Audio(r);n.volume=t,n.addEventListener("ended",()=>{e(n)}),n.addEventListener("error",o=>{i(o.error)}),n.play().catch(o=>{i(o)})})}var Hi=class r{constructor(t){this.fileName=t}static register(t){return new r(t.fileName)}static error=r.register({fileName:"error.mp3"});static warning=r.register({fileName:"warning.mp3"});static success=r.register({fileName:"success.mp3"});static foldedArea=r.register({fileName:"foldedAreas.mp3"});static break=r.register({fileName:"break.mp3"});static quickFixes=r.register({fileName:"quickFixes.mp3"});static taskCompleted=r.register({fileName:"taskCompleted.mp3"});static taskFailed=r.register({fileName:"taskFailed.mp3"});static terminalBell=r.register({fileName:"terminalBell.mp3"});static diffLineInserted=r.register({fileName:"diffLineInserted.mp3"});static diffLineDeleted=r.register({fileName:"diffLineDeleted.mp3"});static diffLineModified=r.register({fileName:"diffLineModified.mp3"});static chatRequestSent=r.register({fileName:"chatRequestSent.mp3"});static chatResponseReceived1=r.register({fileName:"chatResponseReceived1.mp3"});static chatResponseReceived2=r.register({fileName:"chatResponseReceived2.mp3"});static chatResponseReceived3=r.register({fileName:"chatResponseReceived3.mp3"});static chatResponseReceived4=r.register({fileName:"chatResponseReceived4.mp3"});static clear=r.register({fileName:"clear.mp3"});static save=r.register({fileName:"save.mp3"});static format=r.register({fileName:"format.mp3"});static voiceRecordingStarted=r.register({fileName:"voiceRecordingStarted.mp3"});static voiceRecordingStopped=r.register({fileName:"voiceRecordingStopped.mp3"});static progress=r.register({fileName:"progress.mp3"})},l5=class{constructor(t){this.randomOneOf=t}getSound(t=!1){if(t||this.randomOneOf.length===1)return this.randomOneOf[0];{let e=Math.floor(Math.random()*this.randomOneOf.length);return this.randomOneOf[e]}}},mo=class r{constructor(t,e,i,n,o,s){this.sound=t;this.name=e;this.legacySoundSettingsKey=i;this.settingsKey=n;this.legacyAnnouncementSettingsKey=o;this.announcementMessage=s}static _signals=new Set;static register(t){let e=new l5("randomOneOf"in t.sound?t.sound.randomOneOf:[t.sound]),i=new r(e,t.name,t.legacySoundSettingsKey,t.settingsKey,t.legacyAnnouncementSettingsKey,t.announcementMessage);return r._signals.add(i),i}static get allAccessibilitySignals(){return[...this._signals]}static errorAtPosition=r.register({name:h("accessibilitySignals.positionHasError.name","Error at Position"),sound:Hi.error,announcementMessage:h("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"});static warningAtPosition=r.register({name:h("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:Hi.warning,announcementMessage:h("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"});static errorOnLine=r.register({name:h("accessibilitySignals.lineHasError.name","Error on Line"),sound:Hi.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:h("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"});static warningOnLine=r.register({name:h("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:Hi.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:h("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"});static foldedArea=r.register({name:h("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:Hi.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:h("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"});static break=r.register({name:h("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:Hi.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:h("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"});static inlineSuggestion=r.register({name:h("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:Hi.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"});static terminalQuickFix=r.register({name:h("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:Hi.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:h("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"});static onDebugBreak=r.register({name:h("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:Hi.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:h("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"});static noInlayHints=r.register({name:h("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:Hi.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:h("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"});static taskCompleted=r.register({name:h("accessibilitySignals.taskCompleted","Task Completed"),sound:Hi.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:h("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"});static taskFailed=r.register({name:h("accessibilitySignals.taskFailed","Task Failed"),sound:Hi.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:h("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"});static terminalCommandFailed=r.register({name:h("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:Hi.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:h("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"});static terminalCommandSucceeded=r.register({name:h("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:Hi.success,announcementMessage:h("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"});static terminalBell=r.register({name:h("accessibilitySignals.terminalBell","Terminal Bell"),sound:Hi.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:h("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"});static notebookCellCompleted=r.register({name:h("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:Hi.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:h("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"});static notebookCellFailed=r.register({name:h("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:Hi.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:h("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"});static diffLineInserted=r.register({name:h("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:Hi.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"});static diffLineDeleted=r.register({name:h("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:Hi.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"});static diffLineModified=r.register({name:h("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:Hi.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"});static chatRequestSent=r.register({name:h("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:Hi.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:h("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"});static chatResponseReceived=r.register({name:h("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Hi.chatResponseReceived1,Hi.chatResponseReceived2,Hi.chatResponseReceived3,Hi.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"});static progress=r.register({name:h("accessibilitySignals.progress","Progress"),sound:Hi.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:h("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"});static clear=r.register({name:h("accessibilitySignals.clear","Clear"),sound:Hi.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:h("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"});static save=r.register({name:h("accessibilitySignals.save","Save"),sound:Hi.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:h("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"});static format=r.register({name:h("accessibilitySignals.format","Format"),sound:Hi.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:h("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"});static voiceRecordingStarted=r.register({name:h("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:Hi.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"});static voiceRecordingStopped=r.register({name:h("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:Hi.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"})};var nM="notifications.showList",Df="notifications.hideList",Ude="notifications.toggleList",d5="notifications.hideToasts",UQ="notifications.focusToasts",Hde="notifications.focusNextToast",zde="notifications.focusPreviousToast",Kde="notifications.focusFirstToast",Gde="notifications.focusLastToast",oM="notification.collapse",rM="notification.expand",HQ="notification.acceptPrimaryAction",qde="notification.toggle",sM="notification.clear",DT="notifications.clearAll",LT="notifications.toggleDoNotDisturbMode",kT="notifications.toggleDoNotDisturbModeBySource";function Cm(r,t){if(XE(t))return t;let e=r.lastFocusedList;if(e instanceof tu){let i=e.getFocusedElements()[0];if(XE(i)||e.isDOMFocused()&&(i=e.element(0)),XE(i))return i}}function zQ(r,t,e){Zt.registerCommandAndKeybindingRule({id:nM,weight:200,primary:Kr(2089,3116),handler:()=>{t.hide(),r.show()}}),Zt.registerCommandAndKeybindingRule({id:Df,weight:250,when:mI,primary:9,handler:n=>{let o=n.get(qt);for(let s of e.notifications)s.visible&&o.publicLog2("notification:hide",yT(s.message.original,s.sourceId,s.priority===1));r.hide()}}),En.registerCommand(Ude,()=>{r.isVisible?r.hide():(t.hide(),r.show())}),Zt.registerCommandAndKeybindingRule({id:sM,weight:200,when:Ps,primary:20,mac:{primary:2049},handler:(n,o)=>{let s=n.get(Rl),a=Cm(n.get(ko),o);a&&!a.hasProgress&&(a.close(),s.playSignal(mo.clear))}}),Zt.registerCommandAndKeybindingRule({id:rM,weight:200,when:Ps,primary:17,handler:(n,o)=>{Cm(n.get(ko),o)?.expand()}}),Zt.registerCommandAndKeybindingRule({id:HQ,weight:200,when:X.or(Ps,Hd),primary:3103,handler:n=>{let o=n.get(ae).createInstance(Ap),s=Cm(n.get(ko))||e.notifications.at(0);if(!s)return;let a=s.actions?.primary?s.actions.primary.at(0):void 0;a&&(o.run(a,s),s.close())}}),Zt.registerCommandAndKeybindingRule({id:oM,weight:200,when:Ps,primary:15,handler:(n,o)=>{Cm(n.get(ko),o)?.collapse()}}),Zt.registerCommandAndKeybindingRule({id:qde,weight:200,when:Ps,primary:10,secondary:[3],handler:n=>{Cm(n.get(ko))?.toggle()}}),En.registerCommand(d5,n=>{let o=n.get(qt);for(let s of e.notifications)s.visible&&o.publicLog2("notification:hide",yT(s.message.original,s.sourceId,s.priority===1));t.hide()}),Zt.registerKeybindingRule({id:d5,weight:150,when:Hd,primary:9}),Zt.registerKeybindingRule({id:d5,weight:300,when:X.and(Hd,Ps),primary:9}),En.registerCommand(UQ,()=>t.focus()),Zt.registerCommandAndKeybindingRule({id:Hde,weight:200,when:X.and(Ps,Hd),primary:18,handler:()=>{t.focusNext()}}),Zt.registerCommandAndKeybindingRule({id:zde,weight:200,when:X.and(Ps,Hd),primary:16,handler:()=>{t.focusPrevious()}}),Zt.registerCommandAndKeybindingRule({id:Kde,weight:200,when:X.and(Ps,Hd),primary:11,secondary:[14],handler:()=>{t.focusFirst()}}),Zt.registerCommandAndKeybindingRule({id:Gde,weight:200,when:X.and(Ps,Hd),primary:12,secondary:[13],handler:()=>{t.focusLast()}}),En.registerCommand(DT,()=>r.clearAll()),En.registerCommand(LT,n=>{let o=n.get(jt);o.setFilter(o.getFilter()===1?0:1)}),En.registerCommand(kT,n=>{let o=n.get(jt),s=n.get($o),a=o.getFilters().sort((c,u)=>c.label.localeCompare(u.label)),l=new W,d=l.add(s.createQuickPick());d.items=a.map(c=>({id:c.id,label:c.label,tooltip:`${c.label} (${c.id})`,filter:c.filter})),d.canSelectMany=!0,d.placeholder=h("selectSources","Select sources to enable all notifications from"),d.selectedItems=d.items.filter(c=>c.filter===0),d.show(),l.add(d.onDidAccept(async()=>{for(let c of d.items)o.setFilter({id:c.id,label:c.label,filter:d.selectedItems.includes(c)?0:1});d.hide()})),l.add(d.onDidHide(()=>l.dispose()))});let i=pe("notifications","Notifications");Ct.appendMenuItem(ee.CommandPalette,{command:{id:nM,title:pe("showNotifications","Show Notifications"),category:i}}),Ct.appendMenuItem(ee.CommandPalette,{command:{id:Df,title:pe("hideNotifications","Hide Notifications"),category:i},when:mI}),Ct.appendMenuItem(ee.CommandPalette,{command:{id:DT,title:pe("clearAllNotifications","Clear All Notifications"),category:i}}),Ct.appendMenuItem(ee.CommandPalette,{command:{id:HQ,title:pe("acceptNotificationPrimaryAction","Accept Notification Primary Action"),category:i}}),Ct.appendMenuItem(ee.CommandPalette,{command:{id:LT,title:pe("toggleDoNotDisturbMode","Toggle Do Not Disturb Mode"),category:i}}),Ct.appendMenuItem(ee.CommandPalette,{command:{id:kT,title:pe("toggleDoNotDisturbModeBySource","Toggle Do Not Disturb Mode By Source..."),category:i}}),Ct.appendMenuItem(ee.CommandPalette,{command:{id:UQ,title:pe("focusNotificationToasts","Focus Notification Toast"),category:i},when:Hd})}var Ap=class extends wn{constructor(e,i){super();this.telemetryService=e;this.notificationService=i}async runAction(e,i){this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.id,from:"message"}),XE(i)&&this.telemetryService.publicLog2("notification:actionExecuted",{id:Xn(i.message.original.toString()).toString(),actionLabel:e.label,source:i.sourceId||"core",silent:i.priority===1});try{await super.runAction(e,i)}catch(n){this.notificationService.error(n)}}};Ap=_([v(0,qt),v(1,jt)],Ap);var Os=$("openerService");function aM(r){let t,e=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(r.fragment);return e&&(t={startLineNumber:parseInt(e[1]),startColumn:e[2]?parseInt(e[2]):1,endLineNumber:e[4]?parseInt(e[4]):void 0,endColumn:e[4]?e[5]?parseInt(e[5]):1:void 0},r=r.with({fragment:""})),{selection:t,uri:r}}var gI=$("clipboardService");var jde=Tt("notifications-clear",B.close,h("clearIcon","Icon for the clear action in notifications.")),$de=Tt("notifications-clear-all",B.clearAll,h("clearAllIcon","Icon for the clear all action in notifications.")),Yde=Tt("notifications-hide",B.chevronDown,h("hideIcon","Icon for the hide action in notifications.")),Zde=Tt("notifications-expand",B.chevronUp,h("expandIcon","Icon for the expand action in notifications.")),Xde=Tt("notifications-collapse",B.chevronDown,h("collapseIcon","Icon for the collapse action in notifications.")),Qde=Tt("notifications-configure",B.gear,h("configureIcon","Icon for the configure action in notifications.")),KQ=Tt("notifications-do-not-disturb",B.bellSlash,h("doNotDisturbIcon","Icon for the mute all action in notifications.")),Sm=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(jde));this.commandService=n}static ID=sM;static LABEL=h("clearNotification","Clear Notification");async run(e){this.commandService.executeCommand(sM,e)}};Sm=_([v(2,ni)],Sm);var wm=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName($de));this.commandService=n}static ID=DT;static LABEL=h("clearNotifications","Clear All Notifications");async run(){this.commandService.executeCommand(DT)}};wm=_([v(2,ni)],wm);var Lf=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(KQ));this.commandService=n}static ID=LT;static LABEL=h("toggleDoNotDisturbMode","Toggle Do Not Disturb Mode");async run(){this.commandService.executeCommand(LT)}};Lf=_([v(2,ni)],Lf);var kf=class extends ot{constructor(e,i,n){super(e,i);this.commandService=n}static ID=kT;static LABEL=h("toggleDoNotDisturbModeBySource","Toggle Do Not Disturb Mode By Source...");async run(){this.commandService.executeCommand(kT)}};kf=_([v(2,ni)],kf);var Rf=class extends ot{static ID="workbench.action.configureDoNotDisturbMode";static LABEL=h("configureDoNotDisturbMode","Configure Do Not Disturb...");constructor(t,e){super(t,e,ye.asClassName(KQ))}},Em=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(Yde));this.commandService=n}static ID=Df;static LABEL=h("hideNotificationsCenter","Hide Notifications");async run(){this.commandService.executeCommand(Df)}};Em=_([v(2,ni)],Em);var Tm=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(Zde));this.commandService=n}static ID=rM;static LABEL=h("expandNotification","Expand Notification");async run(e){this.commandService.executeCommand(rM,e)}};Tm=_([v(2,ni)],Tm);var xm=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(Xde));this.commandService=n}static ID=oM;static LABEL=h("collapseNotification","Collapse Notification");async run(e){this.commandService.executeCommand(oM,e)}};xm=_([v(2,ni)],xm);var Af=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(Qde));this.notification=n}static ID="workbench.action.configureNotification";static LABEL=h("configureNotification","More Actions...")},_m=class extends ot{constructor(e,i,n){super(e,i);this.clipboardService=n}static ID="workbench.action.copyNotificationMessage";static LABEL=h("copyNotification","Copy Text");run(e){return this.clipboardService.writeText(e.message.raw)}};_m=_([v(2,gI)],_m);var Al=class extends zn{menuActionsOrProvider;dropdownMenu;contextMenuProvider;actionItem=null;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;options;constructor(t,e,i,n=Object.create(null)){super(null,t,n),this.menuActionsOrProvider=e,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(t){this.actionItem=t;let e=o=>{this.element=Ee(o,re("a.action-label"));let s=[];return typeof this.options.classNames=="string"?s=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(s=this.options.classNames),s.find(a=>a==="icon")||s.push("codicon"),this.element.classList.add(...s),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register($n().setupManagedHover(this.options.hoverDelegate??zt("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:e,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new cP(t,n)),this._register(this.dropdownMenu.onDidChangeVisibility(o=>{this.element?.setAttribute("aria-expanded",`${o}`),this._onDidChangeVisibility.fire(o)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let o=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return o.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let t=null;return this.action.tooltip?t=this.action.tooltip:this.action.label&&(t=this.action.label),t??void 0}setActionContext(t){super.setActionContext(t),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=t:this.dropdownMenu.menuOptions={context:t})}show(){this.dropdownMenu?.show()}updateEnabled(){let t=!this.action.enabled;this.actionItem?.classList.toggle("disabled",t),this.element?.classList.toggle("disabled",t)}};var qi=$("hoverService"),du=class extends L{constructor(e,i,n={},o,s){super();this.placement=e;this.instantHover=i;this.overrideOptions=n;this.configurationService=o;this.hoverService=s;this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}lastHoverHideTime=0;timeLimit=200;_delay;get delay(){return this.isInstantlyHovering()?0:this._delay}hoverDisposables=this._register(new W);showHover(e,i){let n=typeof this.overrideOptions=="function"?this.overrideOptions(e,i):this.overrideOptions;this.hoverDisposables.clear();let o=Oi(e.target)?[e.target]:e.target.targetElements;for(let a of o)this.hoverDisposables.add(Wi(a,"keydown",l=>{l.equals(9)&&this.hoverService.hideHover()}));let s=Oi(e.content)?void 0:e.content.toString();return this.hoverService.showHover({...e,...n,persistence:{hideOnKeyDown:!0,...n.persistence},id:s,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...n.appearance}},i)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}setInstantHoverTimeLimit(e){if(!this.instantHover)throw new Error("Instant hover is not enabled");this.timeLimit=e}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};du=_([v(3,de),v(4,qi)],du);var c5={showHover:function(){throw new Error("Native hover function not implemented.")},delay:0,showNativeHover:!0};var lM=class r{static ROW_HEIGHT=42;static LINE_HEIGHT=22;offsetHelper;constructor(t){this.offsetHelper=this.createOffsetHelper(t)}createOffsetHelper(t){let e=document.createElement("div");return e.classList.add("notification-offset-helper"),t.appendChild(e),e}getHeight(t){if(!t.expanded)return r.ROW_HEIGHT;let e=r.ROW_HEIGHT,i=this.computePreferredHeight(t);if(r.LINE_HEIGHT<i){let o=i-r.LINE_HEIGHT;e+=o}return(t.source||FS(t.actions&&t.actions.primary))&&(e+=r.ROW_HEIGHT),e===r.ROW_HEIGHT&&t.collapse(!0),e}computePreferredHeight(t){let e=0;t.hasProgress||e++,t.canCollapse&&e++,FS(t.actions&&t.actions.secondary)&&e++,this.offsetHelper.style.width=`${450-(40+e*30-Math.max(e-1,0)*4)}px`;let i=dM.render(t.message);this.offsetHelper.appendChild(i);let n=Math.max(this.offsetHelper.offsetHeight,this.offsetHelper.scrollHeight);return ci(this.offsetHelper),n}getTemplateId(t){if(t instanceof Vy)return Pp.TEMPLATE_ID;throw new Error("unknown element type: "+t)}},dM=class{static render(t,e){let i=document.createElement("span");for(let n of t.linkedText.nodes)if(typeof n=="string")i.appendChild(document.createTextNode(n));else{let o=n.title;!o&&n.href.startsWith("command:")?o=h("executeCommand","Click to execute command '{0}'",n.href.substr(8)):o||(o=n.href);let s=re("a",{href:n.href,title:o,tabIndex:0},n.label);if(e){let a=p=>{t$(p)&&Te.stop(p,!0),e.callback(n.href)},l=e.toDispose.add(new Ge(s,G.CLICK)).event,d=e.toDispose.add(new Ge(s,G.KEY_DOWN)).event,c=O.chain(d,p=>p.filter(m=>{let g=new st(m);return g.equals(10)||g.equals(3)}));e.toDispose.add(Wt.addTarget(s));let u=e.toDispose.add(new Ge(s,it.Tap)).event;O.any(l,u,c)(a,null,e.toDispose)}i.appendChild(s)}return i}},Pp=class{constructor(t,e,i,n){this.actionRunner=t;this.contextMenuService=e;this.instantiationService=i;this.notificationService=n}static TEMPLATE_ID="notification";get templateId(){return Pp.TEMPLATE_ID}renderTemplate(t){let e=Object.create(null);e.toDispose=new W,e.container=document.createElement("div"),e.container.classList.add("notification-list-item"),e.mainRow=document.createElement("div"),e.mainRow.classList.add("notification-list-item-main-row"),e.icon=document.createElement("div"),e.icon.classList.add("notification-list-item-icon","codicon"),e.message=document.createElement("div"),e.message.classList.add("notification-list-item-message");let i=this,n=document.createElement("div");return n.classList.add("notification-list-item-toolbar-container"),e.toolbar=new gn(n,{ariaLabel:h("notificationActions","Notification Actions"),actionViewItemProvider:(o,s)=>{if(o instanceof Af)return e.toDispose.add(new Al(o,{getActions(){let a=[],l={id:o.notification.sourceId,label:o.notification.source};if(Ty(l)){let d=i.notificationService.getFilter(l)===1;a.push(Ht({id:l.id,label:d?h("turnOnNotifications","Turn On All Notifications from '{0}'",l.label):h("turnOffNotifications","Turn Off Info and Warning Notifications from '{0}'",l.label),run:()=>i.notificationService.setFilter({...l,filter:d?0:1})})),o.notification.actions?.secondary?.length&&a.push(new pt)}return Array.isArray(o.notification.actions?.secondary)&&a.push(...o.notification.actions.secondary),a}},this.contextMenuService,{...s,actionRunner:this.actionRunner,classNames:o.class}))},actionRunner:this.actionRunner}),e.toDispose.add(e.toolbar),e.detailsRow=document.createElement("div"),e.detailsRow.classList.add("notification-list-item-details-row"),e.source=document.createElement("div"),e.source.classList.add("notification-list-item-source"),e.buttonsContainer=document.createElement("div"),e.buttonsContainer.classList.add("notification-list-item-buttons-container"),t.appendChild(e.container),e.container.appendChild(e.detailsRow),e.detailsRow.appendChild(e.source),e.detailsRow.appendChild(e.buttonsContainer),e.container.appendChild(e.mainRow),e.mainRow.appendChild(e.icon),e.mainRow.appendChild(e.message),e.mainRow.appendChild(n),e.progress=new pm(t,eI),e.toDispose.add(e.progress),e.renderer=this.instantiationService.createInstance(ba,e,this.actionRunner),e.toDispose.add(e.renderer),e}renderElement(t,e,i){i.renderer.setInput(t)}disposeTemplate(t){nt(t.toDispose)}};Pp=_([v(1,Mt),v(2,ae),v(3,jt)],Pp);var ba=class extends L{constructor(e,i,n,o,s,a,l){super();this.template=e;this.actionRunner=i;this.openerService=n;this.instantiationService=o;this.keybindingService=s;this.contextMenuService=a;this.hoverService=l;ba.closeNotificationAction||(ba.closeNotificationAction=o.createInstance(Sm,Sm.ID,Sm.LABEL),ba.expandNotificationAction=o.createInstance(Tm,Tm.ID,Tm.LABEL),ba.collapseNotificationAction=o.createInstance(xm,xm.ID,xm.LABEL))}static closeNotificationAction;static expandNotificationAction;static collapseNotificationAction;static SEVERITIES=[ui.Info,ui.Warning,ui.Error];inputDisposables=this._register(new W);setInput(e){this.inputDisposables.clear(),this.render(e)}render(e){this.template.container.classList.toggle("expanded",e.expanded),this.inputDisposables.add(M(this.template.container,G.MOUSE_UP,s=>{s.button===1&&Te.stop(s,!0)})),this.inputDisposables.add(M(this.template.container,G.AUXCLICK,s=>{!e.hasProgress&&s.button===1&&(Te.stop(s,!0),e.close())})),this.renderSeverity(e);let i=this.inputDisposables.add(this.hoverService.setupManagedHover(zt("mouse"),this.template.message,"")),n=this.renderMessage(e,i);this.renderSecondaryActions(e,n);let o=this.inputDisposables.add(this.hoverService.setupManagedHover(zt("mouse"),this.template.source,""));this.renderSource(e,o),this.renderButtons(e),this.renderProgress(e),this.inputDisposables.add(e.onDidChangeContent(s=>{switch(s.kind){case 0:this.renderSeverity(e);break;case 3:this.renderProgress(e);break;case 1:this.renderMessage(e,i);break}}))}renderSeverity(e){ba.SEVERITIES.forEach(i=>{e.severity!==i&&this.template.icon.classList.remove(...ye.asClassNameArray(this.toSeverityIcon(i)))}),this.template.icon.classList.add(...ye.asClassNameArray(this.toSeverityIcon(e.severity)))}renderMessage(e,i){ci(this.template.message),this.template.message.appendChild(dM.render(e.message,{callback:o=>this.openerService.open(q.parse(o),{allowCommands:!0}),toDispose:this.inputDisposables}));let n=e.canCollapse&&!e.expanded&&this.template.message.scrollWidth>this.template.message.clientWidth;return i.update(n?this.template.message.textContent+"":""),n}renderSecondaryActions(e,i){let n=[];if(FS(e.actions?.secondary)){let s=this.instantiationService.createInstance(Af,Af.ID,Af.LABEL,e);n.push(s),this.inputDisposables.add(s)}let o=!1;e.canCollapse&&(e.expanded||e.source||i)&&(o=!0),o&&n.push(e.expanded?ba.collapseNotificationAction:ba.expandNotificationAction),e.hasProgress||n.push(ba.closeNotificationAction),this.template.toolbar.clear(),this.template.toolbar.context=e,n.forEach(s=>this.template.toolbar.push(s,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(s)}))}renderSource(e,i){e.expanded&&e.source?(this.template.source.textContent=h("notificationSource","Source: {0}",e.source),i.update(e.source)):(this.template.source.textContent="",i.update(""))}renderButtons(e){ci(this.template.buttonsContainer);let i=e.actions?e.actions.primary:void 0;if(e.expanded&&FS(i)){let n=this,o=new class extends wn{async runAction(a){n.actionRunner.run(a,e),(!(a instanceof gf)||!a.keepOpen)&&e.close()}},s=this.inputDisposables.add(new hT(this.template.buttonsContainer));for(let a=0;a<i.length;a++){let l=i[a],d={title:!0,secondary:a>0,...gP},c=l instanceof gf?l.menu:void 0,u=this.inputDisposables.add(c?s.addButtonWithDropdown({...d,contextMenuProvider:this.contextMenuService,actions:c,actionRunner:o}):s.addButton(d));u.label=l.label,this.inputDisposables.add(u.onDidClick(p=>{p&&Te.stop(p,!0),o.run(l)}))}}}renderProgress(e){if(!e.hasProgress){this.template.progress.stop().hide();return}let i=e.progress.state;i.infinite?this.template.progress.infinite().show():typeof i.total=="number"||typeof i.worked=="number"?(typeof i.total=="number"&&!this.template.progress.hasTotal()&&this.template.progress.total(i.total),typeof i.worked=="number"&&this.template.progress.setWorked(i.worked).show()):this.template.progress.done().hide()}toSeverityIcon(e){switch(e){case ui.Warning:return B.warning;case ui.Error:return B.error}return B.info}getKeybindingLabel(e){let i=this.keybindingService.lookupKeybinding(e.id);return i?i.getLabel():null}};ba=_([v(2,Os),v(3,ae),v(4,at),v(5,Mt),v(6,qi)],ba);var Dm=class extends L{constructor(e,i,n,o){super();this.container=e;this.options=i;this.instantiationService=n;this.contextMenuService=o}listContainer;list;listDelegate;viewModel=[];isVisible;show(){this.isVisible||(this.list||this.createNotificationsList(),this.isVisible=!0)}createNotificationsList(){this.listContainer=document.createElement("div"),this.listContainer.classList.add("notifications-list-container");let e=this._register(this.instantiationService.createInstance(Ap)),i=this.instantiationService.createInstance(Pp,e),n=this.listDelegate=new lM(this.listContainer),o=this.options,s=this.list=this._register(this.instantiationService.createInstance(tu,"NotificationsList",this.listContainer,n,[i],{...o,setRowLineHeight:!1,horizontalScrolling:!1,overrideStyles:{listBackground:Bh},accessibilityProvider:this.instantiationService.createInstance(RT,o)})),a=this._register(this.instantiationService.createInstance(_m,_m.ID,_m.LABEL));this._register(s.onContextMenu(d=>{d.element&&this.contextMenuService.showContextMenu({getAnchor:()=>d.anchor,getActions:()=>[a],getActionsContext:()=>d.element,actionRunner:e})})),this._register(s.onMouseDblClick(d=>d.element.toggle()));let l=this._register(Un(s.getHTMLElement()));this._register(l.onDidBlur(()=>{oe(this.listContainer).document.hasFocus()&&s.setFocus([])})),Ps.bindTo(s.contextKeyService),this._register(s.onDidChangeSelection(d=>{d.indexes.length>0&&s.setSelection([])})),this.container.appendChild(this.listContainer)}updateNotificationsList(e,i,n=[]){let[o,s]=Zs(this.list,this.listContainer),a=Oa(s),l=o.getFocus()[0],d=this.viewModel[l],c=null;if(typeof l=="number"&&(c=o.getRelativeTop(l)),this.viewModel.splice(e,i,...n),o.splice(e,i,n),o.layout(),this.viewModel.length===0)this.hide();else if(typeof l=="number"){let u=0;if(d){let p=this.viewModel.indexOf(d);p===-1&&(p=l-1),p<this.viewModel.length&&p>=0&&(u=p)}typeof c=="number"&&o.reveal(u,c),o.setFocus([u])}this.isVisible&&a&&o.domFocus()}updateNotificationHeight(e){let i=this.viewModel.indexOf(e);if(i===-1)return;let[n,o]=Zs(this.list,this.listDelegate);n.updateElementHeight(i,o.getHeight(e)),n.layout()}hide(){!this.isVisible||!this.list||(this.isVisible=!1,this.list.splice(0,this.viewModel.length),this.viewModel=[])}focusFirst(){this.list&&(this.list.focusFirst(),this.list.domFocus())}hasFocus(){return this.listContainer?Oa(this.listContainer):!1}layout(e,i){this.listContainer&&this.list&&(this.listContainer.style.width=`${e}px`,typeof i=="number"&&(this.list.getHTMLElement().style.maxHeight=`${i}px`),this.list.layout())}dispose(){this.hide(),super.dispose()}};Dm=_([v(2,ae),v(3,Mt)],Dm);var RT=class{constructor(t,e,i){this._options=t;this._keybindingService=e;this._configurationService=i}getAriaLabel(t){let e,i=this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel();return this._configurationService.getValue("accessibility.verbosity.notification")&&(e=i?h("notificationAccessibleViewHint","Inspect the response in the accessible view with {0}",i):h("notificationAccessibleViewHintNoKb","Inspect the response in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding")),t.source?e?h("notificationWithSourceAriaLabelHint","{0}, source: {1}, notification, {2}",t.message.raw,t.source,e):h("notificationWithSourceAriaLabel","{0}, source: {1}, notification",t.message.raw,t.source):e?h("notificationAriaLabelHint","{0}, notification, {1}",t.message.raw,e):h("notificationAriaLabel","{0}, notification",t.message.raw)}getWidgetAriaLabel(){return this._options.widgetAriaLabel??h("notificationsList","Notifications List")}getRole(){return"dialog"}};RT=_([v(1,at),v(2,de)],RT);var zd=class extends ia{constructor(e,i,n,o,s,a,l,d,c,u,p){super(n);this.container=e;this.model=i;this.instantiationService=o;this.layoutService=s;this.contextKeyService=a;this.editorGroupService=l;this.keybindingService=d;this.notificationService=c;this.accessibilitySignalService=u;this.contextMenuService=p;this.notificationsCenterVisibleContextKey=mI.bindTo(a),this.registerListeners()}static MAX_DIMENSIONS=new dt(450,400);static MAX_NOTIFICATION_SOURCES=10;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;notificationsCenterContainer;notificationsCenterHeader;notificationsCenterTitle;notificationsList;_isVisible;workbenchDimensions;notificationsCenterVisibleContextKey=mI.bindTo(this.contextKeyService);clearAllAction;configureDoNotDisturbAction;registerListeners(){this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e))),this._register(this.layoutService.onDidLayoutMainContainer(e=>this.layout(dt.lift(e)))),this._register(this.notificationService.onDidChangeFilter(()=>this.onDidChangeFilter()))}onDidChangeFilter(){this.notificationService.getFilter()===1&&this.hide()}get isVisible(){return!!this._isVisible}show(){if(this._isVisible){let n=Ue(this.notificationsList);n.show(),n.focusFirst();return}this.notificationsCenterContainer||this.create(),this.updateTitle();let[e,i]=Zs(this.notificationsList,this.notificationsCenterContainer);this._isVisible=!0,i.classList.add("visible"),e.show(),this.layout(this.workbenchDimensions),e.updateNotificationsList(0,0,this.model.notifications),e.focusFirst(),this.updateStyles(),this.model.notifications.forEach(n=>n.updateVisibility(!0)),this.notificationsCenterVisibleContextKey.set(!0),this._onDidChangeVisibility.fire()}updateTitle(){let[e,i]=Zs(this.notificationsCenterTitle,this.clearAllAction);this.model.notifications.length===0?(e.textContent=h("notificationsEmpty","No new notifications"),i.enabled=!1):(e.textContent=h("notifications","Notifications"),i.enabled=this.model.notifications.some(n=>!n.hasProgress))}create(){this.notificationsCenterContainer=document.createElement("div"),this.notificationsCenterContainer.classList.add("notifications-center"),this.notificationsCenterHeader=document.createElement("div"),this.notificationsCenterHeader.classList.add("notifications-center-header"),this.notificationsCenterContainer.appendChild(this.notificationsCenterHeader),this.notificationsCenterTitle=document.createElement("span"),this.notificationsCenterTitle.classList.add("notifications-center-header-title"),this.notificationsCenterHeader.appendChild(this.notificationsCenterTitle);let e=document.createElement("div");e.classList.add("notifications-center-header-toolbar"),this.notificationsCenterHeader.appendChild(e);let i=this._register(this.instantiationService.createInstance(Ap)),n=this,o=this._register(new gn(e,{ariaLabel:h("notificationsToolbar","Notification Center Actions"),actionRunner:i,actionViewItemProvider:(a,l)=>{if(a.id===Rf.ID)return this._register(this.instantiationService.createInstance(Al,a,{getActions(){let d=[Ht({id:Lf.ID,label:n.notificationService.getFilter()===0?h("turnOnNotifications","Enable Do Not Disturb Mode"):h("turnOffNotifications","Disable Do Not Disturb Mode"),run:()=>n.notificationService.setFilter(n.notificationService.getFilter()===0?1:0)})],c=n.notificationService.getFilters().sort((u,p)=>u.label.localeCompare(p.label));for(let u of c.slice(0,zd.MAX_NOTIFICATION_SOURCES))d.length===1&&d.push(new pt),d.push(Ht({id:`${Lf.ID}.${u.id}`,label:u.label,checked:u.filter!==1,run:()=>n.notificationService.setFilter({...u,filter:u.filter===1?0:1})}));return c.length>zd.MAX_NOTIFICATION_SOURCES&&(d.push(new pt),d.push(n._register(n.instantiationService.createInstance(kf,kf.ID,h("moreSources","More\u2026"))))),d}},this.contextMenuService,{...l,actionRunner:i,classNames:a.class,keybindingProvider:d=>this.keybindingService.lookupKeybinding(d.id)}))}}));this.clearAllAction=this._register(this.instantiationService.createInstance(wm,wm.ID,wm.LABEL)),o.push(this.clearAllAction,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(this.clearAllAction)}),this.configureDoNotDisturbAction=this._register(this.instantiationService.createInstance(Rf,Rf.ID,Rf.LABEL)),o.push(this.configureDoNotDisturbAction,{icon:!0,label:!1});let s=this._register(this.instantiationService.createInstance(Em,Em.ID,Em.LABEL));o.push(s,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(s)}),this.notificationsList=this.instantiationService.createInstance(Dm,this.notificationsCenterContainer,{widgetAriaLabel:h("notificationsCenterWidgetAriaLabel","Notifications Center")}),this.container.appendChild(this.notificationsCenterContainer)}getKeybindingLabel(e){let i=this.keybindingService.lookupKeybinding(e.id);return i?i.getLabel():null}onDidChangeNotification(e){if(!this._isVisible)return;let i=!1,[n,o]=Zs(this.notificationsList,this.notificationsCenterContainer);switch(e.kind){case 0:n.updateNotificationsList(e.index,0,[e.item]),e.item.updateVisibility(!0);break;case 1:switch(e.detail){case 2:n.updateNotificationsList(e.index,1,[e.item]);break;case 1:e.item.expanded&&n.updateNotificationHeight(e.item);break}break;case 2:n.updateNotificationsList(e.index,1,[e.item]);break;case 3:i=Oa(o),n.updateNotificationsList(e.index,1),e.item.updateVisibility(!1);break}this.updateTitle(),this.model.notifications.length===0&&(this.hide(),i&&this.editorGroupService.activeGroup.focus())}hide(){if(!this._isVisible||!this.notificationsCenterContainer||!this.notificationsList)return;let e=Oa(this.notificationsCenterContainer);this._isVisible=!1,this.notificationsCenterContainer.classList.remove("visible"),this.notificationsList.hide(),this.model.notifications.forEach(i=>i.updateVisibility(!1)),this.notificationsCenterVisibleContextKey.set(!1),this._onDidChangeVisibility.fire(),e&&this.editorGroupService.activeGroup.focus()}updateStyles(){if(this.notificationsCenterContainer&&this.notificationsCenterHeader){let e=this.getColor(pl);this.notificationsCenterContainer.style.boxShadow=e?`0 0 8px 2px ${e}`:"";let i=this.getColor(pj);this.notificationsCenterContainer.style.border=i?`1px solid ${i}`:"";let n=this.getColor(mj);this.notificationsCenterHeader.style.color=n??"";let o=this.getColor(WV);this.notificationsCenterHeader.style.background=o??""}}layout(e){if(this.workbenchDimensions=e,this._isVisible&&this.notificationsCenterContainer){let i=zd.MAX_DIMENSIONS.width,n=zd.MAX_DIMENSIONS.height,o=i,s=n;this.workbenchDimensions&&(o=this.workbenchDimensions.width,o-=2*8,s=this.workbenchDimensions.height-35,this.layoutService.isVisible("workbench.parts.statusbar",ne)&&(s-=22),this.layoutService.isVisible("workbench.parts.titlebar",ne)&&(s-=22),s-=2*12),Ue(this.notificationsList).layout(Math.min(i,o),Math.min(n,s))}}clearAll(){this.hide();for(let e of[...this.model.notifications])e.hasProgress||e.close(),this.accessibilitySignalService.playSignal(mo.clear)}};zd=_([v(2,Ze),v(3,ae),v(4,Qe),v(5,ke),v(6,di),v(7,at),v(8,jt),v(9,Rl),v(10,Mt)],zd);var cM=class extends L{constructor(e){super();this.model=e;for(let i of e.notifications)this.triggerAriaAlert(i);this.registerListeners()}registerListeners(){this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e)))}onDidChangeNotification(e){e.kind===0&&(this.triggerAriaAlert(e.item),e.item.severity===ui.Error&&(e.item.message.original instanceof Error?console.error(e.item.message.original):console.error(lo(e.item.message.linkedText.toString(),!0))))}triggerAriaAlert(e){if(e.priority===1)return;let i=e.onDidChangeContent(n=>{n.kind===1&&this.doTriggerAriaAlert(e)});O.once(e.onDidClose)(()=>i.dispose()),this.doTriggerAriaAlert(e)}doTriggerAriaAlert(e){let i;e.severity===ui.Error?i=h("alertErrorMessage","Error: {0}",e.message.linkedText.toString()):e.severity===ui.Warning?i=h("alertWarningMessage","Warning: {0}",e.message.linkedText.toString()):i=h("alertInfoMessage","Info: {0}",e.message.linkedText.toString()),Xc(i)}};var R1t=h("views log","Views"),GQ=Tt("default-view-icon",B.window,h("defaultViewIcon","Default view icon.")),AT;(e=>(e.ViewContainersRegistry="workbench.registry.view.containers",e.ViewsRegistry="workbench.registry.view"))(AT||={});function go(r){switch(r){case 0:return"sidebar";case 1:return"panel";case 2:return"auxiliarybar"}}var p5=class extends L{_onDidRegister=this._register(new T);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new T);onDidDeregister=this._onDidDeregister.event;viewContainers=new Map;defaultViewContainers=[];get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(t,e,i){let n=this.get(t.id);if(n)return n;let o=t;return o.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:o.openCommandActionDescriptor??{id:o.id},ql(this.viewContainers,e,[]).push(o),i?.isDefault&&this.defaultViewContainers.push(o),this._onDidRegister.fire({viewContainer:o,viewContainerLocation:e}),o}deregisterViewContainer(t){for(let e of this.viewContainers.keys()){let i=this.viewContainers.get(e),n=i?.indexOf(t);if(n!==-1){i?.splice(n,1),i.length===0&&this.viewContainers.delete(e),this._onDidDeregister.fire({viewContainer:t,viewContainerLocation:e});return}}}get(t){return this.all.filter(e=>e.id===t)[0]}getViewContainers(t){return[...this.viewContainers.get(t)||[]]}getViewContainerLocation(t){return[...this.viewContainers.keys()].filter(e=>this.getViewContainers(e).filter(i=>i?.id===t.id).length>0)[0]}getDefaultViewContainer(t){return this.defaultViewContainers.find(e=>this.getViewContainerLocation(e)===t)}};Ne.add(AT.ViewContainersRegistry,new p5);function Jde(r,t){let e=r.group??"9_more",i=t.group??"9_more";return e!==i?e.localeCompare(i):(r.order??5)-(t.order??5)}var h5=class extends L{_onViewsRegistered=this._register(new T);onViewsRegistered=this._onViewsRegistered.event;_onViewsDeregistered=this._register(new T);onViewsDeregistered=this._onViewsDeregistered.event;_onDidChangeContainer=this._register(new T);onDidChangeContainer=this._onDidChangeContainer.event;_onDidChangeViewWelcomeContent=this._register(new T);onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;_viewContainers=[];_views=new Map;_viewWelcomeContents=new Vu;registerViews(t,e){this.registerViews2([{views:t,viewContainer:e}])}registerViews2(t){t.forEach(({views:e,viewContainer:i})=>this.addViews(e,i)),this._onViewsRegistered.fire(t)}deregisterViews(t,e){let i=this.removeViews(t,e);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:e})}moveViews(t,e){for(let i of this._views.keys())if(i!==e){let n=this.removeViews(t,i);n.length&&(this.addViews(n,e),this._onDidChangeContainer.fire({views:n,from:i,to:e}))}}getViews(t){return this._views.get(t)||[]}getView(t){for(let e of this._viewContainers){let i=(this._views.get(e)||[]).filter(n=>n.id===t)[0];if(i)return i}return null}getViewContainer(t){for(let e of this._viewContainers)if((this._views.get(e)||[]).filter(n=>n.id===t)[0])return e;return null}registerViewWelcomeContent(t,e){return this._viewWelcomeContents.add(t,e),this._onDidChangeViewWelcomeContent.fire(t),te(()=>{this._viewWelcomeContents.delete(t,e),this._onDidChangeViewWelcomeContent.fire(t)})}registerViewWelcomeContent2(t,e){let i=new Map;for(let[n,o]of e)this._viewWelcomeContents.add(t,o),i.set(n,te(()=>{this._viewWelcomeContents.delete(t,o),this._onDidChangeViewWelcomeContent.fire(t)}));return this._onDidChangeViewWelcomeContent.fire(t),i}getViewWelcomeContent(t){let e=[];return this._viewWelcomeContents.forEach(t,i=>e.push(i)),e.sort(Jde)}addViews(t,e){let i=this._views.get(e);i||(i=[],this._views.set(e,i),this._viewContainers.push(e));for(let n of t){if(this.getView(n.id)!==null)throw new Error(h("duplicateId","A view with id '{0}' is already registered",n.id));i.push(n)}}removeViews(t,e){let i=this._views.get(e);if(!i)return[];let n=[],o=[];for(let s of i)t.includes(s)?n.push(s):o.push(s);return n.length&&(o.length?this._views.set(e,o):(this._views.delete(e),this._viewContainers.splice(this._viewContainers.indexOf(e),1))),n}};Ne.add(AT.ViewsRegistry,new h5);var zi=$("viewDescriptorService");var va=$("viewsService");var fI=class extends _p{constructor(e,i,n,o){super(e,n,o);this.telemetryService=i}_onTitleAreaUpdate=this._register(new T);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidFocus;get onDidFocus(){return this._onDidFocus||(this._onDidFocus=this.registerFocusTrackEvents().onDidFocus),this._onDidFocus.event}_onDidBlur;get onDidBlur(){return this._onDidBlur||(this._onDidBlur=this.registerFocusTrackEvents().onDidBlur),this._onDidBlur.event}_hasFocus=!1;hasFocus(){return this._hasFocus}registerFocusTrackEvents(){let e=Ue(this.getContainer()),i=this._register(Un(e)),n=this._onDidFocus=this._register(new T);this._register(i.onDidFocus(()=>{this._hasFocus=!0,n.fire()}));let o=this._onDidBlur=this._register(new T);return this._register(i.onDidBlur(()=>{this._hasFocus=!1,o.fire()})),{onDidFocus:n,onDidBlur:o}}actionRunner;visible=!1;parent;getTitle(){}create(e){this.parent=e}getContainer(){return this.parent}setVisible(e){this.visible!==!!e&&(this.visible=e)}focus(){}getMenuIds(){return[]}getActions(){return[]}getSecondaryActions(){return[]}getContextMenuActions(){return[]}getActionViewItem(e,i){}getActionsContext(){return null}getActionRunner(){return this.actionRunner||(this.actionRunner=this._register(new wn)),this.actionRunner}updateTitleArea(){this._onTitleAreaUpdate.fire()}isVisible(){return this.visible}getControl(){}};var uM=class extends L{_onDidRegister=this._register(new T);onDidRegister=this._onDidRegister.event;_onDidDeregister=this._register(new T);onDidDeregister=this._onDidDeregister.event;composites=[];registerComposite(t){this.compositeById(t.id)||(this.composites.push(t),this._onDidRegister.fire(t))}deregisterComposite(t){let e=this.compositeById(t);e&&(this.composites.splice(this.composites.indexOf(e),1),this._onDidDeregister.fire(e))}getComposite(t){return this.compositeById(t)}getComposites(){return this.composites.slice(0)}compositeById(t){return this.composites.find(e=>e.id===t)}};var pM=class r extends L{static HEADER_SIZE=22;element;header;body;_expanded;_orientation;expandedSize=void 0;_headerVisible=!0;_collapsible=!0;_bodyRendered=!1;_minimumBodySize;_maximumBodySize;_ariaHeaderLabel;styles={dropBackground:void 0,headerBackground:void 0,headerBorder:void 0,headerForeground:void 0,leftBorder:void 0};animationTimer=void 0;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_onDidChangeExpansionState=this._register(new T);onDidChangeExpansionState=this._onDidChangeExpansionState.event;get ariaHeaderLabel(){return this._ariaHeaderLabel}set ariaHeaderLabel(t){this._ariaHeaderLabel=t,this.header.setAttribute("aria-label",this.ariaHeaderLabel)}get draggableElement(){return this.header}get dropTargetElement(){return this.element}get dropBackground(){return this.styles.dropBackground}get minimumBodySize(){return this._minimumBodySize}set minimumBodySize(t){this._minimumBodySize=t,this._onDidChange.fire(void 0)}get maximumBodySize(){return this._maximumBodySize}set maximumBodySize(t){this._maximumBodySize=t,this._onDidChange.fire(void 0)}get headerSize(){return this.headerVisible?r.HEADER_SIZE:0}get minimumSize(){let t=this.headerSize,i=!this.headerVisible||this.isExpanded()?this.minimumBodySize:0;return t+i}get maximumSize(){let t=this.headerSize,i=!this.headerVisible||this.isExpanded()?this.maximumBodySize:0;return t+i}orthogonalSize=0;constructor(t){super(),this._expanded=typeof t.expanded>"u"?!0:!!t.expanded,this._orientation=typeof t.orientation>"u"?0:t.orientation,this._ariaHeaderLabel=h("viewSection","{0} Section",t.title),this._minimumBodySize=typeof t.minimumBodySize=="number"?t.minimumBodySize:this._orientation===1?200:120,this._maximumBodySize=typeof t.maximumBodySize=="number"?t.maximumBodySize:Number.POSITIVE_INFINITY,this.element=re(".pane")}isExpanded(){return this._expanded}setExpanded(t){return!t&&!this.collapsible||this._expanded===!!t?!1:(this.element?.classList.toggle("expanded",t),this._expanded=!!t,this.updateHeader(),t?(this._bodyRendered||(this.renderBody(this.body),this._bodyRendered=!0),typeof this.animationTimer=="number"&&oe(this.element).clearTimeout(this.animationTimer),Ee(this.element,this.body)):this.animationTimer=oe(this.element).setTimeout(()=>{this.body.remove()},200),this._onDidChangeExpansionState.fire(t),this._onDidChange.fire(t?this.expandedSize:void 0),!0)}get headerVisible(){return this._headerVisible}set headerVisible(t){this._headerVisible!==!!t&&(this._headerVisible=!!t,this.updateHeader(),this._onDidChange.fire(void 0))}get collapsible(){return this._collapsible}set collapsible(t){this._collapsible!==!!t&&(this._collapsible=!!t,this.updateHeader())}get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this.element&&(this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0)),this.header&&this.updateHeader())}render(){this.element.classList.toggle("expanded",this.isExpanded()),this.element.classList.toggle("horizontal",this.orientation===1),this.element.classList.toggle("vertical",this.orientation===0),this.header=re(".pane-header"),Ee(this.element,this.header),this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button"),this.header.setAttribute("aria-label",this.ariaHeaderLabel),this.renderHeader(this.header);let t=Un(this.header);this._register(t),this._register(t.onDidFocus(()=>this.header.classList.add("focused"),null)),this._register(t.onDidBlur(()=>this.header.classList.remove("focused"),null)),this.updateHeader();let e=this._register(new W),i=this._register(new Ge(this.header,"keydown")),n=O.map(i.event,o=>new st(o),e);this._register(O.filter(n,o=>o.keyCode===3||o.keyCode===10,e)(()=>this.setExpanded(!this.isExpanded()),null)),this._register(O.filter(n,o=>o.keyCode===15,e)(()=>this.setExpanded(!1),null)),this._register(O.filter(n,o=>o.keyCode===17,e)(()=>this.setExpanded(!0),null)),this._register(Wt.addTarget(this.header)),[G.CLICK,it.Tap].forEach(o=>{this._register(M(this.header,o,s=>{s.defaultPrevented||this.setExpanded(!this.isExpanded())}))}),this.body=Ee(this.element,re(".pane-body")),!this._bodyRendered&&this.isExpanded()&&(this.renderBody(this.body),this._bodyRendered=!0),this.isExpanded()||this.body.remove()}layout(t){let e=this.headerVisible?r.HEADER_SIZE:0,i=this._orientation===0?this.orthogonalSize:t,n=this._orientation===0?t-e:this.orthogonalSize-e;this.isExpanded()&&(this.body.classList.toggle("wide",i>=600),this.layoutBody(n,i),this.expandedSize=t)}style(t){this.styles=t,this.header&&this.updateHeader()}updateHeader(){let t=!this.headerVisible||this.isExpanded();this.collapsible?(this.header.setAttribute("tabindex","0"),this.header.setAttribute("role","button")):(this.header.removeAttribute("tabindex"),this.header.removeAttribute("role")),this.header.style.lineHeight=`${this.headerSize}px`,this.header.classList.toggle("hidden",!this.headerVisible),this.header.classList.toggle("expanded",t),this.header.classList.toggle("not-collapsible",!this.collapsible),this.header.setAttribute("aria-expanded",String(t)),this.header.style.color=this.collapsible?this.styles.headerForeground??"":"",this.header.style.backgroundColor=(this.collapsible?this.styles.headerBackground:"transparent")??"",this.header.style.borderTop=this.styles.headerBorder&&this.orientation===0?`1px solid ${this.styles.headerBorder}`:"",this.element.style.borderLeft=this.styles.leftBorder&&this.orientation===1?`1px solid ${this.styles.leftBorder}`:""}},m5=class r extends L{constructor(e,i,n){super();this.pane=e;this.dnd=i;this.context=n;e.draggableElement.draggable=!0,this._register(M(e.draggableElement,"dragstart",o=>this.onDragStart(o))),this._register(M(e.dropTargetElement,"dragenter",o=>this.onDragEnter(o))),this._register(M(e.dropTargetElement,"dragleave",o=>this.onDragLeave(o))),this._register(M(e.dropTargetElement,"dragend",o=>this.onDragEnd(o))),this._register(M(e.dropTargetElement,"drop",o=>this.onDrop(o)))}static DefaultDragOverBackgroundColor=new Y(new Pt(128,128,128,.5));dragOverCounter=0;_onDidDrop=this._register(new T);onDidDrop=this._onDidDrop.event;onDragStart(e){if(!this.dnd.canDrag(this.pane)||!e.dataTransfer){e.preventDefault(),e.stopPropagation();return}e.dataTransfer.effectAllowed="move",dn&&e.dataTransfer?.setData(cs.TEXT,this.pane.draggableElement.textContent||"");let i=Ee(this.pane.element.ownerDocument.body,re(".monaco-drag-image",{},this.pane.draggableElement.textContent||""));e.dataTransfer.setDragImage(i,-10,-10),setTimeout(()=>i.remove(),0),this.context.draggable=this}onDragEnter(e){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter++,this.render())}onDragLeave(e){!this.context.draggable||this.context.draggable===this||this.dnd.canDrop(this.context.draggable.pane,this.pane)&&(this.dragOverCounter--,this.dragOverCounter===0&&this.render())}onDragEnd(e){this.context.draggable&&(this.dragOverCounter=0,this.render(),this.context.draggable=null)}onDrop(e){this.context.draggable&&(Te.stop(e),this.dragOverCounter=0,this.render(),this.dnd.canDrop(this.context.draggable.pane,this.pane)&&this.context.draggable!==this&&this._onDidDrop.fire({from:this.context.draggable.pane,to:this.pane}),this.context.draggable=null)}render(){let e=null;this.dragOverCounter>0&&(e=this.pane.dropBackground??r.DefaultDragOverBackgroundColor.toString()),this.pane.dropTargetElement.style.backgroundColor=e||""}};var hM=class extends L{dnd;dndContext={draggable:null};element;paneItems=[];orthogonalSize=0;size=0;splitview;animationTimer=void 0;_onDidDrop=this._register(new T);onDidDrop=this._onDidDrop.event;orientation;boundarySashes;onDidSashChange;onDidSashReset;onDidScroll;constructor(t,e={}){super(),this.dnd=e.dnd,this.orientation=e.orientation??0,this.element=Ee(t,re(".monaco-pane-view")),this.splitview=this._register(new El(this.element,{orientation:this.orientation})),this.onDidSashReset=this.splitview.onDidSashReset,this.onDidSashChange=this.splitview.onDidSashChange,this.onDidScroll=this.splitview.onDidScroll;let i=this._register(new W),n=this._register(new Ge(this.element,"keydown")),o=O.map(O.filter(n.event,s=>Oi(s.target)&&s.target.classList.contains("pane-header"),i),s=>new st(s),i);this._register(O.filter(o,s=>s.keyCode===16,i)(()=>this.focusPrevious())),this._register(O.filter(o,s=>s.keyCode===18,i)(()=>this.focusNext()))}addPane(t,e,i=this.splitview.length){let n=new W;t.onDidChangeExpansionState(this.setupAnimation,this,n);let o={pane:t,disposable:n};if(this.paneItems.splice(i,0,o),t.orientation=this.orientation,t.orthogonalSize=this.orthogonalSize,this.splitview.addView(t,e,i),this.dnd){let s=new m5(t,this.dnd,this.dndContext);n.add(s),n.add(s.onDidDrop(this._onDidDrop.fire,this._onDidDrop))}}removePane(t){let e=this.paneItems.findIndex(n=>n.pane===t);if(e===-1)return;this.splitview.removeView(e,t.isExpanded()?lr.Distribute:void 0),this.paneItems.splice(e,1)[0].disposable.dispose()}movePane(t,e){let i=this.paneItems.findIndex(s=>s.pane===t),n=this.paneItems.findIndex(s=>s.pane===e);if(i===-1||n===-1)return;let[o]=this.paneItems.splice(i,1);this.paneItems.splice(n,0,o),this.splitview.moveView(i,n)}resizePane(t,e){let i=this.paneItems.findIndex(n=>n.pane===t);i!==-1&&this.splitview.resizeView(i,e)}getPaneSize(t){let e=this.paneItems.findIndex(i=>i.pane===t);return e===-1?-1:this.splitview.getViewSize(e)}layout(t,e){this.orthogonalSize=this.orientation===0?e:t,this.size=this.orientation===1?e:t;for(let i of this.paneItems)i.pane.orthogonalSize=this.orthogonalSize;this.splitview.layout(this.size)}setBoundarySashes(t){this.boundarySashes=t,this.updateSplitviewOrthogonalSashes(t)}updateSplitviewOrthogonalSashes(t){this.orientation===0?(this.splitview.orthogonalStartSash=t?.left,this.splitview.orthogonalEndSash=t?.right):this.splitview.orthogonalEndSash=t?.bottom}flipOrientation(t,e){this.orientation=this.orientation===0?1:0;let i=this.paneItems.map(s=>this.getPaneSize(s.pane));this.splitview.dispose(),ci(this.element),this.splitview=this._register(new El(this.element,{orientation:this.orientation})),this.updateSplitviewOrthogonalSashes(this.boundarySashes);let n=this.orientation===0?e:t,o=this.orientation===1?e:t;this.paneItems.forEach((s,a)=>{s.pane.orthogonalSize=n,s.pane.orientation=this.orientation;let l=this.size===0?0:o*i[a]/this.size;this.splitview.addView(s.pane,l,a)}),this.size=o,this.orthogonalSize=n,this.splitview.layout(this.size)}setupAnimation(){typeof this.animationTimer=="number"&&oe(this.element).clearTimeout(this.animationTimer),this.element.classList.add("animated"),this.animationTimer=oe(this.element).setTimeout(()=>{this.animationTimer=void 0,this.element.classList.remove("animated")},200)}getPaneHeaderElements(){return[...this.element.querySelectorAll(".pane-header")]}focusPrevious(){let t=this.getPaneHeaderElements(),e=t.indexOf(this.element.ownerDocument.activeElement);e!==-1&&t[Math.max(e-1,0)].focus()}focusNext(){let t=this.getPaneHeaderElements(),e=t.indexOf(this.element.ownerDocument.activeElement);e!==-1&&t[Math.min(e+1,t.length-1)].focus()}dispose(){super.dispose(),this.paneItems.forEach(t=>t.disposable.dispose())}};function Mp(r,t,e,i){let n,o,s;if(Array.isArray(r))s=r,n=t,o=e;else{let d=t;s=r.getActions(d),n=e,o=i}let a=pd.getInstance(),l=a.keyStatus.altKey||(rt||_t)&&a.keyStatus.shiftKey;qQ(s,n,l,o?d=>d===o:d=>d==="navigation")}function qa(r,t,e,i,n,o){let s,a,l,d,c;if(Array.isArray(r))c=r,s=t,a=e,l=i,d=n;else{let p=t;c=r.getActions(p),s=e,a=i,l=n,d=o}qQ(c,s,!1,typeof a=="string"?p=>p===a:a,l,d)}function qQ(r,t,e,i=s=>s==="navigation",n=()=>!1,o=!1){let s,a;Array.isArray(t)?(s=t,a=t):(s=t.primary,a=t.secondary);let l=new Set;for(let[d,c]of r){let u;i(d)?(u=s,u.length>0&&o&&u.push(new pt)):(u=a,u.length>0&&u.push(new pt));for(let p of c){e&&(p=p instanceof po&&p.alt?p.alt:p);let m=u.push(p);p instanceof mn&&l.add({group:d,action:p,index:m-1})}}for(let{group:d,action:c,index:u}of l){let p=i(d)?s:a,m=c.actions;n(c,d,p.length)&&p.splice(u,1,...m)}}var Pf=class extends Nd{constructor(e,i,n,o,s,a,l,d){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:i?.draggable,keybinding:i?.keybinding,hoverDelegate:i?.hoverDelegate});this._options=i;this._keybindingService=n;this._notificationService=o;this._contextKeyService=s;this._themeService=a;this._contextMenuService=l;this._accessibilityService=d;this._altKey=pd.getInstance()}_wantsAltCommand=!1;_itemClassDispose=this._register(new mt);_altKey;get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(i){this._notificationService.error(i)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let i=!1,n=()=>{let o=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||i)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&i);o!==this._wantsAltCommand&&(this._wantsAltCommand=o,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(n)),this._register(M(e,"mouseleave",o=>{i=!1,n()})),this._register(M(e,"mouseenter",o=>{i=!0,n()})),n()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){let e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),i=e&&e.getLabel(),n=this._commandAction.tooltip||this._commandAction.label,o=i?h("titleAndKb","{0} ({1})",n,i):n;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){let s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),d=l?h("titleAndKb","{0} ({1})",s,l):s;o=h("titleAndKbAndAlt",`{0}
[{1}] {2}`,o,Sz.modifierLabels[Hs].altKey,d)}return o}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;let{element:i,label:n}=this;if(!i||!n)return;let o=this._commandAction.checked&&iL(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(o)if(ye.isThemeIcon(o)){let s=ye.asClassNameArray(o);n.classList.add(...s),this._itemClassDispose.value=te(()=>{n.classList.remove(...s)})}else n.style.backgroundImage=AV(this._themeService.getColorTheme().type)?vl(o.dark):vl(o.light),n.classList.add("icon"),this._itemClassDispose.value=Ln(te(()=>{n.style.backgroundImage="",n.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};Pf=_([v(2,at),v(3,jt),v(4,ke),v(5,Ze),v(6,Mt),v(7,zo)],Pf);var Mf=class extends Al{constructor(e,i,n,o,s){let a={...i,menuAsChild:i?.menuAsChild??!1,classNames:i?.classNames??(ye.isThemeIcon(e.item.icon)?ye.asClassName(e.item.icon):void 0),keybindingProvider:i?.keybindingProvider??(l=>n.lookupKeybinding(l.id))};super(e,{getActions:()=>e.actions},o,a);this._keybindingService=n;this._contextMenuService=o;this._themeService=s}render(e){super.render(e),Yb(this.element),e.classList.add("menu-entry");let i=this._action,{icon:n}=i.item;if(n&&!ye.isThemeIcon(n)){this.element.classList.add("icon");let o=()=>{this.element&&(this.element.style.backgroundImage=AV(this._themeService.getColorTheme().type)?vl(n.dark):vl(n.light))};o(),this._register(this._themeService.onDidColorThemeChange(()=>{o()}))}}};Mf=_([v(2,at),v(3,Mt),v(4,Ze)],Mf);var PT=class extends zn{constructor(e,i,n,o,s,a,l,d){super(null,e);this._keybindingService=n;this._notificationService=o;this._contextMenuService=s;this._menuService=a;this._instaService=l;this._storageService=d;this._options=i,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c,u=i?.persistLastActionId?d.get(this._storageKey,1):void 0;u&&(c=e.actions.find(m=>u===m.id)),c||(c=e.actions[0]),this._defaultAction=this._instaService.createInstance(Pf,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});let p={keybindingProvider:m=>this._keybindingService.lookupKeybinding(m.id),...i,menuAsChild:i?.menuAsChild??!0,classNames:i?.classNames??["codicon","codicon-chevron-down"],actionRunner:i?.actionRunner??new wn};this._dropdown=new Al(e,e.actions,this._contextMenuService,p),this._register(this._dropdown.actionRunner.onDidRun(m=>{m.action instanceof po&&this.update(m.action)}))}_options;_defaultAction;_dropdown;_container=null;_storageKey;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}update(e){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(Pf,e,{keybinding:this._getDefaultActionKeybindingLabel(e)}),this._defaultAction.actionRunner=new class extends wn{async runAction(i,n){await i.run(void 0)}},this._container&&this._defaultAction.render(up(this._container,re(".action-container")))}_getDefaultActionKeybindingLabel(e){let i;if(this._options?.renderKeybindingWithDefaultActionLabel){let n=this._keybindingService.lookupKeybinding(e.id);n&&(i=`(${n.getLabel()})`)}return i}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");let i=re(".action-container");this._defaultAction.render(Ee(this._container,i)),this._register(M(i,G.KEY_DOWN,o=>{let s=new st(o);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));let n=re(".dropdown-action-container");this._dropdown.render(Ee(this._container,n)),this._register(M(n,G.KEY_DOWN,o=>{let s=new st(o);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};PT=_([v(2,at),v(3,jt),v(4,Mt),v(5,Ri),v(6,ae),v(7,tt)],PT);var MT=class extends zA{constructor(t,e){super(null,t,t.actions.map(i=>({text:i.id===pt.ID?"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500":i.label,isDisabled:!i.enabled})),0,e,VX,{ariaLabel:t.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,t.actions.findIndex(i=>i.checked)))}render(t){super.render(t),t.style.borderColor=Se(Mw)}runAction(t,e){let i=this.action.actions[e];i&&this.actionRunner.run(i)}};MT=_([v(1,um)],MT);function ja(r,t,e){return t instanceof po?r.createInstance(Pf,t,e):t instanceof jn?t.item.isSelection?r.createInstance(MT,t):t.item.rememberDefaultAction?r.createInstance(PT,t,{...e,persistLastActionId:!0}):r.createInstance(Mf,t,e):void 0}var g5=class extends L{constructor(e,i,n,o){super();this.options=i;this.menuService=n;this.contextKeyService=o;this.menu=this._register(n.createMenu(e,o)),this._register(this.menu.onDidChange(()=>this.updateActions())),this.updateActions()}menu;_primaryActions=[];get primaryActions(){return this._primaryActions}_secondaryActions=[];get secondaryActions(){return this._secondaryActions}_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;disposables=this._register(new W);updateActions(){this.disposables.clear(),this._primaryActions=[],this._secondaryActions=[],qa(this.menu,this.options,{primary:this._primaryActions,secondary:this._secondaryActions}),this.disposables.add(this.updateSubmenus([...this._primaryActions,...this._secondaryActions],{})),this._onDidChange.fire()}updateSubmenus(e,i){let n=new W;for(let o of e)if(o instanceof jn&&!i[o.item.submenu.id]){let s=i[o.item.submenu.id]=n.add(this.menuService.createMenu(o.item.submenu,this.contextKeyService));n.add(s.onDidChange(()=>this.updateActions())),n.add(this.updateSubmenus(o.actions,i))}return n}},Pl=class extends L{constructor(e,i,n,o,s){super();this.menuId=e;this.contextMenuId=i;this.options=n;this.contextKeyService=o;this.menuService=s;this.menuActions=this._register(new g5(e,this.options,s,o)),this._register(this.menuActions.onDidChange(()=>this._onDidChange.fire()))}menuActions;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;getPrimaryActions(){return this.menuActions.primaryActions}getSecondaryActions(){return this.menuActions.secondaryActions}getContextMenuActions(){let e=[];if(this.contextMenuId){let i=this.menuService.getMenuActions(this.contextMenuId,this.contextKeyService,this.options);qa(i,{primary:[],secondary:e})}return e}};Pl=_([v(3,ke),v(4,Ri)],Pl);var $a;(n=>{function r(o){return typeof o?.showDirectoryPicker=="function"}n.supported=r;function t(o){let s=o;return s?typeof s.kind=="string"&&typeof s.queryPermission=="function"&&typeof s.requestPermission=="function":!1}n.isFileSystemHandle=t;function e(o){return o.kind==="file"}n.isFileSystemFileHandle=e;function i(o){return o.kind==="directory"}n.isFileSystemDirectoryHandle=i})($a||={});var mM=class{constructor(t,e,i){this.indexedDB=t;this.store=e;this.logService=i}onDidChangeCapabilities=O.None;onDidChangeFile=O.None;extUri=_t?ii:sw;_capabilities;get capabilities(){return this._capabilities||(this._capabilities=18,_t&&(this._capabilities|=1024)),this._capabilities}async stat(t){try{let e=await this.getHandle(t);if(!e)throw this.createFileSystemProviderError(t,"No such file or directory, stat","EntryNotFound");if($a.isFileSystemFileHandle(e)){let i=await e.getFile();return{type:1,mtime:i.lastModified,ctime:0,size:i.size}}return{type:2,mtime:0,ctime:0,size:0}}catch(e){throw this.toFileSystemProviderError(e)}}async readdir(t){try{let e=await this.getDirectoryHandle(t);if(!e)throw this.createFileSystemProviderError(t,"No such file or directory, readdir","EntryNotFound");let i=[];for await(let[n,o]of e)i.push([n,$a.isFileSystemFileHandle(o)?1:2]);return i}catch(e){throw this.toFileSystemProviderError(e)}}readFileStream(t,e,i){let n=ed(o=>qe.concat(o.map(s=>qe.wrap(s))).buffer,{highWaterMark:10});return(async()=>{try{let o=await this.getFileHandle(t);if(!o)throw this.createFileSystemProviderError(t,"No such file or directory, readFile","EntryNotFound");let s=await o.getFile();if(typeof e.length=="number"||typeof e.position=="number"){let a=new Uint8Array(await s.arrayBuffer());typeof e?.position=="number"&&(a=a.slice(e.position)),typeof e?.length=="number"&&(a=a.slice(0,e.length)),n.end(a)}else{let a=s.stream().getReader(),l=await a.read();for(;!l.done&&!(i.isCancellationRequested||(await n.write(l.value),i.isCancellationRequested));)l=await a.read();n.end(void 0)}}catch(o){n.error(this.toFileSystemProviderError(o)),n.end()}})(),n}async readFile(t){try{let e=await this.getFileHandle(t);if(!e)throw this.createFileSystemProviderError(t,"No such file or directory, readFile","EntryNotFound");let i=await e.getFile();return new Uint8Array(await i.arrayBuffer())}catch(e){throw this.toFileSystemProviderError(e)}}async writeFile(t,e,i){try{let n=await this.getFileHandle(t);if(!i.create||!i.overwrite){if(n){if(!i.overwrite)throw this.createFileSystemProviderError(t,"File already exists, writeFile","EntryExists")}else if(!i.create)throw this.createFileSystemProviderError(t,"No such file, writeFile","EntryNotFound")}if(!n){let s=await this.getDirectoryHandle(this.extUri.dirname(t));if(!s)throw this.createFileSystemProviderError(t,"No such parent directory, writeFile","EntryNotFound");if(n=await s.getFileHandle(this.extUri.basename(t),{create:!0}),!n)throw this.createFileSystemProviderError(t,"Unable to create file , writeFile","Unknown")}let o=await n.createWritable();await o.write(e),await o.close()}catch(n){throw this.toFileSystemProviderError(n)}}async mkdir(t){try{let e=await this.getDirectoryHandle(this.extUri.dirname(t));if(!e)throw this.createFileSystemProviderError(t,"No such parent directory, mkdir","EntryNotFound");await e.getDirectoryHandle(this.extUri.basename(t),{create:!0})}catch(e){throw this.toFileSystemProviderError(e)}}async delete(t,e){try{let i=await this.getDirectoryHandle(this.extUri.dirname(t));if(!i)throw this.createFileSystemProviderError(t,"No such parent directory, delete","EntryNotFound");return i.removeEntry(this.extUri.basename(t),{recursive:e.recursive})}catch(i){throw this.toFileSystemProviderError(i)}}async rename(t,e,i){try{if(this.extUri.isEqual(t,e))return;let n=await this.getFileHandle(t);if(n){let o=await n.getFile(),s=new Uint8Array(await o.arrayBuffer());await this.writeFile(e,s,{create:!0,overwrite:i.overwrite,unlock:!1,atomic:!1}),await this.delete(t,{recursive:!1,useTrash:!1,atomic:!1})}else throw this.createFileSystemProviderError(t,h("fileSystemRenameError","Rename is only supported for files."),"Unavailable")}catch(n){throw this.toFileSystemProviderError(n)}}watch(t,e){return L.None}_files=new Map;_directories=new Map;registerFileHandle(t){return this.registerHandle(t,this._files)}registerDirectoryHandle(t){return this.registerHandle(t,this._directories)}get directories(){return this._directories.values()}async registerHandle(t,e){let i=`/${t.name}`;if(e.has(i)&&!await e.get(i)?.isSameEntry(t)){let n=Pu(t.name),o=ah(t.name,n),s=1;do i=`/${o}-${s++}${n}`;while(e.has(i)&&!await e.get(i)?.isSameEntry(t))}e.set(i,t);try{await this.indexedDB?.runInTransaction(this.store,"readwrite",n=>n.put(t,i))}catch(n){this.logService.error(n)}return q.from({scheme:he.file,path:i})}async getHandle(t){let e=await this.doGetHandle(t);if(!e){let i=await this.getDirectoryHandle(this.extUri.dirname(t));if(i){let n=ii.basename(t);try{e=await i.getFileHandle(n)}catch{try{e=await i.getDirectoryHandle(n)}catch{}}}}return e}async getFileHandle(t){let e=await this.doGetHandle(t);if(e instanceof FileSystemFileHandle)return e;let i=await this.getDirectoryHandle(this.extUri.dirname(t));try{return await i?.getFileHandle(ii.basename(t))}catch{return}}async getDirectoryHandle(t){let e=await this.doGetHandle(t);if(e instanceof FileSystemDirectoryHandle)return e;let i=this.extUri.dirname(t);if(this.extUri.isEqual(i,t))return;let n=await this.getDirectoryHandle(i);try{return await n?.getDirectoryHandle(ii.basename(t))}catch{return}}async doGetHandle(t){if(this.extUri.dirname(t).path!=="/")return;let e=t.path.replace(/\/$/,""),i=this._files.get(e)??this._directories.get(e);if(i)return i;let n=await this.indexedDB?.runInTransaction(this.store,"readonly",o=>o.get(e));if($a.isFileSystemHandle(n)){let o=await n.queryPermission()==="granted";try{o||(o=await n.requestPermission()==="granted")}catch(s){this.logService.error(s)}if(o)return $a.isFileSystemFileHandle(n)?this._files.set(e,n):$a.isFileSystemDirectoryHandle(n)&&this._directories.set(e,n),n}throw this.createFileSystemProviderError(t,"No file system handle registered","Unavailable")}toFileSystemProviderError(t){if(t instanceof cv)return t;let e="Unknown";return t.name==="NotAllowedError"&&(t=new Error(h("fileSystemNotAllowedError","Insufficient permissions. Please retry and allow the operation.")),e="Unavailable"),Lh(t,e)}createFileSystemProviderError(t,e,i){return Lh(new Error(`${e} (${sl(t.path)})`),i)}};var fM={EDITORS:"CodeEditors",FILES:"CodeFiles"};function ece(r){let t=[];if(r.dataTransfer&&r.dataTransfer.types.length>0){let n=r.dataTransfer.getData(fM.EDITORS);if(n)try{t.push(...Py(n))}catch{}else try{let a=r.dataTransfer.getData(cs.RESOURCES);t.push(...v5(a))}catch{}if(r.dataTransfer?.files)for(let a=0;a<r.dataTransfer.files.length;a++){let l=r.dataTransfer.files[a];if(l&&l.path)try{t.push({resource:q.file(l.path),isExternal:!0,allowWorkspaceOpen:!0})}catch{}}let o=r.dataTransfer.getData(fM.FILES);if(o)try{let a=JSON.parse(o);for(let l of a)t.push({resource:q.file(l),isExternal:!0,allowWorkspaceOpen:!0})}catch{}let s=Ne.as(bM.DragAndDropContribution).getAll();for(let a of s){let l=r.dataTransfer.getData(a.dataFormatKey);if(l)try{t.push(...a.getEditorInputs(l))}catch{}}}let e=[],i=new Ci;for(let n of t)n.resource?i.has(n.resource)||(e.push(n),i.set(n.resource,!0)):e.push(n);return e}async function jQ(r,t){let e=ece(t);if(t.dataTransfer&&wt&&oce(t,cs.FILES)&&t.dataTransfer.items){let o=await r.get(ae).invokeFunction(s=>tce(s,t));for(let s of o)e.push({resource:s.resource,contents:s.contents?.toString(),isExternal:!0,allowWorkspaceOpen:s.isDirectory})}return e}function v5(r){let t=[];if(r){let e=JSON.parse(r);for(let i of e)if(i.indexOf(":")>0){let{selection:n,uri:o}=aM(q.parse(i));t.push({resource:o,options:{selection:n}})}}return t}async function tce(r,t){if($a.supported(ne)){let i=t.dataTransfer?.items;if(i)return ice(r,i)}let e=t.dataTransfer?.files;return e?nce(r,e):[]}async function ice(r,t){let e=r.get(ai).getProvider(he.file);if(!(e instanceof mM))return[];let i=[];for(let n=0;n<t.length;n++){let o=t[n];if(o){let s=new xr;i.push(s),(async()=>{try{let a=await o.getAsFileSystemHandle();if(!a){s.complete(void 0);return}$a.isFileSystemFileHandle(a)?s.complete({resource:await e.registerFileHandle(a),isDirectory:!1}):$a.isFileSystemDirectoryHandle(a)?s.complete({resource:await e.registerDirectoryHandle(a),isDirectory:!0}):s.complete(void 0)}catch{s.complete(void 0)}})()}}return Ei(await Promise.all(i.map(n=>n.p)))}async function nce(r,t){let e=r.get(Ar),i=[];for(let n=0;n<t.length;n++){let o=t.item(n);if(o){if(o.size>100*uv.MB){e.warn(h("fileTooLarge","File is too large to open as untitled editor. Please upload it first into the file explorer and then try again."));continue}let s=new xr;i.push(s);let a=new FileReader;a.onerror=()=>s.complete(void 0),a.onabort=()=>s.complete(void 0),a.onload=async l=>{let d=o.name,c=l.target?.result??void 0;if(typeof d!="string"||typeof c>"u"){s.complete(void 0);return}s.complete({resource:q.from({scheme:he.untitled,path:d}),contents:typeof c=="string"?qe.fromString(c):qe.wrap(new Uint8Array(c))})},a.readAsArrayBuffer(o)}}return Ei(await Promise.all(i.map(n=>n.p)))}function oce(r,...t){if(!r.dataTransfer)return!1;let e=r.dataTransfer.types,i=[];for(let n=0;n<e.length;n++)i.push(e[n].toLowerCase());for(let n of t)if(i.indexOf(n.toLowerCase())>=0)return!0;return!1}var b5=class{_contributions=new Map;register(t){if(this._contributions.has(t.dataFormatKey))throw new Error(`A drag and drop contributiont with key '${t.dataFormatKey}' was already registered.`);this._contributions.set(t.dataFormatKey,t)}getAll(){return this._contributions.values()}},bM={DragAndDropContribution:"workbench.contributions.dragAndDrop"};Ne.add(bM.DragAndDropContribution,new b5);var Lm=class r{static INSTANCE=new r;data;proto;constructor(){}static getInstance(){return r.INSTANCE}hasData(t){return t&&t===this.proto}clearData(t){this.hasData(t)&&(this.proto=void 0,this.data=void 0)}getData(t){if(this.hasData(t))return this.data}setData(t,e){e&&(this.data=t,this.proto=e)}};function $Q(r,t,e){let i,n,o,s,a;if(t){for(s=t.offset,a=s+t.length,o=s;o>0&&!OT(r,o-1);)o--;let E=a;for(;E<r.length&&!OT(r,E);)E++;n=r.substring(o,E),i=rce(n,e)}else n=r,i=0,o=0,s=0,a=r.length;let l=sce(e,r),d=!1,c=0,u;e.insertSpaces?u=y5(" ",e.tabSize||4):u="	";let p=VH(n,!1),m=!1;function g(){return l+y5(u,i+c)}function f(){let E=p.scan();for(d=!1;E===15||E===14;)d=d||E===14,E=p.scan();return m=E===16||p.getTokenError()!==0,E}let b=[];function y(E,S,w){!m&&S<a&&w>s&&r.substring(S,w)!==E&&b.push({offset:S,length:w-S,content:E})}let I=f();if(I!==17){let E=p.getTokenOffset()+o,S=y5(u,i);y(S,o,E)}for(;I!==17;){let E=p.getTokenOffset()+p.getTokenLength()+o,S=f(),w="";for(;!d&&(S===12||S===13);){let k=p.getTokenOffset()+o;y(" ",E,k),E=p.getTokenOffset()+p.getTokenLength()+o,w=S===12?g():"",S=f()}if(S===2)I!==1&&(c--,w=g());else if(S===4)I!==3&&(c--,w=g());else{switch(I){case 3:case 1:c++,w=g();break;case 5:case 12:w=g();break;case 13:d?w=g():w=" ";break;case 6:w=" ";break;case 10:if(S===6){w="";break}case 7:case 8:case 9:case 11:case 2:case 4:S===12||S===13?w=" ":S!==5&&S!==17&&(m=!0);break;case 16:m=!0;break}d&&(S===12||S===13)&&(w=g())}let D=p.getTokenOffset()+o;y(w,E,D),I=S}return b}function y5(r,t){let e="";for(let i=0;i<t;i++)e+=r;return e}function rce(r,t){let e=0,i=0,n=t.tabSize||4;for(;e<r.length;){let o=r.charAt(e);if(o===" ")i++;else if(o==="	")i+=n;else break;e++}return Math.floor(i/n)}function sce(r,t){for(let e=0;e<t.length;e++){let i=t.charAt(e);if(i==="\r")return e+1<t.length&&t.charAt(e+1)===`
`?`\r
`:"\r";if(i===`
`)return`
`}return r&&r.eol||`
`}function OT(r,t){return`\r
`.indexOf(r.charAt(t))!==-1}function I5(r,t,e,i,n){let o=t.slice(),a=IZ(r,[]),l,d;for(;o.length>0&&(d=o.pop(),l=UH(a,o),l===void 0&&e!==void 0);)typeof d=="string"?e={[d]:e}:e=[e];if(l)if(l.type==="object"&&typeof d=="string"&&Array.isArray(l.children)){let c=UH(l,[d]);if(c!==void 0)if(e===void 0){if(!c.parent)throw new Error("Malformed AST");let u=l.children.indexOf(c.parent),p,m=c.parent.offset+c.parent.length;if(u>0){let g=l.children[u-1];p=g.offset+g.length}else p=l.offset+1,l.children.length>1&&(m=l.children[1].offset);return bI(r,{offset:p,length:m-p,content:""},i)}else return bI(r,{offset:c.offset,length:c.length,content:JSON.stringify(e)},i);else{if(e===void 0)return[];let u=`${JSON.stringify(d)}: ${JSON.stringify(e)}`,p=n?n(l.children.map(g=>g.children[0].value)):l.children.length,m;if(p>0){let g=l.children[p-1];m={offset:g.offset+g.length,length:0,content:","+u}}else l.children.length===0?m={offset:l.offset+1,length:0,content:u}:m={offset:l.offset+1,length:0,content:u+","};return bI(r,m,i)}}else if(l.type==="array"&&typeof d=="number"&&Array.isArray(l.children))if(e!==void 0){let c=`${JSON.stringify(e)}`,u;if(l.children.length===0||d===0)u={offset:l.offset+1,length:0,content:l.children.length===0?c:c+","};else{let p=d===-1||d>l.children.length?l.children.length:d,m=l.children[p-1];u={offset:m.offset+m.length,length:0,content:","+c}}return bI(r,u,i)}else{let c=d,u=l.children[c],p;if(l.children.length===1)p={offset:l.offset+1,length:l.length-2,content:""};else if(l.children.length-1===c){let m=l.children[c-1],g=m.offset+m.length,f=l.offset+l.length;p={offset:g,length:f-2-g,content:""}}else p={offset:u.offset,length:l.children[c+1].offset-u.offset,content:""};return bI(r,p,i)}else throw new Error(`Can not add ${typeof d!="number"?"index":"property"} to parent of type ${l.type}`);else return e===void 0?[]:bI(r,{offset:a?a.offset:0,length:a?a.length:0,content:JSON.stringify(e)},i)}function bI(r,t,e){let i=YQ(r,t),n=t.offset,o=t.offset+t.content.length;if(t.length===0||t.content.length===0){for(;n>0&&!OT(i,n-1);)n--;for(;o<i.length&&!OT(i,o);)o++}let s=$Q(i,{offset:n,length:o-n},e);for(let l=s.length-1;l>=0;l--){let d=s[l];i=YQ(i,d),n=Math.min(n,d.offset),o=Math.max(o,d.offset+d.length),o+=d.content.length-d.length}let a=r.length-(i.length-o)-n;return[{offset:n,length:a,content:i.substring(n,o)}]}function YQ(r,t){return r.substring(0,t.offset)+t.content+r.substring(t.offset+t.length)}function C5(r){return r&&r.hasOwnProperty("folderUri")}function ZQ(r){return r&&r.hasOwnProperty("workspace")}var Of=$("workspacesService");function NT(r){return r.hasOwnProperty("workspace")}function vI(r){return r.hasOwnProperty("folderUri")}function QQ(r){return JQ(r)||eJ(r)}function JQ(r){let t=r;return typeof t?.path=="string"&&(!t.name||typeof t.name=="string")}function eJ(r){let t=r;return typeof t?.uri=="string"&&(!t.name||typeof t.name=="string")}function tJ(r,t,e,i,n){if(r.scheme!==i.scheme)return{name:e,uri:r.toString(!0)};let o=t?void 0:n.relativePath(i,r);if(o!==void 0)o.length===0?o=".":rt&&(o=XQ(o));else if(r.scheme===he.file)o=r.fsPath,rt&&(o=XQ(o));else if(n.isEqualAuthority(r.authority,i.authority))o=r.path;else return{name:e,uri:r.toString(!0)};return{name:e,path:o}}function XQ(r){return r=HR(r),oG(r)||(r=Jb(r)),r}function vM(r,t,e){let i=[],n=new Set,o=e.dirname(t);for(let s of r){let a;if(JQ(s))s.path&&(a=e.resolvePath(o,s.path));else if(eJ(s))try{a=q.parse(s.uri),a.path[0]!==Ft.sep&&(a=a.with({path:Ft.sep+a.path}))}catch(l){console.warn(l)}if(a){let l=e.getComparisonKey(a);if(!n.has(l)){n.add(l);let d=s.name||e.basenameOrAuthority(a);i.push(new lw({uri:a,name:d,index:i.length},s))}}}return i}var en=$("hostService");var yM=$("workspaceEditingService");var IM=class extends L{constructor(e){super();this.channelName=e;if("BroadcastChannel"in ne)try{this.broadcastChannel=new BroadcastChannel(e);let i=n=>{this._onDidReceiveData.fire(n.data)};this.broadcastChannel.addEventListener("message",i),this._register(te(()=>{this.broadcastChannel&&(this.broadcastChannel.removeEventListener("message",i),this.broadcastChannel.close())}))}catch(i){console.warn("Error while creating broadcast channel. Falling back to localStorage.",Nu(i))}this.broadcastChannel||(this.channelName=`BroadcastDataChannel.${e}`,this.createBroadcastChannel())}broadcastChannel;_onDidReceiveData=this._register(new T);onDidReceiveData=this._onDidReceiveData.event;createBroadcastChannel(){let e=i=>{i.key===this.channelName&&i.newValue&&this._onDidReceiveData.fire(JSON.parse(i.newValue))};ne.addEventListener("storage",e),this._register(te(()=>ne.removeEventListener("storage",e)))}postData(e){this.broadcastChannel?this.broadcastChannel.postMessage(e):(localStorage.removeItem(this.channelName),localStorage.setItem(this.channelName,JSON.stringify(e)))}};var Ya=class{constructor(t){this.identifier=t}},Za=class{constructor(t){this.identifier=t}};async function iJ(r){let t=[],e=Id.uriList.toLowerCase();if(r.has(e))try{let i=await r.get(e)?.asString(),n=JSON.stringify(iE.parse(i??""));t.push(...v5(n))}catch{}return t}var yI=class{constructor(t,e,i,n,o,s,a,l){this.options=t;this.fileService=e;this.workspacesService=i;this.editorService=n;this.workspaceEditingService=o;this.hostService=s;this.contextService=a;this.instantiationService=l}async handleDrop(t,e,i,n,o){let s=await this.instantiationService.invokeFunction(d=>jQ(d,t));if(!s.length)return;if(await this.hostService.focus(e),this.options.allowWorkspaceOpen){let d=Ei(s.filter(c=>c.allowWorkspaceOpen&&c.resource?.scheme===he.file).map(c=>c.resource));if(d.length>0&&await this.handleWorkspaceDrop(d))return}let a=Ei(s.filter(d=>d.isExternal&&d.resource?.scheme===he.file).map(d=>d.resource));a.length&&this.workspacesService.addRecentlyOpened(a.map(d=>({fileUri:d})));let l=i?.();await this.editorService.openEditors(s.map(d=>({...d,resource:d.resource,options:{...d.options,...o,pinned:!0}})),l,{validateTrust:!0}),n?.(l)}async handleWorkspaceDrop(t){let e=[],i=[];return await Promise.all(t.map(async n=>{if(CG(n)){e.push({workspaceUri:n});return}try{let o=await this.fileService.stat(n);o.isDirectory&&(e.push({folderUri:o.resource}),i.push({uri:o.resource}))}catch{}})),e.length===0?!1:(e.length>i.length||i.length===1?await this.hostService.openWindow(e):Yu(this.contextService.getWorkspace())?await this.workspaceEditingService.addFolders(i):await this.workspaceEditingService.createAndEnterWorkspace(i),!0)}};yI=_([v(1,ai),v(2,Of),v(3,kt),v(4,yM),v(5,en),v(6,Xt),v(7,ae)],yI);function E5(r,t,e,i){if(t.length===0||!e.dataTransfer)return;let n=r.get(qc),o=r.get(kt),s=r.get(ai),a=r.get(qo),l=Ei(t.map(m=>q.isUri(m)?{resource:m}:tA(m)?q.isUri(m.editor.resource)?{resource:m.editor.resource}:void 0:m)),d=l.filter(({resource:m})=>s.hasProvider(m));if(!i?.disableStandardTransfer){let m=rt?`\r
`:`
`;e.dataTransfer.setData(cs.TEXT,d.map(({resource:f})=>a.getUriLabel(f,{noPrefix:!0})).join(m));let g=d.find(({isDirectory:f})=>!f);if(g){let f=Da.uriToFileUri(g.resource);f.scheme===he.file&&e.dataTransfer.setData(cs.DOWNLOAD_URL,[Id.binary,Tr(g.resource),f.toString()].join(":"))}}let c=d.filter(({isDirectory:m})=>!m);c.length&&e.dataTransfer.setData(cs.RESOURCES,JSON.stringify(c.map(({resource:m})=>m.toString())));let u=Ne.as(bM.DragAndDropContribution).getAll();for(let m of u)m.setData(l,e);let p=[];for(let m of t){let g;if(tA(m)){let f=m.editor.toUntyped({preserveViewState:m.groupId});f&&(g={...f,resource:Ui.getCanonicalUri(f)})}else if(q.isUri(m)){let{selection:f,uri:b}=aM(m);g={resource:b,options:f?{selection:f}:void 0}}else m.isDirectory||(g={resource:m.resource});if(g){{let f=g.resource;if(f){let b=n.files.get(f);b&&(typeof g.languageId!="string"&&(g.languageId=b.getLanguageId()),typeof g.encoding!="string"&&(g.encoding=b.getEncoding()),typeof g.contents!="string"&&b.isDirty()&&!b.textEditorModel.isTooLargeForHeapOperation()&&(g.contents=b.textEditorModel.getValue())),g.options?.viewState||(g.options={...g.options,viewState:(()=>{for(let y of o.visibleEditorPanes)if(Wn(y.input.resource,f)){let I=y.getViewState();if(I)return I}})()})}}p.push(g)}}if(p.length){e.dataTransfer.setData(fM.EDITORS,oA(p));let m=[];for(let g of p)g.resource?m.push(g.resource):Wa(g)?g.modified.resource&&m.push(g.modified.resource):zc(g)?g.primary.resource&&m.push(g.primary.resource):Kc(g)&&m.push(g.result.resource);i?.disableStandardTransfer||e.dataTransfer.setData(Id.uriList,iE.create(m.slice(0,1))),e.dataTransfer.setData(cs.INTERNAL_URI_LIST,iE.create(m))}}var S5=class{constructor(t,e){this.type=t;this.id=e}update(t){}getData(){return{type:this.type,id:this.id}}},Nf=class{constructor(t){this.compositeId=t}get id(){return this.compositeId}},Ff=class{constructor(t){this.viewId=t}get id(){return this.viewId}},Xa=class r extends L{static instance;static get INSTANCE(){return r.instance||(r.instance=new r,mc(r.instance)),r.instance}transferData=Lm.getInstance();onDragStart=this._register(new T);onDragEnd=this._register(new T);constructor(){super(),this._register(this.onDragEnd.event(t=>{let e=t.dragAndDropData.getData().id,i=t.dragAndDropData.getData().type;this.readDragData(i)?.getData().id===e&&this.transferData.clearData(i==="view"?Ff.prototype:Nf.prototype)}))}readDragData(t){if(this.transferData.hasData(t==="view"?Ff.prototype:Nf.prototype)){let e=this.transferData.getData(t==="view"?Ff.prototype:Nf.prototype);if(e&&e[0])return new S5(t,e[0].id)}}writeDragData(t,e){this.transferData.setData([e==="view"?new Ff(t):new Nf(t)],e==="view"?Ff.prototype:Nf.prototype)}registerTarget(t,e){let i=new W;return i.add(new ra(t,{onDragEnter:n=>{if(n.preventDefault(),e.onDragEnter){let o=this.readDragData("composite")||this.readDragData("view");o&&e.onDragEnter({eventData:n,dragAndDropData:o})}},onDragLeave:n=>{let o=this.readDragData("composite")||this.readDragData("view");e.onDragLeave&&o&&e.onDragLeave({eventData:n,dragAndDropData:o})},onDrop:n=>{if(e.onDrop){let o=this.readDragData("composite")||this.readDragData("view");if(!o)return;e.onDrop({eventData:n,dragAndDropData:o}),this.onDragEnd.fire({eventData:n,dragAndDropData:o})}},onDragOver:n=>{if(n.preventDefault(),e.onDragOver){let o=this.readDragData("composite")||this.readDragData("view");if(!o)return;e.onDragOver({eventData:n,dragAndDropData:o})}}})),e.onDragStart&&this.onDragStart.event(n=>{e.onDragStart(n)},this,i),e.onDragEnd&&this.onDragEnd.event(n=>{e.onDragEnd(n)},this,i),this._register(i)}registerDraggable(t,e,i){t.draggable=!0;let n=new W;return n.add(new ra(t,{onDragStart:o=>{let{id:s,type:a}=e();this.writeDragData(s,a),o.dataTransfer?.setDragImage(t,0,0),this.onDragStart.fire({eventData:o,dragAndDropData:this.readDragData(a)})},onDragEnd:o=>{let{type:s}=e(),a=this.readDragData(s);a&&this.onDragEnd.fire({eventData:o,dragAndDropData:a})},onDragEnter:o=>{if(i.onDragEnter){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;s&&i.onDragEnter({eventData:o,dragAndDropData:s})}},onDragLeave:o=>{let s=this.readDragData("composite")||this.readDragData("view");s&&i.onDragLeave?.({eventData:o,dragAndDropData:s})},onDrop:o=>{if(i.onDrop){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;i.onDrop({eventData:o,dragAndDropData:s}),this.onDragEnd.fire({eventData:o,dragAndDropData:s})}},onDragOver:o=>{if(i.onDragOver){let s=this.readDragData("composite")||this.readDragData("view");if(!s)return;i.onDragOver({eventData:o,dragAndDropData:s})}}})),i.onDragStart&&this.onDragStart.event(o=>{i.onDragStart(o)},this,n),i.onDragEnd&&this.onDragEnd.event(o=>{i.onDragEnd(o)},this,n),this._register(n)}};function Op(r,t,e){r&&(r.dropEffect=e?t:"none")}var CM=class{constructor(t,e){this.toResource=t;this.instantiationService=e}getDragURI(t){let e=this.toResource(t);return e?e.toString():null}getDragLabel(t){let e=Ei(t.map(this.toResource));return e.length===1?Tr(e[0]):e.length>1?String(e.length):void 0}onDragStart(t,e){let i=[];for(let n of t.elements){let o=this.toResource(n);o&&i.push(o)}i.length&&this.instantiationService.invokeFunction(n=>E5(n,i,e))}onDragOver(t,e,i,n,o){return!1}drop(t,e,i,n,o){}dispose(){}};CM=_([v(1,ae)],CM);var w5=class r extends L{static CHANNEL_NAME="monaco-workbench-global-dragged-over";broadcaster=this._register(new IM(r.CHANNEL_NAME));constructor(){super(),this.registerListeners()}registerListeners(){this._register(O.runAndSubscribe(Wg,({window:t,disposables:e})=>{e.add(M(t,G.DRAG_OVER,()=>this.markDraggedOver(!1),!0)),e.add(M(t,G.DRAG_LEAVE,()=>this.clearDraggedOver(!1),!0))},{window:ne,disposables:this._store})),this._register(this.broadcaster.onDidReceiveData(t=>{t===!0?this.markDraggedOver(!0):this.clearDraggedOver(!0)}))}draggedOver=!1;get isDraggedOver(){return this.draggedOver}markDraggedOver(t){this.draggedOver!==!0&&(this.draggedOver=!0,t||this.broadcaster.postData(!0))}clearDraggedOver(t){this.draggedOver!==!1&&(this.draggedOver=!1,t||this.broadcaster.postData(!1))}},lce=new w5;function SM(){return lce.isDraggedOver}var II=class extends L{constructor(e,i,n={},o,s){super();this._link=i;this._hoverService=o;this.el=Ee(e,re("a.monaco-link",{tabIndex:i.tabIndex??0,href:i.href},i.label)),this.hoverDelegate=n.hoverDelegate??zt("mouse"),this.setTooltip(i.title),this.el.setAttribute("role","button");let a=this._register(new Ge(this.el,"click")),l=this._register(new Ge(this.el,"keypress")),d=O.chain(l.event,p=>p.map(m=>new st(m)).filter(m=>m.keyCode===3)),c=this._register(new Ge(this.el,it.Tap)).event;this._register(Wt.addTarget(this.el));let u=O.any(a.event,d,c);this._register(u(p=>{this.enabled&&(Te.stop(p,!0),n?.opener?n.opener(this._link.href):s.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}el;hover;hoverDelegate;_enabled=!0;get enabled(){return this._enabled}set enabled(e){e?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=e}set link(e){typeof e.label=="string"?this.el.textContent=e.label:(ci(this.el),this.el.appendChild(e.label)),this.el.href=e.href,typeof e.tabIndex<"u"&&(this.el.tabIndex=e.tabIndex),this.setTooltip(e.title),this._link=e}setTooltip(e){this.hoverDelegate.showNativeHover?this.el.title=e??"":!this.hover&&e?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,e)):this.hover&&this.hover.update(e)}};II=_([v(3,qi),v(4,Os)],II);async function nJ(r){let t=navigator.usb;if(!t)return;let e=await t.requestDevice({filters:r?.filters??[]});if(e)return{deviceClass:e.deviceClass,deviceProtocol:e.deviceProtocol,deviceSubclass:e.deviceSubclass,deviceVersionMajor:e.deviceVersionMajor,deviceVersionMinor:e.deviceVersionMinor,deviceVersionSubminor:e.deviceVersionSubminor,manufacturerName:e.manufacturerName,productId:e.productId,productName:e.productName,serialNumber:e.serialNumber,usbVersionMajor:e.usbVersionMajor,usbVersionMinor:e.usbVersionMinor,usbVersionSubminor:e.usbVersionSubminor,vendorId:e.vendorId}}async function oJ(r){let t=navigator.serial;if(!t)return;let e=await t.requestPort({filters:r?.filters??[]});if(!e)return;let i=e.getInfo();return{usbVendorId:i.usbVendorId,usbProductId:i.usbProductId}}async function rJ(r){let t=navigator.hid;if(!t)return;let e=await t.requestDevice({filters:r?.filters??[]});if(!e.length)return;let i=e[0];return{opened:i.opened,vendorId:i.vendorId,productId:i.productId,productName:i.productName,collections:i.collections}}var on=tr;var dce=60,cce=dce*60,T5=cce*24,YUt=T5*7,ZUt=T5*30,XUt=T5*365;function sJ(r){return r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+(r.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var FT=/^([^.]+\..+)[:=](.+)$/,Bi=class{constructor(t,e,i){this._args=t;this.paths=e;this.productService=i}get appRoot(){return B_(Da.asFileUri("").fsPath)}get userHome(){return q.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return q.file(fs(this.userDataPath,"User"))}get tmpDir(){return q.file(this.paths.tmpDir)}get cacheHome(){return q.file(this.userDataPath)}get stateResource(){return Ot(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:he.vscodeUserData})}get userDataSyncHome(){return Ot(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let t=sJ(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=fs(this.userDataPath,"logs",t)}return q.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return Ot(q.file(fs(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return Ot(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return Ot(this.appSettingsHome,"History")}get keyboardLayoutResource(){return Ot(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let t=zs.VSCODE_PORTABLE;return t?q.file(fs(t,"argv.json")):Ot(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return q.file(fs(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let t=this.args["builtin-extensions-dir"];return t?Fb(t):sl(fs(Da.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let t=this.args["extensions-download-dir"];return t?q.file(Fb(t)):q.file(fs(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let t=this.args["extensions-dir"];if(t)return Fb(t);let e=zs.VSCODE_EXTENSIONS;if(e)return e;let i=zs.VSCODE_PORTABLE;return i?fs(i,"extensions"):Ot(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let t=this.args.extensionDevelopmentPath;if(Array.isArray(t))return t.map(e=>/^[^:/?#]+?:\/\//.test(e)?q.parse(e):q.file(sl(e)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(t=>t==="ui"||t==="workspace"||t==="web"?t:"workspace")}get extensionTestsLocationURI(){let t=this.args.extensionTestsPath;if(t)return/^[^:/?#]+?:\/\//.test(t)?q.parse(t):q.file(sl(t))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let t=this.args["disable-extension"];if(t){if(typeof t=="string")return[t];if(Array.isArray(t)&&t.length>0)return t}return!1}get debugExtensionHost(){return uce(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!zs.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(t=>!FT.test(t))}get extensionLogLevel(){let t=[];for(let e of this.args.log||[]){let i=FT.exec(e);i&&i[1]&&i[2]&&t.push([i[1],i[2]])}return t.length?t:void 0}get serviceMachineIdResource(){return Ot(q.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let t=zs.VSCODE_PORTABLE;return t?q.file(fs(t,"policy.json")):Ot(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(t){this.args.continueOn=t}get args(){return this._args}};_([ue],Bi.prototype,"appRoot",1),_([ue],Bi.prototype,"userHome",1),_([ue],Bi.prototype,"userDataPath",1),_([ue],Bi.prototype,"appSettingsHome",1),_([ue],Bi.prototype,"tmpDir",1),_([ue],Bi.prototype,"cacheHome",1),_([ue],Bi.prototype,"stateResource",1),_([ue],Bi.prototype,"userRoamingDataHome",1),_([ue],Bi.prototype,"userDataSyncHome",1),_([ue],Bi.prototype,"sync",1),_([ue],Bi.prototype,"machineSettingsResource",1),_([ue],Bi.prototype,"workspaceStorageHome",1),_([ue],Bi.prototype,"localHistoryHome",1),_([ue],Bi.prototype,"keyboardLayoutResource",1),_([ue],Bi.prototype,"argvResource",1),_([ue],Bi.prototype,"isExtensionDevelopment",1),_([ue],Bi.prototype,"untitledWorkspacesHome",1),_([ue],Bi.prototype,"builtinExtensionsPath",1),_([ue],Bi.prototype,"extensionsPath",1),_([ue],Bi.prototype,"extensionDevelopmentLocationURI",1),_([ue],Bi.prototype,"extensionDevelopmentKind",1),_([ue],Bi.prototype,"extensionTestsLocationURI",1),_([ue],Bi.prototype,"debugExtensionHost",1),_([ue],Bi.prototype,"logLevel",1),_([ue],Bi.prototype,"extensionLogLevel",1),_([ue],Bi.prototype,"serviceMachineIdResource",1),_([ue],Bi.prototype,"disableTelemetry",1),_([ue],Bi.prototype,"disableWorkspaceTrust",1),_([ue],Bi.prototype,"useInMemorySecretStorage",1),_([ue],Bi.prototype,"policyFile",1);function uce(r,t){return pce(r["inspect-extensions"],r["inspect-brk-extensions"],5870,t,r.debugId,r.extensionEnvironment)}function pce(r,t,e,i,n,o){let a=Number(t||r)||(i?null:e),l=a?!!t:!1,d;if(o)try{d=JSON.parse(o)}catch{}return{port:a,break:l,debugId:n,env:d}}var Ml=tr,pi=class{constructor(t,e,i,n){this.workspaceId=t;this.logsHome=e;this.options=i;this.productService=n;if(i.workspaceProvider&&Array.isArray(i.workspaceProvider.payload))try{this.payload=new Map(i.workspaceProvider.payload)}catch(o){Ke(o)}}get remoteAuthority(){return this.options.remoteAuthority}get expectsResolverExtension(){return!!this.options.remoteAuthority?.includes("+")&&!this.options.webSocketFactory}get isBuilt(){return!!this.productService.commit}get logLevel(){let t=this.payload?.get("logLevel");return t?t.split(",").find(e=>!FT.test(e)):this.options.developmentOptions?.logLevel!==void 0?dL(this.options.developmentOptions?.logLevel):void 0}get extensionLogLevel(){let t=this.payload?.get("logLevel");if(t){let e=[];for(let i of t.split(",")){let n=FT.exec(i);n&&n[1]&&n[2]&&e.push([n[1],n[2]])}return e.length?e:void 0}return this.options.developmentOptions?.extensionLogLevel!==void 0?this.options.developmentOptions?.extensionLogLevel.map(([e,i])=>[e,dL(i)]):void 0}get profDurationMarkers(){let t=this.payload?.get("profDurationMarkers");if(t){let e=[];for(let i of t.split(","))e.push(i);return e.length===2?e:void 0}}get windowLogsPath(){return this.logsHome}get logFile(){return Ot(this.windowLogsPath,"window.log")}get userRoamingDataHome(){return q.file("/User").with({scheme:he.vscodeUserData})}get argvResource(){return Ot(this.userRoamingDataHome,"argv.json")}get cacheHome(){return Ot(this.userRoamingDataHome,"caches")}get workspaceStorageHome(){return Ot(this.userRoamingDataHome,"workspaceStorage")}get localHistoryHome(){return Ot(this.userRoamingDataHome,"History")}get stateResource(){return Ot(this.userRoamingDataHome,"State","storage.json")}get userDataSyncHome(){return Ot(this.userRoamingDataHome,"sync",this.workspaceId)}get sync(){}get keyboardLayoutResource(){return Ot(this.userRoamingDataHome,"keyboardLayout.json")}get untitledWorkspacesHome(){return Ot(this.userRoamingDataHome,"Workspaces")}get serviceMachineIdResource(){return Ot(this.userRoamingDataHome,"machineid")}get extHostLogsPath(){return Ot(this.logsHome,"exthost")}get extHostTelemetryLogFile(){return Ot(this.extHostLogsPath,"extensionTelemetry.log")}extensionHostDebugEnvironment=void 0;get debugExtensionHost(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.params}get isExtensionDevelopment(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.isExtensionDevelopment}get extensionDevelopmentLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentLocationURI}get extensionDevelopmentLocationKind(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionDevelopmentKind}get extensionTestsLocationURI(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionTestsLocationURI}get extensionEnabledProposedApi(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.extensionEnabledProposedApi}get debugRenderer(){return this.extensionHostDebugEnvironment||(this.extensionHostDebugEnvironment=this.resolveExtensionHostDebugEnvironment()),this.extensionHostDebugEnvironment.debugRenderer}get enableSmokeTestDriver(){return this.options.developmentOptions?.enableSmokeTestDriver}get disableExtensions(){return this.payload?.get("disableExtensions")==="true"}get enableExtensions(){return this.options.enabledExtensions}get webviewExternalEndpoint(){let t=this.options.webviewEndpoint||this.productService.webviewContentExternalBaseUrlTemplate||"https://{{uuid}}.vscode-cdn.net/{{quality}}/{{commit}}/out/vs/workbench/contrib/webview/browser/pre/",e=this.payload?.get("webviewExternalEndpointCommit");return t.replace("{{commit}}",e??this.productService.commit??"ef65ac1ba57f57f2a3961bfe94aa20481caca4c6").replace("{{quality}}",(e?"insider":this.productService.quality)??"insider")}get extensionTelemetryLogResource(){return Ot(this.logsHome,"extensionTelemetry.log")}get disableTelemetry(){return!1}get verbose(){return this.payload?.get("verbose")==="true"}get logExtensionHostCommunication(){return this.payload?.get("logExtensionHostCommunication")==="true"}get skipReleaseNotes(){return this.payload?.get("skipReleaseNotes")==="true"}get skipWelcome(){return this.payload?.get("skipWelcome")==="true"}get disableWorkspaceTrust(){return!this.options.enableWorkspaceTrust}get profile(){return this.payload?.get("profile")}editSessionId=this.options.editSessionId;payload;resolveExtensionHostDebugEnvironment(){let t={params:{port:null,break:!1},debugRenderer:!1,isExtensionDevelopment:!1,extensionDevelopmentLocationURI:void 0,extensionDevelopmentKind:void 0};if(this.payload)for(let[i,n]of this.payload)switch(i){case"extensionDevelopmentPath":t.extensionDevelopmentLocationURI||(t.extensionDevelopmentLocationURI=[]),t.extensionDevelopmentLocationURI.push(q.parse(n)),t.isExtensionDevelopment=!0;break;case"extensionDevelopmentKind":t.extensionDevelopmentKind=[n];break;case"extensionTestsPath":t.extensionTestsLocationURI=q.parse(n);break;case"debugRenderer":t.debugRenderer=n==="true";break;case"debugId":t.params.debugId=n;break;case"inspect-brk-extensions":t.params.port=parseInt(n),t.params.break=!0;break;case"inspect-extensions":t.params.port=parseInt(n);break;case"enableProposedApi":t.extensionEnabledProposedApi=[];break}let e=this.options.developmentOptions;return e&&!t.isExtensionDevelopment&&(e.extensions?.length&&(t.extensionDevelopmentLocationURI=e.extensions.map(i=>q.revive(i)),t.isExtensionDevelopment=!0),e.extensionTestsPath&&(t.extensionTestsLocationURI=q.revive(e.extensionTestsPath))),t}get filesToOpenOrCreate(){if(this.payload){let t=this.payload.get("openFile");if(t){let e=q.parse(t);if(this.payload.has("gotoLineMode")){let i=cG(e.path);return[{fileUri:e.with({path:i.path}),options:{selection:Vn(i.line)?void 0:{startLineNumber:i.line,startColumn:i.column||1}}}]}return[{fileUri:e}]}}}get filesToDiff(){if(this.payload){let t=this.payload.get("diffFilePrimary"),e=this.payload.get("diffFileSecondary");if(t&&e)return[{fileUri:q.parse(e)},{fileUri:q.parse(t)}]}}get filesToMerge(){if(this.payload){let t=this.payload.get("mergeFile1"),e=this.payload.get("mergeFile2"),i=this.payload.get("mergeFileBase"),n=this.payload.get("mergeFileResult");if(t&&e&&i&&n)return[{fileUri:q.parse(t)},{fileUri:q.parse(e)},{fileUri:q.parse(i)},{fileUri:q.parse(n)}]}}};_([ue],pi.prototype,"remoteAuthority",1),_([ue],pi.prototype,"expectsResolverExtension",1),_([ue],pi.prototype,"isBuilt",1),_([ue],pi.prototype,"logLevel",1),_([ue],pi.prototype,"windowLogsPath",1),_([ue],pi.prototype,"logFile",1),_([ue],pi.prototype,"userRoamingDataHome",1),_([ue],pi.prototype,"argvResource",1),_([ue],pi.prototype,"cacheHome",1),_([ue],pi.prototype,"workspaceStorageHome",1),_([ue],pi.prototype,"localHistoryHome",1),_([ue],pi.prototype,"stateResource",1),_([ue],pi.prototype,"userDataSyncHome",1),_([ue],pi.prototype,"sync",1),_([ue],pi.prototype,"keyboardLayoutResource",1),_([ue],pi.prototype,"untitledWorkspacesHome",1),_([ue],pi.prototype,"serviceMachineIdResource",1),_([ue],pi.prototype,"extHostLogsPath",1),_([ue],pi.prototype,"extHostTelemetryLogFile",1),_([ue],pi.prototype,"debugExtensionHost",1),_([ue],pi.prototype,"isExtensionDevelopment",1),_([ue],pi.prototype,"extensionDevelopmentLocationURI",1),_([ue],pi.prototype,"extensionDevelopmentLocationKind",1),_([ue],pi.prototype,"extensionTestsLocationURI",1),_([ue],pi.prototype,"extensionEnabledProposedApi",1),_([ue],pi.prototype,"debugRenderer",1),_([ue],pi.prototype,"enableSmokeTestDriver",1),_([ue],pi.prototype,"disableExtensions",1),_([ue],pi.prototype,"enableExtensions",1),_([ue],pi.prototype,"webviewExternalEndpoint",1),_([ue],pi.prototype,"extensionTelemetryLogResource",1),_([ue],pi.prototype,"disableTelemetry",1),_([ue],pi.prototype,"verbose",1),_([ue],pi.prototype,"logExtensionHostCommunication",1),_([ue],pi.prototype,"skipReleaseNotes",1),_([ue],pi.prototype,"skipWelcome",1),_([ue],pi.prototype,"disableWorkspaceTrust",1),_([ue],pi.prototype,"profile",1),_([ue],pi.prototype,"filesToOpenOrCreate",1),_([ue],pi.prototype,"filesToDiff",1),_([ue],pi.prototype,"filesToMerge",1);var cu=class extends L{constructor(e,i){super();this.logService=e;this.storageService=i;this._startupKind=this.resolveStartupKind(),this._register(this.storageService.onWillSaveState(n=>{n.reason===1&&this.storageService.store(cu.LAST_SHUTDOWN_REASON_KEY,this.shutdownReason,1,1)}))}static LAST_SHUTDOWN_REASON_KEY="lifecyle.lastShutdownReason";_onBeforeShutdown=this._register(new T);onBeforeShutdown=this._onBeforeShutdown.event;_onWillShutdown=this._register(new T);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new T);onDidShutdown=this._onDidShutdown.event;_onBeforeShutdownError=this._register(new T);onBeforeShutdownError=this._onBeforeShutdownError.event;_onShutdownVeto=this._register(new T);onShutdownVeto=this._onShutdownVeto.event;_startupKind;get startupKind(){return this._startupKind}_phase=1;get phase(){return this._phase}phaseWhen=new Map;shutdownReason;resolveStartupKind(){let e=this.doResolveStartupKind()??1;return this.logService.trace(`[lifecycle] starting up (startup kind: ${e})`),e}doResolveStartupKind(){let e=this.storageService.getNumber(cu.LAST_SHUTDOWN_REASON_KEY,1);this.storageService.remove(cu.LAST_SHUTDOWN_REASON_KEY,1);let i;switch(e){case 3:i=3;break;case 4:i=4;break}return i}set phase(e){if(e<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===e)return;this.logService.trace(`lifecycle: phase changed (value: ${e})`),this._phase=e,Dt(`code/LifecyclePhase/${c$(e)}`);let i=this.phaseWhen.get(this._phase);i&&(i.open(),this.phaseWhen.delete(this._phase))}async when(e){if(e<=this._phase)return;let i=this.phaseWhen.get(e);i||(i=new La,this.phaseWhen.set(e,i)),await i.wait()}};cu=_([v(0,Gt),v(1,tt)],cu);var BT=class extends cu{beforeUnloadListener=void 0;unloadListener=void 0;ignoreBeforeUnload=!1;didUnload=!1;constructor(t,e){super(t,e),this.registerListeners()}registerListeners(){this.beforeUnloadListener=M(ne,G.BEFORE_UNLOAD,t=>this.onBeforeUnload(t)),this.unloadListener=M(ne,G.PAGE_HIDE,()=>this.onUnload())}onBeforeUnload(t){this.ignoreBeforeUnload?(this.logService.info("[lifecycle] onBeforeUnload triggered but ignored once"),this.ignoreBeforeUnload=!1):(this.logService.info("[lifecycle] onBeforeUnload triggered and handled with veto support"),this.doShutdown(()=>this.vetoBeforeUnload(t)))}vetoBeforeUnload(t){t.preventDefault(),t.returnValue=h("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}withExpectedShutdown(t,e){if(typeof t=="number")return this.shutdownReason=t,this.storageService.flush(1);this.ignoreBeforeUnload=!0;try{e?.()}finally{this.ignoreBeforeUnload=!1}}async shutdown(){this.logService.info("[lifecycle] shutdown triggered"),this.beforeUnloadListener?.dispose(),this.unloadListener?.dispose(),await this.storageService.flush(1),this.doShutdown()}doShutdown(t){let e=this.logService;this.storageService.flush(1);let i=!1;function n(o,s){typeof t=="function"&&(o instanceof Promise&&(e.error(`[lifecycle] Long running operations before shutdown are unsupported in the web (id: ${s})`),i=!0),o===!0&&(e.info(`[lifecycle]: Unload was prevented (id: ${s})`),i=!0))}return this._onBeforeShutdown.fire({reason:2,veto(o,s){n(o,s)},finalVeto(o,s){n(o(),s)}}),i&&typeof t=="function"?t():this.onUnload()}onUnload(){if(this.didUnload)return;this.didUnload=!0,this._register(M(ne,G.PAGE_SHOW,e=>this.onLoadAfterUnload(e)));let t=this.logService;this._onWillShutdown.fire({reason:2,joiners:()=>[],token:In.None,join(e,i){t.error(`[lifecycle] Long running operations during shutdown are unsupported in the web (id: ${i.id})`)},force:()=>{}}),this._onDidShutdown.fire()}onLoadAfterUnload(t){t.persisted&&this.withExpectedShutdown({disableShutdownHandling:!0},()=>ne.location.reload())}doResolveStartupKind(){let t=super.doResolveStartupKind();return typeof t!="number"&&performance.getEntriesByType("navigation").at(0)?.type==="reload"&&(t=3),t}};BT=_([v(0,Gt),v(1,tt)],BT);vi(Pn,BT,0);var hce=h("open","open"),mce=h("close","close"),gce=h("find","find"),wM={open:hce,close:mce,find:gce};async function dJ(r,t){let e=[];return await cJ(r,e,t.logsHome,t.logsHome),e}async function cJ(r,t,e,i){let n=await r.resolve(e);for(let{resource:o,isDirectory:s}of n.children||[])if(s)await cJ(r,t,o,i);else{let a=(await r.readFile(o)).value.toString();if(a){let l=bD(i,o);l&&t.push({relativePath:l,contents:a})}}}var Bf=class{constructor(t,e,i,n){this.fileService=t;this.environmentService=e;this.lifecycleService=i;this.logService=n}async getLogs(){return dJ(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(3),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await Ne.as(Qh.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(t,e){let i=ne.document.querySelector(t);if(!i)return Promise.reject(new Error(`Element not found: ${t}`));let n=i;n.value=e;let o=new Event("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(o)}async isActiveElement(t){if(ne.document.querySelector(t)!==ne.document.activeElement){let i=[],n=ne.document.activeElement;for(;n;){let o=n.tagName,s=n.id?`#${n.id}`:"",a=Ei(n.className.split(/\s+/g).map(l=>l.trim())).map(l=>`.${l}`).join("");i.unshift(`${o}${s}${a}`),n=n.parentElement}throw new Error(`Active element not found. Current active element is '${i.join(" > ")}'. Looking for ${t}`)}return!0}async getElements(t,e){let i=ne.document.querySelectorAll(t),n=[];for(let o=0;o<i.length;o++){let s=i.item(o);n.push(this.serializeElement(s,e))}return n}serializeElement(t,e){let i=Object.create(null);for(let a=0;a<t.attributes.length;a++){let l=t.attributes.item(a);l&&(i[l.name]=l.value)}let n=[];if(e)for(let a=0;a<t.children.length;a++){let l=t.children.item(a);l&&n.push(this.serializeElement(l,!0))}let{left:o,top:s}=$w(t);return{tagName:t.tagName,className:t.className,textContent:t.textContent||"",attributes:i,children:n,left:o,top:s}}async getElementXY(t,e,i){let n=typeof e=="number"&&typeof i=="number"?{x:e,y:i}:void 0;return this._getElementXY(t,n)}async typeInEditor(t,e){let i=ne.document.querySelector(t);if(!i)throw new Error(`Editor not found: ${t}`);let n=i,o=n.selectionStart,s=o+e.length,a=n.value,l=a.substr(0,o)+e+a.substr(o);n.value=l,n.setSelectionRange(s,s);let d=new Event("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(d)}async getTerminalBuffer(t){let e=ne.document.querySelector(t);if(!e)throw new Error(`Terminal not found: ${t}`);let i=e.xterm;if(!i)throw new Error(`Xterm not found: ${t}`);let n=[];for(let o=0;o<i.buffer.active.length;o++)n.push(i.buffer.active.getLine(o).translateToString(!0));return n}async writeInTerminal(t,e){let i=ne.document.querySelector(t);if(!i)throw new Error(`Element not found: ${t}`);let n=i.xterm;if(!n)throw new Error(`Xterm not found: ${t}`);n.input(e)}getLocaleInfo(){return Promise.resolve({language:rl,locale:j9})}getLocalizedStrings(){return Promise.resolve({open:wM.open,close:wM.close,find:wM.find})}async _getElementXY(t,e){let i=ne.document.querySelector(t);if(!i)return Promise.reject(new Error(`Element not found: ${t}`));let{left:n,top:o}=$w(i),{width:s,height:a}=gd(i),l,d;return e?(l=n+e.x,d=o+e.y):(l=n+s/2,d=o+a/2),l=Math.round(l),d=Math.round(d),{x:l,y:d}}async exitApplication(){}};Bf=_([v(0,ai),v(1,tr),v(2,Pn),v(3,Gt)],Bf);function uJ(r){Object.assign(ne,{driver:r.createInstance(Bf)})}var Ns=class extends L{constructor(e,i={getWindowsCount:JL,getWindows:hd},n,o){super();this.hostService=n;this.environmentService=o;this.enableWindowFocusOnElementFocus(e),this.enableMultiWindowAwareTimeout(e,i),this.registerFullScreenListeners(e.vscodeWindowId)}static TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER;static TIMEOUT_DISPOSABLES=new Map;enableWindowFocusOnElementFocus(e){let i=e.HTMLElement.prototype.focus,n=this;e.HTMLElement.prototype.focus=function(o){n.onElementFocus(oe(this)),i.apply(this,[o])}}onElementFocus(e){let i=uo();i!==e&&i.document.hasFocus()&&(e.focus(),!this.environmentService.extensionTestsLocationURI&&!e.document.hasFocus()&&this.hostService.focus(e))}enableMultiWindowAwareTimeout(e,i={getWindowsCount:JL,getWindows:hd}){let n=e.setTimeout;Object.defineProperty(e,"vscodeOriginalSetTimeout",{get:()=>n});let o=e.clearTimeout;Object.defineProperty(e,"vscodeOriginalClearTimeout",{get:()=>o}),e.setTimeout=function(s,a=0,...l){if(i.getWindowsCount()===1||typeof s=="string"||a===0)return n.apply(this,[s,a,...l]);let d=new Set,c=Ns.TIMEOUT_HANDLES++;Ns.TIMEOUT_DISPOSABLES.set(c,d);let u=jl(s,()=>{nt(d),Ns.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:p,disposables:m}of i.getWindows()){if(HL(p)&&p.document.visibilityState==="hidden")continue;let g=!1,f=p.vscodeOriginalSetTimeout.apply(this,[(...y)=>{g||u(...y)},a,...l]),b=te(()=>{g=!0,p.vscodeOriginalClearTimeout(f),d.delete(b)});m.add(b),d.add(b)}return c},e.clearTimeout=function(s){let a=typeof s=="number"?Ns.TIMEOUT_DISPOSABLES.get(s):void 0;a?(nt(a),Ns.TIMEOUT_DISPOSABLES.delete(s)):o.apply(this,[s])}}registerFullScreenListeners(e){this._register(this.hostService.onDidChangeFullScreen(({windowId:i,fullscreen:n})=>{if(i===e){let o=Ma(e);o&&Bg(n,o.window)}}))}static async confirmOnShutdown(e,i){let n=e.get(Ar),o=e.get(de),s=i===2?be?h("quitMessageMac","Are you sure you want to quit?"):h("quitMessage","Are you sure you want to exit?"):h("closeWindowMessage","Are you sure you want to close the window?"),a=i===2?be?h({key:"quitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Quit"):h({key:"exitButtonLabel",comment:["&& denotes a mnemonic"]},"&&Exit"):h({key:"closeWindowButtonLabel",comment:["&& denotes a mnemonic"]},"&&Close Window"),l=await n.confirm({message:s,primaryButton:a,checkbox:{label:h("doNotAskAgain","Do not ask me again")}});return l.confirmed&&l.checkboxChecked&&await o.updateValue("window.confirmBeforeClose","never"),l.confirmed}};Ns=_([v(2,en),v(3,on)],Ns);var EM=class extends Ns{constructor(e,i,n,o,s,a,l,d,c){super(ne,void 0,c,a);this.openerService=e;this.lifecycleService=i;this.dialogService=n;this.labelService=o;this.productService=s;this.browserEnvironmentService=a;this.layoutService=l;this.instantiationService=d;this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let e=Xo&&ne.visualViewport?ne.visualViewport:ne;this._register(M(e,G.RESIZE,()=>{this.layoutService.layout(),Xo&&ne.scrollTo(0,0)})),this._register(M(this.layoutService.mainContainer,G.WHEEL,i=>i.preventDefault(),{passive:!1})),this._register(M(this.layoutService.mainContainer,G.CONTEXT_MENU,i=>Te.stop(i,!0))),this._register(M(this.layoutService.mainContainer,G.DROP,i=>Te.stop(i,!0)))}onWillShutdown(){O.toPromise(O.any(O.once(new Ge(ne.document.body,G.KEY_DOWN,!0).event),O.once(new Ge(ne.document.body,G.MOUSE_DOWN,!0).event))).then(async()=>{await Sn(3e3),await this.dialogService.prompt({type:xo.Error,message:h("shutdownError","An unexpected error occurred that requires a reload of this page."),detail:h("shutdownErrorDetail","The workbench was unexpectedly disposed while running."),buttons:[{label:h({key:"reload",comment:["&& denotes a mnemonic"]},"&&Reload"),run:()=>ne.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&uJ(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async e=>{let i=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(let n of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(e.startsWith(n)){i=!0;break}}if(ev(e,he.http)||ev(e,he.https))Eo?s$(e,!i)||await this.dialogService.prompt({type:xo.Warning,message:h("unableToOpenExternal","The browser interrupted the opening of a new tab or window. Press 'Open' to open it anyway."),detail:e,buttons:[{label:h({key:"open",comment:["&& denotes a mnemonic"]},"&&Open"),run:()=>i?cW(e):dW(e)},{label:h({key:"learnMore",comment:["&& denotes a mnemonic"]},"&&Learn More"),run:()=>this.openerService.open(q.parse("https://aka.ms/allow-vscode-popup"))}],cancelButton:!0}):i?cW(e):dW(e);else{let n=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>ne.location.href=e)};n();let o=async()=>{let{downloadUrl:s}=this.productService,a,l=[{label:h({key:"openExternalDialogButtonRetry.v2",comment:["&& denotes a mnemonic"]},"&&Try Again"),run:()=>n()}];s!==void 0?(a=h("openExternalDialogDetail.v2",`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),l.push({label:h({key:"openExternalDialogButtonInstall.v3",comment:["&& denotes a mnemonic"]},"&&Install"),run:async()=>{await this.openerService.open(q.parse(s)),o()}})):a=h("openExternalDialogDetailNoInstall",`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:xo.Info,message:h("openExternalDialogTitle","All done. You can close this tab now."),detail:a,buttons:l,cancelButton:!0}))};ev(e,this.productService.urlProtocol)&&await o()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:he.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){En.registerCommand("workbench.experimental.requestUsbDevice",async(e,i)=>nJ(i)),En.registerCommand("workbench.experimental.requestSerialPort",async(e,i)=>oJ(i)),En.registerCommand("workbench.experimental.requestHidDevice",async(e,i)=>rJ(i))}};EM=_([v(0,Os),v(1,Pn),v(2,Ar),v(3,qo),v(4,Qn),v(5,Ml),v(6,Qe),v(7,ae),v(8,en)],EM);var D5=$("auxiliaryWindowService");var VT=class extends Ns{constructor(e,i,n,o,s,a){super(e,void 0,s,a);this.window=e;this.container=i;this.configurationService=o;this.whenStylesHaveLoaded=n.wait().then(()=>{}),this.registerListeners()}_onWillLayout=this._register(new T);onWillLayout=this._onWillLayout.event;_onDidLayout=this._register(new T);onDidLayout=this._onDidLayout.event;_onBeforeUnload=this._register(new T);onBeforeUnload=this._onBeforeUnload.event;_onUnload=this._register(new T);onUnload=this._onUnload.event;_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;whenStylesHaveLoaded;registerListeners(){this._register(M(this.window,G.BEFORE_UNLOAD,e=>this.handleBeforeUnload(e))),this._register(M(this.window,G.UNLOAD,()=>this.handleUnload())),this._register(M(this.window,"unhandledrejection",e=>{Ke(e.reason),e.preventDefault()})),this._register(M(this.window,G.RESIZE,()=>this.layout())),this._register(M(this.container,G.SCROLL,()=>this.container.scrollTop=0)),wt?(this._register(M(this.container,G.DROP,e=>Te.stop(e,!0))),this._register(M(this.container,G.WHEEL,e=>e.preventDefault(),{passive:!1})),this._register(M(this.container,G.CONTEXT_MENU,e=>Te.stop(e,!0)))):(this._register(M(this.window.document.body,G.DRAG_OVER,e=>Te.stop(e))),this._register(M(this.window.document.body,G.DROP,e=>Te.stop(e))))}handleBeforeUnload(e){let i;if(this._onBeforeUnload.fire({veto(s){s&&(i=s)}}),i){this.handleVetoBeforeClose(e,i);return}let n=this.configurationService.getValue("window.confirmBeforeClose");(n==="always"||n==="keyboardOnly"&&pd.getInstance().isModifierPressed)&&this.confirmBeforeClose(e)}handleVetoBeforeClose(e,i){this.preventUnload(e)}preventUnload(e){e.preventDefault(),e.returnValue=h("lifecycleVeto","Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(e){this.preventUnload(e)}handleUnload(){this._onUnload.fire()}layout(){let e=gd(this.window.document.body,this.container);this._onWillLayout.fire(e),this._onDidLayout.fire(e)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:Wh(this.window)}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};VT=_([v(3,de),v(4,en),v(5,on)],VT);var Np=class extends L{constructor(e,i,n,o,s,a){super();this.layoutService=e;this.dialogService=i;this.configurationService=n;this.telemetryService=o;this.hostService=s;this.environmentService=a}static DEFAULT_SIZE={width:800,height:600};static WINDOW_IDS=oa(ne)+1;_onDidOpenAuxiliaryWindow=this._register(new T);onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event;windows=new Map;async open(e){Dt("code/auxiliaryWindow/willOpen");let i=await this.openWindow(e);if(!i)throw new Error(h("unableToOpenWindowError","Unable to open a new window."));let n=await this.resolveWindowId(i);UL(i,n);let o=new W,{container:s,stylesLoaded:a}=this.createContainer(i,o,e),l=this.createAuxiliaryWindow(i,s,a),d=new W;this.windows.set(i.vscodeWindowId,l),d.add(te(()=>this.windows.delete(i.vscodeWindowId)));let c=new W;return O.once(l.onWillDispose)(()=>{i.close(),o.dispose(),d.dispose(),c.dispose()}),d.add(Kj(i)),this._onDidOpenAuxiliaryWindow.fire({window:l,disposables:c}),Dt("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!e?.bounds}),l}createAuxiliaryWindow(e,i,n){return new VT(e,i,n,this.configurationService,this.hostService,this.environmentService)}async openWindow(e){let i=uo(),n={x:i.screenX,y:i.screenY,width:i.outerWidth,height:i.outerHeight},o=Math.max(e?.bounds?.width??Np.DEFAULT_SIZE.width,Lv.WIDTH),s=Math.max(e?.bounds?.height??Np.DEFAULT_SIZE.height,Lv.HEIGHT),a={x:e?.bounds?.x??Math.max(n.x+n.width/2-o/2,0),y:e?.bounds?.y??Math.max(n.y+n.height/2-s/2,0),width:o,height:s};!e?.bounds&&a.x===n.x&&a.y===n.y&&(a={...a,x:a.x+30,y:a.y+30});let l=Ei(["popup=yes",`left=${a.x}`,`top=${a.y}`,`width=${a.width}`,`height=${a.height}`,e?.nativeTitlebar?"window-native-titlebar=yes":void 0,e?.disableFullscreen?"window-disable-fullscreen=yes":void 0,e?.mode===0?"window-maximized=yes":void 0,e?.mode===2?"window-fullscreen=yes":void 0]),d=ne.open(M_?"":"about:blank",void 0,l.join(","));return!d&&wt?(await this.dialogService.prompt({type:xo.Warning,message:h("unableToOpenWindow","The browser interrupted the opening of a new window. Press 'Retry' to try again."),detail:h("unableToOpenWindowDetail","To avoid this problem in the future, please ensure to allow popups for this website."),buttons:[{label:h({key:"retry",comment:["&& denotes a mnemonic"]},"&&Retry"),run:()=>this.openWindow(e)}],cancelButton:!0})).result:d?.window}async resolveWindowId(e){return Np.WINDOW_IDS++}createContainer(e,i,n){e.document.createElement=function(){throw new Error('Not allowed to create elements in child window JavaScript context. Always use the main window so that "xyz instanceof HTMLElement" continues to work.')},this.applyMeta(e);let{stylesLoaded:o}=this.applyCSS(e,i),s=this.applyHTML(e,i);return{stylesLoaded:o,container:s}}applyMeta(e){for(let n of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let o=ne.document.querySelector(n);if(o){let s=lk(e.document.head);if(ck(o,s),n==='meta[http-equiv="Content-Security-Policy"]'){let a=s.getAttribute("content");a&&s.setAttribute("content",a.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let i=ne.document.querySelector('link[rel="icon"]');if(i){let n=Qj(e.document.head);ck(i,n)}}applyCSS(e,i){Dt("code/auxiliaryWindow/willApplyCSS");let n=new Map,o=new La;o.wait().then(()=>Dt("code/auxiliaryWindow/didLoadCSSStyles"));let s=i.add(new W),a=0;function l(){--a===0&&(s.dispose(),o.open())}function d(c){if(Yj(c))return;let u=e.document.head.appendChild(c.cloneNode(!0));c.tagName.toLowerCase()==="link"&&(a++,s.add(M(u,"load",l)),s.add(M(u,"error",l))),n.set(c,u)}a++;try{for(let c of ne.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(c)}finally{l()}return i.add(Zj(e)),i.add(ak.observe(ne.document.head,i,{childList:!0,subtree:!0})(c=>{for(let u of c)if(!(u.type!=="childList"||u.target.nodeName.toLowerCase()==="title"||u.target.nodeName.toLowerCase()==="script"||u.target.nodeName.toLowerCase()==="meta")){for(let p of u.addedNodes)if(Oi(p)&&(p.tagName.toLowerCase()==="style"||p.tagName.toLowerCase()==="link"))d(p);else if(p.nodeType===Node.TEXT_NODE&&p.parentNode){let m=n.get(p.parentNode);m&&(m.textContent=p.textContent)}for(let p of u.removedNodes){let m=n.get(p);m&&(m.parentNode?.removeChild(m),n.delete(p))}}})),Dt("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:o}}applyHTML(e,i){Dt("code/auxiliaryWindow/willApplyHTML");let n=document.createElement("div");return n.setAttribute("role","application"),tk(n,0,0,0,0,"relative"),n.style.display="flex",n.style.height="100%",n.style.flexDirection="column",e.document.body.append(n),i.add(uk(ne.document.documentElement,e.document.documentElement)),i.add(uk(ne.document.body,e.document.body)),i.add(uk(this.layoutService.mainContainer,n,["class"])),Dt("code/auxiliaryWindow/didApplyHTML"),n}getWindow(e){return this.windows.get(e)}};Np=_([v(0,Qe),v(1,Ar),v(2,de),v(3,qt),v(4,en),v(5,on)],Np);vi(D5,Np,1);var km=new dt(220,70),L5=new dt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);var Kd;(s=>{let r;(p=>(p[p.None=0]="None",p[p.Done=1]="Done",p[p.Infinite=2]="Infinite",p[p.While=3]="While",p[p.Work=4]="Work"))(r=s.Type||={}),s.None={type:0},s.Done={type:1},s.Infinite={type:2};class n{constructor(l,d,c){this.whilePromise=l;this.whileStart=d;this.whileDelay=c}type=3}s.While=n;class o{constructor(l,d){this.total=l;this.worked=d}type=4}s.Work=o})(Kd||={});var CI=class extends L{constructor(e,i){super();this.progressBar=e;this.scope=i;this.registerListeners()}progressState=Kd.None;registerListeners(){this._register(this.scope.onDidChangeActive(()=>{this.scope.isActive?this.onDidScopeActivate():this.onDidScopeDeactivate()}))}onDidScopeActivate(){if(this.progressState.type!==Kd.Done.type)if(this.progressState.type===3){let e;if(this.progressState.whileDelay>0){let i=this.progressState.whileDelay-(Date.now()-this.progressState.whileStart);i>0&&(e=i)}this.doShowWhile(e)}else this.progressState.type===2?this.progressBar.infinite().show():this.progressState.type===4&&(this.progressState.total&&this.progressBar.total(this.progressState.total).show(),this.progressState.worked&&this.progressBar.worked(this.progressState.worked).show())}onDidScopeDeactivate(){this.progressBar.stop().hide()}show(e,i){return typeof e=="boolean"?this.progressState=Kd.Infinite:this.progressState=new Kd.Work(e,void 0),this.scope.isActive&&(this.progressState.type===2?this.progressBar.infinite().show(i):this.progressState.type===4&&typeof this.progressState.total=="number"&&this.progressBar.total(this.progressState.total).show(i)),{total:n=>{this.progressState=new Kd.Work(n,this.progressState.type===4?this.progressState.worked:void 0),this.scope.isActive&&this.progressBar.total(n)},worked:n=>{!this.scope.isActive||this.progressBar.hasTotal()?(this.progressState=new Kd.Work(this.progressState.type===4?this.progressState.total:void 0,this.progressState.type===4&&typeof this.progressState.worked=="number"?this.progressState.worked+n:n),this.scope.isActive&&this.progressBar.worked(n)):(this.progressState=Kd.Infinite,this.progressBar.infinite().show())},done:()=>{this.progressState=Kd.Done,this.scope.isActive&&this.progressBar.stop().hide()}}}async showWhile(e,i){this.progressState.type===3&&(e=Promise.all([e,this.progressState.whilePromise])),this.progressState=new Kd.While(e,i||0,Date.now());try{this.doShowWhile(i),await e}catch{}finally{(this.progressState.type!==3||this.progressState.whilePromise===e)&&(this.progressState=Kd.None,this.scope.isActive&&this.progressBar.stop().hide())}}doShowWhile(e){this.scope.isActive&&this.progressBar.infinite().show(e)}},SI=class extends L{constructor(e,i){super();this.scopeId=e;this._isActive=i}_onDidChangeActive=this._register(new T);onDidChangeActive=this._onDidChangeActive.event;get isActive(){return this._isActive}onScopeOpened(e){e===this.scopeId&&(this._isActive||(this._isActive=!0,this._onDidChangeActive.fire()))}onScopeClosed(e){e===this.scopeId&&this._isActive&&(this._isActive=!1,this._onDidChangeActive.fire())}};var TM=class extends L{options;actionBar;toggleMenuAction;toggleMenuActionViewItem;submenuActionViewItems=[];hasSecondaryActions=!1;element;_onDidChangeDropdownVisibility=this._register(new $S);onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event;disposables=this._register(new W);constructor(t,e,i={orientation:0}){super(),i.hoverDelegate=i.hoverDelegate??this._register(Ha()),this.options=i,this.toggleMenuAction=this._register(new wI(()=>this.toggleMenuActionViewItem?.show(),i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",t.appendChild(this.element),this.actionBar=this._register(new gn(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,o)=>{if(n.id===wI.ID)return this.toggleMenuActionViewItem=new Al(n,n.menuActions,e,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:ye.asClassNameArray(i.moreIcon??B.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){let s=i.actionViewItemProvider(n,o);if(s)return s}if(n instanceof mn){let s=new Al(n,n.actions,e,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return s.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(s),this.disposables.add(this._onDidChangeDropdownVisibility.add(s.onDidChangeVisibility)),s}}}))}set actionRunner(t){this.actionBar.actionRunner=t}get actionRunner(){return this.actionBar.actionRunner}set context(t){this.actionBar.context=t,this.toggleMenuActionViewItem?.setActionContext(t);for(let e of this.submenuActionViewItems)e.setActionContext(t)}getElement(){return this.element}focus(){this.actionBar.focus()}getItemsWidth(){let t=0;for(let e=0;e<this.actionBar.length();e++)t+=this.actionBar.getWidth(e);return t}getItemAction(t){return this.actionBar.getAction(t)}getItemWidth(t){return this.actionBar.getWidth(t)}getItemsLength(){return this.actionBar.length()}setAriaLabel(t){this.actionBar.setAriaLabel(t)}setActions(t,e){this.clear();let i=t?t.slice(0):[];this.hasSecondaryActions=!!(e&&e.length>0),this.hasSecondaryActions&&e&&(this.toggleMenuAction.menuActions=e.slice(0),i.push(this.toggleMenuAction)),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})})}isEmpty(){return this.actionBar.isEmpty()}getKeybindingLabel(t){return this.options.getKeyBinding?.(t)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}},wI=class r extends ot{static ID="toolbar.toggle.more";_menuActions;toggleDropdownMenu;constructor(t,e){e=e||h("moreActions","More Actions..."),super(r.ID,e,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=t}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(t){this._menuActions=t}};var xM=class{constructor(t,e,i){this._commandService=t;this._keybindingService=e;this._hiddenStates=new uu(i)}_hiddenStates;createMenu(t,e,i){return new EI(t,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,e)}getMenuActions(t,e,i){let n=new EI(t,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,e),o=n.getActions(i);return n.dispose(),o}getMenuContexts(t){let e=new _M(t,!1);return new Set([...e.structureContextKeys,...e.preconditionContextKeys,...e.toggledContextKeys])}resetHiddenStates(t){this._hiddenStates.reset(t)}};xM=_([v(0,ni),v(1,at),v(2,tt)],xM);var uu=class{constructor(t){this._storageService=t;try{let e=t.get(uu._key,0,"{}");this._data=JSON.parse(e)}catch{this._data=Object.create(null)}this._disposables.add(t.onDidChangeValue(0,uu._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{let e=t.get(uu._key,0,"{}");this._data=JSON.parse(e)}catch(e){console.log("FAILED to read storage after UPDATE",e)}this._onDidChange.fire()}))}static _key="menu.hiddenCommands";_disposables=new W;_onDidChange=new T;onDidChange=this._onDidChange.event;_ignoreChangeEvent=!1;_data;_hiddenByDefaultCache=new Map;dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(t,e){return this._hiddenByDefaultCache.get(`${t.id}/${e}`)??!1}setDefaultState(t,e,i){this._hiddenByDefaultCache.set(`${t.id}/${e}`,i)}isHidden(t,e){let i=this._isHiddenByDefault(t,e),n=this._data[t.id]?.includes(e)??!1;return i?!n:n}updateHidden(t,e,i){this._isHiddenByDefault(t,e)&&(i=!i);let o=this._data[t.id];if(i)o?o.indexOf(e)<0&&o.push(e):this._data[t.id]=[e];else if(o){let s=o.indexOf(e);s>=0&&m7(o,s),o.length===0&&delete this._data[t.id]}this._persist()}reset(t){if(t===void 0)this._data=Object.create(null),this._persist();else{for(let{id:e}of t)this._data[e]&&delete this._data[e];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;let t=JSON.stringify(this._data);this._storageService.store(uu._key,t,0,0)}finally{this._ignoreChangeEvent=!1}}};uu=_([v(0,tt)],uu);var _M=class r{constructor(t,e){this._id=t;this._collectContextKeysForSubmenus=e;this.refresh()}_menuGroups=[];_allMenuIds=new Set;_structureContextKeys=new Set;_preconditionContextKeys=new Set;_toggledContextKeys=new Set;get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();let t=this._sort(Ct.getMenuItems(this._id)),e;for(let i of t){let n=i.group||"";(!e||e[0]!==n)&&(e=[n,[]],this._menuGroups.push(e)),e[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(t){return t}_collectContextKeysAndSubmenuIds(t){if(r._fillInKbExprKeys(t.when,this._structureContextKeys),Ey(t)){if(t.command.precondition&&r._fillInKbExprKeys(t.command.precondition,this._preconditionContextKeys),t.command.toggled){let e=t.command.toggled.condition||t.command.toggled;r._fillInKbExprKeys(e,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(Ct.getMenuItems(t.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(t.submenu))}static _fillInKbExprKeys(t,e){if(t)for(let i of t.keys())e.add(i)}},Fp=class extends _M{constructor(e,i,n,o,s,a){super(e,n);this._hiddenStates=i;this._commandService=o;this._keybindingService=s;this._contextKeyService=a;this.refresh()}createActionGroups(e){let i=[];for(let n of this._menuGroups){let[o,s]=n,a;for(let l of s)if(this._contextKeyService.contextMatchesRules(l.when)){let d=Ey(l);d&&this._hiddenStates.setDefaultState(this._id,l.command.id,!!l.isHiddenByDefault);let c=fce(this._id,d?l.command:l,this._hiddenStates);if(d){let u=k5(this._commandService,this._keybindingService,l.command.id,l.when);(a??=[]).push(new po(l.command,l.alt,e,c,u,this._contextKeyService,this._commandService))}else{let u=new Fp(l.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),p=pt.join(...u.map(m=>m[1]));p.length>0&&(a??=[]).push(new jn(l,c,p))}}a&&a.length>0&&i.push([o,a])}return i}_sort(e){return e.sort(Fp._compareMenuItems)}static _compareMenuItems(e,i){let n=e.group,o=i.group;if(n!==o){if(n){if(!o)return-1}else return 1;if(n==="navigation")return-1;if(o==="navigation")return 1;let l=n.localeCompare(o);if(l!==0)return l}let s=e.order||0,a=i.order||0;return s<a?-1:s>a?1:Fp._compareTitles(Ey(e)?e.command.title:e.title,Ey(i)?i.command.title:i.title)}static _compareTitles(e,i){let n=typeof e=="string"?e:e.original,o=typeof i=="string"?i:i.original;return n.localeCompare(o)}};Fp=_([v(3,ni),v(4,at),v(5,ke)],Fp);var EI=class{_menuInfo;_disposables=new W;_onDidChange;onDidChange;constructor(t,e,i,n,o,s){this._menuInfo=new Fp(t,e,i.emitEventsForSubmenuChanges,n,o,s);let a=new Et(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(Ct.onDidChangeMenu(u=>{for(let p of this._menuInfo.allMenuIds)if(u.has(p)){a.schedule();break}}));let l=this._disposables.add(new W),d=u=>{let p=!1,m=!1,g=!1;for(let f of u)if(p=p||f.isStructuralChange,m=m||f.isEnablementChange,g=g||f.isToggleChange,p&&m&&g)break;return{menu:this,isStructuralChange:p,isEnablementChange:m,isToggleChange:g}},c=()=>{l.add(s.onDidChangeContext(u=>{let p=u.affectsSome(this._menuInfo.structureContextKeys),m=u.affectsSome(this._menuInfo.preconditionContextKeys),g=u.affectsSome(this._menuInfo.toggledContextKeys);(p||m||g)&&this._onDidChange.fire({menu:this,isStructuralChange:p,isEnablementChange:m,isToggleChange:g})})),l.add(e.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new rD({onWillAddFirstListener:c,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:d}),this.onDidChange=this._onDidChange.event}getActions(t){return this._menuInfo.createActionGroups(t)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};EI=_([v(3,ni),v(4,at),v(5,ke)],EI);function fce(r,t,e){let i=pZ(t)?t.submenu.id:t.id,n=typeof t.title=="string"?t.title:t.title.value,o=Ht({id:`hide/${r.id}/${i}`,label:h("hide.label","Hide '{0}'",n),run(){e.updateHidden(r,i,!0)}}),s=Ht({id:`toggle/${r.id}/${i}`,label:n,get checked(){return!e.isHidden(r,i)},run(){e.updateHidden(r,i,!!this.checked)}});return{hide:o,toggle:s,get isHidden(){return!s.checked}}}function k5(r,t,e,i=void 0,n=!0){return Ht({id:`configureKeybinding/${e}`,label:h("configure keybinding","Configure Keybinding"),enabled:n,run(){let s=!!!t.lookupKeybinding(e)&&i?i.serialize():void 0;r.executeCommand("workbench.action.openGlobalKeybindings",`@command:${e}`+(s?` +when:${s}`:""))}})}var pr=class extends TM{constructor(e,i,n,o,s,a,l,d){super(e,s,{getKeyBinding:u=>a.lookupKeybinding(u.id)??void 0,...i,allowContextMenu:!0,skipTelemetry:typeof i?.telemetrySource=="string"});this._options=i;this._menuService=n;this._contextKeyService=o;this._contextMenuService=s;this._keybindingService=a;this._commandService=l;let c=i?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(u=>d.publicLog2("workbenchActionExecuted",{id:u.action.id,from:c})))}_sessionDisposables=this._store.add(new W);setActions(e,i=[],n){this._sessionDisposables.clear();let o=e.slice(),s=i.slice(),a=[],l=0,d=[],c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let u=0;u<o.length;u++){let p=o[u];!(p instanceof po)&&!(p instanceof jn)||p.hideActions&&(a.push(p.hideActions.toggle),p.hideActions.toggle.checked&&l++,p.hideActions.isHidden&&(c=!0,o[u]=void 0,this._options?.hiddenItemStrategy!==0&&(d[u]=p)))}if(this._options?.overflowBehavior!==void 0){let u=e7(new Set(this._options.overflowBehavior.exempted),Lt.map(o,g=>g?.id)),p=this._options.overflowBehavior.maxItems-u.size,m=0;for(let g=0;g<o.length;g++){let f=o[g];f&&(m++,!u.has(f.id)&&m>=p&&(o[g]=void 0,d[g]=f))}}XF(o),XF(d),super.setActions(o,pt.join(d,s)),(a.length>0||o.length>0)&&this._sessionDisposables.add(M(this.getElement(),"contextmenu",u=>{let p=new ri(oe(this.getElement()),u),m=this.getItemAction(p.target);if(!m)return;p.preventDefault(),p.stopPropagation();let g=[];if(m instanceof po&&m.menuKeybinding)g.push(m.menuKeybinding);else if(!(m instanceof jn||m instanceof wI)){let b=!!this._keybindingService.lookupKeybinding(m.id);g.push(k5(this._commandService,this._keybindingService,m.id,void 0,b))}if(a.length>0){let b=!1;if(l===1&&this._options?.hiddenItemStrategy===0){b=!0;for(let y=0;y<a.length;y++)if(a[y].checked){a[y]=Ht({id:m.id,label:m.label,checked:!0,enabled:!1,run(){}});break}}if(!b&&(m instanceof po||m instanceof jn)){if(!m.hideActions)return;g.push(m.hideActions.hide)}else g.push(Ht({id:"label",label:h("hide","Hide"),enabled:!1,run(){}}))}let f=pt.join(g,a);this._options?.resetMenu&&!n&&(n=[this._options.resetMenu]),c&&n&&(f.push(new pt),f.push(Ht({id:"resetThisMenu",label:h("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(n)}))),f.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>p,getActions:()=>f,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};pr=_([v(2,Ri),v(3,ke),v(4,Mt),v(5,at),v(6,ni),v(7,qt)],pr);var pu=class extends pr{_onDidChangeMenuItems=this._store.add(new T);onDidChangeMenuItems=this._onDidChangeMenuItems.event;constructor(t,e,i,n,o,s,a,l,d){super(t,{resetMenu:e,...i},n,o,s,a,l,d);let c=this._store.add(n.createMenu(e,o,{emitEventsForSubmenuChanges:!0})),u=()=>{let p=[],m=[];qa(c,i?.menuOptions,{primary:p,secondary:m},i?.toolbarOptions?.primaryGroup,i?.toolbarOptions?.shouldInlineSubmenu,i?.toolbarOptions?.useSeparatorsInPrimaryActions),t.classList.toggle("has-no-actions",p.length===0&&m.length===0),super.setActions(p,m)};this._store.add(c.onDidChange(()=>{u(),this._onDidChangeMenuItems.fire(this)})),u()}setActions(){throw new yt("This toolbar is populated from a menu.")}};pu=_([v(3,Ri),v(4,ke),v(5,Mt),v(6,at),v(7,ni),v(8,qt)],pu);var bce=h("defaultLabel","input"),vce=h("label.preserveCaseToggle","Preserve Case"),R5=class extends Od{constructor(t){super({icon:B.preserveCase,title:vce+t.appendTitle,isChecked:t.isChecked,hoverDelegate:t.hoverDelegate??zt("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}},DM=class extends eo{constructor(e,i,n,o){super();this._showOptionButtons=n;this.contextViewProvider=i,this.placeholder=o.placeholder||"",this.validation=o.validation,this.label=o.label||bce;let s=o.appendPreserveCaseLabel||"",a=o.history||[],l=!!o.flexibleHeight,d=!!o.flexibleWidth,c=o.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new am(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:o.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c,inputBoxStyles:o.inputBoxStyles})),this.preserveCase=this._register(new R5({appendTitle:s,isChecked:!1,...o.toggleStyles})),this._register(this.preserveCase.onChange(m=>{this._onDidOptionChange.fire(m),!m&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(m=>{this._onPreserveCaseKeyDown.fire(m)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let u=[this.preserveCase.domNode];this.onkeydown(this.domNode,m=>{if(m.equals(15)||m.equals(17)||m.equals(9)){let g=u.indexOf(this.domNode.ownerDocument.activeElement);if(g>=0){let f=-1;m.equals(17)?f=(g+1)%u.length:m.equals(15)&&(g===0?f=u.length-1:f=g-1),m.equals(9)?(u[g].blur(),this.inputBox.focus()):f>=0&&u[f].focus(),Te.stop(m,!0)}}});let p=document.createElement("div");p.className="controls",p.style.display=this._showOptionButtons?"block":"none",p.appendChild(this.preserveCase.domNode),this.domNode.appendChild(p),e?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,m=>this._onKeyDown.fire(m)),this.onkeyup(this.inputBox.inputElement,m=>this._onKeyUp.fire(m)),this.oninput(this.inputBox.inputElement,m=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,m=>this._onMouseDown.fire(m))}static OPTION_CHANGE="optionChange";contextViewProvider;placeholder;validation;label;fixFocusOnOptionClickEnabled=!0;preserveCase;cachedOptionsWidth=0;domNode;inputBox;_onDidOptionChange=this._register(new T);onDidOptionChange=this._onDidOptionChange.event;_onKeyDown=this._register(new T);onKeyDown=this._onKeyDown.event;_onMouseDown=this._register(new T);onMouseDown=this._onMouseDown.event;_onInput=this._register(new T);onInput=this._onInput.event;_onKeyUp=this._register(new T);onKeyUp=this._onKeyUp.event;_onPreserveCaseKeyDown=this._register(new T);onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event;enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}clear(){this.clearValidation(),this.setValue(""),this.focus()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}onSearchSubmit(){this.inputBox.addToHistory()}applyStyles(){}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}_lastHighlightFindOptions=0;highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox?.validate()}showMessage(e){this.inputBox?.showMessage(e)}clearMessage(){this.inputBox?.hideMessage()}clearValidation(){this.inputBox?.hideMessage()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}};var pJ=new ie("suggestWidgetVisible",!1,h("suggestWidgetVisible","Whether suggestion are visible")),A5="historyNavigationWidgetFocus",hJ="historyNavigationForwardsEnabled",mJ="historyNavigationBackwardsEnabled",WT,LM=[];function P5(r,t){if(LM.includes(t))throw new Error("Cannot register the same widget multiple times");LM.push(t);let e=new W,i=new ie(A5,!1).bindTo(r),n=new ie(hJ,!0).bindTo(r),o=new ie(mJ,!0).bindTo(r),s=()=>{i.set(!0),WT=t},a=()=>{i.set(!1),WT===t&&(WT=void 0)};return os(t.element)&&s(),e.add(t.onDidFocus(()=>s())),e.add(t.onDidBlur(()=>a())),e.add(te(()=>{LM.splice(LM.indexOf(t),1),a()})),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:o,dispose(){e.dispose()}}}var TI=class extends am{constructor(t,e,i,n){super(t,e,i);let o=this._register(n.createScoped(this.element));this._register(P5(o,this))}};TI=_([v(3,ke)],TI);var kM=class extends Gy{constructor(t,e,i,n){super(t,e,i);let o=this._register(n.createScoped(this.inputBox.element));this._register(P5(o,this.inputBox))}};kM=_([v(3,ke)],kM);var RM=class extends DM{constructor(t,e,i,n,o=!1){super(t,e,o,i);let s=this._register(n.createScoped(this.inputBox.element));this._register(P5(s,this.inputBox))}};RM=_([v(3,ke)],RM);Zt.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:X.and(X.has(A5),X.equals(mJ,!0),X.not("isComposing"),pJ.isEqualTo(!1)),primary:16,secondary:[528],handler:r=>{WT?.showPreviousValue()}});Zt.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:X.and(X.has(A5),X.equals(hJ,!0),X.not("isComposing"),pJ.isEqualTo(!1)),primary:18,secondary:[530],handler:r=>{WT?.showNextValue()}});function gJ(r){return r.lookupKeybinding("history.showPrevious")?.getElectronAccelerator()==="Up"&&r.lookupKeybinding("history.showNext")?.getElectronAccelerator()==="Down"}var fJ=new ee("menu.view.filter"),bJ=new ee("submenu.view.filter");Ct.appendMenuItem(fJ,{submenu:bJ,title:h("more filters","More Filters..."),group:"navigation",icon:B.filter});var M5=class extends Mf{_checked=!1;set checked(t){this._checked!==t&&(this._checked=t,this.updateChecked())}updateChecked(){this.element&&this.element.classList.toggle("checked",this._checked)}render(t){super.render(t),this.updateChecked()}},xI=class extends eo{constructor(e,i,n,o,s){super();this.options=e;this.instantiationService=i;this.contextViewService=n;this.keybindingService=s;this.delayedFilterUpdate=new bs(400),this._register(te(()=>this.delayedFilterUpdate.cancel())),e.focusContextKey&&(this.focusContextKey=new ie(e.focusContextKey,!1).bindTo(o)),this.element=re(".viewpane-filter"),[this.filterInputBox,this.focusTracker]=this.createInput(this.element),this._register(this.filterInputBox),this._register(this.focusTracker);let a=Ee(this.element,re(".viewpane-filter-controls"));this.filterBadge=this.createBadge(a),this.toolbar=this._register(this.createToolBar(a)),this.adjustInputBox()}element;delayedFilterUpdate;filterInputBox;filterBadge;toolbar;focusContextKey;_onDidChangeFilterText=this._register(new T);onDidChangeFilterText=this._onDidChangeFilterText.event;moreFiltersActionViewItem;isMoreFiltersChecked=!1;lastWidth;focusTracker;get onDidFocus(){return this.focusTracker.onDidFocus}get onDidBlur(){return this.focusTracker.onDidBlur}hasFocus(){return this.filterInputBox.hasFocus()}focus(){this.filterInputBox.focus()}blur(){this.filterInputBox.blur()}updateBadge(e){this.filterBadge.classList.toggle("hidden",!e),this.filterBadge.textContent=e||"",this.adjustInputBox()}setFilterText(e){this.filterInputBox.value=e}getFilterText(){return this.filterInputBox.value}getHistory(){return this.filterInputBox.getHistory()}layout(e){this.element.parentElement?.classList.toggle("grow",e>700),this.element.classList.toggle("small",e<400),this.adjustInputBox(),this.lastWidth=e}relayout(){this.lastWidth&&this.layout(this.lastWidth)}checkMoreFilters(e){this.isMoreFiltersChecked=e,this.moreFiltersActionViewItem&&(this.moreFiltersActionViewItem.checked=e)}createInput(e){let i=this._register(this.instantiationService.createInstance(TI,e,this.contextViewService,{placeholder:this.options.placeholder,ariaLabel:this.options.ariaLabel,history:this.options.history||[],showHistoryHint:()=>gJ(this.keybindingService),inputBoxStyles:xz}));this.options.text&&(i.value=this.options.text),this._register(i.onDidChange(o=>this.delayedFilterUpdate.trigger(()=>this.onDidInputChange(i)))),this._register(Wi(i.inputElement,G.KEY_DOWN,o=>this.onInputKeyDown(o,i))),this._register(Wi(e,G.KEY_DOWN,this.handleKeyboardEvent)),this._register(Wi(e,G.KEY_UP,this.handleKeyboardEvent)),this._register(Wi(i.inputElement,G.CLICK,o=>{o.stopPropagation(),o.preventDefault()}));let n=this._register(Un(i.inputElement));return this.focusContextKey&&(this._register(n.onDidFocus(()=>this.focusContextKey.set(!0))),this._register(n.onDidBlur(()=>this.focusContextKey.set(!1))),this._register(te(()=>this.focusContextKey.reset()))),[i,n]}createBadge(e){let i=Ee(e,re(".viewpane-filter-badge.hidden"));return i.style.backgroundColor=Se(ul),i.style.color=Se(Mh),i.style.border=`1px solid ${Se(Le)}`,i}createToolBar(e){return this.instantiationService.createInstance(pu,e,fJ,{hiddenItemStrategy:-1,actionViewItemProvider:(i,n)=>{if(i instanceof jn&&i.item.submenu.id===bJ.id)return this.moreFiltersActionViewItem=this.instantiationService.createInstance(M5,i,n),this.moreFiltersActionViewItem.checked=this.isMoreFiltersChecked,this.moreFiltersActionViewItem}})}onDidInputChange(e){e.addToHistory(),this._onDidChangeFilterText.fire(e.value)}adjustInputBox(){this.filterInputBox.inputElement.style.paddingRight=this.element.classList.contains("small")||this.filterBadge.classList.contains("hidden")?"25px":"150px"}handleKeyboardEvent(e){(e.equals(10)||e.equals(15)||e.equals(17)||e.equals(14)||e.equals(13))&&e.stopPropagation()}onInputKeyDown(e,i){let n=!1;e.equals(2)&&!this.toolbar.isEmpty()&&(this.toolbar.focus(),n=!0),n&&(e.stopPropagation(),e.preventDefault())}};xI=_([v(1,ae),v(2,um),v(3,ke),v(4,at)],xI);var d9t=$("accessibleViewInformationService"),PM=class extends L{constructor(e){super();this._storageService=e}hasShownAccessibleView(e){return this._storageService.getBoolean(`${g$}${e}`,-1,!1)===!0}};PM=_([v(0,tt)],PM);var OM=new ot("viewpane.action.filter"),yce=Tt("view-pane-container-expanded",B.chevronDown,h("viewPaneContainerExpandedIcon","Icon for an expanded view pane container.")),Ice=Tt("view-pane-container-collapsed",B.chevronRight,h("viewPaneContainerCollapsedIcon","Icon for a collapsed view pane container.")),vJ=Ne.as(AT.ViewsRegistry),UT=class{constructor(t,e,i,n,o,s,a){this.container=t;this.delegate=e;this.instantiationService=i;this.openerService=n;this.telemetryService=o;this.contextKeyService=s;this.disposables.add(O.runAndSubscribe(this.delegate.onDidChangeViewWelcomeState,()=>this.onDidChangeViewWelcomeState())),this.disposables.add(a.onWillShutdown(()=>this.dispose()))}defaultItem;items=[];get enabled(){return this._enabled}_enabled=!1;element;scrollableElement;disposables=new W;enabledDisposables=this.disposables.add(new W);renderDisposables=this.disposables.add(new W);layout(t,e){this._enabled&&(this.element.style.height=`${t}px`,this.element.style.width=`${e}px`,this.element.classList.toggle("wide",e>640),this.scrollableElement.scanDomNode())}focus(){this._enabled&&this.element.focus()}onDidChangeViewWelcomeState(){let t=this.delegate.shouldShowWelcome();if(this._enabled===t)return;if(this._enabled=t,!t){this.enabledDisposables.clear();return}this.container.classList.add("welcome");let e=Ee(this.container,re(".welcome-view"));this.element=re(".welcome-view-content",{tabIndex:0}),this.scrollableElement=new Rd(this.element,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3}),Ee(e,this.scrollableElement.getDomNode()),this.enabledDisposables.add(te(()=>{this.container.classList.remove("welcome"),this.scrollableElement.dispose(),e.remove(),this.scrollableElement=void 0,this.element=void 0})),this.contextKeyService.onDidChangeContext(this.onDidChangeContext,this,this.enabledDisposables),O.chain(vJ.onDidChangeViewWelcomeContent,i=>i.filter(n=>n===this.delegate.id))(this.onDidChangeViewWelcomeContent,this,this.enabledDisposables),this.onDidChangeViewWelcomeContent()}onDidChangeViewWelcomeContent(){let t=vJ.getViewWelcomeContent(this.delegate.id);this.items=[];for(let e of t)if(e.when==="default")this.defaultItem={descriptor:e,visible:!0};else{let i=e.when?this.contextKeyService.contextMatchesRules(e.when):!0;this.items.push({descriptor:e,visible:i})}this.render()}onDidChangeContext(){let t=!1;for(let e of this.items){if(!e.descriptor.when||e.descriptor.when==="default")continue;let i=this.contextKeyService.contextMatchesRules(e.descriptor.when);e.visible!==i&&(e.visible=i,t=!0)}t&&this.render()}render(){this.renderDisposables.clear(),this.element.innerText="";let t=this.getContentDescriptors();if(t.length===0){this.container.classList.remove("welcome"),this.scrollableElement.scanDomNode();return}for(let{content:e,precondition:i}of t){let n=e.split(`
`);for(let o of n){if(o=o.trim(),!o)continue;let s=bA(o);if(s.nodes.length===1&&typeof s.nodes[0]!="string"){let a=s.nodes[0],l=Ee(this.element,re(".button-container")),d=new Lp(l,{title:a.title,supportIcons:!0,...gP});if(d.label=a.label,d.onDidClick(c=>{this.telemetryService.publicLog2("views.welcomeAction",{viewId:this.delegate.id,uri:a.href}),this.openerService.open(a.href,{allowCommands:!0})},null,this.renderDisposables),this.renderDisposables.add(d),i){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(i);c();let u=new Set(i.keys());O.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(u))(c,null,this.renderDisposables)}}else{let a=Ee(this.element,re("p"));for(let l of s.nodes)if(typeof l=="string")Ee(a,document.createTextNode(l));else{let d=this.renderDisposables.add(this.instantiationService.createInstance(II,a,l,{}));if(i&&l.href.startsWith("command:")){let c=()=>d.enabled=this.contextKeyService.contextMatchesRules(i);c();let u=new Set(i.keys());O.filter(this.contextKeyService.onDidChangeContext,m=>m.affectsSome(u))(c,null,this.renderDisposables)}}}}}this.container.classList.add("welcome"),this.scrollableElement.scanDomNode()}getContentDescriptors(){let t=this.items.filter(e=>e.visible);return t.length===0&&this.defaultItem?[this.defaultItem.descriptor]:t.map(e=>e.descriptor)}dispose(){this.disposables.dispose()}};UT=_([v(2,ae),v(3,Os),v(4,qt),v(5,ke),v(6,Pn)],UT);var Vf=class extends pM{constructor(e,i,n,o,s,a,l,d,c,u,p,m){super({...e,orientation:a.getViewLocationById(e.id)===1?1:0});this.keybindingService=i;this.contextMenuService=n;this.configurationService=o;this.contextKeyService=s;this.viewDescriptorService=a;this.instantiationService=l;this.openerService=d;this.themeService=c;this.telemetryService=u;this.hoverService=p;this.accessibleViewInformationService=m;this.id=e.id,this._title=e.title,this._titleDescription=e.titleDescription,this._singleViewPaneContainerTitle=e.singleViewPaneContainerTitle,this.showActions=e.showActions??0,this.scopedContextKeyService=this._register(s.createScoped(this.element)),this.scopedContextKeyService.createKey("view",this.id);let g=this.scopedContextKeyService.createKey("viewLocation",go(a.getViewLocationById(this.id)));this._register(O.filter(a.onDidChangeLocation,b=>b.views.some(y=>y.id===this.id))(()=>g.set(go(a.getViewLocationById(this.id)))));let f=this._register(this.instantiationService.createChild(new Wr([ke,this.scopedContextKeyService])));this.menuActions=this._register(f.createInstance(Pl,e.titleMenuId??ee.ViewTitle,ee.ViewTitleContext,{shouldForwardArgs:!e.donotForwardArgs,renderShortTitle:!0})),this._register(this.menuActions.onDidChange(()=>this.updateActions()))}static AlwaysShowActionsConfig="workbench.view.alwaysShowHeaderActions";_onDidFocus=this._register(new T);onDidFocus=this._onDidFocus.event;_onDidBlur=this._register(new T);onDidBlur=this._onDidBlur.event;_onDidChangeBodyVisibility=this._register(new T);onDidChangeBodyVisibility=this._onDidChangeBodyVisibility.event;_onDidChangeTitleArea=this._register(new T);onDidChangeTitleArea=this._onDidChangeTitleArea.event;_onDidChangeViewWelcomeState=this._register(new T);onDidChangeViewWelcomeState=this._onDidChangeViewWelcomeState.event;_isVisible=!1;id;_title;get title(){return this._title}_titleDescription;get titleDescription(){return this._titleDescription}_singleViewPaneContainerTitle;get singleViewPaneContainerTitle(){return this._singleViewPaneContainerTitle}menuActions;progressBar;progressIndicator;toolbar;showActions;headerContainer;titleContainer;titleContainerHover;titleDescriptionContainer;titleDescriptionContainerHover;iconContainer;iconContainerHover;twistiesContainer;viewWelcomeController;scopedContextKeyService;get headerVisible(){return super.headerVisible}set headerVisible(e){super.headerVisible=e,this.element.classList.toggle("merged-header",!e)}setVisible(e){this._isVisible!==e&&(this._isVisible=e,this.isExpanded()&&this._onDidChangeBodyVisibility.fire(e))}isVisible(){return this._isVisible}isBodyVisible(){return this._isVisible&&this.isExpanded()}setExpanded(e){let i=super.setExpanded(e);return i&&this._onDidChangeBodyVisibility.fire(e),this.updateTwistyIcon(),i}render(){super.render();let e=Un(this.element);this._register(e),this._register(e.onDidFocus(()=>this._onDidFocus.fire())),this._register(e.onDidBlur(()=>this._onDidBlur.fire()))}renderHeader(e){this.headerContainer=e,this.twistiesContainer=Ee(e,re(`.twisty-container${ye.asCSSSelector(this.getTwistyIcon(this.isExpanded()))}`)),this.renderHeaderTitle(e,this.title);let i=Ee(e,re(".actions"));i.classList.toggle("show-always",this.showActions===2),i.classList.toggle("show-expanded",this.showActions===1),this.toolbar=this.instantiationService.createInstance(pr,i,{orientation:0,actionViewItemProvider:(s,a)=>this.getActionViewItem(s,a),ariaLabel:h("viewToolbarAriaLabel","{0} actions",this.title),getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id),renderDropdownAsChildElement:!0,actionRunner:this.getActionRunner(),resetMenu:this.menuActions.menuId}),this._register(this.toolbar),this.setActions(),this._register(M(i,G.CLICK,s=>s.preventDefault()));let n=this.viewDescriptorService.getViewContainerByViewId(this.id);n?this._register(this.viewDescriptorService.getViewContainerModel(n).onDidChangeContainerInfo(({title:s})=>this.updateTitle(this.title))):console.error(`View container model not found for view ${this.id}`);let o=O.filter(this.configurationService.onDidChangeConfiguration,s=>s.affectsConfiguration(Vf.AlwaysShowActionsConfig));this._register(o(this.updateActionsVisibility,this)),this.updateActionsVisibility()}updateHeader(){super.updateHeader(),this.updateTwistyIcon()}updateTwistyIcon(){this.twistiesContainer&&(this.twistiesContainer.classList.remove(...ye.asClassNameArray(this.getTwistyIcon(!this._expanded))),this.twistiesContainer.classList.add(...ye.asClassNameArray(this.getTwistyIcon(this._expanded))))}getTwistyIcon(e){return e?yce:Ice}style(e){super.style(e);let i=this.getIcon();if(this.iconContainer){let n=Is(e.headerForeground,Se(li));q.isUri(i)?(this.iconContainer.style.backgroundColor=n,this.iconContainer.style.color=""):(this.iconContainer.style.color=n,this.iconContainer.style.backgroundColor="")}}getIcon(){return this.viewDescriptorService.getViewDescriptorById(this.id)?.containerIcon||GQ}renderHeaderTitle(e,i){this.iconContainer=Ee(e,re(".icon",void 0));let n=this.getIcon(),o;if(q.isUri(n)){o=`view-${this.id.replace(/[\.\:]/g,"-")}`;let a=`.pane-header .icon.${o}`;Zw(a,`
				mask: ${vl(n)} no-repeat 50% 50%;
				mask-size: 24px;
				-webkit-mask: ${vl(n)} no-repeat 50% 50%;
				-webkit-mask-size: 16px;
			`)}else ye.isThemeIcon(n)&&(o=ye.asClassName(n));o&&this.iconContainer.classList.add(...o.split(" "));let s=this.calculateTitle(i);this.titleContainer=Ee(e,re("h3.title",{},s)),this.titleContainerHover=this._register(this.hoverService.setupManagedHover(zt("mouse"),this.titleContainer,s)),this._titleDescription&&this.setTitleDescription(this._titleDescription),this.iconContainerHover=this._register(this.hoverService.setupManagedHover(zt("mouse"),this.iconContainer,s)),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(s))}_getAriaLabel(e){let i=this.viewDescriptorService.getViewDescriptorById(this.id)?.accessibilityHelpContent,n=this.accessibleViewInformationService?.hasShownAccessibleView(this.id);return!i||n?e:h("viewAccessibilityHelp","Use Alt+F1 for accessibility help {0}",e)}updateTitle(e){let i=this.calculateTitle(e);this.titleContainer&&(this.titleContainer.textContent=i,this.titleContainerHover?.update(i)),this.iconContainer&&(this.iconContainerHover?.update(i),this.iconContainer.setAttribute("aria-label",this._getAriaLabel(i))),this._title=e,this._onDidChangeTitleArea.fire()}setTitleDescription(e){this.titleDescriptionContainer?(this.titleDescriptionContainer.textContent=e??"",this.titleDescriptionContainerHover?.update(e??"")):e&&this.titleContainer&&(this.titleDescriptionContainer=dk(this.titleContainer,re("span.description",{},e)),this.titleDescriptionContainerHover=this._register(this.hoverService.setupManagedHover(zt("mouse"),this.titleDescriptionContainer,e)))}updateTitleDescription(e){this.setTitleDescription(e),this._titleDescription=e,this._onDidChangeTitleArea.fire()}calculateTitle(e){let i=this.viewDescriptorService.getViewContainerByViewId(this.id),n=this.viewDescriptorService.getViewContainerModel(i),o=this.viewDescriptorService.getViewDescriptorById(this.id);return!(this.viewDescriptorService.getDefaultContainerById(this.id)===i)&&o?.containerTitle&&n.title!==o.containerTitle?`${o.containerTitle}: ${e}`:e}renderBody(e){this.viewWelcomeController=this._register(this.instantiationService.createInstance(UT,e,this))}layoutBody(e,i){this.viewWelcomeController.layout(e,i)}onDidScrollRoot(){}getProgressIndicator(){if(this.progressBar===void 0&&(this.progressBar=this._register(new pm(this.element,eI)),this.progressBar.hide()),this.progressIndicator===void 0){let e=this;this.progressIndicator=this._register(new CI(Ue(this.progressBar),new class extends SI{constructor(){super(e.id,e.isBodyVisible()),this._register(e.onDidChangeBodyVisibility(i=>i?this.onScopeOpened(e.id):this.onScopeClosed(e.id)))}}))}return this.progressIndicator}getProgressLocation(){return this.viewDescriptorService.getViewContainerByViewId(this.id).id}getLocationBasedColors(){return Cce(this.viewDescriptorService.getViewLocationById(this.id))}focus(){this.viewWelcomeController.enabled?this.viewWelcomeController.focus():this.element&&(this.element.focus(),this._onDidFocus.fire())}setActions(){if(this.toolbar){let e=[...this.menuActions.getPrimaryActions()];this.shouldShowFilterInHeader()&&e.unshift(OM),this.toolbar.setActions(Or(e),Or(this.menuActions.getSecondaryActions())),this.toolbar.context=this.getActionsContext()}}updateActionsVisibility(){if(!this.headerContainer)return;let e=this.configurationService.getValue("workbench.view.alwaysShowHeaderActions");this.headerContainer.classList.toggle("actions-always-visible",e)}updateActions(){this.setActions(),this._onDidChangeTitleArea.fire()}getActionViewItem(e,i){if(e.id===OM.id){let n=this;return new class extends zn{constructor(){super(null,e)}setFocusable(){}get trapsArrowNavigation(){return!0}render(o){o.classList.add("viewpane-filter-container");let s=n.getFilterWidget();Ee(o,s.element),s.relayout()}}}return ja(this.instantiationService,e,{...i,menuAsChild:e instanceof jn})}getActionsContext(){}getActionRunner(){}getOptimalWidth(){return 0}saveState(){}shouldShowWelcome(){return!1}getFilterWidget(){}shouldShowFilterInHeader(){return!1}};Vf=_([v(1,at),v(2,Mt),v(3,de),v(4,ke),v(5,zi),v(6,ae),v(7,Os),v(8,Ze),v(9,qt),v(10,qi)],Vf);var MM=class extends Vf{filterWidget;dimension;filterContainer;constructor(t,e,i,n,o,s,a,l,d,c,u,p){super(t,e,i,n,o,s,a,l,d,c,u,p);let m=this._register(a.createChild(new Wr([ke,this.scopedContextKeyService])));this.filterWidget=this._register(m.createInstance(xI,t.filterOptions))}getFilterWidget(){return this.filterWidget}renderBody(t){super.renderBody(t),this.filterContainer=Ee(t,re(".viewpane-filter-container"))}layoutBody(t,e){super.layoutBody(t,e),this.dimension=new dt(e,t);let i=!this.filterContainer?.hasChildNodes(),n=this.shouldShowFilterInHeader();i!==n&&(n&&Tn(this.filterContainer),this.updateActions(),n||Ee(this.filterContainer,this.filterWidget.element)),n||(t=t-44),this.filterWidget.layout(e),this.layoutBodyContent(t,e)}shouldShowFilterInHeader(){return!(this.dimension&&this.dimension.width<600&&this.dimension.height>100)}};MM=_([v(1,at),v(2,Mt),v(3,de),v(4,ke),v(5,zi),v(6,ae),v(7,Os),v(8,Ze),v(9,qt),v(10,qi)],MM);function Cce(r){let t,e,i,n;switch(r){case 1:t=Fg,e=zq,i=Kq,n=Gq;break;case 0:case 2:default:t=gl,e=aj,i=lj,n=dj}return{background:t,listOverrideStyles:{listBackground:t,treeStickyScrollBackground:e,treeStickyScrollBorder:i,treeStickyScrollShadow:n}}}var NM="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",z7t=new RegExp(NM);var K7t=$("extensionGalleryService");var G7t=$("extensionManagementService");var q7t=$("IGlobalExtensionEnablementService"),j7t=$("IExtensionTipsService"),$7t=pe("extensions","Extensions"),Y7t=pe("preferences","Preferences");var O5=class{telemetryLevel=0;sessionId="someValue.sessionId";machineId="someValue.machineId";sqmId="someValue.sqmId";devDeviceId="someValue.devDeviceId";firstSessionDate="someValue.firstSessionDate";sendErrorTelemetry=!1;publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},EGt=new O5;function IJ(r){let t=r.getValue(iZ),e=r.getValue(nZ);if(r.getValue(oZ)===!1||e===!1)return 0;switch(t??"all"){case"all":return 3;case"error":return 2;case"crash":return 1;case"off":return 0}}var GGt=new Ba("pprice.better-merge");var N5=class{_generators=new Map;_cache=new WeakMap;register(t,e){this._generators.set(t,e)}readActivationEvents(t){return this._cache.has(t)||this._cache.set(t,this._readActivationEvents(t)),this._cache.get(t)}createActivationEventsMap(t){let e=Object.create(null);for(let i of t){let n=this.readActivationEvents(i);n.length>0&&(e[Ba.toKey(i.identifier)]=n)}return e}_readActivationEvents(t){if(typeof t.main>"u"&&typeof t.browser>"u")return[];let e=Array.isArray(t.activationEvents)?t.activationEvents.slice(0):[];for(let i=0;i<e.length;i++)e[i]==="onUri"&&(e[i]=`onUri:${Ba.toKey(t.identifier)}`);if(!t.contributes)return e;for(let i in t.contributes){let n=this._generators.get(i);if(!n)continue;let o=t.contributes[i],s=Array.isArray(o)?o:[o];try{n(s,e)}catch(a){Ke(a)}}return e}},F5=new N5;var Tce={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts"},aiTextSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProviderNew.d.ts"},attributableCoverage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.attributableCoverage.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:2},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},chatVariableResolver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribChatParticipantDetection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribChatParticipantDetection.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribIssueReporter:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},createFileSystemWatcher:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},documentPaste:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileComments:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProviderNew.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts"},findFiles2New:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2New.d.ts"},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFilesNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFilesNew.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},lmTools:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.lmTools.d.ts",version:6},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},showLocal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textSearchCompleteNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchCompleteNew.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProviderNew.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},HT=Object.freeze(Tce);var e3t=$("IV8InspectProfilingService"),xce;(e=>{function r(i){return!!(i.samples&&i.timeDeltas)}e.isValidProfile=r;function t(i,n="noAbsolutePaths"){for(let o of i.nodes)o.callFrame&&o.callFrame.url&&(cg(o.callFrame.url)||/^\w[\w\d+.-]*:\/\/\/?/.test(o.callFrame.url))&&(o.callFrame.url=fs(n,ah(o.callFrame.url)));return i}e.rewriteAbsolutePaths=t})(xce||={});var H5=Ne.as(nd.JSONContribution);var B5=class r{constructor(t,e){this.added=t;this.removed=e}static _toSet(t){let e=new rE;for(let i=0,n=t.length;i<n;i++)e.add(t[i].description.identifier);return e}static compute(t,e){if(!t||!t.length)return new r(e,[]);if(!e||!e.length)return new r([],t);let i=this._toSet(t),n=this._toSet(e),o=e.filter(a=>!i.has(a.description.identifier)),s=t.filter(a=>!n.has(a.description.identifier));return new r(o,s)}},V5=class{name;defaultExtensionKind;_handler;_users;_delta;constructor(t,e){this.name=t,this.defaultExtensionKind=e,this._handler=null,this._users=null,this._delta=null}setHandler(t){if(this._handler!==null)throw new Error("Handler already set!");return this._handler=t,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(t){this._delta=B5.compute(this._users,t),this._users=t,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(t){Ke(t)}}},_ce={type:"string",enum:["ui","workspace"],enumDescriptions:[h("ui","UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h("workspace","Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]},CJ="vscode://schemas/vscode-extensions",W5={properties:{engines:{type:"object",description:h("vscode.extension.engines","Engine compatibility."),properties:{vscode:{type:"string",description:h("vscode.extension.engines.vscode","For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h("vscode.extension.publisher","The publisher of the VS Code extension."),type:"string"},displayName:{description:h("vscode.extension.displayName","The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h("vscode.extension.categories","The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:_$},{type:"string",const:"Languages",deprecationMessage:h("vscode.extension.category.languages.deprecated","Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h("vscode.extension.galleryBanner","Banner used in the VS Code marketplace."),properties:{color:{description:h("vscode.extension.galleryBanner.color","The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h("vscode.extension.galleryBanner.theme","The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h("vscode.extension.contributes","All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h("vscode.extension.preview","Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h("vscode.extension.enableProposedApi.deprecated","Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h("vscode.extension.enabledApiProposals","Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(HT).map(r=>r),markdownEnumDescriptions:Object.values(HT).map(r=>r.proposal)}},api:{markdownDescription:h("vscode.extension.api","Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h("vscode.extension.api.none","Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h("vscode.extension.activationEvents","Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h("vscode.extension.activationEvents.onWebviewPanel","An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h("vscode.extension.activationEvents.onLanguage","An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h("vscode.extension.activationEvents.onCommand","An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h("vscode.extension.activationEvents.onDebug","An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h("vscode.extension.activationEvents.onDebugInitialConfigurations",'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h("vscode.extension.activationEvents.onDebugDynamicConfigurations",'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h("vscode.extension.activationEvents.onDebugResolve","An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h("vscode.extension.activationEvents.onDebugAdapterProtocolTracker","An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h("vscode.extension.activationEvents.workspaceContains","An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h("vscode.extension.activationEvents.onStartupFinished","An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h("vscode.extension.activationEvents.onTaskType","An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h("vscode.extension.activationEvents.onFileSystem","An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h("vscode.extension.activationEvents.onEditSession","An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h("vscode.extension.activationEvents.onSearch","An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h("vscode.extension.activationEvents.onView","An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h("vscode.extension.activationEvents.onUri","An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h("vscode.extension.activationEvents.onOpenExternalUri","An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h("vscode.extension.activationEvents.onCustomEditor","An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h("vscode.extension.activationEvents.onNotebook","An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h("vscode.extension.activationEvents.onAuthenticationRequest","An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h("vscode.extension.activationEvents.onRenderer","An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h("vscode.extension.activationEvents.onTerminalProfile","An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h("vscode.extension.activationEvents.onTerminalQuickFixRequest","An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h("vscode.extension.activationEvents.onWalkthrough","An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h("vscode.extension.activationEvents.onIssueReporterOpened","An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h("vscode.extension.activationEvents.onChatParticipant","An activation event emitted when the specified chat participant is invoked.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:h("vscode.extension.activationEvents.onLanguageModelTool","An activation event emitted when the specified language model tool is invoked.")},{label:"*",description:h("vscode.extension.activationEvents.star","An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h("vscode.extension.badges","Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h("vscode.extension.badges.url","Badge image URL.")},href:{type:"string",description:h("vscode.extension.badges.href","Badge link.")},description:{type:"string",description:h("vscode.extension.badges.description","Badge description.")}}}},markdown:{type:"string",description:h("vscode.extension.markdown","Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h("vscode.extension.qna","Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:h("vscode.extension.extensionDependencies","Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:NM}},extensionPack:{description:h("vscode.extension.contributes.extensionPack","A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:NM}},extensionKind:{description:h("extensionKind","Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:_ce,default:["workspace"],defaultSnippets:[{body:["ui"],description:h("extensionKind.ui","Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h("extensionKind.workspace","Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h("extensionKind.ui-workspace","Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h("extensionKind.workspace-ui","Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h("extensionKind.empty","Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h("vscode.extension.capabilities","Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h("vscode.extension.capabilities.virtualWorkspaces","Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:h("vscode.extension.capabilities.virtualWorkspaces.supported","Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h("vscode.extension.capabilities.virtualWorkspaces.supported.limited","The extension will be enabled in virtual workspaces with some functionality disabled."),h("vscode.extension.capabilities.virtualWorkspaces.supported.true","The extension will be enabled in virtual workspaces with all functionality enabled."),h("vscode.extension.capabilities.virtualWorkspaces.supported.false","The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h("vscode.extension.capabilities.virtualWorkspaces.description","A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h("vscode.extension.capabilities.untrustedWorkspaces","Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h("vscode.extension.capabilities.untrustedWorkspaces.supported","Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h("vscode.extension.capabilities.untrustedWorkspaces.supported.limited","The extension will be enabled in untrusted workspaces with some functionality disabled."),h("vscode.extension.capabilities.untrustedWorkspaces.supported.true","The extension will be enabled in untrusted workspaces with all functionality enabled."),h("vscode.extension.capabilities.untrustedWorkspaces.supported.false","The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h("vscode.extension.capabilities.untrustedWorkspaces.restrictedConfigurations","A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h("vscode.extension.capabilities.untrustedWorkspaces.description","A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h("vscode.extension.contributes.sponsor","Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:h("vscode.extension.contributes.sponsor.url","URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h("vscode.extension.scripts.prepublish","Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h("vscode.extension.scripts.uninstall","Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h("vscode.extension.icon","The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h({key:"vscode.extension.l10n",comment:['{Locked="bundle.l10n._locale_.json"}','{Locked="vscode.l10n API"}']},"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h("vscode.extension.pricing","The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}},U5=class{_extensionPoints=new Map;registerExtensionPoint(t){if(this._extensionPoints.has(t.extensionPoint))throw new Error("Duplicate extension point: "+t.extensionPoint);let e=new V5(t.extensionPoint,t.defaultExtensionKind);return this._extensionPoints.set(t.extensionPoint,e),t.activationEventsGenerator&&F5.register(t.extensionPoint,t.activationEventsGenerator),W5.properties.contributes.properties[t.extensionPoint]=t.jsonSchema,H5.registerSchema(CJ,W5),e}getExtensionPoints(){return Array.from(this._extensionPoints.values())}},SJ={ExtensionsRegistry:"ExtensionsRegistry"};Ne.add(SJ.ExtensionsRegistry,new U5);var K3t=Ne.as(SJ.ExtensionsRegistry);H5.registerSchema(CJ,W5);H5.registerSchema(cZ,{properties:{extensionEnabledApiProposals:{description:h("product.extensionEnabledApiProposals","API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(HT),markdownEnumDescriptions:Object.values(HT).map(r=>r.proposal)}}]}}}});var S6t=Object.freeze({identifier:new Ba("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:q.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1});var xn=$("extensionService");var FM=class extends _I{constantViewDescriptors=new Map;allViews=new Map;filterValue;constructor(t,e,i,n,o,s,a,l,d,c,u,p){super(t,{mergeViewWithContainerWhenSingleView:!1},a,i,n,d,o,c,l,s,u,p),this._register(e(m=>{this.filterValue=m,this.onFilterChanged(m)})),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>{this.updateAllViews(this.viewContainerModel.activeViewDescriptors)}))}updateAllViews(t){t.forEach(e=>{let i=this.getFilterOn(e);i&&(this.allViews.has(i)||this.allViews.set(i,new Map),this.allViews.get(i).set(e.id,e),this.filterValue&&!this.filterValue.includes(i)&&this.panes.find(n=>n.id===e.id)&&this.viewContainerModel.setVisible(e.id,!1))})}addConstantViewDescriptors(t){t.forEach(e=>this.constantViewDescriptors.set(e.id,e))}onFilterChanged(t){this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),this.getViewsNotForTarget(t).forEach(e=>this.viewContainerModel.setVisible(e.id,!1)),this.getViewsForTarget(t).forEach(e=>this.viewContainerModel.setVisible(e.id,!0))}getViewsForTarget(t){let e=[];for(let i=0;i<t.length;i++)this.allViews.has(t[i])&&e.push(...Array.from(this.allViews.get(t[i]).values()));return e}getViewsNotForTarget(t){let e=this.allViews.keys(),i=e.next(),n=[];for(;!i.done;){let o=!1;t.forEach(s=>{i.value===s&&(o=!0)}),o||(n=n.concat(this.getViewsForTarget([i.value]))),i=e.next()}return n}onDidAddViewDescriptors(t){let e=super.onDidAddViewDescriptors(t);for(let i=0;i<t.length;i++)this.constantViewDescriptors.has(t[i].viewDescriptor.id)&&e[i].setExpanded(!1);return this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),e}openView(t,e){let i=super.openView(t,e);if(i){let n=Array.from(this.allViews.entries()).find(o=>o[1].has(t));n&&!this.filterValue?.includes(n[0])&&this.setFilter(n[1].get(t))}return i}};FM=_([v(2,de),v(3,Qe),v(4,qt),v(5,tt),v(6,ae),v(7,Ze),v(8,Mt),v(9,xn),v(10,Xt),v(11,zi)],FM);var KT=new ee("Views");Ct.appendMenuItem(ee.ViewContainerTitle,{submenu:KT,title:h("views","Views"),order:1});var DI=class r extends ia{constructor(e,i,n,o,s){super(s);this.paneElement=e;this.orientation=i;this.bounds=n;this.location=o;this.cleanupOverlayScheduler=this._register(new Et(()=>this.dispose(),300)),this.create()}static OVERLAY_ID="monaco-pane-drop-overlay";container;overlay;_currentDropOperation;_disposed;cleanupOverlayScheduler;get currentDropOperation(){return this._currentDropOperation}get disposed(){return!!this._disposed}create(){this.container=document.createElement("div"),this.container.id=r.OVERLAY_ID,this.container.style.top="0px",this.paneElement.appendChild(this.container),this.paneElement.classList.add("dragged-over"),this._register(te(()=>{this.container.remove(),this.paneElement.classList.remove("dragged-over")})),this.overlay=document.createElement("div"),this.overlay.classList.add("pane-overlay-indicator"),this.container.appendChild(this.overlay),this.registerListeners(),this.updateStyles()}updateStyles(){this.overlay.style.backgroundColor=this.getColor(this.location===1?OV:Vw)||"";let e=this.getColor(oi);this.overlay.style.outlineColor=e||"",this.overlay.style.outlineOffset=e?"-2px":"",this.overlay.style.outlineStyle=e?"dashed":"",this.overlay.style.outlineWidth=e?"2px":"",this.overlay.style.borderColor=e||"",this.overlay.style.borderStyle="solid",this.overlay.style.borderWidth="0px"}registerListeners(){this._register(new ra(this.container,{onDragOver:e=>{this.positionOverlay(e.offsetX,e.offsetY),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:e=>this.dispose(),onDragEnd:e=>this.dispose(),onDrop:e=>{this.dispose()}})),this._register(M(this.container,G.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}positionOverlay(e,i){let n=this.paneElement.clientWidth,o=this.paneElement.clientHeight,s=n/2,a=o/2,l;switch(this.orientation===0?i<a?l=0:i>=a&&(l=1):this.orientation===1&&(e<s?l=2:e>=s&&(l=3)),l){case 0:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"});break;case 1:this.doPositionOverlay({bottom:"0",left:"0",width:"100%",height:"50%"});break;case 2:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"});break;case 3:this.doPositionOverlay({top:"0",right:"0",width:"50%",height:"100%"});break;default:{let d="0",c="0",u="100%",p="100%";if(this.bounds){let m=this.container.getBoundingClientRect();d=`${this.bounds.top-m.top}px`,c=`${this.bounds.left-m.left}px`,p=`${this.bounds.bottom-this.bounds.top}px`,u=`${this.bounds.right-this.bounds.left}px`}this.doPositionOverlay({top:d,left:c,width:u,height:p})}}this.orientation===0&&o<=25||this.orientation===1&&n<=25?this.doUpdateOverlayBorder(l):this.doUpdateOverlayBorder(void 0),this.overlay.style.opacity="1",setTimeout(()=>this.overlay.classList.add("overlay-move-transition"),0),this._currentDropOperation=l}doUpdateOverlayBorder(e){this.overlay.style.borderTopWidth=e===0?"2px":"0px",this.overlay.style.borderLeftWidth=e===2?"2px":"0px",this.overlay.style.borderBottomWidth=e===1?"2px":"0px",this.overlay.style.borderRightWidth=e===3?"2px":"0px"}doPositionOverlay(e){this.container.style.height="100%",this.overlay.style.top=e.top||"",this.overlay.style.left=e.left||"",this.overlay.style.bottom=e.bottom||"",this.overlay.style.right=e.right||"",this.overlay.style.width=e.width,this.overlay.style.height=e.height}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}},zT=class extends Pl{constructor(t,e,i,n,o){let s=n.createScoped(t);s.createKey("viewContainer",e.id);let a=s.createKey("viewContainerLocation",go(i.getViewContainerLocation(e)));super(ee.ViewContainerTitle,ee.ViewContainerTitleContext,{shouldForwardArgs:!0,renderShortTitle:!0},s,o),this._register(s),this._register(O.filter(i.onDidChangeContainerLocation,l=>l.viewContainer===e)(()=>a.set(go(i.getViewContainerLocation(e)))))}};zT=_([v(2,zi),v(3,ke),v(4,Ri)],zT);var _I=class extends _p{constructor(e,i,n,o,s,a,l,d,c,u,p,m){super(e,c,u);this.options=i;this.instantiationService=n;this.configurationService=o;this.layoutService=s;this.contextMenuService=a;this.telemetryService=l;this.extensionService=d;this.storageService=u;this.contextService=p;this.viewDescriptorService=m;let g=this.viewDescriptorService.getViewContainerById(e);if(!g)throw new Error("Could not find container");this.viewContainer=g,this.visibleViewsStorageId=`${e}.numberOfVisibleViews`,this.visibleViewsCountFromCache=this.storageService.getNumber(this.visibleViewsStorageId,1,void 0),this.viewContainerModel=this.viewDescriptorService.getViewContainerModel(g)}viewContainer;lastFocusedPane;lastMergedCollapsedPane;paneItems=[];paneview;visible=!1;areExtensionsReady=!1;didLayout=!1;dimension;_boundarySashes;visibleViewsCountFromCache;visibleViewsStorageId;viewContainerModel;_onTitleAreaUpdate=this._register(new T);onTitleAreaUpdate=this._onTitleAreaUpdate.event;_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;_onDidAddViews=this._register(new T);onDidAddViews=this._onDidAddViews.event;_onDidRemoveViews=this._register(new T);onDidRemoveViews=this._onDidRemoveViews.event;_onDidChangeViewVisibility=this._register(new T);onDidChangeViewVisibility=this._onDidChangeViewVisibility.event;_onDidFocusView=this._register(new T);onDidFocusView=this._onDidFocusView.event;_onDidBlurView=this._register(new T);onDidBlurView=this._onDidBlurView.event;get onDidSashChange(){return Ue(this.paneview).onDidSashChange}get panes(){return this.paneItems.map(e=>e.pane)}get views(){return this.panes}get length(){return this.paneItems.length}_menuActions;get menuActions(){return this._menuActions}create(e){let i=this.options;i.orientation=this.orientation,this.paneview=this._register(new hM(e,this.options)),this._boundarySashes&&this.paneview.setBoundarySashes(this._boundarySashes),this._register(this.paneview.onDidDrop(({from:d,to:c})=>this.movePane(d,c))),this._register(this.paneview.onDidScroll(d=>this.onDidScrollPane())),this._register(this.paneview.onDidSashReset(d=>this.onDidSashReset(d))),this._register(M(e,G.CONTEXT_MENU,d=>this.showContextMenu(new ri(oe(e),d)))),this._register(Wt.addTarget(e)),this._register(M(e,it.Contextmenu,d=>this.showContextMenu(new ri(oe(e),d)))),this._menuActions=this._register(this.instantiationService.createInstance(zT,this.paneview.element,this.viewContainer)),this._register(this._menuActions.onDidChange(()=>this.updateTitleArea()));let n,o=()=>{let d=e.getBoundingClientRect(),c=this.panes[this.panes.length-1].element.getBoundingClientRect(),u=this.orientation===0?c.bottom:d.top,p=this.orientation===1?c.right:d.left;return{top:u,bottom:d.bottom,left:p,right:d.right}},s=(d,c)=>c.x>=d.left&&c.x<=d.right&&c.y>=d.top&&c.y<=d.bottom,a;this._register(Xa.INSTANCE.registerTarget(e,{onDragEnter:d=>{if(a=o(),n&&n.disposed&&(n=void 0),!n&&s(a,d.eventData)){let c=d.dragAndDropData.getData();if(c.type==="view"){let u=this.viewDescriptorService.getViewContainerByViewId(c.id),p=this.viewDescriptorService.getViewDescriptorById(c.id);if(u!==this.viewContainer&&(!p||!p.canMoveView||this.viewContainer.rejectAddedViews))return;n=new DI(e,void 0,a,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService)}if(c.type==="composite"&&c.id!==this.viewContainer.id){let u=this.viewDescriptorService.getViewContainerById(c.id),p=this.viewDescriptorService.getViewContainerModel(u).allViewDescriptors;!p.some(m=>!m.canMoveView)&&p.length>0&&(n=new DI(e,void 0,a,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService))}}},onDragOver:d=>{n&&n.disposed&&(n=void 0),n&&!s(a,d.eventData)&&(n.dispose(),n=void 0),s(a,d.eventData)&&Op(d.eventData.dataTransfer,"move",n!==void 0)},onDragLeave:d=>{n?.dispose(),n=void 0},onDrop:d=>{if(n){let c=d.dragAndDropData.getData(),u=[];if(c.type==="composite"&&c.id!==this.viewContainer.id){let m=this.viewDescriptorService.getViewContainerById(c.id),g=this.viewDescriptorService.getViewContainerModel(m).allViewDescriptors;g.some(f=>!f.canMoveView)||u.push(...g)}else if(c.type==="view"){let m=this.viewDescriptorService.getViewContainerByViewId(c.id),g=this.viewDescriptorService.getViewDescriptorById(c.id);m!==this.viewContainer&&g&&g.canMoveView&&this.viewDescriptorService.moveViewsToContainer([g],this.viewContainer,void 0,"dnd")}let p=this.panes.length;if(u.length>0&&this.viewDescriptorService.moveViewsToContainer(u,this.viewContainer,void 0,"dnd"),p>0)for(let m of u){let g=this.panes.find(f=>f.id===m.id);g&&this.movePane(g,this.panes[this.panes.length-1])}}n?.dispose(),n=void 0}})),this._register(this.onDidSashChange(()=>this.saveViewSizes())),this._register(this.viewContainerModel.onDidAddVisibleViewDescriptors(d=>this.onDidAddViewDescriptors(d))),this._register(this.viewContainerModel.onDidRemoveVisibleViewDescriptors(d=>this.onDidRemoveViewDescriptors(d)));let l=this.viewContainerModel.visibleViewDescriptors.map((d,c)=>{let u=this.viewContainerModel.getSize(d.id),p=this.viewContainerModel.isCollapsed(d.id);return{viewDescriptor:d,index:c,size:u,collapsed:p}});l.length&&this.onDidAddViewDescriptors(l),this.extensionService.whenInstalledExtensionsRegistered().then(()=>{this.areExtensionsReady=!0,this.panes.length&&(this.updateTitleArea(),this.updateViewHeaders()),this._register(this.configurationService.onDidChangeConfiguration(d=>{d.affectsConfiguration("workbench.activityBar.location")&&this.updateViewHeaders()}))}),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>this._onTitleAreaUpdate.fire()))}getTitle(){let e=this.viewContainerModel.title;if(this.isViewMergedWithContainer()){let i=this.paneItems[0].pane.singleViewPaneContainerTitle;if(i)return i;let n=this.paneItems[0].pane.title;return e===n?n:n?`${e}: ${n}`:e}return e}showContextMenu(e){for(let i of this.paneItems)if(Xi(e.target,i.pane.element))return;e.stopPropagation(),e.preventDefault(),this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>this.menuActions?.getContextMenuActions()??[]})}getActionsContext(){if(this.isViewMergedWithContainer())return this.panes[0].getActionsContext()}getActionViewItem(e,i){return this.isViewMergedWithContainer()?this.paneItems[0].pane.getActionViewItem(e,i):ja(this.instantiationService,e,i)}focus(){let e;if(this.lastFocusedPane)e=this.lastFocusedPane;else if(this.paneItems.length>0){for(let{pane:i}of this.paneItems)if(i.isExpanded()){e=i;break}}e&&e.focus()}get orientation(){switch(this.viewDescriptorService.getViewContainerLocation(this.viewContainer)){case 0:case 2:return 0;case 1:return ho(this.layoutService.getPanelPosition())?1:0}return 0}layout(e){this.paneview&&(this.paneview.orientation!==this.orientation&&this.paneview.flipOrientation(e.height,e.width),this.paneview.layout(e.height,e.width)),this.dimension=e,this.didLayout?this.saveViewSizes():(this.didLayout=!0,this.restoreViewSizes())}setBoundarySashes(e){this._boundarySashes=e,this.paneview?.setBoundarySashes(e)}getOptimalWidth(){return Math.max(...this.panes.map(n=>n.getOptimalWidth()||0))+16}addPanes(e){let i=this.isViewMergedWithContainer();for(let{pane:n,size:o,index:s,disposable:a}of e)this.addPane(n,o,a,s);this.updateViewHeaders(),this.isViewMergedWithContainer()!==i&&this.updateTitleArea(),this._onDidAddViews.fire(e.map(({pane:n})=>n))}setVisible(e){this.visible!==!!e&&(this.visible=e,this._onDidChangeVisibility.fire(e)),this.panes.filter(i=>i.isVisible()!==e).map(i=>i.setVisible(e))}isVisible(){return this.visible}updateTitleArea(){this._onTitleAreaUpdate.fire()}createView(e,i){return this.instantiationService.createInstance(e.ctorDescriptor.ctor,...e.ctorDescriptor.staticArguments||[],i)}getView(e){return this.panes.filter(i=>i.id===e)[0]}saveViewSizes(){this.didLayout&&this.viewContainerModel.setSizes(this.panes.map(e=>({id:e.id,size:this.getPaneSize(e)})))}restoreViewSizes(){if(this.didLayout){let e;for(let i=0;i<this.viewContainerModel.visibleViewDescriptors.length;i++){let n=this.panes[i],o=this.viewContainerModel.visibleViewDescriptors[i],s=this.viewContainerModel.getSize(o.id);typeof s=="number"?this.resizePane(n,s):(e=e||this.computeInitialSizes(),this.resizePane(n,e.get(n.id)||200))}}}computeInitialSizes(){let e=new Map;if(this.dimension){let i=this.viewContainerModel.visibleViewDescriptors.reduce((n,{weight:o})=>n+(o||20),0);for(let n of this.viewContainerModel.visibleViewDescriptors)this.orientation===0?e.set(n.id,this.dimension.height*(n.weight||20)/i):e.set(n.id,this.dimension.width*(n.weight||20)/i)}return e}saveState(){this.panes.forEach(e=>e.saveState()),this.storageService.store(this.visibleViewsStorageId,this.length,1,1)}onContextMenu(e,i){e.stopPropagation(),e.preventDefault();let n=i.menuActions.getContextMenuActions();this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>n})}openView(e,i){let n=this.getView(e);return n||this.toggleViewVisibility(e),n=this.getView(e),n&&(n.setExpanded(!0),i&&n.focus()),n}onDidAddViewDescriptors(e){let i=[];for(let{viewDescriptor:o,collapsed:s,index:a,size:l}of e){let d=this.createView(o,{id:o.id,title:o.name.value,fromExtensionId:o.extensionId,expanded:!s,singleViewPaneContainerTitle:o.singleViewPaneContainerTitle});d.render();let c=M(d.draggableElement,"contextmenu",p=>{p.stopPropagation(),p.preventDefault(),this.onContextMenu(new ri(oe(d.draggableElement),p),d)}),u=O.latch(O.map(d.onDidChange,()=>!d.isExpanded()))(p=>{this.viewContainerModel.setCollapsed(o.id,p)});i.push({pane:d,size:l||d.minimumSize,index:a,disposable:Ln(c,u)})}this.addPanes(i),this.restoreViewSizes();let n=[];for(let{pane:o}of i)o.setVisible(this.isVisible()),n.push(o);return n}onDidRemoveViewDescriptors(e){e=e.sort((n,o)=>o.index-n.index);let i=[];for(let{index:n}of e)this.paneItems[n]&&i.push(this.paneItems[n].pane);if(i.length){this.removePanes(i);for(let n of i)n.setVisible(!1)}}toggleViewVisibility(e){if(this.viewContainerModel.activeViewDescriptors.some(i=>i.id===e)){let i=!this.viewContainerModel.isVisible(e);this.viewContainerModel.setVisible(e,i)}}addPane(e,i,n,o=this.paneItems.length-1){let s=e.onDidFocus(()=>{this._onDidFocusView.fire(e),this.lastFocusedPane=e}),a=e.onDidBlur(()=>this._onDidBlurView.fire(e)),l=e.onDidChangeTitleArea(()=>{this.isViewMergedWithContainer()&&this.updateTitleArea()}),d=e.onDidChangeBodyVisibility(()=>this._onDidChangeViewVisibility.fire(e)),c=e.onDidChange(()=>{e===this.lastFocusedPane&&!e.isExpanded()&&(this.lastFocusedPane=void 0)}),u=this.viewDescriptorService.getViewContainerLocation(this.viewContainer)===1;e.style({headerForeground:Se(u?Wq:sj),headerBackground:Se(u?Vq:rj),headerBorder:Se(u?Uq:VV),dropBackground:Se(u?OV:Vw),leftBorder:u?Se(Hq):void 0});let p=new W;p.add(n),p.add(Ln(e,s,a,l,c,d));let m={pane:e,disposable:p};this.paneItems.splice(o,0,m),Ue(this.paneview).addPane(e,i,o);let g;p.add(Xa.INSTANCE.registerDraggable(e.draggableElement,()=>({type:"view",id:e.id}),{})),p.add(Xa.INSTANCE.registerTarget(e.dropTargetElement,{onDragEnter:f=>{if(!g){let b=f.dragAndDropData.getData();if(b.type==="view"&&b.id!==e.id){let y=this.viewDescriptorService.getViewContainerByViewId(b.id),I=this.viewDescriptorService.getViewDescriptorById(b.id);if(y!==this.viewContainer&&(!I||!I.canMoveView||this.viewContainer.rejectAddedViews))return;g=new DI(e.dropTargetElement,this.orientation??0,void 0,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService)}if(b.type==="composite"&&b.id!==this.viewContainer.id&&!this.viewContainer.rejectAddedViews){let y=this.viewDescriptorService.getViewContainerById(b.id),I=this.viewDescriptorService.getViewContainerModel(y).allViewDescriptors;!I.some(E=>!E.canMoveView)&&I.length>0&&(g=new DI(e.dropTargetElement,this.orientation??0,void 0,this.viewDescriptorService.getViewContainerLocation(this.viewContainer),this.themeService))}}},onDragOver:f=>{Op(f.eventData.dataTransfer,"move",g!==void 0)},onDragLeave:f=>{g?.dispose(),g=void 0},onDrop:f=>{if(g){let b=f.dragAndDropData.getData(),y=[],I;if(b.type==="composite"&&b.id!==this.viewContainer.id&&!this.viewContainer.rejectAddedViews){let E=this.viewDescriptorService.getViewContainerById(b.id),S=this.viewDescriptorService.getViewContainerModel(E).allViewDescriptors;S.length>0&&!S.some(w=>!w.canMoveView)&&(y.push(...S),I=S[0])}else if(b.type==="view"){let E=this.viewDescriptorService.getViewContainerByViewId(b.id),S=this.viewDescriptorService.getViewDescriptorById(b.id);E!==this.viewContainer&&S&&S.canMoveView&&!this.viewContainer.rejectAddedViews&&y.push(S),S&&(I=S)}if(y&&this.viewDescriptorService.moveViewsToContainer(y,this.viewContainer,void 0,"dnd"),I){if(g.currentDropOperation===1||g.currentDropOperation===3){let E=this.panes.findIndex(w=>w.id===I.id),S=this.panes.findIndex(w=>w.id===e.id);E>=0&&S>=0&&(E>S&&S++,S<this.panes.length&&S!==E&&this.movePane(this.panes[E],this.panes[S]))}if(g.currentDropOperation===0||g.currentDropOperation===2){let E=this.panes.findIndex(w=>w.id===I.id),S=this.panes.findIndex(w=>w.id===e.id);E>=0&&S>=0&&(E<S&&S--,S>=0&&S!==E&&this.movePane(this.panes[E],this.panes[S]))}y.length>1&&y.slice(1).forEach(E=>{let S=this.panes.findIndex(D=>D.id===I.id),w=this.panes.findIndex(D=>D.id===E.id);w>=0&&S>=0&&(w>S&&S++,S<this.panes.length&&S!==w&&(this.movePane(this.panes[w],this.panes[S]),I=E))})}}g?.dispose(),g=void 0}}))}removePanes(e){let i=this.isViewMergedWithContainer();e.forEach(n=>this.removePane(n)),this.updateViewHeaders(),i!==this.isViewMergedWithContainer()&&this.updateTitleArea(),this._onDidRemoveViews.fire(e)}removePane(e){let i=this.paneItems.findIndex(o=>o.pane===e);if(i===-1)return;this.lastFocusedPane===e&&(this.lastFocusedPane=void 0),Ue(this.paneview).removePane(e);let[n]=this.paneItems.splice(i,1);n.disposable.dispose()}movePane(e,i){let n=this.paneItems.findIndex(d=>d.pane===e),o=this.paneItems.findIndex(d=>d.pane===i),s=this.viewContainerModel.visibleViewDescriptors[n],a=this.viewContainerModel.visibleViewDescriptors[o];if(n<0||n>=this.paneItems.length||o<0||o>=this.paneItems.length)return;let[l]=this.paneItems.splice(n,1);this.paneItems.splice(o,0,l),Ue(this.paneview).movePane(e,i),this.viewContainerModel.move(s.id,a.id),this.updateTitleArea()}resizePane(e,i){Ue(this.paneview).resizePane(e,i)}getPaneSize(e){return Ue(this.paneview).getPaneSize(e)}updateViewHeaders(){this.isViewMergedWithContainer()?(this.paneItems[0].pane.isExpanded()?this.lastMergedCollapsedPane=void 0:(this.lastMergedCollapsedPane=this.paneItems[0].pane,this.paneItems[0].pane.setExpanded(!0)),this.paneItems[0].pane.headerVisible=!1,this.paneItems[0].pane.collapsible=!0):(this.paneItems.length===1?(this.paneItems[0].pane.headerVisible=!0,this.paneItems[0].pane===this.lastMergedCollapsedPane&&this.paneItems[0].pane.setExpanded(!1),this.paneItems[0].pane.collapsible=!1):this.paneItems.forEach(e=>{e.pane.headerVisible=!0,e.pane.collapsible=!0,e.pane===this.lastMergedCollapsedPane&&e.pane.setExpanded(!1)}),this.lastMergedCollapsedPane=void 0)}isViewMergedWithContainer(){return this.options.mergeViewWithContainerWhenSingleView&&this.paneItems.length===1?this.areExtensionsReady?!0:this.visibleViewsCountFromCache===void 0?this.paneItems[0].pane.isExpanded():this.visibleViewsCountFromCache===1:!1}onDidScrollPane(){for(let e of this.panes)e.onDidScrollRoot()}onDidSashReset(e){let i,n;for(let o=e;o>=0;o--)if(this.paneItems[o].pane?.isVisible()&&this.paneItems[o]?.pane.isExpanded()){i=this.paneItems[o].pane;break}for(let o=e+1;o<this.paneItems.length;o++)if(this.paneItems[o].pane?.isVisible()&&this.paneItems[o]?.pane.isExpanded()){n=this.paneItems[o].pane;break}if(i&&n){let o=this.getPaneSize(i),s=this.getPaneSize(n),a=Math.ceil((o+s)/2),l=Math.floor((o+s)/2);o>s?(this.resizePane(i,a),this.resizePane(n,l)):(this.resizePane(n,l),this.resizePane(i,a))}}dispose(){super.dispose(),this.paneItems.forEach(e=>e.disposable.dispose()),this.paneview&&this.paneview.dispose()}};_I=_([v(2,ae),v(3,de),v(4,Qe),v(5,Mt),v(6,qt),v(7,xn),v(8,Ze),v(9,tt),v(10,Xt),v(11,zi)],_I);var LI=class extends We{constructor(e,i){super(e);this.offset=i}async run(e){let i=e.get(zi),n=e.get(ke),o=kl.getValue(n);if(o===void 0)return;let s=i.getViewContainerByViewId(o),a=i.getViewContainerModel(s),l=a.visibleViewDescriptors.find(u=>u.id===o),d=a.visibleViewDescriptors.indexOf(l);if(d+this.offset<0||d+this.offset>=a.visibleViewDescriptors.length)return;let c=a.visibleViewDescriptors[d+this.offset];a.move(l.id,c.id)}};Me(class extends LI{constructor(){super({id:"views.moveViewUp",title:h("viewMoveUp","Move View Up"),keybinding:{primary:Kr(2089,16),weight:201,when:kl.notEqualsTo("")}},-1)}});Me(class extends LI{constructor(){super({id:"views.moveViewLeft",title:h("viewMoveLeft","Move View Left"),keybinding:{primary:Kr(2089,15),weight:201,when:kl.notEqualsTo("")}},-1)}});Me(class extends LI{constructor(){super({id:"views.moveViewDown",title:h("viewMoveDown","Move View Down"),keybinding:{primary:Kr(2089,18),weight:201,when:kl.notEqualsTo("")}},1)}});Me(class extends LI{constructor(){super({id:"views.moveViewRight",title:h("viewMoveRight","Move View Right"),keybinding:{primary:Kr(2089,17),weight:201,when:kl.notEqualsTo("")}},1)}});Me(class extends We{constructor(){super({id:"vscode.moveViews",title:h("viewsMove","Move Views")})}async run(t,e){if(!Array.isArray(e?.viewIds)||typeof e?.destinationId!="string")return Promise.reject("Invalid arguments");let i=t.get(zi),n=i.getViewContainerById(e.destinationId);if(n){for(let o of e.viewIds){let s=i.getViewDescriptorById(o);s?.canMoveView&&i.moveViewsToContainer([s],n,0,this.desc.id)}await t.get(va).openViewContainer(n.id,!0)}}});var BM=class extends fI{constructor(e,i,n,o,s,a,l,d){super(e,i,s,n);this.storageService=n;this.instantiationService=o;this.contextMenuService=a;this.extensionService=l;this.contextService=d}viewPaneContainer;create(e){super.create(e),this.viewPaneContainer=this._register(this.createViewPaneContainer(e)),this._register(this.viewPaneContainer.onTitleAreaUpdate(()=>this.updateTitleArea())),this.viewPaneContainer.create(e)}setVisible(e){super.setVisible(e),this.viewPaneContainer?.setVisible(e)}layout(e){this.viewPaneContainer?.layout(e)}setBoundarySashes(e){this.viewPaneContainer?.setBoundarySashes(e)}getOptimalWidth(){return this.viewPaneContainer?.getOptimalWidth()??0}openView(e,i){return this.viewPaneContainer?.openView(e,i)}getViewPaneContainer(){return this.viewPaneContainer}getActionsContext(){return this.getViewPaneContainer()?.getActionsContext()}getContextMenuActions(){return this.viewPaneContainer?.menuActions?.getContextMenuActions()??[]}getMenuIds(){let e=[];return this.viewPaneContainer?.menuActions&&(e.push(this.viewPaneContainer.menuActions.menuId),this.viewPaneContainer.isViewMergedWithContainer()&&e.push(this.viewPaneContainer.panes[0].menuActions.menuId)),e}getActions(){let e=[];if(this.viewPaneContainer?.menuActions&&(e.push(...this.viewPaneContainer.menuActions.getPrimaryActions()),this.viewPaneContainer.isViewMergedWithContainer())){let i=this.viewPaneContainer.panes[0];i.shouldShowFilterInHeader()&&e.push(OM),e.push(...i.menuActions.getPrimaryActions())}return e}getSecondaryActions(){if(!this.viewPaneContainer?.menuActions)return[];let e=this.viewPaneContainer.isViewMergedWithContainer()?this.viewPaneContainer.panes[0].menuActions.getSecondaryActions():[],i=this.viewPaneContainer.menuActions.getSecondaryActions(),n=i.findIndex(o=>o instanceof jn&&o.item.submenu===KT);if(n!==-1){let o=i[n];o.actions.some(({enabled:s})=>s)?i.length===1&&e.length===0?i=o.actions.slice():n!==0&&(i=[o,...i.slice(0,n),...i.slice(n+1)]):i.splice(n,1)}return i.length&&e.length?[...i,new pt,...e]:i.length?i:e}getActionViewItem(e,i){return this.viewPaneContainer?.getActionViewItem(e,i)}getTitle(){return this.viewPaneContainer?.getTitle()??""}focus(){super.focus(),this.viewPaneContainer?.focus()}};BM=_([v(1,qt),v(2,tt),v(3,ae),v(4,Ze),v(5,Mt),v(6,xn),v(7,Xt)],BM);var Wf={Viewlets:"workbench.contributions.viewlets",Panels:"workbench.contributions.panels",Auxiliary:"workbench.contributions.auxiliary"},GT=class extends uM{registerPaneComposite(t){super.registerComposite(t)}deregisterPaneComposite(t){super.deregisterComposite(t)}getPaneComposite(t){return this.getComposite(t)}getPaneComposites(){return this.getComposites()}};Ne.add(Wf.Viewlets,new GT);Ne.add(Wf.Panels,new GT);Ne.add(Wf.Auxiliary,new GT);var hs=$("paneCompositePartService");var Dce=Tt("auxiliarybar-right-layout-icon",B.layoutSidebarRight,h("toggleAuxiliaryIconRight","Icon to toggle the auxiliary bar off in its right position.")),Lce=Tt("auxiliarybar-right-off-layout-icon",B.layoutSidebarRightOff,h("toggleAuxiliaryIconRightOn","Icon to toggle the auxiliary bar on in its right position.")),kce=Tt("auxiliarybar-left-layout-icon",B.layoutSidebarLeft,h("toggleAuxiliaryIconLeft","Icon to toggle the auxiliary bar in its left position.")),Rce=Tt("auxiliarybar-left-off-layout-icon",B.layoutSidebarLeftOff,h("toggleAuxiliaryIconLeftOn","Icon to toggle the auxiliary bar on in its left position.")),Ol=class r extends We{static ID="workbench.action.toggleAuxiliaryBar";static LABEL=pe("toggleAuxiliaryBar","Toggle Secondary Side Bar Visibility");constructor(){super({id:r.ID,title:r.LABEL,toggled:{condition:Dl,title:h("secondary sidebar","Secondary Side Bar"),mnemonicTitle:h({key:"secondary sidebar mnemonic",comment:["&& denotes a mnemonic"]},"Secondary Si&&de Bar")},category:gt.View,f1:!0,keybinding:{weight:200,primary:2592},menu:[{id:ee.LayoutControlMenuSubmenu,group:"0_workbench_layout",order:1},{id:ee.MenubarAppearanceMenu,group:"2_workbench_layout",order:2}]})}async run(t){let e=t.get(Qe);e.setPartHidden(e.isVisible("workbench.parts.auxiliarybar"),"workbench.parts.auxiliarybar")}};Me(Ol);Me(class z5 extends We{static ID="workbench.action.focusAuxiliaryBar";static LABEL=pe("focusAuxiliaryBar","Focus into Secondary Side Bar");constructor(){super({id:z5.ID,title:z5.LABEL,category:gt.View,f1:!0})}async run(t){let e=t.get(hs),i=t.get(Qe);i.isVisible("workbench.parts.auxiliarybar")||i.setPartHidden(!1,"workbench.parts.auxiliarybar"),e.getActivePaneComposite(2)?.focus()}});Ct.appendMenuItems([{id:ee.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:Ol.ID,title:h("toggleSecondarySideBar","Toggle Secondary Side Bar"),toggled:{condition:Dl,icon:kce},icon:Rce},when:X.and(X.or(X.equals("config.workbench.layoutControl.type","toggles"),X.equals("config.workbench.layoutControl.type","both")),X.equals("config.workbench.sideBar.location","right")),order:0}},{id:ee.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:Ol.ID,title:h("toggleSecondarySideBar","Toggle Secondary Side Bar"),toggled:{condition:Dl,icon:Dce},icon:Lce},when:X.and(X.or(X.equals("config.workbench.layoutControl.type","toggles"),X.equals("config.workbench.layoutControl.type","both")),X.equals("config.workbench.sideBar.location","left")),order:2}},{id:ee.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:Ol.ID,title:pe("hideAuxiliaryBar","Hide Secondary Side Bar")},when:X.and(Dl,X.equals("viewLocation",go(2))),order:2}}]);var kI=class extends L{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_referenceDomElement;_width;_height;_resizeObserver;constructor(t,e){super(),this._referenceDomElement=t,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,e)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let t=null,e=()=>{t?this.observe({width:t.width,height:t.height}):this.observe()},i=!1,n=!1,o=()=>{if(i&&!n)try{i=!1,n=!0,e()}finally{nn(oe(this._referenceDomElement),()=>{n=!1,o()})}};this._resizeObserver=new ResizeObserver(s=>{s&&s[0]&&s[0].contentRect?t={width:s[0].contentRect.width,height:s[0].contentRect.height}:t=null,i=!0,o()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(t){this.measureReferenceDomElement(!0,t)}measureReferenceDomElement(t,e){let i=0,n=0;e?(i=e.width,n=e.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,t&&this._onDidChange.fire())}};var K5=class extends L{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_listener;_mediaQueryList;constructor(t){super(),this._listener=()=>this._handleChange(t,!0),this._mediaQueryList=null,this._handleChange(t,!1)}_handleChange(t,e){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=t.matchMedia(`(resolution: ${t.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),e&&this._onDidChange.fire()}},G5=class extends L{_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_value;get value(){return this._value}constructor(t){super(),this._value=this._getPixelRatio(t);let e=this._register(new K5(t));this._register(e.onDidChange(()=>{this._value=this._getPixelRatio(t),this._onDidChange.fire(this._value)}))}_getPixelRatio(t){let e=document.createElement("canvas").getContext("2d"),i=t.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return i/n}},q5=class{mapWindowIdToPixelRatioMonitor=new Map;_getOrCreatePixelRatioMonitor(t){let e=oa(t),i=this.mapWindowIdToPixelRatioMonitor.get(e);return i||(i=mc(new G5(t)),this.mapWindowIdToPixelRatioMonitor.set(e,i),mc(O.once(Gj)(({vscodeWindowId:n})=>{n===e&&(i?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(e))}))),i}getInstance(t){return this._getOrCreatePixelRatioMonitor(t)}},hu=new q5;function rn(r,t){r instanceof pf?(r.setFontFamily(t.getMassagedFontFamily()),r.setFontWeight(t.fontWeight),r.setFontSize(t.fontSize),r.setFontFeatureSettings(t.fontFeatureSettings),r.setFontVariationSettings(t.fontVariationSettings),r.setLineHeight(t.lineHeight),r.setLetterSpacing(t.letterSpacing)):(r.style.fontFamily=t.getMassagedFontFamily(),r.style.fontWeight=t.fontWeight,r.style.fontSize=t.fontSize+"px",r.style.fontFeatureSettings=t.fontFeatureSettings,r.style.fontVariationSettings=t.fontVariationSettings,r.style.lineHeight=t.lineHeight+"px",r.style.letterSpacing=t.letterSpacing+"px")}var VM=class{chr;type;width;constructor(t,e){this.chr=t,this.type=e,this.width=0}fulfill(t){this.width=t}},j5=class r{_bareFontInfo;_requests;_container;_testElements;constructor(t,e){this._bareFontInfo=t,this._requests=e,this._container=null,this._testElements=null}read(t){this._createDomElements(),t.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){let t=document.createElement("div");t.style.position="absolute",t.style.top="-50000px",t.style.width="50000px";let e=document.createElement("div");rn(e,this._bareFontInfo),t.appendChild(e);let i=document.createElement("div");rn(i,this._bareFontInfo),i.style.fontWeight="bold",t.appendChild(i);let n=document.createElement("div");rn(n,this._bareFontInfo),n.style.fontStyle="italic",t.appendChild(n);let o=[];for(let s of this._requests){let a;s.type===0&&(a=e),s.type===2&&(a=i),s.type===1&&(a=n),a.appendChild(document.createElement("br"));let l=document.createElement("span");r._render(l,s),a.appendChild(l),o.push(l)}this._container=t,this._testElements=o}static _render(t,e){if(e.chr===" "){let i="\xA0";for(let n=0;n<8;n++)i+=i;t.innerText=i}else{let i=e.chr;for(let n=0;n<8;n++)i+=i;t.textContent=i}}_readFromDomElements(){for(let t=0,e=this._requests.length;t<e;t++){let i=this._requests[t],n=this._testElements[t];i.fulfill(n.offsetWidth/256)}}};function wJ(r,t,e){new j5(t,e).read(r)}var $5=class extends L{_cache=new Map;_evictUntrustedReadingsTimeout=-1;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(t){let e=oa(t),i=this._cache.get(e);return i||(i=new Y5,this._cache.set(e,i)),i}_writeToCache(t,e,i){this._ensureCache(t).put(e,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=t.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(t)},5e3))}_evictUntrustedReadings(t){let e=this._ensureCache(t),i=e.getValues(),n=!1;for(let o of i)o.isTrusted||(n=!0,e.remove(o));n&&this._onDidChange.fire()}serializeFontInfo(t){return this._ensureCache(t).getValues().filter(i=>i.isTrusted)}restoreFontInfo(t,e){for(let i of e){if(i.version!==bW)continue;let n=new qv(i,!1);this._writeToCache(t,n,n)}}readFontInfo(t,e){let i=this._ensureCache(t);if(!i.has(e)){let n=this._actualReadFontInfo(t,e);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new qv({pixelRatio:hu.getInstance(t).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(t,e,n)}return i.get(e)}_createRequest(t,e,i,n){let o=new VM(t,e);return i.push(o),n?.push(o),o}_actualReadFontInfo(t,e){let i=[],n=[],o=this._createRequest("n",0,i,n),s=this._createRequest("\uFF4D",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),d=this._createRequest("1",0,i,n),c=this._createRequest("2",0,i,n),u=this._createRequest("3",0,i,n),p=this._createRequest("4",0,i,n),m=this._createRequest("5",0,i,n),g=this._createRequest("6",0,i,n),f=this._createRequest("7",0,i,n),b=this._createRequest("8",0,i,n),y=this._createRequest("9",0,i,n),I=this._createRequest("\u2192",0,i,n),E=this._createRequest("\uFFEB",0,i,null),S=this._createRequest("\xB7",0,i,n),w=this._createRequest("\u2E31",0,i,null),D="|/-_ilm%";for(let z=0,Z=D.length;z<Z;z++)this._createRequest(D.charAt(z),0,i,n),this._createRequest(D.charAt(z),1,i,n),this._createRequest(D.charAt(z),2,i,n);wJ(t,e,i);let k=Math.max(l.width,d.width,c.width,u.width,p.width,m.width,g.width,f.width,b.width,y.width),R=e.fontFeatureSettings===vd.OFF,A=n[0].width;for(let z=1,Z=n.length;R&&z<Z;z++){let fe=A-n[z].width;if(fe<-.001||fe>.001){R=!1;break}}let H=!0;return R&&E.width!==A&&(H=!1),E.width>I.width&&(H=!1),new qv({pixelRatio:hu.getInstance(t).value,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,fontVariationSettings:e.fontVariationSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:R,typicalHalfwidthCharacterWidth:o.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:H,spaceWidth:a.width,middotWidth:S.width,wsmiddotWidth:w.width,maxDigitWidth:k},!0)}},Y5=class{_keys;_values;constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(t){let e=t.getId();return!!this._values[e]}get(t){let e=t.getId();return this._values[e]}put(t,e){let i=t.getId();this._keys[i]=t,this._values[i]=e}remove(t){let e=t.getId();delete this._keys[e],delete this._values[e]}getValues(){return Object.keys(this._keys).map(t=>this._values[t])}},Uf=new $5;var qT=class r{constructor(t,e){this.key=t;this.migrate=e}static items=[];apply(t){let e=r._read(t,this.key),i=o=>r._read(t,o),n=(o,s)=>r._write(t,o,s);this.migrate(e,i,n)}static _read(t,e){if(typeof t>"u")return;let i=e.indexOf(".");if(i>=0){let n=e.substring(0,i);return this._read(t[n],e.substring(i+1))}return t[e]}static _write(t,e,i){let n=e.indexOf(".");if(n>=0){let o=e.substring(0,n);t[o]=t[o]||{},this._write(t[o],e.substring(n+1),i);return}t[e]=i}};function Gd(r,t){qT.items.push(new qT(r,t))}function Fs(r,t){Gd(r,(e,i,n)=>{if(typeof e<"u"){for(let[o,s]of t)if(e===o){n(r,s);return}}})}function EJ(r){qT.items.forEach(t=>t.apply(r))}Fs("wordWrap",[[!0,"on"],[!1,"off"]]);Fs("lineNumbers",[[!0,"on"],[!1,"off"]]);Fs("cursorBlinking",[["visible","solid"]]);Fs("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);Fs("renderLineHighlight",[[!0,"line"],[!1,"none"]]);Fs("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);Fs("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);Fs("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Fs("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Fs("autoIndent",[[!1,"advanced"],[!0,"full"]]);Fs("matchBrackets",[[!0,"always"],[!1,"never"]]);Fs("renderFinalNewline",[[!0,"on"],[!1,"off"]]);Fs("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);Fs("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);Fs("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);Gd("autoClosingBrackets",(r,t,e)=>{r===!1&&(e("autoClosingBrackets","never"),typeof t("autoClosingQuotes")>"u"&&e("autoClosingQuotes","never"),typeof t("autoSurround")>"u"&&e("autoSurround","never"))});Gd("renderIndentGuides",(r,t,e)=>{typeof r<"u"&&(e("renderIndentGuides",void 0),typeof t("guides.indentation")>"u"&&e("guides.indentation",!!r))});Gd("highlightActiveIndentGuide",(r,t,e)=>{typeof r<"u"&&(e("highlightActiveIndentGuide",void 0),typeof t("guides.highlightActiveIndentation")>"u"&&e("guides.highlightActiveIndentation",!!r))});var Ace={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Gd("suggest.filteredTypes",(r,t,e)=>{if(r&&typeof r=="object"){for(let i of Object.entries(Ace))r[i[0]]===!1&&typeof t(`suggest.${i[1]}`)>"u"&&e(`suggest.${i[1]}`,!1);e("suggest.filteredTypes",void 0)}});Gd("quickSuggestions",(r,t,e)=>{if(typeof r=="boolean"){let i=r?"on":"off";e("quickSuggestions",{comments:i,strings:i,other:i})}});Gd("experimental.stickyScroll.enabled",(r,t,e)=>{typeof r=="boolean"&&(e("experimental.stickyScroll.enabled",void 0),typeof t("stickyScroll.enabled")>"u"&&e("stickyScroll.enabled",r))});Gd("experimental.stickyScroll.maxLineCount",(r,t,e)=>{typeof r=="number"&&(e("experimental.stickyScroll.maxLineCount",void 0),typeof t("stickyScroll.maxLineCount")>"u"&&e("stickyScroll.maxLineCount",r))});Gd("codeActionsOnSave",(r,t,e)=>{if(r&&typeof r=="object"){let i=!1,n={};for(let o of Object.entries(r))typeof o[1]=="boolean"?(i=!0,n[o[0]]=o[1]?"explicit":"never"):n[o[0]]=o[1];i&&e("codeActionsOnSave",n)}});Gd("codeActionWidget.includeNearbyQuickfixes",(r,t,e)=>{typeof r=="boolean"&&(e("codeActionWidget.includeNearbyQuickfixes",void 0),typeof t("codeActionWidget.includeNearbyQuickFixes")>"u"&&e("codeActionWidget.includeNearbyQuickFixes",r))});Gd("lightbulb.enabled",(r,t,e)=>{typeof r=="boolean"&&e("lightbulb.enabled",r?void 0:"off")});var Z5=class{_tabFocus=!1;_onDidChangeTabFocus=new T;onDidChangeTabFocus=this._onDidChangeTabFocus.event;getTabFocusMode(){return this._tabFocus}setTabFocusMode(t){this._tabFocus=t,this._onDidChangeTabFocus.fire(this._tabFocus)}},RI=new Z5;var AI=class extends L{constructor(e,i,n,o,s){super();this._accessibilityService=s;this.isSimpleWidget=e,this.contextMenuId=i,this._containerObserver=this._register(new kI(o,n.dimension)),this._targetWindowId=oe(o).vscodeWindowId,this._rawOptions=TJ(n),this._validatedOptions=Hf.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Lc.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(RI.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(Uf.onDidChange(()=>this._recomputeOptions())),this._register(hu.getInstance(oe(o)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;_onDidChangeFast=this._register(new T);onDidChangeFast=this._onDidChangeFast.event;isSimpleWidget;contextMenuId;_containerObserver;_isDominatedByLongLines=!1;_viewLineCount=1;_lineNumbersDigitCount=1;_reservedHeight=0;_glyphMarginDecorationLaneCount=1;_targetWindowId;_computeOptionsMemory=new Jw;_rawOptions;_validatedOptions;options;_recomputeOptions(){let e=this._computeOptions(),i=Hf.checkEquals(this.options,e);i!==null&&(this.options=e,this._onDidChangeFast.fire(i),this._onDidChange.fire(i))}_computeOptions(){let e=this._readEnvConfiguration(),i=Ug.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),n=this._readFontInfo(i),o={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:n,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:RI.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Hf.computeOptions(this._validatedOptions,o)}_readEnvConfiguration(){return{extraEditorClassName:Mce(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:dd||dn,pixelRatio:hu.getInstance(Ma(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return Uf.readFontInfo(Ma(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){let i=TJ(e);Hf.applyUpdate(this._rawOptions,i)&&(this._validatedOptions=Hf.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){let i=Pce(e);this._lineNumbersDigitCount!==i&&(this._lineNumbersDigitCount=i,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};AI=_([v(4,zo)],AI);function Pce(r){let t=0;for(;r;)r=Math.floor(r/10),t++;return t||1}function Mce(){let r="";return!Eo&&!Ij&&(r+="no-user-select "),Eo&&(r+="no-minimap-shadow ",r+="enable-user-select "),be&&(r+="mac "),r}var X5=class{_values=[];_read(t){return this._values[t]}get(t){return this._values[t]}_write(t,e){this._values[t]=e}},Q5=class{_values=[];_read(t){if(t>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[t]}get(t){return this._read(t)}_write(t,e){this._values[t]=e}},Hf=class r{static validateOptions(t){let e=new X5;for(let i of Jv){let n=i.name==="_never_"?void 0:t[i.name];e._write(i.id,i.validate(n))}return e}static computeOptions(t,e){let i=new Q5;for(let n of Jv)i._write(n.id,n.compute(e,i,t._read(n.id)));return i}static _deepEquals(t,e){if(typeof t!="object"||typeof e!="object"||!t||!e)return t===e;if(Array.isArray(t)||Array.isArray(e))return Array.isArray(t)&&Array.isArray(e)?ti(t,e):!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let i in t)if(!r._deepEquals(t[i],e[i]))return!1;return!0}static checkEquals(t,e){let i=[],n=!1;for(let o of Jv){let s=!r._deepEquals(t._read(o.id),e._read(o.id));i[o.id]=s,s&&(n=!0)}return n?new yk(i):null}static applyUpdate(t,e){let i=!1;for(let n of Jv)if(e.hasOwnProperty(n.name)){let o=n.applyUpdate(t[n.name],e[n.name]);t[n.name]=o.newValue,i=i||o.didChange}return i}};function TJ(r){let t=Cs(r);return EJ(t),t}var WM=class{constructor(t){this.text=t;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let e=0;e<t.length;e++)t.charAt(e)===`
`&&this.lineStartOffsetByLineIdx.push(e+1)}lineStartOffsetByLineIdx;getOffset(t){return this.lineStartOffsetByLineIdx[t.lineNumber-1]+t.column-1}getOffsetRange(t){return new Xe(this.getOffset(t.getStartPosition()),this.getOffset(t.getEndPosition()))}getPosition(t){let e=Ou(this.lineStartOffsetByLineIdx,o=>o<=t),i=e+1,n=t-this.lineStartOffsetByLineIdx[e]+1;return new U(i,n)}getRange(t){return F.fromPositions(this.getPosition(t.start),this.getPosition(t.endExclusive))}getTextLength(t){return Ts.ofRange(this.getRange(t))}get textLength(){let t=this.lineStartOffsetByLineIdx.length-1;return new Ts(t,this.text.length-this.lineStartOffsetByLineIdx[t])}};var HM=class r{constructor(t){this.edits=t;$l(()=>HS(t,(e,i)=>e.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}static single(t,e){return new r([new zf(t,e)])}normalize(){let t=[];for(let e of this.edits)if(t.length>0&&t[t.length-1].range.getEndPosition().equals(e.range.getStartPosition())){let i=t[t.length-1];t[t.length-1]=new zf(i.range.plusRange(e.range),i.text+e.text)}else e.isEmpty||t.push(e);return new r(t)}mapPosition(t){let e=0,i=0,n=0;for(let o of this.edits){let s=o.range.getStartPosition(),a=o.range.getEndPosition();if(t.isBeforeOrEqual(s))break;let l=Ts.ofText(o.text);if(t.isBefore(a)){let d=new U(s.lineNumber+e,s.column+(s.lineNumber+e===i?n:0)),c=l.addToPosition(d);return UM(d,c)}e+=l.lineCount-(o.range.endLineNumber-o.range.startLineNumber),l.lineCount===0?a.lineNumber!==s.lineNumber?n+=l.columnCount-(a.column-1):n+=l.columnCount-(a.column-s.column):n=l.columnCount,i=a.lineNumber+e}return new U(t.lineNumber+e,t.column+(t.lineNumber+e===i?n:0))}mapRange(t){function e(s){return s instanceof U?s:s.getStartPosition()}function i(s){return s instanceof U?s:s.getEndPosition()}let n=e(this.mapPosition(t.getStartPosition())),o=i(this.mapPosition(t.getEndPosition()));return UM(n,o)}inverseMapPosition(t,e){return this.inverse(e).mapPosition(t)}inverseMapRange(t,e){return this.inverse(e).mapRange(t)}apply(t){let e="",i=new U(1,1);for(let o of this.edits){let s=o.range,a=s.getStartPosition(),l=s.getEndPosition(),d=UM(i,a);d.isEmpty()||(e+=t.getValueOfRange(d)),e+=o.text,i=l}let n=UM(i,t.endPositionExclusive);return n.isEmpty()||(e+=t.getValueOfRange(n)),e}applyToString(t){let e=new J5(t);return this.apply(e)}inverse(t){let e=this.getNewRanges();return new r(this.edits.map((i,n)=>new zf(e[n],t.getValueOfRange(i.range))))}getNewRanges(){let t=[],e=0,i=0,n=0;for(let o of this.edits){let s=Ts.ofText(o.text),a=U.lift({lineNumber:o.range.startLineNumber+i,column:o.range.startColumn+(o.range.startLineNumber===e?n:0)}),l=s.createRange(a);t.push(l),i=l.endLineNumber-o.range.endLineNumber,n=l.endColumn-o.range.endColumn,e=o.range.endLineNumber}return t}},zf=class{constructor(t,e){this.range=t;this.text=e}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(t,e){return t.range.equalsRange(e.range)&&t.text===e.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};function UM(r,t){if(r.lineNumber===t.lineNumber&&r.column===Number.MAX_SAFE_INTEGER)return F.fromPositions(t,t);if(!r.isBeforeOrEqual(t))throw new yt("start must be before end");return new F(r.lineNumber,r.column,t.lineNumber,t.column)}var jT=class{get endPositionExclusive(){return this.length.addToPosition(new U(1,1))}getValue(){return this.getValueOfRange(this.length.toRange())}};var J5=class extends jT{constructor(e){super();this.value=e}_t=new WM(this.value);getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}};var Nr=class r{static inverse(t,e,i){let n=[],o=1,s=1;for(let l of t){let d=new r(new Ye(o,l.original.startLineNumber),new Ye(s,l.modified.startLineNumber));d.modified.isEmpty||n.push(d),o=l.original.endLineNumberExclusive,s=l.modified.endLineNumberExclusive}let a=new r(new Ye(o,e+1),new Ye(s,i+1));return a.modified.isEmpty||n.push(a),n}static clip(t,e,i){let n=[];for(let o of t){let s=o.original.intersect(e),a=o.modified.intersect(i);s&&!s.isEmpty&&a&&!a.isEmpty&&n.push(new r(s,a))}return n}original;modified;constructor(t,e){this.original=t,this.modified=e}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new r(this.modified,this.original)}join(t){return new r(this.original.join(t.original),this.modified.join(t.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let t=this.original.toInclusiveRange(),e=this.modified.toInclusiveRange();if(t&&e)return new $r(t,e);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new yt("not a valid diff");return new $r(new F(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new F(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new $r(new F(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new F(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(t,e){if(xJ(this.original.endLineNumberExclusive,t)&&xJ(this.modified.endLineNumberExclusive,e))return new $r(new F(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new F(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new $r(F.fromPositions(new U(this.original.startLineNumber,1),PI(new U(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)),F.fromPositions(new U(this.modified.startLineNumber,1),PI(new U(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new $r(F.fromPositions(PI(new U(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),PI(new U(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)),F.fromPositions(PI(new U(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),PI(new U(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)));throw new yt}};function PI(r,t){if(r.lineNumber<1)return new U(1,1);if(r.lineNumber>t.length)return new U(t.length,t[t.length-1].length+1);let e=t[r.lineNumber-1];return r.column>e.length+1?new U(r.lineNumber,e.length+1):r}function xJ(r,t){return r>=1&&r<=t.length}var ya=class r extends Nr{static fromRangeMappings(t){let e=Ye.join(t.map(n=>Ye.fromRangeInclusive(n.originalRange))),i=Ye.join(t.map(n=>Ye.fromRangeInclusive(n.modifiedRange)));return new r(e,i,t)}innerChanges;constructor(t,e,i){super(t,e),this.innerChanges=i}flip(){return new r(this.modified,this.original,this.innerChanges?.map(t=>t.flip()))}withInnerChangesFromLineRanges(){return new r(this.original,this.modified,[this.toRangeMapping()])}},$r=class r{static assertSorted(t){for(let e=1;e<t.length;e++){let i=t[e-1],n=t[e];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new yt("Range mappings must be sorted")}}originalRange;modifiedRange;constructor(t,e){this.originalRange=t,this.modifiedRange=e}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new r(this.modifiedRange,this.originalRange)}toTextEdit(t){let e=t.getValueOfRange(this.modifiedRange);return new zf(this.originalRange,e)}};var Kf=class{constructor(t,e,i){this.changes=t;this.moves=e;this.hitTimeout=i}},zM=class r{lineRangeMapping;changes;constructor(t,e){this.lineRangeMapping=t,this.changes=e}flip(){return new r(this.lineRangeMapping.flip(),this.changes.map(t=>t.flip()))}};var Vp=class{constructor(t,e,i,n,o){this.injectionOffsets=t;this.injectionOptions=e;this.breakOffsets=i;this.breakOffsetsVisibleColumn=n;this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(t){return t>0?this.wrappedTextIndentLength:0}getLineLength(t){let e=t>0?this.breakOffsets[t-1]:0,n=this.breakOffsets[t]-e;return t>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(t){return this.getLineLength(t)}translateToInputOffset(t,e){t>0&&(e=Math.max(0,e-this.wrappedTextIndentLength));let n=t===0?e:this.breakOffsets[t-1]+e;if(this.injectionOffsets!==null)for(let o=0;o<this.injectionOffsets.length&&n>this.injectionOffsets[o];o++)n<this.injectionOffsets[o]+this.injectionOptions[o].content.length?n=this.injectionOffsets[o]:n-=this.injectionOptions[o].content.length;return n}translateToOutputPosition(t,e=2){let i=t;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(t<this.injectionOffsets[n]||e!==1&&t===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,e)}offsetInInputWithInjectionsToOutputPosition(t,e=2){let i=0,n=this.breakOffsets.length-1,o=0,s=0;for(;i<=n;){o=i+(n-i)/2|0;let l=this.breakOffsets[o];if(s=o>0?this.breakOffsets[o-1]:0,e===0)if(t<=s)n=o-1;else if(t>l)i=o+1;else break;else if(t<s)n=o-1;else if(t>=l)i=o+1;else break}let a=t-s;return o>0&&(a+=this.wrappedTextIndentLength),new MI(o,a)}normalizeOutputPosition(t,e,i){if(this.injectionOffsets!==null){let n=this.outputPositionToOffsetInInputWithInjections(t,e),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(o!==n)return this.offsetInInputWithInjectionsToOutputPosition(o,i)}if(i===0){if(t>0&&e===this.getMinOutputOffset(t))return new MI(t-1,this.getMaxOutputOffset(t-1))}else if(i===1){let n=this.getOutputLineCount()-1;if(t<n&&e===this.getMaxOutputOffset(t))return new MI(t+1,this.getMinOutputOffset(t+1))}return new MI(t,e)}outputPositionToOffsetInInputWithInjections(t,e){return t>0&&(e=Math.max(0,e-this.wrappedTextIndentLength)),(t>0?this.breakOffsets[t-1]:0)+e}normalizeOffsetInInputWithInjectionsAroundInjections(t,e){let i=this.getInjectedTextAtOffset(t);if(!i)return t;if(e===2){if(t===i.offsetInInputWithInjections+i.length&&_J(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(DJ(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let o=i.injectedTextIndex-1;for(;o>=0&&this.injectionOffsets[o]===this.injectionOffsets[i.injectedTextIndex]&&!(_J(this.injectionOptions[o].cursorStops)||(n-=this.injectionOptions[o].content.length,DJ(this.injectionOptions[o].cursorStops)));)o--;return n}}else if(e===1||e===4){let n=i.offsetInInputWithInjections+i.length,o=i.injectedTextIndex;for(;o+1<this.injectionOffsets.length&&this.injectionOffsets[o+1]===this.injectionOffsets[o];)n+=this.injectionOptions[o+1].content.length,o++;return n}else if(e===0||e===3){let n=i.offsetInInputWithInjections,o=i.injectedTextIndex;for(;o-1>=0&&this.injectionOffsets[o-1]===this.injectionOffsets[o];)n-=this.injectionOptions[o-1].content.length,o--;return n}US(e)}getInjectedText(t,e){let i=this.outputPositionToOffsetInInputWithInjections(t,e),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(t){let e=this.injectionOffsets,i=this.injectionOptions;if(e!==null){let n=0;for(let o=0;o<e.length;o++){let s=i[o].content.length,a=e[o]+n,l=e[o]+n+s;if(a>t)break;if(t<=l)return{injectedTextIndex:o,offsetInInputWithInjections:a,length:s};n+=s}}}};function _J(r){return r==null?!0:r===1||r===0}function DJ(r){return r==null?!0:r===2||r===0}var MI=class{outputLineIndex;outputOffset;constructor(t,e){this.outputLineIndex=t,this.outputOffset=e}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(t){return new U(t+this.outputLineIndex,this.outputOffset+1)}};var Oce=()=>!0,Nce=()=>!1,Fce=r=>r===" "||r==="	",Wp=class{constructor(t,e,i,n){this.languageConfigurationService=n;this._languageId=t;let o=i.options,s=o.get(147),a=o.get(51);this.readOnly=o.get(93),this.tabSize=e.tabSize,this.indentSize=e.indentSize,this.insertSpaces=e.insertSpaces,this.stickyTabStops=o.get(118),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=o.get(130),this.wordSeparators=o.get(133),this.emptySelectionClipboard=o.get(38),this.copyWithSyntaxHighlighting=o.get(25),this.multiCursorMergeOverlapping=o.get(78),this.multiCursorPaste=o.get(80),this.multiCursorLimit=o.get(81),this.autoClosingBrackets=o.get(6),this.autoClosingComments=o.get(7),this.autoClosingQuotes=o.get(11),this.autoClosingDelete=o.get(9),this.autoClosingOvertype=o.get(10),this.autoSurround=o.get(14),this.autoIndent=o.get(12),this.wordSegmenterLocales=o.get(132),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(t,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(t,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(t,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(t).getAutoClosingPairs();let l=this.languageConfigurationService.getLanguageConfiguration(t).getSurroundingPairs();if(l)for(let c of l)this.surroundingPairs[c.open]=c.close;let d=this.languageConfigurationService.getLanguageConfiguration(t).comments;this.blockCommentStartToken=d?.blockCommentStartToken??null}_cursorMoveConfigurationBrand=void 0;readOnly;tabSize;indentSize;insertSpaces;stickyTabStops;pageSize;lineHeight;typicalHalfwidthCharacterWidth;useTabStops;wordSeparators;emptySelectionClipboard;copyWithSyntaxHighlighting;multiCursorMergeOverlapping;multiCursorPaste;multiCursorLimit;autoClosingBrackets;autoClosingComments;autoClosingQuotes;autoClosingDelete;autoClosingOvertype;autoSurround;autoIndent;autoClosingPairs;surroundingPairs;blockCommentStartToken;shouldAutoCloseBefore;wordSegmenterLocales;_languageId;_electricChars;static shouldRecreate(t){return t.hasChanged(147)||t.hasChanged(133)||t.hasChanged(38)||t.hasChanged(78)||t.hasChanged(80)||t.hasChanged(81)||t.hasChanged(6)||t.hasChanged(7)||t.hasChanged(11)||t.hasChanged(9)||t.hasChanged(10)||t.hasChanged(14)||t.hasChanged(130)||t.hasChanged(51)||t.hasChanged(93)||t.hasChanged(132)}get electricChars(){if(!this._electricChars){this._electricChars={};let t=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(t)for(let e of t)this._electricChars[e]=!0}return this._electricChars}onElectricCharacter(t,e,i){let n=Fc(e,i-1),o=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return o?o.onElectricCharacter(t,n,i-n.firstCharOffset):null}normalizeIndentation(t){return nR(t,this.indentSize,this.insertSpaces)}_getShouldAutoClose(t,e,i){switch(e){case"beforeWhitespace":return Fce;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(t,i);case"always":return Oce;case"never":return Nce}}_getLanguageDefinedShouldAutoClose(t,e){let i=this.languageConfigurationService.getLanguageConfiguration(t).getAutoCloseBeforeSet(e);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(t,e){return Ni.visibleColumnFromColumn(t.getLineContent(e.lineNumber),e.column,this.tabSize)}columnFromVisibleColumn(t,e,i){let n=Ni.columnFromVisibleColumn(t.getLineContent(e),i,this.tabSize),o=t.getLineMinColumn(e);if(n<o)return o;let s=t.getLineMaxColumn(e);return n>s?s:n}},Rt=class r{_cursorStateBrand=void 0;static fromModelState(t){return new e4(t)}static fromViewState(t){return new t4(t)}static fromModelSelection(t){let e=It.liftSelection(t),i=new Yn(F.fromPositions(e.getSelectionStart()),0,0,e.getPosition(),0);return r.fromModelState(i)}static fromModelSelections(t){let e=[];for(let i=0,n=t.length;i<n;i++)e[i]=this.fromModelSelection(t[i]);return e}modelState;viewState;constructor(t,e){this.modelState=t,this.viewState=e}equals(t){return this.viewState.equals(t.viewState)&&this.modelState.equals(t.modelState)}},e4=class{modelState;viewState;constructor(t){this.modelState=t,this.viewState=null}},t4=class{modelState;viewState;constructor(t){this.modelState=null,this.viewState=t}};var Yn=class r{constructor(t,e,i,n,o){this.selectionStart=t;this.selectionStartKind=e;this.selectionStartLeftoverVisibleColumns=i;this.position=n;this.leftoverVisibleColumns=o;this.selection=r._computeSelection(this.selectionStart,this.position)}_singleCursorStateBrand=void 0;selection;equals(t){return this.selectionStartLeftoverVisibleColumns===t.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===t.leftoverVisibleColumns&&this.selectionStartKind===t.selectionStartKind&&this.position.equals(t.position)&&this.selectionStart.equalsRange(t.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(t,e,i,n){return t?new r(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new U(e,i),n):new r(new F(e,i,e,i),0,n,new U(e,i),n)}static _computeSelection(t,e){return t.isEmpty()||!e.isBeforeOrEqual(t.getStartPosition())?It.fromPositions(t.getStartPosition(),e):It.fromPositions(t.getEndPosition(),e)}},fo=class{_editOperationResultBrand=void 0;type;commands;shouldPushStackElementBefore;shouldPushStackElementAfter;constructor(t,e,i){this.type=t,this.commands=e,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}};function qd(r){return r==="'"||r==='"'||r==="`"}var KM=class{_theme;get type(){return this._theme.type}get value(){return this._theme}constructor(t){this._theme=t}update(t){this._theme=t}getColor(t){return this._theme.getColor(t)}};var GM=class{type=0;constructor(){}},qM=class{type=1;constructor(){}},jM=class{type=2;_source;constructor(t){this._source=t}hasChanged(t){return this._source.hasChanged(t)}},$M=class{constructor(t,e,i){this.selections=t;this.modelSelections=e;this.reason=i}type=3},mu=class{type=4;affectsMinimap;affectsOverviewRuler;affectsGlyphMargin;affectsLineNumber;constructor(t){t?(this.affectsMinimap=t.affectsMinimap,this.affectsOverviewRuler=t.affectsOverviewRuler,this.affectsGlyphMargin=t.affectsGlyphMargin,this.affectsLineNumber=t.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}},qf=class{type=5;constructor(){}},YM=class{type=6;isFocused;constructor(t){this.isFocused=t}},ZM=class{type=7},jf=class{type=8;constructor(){}},$T=class{constructor(t,e){this.fromLineNumber=t;this.count=e}type=9},OI=class{type=10;fromLineNumber;toLineNumber;constructor(t,e){this.fromLineNumber=t,this.toLineNumber=e}},NI=class{type=11;fromLineNumber;toLineNumber;constructor(t,e){this.fromLineNumber=t,this.toLineNumber=e}};var Up=class{constructor(t,e,i,n,o,s,a){this.source=t;this.minimalReveal=e;this.range=i;this.selections=n;this.verticalType=o;this.revealHorizontal=s;this.scrollType=a}type=12},XM=class{type=13;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(t){this.scrollWidth=t.scrollWidth,this.scrollLeft=t.scrollLeft,this.scrollHeight=t.scrollHeight,this.scrollTop=t.scrollTop,this.scrollWidthChanged=t.scrollWidthChanged,this.scrollLeftChanged=t.scrollLeftChanged,this.scrollHeightChanged=t.scrollHeightChanged,this.scrollTopChanged=t.scrollTopChanged}},QM=class{constructor(t){this.theme=t}type=14},JM=class{type=15;ranges;constructor(t){this.ranges=t}},e0=class{type=16;constructor(){}},t0=class{type=17;constructor(){}};var Nl=class extends L{_shouldRender;constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(t){return!1}onCompositionEnd(t){return!1}onConfigurationChanged(t){return!1}onCursorStateChanged(t){return!1}onDecorationsChanged(t){return!1}onFlushed(t){return!1}onFocusChanged(t){return!1}onLanguageConfigurationChanged(t){return!1}onLineMappingChanged(t){return!1}onLinesChanged(t){return!1}onLinesDeleted(t){return!1}onLinesInserted(t){return!1}onRevealRangeRequest(t){return!1}onScrollChanged(t){return!1}onThemeChanged(t){return!1}onTokensChanged(t){return!1}onTokensColorsChanged(t){return!1}onZonesChanged(t){return!1}handleEvents(t){let e=!1;for(let i=0,n=t.length;i<n;i++){let o=t[i];switch(o.type){case 0:this.onCompositionStart(o)&&(e=!0);break;case 1:this.onCompositionEnd(o)&&(e=!0);break;case 2:this.onConfigurationChanged(o)&&(e=!0);break;case 3:this.onCursorStateChanged(o)&&(e=!0);break;case 4:this.onDecorationsChanged(o)&&(e=!0);break;case 5:this.onFlushed(o)&&(e=!0);break;case 6:this.onFocusChanged(o)&&(e=!0);break;case 7:this.onLanguageConfigurationChanged(o)&&(e=!0);break;case 8:this.onLineMappingChanged(o)&&(e=!0);break;case 9:this.onLinesChanged(o)&&(e=!0);break;case 10:this.onLinesDeleted(o)&&(e=!0);break;case 11:this.onLinesInserted(o)&&(e=!0);break;case 12:this.onRevealRangeRequest(o)&&(e=!0);break;case 13:this.onScrollChanged(o)&&(e=!0);break;case 15:this.onTokensChanged(o)&&(e=!0);break;case 14:this.onThemeChanged(o)&&(e=!0);break;case 16:this.onTokensColorsChanged(o)&&(e=!0);break;case 17:this.onZonesChanged(o)&&(e=!0);break;default:console.info("View received unknown event: "),console.info(o)}}e&&(this._shouldRender=!0)}};var YT=class{_viewportBrand=void 0;top;left;width;height;constructor(t,e,i,n){this.top=t|0,this.left=e|0,this.width=i|0,this.height=n|0}},i0=class{tabSize;data;constructor(t,e){this.tabSize=t,this.data=e}},$f=class{_viewLineDataBrand=void 0;content;continuesWithWrappedLine;minColumn;maxColumn;startVisibleColumn;tokens;inlineDecorations;constructor(t,e,i,n,o,s,a){this.content=t,this.continuesWithWrappedLine=e,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=o,this.tokens=s,this.inlineDecorations=a}},gu=class r{minColumn;maxColumn;content;continuesWithWrappedLine;containsRTL;isBasicASCII;tokens;inlineDecorations;tabSize;startVisibleColumn;constructor(t,e,i,n,o,s,a,l,d,c){this.minColumn=t,this.maxColumn=e,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=r.isBasicASCII(i,s),this.containsRTL=r.containsRTL(i,this.isBasicASCII,o),this.tokens=a,this.inlineDecorations=l,this.tabSize=d,this.startVisibleColumn=c}static isBasicASCII(t,e){return e?iw(t):!0}static containsRTL(t,e,i){return!e&&i?qu(t):!1}};var Hp=class{constructor(t,e,i){this.range=t;this.inlineClassName=e;this.type=i}},n0=class{constructor(t,e,i,n){this.startOffset=t;this.endOffset=e;this.inlineClassName=i;this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(t){return new Hp(new F(t,this.startOffset+1,t,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}},BI=class{_viewModelDecorationBrand=void 0;range;options;constructor(t,e){this.range=t,this.options=e}},Yf=class r{constructor(t,e,i){this.color=t;this.zIndex=e;this.data=i}static compareByRenderingProps(t,e){return t.zIndex===e.zIndex?t.color<e.color?-1:t.color>e.color?1:0:t.zIndex-e.zIndex}static equals(t,e){return t.color===e.color&&t.zIndex===e.zIndex&&ti(t.data,e.data)}static equalsArr(t,e){return ti(t,e,r.equals)}};var o0=class{_colorZoneBrand=void 0;from;to;colorId;constructor(t,e,i){this.from=t|0,this.to=e|0,this.colorId=i|0}static compare(t,e){return t.colorId===e.colorId?t.from===e.from?t.to-e.to:t.from-e.from:t.colorId-e.colorId}},ZT=class{_overviewRulerZoneBrand=void 0;startLineNumber;endLineNumber;heightInLines;color;_colorZone;constructor(t,e,i,n){this.startLineNumber=t,this.endLineNumber=e,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(t,e){return t.color===e.color?t.startLineNumber===e.startLineNumber?t.heightInLines===e.heightInLines?t.endLineNumber-e.endLineNumber:t.heightInLines-e.heightInLines:t.startLineNumber-e.startLineNumber:t.color<e.color?-1:1}setColorZone(t){this._colorZone=t}getColorZones(){return this._colorZone}},r0=class{_getVerticalOffsetForLine;_zones;_colorZonesInvalid;_lineHeight;_domWidth;_domHeight;_outerHeight;_pixelRatio;_lastAssignedId;_color2Id;_id2Color;constructor(t){this._getVerticalOffsetForLine=t,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(t){this._zones=t,this._zones.sort(ZT.compare)}setLineHeight(t){return this._lineHeight===t?!1:(this._lineHeight=t,this._colorZonesInvalid=!0,!0)}setPixelRatio(t){this._pixelRatio=t,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(t){return this._domWidth===t?!1:(this._domWidth=t,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(t){return this._domHeight===t?!1:(this._domHeight=t,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(t){return this._outerHeight===t?!1:(this._outerHeight=t,this._colorZonesInvalid=!0,!0)}resolveColorZones(){let t=this._colorZonesInvalid,e=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),o=i/n,s=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,d=this._zones.length;l<d;l++){let c=this._zones[l];if(!t){let S=c.getColorZones();if(S){a.push(S);continue}}let u=this._getVerticalOffsetForLine(c.startLineNumber),p=c.heightInLines===0?this._getVerticalOffsetForLine(c.endLineNumber)+e:u+c.heightInLines*e,m=Math.floor(o*u),g=Math.floor(o*p),f=Math.floor((m+g)/2),b=g-f;b<s&&(b=s),f-b<0&&(f=b),f+b>i&&(f=i-b);let y=c.color,I=this._color2Id[y];I||(I=++this._lastAssignedId,this._color2Id[y]=I,this._id2Color[I]=y);let E=new o0(f-b,f+b,I);c.setColorZone(E),a.push(E)}return this._colorZonesInvalid=!1,a.sort(o0.compare),a}};function XT(r){return r&&typeof r.getEditorType=="function"?r.getEditorType()===Yg.ICodeEditor:!1}function s0(r){return r&&typeof r.getEditorType=="function"?r.getEditorType()===Yg.IDiffEditor:!1}function LJ(r){return XT(r)||s0(r)?r:null}var fu=$("codeEditorService");var Zf=class{id;precondition;_kbOpts;_menuOpts;metadata;constructor(t){this.id=t.id,this.precondition=t.precondition,this._kbOpts=t.kbOpts,this._menuOpts=t.menuOpts,this.metadata=t.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){let t=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(let e of t){let i=e.kbExpr;this.precondition&&(i?i=X.and(i,this.precondition):i=this.precondition);let n={id:this.id,weight:e.weight,args:e.args,when:i,primary:e.primary,secondary:e.secondary,win:e.win,linux:e.linux,mac:e.mac};Zt.registerKeybindingRule(n)}}En.registerCommand({id:this.id,handler:(t,e)=>this.runCommand(t,e),metadata:this.metadata})}_registerMenuItem(t){Ct.appendMenuItem(t.menuId,{group:t.group,command:{id:this.id,title:t.title,icon:t.icon,precondition:this.precondition},when:t.when,order:t.order})}},QT=class extends Zf{_implementations=[];addImplementation(t,e,i,n){return this._implementations.push({priority:t,name:e,implementation:i,when:n}),this._implementations.sort((o,s)=>s.priority-o.priority),{dispose:()=>{for(let o=0;o<this._implementations.length;o++)if(this._implementations[o].implementation===i){this._implementations.splice(o,1);return}}}}runCommand(t,e){let i=t.get(Gt),n=t.get(ke);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(let o of this._implementations){if(o.when){let a=n.getContext(An());if(!o.when.evaluate(a))continue}let s=o.implementation(t,e);if(s)return i.trace(`Command '${this.id}' was handled by '${o.name}'.`),typeof s=="boolean"?void 0:s}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}},a0=class extends Zf{constructor(e,i){super(i);this.command=e}runCommand(e,i){return this.command.runCommand(e,i)}},JT=class r extends Zf{static bindToContribution(t){return class extends r{_callback;constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,o){let s=t(n);s&&this._callback(s,o)}}}static runEditorCommand(t,e,i,n){let o=t.get(fu),s=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(s)return s.invokeWithinContext(a=>{if(a.get(ke).contextMatchesRules(i??void 0))return n(a,s,e)})}runCommand(t,e){return r.runEditorCommand(t,e,this.precondition,(i,n,o)=>this.runEditorCommand(i,n,o))}};function St(r){return bu.INSTANCE.registerEditorCommand(r),r}function kJ(r,t,e){bu.INSTANCE.registerEditorContribution(r,t,e)}var Xf;(o=>{function r(s){return bu.INSTANCE.getEditorCommand(s)}o.getEditorCommand=r;function t(){return bu.INSTANCE.getEditorActions()}o.getEditorActions=t;function e(){return bu.INSTANCE.getEditorContributions()}o.getEditorContributions=e;function i(s){return bu.INSTANCE.getEditorContributions().filter(a=>s.indexOf(a.id)>=0)}o.getSomeEditorContributions=i;function n(){return bu.INSTANCE.getDiffEditorContributions()}o.getDiffEditorContributions=n})(Xf||={});var Bce={EditorCommonContributions:"editor.contributions"},bu=class r{static INSTANCE=new r;editorContributions=[];diffEditorContributions=[];editorActions=[];editorCommands=Object.create(null);constructor(){}registerEditorContribution(t,e,i){this.editorContributions.push({id:t,ctor:e,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}registerDiffEditorContribution(t,e){this.diffEditorContributions.push({id:t,ctor:e})}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(t){t.register(),this.editorActions.push(t)}getEditorActions(){return this.editorActions}registerEditorCommand(t){t.register(),this.editorCommands[t.id]=t}getEditorCommand(t){return this.editorCommands[t]||null}};Ne.add(Bce.EditorCommonContributions,bu.INSTANCE);function ex(r){return r.register(),r}var i4=ex(new QT({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:ee.MenubarEditMenu,group:"1_do",title:h({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:ee.CommandPalette,group:"",title:h("undo","Undo"),order:1}]}));ex(new a0(i4,{id:"default:undo",precondition:void 0}));var n4=ex(new QT({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:ee.MenubarEditMenu,group:"1_do",title:h({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:ee.CommandPalette,group:"",title:h("redo","Redo"),order:1}]}));ex(new a0(n4,{id:"default:redo",precondition:void 0}));var RJ=ex(new QT({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:ee.MenubarSelectionMenu,group:"1_basic",title:h({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:ee.CommandPalette,group:"",title:h("selectAll","Select All"),order:1}]}));var Vce=Tt("panel-maximize",B.chevronUp,h("maximizeIcon","Icon to maximize a panel.")),Wce=Tt("panel-restore",B.chevronDown,h("restoreIcon","Icon to restore a panel.")),AJ=Tt("panel-close",B.close,h("closeIcon","Icon to close a panel.")),Uce=Tt("panel-layout-icon",B.layoutPanel,h("togglePanelOffIcon","Icon to toggle the panel off when it is on.")),Hce=Tt("panel-layout-icon-off",B.layoutPanelOff,h("togglePanelOnIcon","Icon to toggle the panel on when it is off.")),vu=class r extends We{static ID="workbench.action.togglePanel";static LABEL=pe("togglePanelVisibility","Toggle Panel Visibility");constructor(){super({id:r.ID,title:r.LABEL,toggled:{condition:Rp,title:h("toggle panel","Panel"),mnemonicTitle:h({key:"toggle panel mnemonic",comment:["&& denotes a mnemonic"]},"&&Panel")},f1:!0,category:gt.View,keybinding:{primary:2088,weight:200},menu:[{id:ee.MenubarAppearanceMenu,group:"2_workbench_layout",order:5},{id:ee.LayoutControlMenuSubmenu,group:"0_workbench_layout",order:4}]})}async run(t){let e=t.get(Qe);e.setPartHidden(e.isVisible("workbench.parts.panel"),"workbench.parts.panel")}};Me(vu);Me(class extends We{static ID="workbench.action.focusPanel";static LABEL=h("focusPanel","Focus into Panel");constructor(){super({id:"workbench.action.focusPanel",title:pe("focusPanel","Focus into Panel"),category:gt.View,f1:!0})}async run(r){let t=r.get(Qe),e=r.get(hs);t.isVisible("workbench.parts.panel")||t.setPartHidden(!1,"workbench.parts.panel"),e.getActivePaneComposite(1)?.focus()}});var l0={LEFT:"workbench.action.positionPanelLeft",RIGHT:"workbench.action.positionPanelRight",BOTTOM:"workbench.action.positionPanelBottom",TOP:"workbench.action.positionPanelTop"},d0={LEFT:"workbench.action.alignPanelLeft",RIGHT:"workbench.action.alignPanelRight",CENTER:"workbench.action.alignPanelCenter",JUSTIFY:"workbench.action.alignPanelJustify"};function PJ(r,t,e,i,n){return{id:r,title:t,shortLabel:e,value:i,when:n}}function c0(r,t,e,i){return PJ(r,t,e,i,au.notEqualsTo(Mr(i)))}function u0(r,t,e,i){return PJ(r,t,e,i,Ll.notEqualsTo(i))}var zce=[c0(l0.TOP,pe("positionPanelTop","Move Panel To Top"),h("positionPanelTopShort","Top"),3),c0(l0.LEFT,pe("positionPanelLeft","Move Panel Left"),h("positionPanelLeftShort","Left"),0),c0(l0.RIGHT,pe("positionPanelRight","Move Panel Right"),h("positionPanelRightShort","Right"),1),c0(l0.BOTTOM,pe("positionPanelBottom","Move Panel To Bottom"),h("positionPanelBottomShort","Bottom"),2)],Kce=[u0(d0.LEFT,pe("alignPanelLeft","Set Panel Alignment to Left"),h("alignPanelLeftShort","Left"),"left"),u0(d0.RIGHT,pe("alignPanelRight","Set Panel Alignment to Right"),h("alignPanelRightShort","Right"),"right"),u0(d0.CENTER,pe("alignPanelCenter","Set Panel Alignment to Center"),h("alignPanelCenterShort","Center"),"center"),u0(d0.JUSTIFY,pe("alignPanelJustify","Set Panel Alignment to Justify"),h("alignPanelJustifyShort","Justify"),"justify")];Ct.appendMenuItem(ee.MenubarAppearanceMenu,{submenu:ee.PanelPositionMenu,title:h("positionPanel","Panel Position"),group:"3_workbench_layout_move",order:4});zce.forEach((r,t)=>{let{id:e,title:i,shortLabel:n,value:o,when:s}=r;Me(class extends We{constructor(){super({id:e,title:i,category:gt.View,f1:!0})}run(a){a.get(Qe).setPanelPosition(o===void 0?2:o)}}),Ct.appendMenuItem(ee.PanelPositionMenu,{command:{id:e,title:n,toggled:s.negate()},order:5+t})});Ct.appendMenuItem(ee.MenubarAppearanceMenu,{submenu:ee.PanelAlignmentMenu,title:h("alignPanel","Align Panel"),group:"3_workbench_layout_move",order:5});Kce.forEach(r=>{let{id:t,title:e,shortLabel:i,value:n,when:o}=r;Me(class extends We{constructor(){super({id:t,title:e,category:gt.View,toggled:o.negate(),f1:!0})}run(s){s.get(Qe).setPanelAlignment(n===void 0?"center":n)}}),Ct.appendMenuItem(ee.PanelAlignmentMenu,{command:{id:t,title:i,toggled:o.negate()},order:5})});var p0=class extends We{constructor(t,e){super({id:t,title:e,category:gt.View,f1:!0})}async run(t,e){let i=t.get(hs),n=i.getVisiblePaneCompositeIds(1),o=i.getActivePaneComposite(1);if(!o)return;let s;for(let a=0;a<n.length;a++)if(n[a]===o.getId()){s=n[(a+n.length+e)%n.length];break}typeof s=="string"&&await i.openPaneComposite(s,1,!0)}};Me(class extends p0{constructor(){super("workbench.action.previousPanelView",pe("previousPanelView","Previous Panel View"))}run(r){return super.run(r,-1)}});Me(class extends p0{constructor(){super("workbench.action.nextPanelView",pe("nextPanelView","Next Panel View"))}run(r){return super.run(r,1)}});Me(class extends We{constructor(){super({id:"workbench.action.toggleMaximizedPanel",title:pe("toggleMaximizedPanel","Toggle Maximized Panel"),tooltip:h("maximizePanel","Maximize Panel Size"),category:gt.View,f1:!0,icon:Vce,precondition:X.or(Ll.isEqualTo("center"),X.and(au.notEqualsTo("bottom"),au.notEqualsTo("top"))),toggled:{condition:ZP,icon:Wce,tooltip:h("minimizePanel","Restore Panel Size")},menu:[{id:ee.PanelTitle,group:"navigation",order:1,when:X.or(Ll.isEqualTo("center"),X.and(au.notEqualsTo("bottom"),au.notEqualsTo("top")))}]})}run(r){let t=r.get(Qe),e=r.get(jt);if(t.getPanelAlignment()!=="center"&&ho(t.getPanelPosition())){e.warn(h("panelMaxNotSupported","Maximizing the panel is only supported when it is center aligned."));return}t.isVisible("workbench.parts.panel")?t.toggleMaximizedPanel():(t.setPartHidden(!1,"workbench.parts.panel"),t.isPanelMaximized()||t.toggleMaximizedPanel())}});Me(class extends We{constructor(){super({id:"workbench.action.closePanel",title:pe("closePanel","Hide Panel"),category:gt.View,icon:AJ,menu:[{id:ee.CommandPalette,when:Rp},{id:ee.PanelTitle,group:"navigation",order:2}]})}run(r){r.get(Qe).setPartHidden(!0,"workbench.parts.panel")}});Me(class extends We{constructor(){super({id:"workbench.action.closeAuxiliaryBar",title:pe("closeSecondarySideBar","Hide Secondary Side Bar"),category:gt.View,icon:AJ,menu:[{id:ee.CommandPalette,when:Dl},{id:ee.AuxiliaryBarTitle,group:"navigation",order:2,when:X.notEquals("config.workbench.activityBar.location","top")}]})}run(r){r.get(Qe).setPartHidden(!0,"workbench.parts.auxiliarybar")}});Ct.appendMenuItems([{id:ee.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:vu.ID,title:h("togglePanel","Toggle Panel"),icon:Hce,toggled:{condition:Rp,icon:Uce}},when:X.or(X.equals("config.workbench.layoutControl.type","toggles"),X.equals("config.workbench.layoutControl.type","both")),order:1}},{id:ee.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:vu.ID,title:pe("hidePanel","Hide Panel")},when:X.and(Rp,X.equals("viewLocation",go(1))),order:2}}]);var VI=class extends We{constructor(e,i,n){super(n);this.source=e;this.destination=i}run(e,...i){let n=e.get(zi),o=e.get(Qe),s=e.get(va),a=n.getViewContainersByLocation(this.source),l=n.getViewContainersByLocation(this.destination);if(a.length){let d=s.getVisibleViewContainer(this.source);a.forEach(c=>n.moveViewContainerToLocation(c,this.destination,void 0,this.desc.id)),o.setPartHidden(!1,this.destination===1?"workbench.parts.panel":"workbench.parts.auxiliarybar"),d&&l.length===0&&s.openViewContainer(d.id,!0)}}},o4=class r extends VI{static ID="workbench.action.movePanelToSidePanel";constructor(){super(1,2,{id:r.ID,title:pe("movePanelToSecondarySideBar","Move Panel Views To Secondary Side Bar"),category:gt.View,f1:!1})}},r4=class r extends VI{static ID="workbench.action.movePanelToSecondarySideBar";constructor(){super(1,2,{id:r.ID,title:pe("movePanelToSecondarySideBar","Move Panel Views To Secondary Side Bar"),category:gt.View,f1:!0})}};Me(o4);Me(r4);var s4=class r extends VI{static ID="workbench.action.moveSidePanelToPanel";constructor(){super(2,1,{id:r.ID,title:pe("moveSidePanelToPanel","Move Secondary Side Bar Views To Panel"),category:gt.View,f1:!1})}},a4=class r extends VI{static ID="workbench.action.moveSecondarySideBarToPanel";constructor(){super(2,1,{id:r.ID,title:pe("moveSidePanelToPanel","Move Secondary Side Bar Views To Panel"),category:gt.View,f1:!0})}};Me(s4);Me(a4);var $ce=Tt("menuBar",B.layoutMenubar,h("menuBarIcon","Represents the menu bar")),Yce=Tt("activity-bar-left",B.layoutActivitybarLeft,h("activityBarLeft","Represents the activity bar in the left position")),Zce=Tt("activity-bar-right",B.layoutActivitybarRight,h("activityBarRight","Represents the activity bar in the right position")),h0=Tt("panel-left",B.layoutSidebarLeft,h("panelLeft","Represents a side bar in the left position")),Xce=Tt("panel-left-off",B.layoutSidebarLeftOff,h("panelLeftOff","Represents a side bar in the left position toggled off")),m0=Tt("panel-right",B.layoutSidebarRight,h("panelRight","Represents side bar in the right position")),Qce=Tt("panel-right-off",B.layoutSidebarRightOff,h("panelRightOff","Represents side bar in the right position toggled off")),Jce=Tt("panel-bottom",B.layoutPanel,h("panelBottom","Represents the bottom panel")),eue=Tt("statusBar",B.layoutStatusbar,h("statusBarIcon","Represents the status bar")),tue=Tt("panel-align-left",B.layoutPanelLeft,h("panelBottomLeft","Represents the bottom panel alignment set to the left")),iue=Tt("panel-align-right",B.layoutPanelRight,h("panelBottomRight","Represents the bottom panel alignment set to the right")),nue=Tt("panel-align-center",B.layoutPanelCenter,h("panelBottomCenter","Represents the bottom panel alignment set to the center")),oue=Tt("panel-align-justify",B.layoutPanelJustify,h("panelBottomJustify","Represents the bottom panel alignment set to justified")),rue=Tt("fullscreen",B.screenFull,h("fullScreenIcon","Represents full screen")),sue=Tt("centerLayoutIcon",B.layoutCentered,h("centerLayoutIcon","Represents centered layout mode")),aue=Tt("zenMode",B.target,h("zenModeIcon","Represents zen mode"));Me(class extends We{constructor(){super({id:"workbench.action.closeSidebar",title:pe("closeSidebar","Close Primary Side Bar"),category:gt.View,f1:!0})}run(r){r.get(Qe).setPartHidden(!0,"workbench.parts.sidebar")}});var x4="workbench.action.toggleActivityBarVisibility";Me(class extends We{constructor(){super({id:"workbench.action.toggleCenteredLayout",title:{...pe("toggleCenteredLayout","Toggle Centered Layout"),mnemonicTitle:h({key:"miToggleCenteredLayout",comment:["&& denotes a mnemonic"]},"&&Centered Layout")},precondition:ps.toNegated(),category:gt.View,f1:!0,toggled:_T,menu:[{id:ee.MenubarAppearanceMenu,group:"1_toggle_view",order:3}]})}run(r){let t=r.get(Qe);t.centerMainEditorLayout(!t.isMainEditorLayoutCentered())}});var OJ="workbench.sideBar.location",g0=class extends We{constructor(e,i,n){super({id:e,title:i,f1:!1});this.position=n}async run(e){let i=e.get(Qe),n=e.get(de);if(i.getSideBarPosition()!==this.position)return n.updateValue(OJ,Mr(this.position))}},f0=class r extends g0{static ID="workbench.action.moveSideBarRight";constructor(){super(r.ID,pe("moveSidebarRight","Move Primary Side Bar Right"),1)}},b0=class r extends g0{static ID="workbench.action.moveSideBarLeft";constructor(){super(r.ID,pe("moveSidebarLeft","Move Primary Side Bar Left"),0)}};Me(f0);Me(b0);var Fr=class r extends We{static ID="workbench.action.toggleSidebarPosition";static LABEL=h("toggleSidebarPosition","Toggle Primary Side Bar Position");static getLabel(t){return t.getSideBarPosition()===0?h("moveSidebarRight","Move Primary Side Bar Right"):h("moveSidebarLeft","Move Primary Side Bar Left")}constructor(){super({id:r.ID,title:pe("toggleSidebarPosition","Toggle Primary Side Bar Position"),category:gt.View,f1:!0})}run(t){let e=t.get(Qe),i=t.get(de),o=e.getSideBarPosition()===0?"right":"left";return i.updateValue(OJ,o)}};Me(Fr);var NJ=Tt("configure-layout-icon",B.layout,h("cofigureLayoutIcon","Icon represents workbench layout configuration."));Ct.appendMenuItem(ee.LayoutControlMenu,{submenu:ee.LayoutControlMenuSubmenu,title:h("configureLayout","Configure Layout"),icon:NJ,group:"1_workbench_layout",when:X.equals("config.workbench.layoutControl.type","menu")});Ct.appendMenuItems([{id:ee.ViewContainerTitleContext,item:{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h("move side bar right","Move Primary Side Bar Right")},when:X.and(X.notEquals("config.workbench.sideBar.location","right"),X.equals("viewContainerLocation",go(0))),order:1}},{id:ee.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h("move sidebar right","Move Primary Side Bar Right")},when:X.and(X.notEquals("config.workbench.sideBar.location","right"),X.equals("viewLocation",go(0))),order:1}},{id:ee.ViewContainerTitleContext,item:{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h("move sidebar left","Move Primary Side Bar Left")},when:X.and(X.equals("config.workbench.sideBar.location","right"),X.equals("viewContainerLocation",go(0))),order:1}},{id:ee.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h("move sidebar left","Move Primary Side Bar Left")},when:X.and(X.equals("config.workbench.sideBar.location","right"),X.equals("viewLocation",go(0))),order:1}},{id:ee.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h("move second sidebar left","Move Secondary Side Bar Left")},when:X.and(X.notEquals("config.workbench.sideBar.location","right"),X.equals("viewLocation",go(2))),order:1}},{id:ee.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h("move second sidebar right","Move Secondary Side Bar Right")},when:X.and(X.equals("config.workbench.sideBar.location","right"),X.equals("viewLocation",go(2))),order:1}}]);Ct.appendMenuItem(ee.MenubarAppearanceMenu,{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h({key:"miMoveSidebarRight",comment:["&& denotes a mnemonic"]},"&&Move Primary Side Bar Right")},when:X.notEquals("config.workbench.sideBar.location","right"),order:2});Ct.appendMenuItem(ee.MenubarAppearanceMenu,{group:"3_workbench_layout_move",command:{id:Fr.ID,title:h({key:"miMoveSidebarLeft",comment:["&& denotes a mnemonic"]},"&&Move Primary Side Bar Left")},when:X.equals("config.workbench.sideBar.location","right"),order:2});Me(class extends We{constructor(){super({id:"workbench.action.toggleEditorVisibility",title:{...pe("toggleEditor","Toggle Editor Area Visibility"),mnemonicTitle:h({key:"miShowEditorArea",comment:["&& denotes a mnemonic"]},"Show &&Editor Area")},category:gt.View,f1:!0,toggled:YP,precondition:X.and(ps.toNegated(),X.or(Ll.isEqualTo("center"),au.notEqualsTo("bottom")))})}run(r){r.get(Qe).toggleMaximizedPanel()}});Ct.appendMenuItem(ee.MenubarViewMenu,{group:"2_appearance",title:h({key:"miAppearance",comment:["&& denotes a mnemonic"]},"&&Appearance"),submenu:ee.MenubarAppearanceMenu,order:1});var Pm=class r extends We{static ID="workbench.action.toggleSidebarVisibility";constructor(){super({id:r.ID,title:pe("toggleSidebar","Toggle Primary Side Bar Visibility"),toggled:{condition:su,title:h("primary sidebar","Primary Side Bar"),mnemonicTitle:h({key:"primary sidebar mnemonic",comment:["&& denotes a mnemonic"]},"&&Primary Side Bar")},category:gt.View,f1:!0,keybinding:{weight:200,primary:2080},menu:[{id:ee.LayoutControlMenuSubmenu,group:"0_workbench_layout",order:0},{id:ee.MenubarAppearanceMenu,group:"2_workbench_layout",order:1}]})}run(t){let e=t.get(Qe);e.setPartHidden(e.isVisible("workbench.parts.sidebar"),"workbench.parts.sidebar")}};Me(Pm);Ct.appendMenuItems([{id:ee.ViewContainerTitleContext,item:{group:"3_workbench_layout_move",command:{id:Pm.ID,title:h("compositePart.hideSideBarLabel","Hide Primary Side Bar")},when:X.and(su,X.equals("viewContainerLocation",go(0))),order:2}},{id:ee.ViewTitleContext,item:{group:"3_workbench_layout_move",command:{id:Pm.ID,title:h("compositePart.hideSideBarLabel","Hide Primary Side Bar")},when:X.and(su,X.equals("viewLocation",go(0))),order:2}},{id:ee.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:Pm.ID,title:h("toggleSideBar","Toggle Primary Side Bar"),icon:Xce,toggled:{condition:su,icon:h0}},when:X.and(X.or(X.equals("config.workbench.layoutControl.type","toggles"),X.equals("config.workbench.layoutControl.type","both")),X.equals("config.workbench.sideBar.location","left")),order:0}},{id:ee.LayoutControlMenu,item:{group:"0_workbench_toggles",command:{id:Pm.ID,title:h("toggleSideBar","Toggle Primary Side Bar"),icon:Qce,toggled:{condition:su,icon:m0}},when:X.and(X.or(X.equals("config.workbench.layoutControl.type","toggles"),X.equals("config.workbench.layoutControl.type","both")),X.equals("config.workbench.sideBar.location","right")),order:2}}]);var Qf=class r extends We{static ID="workbench.action.toggleStatusbarVisibility";static statusbarVisibleKey="workbench.statusBar.visible";constructor(){super({id:r.ID,title:{...pe("toggleStatusbar","Toggle Status Bar Visibility"),mnemonicTitle:h({key:"miStatusbar",comment:["&& denotes a mnemonic"]},"S&&tatus Bar")},category:gt.View,f1:!0,toggled:X.equals("config.workbench.statusBar.visible",!0),menu:[{id:ee.MenubarAppearanceMenu,group:"2_workbench_layout",order:3}]})}run(t){let e=t.get(Qe),i=t.get(de),o=!e.isVisible("workbench.parts.statusbar",ne);return i.updateValue(r.statusbarVisibleKey,o)}};Me(Qf);var Mm=class extends We{constructor(e,i,n,o,s,a){super({id:o,title:n,category:gt.View,precondition:s,metadata:a?{description:a}:void 0,f1:!0});this.settingName=e;this.value=i}run(e){return e.get(de).updateValue(this.settingName,this.value)}},l4=class r extends Mm{static ID="workbench.action.hideEditorTabs";constructor(){let t=X.and(X.equals("config.workbench.editor.showTabs","none").negate(),As.negate()),e=pe("hideEditorTabs","Hide Editor Tabs");super("workbench.editor.showTabs","none",e,r.ID,t,pe("hideEditorTabsDescription","Hide Tab Bar"))}},d4=class r extends Mm{static ID="workbench.action.zenHideEditorTabs";constructor(){let t=X.and(X.equals("config.zenMode.showTabs","none").negate(),As),e=pe("hideEditorTabsZenMode","Hide Editor Tabs in Zen Mode");super("zenMode.showTabs","none",e,r.ID,t,pe("hideEditorTabsZenModeDescription","Hide Tab Bar in Zen Mode"))}},c4=class r extends Mm{static ID="workbench.action.showMultipleEditorTabs";constructor(){let t=X.and(X.equals("config.workbench.editor.showTabs","multiple").negate(),As.negate()),e=pe("showMultipleEditorTabs","Show Multiple Editor Tabs");super("workbench.editor.showTabs","multiple",e,r.ID,t,pe("showMultipleEditorTabsDescription","Show Tab Bar with multiple tabs"))}},u4=class r extends Mm{static ID="workbench.action.zenShowMultipleEditorTabs";constructor(){let t=X.and(X.equals("config.zenMode.showTabs","multiple").negate(),As),e=pe("showMultipleEditorTabsZenMode","Show Multiple Editor Tabs in Zen Mode");super("zenMode.showTabs","multiple",e,r.ID,t,pe("showMultipleEditorTabsZenModeDescription","Show Tab Bar in Zen Mode"))}},p4=class r extends Mm{static ID="workbench.action.showEditorTab";constructor(){let t=X.and(X.equals("config.workbench.editor.showTabs","single").negate(),As.negate()),e=pe("showSingleEditorTab","Show Single Editor Tab");super("workbench.editor.showTabs","single",e,r.ID,t,pe("showSingleEditorTabDescription","Show Tab Bar with one Tab"))}},h4=class r extends Mm{static ID="workbench.action.zenShowEditorTab";constructor(){let t=X.and(X.equals("config.zenMode.showTabs","single").negate(),As),e=pe("showSingleEditorTabZenMode","Show Single Editor Tab in Zen Mode");super("zenMode.showTabs","single",e,r.ID,t,pe("showSingleEditorTabZenModeDescription","Show Tab Bar in Zen Mode with one Tab"))}};Me(l4);Me(d4);Me(c4);Me(u4);Me(p4);Me(h4);Ct.appendMenuItem(ee.MenubarAppearanceMenu,{submenu:ee.EditorTabsBarShowTabsSubmenu,title:h("tabBar","Tab Bar"),group:"3_workbench_layout_move",order:10,when:As.negate()});Ct.appendMenuItem(ee.MenubarAppearanceMenu,{submenu:ee.EditorTabsBarShowTabsZenModeSubmenu,title:h("tabBar","Tab Bar"),group:"3_workbench_layout_move",order:10,when:As});var m4=class r extends We{static ID="workbench.action.editorActionsTitleBar";constructor(){super({id:r.ID,title:pe("moveEditorActionsToTitleBar","Move Editor Actions to Title Bar"),category:gt.View,precondition:X.equals("config.workbench.editor.editorActionsLocation","titleBar").negate(),metadata:{description:pe("moveEditorActionsToTitleBarDescription","Move Editor Actions from the tab bar to the title bar")},f1:!0})}run(t){return t.get(de).updateValue("workbench.editor.editorActionsLocation","titleBar")}};Me(m4);var g4=class r extends We{static ID="workbench.action.editorActionsDefault";constructor(){super({id:r.ID,title:pe("moveEditorActionsToTabBar","Move Editor Actions to Tab Bar"),category:gt.View,precondition:X.and(X.equals("config.workbench.editor.editorActionsLocation","default").negate(),X.equals("config.workbench.editor.showTabs","none").negate()),metadata:{description:pe("moveEditorActionsToTabBarDescription","Move Editor Actions from the title bar to the tab bar")},f1:!0})}run(t){return t.get(de).updateValue("workbench.editor.editorActionsLocation","default")}};Me(g4);var f4=class r extends We{static ID="workbench.action.hideEditorActions";constructor(){super({id:r.ID,title:pe("hideEditorActons","Hide Editor Actions"),category:gt.View,precondition:X.equals("config.workbench.editor.editorActionsLocation","hidden").negate(),metadata:{description:pe("hideEditorActonsDescription","Hide Editor Actions in the tab and title bar")},f1:!0})}run(t){return t.get(de).updateValue("workbench.editor.editorActionsLocation","hidden")}};Me(f4);var b4=class r extends We{static ID="workbench.action.showEditorActions";constructor(){super({id:r.ID,title:pe("showEditorActons","Show Editor Actions"),category:gt.View,precondition:X.equals("config.workbench.editor.editorActionsLocation","hidden"),metadata:{description:pe("showEditorActonsDescription","Make Editor Actions visible.")},f1:!0})}run(t){return t.get(de).updateValue("workbench.editor.editorActionsLocation","default")}};Me(b4);Ct.appendMenuItem(ee.MenubarAppearanceMenu,{submenu:ee.EditorActionsPositionSubmenu,title:h("editorActionsPosition","Editor Actions Position"),group:"3_workbench_layout_move",order:11});var v4=class r extends We{static ID="workbench.action.configureEditorTabs";constructor(){super({id:r.ID,title:pe("configureTabs","Configure Tabs"),category:gt.View})}run(t){t.get(Ld).openSettings({jsonEditor:!1,query:"workbench.editor tab"})}};Me(v4);var y4=class r extends We{static ID="workbench.action.configureEditor";constructor(){super({id:r.ID,title:pe("configureEditors","Configure Editors"),category:gt.View})}run(t){t.get(Ld).openSettings({jsonEditor:!1,query:"workbench.editor"})}};Me(y4);Me(class extends We{constructor(){super({id:"workbench.action.toggleSeparatePinnedEditorTabs",title:pe("toggleSeparatePinnedEditorTabs","Separate Pinned Editor Tabs"),category:gt.View,precondition:X.equals("config.workbench.editor.showTabs","multiple"),metadata:{description:pe("toggleSeparatePinnedEditorTabsDescription","Toggle whether pinned editor tabs are shown on a separate row above unpinned tabs.")},f1:!0})}run(r){let t=r.get(de),i=!t.getValue("workbench.editor.pinnedTabsOnSeparateRow");return t.updateValue("workbench.editor.pinnedTabsOnSeparateRow",i)}});Me(class extends We{constructor(){super({id:"workbench.action.toggleZenMode",title:{...pe("toggleZenMode","Toggle Zen Mode"),mnemonicTitle:h({key:"miToggleZenMode",comment:["&& denotes a mnemonic"]},"Zen Mode")},precondition:ps.toNegated(),category:gt.View,f1:!0,keybinding:{weight:200,primary:Kr(2089,56)},toggled:As,menu:[{id:ee.MenubarAppearanceMenu,group:"1_toggle_view",order:2}]})}run(r){return r.get(Qe).toggleZenMode()}});Zt.registerCommandAndKeybindingRule({id:"workbench.action.exitZenMode",weight:-900,handler(r){let t=r.get(Qe),e=r.get(ke);As.getValue(e)&&t.toggleZenMode()},when:As,primary:Kr(9,9)});if(rt||_t||wt){Me(class extends We{constructor(){super({id:"workbench.action.toggleMenuBar",title:{...pe("toggleMenuBar","Toggle Menu Bar"),mnemonicTitle:h({key:"miMenuBar",comment:["&& denotes a mnemonic"]},"Menu &&Bar")},category:gt.View,f1:!0,toggled:X.and(eu.toNegated(),X.notEquals("config.window.menuBarVisibility","hidden"),X.notEquals("config.window.menuBarVisibility","toggle"),X.notEquals("config.window.menuBarVisibility","compact")),menu:[{id:ee.MenubarAppearanceMenu,group:"2_workbench_layout",order:0}]})}run(t){return t.get(Qe).toggleMenuBar()}});for(let r of[ee.TitleBarContext,ee.TitleBarTitleContext])Ct.appendMenuItem(r,{command:{id:"workbench.action.toggleMenuBar",title:h("miMenuBarNoMnemonic","Menu Bar"),toggled:X.and(eu.toNegated(),X.notEquals("config.window.menuBarVisibility","hidden"),X.notEquals("config.window.menuBarVisibility","toggle"),X.notEquals("config.window.menuBarVisibility","compact"))},when:X.and(ps.toNegated(),X.notEquals(Im.key,"native"),Ga.negate()),group:"2_config",order:0})}Me(class extends We{constructor(){super({id:"workbench.action.resetViewLocations",title:pe("resetViewLocations","Reset View Locations"),category:gt.View,f1:!0})}run(r){return r.get(zi).reset()}});Me(class extends We{constructor(){super({id:"workbench.action.moveView",title:pe("moveView","Move View"),category:gt.View,f1:!0})}async run(r){let t=r.get(zi),e=r.get(ae),i=r.get($o),n=r.get(ke),o=r.get(hs),s=kl.getValue(n),a;s&&t.getViewDescriptorById(s)?.canMoveView&&(a=s);try{if(a=await this.getView(i,t,o,a),!a)return;let l=new v0;e.invokeFunction(d=>l.run(d,a))}catch{}}getViewItems(r,t){let e=[];return t.getVisiblePaneCompositeIds(0).forEach(s=>{let a=r.getViewContainerById(s),l=r.getViewContainerModel(a),d=!1;l.visibleViewDescriptors.forEach(c=>{c.canMoveView&&(d||(e.push({type:"separator",label:h("sidebarContainer","Side Bar / {0}",l.title)}),d=!0),e.push({id:c.id,label:c.name.value}))})}),t.getPinnedPaneCompositeIds(1).forEach(s=>{let a=r.getViewContainerById(s),l=r.getViewContainerModel(a),d=!1;l.visibleViewDescriptors.forEach(c=>{c.canMoveView&&(d||(e.push({type:"separator",label:h("panelContainer","Panel / {0}",l.title)}),d=!0),e.push({id:c.id,label:c.name.value}))})}),t.getPinnedPaneCompositeIds(2).forEach(s=>{let a=r.getViewContainerById(s),l=r.getViewContainerModel(a),d=!1;l.visibleViewDescriptors.forEach(c=>{c.canMoveView&&(d||(e.push({type:"separator",label:h("secondarySideBarContainer","Secondary Side Bar / {0}",l.title)}),d=!0),e.push({id:c.id,label:c.name.value}))})}),e}async getView(r,t,e,i){let n=new W,o=n.add(r.createQuickPick({useSeparators:!0}));return o.placeholder=h("moveFocusedView.selectView","Select a View to Move"),o.items=this.getViewItems(t,e),o.selectedItems=o.items.filter(s=>s.id===i),new Promise((s,a)=>{n.add(o.onDidAccept(()=>{let l=o.selectedItems[0];l.id?s(l.id):a(),o.hide()})),n.add(o.onDidHide(()=>{n.dispose(),a()})),o.show()})}});var v0=class extends We{constructor(){super({id:"workbench.action.moveFocusedView",title:pe("moveFocusedView","Move Focused View"),category:gt.View,precondition:kl.notEqualsTo(""),f1:!0})}run(t,e){let i=t.get(zi),n=t.get(va),o=t.get($o),s=t.get(ke),a=t.get(Ar),l=t.get(hs),d=e||kl.getValue(s);if(d===void 0||d.trim()===""){a.error(h("moveFocusedView.error.noFocusedView","There is no view currently focused."));return}let c=i.getViewDescriptorById(d);if(!c||!c.canMoveView){a.error(h("moveFocusedView.error.nonMovableView","The currently focused view is not movable."));return}let u=new W,p=u.add(o.createQuickPick({useSeparators:!0}));p.placeholder=h("moveFocusedView.selectDestination","Select a Destination for the View"),p.title=h({key:"moveFocusedView.title",comment:["{0} indicates the title of the view the user has selected to move."]},"View: Move {0}",c.name.value);let m=[],g=i.getViewContainerByViewId(d),f=i.getViewLocationById(d),b=i.getViewContainerModel(g).allViewDescriptors.length===1;b&&f===1||m.push({id:"_.panel.newcontainer",label:h({key:"moveFocusedView.newContainerInPanel",comment:["Creates a new top-level tab in the panel."]},"New Panel Entry")}),b&&f===0||m.push({id:"_.sidebar.newcontainer",label:h("moveFocusedView.newContainerInSidebar","New Side Bar Entry")}),b&&f===2||m.push({id:"_.auxiliarybar.newcontainer",label:h("moveFocusedView.newContainerInSidePanel","New Secondary Side Bar Entry")}),m.push({type:"separator",label:h("sidebar","Side Bar")});let y=l.getVisiblePaneCompositeIds(0);m.push(...y.filter(S=>S===i.getViewContainerByViewId(d).id?!1:!i.getViewContainerById(S).rejectAddedViews).map(S=>({id:S,label:i.getViewContainerModel(i.getViewContainerById(S)).title}))),m.push({type:"separator",label:h("panel","Panel")});let I=l.getPinnedPaneCompositeIds(1);m.push(...I.filter(S=>S===i.getViewContainerByViewId(d).id?!1:!i.getViewContainerById(S).rejectAddedViews).map(S=>({id:S,label:i.getViewContainerModel(i.getViewContainerById(S)).title}))),m.push({type:"separator",label:h("secondarySideBar","Secondary Side Bar")});let E=l.getPinnedPaneCompositeIds(2);m.push(...E.filter(S=>S===i.getViewContainerByViewId(d).id?!1:!i.getViewContainerById(S).rejectAddedViews).map(S=>({id:S,label:i.getViewContainerModel(i.getViewContainerById(S)).title}))),p.items=m,u.add(p.onDidAccept(()=>{let S=p.selectedItems[0];S.id==="_.panel.newcontainer"?(i.moveViewToLocation(c,1,this.desc.id),n.openView(d,!0)):S.id==="_.sidebar.newcontainer"?(i.moveViewToLocation(c,0,this.desc.id),n.openView(d,!0)):S.id==="_.auxiliarybar.newcontainer"?(i.moveViewToLocation(c,2,this.desc.id),n.openView(d,!0)):S.id&&(i.moveViewsToContainer([c],i.getViewContainerById(S.id),void 0,this.desc.id),n.openView(d,!0)),p.hide()})),u.add(p.onDidHide(()=>u.dispose())),p.show()}};Me(v0);Me(class extends We{constructor(){super({id:"workbench.action.resetFocusedViewLocation",title:pe("resetFocusedViewLocation","Reset Focused View Location"),category:gt.View,f1:!0,precondition:kl.notEqualsTo("")})}run(r){let t=r.get(zi),e=r.get(ke),i=r.get(Ar),n=r.get(va),o=kl.getValue(e),s=null;if(o!==void 0&&o.trim()!==""&&(s=t.getViewDescriptorById(o)),!s){i.error(h("resetFocusedView.error.noFocusedView","There is no view currently focused."));return}let a=t.getDefaultContainerById(s.id);!a||a===t.getViewContainerByViewId(s.id)||(t.moveViewsToContainer([s],a,void 0,this.desc.id),n.openView(s.id,!0))}});var ms=class extends We{static RESIZE_INCREMENT=60;resizePart(t,e,i,n){let o;if(n===void 0){let s=i.hasFocus("workbench.parts.editor"),a=i.hasFocus("workbench.parts.sidebar"),l=i.hasFocus("workbench.parts.panel"),d=i.hasFocus("workbench.parts.auxiliarybar");a?o="workbench.parts.sidebar":l?o="workbench.parts.panel":s?o="workbench.parts.editor":d&&(o="workbench.parts.auxiliarybar")}else o=n;o&&i.resizePart(o,t,e)}},I4=class extends ms{constructor(){super({id:"workbench.action.increaseViewSize",title:pe("increaseViewSize","Increase Current View Size"),f1:!0,precondition:ps.toNegated()})}run(t){this.resizePart(ms.RESIZE_INCREMENT,ms.RESIZE_INCREMENT,t.get(Qe))}},C4=class extends ms{constructor(){super({id:"workbench.action.increaseViewWidth",title:pe("increaseEditorWidth","Increase Editor Width"),f1:!0,precondition:ps.toNegated()})}run(t){this.resizePart(ms.RESIZE_INCREMENT,0,t.get(Qe),"workbench.parts.editor")}},S4=class extends ms{constructor(){super({id:"workbench.action.increaseViewHeight",title:pe("increaseEditorHeight","Increase Editor Height"),f1:!0,precondition:ps.toNegated()})}run(t){this.resizePart(0,ms.RESIZE_INCREMENT,t.get(Qe),"workbench.parts.editor")}},w4=class extends ms{constructor(){super({id:"workbench.action.decreaseViewSize",title:pe("decreaseViewSize","Decrease Current View Size"),f1:!0,precondition:ps.toNegated()})}run(t){this.resizePart(-ms.RESIZE_INCREMENT,-ms.RESIZE_INCREMENT,t.get(Qe))}},E4=class extends ms{constructor(){super({id:"workbench.action.decreaseViewWidth",title:pe("decreaseEditorWidth","Decrease Editor Width"),f1:!0,precondition:ps.toNegated()})}run(t){this.resizePart(-ms.RESIZE_INCREMENT,0,t.get(Qe),"workbench.parts.editor")}},T4=class extends ms{constructor(){super({id:"workbench.action.decreaseViewHeight",title:pe("decreaseEditorHeight","Decrease Editor Height"),f1:!0,precondition:ps.toNegated()})}run(t){this.resizePart(0,-ms.RESIZE_INCREMENT,t.get(Qe),"workbench.parts.editor")}};Me(I4);Me(C4);Me(S4);Me(w4);Me(E4);Me(T4);function lue(r){return r.iconA!==void 0}var UI=(r,t,e,i)=>({id:r,active:t,label:e,visualIcon:i,activeIcon:B.eye,inactiveIcon:B.eyeClosed,activeAriaLabel:h("selectToHide","Select to Hide"),inactiveAriaLabel:h("selectToShow","Select to Show"),useButtons:!0}),zp=(r,t,e,i)=>({id:r,active:t,label:e,visualIcon:i,activeIcon:B.check,activeAriaLabel:h("active","Active"),useButtons:!1}),due=X.and(eu.toNegated(),X.notEquals("config.window.menuBarVisibility","hidden"),X.notEquals("config.window.menuBarVisibility","toggle"),X.notEquals("config.window.menuBarVisibility","compact")),y0=[];(!be||!Pi)&&y0.push(UI("workbench.action.toggleMenuBar",due,h("menuBar","Menu Bar"),$ce));y0.push(UI(x4,X.notEquals("config.workbench.activityBar.location","hidden"),h("activityBar","Activity Bar"),{whenA:X.equals("config.workbench.sideBar.location","left"),iconA:Yce,iconB:Zce}),UI(Pm.ID,su,h("sideBar","Primary Side Bar"),{whenA:X.equals("config.workbench.sideBar.location","left"),iconA:h0,iconB:m0}),UI(Ol.ID,Dl,h("secondarySideBar","Secondary Side Bar"),{whenA:X.equals("config.workbench.sideBar.location","left"),iconA:m0,iconB:h0}),UI(vu.ID,Rp,h("panel","Panel"),Jce),UI(Qf.ID,X.equals("config.workbench.statusBar.visible",!0),h("statusBar","Status Bar"),eue));var FJ=[zp(b0.ID,X.equals("config.workbench.sideBar.location","left"),h("leftSideBar","Left"),h0),zp(f0.ID,X.equals("config.workbench.sideBar.location","right"),h("rightSideBar","Right"),m0)],BJ=[zp("workbench.action.alignPanelLeft",Ll.isEqualTo("left"),h("leftPanel","Left"),tue),zp("workbench.action.alignPanelRight",Ll.isEqualTo("right"),h("rightPanel","Right"),iue),zp("workbench.action.alignPanelCenter",Ll.isEqualTo("center"),h("centerPanel","Center"),nue),zp("workbench.action.alignPanelJustify",Ll.isEqualTo("justify"),h("justifyPanel","Justify"),oue)],VJ=[zp("workbench.action.toggleFullScreen",Ga,h("fullscreen","Full Screen"),rue),zp("workbench.action.toggleZenMode",As,h("zenMode","Zen Mode"),aue),zp("workbench.action.toggleCenteredLayout",_T,h("centeredLayout","Centered Layout"),sue)],WJ=new Set;for(let{active:r}of[...y0,...FJ,...BJ,...VJ])for(let t of r.keys())WJ.add(t);Me(class extends We{_currentQuickPick;constructor(){super({id:"workbench.action.customizeLayout",title:pe("customizeLayout","Customize Layout..."),f1:!0,icon:NJ,menu:[{id:ee.LayoutControlMenuSubmenu,group:"z_end"},{id:ee.LayoutControlMenu,when:X.equals("config.workbench.layoutControl.type","both"),group:"z_end"}]})}getItems(t,e){let i=n=>{let o=n.active.evaluate(t.getContext(null)),s=n.useButtons?n.label:n.label+(o&&n.activeIcon?` $(${n.activeIcon.id})`:!o&&n.inactiveIcon?` $(${n.inactiveIcon.id})`:""),a=n.label+(o&&n.activeAriaLabel?` (${n.activeAriaLabel})`:!o&&n.inactiveAriaLabel?` (${n.inactiveAriaLabel})`:"");if(n.visualIcon){let d=n.visualIcon;lue(d)&&(d=d.whenA.evaluate(t.getContext(null))?d.iconA:d.iconB),s=`$(${d.id}) ${s}`}let l=o?n.activeIcon:n.inactiveIcon;return{type:"item",id:n.id,label:s,ariaLabel:a,keybinding:e.lookupKeybinding(n.id,t),buttons:n.useButtons?[{alwaysVisible:!1,tooltip:a,iconClass:l?ye.asClassName(l):void 0}]:void 0}};return[{type:"separator",label:h("toggleVisibility","Visibility")},...y0.map(i),{type:"separator",label:h("sideBarPosition","Primary Side Bar Position")},...FJ.map(i),{type:"separator",label:h("panelAlignment","Panel Alignment")},...BJ.map(i),{type:"separator",label:h("layoutModes","Modes")},...VJ.map(i)]}run(t){if(this._currentQuickPick){this._currentQuickPick.hide();return}let e=t.get(de),i=t.get(ke),n=t.get(ni),o=t.get($o),s=t.get(at),a=new W,l=a.add(o.createQuickPick({useSeparators:!0}));this._currentQuickPick=l,l.items=this.getItems(i,s),l.ignoreFocusOut=!0,l.hideInput=!0,l.title=h("customizeLayoutQuickPickTitle","Customize Layout");let d={alwaysVisible:!0,iconClass:ye.asClassName(B.close),tooltip:h("close","Close")},c={alwaysVisible:!0,iconClass:ye.asClassName(B.discard),tooltip:h("restore defaults","Restore Defaults")};l.buttons=[c,d];let u;a.add(i.onDidChangeContext(p=>{p.affectsSome(WJ)&&(l.items=this.getItems(i,s),u&&(l.activeItems=l.items.filter(m=>m.id===u?.id)),setTimeout(()=>o.focus(),0))})),a.add(l.onDidAccept(p=>{l.selectedItems.length&&(u=l.selectedItems[0],n.executeCommand(u.id))})),a.add(l.onDidTriggerItemButton(p=>{p.item&&(u=p.item,n.executeCommand(u.id))})),a.add(l.onDidTriggerButton(p=>{if(p===d)l.hide();else if(p===c){let m=g=>{let f=e.inspect(g);e.updateValue(g,f.defaultValue)};m("workbench.activityBar.location"),m("workbench.sideBar.location"),m("workbench.statusBar.visible"),m("workbench.panel.defaultLocation"),(!be||!Pi)&&m("window.menuBarVisibility"),n.executeCommand("workbench.action.alignPanelCenter")}})),a.add(l.onDidHide(()=>{l.dispose()})),a.add(l.onDispose(()=>{this._currentQuickPick=void 0,a.dispose()})),l.show()}});var I0=class r extends L{constructor(e){super();this.storageService=e;this.restoreState(),this.registerListeners()}static HIDDEN_ENTRIES_KEY="workbench.statusbar.hidden";_onDidChangeEntryVisibility=this._register(new T);onDidChangeEntryVisibility=this._onDidChangeEntryVisibility.event;_entries=[];get entries(){return this._entries.slice(0)}_lastFocusedEntry;get lastFocusedEntry(){return this._lastFocusedEntry&&!this.isHidden(this._lastFocusedEntry.id)?this._lastFocusedEntry:void 0}hidden=new Set;restoreState(){let e=this.storageService.get(r.HIDDEN_ENTRIES_KEY,0);if(e)try{this.hidden=new Set(JSON.parse(e))}catch{}}registerListeners(){this._register(this.storageService.onDidChangeValue(0,r.HIDDEN_ENTRIES_KEY,this._register(new W))(()=>this.onDidStorageValueChange()))}onDidStorageValueChange(){let e=new Set(this.hidden);this.hidden.clear(),this.restoreState();let i=new Set;for(let n of e)this.hidden.has(n)||i.add(n);for(let n of this.hidden)e.has(n)||i.add(n);if(i.size>0)for(let n of this._entries)i.has(n.id)&&(this.updateVisibility(n.id,!0),i.delete(n.id))}add(e){this._entries.push(e),this.updateVisibility(e,!1),this.sort(),this.markFirstLastVisibleEntry()}remove(e){let i=this._entries.indexOf(e);i>=0&&(this._entries.splice(i,1),this._entries.some(n=>Jf(n.priority.primary)&&n.priority.primary.id===e.id)&&this.sort(),this.markFirstLastVisibleEntry())}isHidden(e){return this.hidden.has(e)}hide(e){this.hidden.has(e)||(this.hidden.add(e),this.updateVisibility(e,!0),this.saveState())}show(e){this.hidden.has(e)&&(this.hidden.delete(e),this.updateVisibility(e,!0),this.saveState())}findEntry(e){return this._entries.find(i=>i.container===e)}getEntries(e){return this._entries.filter(i=>i.alignment===e)}focusNextEntry(){this.focusEntry(1,0)}focusPreviousEntry(){this.focusEntry(-1,this.entries.length-1)}isEntryFocused(){return!!this.getFocusedEntry()}getFocusedEntry(){return this._entries.find(e=>Oa(e.container))}focusEntry(e,i){let n=a=>{let l=a,d=l>=0&&l<this._entries.length?this._entries[l]:void 0;for(;d&&this.isHidden(d.id);)l+=e,d=l>=0&&l<this._entries.length?this._entries[l]:void 0;return d},o=this.getFocusedEntry();if(o){let a=n(this._entries.indexOf(o)+e);if(a){this._lastFocusedEntry=a,a.labelContainer.focus();return}}let s=n(i);s&&(this._lastFocusedEntry=s,s.labelContainer.focus())}updateVisibility(e,i){if(typeof e=="string"){let n=e;for(let o of this._entries)o.id===n&&this.updateVisibility(o,i)}else{let n=e,o=this.isHidden(n.id);o?ys(n.container):rs(n.container),i&&this._onDidChangeEntryVisibility.fire({id:n.id,visible:!o}),this.markFirstLastVisibleEntry()}}saveState(){this.hidden.size>0?this.storageService.store(r.HIDDEN_ENTRIES_KEY,JSON.stringify(Array.from(this.hidden.values())),0,0):this.storageService.remove(r.HIDDEN_ENTRIES_KEY,0)}sort(){let e=new Map,i=new Map;for(let s=0;s<this._entries.length;s++){let a=this._entries[s];if(typeof a.priority.primary=="number")e.set(a,s);else{let l=a.priority.primary.id,d=i.get(l);if(!d){for(let c of i.values())if(c.has(l)){d=c;break}d||(d=new Map,i.set(l,d))}d.set(a.id,a)}}let n=Array.from(e.keys());n.sort((s,a)=>s.alignment===a.alignment?s.priority.primary!==a.priority.primary?Number(a.priority.primary)-Number(s.priority.primary):s.priority.secondary!==a.priority.secondary?a.priority.secondary-s.priority.secondary:e.get(s)-e.get(a):s.alignment===0?-1:a.alignment===0?1:0);let o;if(i.size>0){o=[];for(let s of n){let a=i.get(s.id),l=a?Array.from(a.values()):void 0;l&&o.push(...l.filter(d=>Jf(d.priority.primary)&&d.priority.primary.alignment===0)),o.push(s),l&&o.push(...l.filter(d=>Jf(d.priority.primary)&&d.priority.primary.alignment===1)),i.delete(s.id)}for(let[,s]of i)o.push(...s.values())}else o=n;this._entries=o}markFirstLastVisibleEntry(){this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(0)),this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(1))}doMarkFirstLastVisibleStatusbarItem(e){let i,n;for(let o of e)o.container.classList.remove("first-visible-item","last-visible-item"),!this.isHidden(o.id)&&(i||(i=o),n=o);i?.container.classList.add("first-visible-item"),n?.container.classList.add("last-visible-item")}};var C0=class extends ot{constructor(e,i,n){super(e,i,void 0,!0);this.model=n;this.checked=!n.isHidden(e)}async run(){this.model.isHidden(this.id)?this.model.show(this.id):this.model.hide(this.id)}},S0=class extends ot{constructor(e,i,n){super(e,h("hide","Hide '{0}'",i),void 0,!0);this.model=n}async run(){this.model.hide(this.id)}};Zt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusPrevious",weight:200,primary:15,secondary:[16],when:ym,handler:r=>{r.get(Bs).focusPreviousEntry()}});Zt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusNext",weight:200,primary:17,secondary:[18],when:ym,handler:r=>{r.get(Bs).focusNextEntry()}});Zt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusFirst",weight:200,primary:14,when:ym,handler:r=>{let t=r.get(Bs);t.focus(!1),t.focusNextEntry()}});Zt.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusLast",weight:200,primary:13,when:ym,handler:r=>{let t=r.get(Bs);t.focus(!1),t.focusPreviousEntry()}});Zt.registerCommandAndKeybindingRule({id:"workbench.statusBar.clearFocus",weight:200,primary:9,when:ym,handler:r=>{let t=r.get(Bs),e=r.get(kt);t.isEntryFocused()?t.focus(!1):e.activeEditorPane&&e.activeEditorPane.focus()}});var D4=class extends We{constructor(){super({id:"workbench.action.focusStatusBar",title:pe("focusStatusBar","Focus Status Bar"),category:gt.View,f1:!0})}async run(t){t.get(Qe).focusPart("workbench.parts.statusbar",uo())}};Me(D4);var w0=class{constructor(t){this._container=t}hover;set text(t){Tn(this._container,...Rs(t??""))}set title(t){!this.hover&&t?this.hover=$n().setupManagedHover(zt("mouse"),this._container,t):this.hover&&this.hover.update(t)}dispose(){this.hover?.dispose()}};var HI=class extends L{constructor(e,i,n,o,s,a,l,d){super();this.container=e;this.hoverDelegate=n;this.commandService=o;this.hoverService=s;this.notificationService=a;this.telemetryService=l;this.themeService=d;this.labelContainer=document.createElement("a"),this.labelContainer.tabIndex=-1,this.labelContainer.setAttribute("role","button"),this.labelContainer.className="statusbar-item-label",this._register(Wt.addTarget(this.labelContainer)),this.label=this._register(new L4(this.labelContainer)),this.container.appendChild(this.labelContainer),this.beakContainer=document.createElement("div"),this.beakContainer.className="status-bar-item-beak-container",this.container.appendChild(this.beakContainer),this.update(i)}label;entry=void 0;foregroundListener=this._register(new mt);backgroundListener=this._register(new mt);commandMouseListener=this._register(new mt);commandTouchListener=this._register(new mt);commandKeyboardListener=this._register(new mt);focusListener=this._register(new mt);focusOutListener=this._register(new mt);hover=void 0;labelContainer;beakContainer;get name(){return Ue(this.entry).name}get hasCommand(){return typeof this.entry?.command<"u"}update(e){if(this.label.showProgress=e.showProgress??!1,(!this.entry||e.text!==this.entry.text)&&(this.label.text=e.text,e.text?rs(this.labelContainer):ys(this.labelContainer)),(!this.entry||e.ariaLabel!==this.entry.ariaLabel)&&(this.container.setAttribute("aria-label",e.ariaLabel),this.labelContainer.setAttribute("aria-label",e.ariaLabel)),(!this.entry||e.role!==this.entry.role)&&this.labelContainer.setAttribute("role",e.role||"button"),!this.entry||!this.isEqualTooltip(this.entry,e)){let n=xh(e.tooltip)?{markdown:e.tooltip,markdownNotSupportedFallback:void 0}:e.tooltip;this.hover?this.hover.update(n):this.hover=this._register(this.hoverService.setupManagedHover(this.hoverDelegate,this.container,n)),e.command!==zI&&(this.focusListener.value=M(this.labelContainer,G.FOCUS,o=>{Te.stop(o),this.hover?.show(!1)}),this.focusOutListener.value=M(this.labelContainer,G.FOCUS_OUT,o=>{Te.stop(o),this.hover?.hide()}))}if(!this.entry||e.command!==this.entry.command){this.commandMouseListener.clear(),this.commandTouchListener.clear(),this.commandKeyboardListener.clear();let n=e.command;n&&(n!==zI||this.hover)?(this.commandMouseListener.value=M(this.labelContainer,G.CLICK,()=>this.executeCommand(n)),this.commandTouchListener.value=M(this.labelContainer,it.Tap,()=>this.executeCommand(n)),this.commandKeyboardListener.value=M(this.labelContainer,G.KEY_DOWN,o=>{let s=new st(o);s.equals(10)||s.equals(3)?(Te.stop(o),this.executeCommand(n)):(s.equals(9)||s.equals(15)||s.equals(17))&&(Te.stop(o),this.hover?.hide())}),this.labelContainer.classList.remove("disabled")):this.labelContainer.classList.add("disabled")}(!this.entry||e.showBeak!==this.entry.showBeak)&&(e.showBeak?this.container.classList.add("has-beak"):this.container.classList.remove("has-beak"));let i=!!e.backgroundColor||e.kind&&e.kind!=="standard";if(!this.entry||e.kind!==this.entry.kind){for(let n of UJ)this.container.classList.remove(`${n}-kind`);e.kind&&e.kind!=="standard"&&this.container.classList.add(`${e.kind}-kind`),this.container.classList.toggle("has-background-color",i)}(!this.entry||e.color!==this.entry.color)&&this.applyColor(this.labelContainer,e.color),(!this.entry||e.backgroundColor!==this.entry.backgroundColor)&&(this.container.classList.toggle("has-background-color",i),this.applyColor(this.container,e.backgroundColor,!0)),this.entry=e}isEqualTooltip({tooltip:e},{tooltip:i}){return e===void 0?i===void 0:xh(e)?xh(i)&&zD(e,i):e===i}async executeCommand(e){if(e===zI)this.hover?.show(!0);else{let i=typeof e=="string"?e:e.id,n=typeof e=="string"?[]:e.arguments??[];this.telemetryService.publicLog2("workbenchActionExecuted",{id:i,from:"status bar"});try{await this.commandService.executeCommand(i,...n)}catch(o){this.notificationService.error(lo(o))}}}applyColor(e,i,n){let o;if(n?this.backgroundListener.clear():this.foregroundListener.clear(),i)if(Y$(i)){o=this.themeService.getColorTheme().getColor(i.id)?.toString();let s=this.themeService.onDidColorThemeChange(a=>{let l=a.getColor(i.id)?.toString();n?e.style.backgroundColor=l??"":e.style.color=l??""});n?this.backgroundListener.value=s:this.foregroundListener.value=s}else o=i;n?e.style.backgroundColor=o??"":e.style.color=o??""}};HI=_([v(3,ni),v(4,qi),v(5,jt),v(6,qt),v(7,Ze)],HI);var L4=class extends w0{constructor(e){super(e);this.container=e}progressCodicon=Md(RV);currentText="";currentShowProgress=!1;set showProgress(e){this.currentShowProgress!==e&&(this.currentShowProgress=e,this.progressCodicon=Md(e==="syncing"?RV:gq),this.text=this.currentText)}set text(e){if(this.currentShowProgress){this.container.firstChild!==this.progressCodicon&&this.container.appendChild(this.progressCodicon);for(let n of Array.from(this.container.childNodes))n!==this.progressCodicon&&n.remove();let i=e??"";i&&(i=` ${i}`),Ee(this.container,...Rs(i))}else super.text=e}};var yu=class extends xl{constructor(e,i,n,o,s,a,l,d){super(e,{hasTitle:!1},n,s,a);this.instantiationService=i;this.contextService=o;this.storageService=s;this.contextMenuService=l;this.contextKeyService=d;this.registerListeners()}static HEIGHT=22;minimumWidth=0;maximumWidth=Number.POSITIVE_INFINITY;minimumHeight=yu.HEIGHT;maximumHeight=yu.HEIGHT;styleElement;pendingEntries=[];viewModel=this._register(new I0(this.storageService));onDidChangeEntryVisibility=this.viewModel.onDidChangeEntryVisibility;_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;leftItemsContainer;rightItemsContainer;hoverDelegate=this._register(this.instantiationService.createInstance(du,"element",!0,(e,i)=>({persistence:{hideOnKeyDown:!0,sticky:i}})));compactEntriesDisposable=this._register(new mt);styleOverrides=new Set;registerListeners(){this._register(this.onDidChangeEntryVisibility(()=>this.updateCompactEntries())),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateStyles()))}addEntry(e,i,n,o=0){let s;return HJ(o)?s=o:s={primary:o,secondary:Xn(i)},this.element?this.doAddEntry(e,i,n,s):this.doAddPendingEntry(e,i,n,s)}doAddPendingEntry(e,i,n,o){let s={entry:e,id:i,alignment:n,priority:o};return this.pendingEntries.push(s),{update:l=>{s.accessor?s.accessor.update(l):s.entry=l},dispose:()=>{s.accessor?s.accessor.dispose():this.pendingEntries=this.pendingEntries.filter(l=>l!==s)}}}doAddEntry(e,i,n,o){let s=this.doCreateStatusItem(i,n),a=this.instantiationService.createInstance(HI,s,e,this.hoverDelegate),l=new class{id=i;alignment=n;priority=o;container=s;labelContainer=a.labelContainer;get name(){return a.name}get hasCommand(){return a.hasCommand}},{needsFullRefresh:d}=this.doAddOrRemoveModelEntry(l,!0);return d?this.appendStatusbarEntries():this.appendStatusbarEntry(l),{update:c=>{a.update(c)},dispose:()=>{let{needsFullRefresh:c}=this.doAddOrRemoveModelEntry(l,!1);c?this.appendStatusbarEntries():s.remove(),nt(a)}}}doCreateStatusItem(e,i,...n){let o=document.createElement("div");return o.id=e,o.classList.add("statusbar-item"),n&&o.classList.add(...n),i===1?o.classList.add("right"):o.classList.add("left"),o}doAddOrRemoveModelEntry(e,i){let n=this.viewModel.entries;i?this.viewModel.add(e):this.viewModel.remove(e);let o=this.viewModel.entries;return i?n.splice(o.indexOf(e),0,e):n.splice(n.indexOf(e),1),{needsFullRefresh:!ti(n,o)}}isEntryVisible(e){return!this.viewModel.isHidden(e)}updateEntryVisibility(e,i){i?this.viewModel.show(e):this.viewModel.hide(e)}focusNextEntry(){this.viewModel.focusNextEntry()}focusPreviousEntry(){this.viewModel.focusPreviousEntry()}isEntryFocused(){return this.viewModel.isEntryFocused()}focus(e=!0){this.getContainer()?.focus();let i=this.viewModel.lastFocusedEntry;e&&i&&setTimeout(()=>i.labelContainer.focus(),0)}createContentArea(e){this.element=e;let i=this._register(this.contextKeyService.createScoped(this.element));return ym.bindTo(i).set(!0),this.leftItemsContainer=document.createElement("div"),this.leftItemsContainer.classList.add("left-items","items-container"),this.element.appendChild(this.leftItemsContainer),this.element.tabIndex=0,this.rightItemsContainer=document.createElement("div"),this.rightItemsContainer.classList.add("right-items","items-container"),this.element.appendChild(this.rightItemsContainer),this._register(M(e,G.CONTEXT_MENU,n=>this.showContextMenu(n))),this._register(Wt.addTarget(e)),this._register(M(e,it.Contextmenu,n=>this.showContextMenu(n))),this.createInitialStatusbarEntries(),this.element}createInitialStatusbarEntries(){for(this.appendStatusbarEntries();this.pendingEntries.length;){let e=this.pendingEntries.shift();e&&(e.accessor=this.addEntry(e.entry,e.id,e.alignment,e.priority.primary))}}appendStatusbarEntries(){let e=Ue(this.leftItemsContainer),i=Ue(this.rightItemsContainer);ci(e),ci(i);for(let n of[...this.viewModel.getEntries(0),...this.viewModel.getEntries(1).reverse()])(n.alignment===0?e:i).appendChild(n.container);this.updateCompactEntries()}appendStatusbarEntry(e){let i=this.viewModel.getEntries(e.alignment);e.alignment===1&&i.reverse();let n=Ue(e.alignment===0?this.leftItemsContainer:this.rightItemsContainer),o=i.indexOf(e);o+1===i.length?n.appendChild(e.container):n.insertBefore(e.container,i[o+1].container),this.updateCompactEntries()}updateCompactEntries(){let e=this.viewModel.entries,i=new Map;for(let a of e)this.viewModel.isHidden(a.id)||i.set(a.id,a),a.container.classList.remove("compact-left","compact-right");let n=new Map;for(let a of i.values())if(Jf(a.priority.primary)&&a.priority.primary.compact){let l=a.priority.primary.id,d=i.get(l);if(!d)continue;let c=n.get(l);if(!c){for(let u of n.values())if(u.has(l)){c=u;break}c||(c=new Map,n.set(l,c))}c.set(a.id,a),c.set(d.id,d),a.priority.primary.alignment===0?(d.container.classList.add("compact-left"),a.container.classList.add("compact-right")):(d.container.classList.add("compact-right"),a.container.classList.add("compact-left"))}let o=this.getColor(Ec),s=this.getColor(Qq);if(this.compactEntriesDisposable.value=new W,o&&s&&!Ra(this.theme.type))for(let[,a]of n)for(let l of a.values())l.hasCommand&&(this.compactEntriesDisposable.value.add(M(l.labelContainer,G.MOUSE_OVER,()=>{a.forEach(d=>d.labelContainer.style.backgroundColor=o),l.labelContainer.style.backgroundColor=s})),this.compactEntriesDisposable.value.add(M(l.labelContainer,G.MOUSE_OUT,()=>{a.forEach(d=>d.labelContainer.style.backgroundColor="")})))}showContextMenu(e){Te.stop(e,!0);let i=new ri(oe(this.element),e),n;this.contextMenuService.showContextMenu({getAnchor:()=>i,getActions:()=>(n=this.getContextMenuActions(i),n),onHide:()=>{n&&E7(n)}})}getContextMenuActions(e){let i=[];i.push(Ht({id:Qf.ID,label:h("hideStatusBar","Hide Status Bar"),run:()=>this.instantiationService.invokeFunction(s=>new Qf().run(s))})),i.push(new pt);let n=new Set;for(let s of this.viewModel.entries)n.has(s.id)||(i.push(new C0(s.id,s.name,this.viewModel)),n.add(s.id));let o;for(let s=e.target;s;s=s.parentElement){let a=this.viewModel.findEntry(s);if(a){o=a;break}}return o&&(i.push(new pt),i.push(new S0(o.id,o.name,this.viewModel))),i}updateStyles(){super.updateStyles();let e=Ue(this.getContainer()),i=[...this.styleOverrides].sort((d,c)=>d.priority-c.priority)[0],n=this.getColor(i?.background??(this.contextService.getWorkbenchState()!==1?jq:$q))||"";e.style.backgroundColor=n;let o=this.getColor(i?.foreground??(this.contextService.getWorkbenchState()!==1?wc:qq))||"";e.style.color=o;let s=this.getColor(Xq),a=this.getColor(i?.border??(this.contextService.getWorkbenchState()!==1?NV:Zq))||this.getColor(Le);a?(e.classList.add("status-border-top"),e.style.setProperty("--status-border-top-color",a)):(e.classList.remove("status-border-top"),e.style.removeProperty("--status-border-top-color"));let l=this.getColor(Yq);this.styleElement||(this.styleElement=Ho(e)),this.styleElement.textContent=`

				/* Status bar focus outline */
				.monaco-workbench .part.statusbar:focus {
					outline-color: ${l};
				}

				/* Status bar item focus outline */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item a:focus-visible {
					outline: 1px solid ${this.getColor(oi)??s};
					outline-offset: ${a?"-2px":"-1px"};
				}

				/* Notification Beak */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item.has-beak > .status-bar-item-beak-container:before {
					border-bottom-color: ${n};
				}
			`}layout(e,i,n,o){super.layout(e,i,n,o),super.layoutContents(e,i)}overrideStyle(e){return this.styleOverrides.add(e),this.updateStyles(),te(()=>{this.styleOverrides.delete(e),this.updateStyles()})}toJSON(){return{type:"workbench.parts.statusbar"}}dispose(){this._onWillDispose.fire(),super.dispose()}};yu=_([v(1,ae),v(2,Ze),v(3,Xt),v(4,tt),v(5,Qe),v(6,Mt),v(7,ke)],yu);var tx=class extends yu{constructor(t,e,i,n,o,s,a){super("workbench.parts.statusbar",t,e,i,n,o,s,a)}};tx=_([v(0,ae),v(1,Ze),v(2,Xt),v(3,tt),v(4,Qe),v(5,Mt),v(6,ke)],tx);var eb=class extends yu{constructor(e,i,n,o,s,a,l,d){let c=eb.COUNTER++;super(`workbench.parts.auxiliaryStatus.${c}`,i,n,o,s,a,l,d);this.container=e}static COUNTER=1;height=yu.HEIGHT};eb=_([v(1,ae),v(2,Ze),v(3,Xt),v(4,tt),v(5,Qe),v(6,Mt),v(7,ke)],eb);var ix=class extends By{constructor(e,i,n){super("workbench.statusBarService",n,i);this.instantiationService=e;this._register(this.registerPart(this.mainPart))}mainPart=this._register(this.instantiationService.createInstance(tx));_onDidCreateAuxiliaryStatusbarPart=this._register(new T);onDidCreateAuxiliaryStatusbarPart=this._onDidCreateAuxiliaryStatusbarPart.event;createAuxiliaryStatusbarPart(e){let i=document.createElement("footer");i.classList.add("part","statusbar"),i.setAttribute("role","status"),i.style.position="relative",i.setAttribute("aria-live","off"),i.setAttribute("tabindex","0"),e.appendChild(i);let n=this.instantiationService.createInstance(eb,i),o=this.registerPart(n);return n.create(i),O.once(n.onWillDispose)(()=>o.dispose()),this._onDidCreateAuxiliaryStatusbarPart.fire(n),n}createScoped(e,i){return i.add(this.instantiationService.createInstance(nx,e))}onDidChangeEntryVisibility=this.mainPart.onDidChangeEntryVisibility;addEntry(e,i,n,o=0){return e.showInAllWindows?this.doAddEntryToAllWindows(e,i,n,o):this.mainPart.addEntry(e,i,n,o)}doAddEntryToAllWindows(e,i,n,o=0){let s=new W,a=new Set;function l(d){let c=new W;c.add(d.onWillDispose(()=>c.dispose()));let u=c.add(d.addEntry(e,i,n,o));a.add(u),c.add(te(()=>a.delete(u))),s.add(c),c.add(te(()=>s.delete(c)))}for(let d of this.parts)l(d);return s.add(this.onDidCreateAuxiliaryStatusbarPart(d=>l(d))),{update:d=>{for(let c of a)c.update(d)},dispose:()=>s.dispose()}}isEntryVisible(e){return this.mainPart.isEntryVisible(e)}updateEntryVisibility(e,i){for(let n of this.parts)n.updateEntryVisibility(e,i)}focus(e){this.activePart.focus(e)}focusNextEntry(){this.activePart.focusNextEntry()}focusPreviousEntry(){this.activePart.focusPreviousEntry()}isEntryFocused(){return this.activePart.isEntryFocused()}overrideStyle(e){let i=new W;for(let n of this.parts)i.add(n.overrideStyle(e));return i}};ix=_([v(0,ae),v(1,tt),v(2,Ze)],ix);var nx=class extends L{constructor(e,i){super();this.statusbarEntryContainer=e;this.statusbarService=i}createAuxiliaryStatusbarPart(e){return this.statusbarService.createAuxiliaryStatusbarPart(e)}createScoped(e,i){return this.statusbarService.createScoped(e,i)}getPart(){return this.statusbarEntryContainer}onDidChangeEntryVisibility=this.statusbarEntryContainer.onDidChangeEntryVisibility;addEntry(e,i,n,o=0){return this.statusbarEntryContainer.addEntry(e,i,n,o)}isEntryVisible(e){return this.statusbarEntryContainer.isEntryVisible(e)}updateEntryVisibility(e,i){this.statusbarEntryContainer.updateEntryVisibility(e,i)}focus(e){this.statusbarEntryContainer.focus(e)}focusNextEntry(){this.statusbarEntryContainer.focusNextEntry()}focusPreviousEntry(){this.statusbarEntryContainer.focusPreviousEntry()}isEntryFocused(){return this.statusbarEntryContainer.isEntryFocused()}overrideStyle(e){return this.statusbarEntryContainer.overrideStyle(e)}};nx=_([v(1,Bs)],nx);vi(Bs,ix,0);var Bs=$("statusbarService");function Jf(r){let t=r;return typeof t?.id=="string"&&typeof t.alignment=="number"}function HJ(r){let t=r;return(typeof t?.primary=="number"||Jf(t?.primary))&&typeof t?.secondary=="number"}var zI={id:"statusBar.entry.showTooltip",title:""},UJ=["standard","warning","error","prominent","remote","offline"];var KI=class extends L{constructor(e,i,n){super();this.model=e;this.statusbarService=i;this.notificationService=n;this.updateNotificationsCenterStatusItem(),e.statusMessage&&this.doSetStatusMessage(e.statusMessage),this.registerListeners()}notificationsCenterStatusItem;newNotificationsCount=0;currentStatusMessage;isNotificationsCenterVisible=!1;isNotificationsToastsVisible=!1;registerListeners(){this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e))),this._register(this.model.onDidChangeStatusMessage(e=>this.onDidChangeStatusMessage(e))),this._register(this.notificationService.onDidChangeFilter(()=>this.updateNotificationsCenterStatusItem()))}onDidChangeNotification(e){this.isNotificationsCenterVisible||(e.kind===0?this.newNotificationsCount++:e.kind===3&&this.newNotificationsCount>0&&this.newNotificationsCount--),this.updateNotificationsCenterStatusItem()}updateNotificationsCenterStatusItem(){let e=0;if(!this.isNotificationsCenterVisible&&!this.isNotificationsToastsVisible)for(let n of this.model.notifications)n.hasProgress&&e++;let i={name:h("status.notifications","Notifications"),text:`${e>0||this.newNotificationsCount>0?"$(bell-dot)":"$(bell)"}`,ariaLabel:h("status.notifications","Notifications"),command:this.isNotificationsCenterVisible?Df:nM,tooltip:this.getTooltip(e),showBeak:this.isNotificationsCenterVisible};this.notificationService.getFilter()===1&&(i={...i,text:`${e>0||this.newNotificationsCount>0?"$(bell-slash-dot)":"$(bell-slash)"}`,ariaLabel:h("status.doNotDisturb","Do Not Disturb"),tooltip:h("status.doNotDisturbTooltip","Do Not Disturb Mode is Enabled")}),this.notificationsCenterStatusItem?this.notificationsCenterStatusItem.update(i):this.notificationsCenterStatusItem=this.statusbarService.addEntry(i,"status.notifications",1,-Number.MAX_VALUE)}getTooltip(e){return this.isNotificationsCenterVisible?h("hideNotifications","Hide Notifications"):this.model.notifications.length===0?h("zeroNotifications","No Notifications"):e===0?this.newNotificationsCount===0?h("noNotifications","No New Notifications"):this.newNotificationsCount===1?h("oneNotification","1 New Notification"):h({key:"notifications",comment:["{0} will be replaced by a number"]},"{0} New Notifications",this.newNotificationsCount):this.newNotificationsCount===0?h({key:"noNotificationsWithProgress",comment:["{0} will be replaced by a number"]},"No New Notifications ({0} in progress)",e):this.newNotificationsCount===1?h({key:"oneNotificationWithProgress",comment:["{0} will be replaced by a number"]},"1 New Notification ({0} in progress)",e):h({key:"notificationsWithProgress",comment:["{0} and {1} will be replaced by a number"]},"{0} New Notifications ({1} in progress)",this.newNotificationsCount,e)}update(e,i){let n=!1;this.isNotificationsCenterVisible!==e&&(this.isNotificationsCenterVisible=e,this.newNotificationsCount=0,n=!0),this.isNotificationsToastsVisible!==i&&(this.isNotificationsToastsVisible=i,n=!0),n&&this.updateNotificationsCenterStatusItem()}onDidChangeStatusMessage(e){let i=e.item;switch(e.kind){case 0:this.doSetStatusMessage(i);break;case 1:this.currentStatusMessage&&this.currentStatusMessage[0]===i&&(nt(this.currentStatusMessage[1]),this.currentStatusMessage=void 0);break}}doSetStatusMessage(e){let i=e.message,n=e.options&&typeof e.options.showAfter=="number"?e.options.showAfter:0,o=e.options&&typeof e.options.hideAfter=="number"?e.options.hideAfter:-1;this.currentStatusMessage&&nt(this.currentStatusMessage[1]);let s,a=setTimeout(()=>{s=this.statusbarService.addEntry({name:h("status.message","Status Message"),text:i,ariaLabel:i},"status.message",0,-Number.MAX_VALUE),a=null},n),l,d={dispose:()=>{a&&clearTimeout(a),l&&clearTimeout(l),s?.dispose()}};o>0&&(l=setTimeout(()=>d.dispose(),o)),this.currentStatusMessage=[e,d]}};KI=_([v(1,Bs),v(2,jt)],KI);var Fl=class extends ia{constructor(e,i,n,o,s,a,l,d,c){super(s);this.container=e;this.model=i;this.instantiationService=n;this.layoutService=o;this.editorGroupService=a;this.contextKeyService=l;this.lifecycleService=d;this.hostService=c;this.registerListeners()}static MAX_WIDTH=450;static MAX_NOTIFICATIONS=3;static PURGE_TIMEOUT={[ui.Info]:15e3,[ui.Warning]:18e3,[ui.Error]:2e4};static SPAM_PROTECTION={interval:800,limit:this.MAX_NOTIFICATIONS};_onDidChangeVisibility=this._register(new T);onDidChangeVisibility=this._onDidChangeVisibility.event;_isVisible=!1;get isVisible(){return!!this._isVisible}notificationsToastsContainer;workbenchDimensions;isNotificationsCenterVisible;mapNotificationToToast=new Map;mapNotificationToDisposable=new Map;notificationsToastsVisibleContextKey=Hd.bindTo(this.contextKeyService);addedToastsIntervalCounter=new PD(Fl.SPAM_PROTECTION.interval);registerListeners(){this._register(this.layoutService.onDidLayoutMainContainer(e=>this.layout(dt.lift(e)))),this.lifecycleService.when(3).then(()=>{this.model.notifications.forEach(e=>this.addToast(e)),this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e)))}),this._register(this.model.onDidChangeFilter(({global:e,sources:i})=>{if(e===1)this.hide();else if(i)for(let[n]of this.mapNotificationToToast)typeof n.sourceId=="string"&&i.get(n.sourceId)===1&&n.severity!==ui.Error&&n.priority!==2&&this.removeToast(n)}))}onDidChangeNotification(e){switch(e.kind){case 0:return this.addToast(e.item);case 3:return this.removeToast(e.item)}}addToast(e){if(this.isNotificationsCenterVisible||e.priority===1||this.addedToastsIntervalCounter.increment()>Fl.SPAM_PROTECTION.limit)return;let i=new W;this.mapNotificationToDisposable.set(e,i),i.add(nn(oe(this.container),()=>this.doAddToast(e,i)))}doAddToast(e,i){let n=this.notificationsToastsContainer;n||(n=this.notificationsToastsContainer=document.createElement("div"),n.classList.add("notifications-toasts"),this.container.appendChild(n)),n.classList.add("visible");let o=document.createElement("div");o.classList.add("notification-toast-container");let s=n.firstChild;s?n.insertBefore(o,s):n.appendChild(o);let a=document.createElement("div");a.classList.add("notification-toast"),o.appendChild(a);let l=this.instantiationService.createInstance(Dm,a,{verticalScrollMode:2,widgetAriaLabel:e.source?h("notificationWithSourceAriaLabel","{0}, source: {1}, notification",e.message.raw,e.source):h("notificationAriaLabel","{0}, notification",e.message.raw)});i.add(l);let d={item:e,list:l,container:o,toast:a};this.mapNotificationToToast.set(e,d),i.add(te(()=>this.updateToastVisibility(d,!1))),l.show();let c=this.computeMaxDimensions();this.layoutLists(c.width),l.updateNotificationsList(0,0,[e]),this.layoutContainer(c.height),i.add(e.onDidChangeExpansion(()=>{l.updateNotificationsList(0,1,[e])})),i.add(e.onDidChangeContent(u=>{switch(u.kind){case 2:l.updateNotificationsList(0,1,[e]);break;case 1:e.expanded&&l.updateNotificationHeight(e);break}})),O.once(e.onDidClose)(()=>{this.removeToast(e)}),this.purgeNotification(e,o,l,i),this.updateStyles(),this.notificationsToastsVisibleContextKey.set(!0),a.classList.add("notification-fade-in"),i.add(M(a,"transitionend",()=>{a.classList.remove("notification-fade-in"),a.classList.add("notification-fade-in-done")})),e.updateVisibility(!0),this._isVisible||(this._isVisible=!0,this._onDidChangeVisibility.fire())}purgeNotification(e,i,n,o){let s=!1;o.add(M(i,G.MOUSE_OVER,()=>s=!0)),o.add(M(i,G.MOUSE_OUT,()=>s=!1));let a,l,d=()=>{a=setTimeout(()=>{this.hostService.hasFocus?e.sticky||n.hasFocus()||s?d():this.removeToast(e):l||(l=this.hostService.onDidChangeFocus(c=>{c&&d()}),o.add(l))},Fl.PURGE_TIMEOUT[e.severity])};d(),o.add(te(()=>clearTimeout(a)))}removeToast(e){let i=!1,n=this.mapNotificationToToast.get(e);n&&(Oa(n.container)&&(i=!(this.focusNext()||this.focusPrevious())),this.mapNotificationToToast.delete(e));let o=this.mapNotificationToDisposable.get(e);o&&(nt(o),this.mapNotificationToDisposable.delete(e)),this.mapNotificationToToast.size>0?this.layout(this.workbenchDimensions):(this.doHide(),i&&this.editorGroupService.activeGroup.focus())}removeToasts(){this.mapNotificationToToast.clear(),this.mapNotificationToDisposable.forEach(e=>nt(e)),this.mapNotificationToDisposable.clear(),this.doHide()}doHide(){this.notificationsToastsContainer?.classList.remove("visible"),this.notificationsToastsVisibleContextKey.set(!1),this._isVisible&&(this._isVisible=!1,this._onDidChangeVisibility.fire())}hide(){let e=this.notificationsToastsContainer?Oa(this.notificationsToastsContainer):!1;this.removeToasts(),e&&this.editorGroupService.activeGroup.focus()}focus(){let e=this.getToasts(2);return e.length>0?(e[0].list.focusFirst(),!0):!1}focusNext(){let e=this.getToasts(2);for(let i=0;i<e.length;i++)if(e[i].list.hasFocus()){let o=e[i+1];if(o)return o.list.focusFirst(),!0;break}return!1}focusPrevious(){let e=this.getToasts(2);for(let i=0;i<e.length;i++)if(e[i].list.hasFocus()){let o=e[i-1];if(o)return o.list.focusFirst(),!0;break}return!1}focusFirst(){let e=this.getToasts(2)[0];return e?(e.list.focusFirst(),!0):!1}focusLast(){let e=this.getToasts(2);return e.length>0?(e[e.length-1].list.focusFirst(),!0):!1}update(e){this.isNotificationsCenterVisible!==e&&(this.isNotificationsCenterVisible=e,this.isNotificationsCenterVisible&&this.removeToasts())}updateStyles(){this.mapNotificationToToast.forEach(({toast:e})=>{let i=this.getColor(Bh);e.style.background=i||"";let n=this.getColor(pl);e.style.boxShadow=n?`0 0 8px 2px ${n}`:"";let o=this.getColor(hj);e.style.border=o?`1px solid ${o}`:""})}getToasts(e){let i=[];return this.mapNotificationToToast.forEach(n=>{switch(e){case 0:i.push(n);break;case 1:this.isToastInDOM(n)||i.push(n);break;case 2:this.isToastInDOM(n)&&i.push(n);break}}),i.reverse()}layout(e){this.workbenchDimensions=e;let i=this.computeMaxDimensions();i.height&&this.layoutContainer(i.height),this.layoutLists(i.width)}computeMaxDimensions(){let e=Fl.MAX_WIDTH,i=e,n;return this.workbenchDimensions&&(i=this.workbenchDimensions.width,i-=2*8,n=this.workbenchDimensions.height,this.layoutService.isVisible("workbench.parts.statusbar",ne)&&(n-=22),this.layoutService.isVisible("workbench.parts.titlebar",ne)&&(n-=22),n-=2*12),n=typeof n=="number"?Math.round(n*.618):0,new dt(Math.min(e,i),n)}layoutLists(e){this.mapNotificationToToast.forEach(({list:i})=>i.layout(e))}layoutContainer(e){let i=0;for(let n of this.getToasts(0)){n.container.style.opacity="0",this.updateToastVisibility(n,!0),e-=n.container.offsetHeight;let o=!1;i===Fl.MAX_NOTIFICATIONS?o=!1:e>=0&&(o=!0),this.updateToastVisibility(n,o),n.container.style.opacity="",o&&i++}}updateToastVisibility(e,i){if(this.isToastInDOM(e)===i)return;let n=Ue(this.notificationsToastsContainer);i?n.appendChild(e.container):e.container.remove(),e.item.updateVisibility(i)}isToastInDOM(e){return!!e.container.parentElement}};Fl=_([v(2,ae),v(3,Qe),v(4,Ze),v(5,di),v(6,ke),v(7,Pn),v(8,en)],Fl);function E0(r){return r.scheme!==he.file&&r.scheme!==he.vscodeRemote}function k4(r){if(r.folders.length)return r.folders.every(t=>E0(t.uri))?r.folders[0].uri:void 0;if(r.configuration&&E0(r.configuration))return r.configuration}function T0(r){return k4(r)?.scheme}var GI=class extends L{constructor(e,i,n,o,s,a,l,d,c,u){super();this.contextKeyService=e;this.contextService=i;this.configurationService=n;this.environmentService=o;this.productService=s;this.editorGroupService=a;this.editorService=l;this.layoutService=d;this.paneCompositeService=c;this.workingCopyService=u;DX.bindTo(this.contextKeyService),LX.bindTo(this.contextKeyService),kX.bindTo(this.contextKeyService),Zy.bindTo(this.contextKeyService),eu.bindTo(this.contextKeyService),aP.bindTo(this.contextKeyService),RX.bindTo(this.contextKeyService),sQ.bindTo(this.contextKeyService).set(xk(this.environmentService.remoteAuthority)||""),this.virtualWorkspaceContext=aQ.bindTo(this.contextKeyService),this.temporaryWorkspaceContext=lQ.bindTo(this.contextKeyService),this.updateWorkspaceContextKeys(),dQ.bindTo(this.contextKeyService).set($a.supported(ne));let p=!this.environmentService.isBuilt||this.environmentService.isExtensionDevelopment;dT.bindTo(this.contextKeyService).set(p),S3(dT.key,p),AX.bindTo(this.contextKeyService).set(this.productService.quality||""),cQ.bindTo(this.contextKeyService).set(s.embedderIdentifier),this.activeEditorGroupEmpty=$P.bindTo(this.contextKeyService),this.activeEditorGroupIndex=gQ.bindTo(this.contextKeyService),this.activeEditorGroupLast=fQ.bindTo(this.contextKeyService),this.activeEditorGroupLocked=TT.bindTo(this.contextKeyService),this.multipleEditorGroupsContext=xT.bindTo(this.contextKeyService),this.editorsVisibleContext=vQ.bindTo(this.contextKeyService),this.dirtyWorkingCopiesContext=rQ.bindTo(this.contextKeyService),this.dirtyWorkingCopiesContext.set(this.workingCopyService.hasDirty),this.inputFocusedContext=PX.bindTo(this.contextKeyService),this.workbenchStateContext=eQ.bindTo(this.contextKeyService),this.updateWorkbenchStateContextKey(),this.workspaceFolderCountContext=tQ.bindTo(this.contextKeyService),this.updateWorkspaceFolderCountContextKey(),this.openFolderWorkspaceSupportContext=iQ.bindTo(this.contextKeyService),this.openFolderWorkspaceSupportContext.set(Pi||typeof this.environmentService.remoteAuthority=="string"),this.emptyWorkspaceSupportContext=oQ.bindTo(this.contextKeyService),this.emptyWorkspaceSupportContext.set(Pi||typeof this.environmentService.remoteAuthority=="string"),this.enterMultiRootWorkspaceSupportContext=nQ.bindTo(this.contextKeyService),this.enterMultiRootWorkspaceSupportContext.set(Pi||typeof this.environmentService.remoteAuthority=="string"),this.splitEditorsVerticallyContext=yQ.bindTo(this.contextKeyService),this.updateSplitEditorsVerticallyContext(),this.isMainWindowFullscreenContext=Ga.bindTo(this.contextKeyService),this.isAuxiliaryWindowFocusedContext=ps.bindTo(this.contextKeyService),this.inZenModeContext=As.bindTo(this.contextKeyService),this.isMainEditorCenteredLayoutContext=_T.bindTo(this.contextKeyService),this.mainEditorAreaVisibleContext=YP.bindTo(this.contextKeyService),this.editorTabsVisibleContext=IQ.bindTo(this.contextKeyService),this.sideBarVisibleContext=su.bindTo(this.contextKeyService),this.titleAreaVisibleContext=_f.bindTo(this.contextKeyService),this.titleBarStyleContext=Im.bindTo(this.contextKeyService),this.updateTitleBarContextKeys(),this.panelPositionContext=au.bindTo(this.contextKeyService),this.panelPositionContext.set(Mr(this.layoutService.getPanelPosition())),this.panelVisibleContext=Rp.bindTo(this.contextKeyService),this.panelVisibleContext.set(this.layoutService.isVisible("workbench.parts.panel")),this.panelMaximizedContext=ZP.bindTo(this.contextKeyService),this.panelMaximizedContext.set(this.layoutService.isPanelMaximized()),this.panelAlignmentContext=Ll.bindTo(this.contextKeyService),this.panelAlignmentContext.set(this.layoutService.getPanelAlignment()),this.auxiliaryBarVisibleContext=Dl.bindTo(this.contextKeyService),this.auxiliaryBarVisibleContext.set(this.layoutService.isVisible("workbench.parts.auxiliarybar")),this.registerListeners()}inputFocusedContext;dirtyWorkingCopiesContext;activeEditorGroupEmpty;activeEditorGroupIndex;activeEditorGroupLast;activeEditorGroupLocked;multipleEditorGroupsContext;editorsVisibleContext;splitEditorsVerticallyContext;workbenchStateContext;workspaceFolderCountContext;openFolderWorkspaceSupportContext;enterMultiRootWorkspaceSupportContext;emptyWorkspaceSupportContext;virtualWorkspaceContext;temporaryWorkspaceContext;inZenModeContext;isMainWindowFullscreenContext;isAuxiliaryWindowFocusedContext;isMainEditorCenteredLayoutContext;sideBarVisibleContext;mainEditorAreaVisibleContext;panelPositionContext;panelVisibleContext;panelAlignmentContext;panelMaximizedContext;auxiliaryBarVisibleContext;editorTabsVisibleContext;titleAreaVisibleContext;titleBarStyleContext;registerListeners(){this.editorGroupService.whenReady.then(()=>{this.updateEditorAreaContextKeys(),this.updateActiveEditorGroupContextKeys(),this.updateVisiblePanesContextKeys()}),this._register(this.editorService.onDidActiveEditorChange(()=>this.updateActiveEditorGroupContextKeys())),this._register(this.editorService.onDidVisibleEditorsChange(()=>this.updateVisiblePanesContextKeys())),this._register(this.editorGroupService.onDidAddGroup(()=>this.updateEditorGroupsContextKeys())),this._register(this.editorGroupService.onDidRemoveGroup(()=>this.updateEditorGroupsContextKeys())),this._register(this.editorGroupService.onDidChangeGroupIndex(()=>this.updateActiveEditorGroupContextKeys())),this._register(this.editorGroupService.onDidChangeGroupLocked(()=>this.updateActiveEditorGroupContextKeys())),this._register(this.editorGroupService.onDidChangeEditorPartOptions(()=>this.updateEditorAreaContextKeys())),this._register(O.runAndSubscribe(Wg,({window:e,disposables:i})=>i.add(M(e,G.FOCUS_IN,()=>this.updateInputContextKeys(e.document),!0)),{window:ne,disposables:this._store})),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateWorkbenchStateContextKey())),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>{this.updateWorkspaceFolderCountContextKey(),this.updateWorkspaceContextKeys()})),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("workbench.editor.openSideBySideDirection")&&this.updateSplitEditorsVerticallyContext()})),this._register(this.layoutService.onDidChangeZenMode(e=>this.inZenModeContext.set(e))),this._register(this.layoutService.onDidChangeActiveContainer(()=>this.isAuxiliaryWindowFocusedContext.set(this.layoutService.activeContainer!==this.layoutService.mainContainer))),this._register(Nv(e=>{e===ne.vscodeWindowId&&this.isMainWindowFullscreenContext.set(ld(ne))})),this._register(this.layoutService.onDidChangeMainEditorCenteredLayout(e=>this.isMainEditorCenteredLayoutContext.set(e))),this._register(this.layoutService.onDidChangePanelPosition(e=>this.panelPositionContext.set(e))),this._register(this.layoutService.onDidChangePanelAlignment(e=>this.panelAlignmentContext.set(e))),this._register(this.paneCompositeService.onDidPaneCompositeClose(()=>this.updateSideBarContextKeys())),this._register(this.paneCompositeService.onDidPaneCompositeOpen(()=>this.updateSideBarContextKeys())),this._register(this.layoutService.onDidChangePartVisibility(()=>{this.mainEditorAreaVisibleContext.set(this.layoutService.isVisible("workbench.parts.editor",ne)),this.panelVisibleContext.set(this.layoutService.isVisible("workbench.parts.panel")),this.panelMaximizedContext.set(this.layoutService.isPanelMaximized()),this.auxiliaryBarVisibleContext.set(this.layoutService.isVisible("workbench.parts.auxiliarybar")),this.updateTitleBarContextKeys()})),this._register(this.workingCopyService.onDidChangeDirty(e=>this.dirtyWorkingCopiesContext.set(e.isDirty()||this.workingCopyService.hasDirty)))}updateVisiblePanesContextKeys(){this.editorService.visibleEditorPanes.length>0?this.editorsVisibleContext.set(!0):this.editorsVisibleContext.reset()}updateActiveEditorGroupContextKeys(){this.editorService.activeEditor?this.activeEditorGroupEmpty.reset():this.activeEditorGroupEmpty.set(!0);let e=this.editorGroupService.activeGroup;this.activeEditorGroupIndex.set(e.index+1),this.activeEditorGroupLocked.set(e.isLocked),this.updateEditorGroupsContextKeys()}updateEditorGroupsContextKeys(){let e=this.editorGroupService.count;e>1?this.multipleEditorGroupsContext.set(!0):this.multipleEditorGroupsContext.reset();let i=this.editorGroupService.activeGroup;this.activeEditorGroupLast.set(i.index===e-1)}updateEditorAreaContextKeys(){this.editorTabsVisibleContext.set(this.editorGroupService.partOptions.showTabs==="multiple")}updateInputContextKeys(e){function i(){return!!e.activeElement&&sa(e.activeElement)}let n=i();if(this.inputFocusedContext.set(n),n){let o=Un(e.activeElement);O.once(o.onDidBlur)(()=>{uo().document===e&&this.inputFocusedContext.set(i()),o.dispose()})}}updateWorkbenchStateContextKey(){this.workbenchStateContext.set(this.getWorkbenchStateString())}updateWorkspaceFolderCountContextKey(){this.workspaceFolderCountContext.set(this.contextService.getWorkspace().folders.length)}updateSplitEditorsVerticallyContext(){let e=NE(this.configurationService);this.splitEditorsVerticallyContext.set(e===1)}getWorkbenchStateString(){switch(this.contextService.getWorkbenchState()){case 1:return"empty";case 2:return"folder";case 3:return"workspace"}}updateSideBarContextKeys(){this.sideBarVisibleContext.set(this.layoutService.isVisible("workbench.parts.sidebar"))}updateTitleBarContextKeys(){this.titleAreaVisibleContext.set(this.layoutService.isVisible("workbench.parts.titlebar",ne)),this.titleBarStyleContext.set(Nw(this.configurationService))}updateWorkspaceContextKeys(){this.virtualWorkspaceContext.set(T0(this.contextService.getWorkspace())||""),this.temporaryWorkspaceContext.set(Yu(this.contextService.getWorkspace()))}};GI=_([v(0,ke),v(1,Xt),v(2,de),v(3,on),v(4,Qn),v(5,di),v(6,kt),v(7,Qe),v(8,hs),v(9,Va)],GI);var R4=class{constructor(t,e){this.key=t;this.data=e}incoming=new Map;outgoing=new Map},ox=class{constructor(t){this._hashFn=t}_nodes=new Map;roots(){let t=[];for(let e of this._nodes.values())e.outgoing.size===0&&t.push(e);return t}insertEdge(t,e){let i=this.lookupOrInsertNode(t),n=this.lookupOrInsertNode(e);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(t){let e=this._hashFn(t);this._nodes.delete(e);for(let i of this._nodes.values())i.outgoing.delete(e),i.incoming.delete(e)}lookupOrInsertNode(t){let e=this._hashFn(t),i=this._nodes.get(e);return i||(i=new R4(e,t),this._nodes.set(e,i)),i}lookup(t){return this._nodes.get(this._hashFn(t))}isEmpty(){return this._nodes.size===0}toString(){let t=[];for(let[e,i]of this._nodes)t.push(`${e}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return t.join(`
`)}findCycleSlow(){for(let[t,e]of this._nodes){let i=new Set([t]),n=this._findCycle(e,i);if(n)return n}}_findCycle(t,e){for(let[i,n]of t.outgoing){if(e.has(i))return[...e,i].join(" -> ");e.add(i);let o=this._findCycle(n,e);if(o)return o;e.delete(i)}}};var cue=!1,x0=class extends Error{constructor(t){super("cyclic dependency between services"),this.message=t.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${t.toString()}`}},_0=class r{constructor(t=new Wr,e=!1,i,n=cue){this._services=t;this._strict=e;this._parent=i;this._enableTracing=n;this._services.set(ae,this),this._globalGraph=n?i?._globalGraph??new ox(o=>o):void 0}_globalGraph;_globalGraphImplicitDependency;_isDisposed=!1;_servicesToMaybeDispose=new Set;_children=new Set;dispose(){if(!this._isDisposed){this._isDisposed=!0,nt(this._children),this._children.clear();for(let t of this._servicesToMaybeDispose)fg(t)&&t.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(t,e){this._throwIfDisposed();let i=this,n=new class extends r{dispose(){i._children.delete(n),super.dispose()}}(t,this._strict,this,this._enableTracing);return this._children.add(n),e?.add(n),n}invokeFunction(t,...e){this._throwIfDisposed();let i=rx.traceInvocation(this._enableTracing,t),n=!1;try{return t({get:s=>{if(n)throw z_("service accessor is only valid during the invocation of its target method");let a=this._getOrCreateServiceInstance(s,i);if(!a)throw new Error(`[invokeFunction] unknown service '${s}'`);return a}},...e)}finally{n=!0,i.stop()}}createInstance(t,...e){this._throwIfDisposed();let i,n;return t instanceof Xs?(i=rx.traceCreation(this._enableTracing,t.ctor),n=this._createInstance(t.ctor,t.staticArguments.concat(e),i)):(i=rx.traceCreation(this._enableTracing,t),n=this._createInstance(t,e,i)),i.stop(),n}_createInstance(t,e=[],i){let n=Ql.getServiceDependencies(t).sort((a,l)=>a.index-l.index),o=[];for(let a of n){let l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${t.name} depends on UNKNOWN service ${a.id}.`,!1),o.push(l)}let s=n.length>0?n[0].index:e.length;if(e.length!==s){console.trace(`[createInstance] First service dependency of ${t.name} at position ${s+1} conflicts with ${e.length} static arguments`);let a=s-e.length;a>0?e=e.concat(new Array(a)):e=e.slice(0,s)}return Reflect.construct(t,e.concat(o))}_setCreatedServiceInstance(t,e){if(this._services.get(t)instanceof Xs)this._services.set(t,e);else if(this._parent)this._parent._setCreatedServiceInstance(t,e);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(t){let e=this._services.get(t);return!e&&this._parent?this._parent._getServiceInstanceOrDescriptor(t):e}_getOrCreateServiceInstance(t,e){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(t));let i=this._getServiceInstanceOrDescriptor(t);return i instanceof Xs?this._safeCreateAndCacheServiceInstance(t,i,e.branch(t,!0)):(e.branch(t,!1),i)}_activeInstantiations=new Set;_safeCreateAndCacheServiceInstance(t,e,i){if(this._activeInstantiations.has(t))throw new Error(`illegal state - RECURSIVELY instantiating service '${t}'`);this._activeInstantiations.add(t);try{return this._createAndCacheServiceInstance(t,e,i)}finally{this._activeInstantiations.delete(t)}}_createAndCacheServiceInstance(t,e,i){let n=new ox(l=>l.id.toString()),o=0,s=[{id:t,desc:e,_trace:i}],a=new Set;for(;s.length;){let l=s.pop();if(!a.has(String(l.id))){if(a.add(String(l.id)),n.lookupOrInsertNode(l),o++>1e3)throw new x0(n);for(let d of Ql.getServiceDependencies(l.desc.ctor)){let c=this._getServiceInstanceOrDescriptor(d.id);if(c||this._throwIfStrict(`[createInstance] ${t} depends on ${d.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(d.id)),c instanceof Xs){let u={id:d.id,desc:c,_trace:l._trace.branch(d.id,!0)};n.insertEdge(l,u),s.push(u)}}}}for(;;){let l=n.roots();if(l.length===0){if(!n.isEmpty())throw new x0(n);break}for(let{data:d}of l){if(this._getServiceInstanceOrDescriptor(d.id)instanceof Xs){let u=this._createServiceInstanceWithOwner(d.id,d.desc.ctor,d.desc.staticArguments,d.desc.supportsDelayedInstantiation,d._trace);this._setCreatedServiceInstance(d.id,u)}n.removeNode(d)}}return this._getServiceInstanceOrDescriptor(t)}_createServiceInstanceWithOwner(t,e,i=[],n,o){if(this._services.get(t)instanceof Xs)return this._createServiceInstance(t,e,i,n,o,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(t,e,i,n,o);throw new Error(`illegalState - creating UNKNOWN service instance ${e.name}`)}_createServiceInstance(t,e,i=[],n,o,s){if(n){let a=new r(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(t);let l=new Map,d=new _g(()=>{let c=a._createInstance(e,i,o);for(let[u,p]of l){let m=c[u];if(typeof m=="function")for(let g of p)g.disposable=m.apply(c,g.listener)}return l.clear(),s.add(c),c});return new Proxy(Object.create(null),{get(c,u){if(!d.isInitialized&&typeof u=="string"&&(u.startsWith("onDid")||u.startsWith("onWill"))){let g=l.get(u);return g||(g=new ao,l.set(u,g)),(b,y,I)=>{if(d.isInitialized)return d.value[u](b,y,I);{let E={listener:[b,y,I],disposable:void 0},S=g.push(E);return te(()=>{S(),E.disposable?.dispose()})}}}if(u in c)return c[u];let p=d.value,m=p[u];return typeof m!="function"||(m=m.bind(p),c[u]=m),m},set(c,u,p){return d.value[u]=p,!0},getPrototypeOf(c){return e.prototype}})}else{let a=this._createInstance(e,i,o);return s.add(a),a}}_throwIfStrict(t,e){if(e&&console.warn(t),this._strict)throw new Error(t)}};var rx=class r{constructor(t,e){this.type=t;this.name=e}static all=new Set;static _None=new class extends r{constructor(){super(0,null)}stop(){}branch(){return this}};static traceInvocation(t,e){return t?new r(2,e.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):r._None}static traceCreation(t,e){return t?new r(1,e.name):r._None}static _totals=0;_start=Date.now();_dep=[];branch(t,e){let i=new r(3,t.toString());return this._dep.push([t,e,i]),i}stop(){let t=Date.now()-this._start;r._totals+=t;let e=!1;function i(o,s){let a=[],l=new Array(o+1).join("	");for(let[d,c,u]of s._dep)if(c&&u){e=!0,a.push(`${l}CREATES -> ${d}`);let p=i(o+1,u);p&&a.push(p)}else a.push(`${l}uses -> ${d}`);return a.join(`
`)}let n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${r._totals.toFixed(2)}ms)`];(t>2||e)&&r.all.add(n.join(`
`))}};var A4=class extends We{constructor(){super({id:"workbench.action.focusSideBar",title:pe("focusSideBar","Focus into Primary Side Bar"),category:gt.View,f1:!0,keybinding:{weight:200,when:null,primary:2069}})}async run(t){let e=t.get(Qe),i=t.get(hs);e.isVisible("workbench.parts.sidebar")||e.setPartHidden(!1,"workbench.parts.sidebar"),i.getActivePaneComposite(0)?.focus()}};Me(A4);var D0=class extends xl{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y){super(b,y,d,i,o);this.notificationService=e;this.storageService=i;this.contextMenuService=n;this.keybindingService=s;this.hoverService=a;this.instantiationService=l;this.registry=c;this.activeCompositeSettingsKey=u;this.defaultCompositeId=p;this.nameForTelemetry=m;this.compositeCSSClass=g;this.titleForegroundColor=f;this.lastActiveCompositeId=i.get(u,1,this.defaultCompositeId),this.toolbarHoverDelegate=this._register(Ha())}onDidCompositeOpen=this._register(new T);onDidCompositeClose=this._register(new T);toolBar;titleLabelElement;toolbarHoverDelegate;mapCompositeToCompositeContainer=new Map;mapActionsBindingToComposite=new Map;activeComposite;lastActiveCompositeId;instantiatedCompositeItems=new Map;titleLabel;progressBar;contentAreaSize;actionsListener=this._register(new mt);currentCompositeOpenToken;boundarySashes;openComposite(e,i){if(this.activeComposite?.getId()===e)return i&&this.activeComposite.focus(),this.activeComposite;if(this.element)return this.doOpenComposite(e,i)}doOpenComposite(e,i=!1){let n=iT.nextId();this.currentCompositeOpenToken=n,this.activeComposite&&this.hideActiveComposite(),this.updateTitle(e);let o=this.createComposite(e,!0);if(!(this.currentCompositeOpenToken!==n||this.activeComposite&&this.activeComposite.getId()!==o.getId()))return this.activeComposite?.getId()===o.getId()?(i&&o.focus(),this.onDidCompositeOpen.fire({composite:o,focus:i}),o):(this.showComposite(o),i&&o.focus(),o&&this.onDidCompositeOpen.fire({composite:o,focus:i}),o)}createComposite(e,i){let n=this.instantiatedCompositeItems.get(e);if(n)return n.composite;let o=this.registry.getComposite(e);if(o){let s=this,a=new CI(Ue(this.progressBar),new class extends SI{constructor(){super(o.id,!!i),this._register(s.onDidCompositeOpen.event(u=>this.onScopeOpened(u.composite.getId()))),this._register(s.onDidCompositeClose.event(u=>this.onScopeClosed(u.getId())))}}),l=this._register(this.instantiationService.createChild(new Wr([qR,a]))),d=o.instantiate(l),c=new W;return this.instantiatedCompositeItems.set(e,{composite:d,disposable:c,progress:a}),c.add(d.onTitleAreaUpdate(()=>this.onTitleAreaUpdate(d.getId()),this)),c.add(l),d}throw new Error(`Unable to find composite with id ${e}`)}showComposite(e){this.activeComposite=e;let i=this.activeComposite.getId();i!==this.defaultCompositeId?this.storageService.store(this.activeCompositeSettingsKey,i,1,1):this.storageService.remove(this.activeCompositeSettingsKey,1),this.lastActiveCompositeId=this.activeComposite.getId();let n=this.mapCompositeToCompositeContainer.get(e.getId());if(n||(n=re(".composite"),n.classList.add(...this.compositeCSSClass.split(" ")),n.id=e.getId(),e.create(n),e.updateStyles(),this.mapCompositeToCompositeContainer.set(e.getId(),n)),!this.activeComposite||e.getId()!==this.activeComposite.getId())return;this.getContentArea()?.appendChild(n),rs(n);let s=Ue(this.toolBar);s.actionRunner=e.getActionRunner();let a=this.registry.getComposite(e.getId());a&&a.name!==e.getTitle()&&this.updateTitle(e.getId(),e.getTitle());let l=this.mapActionsBindingToComposite.get(e.getId());l||(l=this.collectCompositeActions(e),this.mapActionsBindingToComposite.set(e.getId(),l)),l(),this.actionsListener.value=s.actionRunner.onDidRun(d=>{d.error&&!al(d.error)&&this.notificationService.error(d.error)}),e.setVisible(!0),!(!this.activeComposite||e.getId()!==this.activeComposite.getId())&&(this.contentAreaSize&&e.layout(this.contentAreaSize),this.boundarySashes&&e.setBoundarySashes(this.boundarySashes))}onTitleAreaUpdate(e){let i=this.instantiatedCompositeItems.get(e);if(i&&this.updateTitle(e,i.composite.getTitle()),this.activeComposite?.getId()===e){let n=this.collectCompositeActions(this.activeComposite);this.mapActionsBindingToComposite.set(this.activeComposite.getId(),n),n()}else this.mapActionsBindingToComposite.delete(e)}updateTitle(e,i){let n=this.registry.getComposite(e);if(!n||!this.titleLabel)return;i||(i=n.name);let o=this.keybindingService.lookupKeybinding(e);this.titleLabel.updateTitle(e,i,o?.getLabel()??void 0),Ue(this.toolBar).setAriaLabel(h("ariaCompositeToolbarLabel","{0} actions",i))}collectCompositeActions(e){let i=e?.getMenuIds(),n=e?.getActions().slice(0)||[],o=e?.getSecondaryActions().slice(0)||[],s=Ue(this.toolBar);return s.context=this.actionsContextProvider(),()=>s.setActions(Or(n),Or(o),i)}getActiveComposite(){return this.activeComposite}getLastActiveCompositeId(){return this.lastActiveCompositeId}hideActiveComposite(){if(!this.activeComposite)return;let e=this.activeComposite;this.activeComposite=void 0;let i=this.mapCompositeToCompositeContainer.get(e.getId());return e.setVisible(!1),i&&(i.remove(),ys(i)),this.progressBar?.stop().hide(),this.toolBar&&this.collectCompositeActions()(),this.onDidCompositeClose.fire(e),e}createTitleArea(e){let i=Ee(e,re(".composite"));i.classList.add("title"),this.titleLabel=this.createTitleLabel(i);let n=Ee(i,re(".title-actions"));return this.toolBar=this._register(this.instantiationService.createInstance(pr,n,{actionViewItemProvider:(o,s)=>this.actionViewItemProvider(o,s),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:h("viewsAndMoreActions","Views and More Actions..."),telemetrySource:this.nameForTelemetry,hoverDelegate:this.toolbarHoverDelegate})),this.collectCompositeActions()(),i}createTitleLabel(e){let i=Ee(e,re(".title-label")),n=Ee(i,re("h2"));this.titleLabelElement=n;let o=this._register(this.hoverService.setupManagedHover(zt("mouse"),n,"")),s=this;return{updateTitle:(a,l,d)=>{(!this.activeComposite||this.activeComposite.getId()===a)&&(n.innerText=l,o.update(d?h("titleTooltip","{0} ({1})",l,d):l))},updateStyles:()=>{n.style.color=s.titleForegroundColor&&s.getColor(s.titleForegroundColor)||""}}}createHeaderArea(){return re(".composite")}createFooterArea(){return re(".composite")}updateStyles(){super.updateStyles(),Ue(this.titleLabel).updateStyles()}actionViewItemProvider(e,i){return this.activeComposite?this.activeComposite.getActionViewItem(e,i):ja(this.instantiationService,e,i)}actionsContextProvider(){return this.activeComposite?this.activeComposite.getActionsContext():null}createContentArea(e){let i=Ee(e,re(".content"));return this.progressBar=this._register(new pm(i,eI)),this.progressBar.hide(),i}getProgressIndicator(e){let i=this.instantiatedCompositeItems.get(e);return i?i.progress:void 0}getTitleAreaDropDownAnchorAlignment(){return 1}layout(e,i,n,o){super.layout(e,i,n,o),this.contentAreaSize=dt.lift(super.layoutContents(e,i).contentSize),this.activeComposite?.layout(this.contentAreaSize)}setBoundarySashes(e){this.boundarySashes=e,this.activeComposite?.setBoundarySashes(e)}removeComposite(e){if(this.activeComposite?.getId()===e)return!1;this.mapCompositeToCompositeContainer.delete(e),this.mapActionsBindingToComposite.delete(e);let i=this.instantiatedCompositeItems.get(e);return i&&(i.composite.dispose(),nt(i.disposable),this.instantiatedCompositeItems.delete(e)),!0}dispose(){this.mapCompositeToCompositeContainer.clear(),this.mapActionsBindingToComposite.clear(),this.instantiatedCompositeItems.forEach(e=>{e.composite.dispose(),nt(e.disposable)}),this.instantiatedCompositeItems.clear(),super.dispose()}};var Om=$("activityService"),L0=class{constructor(t){this.descriptorFn=t;this.descriptorFn=t}getDescription(){return this.descriptorFn(null)}},Kp=class extends L0{constructor(e,i){super(i);this.number=e;this.number=e}getDescription(){return this.descriptorFn(this.number)}};var k0=class extends L0{};var Gp=class extends ot{constructor(e){super(e.id,e.name,e.classNames?.join(" "),!0);this.item=e}_onDidChangeCompositeBarActionItem=this._register(new T);onDidChangeCompositeBarActionItem=this._onDidChangeCompositeBarActionItem.event;_onDidChangeActivity=this._register(new T);onDidChangeActivity=this._onDidChangeActivity.event;_activity;get compositeBarActionItem(){return this.item}set compositeBarActionItem(e){this._label=e.name,this.item=e,this._onDidChangeCompositeBarActionItem.fire(this)}get activity(){return this._activity}set activity(e){this._activity=e,this._onDidChangeActivity.fire(e)}activate(){this.checked||this._setChecked(!0)}deactivate(){this.checked&&this._setChecked(!1)}},jd=class extends zn{constructor(e,i,n,o,s,a,l){super(null,e,i);this.badgesEnabled=n;this.themeService=o;this.hoverService=s;this.configurationService=a;this.keybindingService=l;this.options=i,this._register(this.themeService.onDidColorThemeChange(this.onThemeChange,this)),this._register(e.onDidChangeCompositeBarActionItem(()=>this.update())),this._register(O.filter(l.onDidUpdateKeybindings,()=>this.keybindingLabel!==this.computeKeybindingLabel())(()=>this.updateTitle())),this._register(e.onDidChangeActivity(()=>this.updateActivity())),this._register(te(()=>this.showHoverScheduler.cancel()))}static hoverLeaveTime=0;container;label;badge;options;badgeContent;badgeDisposable=this._register(new mt);mouseUpTimeout;keybindingLabel;hoverDisposables=this._register(new W);lastHover;showHoverScheduler=new Et(()=>this.showHover(),0);get compositeBarActionItem(){return this._action.compositeBarActionItem}updateStyles(){let e=this.themeService.getColorTheme(),i=this.options.colors(e);if(this.label){if(this.options.icon){let n=this._action.checked?i.activeForegroundColor:i.inactiveForegroundColor;this.compositeBarActionItem.iconUrl?(this.label.style.backgroundColor=n?n.toString():"",this.label.style.color=""):(this.label.style.color=n?n.toString():"",this.label.style.backgroundColor="")}else{let n=this._action.checked?i.activeForegroundColor:i.inactiveForegroundColor,o=this._action.checked?i.activeBorderBottomColor:null;this.label.style.color=n?n.toString():"",this.label.style.borderBottomColor=o?o.toString():""}this.container.style.setProperty("--insert-border-color",i.dragAndDropBorder?i.dragAndDropBorder.toString():"")}if(this.badgeContent){let n=i.badgeForeground??e.getColor(Mh),o=i.badgeBackground??e.getColor(ul),s=e.getColor(Le);this.badgeContent.style.color=n?n.toString():"",this.badgeContent.style.backgroundColor=o?o.toString():"",this.badgeContent.style.borderStyle=s&&!this.options.compact?"solid":"",this.badgeContent.style.borderWidth=s?"1px":"",this.badgeContent.style.borderColor=s?s.toString():""}}render(e){super.render(e),this.container=e,this.options.icon&&this.container.classList.add("icon"),this.options.hasPopup?(this.container.setAttribute("role","button"),this.container.setAttribute("aria-haspopup","true")):this.container.setAttribute("role","tab"),this._register(M(this.container,G.MOUSE_DOWN,()=>{this.container.classList.add("clicked")})),this._register(M(this.container,G.MOUSE_UP,()=>{this.mouseUpTimeout&&clearTimeout(this.mouseUpTimeout),this.mouseUpTimeout=setTimeout(()=>{this.container.classList.remove("clicked")},800)})),this.label=Ee(e,re("a")),this.badge=Ee(e,re(".badge")),this.badgeContent=Ee(this.badge,re(".badge-content")),Ee(e,re(".active-item-indicator")),ys(this.badge),this.update(),this.updateStyles(),this.updateHover()}onThemeChange(e){this.updateStyles()}update(){this.updateLabel(),this.updateActivity(),this.updateTitle(),this.updateStyles()}updateActivity(){let e=this.action;if(!this.badge||!this.badgeContent||!(e instanceof Gp))return;let i=e.activity;this.badgeDisposable.clear(),ci(this.badgeContent),ys(this.badge);let n=this.badgesEnabled(this.compositeBarActionItem.id);if(i&&n){let{badge:o}=i,s=[];if(this.options.compact&&s.push("compact"),o instanceof k0)rs(this.badge),s.push("progress-badge");else if(o instanceof Kp&&o.number){let a=o.number.toString();if(o.number>999){let l=o.number/1e3,d=Math.floor(l);l>d?a=`${d}K+`:a=`${l}K`}this.options.compact&&a.length>=3&&s.push("compact-content"),this.badgeContent.textContent=a,rs(this.badge)}s.length&&(this.badge.classList.add(...s),this.badgeDisposable.value=te(()=>this.badge.classList.remove(...s)))}this.updateTitle()}updateLabel(){this.label.className="action-label",this.compositeBarActionItem.classNames&&this.label.classList.add(...this.compositeBarActionItem.classNames),this.options.icon||(this.label.textContent=this.action.label)}updateTitle(){let e=this.computeTitle();[this.label,this.badge,this.container].forEach(i=>{i&&(i.setAttribute("aria-label",e),i.setAttribute("title",""),i.removeAttribute("title"))})}computeTitle(){this.keybindingLabel=this.computeKeybindingLabel();let e=this.keybindingLabel?h("titleKeybinding","{0} ({1})",this.compositeBarActionItem.name,this.keybindingLabel):this.compositeBarActionItem.name,i=this.action.activity?.badge;return i?.getDescription()&&(e=h("badgeTitle","{0} - {1}",e,i.getDescription())),e}computeKeybindingLabel(){return(this.compositeBarActionItem.keybindingId?this.keybindingService.lookupKeybinding(this.compositeBarActionItem.keybindingId):null)?.getLabel()}updateHover(){this.hoverDisposables.clear(),this.updateTitle(),this.hoverDisposables.add(M(this.container,G.MOUSE_OVER,()=>{this.showHoverScheduler.isScheduled()||(Date.now()-jd.hoverLeaveTime<200?this.showHover(!0):this.showHoverScheduler.schedule(this.configurationService.getValue("workbench.hover.delay")))},!0)),this.hoverDisposables.add(M(this.container,G.MOUSE_LEAVE,e=>{e.target===this.container&&(jd.hoverLeaveTime=Date.now(),this.hoverService.hideHover(),this.showHoverScheduler.cancel())},!0)),this.hoverDisposables.add(te(()=>{this.hoverService.hideHover(),this.showHoverScheduler.cancel()}))}showHover(e=!1){if(this.lastHover&&!this.lastHover.isDisposed)return;let i=this.options.hoverOptions.position();this.lastHover=this.hoverService.showHover({target:this.container,content:this.computeTitle(),position:{hoverPosition:i},persistence:{hideOnKeyDown:!0},appearance:{showPointer:!0,compact:!0,skipFadeInAnimation:e}})}dispose(){super.dispose(),this.mouseUpTimeout&&clearTimeout(this.mouseUpTimeout),this.badge.remove()}};jd=_([v(3,Ze),v(4,qi),v(5,de),v(6,at)],jd);var ax=class extends Gp{constructor(e){super({id:"additionalComposites.action",name:h("additionalViews","Additional Views"),classNames:ye.asClassNameArray(B.more)});this.showMenu=e}async run(){this.showMenu()}},qI=class extends jd{constructor(e,i,n,o,s,a,l,d,c,u,p,m){super(e,{icon:!0,colors:a,hasPopup:!0,hoverOptions:l},()=>!0,c,u,p,m);this.getOverflowingComposites=i;this.getActiveCompositeId=n;this.getBadge=o;this.getCompositeOpenAction=s;this.contextMenuService=d}showMenu(){this.contextMenuService.showContextMenu({getAnchor:()=>this.container,getActions:()=>this.getActions(),getCheckedActionsRepresentation:()=>"radio"})}getActions(){return this.getOverflowingComposites().map(e=>{let i=this.getCompositeOpenAction(e.id);i.checked=this.getActiveCompositeId()===i.id;let n=this.getBadge(e.id),o;return n instanceof Kp&&(o=n.number),o?i.label=h("numberBadge","{0} ({1})",e.name,o):i.label=e.name||"",i})}};qI=_([v(7,Mt),v(8,Ze),v(9,qi),v(10,de),v(11,at)],qI);var sx=class extends ot{constructor(e){super("activitybar.manage.extension",h("manageExtension","Manage Extension"));this.commandService=e}run(e){return this.commandService.executeCommand("_extensions.manage",e)}};sx=_([v(0,ni)],sx);var Iu=class extends jd{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f){super(i,e,d.areBadgesEnabled.bind(d),m,g,f,u);this.compositeActivityAction=i;this.toggleCompositePinnedAction=n;this.toggleCompositeBadgeAction=o;this.compositeContextMenuActionsProvider=s;this.contextMenuActionsProvider=a;this.dndHandler=l;this.compositeBar=d;this.contextMenuService=c;Iu.manageExtensionAction||(Iu.manageExtensionAction=p.createInstance(sx))}static manageExtensionAction;render(e){super.render(e),this.updateChecked(),this.updateEnabled(),this._register(M(this.container,G.CONTEXT_MENU,n=>{Te.stop(n,!0),this.showContextMenu(e)}));let i;this._register(Xa.INSTANCE.registerDraggable(this.container,()=>({type:"composite",id:this.compositeBarActionItem.id}),{onDragOver:n=>{let o=n.dragAndDropData.getData().id!==this.compositeBarActionItem.id&&this.dndHandler.onDragOver(n.dragAndDropData,this.compositeBarActionItem.id,n.eventData);Op(n.eventData.dataTransfer,"move",o),i=this.updateFromDragging(e,o,n.eventData)},onDragLeave:n=>{i=this.updateFromDragging(e,!1,n.eventData)},onDragEnd:n=>{i=this.updateFromDragging(e,!1,n.eventData)},onDrop:n=>{Te.stop(n.eventData,!0),this.dndHandler.drop(n.dragAndDropData,this.compositeBarActionItem.id,n.eventData,i),i=this.updateFromDragging(e,!1,n.eventData)},onDragStart:n=>{n.dragAndDropData.getData().id===this.compositeBarActionItem.id&&(n.eventData.dataTransfer&&(n.eventData.dataTransfer.effectAllowed="move"),this.blur())}})),[this.badge,this.label].forEach(n=>this._register(new IA(n,()=>{this.action.checked||this.action.run()}))),this.updateStyles()}updateFromDragging(e,i,n){let o=e.getBoundingClientRect(),s=n.clientX,a=n.clientY,l=o.bottom-o.top,d=o.right-o.left,c=a<=o.top+l*.4,u=a>o.bottom-l*.4,p=a<=o.top+l*.5,m=s<=o.left+d*.4,g=s>o.right-d*.4,f=s<=o.left+d*.5,b=e.classList,y={vertical:b.contains("top")?"top":b.contains("bottom")?"bottom":void 0,horizontal:b.contains("left")?"left":b.contains("right")?"right":void 0},I=c||p&&!y.vertical||!u&&y.vertical==="top",E=u||!p&&!y.vertical||!c&&y.vertical==="bottom",S=m||f&&!y.horizontal||!g&&y.horizontal==="left",w=g||!f&&!y.horizontal||!m&&y.horizontal==="right";if(e.classList.toggle("top",i&&I),e.classList.toggle("bottom",i&&E),e.classList.toggle("left",i&&S),e.classList.toggle("right",i&&w),!!i)return{verticallyBefore:I,horizontallyBefore:S}}showContextMenu(e){let i=[this.toggleCompositePinnedAction,this.toggleCompositeBadgeAction],n=this.compositeContextMenuActionsProvider(this.compositeBarActionItem.id);n.length&&i.push(...n),this.compositeActivityAction.compositeBarActionItem.extensionId&&(i.push(new pt),i.push(Iu.manageExtensionAction)),this.compositeBar.isPinned(this.compositeBarActionItem.id)?(this.toggleCompositePinnedAction.label=h("hide","Hide '{0}'",this.compositeBarActionItem.name),this.toggleCompositePinnedAction.checked=!1):this.toggleCompositePinnedAction.label=h("keep","Keep '{0}'",this.compositeBarActionItem.name),this.compositeBar.areBadgesEnabled(this.compositeBarActionItem.id)?this.toggleCompositeBadgeAction.label=h("hideBadge","Hide Badge"):this.toggleCompositeBadgeAction.label=h("showBadge","Show Badge");let a=this.contextMenuActionsProvider();a.length&&(i.push(new pt),i.push(...a));let l=To(e),d={x:Math.floor(l.left+l.width/2),y:l.top+l.height};this.contextMenuService.showContextMenu({getAnchor:()=>d,getActions:()=>i,getActionsContext:()=>this.compositeBarActionItem.id})}updateChecked(){this.action.checked?(this.container.classList.add("checked"),this.container.setAttribute("aria-label",this.getTooltip()??this.container.title),this.container.setAttribute("aria-expanded","true"),this.container.setAttribute("aria-selected","true")):(this.container.classList.remove("checked"),this.container.setAttribute("aria-label",this.getTooltip()??this.container.title),this.container.setAttribute("aria-expanded","false"),this.container.setAttribute("aria-selected","false")),this.updateStyles()}updateEnabled(){this.element&&(this.action.enabled?this.element.classList.remove("disabled"):this.element.classList.add("disabled"))}dispose(){super.dispose(),this.label.remove()}};Iu=_([v(8,Mt),v(9,at),v(10,ae),v(11,Ze),v(12,qi),v(13,de)],Iu);var lx=class extends ot{constructor(e,i){super("show.toggleCompositePinned",e?e.name:h("toggle","Toggle View Pinned"));this.activity=e;this.compositeBar=i;this.checked=!!this.activity&&this.compositeBar.isPinned(this.activity.id)}async run(e){let i=this.activity?this.activity.id:e;this.compositeBar.isPinned(i)?this.compositeBar.unpin(i):this.compositeBar.pin(i)}},dx=class extends ot{constructor(e,i){super("show.toggleCompositeBadge",e?e.name:h("toggleBadge","Toggle View Badge"));this.compositeBarActionItem=e;this.compositeBar=i;this.checked=!1}async run(e){let i=this.compositeBarActionItem?this.compositeBarActionItem.id:e;this.compositeBar.toggleBadgeEnablement(i)}};var R0=class{constructor(t,e,i,n,o,s){this.viewDescriptorService=t;this.targetContainerLocation=e;this.orientation=i;this.openComposite=n;this.moveComposite=o;this.getItems=s}drop(t,e,i,n){let o=t.getData();if(o.type==="composite"){let s=this.viewDescriptorService.getViewContainerById(o.id);this.viewDescriptorService.getViewContainerLocation(s)===this.targetContainerLocation?e&&this.moveComposite(o.id,e,n):this.viewDescriptorService.moveViewContainerToLocation(s,this.targetContainerLocation,this.getTargetIndex(e,n),"dnd")}if(o.type==="view"){let s=this.viewDescriptorService.getViewDescriptorById(o.id);if(s&&s.canMoveView){this.viewDescriptorService.moveViewToLocation(s,this.targetContainerLocation,"dnd");let a=this.viewDescriptorService.getViewContainerByViewId(s.id);e&&this.moveComposite(a.id,e,n),this.openComposite(a.id,!0).then(l=>{l?.openView(s.id,!0)})}}}onDragEnter(t,e,i){return this.canDrop(t,e)}onDragOver(t,e,i){return this.canDrop(t,e)}getTargetIndex(t,e){if(!t)return;let i=this.getItems(),n=this.orientation===0?e?.horizontallyBefore:e?.verticallyBefore;return i.filter(o=>o.visible).findIndex(o=>o.id===t)+(n?0:1)}canDrop(t,e){let i=t.getData();if(i.type==="composite"){let n=this.viewDescriptorService.getViewContainerById(i.id);return this.viewDescriptorService.getViewContainerLocation(n)===this.targetContainerLocation?i.id!==e:!0}else{let n=this.viewDescriptorService.getViewDescriptorById(i.id);return!(!n||!n.canMoveView)}}},P4=class{constructor(t,e,i,n,o){this.compositeBarContainer=t;this.actionBarContainer=e;this.compositeBarModel=i;this.dndHandler=n;this.orientation=o}insertDropBefore=void 0;onDragOver(t){let e=this.compositeBarModel.visibleItems;if(!e.length||t.eventData.target&&Xi(t.eventData.target,this.actionBarContainer)){this.insertDropBefore=this.updateFromDragging(this.compositeBarContainer,!1,!1,!0);return}let i=this.insertAtFront(this.actionBarContainer,t.eventData),n=i?e[0]:e[e.length-1],o=this.dndHandler.onDragOver(t.dragAndDropData,n.id,t.eventData);Op(t.eventData.dataTransfer,"move",o),this.insertDropBefore=this.updateFromDragging(this.compositeBarContainer,o,i,!0)}onDragLeave(t){this.insertDropBefore=this.updateFromDragging(this.compositeBarContainer,!1,!1,!1)}onDragEnd(t){this.insertDropBefore=this.updateFromDragging(this.compositeBarContainer,!1,!1,!1)}onDrop(t){let e=this.compositeBarModel.visibleItems,i;e.length&&(i=this.insertAtFront(this.actionBarContainer,t.eventData)?e[0].id:e[e.length-1].id),this.dndHandler.drop(t.dragAndDropData,i,t.eventData,this.insertDropBefore),this.insertDropBefore=this.updateFromDragging(this.compositeBarContainer,!1,!1,!1)}insertAtFront(t,e){let i=t.getBoundingClientRect(),n=e.clientX,o=e.clientY;switch(this.orientation){case 0:return n<i.left;case 1:return o<i.top}}updateFromDragging(t,e,i,n){if(t.classList.toggle("dragged-over",n),t.classList.toggle("dragged-over-head",e&&i),t.classList.toggle("dragged-over-tail",e&&!i),!!e)return{verticallyBefore:i,horizontallyBefore:i}}},jI=class extends eo{constructor(e,i,n,o,s){super();this.options=i;this.instantiationService=n;this.contextMenuService=o;this.viewDescriptorService=s;this.model=new M4(e,i),this.visibleComposites=[],this.compositeSizeInBar=new Map,this.computeSizes(this.model.visibleItems)}_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;dimension;compositeSwitcherBar;compositeOverflowAction;compositeOverflowActionViewItem;model;visibleComposites;compositeSizeInBar;getCompositeBarItems(){return[...this.model.items]}setCompositeBarItems(e){this.model.setItems(e),this.updateCompositeSwitcher()}getPinnedComposites(){return this.model.pinnedItems}getVisibleComposites(){return this.model.visibleItems}create(e){let i=e.appendChild(re(".composite-bar"));this.compositeSwitcherBar=this._register(new gn(i,{actionViewItemProvider:(o,s)=>{if(o instanceof ax)return this.compositeOverflowActionViewItem;let a=this.model.findItem(o.id);return a&&this.instantiationService.createInstance(Iu,{...s,draggable:!0,colors:this.options.colors,icon:this.options.icon,hoverOptions:this.options.activityHoverOptions,compact:this.options.compact},o,a.pinnedAction,a.toggleBadgeAction,l=>this.options.getContextMenuActionsForComposite(l),()=>this.getContextMenuActions(),this.options.dndHandler,this)},orientation:this.options.orientation,ariaLabel:h("activityBarAriaLabel","Active View Switcher"),ariaRole:"tablist",preventLoopNavigation:this.options.preventLoopNavigation,triggerKeys:{keyDown:!0}})),this._register(M(e,G.CONTEXT_MENU,o=>this.showContextMenu(oe(e),o))),this._register(Wt.addTarget(e)),this._register(M(e,it.Contextmenu,o=>this.showContextMenu(oe(e),o)));let n=new P4(e,i,this.model,this.options.dndHandler,this.options.orientation);return this._register(Xa.INSTANCE.registerTarget(e,n)),i}focus(e){this.compositeSwitcherBar?.focus(e)}recomputeSizes(){this.computeSizes(this.model.visibleItems),this.updateCompositeSwitcher()}layout(e){this.dimension=e,!(e.height===0||e.width===0)&&(this.compositeSizeInBar.size===0&&this.computeSizes(this.model.visibleItems),this.updateCompositeSwitcher())}addComposite({id:e,name:i,order:n,requestedIndex:o}){this.model.add(e,i,n,o)&&(this.computeSizes([this.model.findItem(e)]),this.updateCompositeSwitcher())}removeComposite(e){this.isPinned(e)&&this.unpin(e),this.model.remove(e)&&this.updateCompositeSwitcher()}hideComposite(e){this.model.hide(e)&&(this.resetActiveComposite(e),this.updateCompositeSwitcher())}activateComposite(e){let i=this.model.activeItem;this.model.activate(e)&&(this.visibleComposites.indexOf(e)===-1||this.model.activeItem&&!this.model.activeItem.pinned||i&&!i.pinned)&&this.updateCompositeSwitcher()}deactivateComposite(e){let i=this.model.activeItem;this.model.deactivate()&&i&&!i.pinned&&this.updateCompositeSwitcher()}async pin(e,i){this.model.setPinned(e,!0)&&(this.updateCompositeSwitcher(),i&&(await this.options.openComposite(e),this.activateComposite(e)))}unpin(e){this.model.setPinned(e,!1)&&(this.updateCompositeSwitcher(),this.resetActiveComposite(e))}areBadgesEnabled(e){return this.viewDescriptorService.getViewContainerBadgeEnablementState(e)}toggleBadgeEnablement(e){this.viewDescriptorService.setViewContainerBadgeEnablementState(e,!this.areBadgesEnabled(e)),this.updateCompositeSwitcher();let i=this.model.findItem(e);i&&(i.activityAction.activity=i.activityAction.activity)}resetActiveComposite(e){let i=this.options.getDefaultCompositeId();!this.model.activeItem||this.model.activeItem.id!==e||(this.deactivateComposite(e),i&&i!==e&&this.isPinned(i)?this.options.openComposite(i,!0):this.options.openComposite(this.visibleComposites.filter(n=>n!==e)[0]))}isPinned(e){return this.model.findItem(e)?.pinned}move(e,i,n){if(n!==void 0){let o=this.model.items.findIndex(a=>a.id===e),s=this.model.items.findIndex(a=>a.id===i);o>=0&&s>=0&&(!n&&o>s&&s++,n&&o<s&&s--,s<this.model.items.length&&s>=0&&s!==o&&this.model.move(this.model.items[o].id,this.model.items[s].id)&&setTimeout(()=>this.updateCompositeSwitcher(),0))}else this.model.move(e,i)&&setTimeout(()=>this.updateCompositeSwitcher(),0)}getAction(e){return this.model.findItem(e)?.activityAction}computeSizes(e){let i=this.options.compositeSize;if(i)e.forEach(n=>this.compositeSizeInBar.set(n.id,i));else{let n=this.compositeSwitcherBar;if(n&&this.dimension&&this.dimension.height!==0&&this.dimension.width!==0){let o=n.viewItems.length;n.push(e.map(s=>s.activityAction)),e.map((s,a)=>this.compositeSizeInBar.set(s.id,this.options.orientation===1?n.getHeight(o+a):n.getWidth(o+a))),e.forEach(()=>n.pull(n.viewItems.length-1))}}}updateCompositeSwitcher(){let e=this.compositeSwitcherBar;if(!e||!this.dimension)return;let i=this.model.visibleItems.filter(d=>d.pinned||this.model.activeItem&&this.model.activeItem.id===d.id).map(d=>d.id),n=i.length,o=i.length,s=0,a=this.options.orientation===1?this.dimension.height:this.dimension.width;for(let d=0;d<i.length;d++){let c=this.compositeSizeInBar.get(i[d]);if(s+c>a){n=d;break}s+=c}for(o>n&&(i=i.slice(0,n)),this.model.activeItem&&i.every(d=>!!this.model.activeItem&&d!==this.model.activeItem.id)&&(s+=this.compositeSizeInBar.get(this.model.activeItem.id),i.push(this.model.activeItem.id));s>a&&i.length;){let d=i.length>1?i.splice(i.length-2,1)[0]:i.pop();s-=this.compositeSizeInBar.get(d)}for(o>i.length&&(s+=this.options.overflowActionSize);s>a&&i.length;){let d=i.length>1&&i[i.length-1]===this.model.activeItem?.id?i.splice(i.length-2,1)[0]:i.pop();s-=this.compositeSizeInBar.get(d)}o===i.length&&this.compositeOverflowAction&&(e.pull(e.length()-1),this.compositeOverflowAction.dispose(),this.compositeOverflowAction=void 0,this.compositeOverflowActionViewItem?.dispose(),this.compositeOverflowActionViewItem=void 0);let l=[];this.visibleComposites.forEach((d,c)=>{i.includes(d)||l.push(c)}),l.reverse().forEach(d=>{e.pull(d),this.visibleComposites.splice(d,1)}),i.forEach((d,c)=>{let u=this.visibleComposites.indexOf(d);c!==u&&(u!==-1&&(e.pull(u),this.visibleComposites.splice(u,1)),e.push(this.model.findItem(d).activityAction,{label:!0,icon:this.options.icon,index:c}),this.visibleComposites.splice(c,0,d))}),o>i.length&&!this.compositeOverflowAction&&(this.compositeOverflowAction=this._register(this.instantiationService.createInstance(ax,()=>{this.compositeOverflowActionViewItem?.showMenu()})),this.compositeOverflowActionViewItem=this._register(this.instantiationService.createInstance(qI,this.compositeOverflowAction,()=>this.getOverflowingComposites(),()=>this.model.activeItem?this.model.activeItem.id:void 0,d=>this.model.findItem(d)?.activity[0]?.badge,this.options.getOnCompositeClickAction,this.options.colors,this.options.activityHoverOptions)),e.push(this.compositeOverflowAction,{label:!1,icon:!0})),this._onDidChange.fire()}getOverflowingComposites(){let e=this.model.visibleItems.filter(i=>i.pinned).map(i=>i.id);return this.model.activeItem&&!this.model.activeItem.pinned&&e.push(this.model.activeItem.id),e=e.filter(i=>!this.visibleComposites.includes(i)),this.model.visibleItems.filter(i=>e.includes(i.id)).map(i=>({id:i.id,name:this.getAction(i.id)?.label||i.name}))}showContextMenu(e,i){Te.stop(i,!0);let n=new ri(e,i);this.contextMenuService.showContextMenu({getAnchor:()=>n,getActions:()=>this.getContextMenuActions(i)})}getContextMenuActions(e){let i=this.model.visibleItems.map(({id:n,name:o,activityAction:s})=>Ht({id:n,label:this.getAction(n).label||o||n,checked:this.isPinned(n),enabled:s.enabled,run:()=>{this.isPinned(n)?this.unpin(n):this.pin(n,!0)}}));return this.options.fillExtraContextMenuActions(i,e),i}};jI=_([v(2,ae),v(3,Mt),v(4,zi)],jI);var M4=class{_items=[];get items(){return this._items}options;activeItem;constructor(t,e){this.options=e,this.setItems(t)}setItems(t){this._items=[],this._items=t.map(e=>this.createCompositeBarItem(e.id,e.name,e.order,e.pinned,e.visible))}get visibleItems(){return this.items.filter(t=>t.visible)}get pinnedItems(){return this.items.filter(t=>t.visible&&t.pinned)}createCompositeBarItem(t,e,i,n,o){let s=this.options;return{id:t,name:e,pinned:n,order:i,visible:o,activity:[],get activityAction(){return s.getActivityAction(t)},get pinnedAction(){return s.getCompositePinnedAction(t)},get toggleBadgeAction(){return s.getCompositeBadgeAction(t)}}}add(t,e,i,n){let o=this.findItem(t);if(o){let s=!1;return o.name=e,Zi(i)||(s=o.order!==i,o.order=i),o.visible||(o.visible=!0,s=!0),s}else{let s=this.createCompositeBarItem(t,e,i,!0,!0);if(Zi(n))if(Zi(i))this.items.push(s);else{let a=0;for(;a<this.items.length&&typeof this.items[a].order=="number"&&this.items[a].order<i;)a++;this.items.splice(a,0,s)}else{let a=0,l=n;for(;l>0&&a<this.items.length;)this.items[a++].visible&&l--;this.items.splice(a,0,s)}return!0}}remove(t){for(let e=0;e<this.items.length;e++)if(this.items[e].id===t)return this.items.splice(e,1),!0;return!1}hide(t){for(let e of this.items)if(e.id===t)return e.visible?(e.visible=!1,!0):!1;return!1}move(t,e){let i=this.findIndex(t),n=this.findIndex(e);if(i===-1||n===-1)return!1;let o=this.items.splice(i,1)[0];return this.items.splice(n,0,o),o.pinned=!0,!0}setPinned(t,e){for(let i of this.items)if(i.id===t)return i.pinned!==e?(i.pinned=e,!0):!1;return!1}activate(t){if(!this.activeItem||this.activeItem.id!==t){this.activeItem&&this.deactivate();for(let e of this.items)if(e.id===t)return this.activeItem=e,this.activeItem.activityAction.activate(),!0}return!1}deactivate(){return this.activeItem?(this.activeItem.activityAction.deactivate(),this.activeItem=void 0,!0):!1}findItem(t){return this.items.filter(e=>e.id===t)[0]}findIndex(t){for(let e=0;e<this.items.length;e++)if(this.items[e].id===t)return e;return-1}};var Nm=class extends L{constructor(e,i,n,o,s,a,l,d,c,u,p){super();this.options=e;this.part=i;this.paneCompositePart=n;this.instantiationService=o;this.storageService=s;this.extensionService=a;this.viewDescriptorService=l;this.viewService=d;this.contextKeyService=c;this.environmentService=u;this.layoutService=p;this.location=n.partId==="workbench.parts.panel"?1:n.partId==="workbench.parts.auxiliarybar"?2:0,this.dndHandler=new R0(this.viewDescriptorService,this.location,this.options.orientation,async(g,f)=>await this.paneCompositePart.openPaneComposite(g,f)??null,(g,f,b)=>this.compositeBar.move(g,f,this.options.orientation===1?b?.verticallyBefore:b?.horizontallyBefore),()=>this.compositeBar.getCompositeBarItems());let m=this.cachedViewContainers.map(g=>({id:g.id,name:g.name,visible:!this.shouldBeHidden(g.id,g),order:g.order,pinned:g.pinned}));this.compositeBar=this.createCompositeBar(m),this.onDidRegisterViewContainers(this.getViewContainers()),this.registerListeners()}viewContainerDisposables=this._register(new Bo);location;compositeBar;dndHandler;compositeActions=new Map;hasExtensionsRegistered=!1;createCompositeBar(e){return this._register(this.instantiationService.createInstance(jI,e,{icon:this.options.icon,compact:this.options.compact,orientation:this.options.orientation,activityHoverOptions:this.options.activityHoverOptions,preventLoopNavigation:this.options.preventLoopNavigation,openComposite:async(i,n)=>await this.paneCompositePart.openPaneComposite(i,!n)??null,getActivityAction:i=>this.getCompositeActions(i).activityAction,getCompositePinnedAction:i=>this.getCompositeActions(i).pinnedAction,getCompositeBadgeAction:i=>this.getCompositeActions(i).badgeAction,getOnCompositeClickAction:i=>this.getCompositeActions(i).activityAction,fillExtraContextMenuActions:(i,n)=>this.options.fillExtraContextMenuActions(i,n),getContextMenuActionsForComposite:i=>this.getContextMenuActionsForComposite(i),getDefaultCompositeId:()=>this.viewDescriptorService.getDefaultViewContainer(this.location)?.id,dndHandler:this.dndHandler,compositeSize:this.options.compositeSize,overflowActionSize:this.options.overflowActionSize,colors:i=>this.options.colors(i)}))}getContextMenuActionsForComposite(e){let i=[],n=this.viewDescriptorService.getViewContainerById(e),o=this.viewDescriptorService.getDefaultViewContainerLocation(n);if(o!==this.viewDescriptorService.getViewContainerLocation(n))i.push(Ht({id:"resetLocationAction",label:h("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewContainerToLocation(n,o,void 0,"resetLocationAction")}));else{let s=this.viewDescriptorService.getViewContainerModel(n);if(s.allViewDescriptors.length===1){let a=s.allViewDescriptors[0],l=this.viewDescriptorService.getDefaultContainerById(a.id);l!==n&&i.push(Ht({id:"resetLocationAction",label:h("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewsToContainer([a],l,void 0,"resetLocationAction")}))}}return i}registerListeners(){this._register(this.viewDescriptorService.onDidChangeViewContainers(({added:e,removed:i})=>this.onDidChangeViewContainers(e,i))),this._register(this.viewDescriptorService.onDidChangeContainerLocation(({viewContainer:e,from:i,to:n})=>this.onDidChangeViewContainerLocation(e,i,n))),this._register(this.paneCompositePart.onDidPaneCompositeOpen(e=>this.onDidChangeViewContainerVisibility(e.getId(),!0))),this._register(this.paneCompositePart.onDidPaneCompositeClose(e=>this.onDidChangeViewContainerVisibility(e.getId(),!1))),this.extensionService.whenInstalledExtensionsRegistered().then(()=>{this._store.isDisposed||(this.onDidRegisterExtensions(),this._register(this.compositeBar.onDidChange(()=>this.saveCachedViewContainers())),this._register(this.storageService.onDidChangeValue(0,this.options.pinnedViewContainersKey,this._store)(e=>this.onDidPinnedViewContainersStorageValueChange(e))))})}onDidChangeViewContainers(e,i){i.filter(({location:n})=>n===this.location).forEach(({container:n})=>this.onDidDeregisterViewContainer(n)),this.onDidRegisterViewContainers(e.filter(({location:n})=>n===this.location).map(({container:n})=>n))}onDidChangeViewContainerLocation(e,i,n){i===this.location&&this.onDidDeregisterViewContainer(e),n===this.location&&this.onDidRegisterViewContainers([e])}onDidChangeViewContainerVisibility(e,i){i?this.onDidViewContainerVisible(e):this.compositeBar.deactivateComposite(e)}onDidRegisterExtensions(){this.hasExtensionsRegistered=!0;for(let{id:e}of this.cachedViewContainers){let i=this.getViewContainer(e);i?this.showOrHideViewContainer(i):this.viewDescriptorService.isViewContainerRemovedPermanently(e)?this.removeComposite(e):this.hideComposite(e)}this.saveCachedViewContainers()}onDidViewContainerVisible(e){let i=this.getViewContainer(e);i&&(this.addComposite(i),this.compositeBar.activateComposite(i.id),this.shouldBeHidden(i)&&this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.length===0&&this.hideComposite(i.id))}create(e){return this.compositeBar.create(e)}getCompositeActions(e){let i=this.compositeActions.get(e);if(!i){let n=this.getViewContainer(e);if(n){let o=this.viewDescriptorService.getViewContainerModel(n);i={activityAction:this._register(this.instantiationService.createInstance(Fm,this.toCompositeBarActionItemFrom(o),this.part,this.paneCompositePart)),pinnedAction:this._register(new lx(this.toCompositeBarActionItemFrom(o),this.compositeBar)),badgeAction:this._register(new dx(this.toCompositeBarActionItemFrom(o),this.compositeBar))}}else{let o=this.cachedViewContainers.filter(s=>s.id===e)[0];i={activityAction:this._register(this.instantiationService.createInstance(O4,this.toCompositeBarActionItem(e,o?.name??e,o?.icon,void 0),this.part,this.paneCompositePart)),pinnedAction:this._register(new A0(e,this.compositeBar)),badgeAction:this._register(new N4(e,this.compositeBar))}}this.compositeActions.set(e,i)}return i}onDidRegisterViewContainers(e){for(let i of e){this.addComposite(i),this.cachedViewContainers.filter(({id:l})=>l===i.id)[0]||this.compositeBar.pin(i.id),this.paneCompositePart.getActivePaneComposite()?.getId()===i.id&&this.compositeBar.activateComposite(i.id);let s=this.viewDescriptorService.getViewContainerModel(i);this.updateCompositeBarActionItem(i,s),this.showOrHideViewContainer(i);let a=new W;a.add(s.onDidChangeContainerInfo(()=>this.updateCompositeBarActionItem(i,s))),a.add(s.onDidChangeActiveViewDescriptors(()=>this.showOrHideViewContainer(i))),this.viewContainerDisposables.set(i.id,a)}}onDidDeregisterViewContainer(e){this.viewContainerDisposables.deleteAndDispose(e.id),this.removeComposite(e.id)}updateCompositeBarActionItem(e,i){let n=this.toCompositeBarActionItemFrom(i),{activityAction:o,pinnedAction:s}=this.getCompositeActions(e.id);o.updateCompositeBarActionItem(n),s instanceof A0&&s.setActivity(n),this.options.recomputeSizes&&this.compositeBar.recomputeSizes(),this.saveCachedViewContainers()}toCompositeBarActionItemFrom(e){return this.toCompositeBarActionItem(e.viewContainer.id,e.title,e.icon,e.keybindingId)}toCompositeBarActionItem(e,i,n,o){let s,a;if(this.options.icon)if(q.isUri(n)){a=n;let l=vl(n),d=new ZD;d.update(l);let c=`activity-${e.replace(/\./g,"-")}-${d.digest()}`,u=`.monaco-workbench .${this.options.partContainerClass} .monaco-action-bar .action-label.${c}`;s=[c,"uri-icon"],Zw(u,`
				mask: ${l} no-repeat 50% 50%;
				mask-size: ${this.options.iconSize}px;
				-webkit-mask: ${l} no-repeat 50% 50%;
				-webkit-mask-size: ${this.options.iconSize}px;
				mask-origin: padding;
				-webkit-mask-origin: padding;
			`)}else ye.isThemeIcon(n)&&(s=ye.asClassNameArray(n));return{id:e,name:i,classNames:s,iconUrl:a,keybindingId:o}}showOrHideViewContainer(e){this.shouldBeHidden(e)?this.hideComposite(e.id):this.addComposite(e)}shouldBeHidden(e,i){let n=si(e)?this.getViewContainer(e):e,o=si(e)?e:e.id;if(n)if(n.hideIfEmpty){if(this.viewService.isViewContainerActive(o))return!1}else return!1;if(!this.hasExtensionsRegistered&&!(this.part==="workbench.parts.sidebar"&&this.environmentService.remoteAuthority&&Pi)){if(i=i||this.cachedViewContainers.find(({id:s})=>s===o),!n&&i?.isBuiltin&&i?.visible)return!1;if(i?.views?.length)return i.views.every(({when:s})=>!!s&&!this.contextKeyService.contextMatchesRules(X.deserialize(s)))}return!0}addComposite(e){this.compositeBar.addComposite({id:e.id,name:typeof e.title=="string"?e.title:e.title.value,order:e.order,requestedIndex:e.requestedIndex})}hideComposite(e){this.compositeBar.hideComposite(e);let i=this.compositeActions.get(e);i&&(i.activityAction.dispose(),i.pinnedAction.dispose(),this.compositeActions.delete(e))}removeComposite(e){this.compositeBar.removeComposite(e);let i=this.compositeActions.get(e);i&&(i.activityAction.dispose(),i.pinnedAction.dispose(),this.compositeActions.delete(e))}getPinnedPaneCompositeIds(){let e=this.compositeBar.getPinnedComposites().map(i=>i.id);return this.getViewContainers().filter(i=>this.compositeBar.isPinned(i.id)).sort((i,n)=>e.indexOf(i.id)-e.indexOf(n.id)).map(i=>i.id)}getVisiblePaneCompositeIds(){return this.compositeBar.getVisibleComposites().filter(e=>this.paneCompositePart.getActivePaneComposite()?.getId()===e.id||this.compositeBar.isPinned(e.id)).map(e=>e.id)}getContextMenuActions(){return this.compositeBar.getContextMenuActions()}focus(e){this.compositeBar.focus(e)}layout(e,i){this.compositeBar.layout(new dt(e,i))}getViewContainer(e){let i=this.viewDescriptorService.getViewContainerById(e);return i&&this.viewDescriptorService.getViewContainerLocation(i)===this.location?i:void 0}getViewContainers(){return this.viewDescriptorService.getViewContainersByLocation(this.location)}onDidPinnedViewContainersStorageValueChange(e){if(this.pinnedViewContainersValue!==this.getStoredPinnedViewContainersValue()){this._placeholderViewContainersValue=void 0,this._pinnedViewContainersValue=void 0,this._cachedViewContainers=void 0;let i=[],n=this.compositeBar.getCompositeBarItems();for(let o of this.cachedViewContainers)i.push({id:o.id,name:o.name,order:o.order,pinned:o.pinned,visible:o.visible&&!!this.getViewContainer(o.id)});for(let o of this.getViewContainers())if(!i.some(({id:s})=>s===o.id)){let s=n.findIndex(({id:a})=>a===o.id);if(s!==-1){let a=n[s];i.splice(s,0,{id:o.id,name:typeof o.title=="string"?o.title:o.title.value,order:a.order,pinned:a.pinned,visible:a.visible})}else i.push({id:o.id,name:typeof o.title=="string"?o.title:o.title.value,order:o.order,pinned:!0,visible:!this.shouldBeHidden(o)})}this.compositeBar.setCompositeBarItems(i)}}saveCachedViewContainers(){let e=[],i=this.compositeBar.getCompositeBarItems();for(let n of i){let o=this.getViewContainer(n.id);if(o){let s=this.viewDescriptorService.getViewContainerModel(o),a=[];for(let{when:l}of s.allViewDescriptors)a.push({when:l?l.serialize():void 0});e.push({id:n.id,name:s.title,icon:q.isUri(s.icon)&&this.environmentService.remoteAuthority?void 0:s.icon,views:a,pinned:n.pinned,order:n.order,visible:n.visible,isBuiltin:!o.extensionId})}else e.push({id:n.id,name:n.name,pinned:n.pinned,order:n.order,visible:!1,isBuiltin:!1})}this.storeCachedViewContainersState(e)}_cachedViewContainers=void 0;get cachedViewContainers(){if(this._cachedViewContainers===void 0){this._cachedViewContainers=this.getPinnedViewContainers();for(let e of this.getPlaceholderViewContainers()){let i=this._cachedViewContainers.find(n=>n.id===e.id);i&&(i.visible=e.visible??i.visible,i.name=e.name,i.icon=e.themeIcon?e.themeIcon:e.iconUrl?q.revive(e.iconUrl):void 0,q.isUri(i.icon)&&this.environmentService.remoteAuthority&&(i.icon=void 0),i.views=e.views,i.isBuiltin=e.isBuiltin)}for(let e of this.getViewContainersWorkspaceState()){let i=this._cachedViewContainers.find(n=>n.id===e.id);i&&(i.visible=e.visible??i.visible)}}return this._cachedViewContainers}storeCachedViewContainersState(e){let i=this.getPinnedViewContainers();this.setPinnedViewContainers(e.map(({id:n,pinned:o,order:s})=>({id:n,pinned:o,visible:!!i.find(({id:a})=>a===n)?.visible,order:s}))),this.setPlaceholderViewContainers(e.map(({id:n,icon:o,name:s,views:a,isBuiltin:l})=>({id:n,iconUrl:q.isUri(o)?o:void 0,themeIcon:ye.isThemeIcon(o)?o:void 0,name:s,isBuiltin:l,views:a}))),this.setViewContainersWorkspaceState(e.map(({id:n,visible:o})=>({id:n,visible:o})))}getPinnedViewContainers(){return JSON.parse(this.pinnedViewContainersValue)}setPinnedViewContainers(e){this.pinnedViewContainersValue=JSON.stringify(e)}_pinnedViewContainersValue;get pinnedViewContainersValue(){return this._pinnedViewContainersValue||(this._pinnedViewContainersValue=this.getStoredPinnedViewContainersValue()),this._pinnedViewContainersValue}set pinnedViewContainersValue(e){this.pinnedViewContainersValue!==e&&(this._pinnedViewContainersValue=e,this.setStoredPinnedViewContainersValue(e))}getStoredPinnedViewContainersValue(){return this.storageService.get(this.options.pinnedViewContainersKey,0,"[]")}setStoredPinnedViewContainersValue(e){this.storageService.store(this.options.pinnedViewContainersKey,e,0,0)}getPlaceholderViewContainers(){return JSON.parse(this.placeholderViewContainersValue)}setPlaceholderViewContainers(e){this.placeholderViewContainersValue=JSON.stringify(e)}_placeholderViewContainersValue;get placeholderViewContainersValue(){return this._placeholderViewContainersValue||(this._placeholderViewContainersValue=this.getStoredPlaceholderViewContainersValue()),this._placeholderViewContainersValue}set placeholderViewContainersValue(e){this.placeholderViewContainersValue!==e&&(this._placeholderViewContainersValue=e,this.setStoredPlaceholderViewContainersValue(e))}getStoredPlaceholderViewContainersValue(){return this.storageService.get(this.options.placeholderViewContainersKey,0,"[]")}setStoredPlaceholderViewContainersValue(e){this.storageService.store(this.options.placeholderViewContainersKey,e,0,1)}getViewContainersWorkspaceState(){return JSON.parse(this.viewContainersWorkspaceStateValue)}setViewContainersWorkspaceState(e){this.viewContainersWorkspaceStateValue=JSON.stringify(e)}_viewContainersWorkspaceStateValue;get viewContainersWorkspaceStateValue(){return this._viewContainersWorkspaceStateValue||(this._viewContainersWorkspaceStateValue=this.getStoredViewContainersWorkspaceStateValue()),this._viewContainersWorkspaceStateValue}set viewContainersWorkspaceStateValue(e){this.viewContainersWorkspaceStateValue!==e&&(this._viewContainersWorkspaceStateValue=e,this.setStoredViewContainersWorkspaceStateValue(e))}getStoredViewContainersWorkspaceStateValue(){return this.storageService.get(this.options.viewContainersWorkspaceStateKey,1,"[]")}setStoredViewContainersWorkspaceStateValue(e){this.storageService.store(this.options.viewContainersWorkspaceStateKey,e,1,1)}};Nm=_([v(3,ae),v(4,tt),v(5,xn),v(6,zi),v(7,va),v(8,ke),v(9,on),v(10,Qe)],Nm);var Fm=class extends Gp{constructor(e,i,n,o,s,a,l){super(e);this.part=i;this.paneCompositePart=n;this.layoutService=o;this.telemetryService=s;this.configurationService=a;this.activityService=l;this.updateActivity(),this._register(this.activityService.onDidChangeActivity(d=>{!si(d)&&d.id===this.compositeBarActionItem.id&&this.updateActivity()}))}static preventDoubleClickDelay=300;lastRun=0;updateCompositeBarActionItem(e){this.compositeBarActionItem=e}updateActivity(){let e=this.activityService.getViewContainerActivities(this.compositeBarActionItem.id);this.activity=e[0]}async run(e){if(Na(e)&&e.button===2)return;let i=Date.now();if(i>this.lastRun&&i-this.lastRun<Fm.preventDoubleClickDelay)return;this.lastRun=i;let n=e&&"preserveFocus"in e?!e.preserveFocus:!0;if(this.part==="workbench.parts.activitybar"){let o=this.layoutService.isVisible("workbench.parts.sidebar"),s=this.paneCompositePart.getActivePaneComposite(),a=this.configurationService.getValue("workbench.activityBar.iconClickBehavior");if(o&&s?.getId()===this.compositeBarActionItem.id){switch(a){case"focus":this.logAction("refocus"),this.paneCompositePart.openPaneComposite(this.compositeBarActionItem.id,n);break;case"toggle":default:this.logAction("hide"),this.layoutService.setPartHidden(!0,"workbench.parts.sidebar");break}return}this.logAction("show")}return await this.paneCompositePart.openPaneComposite(this.compositeBarActionItem.id,n),this.activate()}logAction(e){this.telemetryService.publicLog2("activityBarAction",{viewletId:this.compositeBarActionItem.id,action:e})}};Fm=_([v(3,Qe),v(4,qt),v(5,de),v(6,Om)],Fm);var O4=class extends Fm{},A0=class extends lx{constructor(t,e){super({id:t,name:t,classNames:void 0},e)}setActivity(t){this.label=t.name}},N4=class extends dx{constructor(t,e){super({id:t,name:t,classNames:void 0},e)}setCompositeBarActionItem(t){this.label=t.name}};var Bl=class extends D0{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y,I,E,S,w){let D=0,k=Wf.Viewlets,R=ee.SidebarTitle;e==="workbench.parts.panel"?(D=1,k=Wf.Panels,R=ee.PanelTitle):e==="workbench.parts.auxiliarybar"&&(D=2,k=Wf.Auxiliary,R=ee.AuxiliaryBarTitle);super(c,u,p,m,g,f,b,y,Ne.as(k),n,I.getDefaultViewContainer(D)?.id||"",a,l,d,e,i);this.partId=e;this.activePaneContextKey=o;this.paneFocusContextKey=s;this.viewDescriptorService=I;this.contextKeyService=E;this.extensionService=S;this.menuService=w;this.location=D,this.globalActions=this._register(this.instantiationService.createInstance(Pl,R,void 0,void 0)),this.registerListeners()}static MIN_COMPOSITE_BAR_WIDTH=50;get snap(){return this.layoutService.isVisible(this.partId)||!!this.paneCompositeBar.value?.getVisiblePaneCompositeIds().length}get onDidPaneCompositeOpen(){return O.map(this.onDidCompositeOpen.event,e=>e.composite)}onDidPaneCompositeClose=this.onDidCompositeClose.event;location;titleContainer;headerFooterCompositeBarContainer;headerFooterCompositeBarDispoables=this._register(new W);paneCompositeBarContainer;paneCompositeBar=this._register(new mt);compositeBarPosition=void 0;emptyPaneMessageElement;globalToolBar;globalActions;blockOpening=!1;contentDimension;registerListeners(){this._register(this.onDidPaneCompositeOpen(e=>this.onDidOpen(e))),this._register(this.onDidPaneCompositeClose(this.onDidClose,this)),this._register(this.globalActions.onDidChange(()=>this.updateGlobalToolbarActions())),this._register(this.registry.onDidDeregister(e=>{let i=this.viewDescriptorService.getViewContainersByLocation(this.location).filter(n=>this.viewDescriptorService.getViewContainerModel(n).activeViewDescriptors.length>0);if(i.length){if(this.getActiveComposite()?.getId()===e.id){let n=this.viewDescriptorService.getDefaultViewContainer(this.location)?.id,o=i.filter(s=>s.id===n)[0]||i[0];this.doOpenPaneComposite(o.id)}}else this.layoutService.setPartHidden(!0,this.partId);this.removeComposite(e.id)})),this._register(this.extensionService.onDidRegisterExtensions(()=>{this.layoutCompositeBar()}))}onDidOpen(e){this.activePaneContextKey.set(e.getId())}onDidClose(e){let i=e.getId();this.activePaneContextKey.get()===i&&this.activePaneContextKey.reset()}showComposite(e){super.showComposite(e),this.layoutCompositeBar(),this.layoutEmptyMessage()}hideActiveComposite(){let e=super.hideActiveComposite();return this.layoutCompositeBar(),this.layoutEmptyMessage(),e}create(e){this.element=e,this.element.classList.add("pane-composite-part"),super.create(e);let i=this.getContentArea();i&&this.createEmptyPaneMessage(i),this.updateCompositeBar();let n=this._register(Un(e));this._register(n.onDidFocus(()=>this.paneFocusContextKey.set(!0))),this._register(n.onDidBlur(()=>this.paneFocusContextKey.set(!1)))}createEmptyPaneMessage(e){this.emptyPaneMessageElement=document.createElement("div"),this.emptyPaneMessageElement.classList.add("empty-pane-message-area");let i=document.createElement("div");i.classList.add("empty-pane-message"),i.innerText=h("pane.emptyMessage","Drag a view here to display."),this.emptyPaneMessageElement.appendChild(i),e.appendChild(this.emptyPaneMessageElement),this._register(Xa.INSTANCE.registerTarget(this.element,{onDragOver:n=>{if(Te.stop(n.eventData,!0),this.paneCompositeBar.value){let o=this.paneCompositeBar.value.dndHandler.onDragEnter(n.dragAndDropData,void 0,n.eventData);Op(n.eventData.dataTransfer,"move",o)}},onDragEnter:n=>{if(Te.stop(n.eventData,!0),this.paneCompositeBar.value){let o=this.paneCompositeBar.value.dndHandler.onDragEnter(n.dragAndDropData,void 0,n.eventData);this.emptyPaneMessageElement.style.backgroundColor=o&&this.theme.getColor(Pv)?.toString()||""}},onDragLeave:n=>{Te.stop(n.eventData,!0),this.emptyPaneMessageElement.style.backgroundColor=""},onDragEnd:n=>{Te.stop(n.eventData,!0),this.emptyPaneMessageElement.style.backgroundColor=""},onDrop:n=>{if(Te.stop(n.eventData,!0),this.emptyPaneMessageElement.style.backgroundColor="",this.paneCompositeBar.value)this.paneCompositeBar.value.dndHandler.drop(n.dragAndDropData,void 0,n.eventData);else{let o=n.dragAndDropData.getData();if(o.type==="composite"){let s=this.viewDescriptorService.getViewContainerById(o.id);this.viewDescriptorService.moveViewContainerToLocation(s,this.location,void 0,"dnd"),this.openPaneComposite(s.id,!0)}else if(o.type==="view"){let s=this.viewDescriptorService.getViewDescriptorById(o.id);if(s&&s.canMoveView){this.viewDescriptorService.moveViewToLocation(s,this.location,"dnd");let a=this.viewDescriptorService.getViewContainerByViewId(s.id);this.openPaneComposite(a.id,!0).then(l=>{l?.openView(s.id,!0)})}}}}}))}createTitleArea(e){let i=super.createTitleArea(e);this._register(M(i,G.CONTEXT_MENU,o=>{this.onTitleAreaContextMenu(new ri(oe(i),o))})),this._register(Wt.addTarget(i)),this._register(M(i,it.Contextmenu,o=>{this.onTitleAreaContextMenu(new ri(oe(i),o))}));let n=i.appendChild(re(".global-actions"));return this.globalToolBar=this._register(this.instantiationService.createInstance(pr,n,{actionViewItemProvider:(o,s)=>this.actionViewItemProvider(o,s),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:h("moreActions","More Actions..."),hoverDelegate:this.toolbarHoverDelegate,hiddenItemStrategy:-1})),this.updateGlobalToolbarActions(),i}createTitleLabel(e){this.titleContainer=e;let i=super.createTitleLabel(e);this.titleLabelElement.draggable=!0;let n=()=>({type:"composite",id:this.getActivePaneComposite().getId()});return this._register(Xa.INSTANCE.registerDraggable(this.titleLabelElement,n,{})),i}updateCompositeBar(e=!1){let i=this.compositeBarPosition!==void 0,n=this.shouldShowCompositeBar(),o=this.compositeBarPosition,s=n?this.getCompositeBarPosition():void 0;if(!e&&o===s)return;if(i){let l=o===1?this.titleContainer:this.headerFooterCompositeBarContainer;if(!this.paneCompositeBarContainer||!this.paneCompositeBar.value||!l)throw new Error("Composite bar containers should exist when removing the previous composite bar");this.paneCompositeBarContainer.remove(),this.paneCompositeBarContainer=void 0,this.paneCompositeBar.value=void 0,l.classList.remove("has-composite-bar"),o===0?this.removeFooterHeaderArea(!0):o===2&&this.removeFooterHeaderArea(!1)}let a;switch(s){case 0:a=this.createHeaderArea();break;case 1:a=this.titleContainer;break;case 2:a=this.createFooterArea();break}if(n){if(this.paneCompositeBarContainer||this.paneCompositeBar.value||!a)throw new Error("Invalid composite bar state when creating the new composite bar");a.classList.add("has-composite-bar"),this.paneCompositeBarContainer=up(a,re(".composite-bar-container")),this.paneCompositeBar.value=this.createCompositeBar(),this.paneCompositeBar.value.create(this.paneCompositeBarContainer),s===0?this.setHeaderArea(a):s===2&&this.setFooterArea(a)}this.compositeBarPosition=s,e&&this.layoutCompositeBar()}createHeaderArea(){let e=super.createHeaderArea();return this.createHeaderFooterCompositeBarArea(e)}createFooterArea(){let e=super.createFooterArea();return this.createHeaderFooterCompositeBarArea(e)}createHeaderFooterCompositeBarArea(e){if(this.headerFooterCompositeBarContainer)throw new Error("Header or Footer composite bar already exists");return this.headerFooterCompositeBarContainer=e,this.headerFooterCompositeBarDispoables.add(M(e,G.CONTEXT_MENU,i=>{this.onCompositeBarAreaContextMenu(new ri(oe(e),i))})),this.headerFooterCompositeBarDispoables.add(Wt.addTarget(e)),this.headerFooterCompositeBarDispoables.add(M(e,it.Contextmenu,i=>{this.onCompositeBarAreaContextMenu(new ri(oe(e),i))})),e}removeFooterHeaderArea(e){this.headerFooterCompositeBarContainer=void 0,this.headerFooterCompositeBarDispoables.clear(),e?this.removeHeaderArea():this.removeFooterArea()}createCompositeBar(){return this.instantiationService.createInstance(Nm,this.getCompositeBarOptions(),this.partId,this)}onTitleAreaUpdate(e){super.onTitleAreaUpdate(e),this.layoutCompositeBar()}async openPaneComposite(e,i){if(typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPaneComposite(e,i);if(await this.extensionService.whenInstalledExtensionsRegistered(),typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPaneComposite(e,i)}doOpenPaneComposite(e,i){if(!this.blockOpening){if(!this.layoutService.isVisible(this.partId))try{this.blockOpening=!0,this.layoutService.setPartHidden(!1,this.partId)}finally{this.blockOpening=!1}return this.openComposite(e,i)}}getPaneComposite(e){return this.registry.getPaneComposite(e)}getPaneComposites(){return this.registry.getPaneComposites().sort((e,i)=>typeof e.order!="number"?1:typeof i.order!="number"?-1:e.order-i.order)}getPinnedPaneCompositeIds(){return this.paneCompositeBar.value?.getPinnedPaneCompositeIds()??[]}getVisiblePaneCompositeIds(){return this.paneCompositeBar.value?.getVisiblePaneCompositeIds()??[]}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.layoutService.isVisible(this.partId)&&this.layoutService.setPartHidden(!0,this.partId),this.hideActiveComposite()}focusCompositeBar(){this.paneCompositeBar.value?.focus()}layout(e,i,n,o){this.layoutService.isVisible(this.partId)&&(this.contentDimension=new dt(e,i),super.layout(this.contentDimension.width,this.contentDimension.height,n,o),this.layoutCompositeBar(),this.layoutEmptyMessage())}layoutCompositeBar(){if(this.contentDimension&&this.dimension&&this.paneCompositeBar.value){let e=this.compositeBarPosition===1?16:8,i=this.partId==="workbench.parts.panel"?0:1,n=this.contentDimension.width-e-i;n=Math.max(Bl.MIN_COMPOSITE_BAR_WIDTH,n-this.getToolbarWidth()),this.paneCompositeBar.value.layout(n,this.dimension.height)}}layoutEmptyMessage(){let e=!this.getActiveComposite();this.emptyPaneMessageElement?.classList.toggle("visible",e),e&&this.titleLabel?.updateTitle("","")}updateGlobalToolbarActions(){let e=this.globalActions.getPrimaryActions(),i=this.globalActions.getSecondaryActions();this.globalToolBar?.setActions(Or(e),Or(i))}getToolbarWidth(){if(!this.toolBar||this.compositeBarPosition!==1||!this.getActivePaneComposite())return 0;let i=this.toolBar.getItemsWidth()+this.toolBar.getItemsLength()*4,n=this.globalToolBar?this.globalToolBar.getItemsWidth()+this.globalToolBar.getItemsLength()*4:0;return i+n+5}onTitleAreaContextMenu(e){if(this.shouldShowCompositeBar()&&this.getCompositeBarPosition()===1)return this.onCompositeBarContextMenu(e);{let i=this.getActivePaneComposite(),n=i?i.getContextMenuActions():[];n.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>n,getActionViewItem:(o,s)=>this.actionViewItemProvider(o,s),actionRunner:i.getActionRunner(),skipTelemetry:!0})}}onCompositeBarAreaContextMenu(e){return this.onCompositeBarContextMenu(e)}onCompositeBarContextMenu(e){if(this.paneCompositeBar.value){let i=[...this.paneCompositeBar.value.getContextMenuActions()];i.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>i,skipTelemetry:!0})}}getViewsSubmenuAction(){let e=this.getActivePaneComposite()?.getViewPaneContainer();if(e){let i=new W,n=[],o=i.add(this.contextKeyService.createScoped(this.element));o.createKey("viewContainer",e.viewContainer.id);let s=this.menuService.getMenuActions(KT,o,{shouldForwardArgs:!0,renderShortTitle:!0});return qa(s,{primary:n,secondary:[]},()=>!0),i.dispose(),n.length>1&&n.some(a=>a.enabled)?new mn("views",h("views","Views"),n):void 0}}};Bl=_([v(8,jt),v(9,tt),v(10,Mt),v(11,Qe),v(12,at),v(13,qi),v(14,ae),v(15,Ze),v(16,zi),v(17,ke),v(18,xn),v(19,Ri)],Bl);var KJ=$("updateService");var $I=re;var P0=class r extends L{constructor(e,i,n){super();this.container=e;this.options=i;this.menuStyle=n;this.container.setAttribute("role","menubar"),this.isCompact&&this.container.classList.add("compact"),this.menus=[],this.mnemonics=new Map,this._focusState=1,this._onVisibilityChange=this._register(new T),this._onFocusStateChange=this._register(new T),this.createOverflowMenu(),this.menuUpdater=this._register(new Et(()=>this.update(),200)),this.actionRunner=this.options.actionRunner??this._register(new wn),this._register(this.actionRunner.onWillRun(()=>{this.setUnfocusedState()})),this._register(pd.getInstance().event(this.onModifierKeyToggled,this)),this._register(M(this.container,G.KEY_DOWN,s=>{let a=new st(s),l=!0,d=s.key?s.key.toLocaleLowerCase():"",c=be&&!this.isCompact;if(a.equals(15)||c&&a.equals(1026))this.focusPrevious();else if(a.equals(17)||c&&a.equals(2))this.focusNext();else if(a.equals(9)&&this.isFocused&&!this.isOpen)this.setUnfocusedState();else if(!this.isOpen&&!a.ctrlKey&&this.options.enableMnemonics&&this.mnemonicsInUse&&this.mnemonics.has(d)){let u=this.mnemonics.get(d);this.onMenuTriggered(u,!1)}else l=!1;!this.isCompact&&(a.equals(1026)||a.equals(2))&&a.preventDefault(),l&&(a.preventDefault(),a.stopPropagation())}));let o=oe(this.container);this._register(M(o,G.MOUSE_DOWN,()=>{this.isFocused&&this.setUnfocusedState()})),this._register(M(this.container,G.FOCUS_IN,s=>{let a=s;a.relatedTarget&&(this.container.contains(a.relatedTarget)||(this.focusToReturn=a.relatedTarget))})),this._register(M(this.container,G.FOCUS_OUT,s=>{let a=s;a.relatedTarget?a.relatedTarget&&!this.container.contains(a.relatedTarget)&&(this.focusToReturn=void 0,this.setUnfocusedState()):this.setUnfocusedState()})),this._register(M(o,G.KEY_DOWN,s=>{if(!this.options.enableMnemonics||!s.altKey||s.ctrlKey||s.defaultPrevented)return;let a=s.key.toLocaleLowerCase();if(!this.mnemonics.has(a))return;this.mnemonicsInUse=!0,this.updateMnemonicVisibility(!0);let l=this.mnemonics.get(a);this.onMenuTriggered(l,!1)})),this.setUnfocusedState()}static OVERFLOW_INDEX=-1;menus;overflowMenu;focusedMenu;focusToReturn;menuUpdater;_mnemonicsInUse=!1;openedViaKeyboard=!1;awaitingAltRelease=!1;ignoreNextMouseUp=!1;mnemonics;updatePending=!1;_focusState;actionRunner;_onVisibilityChange;_onFocusStateChange;numMenusShown=0;overflowLayoutScheduled=void 0;menuDisposables=this._register(new W);push(e){v7(e).forEach(n=>{let o=this.menus.length,s=dP(n.label),a=Xy.exec(n.label);if(a){let l=a[1]?a[1]:a[3];this.registerMnemonic(this.menus.length,l)}if(this.isCompact)this.menus.push(n);else{let l=$I("div.menubar-menu-button",{role:"menuitem",tabindex:-1,"aria-label":s,"aria-haspopup":!0}),d=$I("div.menubar-menu-title",{role:"none","aria-hidden":!0});l.appendChild(d),this.container.insertBefore(l,this.overflowMenu.buttonElement),this.updateLabels(d,l,n.label),this._register(M(l,G.KEY_UP,c=>{let u=new st(c),p=!0;(u.equals(18)||u.equals(3))&&!this.isOpen?(this.focusedMenu={index:o},this.openedViaKeyboard=!0,this.focusState=3):p=!1,p&&(u.preventDefault(),u.stopPropagation())})),this._register(Wt.addTarget(l)),this._register(M(l,it.Tap,c=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&Xi(c.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(o,!0),c.preventDefault(),c.stopPropagation())})),this._register(M(l,G.MOUSE_DOWN,c=>{if(!new ri(oe(l),c).leftButton){c.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(o,!0)),c.preventDefault(),c.stopPropagation()})),this._register(M(l,G.MOUSE_UP,c=>{c.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(o,!0))})),this._register(M(l,G.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(o)?(l.focus(),this.cleanupCustomMenu(),this.showCustomMenu(o,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:o},l.focus())})),this.menus.push({label:n.label,actions:n.actions,buttonElement:l,titleElement:d})}})}createOverflowMenu(){let e=this.isCompact?h("mAppMenu","Application Menu"):h("mMore","More"),i=$I("div.menubar-menu-button",{role:"menuitem",tabindex:this.isCompact?0:-1,"aria-label":e,"aria-haspopup":!0}),n=$I("div.menubar-menu-title.toolbar-toggle-more"+ye.asCSSSelector(B.menuBarMore),{role:"none","aria-hidden":!0});i.appendChild(n),this.container.appendChild(i),i.style.visibility="hidden",this._register(M(i,G.KEY_UP,o=>{let s=new st(o),a=!0,l=[3];this.isCompact?(l.push(10),this.options.compactMode?.horizontal===0?l.push(17):this.options.compactMode?.horizontal===1&&l.push(15)):l.push(18),l.some(d=>s.equals(d))&&!this.isOpen?(this.focusedMenu={index:r.OVERFLOW_INDEX},this.openedViaKeyboard=!0,this.focusState=3):a=!1,a&&(s.preventDefault(),s.stopPropagation())})),this._register(Wt.addTarget(i)),this._register(M(i,it.Tap,o=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&Xi(o.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(r.OVERFLOW_INDEX,!0),o.preventDefault(),o.stopPropagation())})),this._register(M(i,G.MOUSE_DOWN,o=>{if(!new ri(oe(i),o).leftButton){o.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(r.OVERFLOW_INDEX,!0)),o.preventDefault(),o.stopPropagation()})),this._register(M(i,G.MOUSE_UP,o=>{o.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(r.OVERFLOW_INDEX,!0))})),this._register(M(i,G.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(r.OVERFLOW_INDEX)?(this.overflowMenu.buttonElement.focus(),this.cleanupCustomMenu(),this.showCustomMenu(r.OVERFLOW_INDEX,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:r.OVERFLOW_INDEX},i.focus())})),this.overflowMenu={buttonElement:i,titleElement:n,label:"More",actions:[]}}updateMenu(e){let i=this.menus.filter(n=>n.label===e.label);i&&i.length&&(i[0].actions=e.actions)}dispose(){super.dispose(),this.menus.forEach(e=>{e.titleElement?.remove(),e.buttonElement?.remove()}),this.overflowMenu.titleElement.remove(),this.overflowMenu.buttonElement.remove(),nt(this.overflowLayoutScheduled),this.overflowLayoutScheduled=void 0}blur(){this.setUnfocusedState()}getWidth(){if(!this.isCompact&&this.menus){let e=this.menus[0].buttonElement.getBoundingClientRect().left;return(this.hasOverflow?this.overflowMenu.buttonElement.getBoundingClientRect().right:this.menus[this.menus.length-1].buttonElement.getBoundingClientRect().right)-e}return 0}getHeight(){return this.container.clientHeight}toggleFocus(){!this.isFocused&&this.options.visibility!=="hidden"?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:r.OVERFLOW_INDEX},this.focusState=2):this.isOpen||this.setUnfocusedState()}updateOverflowAction(){if(!this.menus||!this.menus.length)return;let e="overflow-menu-only";this.container.classList.toggle(e,!1);let i=this.container.offsetWidth,n=0,o=this.isCompact,s=this.numMenusShown;this.numMenusShown=0;let a=this.menus.filter(l=>l.buttonElement!==void 0&&l.titleElement!==void 0);for(let l of a){if(!o){let d=l.buttonElement.offsetWidth;n+d>i?o=!0:(n+=d,this.numMenusShown++,this.numMenusShown>s&&(l.buttonElement.style.visibility="visible"))}o&&(l.buttonElement.style.visibility="hidden")}if(this.numMenusShown-1<=a.length/4){for(let l of a)l.buttonElement.style.visibility="hidden";o=!0,this.numMenusShown=0,n=0}if(this.isCompact){this.overflowMenu.actions=[];for(let d=this.numMenusShown;d<this.menus.length;d++)this.overflowMenu.actions.push(new mn(`menubar.submenu.${this.menus[d].label}`,this.menus[d].label,this.menus[d].actions||[]));let l=this.options.getCompactMenuActions?.();l&&l.length&&(this.overflowMenu.actions.push(new pt),this.overflowMenu.actions.push(...l)),this.overflowMenu.buttonElement.style.visibility="visible"}else if(o){for(;n+this.overflowMenu.buttonElement.offsetWidth>i&&this.numMenusShown>0;){this.numMenusShown--;let l=a[this.numMenusShown].buttonElement.offsetWidth;a[this.numMenusShown].buttonElement.style.visibility="hidden",n-=l}this.overflowMenu.actions=[];for(let l=this.numMenusShown;l<a.length;l++)this.overflowMenu.actions.push(new mn(`menubar.submenu.${a[l].label}`,a[l].label,a[l].actions||[]));this.overflowMenu.buttonElement.nextElementSibling!==a[this.numMenusShown].buttonElement&&(this.overflowMenu.buttonElement.remove(),this.container.insertBefore(this.overflowMenu.buttonElement,a[this.numMenusShown].buttonElement)),this.overflowMenu.buttonElement.style.visibility="visible"}else this.overflowMenu.buttonElement.remove(),this.container.appendChild(this.overflowMenu.buttonElement),this.overflowMenu.buttonElement.style.visibility="hidden";this.container.classList.toggle(e,this.numMenusShown===0)}updateLabels(e,i,n){let o=dP(n);if(this.options.enableMnemonics){let a=Ku(n);wf.lastIndex=0;let l=wf.exec(a);for(;l&&l[1];)l=wf.exec(a);let d=c=>c.replace(/&amp;&amp;/g,"&amp;");l?(e.innerText="",e.append(vh(d(a.substr(0,l.index))," "),$I("mnemonic",{"aria-hidden":"true"},l[3]),Gu(d(a.substr(l.index+l[0].length))," "))):e.innerText=d(a).trim()}else e.innerText=o.replace(/&&/g,"&");let s=Xy.exec(n);if(s){let a=s[1]?s[1]:s[3];this.options.enableMnemonics?i.setAttribute("aria-keyshortcuts","Alt+"+a.toLocaleLowerCase()):i.removeAttribute("aria-keyshortcuts")}}update(e){if(e&&(this.options=e),this.isFocused){this.updatePending=!0;return}this.menus.forEach(i=>{!i.buttonElement||!i.titleElement||this.updateLabels(i.titleElement,i.buttonElement,i.label)}),this.overflowLayoutScheduled||(this.overflowLayoutScheduled=nn(oe(this.container),()=>{this.updateOverflowAction(),this.overflowLayoutScheduled=void 0})),this.setUnfocusedState()}registerMnemonic(e,i){this.mnemonics.set(i.toLocaleLowerCase(),e)}hideMenubar(){this.container.style.display!=="none"&&(this.container.style.display="none",this._onVisibilityChange.fire(!1))}showMenubar(){this.container.style.display!=="flex"&&(this.container.style.display="flex",this._onVisibilityChange.fire(!0),this.updateOverflowAction())}get focusState(){return this._focusState}set focusState(e){if(this._focusState>=2&&e<2&&this.updatePending&&(this.menuUpdater.schedule(),this.updatePending=!1),e===this._focusState)return;let i=this.isVisible,n=this.isOpen,o=this.isFocused;switch(this._focusState=e,e){case 0:i&&this.hideMenubar(),n&&this.cleanupCustomMenu(),o&&(this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case 1:i||this.showMenubar(),n&&this.cleanupCustomMenu(),o&&(this.focusedMenu&&(this.focusedMenu.index===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.blur():this.menus[this.focusedMenu.index].buttonElement?.blur()),this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case 2:i||this.showMenubar(),n&&this.cleanupCustomMenu(),this.focusedMenu&&(this.focusedMenu.index===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[this.focusedMenu.index].buttonElement?.focus());break;case 3:i||this.showMenubar(),this.focusedMenu&&(this.cleanupCustomMenu(),this.showCustomMenu(this.focusedMenu.index,this.openedViaKeyboard));break}this._focusState=e,this._onFocusStateChange.fire(this.focusState>=2)}get isVisible(){return this.focusState>=1}get isFocused(){return this.focusState>=2}get isOpen(){return this.focusState>=3}get hasOverflow(){return this.isCompact||this.numMenusShown<this.menus.length}get isCompact(){return this.options.compactMode!==void 0}setUnfocusedState(){this.options.visibility==="toggle"||this.options.visibility==="hidden"?this.focusState=0:this.options.visibility==="classic"&&ld(ne)?this.focusState=0:this.focusState=1,this.ignoreNextMouseUp=!1,this.mnemonicsInUse=!1,this.updateMnemonicVisibility(!1)}focusPrevious(){if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index-1+this.numMenusShown)%this.numMenusShown;this.focusedMenu.index===r.OVERFLOW_INDEX?e=this.numMenusShown-1:this.focusedMenu.index===0&&this.hasOverflow&&(e=r.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[e].buttonElement?.focus()))}focusNext(){if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index+1)%this.numMenusShown;this.focusedMenu.index===r.OVERFLOW_INDEX?e=0:this.focusedMenu.index===this.numMenusShown-1&&(e=r.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[e].buttonElement?.focus()))}updateMnemonicVisibility(e){this.menus&&this.menus.forEach(i=>{if(i.titleElement&&i.titleElement.children.length){let n=i.titleElement.children.item(0);n&&(n.style.textDecoration=this.options.alwaysOnMnemonics||e?"underline":"")}})}get mnemonicsInUse(){return this._mnemonicsInUse}set mnemonicsInUse(e){this._mnemonicsInUse=e}get shouldAltKeyFocus(){return be?!1:!this.options.disableAltFocus||this.options.visibility==="toggle"}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}onMenuTriggered(e,i){this.isOpen?this.isCurrentMenu(e)?this.setUnfocusedState():(this.cleanupCustomMenu(),this.showCustomMenu(e,this.openedViaKeyboard)):(this.focusedMenu={index:e},this.openedViaKeyboard=!i,this.focusState=3)}onModifierKeyToggled(e){let i=!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey;this.options.visibility!=="hidden"&&(e.event&&this.shouldAltKeyFocus&&Uw.toEnum(e.event.code)===159&&e.event.preventDefault(),this.isFocused&&e.lastKeyPressed==="alt"&&e.altKey&&(this.setUnfocusedState(),this.mnemonicsInUse=!1,this.awaitingAltRelease=!0),i&&e.lastKeyPressed==="alt"&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease||(!this.isFocused&&this.shouldAltKeyFocus?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:r.OVERFLOW_INDEX},this.focusState=2):this.isOpen||this.setUnfocusedState())),!e.altKey&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease=!1),this.options.enableMnemonics&&this.menus&&!this.isOpen&&this.updateMnemonicVisibility(!this.awaitingAltRelease&&e.altKey||this.mnemonicsInUse))}isCurrentMenu(e){return this.focusedMenu?this.focusedMenu.index===e:!1}cleanupCustomMenu(){this.focusedMenu&&(this.focusedMenu.index===r.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():this.menus[this.focusedMenu.index].buttonElement?.focus(),this.focusedMenu.holder&&(this.focusedMenu.holder.parentElement?.classList.remove("open"),this.focusedMenu.holder.remove()),this.focusedMenu.widget?.dispose(),this.focusedMenu={index:this.focusedMenu.index}),this.menuDisposables.clear()}showCustomMenu(e,i=!0){let n=e>=this.numMenusShown?r.OVERFLOW_INDEX:e,o=n===r.OVERFLOW_INDEX?this.overflowMenu:this.menus[n];if(!o.actions||!o.buttonElement||!o.titleElement)return;let s=$I("div.menubar-menu-items-holder",{title:""});o.buttonElement.classList.add("open");let a=o.titleElement.getBoundingClientRect(),l=aW(o.titleElement);if(this.options.compactMode?.horizontal===0)s.style.left=`${a.left+this.container.clientWidth}px`;else if(this.options.compactMode?.horizontal===1){let u=oe(this.container).innerWidth;s.style.right=`${u-a.left}px`,s.style.left="auto"}else s.style.left=`${a.left*l}px`;this.options.compactMode?.vertical===0?s.style.top=`${a.top-this.menus.length*30+this.container.clientHeight}px`:this.options.compactMode?.vertical===1?s.style.top=`${a.top}px`:s.style.top=`${a.bottom*l}px`,o.buttonElement.appendChild(s);let d={getKeyBinding:this.options.getKeybinding,actionRunner:this.actionRunner,enableMnemonics:this.options.alwaysOnMnemonics||this.mnemonicsInUse&&this.options.enableMnemonics,ariaLabel:o.buttonElement.getAttribute("aria-label")??void 0,expandDirection:this.isCompact?this.options.compactMode:{horizontal:0,vertical:1},useEventAsContext:!0},c=this.menuDisposables.add(new uT(s,o.actions,d,this.menuStyle));this.menuDisposables.add(c.onDidCancel(()=>{this.focusState=2})),n!==e?c.trigger(e-this.numMenusShown):c.focus(i),this.focusedMenu={index:n,holder:s,widget:c}}};var hue=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function Bm(r,t,e,i,n){if(ye.isThemeIcon(n))return[`codicon-${n.id}`,"predefined-file-icon"];if(q.isUri(n))return[];let o=i===2?["rootfolder-icon"]:i===1?["folder-icon"]:["file-icon"];if(e){let s;if(e.scheme===he.data)s=iv.parseMetaData(e).get(iv.META_DATA_LABEL);else{let a=e.path.match(hue);a?(s=M0(a[2].toLowerCase()),a[1]&&o.push(`${M0(a[1].toLowerCase())}-name-dir-icon`)):s=M0(e.authority.toLowerCase())}if(i===2)o.push(`${s}-root-name-folder-icon`);else if(i===1)o.push(`${s}-name-folder-icon`);else{if(s){if(o.push(`${s}-name-file-icon`),o.push("name-file-icon"),s.length<=255){let l=s.split(".");for(let d=1;d<l.length;d++)o.push(`${l.slice(d).join(".")}-ext-file-icon`)}o.push("ext-file-icon")}let a=mue(r,t,e);a&&o.push(`${M0(a)}-lang-file-icon`)}}return o}function mue(r,t,e){if(!e)return null;let i=null;if(e.scheme===he.data){let o=iv.parseMetaData(e).get(iv.META_DATA_MIME);o&&(i=t.getLanguageIdByMimeType(o))}else{let n=r.getModel(e);n&&(i=n.getLanguageId())}return i&&i!==Cd?i:t.guessLanguageIdByFilepathOrFirstLine(e)}function M0(r){return r.replace(/[\s]/g,"/")}var GJ="inQuickOpen",ppi=new ie(GJ,!1,h("inQuickOpen","Whether keyboard focus is inside the quick open control")),F4=X.has(GJ),gue="inFilesPicker",hpi=X.and(F4,X.has(gue));function B4(r,t){return e=>{let i=e.get(at),n=e.get($o),s={keybindings:i.lookupKeybindings(r)};n.navigate(!!t,s)}}var O0=class extends L{constructor(e,i){super();this.editorService=e;this.editorGroupsService=i}_editorViewState=void 0;openedTransientEditors=new Set;set(){if(this._editorViewState)return;let e=this.editorService.activeEditorPane;e&&(this._editorViewState={group:e.group,editor:e.input,state:LJ(e.getControl())?.saveViewState()??void 0})}async openTransientEditor(e,i){e.options={...e.options,transient:!0};let n=await this.editorService.openEditor(e,i);return n?.input&&n.input!==this._editorViewState?.editor&&n.group.isTransient(n.input)&&this.openedTransientEditors.add(n.input),n}async restore(){if(this._editorViewState){for(let e of this.openedTransientEditors)if(!e.isDirty())for(let i of this.editorGroupsService.groups)i.isTransient(e)&&await i.closeEditor(e,{preserveFocus:!0});await this._editorViewState.group.openEditor(this._editorViewState.editor,{viewState:this._editorViewState.state,preserveFocus:!0}),this.reset()}}reset(){this._editorViewState=void 0,this.openedTransientEditors.clear()}dispose(){super.dispose(),this.reset()}};O0=_([v(0,kt),v(1,di)],O0);var YJ="inRecentFilesPicker",N0=class extends We{removeFromRecentlyOpened={iconClass:ye.asClassName(B.removeClose),tooltip:h("remove","Remove from Recently Opened")};dirtyRecentlyOpenedFolder={iconClass:"dirty-workspace "+ye.asClassName(B.closeDirty),tooltip:h("dirtyRecentlyOpenedFolder","Folder With Unsaved Files"),alwaysVisible:!0};dirtyRecentlyOpenedWorkspace={...this.dirtyRecentlyOpenedFolder,tooltip:h("dirtyRecentlyOpenedWorkspace","Workspace With Unsaved Files")};constructor(t){super(t)}async run(t){let e=t.get(Of),i=t.get($o),n=t.get(Xt),o=t.get(qo),s=t.get(at),a=t.get(Rr),l=t.get(Hn),d=t.get(en),c=t.get(Ar),u=await e.getRecentlyOpened(),p=await e.getDirtyWorkspaces(),m=!1,g=new Ci,f=new Ci;for(let z of p)C5(z)?g.set(z.folderUri,!0):(f.set(z.workspace.configPath,z.workspace),m=!0);let b=new Ci,y=new Ci;for(let z of u.workspaces)vI(z)?b.set(z.folderUri,!0):(y.set(z.workspace.configPath,z.workspace),m=!0);let I=[];for(let z of u.workspaces){let Z=vI(z)?g.has(z.folderUri):f.has(z.workspace.configPath);I.push(this.toQuickPick(a,l,o,z,Z))}for(let z of p)C5(z)&&!b.has(z.folderUri)?I.push(this.toQuickPick(a,l,o,z,!0)):ZQ(z)&&!y.has(z.workspace.configPath)&&I.push(this.toQuickPick(a,l,o,z,!0));let E=u.files.map(z=>this.toQuickPick(a,l,o,z,!1)),S=u.workspaces[0],w=S&&n.isCurrentWorkspace(NT(S)?S.workspace:S.folderUri),D,k={type:"separator",label:m?h("workspacesAndFolders","folders & workspaces"):h("folders","folders")},R={type:"separator",label:h("files","files")},A=[k,...I,R,...E],H=await i.pick(A,{contextKey:YJ,activeItem:[...I,...E][w?1:0],placeHolder:be?h("openRecentPlaceholderMac","Select to open (hold Cmd-key to force new window or Option-key for same window)"):h("openRecentPlaceholder","Select to open (hold Ctrl-key to force new window or Alt-key for same window)"),matchOnDescription:!0,onKeyMods:z=>D=z,quickNavigate:this.isQuickNavigate()?{keybindings:s.lookupKeybindings(this.desc.id)}:void 0,hideInput:this.isQuickNavigate(),onDidTriggerItemButton:async z=>{if(z.button===this.removeFromRecentlyOpened)await e.removeRecentlyOpened([z.item.resource]),z.removeItem();else if(z.button===this.dirtyRecentlyOpenedFolder||z.button===this.dirtyRecentlyOpenedWorkspace){let Z=z.button===this.dirtyRecentlyOpenedWorkspace,{confirmed:fe}=await c.confirm({title:Z?h("dirtyWorkspace","Workspace with Unsaved Files"):h("dirtyFolder","Folder with Unsaved Files"),message:Z?h("dirtyWorkspaceConfirm","Do you want to open the workspace to review the unsaved files?"):h("dirtyFolderConfirm","Do you want to open the folder to review the unsaved files?"),detail:Z?h("dirtyWorkspaceConfirmDetail","Workspaces with unsaved files cannot be removed until all unsaved files have been saved or reverted."):h("dirtyFolderConfirmDetail","Folders with unsaved files cannot be removed until all unsaved files have been saved or reverted.")});fe&&(d.openWindow([z.item.openable],{remoteAuthority:z.item.remoteAuthority||null}),i.cancel())}}});if(H)return d.openWindow([H.openable],{forceNewWindow:D?.ctrlCmd,forceReuseWindow:D?.alt,remoteAuthority:H.remoteAuthority||null})}toQuickPick(t,e,i,n,o){let s,a,l,d,c=!1;vI(n)?(d=n.folderUri,a=Bm(t,e,d,1),s={folderUri:d},l=n.label||i.getWorkspaceLabel(d,{verbose:2})):NT(n)?(d=n.workspace.configPath,a=Bm(t,e,d,2),s={workspaceUri:d},l=n.label||i.getWorkspaceLabel(n.workspace,{verbose:2}),c=!0):(d=n.fileUri,a=Bm(t,e,d,0),s={fileUri:d},l=n.label||i.getUriLabel(d));let{name:u,parentPath:p}=dZ(l);return{iconClasses:a,label:u,ariaLabel:o?c?h("recentDirtyWorkspaceAriaLabel","{0}, workspace with unsaved changes",u):h("recentDirtyFolderAriaLabel","{0}, folder with unsaved changes",u):u,description:p,buttons:o?[c?this.dirtyRecentlyOpenedWorkspace:this.dirtyRecentlyOpenedFolder]:[this.removeFromRecentlyOpened],openable:s,resource:d,remoteAuthority:n.remoteAuthority}}},cx=class r extends N0{static ID="workbench.action.openRecent";constructor(){super({id:r.ID,title:{...pe("openRecent","Open Recent..."),mnemonicTitle:h({key:"miMore",comment:["&& denotes a mnemonic"]},"&&More...")},category:gt.File,f1:!0,keybinding:{weight:200,primary:2096,mac:{primary:304}},menu:{id:ee.MenubarRecentMenu,group:"y_more",order:1}})}isQuickNavigate(){return!1}},V4=class extends N0{constructor(){super({id:"workbench.action.quickOpenRecent",title:pe("quickOpenRecent","Quick Open Recent..."),category:gt.File,f1:!1})}isQuickNavigate(){return!0}},W4=class extends We{constructor(){super({id:"workbench.action.toggleFullScreen",title:{...pe("toggleFullScreen","Toggle Full Screen"),mnemonicTitle:h({key:"miToggleFullScreen",comment:["&& denotes a mnemonic"]},"&&Full Screen")},category:gt.View,f1:!0,keybinding:{weight:200,primary:69,mac:{primary:2340}},precondition:aP.toNegated(),toggled:Ga,menu:[{id:ee.MenubarAppearanceMenu,group:"1_toggle_view",order:1}]})}run(t){return t.get(en).toggleFullScreen(uo())}},U4=class r extends We{static ID="workbench.action.reloadWindow";constructor(){super({id:r.ID,title:pe("reloadWindow","Reload Window"),category:gt.Developer,f1:!0,keybinding:{weight:250,when:dT,primary:2096}})}async run(t){return t.get(en).reload()}},H4=class extends We{constructor(){super({id:"workbench.action.showAboutDialog",title:{...pe("about","About"),mnemonicTitle:h({key:"miAbout",comment:["&& denotes a mnemonic"]},"&&About")},category:gt.Help,f1:!0,menu:{id:ee.MenubarHelpMenu,group:"z_about",order:1,when:eu.toNegated()}})}run(t){return t.get(Ar).about()}},z4=class extends We{constructor(){super({id:"workbench.action.newWindow",title:{...pe("newWindow","New Window"),mnemonicTitle:h({key:"miNewWindow",comment:["&& denotes a mnemonic"]},"New &&Window")},f1:!0,keybinding:{weight:200,primary:wt?rt?Kr(2089,1068):3628:3116,secondary:wt?[3116]:void 0},menu:{id:ee.MenubarFileMenu,group:"1_new",order:3}})}run(t){return t.get(en).openWindow({remoteAuthority:null})}},K4=class extends We{constructor(){super({id:"workbench.action.blur",title:pe("blur","Remove keyboard focus from focused element")})}run(){let t=An();Oi(t)&&t.blur()}};Me(z4);Me(W4);Me(V4);Me(cx);Me(U4);Me(H4);Me(K4);var ZJ=X.and(F4,X.has(YJ)),qJ="workbench.action.quickOpenNavigateNextInRecentFilesPicker";Zt.registerCommandAndKeybindingRule({id:qJ,weight:250,handler:B4(qJ,!0),when:ZJ,primary:2096,mac:{primary:304}});var jJ="workbench.action.quickOpenNavigatePreviousInRecentFilesPicker";Zt.registerCommandAndKeybindingRule({id:jJ,weight:250,handler:B4(jJ,!1),when:ZJ,primary:3120,mac:{primary:1328}});En.registerCommand("workbench.action.toggleConfirmBeforeClose",r=>{let t=r.get(de),e=t.inspect("window.confirmBeforeClose").userValue;return t.updateValue("window.confirmBeforeClose",e==="never"?"keyboardOnly":"never")});Ct.appendMenuItem(ee.MenubarFileMenu,{group:"z_ConfirmClose",command:{id:"workbench.action.toggleConfirmBeforeClose",title:h("miConfirmClose","Confirm Before Close"),toggled:X.notEquals("config.window.confirmBeforeClose","never")},order:1,when:Zy});Ct.appendMenuItem(ee.MenubarFileMenu,{title:h({key:"miOpenRecent",comment:["&& denotes a mnemonic"]},"Open &&Recent"),submenu:ee.MenubarRecentMenu,group:"2_open",order:4});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarFileMenu,title:{value:"File",original:"File",mnemonicTitle:h({key:"mFile",comment:["&& denotes a mnemonic"]},"&&File")},order:1});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarEditMenu,title:{value:"Edit",original:"Edit",mnemonicTitle:h({key:"mEdit",comment:["&& denotes a mnemonic"]},"&&Edit")},order:2});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarSelectionMenu,title:{value:"Selection",original:"Selection",mnemonicTitle:h({key:"mSelection",comment:["&& denotes a mnemonic"]},"&&Selection")},order:3});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarViewMenu,title:{value:"View",original:"View",mnemonicTitle:h({key:"mView",comment:["&& denotes a mnemonic"]},"&&View")},order:4});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarGoMenu,title:{value:"Go",original:"Go",mnemonicTitle:h({key:"mGoto",comment:["&& denotes a mnemonic"]},"&&Go")},order:5});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarTerminalMenu,title:{value:"Terminal",original:"Terminal",mnemonicTitle:h({key:"mTerminal",comment:["&& denotes a mnemonic"]},"&&Terminal")},order:7});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarHelpMenu,title:{value:"Help",original:"Help",mnemonicTitle:h({key:"mHelp",comment:["&& denotes a mnemonic"]},"&&Help")},order:8});Ct.appendMenuItem(ee.MenubarMainMenu,{submenu:ee.MenubarPreferencesMenu,title:{value:"Preferences",original:"Preferences",mnemonicTitle:h({key:"mPreferences",comment:["&& denotes a mnemonic"]},"Preferences")},when:eu,order:9});var G4=class r extends L{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f){super();this.menuService=e;this.workspacesService=i;this.contextKeyService=n;this.keybindingService=o;this.configurationService=s;this.labelService=a;this.updateService=l;this.storageService=d;this.notificationService=c;this.preferencesService=u;this.environmentService=p;this.accessibilityService=m;this.hostService=g;this.commandService=f;this.mainMenu=this._register(this.menuService.createMenu(ee.MenubarMainMenu,this.contextKeyService)),this.mainMenuDisposables=this._register(new W),this.setupMainMenu(),this.menuUpdater=this._register(new Et(()=>this.doUpdateMenubar(!1),200)),this.notifyUserOfCustomMenubarAccessibility()}keys=["window.menuBarVisibility","window.enableMenuBarMnemonics","window.customMenuBarAltFocus","workbench.sideBar.location","window.nativeTabs"];mainMenu;menus={};topLevelTitles={};mainMenuDisposables;recentlyOpened={files:[],workspaces:[]};menuUpdater;static MAX_MENU_RECENT_ENTRIES=10;registerListeners(){this._register(this.hostService.onDidChangeFocus(e=>this.onDidChangeWindowFocus(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.updateService.onStateChange(()=>this.onUpdateStateChange())),this._register(this.workspacesService.onDidChangeRecentlyOpened(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.keybindingService.onDidUpdateKeybindings(()=>this.updateMenubar())),this._register(this.labelService.onDidChangeFormatters(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.mainMenu.onDidChange(()=>{this.setupMainMenu(),this.doUpdateMenubar(!0)}))}setupMainMenu(){this.mainMenuDisposables.clear(),this.menus={},this.topLevelTitles={};let[,e]=this.mainMenu.getActions()[0];for(let i of e)i instanceof jn&&typeof i.item.title!="string"&&(this.menus[i.item.title.original]=this.mainMenuDisposables.add(this.menuService.createMenu(i.item.submenu,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.topLevelTitles[i.item.title.original]=i.item.title.mnemonicTitle??i.item.title.value)}updateMenubar(){this.menuUpdater.schedule()}calculateActionLabel(e){let i=e.label;switch(e.id){default:break}return i}onUpdateStateChange(){this.updateMenubar()}onUpdateKeybindings(){this.updateMenubar()}getOpenRecentActions(){if(!this.recentlyOpened)return[];let{workspaces:e,files:i}=this.recentlyOpened,n=[];if(e.length>0){for(let o=0;o<r.MAX_MENU_RECENT_ENTRIES&&o<e.length;o++)n.push(this.createOpenRecentMenuAction(e[o]));n.push(new pt)}if(i.length>0){for(let o=0;o<r.MAX_MENU_RECENT_ENTRIES&&o<i.length;o++)n.push(this.createOpenRecentMenuAction(i[o]));n.push(new pt)}return n}onDidChangeWindowFocus(e){e&&this.onDidChangeRecentlyOpened()}onConfigurationUpdated(e){this.keys.some(i=>e.affectsConfiguration(i))&&this.updateMenubar(),e.affectsConfiguration("editor.accessibilitySupport")&&this.notifyUserOfCustomMenubarAccessibility(),e.affectsConfiguration("window.menuBarVisibility")&&this.onDidChangeRecentlyOpened()}get menubarHidden(){return be&&Pi?!1:na(this.configurationService)==="hidden"}onDidChangeRecentlyOpened(){this.menubarHidden||this.workspacesService.getRecentlyOpened().then(e=>{this.recentlyOpened=e,this.updateMenubar()})}createOpenRecentMenuAction(e){let i,n,o,s,a=e.remoteAuthority;vI(e)?(n=e.folderUri,i=e.label||this.labelService.getWorkspaceLabel(n,{verbose:2}),o="openRecentFolder",s={folderUri:n}):NT(e)?(n=e.workspace.configPath,i=e.label||this.labelService.getWorkspaceLabel(e.workspace,{verbose:2}),o="openRecentWorkspace",s={workspaceUri:n}):(n=e.fileUri,i=e.label||this.labelService.getUriLabel(n),o="openRecentFile",s={fileUri:n});let l=Ht({id:o,label:lZ(i),run:d=>{let c=d&&(!be&&(d.ctrlKey||d.shiftKey)||be&&(d.metaKey||d.altKey));return this.hostService.openWindow([s],{forceNewWindow:!!c,remoteAuthority:a||null})}});return Object.assign(l,{uri:n,remoteAuthority:a})}notifyUserOfCustomMenubarAccessibility(){if(wt||be)return;let e=this.storageService.getBoolean("menubar/accessibleMenubarNotified",-1,!1),i=!Dr(this.configurationService);if(e||i||!this.accessibilityService.isScreenReaderOptimized())return;let n=h("menubar.customTitlebarAccessibilityNotification","Accessibility support is enabled for you. For the most accessible experience, we recommend the custom title bar style.");this.notificationService.prompt(ui.Info,n,[{label:h("goToSetting","Open Settings"),run:()=>this.preferencesService.openUserSettings({query:"window.titleBarStyle"})}]),this.storageService.store("menubar/accessibleMenubarNotified",!0,-1,0)}},F0;function fue(){return F0||(F0=new T,Me(class extends We{constructor(){super({id:"workbench.actions.menubar.focus",title:pe("focusMenu","Focus Application Menu"),keybinding:{primary:580,weight:200,when:Zy},f1:!0})}async run(){F0?.fire()}})),F0}var Vm=class extends G4{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b){super(e,i,n,o,s,a,l,d,c,u,p,m,f,b);this.telemetryService=g;this._onVisibilityChange=this._register(new T),this._onFocusStateChange=this._register(new T),this.actionRunner=this._register(new wn),this.actionRunner.onDidRun(y=>{this.telemetryService.publicLog2("workbenchActionExecuted",{id:y.action.id,from:"menu"})}),this.workspacesService.getRecentlyOpened().then(y=>{this.recentlyOpened=y}),this.registerListeners()}menubar;container;alwaysOnMnemonics=!1;focusInsideMenubar=!1;pendingFirstTimeUpdate=!1;visible=!0;actionRunner;webNavigationMenu=this._register(this.menuService.createMenu(ee.MenubarHomeMenu,this.contextKeyService));_onVisibilityChange;_onFocusStateChange;doUpdateMenubar(e){this.focusInsideMenubar||this.setupCustomMenubar(e),e&&(this.pendingFirstTimeUpdate=!0)}getUpdateAction(){switch(this.updateService.state.type){case"idle":return new ot("update.check",h({key:"checkForUpdates",comment:["&& denotes a mnemonic"]},"Check for &&Updates..."),void 0,!0,()=>this.updateService.checkForUpdates(!0));case"checking for updates":return new ot("update.checking",h("checkingForUpdates","Checking for Updates..."),void 0,!1);case"available for download":return new ot("update.downloadNow",h({key:"download now",comment:["&& denotes a mnemonic"]},"D&&ownload Update"),void 0,!0,()=>this.updateService.downloadUpdate());case"downloading":return new ot("update.downloading",h("DownloadingUpdate","Downloading Update..."),void 0,!1);case"downloaded":return be?null:new ot("update.install",h({key:"installUpdate...",comment:["&& denotes a mnemonic"]},"Install &&Update..."),void 0,!0,()=>this.updateService.applyUpdate());case"updating":return new ot("update.updating",h("installingUpdate","Installing Update..."),void 0,!1);case"ready":return new ot("update.restart",h({key:"restartToUpdate",comment:["&& denotes a mnemonic"]},"Restart to &&Update"),void 0,!0,()=>this.updateService.quitAndInstall());default:return null}}get currentMenubarVisibility(){return na(this.configurationService)}get currentDisableMenuBarAltFocus(){let e=this.configurationService.getValue("window.customMenuBarAltFocus"),i=!1;return typeof e=="boolean"&&(i=!e),i}insertActionsBefore(e,i){switch(e.id){case cx.ID:i.push(...this.getOpenRecentActions());break;case"workbench.action.showAboutDialog":if(!be&&!wt){let n=this.getUpdateAction();n&&(n.label=Ep(n.label),i.push(n),i.push(new pt))}break;default:break}}get currentEnableMenuBarMnemonics(){let e=this.configurationService.getValue("window.enableMenuBarMnemonics");return typeof e!="boolean"&&(e=!0),e&&(!wt||ld(ne))}get currentCompactMenuMode(){if(this.currentMenubarVisibility!=="compact")return;let i=this.configurationService.getValue("workbench.sideBar.location")==="right"?1:0,o=this.configurationService.getValue("workbench.activityBar.location")==="bottom"?0:1;return{horizontal:i,vertical:o}}onDidVisibilityChange(e){this.visible=e,this.onDidChangeRecentlyOpened(),this._onVisibilityChange.fire(e)}toActionsArray(e){let i=[];return Mp(e,{shouldForwardArgs:!0},i),i}reinstallDisposables=this._register(new W);setupCustomMenubar(e){if(!this.container)return;e?(this.menubar&&this.reinstallDisposables.clear(),this.menubar=this.reinstallDisposables.add(new P0(this.container,this.getMenuBarOptions(),WX)),this.accessibilityService.alwaysUnderlineAccessKeys().then(n=>{this.alwaysOnMnemonics=n,this.menubar?.update(this.getMenuBarOptions())}),this.reinstallDisposables.add(this.menubar.onFocusStateChange(n=>{this._onFocusStateChange.fire(n),n||(this.pendingFirstTimeUpdate?(this.setupCustomMenubar(!0),this.pendingFirstTimeUpdate=!1):this.updateMenubar(),this.focusInsideMenubar=!1)})),this.reinstallDisposables.add(this.menubar.onVisibilityChange(n=>this.onDidVisibilityChange(n))),this.reinstallDisposables.add(M(this.container,G.FOCUS_IN,()=>{this.focusInsideMenubar=!0})),this.reinstallDisposables.add(M(this.container,G.FOCUS_OUT,()=>{this.focusInsideMenubar=!1})),this.menubar.isVisible&&this.onDidVisibilityChange(!0)):this.menubar?.update(this.getMenuBarOptions());let i=(n,o,s)=>{o.splice(0);for(let a of n)if(this.insertActionsBefore(a,o),a instanceof pt)o.push(a);else if(a instanceof jn||a instanceof po){let l=typeof a.item.title=="string"?a.item.title:a.item.title.mnemonicTitle??a.item.title.value;if(a instanceof jn){let d=[];i(a.actions,d,s),d.length>0&&o.push(new mn(a.id,Ep(l),d))}else{iL(a.item.toggled)&&(l=a.item.toggled.mnemonicTitle??a.item.toggled.title??l);let d=new ot(a.id,Ep(l),a.class,a.enabled,()=>this.commandService.executeCommand(a.id));d.tooltip=a.tooltip,d.checked=a.checked,o.push(d)}}if(s==="File"&&this.currentCompactMenuMode===void 0){let a=this.getWebNavigationActions();a.length&&o.push(...a)}};for(let n of Object.keys(this.topLevelTitles)){let o=this.menus[n];e&&o&&(this.reinstallDisposables.add(o.onDidChange(()=>{if(!this.focusInsideMenubar){let a=[];i(this.toActionsArray(o),a,n),this.menubar?.updateMenu({actions:a,label:Ep(this.topLevelTitles[n])})}})),o===this.menus.File&&this.reinstallDisposables.add(this.webNavigationMenu.onDidChange(()=>{if(!this.focusInsideMenubar){let a=[];i(this.toActionsArray(o),a,n),this.menubar?.updateMenu({actions:a,label:Ep(this.topLevelTitles[n])})}})));let s=[];o&&i(this.toActionsArray(o),s,n),this.menubar&&(e?this.menubar.push({actions:s,label:Ep(this.topLevelTitles[n])}):this.menubar.updateMenu({actions:s,label:Ep(this.topLevelTitles[n])}))}}getWebNavigationActions(){if(!wt)return[];let e=[];for(let i of this.webNavigationMenu.getActions()){let[,n]=i;for(let o of n)if(o instanceof po){let s=typeof o.item.title=="string"?o.item.title:o.item.title.mnemonicTitle??o.item.title.value;e.push(new ot(o.id,Ep(s),o.class,o.enabled,async a=>{this.commandService.executeCommand(o.id,a)}))}e.push(new pt)}return e.length&&e.pop(),e}getMenuBarOptions(){return{enableMnemonics:this.currentEnableMenuBarMnemonics,disableAltFocus:this.currentDisableMenuBarAltFocus,visibility:this.currentMenubarVisibility,actionRunner:this.actionRunner,getKeybinding:e=>this.keybindingService.lookupKeybinding(e.id),alwaysOnMnemonics:this.alwaysOnMnemonics,compactMode:this.currentCompactMenuMode,getCompactMenuActions:()=>wt?this.getWebNavigationActions():[]}}onDidChangeWindowFocus(e){this.visible&&(super.onDidChangeWindowFocus(e),this.container&&(e?this.container.classList.remove("inactive"):(this.container.classList.add("inactive"),this.menubar?.blur())))}onUpdateStateChange(){this.visible&&super.onUpdateStateChange()}onDidChangeRecentlyOpened(){this.visible&&super.onDidChangeRecentlyOpened()}onUpdateKeybindings(){this.visible&&super.onUpdateKeybindings()}registerListeners(){super.registerListeners(),this._register(M(ne,G.RESIZE,()=>{this.menubar&&!(Xo&&Bv.pointerEvents)&&this.menubar.blur()})),wt&&(this._register(Nv(e=>{e===ne.vscodeWindowId&&this.updateMenubar()})),this._register(this.webNavigationMenu.onDidChange(()=>this.updateMenubar())),this._register(fue().event(()=>this.menubar?.toggleFocus())))}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}getMenubarItemsDimensions(){return this.menubar?new dt(this.menubar.getWidth(),this.menubar.getHeight()):new dt(0,0)}create(e){return this.container=e,this.container&&this.doUpdateMenubar(!0),this.container}layout(e){this.menubar?.update(this.getMenuBarOptions())}toggleFocus(){this.menubar?.toggleFocus()}};Vm=_([v(0,Ri),v(1,Of),v(2,ke),v(3,at),v(4,de),v(5,qo),v(6,KJ),v(7,tt),v(8,jt),v(9,Ld),v(10,on),v(11,zo),v(12,qt),v(13,en),v(14,ni)],Vm);var qp="workbench.actions.manage",jp="workbench.actions.accounts";var XJ=$("encryptionService"),cmi=$("encryptionMainService");var q4=$("secretStorageService"),B0=class extends L{constructor(e,i,n,o){super();this._useInMemoryStorage=e;this._storageService=i;this._encryptionService=n;this._logService=o}_storagePrefix="secret://";onDidChangeSecretEmitter=this._register(new T);onDidChangeSecret=this.onDidChangeSecretEmitter.event;_sequencer=new DD;_type="unknown";_onDidChangeValueDisposable=this._register(new W);get type(){return this._type}_lazyStorageService=new an(()=>this.initialize());get resolvedStorageService(){return this._lazyStorageService.value}get(e){return this._sequencer.queue(e,async()=>{let i=await this.resolvedStorageService,n=this.getKey(e);this._logService.trace("[secrets] getting secret for key:",n);let o=i.get(n,-1);if(!o){this._logService.trace("[secrets] no secret found for key:",n);return}try{this._logService.trace("[secrets] decrypting gotten secret for key:",n);let s=this._type==="in-memory"?o:await this._encryptionService.decrypt(o);return this._logService.trace("[secrets] decrypted secret for key:",n),s}catch(s){this._logService.error(s),this.delete(e);return}})}set(e,i){return this._sequencer.queue(e,async()=>{let n=await this.resolvedStorageService;this._logService.trace("[secrets] encrypting secret for key:",e);let o;try{o=this._type==="in-memory"?i:await this._encryptionService.encrypt(i)}catch(a){throw this._logService.error(a),a}let s=this.getKey(e);this._logService.trace("[secrets] storing encrypted secret for key:",s),n.store(s,o,-1,1),this._logService.trace("[secrets] stored encrypted secret for key:",s)})}delete(e){return this._sequencer.queue(e,async()=>{let i=await this.resolvedStorageService,n=this.getKey(e);this._logService.trace("[secrets] deleting secret for key:",n),i.remove(n,-1),this._logService.trace("[secrets] deleted secret for key:",n)})}async initialize(){let e;if(!this._useInMemoryStorage&&await this._encryptionService.isEncryptionAvailable())this._logService.trace("[SecretStorageService] Encryption is available, using persisted storage"),this._type="persisted",e=this._storageService;else{if(this._type==="in-memory")return this._storageService;this._logService.trace("[SecretStorageService] Encryption is not available, falling back to in-memory storage"),this._type="in-memory",e=this._register(new aA)}return this._onDidChangeValueDisposable.clear(),this._onDidChangeValueDisposable.add(e.onDidChangeValue(-1,void 0,this._onDidChangeValueDisposable)(i=>{this.onDidChangeValue(i.key)})),e}reinitialize(){this._lazyStorageService=new an(()=>this.initialize())}onDidChangeValue(e){if(!e.startsWith(this._storagePrefix))return;let i=e.slice(this._storagePrefix.length);this._logService.trace(`[SecretStorageService] Notifying change in value for secret: ${i}`),this.onDidChangeSecretEmitter.fire(i)}getKey(e){return`${this._storagePrefix}${e}`}};B0=_([v(1,tt),v(2,XJ),v(3,Gt)],B0);var ux=$("IAuthenticationService"),xmi=$("IAuthenticationExtensionsService");var j4=$("IAuthenticationAccessService"),px=class extends L{constructor(e,i){super();this._storageService=e;this._productService=i}_serviceBrand;_onDidChangeExtensionSessionAccess=this._register(new T);onDidChangeExtensionSessionAccess=this._onDidChangeExtensionSessionAccess.event;isAccessAllowed(e,i,n){let o=this._productService.trustedExtensionAuthAccess;if(Array.isArray(o)){if(o.includes(n))return!0}else if(o?.[e]?.includes(n))return!0;let a=this.readAllowedExtensions(e,i).find(l=>l.id===n);if(a)return a.allowed!==void 0?a.allowed:!0}readAllowedExtensions(e,i){let n=[];try{let o=this._storageService.get(`${e}-${i}`,-1);o&&(n=JSON.parse(o))}catch{}return n}updateAllowedExtensions(e,i,n){let o=this.readAllowedExtensions(e,i);for(let s of n){let a=o.findIndex(l=>l.id===s.id);a===-1?o.push(s):o[a].allowed=s.allowed}this._storageService.store(`${e}-${i}`,JSON.stringify(o),-1,0),this._onDidChangeExtensionSessionAccess.fire({providerId:e,accountName:i})}removeAllowedExtensions(e,i){this._storageService.remove(`${e}-${i}`,-1),this._onDidChangeExtensionSessionAccess.fire({providerId:e,accountName:i})}};px=_([v(0,tt),v(1,Qn)],px);vi(j4,px,1);function bue(r){return`onAuthenticationRequest:${r}`}async function QJ(r,t){let e=await r.get(`${t.urlProtocol}.loginAccount`);if(e)try{let i=JSON.parse(e);if(i&&si(i.id)&&si(i.accessToken)&&si(i.providerId))return i}catch(i){console.error(`Failed parsing current auth session value: ${i}`)}}var hx=class extends L{constructor(e,i,n){super();this._extensionService=e;this._environmentService=n;this._register(i.onDidChangeExtensionSessionAccess(o=>{this._onDidChangeSessions.fire({providerId:o.providerId,label:o.accountName,event:{added:[],changed:[],removed:[]}})})),this._registerEnvContributedAuthenticationProviders()}_onDidRegisterAuthenticationProvider=this._register(new T);onDidRegisterAuthenticationProvider=this._onDidRegisterAuthenticationProvider.event;_onDidUnregisterAuthenticationProvider=this._register(new T);onDidUnregisterAuthenticationProvider=this._onDidUnregisterAuthenticationProvider.event;_onDidChangeSessions=this._register(new T);onDidChangeSessions=this._onDidChangeSessions.event;_onDidChangeDeclaredProviders=this._register(new T);onDidChangeDeclaredProviders=this._onDidChangeDeclaredProviders.event;_authenticationProviders=new Map;_authenticationProviderDisposables=this._register(new Bo);_declaredProviders=[];get declaredProviders(){return this._declaredProviders}_registerEnvContributedAuthenticationProviders(){if(this._environmentService.options?.authenticationProviders?.length)for(let e of this._environmentService.options.authenticationProviders)this.registerAuthenticationProvider(e.id,e)}registerDeclaredAuthenticationProvider(e){if(YS(e.id))throw new Error(h("authentication.missingId","An authentication contribution must specify an id."));if(YS(e.label))throw new Error(h("authentication.missingLabel","An authentication contribution must specify a label."));if(this.declaredProviders.some(i=>i.id===e.id))throw new Error(h("authentication.idConflict","This authentication id '{0}' has already been registered",e.id));this._declaredProviders.push(e),this._onDidChangeDeclaredProviders.fire()}unregisterDeclaredAuthenticationProvider(e){let i=this.declaredProviders.findIndex(n=>n.id===e);i>-1&&this.declaredProviders.splice(i,1),this._onDidChangeDeclaredProviders.fire()}isAuthenticationProviderRegistered(e){return this._authenticationProviders.has(e)}registerAuthenticationProvider(e,i){this._authenticationProviders.set(e,i);let n=new W;n.add(i.onDidChangeSessions(o=>this._onDidChangeSessions.fire({providerId:e,label:i.label,event:o}))),fg(i)&&n.add(i),this._authenticationProviderDisposables.set(e,n),this._onDidRegisterAuthenticationProvider.fire({id:e,label:i.label})}unregisterAuthenticationProvider(e){let i=this._authenticationProviders.get(e);i&&(this._authenticationProviders.delete(e),this._onDidUnregisterAuthenticationProvider.fire({id:e,label:i.label})),this._authenticationProviderDisposables.deleteAndDispose(e)}getProviderIds(){let e=[];return this._authenticationProviders.forEach(i=>{e.push(i.id)}),e}getProvider(e){if(this._authenticationProviders.has(e))return this._authenticationProviders.get(e);throw new Error(`No authentication provider '${e}' is currently registered.`)}async getAccounts(e){let i=await this.getSessions(e),n=new Array,o=new Set;for(let s of i)o.has(s.account.label)||(o.add(s.account.label),n.push(s.account));return n}async getSessions(e,i,n,o=!1){let s=this._authenticationProviders.get(e)||await this.tryActivateProvider(e,o);if(s)return await s.getSessions(i,{account:n});throw new Error(`No authentication provider '${e}' is currently registered.`)}async createSession(e,i,n){let o=this._authenticationProviders.get(e)||await this.tryActivateProvider(e,!!n?.activateImmediate);if(o)return await o.createSession(i,{account:n?.account});throw new Error(`No authentication provider '${e}' is currently registered.`)}async removeSession(e,i){let n=this._authenticationProviders.get(e);if(n)return n.removeSession(i);throw new Error(`No authentication provider '${e}' is currently registered.`)}async tryActivateProvider(e,i){await this._extensionService.activateByEvent(bue(e),i?1:0);let n=this._authenticationProviders.get(e);if(n)return n;let o=new W,s=new Promise((l,d)=>{o.add(O.once(this.onDidRegisterAuthenticationProvider)(c=>{if(c.id===e)if(n=this._authenticationProviders.get(e),n)l(n);else throw new Error(`No authentication provider '${e}' is currently registered.`)}))}),a=new Promise((l,d)=>{let c=setTimeout(()=>{d("Timed out waiting for authentication provider to register")},5e3);o.add(te(()=>clearTimeout(c)))});return Promise.race([s,a]).finally(()=>o.dispose())}};hx=_([v(0,xn),v(1,j4),v(2,Ml)],hx);vi(ux,hx,1);var Qa=$("IUserDataProfileService"),Pgi=$("IUserDataProfileManagementService");var Mgi=$("IUserDataProfileImportExportService"),JJ=Tt("defaultProfile-icon",B.settings,h("defaultProfileIcon","Icon for Default Profile.")),vue=pe("profiles","Profiles"),Ogi={...vue},yue="code-profile",Ngi=[{name:h("profile","Profile"),extensions:[yue]}],Fgi=new ie("profiles.enabled",!0),Bgi=new ie("currentProfile",""),Vgi=new ie("isCurrentProfileTransient",!1),Wgi=new ie("hasProfiles",!1);var mx=Tt("settings-view-bar-icon",B.settingsGear,h("settingsViewBarIcon","Settings icon in the view bar.")),Ggi=[mx,B.vm,B.server,B.recordKeys,B.deviceMobile,B.watch,B.vr,B.piano,B.ruby,B.code,B.coffee,B.snake,B.window,B.library,B.extensions,B.terminal,B.beaker,B.package,B.cloud,B.book,B.globe,B.database,B.notebook,B.robot,B.game,B.chip,B.music,B.gift,B.send,B.briefcase,B.megaphone,B.comment,B.telescope,B.creditCard,B.map,B.deviceCameraVideo,B.unmute,B.law,B.graphLine,B.heart,B.home,B.inbox,B.mortarBoard,B.rocket,B.magnet,B.lock,B.milestone,B.tag,B.pulse,B.radioTower,B.smiley,B.zap,B.squirrel,B.symbolColor,B.mail,B.key,B.pieChart,B.organization,B.preview,B.wand,B.starEmpty,B.lightbulb,B.symbolRuler,B.dashboard,B.calendar,B.shield,B.flame,B.compass,B.paintcan,B.archive,B.mic,B.jersey];var $d=class extends L{constructor(e,i,n,o,s,a,l){super();this.contextMenuActionsProvider=e;this.colors=i;this.activityHoverOptions=n;this.instantiationService=s;this.storageService=a;this.extensionService=l;this.element=document.createElement("div");let d=()=>({anchorAlignment:o.getValue("workbench.sideBar.location")==="left"?1:0,anchorAxisAlignment:1});this.globalActivityActionBar=this._register(new gn(this.element,{actionViewItemProvider:(c,u)=>{if(c.id===qp)return this.instantiationService.createInstance(ZI,this.contextMenuActionsProvider,{...u,colors:this.colors,hoverOptions:this.activityHoverOptions},d);if(c.id===jp)return this.instantiationService.createInstance(Yd,this.contextMenuActionsProvider,{...u,colors:this.colors,hoverOptions:this.activityHoverOptions},d,p=>{p.unshift(Ht({id:"hideAccounts",label:h("hideAccounts","Hide Accounts"),run:()=>V0(a,!1)}),new pt)});throw new Error(`No view item for action '${c.id}'`)},orientation:1,ariaLabel:h("manage","Manage"),preventLoopNavigation:!0})),this.accountsVisibilityPreference&&this.globalActivityActionBar.push(this.accountAction,{index:$d.ACCOUNTS_ACTION_INDEX}),this.globalActivityActionBar.push(this.globalActivityAction),this.registerListeners()}static ACCOUNTS_ACTION_INDEX=0;static ACCOUNTS_ICON=Tt("accounts-view-bar-icon",B.account,h("accountsViewBarIcon","Accounts icon in the view bar."));element;globalActivityAction=this._register(new ot(qp));accountAction=this._register(new ot(jp));globalActivityActionBar;registerListeners(){this.extensionService.whenInstalledExtensionsRegistered().then(()=>{this._store.isDisposed||this._register(this.storageService.onDidChangeValue(0,Yd.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,this._store)(()=>this.toggleAccountsActivity()))})}create(e){e.appendChild(this.element)}focus(){this.globalActivityActionBar.focus(!0)}size(){return this.globalActivityActionBar.viewItems.length}getContextMenuActions(){return[Ht({id:"toggleAccountsVisibility",label:h("accounts","Accounts"),checked:this.accountsVisibilityPreference,run:()=>this.accountsVisibilityPreference=!this.accountsVisibilityPreference})]}toggleAccountsActivity(){this.globalActivityActionBar.length()===2&&this.accountsVisibilityPreference||(this.globalActivityActionBar.length()===2?this.globalActivityActionBar.pull($d.ACCOUNTS_ACTION_INDEX):this.globalActivityActionBar.push(this.accountAction,{index:$d.ACCOUNTS_ACTION_INDEX}))}get accountsVisibilityPreference(){return gx(this.storageService)}set accountsVisibilityPreference(e){V0(this.storageService,e)}};$d=_([v(3,de),v(4,ae),v(5,tt),v(6,xn)],$d);var YI=class extends jd{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g){super(i,{draggable:!1,icon:!0,hasPopup:!0,...n},()=>!0,a,l,p,m);this.menuId=e;this.contextMenuActionsProvider=o;this.contextMenuAlignmentOptions=s;this.menuService=d;this.contextMenuService=c;this.contextKeyService=u;this.activityService=g;this.updateItemActivity(),this._register(this.activityService.onDidChangeActivity(f=>{si(f)&&f===this.compositeBarActionItem.id&&this.updateItemActivity()}))}updateItemActivity(){let e=this.activityService.getActivity(this.compositeBarActionItem.id),i=e[0];if(i){let{badge:n,priority:o}=i;n instanceof Kp&&e.length>1&&(i={badge:this.getCumulativeNumberBadge(e,o??0)})}this.action.activity=i}getCumulativeNumberBadge(e,i){let n=e.filter(a=>a.badge instanceof Kp&&(a.priority??0)===i),o=n.reduce((a,l)=>a+l.badge.number,0),s=()=>n.reduce((a,l,d)=>(a=a+l.badge.getDescription(),d<n.length-1&&(a=`${a}
`),a),"");return new Kp(o,s)}render(e){super.render(e),this._register(M(this.container,G.MOUSE_DOWN,async i=>{Te.stop(i,!0),i?.button!==2&&this.run()})),this._register(M(this.container,G.CONTEXT_MENU,async i=>{i.stopPropagation();let n=new W,o=await this.resolveContextMenuActions(n),s=new ri(oe(this.container),i);this.contextMenuService.showContextMenu({getAnchor:()=>s,getActions:()=>o,onHide:()=>n.dispose()})})),this._register(M(this.container,G.KEY_UP,i=>{let n=new st(i);(n.equals(3)||n.equals(10))&&(Te.stop(i,!0),this.run())})),this._register(M(this.container,it.Tap,i=>{Te.stop(i,!0),this.run()}))}async resolveContextMenuActions(e){return this.contextMenuActionsProvider()}async run(){let e=new W,i=e.add(this.menuService.createMenu(this.menuId,this.contextKeyService)),n=await this.resolveMainMenuActions(i,e),{anchorAlignment:o,anchorAxisAlignment:s}=this.contextMenuAlignmentOptions()??{anchorAlignment:void 0,anchorAxisAlignment:void 0};this.contextMenuService.showContextMenu({getAnchor:()=>this.label,anchorAlignment:o,anchorAxisAlignment:s,getActions:()=>n,onHide:()=>e.dispose(),menuActionOptions:{renderShortTitle:!0}})}async resolveMainMenuActions(e,i){let n=[];return qa(e,{renderShortTitle:!0},{primary:[],secondary:n}),n}};YI=_([v(5,Ze),v(6,qi),v(7,Ri),v(8,Mt),v(9,ke),v(10,de),v(11,at),v(12,Om)],YI);var Yd=class extends YI{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y,I,E,S,w){let D=S.createInstance(Gp,{id:jp,name:h("accounts","Accounts"),classNames:ye.asClassNameArray($d.ACCOUNTS_ICON)});super(ee.AccountsContext,D,i,e,n,s,l,c,d,u,f,b,E);this.fillContextMenuActions=o;this.lifecycleService=a;this.authenticationService=p;this.productService=g;this.secretStorageService=y;this.logService=I;this.commandService=w;this._register(D),this.registerListeners(),this.initialize()}static ACCOUNTS_VISIBILITY_PREFERENCE_KEY="workbench.activity.showAccounts";groupedAccounts=new Map;problematicProviders=new Set;initialized=!1;sessionFromEmbedder=new an(()=>QJ(this.secretStorageService,this.productService));registerListeners(){this._register(this.authenticationService.onDidRegisterAuthenticationProvider(async e=>{await this.addAccountsFromProvider(e.id)})),this._register(this.authenticationService.onDidUnregisterAuthenticationProvider(e=>{this.groupedAccounts.delete(e.id),this.problematicProviders.delete(e.id)})),this._register(this.authenticationService.onDidChangeSessions(async e=>{if(e.event.removed)for(let i of e.event.removed)this.removeAccount(e.providerId,i.account);for(let i of[...e.event.changed??[],...e.event.added??[]])try{await this.addOrUpdateAccount(e.providerId,i.account)}catch(n){this.logService.error(n)}}))}async initialize(){if(await this.lifecycleService.when(3),this._store.isDisposed)return;let e=this._register(md(oe(this.element),async()=>{await this.doInitialize(),e.dispose()}))}async doInitialize(){let e=this.authenticationService.getProviderIds(),i=await Promise.allSettled(e.map(n=>this.addAccountsFromProvider(n)));for(let n of i)n.status==="rejected"&&this.logService.error(n.reason);this.initialized=!0}async resolveMainMenuActions(e,i){await super.resolveMainMenuActions(e,i);let n=this.authenticationService.getProviderIds(),o=e.getActions(),s=[];for(let a of n){if(!this.initialized){let c=i.add(new ot("noAccountsAvailable",h("loading","Loading..."),void 0,!1));s.push(c);break}let l=this.authenticationService.getProvider(a).label,d=this.groupedAccounts.get(a);if(!d){if(this.problematicProviders.has(a)){let c=i.add(new ot("providerUnavailable",h("authProviderUnavailable","{0} is currently unavailable",l),void 0,!1));s.push(c);try{await this.addAccountsFromProvider(a)}catch(u){this.logService.error(u)}}continue}for(let c of d){let p=[Ht({id:`configureSessions${c.label}`,label:h("manageTrustedExtensions","Manage Trusted Extensions"),enabled:!0,run:()=>this.commandService.executeCommand("_manageTrustedExtensionsForAccount",{providerId:a,accountLabel:c.label})})];c.canSignOut&&p.push(Ht({id:"signOut",label:h("signOut","Sign Out"),enabled:!0,run:()=>this.commandService.executeCommand("_signOutOfAccount",{providerId:a,accountLabel:c.label})}));let m=new mn("activitybar.submenu",`${c.label} (${l})`,p);s.push(m)}}if(n.length&&!s.length){let a=i.add(new ot("noAccountsAvailable",h("noAccounts","You are not signed in to any accounts"),void 0,!1));s.push(a)}return s.length&&o.length&&s.push(new pt),o.forEach((a,l)=>{let d=a[1];s=s.concat(d),l!==o.length-1&&s.push(new pt)}),s}async resolveContextMenuActions(e){let i=await super.resolveContextMenuActions(e);return this.fillContextMenuActions(i),i}async addOrUpdateAccount(e,i){let n=this.groupedAccounts.get(e);n||(n=[],this.groupedAccounts.set(e,n));let o=await this.sessionFromEmbedder.value,s=!0;o&&!o.canSignOut&&(await this.authenticationService.getSessions(e)).some(l=>l.id===o.id&&l.account.id===i.id)&&(s=!1);let a=n.find(l=>l.label===i.label);a?s||(a.canSignOut=s):n.push({...i,canSignOut:s})}removeAccount(e,i){let n=this.groupedAccounts.get(e);if(!n)return;let o=n.findIndex(s=>s.id===i.id);o!==-1&&(n.splice(o,1),n.length===0&&this.groupedAccounts.delete(e))}async addAccountsFromProvider(e){try{let i=await this.authenticationService.getSessions(e);this.problematicProviders.delete(e);for(let n of i)try{await this.addOrUpdateAccount(e,n.account)}catch(o){this.logService.error(o)}}catch(i){this.logService.error(i),this.problematicProviders.add(e)}}};Yd=_([v(4,Ze),v(5,Pn),v(6,qi),v(7,Mt),v(8,Ri),v(9,ke),v(10,ux),v(11,on),v(12,Qn),v(13,de),v(14,at),v(15,q4),v(16,Gt),v(17,Om),v(18,ae),v(19,ni)],Yd);var ZI=class extends YI{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f){let b=g.createInstance(Gp,{id:qp,name:h("manage","Manage"),classNames:ye.asClassNameArray(o.currentProfile.icon?ye.fromId(o.currentProfile.icon):mx)});super(ee.GlobalActivity,b,i,e,n,s,a,l,d,c,u,m,f);this.userDataProfileService=o;this._register(b),this._register(this.userDataProfileService.onDidChangeCurrentProfile(y=>{b.compositeBarActionItem={...b.compositeBarActionItem,classNames:ye.asClassNameArray(o.currentProfile.icon?ye.fromId(o.currentProfile.icon):mx)}}))}profileBadge;profileBadgeContent;render(e){super.render(e),this.profileBadge=Ee(e,re(".profile-badge")),this.profileBadgeContent=Ee(this.profileBadge,re(".profile-badge-content")),this.updateProfileBadge()}updateProfileBadge(){!this.profileBadge||!this.profileBadgeContent||(ci(this.profileBadgeContent),ys(this.profileBadge),!this.userDataProfileService.currentProfile.isDefault&&(this.userDataProfileService.currentProfile.icon&&this.userDataProfileService.currentProfile.icon!==mx.id||this.action.activity||(rs(this.profileBadge),this.profileBadgeContent.classList.toggle("profile-text-overlay",!0),this.profileBadgeContent.classList.toggle("profile-icon-overlay",!1),this.profileBadgeContent.textContent=this.userDataProfileService.currentProfile.name.substring(0,2).toUpperCase())))}updateActivity(){super.updateActivity(),this.updateProfileBadge()}computeTitle(){return this.userDataProfileService.currentProfile.isDefault?super.computeTitle():h("manage profile","Manage {0} (Profile)",this.userDataProfileService.currentProfile.name)}};ZI=_([v(3,Qa),v(4,Ze),v(5,qi),v(6,Ri),v(7,Mt),v(8,ke),v(9,de),v(10,on),v(11,at),v(12,ae),v(13,Om)],ZI);var XI=class extends Yd{constructor(t,e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y,I,E){super(()=>eee(f,!0),{...e,colors:S=>({badgeBackground:S.getColor(sd),badgeForeground:S.getColor(ad)}),hoverOptions:t,compact:!0},()=>{},S=>S,i,n,o,s,a,l,d,c,u,p,m,g,b,y,I,E)}};XI=_([v(2,Ze),v(3,Pn),v(4,qi),v(5,Mt),v(6,Ri),v(7,ke),v(8,ux),v(9,on),v(10,Qn),v(11,de),v(12,at),v(13,q4),v(14,tt),v(15,Gt),v(16,Om),v(17,ae),v(18,ni)],XI);var QI=class extends ZI{constructor(t,e,i,n,o,s,a,l,d,c,u,p,m,g){super(()=>eee(g,!1),{...e,colors:f=>({badgeBackground:f.getColor(sd),badgeForeground:f.getColor(ad)}),hoverOptions:t,compact:!0},()=>{},i,n,o,s,a,l,d,c,u,p,m)}};QI=_([v(2,Qa),v(3,Ze),v(4,qi),v(5,Ri),v(6,Mt),v(7,ke),v(8,de),v(9,on),v(10,at),v(11,ae),v(12,Om),v(13,tt)],QI);function eee(r,t){let e=[];return t&&e.push(Ht({id:"hideAccounts",label:h("hideAccounts","Hide Accounts"),run:()=>V0(r,!1)}),new pt),[...e,Ht({id:"toggle.hideAccounts",label:h("accounts","Accounts"),checked:gx(r),run:()=>V0(r,!gx(r))}),Ht({id:"toggle.hideManage",label:h("manage","Manage"),checked:!0,enabled:!1,run:()=>{throw new Error('"Manage" can not be hidden')}})]}function gx(r){return r.getBoolean(Yd.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,0,!0)}function V0(r,t){r.store(Yd.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,t,0,0)}var Vs=class extends xl{constructor(e,i,n,o,s){super("workbench.parts.activitybar",{hasTitle:!1},o,s,n);this.paneCompositePart=e;this.instantiationService=i}static ACTION_HEIGHT=48;static pinnedViewContainersKey="workbench.activity.pinnedViewlets2";static placeholderViewContainersKey="workbench.activity.placeholderViewlets";static viewContainersWorkspaceStateKey="workbench.activity.viewletsWorkspaceState";minimumWidth=48;maximumWidth=48;minimumHeight=0;maximumHeight=Number.POSITIVE_INFINITY;compositeBar=this._register(new mt);content;createCompositeBar(){return this.instantiationService.createInstance(tb,{partContainerClass:"activitybar",pinnedViewContainersKey:Vs.pinnedViewContainersKey,placeholderViewContainersKey:Vs.placeholderViewContainersKey,viewContainersWorkspaceStateKey:Vs.viewContainersWorkspaceStateKey,orientation:1,icon:!0,iconSize:24,activityHoverOptions:{position:()=>this.layoutService.getSideBarPosition()===0?1:0},preventLoopNavigation:!0,recomputeSizes:!1,fillExtraContextMenuActions:(e,i)=>{},compositeSize:52,colors:e=>({activeForegroundColor:e.getColor(Vh),inactiveForegroundColor:e.getColor(ej),activeBorderColor:e.getColor(FV),activeBackground:e.getColor(BV),badgeBackground:e.getColor(sd),badgeForeground:e.getColor(ad),dragAndDropBorder:e.getColor(nj),activeBackgroundColor:void 0,inactiveBackgroundColor:void 0,activeBorderBottomColor:void 0}),overflowActionSize:Vs.ACTION_HEIGHT},"workbench.parts.activitybar",this.paneCompositePart,!0)}createContentArea(e){return this.element=e,this.content=Ee(this.element,re(".content")),this.layoutService.isVisible("workbench.parts.activitybar")&&this.show(),this.content}getPinnedPaneCompositeIds(){return this.compositeBar.value?.getPinnedPaneCompositeIds()??[]}getVisiblePaneCompositeIds(){return this.compositeBar.value?.getVisiblePaneCompositeIds()??[]}focus(){this.compositeBar.value?.focus()}updateStyles(){super.updateStyles();let e=Ue(this.getContainer()),i=this.getColor(Jq)||"";e.style.backgroundColor=i;let n=this.getColor(tj)||this.getColor(Le)||"";e.classList.toggle("bordered",!!n),e.style.borderColor=n||""}show(e){this.content&&(this.compositeBar.value||(this.compositeBar.value=this.createCompositeBar(),this.compositeBar.value.create(this.content),this.dimension&&this.layout(this.dimension.width,this.dimension.height)),e&&this.focus())}hide(){this.compositeBar.value&&(this.compositeBar.clear(),this.content&&ci(this.content))}layout(e,i){if(super.layout(e,i,0,0),!this.compositeBar.value)return;let n=super.layoutContents(e,i).contentSize;this.compositeBar.value.layout(e,n.height)}toJSON(){return{type:"workbench.parts.activitybar"}}};Vs=_([v(1,ae),v(2,Qe),v(3,Ze),v(4,tt)],Vs);var tb=class extends Nm{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f){super({...e,fillExtraContextMenuActions:(b,y)=>{e.fillExtraContextMenuActions(b,y),this.fillContextMenuActions(b,y)}},i,n,s,a,l,d,c,u,p,f);this.configurationService=m;this.menuService=g;o&&(this.globalCompositeBar=this._register(s.createInstance($d,()=>this.getContextMenuActions(),b=>this.options.colors(b),this.options.activityHoverOptions))),this._register(this.configurationService.onDidChangeConfiguration(b=>{b.affectsConfiguration("window.menuBarVisibility")&&(na(this.configurationService)==="compact"?this.installMenubar():this.uninstallMenubar())}))}element;menuBar;menuBarContainer;compositeBarContainer;globalCompositeBar;keyboardNavigationDisposables=this._register(new W);fillContextMenuActions(e,i){let n=na(this.configurationService);(n==="compact"||n==="hidden"||n==="toggle")&&e.unshift(Ht({id:"toggleMenuVisibility",label:h("menu","Menu"),checked:n==="compact",run:()=>this.configurationService.updateValue("window.menuBarVisibility",n==="compact"?"toggle":"compact")}),new pt),n==="compact"&&this.menuBarContainer&&i?.target&&Xi(i.target,this.menuBarContainer)&&e.unshift(Ht({id:"hideCompactMenu",label:h("hideMenu","Hide Menu"),run:()=>this.configurationService.updateValue("window.menuBarVisibility","toggle")}),new pt),this.globalCompositeBar&&(e.push(new pt),e.push(...this.globalCompositeBar.getContextMenuActions())),e.push(new pt),e.push(...this.getActivityBarContextMenuActions())}uninstallMenubar(){this.menuBar&&(this.menuBar.dispose(),this.menuBar=void 0),this.menuBarContainer&&(this.menuBarContainer.remove(),this.menuBarContainer=void 0)}installMenubar(){if(this.menuBar)return;this.menuBarContainer=document.createElement("div"),this.menuBarContainer.classList.add("menubar"),Ue(this.element).prepend(this.menuBarContainer),this.menuBar=this._register(this.instantiationService.createInstance(Vm)),this.menuBar.create(this.menuBarContainer)}registerKeyboardNavigationListeners(){this.keyboardNavigationDisposables.clear(),this.menuBarContainer&&this.keyboardNavigationDisposables.add(M(this.menuBarContainer,G.KEY_DOWN,e=>{let i=new st(e);(i.equals(18)||i.equals(17))&&this.focus()})),this.compositeBarContainer&&this.keyboardNavigationDisposables.add(M(this.compositeBarContainer,G.KEY_DOWN,e=>{let i=new st(e);i.equals(18)||i.equals(17)?this.globalCompositeBar?.focus():(i.equals(16)||i.equals(15))&&this.menuBar?.toggleFocus()})),this.globalCompositeBar&&this.keyboardNavigationDisposables.add(M(this.globalCompositeBar.element,G.KEY_DOWN,e=>{let i=new st(e);(i.equals(16)||i.equals(15))&&this.focus(this.getVisiblePaneCompositeIds().length-1)}))}create(e){return this.element=e,na(this.configurationService)==="compact"&&this.installMenubar(),this.compositeBarContainer=super.create(this.element),this.globalCompositeBar&&this.globalCompositeBar.create(this.element),this.registerKeyboardNavigationListeners(),this.compositeBarContainer}layout(e,i){this.menuBarContainer&&(this.options.orientation===1?i-=this.menuBarContainer.clientHeight:e-=this.menuBarContainer.clientWidth),this.globalCompositeBar&&(this.options.orientation===1?i-=this.globalCompositeBar.size()*Vs.ACTION_HEIGHT:e-=this.globalCompositeBar.element.clientWidth),super.layout(e,i)}getActivityBarContextMenuActions(){let e=this.menuService.getMenuActions(ee.ActivityBarPositionMenu,this.contextKeyService,{shouldForwardArgs:!0,renderShortTitle:!0}),i=[];return Mp(e,{primary:[],secondary:i}),[new mn("workbench.action.panel.position",h("activity bar position","Activity Bar Position"),i),Ht({id:Fr.ID,label:Fr.getLabel(this.layoutService),run:()=>this.instantiationService.invokeFunction(n=>new Fr().run(n))})]}};tb=_([v(4,ae),v(5,tt),v(6,xn),v(7,zi),v(8,va),v(9,ke),v(10,on),v(11,de),v(12,Ri),v(13,Qe)],tb);Me(class extends We{constructor(){super({id:"workbench.action.activityBarLocation.default",title:{...pe("positionActivityBarDefault","Move Activity Bar to Side"),mnemonicTitle:h({key:"miDefaultActivityBar",comment:["&& denotes a mnemonic"]},"&&Default")},shortTitle:h("default","Default"),category:gt.View,toggled:X.equals("config.workbench.activityBar.location","default"),menu:[{id:ee.ActivityBarPositionMenu,order:1},{id:ee.CommandPalette,when:X.notEquals("config.workbench.activityBar.location","default")}]})}run(r){r.get(de).updateValue("workbench.activityBar.location","default")}});Me(class extends We{constructor(){super({id:"workbench.action.activityBarLocation.top",title:{...pe("positionActivityBarTop","Move Activity Bar to Top"),mnemonicTitle:h({key:"miTopActivityBar",comment:["&& denotes a mnemonic"]},"&&Top")},shortTitle:h("top","Top"),category:gt.View,toggled:X.equals("config.workbench.activityBar.location","top"),menu:[{id:ee.ActivityBarPositionMenu,order:2},{id:ee.CommandPalette,when:X.notEquals("config.workbench.activityBar.location","top")}]})}run(r){r.get(de).updateValue("workbench.activityBar.location","top")}});Me(class extends We{constructor(){super({id:"workbench.action.activityBarLocation.bottom",title:{...pe("positionActivityBarBottom","Move Activity Bar to Bottom"),mnemonicTitle:h({key:"miBottomActivityBar",comment:["&& denotes a mnemonic"]},"&&Bottom")},shortTitle:h("bottom","Bottom"),category:gt.View,toggled:X.equals("config.workbench.activityBar.location","bottom"),menu:[{id:ee.ActivityBarPositionMenu,order:3},{id:ee.CommandPalette,when:X.notEquals("config.workbench.activityBar.location","bottom")}]})}run(r){r.get(de).updateValue("workbench.activityBar.location","bottom")}});Me(class extends We{constructor(){super({id:"workbench.action.activityBarLocation.hide",title:{...pe("hideActivityBar","Hide Activity Bar"),mnemonicTitle:h({key:"miHideActivityBar",comment:["&& denotes a mnemonic"]},"&&Hidden")},shortTitle:h("hide","Hidden"),category:gt.View,toggled:X.equals("config.workbench.activityBar.location","hidden"),menu:[{id:ee.ActivityBarPositionMenu,order:4},{id:ee.CommandPalette,when:X.notEquals("config.workbench.activityBar.location","hidden")}]})}run(r){r.get(de).updateValue("workbench.activityBar.location","hidden")}});Ct.appendMenuItem(ee.MenubarAppearanceMenu,{submenu:ee.ActivityBarPositionMenu,title:h("positionActivituBar","Activity Bar Position"),group:"3_workbench_layout_move",order:2});Ct.appendMenuItem(ee.ViewContainerTitleContext,{submenu:ee.ActivityBarPositionMenu,title:h("positionActivituBar","Activity Bar Position"),when:X.equals("viewContainerLocation",go(0)),group:"3_workbench_layout_move",order:1});Ct.appendMenuItem(ee.ViewTitleContext,{submenu:ee.ActivityBarPositionMenu,title:h("positionActivituBar","Activity Bar Position"),when:X.equals("viewLocation",go(0)),group:"3_workbench_layout_move",order:1});var W0=class extends We{constructor(e,i){super(e);this.offset=i}async run(e){let i=e.get(hs),n=i.getVisiblePaneCompositeIds(0),o=i.getActivePaneComposite(0);if(!o)return;let s;for(let a=0;a<n.length;a++)if(n[a]===o.getId()){s=n[(a+n.length+this.offset)%n.length];break}await i.openPaneComposite(s,0,!0)}};Me(class extends W0{constructor(){super({id:"workbench.action.previousSideBarView",title:pe("previousSideBarView","Previous Primary Side Bar View"),category:gt.View,f1:!0},-1)}});Me(class extends W0{constructor(){super({id:"workbench.action.nextSideBarView",title:pe("nextSideBarView","Next Primary Side Bar View"),category:gt.View,f1:!0},1)}});Me(class extends We{constructor(){super({id:"workbench.action.focusActivityBar",title:pe("focusActivityBar","Focus Activity Bar"),category:gt.View,f1:!0})}async run(t){t.get(Qe).focusPart("workbench.parts.activitybar")}});co((r,t)=>{let e=r.getColor(FV);e&&t.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator:before {
				border-left-color: ${e};
			}
		`);let i=r.getColor(ij);i&&t.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus::before {
				visibility: hidden;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus .active-item-indicator:before {
				visibility: visible;
				border-left-color: ${i};
			}
		`);let n=r.getColor(BV);n&&t.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator {
				z-index: 0;
				background-color: ${n};
			}
		`);let o=r.getColor(oi);if(o)t.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item .action-label::before{
				padding: 6px;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active .action-label::before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover .action-label::before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .action-label::before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover .action-label::before {
				outline: 1px solid ${o};
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover .action-label::before {
				outline: 1px dashed ${o};
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {
				border-left-color: ${o};
			}
		`);else{let s=r.getColor(ir);s&&t.addRule(`
				.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator::before {
						border-left-color: ${s};
					}
				`)}});var $p=class extends Bl{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g){super("workbench.parts.sidebar",{hasTitle:!0,borderWidth:()=>this.getColor(Ov)||this.getColor(Le)?1:0},$p.activeViewletSettingsKey,SQ.bindTo(u),CQ.bindTo(u),"sideBar","viewlet",oj,e,i,n,o,s,a,l,d,c,u,p,g);this.configurationService=m;this.rememberActivityBarVisiblePosition(),this._register(m.onDidChangeConfiguration(f=>{f.affectsConfiguration("workbench.activityBar.location")&&this.onDidChangeActivityBarLocation()})),this.registerActions()}static activeViewletSettingsKey="workbench.sidebar.activeviewletid";minimumWidth=170;maximumWidth=Number.POSITIVE_INFINITY;minimumHeight=0;maximumHeight=Number.POSITIVE_INFINITY;get snap(){return!0}priority=1;get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let i=e.getOptimalWidth();if(typeof i=="number")return Math.max(i,300)}activityBarPart=this._register(this.instantiationService.createInstance(Vs,this));onDidChangeActivityBarLocation(){this.activityBarPart.hide(),this.updateCompositeBar();let e=this.getActiveComposite()?.getId();e&&this.onTitleAreaUpdate(e),this.shouldShowActivityBar()&&this.activityBarPart.show(),this.rememberActivityBarVisiblePosition()}updateStyles(){super.updateStyles();let e=Ue(this.getContainer());e.style.backgroundColor=this.getColor(gl)||"",e.style.color=this.getColor(Mv)||"";let i=this.getColor(Ov)||this.getColor(Le),n=this.layoutService.getSideBarPosition()===0;e.style.borderRightWidth=i&&n?"1px":"",e.style.borderRightStyle=i&&n?"solid":"",e.style.borderRightColor=n&&i||"",e.style.borderLeftWidth=i&&!n?"1px":"",e.style.borderLeftStyle=i&&!n?"solid":"",e.style.borderLeftColor=n?"":i||"",e.style.outlineColor=this.getColor(Vw)??""}layout(e,i,n,o){this.layoutService.isVisible("workbench.parts.sidebar")&&super.layout(e,i,n,o)}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===0?0:1}createCompositeBar(){return this.instantiationService.createInstance(tb,this.getCompositeBarOptions(),this.partId,this,!1)}getCompositeBarOptions(){return{partContainerClass:"sidebar",pinnedViewContainersKey:Vs.pinnedViewContainersKey,placeholderViewContainersKey:Vs.placeholderViewContainersKey,viewContainersWorkspaceStateKey:Vs.viewContainersWorkspaceStateKey,icon:!0,orientation:0,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===2?3:2},fillExtraContextMenuActions:e=>{let i=this.getViewsSubmenuAction();i&&(e.push(new pt),e.push(i))},compositeSize:0,iconSize:16,overflowActionSize:30,colors:e=>({activeBackgroundColor:e.getColor(gl),inactiveBackgroundColor:e.getColor(gl),activeBorderBottomColor:e.getColor(FL),activeForegroundColor:e.getColor(sp),inactiveForegroundColor:e.getColor(BL),badgeBackground:e.getColor(sd),badgeForeground:e.getColor(ad),dragAndDropBorder:e.getColor(VL)}),compact:!0}}shouldShowCompositeBar(){let e=this.configurationService.getValue("workbench.activityBar.location");return e==="top"||e==="bottom"}shouldShowActivityBar(){return this.shouldShowCompositeBar()?!1:this.configurationService.getValue("workbench.activityBar.location")!=="hidden"}getCompositeBarPosition(){switch(this.configurationService.getValue("workbench.activityBar.location")){case"top":return 0;case"bottom":return 2;case"hidden":case"default":default:return 1}}rememberActivityBarVisiblePosition(){let e=this.configurationService.getValue("workbench.activityBar.location");e!=="hidden"&&this.storageService.store("workbench.activityBar.location",e,0,0)}getRememberedActivityBarVisiblePosition(){switch(this.storageService.get("workbench.activityBar.location",0)){case"top":return"top";case"bottom":return"bottom";default:return"default"}}getPinnedPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPinnedPaneCompositeIds():this.activityBarPart.getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(){return this.shouldShowCompositeBar()?super.getVisiblePaneCompositeIds():this.activityBarPart.getVisiblePaneCompositeIds()}async focusActivityBar(){this.configurationService.getValue("workbench.activityBar.location")==="hidden"&&(await this.configurationService.updateValue("workbench.activityBar.location",this.getRememberedActivityBarVisiblePosition()),this.onDidChangeActivityBarLocation()),this.shouldShowCompositeBar()?this.focusCompositeBar():(this.layoutService.isVisible("workbench.parts.activitybar")||this.layoutService.setPartHidden(!1,"workbench.parts.activitybar"),this.activityBarPart.show(!0))}registerActions(){let e=this;this._register(Me(class extends We{constructor(){super({id:x4,title:pe("toggleActivityBar","Toggle Activity Bar Visibility")})}run(){let i=e.configurationService.getValue("workbench.activityBar.location")==="hidden"?e.getRememberedActivityBarVisiblePosition():"hidden";return e.configurationService.updateValue("workbench.activityBar.location",i)}}))}toJSON(){return{type:"workbench.parts.sidebar"}}};$p=_([v(0,jt),v(1,tt),v(2,Mt),v(3,Qe),v(4,at),v(5,qi),v(6,ae),v(7,Ze),v(8,zi),v(9,ke),v(10,xn),v(11,de),v(12,Ri)],$p);var Wm=class extends Bl{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f){super("workbench.parts.panel",{hasTitle:!0},Wm.activePanelSettingsKey,TQ.bindTo(u),xQ.bindTo(u),"panel","panel",void 0,e,i,n,o,s,a,l,d,c,u,p,g);this.commandService=m;this.configurationService=f;this._register(this.configurationService.onDidChangeConfiguration(b=>{b.affectsConfiguration("workbench.panel.showLabel")&&this.updateCompositeBar(!0)}))}minimumWidth=300;maximumWidth=Number.POSITIVE_INFINITY;minimumHeight=77;maximumHeight=Number.POSITIVE_INFINITY;get preferredHeight(){return this.layoutService.mainContainerDimension.height*.4}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let i=e.getOptimalWidth();if(typeof i=="number")return Math.max(i,300)}static activePanelSettingsKey="workbench.panelpart.activepanelid";updateStyles(){super.updateStyles();let e=Ue(this.getContainer());e.style.backgroundColor=this.getColor(Fg)||"";let i=this.getColor(PL)||this.getColor(Le)||"";e.style.borderLeftColor=i,e.style.borderRightColor=i,e.style.borderBottomColor=i;let n=this.getTitleArea();n&&(n.style.borderTopColor=this.getColor(PL)||this.getColor(Le)||"")}getCompositeBarOptions(){return{partContainerClass:"panel",pinnedViewContainersKey:"workbench.panel.pinnedPanels",placeholderViewContainersKey:"workbench.panel.placeholderPanels",viewContainersWorkspaceStateKey:"workbench.panel.viewContainersWorkspaceState",icon:!this.configurationService.getValue("workbench.panel.showLabel"),orientation:0,recomputeSizes:!0,activityHoverOptions:{position:()=>this.layoutService.getPanelPosition()===2&&!this.layoutService.isPanelMaximized()?3:2},fillExtraContextMenuActions:e=>this.fillExtraContextMenuActions(e),compositeSize:0,iconSize:16,overflowActionSize:44,colors:e=>({activeBackgroundColor:e.getColor(Fg),inactiveBackgroundColor:e.getColor(Fg),activeBorderBottomColor:e.getColor(OL),activeForegroundColor:e.getColor(rp),inactiveForegroundColor:e.getColor(ML),badgeBackground:e.getColor(ul),badgeForeground:e.getColor(Mh),dragAndDropBorder:e.getColor(NL)})}}fillExtraContextMenuActions(e){let i=this.menuService.getMenuActions(ee.PanelPositionMenu,this.contextKeyService,{shouldForwardArgs:!0}),n=this.menuService.getMenuActions(ee.PanelAlignmentMenu,this.contextKeyService,{shouldForwardArgs:!0}),o=[],s=[];Mp(i,{primary:[],secondary:o}),Mp(n,{primary:[],secondary:s}),e.push(new pt,new mn("workbench.action.panel.position",h("panel position","Panel Position"),o),new mn("workbench.action.panel.align",h("align panel","Align Panel"),s),Ht({id:vu.ID,label:h("hidePanel","Hide Panel"),run:()=>this.commandService.executeCommand(vu.ID)}))}layout(e,i,n,o){let s;switch(this.layoutService.getPanelPosition()){case 1:s=new dt(e-1,i);break;case 3:s=new dt(e,i-1);break;default:s=new dt(e,i);break}super.layout(s.width,s.height,n,o)}shouldShowCompositeBar(){return!0}getCompositeBarPosition(){return 1}toJSON(){return{type:"workbench.parts.panel"}}};Wm=_([v(0,jt),v(1,tt),v(2,Mt),v(3,Qe),v(4,at),v(5,qi),v(6,ae),v(7,Ze),v(8,zi),v(9,ke),v(10,xn),v(11,ni),v(12,Ri),v(13,de)],Wm);var Iue=(()=>{if(be&&Pi)return"${activeEditorShort}${separator}${rootName}${separator}${profileName}";let r="${dirty}${activeEditorShort}${separator}${rootName}${separator}${profileName}${separator}${appName}";return wt?r+"${separator}${remoteName}":r})(),Cue=be?" \u2014 ":" - ",Ja=class extends L{constructor(e,i,n,o,s,a,l,d,c,u,p){super();this.configurationService=n;this.contextKeyService=o;this.environmentService=a;this.contextService=l;this.labelService=d;this.userDataProfileService=c;this.productService=u;this.viewsService=p;this.editorService=s.createScoped(i,this._store),this.windowId=e.vscodeWindowId,this.updateTitleIncludesFocusedView(),this.registerListeners()}static NLS_USER_IS_ADMIN=rt?h("userIsAdmin","[Administrator]"):h("userIsSudo","[Superuser]");static NLS_EXTENSION_HOST=h("devExtensionWindowTitlePrefix","[Extension Development Host]");static TITLE_DIRTY="\u25CF ";properties={isPure:!0,isAdmin:!1,prefix:void 0};variables=new Map;activeEditorListeners=this._register(new W);titleUpdater=this._register(new Et(()=>this.doUpdateTitle(),0));onDidChangeEmitter=new T;onDidChange=this.onDidChangeEmitter.event;get value(){return this.title??""}get workspaceName(){return this.labelService.getWorkspaceLabel(this.contextService.getWorkspace())}get fileName(){let e=this.editorService.activeEditor;if(!e)return;let i=e.getTitle(0);return`${e?.isDirty()&&!e.isSaving()?Ja.TITLE_DIRTY:""}${i}`}title;titleIncludesFocusedView=!1;editorService;windowId;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationChanged(e))),this._register(this.editorService.onDidActiveEditorChange(()=>this.onActiveEditorChange())),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.titleUpdater.schedule())),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.titleUpdater.schedule())),this._register(this.contextService.onDidChangeWorkspaceName(()=>this.titleUpdater.schedule())),this._register(this.labelService.onDidChangeFormatters(()=>this.titleUpdater.schedule())),this._register(this.userDataProfileService.onDidChangeCurrentProfile(()=>this.titleUpdater.schedule())),this._register(this.viewsService.onDidChangeFocusedView(()=>{this.titleIncludesFocusedView&&this.titleUpdater.schedule()})),this._register(this.contextKeyService.onDidChangeContext(e=>{e.affectsSome(this.variables)&&this.titleUpdater.schedule()}))}onConfigurationChanged(e){e.affectsConfiguration("window.title")&&this.updateTitleIncludesFocusedView(),(e.affectsConfiguration("window.title")||e.affectsConfiguration("window.titleSeparator"))&&this.titleUpdater.schedule()}updateTitleIncludesFocusedView(){let e=this.configurationService.getValue("window.title");this.titleIncludesFocusedView=typeof e=="string"&&e.includes("${focusedView}")}onActiveEditorChange(){this.activeEditorListeners.clear(),this.titleUpdater.schedule();let e=this.editorService.activeEditor;if(e&&(this.activeEditorListeners.add(e.onDidChangeDirty(()=>this.titleUpdater.schedule())),this.activeEditorListeners.add(e.onDidChangeLabel(()=>this.titleUpdater.schedule()))),this.titleIncludesFocusedView){let i=this.editorService.activeTextEditorControl,n=[];XT(i)?n.push(i):s0(i)&&n.push(i.getOriginalEditor(),i.getModifiedEditor());for(let o of n)this.activeEditorListeners.add(o.onDidBlurEditorText(()=>this.titleUpdater.schedule())),this.activeEditorListeners.add(o.onDidFocusEditorText(()=>this.titleUpdater.schedule()))}}doUpdateTitle(){let e=this.getFullWindowTitle();if(e!==this.title){let i=e;Q7(i)||(i=this.productService.nameLong);let n=Ma(this.windowId,!0).window;!n.document.title&&be&&i===this.productService.nameLong&&(n.document.title=`${this.productService.nameLong} ${Ja.TITLE_DIRTY}`),n.document.title=i,this.title=e,this.onDidChangeEmitter.fire()}}getFullWindowTitle(){let{prefix:e,suffix:i}=this.getTitleDecorations(),n=this.getWindowTitle()||this.productService.nameLong;return e&&(n=`${e} ${n}`),i&&(n=`${n} ${i}`),n.replace(/[^\S ]/g," ")}getTitleDecorations(){let e,i;return this.properties.prefix&&(e=this.properties.prefix),this.environmentService.isExtensionDevelopment&&(e=e?`${Ja.NLS_EXTENSION_HOST} - ${e}`:Ja.NLS_EXTENSION_HOST),this.properties.isAdmin&&(i=Ja.NLS_USER_IS_ADMIN),{prefix:e,suffix:i}}updateProperties(e){let i=typeof e.isAdmin=="boolean"?e.isAdmin:this.properties.isAdmin,n=typeof e.isPure=="boolean"?e.isPure:this.properties.isPure,o=typeof e.prefix=="string"?e.prefix:this.properties.prefix;(i!==this.properties.isAdmin||n!==this.properties.isPure||o!==this.properties.prefix)&&(this.properties.isAdmin=i,this.properties.isPure=n,this.properties.prefix=o,this.titleUpdater.schedule())}registerVariables(e){let i=!1;for(let{name:n,contextKey:o}of e)this.variables.has(o)||(this.variables.set(o,n),i=!0);i&&this.titleUpdater.schedule()}getWindowTitle(){let e=this.editorService.activeEditor,i=this.contextService.getWorkspace(),n;i.configuration?n=i.configuration:i.folders.length&&(n=i.folders[0].uri);let o=Ui.getOriginalUri(e,{supportSideBySide:1}),s=o?er(o):void 0;s?.path==="."&&(s=void 0);let a;this.contextService.getWorkbenchState()===2?a=i.folders[0]:o&&(a=this.contextService.getWorkspaceFolder(o)??void 0);let l;if(this.environmentService.remoteAuthority&&!wt)l=this.labelService.getHostLabel(he.vscodeRemote,this.environmentService.remoteAuthority);else{let z=k4(i);z&&(l=this.labelService.getHostLabel(z.scheme,z.authority))}let d=e?e.getTitle(0):"",c=e?e.getTitle(1):d,u=e?e.getTitle(2):c,p=s?Tr(s):"",m=s?this.labelService.getUriLabel(s,{relative:!0}):"",g=s?this.labelService.getUriLabel(s):"",f=this.labelService.getWorkspaceLabel(i),b=this.labelService.getWorkspaceLabel(i,{verbose:0}),y=n?this.labelService.getUriLabel(n):"",I=a?a.name:"",E=a?this.labelService.getUriLabel(a.uri):"",S=e?.isDirty()&&!e.isSaving()?Ja.TITLE_DIRTY:"",w=this.productService.nameLong,D=this.userDataProfileService.currentProfile.isDefault?"":this.userDataProfileService.currentProfile.name,k=this.viewsService.getFocusedViewName(),R={};for(let[z,Z]of this.variables)R[Z]=this.contextKeyService.getContextKeyValue(z)??"";let A=this.configurationService.getValue("window.title");typeof A!="string"&&(A=Iue);let H=this.configurationService.getValue("window.titleSeparator");return typeof H!="string"&&(H=Cue),aZ(A,{...R,activeEditorShort:d,activeEditorLong:u,activeEditorMedium:c,activeFolderShort:p,activeFolderMedium:m,activeFolderLong:g,rootName:f,rootPath:y,rootNameShort:b,folderName:I,folderPath:E,dirty:S,appName:w,remoteName:l,profileName:D,focusedView:k,separator:{label:H}})}isCustomTitleFormat(){let e=this.configurationService.inspect("window.title"),i=this.configurationService.inspect("window.titleSeparator");return e.value!==e.defaultValue||i.value!==i.defaultValue}};Ja=_([v(2,de),v(3,ke),v(4,kt),v(5,Ml),v(6,Xt),v(7,qo),v(8,Qa),v(9,Qn),v(10,va)],Ja);var JI=class{_disposables=new W;_onDidChangeVisibility=new T;onDidChangeVisibility=this._onDidChangeVisibility.event;element=document.createElement("div");constructor(t,e,i,n){this.element.classList.add("command-center");let o=i.createInstance(pu,this.element,ee.CommandCenter,{contextMenu:ee.TitleBarContext,hiddenItemStrategy:-1,toolbarOptions:{primaryGroup:()=>!0},telemetrySource:"commandCenter",actionViewItemProvider:(s,a)=>s instanceof jn&&s.item.submenu===ee.CommandCenterCenter?i.createInstance(ib,s,t,{...a,hoverDelegate:e}):ja(i,s,{...a,hoverDelegate:e})});this._disposables.add(O.filter(n.onShow,()=>Yw(this.element),this._disposables)(this._setVisibility.bind(this,!1))),this._disposables.add(O.filter(n.onHide,()=>Yw(this.element),this._disposables)(this._setVisibility.bind(this,!0))),this._disposables.add(o)}_setVisibility(t){this.element.classList.toggle("hide",!t),this._onDidChangeVisibility.fire()}dispose(){this._disposables.dispose()}};JI=_([v(2,ae),v(3,$o)],JI);var ib=class extends zn{constructor(e,i,n,o,s,a,l){super(void 0,e.actions.find(d=>d.id==="workbench.action.quickOpenWithModes")??e.actions[0],n);this._submenu=e;this._windowTitle=i;this._hoverService=o;this._keybindingService=s;this._instaService=a;this._editorGroupService=l;this._hoverDelegate=n.hoverDelegate??zt("mouse")}static _quickOpenCommandId="workbench.action.quickOpenWithModes";_hoverDelegate;render(e){super.render(e),e.classList.add("command-center-center"),e.classList.toggle("multiple",this._submenu.actions.length>1);let i=this._store.add(this._hoverService.setupManagedHover(this._hoverDelegate,e,this.getTooltip()));this._store.add(this._windowTitle.onDidChange(()=>{i.update(this.getTooltip())}));let n=[];for(let o of this._submenu.actions)o instanceof mn?n.push(o.actions):n.push([o]);for(let o=0;o<n.length;o++){let s=n[o],a=this._instaService.createInstance(pr,e,{hiddenItemStrategy:-1,telemetrySource:"commandCenterCenter",actionViewItemProvider:(l,d)=>{if(d={...d,hoverDelegate:this._hoverDelegate},l.id!==ib._quickOpenCommandId)return ja(this._instaService,l,d);let c=this;return this._instaService.createInstance(class extends zn{constructor(){super(void 0,l,d)}render(p){super.render(p),p.classList.toggle("command-center-quick-pick"),p.role="button";let m=this.action,g=document.createElement("span");g.ariaHidden="true",g.className=m.class??"",g.classList.add("search-icon");let f=this._getLabel(),b=document.createElement("span");b.classList.add("search-label"),b.innerText=f,Tn(p,g,b);let y=this._store.add(c._hoverService.setupManagedHover(c._hoverDelegate,p,this.getTooltip()));this._store.add(c._windowTitle.onDidChange(()=>{y.update(this.getTooltip()),b.innerText=this._getLabel()})),this._store.add(c._editorGroupService.onDidChangeEditorPartOptions(({newPartOptions:I,oldPartOptions:E})=>{I.showTabs!==E.showTabs&&(y.update(this.getTooltip()),b.innerText=this._getLabel())}))}getTooltip(){return c.getTooltip()}_getLabel(){let{prefix:p,suffix:m}=c._windowTitle.getTitleDecorations(),g=c._windowTitle.workspaceName;return c._windowTitle.isCustomTitleFormat()?g=c._windowTitle.getWindowTitle():c._editorGroupService.partOptions.showTabs==="none"&&(g=c._windowTitle.fileName??g),g||(g=h("label.dfl","Search")),p&&(g=h("label1","{0} {1}",p,g)),m&&(g=h("label2","{0} {1}",g,m)),g.replaceAll(/\r\n|\r|\n/g,"\u23CE")}})}});if(a.setActions(s),this._store.add(a),o<n.length-1){let l=Md(B.circleSmallFilled);l.style.padding="0 12px",l.style.height="100%",l.style.opacity="0.5",e.appendChild(l)}}}getTooltip(){let e=this._keybindingService.lookupKeybinding(this.action.id)?.getLabel();return e?h("title","Search {0} ({1}) \u2014 {2}",this._windowTitle.workspaceName,e,this._windowTitle.value):h("title2","Search {0} \u2014 {1}",this._windowTitle.workspaceName,this._windowTitle.value)}};ib=_([v(3,qi),v(4,at),v(5,ae),v(6,di)],ib);Ct.appendMenuItem(ee.CommandCenter,{submenu:ee.CommandCenterCenter,title:h("title3","Command Center"),icon:B.shield,order:101});var Re;(ht=>(ht.editorSimpleInput=new ie("editorSimpleInput",!1,!0),ht.editorTextFocus=new ie("editorTextFocus",!1,h("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),ht.focus=new ie("editorFocus",!1,h("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),ht.textInputFocus=new ie("textInputFocus",!1,h("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),ht.readOnly=new ie("editorReadonly",!1,h("editorReadonly","Whether the editor is read-only")),ht.inDiffEditor=new ie("inDiffEditor",!1,h("inDiffEditor","Whether the context is a diff editor")),ht.isEmbeddedDiffEditor=new ie("isEmbeddedDiffEditor",!1,h("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),ht.multiDiffEditorAllCollapsed=new ie("multiDiffEditorAllCollapsed",void 0,h("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),ht.hasChanges=new ie("diffEditorHasChanges",!1,h("diffEditorHasChanges","Whether the diff editor has changes")),ht.comparingMovedCode=new ie("comparingMovedCode",!1,h("comparingMovedCode","Whether a moved code block is selected for comparison")),ht.accessibleDiffViewerVisible=new ie("accessibleDiffViewerVisible",!1,h("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),ht.diffEditorRenderSideBySideInlineBreakpointReached=new ie("diffEditorRenderSideBySideInlineBreakpointReached",!1,h("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),ht.diffEditorInlineMode=new ie("diffEditorInlineMode",!1,h("diffEditorInlineMode","Whether inline mode is active")),ht.diffEditorOriginalWritable=new ie("diffEditorOriginalWritable",!1,h("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),ht.diffEditorModifiedWritable=new ie("diffEditorModifiedWritable",!1,h("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),ht.diffEditorOriginalUri=new ie("diffEditorOriginalUri","",h("diffEditorOriginalUri","The uri of the original document")),ht.diffEditorModifiedUri=new ie("diffEditorModifiedUri","",h("diffEditorModifiedUri","The uri of the modified document")),ht.columnSelection=new ie("editorColumnSelection",!1,h("editorColumnSelection","Whether `editor.columnSelection` is enabled")),ht.writable=ht.readOnly.toNegated(),ht.hasNonEmptySelection=new ie("editorHasSelection",!1,h("editorHasSelection","Whether the editor has text selected")),ht.hasOnlyEmptySelection=ht.hasNonEmptySelection.toNegated(),ht.hasMultipleSelections=new ie("editorHasMultipleSelections",!1,h("editorHasMultipleSelections","Whether the editor has multiple selections")),ht.hasSingleSelection=ht.hasMultipleSelections.toNegated(),ht.tabMovesFocus=new ie("editorTabMovesFocus",!1,h("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),ht.tabDoesNotMoveFocus=ht.tabMovesFocus.toNegated(),ht.isInEmbeddedEditor=new ie("isInEmbeddedEditor",!1,!0),ht.canUndo=new ie("canUndo",!1,!0),ht.canRedo=new ie("canRedo",!1,!0),ht.hoverVisible=new ie("editorHoverVisible",!1,h("editorHoverVisible","Whether the editor hover is visible")),ht.hoverFocused=new ie("editorHoverFocused",!1,h("editorHoverFocused","Whether the editor hover is focused")),ht.stickyScrollFocused=new ie("stickyScrollFocused",!1,h("stickyScrollFocused","Whether the sticky scroll is focused")),ht.stickyScrollVisible=new ie("stickyScrollVisible",!1,h("stickyScrollVisible","Whether the sticky scroll is visible")),ht.standaloneColorPickerVisible=new ie("standaloneColorPickerVisible",!1,h("standaloneColorPickerVisible","Whether the standalone color picker is visible")),ht.standaloneColorPickerFocused=new ie("standaloneColorPickerFocused",!1,h("standaloneColorPickerFocused","Whether the standalone color picker is focused")),ht.inCompositeEditor=new ie("inCompositeEditor",void 0,h("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),ht.notInCompositeEditor=ht.inCompositeEditor.toNegated(),ht.languageId=new ie("editorLangId","",h("editorLangId","The language identifier of the editor")),ht.hasCompletionItemProvider=new ie("editorHasCompletionItemProvider",!1,h("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),ht.hasCodeActionsProvider=new ie("editorHasCodeActionsProvider",!1,h("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),ht.hasCodeLensProvider=new ie("editorHasCodeLensProvider",!1,h("editorHasCodeLensProvider","Whether the editor has a code lens provider")),ht.hasDefinitionProvider=new ie("editorHasDefinitionProvider",!1,h("editorHasDefinitionProvider","Whether the editor has a definition provider")),ht.hasDeclarationProvider=new ie("editorHasDeclarationProvider",!1,h("editorHasDeclarationProvider","Whether the editor has a declaration provider")),ht.hasImplementationProvider=new ie("editorHasImplementationProvider",!1,h("editorHasImplementationProvider","Whether the editor has an implementation provider")),ht.hasTypeDefinitionProvider=new ie("editorHasTypeDefinitionProvider",!1,h("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),ht.hasHoverProvider=new ie("editorHasHoverProvider",!1,h("editorHasHoverProvider","Whether the editor has a hover provider")),ht.hasDocumentHighlightProvider=new ie("editorHasDocumentHighlightProvider",!1,h("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),ht.hasDocumentSymbolProvider=new ie("editorHasDocumentSymbolProvider",!1,h("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),ht.hasReferenceProvider=new ie("editorHasReferenceProvider",!1,h("editorHasReferenceProvider","Whether the editor has a reference provider")),ht.hasRenameProvider=new ie("editorHasRenameProvider",!1,h("editorHasRenameProvider","Whether the editor has a rename provider")),ht.hasSignatureHelpProvider=new ie("editorHasSignatureHelpProvider",!1,h("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),ht.hasInlayHintsProvider=new ie("editorHasInlayHintsProvider",!1,h("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),ht.hasDocumentFormattingProvider=new ie("editorHasDocumentFormattingProvider",!1,h("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),ht.hasDocumentSelectionFormattingProvider=new ie("editorHasDocumentSelectionFormattingProvider",!1,h("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),ht.hasMultipleDocumentFormattingProvider=new ie("editorHasMultipleDocumentFormattingProvider",!1,h("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),ht.hasMultipleDocumentSelectionFormattingProvider=new ie("editorHasMultipleDocumentSelectionFormattingProvider",!1,h("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))))(Re||={});function $4(r){let t=r;return Array.isArray(t.items)}function iee(r){let t=r;return!!t.picks&&t.additionalPicks instanceof Promise}var U0=class extends L{constructor(e,i){super();this.prefix=e;this.options=i}provide(e,i,n){let o=new W;e.canAcceptInBackground=!!this.options?.canAcceptInBackground,e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;let s,a=o.add(new mt),l=async()=>{let c=a.value=new W;s?.dispose(!0),e.busy=!1,s=new Cn(i);let u=s.token,p=e.value.substring(this.prefix.length);this.options?.shouldSkipTrimPickFilter||(p=p.trim());let m=this._getPicks(p,c,u,n),g=(b,y)=>{let I,E;if($4(b)?(I=b.items,E=b.active):I=b,I.length===0){if(y)return!1;(p.length>0||e.hideInput)&&this.options?.noResultsPick&&(yg(this.options.noResultsPick)?I=[this.options.noResultsPick(p)]:I=[this.options.noResultsPick])}return e.items=I,E&&(e.activeItems=[E]),!0},f=async b=>{let y=!1,I=!1;await Promise.all([(async()=>{typeof b.mergeDelay=="number"&&(await Sn(b.mergeDelay),u.isCancellationRequested)||I||(y=g(b.picks,!0))})(),(async()=>{e.busy=!0;try{let E=await b.additionalPicks;if(u.isCancellationRequested)return;let S,w;$4(b.picks)?(S=b.picks.items,w=b.picks.active):S=b.picks;let D,k;if($4(E)?(D=E.items,k=E.active):D=E,D.length>0||!y){let R;if(!w&&!k){let A=e.activeItems[0];A&&S.indexOf(A)!==-1&&(R=A)}g({items:[...S,...D],active:w||k||R})}}finally{u.isCancellationRequested||(e.busy=!1),I=!0}})()])};if(m!==null)if(iee(m))await f(m);else if(!(m instanceof Promise))g(m);else{e.busy=!0;try{let b=await m;if(u.isCancellationRequested)return;iee(b)?await f(b):g(b)}finally{u.isCancellationRequested||(e.busy=!1)}}};o.add(e.onDidChangeValue(()=>l())),l(),o.add(e.onDidAccept(c=>{if(n?.handleAccept){c.inBackground||e.hide(),n.handleAccept?.(e.activeItems[0]);return}let[u]=e.selectedItems;typeof u?.accept=="function"&&(c.inBackground||e.hide(),u.accept(e.keyMods,c))}));let d=async(c,u)=>{if(typeof u.trigger!="function")return;let p=u.buttons?.indexOf(c)??-1;if(p>=0){let m=u.trigger(p,e.keyMods),g=typeof m=="number"?m:await m;if(i.isCancellationRequested)return;switch(g){case 0:break;case 1:e.hide();break;case 2:l();break;case 3:{let f=e.items.indexOf(u);if(f!==-1){let b=e.items.slice(),y=b.splice(f,1),I=e.activeItems.filter(S=>S!==y[0]),E=e.keepScrollPosition;e.keepScrollPosition=!0,e.items=b,I&&(e.activeItems=I),e.keepScrollPosition=E}break}}}};return o.add(e.onDidTriggerItemButton(({button:c,item:u})=>d(c,u))),o.add(e.onDidTriggerSeparatorButton(({button:c,separator:u})=>d(c,u))),o}};var nb=class extends U0{constructor(e,i,n,o,s){super(e,{canAcceptInBackground:!0,noResultsPick:{label:h("noViewResults","No matching editors"),groupId:-1}});this.editorGroupService=i;this.editorService=n;this.modelService=o;this.languageService=s}pickState=new class{scorerCache=Object.create(null);isQuickNavigating=void 0;reset(e){e||(this.scorerCache=Object.create(null)),this.isQuickNavigating=e}};provide(e,i){return this.pickState.reset(!!e.quickNavigate),super.provide(e,i)}_getPicks(e){let i=BQ(e),n=this.doGetEditorPickItems().filter(s=>{if(!i.normalized)return!0;let a=tM(s,i,!0,a5,this.pickState.scorerCache);return a.score?(s.highlights={label:a.labelMatch,description:a.descriptionMatch},!0):!1});if(i.normalized){let s=this.editorGroupService.getGroups(2).map(a=>a.id);n.sort((a,l)=>a.groupId!==l.groupId?s.indexOf(a.groupId)-s.indexOf(l.groupId):FQ(a,l,i,!0,a5,this.pickState.scorerCache))}let o=[];if(this.editorGroupService.count>1){let s;for(let a of n){if(typeof s!="number"||s!==a.groupId){let l=this.editorGroupService.getGroup(a.groupId);l&&o.push({type:"separator",label:l.label}),s=a.groupId}o.push(a)}}else o.push(...n);return o}doGetEditorPickItems(){let e=this.doGetEditors(),i=new Map;for(let{groupId:n}of e)if(!i.has(n)){let o=this.editorGroupService.getGroup(n);o&&i.set(n,o.ariaLabel)}return this.doGetEditors().map(({editor:n,groupId:o})=>{let s=Ui.getOriginalUri(n,{supportSideBySide:1}),a=n.isDirty()&&!n.isSaving(),l=n.getDescription(),d=l?`${n.getName()} ${l}`:n.getName();return{groupId:o,resource:s,label:n.getName(),ariaLabel:i.size>1?a?h("entryAriaLabelWithGroupDirty","{0}, unsaved changes, {1}",d,i.get(o)):h("entryAriaLabelWithGroup","{0}, {1}",d,i.get(o)):a?h("entryAriaLabelDirty","{0}, unsaved changes",d):d,description:l,iconClasses:Bm(this.modelService,this.languageService,s,void 0,n.getIcon()).concat(n.getLabelExtraClasses()),italic:!this.editorGroupService.getGroup(o)?.isPinned(n),buttons:[{iconClass:a?"dirty-editor "+ye.asClassName(B.closeDirty):ye.asClassName(B.close),tooltip:h("closeEditor","Close Editor"),alwaysVisible:a}],trigger:async()=>{let c=this.editorGroupService.getGroup(o);return c&&(await c.closeEditor(n,{preserveFocus:!0}),!c.contains(n))?3:0},accept:(c,u)=>this.editorGroupService.getGroup(o)?.openEditor(n,{preserveFocus:u.inBackground})}})}};nb=_([v(1,di),v(2,kt),v(3,Rr),v(4,Hn)],nb);var Um=class extends nb{static PREFIX="edt active ";constructor(t,e,i,n){super(Um.PREFIX,t,e,i,n)}doGetEditors(){let t=this.editorGroupService.activeGroup;return t.getEditors(0).map(e=>({editor:e,groupId:t.id}))}};Um=_([v(0,di),v(1,kt),v(2,Rr),v(3,Hn)],Um);var ob=class extends nb{static PREFIX="edt ";constructor(t,e,i,n){super(ob.PREFIX,t,e,i,n)}doGetEditors(){let t=[];for(let e of this.editorGroupService.getGroups(2))for(let i of e.getEditors(1))t.push({editor:i,groupId:e.id});return t}};ob=_([v(0,di),v(1,kt),v(2,Rr),v(3,Hn)],ob);var rb=class extends nb{static PREFIX="edt mru ";constructor(t,e,i,n){super(rb.PREFIX,t,e,i,n)}doGetEditors(){let t=[];for(let e of this.editorService.getEditors(0))t.push(e);return t}};rb=_([v(0,di),v(1,kt),v(2,Rr),v(3,Hn)],rb);var Hm=class r extends fI{constructor(e,i,n,o,s){super(e,n,o,s);this.group=i}onDidChangeSizeConstraints=O.None;_onDidChangeControl=this._register(new T);onDidChangeControl=this._onDidChangeControl.event;static EDITOR_MEMENTOS=new Map;get minimumWidth(){return km.width}get maximumWidth(){return L5.width}get minimumHeight(){return km.height}get maximumHeight(){return L5.height}_input;get input(){return this._input}_options;get options(){return this._options}get window(){return Ma(this.group.windowId,!0).window}get scopedContextKeyService(){}create(e){super.create(e),this.createEditor(e)}async setInput(e,i,n,o){this._input=e,this._options=i}clearInput(){this._input=void 0,this._options=void 0}setOptions(e){this._options=e}setVisible(e){super.setVisible(e),this.setEditorVisible(e)}setEditorVisible(e){}setBoundarySashes(e){}getEditorMemento(e,i,n,o=10){let s=`${this.getId()}${n}`,a=r.EDITOR_MEMENTOS.get(s);return a||(a=this._register(new Y4(this.getId(),n,this.getMemento(1,1),o,e,i)),r.EDITOR_MEMENTOS.set(s,a)),a}getViewState(){}saveState(){for(let[,e]of r.EDITOR_MEMENTOS)e.id===this.getId()&&e.saveState();super.saveState()}dispose(){this._input=void 0,this._options=void 0,super.dispose()}},Y4=class r extends L{constructor(e,i,n,o,s,a){super();this.id=e;this.key=i;this.memento=n;this.limit=o;this.editorGroupService=s;this.configurationService=a;this.updateConfiguration(void 0),this.registerListeners()}static SHARED_EDITOR_STATE=-1;cache;cleanedUp=!1;editorDisposables;shareEditorState=!1;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.updateConfiguration(e)))}updateConfiguration(e){(!e||e.affectsConfiguration(void 0,"workbench.editor.sharedViewState"))&&(this.shareEditorState=this.configurationService.getValue(void 0,"workbench.editor.sharedViewState")===!0)}saveEditorState(e,i,n){let o=this.doGetResource(i);if(!o||!e)return;let s=this.doLoad(),a=s.get(o.toString());a||(a=Object.create(null),s.set(o.toString(),a)),a[e.id]=n,this.shareEditorState&&(a[r.SHARED_EDITOR_STATE]=n),Do(i)&&this.clearEditorStateOnDispose(o,i)}loadEditorState(e,i){let n=this.doGetResource(i);if(!n||!e)return;let s=this.doLoad().get(n.toString());if(s){let a=s[e.id];if(a)return a;if(this.shareEditorState)return s[r.SHARED_EDITOR_STATE]}}clearEditorState(e,i){Do(e)&&this.editorDisposables?.delete(e);let n=this.doGetResource(e);if(n){let o=this.doLoad();if(i){let s=o.get(n.toString());s&&(delete s[i.id],Xl(s)&&o.delete(n.toString()))}else o.delete(n.toString())}}clearEditorStateOnDispose(e,i){this.editorDisposables||(this.editorDisposables=new Map),this.editorDisposables.has(i)||this.editorDisposables.set(i,O.once(i.onWillDispose)(()=>{this.clearEditorState(e),this.editorDisposables?.delete(i)}))}moveEditorState(e,i,n){let o=this.doLoad(),s=[...o.keys()];for(let a of s){let l=q.parse(a);if(!n.isEqualOrParent(l,e))continue;let d;if(Wn(e,l))d=i;else{let u=dG(l.path,e.path);d=Ot(i,l.path.substr(u+e.path.length+1))}let c=o.get(a,0);c&&(o.delete(a),o.set(d.toString(),c))}}doGetResource(e){return Do(e)?e.resource:e}doLoad(){if(!this.cache){this.cache=new $s(this.limit);let e=this.memento[this.key];Array.isArray(e)&&this.cache.fromJSON(e)}return this.cache}saveState(){let e=this.doLoad();this.cleanedUp||(this.cleanUp(),this.cleanedUp=!0),this.memento[this.key]=e.toJSON()}cleanUp(){let e=this.doLoad(),i=[...e.entries()];for(let[n,o]of i)for(let s of Object.keys(o)){let a=Number(s);a===r.SHARED_EDITOR_STATE&&this.shareEditorState||this.editorGroupService.getGroup(a)||(delete o[a],Xl(o)&&e.delete(n))}}};var nee=class r{constructor(t,e,i){this.ctor=t;this.typeId=e;this.name=i}static instantiatedEditorPanes=new Set;static didInstantiateEditorPane(t){return r.instantiatedEditorPanes.has(t)}static _onWillInstantiateEditorPane=new T;static onWillInstantiateEditorPane=r._onWillInstantiateEditorPane.event;static create(t,e,i){return new r(t,e,i)}instantiate(t,e){r._onWillInstantiateEditorPane.fire({typeId:this.typeId});let i=t.createInstance(this.ctor,e);return r.instantiatedEditorPanes.add(this.typeId),i}describes(t){return t.getId()===this.typeId}},Z4=class{mapEditorPanesToEditors=new Map;registerEditorPane(t,e){return this.mapEditorPanesToEditors.set(t,e),te(()=>{this.mapEditorPanesToEditors.delete(t)})}getEditorPane(t){let e=this.findEditorPaneDescriptors(t);if(e.length!==0)return e.length===1?e[0]:t.prefersEditorPane(e)}findEditorPaneDescriptors(t,e){let i=[];for(let n of this.mapEditorPanesToEditors.keys()){let o=this.mapEditorPanesToEditors.get(n)||[];for(let s of o){let a=s.ctor;if(!e&&t.constructor===a){i.push(n);break}else if(e&&t instanceof a){i.push(n);break}}}return!e&&i.length===0?this.findEditorPaneDescriptors(t,!0):i}getEditorPaneByType(t){return Lt.find(this.mapEditorPanesToEditors.keys(),e=>e.typeId===t)}getEditorPanes(){return Array.from(this.mapEditorPanesToEditors.keys())}getEditors(){let t=[];for(let e of this.mapEditorPanesToEditors.keys()){let i=this.mapEditorPanesToEditors.get(e);i&&t.push(...i.map(n=>n.ctor))}return t}};Ne.add(Ua.EditorPane,new Z4);function oee(r,t){let e=r.get(kt),i=r.get(_r),n=r.get(Va);return new Promise(o=>{let s=[...t],a=e.onDidCloseEditor(async l=>{if(l.context===2)return;let d=Ui.getOriginalUri(l.editor,{supportSideBySide:1}),c=Ui.getOriginalUri(l.editor,{supportSideBySide:2});if(l.context===1){let u=Ui.getOriginalUri(e.activeEditor,{supportSideBySide:1}),p=Ui.getOriginalUri(e.activeEditor,{supportSideBySide:2});i.extUri.isEqual(d,u)&&(d=void 0),i.extUri.isEqual(c,p)&&(c=void 0)}if(s=s.filter(u=>!(i.extUri.isEqual(u,d)||i.extUri.isEqual(u,c)||l.context!==1&&(d?.scheme===he.untitled&&i.extUri.isEqual(u,d.with({scheme:u.scheme}))||c?.scheme===he.untitled&&i.extUri.isEqual(u,c.with({scheme:u.scheme}))))),s.length===0){let u=t.filter(p=>n.isDirty(p));return u.length>0&&await Vi.settled(u.map(async p=>await new Promise(m=>{if(!n.isDirty(p))return m();let g=n.onDidChangeDirty(f=>{if(!f.isDirty()&&i.extUri.isEqual(p,f.resource))return g.dispose(),m()})}))),a.dispose(),o()}})})}function z0(r,t,e,i){let n=r.getAriaLabel();return e&&!e.isPinned(r)&&(n=h("preview","{0}, preview",n)),e?.isSticky(t??r)&&(n=h("pinned","{0}, pinned",n)),e&&typeof i=="number"&&i>1&&(n=`${n}, ${e.ariaLabel}`),n}var zm=class extends Hm{constructor(e,i,n,o,s,a,l,d,c,u){super(e,i,o,d,a);this.instantiationService=s;this.textResourceConfigurationService=l;this.editorService=c;this.editorGroupService=u;this.viewState=this.getEditorMemento(u,l,n,100)}viewState;groupListener=this._register(new mt);editorViewStateDisposables;setEditorVisible(e){this.groupListener.value=this.group.onWillCloseEditor(i=>this.onWillCloseEditor(i)),super.setEditorVisible(e)}onWillCloseEditor(e){let i=e.editor;i===this.input&&this.updateEditorViewState(i)}clearInput(){this.updateEditorViewState(this.input),super.clearInput()}saveState(){this.updateEditorViewState(this.input),super.saveState()}updateEditorViewState(e){if(!e||!this.tracksEditorViewState(e))return;let i=this.toEditorViewStateResource(e);i&&(this.tracksDisposedEditorViewState()||(this.editorViewStateDisposables||(this.editorViewStateDisposables=new Map),this.editorViewStateDisposables.has(e)||this.editorViewStateDisposables.set(e,O.once(e.onWillDispose)(()=>{this.clearEditorViewState(i,this.group),this.editorViewStateDisposables?.delete(e)}))),e.isDisposed()&&!this.tracksDisposedEditorViewState()||!this.shouldRestoreEditorViewState(e)&&!this.group.contains(e)?this.clearEditorViewState(i,this.group):e.isDisposed()||this.saveEditorViewState(i))}shouldRestoreEditorViewState(e,i){return i?.newInGroup?this.textResourceConfigurationService.getValue(Ui.getOriginalUri(e,{supportSideBySide:1}),"workbench.editor.restoreViewState")!==!1:!0}getViewState(){let e=this.input;if(!e||!this.tracksEditorViewState(e))return;let i=this.toEditorViewStateResource(e);if(i)return this.computeEditorViewState(i)}saveEditorViewState(e){let i=this.computeEditorViewState(e);i&&this.viewState.saveEditorState(this.group,e,i)}loadEditorViewState(e,i){if(!e||!this.tracksEditorViewState(e)||!this.shouldRestoreEditorViewState(e,i))return;let n=this.toEditorViewStateResource(e);if(n)return this.viewState.loadEditorState(this.group,n)}moveEditorViewState(e,i,n){return this.viewState.moveEditorState(e,i,n)}clearEditorViewState(e,i){this.viewState.clearEditorState(e,i)}dispose(){if(super.dispose(),this.editorViewStateDisposables){for(let[,e]of this.editorViewStateDisposables)e.dispose();this.editorViewStateDisposables=void 0}}tracksDisposedEditorViewState(){return!1}};zm=_([v(3,qt),v(4,ae),v(5,tt),v(6,_s),v(7,Ze),v(8,kt),v(9,di)],zm);function wue(r){let t=r;return typeof t?.primary=="object"&&typeof t.secondary=="object"}var Zd=class extends zm{constructor(e,i,n,o,s,a,l,d,c){super(Zd.ID,e,Zd.VIEW_STATE_PREFERENCE_KEY,i,n,s,l,o,d,c);this.configurationService=a;this.registerListeners()}static ID=AZ;static SIDE_BY_SIDE_LAYOUT_SETTING="workbench.editor.splitInGroupLayout";static VIEW_STATE_PREFERENCE_KEY="sideBySideEditorViewState";get minimumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.minimumWidth:0}get maximumPrimaryWidth(){return this.primaryEditorPane?this.primaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.minimumHeight:0}get maximumPrimaryHeight(){return this.primaryEditorPane?this.primaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}get minimumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumWidth:0}get maximumSecondaryWidth(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumWidth:Number.POSITIVE_INFINITY}get minimumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.minimumHeight:0}get maximumSecondaryHeight(){return this.secondaryEditorPane?this.secondaryEditorPane.maximumHeight:Number.POSITIVE_INFINITY}set minimumWidth(e){}set maximumWidth(e){}set minimumHeight(e){}set maximumHeight(e){}get minimumWidth(){return this.minimumPrimaryWidth+this.minimumSecondaryWidth}get maximumWidth(){return this.maximumPrimaryWidth+this.maximumSecondaryWidth}get minimumHeight(){return this.minimumPrimaryHeight+this.minimumSecondaryHeight}get maximumHeight(){return this.maximumPrimaryHeight+this.maximumSecondaryHeight}_boundarySashes;onDidCreateEditors=this._register(new T);_onDidChangeSizeConstraints=this._register(new Er);onDidChangeSizeConstraints=O.any(this.onDidCreateEditors.event,this._onDidChangeSizeConstraints.event);_onDidChangeSelection=this._register(new T);onDidChangeSelection=this._onDidChangeSelection.event;primaryEditorPane=void 0;secondaryEditorPane=void 0;primaryEditorContainer;secondaryEditorContainer;splitview;splitviewDisposables=this._register(new W);editorDisposables=this._register(new W);orientation=this.configurationService.getValue(Zd.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1;dimension=new dt(0,0);lastFocusedSide=void 0;registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e)))}onConfigurationUpdated(e){e.affectsConfiguration(Zd.SIDE_BY_SIDE_LAYOUT_SETTING)&&(this.orientation=this.configurationService.getValue(Zd.SIDE_BY_SIDE_LAYOUT_SETTING)==="vertical"?0:1,this.splitview&&this.recreateSplitview())}recreateSplitview(){let e=Ue(this.getContainer()),i=this.getSplitViewRatio();this.splitview&&(this.splitview.el.remove(),this.splitviewDisposables.clear()),this.createSplitView(e,i),this.layout(this.dimension)}getSplitViewRatio(){let e;if(this.splitview){let i=this.splitview.getViewSize(0),n=this.splitview.getViewSize(1);if(Math.abs(i-n)>1){let o=this.splitview.orientation===1?this.dimension.width:this.dimension.height;e=i/o}}return e}createEditor(e){e.classList.add("side-by-side-editor"),this.secondaryEditorContainer=re(".side-by-side-editor-container.editor-instance"),this.primaryEditorContainer=re(".side-by-side-editor-container.editor-instance"),this.createSplitView(e)}createSplitView(e,i){this.splitview=this.splitviewDisposables.add(new El(e,{orientation:this.orientation})),this.splitviewDisposables.add(this.splitview.onDidSashReset(()=>this.splitview?.distributeViewSizes())),this.orientation===1?this.splitview.orthogonalEndSash=this._boundarySashes?.bottom:(this.splitview.orthogonalStartSash=this._boundarySashes?.left,this.splitview.orthogonalEndSash=this._boundarySashes?.right);let n=lr.Distribute,o=lr.Distribute;if(i){let l=this.splitview.orientation===1?this.dimension.width:this.dimension.height;n=Math.round(l*i),o=l-n,this.splitview.layout(this.orientation===1?this.dimension.width:this.dimension.height)}let s=Ue(this.secondaryEditorContainer);this.splitview.addView({element:s,layout:l=>this.layoutPane(this.secondaryEditorPane,l),minimumSize:this.orientation===1?km.width:km.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:O.None},n);let a=Ue(this.primaryEditorContainer);this.splitview.addView({element:a,layout:l=>this.layoutPane(this.primaryEditorPane,l),minimumSize:this.orientation===1?km.width:km.height,maximumSize:Number.POSITIVE_INFINITY,onDidChange:O.None},o),this.updateStyles()}getTitle(){return this.input?this.input.getName():h("sideBySideEditor","Side by Side Editor")}async setInput(e,i,n,o){let s=this.input;await super.setInput(e,i,n,o),(!s||!e.matches(s))&&(s&&this.disposeEditors(),this.createEditors(e));let{primary:a,secondary:l,viewState:d}=this.loadViewState(e,i,n);if(this.lastFocusedSide=d?.focus,typeof d?.ratio=="number"&&this.splitview){let c=this.splitview.orientation===1?this.dimension.width:this.dimension.height;this.splitview.resizeView(0,Math.round(c*d.ratio))}else this.splitview?.distributeViewSizes();await Promise.all([this.secondaryEditorPane?.setInput(e.secondary,l,n,o),this.primaryEditorPane?.setInput(e.primary,a,n,o)]),typeof i?.target=="number"&&(this.lastFocusedSide=i.target)}loadViewState(e,i,n){let o=wue(i?.viewState)?i?.viewState:this.loadEditorViewState(e,n),s=Object.create(null),a;return i?.target===2?a={...i}:s={...i},s.viewState=o?.primary,o?.secondary&&(a?a.viewState=o?.secondary:a={viewState:o.secondary}),{primary:s,secondary:a,viewState:o}}createEditors(e){this.secondaryEditorPane=this.doCreateEditor(e.secondary,Ue(this.secondaryEditorContainer)),this.primaryEditorPane=this.doCreateEditor(e.primary,Ue(this.primaryEditorContainer)),this.layout(this.dimension),this._onDidChangeSizeConstraints.input=O.any(O.map(this.secondaryEditorPane.onDidChangeSizeConstraints,()=>{}),O.map(this.primaryEditorPane.onDidChangeSizeConstraints,()=>{})),this.onDidCreateEditors.fire(void 0),this.editorDisposables.add(this.primaryEditorPane.onDidFocus(()=>this.onDidFocusChange(1))),this.editorDisposables.add(this.secondaryEditorPane.onDidFocus(()=>this.onDidFocusChange(2)))}doCreateEditor(e,i){let n=Ne.as(Ua.EditorPane).getEditorPane(e);if(!n)throw new Error("No editor pane descriptor for editor found");let o=n.instantiate(this.instantiationService,this.group);return o.create(i),o.setVisible(this.isVisible()),ZH(o)&&this.editorDisposables.add(o.onDidChangeSelection(s=>this._onDidChangeSelection.fire(s))),this.editorDisposables.add(o),o}onDidFocusChange(e){this.lastFocusedSide=e,this._onDidChangeControl.fire()}getSelection(){let e=this.getLastFocusedEditorPane();if(ZH(e)){let i=e.getSelection();if(i)return new X4(i,e===this.primaryEditorPane?1:2)}}setOptions(e){super.setOptions(e),typeof e?.target=="number"&&(this.lastFocusedSide=e.target),this.getLastFocusedEditorPane()?.setOptions(e)}setEditorVisible(e){this.primaryEditorPane?.setVisible(e),this.secondaryEditorPane?.setVisible(e),super.setEditorVisible(e)}clearInput(){super.clearInput(),this.primaryEditorPane?.clearInput(),this.secondaryEditorPane?.clearInput(),this.disposeEditors()}focus(){super.focus(),this.getLastFocusedEditorPane()?.focus()}getLastFocusedEditorPane(){return this.lastFocusedSide===2?this.secondaryEditorPane:this.primaryEditorPane}layout(e){this.dimension=e,Ue(this.splitview).layout(this.orientation===1?e.width:e.height)}setBoundarySashes(e){this._boundarySashes=e,this.splitview&&(this.splitview.orthogonalEndSash=e.bottom)}layoutPane(e,i){e?.layout(this.orientation===1?new dt(i,this.dimension.height):new dt(this.dimension.width,i))}getControl(){return this.getLastFocusedEditorPane()?.getControl()}getPrimaryEditorPane(){return this.primaryEditorPane}getSecondaryEditorPane(){return this.secondaryEditorPane}tracksEditorViewState(e){return e instanceof qn}computeEditorViewState(e){if(!this.input||!Wn(e,this.toEditorViewStateResource(this.input)))return;let i=this.primaryEditorPane?.getViewState(),n=this.secondaryEditorPane?.getViewState();if(!(!i||!n))return{primary:i,secondary:n,focus:this.lastFocusedSide,ratio:this.getSplitViewRatio()}}toEditorViewStateResource(e){let i,n;if(e instanceof qn&&(i=e.primary.resource,n=e.secondary.resource),!(!n||!i))return q.from({scheme:"sideBySide",path:`${Gv(n.toString())}${Gv(i.toString())}`})}updateStyles(){super.updateStyles(),this.primaryEditorContainer&&(this.orientation===1?(this.primaryEditorContainer.style.borderLeftWidth="1px",this.primaryEditorContainer.style.borderLeftStyle="solid",this.primaryEditorContainer.style.borderLeftColor=this.getColor(Bq)??"",this.primaryEditorContainer.style.borderTopWidth="0"):(this.primaryEditorContainer.style.borderTopWidth="1px",this.primaryEditorContainer.style.borderTopStyle="solid",this.primaryEditorContainer.style.borderTopColor=this.getColor(Fq)??"",this.primaryEditorContainer.style.borderLeftWidth="0"))}dispose(){this.disposeEditors(),super.dispose()}disposeEditors(){this.editorDisposables.clear(),this.secondaryEditorPane=void 0,this.primaryEditorPane=void 0,this.lastFocusedSide=void 0,this.secondaryEditorContainer&&ci(this.secondaryEditorContainer),this.primaryEditorContainer&&ci(this.primaryEditorContainer)}};Zd=_([v(1,qt),v(2,ae),v(3,Ze),v(4,tt),v(5,de),v(6,_s),v(7,kt),v(8,di)],Zd);var X4=class r{constructor(t,e){this.selection=t;this.side=e}compare(t){return t instanceof r?this.side!==t.side?3:this.selection.compare(t.selection):3}restore(t){let e={...t,target:this.side};return this.selection.restore(e)}};var Km=class extends zm{constructor(e,i,n,o,s,a,l,d,c,u){super(e,i,Km.VIEW_STATE_PREFERENCE_KEY,n,o,s,a,l,d,c);this.fileService=u;this._register(this.textResourceConfigurationService.onDidChangeConfiguration(p=>this.handleConfigurationChangeEvent(p))),this._register(O.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{let p=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",p),this.updateEditorControlOptions({ariaLabel:p})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(p=>this.onDidChangeFileSystemProvider(p.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(p=>this.onDidChangeFileSystemProvider(p.scheme)))}static VIEW_STATE_PREFERENCE_KEY="textEditorViewState";_onDidChangeSelection=this._register(new T);onDidChangeSelection=this._onDidChangeSelection.event;_onDidChangeScroll=this._register(new T);onDidChangeScroll=this._onDidChangeScroll.event;editorContainer;hasPendingConfigurationChange;lastAppliedEditorOptions;inputListener=this._register(new mt);handleConfigurationChangeEvent(e){let i=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(e,i)&&(this.isVisible()?this.updateEditorConfiguration(i):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(e,i){return e.affectsConfiguration(i,"editor")||e.affectsConfiguration(i,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(e){let i=Mi(e.editor)?Cs(e.editor):Object.create(null);return Object.assign(i,this.getConfigurationOverrides(e)),i.ariaLabel=this.computeAriaLabel(),i}computeAriaLabel(){return this.input?z0(this.input,void 0,this.group,this.editorGroupService.count):h("editor","Editor")}onDidChangeFileSystemProvider(e){this.input&&this.getActiveResource()?.scheme===e&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(e){this.input===e&&this.updateReadonly(e)}updateReadonly(e){this.updateEditorControlOptions({...this.getReadonlyConfiguration(e.isReadonly())})}getReadonlyConfiguration(e){return{readOnly:!!e,readOnlyMessage:typeof e!="boolean"?e:void 0}}getConfigurationOverrides(e){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:e.problems?.visibility!==!1?"on":"off"}}createEditor(e){this.editorContainer=e,this.createEditorControl(e,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let e=this.getMainControl();e&&(this._register(e.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeCursorPosition(i=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(i)}))),this._register(e.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:3}))),this._register(e.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(e){switch(e.source){case"api":return 1;case"code.navigation":return 4;case"code.jump":return 5;default:return 2}}getSelection(){let e=this.getMainControl();if(e){let i=e.getSelection();if(i)return new Q4(i)}}async setInput(e,i,n,o){await super.setInput(e,i,n,o),this.inputListener.value=e.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(e)),this.updateEditorConfiguration(),Ue(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let e=this.getMainControl();if(!e)throw new Error("Control has not yet been initialized");return{scrollTop:e.getScrollTop()-e.getTopForLineNumber(1),scrollLeft:e.getScrollLeft()}}setScrollPosition(e){let i=this.getMainControl();if(!i)throw new Error("Control has not yet been initialized");i.setScrollTop(e.scrollTop),e.scrollLeft&&i.setScrollLeft(e.scrollLeft)}setEditorVisible(e){e&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(e)}toEditorViewStateResource(e){return e.resource}updateEditorConfiguration(e=this.getActiveResource()){let i;if(e&&(i=this.textResourceConfigurationService.getValue(e)),!i)return;let n=this.computeConfiguration(i),o=n;this.lastAppliedEditorOptions&&(o=h$(this.lastAppliedEditorOptions,o)),Object.keys(o).length>0&&(this.lastAppliedEditorOptions=n,this.updateEditorControlOptions(o))}getActiveResource(){let e=this.getMainControl();if(e){let i=e.getModel();if(i)return i.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}};Km=_([v(2,qt),v(3,ae),v(4,tt),v(5,_s),v(6,Ze),v(7,kt),v(8,di),v(9,ai)],Km);var Q4=class r{constructor(t){this.textSelection=t}static TEXT_EDITOR_SELECTION_THRESHOLD=10;compare(t){if(!(t instanceof r))return 3;let e=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),i=Math.min(t.textSelection.selectionStartLineNumber,t.textSelection.positionLineNumber);return e===i?1:Math.abs(e-i)<r.TEXT_EDITOR_SELECTION_THRESHOLD?2:3}restore(t){return{...t,selection:this.textSelection,selectionRevealType:1}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};function J4(r,t,e){let i=!1,n=xue(r);if(zE(n)&&(t.restoreViewState(n),i=!0),r.selection){let o={startLineNumber:r.selection.startLineNumber,startColumn:r.selection.startColumn,endLineNumber:r.selection.endLineNumber??r.selection.startLineNumber,endColumn:r.selection.endColumn??r.selection.startColumn};t.setSelection(o,r.selectionSource??"code.navigation"),r.selectionRevealType===2?t.revealRangeNearTop(o,e):r.selectionRevealType===3?t.revealRangeNearTopIfOutsideViewport(o,e):r.selectionRevealType===1?t.revealRangeInCenterIfOutsideViewport(o,e):t.revealRangeInCenter(o,e),i=!0}return i}function xue(r){if(!r.selection||!r.viewState)return r.viewState;let t=r.viewState;if(t.modified)return t.modified.cursorState=[],t;let e=r.viewState;return e.cursorState&&(e.cursorState=[]),e}var eC=class extends $h{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}constructor(t,e){super(),this._originalModel=t,this._modifiedModel=e}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}};var tC=class extends eC{_originalModel;get originalModel(){return this._originalModel}_modifiedModel;get modifiedModel(){return this._modifiedModel}_textDiffEditorModel=void 0;get textDiffEditorModel(){return this._textDiffEditorModel}constructor(t,e){super(t,e),this._originalModel=t,this._modifiedModel=e,this.updateTextDiffEditorModel()}async resolve(){await super.resolve(),this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this._textDiffEditorModel?(this._textDiffEditorModel.original=this.originalModel.textEditorModel,this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel):this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0,super.dispose()}};var Yr=class extends qn{constructor(e,i,n,o,s,a){super(e,i,n,o,a);this.original=n;this.modified=o;this.forceOpenAsBinary=s}static ID="workbench.editors.diffEditorInput";get typeId(){return Yr.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let e=super.capabilities;return this.labels.forceDescription&&(e|=64),e}cachedModel=void 0;labels=this.computeLabels();computeLabels(){let e,i=!1;if(this.preferredName)e=this.preferredName;else{let u=this.original.getName(),p=this.modified.getName();e=h("sideBySideLabels","{0} \u2194 {1}",u,p),i=u===p}let n,o,s;if(this.preferredDescription)n=this.preferredDescription,o=this.preferredDescription,s=this.preferredDescription;else{n=this.computeLabel(this.original.getDescription(0),this.modified.getDescription(0)),s=this.computeLabel(this.original.getDescription(2),this.modified.getDescription(2));let u=this.original.getDescription(1),p=this.modified.getDescription(1);if(typeof u=="string"&&typeof p=="string"&&(u||p)){let[m,g]=zR([u,p]);o=this.computeLabel(m,g)}}let a=this.computeLabel(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),l=this.computeLabel(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),d=this.computeLabel(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 "),c=this.getPreferredTitle();return c&&(a=`${c} (${a})`,l=`${c} (${l})`,d=`${c} (${d})`),{name:e,shortDescription:n,mediumDescription:o,longDescription:s,forceDescription:i,shortTitle:a,mediumTitle:l,longTitle:d}}computeLabel(e,i,n=" - "){if(!(!e||!i))return e===i?i:`${e}${n}${i}`}getName(){return this.labels.name}getDescription(e=1){switch(e){case 0:return this.labels.shortDescription;case 2:return this.labels.longDescription;case 1:default:return this.labels.mediumDescription}}getTitle(e){switch(e){case 0:return this.labels.shortTitle;case 2:return this.labels.longTitle;default:case 1:return this.labels.mediumTitle}}async resolve(){let e=await this.createModel();return this.cachedModel?.dispose(),this.cachedModel=e,this.cachedModel}prefersEditorPane(e){return this.forceOpenAsBinary?e.find(i=>i.typeId===PZ):e.find(i=>i.typeId===eA)}async createModel(){let[e,i]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return i instanceof Td&&e instanceof Td?new tC(e,i):new eC(MB(e)?e:void 0,MB(i)?i:void 0)}toUntyped(e){let i=super.toUntyped(e);if(i)return{...i,modified:i.primary,original:i.secondary}}matches(e){return this===e?!0:e instanceof Yr?this.modified.matches(e.modified)&&this.original.matches(e.original)&&e.forceOpenAsBinary===this.forceOpenAsBinary:Wa(e)?this.modified.matches(e.modified)&&this.original.matches(e.original):!1}dispose(){this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=void 0),super.dispose()}};Yr=_([v(5,kt)],Yr);var K0=class r{constructor(t,e,i,n,o){this._initialScrollTop=t;this._initialContentHeight=e;this._visiblePosition=i;this._visiblePositionScrollDelta=n;this._cursorPosition=o}static capture(t){if(t.getScrollTop()===0||t.hasPendingScrollAnimation())return new r(t.getScrollTop(),t.getContentHeight(),null,0,null);let e=null,i=0,n=t.getVisibleRanges();if(n.length>0){e=n[0].getStartPosition();let o=t.getTopForPosition(e.lineNumber,e.column);i=t.getScrollTop()-o}return new r(t.getScrollTop(),t.getContentHeight(),e,i,t.getPosition())}restore(t){if(!(this._initialContentHeight===t.getContentHeight()&&this._initialScrollTop===t.getScrollTop())&&this._visiblePosition){let e=t.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);t.setScrollTop(e+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(t){if(this._initialContentHeight===t.getContentHeight()&&this._initialScrollTop===t.getScrollTop())return;let e=t.getPosition();if(!this._cursorPosition||!e)return;let i=t.getTopForLineNumber(e.lineNumber)-t.getTopForLineNumber(this._cursorPosition.lineNumber);t.setScrollTop(t.getScrollTop()+i,1)}};var ree=$("markerDecorationsService");var iC=class{static ID="editor.contrib.markerDecorations";constructor(t,e){}dispose(){}};iC=_([v(1,ree)],iC);kJ(iC.ID,iC,0);var Yp;(k=>{let r={total:0,min:Number.MAX_VALUE,max:0},t={...r},e={...r},i={...r},n=0,o;(z=>(z[z.Before=0]="Before",z[z.InProgress=1]="InProgress",z[z.Finished=2]="Finished"))(o||={});let s={keydown:0,input:0,render:0};function a(){y(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),s.keydown=1,queueMicrotask(l)}k.onKeyDown=a;function l(){s.keydown===1&&(performance.mark("keydown/end"),s.keydown=2)}function d(){performance.mark("input/start"),s.input=1,b()}k.onBeforeInput=d;function c(){s.input===0&&d(),queueMicrotask(u)}k.onInput=c;function u(){s.input===1&&(performance.mark("input/end"),s.input=2)}function p(){y()}k.onKeyUp=p;function m(){y()}k.onSelectionChange=m;function g(){s.keydown===2&&s.input===2&&s.render===0&&(performance.mark("render/start"),s.render=1,queueMicrotask(f),b())}k.onRenderStart=g;function f(){s.render===1&&(performance.mark("render/end"),s.render=2)}function b(){setTimeout(y)}function y(){s.keydown===2&&s.input===2&&s.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),I("keydown",r),I("input",t),I("render",e),I("inputlatency",i),n++,E())}function I(R,A){let H=performance.getEntriesByName(R)[0].duration;A.total+=H,A.min=Math.min(A.min,H),A.max=Math.max(A.max,H)}function E(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),s.keydown=0,s.input=0,s.render=0}function S(){if(n===0)return;let R={keydown:w(r),input:w(t),render:w(e),total:w(i),sampleCount:n};return D(r),D(t),D(e),D(i),n=0,R}k.getAndClearMeasurements=S;function w(R){return{average:R.total/n,max:R.max,min:R.min}}function D(R){R.total=0,R.min=Number.MAX_VALUE,R.max=0}})(Yp||={});var Gm=class{constructor(t,e){this.x=t;this.y=e}_pageCoordinatesBrand=void 0;toClientCoordinates(t){return new bx(this.x-t.scrollX,this.y-t.scrollY)}},bx=class{constructor(t,e){this.clientX=t;this.clientY=e}_clientCoordinatesBrand=void 0;toPageCoordinates(t){return new Gm(this.clientX+t.scrollX,this.clientY+t.scrollY)}},eK=class{constructor(t,e,i,n){this.x=t;this.y=e;this.width=i;this.height=n}_editorPagePositionBrand=void 0},tK=class{constructor(t,e){this.x=t;this.y=e}_positionRelativeToEditorBrand=void 0};function $0(r){let t=To(r);return new eK(t.left,t.top,t.width,t.height)}function Y0(r,t,e){let i=t.width/r.offsetWidth,n=t.height/r.offsetHeight,o=(e.x-t.x)/i,s=(e.y-t.y)/n;return new tK(o,s)}var Vl=class extends ri{_editorMouseEventBrand=void 0;isFromPointerCapture;pos;editorPos;relativePos;constructor(t,e,i){super(oe(i),t),this.isFromPointerCapture=e,this.pos=new Gm(this.posx,this.posy),this.editorPos=$0(i),this.relativePos=Y0(i,this.editorPos,this.pos)}},G0=class{_editorViewDomNode;constructor(t){this._editorViewDomNode=t}_create(t){return new Vl(t,!1,this._editorViewDomNode)}onContextMenu(t,e){return M(t,"contextmenu",i=>{e(this._create(i))})}onMouseUp(t,e){return M(t,"mouseup",i=>{e(this._create(i))})}onMouseDown(t,e){return M(t,G.MOUSE_DOWN,i=>{e(this._create(i))})}onPointerDown(t,e){return M(t,G.POINTER_DOWN,i=>{e(this._create(i),i.pointerId)})}onMouseLeave(t,e){return M(t,G.MOUSE_LEAVE,i=>{e(this._create(i))})}onMouseMove(t,e){return M(t,"mousemove",i=>e(this._create(i)))}},q0=class{_editorViewDomNode;constructor(t){this._editorViewDomNode=t}_create(t){return new Vl(t,!1,this._editorViewDomNode)}onPointerUp(t,e){return M(t,"pointerup",i=>{e(this._create(i))})}onPointerDown(t,e){return M(t,G.POINTER_DOWN,i=>{e(this._create(i),i.pointerId)})}onPointerLeave(t,e){return M(t,G.POINTER_LEAVE,i=>{e(this._create(i))})}onPointerMove(t,e){return M(t,"pointermove",i=>e(this._create(i)))}},j0=class extends L{_editorViewDomNode;_globalPointerMoveMonitor;_keydownListener;constructor(t){super(),this._editorViewDomNode=t,this._globalPointerMoveMonitor=this._register(new Yc),this._keydownListener=null}startMonitoring(t,e,i,n,o){this._keydownListener=Wi(t.ownerDocument,"keydown",s=>{s.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,s.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(t,e,i,s=>{n(new Vl(s,!0,this._editorViewDomNode))},s=>{this._keydownListener.dispose(),o(s)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}};var Z0=class{selections;startLineNumber;endLineNumber;relativeVerticalOffset;visibleRange;bigNumbersDelta;whitespaceViewportData;_model;lineHeight;constructor(t,e,i,n){this.selections=t,this.startLineNumber=e.startLineNumber|0,this.endLineNumber=e.endLineNumber|0,this.relativeVerticalOffset=e.relativeVerticalOffset,this.bigNumbersDelta=e.bigNumbersDelta|0,this.lineHeight=e.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new F(e.startLineNumber,this._model.getLineMinColumn(e.startLineNumber),e.endLineNumber,this._model.getLineMaxColumn(e.endLineNumber))}getViewLineRenderingData(t){return this._model.getViewportViewLineRenderingData(this.visibleRange,t)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}};var iK=class{_restrictedRenderingContextBrand=void 0;viewportData;scrollWidth;scrollHeight;visibleRange;bigNumbersDelta;scrollTop;scrollLeft;viewportWidth;viewportHeight;_viewLayout;constructor(t,e){this._viewLayout=t,this.viewportData=e,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;let i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(t){return t-this.scrollTop}getVerticalOffsetForLineNumber(t,e){return this._viewLayout.getVerticalOffsetForLineNumber(t,e)}getVerticalOffsetAfterLineNumber(t,e){return this._viewLayout.getVerticalOffsetAfterLineNumber(t,e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}},X0=class extends iK{_renderingContextBrand=void 0;_viewLines;constructor(t,e,i){super(t,e),this._viewLines=i}linesVisibleRangesForRange(t,e){return this._viewLines.linesVisibleRangesForRange(t,e)}visibleRangeForPosition(t){return this._viewLines.visibleRangeForPosition(t)}},Q0=class{constructor(t,e,i,n){this.outsideRenderedLine=t;this.lineNumber=e;this.ranges=i;this.continuesOnNextLine=n}static firstLine(t){if(!t)return null;let e=null;for(let i of t)(!e||i.lineNumber<e.lineNumber)&&(e=i);return e}static lastLine(t){if(!t)return null;let e=null;for(let i of t)(!e||i.lineNumber>e.lineNumber)&&(e=i);return e}},nC=class r{_horizontalRangeBrand=void 0;left;width;static from(t){let e=new Array(t.length);for(let i=0,n=t.length;i<n;i++){let o=t[i];e[i]=new r(o.left,o.width)}return e}constructor(t,e){this.left=Math.round(t),this.width=Math.round(e)}toString(){return`[${this.left},${this.width}]`}},Xd=class{_floatHorizontalRangeBrand=void 0;left;width;constructor(t,e){this.left=t,this.width=e}toString(){return`[${this.left},${this.width}]`}static compare(t,e){return t.left-e.left}},J0=class{outsideRenderedLine;left;originalLeft;constructor(t,e){this.outsideRenderedLine=t,this.originalLeft=e,this.left=Math.round(this.originalLeft)}},vx=class{constructor(t,e){this.outsideRenderedLine=t;this.ranges=e}};var eO=class{configuration;viewModel;viewLayout;theme;constructor(t,e,i){this.configuration=t,this.theme=new KM(e),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(t){this.viewModel.addViewEventHandler(t)}removeEventHandler(t){this.viewModel.removeViewEventHandler(t)}};var ji=class extends Nl{_context;constructor(t){super(),this._context=t,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}};var Ro=class{static write(t,e){t.setAttribute("data-mprt",String(e))}static read(t){let e=t.getAttribute("data-mprt");return e===null?0:parseInt(e,10)}static collect(t,e){let i=[],n=0;for(;t&&t!==t.ownerDocument.body&&t!==e;)t.nodeType===t.ELEMENT_NODE&&(i[n++]=this.read(t)),t=t.parentElement;let o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=i[n-s-1];return o}};function qm(r,t){let e=globalThis.MonacoEnvironment;if(e?.createTrustedTypesPolicy)try{return e.createTrustedTypesPolicy(r,t)}catch(i){Ke(i);return}try{return globalThis.trustedTypes?.createPolicy(r,t)}catch(i){Ke(i);return}}var yx=class{constructor(t){this._lineFactory=t;this._set(1,[])}_lines;_rendLineNumberStart;flush(){this._set(1,[])}_set(t,e){this._lines=e,this._rendLineNumberStart=t}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(t){let e=t-this._rendLineNumberStart;if(e<0||e>=this._lines.length)throw new yt("Illegal value for lineNumber");return this._lines[e]}onLinesDeleted(t,e){if(this.getCount()===0)return null;let i=this.getStartLineNumber(),n=this.getEndLineNumber();if(e<i){let l=e-t+1;return this._rendLineNumberStart-=l,null}if(t>n)return null;let o=0,s=0;for(let l=i;l<=n;l++){let d=l-this._rendLineNumberStart;t<=l&&l<=e&&(s===0?(o=d,s=1):s++)}if(t<i){let l=0;e<i?l=e-t+1:l=i-t,this._rendLineNumberStart-=l}return this._lines.splice(o,s)}onLinesChanged(t,e){let i=t+e-1;if(this.getCount()===0)return!1;let n=this.getStartLineNumber(),o=this.getEndLineNumber(),s=!1;for(let a=t;a<=i;a++)a>=n&&a<=o&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(t,e){if(this.getCount()===0)return null;let i=e-t+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(t<=n)return this._rendLineNumberStart+=i,null;if(t>o)return null;if(i+t>o)return this._lines.splice(t-this._rendLineNumberStart,o-t+1);let s=[];for(let u=0;u<i;u++)s[u]=this._lineFactory.createLine();let a=t-this._rendLineNumberStart,l=this._lines.slice(0,a),d=this._lines.slice(a,this._lines.length-i),c=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(s).concat(d),c}onTokensChanged(t){if(this.getCount()===0)return!1;let e=this.getStartLineNumber(),i=this.getEndLineNumber(),n=!1;for(let o=0,s=t.length;o<s;o++){let a=t[o];if(a.toLineNumber<e||a.fromLineNumber>i)continue;let l=Math.max(e,a.fromLineNumber),d=Math.min(i,a.toLineNumber);for(let c=l;c<=d;c++){let u=c-this._rendLineNumberStart;this._lines[u].onTokensChanged(),n=!0}}return n}},oC=class{constructor(t){this._lineFactory=t}domNode=this._createDomNode();_linesCollection=new yx(this._lineFactory);_createDomNode(){let t=ut(document.createElement("div"));return t.setClassName("view-layer"),t.setPosition("absolute"),t.domNode.setAttribute("role","presentation"),t.domNode.setAttribute("aria-hidden","true"),t}onConfigurationChanged(t){return!!t.hasChanged(147)}onFlushed(t){return this._linesCollection.flush(),!0}onLinesChanged(t){return this._linesCollection.onLinesChanged(t.fromLineNumber,t.count)}onLinesDeleted(t){let e=this._linesCollection.onLinesDeleted(t.fromLineNumber,t.toLineNumber);if(e)for(let i=0,n=e.length;i<n;i++)e[i].getDomNode()?.remove();return!0}onLinesInserted(t){let e=this._linesCollection.onLinesInserted(t.fromLineNumber,t.toLineNumber);if(e)for(let i=0,n=e.length;i<n;i++)e[i].getDomNode()?.remove();return!0}onScrollChanged(t){return t.scrollTopChanged}onTokensChanged(t){return this._linesCollection.onTokensChanged(t.ranges)}onZonesChanged(t){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(t){return this._linesCollection.getLine(t)}renderLines(t){let e=this._linesCollection._get(),i=new nK(this.domNode.domNode,this._lineFactory,t),n={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines,linesLength:e.lines.length},o=i.render(n,t.startLineNumber,t.endLineNumber,t.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}},nK=class r{constructor(t,e,i){this._domNode=t;this._lineFactory=e;this._viewportData=i}static _ttPolicy=qm("editorViewLayer",{createHTML:t=>t});render(t,e,i,n){let o={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines.slice(0),linesLength:t.linesLength};if(o.rendLineNumberStart+o.linesLength-1<e||i<o.rendLineNumberStart){o.rendLineNumberStart=e,o.linesLength=i-e+1,o.lines=[];for(let s=e;s<=i;s++)o.lines[s-e]=this._lineFactory.createLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(e-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),n,e),o.rendLineNumberStart>e){let s=e,a=Math.min(i,o.rendLineNumberStart-1);s<=a&&(this._insertLinesBefore(o,s,a,n,e),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart<e){let s=Math.min(o.linesLength,e-o.rendLineNumberStart);s>0&&(this._removeLinesBefore(o,s),o.linesLength-=s)}if(o.rendLineNumberStart=e,o.rendLineNumberStart+o.linesLength-1<i){let s=o.rendLineNumberStart+o.linesLength,a=i;s<=a&&(this._insertLinesAfter(o,s,a,n,e),o.linesLength+=a-s+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){let s=Math.max(0,i-o.rendLineNumberStart+1),l=o.linesLength-1-s+1;l>0&&(this._removeLinesAfter(o,l),o.linesLength-=l)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(t,e,i,n,o){let s=t.rendLineNumberStart,a=t.lines;for(let l=e;l<=i;l++){let d=s+l;a[l].layoutLine(d,n[d-o],this._viewportData.lineHeight)}}_insertLinesBefore(t,e,i,n,o){let s=[],a=0;for(let l=e;l<=i;l++)s[a++]=this._lineFactory.createLine();t.lines=s.concat(t.lines)}_removeLinesBefore(t,e){for(let i=0;i<e;i++)t.lines[i].getDomNode()?.remove();t.lines.splice(0,e)}_insertLinesAfter(t,e,i,n,o){let s=[],a=0;for(let l=e;l<=i;l++)s[a++]=this._lineFactory.createLine();t.lines=t.lines.concat(s)}_removeLinesAfter(t,e){let i=t.linesLength-e;for(let n=0;n<e;n++)t.lines[i+n].getDomNode()?.remove();t.lines.splice(i,e)}_finishRenderingNewLines(t,e,i,n){r._ttPolicy&&(i=r._ttPolicy.createHTML(i));let o=this._domNode.lastChild;e||!o?this._domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let s=this._domNode.lastChild;for(let a=t.linesLength-1;a>=0;a--){let l=t.lines[a];n[a]&&(l.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(t,e,i){let n=document.createElement("div");r._ttPolicy&&(e=r._ttPolicy.createHTML(e)),n.innerHTML=e;for(let o=0;o<t.linesLength;o++){let s=t.lines[o];if(i[o]){let a=n.firstChild,l=s.getDomNode();l.parentNode.replaceChild(a,l),s.setDomNode(a)}}}static _sb=new Pc(1e5);_finishRendering(t,e,i){let n=r._sb,o=t.linesLength,s=t.lines,a=t.rendLineNumberStart,l=[];{n.reset();let d=!1;for(let c=0;c<o;c++){let u=s[c];l[c]=!1,!(u.getDomNode()||!u.renderLine(c+a,i[c],this._viewportData.lineHeight,this._viewportData,n))&&(l[c]=!0,d=!0)}d&&this._finishRenderingNewLines(t,e,n.build(),l)}{n.reset();let d=!1,c=[];for(let u=0;u<o;u++){let p=s[u];c[u]=!1,!(l[u]||!p.renderLine(u+a,i[u],this._viewportData.lineHeight,this._viewportData,n))&&(c[u]=!0,d=!0)}d&&this._finishRenderingInvalidLines(t,n.build(),c)}}};var rC=class{constructor(t,e){this._domNode=t;this.endNode=e}_didDomLayout=!1;_clientRectDeltaLeft=0;_clientRectScale=1;_clientRectRead=!1;get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;let t=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=t.left,this._clientRectScale=t.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}markDidDomLayout(){this._didDomLayout=!0}};var sb=class{static _handyReadyRange;static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(t,e){t.selectNodeContents(e)}static _readClientRects(t,e,i,n,o){let s=this._createRange();try{return s.setStart(t,e),s.setEnd(i,n),s.getClientRects()}catch{return null}finally{this._detachRange(s,o)}}static _mergeAdjacentRanges(t){if(t.length===1)return t;t.sort(Xd.compare);let e=[],i=0,n=t[0];for(let o=1,s=t.length;o<s;o++){let a=t[o];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(e[i++]=n,n=a)}return e[i++]=n,e}static _createHorizontalRangesFromClientRects(t,e,i){if(!t||t.length===0)return null;let n=[];for(let o=0,s=t.length;o<s;o++){let a=t[o];n[o]=new Xd(Math.max(0,(a.left-e)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(t,e,i,n,o,s){let l=t.children.length-1;if(0>l)return null;if(e=Math.min(l,Math.max(0,e)),n=Math.min(l,Math.max(0,n)),e===n&&i===o&&i===0&&!t.children[e].firstChild){let p=t.children[e].getClientRects();return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(p,s.clientRectDeltaLeft,s.clientRectScale)}e!==n&&n>0&&o===0&&(n--,o=1073741824);let d=t.children[e].firstChild,c=t.children[n].firstChild;if((!d||!c)&&(!d&&i===0&&e>0&&(d=t.children[e-1].firstChild,i=1073741824),!c&&o===0&&n>0&&(c=t.children[n-1].firstChild,o=1073741824)),!d||!c)return null;i=Math.min(d.textContent.length,Math.max(0,i)),o=Math.min(c.textContent.length,Math.max(0,o));let u=this._readClientRects(d,i,c,o,s.endNode);return s.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,s.clientRectDeltaLeft,s.clientRectScale)}};var Kn=class{constructor(t,e,i,n){this.endIndex=t;this.type=e;this.metadata=i;this.containsRTL=n}_linePartBrand=void 0;isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}};var Wl=class r{constructor(t,e,i,n){this.startColumn=t;this.endColumn=e;this.className=i;this.type=n}_lineDecorationBrand=void 0;static _equals(t,e){return t.startColumn===e.startColumn&&t.endColumn===e.endColumn&&t.className===e.className&&t.type===e.type}static equalsArr(t,e){let i=t.length,n=e.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!r._equals(t[o],e[o]))return!1;return!0}static extractWrapped(t,e,i){if(t.length===0)return t;let n=e+1,o=i+1,s=i-e,a=[],l=0;for(let d of t)d.endColumn<=n||d.startColumn>=o||(a[l++]=new r(Math.max(1,d.startColumn-n+1),Math.min(s+1,d.endColumn-n+1),d.className,d.type));return a}static filter(t,e,i,n){if(t.length===0)return[];let o=[],s=0;for(let a=0,l=t.length;a<l;a++){let d=t[a],c=d.range;if(c.endLineNumber<e||c.startLineNumber>e||c.isEmpty()&&(d.type===0||d.type===3))continue;let u=c.startLineNumber===e?c.startColumn:i,p=c.endLineNumber===e?c.endColumn:n;o[s++]=new r(u,p,d.inlineClassName,d.type)}return o}static _typeCompare(t,e){let i=[2,0,1,3];return i[t]-i[e]}static compare(t,e){if(t.startColumn!==e.startColumn)return t.startColumn-e.startColumn;if(t.endColumn!==e.endColumn)return t.endColumn-e.endColumn;let i=r._typeCompare(t.type,e.type);return i!==0?i:t.className!==e.className?t.className<e.className?-1:1:0}},tO=class{startOffset;endOffset;className;metadata;constructor(t,e,i,n){this.startOffset=t,this.endOffset=e,this.className=i,this.metadata=n}},oK=class r{count;stopOffsets;classNames;metadata;constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(t){let e=0;for(let i=0,n=t.length;i<n;i++)e|=t[i];return e}consumeLowerThan(t,e,i){for(;this.count>0&&this.stopOffsets[0]<t;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new tO(e,this.stopOffsets[n],this.classNames.join(" "),r._metadata(this.metadata))),e=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&e<t&&(i.push(new tO(e,t-1,this.classNames.join(" "),r._metadata(this.metadata))),e=t),e}insert(t,e,i){if(this.count===0||this.stopOffsets[this.count-1]<=t)this.stopOffsets.push(t),this.classNames.push(e),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=t){this.stopOffsets.splice(n,0,t),this.classNames.splice(n,0,e),this.metadata.splice(n,0,i);break}this.count++}},iO=class{static normalize(t,e){if(e.length===0)return[];let i=[],n=new oK,o=0;for(let s=0,a=e.length;s<a;s++){let l=e[s],d=l.startColumn,c=l.endColumn,u=l.className,p=l.type===1?2:l.type===2?4:0;if(d>1){let f=t.charCodeAt(d-2);ln(f)&&d--}if(c>1){let f=t.charCodeAt(c-2);ln(f)&&c--}let m=d-1,g=c-2;o=n.consumeLowerThan(m,o,i),n.count===0&&(o=m),n.insert(g,u,p)}return n.consumeLowerThan(1073741824,o,i),i}};var sC=class{startOffset;endOffset;constructor(t,e){this.startOffset=t,this.endOffset=e}equals(t){return this.startOffset===t.startOffset&&this.endOffset===t.endOffset}},jm=class{useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineContent;continuesWithWrappedLine;isBasicASCII;containsRTL;fauxIndentLength;lineTokens;lineDecorations;tabSize;startVisibleColumn;spaceWidth;renderSpaceWidth;renderSpaceCharCode;stopRenderingLineAfter;renderWhitespace;renderControlCharacters;fontLigatures;selectionsOnLine;constructor(t,e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y,I,E){this.useMonospaceOptimizations=t,this.canUseHalfwidthRightwardsArrow=e,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=o,this.containsRTL=s,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=d.sort(Wl.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=p,this.stopRenderingLineAfter=f,this.renderWhitespace=b==="all"?4:b==="boundary"?1:b==="selection"?2:b==="trailing"?3:0,this.renderControlCharacters=y,this.fontLigatures=I,this.selectionsOnLine=E&&E.sort((D,k)=>D.startOffset<k.startOffset?-1:1);let S=Math.abs(g-p),w=Math.abs(m-p);S<w?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=m,this.renderSpaceCharCode=183)}sameSelection(t){if(this.selectionsOnLine===null)return t===null;if(t===null||t.length!==this.selectionsOnLine.length)return!1;for(let e=0;e<this.selectionsOnLine.length;e++)if(!this.selectionsOnLine[e].equals(t[e]))return!1;return!0}equals(t){return this.useMonospaceOptimizations===t.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineContent===t.lineContent&&this.continuesWithWrappedLine===t.continuesWithWrappedLine&&this.isBasicASCII===t.isBasicASCII&&this.containsRTL===t.containsRTL&&this.fauxIndentLength===t.fauxIndentLength&&this.tabSize===t.tabSize&&this.startVisibleColumn===t.startVisibleColumn&&this.spaceWidth===t.spaceWidth&&this.renderSpaceWidth===t.renderSpaceWidth&&this.renderSpaceCharCode===t.renderSpaceCharCode&&this.stopRenderingLineAfter===t.stopRenderingLineAfter&&this.renderWhitespace===t.renderWhitespace&&this.renderControlCharacters===t.renderControlCharacters&&this.fontLigatures===t.fontLigatures&&Wl.equalsArr(this.lineDecorations,t.lineDecorations)&&this.lineTokens.equals(t.lineTokens)&&this.sameSelection(t.selectionsOnLine)}};var Ix=class{constructor(t,e){this.partIndex=t;this.charIndex=e}},Cx=class r{static getPartIndex(t){return(t&4294901760)>>>16}static getCharIndex(t){return(t&65535)>>>0}length;_data;_horizontalOffset;constructor(t,e){this.length=t,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(t,e,i,n){let o=(e<<16|i<<0)>>>0;this._data[t-1]=o,this._horizontalOffset[t-1]=n}getHorizontalOffset(t){return this._horizontalOffset.length===0?0:this._horizontalOffset[t-1]}charOffsetToPartData(t){return this.length===0?0:t<0?this._data[0]:t>=this.length?this._data[this.length-1]:this._data[t]}getDomPosition(t){let e=this.charOffsetToPartData(t-1),i=r.getPartIndex(e),n=r.getCharIndex(e);return new Ix(i,n)}getColumn(t,e){return this.partDataToCharOffset(t.partIndex,e,t.charIndex)+1}partDataToCharOffset(t,e,i){if(this.length===0)return 0;let n=(t<<16|i<<0)>>>0,o=0,s=this.length-1;for(;o+1<s;){let f=o+s>>>1,b=this._data[f];if(b===n)return f;b>n?s=f:o=f}if(o===s)return o;let a=this._data[o],l=this._data[s];if(a===n)return o;if(l===n)return s;let d=r.getPartIndex(a),c=r.getCharIndex(a),u=r.getPartIndex(l),p;d!==u?p=e:p=r.getCharIndex(l);let m=i-c,g=p-i;return m<=g?o:s}inflate(){let t=[];for(let e=0;e<this.length;e++){let i=this._data[e],n=r.getPartIndex(i),o=r.getCharIndex(i),s=this._horizontalOffset[e];t.push([n,o,s])}return t}};var Sx=class{_renderLineOutputBrand=void 0;characterMapping;containsRTL;containsForeignElements;constructor(t,e,i){this.characterMapping=t,this.containsRTL=e,this.containsForeignElements=i}};function wx(r,t){if(r.lineContent.length===0){if(r.lineDecorations.length>0){t.appendString("<span>");let e=0,i=0,n=0;for(let s of r.lineDecorations)(s.type===1||s.type===2)&&(t.appendString('<span class="'),t.appendString(s.className),t.appendString('"></span>'),s.type===1&&(n|=1,e++),s.type===2&&(n|=2,i++));t.appendString("</span>");let o=new Cx(1,e+i);return o.setColumnInfo(1,e,0,0),new Sx(o,!1,n)}return t.appendString("<span><span></span></span>"),new Sx(new Cx(0,0),!1,0)}return Oue(Lue(r),t)}var rK=class{constructor(t,e,i,n){this.characterMapping=t;this.html=e;this.containsRTL=i;this.containsForeignElements=n}};function see(r){let t=new Pc(1e4),e=wx(r,t);return new rK(e.characterMapping,t.build(),e.containsRTL,e.containsForeignElements)}var sK=class{constructor(t,e,i,n,o,s,a,l,d,c,u,p,m,g,f,b){this.fontIsMonospace=t;this.canUseHalfwidthRightwardsArrow=e;this.lineContent=i;this.len=n;this.isOverflowing=o;this.overflowingCharCount=s;this.parts=a;this.containsForeignElements=l;this.fauxIndentLength=d;this.tabSize=c;this.startVisibleColumn=u;this.containsRTL=p;this.spaceWidth=m;this.renderSpaceCharCode=g;this.renderWhitespace=f;this.renderControlCharacters=b}};function Lue(r){let t=r.lineContent,e,i,n;r.stopRenderingLineAfter!==-1&&r.stopRenderingLineAfter<t.length?(e=!0,i=t.length-r.stopRenderingLineAfter,n=r.stopRenderingLineAfter):(e=!1,i=0,n=t.length);let o=kue(t,r.containsRTL,r.lineTokens,r.fauxIndentLength,n);r.renderControlCharacters&&!r.isBasicASCII&&(o=Aue(t,o)),(r.renderWhitespace===4||r.renderWhitespace===1||r.renderWhitespace===2&&r.selectionsOnLine||r.renderWhitespace===3&&!r.continuesWithWrappedLine)&&(o=Pue(r,t,n,o));let s=0;if(r.lineDecorations.length>0){for(let a=0,l=r.lineDecorations.length;a<l;a++){let d=r.lineDecorations[a];d.type===3||d.type===1?s|=1:d.type===2&&(s|=2)}o=Mue(t,n,o,r.lineDecorations)}return r.containsRTL||(o=Rue(t,o,!r.isBasicASCII||r.fontLigatures)),new sK(r.useMonospaceOptimizations,r.canUseHalfwidthRightwardsArrow,t,n,e,i,o,s,r.fauxIndentLength,r.tabSize,r.startVisibleColumn,r.containsRTL,r.spaceWidth,r.renderSpaceCharCode,r.renderWhitespace,r.renderControlCharacters)}function kue(r,t,e,i,n){let o=[],s=0;i>0&&(o[s++]=new Kn(i,"",0,!1));let a=i;for(let l=0,d=e.getCount();l<d;l++){let c=e.getEndOffset(l);if(c<=i)continue;let u=e.getClassName(l);if(c>=n){let m=t?qu(r.substring(a,n)):!1;o[s++]=new Kn(n,u,0,m);break}let p=t?qu(r.substring(a,c)):!1;o[s++]=new Kn(c,u,0,p),a=c}return o}function Rue(r,t,e){let i=0,n=[],o=0;if(e)for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.endIndex;if(i+50<d){let c=l.type,u=l.metadata,p=l.containsRTL,m=-1,g=i;for(let f=i;f<d;f++)r.charCodeAt(f)===32&&(m=f),m!==-1&&f-g>=50&&(n[o++]=new Kn(m+1,c,u,p),g=m+1,m=-1);g!==d&&(n[o++]=new Kn(d,c,u,p))}else n[o++]=l;i=d}else for(let s=0,a=t.length;s<a;s++){let l=t[s],d=l.endIndex,c=d-i;if(c>50){let u=l.type,p=l.metadata,m=l.containsRTL,g=Math.ceil(c/50);for(let f=1;f<g;f++){let b=i+f*50;n[o++]=new Kn(b,u,p,m)}n[o++]=new Kn(d,u,p,m)}else n[o++]=l;i=d}return n}function aee(r){return r<32?r!==9:r===127||r>=8234&&r<=8238||r>=8294&&r<=8297||r>=8206&&r<=8207||r===1564}function Aue(r,t){let e=[],i=new Kn(0,"",0,!1),n=0;for(let o of t){let s=o.endIndex;for(;n<s;n++){let a=r.charCodeAt(n);aee(a)&&(n>i.endIndex&&(i=new Kn(n,o.type,o.metadata,o.containsRTL),e.push(i)),i=new Kn(n+1,"mtkcontrol",o.metadata,!1),e.push(i))}n>i.endIndex&&(i=new Kn(s,o.type,o.metadata,o.containsRTL),e.push(i))}return e}function Pue(r,t,e,i){let n=r.continuesWithWrappedLine,o=r.fauxIndentLength,s=r.tabSize,a=r.startVisibleColumn,l=r.useMonospaceOptimizations,d=r.selectionsOnLine,c=r.renderWhitespace===1,u=r.renderWhitespace===3,p=r.renderSpaceWidth!==r.spaceWidth,m=[],g=0,f=0,b=i[f].type,y=i[f].containsRTL,I=i[f].endIndex,E=i.length,S=!1,w=Rn(t),D;w===-1?(S=!0,w=e,D=e):D=Ta(t);let k=!1,R=0,A=d&&d[R],H=a%s;for(let Z=o;Z<e;Z++){let fe=t.charCodeAt(Z);A&&Z>=A.endOffset&&(R++,A=d&&d[R]);let Ve;if(Z<w||Z>D)Ve=!0;else if(fe===9)Ve=!0;else if(fe===32)if(c)if(k)Ve=!0;else{let me=Z+1<e?t.charCodeAt(Z+1):0;Ve=me===32||me===9}else Ve=!0;else Ve=!1;if(Ve&&d&&(Ve=!!A&&A.startOffset<=Z&&A.endOffset>Z),Ve&&u&&(Ve=S||Z>D),Ve&&y&&Z>=w&&Z<=D&&(Ve=!1),k){if(!Ve||!l&&H>=s){if(p){let me=g>0?m[g-1].endIndex:o;for(let ce=me+1;ce<=Z;ce++)m[g++]=new Kn(ce,"mtkw",1,!1)}else m[g++]=new Kn(Z,"mtkw",1,!1);H=H%s}}else(Z===I||Ve&&Z>o)&&(m[g++]=new Kn(Z,b,0,y),H=H%s);for(fe===9?H=s:xa(fe)?H+=2:H++,k=Ve;Z===I&&(f++,f<E);)b=i[f].type,y=i[f].containsRTL,I=i[f].endIndex}let z=!1;if(k)if(n&&c){let Z=e>0?t.charCodeAt(e-1):0,fe=e>1?t.charCodeAt(e-2):0;Z===32&&fe!==32&&fe!==9||(z=!0)}else z=!0;if(z)if(p){let Z=g>0?m[g-1].endIndex:o;for(let fe=Z+1;fe<=e;fe++)m[g++]=new Kn(fe,"mtkw",1,!1)}else m[g++]=new Kn(e,"mtkw",1,!1);else m[g++]=new Kn(e,b,0,y);return m}function Mue(r,t,e,i){i.sort(Wl.compare);let n=iO.normalize(r,i),o=n.length,s=0,a=[],l=0,d=0;for(let u=0,p=e.length;u<p;u++){let m=e[u],g=m.endIndex,f=m.type,b=m.metadata,y=m.containsRTL;for(;s<o&&n[s].startOffset<g;){let I=n[s];if(I.startOffset>d&&(d=I.startOffset,a[l++]=new Kn(d,f,b,y)),I.endOffset+1<=g)d=I.endOffset+1,a[l++]=new Kn(d,f+" "+I.className,b|I.metadata,y),s++;else{d=g,a[l++]=new Kn(d,f+" "+I.className,b|I.metadata,y);break}}g>d&&(d=g,a[l++]=new Kn(d,f,b,y))}let c=e[e.length-1].endIndex;if(s<o&&n[s].startOffset===c)for(;s<o&&n[s].startOffset===c;){let u=n[s];a[l++]=new Kn(d,u.className,u.metadata,!1),s++}return a}function Oue(r,t){let e=r.fontIsMonospace,i=r.canUseHalfwidthRightwardsArrow,n=r.containsForeignElements,o=r.lineContent,s=r.len,a=r.isOverflowing,l=r.overflowingCharCount,d=r.parts,c=r.fauxIndentLength,u=r.tabSize,p=r.startVisibleColumn,m=r.containsRTL,g=r.spaceWidth,f=r.renderSpaceCharCode,b=r.renderWhitespace,y=r.renderControlCharacters,I=new Cx(s+1,d.length),E=!1,S=0,w=p,D=0,k=0,R=0;m?t.appendString('<span dir="ltr">'):t.appendString("<span>");for(let A=0,H=d.length;A<H;A++){let z=d[A],Z=z.endIndex,fe=z.type,Ve=z.containsRTL,me=b!==0&&z.isWhitespace(),ce=me&&!e&&(fe==="mtkw"||!n),xe=S===Z&&z.isPseudoAfter();if(D=0,t.appendString("<span "),Ve&&t.appendString('style="unicode-bidi:isolate" '),t.appendString('class="'),t.appendString(ce?"mtkz":fe),t.appendASCIICharCode(34),me){let Ie=0;{let ge=S,He=w;for(;ge<Z;ge++){let xt=(o.charCodeAt(ge)===9?u-He%u:1)|0;Ie+=xt,ge>=c&&(He+=xt)}}for(ce&&(t.appendString(' style="width:'),t.appendString(String(g*Ie)),t.appendString('px"')),t.appendASCIICharCode(62);S<Z;S++){I.setColumnInfo(S+1,A-R,D,k),R=0;let ge=o.charCodeAt(S),He,_e;if(ge===9){He=u-w%u|0,_e=He,!i||_e>1?t.appendCharCode(8594):t.appendCharCode(65515);for(let xt=2;xt<=_e;xt++)t.appendCharCode(160)}else He=2,_e=1,t.appendCharCode(f),t.appendCharCode(8204);D+=He,k+=_e,S>=c&&(w+=_e)}}else for(t.appendASCIICharCode(62);S<Z;S++){I.setColumnInfo(S+1,A-R,D,k),R=0;let Ie=o.charCodeAt(S),ge=1,He=1;switch(Ie){case 9:ge=u-w%u,He=ge;for(let _e=1;_e<=ge;_e++)t.appendCharCode(160);break;case 32:t.appendCharCode(160);break;case 60:t.appendString("&lt;");break;case 62:t.appendString("&gt;");break;case 38:t.appendString("&amp;");break;case 0:y?t.appendCharCode(9216):t.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:t.appendCharCode(65533);break;default:xa(Ie)&&He++,y&&Ie<32?t.appendCharCode(9216+Ie):y&&Ie===127?t.appendCharCode(9249):y&&aee(Ie)?(t.appendString("[U+"),t.appendString(Nue(Ie)),t.appendString("]"),ge=8,He=ge):t.appendCharCode(Ie)}D+=ge,k+=He,S>=c&&(w+=He)}xe?R++:R=0,S>=s&&!E&&z.isPseudoAfter()&&(E=!0,I.setColumnInfo(S+1,A,D,k)),t.appendString("</span>")}return E||I.setColumnInfo(s+1,d.length-1,D,k),a&&(t.appendString('<span class="mtkoverflow">'),t.appendString(h("showMore","Show more ({0})",Fue(l))),t.appendString("</span>")),t.appendString("</span>"),new Sx(I,m,n)}function Nue(r){return r.toString(16).toUpperCase().padStart(4,"0")}function Fue(r){return r<1024?h("overflow.chars","{0} chars",r):r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/1024/1024).toFixed(1)} MB`}var Bue=function(){return Pi?!0:!(_t||dn||Eo)}(),lC=!0,Ex=class{themeType;renderWhitespace;renderControlCharacters;spaceWidth;middotWidth;wsmiddotWidth;useMonospaceOptimizations;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;fontLigatures;constructor(t,e){this.themeType=e;let i=t.options,n=i.get(51);i.get(39)==="off"?this.renderWhitespace=i.get(101):this.renderWhitespace="none",this.renderControlCharacters=i.get(96),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(68),this.stopRenderingLineAfter=i.get(119),this.fontLigatures=i.get(52)}equals(t){return this.themeType===t.themeType&&this.renderWhitespace===t.renderWhitespace&&this.renderControlCharacters===t.renderControlCharacters&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.useMonospaceOptimizations===t.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineHeight===t.lineHeight&&this.stopRenderingLineAfter===t.stopRenderingLineAfter&&this.fontLigatures===t.fontLigatures}},Qd=class r{static CLASS_NAME="view-line";_options;_isMaybeInvalid;_renderedViewLine;constructor(t){this._options=t,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(t){if(this._renderedViewLine)this._renderedViewLine.domNode=ut(t);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(t){this._isMaybeInvalid=!0,this._options=t}onSelectionChanged(){return Ra(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(t,e,i,n,o){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;let s=n.getViewLineRenderingData(t),a=this._options,l=Wl.filter(s.inlineDecorations,t,s.minColumn,s.maxColumn),d=null;if(Ra(a.themeType)||this._options.renderWhitespace==="selection"){let m=n.selections;for(let g of m){if(g.endLineNumber<t||g.startLineNumber>t)continue;let f=g.startLineNumber===t?g.startColumn:s.minColumn,b=g.endLineNumber===t?g.endColumn:s.maxColumn;f<b&&(Ra(a.themeType)&&l.push(new Wl(f,b,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(d||(d=[]),d.push(new sC(f-1,b-1))))}}let c=new jm(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,l,s.tabSize,s.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==vd.OFF,d);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;o.appendString('<div style="top:'),o.appendString(String(e)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;" class="'),o.appendString(r.CLASS_NAME),o.appendString('">');let u=wx(c,o);o.appendString("</div>");let p=null;return lC&&Bue&&s.isBasicASCII&&a.useMonospaceOptimizations&&u.containsForeignElements===0&&(p=new aC(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),p||(p=lee(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=p,!0}layoutLine(t,e,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(e),this._renderedViewLine.domNode.setHeight(i))}getWidth(t){return this._renderedViewLine?this._renderedViewLine.getWidth(t):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof aC:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof aC?this._renderedViewLine.monospaceAssumptionsAreValid():lC}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof aC&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(t,e,i,n){if(!this._renderedViewLine)return null;e=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,e)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));let o=this._renderedViewLine.input.stopRenderingLineAfter;if(o!==-1&&e>o+1&&i>o+1)return new vx(!0,[new Xd(this.getWidth(n),0)]);o!==-1&&e>o+1&&(e=o+1),o!==-1&&i>o+1&&(i=o+1);let s=this._renderedViewLine.getVisibleRangesForRange(t,e,i,n);return s&&s.length>0?new vx(!1,s):null}getColumnOfNodeOffset(t,e){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(t,e):1}};var aC=class{domNode;input;_characterMapping;_charWidth;_keyColumnPixelOffsetCache;_cachedWidth=-1;constructor(t,e,i){this.domNode=t,this.input=e;let n=Math.floor(e.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let o=0;o<n;o++)this._keyColumnPixelOffsetCache[o]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=e.spaceWidth}getWidth(t){if(!this.domNode||this.input.lineContent.length<300){let e=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*e)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,t?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return lC;if(this.input.lineContent.length<300){let t=this.getWidth(null),e=this.domNode.domNode.firstChild.offsetWidth;Math.abs(t-e)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),lC=!1)}return lC}toSlowRenderedLine(){return lee(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(t,e,i,n){let o=this._getColumnPixelOffset(t,e,n),s=this._getColumnPixelOffset(t,i,n);return[new Xd(o,s-o)]}_getColumnPixelOffset(t,e,i){if(e<=300){let d=this._characterMapping.getHorizontalOffset(e);return this._charWidth*d}let n=Math.floor((e-1)/300)-1,o=(n+1)*300+1,s=-1;if(this._keyColumnPixelOffsetCache&&(s=this._keyColumnPixelOffsetCache[n],s===-1&&(s=this._actualReadPixelOffset(t,o,i),this._keyColumnPixelOffsetCache[n]=s)),s===-1){let d=this._characterMapping.getHorizontalOffset(e);return this._charWidth*d}let a=this._characterMapping.getHorizontalOffset(o),l=this._characterMapping.getHorizontalOffset(e);return s+this._charWidth*(l-a)}_getReadingTarget(t){return t.domNode.firstChild}_actualReadPixelOffset(t,e,i){if(!this.domNode)return-1;let n=this._characterMapping.getDomPosition(e),o=sb.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!o||o.length===0?-1:o[0].left}getColumnOfNodeOffset(t,e){return dee(this._characterMapping,t,e)}},oO=class{domNode;input;_characterMapping;_isWhitespaceOnly;_containsForeignElements;_cachedWidth;_pixelOffsetCache;constructor(t,e,i,n,o){if(this.domNode=t,this.input=e,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(e.lineContent),this._containsForeignElements=o,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let s=0,a=this._characterMapping.length;s<=a;s++)this._pixelOffsetCache[s]=-1}}_getReadingTarget(t){return t.domNode.firstChild}getWidth(t){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,t?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(t,e,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){let o=this._readPixelOffset(this.domNode,t,e,n);if(o===-1)return null;let s=this._readPixelOffset(this.domNode,t,i,n);return s===-1?null:[new Xd(o,s-o)]}return this._readVisibleRangesForRange(this.domNode,t,e,i,n)}_readVisibleRangesForRange(t,e,i,n,o){if(i===n){let s=this._readPixelOffset(t,e,i,o);return s===-1?null:[new Xd(s,0)]}else return this._readRawVisibleRangesForRange(t,i,n,o)}_readPixelOffset(t,e,i,n){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);let o=this._getReadingTarget(t);return o.firstChild?(n.markDidDomLayout(),o.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){let o=this._pixelOffsetCache[i];if(o!==-1)return o;let s=this._actualReadPixelOffset(t,e,i,n);return this._pixelOffsetCache[i]=s,s}return this._actualReadPixelOffset(t,e,i,n)}_actualReadPixelOffset(t,e,i,n){if(this._characterMapping.length===0){let l=sb.readHorizontalRanges(this._getReadingTarget(t),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);let o=this._characterMapping.getDomPosition(i),s=sb.readHorizontalRanges(this._getReadingTarget(t),o.partIndex,o.charIndex,o.partIndex,o.charIndex,n);if(!s||s.length===0)return-1;let a=s[0].left;if(this.input.isBasicASCII){let l=this._characterMapping.getHorizontalOffset(i),d=Math.round(this.input.spaceWidth*l);if(Math.abs(d-a)<=1)return d}return a}_readRawVisibleRangesForRange(t,e,i,n){if(e===1&&i===this._characterMapping.length)return[new Xd(0,this.getWidth(n))];let o=this._characterMapping.getDomPosition(e),s=this._characterMapping.getDomPosition(i);return sb.readHorizontalRanges(this._getReadingTarget(t),o.partIndex,o.charIndex,s.partIndex,s.charIndex,n)}getColumnOfNodeOffset(t,e){return dee(this._characterMapping,t,e)}},aK=class extends oO{_readVisibleRangesForRange(t,e,i,n,o){let s=super._readVisibleRangesForRange(t,e,i,n,o);if(!s||s.length===0||i===n||i===1&&n===this._characterMapping.length)return s;if(!this.input.containsRTL){let a=this._readPixelOffset(t,e,n,o);if(a!==-1){let l=s[s.length-1];l.left<a&&(l.width=a-l.left)}}return s}},lee=function(){return dd?Vue:Wue}();function Vue(r,t,e,i,n){return new aK(r,t,e,i,n)}function Wue(r,t,e,i,n){return new oO(r,t,e,i,n)}function dee(r,t,e){let i=t.textContent.length,n=-1;for(;t;)t=t.previousSibling,n++;return r.getColumn(new Ix(n,e),i)}var Zp="monaco-mouse-cursor-text";var rO=class{constructor(t,e,i,n,o,s,a){this.top=t;this.left=e;this.paddingLeft=i;this.width=n;this.height=o;this.textContent=s;this.textContentClassName=a}};var Tx=class{_context;_domNode;_cursorStyle;_lineCursorWidth;_lineHeight;_typicalHalfwidthCharacterWidth;_isVisible;_position;_pluralityClass;_lastRenderedContent;_renderData;constructor(t,e){this._context=t;let i=this._context.configuration.options,n=i.get(51);this._cursorStyle=i.get(28),this._lineHeight=i.get(68),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=ut(document.createElement("div")),this._domNode.setClassName(`cursor ${Zp}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),rn(this._domNode,n),this._domNode.setDisplay("none"),this._position=new U(1,1),this._pluralityClass="",this.setPlurality(e),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(t){switch(t){default:case 0:this._pluralityClass="";break;case 1:this._pluralityClass="cursor-primary";break;case 2:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(51);return this._cursorStyle=e.get(28),this._lineHeight=e.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(e.get(31),this._typicalHalfwidthCharacterWidth),rn(this._domNode,i),!0}onCursorPositionChanged(t,e){return e?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=t,!0}_getGraphemeAwarePosition(){let{lineNumber:t,column:e}=this._position,i=this._context.viewModel.getLineContent(t),[n,o]=hD(i,e-1);return[new U(t,n+1),i.substring(n,o)]}_prepareRender(t){let e="",i="",[n,o]=this._getGraphemeAwarePosition();if(this._cursorStyle===1||this._cursorStyle===4){let p=t.visibleRangeForPosition(n);if(!p||p.outsideRenderedLine)return null;let m=oe(this._domNode.domNode),g;this._cursorStyle===1?(g=Kv(m,this._lineCursorWidth>0?this._lineCursorWidth:2),g>2&&(e=o,i=this._getTokenClassName(n))):g=Kv(m,1);let f=p.left,b=0;g>=2&&f>=1&&(b=1,f-=b);let y=t.getVerticalOffsetForLineNumber(n.lineNumber)-t.bigNumbersDelta;return new rO(y,f,b,g,this._lineHeight,e,i)}let s=t.linesVisibleRangesForRange(new F(n.lineNumber,n.column,n.lineNumber,n.column+o.length),!1);if(!s||s.length===0)return null;let a=s[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;let l=a.ranges[0],d=o==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===2&&(e=o,i=this._getTokenClassName(n));let c=t.getVerticalOffsetForLineNumber(n.lineNumber)-t.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===3||this._cursorStyle===6)&&(c+=this._lineHeight-2,u=2),new rO(c,l.left,0,d,u,e,i)}_getTokenClassName(t){let e=this._context.viewModel.getViewLineData(t.lineNumber),i=e.tokens.findTokenIndexAtOffset(t.column-1);return e.tokens.getClassName(i)}prepareRender(t){this._renderData=this._prepareRender(t)}render(t){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${Zp} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}};var ab=class r{static whitespaceVisibleColumn(t,e,i){let n=t.length,o=0,s=-1,a=-1;for(let l=0;l<n;l++){if(l===e)return[s,a,o];switch(o%i===0&&(s=l,a=o),t.charCodeAt(l)){case 32:o+=1;break;case 9:o=Ni.nextRenderTabStop(o,i);break;default:return[-1,-1,-1]}}return e===n?[s,a,o]:[-1,-1,-1]}static atomicPosition(t,e,i,n){let o=t.length,[s,a,l]=r.whitespaceVisibleColumn(t,e,i);if(l===-1)return-1;let d;switch(n){case 0:d=!0;break;case 1:d=!1;break;case 2:if(l%i===0)return e;d=l%i<=i/2;break}if(d){if(s===-1)return-1;let p=a;for(let m=s;m<o;++m){if(p===a+i)return s;switch(t.charCodeAt(m)){case 32:p+=1;break;case 9:p=Ni.nextRenderTabStop(p,i);break;default:return-1}}return p===a+i?s:-1}let c=Ni.nextRenderTabStop(l,i),u=l;for(let p=e;p<o;p++){if(u===c)return p;switch(t.charCodeAt(p)){case 32:u+=1;break;case 9:u=Ni.nextRenderTabStop(u,i);break;default:return-1}}return u===c?o:-1}};var Cu=class{constructor(t=null){this.hitTarget=t}type=0},sO=class{constructor(t,e,i){this.position=t;this.spanNode=e;this.injectedText=i}type=1;get hitTarget(){return this.spanNode}},dC;(t=>{function r(e,i,n){let o=e.getPositionFromDOMInfo(i,n);return o?new sO(o,i,null):new Cu(i)}t.createFromDOMInfo=r})(dC||={});var aO=class{constructor(t,e){this.lastViewCursorsRenderData=t;this.lastTextareaPosition=e}},Ao=class{static _deduceRage(t,e=null){return!e&&t?new F(t.lineNumber,t.column,t.lineNumber,t.column):e??null}static createUnknown(t,e,i){return{type:0,element:t,mouseColumn:e,position:i,range:this._deduceRage(i)}}static createTextarea(t,e){return{type:1,element:t,mouseColumn:e,position:null,range:null}}static createMargin(t,e,i,n,o,s){return{type:t,element:e,mouseColumn:i,position:n,range:o,detail:s}}static createViewZone(t,e,i,n,o){return{type:t,element:e,mouseColumn:i,position:n,range:this._deduceRage(n),detail:o}}static createContentText(t,e,i,n,o){return{type:6,element:t,mouseColumn:e,position:i,range:this._deduceRage(i,n),detail:o}}static createContentEmpty(t,e,i,n){return{type:7,element:t,mouseColumn:e,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(t,e,i){return{type:9,element:t,mouseColumn:e,position:null,range:null,detail:i}}static createScrollbar(t,e,i){return{type:11,element:t,mouseColumn:e,position:i,range:this._deduceRage(i)}}static createOverlayWidget(t,e,i){return{type:12,element:t,mouseColumn:e,position:null,range:null,detail:i}}static createOutsideEditor(t,e,i,n){return{type:13,element:null,mouseColumn:t,position:e,range:this._deduceRage(e),outsidePosition:i,outsideDistance:n}}static _typeToString(t){return t===1?"TEXTAREA":t===2?"GUTTER_GLYPH_MARGIN":t===3?"GUTTER_LINE_NUMBERS":t===4?"GUTTER_LINE_DECORATIONS":t===5?"GUTTER_VIEW_ZONE":t===6?"CONTENT_TEXT":t===7?"CONTENT_EMPTY":t===8?"CONTENT_VIEW_ZONE":t===9?"CONTENT_WIDGET":t===10?"OVERVIEW_RULER":t===11?"SCROLLBAR":t===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(t){return this._typeToString(t.type)+": "+t.position+" - "+t.range+" - "+JSON.stringify(t.detail)}},hr=class{static isTextArea(t){return t.length===2&&t[0]===3&&t[1]===7}static isChildOfViewLines(t){return t.length>=4&&t[0]===3&&t[3]===8}static isStrictChildOfViewLines(t){return t.length>4&&t[0]===3&&t[3]===8}static isChildOfScrollableElement(t){return t.length>=2&&t[0]===3&&t[1]===6}static isChildOfMinimap(t){return t.length>=2&&t[0]===3&&t[1]===9}static isChildOfContentWidgets(t){return t.length>=4&&t[0]===3&&t[3]===1}static isChildOfOverflowGuard(t){return t.length>=1&&t[0]===3}static isChildOfOverflowingContentWidgets(t){return t.length>=1&&t[0]===2}static isChildOfOverlayWidgets(t){return t.length>=2&&t[0]===3&&t[1]===4}static isChildOfOverflowingOverlayWidgets(t){return t.length>=1&&t[0]===5}},cC=class r{viewModel;layoutInfo;viewDomNode;lineHeight;stickyTabStops;typicalHalfwidthCharacterWidth;lastRenderData;_context;_viewHelper;constructor(t,e,i){this.viewModel=t.viewModel;let n=t.configuration.options;this.layoutInfo=n.get(147),this.viewDomNode=e.viewDomNode,this.lineHeight=n.get(68),this.stickyTabStops=n.get(118),this.typicalHalfwidthCharacterWidth=n.get(51).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=t,this._viewHelper=e}getZoneAtCoord(t){return r.getZoneAtCoord(this._context,t)}static getZoneAtCoord(t,e){let i=t.viewLayout.getWhitespaceAtVerticalOffset(e);if(i){let n=i.verticalOffset+i.height/2,o=t.viewModel.getLineCount(),s=null,a,l=null;return i.afterLineNumber!==o&&(l=new U(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(s=new U(i.afterLineNumber,t.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=s:s===null?a=l:e<n?a=s:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:s,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(t){if(this._context.viewLayout.isAfterLines(t)){let n=this._context.viewModel.getLineCount(),o=this._context.viewModel.getLineMaxColumn(n);return{range:new F(n,o,n,o),isAfterLines:!0}}let e=this._context.viewLayout.getLineNumberAtVerticalOffset(t),i=this._context.viewModel.getLineMaxColumn(e);return{range:new F(e,1,e,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(t){return this._context.viewLayout.getLineNumberAtVerticalOffset(t)}isAfterLines(t){return this._context.viewLayout.isAfterLines(t)}isInTopPadding(t){return this._context.viewLayout.isInTopPadding(t)}isInBottomPadding(t){return this._context.viewLayout.isInBottomPadding(t)}getVerticalOffsetForLineNumber(t){return this._context.viewLayout.getVerticalOffsetForLineNumber(t)}findAttribute(t,e){return r._findAttribute(t,e,this._viewHelper.viewDomNode)}static _findAttribute(t,e,i){for(;t&&t!==t.ownerDocument.body;){if(t.hasAttribute&&t.hasAttribute(e))return t.getAttribute(e);if(t===i)return null;t=t.parentNode}return null}getLineWidth(t){return this._viewHelper.getLineWidth(t)}visibleRangeForPosition(t,e){return this._viewHelper.visibleRangeForPosition(t,e)}getPositionFromDOMInfo(t,e){return this._viewHelper.getPositionFromDOMInfo(t,e)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}},dK=class{editorPos;pos;relativePos;mouseVerticalOffset;isInMarginArea;isInContentArea;mouseContentHorizontalOffset;mouseColumn;constructor(t,e,i,n){this.editorPos=e,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,t.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=t.getCurrentScrollLeft()+this.relativePos.x-t.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<t.layoutInfo.contentLeft&&this.relativePos.x>=t.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,uC._getMouseColumn(this.mouseContentHorizontalOffset,t.typicalHalfwidthCharacterWidth))}},cK=class extends dK{_ctx;_eventTarget;hitTestResult=new an(()=>uC.doHitTest(this._ctx,this));_useHitTestTarget;_targetPathCacheElement=null;_targetPathCacheValue=new Uint8Array(0);get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Ro.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(t,e,i,n,o){super(t,e,i,n),this._ctx=t,this._eventTarget=o;let s=!!this._eventTarget;this._useHitTestTarget=!s}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(t=null){return t&&t.column<this._ctx.viewModel.getLineMaxColumn(t.lineNumber)?Ni.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(t.lineNumber),t.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(t=null){return Ao.createUnknown(this.target,this._getMouseColumn(t),t)}fulfillTextarea(){return Ao.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(t,e,i,n){return Ao.createMargin(t,this.target,this._getMouseColumn(e),e,i,n)}fulfillViewZone(t,e,i){return Ao.createViewZone(t,this.target,this._getMouseColumn(e),e,i)}fulfillContentText(t,e,i){return Ao.createContentText(this.target,this._getMouseColumn(t),t,e,i)}fulfillContentEmpty(t,e){return Ao.createContentEmpty(this.target,this._getMouseColumn(t),t,e)}fulfillContentWidget(t){return Ao.createContentWidget(this.target,this._getMouseColumn(),t)}fulfillScrollbar(t){return Ao.createScrollbar(this.target,this._getMouseColumn(t),t)}fulfillOverlayWidget(t){return Ao.createOverlayWidget(this.target,this._getMouseColumn(),t)}},cee={isAfterLines:!0};function lK(r){return{isAfterLines:!1,horizontalDistanceToText:r}}var uC=class r{_context;_viewHelper;constructor(t,e){this._context=t,this._viewHelper=e}mouseTargetIsWidget(t){let e=t.target,i=Ro.collect(e,this._viewHelper.viewDomNode);return!!(hr.isChildOfContentWidgets(i)||hr.isChildOfOverflowingContentWidgets(i)||hr.isChildOfOverlayWidgets(i)||hr.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(t,e,i,n,o){let s=new cC(this._context,this._viewHelper,t),a=new cK(s,e,i,n,o);try{let l=r._createMouseTarget(s,a);if(l.type===6&&s.stickyTabStops&&l.position!==null){let d=r._snapToSoftTabBoundary(l.position,s.viewModel),c=F.fromPositions(d,d).plusRange(l.range);return a.fulfillContentText(d,c,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(t,e){if(e.target===null)return e.fulfillUnknown();let i=e,n=null;return!hr.isChildOfOverflowGuard(e.targetPath)&&!hr.isChildOfOverflowingContentWidgets(e.targetPath)&&!hr.isChildOfOverflowingOverlayWidgets(e.targetPath)&&(n=n||e.fulfillUnknown()),n=n||r._hitTestContentWidget(t,i),n=n||r._hitTestOverlayWidget(t,i),n=n||r._hitTestMinimap(t,i),n=n||r._hitTestScrollbarSlider(t,i),n=n||r._hitTestViewZone(t,i),n=n||r._hitTestMargin(t,i),n=n||r._hitTestViewCursor(t,i),n=n||r._hitTestTextArea(t,i),n=n||r._hitTestViewLines(t,i),n=n||r._hitTestScrollbar(t,i),n||e.fulfillUnknown()}static _hitTestContentWidget(t,e){if(hr.isChildOfContentWidgets(e.targetPath)||hr.isChildOfOverflowingContentWidgets(e.targetPath)){let i=t.findAttribute(e.target,"widgetId");return i?e.fulfillContentWidget(i):e.fulfillUnknown()}return null}static _hitTestOverlayWidget(t,e){if(hr.isChildOfOverlayWidgets(e.targetPath)||hr.isChildOfOverflowingOverlayWidgets(e.targetPath)){let i=t.findAttribute(e.target,"widgetId");return i?e.fulfillOverlayWidget(i):e.fulfillUnknown()}return null}static _hitTestViewCursor(t,e){if(e.target){let i=t.lastRenderData.lastViewCursorsRenderData;for(let n of i)if(e.target===n.domNode)return e.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(e.isInContentArea){let i=t.lastRenderData.lastViewCursorsRenderData,n=e.mouseContentHorizontalOffset,o=e.mouseVerticalOffset;for(let s of i){if(n<s.contentLeft||n>s.contentLeft+s.width)continue;let a=t.getVerticalOffsetForLineNumber(s.position.lineNumber);if(a<=o&&o<=a+s.height)return e.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(t,e){let i=t.getZoneAtCoord(e.mouseVerticalOffset);if(i){let n=e.isInContentArea?8:5;return e.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(t,e){return hr.isTextArea(e.targetPath)?t.lastRenderData.lastTextareaPosition?e.fulfillContentText(t.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):e.fulfillTextarea():null}static _hitTestMargin(t,e){if(e.isInMarginArea){let i=t.getFullLineRangeAtCoord(e.mouseVerticalOffset),n=i.range.getStartPosition(),o=Math.abs(e.relativePos.x),s={isAfterLines:i.isAfterLines,glyphMarginLeft:t.layoutInfo.glyphMarginLeft,glyphMarginWidth:t.layoutInfo.glyphMarginWidth,lineNumbersWidth:t.layoutInfo.lineNumbersWidth,offsetX:o};if(o-=t.layoutInfo.glyphMarginLeft,o<=t.layoutInfo.glyphMarginWidth){let a=t.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=t.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return s.glyphMarginLane=l[Math.floor(o/t.lineHeight)],e.fulfillMargin(2,n,i.range,s)}return o-=t.layoutInfo.glyphMarginWidth,o<=t.layoutInfo.lineNumbersWidth?e.fulfillMargin(3,n,i.range,s):(o-=t.layoutInfo.lineNumbersWidth,e.fulfillMargin(4,n,i.range,s))}return null}static _hitTestViewLines(t,e){if(!hr.isChildOfViewLines(e.targetPath))return null;if(t.isInTopPadding(e.mouseVerticalOffset))return e.fulfillContentEmpty(new U(1,1),cee);if(t.isAfterLines(e.mouseVerticalOffset)||t.isInBottomPadding(e.mouseVerticalOffset)){let n=t.viewModel.getLineCount(),o=t.viewModel.getLineMaxColumn(n);return e.fulfillContentEmpty(new U(n,o),cee)}if(hr.isStrictChildOfViewLines(e.targetPath)){let n=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset);if(t.viewModel.getLineLength(n)===0){let s=t.getLineWidth(n),a=lK(e.mouseContentHorizontalOffset-s);return e.fulfillContentEmpty(new U(n,1),a)}let o=t.getLineWidth(n);if(e.mouseContentHorizontalOffset>=o){let s=lK(e.mouseContentHorizontalOffset-o),a=new U(n,t.viewModel.getLineMaxColumn(n));return e.fulfillContentEmpty(a,s)}}let i=e.hitTestResult.value;return i.type===1?r.createMouseTargetFromHitTestPosition(t,e,i.spanNode,i.position,i.injectedText):e.wouldBenefitFromHitTestTargetSwitch?(e.switchToHitTestTarget(),this._createMouseTarget(t,e)):e.fulfillUnknown()}static _hitTestMinimap(t,e){if(hr.isChildOfMinimap(e.targetPath)){let i=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),n=t.viewModel.getLineMaxColumn(i);return e.fulfillScrollbar(new U(i,n))}return null}static _hitTestScrollbarSlider(t,e){if(hr.isChildOfScrollableElement(e.targetPath)&&e.target&&e.target.nodeType===1){let i=e.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){let n=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),o=t.viewModel.getLineMaxColumn(n);return e.fulfillScrollbar(new U(n,o))}}return null}static _hitTestScrollbar(t,e){if(hr.isChildOfScrollableElement(e.targetPath)){let i=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),n=t.viewModel.getLineMaxColumn(i);return e.fulfillScrollbar(new U(i,n))}return null}getMouseColumn(t){let e=this._context.configuration.options,i=e.get(147),n=this._context.viewLayout.getCurrentScrollLeft()+t.x-i.contentLeft;return r._getMouseColumn(n,e.get(51).typicalHalfwidthCharacterWidth)}static _getMouseColumn(t,e){return t<0?1:Math.round(t/e)+1}static createMouseTargetFromHitTestPosition(t,e,i,n,o){let s=n.lineNumber,a=n.column,l=t.getLineWidth(s);if(e.mouseContentHorizontalOffset>l){let y=lK(e.mouseContentHorizontalOffset-l);return e.fulfillContentEmpty(n,y)}let d=t.visibleRangeForPosition(s,a);if(!d)return e.fulfillUnknown(n);let c=d.left;if(Math.abs(e.mouseContentHorizontalOffset-c)<1)return e.fulfillContentText(n,null,{mightBeForeignElement:!!o,injectedText:o});let u=[];if(u.push({offset:d.left,column:a}),a>1){let y=t.visibleRangeForPosition(s,a-1);y&&u.push({offset:y.left,column:a-1})}let p=t.viewModel.getLineMaxColumn(s);if(a<p){let y=t.visibleRangeForPosition(s,a+1);y&&u.push({offset:y.left,column:a+1})}u.sort((y,I)=>y.offset-I.offset);let m=e.pos.toClientCoordinates(oe(t.viewDomNode)),g=i.getBoundingClientRect(),f=g.left<=m.clientX&&m.clientX<=g.right,b=null;for(let y=1;y<u.length;y++){let I=u[y-1],E=u[y];if(I.offset<=e.mouseContentHorizontalOffset&&e.mouseContentHorizontalOffset<=E.offset){b=new F(s,I.column,s,E.column);let S=Math.abs(I.offset-e.mouseContentHorizontalOffset),w=Math.abs(E.offset-e.mouseContentHorizontalOffset);n=S<w?new U(s,I.column):new U(s,E.column);break}}return e.fulfillContentText(n,b,{mightBeForeignElement:!f||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(t,e){let i=t.getLineNumberAtVerticalOffset(e.mouseVerticalOffset),n=t.getVerticalOffsetForLineNumber(i),o=n+t.lineHeight;if(!(i===t.viewModel.getLineCount()&&e.mouseVerticalOffset>o)){let a=Math.floor((n+o)/2),l=e.pos.y+(a-e.mouseVerticalOffset);l<=e.editorPos.y&&(l=e.editorPos.y+1),l>=e.editorPos.y+e.editorPos.height&&(l=e.editorPos.y+e.editorPos.height-1);let d=new Gm(e.pos.x,l),c=this._actualDoHitTestWithCaretRangeFromPoint(t,d.toClientCoordinates(oe(t.viewDomNode)));if(c.type===1)return c}return this._actualDoHitTestWithCaretRangeFromPoint(t,e.pos.toClientCoordinates(oe(t.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(t,e){let i=cp(t.viewDomNode),n;if(i?typeof i.caretRangeFromPoint>"u"?n=zue(i,e.clientX,e.clientY):n=i.caretRangeFromPoint(e.clientX,e.clientY):n=t.viewDomNode.ownerDocument.caretRangeFromPoint(e.clientX,e.clientY),!n||!n.startContainer)return new Cu;let o=n.startContainer;if(o.nodeType===o.TEXT_NODE){let s=o.parentNode,a=s?s.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Qd.CLASS_NAME?dC.createFromDOMInfo(t,s,n.startOffset):new Cu(o.parentNode)}else if(o.nodeType===o.ELEMENT_NODE){let s=o.parentNode,a=s?s.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Qd.CLASS_NAME?dC.createFromDOMInfo(t,o,o.textContent.length):new Cu(o)}return new Cu}static _doHitTestWithCaretPositionFromPoint(t,e){let i=t.viewDomNode.ownerDocument.caretPositionFromPoint(e.clientX,e.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){let n=i.offsetNode.parentNode,o=n?n.parentNode:null,s=o?o.parentNode:null;return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===Qd.CLASS_NAME?dC.createFromDOMInfo(t,i.offsetNode.parentNode,i.offset):new Cu(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){let n=i.offsetNode.parentNode,o=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,s=n?n.parentNode:null,a=s&&s.nodeType===s.ELEMENT_NODE?s.className:null;if(o===Qd.CLASS_NAME){let l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return dC.createFromDOMInfo(t,l,0)}else if(a===Qd.CLASS_NAME)return dC.createFromDOMInfo(t,i.offsetNode,0)}return new Cu(i.offsetNode)}static _snapToSoftTabBoundary(t,e){let i=e.getLineContent(t.lineNumber),{tabSize:n}=e.model.getOptions(),o=ab.atomicPosition(i,t.column-1,n,2);return o!==-1?new U(t.lineNumber,o+1):t}static doHitTest(t,e){let i=new Cu;if(typeof t.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(t,e):t.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(t,e.pos.toClientCoordinates(oe(t.viewDomNode)))),i.type===1){let n=t.viewModel.getInjectedTextAt(i.position),o=t.viewModel.normalizePosition(i.position,2);(n||!o.equals(i.position))&&(i=new sO(o,i.spanNode,n))}return i}};function zue(r,t,e){let i=document.createRange(),n=r.elementFromPoint(t,e);if(n!==null){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;let o=n.getBoundingClientRect(),s=oe(n),a=s.getComputedStyle(n,null).getPropertyValue("font-style"),l=s.getComputedStyle(n,null).getPropertyValue("font-variant"),d=s.getComputedStyle(n,null).getPropertyValue("font-weight"),c=s.getComputedStyle(n,null).getPropertyValue("font-size"),u=s.getComputedStyle(n,null).getPropertyValue("line-height"),p=s.getComputedStyle(n,null).getPropertyValue("font-family"),m=`${a} ${l} ${d} ${c}/${u} ${p}`,g=n.innerText,f=o.left,b=0,y;if(t>o.left+o.width)b=g.length;else{let I=uK.getInstance();for(let E=0;E<g.length+1;E++){if(y=I.getCharWidth(g.charAt(E),m)/2,f+=y,t<f){b=E;break}f+=y}}i.setStart(n.firstChild,b),i.setEnd(n.firstChild,b)}return i}var uK=class r{static _INSTANCE=null;static getInstance(){return r._INSTANCE||(r._INSTANCE=new r),r._INSTANCE}_cache;_canvas;constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(t,e){let i=t+e;if(this._cache[i])return this._cache[i];let n=this._canvas.getContext("2d");n.font=e;let s=n.measureText(t).width;return this._cache[i]=s,s}};var $m=class r{static columnSelect(t,e,i,n,o,s){let a=Math.abs(o-i)+1,l=i>o,d=n>s,c=n<s,u=[];for(let p=0;p<a;p++){let m=i+(l?-p:p),g=t.columnFromVisibleColumn(e,m,n),f=t.columnFromVisibleColumn(e,m,s),b=t.visibleColumnFromColumn(e,new U(m,g)),y=t.visibleColumnFromColumn(e,new U(m,f));c&&(b>s||y<n)||d&&(y>n||b<s)||u.push(new Yn(new F(m,g,m,g),0,0,new U(m,f),0))}if(u.length===0)for(let p=0;p<a;p++){let m=i+(l?-p:p),g=e.getLineMaxColumn(m);u.push(new Yn(new F(m,g,m,g),0,0,new U(m,g),0))}return{viewStates:u,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:o,toVisualColumn:s}}static columnSelectLeft(t,e,i){let n=i.toViewVisualColumn;return n>0&&n--,r.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(t,e,i){let n=0,o=Math.min(i.fromViewLineNumber,i.toViewLineNumber),s=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=o;l<=s;l++){let d=e.getLineMaxColumn(l),c=t.visibleColumnFromColumn(e,new U(l,d));n=Math.max(n,c)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(t,e,i,n){let o=n?t.pageSize:1,s=Math.max(1,i.toViewLineNumber-o);return this.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,s,i.toViewVisualColumn)}static columnSelectDown(t,e,i,n){let o=n?t.pageSize:1,s=Math.min(e.getLineCount(),i.toViewLineNumber+o);return this.columnSelect(t,e,i.fromViewLineNumber,i.fromViewVisualColumn,s,i.toViewVisualColumn)}};var mr=class{_range;_text;insertsAutoWhitespace;constructor(t,e,i=!1){this._range=t,this._text=e,this.insertsAutoWhitespace=i}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return It.fromPositions(n.getEndPosition())}};var db=class{_range;_text;insertsAutoWhitespace;constructor(t,e,i=!1){this._range=t,this._text=e,this.insertsAutoWhitespace=i}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return It.fromPositions(n.getStartPosition())}},cb=class{_range;_text;_columnDeltaOffset;_lineNumberDeltaOffset;insertsAutoWhitespace;constructor(t,e,i,n,o=!1){this._range=t,this._text=e,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return It.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}},cO=class{_range;_text;_initialSelection;_forceMoveMarkers;_selectionId;constructor(t,e,i,n=!1){this._range=t,this._text=e,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(t,e){e.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=e.trackSelection(this._initialSelection)}computeCursorState(t,e){return e.getTrackedSelection(this._selectionId)}};var xx=class{_cursorPositionBrand=void 0;lineNumber;column;leftoverVisibleColumns;constructor(t,e,i){this.lineNumber=t,this.column=e,this.leftoverVisibleColumns=i}},fn=class r{static leftPosition(t,e){if(e.column>t.getLineMinColumn(e.lineNumber))return e.delta(void 0,-CB(t.getLineContent(e.lineNumber),e.column-1));if(e.lineNumber>1){let i=e.lineNumber-1;return new U(i,t.getLineMaxColumn(i))}else return e}static leftPositionAtomicSoftTabs(t,e,i){if(e.column<=t.getLineIndentColumn(e.lineNumber)){let n=t.getLineMinColumn(e.lineNumber),o=t.getLineContent(e.lineNumber),s=ab.atomicPosition(o,e.column-1,i,0);if(s!==-1&&s+1>=n)return new U(e.lineNumber,s+1)}return this.leftPosition(t,e)}static left(t,e,i){let n=t.stickyTabStops?r.leftPositionAtomicSoftTabs(e,i,t.tabSize):r.leftPosition(e,i);return new xx(n.lineNumber,n.column,0)}static moveLeft(t,e,i,n,o){let s,a;if(i.hasSelection()&&!n)s=i.selection.startLineNumber,a=i.selection.startColumn;else{let l=i.position.delta(void 0,-(o-1)),d=e.normalizePosition(r.clipPositionColumn(l,e),0),c=r.left(t,e,d);s=c.lineNumber,a=c.column}return i.move(n,s,a,0)}static clipPositionColumn(t,e){return new U(t.lineNumber,r.clipRange(t.column,e.getLineMinColumn(t.lineNumber),e.getLineMaxColumn(t.lineNumber)))}static clipRange(t,e,i){return t<e?e:t>i?i:t}static rightPosition(t,e,i){return i<t.getLineMaxColumn(e)?i=i+tw(t.getLineContent(e),i-1):e<t.getLineCount()&&(e=e+1,i=t.getLineMinColumn(e)),new U(e,i)}static rightPositionAtomicSoftTabs(t,e,i,n,o){if(i<t.getLineIndentColumn(e)){let s=t.getLineContent(e),a=ab.atomicPosition(s,i-1,n,1);if(a!==-1)return new U(e,a+1)}return this.rightPosition(t,e,i)}static right(t,e,i){let n=t.stickyTabStops?r.rightPositionAtomicSoftTabs(e,i.lineNumber,i.column,t.tabSize,t.indentSize):r.rightPosition(e,i.lineNumber,i.column);return new xx(n.lineNumber,n.column,0)}static moveRight(t,e,i,n,o){let s,a;if(i.hasSelection()&&!n)s=i.selection.endLineNumber,a=i.selection.endColumn;else{let l=i.position.delta(void 0,o-1),d=e.normalizePosition(r.clipPositionColumn(l,e),1),c=r.right(t,e,d);s=c.lineNumber,a=c.column}return i.move(n,s,a,0)}static vertical(t,e,i,n,o,s,a,l){let d=Ni.visibleColumnFromColumn(e.getLineContent(i),n,t.tabSize)+o,c=e.getLineCount(),u=i===1&&n===1,p=i===c&&n===e.getLineMaxColumn(i),m=s<i?u:p;if(i=s,i<1?(i=1,a?n=e.getLineMinColumn(i):n=Math.min(e.getLineMaxColumn(i),n)):i>c?(i=c,a?n=e.getLineMaxColumn(i):n=Math.min(e.getLineMaxColumn(i),n)):n=t.columnFromVisibleColumn(e,i,d),m?o=0:o=d-Ni.visibleColumnFromColumn(e.getLineContent(i),n,t.tabSize),l!==void 0){let g=new U(i,n),f=e.normalizePosition(g,l);o=o+(n-f.column),i=f.lineNumber,n=f.column}return new xx(i,n,o)}static down(t,e,i,n,o,s,a){return this.vertical(t,e,i,n,o,i+s,a,4)}static moveDown(t,e,i,n,o){let s,a;i.hasSelection()&&!n?(s=i.selection.endLineNumber,a=i.selection.endColumn):(s=i.position.lineNumber,a=i.position.column);let l=0,d;do if(d=r.down(t,e,s+l,a,i.leftoverVisibleColumns,o,!0),e.normalizePosition(new U(d.lineNumber,d.column),2).lineNumber>s)break;while(l++<10&&s+l<e.getLineCount());return i.move(n,d.lineNumber,d.column,d.leftoverVisibleColumns)}static translateDown(t,e,i){let n=i.selection,o=r.down(t,e,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),s=r.down(t,e,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new Yn(new F(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new U(s.lineNumber,s.column),s.leftoverVisibleColumns)}static up(t,e,i,n,o,s,a){return this.vertical(t,e,i,n,o,i-s,a,3)}static moveUp(t,e,i,n,o){let s,a;i.hasSelection()&&!n?(s=i.selection.startLineNumber,a=i.selection.startColumn):(s=i.position.lineNumber,a=i.position.column);let l=r.up(t,e,s,a,i.leftoverVisibleColumns,o,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(t,e,i){let n=i.selection,o=r.up(t,e,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),s=r.up(t,e,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new Yn(new F(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new U(s.lineNumber,s.column),s.leftoverVisibleColumns)}static _isBlankLine(t,e){return t.getLineFirstNonWhitespaceColumn(e)===0}static moveToPrevBlankLine(t,e,i,n){let o=i.position.lineNumber;for(;o>1&&this._isBlankLine(e,o);)o--;for(;o>1&&!this._isBlankLine(e,o);)o--;return i.move(n,o,e.getLineMinColumn(o),0)}static moveToNextBlankLine(t,e,i,n){let o=e.getLineCount(),s=i.position.lineNumber;for(;s<o&&this._isBlankLine(e,s);)s++;for(;s<o&&!this._isBlankLine(e,s);)s++;return i.move(n,s,e.getLineMinColumn(s),0)}static moveToBeginningOfLine(t,e,i,n){let o=i.position.lineNumber,s=e.getLineMinColumn(o),a=e.getLineFirstNonWhitespaceColumn(o)||s,l;return i.position.column===a?l=s:l=a,i.move(n,o,l,0)}static moveToEndOfLine(t,e,i,n,o){let s=i.position.lineNumber,a=e.getLineMaxColumn(s);return i.move(n,s,a,o?1073741824-a:0)}static moveToBeginningOfBuffer(t,e,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(t,e,i,n){let o=e.getLineCount(),s=e.getLineMaxColumn(o);return i.move(n,o,s,0)}};var Xp=class r{static deleteRight(t,e,i,n){let o=[],s=t!==3;for(let a=0,l=n.length;a<l;a++){let d=n[a],c=d;if(c.isEmpty()){let u=d.getPosition(),p=fn.right(e,i,u);c=new F(p.lineNumber,p.column,u.lineNumber,u.column)}if(c.isEmpty()){o[a]=null;continue}c.startLineNumber!==c.endLineNumber&&(s=!0),o[a]=new mr(c,"")}return[s,o]}static isAutoClosingPairDelete(t,e,i,n,o,s,a){if(e==="never"&&i==="never"||t==="never")return!1;for(let l=0,d=s.length;l<d;l++){let c=s[l],u=c.getPosition();if(!c.isEmpty())return!1;let p=o.getLineContent(u.lineNumber);if(u.column<2||u.column>=p.length+1)return!1;let m=p.charAt(u.column-2),g=n.get(m);if(!g)return!1;if(qd(m)){if(i==="never")return!1}else if(e==="never")return!1;let f=p.charAt(u.column-1),b=!1;for(let y of g)y.open===m&&y.close===f&&(b=!0);if(!b)return!1;if(t==="auto"){let y=!1;for(let I=0,E=a.length;I<E;I++){let S=a[I];if(u.lineNumber===S.startLineNumber&&u.column===S.startColumn){y=!0;break}}if(!y)return!1}}return!0}static _runAutoClosingPairDelete(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].getPosition(),l=new F(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[o]=new mr(l,"")}return[!0,n]}static deleteLeft(t,e,i,n,o){if(this.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,o))return this._runAutoClosingPairDelete(e,i,n);let s=[],a=t!==2;for(let l=0,d=n.length;l<d;l++){let c=r.getDeleteRange(n[l],i,e);if(c.isEmpty()){s[l]=null;continue}c.startLineNumber!==c.endLineNumber&&(a=!0),s[l]=new mr(c,"")}return[a,s]}static getDeleteRange(t,e,i){if(!t.isEmpty())return t;let n=t.getPosition();if(i.useTabStops&&n.column>1){let o=e.getLineContent(n.lineNumber),s=Rn(o),a=s===-1?o.length+1:s+1;if(n.column<=a){let l=i.visibleColumnFromColumn(e,n),d=Ni.prevIndentTabStop(l,i.indentSize),c=i.columnFromVisibleColumn(e,n.lineNumber,d);return new F(n.lineNumber,c,n.lineNumber,n.column)}}return F.fromPositions(r.getPositionAfterDeleteLeft(n,e),n)}static getPositionAfterDeleteLeft(t,e){if(t.column>1){let i=iG(t.column-1,e.getLineContent(t.lineNumber));return t.with(void 0,i+1)}else if(t.lineNumber>1){let i=t.lineNumber-1;return new U(i,e.getLineMaxColumn(i))}else return t}static cut(t,e,i){let n=[],o=null;i.sort((s,a)=>U.compare(s.getStartPosition(),a.getEndPosition()));for(let s=0,a=i.length;s<a;s++){let l=i[s];if(l.isEmpty())if(t.emptySelectionClipboard){let d=l.getPosition(),c,u,p,m;d.lineNumber<e.getLineCount()?(c=d.lineNumber,u=1,p=d.lineNumber+1,m=1):d.lineNumber>1&&o?.endLineNumber!==d.lineNumber?(c=d.lineNumber-1,u=e.getLineMaxColumn(d.lineNumber-1),p=d.lineNumber,m=e.getLineMaxColumn(d.lineNumber)):(c=d.lineNumber,u=1,p=d.lineNumber,m=e.getLineMaxColumn(d.lineNumber));let g=new F(c,u,p,m);o=g,g.isEmpty()?n[s]=null:n[s]=new mr(g,"")}else n[s]=null;else n[s]=new mr(l,"")}return new fo(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}};var pC=class r{static _createWord(t,e,i,n,o){return{start:n,end:o,wordType:e,nextCharClass:i}}static _createIntlWord(t,e){return{start:t.index,end:t.index+t.segment.length,wordType:1,nextCharClass:e}}static _findPreviousWordOnLine(t,e,i){let n=e.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,t,i)}static _doFindPreviousWordOnLine(t,e,i){let n=0,o=e.findPrevIntlWordBeforeOrAtOffset(t,i.column-2);for(let s=i.column-2;s>=0;s--){let a=t.charCodeAt(s),l=e.get(a);if(o&&s===o.index)return this._createIntlWord(o,l);if(l===0){if(n===2)return this._createWord(t,n,l,s+1,this._findEndOfWord(t,e,n,s+1));n=1}else if(l===2){if(n===1)return this._createWord(t,n,l,s+1,this._findEndOfWord(t,e,n,s+1));n=2}else if(l===1&&n!==0)return this._createWord(t,n,l,s+1,this._findEndOfWord(t,e,n,s+1))}return n!==0?this._createWord(t,n,1,0,this._findEndOfWord(t,e,n,0)):null}static _findEndOfWord(t,e,i,n){let o=e.findNextIntlWordAtOrAfterOffset(t,n),s=t.length;for(let a=n;a<s;a++){let l=t.charCodeAt(a),d=e.get(l);if(o&&a===o.index+o.segment.length||d===1||i===1&&d===2||i===2&&d===0)return a}return s}static _findNextWordOnLine(t,e,i){let n=e.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,t,i)}static _doFindNextWordOnLine(t,e,i){let n=0,o=t.length,s=e.findNextIntlWordAtOrAfterOffset(t,i.column-1);for(let a=i.column-1;a<o;a++){let l=t.charCodeAt(a),d=e.get(l);if(s&&a===s.index)return this._createIntlWord(s,d);if(d===0){if(n===2)return this._createWord(t,n,d,this._findStartOfWord(t,e,n,a-1),a);n=1}else if(d===2){if(n===1)return this._createWord(t,n,d,this._findStartOfWord(t,e,n,a-1),a);n=2}else if(d===1&&n!==0)return this._createWord(t,n,d,this._findStartOfWord(t,e,n,a-1),a)}return n!==0?this._createWord(t,n,1,this._findStartOfWord(t,e,n,o-1),o):null}static _findStartOfWord(t,e,i,n){let o=e.findPrevIntlWordBeforeOrAtOffset(t,n);for(let s=n;s>=0;s--){let a=t.charCodeAt(s),l=e.get(a);if(o&&s===o.index)return s;if(l===1||i===1&&l===2||i===2&&l===0)return s+1}return 0}static moveWordLeft(t,e,i,n,o){let s=i.lineNumber,a=i.column;a===1&&s>1&&(s=s-1,a=e.getLineMaxColumn(s));let l=r._findPreviousWordOnLine(t,e,new U(s,a));if(n===0)return new U(s,l?l.start+1:1);if(n===1)return!o&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findPreviousWordOnLine(t,e,new U(s,l.start+1))),new U(s,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=r._findPreviousWordOnLine(t,e,new U(s,l.start+1));return new U(s,l?l.start+1:1)}return l&&a<=l.end+1&&(l=r._findPreviousWordOnLine(t,e,new U(s,l.start+1))),new U(s,l?l.end+1:1)}static _moveWordPartLeft(t,e){let i=e.lineNumber,n=t.getLineMaxColumn(i);if(e.column===1)return i>1?new U(i-1,t.getLineMaxColumn(i-1)):e;let o=t.getLineContent(i);for(let s=e.column-1;s>1;s--){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a===95&&l!==95)return new U(i,s);if(a===45&&l!==45)return new U(i,s);if((Cg(a)||QS(a))&&vc(l))return new U(i,s);if(vc(a)&&vc(l)&&s+1<n){let d=o.charCodeAt(s);if(Cg(d)||QS(d))return new U(i,s)}}return new U(i,1)}static moveWordRight(t,e,i,n){let o=i.lineNumber,s=i.column,a=!1;s===e.getLineMaxColumn(o)&&o<e.getLineCount()&&(a=!0,o=o+1,s=1);let l=r._findNextWordOnLine(t,e,new U(o,s));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=r._findNextWordOnLine(t,e,new U(o,l.end+1))),l?s=l.end+1:s=e.getLineMaxColumn(o);else if(n===3){for(a&&(s=0);l&&(l.wordType===2||l.start+1<=s);)l=r._findNextWordOnLine(t,e,new U(o,l.end+1));l?s=l.start+1:s=e.getLineMaxColumn(o)}else l&&!a&&s>=l.start+1&&(l=r._findNextWordOnLine(t,e,new U(o,l.end+1))),l?s=l.start+1:s=e.getLineMaxColumn(o);return new U(o,s)}static _moveWordPartRight(t,e){let i=e.lineNumber,n=t.getLineMaxColumn(i);if(e.column===n)return i<t.getLineCount()?new U(i+1,1):e;let o=t.getLineContent(i);for(let s=e.column+1;s<n;s++){let a=o.charCodeAt(s-2),l=o.charCodeAt(s-1);if(a!==95&&l===95)return new U(i,s);if(a!==45&&l===45)return new U(i,s);if((Cg(a)||QS(a))&&vc(l))return new U(i,s);if(vc(a)&&vc(l)&&s+1<n){let d=o.charCodeAt(s);if(Cg(d)||QS(d))return new U(i,s)}}return new U(i,n)}static _deleteWordLeftWhitespace(t,e){let i=t.getLineContent(e.lineNumber),n=e.column-2,o=Ta(i,n);return o+1<n?new F(e.lineNumber,o+2,e.lineNumber,e.column):null}static deleteWordLeft(t,e){let i=t.wordSeparators,n=t.model,o=t.selection,s=t.whitespaceHeuristics;if(!o.isEmpty())return o;if(Xp.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,t.model,[t.selection],t.autoClosedCharacters)){let u=t.selection.getPosition();return new F(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}let a=new U(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column;if(l===1&&d===1)return null;if(s){let u=this._deleteWordLeftWhitespace(n,a);if(u)return u}let c=r._findPreviousWordOnLine(i,n,a);return e===0?c?d=c.start+1:d>1?d=1:(l--,d=n.getLineMaxColumn(l)):(c&&d<=c.end+1&&(c=r._findPreviousWordOnLine(i,n,new U(l,c.start+1))),c?d=c.end+1:d>1?d=1:(l--,d=n.getLineMaxColumn(l))),new F(l,d,a.lineNumber,a.column)}static deleteInsideWord(t,e,i){if(!i.isEmpty())return i;let n=new U(i.positionLineNumber,i.positionColumn),o=this._deleteInsideWordWhitespace(e,n);return o||this._deleteInsideWordDetermineDeleteRange(t,e,n)}static _charAtIsWhitespace(t,e){let i=t.charCodeAt(e);return i===32||i===9}static _deleteInsideWordWhitespace(t,e){let i=t.getLineContent(e.lineNumber),n=i.length;if(n===0)return null;let o=Math.max(e.column-2,0);if(!this._charAtIsWhitespace(i,o))return null;let s=Math.min(e.column-1,n-1);if(!this._charAtIsWhitespace(i,s))return null;for(;o>0&&this._charAtIsWhitespace(i,o-1);)o--;for(;s+1<n&&this._charAtIsWhitespace(i,s+1);)s++;return new F(e.lineNumber,o+1,e.lineNumber,s+2)}static _deleteInsideWordDetermineDeleteRange(t,e,i){let n=e.getLineContent(i.lineNumber),o=n.length;if(o===0)return i.lineNumber>1?new F(i.lineNumber-1,e.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<e.getLineCount()?new F(i.lineNumber,1,i.lineNumber+1,1):new F(i.lineNumber,1,i.lineNumber,1);let s=u=>u.start+1<=i.column&&i.column<=u.end+1,a=(u,p)=>(u=Math.min(u,i.column),p=Math.max(p,i.column),new F(i.lineNumber,u,i.lineNumber,p)),l=u=>{let p=u.start+1,m=u.end+1,g=!1;for(;m-1<o&&this._charAtIsWhitespace(n,m-1);)g=!0,m++;if(!g)for(;p>1&&this._charAtIsWhitespace(n,p-2);)p--;return a(p,m)},d=r._findPreviousWordOnLine(t,e,i);if(d&&s(d))return l(d);let c=r._findNextWordOnLine(t,e,i);return c&&s(c)?l(c):d&&c?a(d.end+1,c.start+1):d?a(d.start+1,d.end+1):c?a(c.start+1,c.end+1):a(1,o+1)}static _deleteWordPartLeft(t,e){if(!e.isEmpty())return e;let i=e.getPosition(),n=r._moveWordPartLeft(t,i);return new F(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(t,e){let i=t.length;for(let n=e;n<i;n++){let o=t.charAt(n);if(o!==" "&&o!=="	")return n}return i}static _deleteWordRightWhitespace(t,e){let i=t.getLineContent(e.lineNumber),n=e.column-1,o=this._findFirstNonWhitespaceChar(i,n);return n+1<o?new F(e.lineNumber,e.column,e.lineNumber,o+1):null}static deleteWordRight(t,e){let i=t.wordSeparators,n=t.model,o=t.selection,s=t.whitespaceHeuristics;if(!o.isEmpty())return o;let a=new U(o.positionLineNumber,o.positionColumn),l=a.lineNumber,d=a.column,c=n.getLineCount(),u=n.getLineMaxColumn(l);if(l===c&&d===u)return null;if(s){let m=this._deleteWordRightWhitespace(n,a);if(m)return m}let p=r._findNextWordOnLine(i,n,a);return e===2?p?d=p.end+1:d<u||l===c?d=u:(l++,p=r._findNextWordOnLine(i,n,new U(l,1)),p?d=p.start+1:d=n.getLineMaxColumn(l)):(p&&d>=p.start+1&&(p=r._findNextWordOnLine(i,n,new U(l,p.end+1))),p?d=p.start+1:d<u||l===c?d=u:(l++,p=r._findNextWordOnLine(i,n,new U(l,1)),p?d=p.start+1:d=n.getLineMaxColumn(l))),new F(l,d,a.lineNumber,a.column)}static _deleteWordPartRight(t,e){if(!e.isEmpty())return e;let i=e.getPosition(),n=r._moveWordPartRight(t,i);return new F(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(t,e,i){let n=new F(e,i.start+1,e,i.end+1);return{word:t.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(t,e,i,n){let o=Mc(e,i),s=r._findPreviousWordOnLine(o,t,n);if(s&&s.wordType===1&&s.start<=n.column-1&&n.column-1<=s.end)return r._createWordAtPosition(t,n.lineNumber,s);let a=r._findNextWordOnLine(o,t,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?r._createWordAtPosition(t,n.lineNumber,a):null}static word(t,e,i,n,o){let s=Mc(t.wordSeparators,t.wordSegmenterLocales),a=r._findPreviousWordOnLine(s,e,o),l=r._findNextWordOnLine(s,e,o);if(!n){let m,g;return a&&a.wordType===1&&a.start<=o.column-1&&o.column-1<=a.end?(m=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=o.column-1&&o.column-1<=l.end?(m=l.start+1,g=l.end+1):(a?m=a.end+1:m=1,l?g=l.start+1:g=e.getLineMaxColumn(o.lineNumber)),new Yn(new F(o.lineNumber,m,o.lineNumber,g),1,0,new U(o.lineNumber,g),0)}let d,c;a&&a.wordType===1&&a.start<o.column-1&&o.column-1<a.end?(d=a.start+1,c=a.end+1):l&&l.wordType===1&&l.start<o.column-1&&o.column-1<l.end?(d=l.start+1,c=l.end+1):(d=o.column,c=o.column);let u=o.lineNumber,p;if(i.selectionStart.containsPosition(o))p=i.selectionStart.endColumn;else if(o.isBeforeOrEqual(i.selectionStart.getStartPosition())){p=d;let m=new U(u,p);i.selectionStart.containsPosition(m)&&(p=i.selectionStart.endColumn)}else{p=c;let m=new U(u,p);i.selectionStart.containsPosition(m)&&(p=i.selectionStart.startColumn)}return i.move(!0,u,p,0)}};var Po=class{static addCursorDown(t,e,i){let n=[],o=0;for(let s=0,a=e.length;s<a;s++){let l=e[s];n[o++]=new Rt(l.modelState,l.viewState),i?n[o++]=Rt.fromModelState(fn.translateDown(t.cursorConfig,t.model,l.modelState)):n[o++]=Rt.fromViewState(fn.translateDown(t.cursorConfig,t,l.viewState))}return n}static addCursorUp(t,e,i){let n=[],o=0;for(let s=0,a=e.length;s<a;s++){let l=e[s];n[o++]=new Rt(l.modelState,l.viewState),i?n[o++]=Rt.fromModelState(fn.translateUp(t.cursorConfig,t.model,l.modelState)):n[o++]=Rt.fromViewState(fn.translateUp(t.cursorConfig,t,l.viewState))}return n}static moveToBeginningOfLine(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];n[o]=this._moveToLineStart(t,a,i)}return n}static _moveToLineStart(t,e,i){let n=e.viewState.position.column,o=e.modelState.position.column,s=n===o,a=e.viewState.position.lineNumber,l=t.getLineFirstNonWhitespaceColumn(a);return!s&&!(n===l)?this._moveToLineStartByView(t,e,i):this._moveToLineStartByModel(t,e,i)}static _moveToLineStartByView(t,e,i){return Rt.fromViewState(fn.moveToBeginningOfLine(t.cursorConfig,t,e.viewState,i))}static _moveToLineStartByModel(t,e,i){return Rt.fromModelState(fn.moveToBeginningOfLine(t.cursorConfig,t.model,e.modelState,i))}static moveToEndOfLine(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=this._moveToLineEnd(t,l,i,n)}return o}static _moveToLineEnd(t,e,i,n){let o=e.viewState.position,s=t.getLineMaxColumn(o.lineNumber),a=o.column===s,l=e.modelState.position,d=t.model.getLineMaxColumn(l.lineNumber),c=s-o.column===d-l.column;return a||c?this._moveToLineEndByModel(t,e,i,n):this._moveToLineEndByView(t,e,i,n)}static _moveToLineEndByView(t,e,i,n){return Rt.fromViewState(fn.moveToEndOfLine(t.cursorConfig,t,e.viewState,i,n))}static _moveToLineEndByModel(t,e,i,n){return Rt.fromModelState(fn.moveToEndOfLine(t.cursorConfig,t.model,e.modelState,i,n))}static expandLineSelection(t,e){let i=[];for(let n=0,o=e.length;n<o;n++){let s=e[n],a=s.modelState.selection.startLineNumber,l=t.model.getLineCount(),d=s.modelState.selection.endLineNumber,c;d===l?c=t.model.getLineMaxColumn(l):(d++,c=1),i[n]=Rt.fromModelState(new Yn(new F(a,1,a,1),0,0,new U(d,c),0))}return i}static moveToBeginningOfBuffer(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];n[o]=Rt.fromModelState(fn.moveToBeginningOfBuffer(t.cursorConfig,t.model,a.modelState,i))}return n}static moveToEndOfBuffer(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o];n[o]=Rt.fromModelState(fn.moveToEndOfBuffer(t.cursorConfig,t.model,a.modelState,i))}return n}static selectAll(t,e){let i=t.model.getLineCount(),n=t.model.getLineMaxColumn(i);return Rt.fromModelState(new Yn(new F(1,1,1,1),0,0,new U(i,n),0))}static line(t,e,i,n,o){let s=t.model.validatePosition(n),a=o?t.coordinatesConverter.validateViewPosition(new U(o.lineNumber,o.column),s):t.coordinatesConverter.convertModelPositionToViewPosition(s);if(!i){let d=t.model.getLineCount(),c=s.lineNumber+1,u=1;return c>d&&(c=d,u=t.model.getLineMaxColumn(c)),Rt.fromModelState(new Yn(new F(s.lineNumber,1,c,u),2,0,new U(c,u),0))}let l=e.modelState.selectionStart.getStartPosition().lineNumber;if(s.lineNumber<l)return Rt.fromViewState(e.viewState.move(!0,a.lineNumber,1,0));if(s.lineNumber>l){let d=t.getLineCount(),c=a.lineNumber+1,u=1;return c>d&&(c=d,u=t.getLineMaxColumn(c)),Rt.fromViewState(e.viewState.move(!0,c,u,0))}else{let d=e.modelState.selectionStart.getEndPosition();return Rt.fromModelState(e.modelState.move(!0,d.lineNumber,d.column,0))}}static word(t,e,i,n){let o=t.model.validatePosition(n);return Rt.fromModelState(pC.word(t.cursorConfig,t.model,e.modelState,i,o))}static cancelSelection(t,e){if(!e.modelState.hasSelection())return new Rt(e.modelState,e.viewState);let i=e.viewState.position.lineNumber,n=e.viewState.position.column;return Rt.fromViewState(new Yn(new F(i,n,i,n),0,0,new U(i,n),0))}static moveTo(t,e,i,n,o){if(i){if(e.modelState.selectionStartKind===1)return this.word(t,e,i,n);if(e.modelState.selectionStartKind===2)return this.line(t,e,i,n,o)}let s=t.model.validatePosition(n),a=o?t.coordinatesConverter.validateViewPosition(new U(o.lineNumber,o.column),s):t.coordinatesConverter.convertModelPositionToViewPosition(s);return Rt.fromViewState(e.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(t,e,i,n,o,s){switch(i){case ft.Direction.Left:return s===ft.Unit.HalfLine?this._moveHalfLineLeft(t,e,n):this._moveLeft(t,e,n,o);case ft.Direction.Right:return s===ft.Unit.HalfLine?this._moveHalfLineRight(t,e,n):this._moveRight(t,e,n,o);case ft.Direction.Up:return s===ft.Unit.WrappedLine?this._moveUpByViewLines(t,e,n,o):this._moveUpByModelLines(t,e,n,o);case ft.Direction.Down:return s===ft.Unit.WrappedLine?this._moveDownByViewLines(t,e,n,o):this._moveDownByModelLines(t,e,n,o);case ft.Direction.PrevBlankLine:return s===ft.Unit.WrappedLine?e.map(a=>Rt.fromViewState(fn.moveToPrevBlankLine(t.cursorConfig,t,a.viewState,n))):e.map(a=>Rt.fromModelState(fn.moveToPrevBlankLine(t.cursorConfig,t.model,a.modelState,n)));case ft.Direction.NextBlankLine:return s===ft.Unit.WrappedLine?e.map(a=>Rt.fromViewState(fn.moveToNextBlankLine(t.cursorConfig,t,a.viewState,n))):e.map(a=>Rt.fromModelState(fn.moveToNextBlankLine(t.cursorConfig,t.model,a.modelState,n)));case ft.Direction.WrappedLineStart:return this._moveToViewMinColumn(t,e,n);case ft.Direction.WrappedLineFirstNonWhitespaceCharacter:return this._moveToViewFirstNonWhitespaceColumn(t,e,n);case ft.Direction.WrappedLineColumnCenter:return this._moveToViewCenterColumn(t,e,n);case ft.Direction.WrappedLineEnd:return this._moveToViewMaxColumn(t,e,n);case ft.Direction.WrappedLineLastNonWhitespaceCharacter:return this._moveToViewLastNonWhitespaceColumn(t,e,n);default:return null}}static viewportMove(t,e,i,n,o){let s=t.getCompletelyVisibleViewRange(),a=t.coordinatesConverter.convertViewRangeToModelRange(s);switch(i){case ft.Direction.ViewPortTop:{let l=this._firstLineNumberInRange(t.model,a,o),d=t.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(t,e[0],n,l,d)]}case ft.Direction.ViewPortBottom:{let l=this._lastLineNumberInRange(t.model,a,o),d=t.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(t,e[0],n,l,d)]}case ft.Direction.ViewPortCenter:{let l=Math.round((a.startLineNumber+a.endLineNumber)/2),d=t.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(t,e[0],n,l,d)]}case ft.Direction.ViewPortIfOutside:{let l=[];for(let d=0,c=e.length;d<c;d++){let u=e[d];l[d]=this.findPositionInViewportIfOutside(t,u,s,n)}return l}default:return null}}static findPositionInViewportIfOutside(t,e,i,n){let o=e.viewState.position.lineNumber;if(i.startLineNumber<=o&&o<=i.endLineNumber-1)return new Rt(e.modelState,e.viewState);{let s;o>i.endLineNumber-1?s=i.endLineNumber-1:o<i.startLineNumber?s=i.startLineNumber:s=o;let a=fn.vertical(t.cursorConfig,t,o,e.viewState.position.column,e.viewState.leftoverVisibleColumns,s,!1);return Rt.fromViewState(e.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(t,e,i){let n=e.startLineNumber;return e.startColumn!==t.getLineMinColumn(n)&&n++,Math.min(e.endLineNumber,n+i-1)}static _lastLineNumberInRange(t,e,i){let n=e.startLineNumber;return e.startColumn!==t.getLineMinColumn(n)&&n++,Math.max(n,e.endLineNumber-i+1)}static _moveLeft(t,e,i,n){return e.map(o=>Rt.fromViewState(fn.moveLeft(t.cursorConfig,t,o.viewState,i,n)))}static _moveHalfLineLeft(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=Math.round(t.getLineLength(l)/2);n[o]=Rt.fromViewState(fn.moveLeft(t.cursorConfig,t,a.viewState,i,d))}return n}static _moveRight(t,e,i,n){return e.map(o=>Rt.fromViewState(fn.moveRight(t.cursorConfig,t,o.viewState,i,n)))}static _moveHalfLineRight(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=Math.round(t.getLineLength(l)/2);n[o]=Rt.fromViewState(fn.moveRight(t.cursorConfig,t,a.viewState,i,d))}return n}static _moveDownByViewLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Rt.fromViewState(fn.moveDown(t.cursorConfig,t,l.viewState,i,n))}return o}static _moveDownByModelLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Rt.fromModelState(fn.moveDown(t.cursorConfig,t.model,l.modelState,i,n))}return o}static _moveUpByViewLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Rt.fromViewState(fn.moveUp(t.cursorConfig,t,l.viewState,i,n))}return o}static _moveUpByModelLines(t,e,i,n){let o=[];for(let s=0,a=e.length;s<a;s++){let l=e[s];o[s]=Rt.fromModelState(fn.moveUp(t.cursorConfig,t.model,l.modelState,i,n))}return o}static _moveToViewPosition(t,e,i,n,o){return Rt.fromViewState(e.viewState.move(i,n,o,0))}static _moveToModelPosition(t,e,i,n,o){return Rt.fromModelState(e.modelState.move(i,n,o,0))}static _moveToViewMinColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineMinColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewFirstNonWhitespaceColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineFirstNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewCenterColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=Math.round((t.getLineMaxColumn(l)+t.getLineMinColumn(l))/2);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewMaxColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineMaxColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}static _moveToViewLastNonWhitespaceColumn(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.viewState.position.lineNumber,d=t.getLineLastNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(t,a,i,l,d)}return n}},ft;(a=>{let r=function(l){if(!Mi(l))return!1;let d=l;return!(!si(d.to)||!Vn(d.select)&&!gh(d.select)||!Vn(d.by)&&!si(d.by)||!Vn(d.value)&&!Vo(d.value))};a.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},a.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function n(l){if(!l.to)return null;let d;switch(l.to){case a.RawDirection.Left:d=0;break;case a.RawDirection.Right:d=1;break;case a.RawDirection.Up:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.PrevBlankLine:d=4;break;case a.RawDirection.NextBlankLine:d=5;break;case a.RawDirection.WrappedLineStart:d=6;break;case a.RawDirection.WrappedLineFirstNonWhitespaceCharacter:d=7;break;case a.RawDirection.WrappedLineColumnCenter:d=8;break;case a.RawDirection.WrappedLineEnd:d=9;break;case a.RawDirection.WrappedLineLastNonWhitespaceCharacter:d=10;break;case a.RawDirection.ViewPortTop:d=11;break;case a.RawDirection.ViewPortBottom:d=13;break;case a.RawDirection.ViewPortCenter:d=12;break;case a.RawDirection.ViewPortIfOutside:d=14;break;default:return null}let c=0;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Character:c=3;break;case a.RawUnit.HalfLine:c=4;break}return{direction:d,unit:c,select:!!l.select,value:l.value||1}}a.parse=n;let o;(k=>(k[k.Left=0]="Left",k[k.Right=1]="Right",k[k.Up=2]="Up",k[k.Down=3]="Down",k[k.PrevBlankLine=4]="PrevBlankLine",k[k.NextBlankLine=5]="NextBlankLine",k[k.WrappedLineStart=6]="WrappedLineStart",k[k.WrappedLineFirstNonWhitespaceCharacter=7]="WrappedLineFirstNonWhitespaceCharacter",k[k.WrappedLineColumnCenter=8]="WrappedLineColumnCenter",k[k.WrappedLineEnd=9]="WrappedLineEnd",k[k.WrappedLineLastNonWhitespaceCharacter=10]="WrappedLineLastNonWhitespaceCharacter",k[k.ViewPortTop=11]="ViewPortTop",k[k.ViewPortCenter=12]="ViewPortCenter",k[k.ViewPortBottom=13]="ViewPortBottom",k[k.ViewPortIfOutside=14]="ViewPortIfOutside"))(o=a.Direction||={});let s;(m=>(m[m.None=0]="None",m[m.Line=1]="Line",m[m.WrappedLine=2]="WrappedLine",m[m.Character=3]="Character",m[m.HalfLine=4]="HalfLine"))(s=a.Unit||={})})(ft||={});function Kue(r,t,e){let i=r.tokenization.getLanguageIdAtPosition(t,0);if(t>1){let n,o=-1;for(n=t-1;n>=1;n--){if(r.tokenization.getLanguageIdAtPosition(n,0)!==i)return o;let s=r.getLineContent(n);if(e.shouldIgnore(n)||/^\s+$/.test(s)||s===""){o=n;continue}return n}}return-1}function _x(r,t,e,i=!0,n){if(r<4)return null;let o=n.getLanguageConfiguration(t.tokenization.getLanguageId()).indentRulesSupport;if(!o)return null;let s=new pO(t,o,n);if(e<=1)return{indentation:"",action:null};for(let l=e-1;l>0&&t.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};let a=Kue(t,e,s);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(s.shouldIncrease(a)||s.shouldIndentNextLine(a)){let l=t.getLineContent(a);return{indentation:Co(l),action:1,line:a}}else if(s.shouldDecrease(a)){let l=t.getLineContent(a);return{indentation:Co(l),action:null,line:a}}else{if(a===1)return{indentation:Co(t.getLineContent(a)),action:null,line:a};let l=a-1,d=o.getIndentMetadata(t.getLineContent(l));if(!(d&3)&&d&4){let c=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(u)){c=u;break}return{indentation:Co(t.getLineContent(c+1)),action:null,line:c+1}}if(i)return{indentation:Co(t.getLineContent(a)),action:null,line:a};for(let c=a;c>0;c--){if(s.shouldIncrease(c))return{indentation:Co(t.getLineContent(c)),action:1,line:c};if(s.shouldIndentNextLine(c)){let u=0;for(let p=c-1;p>0;p--)if(!s.shouldIndentNextLine(c)){u=p;break}return{indentation:Co(t.getLineContent(u+1)),action:null,line:u+1}}else if(s.shouldDecrease(c))return{indentation:Co(t.getLineContent(c)),action:null,line:c}}return{indentation:Co(t.getLineContent(1)),action:null,line:1}}}function pee(r,t,e,i,n){if(r<4)return null;let o=t.getLanguageIdAtPosition(e.startLineNumber,e.startColumn),s=n.getLanguageConfiguration(o).indentRulesSupport;if(!s)return null;t.tokenization.forceTokenization(e.startLineNumber);let l=new ub(t,n).getProcessedTokenContextAroundRange(e),d=l.afterRangeProcessedTokens,c=l.beforeRangeProcessedTokens,u=Co(c.getLineContent()),p=Gue(t,e.startLineNumber,c),m=hO(t,e.getStartPosition()),g=t.getLineContent(e.startLineNumber),f=Co(g),b=_x(r,p,e.startLineNumber+1,void 0,n);if(!b){let I=m?f:u;return{beforeEnter:I,afterEnter:I}}let y=m?f:b.indentation;return b.action===1&&(y=i.shiftIndent(y)),s.shouldDecrease(d.getLineContent())&&(y=i.unshiftIndent(y)),{beforeEnter:m?f:u,afterEnter:y}}function hee(r,t,e,i,n,o){let s=r.autoIndent;if(s<4||hO(t,e.getStartPosition()))return null;let l=t.getLanguageIdAtPosition(e.startLineNumber,e.startColumn),d=o.getLanguageConfiguration(l).indentRulesSupport;if(!d)return null;let u=new ub(t,o).getProcessedTokenContextAroundRange(e),p=u.beforeRangeProcessedTokens.getLineContent(),m=u.afterRangeProcessedTokens.getLineContent(),g=p+m,f=p+i+m;if(!d.shouldDecrease(g)&&d.shouldDecrease(f)){let y=_x(s,t,e.startLineNumber,!1,o);if(!y)return null;let I=y.indentation;return y.action!==1&&(I=n.unshiftIndent(I)),I}let b=e.startLineNumber-1;if(b>0){let y=t.getLineContent(b);if(d.shouldIndentNextLine(y)&&d.shouldIncrease(f)){let E=_x(s,t,e.startLineNumber,!1,o)?.indentation;if(E!==void 0){let S=t.getLineContent(e.startLineNumber),w=Co(S),k=n.shiftIndent(E)===w,R=/^\s*$/.test(g),A=r.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),z=A&&A.length>0&&R;if(k&&z)return E}}}return null}function Gue(r,t,e){return{tokenization:{getLineTokens:n=>n===t?e:r.tokenization.getLineTokens(n),getLanguageId:()=>r.getLanguageId(),getLanguageIdAtPosition:(n,o)=>r.getLanguageIdAtPosition(n,o)},getLineContent:n=>n===t?e.getLineContent():r.getLineContent(n)}}var pO=class{_indentRulesSupport;_indentationLineProcessor;constructor(t,e,i){this._indentRulesSupport=e,this._indentationLineProcessor=new mO(t,i)}shouldIncrease(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(t,e){let i=this._indentationLineProcessor.getProcessedLine(t,e);return this._indentRulesSupport.shouldIndentNextLine(i)}},ub=class{model;indentationLineProcessor;constructor(t,e){this.model=t,this.indentationLineProcessor=new mO(t,e)}getProcessedTokenContextAroundRange(t){let e=this._getProcessedTokensBeforeRange(t),i=this._getProcessedTokensAfterRange(t),n=this._getProcessedPreviousLineTokens(t);return{beforeRangeProcessedTokens:e,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(t){this.model.tokenization.forceTokenization(t.startLineNumber);let e=this.model.tokenization.getLineTokens(t.startLineNumber),i=Fc(e,t.startColumn-1),n;if(hO(this.model,t.getStartPosition())){let s=t.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+s;n=e.sliceAndInflate(a,l,0)}else{let s=t.startColumn-1;n=e.sliceAndInflate(0,s,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(t){let e=t.isEmpty()?t.getStartPosition():t.getEndPosition();this.model.tokenization.forceTokenization(e.lineNumber);let i=this.model.tokenization.getLineTokens(e.lineNumber),n=Fc(i,e.column-1),o=e.column-1-n.firstCharOffset,s=n.firstCharOffset+o,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(s,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(t){let e=m=>{this.model.tokenization.forceTokenization(m);let g=this.model.tokenization.getLineTokens(m),f=this.model.getLineMaxColumn(m)-1;return Fc(g,f)};this.model.tokenization.forceTokenization(t.startLineNumber);let i=this.model.tokenization.getLineTokens(t.startLineNumber),n=Fc(i,t.startColumn-1),o=Mn.createEmpty("",n.languageIdCodec),s=t.startLineNumber-1;if(s===0||!(n.firstCharOffset===0))return o;let d=e(s);if(!(n.languageId===d.languageId))return o;let u=d.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(u)}},mO=class{constructor(t,e){this.model=t;this.languageConfigurationService=e}getProcessedLine(t,e){let i=(s,a)=>{let l=Co(s);return a+s.substring(l.length)};this.model.tokenization.forceTokenization?.(t);let n=this.model.tokenization.getLineTokens(t),o=this.getProcessedTokens(n).getLineContent();return e!==void 0&&(o=i(o,e)),o}getProcessedTokens(t){let e=l=>l===2||l===3||l===1,i=t.getLanguageId(0),o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),s=[];return t.forEach(l=>{let d=t.getStandardTokenType(l),c=t.getTokenText(l);e(d)&&(c=c.replace(o,""));let u=t.getMetadata(l);s.push({text:c,metadata:u})}),Mn.createFromTextAndMetadata(s,t.languageIdCodec)}};function hO(r,t){r.tokenization.forceTokenization(t.lineNumber);let e=r.tokenization.getLineTokens(t.lineNumber),i=Fc(e,t.column-1),n=i.firstCharOffset===0,o=e.getLanguageId(0)===i.languageId;return!n&&!o}function Dx(r,t,e,i){t.tokenization.forceTokenization(e.startLineNumber);let n=t.getLanguageIdAtPosition(e.startLineNumber,e.startColumn),o=i.getLanguageConfiguration(n);if(!o)return null;let a=new ub(t,i).getProcessedTokenContextAroundRange(e),l=a.previousLineProcessedTokens.getLineContent(),d=a.beforeRangeProcessedTokens.getLineContent(),c=a.afterRangeProcessedTokens.getLineContent(),u=o.onEnter(r,l,d,c);if(!u)return null;let p=u.indentAction,m=u.appendText,g=u.removeText||0;m?p===1&&(m="	"+m):p===1||p===2?m="	":m="";let f=Hk(t,e.startLineNumber,e.startColumn);return g&&(f=f.substring(0,f.length-g)),{indentAction:p,appendText:m,removeText:g,indentation:f}}var pK=Object.create(null);function pb(r,t){if(t<=0)return"";pK[r]||(pK[r]=["",r]);let e=pK[r];for(let i=e.length;i<=t;i++)e[i]=e[i-1]+r;return e[t]}var Ia=class{constructor(t,e,i){this._languageConfigurationService=i;this._opts=e,this._selection=t,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(t,e,i,n,o){let s=Ni.visibleColumnFromColumn(t,e,i);if(o){let a=pb(" ",n),d=Ni.prevIndentTabStop(s,n)/n;return pb(a,d)}else{let a="	",d=Ni.prevRenderTabStop(s,i)/i;return pb(a,d)}}static shiftIndent(t,e,i,n,o){let s=Ni.visibleColumnFromColumn(t,e,i);if(o){let a=pb(" ",n),d=Ni.nextIndentTabStop(s,n)/n;return pb(a,d)}else{let a="	",d=Ni.nextRenderTabStop(s,i)/i;return pb(a,d)}}_opts;_selection;_selectionId;_useLastEditRangeForCursorEndPosition;_selectionStartColumnStaysPut;_addEditOperation(t,e,i){this._useLastEditRangeForCursorEndPosition?t.addTrackedEditOperation(e,i):t.addEditOperation(e,i)}getEditOperations(t,e){let i=this._selection.startLineNumber,n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);let{tabSize:o,indentSize:s,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(t.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let d=0,c=0;for(let u=i;u<=n;u++,d=c){c=0;let p=t.getLineContent(u),m=Rn(p);if(this._opts.isUnshift&&(p.length===0||m===0)||!l&&!this._opts.isUnshift&&p.length===0)continue;if(m===-1&&(m=p.length),u>1&&Ni.visibleColumnFromColumn(p,m+1,o)%s!==0&&t.tokenization.isCheapToTokenize(u-1)){let b=Dx(this._opts.autoIndent,t,new F(u-1,t.getLineMaxColumn(u-1),u-1,t.getLineMaxColumn(u-1)),this._languageConfigurationService);if(b){if(c=d,b.appendText)for(let y=0,I=b.appendText.length;y<I&&c<s&&b.appendText.charCodeAt(y)===32;y++)c++;b.removeText&&(c=Math.max(0,c-b.removeText));for(let y=0;y<c&&!(m===0||p.charCodeAt(m-1)!==32);y++)m--}}if(this._opts.isUnshift&&m===0)continue;let g;this._opts.isUnshift?g=Ia.unshiftIndent(p,m+1,o,s,a):g=Ia.shiftIndent(p,m+1,o,s,a),this._addEditOperation(e,new F(u,1,u,m+1),g),u===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=m+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&t.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);let d=a?pb(" ",s):"	";for(let c=i;c<=n;c++){let u=t.getLineContent(c),p=Rn(u);if(!(this._opts.isUnshift&&(u.length===0||p===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(p===-1&&(p=u.length),!(this._opts.isUnshift&&p===0)))if(this._opts.isUnshift){p=Math.min(p,s);for(let m=0;m<p;m++)if(u.charCodeAt(m)===9){p=m+1;break}this._addEditOperation(e,new F(c,1,c,p+1),"")}else this._addEditOperation(e,new F(c,1,c,1),d),c===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=e.trackSelection(this._selection)}computeCursorState(t,e){if(this._useLastEditRangeForCursorEndPosition){let n=e.getInverseEditOperations()[0];return new It(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}let i=e.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new It(i.startLineNumber,n,i.endLineNumber,i.endColumn):new It(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};Ia=_([v(2,fp)],Ia);var gO=class{_range;_charBeforeSelection;_charAfterSelection;constructor(t,e,i){this._range=t,this._charBeforeSelection=e,this._charAfterSelection=i}getEditOperations(t,e){e.addTrackedEditOperation(new F(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),e.addTrackedEditOperation(new F(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(t,e){let i=e.getInverseEditOperations(),n=i[0].range,o=i[1].range;return new It(n.endLineNumber,n.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}},fO=class{constructor(t,e,i){this._position=t;this._text=e;this._charAfter=i}getEditOperations(t,e){e.addTrackedEditOperation(new F(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return new It(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}};var bO=class{static getEdits(t,e,i,n,o){if(!o&&this._isAutoIndentType(t,e,i)){let s=[];for(let l of i){let d=this._findActualIndentationForSelection(t,e,l,n);if(d===null)return;s.push({selection:l,indentation:d})}let a=hC.getAutoClosingPairClose(t,e,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(t,e,s,n,a)}}static _isAutoIndentType(t,e,i){if(t.autoIndent<4)return!1;for(let n=0,o=i.length;n<o;n++)if(!e.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(t,e,i,n){let o=hee(t,e,i,n,{shiftIndent:a=>Lx(t,a),unshiftIndent:a=>fC(t,a)},t.languageConfigurationService);if(o===null)return null;let s=Hk(e,i.startLineNumber,i.startColumn);return o===t.normalizeIndentation(s)?null:o}static _getIndentationAndAutoClosingPairEdits(t,e,i,n,o){let s=i.map(({selection:l,indentation:d})=>{if(o!==null){let c=this._getEditFromIndentationAndSelection(t,e,d,l,n,!1);return new mK(c,l,n,o)}else{let c=this._getEditFromIndentationAndSelection(t,e,d,l,n,!0);return hb(c.range,c.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new fo(4,s,a)}static _getEditFromIndentationAndSelection(t,e,i,n,o,s=!0){let a=n.startLineNumber,l=e.getLineFirstNonWhitespaceColumn(a),d=t.normalizeIndentation(i);if(l!==0){let u=e.getLineContent(a);d+=u.substring(l-1,n.startColumn-1)}return d+=s?o:"",{range:new F(a,1,n.endLineNumber,n.endColumn),text:d}}},vO=class{static getEdits(t,e,i,n,o,s){if(fee(e,i,n,o,s))return this._runAutoClosingOvertype(t,n,s)}static _runAutoClosingOvertype(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let l=e[o].getPosition(),d=new F(l.lineNumber,l.column,l.lineNumber,l.column+1);n[o]=new mr(d,i)}return new fo(4,n,{shouldPushStackElementBefore:_O(t,4),shouldPushStackElementAfter:!1})}},yO=class{static getEdits(t,e,i,n,o){if(fee(t,e,i,n,o)){let s=i.map(a=>new mr(new F(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new fo(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}},hC=class{static getEdits(t,e,i,n,o,s){if(!s){let a=this.getAutoClosingPairClose(t,e,i,n,o);if(a!==null)return this._runAutoClosingOpenCharType(i,n,o,a)}}static _runAutoClosingOpenCharType(t,e,i,n){let o=[];for(let s=0,a=t.length;s<a;s++){let l=t[s];o[s]=new hK(l,e,!i,n)}return new fo(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(t,e,i,n,o){for(let g of i)if(!g.isEmpty())return null;let s=i.map(g=>{let f=g.getPosition();return o?{lineNumber:f.lineNumber,beforeColumn:f.column-n.length,afterColumn:f.column}:{lineNumber:f.lineNumber,beforeColumn:f.column,afterColumn:f.column}}),a=this._findAutoClosingPairOpen(t,e,s.map(g=>new U(g.lineNumber,g.beforeColumn)),n);if(!a)return null;let l,d;if(qd(n)?(l=t.autoClosingQuotes,d=t.shouldAutoCloseBefore.quote):(t.blockCommentStartToken?a.open.includes(t.blockCommentStartToken):!1)?(l=t.autoClosingComments,d=t.shouldAutoCloseBefore.comment):(l=t.autoClosingBrackets,d=t.shouldAutoCloseBefore.bracket),l==="never")return null;let u=this._findContainedAutoClosingPair(t,a),p=u?u.close:"",m=!0;for(let g of s){let{lineNumber:f,beforeColumn:b,afterColumn:y}=g,I=e.getLineContent(f),E=I.substring(0,b-1),S=I.substring(y-1);if(S.startsWith(p)||(m=!1),S.length>0){let R=S.charAt(0);if(!this._isBeforeClosingBrace(t,S)&&!d(R))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){let R=Mc(t.wordSeparators,[]);if(E.length>0){let A=E.charCodeAt(E.length-1);if(R.get(A)===0)return null}}if(!e.tokenization.isCheapToTokenize(f))return null;e.tokenization.forceTokenization(f);let w=e.tokenization.getLineTokens(f),D=Fc(w,b-1);if(!a.shouldAutoClose(D,b-D.firstCharOffset))return null;let k=a.findNeutralCharacter();if(k){let R=e.tokenization.getTokenTypeIfInsertingCharacter(f,b,k);if(!a.isOK(R))return null}}return m?a.close.substring(0,a.close.length-p.length):a.close}static _findContainedAutoClosingPair(t,e){if(e.open.length<=1)return null;let i=e.close.charAt(e.close.length-1),n=t.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[],o=null;for(let s of n)s.open!==e.open&&e.open.includes(s.open)&&e.close.endsWith(s.close)&&(!o||s.open.length>o.open.length)&&(o=s);return o}static _findAutoClosingPairOpen(t,e,i,n){let o=t.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!o)return null;let s=null;for(let a of o)if(s===null||a.open.length>s.open.length){let l=!0;for(let d of i)if(e.getValueInRange(new F(d.lineNumber,d.column-a.open.length+1,d.lineNumber,d.column))+n!==a.open){l=!1;break}l&&(s=a)}return s}static _isBeforeClosingBrace(t,e){let i=e.charAt(0),n=t.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],o=t.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],s=n.some(l=>e.startsWith(l.open)),a=o.some(l=>e.startsWith(l.close));return!s&&a}},IO=class{static getEdits(t,e,i,n,o){if(!o&&this._isSurroundSelectionType(t,e,i,n))return this._runSurroundSelectionType(t,i,n)}static _runSurroundSelectionType(t,e,i){let n=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=t.surroundingPairs[i];n[o]=new gO(a,i,l)}return new fo(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(t,e,i,n){if(!fK(t,n)||!t.surroundingPairs.hasOwnProperty(n))return!1;let o=qd(n);for(let s of i){if(s.isEmpty())return!1;let a=!0;for(let l=s.startLineNumber;l<=s.endLineNumber;l++){let d=e.getLineContent(l),c=l===s.startLineNumber?s.startColumn-1:0,u=l===s.endLineNumber?s.endColumn-1:d.length,p=d.substring(c,u);if(/[^ \t]/.test(p)){a=!1;break}}if(a)return!1;if(o&&s.startLineNumber===s.endLineNumber&&s.startColumn+1===s.endColumn){let l=e.getValueInRange(s);if(qd(l))return!1}}return!0}},CO=class{static getEdits(t,e,i,n,o,s){if(!s&&this._isTypeInterceptorElectricChar(e,i,n)){let a=this._typeInterceptorElectricChar(t,e,i,n[0],o);if(a)return a}}static _isTypeInterceptorElectricChar(t,e,i){return!!(i.length===1&&e.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(t,e,i,n,o){if(!e.electricChars.hasOwnProperty(o)||!n.isEmpty())return null;let s=n.getPosition();i.tokenization.forceTokenization(s.lineNumber);let a=i.tokenization.getLineTokens(s.lineNumber),l;try{l=e.onElectricCharacter(o,a,s.column)}catch(d){return Ke(d),null}if(!l)return null;if(l.matchOpenBracket){let d=(a.getLineContent()+o).lastIndexOf(l.matchOpenBracket)+1,c=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:s.lineNumber,column:d},500);if(c){if(c.startLineNumber===s.lineNumber)return null;let u=i.getLineContent(c.startLineNumber),p=Co(u),m=e.normalizeIndentation(p),g=i.getLineContent(s.lineNumber),f=i.getLineFirstNonWhitespaceColumn(s.lineNumber)||s.column,b=g.substring(f-1,s.column-1),y=m+b+o,I=new F(s.lineNumber,1,s.lineNumber,s.column),E=new mr(I,y);return new fo(gK(y,t),[E],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}},SO=class{static getEdits(t,e,i){let n=[];for(let s=0,a=e.length;s<a;s++)n[s]=new mr(e[s],i);let o=gK(i,t);return new fo(o,n,{shouldPushStackElementBefore:_O(t,o),shouldPushStackElementAfter:!1})}},mC=class{static getEdits(t,e,i,n,o){if(!o&&n===`
`){let s=[];for(let a=0,l=i.length;a<l;a++)s[a]=this._enter(t,e,!1,i[a]);return new fo(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(t,e,i,n){if(t.autoIndent===0)return hb(n,`
`,i);if(!e.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||t.autoIndent===1){let l=e.getLineContent(n.startLineNumber),d=Co(l).substring(0,n.startColumn-1);return hb(n,`
`+t.normalizeIndentation(d),i)}let o=Dx(t.autoIndent,e,n,t.languageConfigurationService);if(o){if(o.indentAction===0)return hb(n,`
`+t.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===1)return hb(n,`
`+t.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===2){let l=t.normalizeIndentation(o.indentation),d=t.normalizeIndentation(o.indentation+o.appendText),c=`
`+d+`
`+l;return i?new db(n,c,!0):new cb(n,c,-1,d.length-l.length,!0)}else if(o.indentAction===3){let l=fC(t,o.indentation);return hb(n,`
`+t.normalizeIndentation(l+o.appendText),i)}}let s=e.getLineContent(n.startLineNumber),a=Co(s).substring(0,n.startColumn-1);if(t.autoIndent>=4){let l=pee(t.autoIndent,e,n,{unshiftIndent:d=>fC(t,d),shiftIndent:d=>Lx(t,d),normalizeIndentation:d=>t.normalizeIndentation(d)},t.languageConfigurationService);if(l){let d=t.visibleColumnFromColumn(e,n.getEndPosition()),c=n.endColumn,u=e.getLineContent(n.endLineNumber),p=Rn(u);if(p>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,p+1)):n=n.setEndPosition(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),i)return new db(n,`
`+t.normalizeIndentation(l.afterEnter),!0);{let m=0;return c<=p+1&&(t.insertSpaces||(d=Math.ceil(d/t.indentSize)),m=Math.min(d+1-t.normalizeIndentation(l.afterEnter).length-1,0)),new cb(n,`
`+t.normalizeIndentation(l.afterEnter),0,m,!0)}}}return hb(n,`
`+t.normalizeIndentation(a),i)}static lineInsertBefore(t,e,i){if(e===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].positionLineNumber;if(a===1)n[o]=new db(new F(1,1,1,1),`
`);else{a--;let l=e.getLineMaxColumn(a);n[o]=this._enter(t,e,!1,new F(a,l,a,l))}}return n}static lineInsertAfter(t,e,i){if(e===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o].positionLineNumber,l=e.getLineMaxColumn(a);n[o]=this._enter(t,e,!1,new F(a,l,a,l))}return n}static lineBreakInsert(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=this._enter(t,e,!0,i[o]);return n}},wO=class{static getEdits(t,e,i,n,o,s){let a=this._distributePasteToCursors(t,i,n,o,s);return a?(i=i.sort(F.compareRangesUsingStarts),this._distributedPaste(t,e,i,a)):this._simplePaste(t,e,i,n,o)}static _distributePasteToCursors(t,e,i,n,o){if(n||e.length===1)return null;if(o&&o.length===e.length)return o;if(t.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));let s=ZS(i);if(s.length===e.length)return s}return null}static _distributedPaste(t,e,i,n){let o=[];for(let s=0,a=i.length;s<a;s++)o[s]=new mr(i[s],n[s]);return new fo(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(t,e,i,n,o){let s=[];for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d.getPosition();if(o&&!d.isEmpty()&&(o=!1),o&&n.indexOf(`
`)!==n.length-1&&(o=!1),o){let u=new F(c.lineNumber,1,c.lineNumber,1);s[a]=new cO(u,n,d,!0)}else s[a]=new mr(d,n)}return new fo(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}},EO=class{static getEdits(t,e,i,n,o,s,a,l){let d=n.map(c=>this._compositionType(i,c,o,s,a,l));return new fo(4,d,{shouldPushStackElementBefore:_O(t,4),shouldPushStackElementAfter:!1})}static _compositionType(t,e,i,n,o,s){if(!e.isEmpty())return null;let a=e.getPosition(),l=Math.max(1,a.column-n),d=Math.min(t.getLineMaxColumn(a.lineNumber),a.column+o),c=new F(a.lineNumber,l,a.lineNumber,d);return t.getValueInRange(c)===i&&s===0?null:new cb(c,i,0,s)}},TO=class{static getEdits(t,e,i){let n=[];for(let s=0,a=e.length;s<a;s++)n[s]=new mr(e[s],i);let o=gK(i,t);return new fo(o,n,{shouldPushStackElementBefore:_O(t,o),shouldPushStackElementAfter:!1})}},xO=class{static getCommands(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++){let a=i[o];if(a.isEmpty()){let l=e.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&e.tokenization.isCheapToTokenize(a.startLineNumber)){let d=this._goodIndentForLine(t,e,a.startLineNumber);d=d||"	";let c=t.normalizeIndentation(d);if(!l.startsWith(c)){n[o]=new mr(new F(a.startLineNumber,1,a.startLineNumber,l.length+1),c,!0);continue}}n[o]=this._replaceJumpToNextIndent(t,e,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=e.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[o]=this._replaceJumpToNextIndent(t,e,a,!1);continue}}n[o]=new Ia(a,{isUnshift:!1,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService)}}return n}static _goodIndentForLine(t,e,i){let n=null,o="",s=_x(t.autoIndent,e,i,!1,t.languageConfigurationService);if(s)n=s.action,o=s.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){let c=e.getLineContent(a);if(Ta(c)>=0)break}if(a<1)return null;let l=e.getLineMaxColumn(a),d=Dx(t.autoIndent,e,new F(a,l,a,l),t.languageConfigurationService);d&&(o=d.indentation+d.appendText)}return n&&(n===1&&(o=Lx(t,o)),n===3&&(o=fC(t,o)),o=t.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(t,e,i,n){let o="",s=i.getStartPosition();if(t.insertSpaces){let a=t.visibleColumnFromColumn(e,s),l=t.indentSize,d=l-a%l;for(let c=0;c<d;c++)o+=" "}else o="	";return new mr(i,o,n)}},gC=class extends cb{_openCharacter;_closeCharacter;closeCharacterRange;enclosingRange;constructor(t,e,i,n,o,s){super(t,e,i,n),this._openCharacter=o,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(t,e,i){return this.closeCharacterRange=new F(e.startLineNumber,e.endColumn-this._closeCharacter.length,e.endLineNumber,e.endColumn),this.enclosingRange=new F(e.startLineNumber,e.endColumn-this._openCharacter.length-this._closeCharacter.length,e.endLineNumber,e.endColumn),super.computeCursorState(t,i)}},hK=class extends gC{constructor(t,e,i,n){let o=(i?e:"")+n,s=0,a=-n.length;super(t,o,s,a,e,n)}computeCursorState(t,e){let n=e.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(t,n,e)}},mK=class extends gC{_autoIndentationEdit;_autoClosingEdit;constructor(t,e,i,n){let o=i+n,s=0,a=i.length;super(e,o,s,a,i,n),this._autoIndentationEdit=t,this._autoClosingEdit={range:e,text:o}}getEditOperations(t,e){e.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),e.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(t,e){let i=e.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");let n=i[0].range,o=i[1].range,s=n.plusRange(o);return this._computeCursorStateWithRange(t,s,e)}};function gK(r,t){return r===" "?t===5||t===6?6:5:4}function _O(r,t){return gee(r)&&!gee(t)?!0:r===5?!1:mee(r)!==mee(t)}function mee(r){return r===6||r===5?"space":r}function gee(r){return r===4||r===5||r===6}function fee(r,t,e,i,n){if(r.autoClosingOvertype==="never"||!r.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let o=0,s=e.length;o<s;o++){let a=e[o];if(!a.isEmpty())return!1;let l=a.getPosition(),d=t.getLineContent(l.lineNumber);if(d.charAt(l.column-1)!==n)return!1;let u=qd(n);if((l.column>2?d.charCodeAt(l.column-2):0)===92&&u)return!1;if(r.autoClosingOvertype==="auto"){let m=!1;for(let g=0,f=i.length;g<f;g++){let b=i[g];if(l.lineNumber===b.startLineNumber&&l.column===b.startColumn){m=!0;break}}if(!m)return!1}}return!0}function hb(r,t,e){return e?new db(r,t,!0):new mr(r,t,!0)}function Lx(r,t,e){return e=e||1,Ia.shiftIndent(t,t.length+e,r.tabSize,r.indentSize,r.insertSpaces)}function fC(r,t,e){return e=e||1,Ia.unshiftIndent(t,t.length+e,r.tabSize,r.indentSize,r.insertSpaces)}function fK(r,t){return qd(t)?r.autoSurround==="quotes"||r.autoSurround==="languageDefined":r.autoSurround==="brackets"||r.autoSurround==="languageDefined"}var Jd=class{static indent(t,e,i){if(e===null||i===null)return[];let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=new Ia(i[o],{isUnshift:!1,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService);return n}static outdent(t,e,i){let n=[];for(let o=0,s=i.length;o<s;o++)n[o]=new Ia(i[o],{isUnshift:!0,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService);return n}static shiftIndent(t,e,i){return Lx(t,e,i)}static unshiftIndent(t,e,i){return fC(t,e,i)}static paste(t,e,i,n,o,s){return wO.getEdits(t,e,i,n,o,s)}static tab(t,e,i){return xO.getCommands(t,e,i)}static compositionType(t,e,i,n,o,s,a,l){return EO.getEdits(t,e,i,n,o,s,a,l)}static compositionEndWithInterceptors(t,e,i,n,o,s){if(!n)return null;let a=null;for(let p of n)if(a===null)a=p.insertedText;else if(a!==p.insertedText)return null;if(!a||a.length!==1)return null;let l=a,d=!1;for(let p of n)if(p.deletedText.length!==0){d=!0;break}if(d){if(!fK(e,l)||!e.surroundingPairs.hasOwnProperty(l))return null;let p=qd(l);for(let f of n)if(f.deletedSelectionStart!==0||f.deletedSelectionEnd!==f.deletedText.length||/^[ \t]+$/.test(f.deletedText)||p&&qd(f.deletedText))return null;let m=[];for(let f of o){if(!f.isEmpty())return null;m.push(f.getPosition())}if(m.length!==n.length)return null;let g=[];for(let f=0,b=m.length;f<b;f++)g.push(new fO(m[f],n[f].deletedText,e.surroundingPairs[l]));return new fo(4,g,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}let c=yO.getEdits(e,i,o,s,l);if(c!==void 0)return c;let u=hC.getEdits(e,i,o,l,!0,!1);return u!==void 0?u:null}static typeWithInterceptors(t,e,i,n,o,s,a){let l=mC.getEdits(i,n,o,a,t);if(l!==void 0)return l;let d=bO.getEdits(i,n,o,a,t);if(d!==void 0)return d;let c=vO.getEdits(e,i,n,o,s,a);if(c!==void 0)return c;let u=hC.getEdits(i,n,o,a,!1,t);if(u!==void 0)return u;let p=IO.getEdits(i,n,o,a,t);if(p!==void 0)return p;let m=CO.getEdits(e,i,n,o,a,t);return m!==void 0?m:SO.getEdits(e,o,a)}static typeWithoutInterceptors(t,e,i,n,o){return TO.getEdits(t,n,o)}},DO=class{constructor(t,e,i,n,o,s){this.deletedText=t;this.deletedSelectionStart=e;this.deletedSelectionEnd=i;this.insertedText=n;this.insertedSelectionStart=o;this.insertedSelectionEnd=s}};var Jt=0,tn=class extends JT{runEditorCommand(t,e,i){let n=e._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}},gr;(a=>{let r=function(l){if(!Mi(l))return!1;let d=l;return!(!si(d.to)||!Vn(d.by)&&!si(d.by)||!Vn(d.value)&&!Vo(d.value)||!Vn(d.revealCursor)&&!gh(d.revealCursor))};a.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:r,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},a.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},a.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function n(l){let d;switch(l.to){case a.RawDirection.Up:d=1;break;case a.RawDirection.Right:d=2;break;case a.RawDirection.Down:d=3;break;case a.RawDirection.Left:d=4;break;default:return null}let c;switch(l.by){case a.RawUnit.Line:c=1;break;case a.RawUnit.WrappedLine:c=2;break;case a.RawUnit.Page:c=3;break;case a.RawUnit.HalfPage:c=4;break;case a.RawUnit.Editor:c=5;break;case a.RawUnit.Column:c=6;break;default:c=2}let u=Math.floor(l.value||1),p=!!l.revealCursor;return{direction:d,unit:c,value:u,revealCursor:p,select:!!l.select}}a.parse=n;let o;(p=>(p[p.Up=1]="Up",p[p.Right=2]="Right",p[p.Down=3]="Down",p[p.Left=4]="Left"))(o=a.Direction||={});let s;(g=>(g[g.Line=1]="Line",g[g.WrappedLine=2]="WrappedLine",g[g.Page=3]="Page",g[g.HalfPage=4]="HalfPage",g[g.Editor=5]="Editor",g[g.Column=6]="Column"))(s=a.Unit||={})})(gr||={});var kx;(i=>{let r=function(n){if(!Mi(n))return!1;let o=n;return!(!Vo(o.lineNumber)&&!si(o.lineNumber)||!Vn(o.at)&&!si(o.at))};i.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:r,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},i.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(kx||={});var Rx=class{constructor(t){t.addImplementation(1e4,"code-editor",(e,i)=>{let n=e.get(fu).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(e,n,i):!1}),t.addImplementation(1e3,"generic-dom-input-textarea",(e,i)=>{let n=An();return n&&sa(n)?(this.runDOMCommand(n),!0):!1}),t.addImplementation(0,"generic-dom",(e,i)=>{let n=e.get(fu).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(e,n,i)):!1})}_runEditorCommand(t,e,i){let n=this.runEditorCommand(t,e,i);return n||!0}};var bo;(Oe=>{class r extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){if(!we.position)return;K.model.pushStackElement(),K.setCursorStates(we.source,3,[Po.moveTo(K,K.getPrimaryCursorState(),this._inSelectionMode,we.position,we.viewPosition)])&&we.revealType!==2&&K.revealAllCursors(we.source,!0,!0)}}Oe.MoveTo=St(new r({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),Oe.MoveToSelect=St(new r({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class i extends tn{runCoreEditorCommand(K,we){K.model.pushStackElement();let Ae=this._getColumnSelectResult(K,K.getPrimaryCursorState(),K.getCursorColumnSelectData(),we);Ae!==null&&(K.setCursorStates(we.source,3,Ae.viewStates.map(Nt=>Rt.fromViewState(Nt))),K.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:Ae.fromLineNumber,fromViewVisualColumn:Ae.fromVisualColumn,toViewLineNumber:Ae.toLineNumber,toViewVisualColumn:Ae.toVisualColumn}),Ae.reversed?K.revealTopMostCursor(we.source):K.revealBottomMostCursor(we.source))}}Oe.ColumnSelect=St(new class extends i{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(De,K,we,Ae){if(typeof Ae.position>"u"||typeof Ae.viewPosition>"u"||typeof Ae.mouseColumn>"u")return null;let Nt=De.model.validatePosition(Ae.position),_i=De.coordinatesConverter.validateViewPosition(new U(Ae.viewPosition.lineNumber,Ae.viewPosition.column),Nt),Fo=Ae.doColumnSelect?we.fromViewLineNumber:_i.lineNumber,yr=Ae.doColumnSelect?we.fromViewVisualColumn:Ae.mouseColumn-1;return $m.columnSelect(De.cursorConfig,De,Fo,yr,_i.lineNumber,Ae.mouseColumn-1)}}),Oe.CursorColumnSelectLeft=St(new class extends i{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(De,K,we,Ae){return $m.columnSelectLeft(De.cursorConfig,De,we)}}),Oe.CursorColumnSelectRight=St(new class extends i{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(De,K,we,Ae){return $m.columnSelectRight(De.cursorConfig,De,we)}});class a extends i{_isPaged;constructor(K){super(K),this._isPaged=K.isPaged}_getColumnSelectResult(K,we,Ae,Nt){return $m.columnSelectUp(K.cursorConfig,K,Ae,this._isPaged)}}Oe.CursorColumnSelectUp=St(new a({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3600,linux:{primary:0}}})),Oe.CursorColumnSelectPageUp=St(new a({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3595,linux:{primary:0}}}));class c extends i{_isPaged;constructor(K){super(K),this._isPaged=K.isPaged}_getColumnSelectResult(K,we,Ae,Nt){return $m.columnSelectDown(K.cursorConfig,K,Ae,this._isPaged)}}Oe.CursorColumnSelectDown=St(new c({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3602,linux:{primary:0}}})),Oe.CursorColumnSelectPageDown=St(new c({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3596,linux:{primary:0}}}));class m extends tn{constructor(){super({id:"cursorMove",precondition:void 0,metadata:ft.metadata})}runCoreEditorCommand(K,we){let Ae=ft.parse(we);Ae&&this._runCursorMove(K,we.source,Ae)}_runCursorMove(K,we,Ae){K.model.pushStackElement(),K.setCursorStates(we,3,m._move(K,K.getCursorStates(),Ae)),K.revealAllCursors(we,!0)}static _move(K,we,Ae){let Nt=Ae.select,_i=Ae.value;switch(Ae.direction){case ft.Direction.Left:case ft.Direction.Right:case ft.Direction.Up:case ft.Direction.Down:case ft.Direction.PrevBlankLine:case ft.Direction.NextBlankLine:case ft.Direction.WrappedLineStart:case ft.Direction.WrappedLineFirstNonWhitespaceCharacter:case ft.Direction.WrappedLineColumnCenter:case ft.Direction.WrappedLineEnd:case ft.Direction.WrappedLineLastNonWhitespaceCharacter:return Po.simpleMove(K,we,Ae.direction,Nt,_i,Ae.unit);case ft.Direction.ViewPortTop:case ft.Direction.ViewPortBottom:case ft.Direction.ViewPortCenter:case ft.Direction.ViewPortIfOutside:return Po.viewportMove(K,we,Ae.direction,Nt,_i);default:return null}}}Oe.CursorMoveImpl=m,Oe.CursorMove=St(new m);let f;(K=>K[K.PAGE_SIZE_MARKER=-1]="PAGE_SIZE_MARKER")(f||={});class b extends tn{_staticArgs;constructor(K){super(K),this._staticArgs=K.args}runCoreEditorCommand(K,we){let Ae=this._staticArgs;this._staticArgs.value===-1&&(Ae={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:we.pageSize||K.cursorConfig.pageSize}),K.model.pushStackElement(),K.setCursorStates(we.source,3,Po.simpleMove(K,K.getCursorStates(),Ae.direction,Ae.select,Ae.value,Ae.unit)),K.revealAllCursors(we.source,!0)}}Oe.CursorLeft=St(new b({args:{direction:ft.Direction.Left,unit:ft.Unit.None,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),Oe.CursorLeftSelect=St(new b({args:{direction:ft.Direction.Left,unit:ft.Unit.None,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1039}})),Oe.CursorRight=St(new b({args:{direction:ft.Direction.Right,unit:ft.Unit.None,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),Oe.CursorRightSelect=St(new b({args:{direction:ft.Direction.Right,unit:ft.Unit.None,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1041}})),Oe.CursorUp=St(new b({args:{direction:ft.Direction.Up,unit:ft.Unit.WrappedLine,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),Oe.CursorUpSelect=St(new b({args:{direction:ft.Direction.Up,unit:ft.Unit.WrappedLine,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),Oe.CursorPageUp=St(new b({args:{direction:ft.Direction.Up,unit:ft.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:11}})),Oe.CursorPageUpSelect=St(new b({args:{direction:ft.Direction.Up,unit:ft.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1035}})),Oe.CursorDown=St(new b({args:{direction:ft.Direction.Down,unit:ft.Unit.WrappedLine,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),Oe.CursorDownSelect=St(new b({args:{direction:ft.Direction.Down,unit:ft.Unit.WrappedLine,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),Oe.CursorPageDown=St(new b({args:{direction:ft.Direction.Down,unit:ft.Unit.WrappedLine,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:12}})),Oe.CursorPageDownSelect=St(new b({args:{direction:ft.Direction.Down,unit:ft.Unit.WrappedLine,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1036}})),Oe.CreateCursor=St(new class extends tn{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(De,K){if(!K.position)return;let we;K.wholeLine?we=Po.line(De,De.getPrimaryCursorState(),!1,K.position,K.viewPosition):we=Po.moveTo(De,De.getPrimaryCursorState(),!1,K.position,K.viewPosition);let Ae=De.getCursorStates();if(Ae.length>1){let Nt=we.modelState?we.modelState.position:null,_i=we.viewState?we.viewState.position:null;for(let Fo=0,yr=Ae.length;Fo<yr;Fo++){let vt=Ae[Fo];if(!(Nt&&!vt.modelState.selection.containsPosition(Nt))&&!(_i&&!vt.viewState.selection.containsPosition(_i))){Ae.splice(Fo,1),De.model.pushStackElement(),De.setCursorStates(K.source,3,Ae);return}}}Ae.push(we),De.model.pushStackElement(),De.setCursorStates(K.source,3,Ae)}}),Oe.LastCursorMoveToSelect=St(new class extends tn{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(De,K){if(!K.position)return;let we=De.getLastAddedCursorIndex(),Ae=De.getCursorStates(),Nt=Ae.slice(0);Nt[we]=Po.moveTo(De,Ae[we],!0,K.position,K.viewPosition),De.model.pushStackElement(),De.setCursorStates(K.source,3,Nt)}});class me extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){K.model.pushStackElement(),K.setCursorStates(we.source,3,Po.moveToBeginningOfLine(K,K.getCursorStates(),this._inSelectionMode)),K.revealAllCursors(we.source,!0)}}Oe.CursorHome=St(new me({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),Oe.CursorHomeSelect=St(new me({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class Ie extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){K.model.pushStackElement(),K.setCursorStates(we.source,3,this._exec(K.getCursorStates())),K.revealAllCursors(we.source,!0)}_exec(K){let we=[];for(let Ae=0,Nt=K.length;Ae<Nt;Ae++){let _i=K[Ae],Fo=_i.modelState.position.lineNumber;we[Ae]=Rt.fromModelState(_i.modelState.move(this._inSelectionMode,Fo,1,0))}return we}}Oe.CursorLineStart=St(new Ie({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:0,mac:{primary:287}}})),Oe.CursorLineStartSelect=St(new Ie({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:0,mac:{primary:1311}}}));class _e extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){K.model.pushStackElement(),K.setCursorStates(we.source,3,Po.moveToEndOfLine(K,K.getCursorStates(),this._inSelectionMode,we.sticky||!1)),K.revealAllCursors(we.source,!0)}}Oe.CursorEnd=St(new _e({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Jt,kbExpr:Re.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),Oe.CursorEndSelect=St(new _e({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:Jt,kbExpr:Re.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:h("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class je extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){K.model.pushStackElement(),K.setCursorStates(we.source,3,this._exec(K,K.getCursorStates())),K.revealAllCursors(we.source,!0)}_exec(K,we){let Ae=[];for(let Nt=0,_i=we.length;Nt<_i;Nt++){let Fo=we[Nt],yr=Fo.modelState.position.lineNumber,vt=K.model.getLineMaxColumn(yr);Ae[Nt]=Rt.fromModelState(Fo.modelState.move(this._inSelectionMode,yr,vt,0))}return Ae}}Oe.CursorLineEnd=St(new je({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:0,mac:{primary:291}}})),Oe.CursorLineEndSelect=St(new je({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:0,mac:{primary:1315}}}));class no extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){K.model.pushStackElement(),K.setCursorStates(we.source,3,Po.moveToBeginningOfBuffer(K,K.getCursorStates(),this._inSelectionMode)),K.revealAllCursors(we.source,!0)}}Oe.CursorTop=St(new no({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:2062,mac:{primary:2064}}})),Oe.CursorTopSelect=St(new no({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3086,mac:{primary:3088}}}));class Ai extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){K.model.pushStackElement(),K.setCursorStates(we.source,3,Po.moveToEndOfBuffer(K,K.getCursorStates(),this._inSelectionMode)),K.revealAllCursors(we.source,!0)}}Oe.CursorBottom=St(new Ai({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:2061,mac:{primary:2066}}})),Oe.CursorBottomSelect=St(new Ai({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:3085,mac:{primary:3090}}}));class Jp extends tn{constructor(){super({id:"editorScroll",precondition:void 0,metadata:gr.metadata})}determineScrollMethod(K){let we=[6],Ae=[1,2,3,4,5,6],Nt=[4,2],_i=[1,3];return we.includes(K.unit)&&Nt.includes(K.direction)?this._runHorizontalEditorScroll.bind(this):Ae.includes(K.unit)&&_i.includes(K.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(K,we){let Ae=gr.parse(we);if(!Ae)return;let Nt=this.determineScrollMethod(Ae);Nt&&Nt(K,we.source,Ae)}_runVerticalEditorScroll(K,we,Ae){let Nt=this._computeDesiredScrollTop(K,Ae);if(Ae.revealCursor){let _i=K.getCompletelyVisibleViewRangeAtScrollTop(Nt);K.setCursorStates(we,3,[Po.findPositionInViewportIfOutside(K,K.getPrimaryCursorState(),_i,Ae.select)])}K.viewLayout.setScrollPosition({scrollTop:Nt},0)}_computeDesiredScrollTop(K,we){if(we.unit===1){let _i=K.viewLayout.getFutureViewport(),Fo=K.getCompletelyVisibleViewRangeAtScrollTop(_i.top),yr=K.coordinatesConverter.convertViewRangeToModelRange(Fo),vt;we.direction===1?vt=Math.max(1,yr.startLineNumber-we.value):vt=Math.min(K.model.getLineCount(),yr.startLineNumber+we.value);let P=K.coordinatesConverter.convertModelPositionToViewPosition(new U(vt,1));return K.viewLayout.getVerticalOffsetForLineNumber(P.lineNumber)}if(we.unit===5){let _i=0;return we.direction===3&&(_i=K.model.getLineCount()-K.cursorConfig.pageSize),K.viewLayout.getVerticalOffsetForLineNumber(_i)}let Ae;we.unit===3?Ae=K.cursorConfig.pageSize*we.value:we.unit===4?Ae=Math.round(K.cursorConfig.pageSize/2)*we.value:Ae=we.value;let Nt=(we.direction===1?-1:1)*Ae;return K.viewLayout.getCurrentScrollTop()+Nt*K.cursorConfig.lineHeight}_runHorizontalEditorScroll(K,we,Ae){let Nt=this._computeDesiredScrollLeft(K,Ae);K.viewLayout.setScrollPosition({scrollLeft:Nt},0)}_computeDesiredScrollLeft(K,we){let Ae=(we.direction===4?-1:1)*we.value;return K.viewLayout.getCurrentScrollLeft()+Ae*K.cursorConfig.typicalHalfwidthCharacterWidth}}Oe.EditorScrollImpl=Jp,Oe.EditorScroll=St(new Jp),Oe.ScrollLineUp=St(new class extends tn{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Up,by:gr.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:K.source})}}),Oe.ScrollPageUp=St(new class extends tn{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Up,by:gr.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:K.source})}}),Oe.ScrollEditorTop=St(new class extends tn{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Up,by:gr.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:K.source})}}),Oe.ScrollLineDown=St(new class extends tn{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Down,by:gr.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:K.source})}}),Oe.ScrollPageDown=St(new class extends tn{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Down,by:gr.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:K.source})}}),Oe.ScrollEditorBottom=St(new class extends tn{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Down,by:gr.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:K.source})}}),Oe.ScrollLeft=St(new class extends tn{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Left,by:gr.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:K.source})}}),Oe.ScrollRight=St(new class extends tn{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus}})}runCoreEditorCommand(De,K){Oe.EditorScroll.runCoreEditorCommand(De,{to:gr.RawDirection.Right,by:gr.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:K.source})}});class ol extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){we.position&&(K.model.pushStackElement(),K.setCursorStates(we.source,3,[Po.word(K,K.getPrimaryCursorState(),this._inSelectionMode,we.position)]),we.revealType!==2&&K.revealAllCursors(we.source,!0,!0))}}Oe.WordSelect=St(new ol({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),Oe.WordSelectDrag=St(new ol({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),Oe.LastCursorWordSelect=St(new class extends tn{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(De,K){if(!K.position)return;let we=De.getLastAddedCursorIndex(),Ae=De.getCursorStates(),Nt=Ae.slice(0),_i=Ae[we];Nt[we]=Po.word(De,_i,_i.modelState.hasSelection(),K.position),De.model.pushStackElement(),De.setCursorStates(K.source,3,Nt)}});class ac extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){we.position&&(K.model.pushStackElement(),K.setCursorStates(we.source,3,[Po.line(K,K.getPrimaryCursorState(),this._inSelectionMode,we.position,we.viewPosition)]),we.revealType!==2&&K.revealAllCursors(we.source,!1,!0))}}Oe.LineSelect=St(new ac({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),Oe.LineSelectDrag=St(new ac({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class Ca extends tn{_inSelectionMode;constructor(K){super(K),this._inSelectionMode=K.inSelectionMode}runCoreEditorCommand(K,we){if(!we.position)return;let Ae=K.getLastAddedCursorIndex(),Nt=K.getCursorStates(),_i=Nt.slice(0);_i[Ae]=Po.line(K,Nt[Ae],this._inSelectionMode,we.position,we.viewPosition),K.model.pushStackElement(),K.setCursorStates(we.source,3,_i)}}Oe.LastCursorLineSelect=St(new Ca({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),Oe.LastCursorLineSelectDrag=St(new Ca({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),Oe.CancelSelection=St(new class extends tn{constructor(){super({id:"cancelSelection",precondition:Re.hasNonEmptySelection,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(De,K){De.model.pushStackElement(),De.setCursorStates(K.source,3,[Po.cancelSelection(De,De.getPrimaryCursorState())]),De.revealAllCursors(K.source,!0)}}),Oe.RemoveSecondaryCursors=St(new class extends tn{constructor(){super({id:"removeSecondaryCursors",precondition:Re.hasMultipleSelections,kbOpts:{weight:Jt+1,kbExpr:Re.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(De,K){De.model.pushStackElement(),De.setCursorStates(K.source,3,[De.getPrimaryCursorState()]),De.revealAllCursors(K.source,!0),QE(h("removedCursor","Removed secondary cursors"))}}),Oe.RevealLine=St(new class extends tn{constructor(){super({id:"revealLine",precondition:void 0,metadata:kx.metadata})}runCoreEditorCommand(De,K){let we=K,Ae=we.lineNumber||0,Nt=typeof Ae=="number"?Ae+1:parseInt(Ae)+1;Nt<1&&(Nt=1);let _i=De.model.getLineCount();Nt>_i&&(Nt=_i);let Fo=new F(Nt,1,Nt,De.model.getLineMaxColumn(Nt)),yr=0;if(we.at)switch(we.at){case kx.RawAtArgument.Top:yr=3;break;case kx.RawAtArgument.Center:yr=1;break;case kx.RawAtArgument.Bottom:yr=4;break;default:break}let vt=De.coordinatesConverter.convertModelRangeToViewRange(Fo);De.revealRange(K.source,!1,vt,yr,0)}}),Oe.SelectAll=new class extends Rx{constructor(){super(RJ)}runDOMCommand(De){dn&&(De.focus(),De.select()),De.ownerDocument.execCommand("selectAll")}runEditorCommand(De,K,we){let Ae=K._getViewModel();Ae&&this.runCoreEditorCommand(Ae,we)}runCoreEditorCommand(De,K){De.model.pushStackElement(),De.setCursorStates("keyboard",3,[Po.selectAll(De,De.getPrimaryCursorState())])}},Oe.SetSelection=St(new class extends tn{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(De,K){K.selection&&(De.model.pushStackElement(),De.setCursorStates(K.source,3,[Rt.fromModelSelection(K.selection)]))}})})(bo||={});var jue=X.and(Re.textInputFocus,Re.columnSelection);function vC(r,t){Zt.registerKeybindingRule({id:r,primary:t,when:jue,weight:Jt+1})}vC(bo.CursorColumnSelectLeft.id,1039);vC(bo.CursorColumnSelectRight.id,1041);vC(bo.CursorColumnSelectUp.id,1040);vC(bo.CursorColumnSelectPageUp.id,1035);vC(bo.CursorColumnSelectDown.id,1042);vC(bo.CursorColumnSelectPageDown.id,1036);function bee(r){return r.register(),r}var $ue;(l=>{class r extends JT{runEditorCommand(c,u,p){let m=u._getViewModel();m&&this.runCoreEditingCommand(u,m,p||{})}}l.CoreEditingCommand=r,l.LineBreakInsert=St(new class extends r{constructor(){super({id:"lineBreakInsert",precondition:Re.writable,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,mC.lineBreakInsert(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection)))}}),l.Outdent=St(new class extends r{constructor(){super({id:"outdent",precondition:Re.writable,kbOpts:{weight:Jt,kbExpr:X.and(Re.editorTextFocus,Re.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Jd.outdent(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.Tab=St(new class extends r{constructor(){super({id:"tab",precondition:Re.writable,kbOpts:{weight:Jt,kbExpr:X.and(Re.editorTextFocus,Re.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(d,c,u){d.pushUndoStop(),d.executeCommands(this.id,Jd.tab(c.cursorConfig,c.model,c.getCursorStates().map(p=>p.modelState.selection))),d.pushUndoStop()}}),l.DeleteLeft=St(new class extends r{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(d,c,u){let[p,m]=Xp.deleteLeft(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(g=>g.modelState.selection),c.getCursorAutoClosedCharacters());p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(2)}}),l.DeleteRight=St(new class extends r{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:Jt,kbExpr:Re.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(d,c,u){let[p,m]=Xp.deleteRight(c.getPrevEditOperationType(),c.cursorConfig,c.model,c.getCursorStates().map(g=>g.modelState.selection));p&&d.pushUndoStop(),d.executeCommands(this.id,m),c.setPrevEditOperationType(3)}}),l.Undo=new class extends Rx{constructor(){super(i4)}runDOMCommand(d){d.ownerDocument.execCommand("undo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().undo()}},l.Redo=new class extends Rx{constructor(){super(n4)}runDOMCommand(d){d.ownerDocument.execCommand("redo")}runEditorCommand(d,c,u){if(!(!c.hasModel()||c.getOption(93)===!0))return c.getModel().redo()}}})($ue||={});var LO=class extends Zf{_handlerId;constructor(t,e,i){super({id:t,precondition:void 0,metadata:i}),this._handlerId=e}runCommand(t,e){let i=t.get(fu).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,e)}};function gb(r,t){bee(new LO("default:"+r,r)),bee(new LO(r,r,t))}gb("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});gb("replacePreviousChar");gb("compositionType");gb("compositionStart");gb("compositionEnd");gb("paste");gb("cut");var yC=class r{onKeyDown=null;onKeyUp=null;onContextMenu=null;onMouseMove=null;onMouseLeave=null;onMouseDown=null;onMouseUp=null;onMouseDrag=null;onMouseDrop=null;onMouseDropCanceled=null;onMouseWheel=null;_coordinatesConverter;constructor(t){this._coordinatesConverter=t}emitKeyDown(t){this.onKeyDown?.(t)}emitKeyUp(t){this.onKeyUp?.(t)}emitContextMenu(t){this.onContextMenu?.(this._convertViewToModelMouseEvent(t))}emitMouseMove(t){this.onMouseMove?.(this._convertViewToModelMouseEvent(t))}emitMouseLeave(t){this.onMouseLeave?.(this._convertViewToModelMouseEvent(t))}emitMouseDown(t){this.onMouseDown?.(this._convertViewToModelMouseEvent(t))}emitMouseUp(t){this.onMouseUp?.(this._convertViewToModelMouseEvent(t))}emitMouseDrag(t){this.onMouseDrag?.(this._convertViewToModelMouseEvent(t))}emitMouseDrop(t){this.onMouseDrop?.(this._convertViewToModelMouseEvent(t))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(t){this.onMouseWheel?.(t)}_convertViewToModelMouseEvent(t){return t.target?{event:t.event,target:this._convertViewToModelMouseTarget(t.target)}:t}_convertViewToModelMouseTarget(t){return r.convertViewToModelMouseTarget(t,this._coordinatesConverter)}static convertViewToModelMouseTarget(t,e){let i={...t};return i.position&&(i.position=e.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=e.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,e)),i}static convertViewToModelViewZoneData(t,e){return{viewZoneId:t.viewZoneId,positionBefore:t.positionBefore?e.convertViewPositionToModelPosition(t.positionBefore):t.positionBefore,positionAfter:t.positionAfter?e.convertViewPositionToModelPosition(t.positionAfter):t.positionAfter,position:e.convertViewPositionToModelPosition(t.position),afterLineNumber:e.convertViewPositionToModelPosition(new U(t.afterLineNumber,1)).lineNumber}}};var kO=class{configuration;viewModel;userInputEvents;commandDelegate;constructor(t,e,i,n){this.configuration=t,this.viewModel=e,this.userInputEvents=i,this.commandDelegate=n}paste(t,e,i,n){this.commandDelegate.paste(t,e,i,n)}type(t){this.commandDelegate.type(t)}compositionType(t,e,i,n){this.commandDelegate.compositionType(t,e,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(t){bo.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:t})}_validateViewColumn(t){let e=this.viewModel.getLineMinColumn(t.lineNumber);return t.column<e?new U(t.lineNumber,e):t}_hasMulticursorModifier(t){switch(this.configuration.options.get(79)){case"altKey":return t.altKey;case"ctrlKey":return t.ctrlKey;case"metaKey":return t.metaKey;default:return!1}}_hasNonMulticursorModifier(t){switch(this.configuration.options.get(79)){case"altKey":return t.ctrlKey||t.metaKey;case"ctrlKey":return t.altKey||t.metaKey;case"metaKey":return t.ctrlKey||t.altKey;default:return!1}}dispatchMouse(t){let e=this.configuration.options,i=_t&&e.get(109),n=e.get(22);t.middleButton&&!i?this._columnSelect(t.position,t.mouseColumn,t.inSelectionMode):t.startedOnLineNumbers?this._hasMulticursorModifier(t)?t.inSelectionMode?this._lastCursorLineSelect(t.position,t.revealType):this._createCursor(t.position,!0):t.inSelectionMode?this._lineSelectDrag(t.position,t.revealType):this._lineSelect(t.position,t.revealType):t.mouseDownCount>=4?this._selectAll():t.mouseDownCount===3?this._hasMulticursorModifier(t)?t.inSelectionMode?this._lastCursorLineSelectDrag(t.position,t.revealType):this._lastCursorLineSelect(t.position,t.revealType):t.inSelectionMode?this._lineSelectDrag(t.position,t.revealType):this._lineSelect(t.position,t.revealType):t.mouseDownCount===2?t.onInjectedText||(this._hasMulticursorModifier(t)?this._lastCursorWordSelect(t.position,t.revealType):t.inSelectionMode?this._wordSelectDrag(t.position,t.revealType):this._wordSelect(t.position,t.revealType)):this._hasMulticursorModifier(t)?this._hasNonMulticursorModifier(t)||(t.shiftKey?this._columnSelect(t.position,t.mouseColumn,!0):t.inSelectionMode?this._lastCursorMoveToSelect(t.position,t.revealType):this._createCursor(t.position,!1)):t.inSelectionMode?t.altKey?this._columnSelect(t.position,t.mouseColumn,!0):n?this._columnSelect(t.position,t.mouseColumn,!0):this._moveToSelect(t.position,t.revealType):this.moveTo(t.position,t.revealType)}_usualArgs(t,e){return t=this._validateViewColumn(t),{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,revealType:e}}moveTo(t,e){bo.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_moveToSelect(t,e){bo.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_columnSelect(t,e,i){t=this._validateViewColumn(t),bo.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,mouseColumn:e,doColumnSelect:i})}_createCursor(t,e){t=this._validateViewColumn(t),bo.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,wholeLine:e})}_lastCursorMoveToSelect(t,e){bo.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_wordSelect(t,e){bo.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_wordSelectDrag(t,e){bo.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lastCursorWordSelect(t,e){bo.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lineSelect(t,e){bo.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lineSelectDrag(t,e){bo.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lastCursorLineSelect(t,e){bo.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_lastCursorLineSelectDrag(t,e){bo.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,e))}_selectAll(){bo.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(t){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t)}emitKeyDown(t){this.userInputEvents.emitKeyDown(t)}emitKeyUp(t){this.userInputEvents.emitKeyUp(t)}emitContextMenu(t){this.userInputEvents.emitContextMenu(t)}emitMouseMove(t){this.userInputEvents.emitMouseMove(t)}emitMouseLeave(t){this.userInputEvents.emitMouseLeave(t)}emitMouseUp(t){this.userInputEvents.emitMouseUp(t)}emitMouseDown(t){this.userInputEvents.emitMouseDown(t)}emitMouseDrag(t){this.userInputEvents.emitMouseDrag(t)}emitMouseDrop(t){this.userInputEvents.emitMouseDrop(t)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(t){this.userInputEvents.emitMouseWheel(t)}};var IC=class extends Nl{_context;viewController;viewHelper;mouseTargetFactory;_mouseDownOperation;lastMouseLeaveTime;_height;_mouseLeaveMonitor=null;constructor(t,e,i){super(),this._context=t,this.viewController=e,this.viewHelper=i,this.mouseTargetFactory=new uC(this._context,i),this._mouseDownOperation=this._register(new bK(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(s,a)=>this._createMouseTarget(s,a),s=>this._getMouseColumn(s))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(147).height;let n=new G0(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,s=>this._onContextMenu(s,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,s=>{this._onMouseMove(s),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=M(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new Vl(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s)));let o=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(s,a)=>{o=a})),this._register(M(this.viewHelper.viewDomNode,G.POINTER_UP,s=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s,o))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){let t=$E.INSTANCE,e=0,i=Lc.getZoomLevel(),n=!1,o=0,s=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(77))return;let d=new Aa(l);if(t.acceptStandardWheelEvent(d),t.isPhysicalMouseWheel()){if(a(l)){let c=Lc.getZoomLevel(),u=d.deltaY>0?1:-1;Lc.setZoomLevel(c+u),d.preventDefault(),d.stopPropagation()}}else Date.now()-e>50&&(i=Lc.getZoomLevel(),n=a(l),o=0),e=Date.now(),o+=d.deltaY,n&&(Lc.setZoomLevel(i+o/5),d.preventDefault(),d.stopPropagation())};this._register(M(this.viewHelper.viewDomNode,G.MOUSE_WHEEL,s,{capture:!0,passive:!1}));function a(l){return be?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(t){if(t.hasChanged(147)){let e=this._context.configuration.options.get(147).height;this._height!==e&&(this._height=e,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(t){return this._mouseDownOperation.onCursorStateChanged(t),!1}onFocusChanged(t){return!1}getTargetAtClientPoint(t,e){let n=new bx(t,e).toPageCoordinates(oe(this.viewHelper.viewDomNode)),o=$0(this.viewHelper.viewDomNode);if(n.y<o.y||n.y>o.y+o.height||n.x<o.x||n.x>o.x+o.width)return null;let s=Y0(this.viewHelper.viewDomNode,o,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),o,n,s,null)}_createMouseTarget(t,e){let i=t.target;if(!this.viewHelper.viewDomNode.contains(i)){let n=cp(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(t.posx,t.posy).find(o=>this.viewHelper.viewDomNode.contains(o)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),t.editorPos,t.pos,t.relativePos,e?i:null)}_getMouseColumn(t){return this.mouseTargetFactory.getMouseColumn(t.relativePos)}_onContextMenu(t,e){this.viewController.emitContextMenu({event:t,target:this._createMouseTarget(t,e)})}_onMouseMove(t){this.mouseTargetFactory.mouseTargetIsWidget(t)||t.preventDefault(),!(this._mouseDownOperation.isActive()||t.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:t,target:this._createMouseTarget(t,!0)})}_onMouseLeave(t){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:t,target:null})}_onMouseUp(t){this.viewController.emitMouseUp({event:t,target:this._createMouseTarget(t,!0)})}_onMouseDown(t,e){let i=this._createMouseTarget(t,!0),n=i.type===6||i.type===7,o=i.type===2||i.type===3||i.type===4,s=i.type===3,a=this._context.configuration.options.get(111),l=i.type===8||i.type===5,d=i.type===9,c=t.leftButton||t.middleButton;be&&t.leftButton&&t.ctrlKey&&(c=!1);let u=()=>{t.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(n||s&&a))u(),this._mouseDownOperation.start(i.type,t,e);else if(o)t.preventDefault();else if(l){let p=i.detail;c&&this.viewHelper.shouldSuppressMouseDownOnViewZone(p.viewZoneId)&&(u(),this._mouseDownOperation.start(i.type,t,e),t.preventDefault())}else d&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(u(),t.preventDefault());this.viewController.emitMouseDown({event:t,target:i})}_onMouseWheel(t){this.viewController.emitMouseWheel(t)}},bK=class extends L{constructor(e,i,n,o,s,a){super();this._context=e;this._viewController=i;this._viewHelper=n;this._mouseTargetFactory=o;this._createMouseTarget=s,this._getMouseColumn=a,this._mouseMoveMonitor=this._register(new j0(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new vK(this._context,this._viewHelper,this._mouseTargetFactory,(l,d,c)=>this._dispatchMouse(l,d,c))),this._mouseState=new IK,this._currentSelection=new It(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}_createMouseTarget;_getMouseColumn;_mouseMoveMonitor;_topBottomDragScrolling;_mouseState;_currentSelection;_isActive;_lastMouseEvent;dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);let i=this._findMousePosition(e,!1);i&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:i}):i.type===13&&(i.outsidePosition==="above"||i.outsidePosition==="below")?this._topBottomDragScrolling.start(i,e):(this._topBottomDragScrolling.stop(),this._dispatchMouse(i,!0,1)))}start(e,i,n){this._lastMouseEvent=i,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(i),this._mouseState.setModifiers(i);let o=this._findMousePosition(i,!0);if(!o||!o.position)return;this._mouseState.trySetCount(i.detail,o.position),i.detail=this._mouseState.count;let s=this._context.configuration.options;if(!s.get(93)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&i.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&o.type===6&&o.position&&this._currentSelection.containsPosition(o.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,n,i.buttons,a=>this._onMouseDownThenMove(a),a=>{let l=this._findMousePosition(this._lastMouseEvent,!1);bl(a)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:l?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(o,i.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,n,i.buttons,a=>this._onMouseDownThenMove(a),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){let i=e.editorPos,n=this._context.viewModel,o=this._context.viewLayout,s=this._getMouseColumn(e);if(e.posy<i.y){let l=i.y-e.posy,d=Math.max(o.getCurrentScrollTop()-l,0),c=cC.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Ao.createOutsideEditor(s,p,"above",l)}let u=o.getLineNumberAtVerticalOffset(d);return Ao.createOutsideEditor(s,new U(u,1),"above",l)}if(e.posy>i.y+i.height){let l=e.posy-i.y-i.height,d=o.getCurrentScrollTop()+e.relativePos.y,c=cC.getZoneAtCoord(this._context,d);if(c){let p=this._helpPositionJumpOverViewZone(c);if(p)return Ao.createOutsideEditor(s,p,"below",l)}let u=o.getLineNumberAtVerticalOffset(d);return Ao.createOutsideEditor(s,new U(u,n.getLineMaxColumn(u)),"below",l)}let a=o.getLineNumberAtVerticalOffset(o.getCurrentScrollTop()+e.relativePos.y);if(e.posx<i.x){let l=i.x-e.posx;return Ao.createOutsideEditor(s,new U(a,1),"left",l)}if(e.posx>i.x+i.width){let l=e.posx-i.x-i.width;return Ao.createOutsideEditor(s,new U(a,n.getLineMaxColumn(a)),"right",l)}return null}_findMousePosition(e,i){let n=this._getPositionOutsideEditor(e);if(n)return n;let o=this._createMouseTarget(e,i);if(!o.position)return null;if(o.type===8||o.type===5){let a=this._helpPositionJumpOverViewZone(o.detail);if(a)return Ao.createViewZone(o.type,o.element,o.mouseColumn,a,o.detail)}return o}_helpPositionJumpOverViewZone(e){let i=new U(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),n=e.positionBefore,o=e.positionAfter;return n&&o?n.isBefore(i)?n:o:null}_dispatchMouse(e,i,n){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:n,inSelectionMode:i,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}},vK=class extends L{constructor(e,i,n,o){super();this._context=e;this._viewHelper=i;this._mouseTargetFactory=n;this._dispatchMouse=o;this._operation=null}_operation;dispose(){super.dispose(),this.stop()}start(e,i){this._operation?this._operation.setPosition(e,i):this._operation=new yK(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,i)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}},yK=class extends L{constructor(e,i,n,o,s,a){super();this._context=e;this._viewHelper=i;this._mouseTargetFactory=n;this._dispatchMouse=o;this._position=s,this._mouseEvent=a,this._lastTime=Date.now(),this._animationFrameDisposable=nn(oe(a.browserEvent),()=>this._execute())}_position;_mouseEvent;_lastTime;_animationFrameDisposable;dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,i){this._position=e,this._mouseEvent=i}_tick(){let e=Date.now(),i=e-this._lastTime;return this._lastTime=e,i}_getScrollSpeed(){let e=this._context.configuration.options.get(68),i=this._context.configuration.options.get(147).height/e,n=this._position.outsideDistance/e;return n<=1.5?Math.max(30,i*(1+n)):n<=3?Math.max(60,i*(2+n)):Math.max(200,i*(7+n))}_execute(){let e=this._context.configuration.options.get(68),i=this._getScrollSpeed(),n=this._tick(),o=i*(n/1e3)*e,s=this._position.outsidePosition==="above"?-o:o;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();let a=this._context.viewLayout.getLinesViewportData(),l=this._position.outsidePosition==="above"?a.startLineNumber:a.endLineNumber,d;{let c=$0(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(147).horizontalScrollbarHeight,p=new Gm(this._mouseEvent.pos.x,c.y+c.height-u-.1),m=Y0(this._viewHelper.viewDomNode,c,p);d=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,p,m,null)}(!d.position||d.position.lineNumber!==l)&&(this._position.outsidePosition==="above"?d=Ao.createOutsideEditor(this._position.mouseColumn,new U(l,1),"above",this._position.outsideDistance):d=Ao.createOutsideEditor(this._position.mouseColumn,new U(l,this._context.viewModel.getLineMaxColumn(l)),"below",this._position.outsideDistance)),this._dispatchMouse(d,!0,2),this._animationFrameDisposable=nn(oe(d.element),()=>this._execute())}},IK=class r{static CLEAR_MOUSE_DOWN_COUNT_TIME=400;_altKey;get altKey(){return this._altKey}_ctrlKey;get ctrlKey(){return this._ctrlKey}_metaKey;get metaKey(){return this._metaKey}_shiftKey;get shiftKey(){return this._shiftKey}_leftButton;get leftButton(){return this._leftButton}_middleButton;get middleButton(){return this._middleButton}_startedOnLineNumbers;get startedOnLineNumbers(){return this._startedOnLineNumbers}_lastMouseDownPosition;_lastMouseDownPositionEqualCount;_lastMouseDownCount;_lastSetMouseDownCountTime;isDragAndDrop;constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(t){this._altKey=t.altKey,this._ctrlKey=t.ctrlKey,this._metaKey=t.metaKey,this._shiftKey=t.shiftKey}setStartButtons(t){this._leftButton=t.leftButton,this._middleButton=t.middleButton}setStartedOnLineNumbers(t){this._startedOnLineNumbers=t}trySetCount(t,e){let i=new Date().getTime();i-this._lastSetMouseDownCountTime>r.CLEAR_MOUSE_DOWN_COUNT_TIME&&(t=1),this._lastSetMouseDownCountTime=i,t>this._lastMouseDownCount+1&&(t=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(e)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=e,this._lastMouseDownCount=Math.min(t,this._lastMouseDownPositionEqualCount)}};function RO(r,t,e,i){let n=r.getPlainTextToCopy(t,e,rt),o=r.model.getEOL(),s=e&&t.length===1&&t[0].isEmpty(),a=Array.isArray(n)?n:null,l=Array.isArray(n)?n.join(o):n,d,c=null;if(Zue.forceCopyWithSyntaxHighlighting||i&&l.length<65536){let p=r.getRichTextToCopy(t,e);p&&(d=p.html,c=p.mode)}return{isFromEmptySelection:s,multicursorText:a,text:l,html:d,mode:c}}var fb=class r{static INSTANCE=new r;_lastState;constructor(){this._lastState=null}set(t,e){this._lastState={lastCopiedValue:t,data:e}}get(t){return this._lastState&&this._lastState.lastCopiedValue===t?this._lastState.data:(this._lastState=null,null)}},Zue={forceCopyWithSyntaxHighlighting:!1};var CC=class r{static _getPageOfLine(t,e){return Math.floor((t-1)/e)}static _getRangeForPage(t,e){let i=t*e,n=i+1,o=i+e;return new F(n,1,o+1,1)}static fromEditorSelection(t,e,i,n){let s=r._getPageOfLine(e.startLineNumber,i),a=r._getRangeForPage(s,i),l=r._getPageOfLine(e.endLineNumber,i),d=r._getRangeForPage(l,i),c=a.intersectRanges(new F(1,1,e.startLineNumber,e.startColumn));if(n&&t.getValueLengthInRange(c,1)>500){let y=t.modifyPosition(c.getEndPosition(),-500);c=F.fromPositions(y,c.getEndPosition())}let u=t.getValueInRange(c,1),p=t.getLineCount(),m=t.getLineMaxColumn(p),g=d.intersectRanges(new F(e.endLineNumber,e.endColumn,p,m));if(n&&t.getValueLengthInRange(g,1)>500){let y=t.modifyPosition(g.getStartPosition(),500);g=F.fromPositions(g.getStartPosition(),y)}let f=t.getValueInRange(g,1),b;if(s===l||s+1===l)b=t.getValueInRange(e,1);else{let y=a.intersectRanges(e),I=d.intersectRanges(e);b=t.getValueInRange(y,1)+"\u2026"+t.getValueInRange(I,1)}return n&&b.length>2*500&&(b=b.substring(0,500)+"\u2026"+b.substring(b.length-500,b.length)),{value:u+b+f,selection:e,selectionStart:u.length,selectionEnd:u.length+b.length,newlineCountBeforeSelection:c.endLineNumber-c.startLineNumber}}};function Ax(r,t){if(r.get(2)===1){let i=t.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),n=t.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),o=t.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),s=h("accessibilityModeOff","The editor is not accessible at this time.");return i?h("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",s,i):n?h("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",s,n):o?h("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",s,o):s}return r.get(4)}function Px(r){let t=0,e=-1;do{if(e=r.indexOf(`
`,e+1),e===-1)break;t++}while(!0);return t}var Ws=!1,Mo=class r{constructor(t,e,i,n,o){this.value=t;this.selectionStart=e;this.selectionEnd=i;this.selection=n;this.newlineCountBeforeSelection=o}static EMPTY=new r("",0,0,null,void 0);toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(t,e){let i=t.getValue(),n=t.getSelectionStart(),o=t.getSelectionEnd(),s;if(e){let a=i.substring(0,n),l=e.value.substring(0,e.selectionStart);a===l&&(s=e.newlineCountBeforeSelection)}return new r(i,n,o,null,s)}collapseSelection(){return this.selectionStart===this.value.length?this:new r(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(t,e,i){Ws&&console.log(`writeToTextArea ${t}: ${this.toString()}`),e.setValue(t,this.value),i&&e.setSelectionRange(t,this.selectionStart,this.selectionEnd)}deduceEditorPosition(t){if(t<=this.selectionStart){let n=this.value.substring(t,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,n,-1)}if(t>=this.selectionEnd){let n=this.value.substring(this.selectionEnd,t);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,1)}let e=this.value.substring(this.selectionStart,t);if(e.indexOf("\u2026")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,e,1);let i=this.value.substring(t,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,-1)}_finishDeduceEditorPosition(t,e,i){let n=0,o=-1;for(;(o=e.indexOf(`
`,o+1))!==-1;)n++;return[t,i*e.length,n]}static deduceInput(t,e,i){if(!t)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};Ws&&(console.log("------------------------deduceInput"),console.log(`PREVIOUS STATE: ${t.toString()}`),console.log(`CURRENT STATE: ${e.toString()}`));let n=Math.min(JS(t.value,e.value),t.selectionStart,e.selectionStart),o=Math.min(ew(t.value,e.value),t.value.length-t.selectionEnd,e.value.length-e.selectionEnd),s=t.value.substring(n,t.value.length-o),a=e.value.substring(n,e.value.length-o),l=t.selectionStart-n,d=t.selectionEnd-n,c=e.selectionStart-n,u=e.selectionEnd-n;if(Ws&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${s}>, selectionStart: ${l}, selectionEnd: ${d}`),console.log(`AFTER DIFFING CURRENT STATE: <${a}>, selectionStart: ${c}, selectionEnd: ${u}`)),c===u){let m=t.selectionStart-n;return Ws&&console.log(`REMOVE PREVIOUS: ${m} chars`),{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}let p=d-l;return{text:a,replacePrevCharCnt:p,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(t,e){if(!t)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(Ws&&(console.log("------------------------deduceAndroidCompositionInput"),console.log(`PREVIOUS STATE: ${t.toString()}`),console.log(`CURRENT STATE: ${e.toString()}`)),t.value===e.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:e.selectionEnd-t.selectionEnd};let i=Math.min(JS(t.value,e.value),t.selectionEnd),n=Math.min(ew(t.value,e.value),t.value.length-t.selectionEnd),o=t.value.substring(i,t.value.length-n),s=e.value.substring(i,e.value.length-n),a=t.selectionStart-i,l=t.selectionEnd-i,d=e.selectionStart-i,c=e.selectionEnd-i;return Ws&&(console.log(`AFTER DIFFING PREVIOUS STATE: <${o}>, selectionStart: ${a}, selectionEnd: ${l}`),console.log(`AFTER DIFFING CURRENT STATE: <${s}>, selectionStart: ${d}, selectionEnd: ${c}`)),{text:s,replacePrevCharCnt:l,replaceNextCharCnt:o.length-l,positionDelta:c-s.length}}static fromScreenReaderContentState(t){return new r(t.value,t.selectionStart,t.selectionEnd,t.selection,t.newlineCountBeforeSelection)}};var PO;(t=>t.Tap="-monaco-textarea-synthetic-tap")(PO||={});var CK=class{_lastTypeTextLength;constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(t){t=t||"";let e={text:t,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=t.length,e}},SC=class extends L{constructor(e,i,n,o,s,a){super();this._host=e;this._textArea=i;this._OS=n;this._browser=o;this._accessibilityService=s;this._logService=a;this._asyncTriggerCut=this._register(new Et(()=>this._onCut.fire(),0)),this._textAreaState=Mo.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(O.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Et(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let l=null;this._register(this._textArea.onKeyDown(d=>{let c=new st(d);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),l=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(d=>{let c=new st(d);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(d=>{Ws&&console.log("[compositionstart]",d);let c=new CK;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&l&&l.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===d.data&&(l.code==="ArrowRight"||l.code==="ArrowLeft")){Ws&&console.log("[compositionstart] Handling long press case on macOS + arrow key",d),c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:d.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:d.data});return}this._onCompositionStart.fire({data:d.data})})),this._register(this._textArea.onCompositionUpdate(d=>{Ws&&console.log("[compositionupdate]",d);let c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){let p=Mo.readFromTextArea(this._textArea,this._textAreaState),m=Mo.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionUpdate.fire(d);return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Mo.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionUpdate.fire(d)})),this._register(this._textArea.onCompositionEnd(d=>{Ws&&console.log("[compositionend]",d);let c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){let p=Mo.readFromTextArea(this._textArea,this._textAreaState),m=Mo.deduceAndroidCompositionInput(this._textAreaState,p);this._textAreaState=p,this._onType.fire(m),this._onCompositionEnd.fire();return}let u=c.handleCompositionUpdate(d.data);this._textAreaState=Mo.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(u),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(d=>{if(Ws&&console.log("[input]",d),this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;let c=Mo.readFromTextArea(this._textArea,this._textAreaState),u=Mo.deduceInput(this._textAreaState,c,this._OS===2);u.replacePrevCharCnt===0&&u.text.length===1&&(ln(u.text.charCodeAt(0))||u.text.charCodeAt(0)===127)||(this._textAreaState=c,(u.text!==""||u.replacePrevCharCnt!==0||u.replaceNextCharCnt!==0||u.positionDelta!==0)&&this._onType.fire(u))})),this._register(this._textArea.onCut(d=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(d),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(d=>{this._ensureClipboardGetsEditorSelection(d)})),this._register(this._textArea.onPaste(d=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),d.preventDefault(),!d.clipboardData)return;let[c,u]=vee.getTextData(d.clipboardData);c&&(u=u||fb.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:u}))})),this._register(this._textArea.onFocus(()=>{let d=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!d&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Et(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_onFocus=this._register(new T);onFocus=this._onFocus.event;_onBlur=this._register(new T);onBlur=this._onBlur.event;_onKeyDown=this._register(new T);onKeyDown=this._onKeyDown.event;_onKeyUp=this._register(new T);onKeyUp=this._onKeyUp.event;_onCut=this._register(new T);onCut=this._onCut.event;_onPaste=this._register(new T);onPaste=this._onPaste.event;_onType=this._register(new T);onType=this._onType.event;_onCompositionStart=this._register(new T);onCompositionStart=this._onCompositionStart.event;_onCompositionUpdate=this._register(new T);onCompositionUpdate=this._onCompositionUpdate.event;_onCompositionEnd=this._register(new T);onCompositionEnd=this._onCompositionEnd.event;_onSelectionChangeRequest=this._register(new T);onSelectionChangeRequest=this._onSelectionChangeRequest.event;_asyncTriggerCut;_asyncFocusGainWriteScreenReaderContent=this._register(new mt);_textAreaState;get textAreaState(){return this._textAreaState}_selectionChangeListener;_hasFocus;_currentComposition;_initializeFromTest(){this._hasFocus=!0,this._textAreaState=Mo.readFromTextArea(this._textArea,null)}_installSelectionChangeListener(){let e=0;return M(this._textArea.ownerDocument,"selectionchange",i=>{if(Yp.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;let n=Date.now(),o=n-e;if(e=n,o<5)return;let s=n-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;let a=this._textArea.getValue();if(this._textAreaState.value!==a)return;let l=this._textArea.getSelectionStart(),d=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===l&&this._textAreaState.selectionEnd===d)return;let c=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(c[0],c[1],c[2]),p=this._textAreaState.deduceEditorPosition(d),m=this._host.deduceModelPosition(p[0],p[1],p[2]),g=new It(u.lineNumber,u.column,m.lineNumber,m.column);this._onSelectionChangeRequest.fire(g)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,i){this._hasFocus||(i=i.collapseSelection()),i.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=i}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${e})`),this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(e){let i=this._host.getDataToCopy(),n={version:1,isFromEmptySelection:i.isFromEmptySelection,multicursorText:i.multicursorText,mode:i.mode};fb.INSTANCE.set(this._browser.isFirefox?i.text.replace(/\r\n/g,`
`):i.text,n),e.preventDefault(),e.clipboardData&&vee.setTextData(e.clipboardData,i.text,i.html,n)}};SC=_([v(4,zo),v(5,Gt)],SC);var vee={getTextData(r){let t=r.getData(Id.text),e=null,i=r.getData("vscode-editor-data");if(typeof i=="string")try{e=JSON.parse(i),e.version!==1&&(e=null)}catch{}return t.length===0&&e===null&&r.files.length>0?[Array.prototype.slice.call(r.files,0).map(o=>o.name).join(`
`),null]:[t,e]},setTextData(r,t,e,i){r.setData(Id.text,t),typeof e=="string"&&r.setData("text/html",e),r.setData("vscode-editor-data",JSON.stringify(i))}},AO=class extends L{constructor(e){super();this._actual=e;this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>Yp.onKeyDown())),this._register(this.onBeforeInput(()=>Yp.onBeforeInput())),this._register(this.onInput(()=>Yp.onInput())),this._register(this.onKeyUp(()=>Yp.onKeyUp())),this._register(M(this._actual,PO.Tap,()=>this._onSyntheticTap.fire()))}onKeyDown=this._register(new Ge(this._actual,"keydown")).event;onKeyPress=this._register(new Ge(this._actual,"keypress")).event;onKeyUp=this._register(new Ge(this._actual,"keyup")).event;onCompositionStart=this._register(new Ge(this._actual,"compositionstart")).event;onCompositionUpdate=this._register(new Ge(this._actual,"compositionupdate")).event;onCompositionEnd=this._register(new Ge(this._actual,"compositionend")).event;onBeforeInput=this._register(new Ge(this._actual,"beforeinput")).event;onInput=this._register(new Ge(this._actual,"input")).event;onCut=this._register(new Ge(this._actual,"cut")).event;onCopy=this._register(new Ge(this._actual,"copy")).event;onPaste=this._register(new Ge(this._actual,"paste")).event;onFocus=this._register(new Ge(this._actual,"focus")).event;onBlur=this._register(new Ge(this._actual,"blur")).event;get ownerDocument(){return this._actual.ownerDocument}_onSyntheticTap=this._register(new T);onSyntheticTap=this._onSyntheticTap.event;_ignoreSelectionChangeTime;hasFocus(){let e=cp(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?An()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,i){let n=this._actual;n.value!==i&&(this.setIgnoreSelectionChangeTime("setValue"),n.value=i)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,i,n){let o=this._actual,s=null,a=cp(o);a?s=a.activeElement:s=An();let l=oe(s),d=s===o,c=o.selectionStart,u=o.selectionEnd;if(d&&c===i&&u===n){dn&&l.parent!==l&&o.focus();return}if(d){this.setIgnoreSelectionChangeTime("setSelectionRange"),o.setSelectionRange(i,n),dn&&l.parent!==l&&o.focus();return}try{let p=i$(o);this.setIgnoreSelectionChangeTime("setSelectionRange"),o.focus(),o.setSelectionRange(i,n),n$(o,p)}catch{}}};var SK=class extends IC{_lastPointerType;constructor(t,e,i){super(t,e,i),this._register(Wt.addTarget(this.viewHelper.linesContentDomNode)),this._register(M(this.viewHelper.linesContentDomNode,it.Tap,o=>this.onTap(o))),this._register(M(this.viewHelper.linesContentDomNode,it.Change,o=>this.onChange(o))),this._register(M(this.viewHelper.linesContentDomNode,it.Contextmenu,o=>this._onContextMenu(new Vl(o,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(M(this.viewHelper.linesContentDomNode,"pointerdown",o=>{let s=o.pointerType;if(s==="mouse"){this._lastPointerType="mouse";return}else s==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));let n=new q0(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,o=>this._onMouseMove(o))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,s)=>this._onMouseDown(o,s)))}onTap(t){!t.initialTarget||!this.viewHelper.linesContentDomNode.contains(t.initialTarget)||(t.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(t,!1))}onChange(t){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-t.translationX,-t.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(t,!0)}_dispatchGesture(t,e){let i=this._createMouseTarget(new Vl(t,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:t.tapCount,inSelectionMode:e,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(t,e){t.browserEvent.pointerType!=="touch"&&super._onMouseDown(t,e)}},wK=class extends IC{constructor(t,e,i){super(t,e,i),this._register(Wt.addTarget(this.viewHelper.linesContentDomNode)),this._register(M(this.viewHelper.linesContentDomNode,it.Tap,n=>this.onTap(n))),this._register(M(this.viewHelper.linesContentDomNode,it.Change,n=>this.onChange(n))),this._register(M(this.viewHelper.linesContentDomNode,it.Contextmenu,n=>this._onContextMenu(new Vl(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(t){t.preventDefault(),this.viewHelper.focusTextArea();let e=this._createMouseTarget(new Vl(t,!1,this.viewHelper.viewDomNode),!1);if(e.position){let i=document.createEvent("CustomEvent");i.initEvent(PO.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(e.position,1)}}onChange(t){this._context.viewModel.viewLayout.deltaScrollNow(-t.translationX,-t.translationY)}},MO=class extends L{handler;constructor(t,e,i){super(),(Xo||Q9&&R_)&&Bv.pointerEvents?this.handler=this._register(new SK(t,e,i)):ne.TouchEvent?this.handler=this._register(new wK(t,e,i)):this.handler=this._register(new IC(t,e,i))}getTargetAtClientPoint(t,e){return this.handler.getTargetAtClientPoint(t,e)}};var gs=class extends Nl{};var OO=class extends ji{_visibleLines;domNode;_dynamicOverlays=[];_isFocused=!1;constructor(t){super(t),this._visibleLines=new oC({createLine:()=>new EK(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;let i=this._context.configuration.options.get(51);rn(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let t=0,e=this._dynamicOverlays.length;t<e;t++)if(this._dynamicOverlays[t].shouldRender())return!0;return!1}dispose(){super.dispose();for(let t=0,e=this._dynamicOverlays.length;t<e;t++)this._dynamicOverlays[t].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(t){this._dynamicOverlays.push(t)}onConfigurationChanged(t){this._visibleLines.onConfigurationChanged(t);let i=this._context.configuration.options.get(51);return rn(this.domNode,i),!0}onFlushed(t){return this._visibleLines.onFlushed(t)}onFocusChanged(t){return this._isFocused=t.isFocused,!0}onLinesChanged(t){return this._visibleLines.onLinesChanged(t)}onLinesDeleted(t){return this._visibleLines.onLinesDeleted(t)}onLinesInserted(t){return this._visibleLines.onLinesInserted(t)}onScrollChanged(t){return this._visibleLines.onScrollChanged(t)||!0}onTokensChanged(t){return this._visibleLines.onTokensChanged(t)}onZonesChanged(t){return this._visibleLines.onZonesChanged(t)}prepareRender(t){let e=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=e.length;i<n;i++){let o=e[i];o.prepareRender(t),o.onDidRender()}}render(t){this._viewOverlaysRender(t),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(t){this._visibleLines.renderLines(t.viewportData)}},EK=class{_dynamicOverlays;_domNode;_renderedContent;constructor(t){this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(t){this._domNode=ut(t)}onContentChanged(){}onTokensChanged(){}renderLine(t,e,i,n,o){let s="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){let d=this._dynamicOverlays[a];s+=d.render(n.startLineNumber,t)}return this._renderedContent===s?!1:(this._renderedContent=s,o.appendString('<div style="top:'),o.appendString(String(e)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString('px;">'),o.appendString(s),o.appendString("</div>"),!0)}layoutLine(t,e,i){this._domNode&&(this._domNode.setTop(e),this._domNode.setHeight(i))}},NO=class extends OO{_contentWidth;constructor(t){super(t);let i=this._context.configuration.options.get(147);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(t){let i=this._context.configuration.options.get(147);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(t)||!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollWidthChanged}_viewOverlaysRender(t){super._viewOverlaysRender(t),this.domNode.setWidth(Math.max(t.scrollWidth,this._contentWidth))}},FO=class extends OO{_contentLeft;constructor(t){super(t);let e=this._context.configuration.options,i=e.get(147);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),rn(this.domNode,e.get(51))}onConfigurationChanged(t){let e=this._context.configuration.options;rn(this.domNode,e.get(51));let i=e.get(147);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(t)||!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollHeightChanged}_viewOverlaysRender(t){super._viewOverlaysRender(t);let e=Math.min(t.scrollHeight,1e6);this.domNode.setHeight(e),this.domNode.setWidth(this._contentLeft)}};var BO=class extends ji{domNode;blocks=[];contentWidth=-1;contentLeft=0;constructor(t){super(t),this.domNode=ut(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let t=!1,i=this._context.configuration.options.get(147),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,t=!0);let o=i.contentLeft;return this.contentLeft!==o&&(this.contentLeft=o,t=!0),t}dispose(){super.dispose()}onConfigurationChanged(t){return this.update()}onScrollChanged(t){return t.scrollTopChanged||t.scrollLeftChanged}onDecorationsChanged(t){return!0}onZonesChanged(t){return!0}prepareRender(t){}render(t){let e=0,i=t.getDecorationsInViewport();for(let n of i){if(!n.options.blockClassName)continue;let o=this.blocks[e];o||(o=this.blocks[e]=ut(document.createElement("div")),this.domNode.appendChild(o));let s,a;n.options.blockIsAfterEnd?(s=t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(s=t.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?t.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));let[l,d,c,u]=n.options.blockPadding??[0,0,0,0];o.setClassName("blockDecorations-block "+n.options.blockClassName),o.setLeft(this.contentLeft-u),o.setWidth(this.contentWidth+u+d),o.setTop(s-t.scrollTop-l),o.setHeight(a-s+l+c),e++}for(let n=e;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=e}};var VO=class extends ji{_viewDomNode;_widgets;domNode;overflowingContentWidgetsDomNode;constructor(t,e){super(t),this._viewDomNode=e,this._widgets={},this.domNode=ut(document.createElement("div")),Ro.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=ut(document.createElement("div")),Ro.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].onConfigurationChanged(t);return!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLineMappingChanged(t){return this._updateAnchorsViewPositions(),!0}onLinesChanged(t){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(t){return this._updateAnchorsViewPositions(),!0}onLinesInserted(t){return this._updateAnchorsViewPositions(),!0}onScrollChanged(t){return!0}onZonesChanged(t){return!0}_updateAnchorsViewPositions(){let t=Object.keys(this._widgets);for(let e of t)this._widgets[e].updateAnchorViewPosition()}addWidget(t){let e=new xK(this._context,this._viewDomNode,t);this._widgets[e.id]=e,e.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(e.domNode):this.domNode.appendChild(e.domNode),this.setShouldRender()}setWidgetPosition(t,e,i,n,o){this._widgets[t.getId()].setPosition(e,i,n,o),this.setShouldRender()}removeWidget(t){let e=t.getId();if(this._widgets.hasOwnProperty(e)){let i=this._widgets[e];delete this._widgets[e];let n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(t){return this._widgets.hasOwnProperty(t)?this._widgets[t].suppressMouseDown:!1}onBeforeRender(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].onBeforeRender(t)}prepareRender(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].prepareRender(t)}render(t){let e=Object.keys(this._widgets);for(let i of e)this._widgets[i].render(t)}},xK=class{_context;_viewDomNode;_actual;domNode;id;allowEditorOverflow;suppressMouseDown;_fixedOverflowWidgets;_contentWidth;_contentLeft;_lineHeight;_primaryAnchor=new bb(null,null);_secondaryAnchor=new bb(null,null);_affinity;_preference;_cachedDomNodeOffsetWidth;_cachedDomNodeOffsetHeight;_maxWidth;_isVisible;_renderData;constructor(t,e,i){this._context=t,this._viewDomNode=e,this._actual=i,this.domNode=ut(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;let n=this._context.configuration.options,o=n.get(147);this._fixedOverflowWidgets=n.get(43),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._lineHeight=n.get(68),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(t){let e=this._context.configuration.options;if(this._lineHeight=e.get(68),t.hasChanged(147)){let i=e.get(147);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(t,e,i){this._affinity=t,this._primaryAnchor=n(e,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(o,s,a){if(!o)return new bb(null,null);let l=s.model.validatePosition(o);if(s.coordinatesConverter.modelPositionIsVisible(l)){let d=s.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new bb(o,d)}return new bb(o,null)}}_getMaxWidth(){let t=this.domNode.domNode.ownerDocument,e=t.defaultView;return this.allowEditorOverflow?e?.innerWidth||t.documentElement.offsetWidth||t.body.offsetWidth:this._contentWidth}setPosition(t,e,i,n){this._setPosition(n,t,e),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(t,e,i,n){let o=t.top,s=o,a=t.top+t.height,l=n.viewportHeight-a,d=o-i,c=s>=i,u=a,p=l>=i,m=t.left;return m+e>n.scrollLeft+n.viewportWidth&&(m=n.scrollLeft+n.viewportWidth-e),m<n.scrollLeft&&(m=n.scrollLeft),{fitsAbove:c,aboveTop:d,fitsBelow:p,belowTop:u,left:m}}_layoutHorizontalSegmentInPage(t,e,i,n){let a=Math.max(15,e.left-n),l=Math.min(e.left+e.width+n,t.width-15),c=this._viewDomNode.domNode.ownerDocument.defaultView,u=e.left+i-(c?.scrollX??0);if(u+n>l){let p=u-(l-n);u-=p,i-=p}if(u<a){let p=u-a;u-=p,i-=p}return[i,u]}_layoutBoxInPage(t,e,i,n){let o=t.top-i,s=t.top+t.height,a=To(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,d=l.defaultView,c=a.top+o-(d?.scrollY??0),u=a.top+s-(d?.scrollY??0),p=gd(l.body),[m,g]=this._layoutHorizontalSegmentInPage(p,a,t.left-n.scrollLeft+this._contentLeft,e),f=22,b=22,y=c>=f,I=u+i<=p.height-b;return this._fixedOverflowWidgets?{fitsAbove:y,aboveTop:Math.max(c,f),fitsBelow:I,belowTop:u,left:g}:{fitsAbove:y,aboveTop:o,fitsBelow:I,belowTop:s,left:m}}_prepareRenderWidgetAtExactPositionOverflowing(t){return new vb(t.top,t.left+this._contentLeft)}_getAnchorsCoordinates(t){let e=o(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),i=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,n=o(i,this._affinity,this._lineHeight);return{primary:e,secondary:n};function o(s,a,l){if(!s)return null;let d=t.visibleRangeForPosition(s);if(!d)return null;let c=s.column===1&&a===3?0:d.left,u=t.getVerticalOffsetForLineNumber(s.lineNumber)-t.scrollTop;return new WO(u,c,l)}}_reduceAnchorCoordinates(t,e,i){if(!e)return t;let n=this._context.configuration.options.get(51),o=e.left;return o<t.left?o=Math.max(o,t.left-i+n.typicalFullwidthCharacterWidth):o=Math.min(o,t.left+i-n.typicalFullwidthCharacterWidth),new WO(t.top,o,t.height)}_prepareRenderWidget(t){if(!this._preference||this._preference.length===0)return null;let{primary:e,secondary:i}=this._getAnchorsCoordinates(t);if(!e)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=TK(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeOffsetWidth=s.width,this._cachedDomNodeOffsetHeight=s.height;else{let l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}let n=this._reduceAnchorCoordinates(e,i,this._cachedDomNodeOffsetWidth),o;this.allowEditorOverflow?o=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,t):o=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,t);for(let s=1;s<=2;s++)for(let a of this._preference)if(a===1){if(!o)return null;if(s===2||o.fitsAbove)return{kind:"inViewport",coordinate:new vb(o.aboveTop,o.left),position:1}}else if(a===2){if(!o)return null;if(s===2||o.fitsBelow)return{kind:"inViewport",coordinate:new vb(o.belowTop,o.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new vb(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new vb(n.top,n.left),position:0};return null}onBeforeRender(t){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<t.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>t.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(t){this._renderData=this._prepareRenderWidget(t)}render(t){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&TK(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+t.scrollTop-t.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&TK(this._actual.afterRender,this._actual,this._renderData.position)}},bb=class{constructor(t,e){this.modelPosition=t;this.viewPosition=e}},vb=class{constructor(t,e){this.top=t;this.left=e}_coordinateBrand=void 0},WO=class{constructor(t,e,i){this.top=t;this.left=e;this.height=i}_anchorCoordinateBrand=void 0};function TK(r,t,...e){try{return r.call(t,...e)}catch{return null}}var UO=class extends gs{_context;_renderLineHighlight;_wordWrap;_contentLeft;_contentWidth;_selectionIsEmpty;_renderLineHighlightOnlyWhenFocus;_focused;_cursorLineNumbers;_selections;_renderData;constructor(t){super(),this._context=t;let e=this._context.configuration.options,i=e.get(147);this._renderLineHighlight=e.get(98),this._renderLineHighlightOnlyWhenFocus=e.get(99),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new It(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let t=!1,e=new Set;for(let o of this._selections)e.add(o.positionLineNumber);let i=Array.from(e);i.sort((o,s)=>o-s),ti(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,t=!0);let n=this._selections.every(o=>o.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,t=!0),t}onThemeChanged(t){return this._readFromSelections()}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._renderLineHighlight=e.get(98),this._renderLineHighlightOnlyWhenFocus=e.get(99),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(t){return this._selections=t.selections,this._readFromSelections()}onFlushed(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollWidthChanged||t.scrollTopChanged}onZonesChanged(t){return!0}onFocusChanged(t){return this._renderLineHighlightOnlyWhenFocus?(this._focused=t.isFocused,!0):!1}prepareRender(t){if(!this._shouldRenderThis()){this._renderData=null;return}let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=[];for(let s=e;s<=i;s++){let a=s-e;n[a]=""}if(this._wordWrap){let s=this._renderOne(t,!1);for(let a of this._cursorLineNumbers){let l=this._context.viewModel.coordinatesConverter,d=l.convertViewPositionToModelPosition(new U(a,1)).lineNumber,c=l.convertModelPositionToViewPosition(new U(d,1)).lineNumber,u=l.convertModelPositionToViewPosition(new U(d,this._context.viewModel.model.getLineMaxColumn(d))).lineNumber,p=Math.max(c,e),m=Math.min(u,i);for(let g=p;g<=m;g++){let f=g-e;n[f]=s}}}let o=this._renderOne(t,!0);for(let s of this._cursorLineNumbers){if(s<e||s>i)continue;let a=s-e;n[a]=o}this._renderData=n}render(t,e){if(!this._renderData)return"";let i=e-t;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}},HO=class extends UO{_renderOne(t,e){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(e?" current-line-exact":"")}" style="width:${Math.max(t.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}},zO=class extends UO{_renderOne(t,e){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&e?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}};co((r,t)=>{let e=r.getColor(qU);if(e&&(t.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${e}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${e}; border: none; }`)),!e||e.isTransparent()||r.defines(jU)){let i=r.getColor(jU);i&&(t.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),Ra(r.type)&&(t.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),t.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});var KO=class extends gs{_context;_typicalHalfwidthCharacterWidth;_renderResult;constructor(t){super(),this._context=t;let e=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged||t.scrollWidthChanged}onZonesChanged(t){return!0}prepareRender(t){let e=t.getDecorationsInViewport(),i=[],n=0;for(let l=0,d=e.length;l<d;l++){let c=e[l];c.options.className&&(i[n++]=c)}i=i.sort((l,d)=>{if(l.options.zIndex<d.options.zIndex)return-1;if(l.options.zIndex>d.options.zIndex)return 1;let c=l.options.className,u=d.options.className;return c<u?-1:c>u?1:F.compareRangesUsingStarts(l.range,d.range)});let o=t.visibleRange.startLineNumber,s=t.visibleRange.endLineNumber,a=[];for(let l=o;l<=s;l++){let d=l-o;a[d]=""}this._renderWholeLineDecorations(t,i,a),this._renderNormalDecorations(t,i,a),this._renderResult=a}_renderWholeLineDecorations(t,e,i){let n=t.visibleRange.startLineNumber,o=t.visibleRange.endLineNumber;for(let s=0,a=e.length;s<a;s++){let l=e[s];if(!l.options.isWholeLine)continue;let d='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',c=Math.max(l.range.startLineNumber,n),u=Math.min(l.range.endLineNumber,o);for(let p=c;p<=u;p++){let m=p-n;i[m]+=d}}}_renderNormalDecorations(t,e,i){let n=t.visibleRange.startLineNumber,o=null,s=!1,a=null,l=!1;for(let d=0,c=e.length;d<c;d++){let u=e[d];if(u.options.isWholeLine)continue;let p=u.options.className,m=!!u.options.showIfCollapsed,g=u.range;if(m&&g.endColumn===1&&g.endLineNumber!==g.startLineNumber&&(g=new F(g.startLineNumber,g.startColumn,g.endLineNumber-1,this._context.viewModel.getLineMaxColumn(g.endLineNumber-1))),o===p&&s===m&&F.areIntersectingOrTouching(a,g)){a=F.plusRange(a,g);continue}o!==null&&this._renderNormalDecoration(t,a,o,l,s,n,i),o=p,s=m,a=g,l=u.options.shouldFillLineOnLineBreak??!1}o!==null&&this._renderNormalDecoration(t,a,o,l,s,n,i)}_renderNormalDecoration(t,e,i,n,o,s,a){let l=t.linesVisibleRangesForRange(e,i==="findMatch");if(l)for(let d=0,c=l.length;d<c;d++){let u=l[d];if(u.outsideRenderedLine)continue;let p=u.lineNumber-s;if(o&&u.ranges.length===1){let m=u.ranges[0];if(m.width<this._typicalHalfwidthCharacterWidth){let g=Math.round(m.left+m.width/2),f=Math.max(0,Math.round(g-this._typicalHalfwidthCharacterWidth/2));u.ranges[0]=new nC(f,this._typicalHalfwidthCharacterWidth)}}for(let m=0,g=u.ranges.length;m<g;m++){let f=n&&u.continuesOnNextLine&&g===1,b=u.ranges[m],y='<div class="cdr '+i+'" style="left:'+String(b.left)+"px;width:"+(f?"100%;":String(b.width)+"px;")+'"></div>';a[p]+=y}}}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};var GO=class extends ji{scrollbar;scrollbarDomNode;constructor(t,e,i,n){super(t);let o=this._context.configuration.options,s=o.get(105),a=o.get(76),l=o.get(41),d=o.get(108),c={listenOnDomNode:i.domNode,className:"editor-scrollable "+Ow(t.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,alwaysConsumeMouseWheel:s.alwaysConsumeMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:d,scrollByPage:s.scrollByPage};this.scrollbar=this._register(new nm(e.domNode,c,this._context.viewLayout.getScrollable())),Ro.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=ut(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();let u=(p,m,g)=>{let f={};if(m){let b=p.scrollTop;b&&(f.scrollTop=this._context.viewLayout.getCurrentScrollTop()+b,p.scrollTop=0)}if(g){let b=p.scrollLeft;b&&(f.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+b,p.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(f,1)};this._register(M(i.domNode,"scroll",p=>u(i.domNode,!0,!0))),this._register(M(e.domNode,"scroll",p=>u(e.domNode,!0,!1))),this._register(M(n.domNode,"scroll",p=>u(n.domNode,!0,!1))),this._register(M(this.scrollbarDomNode.domNode,"scroll",p=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){let t=this._context.configuration.options,e=t.get(147);this.scrollbarDomNode.setLeft(e.contentLeft),t.get(74).side==="right"?this.scrollbarDomNode.setWidth(e.contentWidth+e.minimap.minimapWidth):this.scrollbarDomNode.setWidth(e.contentWidth),this.scrollbarDomNode.setHeight(e.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(t){this.scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this.scrollbar.delegateScrollFromMouseWheelEvent(t)}onConfigurationChanged(t){if(t.hasChanged(105)||t.hasChanged(76)||t.hasChanged(41)){let e=this._context.configuration.options,i=e.get(105),n=e.get(76),o=e.get(41),s=e.get(108),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:o,scrollPredominantAxis:s};this.scrollbar.updateOptions(a)}return t.hasChanged(147)&&this._setLayout(),!0}onScrollChanged(t){return!0}onThemeChanged(t){return this.scrollbar.updateClassName("editor-scrollable "+Ow(this._context.theme.type)),!0}prepareRender(t){}render(t){this.scrollbar.renderNow()}};var yb=class{constructor(t,e,i,n,o){this.startLineNumber=t;this.endLineNumber=e;this.className=i;this.tooltip=n;this.zIndex=o??0}_decorationToRenderBrand=void 0;zIndex},_K=class{constructor(t,e,i){this.className=t;this.zIndex=e;this.tooltip=i}},DK=class{decorations=[];add(t){this.decorations.push(t)}getDecorations(){return this.decorations}},wC=class extends gs{_render(t,e,i){let n=[];for(let a=t;a<=e;a++){let l=a-t;n[l]=new DK}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let o=null,s=0;for(let a=0,l=i.length;a<l;a++){let d=i[a],c=d.className,u=d.zIndex,p=Math.max(d.startLineNumber,t)-t,m=Math.min(d.endLineNumber,e)-t;o===c?(p=Math.max(s+1,p),s=Math.max(s,m)):(o=c,s=m);for(let g=p;g<=s;g++)n[g].add(new _K(c,u,d.tooltip))}return n}},qO=class extends ji{domNode;_lineHeight;_glyphMargin;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginDecorationLaneCount;_managedDomNodes;_decorationGlyphsToRender;_widgets={};constructor(t){super(t),this._context=t;let e=this._context.configuration.options,i=e.get(147);this.domNode=ut(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=e.get(68),this._glyphMargin=e.get(58),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._lineHeight=e.get(68),this._glyphMargin=e.get(58),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}addWidget(t){let e=ut(t.getDomNode());this._widgets[t.getId()]={widget:t,preference:t.getPosition(),domNode:e,renderInfo:null},e.setPosition("absolute"),e.setDisplay("none"),e.setAttribute("widgetId",t.getId()),this.domNode.appendChild(e),this.setShouldRender()}setWidgetPosition(t,e){let i=this._widgets[t.getId()];return i.preference.lane===e.lane&&i.preference.zIndex===e.zIndex&&F.equalsRange(i.preference.range,e.range)?!1:(i.preference=e,this.setShouldRender(),!0)}removeWidget(t){let e=t.getId();if(this._widgets[e]){let n=this._widgets[e].domNode.domNode;delete this._widgets[e],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(t,e){let i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber,o=t.getDecorationsInViewport();for(let s of o){let a=s.options.glyphMarginClassName;if(!a)continue;let l=Math.max(s.range.startLineNumber,i),d=Math.min(s.range.endLineNumber,n),c=s.options.glyphMargin?.position??2,u=s.options.zIndex??0;for(let p=l;p<=d;p++){let m=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new U(p,0)),g=this._context.viewModel.glyphLanes.getLanesAtLine(m.lineNumber).indexOf(c);e.push(new LK(p,g,u,a))}}}_collectWidgetBasedGlyphRenderRequest(t,e){let i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber;for(let o of Object.values(this._widgets)){let s=o.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(F.lift(s));if(!a||!l||l<i||a>n)continue;let d=Math.max(a,i),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new U(d,0)),u=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(o.preference.lane);e.push(new kK(d,u,o.preference.zIndex,o))}}_collectSortedGlyphRenderRequests(t){let e=[];return this._collectDecorationBasedGlyphRenderRequest(t,e),this._collectWidgetBasedGlyphRenderRequest(t,e),e.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),e}prepareRender(t){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(let n of Object.values(this._widgets))n.renderInfo=null;let e=new Sr(this._collectSortedGlyphRenderRequests(t)),i=[];for(;e.length>0;){let n=e.peek();if(!n)break;let o=e.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!o||o.length===0)break;let s=o[0];if(s.type===0){let a=[];for(let l of o){if(l.zIndex!==s.zIndex||l.type!==s.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(s.accept(a.join(" ")))}else s.widget.renderInfo={lineNumber:s.lineNumber,laneIndex:s.laneIndex}}this._decorationGlyphsToRender=i}render(t){if(!this._glyphMargin){for(let i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}let e=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(let i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{let n=t.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-t.viewportData.startLineNumber],o=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(o),i.domNode.setWidth(e),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){let n=this._decorationGlyphsToRender[i],o=t.viewportData.relativeVerticalOffset[n.lineNumber-t.viewportData.startLineNumber],s=this._glyphMarginLeft+n.laneIndex*this._lineHeight,a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=ut(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+n.combinedClassName),a.setPosition("absolute"),a.setTop(o),a.setLeft(s),a.setWidth(e),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}};var LK=class{constructor(t,e,i,n){this.lineNumber=t;this.laneIndex=e;this.zIndex=i;this.className=n}type=0;accept(t){return new RK(this.lineNumber,this.laneIndex,t)}},kK=class{constructor(t,e,i,n){this.lineNumber=t;this.laneIndex=e;this.zIndex=i;this.widget=n}type=1},RK=class{constructor(t,e,i){this.lineNumber=t;this.laneIndex=e;this.combinedClassName=i}};var jO=class extends gs{_context;_primaryPosition;_spaceWidth;_renderResult;_maxIndentLeft;_bracketPairGuideOptions;constructor(t){super(),this._context=t,this._primaryPosition=null;let e=this._context.configuration.options,i=e.get(148),n=e.get(51);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=e.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(148),n=e.get(51);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=e.get(16),!0}onCursorStateChanged(t){let i=t.selections[0].getPosition();return this._primaryPosition?.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}onLanguageConfigurationChanged(t){return!0}prepareRender(t){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=t.scrollWidth,o=this._primaryPosition,s=this.getGuidesByLine(e,Math.min(i+1,this._context.viewModel.getLineCount()),o),a=[];for(let l=e;l<=i;l++){let d=l-e,c=s[d],u="",p=t.visibleRangeForPosition(new U(l,1))?.left??0;for(let m of c){let g=m.column===-1?p+(m.visibleColumn-1)*this._spaceWidth:t.visibleRangeForPosition(new U(l,m.column)).left;if(g>n||this._maxIndentLeft>0&&g>this._maxIndentLeft)break;let f=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=m.horizontalLine?(t.visibleRangeForPosition(new U(l,m.horizontalLine.endColumn))?.left??g+this._spaceWidth)-g:this._spaceWidth;u+=`<div class="core-guide ${m.className} ${f}" style="left:${g}px;width:${b}px"></div>`}a[d]=u}this._renderResult=a}getGuidesByLine(t,e,i){let n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(t,e,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?2:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?1:0,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(t,e):null,s=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){let u=this._context.viewModel.getActiveIndentGuide(i.lineNumber,t,e);s=u.startLineNumber,a=u.endLineNumber,l=u.indent}let{indentSize:d}=this._context.viewModel.model.getOptions(),c=[];for(let u=t;u<=e;u++){let p=new Array;c.push(p);let m=n?n[u-t]:[],g=new Sr(m),f=o?o[u-t]:0;for(let b=1;b<=f;b++){let y=(b-1)*d+1,I=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||m.length===0)&&s<=u&&u<=a&&b===l;p.push(...g.takeWhile(S=>S.visibleColumn<y)||[]);let E=g.peek();(!E||E.visibleColumn!==y||E.horizontalLine)&&p.push(new Sl(y,-1,`core-guide-indent lvl-${(b-1)%30}`+(I?" indent-active":""),null,-1,-1))}p.push(...g.takeWhile(b=>!0)||[])}return c}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};function EC(r){if(!(r&&r.isTransparent()))return r}co((r,t)=>{let e=[{bracketColor:hR,guideColor:wY,guideColorActive:LY},{bracketColor:mR,guideColor:EY,guideColorActive:kY},{bracketColor:gR,guideColor:TY,guideColorActive:RY},{bracketColor:fR,guideColor:xY,guideColorActive:AY},{bracketColor:bR,guideColor:_Y,guideColorActive:PY},{bracketColor:vR,guideColor:DY,guideColorActive:MY}],i=new CE,n=[{indentColor:sY,indentColorActive:pY},{indentColor:aY,indentColorActive:hY},{indentColor:lY,indentColorActive:mY},{indentColor:dY,indentColorActive:gY},{indentColor:cY,indentColorActive:fY},{indentColor:uY,indentColorActive:bY}],o=e.map(a=>{let l=r.getColor(a.bracketColor),d=r.getColor(a.guideColor),c=r.getColor(a.guideColorActive),u=EC(EC(d)??l?.transparent(.3)),p=EC(EC(c)??l);if(!(!u||!p))return{guideColor:u,guideColorActive:p}}).filter(zu),s=n.map(a=>{let l=r.getColor(a.indentColor),d=r.getColor(a.indentColorActive),c=EC(l),u=EC(d);if(!(!c||!u))return{indentColor:c,indentColorActive:u}}).filter(zu);if(o.length>0){for(let a=0;a<30;a++){let l=o[a%o.length];t.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}t.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),t.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),t.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),t.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),t.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),t.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(s.length>0){for(let a=0;a<30;a++){let l=s[a%s.length];t.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}t.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),t.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});var TC=class r extends gs{static CLASS_NAME="line-numbers";_context;_lineHeight;_renderLineNumbers;_renderCustomLineNumbers;_renderFinalNewline;_lineNumbersLeft;_lineNumbersWidth;_lastCursorModelPosition;_renderResult;_activeLineNumber;constructor(t){super(),this._context=t,this._readConfig(),this._lastCursorModelPosition=new U(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){let t=this._context.configuration.options;this._lineHeight=t.get(68);let e=t.get(69);this._renderLineNumbers=e.renderType,this._renderCustomLineNumbers=e.renderFn,this._renderFinalNewline=t.get(97);let i=t.get(147);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){return this._readConfig(),!0}onCursorStateChanged(t){let e=t.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e);let i=!1;return this._activeLineNumber!==e.lineNumber&&(this._activeLineNumber=e.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}onDecorationsChanged(t){return t.affectsLineNumber}_getLineRenderLineNumber(t){let e=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new U(t,1));if(e.column!==1)return"";let i=e.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){let n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);let n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(t){if(this._renderLineNumbers===0){this._renderResult=null;return}let e=_t?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber,o=this._context.viewModel.getDecorationsInViewport(t.visibleRange).filter(d=>!!d.options.lineNumberClassName);o.sort((d,c)=>F.compareRangesUsingEnds(d.range,c.range));let s=0,a=this._context.viewModel.getLineCount(),l=[];for(let d=i;d<=n;d++){let c=d-i,u=this._getLineRenderLineNumber(d),p="";for(;s<o.length&&o[s].range.endLineNumber<d;)s++;for(let m=s;m<o.length;m++){let{range:g,options:f}=o[m];g.startLineNumber<=d&&(p+=" "+f.lineNumberClassName)}if(!u&&!p){l[c]="";continue}d===a&&this._context.viewModel.getLineLength(d)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(p+=" dimmed-line-number")),d===this._activeLineNumber&&(p+=" active-line-number"),l[c]=`<div class="${r.CLASS_NAME}${e}${p}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};co((r,t)=>{let e=r.getColor(rY),i=r.getColor(vY);i?t.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):e&&t.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${e.transparent(.4)}; }`)});var AK=class{_currentVisibleRange;constructor(){this._currentVisibleRange=new F(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(t){this._currentVisibleRange=t}},PK=class{constructor(t,e,i,n,o,s,a){this.minimalReveal=t;this.lineNumber=e;this.startColumn=i;this.endColumn=n;this.startScrollTop=o;this.stopScrollTop=s;this.scrollType=a;this.minLineNumber=e,this.maxLineNumber=e}type="range";minLineNumber;maxLineNumber},MK=class{constructor(t,e,i,n,o){this.minimalReveal=t;this.selections=e;this.startScrollTop=i;this.stopScrollTop=n;this.scrollType=o;let s=e[0].startLineNumber,a=e[0].endLineNumber;for(let l=1,d=e.length;l<d;l++){let c=e[l];s=Math.min(s,c.startLineNumber),a=Math.max(a,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=a}type="selections";minLineNumber;maxLineNumber},$O=class r extends ji{static HORIZONTAL_EXTRA_PX=30;_linesContent;_textRangeRestingSpot;_visibleLines;domNode;_lineHeight;_typicalHalfwidthCharacterWidth;_isViewportWrapping;_revealHorizontalRightPadding;_cursorSurroundingLines;_cursorSurroundingLinesStyle;_canUseLayerHinting;_viewLineOptions;_maxLineWidth;_asyncUpdateLineWidths;_asyncCheckMonospaceFontAssumptions;_horizontalRevealRequest;_lastRenderedData;_stickyScrollEnabled;_maxNumberStickyLines;constructor(t,e){super(t);let i=this._context.configuration,n=this._context.configuration.options,o=n.get(51),s=n.get(148);this._lineHeight=n.get(68),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=n.get(102),this._cursorSurroundingLines=n.get(29),this._cursorSurroundingLinesStyle=n.get(30),this._canUseLayerHinting=!n.get(32),this._viewLineOptions=new Ex(i,this._context.theme.type),this._linesContent=e,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new oC({createLine:()=>new Qd(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Ro.write(this.domNode,8),this.domNode.setClassName(`view-lines ${Zp}`),rn(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Et(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Et(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new AK,this._horizontalRevealRequest=null,this._stickyScrollEnabled=n.get(117).enabled,this._maxNumberStickyLines=n.get(117).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(t){this._visibleLines.onConfigurationChanged(t),t.hasChanged(148)&&(this._maxLineWidth=0);let e=this._context.configuration.options,i=e.get(51),n=e.get(148);return this._lineHeight=e.get(68),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=e.get(102),this._cursorSurroundingLines=e.get(29),this._cursorSurroundingLinesStyle=e.get(30),this._canUseLayerHinting=!e.get(32),this._stickyScrollEnabled=e.get(117).enabled,this._maxNumberStickyLines=e.get(117).maxLineCount,rn(this.domNode,i),this._onOptionsMaybeChanged(),t.hasChanged(147)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){let t=this._context.configuration,e=new Ex(t,this._context.theme.type);if(!this._viewLineOptions.equals(e)){this._viewLineOptions=e;let i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber(),n=!1;for(let o=e;o<=i;o++)n=this._visibleLines.getVisibleLine(o).onSelectionChanged()||n;return n}onDecorationsChanged(t){{let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=e;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(t){let e=this._visibleLines.onFlushed(t);return this._maxLineWidth=0,e}onLinesChanged(t){return this._visibleLines.onLinesChanged(t)}onLinesDeleted(t){return this._visibleLines.onLinesDeleted(t)}onLinesInserted(t){return this._visibleLines.onLinesInserted(t)}onRevealRangeRequest(t){let e=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),t.source,t.minimalReveal,t.range,t.selections,t.verticalType);if(e===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:e});t.revealHorizontal?t.range&&t.range.startLineNumber!==t.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:t.range?this._horizontalRevealRequest=new PK(t.minimalReveal,t.range.startLineNumber,t.range.startColumn,t.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,t.scrollType):t.selections&&t.selections.length>0&&(this._horizontalRevealRequest=new MK(t.minimalReveal,t.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,t.scrollType)):this._horizontalRevealRequest=null;let o=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:t.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,o),!0}onScrollChanged(t){if(this._horizontalRevealRequest&&t.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&t.scrollTopChanged){let e=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(t.scrollTop<e||t.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(t.scrollWidth),this._visibleLines.onScrollChanged(t)||!0}onTokensChanged(t){return this._visibleLines.onTokensChanged(t)}onZonesChanged(t){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(t)}onThemeChanged(t){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(t,e){let i=this._getViewLineDomNode(t);if(i===null)return null;let n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new U(n,1);let o=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();if(n<o||n>s)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(t,e),l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new U(n,a)}_getViewLineDomNode(t){for(;t&&t.nodeType===1;){if(t.className===Qd.CLASS_NAME)return t;t=t.parentElement}return null}_getLineNumberFor(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=e;n<=i;n++){let o=this._visibleLines.getVisibleLine(n);if(t===o.getDomNode())return n}return-1}getLineWidth(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(t<e||t>i)return-1;let n=new rC(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(t).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}linesVisibleRangesForRange(t,e){if(this.shouldRender())return null;let i=t.endLineNumber,n=F.intersectRanges(t,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;let o=[],s=0,a=new rC(this.domNode.domNode,this._textRangeRestingSpot),l=0;e&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new U(n.startLineNumber,1)).lineNumber);let d=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=n.startLineNumber;u<=n.endLineNumber;u++){if(u<d||u>c)continue;let p=u===n.startLineNumber?n.startColumn:1,m=u!==n.endLineNumber,g=m?this._context.viewModel.getLineMaxColumn(u):n.endColumn,f=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,p,g,a);if(f){if(e&&u<i){let b=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new U(u+1,1)).lineNumber,b!==l&&(f.ranges[f.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}o[s++]=new Q0(f.outsideRenderedLine,u,nC.from(f.ranges),m)}}return this._updateLineWidthsSlowIfDomDidLayout(a),s===0?null:o}_visibleRangesForLineRange(t,e,i){if(this.shouldRender()||t<this._visibleLines.getStartLineNumber()||t>this._visibleLines.getEndLineNumber())return null;let n=new rC(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(t).getVisibleRangesForRange(t,e,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}visibleRangeForPosition(t){let e=this._visibleRangesForLineRange(t.lineNumber,t.column,t.column);return e?new J0(e.outsideRenderedLine,e.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(t){t.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(t){let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber(),n=1,o=!0;for(let s=e;s<=i;s++){let a=this._visibleLines.getVisibleLine(s);if(t&&!a.getWidthIsFast()){o=!1;continue}n=Math.max(n,a.getWidth(null))}return o&&e===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),o}_checkMonospaceFontAssumptions(){let t=-1,e=-1,i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++){let s=this._visibleLines.getVisibleLine(o);if(s.needsMonospaceFontCheck()){let a=s.getWidth(null);a>e&&(e=a,t=o)}}if(t!==-1&&!this._visibleLines.getVisibleLine(t).monospaceAssumptionsAreValid())for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(t){if(this._visibleLines.renderLines(t),this._lastRenderedData.setCurrentVisibleRange(t.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){let i=this._horizontalRevealRequest;if(t.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=t.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();let n=this._computeScrollLeftToReveal(i);n&&(this._isViewportWrapping||this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),_t&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){let i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)if(this._visibleLines.getVisibleLine(o).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");let e=this._context.viewLayout.getCurrentScrollTop()-t.bigNumbersDelta;this._linesContent.setTop(-e),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(t){let e=Math.ceil(t);this._maxLineWidth<e&&(this._maxLineWidth=e,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(t,e,i,n,o,s){let a=t.top,l=t.height,d=a+l,c,u,p;if(o&&o.length>0){let y=o[0].startLineNumber,I=o[0].endLineNumber;for(let E=1,S=o.length;E<S;E++){let w=o[E];y=Math.min(y,w.startLineNumber),I=Math.max(I,w.endLineNumber)}c=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(y),p=this._context.viewLayout.getVerticalOffsetForLineNumber(I)+this._lineHeight}else if(n)c=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),p=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;let m=(e==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default",g=0,f=0;if(m)i||(g=this._lineHeight);else{let y=l/this._lineHeight,I=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),E=Math.min(y/2,I);g=E*this._lineHeight,f=Math.max(0,E-1)*this._lineHeight}i||(s===0||s===4)&&(f+=this._lineHeight),u-=g,p+=f;let b;if(p-u>l){if(!c)return-1;b=u}else if(s===5||s===6)if(s===6&&a<=u&&p<=d)b=a;else{let y=Math.max(5*this._lineHeight,l*.2),I=u-y,E=p-l;b=Math.max(E,I)}else if(s===1||s===2)if(s===2&&a<=u&&p<=d)b=a;else{let y=(u+p)/2;b=Math.max(0,y-l/2)}else b=this._computeMinimumScrolling(a,d,u,p,s===3,s===4);return b}_computeScrollLeftToReveal(t){let e=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(147),n=e.left,o=n+e.width-i.verticalScrollbarWidth,s=1073741824,a=0;if(t.type==="range"){let d=this._visibleRangesForLineRange(t.lineNumber,t.startColumn,t.endColumn);if(!d)return null;for(let c of d.ranges)s=Math.min(s,Math.round(c.left)),a=Math.max(a,Math.round(c.left+c.width))}else for(let d of t.selections){if(d.startLineNumber!==d.endLineNumber)return null;let c=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(!c)return null;for(let u of c.ranges)s=Math.min(s,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return t.minimalReveal||(s=Math.max(0,s-r.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),t.type==="selections"&&a-s>e.width?null:{scrollLeft:this._computeMinimumScrolling(n,o,s,a),maxHorizontalOffset:a}}_computeMinimumScrolling(t,e,i,n,o,s){t=t|0,e=e|0,i=i|0,n=n|0,o=!!o,s=!!s;let a=e-t;if(n-i<a){if(o)return i;if(s)return Math.max(0,n-a);if(i<t)return i;if(n>e)return Math.max(0,n-a)}else return i;return t}};var YO=class extends wC{_context;_decorationsLeft;_decorationsWidth;_renderResult;constructor(t){super(),this._context=t;let i=this._context.configuration.options.get(147);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let i=this._context.configuration.options.get(147);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_getDecorations(t){let e=t.getDecorationsInViewport(),i=[],n=0;for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.options.linesDecorationsClassName,d=a.options.zIndex;l&&(i[n++]=new yb(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,d));let c=a.options.firstLineDecorationClassName;c&&(i[n++]=new yb(a.range.startLineNumber,a.range.startLineNumber,c,a.options.linesDecorationsTooltip??null,d))}return i}prepareRender(t){let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=this._render(e,i,this._getDecorations(t)),o=this._decorationsLeft.toString(),s=this._decorationsWidth.toString(),a='" style="left:'+o+"px;width:"+s+'px;"></div>',l=[];for(let d=e;d<=i;d++){let c=d-e,u=n[c].getDecorations(),p="";for(let m of u){let g='<div class="cldr '+m.className;m.tooltip!==null&&(g+='" title="'+m.tooltip),g+=a,p+=g}l[c]=p}this._renderResult=l}render(t,e){return this._renderResult?this._renderResult[e-t]:""}};var xC=class r extends ji{static CLASS_NAME="glyph-margin";static OUTER_CLASS_NAME="margin";_domNode;_canUseLayerHinting;_contentLeft;_glyphMarginLeft;_glyphMarginWidth;_glyphMarginBackgroundDomNode;constructor(t){super(t);let e=this._context.configuration.options,i=e.get(147);this._canUseLayerHinting=!e.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=ut(document.createElement("div")),this._domNode.setClassName(r.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=ut(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(r.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._canUseLayerHinting=!e.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollTopChanged}prepareRender(t){}render(t){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");let e=t.scrollTop-t.bigNumbersDelta;this._domNode.setTop(-e);let i=Math.min(t.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};var ZO=class extends wC{_context;_renderResult;constructor(t){super(),this._context=t,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){return!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_getDecorations(t){let e=t.getDecorationsInViewport(),i=[],n=0;for(let o=0,s=e.length;o<s;o++){let a=e[o],l=a.options.marginClassName,d=a.options.zIndex;l&&(i[n++]=new yb(a.range.startLineNumber,a.range.endLineNumber,l,null,d))}return i}prepareRender(t){let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber,n=this._render(e,i,this._getDecorations(t)),o=[];for(let s=e;s<=i;s++){let a=s-e,l=n[a].getDecorations(),d="";for(let c of l)d+='<div class="cmdr '+c.className+'" style=""></div>';o[a]=d}this._renderResult=o}render(t,e){return this._renderResult?this._renderResult[e-t]:""}};var ec=class r{_rgba8Brand=void 0;static Empty=new r(0,0,0,0);r;g;b;a;constructor(t,e,i,n){this.r=r._clamp(t),this.g=r._clamp(e),this.b=r._clamp(i),this.a=r._clamp(n)}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}static _clamp(t){return t<0?0:t>255?255:t|0}};var yee=(()=>{let r=[];for(let t=32;t<=126;t++)r.push(t);return r.push(65533),r})(),Iee=(r,t)=>(r-=32,r<0||r>96?t<=2?(r+96)%96:95:r);var Mx=class r{constructor(t,e){this.scale=e;this.charDataNormal=r.soften(t,12/15),this.charDataLight=r.soften(t,50/60)}_minimapCharRendererBrand=void 0;charDataNormal;charDataLight;static soften(t,e){let i=new Uint8ClampedArray(t.length);for(let n=0,o=t.length;n<o;n++)i[n]=Ig(t[n]*e);return i}renderChar(t,e,i,n,o,s,a,l,d,c,u){let p=1*this.scale,m=2*this.scale,g=u?1:m;if(e+p>t.width||i+g>t.height){console.warn("bad render request outside image data");return}let f=c?this.charDataLight:this.charDataNormal,b=Iee(n,d),y=t.width*4,I=a.r,E=a.g,S=a.b,w=o.r-I,D=o.g-E,k=o.b-S,R=Math.max(s,l),A=t.data,H=b*p*m,z=i*y+e*4;for(let Z=0;Z<g;Z++){let fe=z;for(let Ve=0;Ve<p;Ve++){let me=f[H++]/255*(s/255);A[fe++]=I+w*me,A[fe++]=E+D*me,A[fe++]=S+k*me,A[fe++]=R}z+=y}}blockRenderChar(t,e,i,n,o,s,a,l){let d=1*this.scale,c=2*this.scale,u=l?1:c;if(e+d>t.width||i+u>t.height){console.warn("bad render request outside image data");return}let p=t.width*4,m=.5*(o/255),g=s.r,f=s.g,b=s.b,y=n.r-g,I=n.g-f,E=n.b-b,S=g+y*m,w=f+I*m,D=b+E*m,k=Math.max(o,a),R=t.data,A=i*p+e*4;for(let H=0;H<u;H++){let z=A;for(let Z=0;Z<d;Z++)R[z++]=S,R[z++]=w,R[z++]=D,R[z++]=k;A+=p}}};var _C=class r extends L{static _INSTANCE=null;static getInstance(){return this._INSTANCE||(this._INSTANCE=mc(new r)),this._INSTANCE}_colors;_backgroundIsLight;_onDidChange=new T;onDidChange=this._onDidChange.event;constructor(){super(),this._updateColorMap(),this._register(ca.onDidChange(t=>{t.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){let t=ca.getColorMap();if(!t){this._colors=[ec.Empty],this._backgroundIsLight=!0;return}this._colors=[ec.Empty];for(let i=1;i<t.length;i++){let n=t[i].rgba;this._colors[i]=new ec(n.r,n.g,n.b,Math.round(n.a*255))}let e=t[2].getRelativeLuminance();this._backgroundIsLight=e>=.5,this._onDidChange.fire(void 0)}getColor(t){return(t<1||t>=this._colors.length)&&(t=2),this._colors[t]}backgroundIsLight(){return this._backgroundIsLight}};var See={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},wee=r=>{let t=new Uint8ClampedArray(r.length/2);for(let e=0;e<r.length;e+=2)t[e>>1]=See[r[e]]<<4|See[r[e+1]]&15;return t},OK={1:jl(()=>wee("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:jl(()=>wee("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};var XO=class r{static lastCreated;static lastFontFamily;static create(t,e){if(this.lastCreated&&t===this.lastCreated.scale&&e===this.lastFontFamily)return this.lastCreated;let i;return OK[t]?i=new Mx(OK[t](),t):i=r.createFromSampleData(r.createSampleData(e).data,t),this.lastFontFamily=e,this.lastCreated=i,i}static createSampleData(t){let e=document.createElement("canvas"),i=e.getContext("2d");e.style.height="16px",e.height=16,e.width=96*10,e.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${t}`,i.textBaseline="middle";let n=0;for(let o of yee)i.fillText(String.fromCharCode(o),n,16/2),n+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(t,e){let i=16*10*4*96;if(t.length!==i)throw new Error("Unexpected source in MinimapCharRenderer");let n=r._downsample(t,e);return new Mx(n,e)}static _downsampleChar(t,e,i,n,o){let s=1*o,a=2*o,l=n,d=0;for(let c=0;c<a;c++){let u=c/a*16,p=(c+1)/a*16;for(let m=0;m<s;m++){let g=m/s*10,f=(m+1)/s*10,b=0,y=0;for(let E=u;E<p;E++){let S=e+Math.floor(E)*3840,w=1-(E-Math.floor(E));for(let D=g;D<f;D++){let k=1-(D-Math.floor(D)),R=S+Math.floor(D)*4,A=k*w;y+=A,b+=t[R]*t[R+3]/255*A}}let I=b/y;d=Math.max(d,I),i[l++]=Ig(I)}}return d}static _downsample(t,e){let i=2*e*1*e,n=i*96,o=new Uint8ClampedArray(n),s=0,a=0,l=0;for(let d=0;d<96;d++)l=Math.max(l,this._downsampleChar(t,a,o,s,e)),s+=i,a+=10*4;if(l>0){let d=255/l;for(let c=0;c<n;c++)o[c]*=d}return o}};var Eee=rt?'"Segoe WPC", "Segoe UI", sans-serif':be?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';var Que=140,Jue=2,QO=class r{renderMinimap;size;minimapHeightIsEditorHeight;scrollBeyondLastLine;paddingTop;paddingBottom;showSlider;autohide;pixelRatio;typicalHalfwidthCharacterWidth;lineHeight;minimapLeft;minimapWidth;minimapHeight;canvasInnerWidth;canvasInnerHeight;canvasOuterWidth;canvasOuterHeight;isSampling;editorHeight;fontScale;minimapLineHeight;minimapCharWidth;sectionHeaderFontFamily;sectionHeaderFontSize;sectionHeaderLetterSpacing;sectionHeaderFontColor;charRenderer;defaultBackgroundColor;backgroundColor;foregroundAlpha;constructor(t,e,i){let n=t.options,o=n.get(145),s=n.get(147),a=s.minimap,l=n.get(51),d=n.get(74);this.renderMinimap=a.renderMinimap,this.size=d.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(107),this.paddingTop=n.get(85).top,this.paddingBottom=n.get(85).bottom,this.showSlider=d.showSlider,this.autohide=d.autohide,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(68),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=s.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=s.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=Eee,this.sectionHeaderFontSize=d.sectionHeaderFontSize*o,this.sectionHeaderLetterSpacing=d.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=r._getSectionHeaderColor(e,i.getColor(1)),this.charRenderer=jl(()=>XO.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=r._getMinimapBackground(e,this.defaultBackgroundColor),this.foregroundAlpha=r._getMinimapForegroundOpacity(e)}static _getMinimapBackground(t,e){let i=t.getColor(n6);return i?new ec(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):e}static _getMinimapForegroundOpacity(t){let e=t.getColor(o6);return e?ec._clamp(Math.round(255*e.rgba.a)):255}static _getSectionHeaderColor(t,e){let i=t.getColor(Cc);return i?new ec(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):e}equals(t){return this.renderMinimap===t.renderMinimap&&this.size===t.size&&this.minimapHeightIsEditorHeight===t.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===t.scrollBeyondLastLine&&this.paddingTop===t.paddingTop&&this.paddingBottom===t.paddingBottom&&this.showSlider===t.showSlider&&this.autohide===t.autohide&&this.pixelRatio===t.pixelRatio&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.lineHeight===t.lineHeight&&this.minimapLeft===t.minimapLeft&&this.minimapWidth===t.minimapWidth&&this.minimapHeight===t.minimapHeight&&this.canvasInnerWidth===t.canvasInnerWidth&&this.canvasInnerHeight===t.canvasInnerHeight&&this.canvasOuterWidth===t.canvasOuterWidth&&this.canvasOuterHeight===t.canvasOuterHeight&&this.isSampling===t.isSampling&&this.editorHeight===t.editorHeight&&this.fontScale===t.fontScale&&this.minimapLineHeight===t.minimapLineHeight&&this.minimapCharWidth===t.minimapCharWidth&&this.sectionHeaderFontSize===t.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===t.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(t.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(t.backgroundColor)&&this.foregroundAlpha===t.foregroundAlpha}},NK=class r{constructor(t,e,i,n,o,s,a,l,d){this.scrollTop=t;this.scrollHeight=e;this.sliderNeeded=i;this._computedSliderRatio=n;this.sliderTop=o;this.sliderHeight=s;this.topPaddingLineCount=a;this.startLineNumber=l;this.endLineNumber=d}getDesiredScrollTopFromDelta(t){return Math.round(this.scrollTop+t/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(t){return Math.round((t-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(t){let e=Math.max(this.startLineNumber,t.startLineNumber),i=Math.min(this.endLineNumber,t.endLineNumber);return e>i?null:[e,i]}getYForLineNumber(t,e){return+(t-this.startLineNumber+this.topPaddingLineCount)*e}static create(t,e,i,n,o,s,a,l,d,c,u){let p=t.pixelRatio,m=t.minimapLineHeight,g=Math.floor(t.canvasInnerHeight/m),f=t.lineHeight;if(t.minimapHeightIsEditorHeight){let D=l*t.lineHeight+t.paddingTop+t.paddingBottom;t.scrollBeyondLastLine&&(D+=Math.max(0,o-t.lineHeight-t.paddingBottom));let k=Math.max(1,Math.floor(o*o/D)),R=Math.max(0,t.minimapHeight-k),A=R/(c-o),H=d*A,z=R>0,Z=Math.floor(t.canvasInnerHeight/t.minimapLineHeight),fe=Math.floor(t.paddingTop/t.lineHeight);return new r(d,c,z,A,H,k,fe,1,Math.min(a,Z))}let b;if(s&&i!==a){let D=i-e+1;b=Math.floor(D*m/p)}else{let D=o/f;b=Math.floor(D*m/p)}let y=Math.floor(t.paddingTop/f),I=Math.floor(t.paddingBottom/f);if(t.scrollBeyondLastLine){let D=o/f;I=Math.max(I,D-1)}let E;if(I>0){let D=o/f;E=(y+a+I-D-1)*m/p}else E=Math.max(0,(y+a)*m/p-b);E=Math.min(t.minimapHeight-b,E);let S=E/(c-o),w=d*S;if(g>=y+a+I){let D=E>0;return new r(d,c,D,S,w,b,y,1,a)}else{let D;e>1?D=e+y:D=Math.max(1,d/f);let k,R=Math.max(1,Math.floor(D-w*p/m));R<y?(k=y-R+1,R=1):(k=0,R=Math.max(1,R-y)),u&&u.scrollHeight===c&&(u.scrollTop>d&&(R=Math.min(R,u.startLineNumber),k=Math.max(k,u.topPaddingLineCount)),u.scrollTop<d&&(R=Math.max(R,u.startLineNumber),k=Math.min(k,u.topPaddingLineCount)));let A=Math.min(a,R-k+g-1),H=(d-n)/f,z;return d>=t.paddingTop?z=(e-R+k+H)*m/p:z=d/t.paddingTop*(k+H)*m/p,new r(d,c,!0,S,z,b,k,R,A)}}},JO=class r{static INVALID=new r(-1);dy;constructor(t){this.dy=t}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}},e1=class{renderedLayout;_imageData;_renderedLines;constructor(t,e,i){this.renderedLayout=t,this._imageData=e,this._renderedLines=new yx({createLine:()=>JO.INVALID}),this._renderedLines._set(t.startLineNumber,i)}linesEquals(t){if(!this.scrollEquals(t))return!1;let i=this._renderedLines._get().lines;for(let n=0,o=i.length;n<o;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(t){return this.renderedLayout.startLineNumber===t.startLineNumber&&this.renderedLayout.endLineNumber===t.endLineNumber}_get(){let t=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:t.rendLineNumberStart,lines:t.lines}}onLinesChanged(t,e){return this._renderedLines.onLinesChanged(t,e)}onLinesDeleted(t,e){this._renderedLines.onLinesDeleted(t,e)}onLinesInserted(t,e){this._renderedLines.onLinesInserted(t,e)}onTokensChanged(t){return this._renderedLines.onTokensChanged(t)}},FK=class r{_backgroundFillData;_buffers;_lastUsedBuffer;constructor(t,e,i,n){this._backgroundFillData=r._createBackgroundFillData(e,i,n),this._buffers=[t.createImageData(e,i),t.createImageData(e,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;let t=this._buffers[this._lastUsedBuffer];return t.data.set(this._backgroundFillData),t}static _createBackgroundFillData(t,e,i){let n=i.r,o=i.g,s=i.b,a=i.a,l=new Uint8ClampedArray(t*e*4),d=0;for(let c=0;c<e;c++)for(let u=0;u<t;u++)l[d]=n,l[d+1]=o,l[d+2]=s,l[d+3]=a,d+=4;return l}},t1=class r{constructor(t,e){this.samplingRatio=t;this.minimapLines=e}static compute(t,e,i){if(t.renderMinimap===0||!t.isSampling)return[null,[]];let{minimapLineCount:n}=eE.computeContainedMinimapLineCount({viewLineCount:e,scrollBeyondLastLine:t.scrollBeyondLastLine,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:t.editorHeight,lineHeight:t.lineHeight,pixelRatio:t.pixelRatio}),o=e/n,s=o/2;if(!i||i.minimapLines.length===0){let b=[];if(b[0]=1,n>1){for(let y=0,I=n-1;y<I;y++)b[y]=Math.round(y*o+s);b[n-1]=e}return[new r(o,b),[]]}let a=i.minimapLines,l=a.length,d=[],c=0,u=0,p=1,m=10,g=[],f=null;for(let b=0;b<n;b++){let y=Math.max(p,Math.round(b*o)),I=Math.max(y,Math.round((b+1)*o));for(;c<l&&a[c]<y;){if(g.length<m){let S=c+1+u;f&&f.type==="deleted"&&f._oldIndex===c-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:c,deleteFromLineNumber:S,deleteToLineNumber:S},g.push(f)),u--}c++}let E;if(c<l&&a[c]<=I)E=a[c],c++;else if(b===0?E=1:b+1===n?E=e:E=Math.round(b*o+s),g.length<m){let S=c+1+u;f&&f.type==="inserted"&&f._i===b-1?f.insertToLineNumber++:(f={type:"inserted",_i:b,insertFromLineNumber:S,insertToLineNumber:S},g.push(f)),u++}d[b]=E,p=E}if(g.length<m)for(;c<l;){let b=c+1+u;f&&f.type==="deleted"&&f._oldIndex===c-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:c,deleteFromLineNumber:b,deleteToLineNumber:b},g.push(f)),u--,c++}else g=[{type:"flush"}];return[new r(o,d),g]}modelLineToMinimapLine(t){return Math.min(this.minimapLines.length,Math.max(1,Math.round(t/this.samplingRatio)))}modelLineRangeToMinimapLineRange(t,e){let i=this.modelLineToMinimapLine(t)-1;for(;i>0&&this.minimapLines[i-1]>=t;)i--;let n=this.modelLineToMinimapLine(e)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=e;)n++;if(i===n){let o=this.minimapLines[i];if(o<t||o>e)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(t,e){let i=this.modelLineToMinimapLine(t),n=this.modelLineToMinimapLine(e);return t!==e&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(t){let e=t.toLineNumber-t.fromLineNumber+1,i=this.minimapLines.length,n=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<t.fromLineNumber);o--)this.minimapLines[o]<=t.toLineNumber?(this.minimapLines[o]=Math.max(1,t.fromLineNumber-1),i=Math.min(i,o),n=Math.max(n,o)):this.minimapLines[o]-=e;return[i,n]}onLinesInserted(t){let e=t.toLineNumber-t.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<t.fromLineNumber);i--)this.minimapLines[i]+=e}},i1=class extends ji{tokensColorTracker;_selections;_minimapSelections;options;_samplingState;_shouldCheckSampling;_sectionHeaderCache=new $s(10,1.5);_actual;constructor(t){super(t),this.tokensColorTracker=_C.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new QO(this._context.configuration,this._context.theme,this.tokensColorTracker);let[e]=t1.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=e,this._shouldCheckSampling=!1,this._actual=new BK(t.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){let t=new QO(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(t)?!1:(this.options=t,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(t){return this._onOptionsMaybeChanged()}onCursorStateChanged(t){return this._selections=t.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(t){return t.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(t){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(t){if(this._samplingState){let e=this._samplingState.modelLineRangeToMinimapLineRange(t.fromLineNumber,t.fromLineNumber+t.count-1);return e?this._actual.onLinesChanged(e[0],e[1]-e[0]+1):!1}else return this._actual.onLinesChanged(t.fromLineNumber,t.count)}onLinesDeleted(t){if(this._samplingState){let[e,i]=this._samplingState.onLinesDeleted(t);return e<=i&&this._actual.onLinesChanged(e+1,i-e+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(t.fromLineNumber,t.toLineNumber)}onLinesInserted(t){return this._samplingState?(this._samplingState.onLinesInserted(t),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(t.fromLineNumber,t.toLineNumber)}onScrollChanged(t){return this._actual.onScrollChanged()}onThemeChanged(t){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(t){if(this._samplingState){let e=[];for(let i of t.ranges){let n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&e.push({fromLineNumber:n[0],toLineNumber:n[1]})}return e.length?this._actual.onTokensChanged(e):!1}else return this._actual.onTokensChanged(t.ranges)}onTokensColorsChanged(t){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(t){return this._actual.onZonesChanged()}prepareRender(t){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(t){let e=t.visibleRange.startLineNumber,i=t.visibleRange.endLineNumber;this._samplingState&&(e=this._samplingState.modelLineToMinimapLine(e),i=this._samplingState.modelLineToMinimapLine(i));let n={viewportContainsWhitespaceGaps:t.viewportData.whitespaceViewportData.length>0,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,viewportStartLineNumber:e,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:t.getVerticalOffsetForLineNumber(e),scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,viewportWidth:t.viewportWidth,viewportHeight:t.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;let t=!!this._samplingState,[e,i]=t1.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=e,t&&this._samplingState)for(let n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(t){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[t-1]):this._context.viewModel.getLineContent(t)}getLineMaxColumn(t){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[t-1]):this._context.viewModel.getLineMaxColumn(t)}getMinimapLinesRenderingData(t,e,i){if(this._samplingState){let n=[];for(let o=0,s=e-t+1;o<s;o++)i[o]?n[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[t+o-1]):n[o]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(t,e,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(let t of this._selections){let[e,i]=this._samplingState.decorationLineRangeToMinimapLineRange(t.startLineNumber,t.endLineNumber);this._minimapSelections.push(new It(e,t.startColumn,i,t.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(t,e){let i=this._getMinimapDecorationsInViewport(t,e).filter(n=>!n.options.minimap?.sectionHeaderStyle);if(this._samplingState){let n=[];for(let o of i){if(!o.options.minimap)continue;let s=o.range,a=this._samplingState.modelLineToMinimapLine(s.startLineNumber),l=this._samplingState.modelLineToMinimapLine(s.endLineNumber);n.push(new BI(new F(a,s.startColumn,l,s.endColumn),o.options))}return n}return i}getSectionHeaderDecorationsInViewport(t,e){let i=this.options.minimapLineHeight,o=this.options.sectionHeaderFontSize/i;return t=Math.floor(Math.max(1,t-o)),this._getMinimapDecorationsInViewport(t,e).filter(s=>!!s.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(t,e){let i;if(this._samplingState){let n=this._samplingState.minimapLines[t-1],o=this._samplingState.minimapLines[e-1];i=new F(n,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new F(t,1,e,this._context.viewModel.getLineMaxColumn(e));return this._context.viewModel.getMinimapDecorationsInRange(i)}getSectionHeaderText(t,e){let i=t.options.minimap?.sectionHeaderText;if(!i)return null;let n=this._sectionHeaderCache.get(i);if(n)return n;let o=e(i);return this._sectionHeaderCache.set(i,o),o}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(t){this._samplingState&&(t=this._samplingState.minimapLines[t-1]),this._context.viewModel.revealRange("mouse",!1,new F(t,1,t,1),1,0)}setScrollTop(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t},1)}},BK=class r extends L{_theme;_model;_domNode;_shadow;_canvas;_decorationsCanvas;_slider;_sliderHorizontal;_pointerDownListener;_sliderPointerMoveMonitor;_sliderPointerDownListener;_gestureDisposable;_sliderTouchStartListener;_sliderTouchMoveListener;_sliderTouchEndListener;_lastRenderData;_selectionColor;_renderDecorations=!1;_gestureInProgress=!1;_buffers;constructor(t,e){super(),this._theme=t,this._model=e,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(wV),this._domNode=ut(document.createElement("div")),Ro.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=ut(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=ut(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=ut(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=ut(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=ut(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=Wi(this._domNode.domNode,G.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){let d=To(this._slider.domNode),c=d.top+d.height/2;this._startSliderDragging(i,c,this._lastRenderData.renderedLayout)}return}let o=this._model.options.minimapLineHeight,s=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY,l=Math.floor(s/o)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new Yc,this._sliderPointerDownListener=Wi(this._slider.domNode,G.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Wt.addTarget(this._domNode.domNode),this._sliderTouchStartListener=M(this._domNode.domNode,it.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=M(this._domNode.domNode,it.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=Wi(this._domNode.domNode,it.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(t,e,i){if(!t.target||!(t.target instanceof Element))return;let n=t.pageX;this._slider.toggleClassName("active",!0);let o=(s,a)=>{let l=To(this._domNode.domNode),d=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(rt&&d>Que){this._model.setScrollTop(i.scrollTop);return}let c=s-e;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(c))};t.pageY!==e&&o(t.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,s=>o(s.pageY,s.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(t){let e=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(t.pageY-e);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){let t=["minimap"];return this._model.options.showSlider==="always"?t.push("slider-always"):t.push("slider-mouseover"),this._model.options.autohide&&t.push("autohide"),t.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new FK(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(t,e){return this._lastRenderData?this._lastRenderData.onLinesChanged(t,e):!1}onLinesDeleted(t,e){return this._lastRenderData?.onLinesDeleted(t,e),!0}onLinesInserted(t,e){return this._lastRenderData?.onLinesInserted(t,e),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(wV),this._renderDecorations=!0,!0}onTokensChanged(t){return this._lastRenderData?this._lastRenderData.onTokensChanged(t):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(t){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}t.scrollLeft+t.viewportWidth>=t.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");let i=NK.create(this._model.options,t.viewportStartLineNumber,t.viewportEndLineNumber,t.viewportStartLineNumberVerticalOffset,t.viewportHeight,t.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),t.scrollTop,t.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(t){if(this._renderDecorations){this._renderDecorations=!1;let e=this._model.getSelections();e.sort(F.compareRangesUsingStarts);let i=this._model.getMinimapDecorationsInViewport(t.startLineNumber,t.endLineNumber);i.sort((p,m)=>(p.options.zIndex||0)-(m.options.zIndex||0));let{canvasInnerWidth:n,canvasInnerHeight:o}=this._model.options,s=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,d=this._decorationsCanvas.domNode.getContext("2d");d.clearRect(0,0,n,o);let c=new n1(t.startLineNumber,t.endLineNumber,!1);this._renderSelectionLineHighlights(d,e,c,t,s),this._renderDecorationsLineHighlights(d,i,c,t,s);let u=new n1(t.startLineNumber,t.endLineNumber,null);this._renderSelectionsHighlights(d,e,u,t,s,l,a,n),this._renderDecorationsHighlights(d,i,u,t,s,l,a,n),this._renderSectionHeaders(t)}}_renderSelectionLineHighlights(t,e,i,n,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;t.fillStyle=this._selectionColor.transparent(.5).toString();let s=0,a=0;for(let l of e){let d=n.intersectWithViewport(l);if(!d)continue;let[c,u]=d;for(let g=c;g<=u;g++)i.set(g,!0);let p=n.getYForLineNumber(c,o),m=n.getYForLineNumber(u,o);a>=p||(a>s&&t.fillRect(yd,s,t.canvas.width,a-s),s=p),a=m}a>s&&t.fillRect(yd,s,t.canvas.width,a-s)}_renderDecorationsLineHighlights(t,e,i,n,o){let s=new Map;for(let a=e.length-1;a>=0;a--){let l=e[a],d=l.options.minimap;if(!d||d.position!==1)continue;let c=n.intersectWithViewport(l.range);if(!c)continue;let[u,p]=c,m=d.getColor(this._theme.value);if(!m||m.isTransparent())continue;let g=s.get(m.toString());g||(g=m.transparent(.5).toString(),s.set(m.toString(),g)),t.fillStyle=g;for(let f=u;f<=p;f++){if(i.has(f))continue;i.set(f,!0);let b=n.getYForLineNumber(u,o);t.fillRect(yd,b,t.canvas.width,o)}}}_renderSelectionsHighlights(t,e,i,n,o,s,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(let d of e){let c=n.intersectWithViewport(d);if(!c)continue;let[u,p]=c;for(let m=u;m<=p;m++)this.renderDecorationOnLine(t,i,d,this._selectionColor,n,m,o,o,s,a,l)}}_renderDecorationsHighlights(t,e,i,n,o,s,a,l){for(let d of e){let c=d.options.minimap;if(!c)continue;let u=n.intersectWithViewport(d.range);if(!u)continue;let[p,m]=u,g=c.getColor(this._theme.value);if(!(!g||g.isTransparent()))for(let f=p;f<=m;f++)switch(c.position){case 1:this.renderDecorationOnLine(t,i,d.range,g,n,f,o,o,s,a,l);continue;case 2:{let b=n.getYForLineNumber(f,o);this.renderDecoration(t,g,2,b,Jue,o);continue}}}}renderDecorationOnLine(t,e,i,n,o,s,a,l,d,c,u){let p=o.getYForLineNumber(s,l);if(p+a<0||p>this._model.options.canvasInnerHeight)return;let{startLineNumber:m,endLineNumber:g}=i,f=m===s?i.startColumn:1,b=g===s?i.endColumn:this._model.getLineMaxColumn(s),y=this.getXOffsetForPosition(e,s,f,d,c,u),I=this.getXOffsetForPosition(e,s,b,d,c,u);this.renderDecoration(t,n,y,p,I-y,a)}getXOffsetForPosition(t,e,i,n,o,s){if(i===1)return yd;if((i-1)*o>=s)return s;let l=t.get(e);if(!l){let d=this._model.getLineContent(e);l=[yd];let c=yd;for(let u=1;u<d.length+1;u++){let p=d.charCodeAt(u-1),m=p===9?n*o:xa(p)?2*o:o,g=c+m;if(g>=s){l[u]=s;break}l[u]=g,c=g}t.set(e,l)}return i-1<l.length?l[i-1]:s}renderDecoration(t,e,i,n,o,s){t.fillStyle=e&&e.toString()||"",t.fillRect(i,n,o,s)}_renderSectionHeaders(t){let e=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,o=i*1.5,{canvasInnerWidth:s}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,d=this._model.options.sectionHeaderFontColor,c=`rgb(${d.r} ${d.g} ${d.b})`,u=c,p=this._decorationsCanvas.domNode.getContext("2d");p.letterSpacing=n+"px",p.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,p.strokeStyle=u,p.lineWidth=.2;let m=this._model.getSectionHeaderDecorationsInViewport(t.startLineNumber,t.endLineNumber);m.sort((f,b)=>f.range.startLineNumber-b.range.startLineNumber);let g=r._fitSectionHeader.bind(null,p,s-yd);for(let f of m){let b=t.getYForLineNumber(f.range.startLineNumber,e)+i,y=b-i,I=y+2,E=this._model.getSectionHeaderText(f,g);r._renderSectionLabel(p,E,f.options.minimap?.sectionHeaderStyle===2,l,c,s,y,o,b,I)}}static _fitSectionHeader(t,e,i){if(!i)return i;let n="\u2026",o=t.measureText(i).width,s=t.measureText(n).width;if(o<=e||o<=s)return i;let a=i.length,l=o/i.length,d=Math.floor((e-s)/l)-1,c=Math.ceil(d/2);for(;c>0&&/\s/.test(i[c-1]);)--c;return i.substring(0,c)+n+i.substring(a-(d-c))}static _renderSectionLabel(t,e,i,n,o,s,a,l,d,c){e&&(t.fillStyle=n,t.fillRect(0,a,s,l),t.fillStyle=o,t.fillText(e,yd,d)),i&&(t.beginPath(),t.moveTo(0,c),t.lineTo(s,c),t.closePath(),t.stroke())}renderLines(t){let e=t.startLineNumber,i=t.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(t)){let me=this._lastRenderData._get();return new e1(t,me.imageData,me.lines)}let o=this._getBuffer();if(!o)return null;let[s,a,l]=r._renderUntouchedLines(o,t.topPaddingLineCount,e,i,n,this._lastRenderData),d=this._model.getMinimapLinesRenderingData(e,i,l),c=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,p=this._model.options.backgroundColor,m=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,f=g.backgroundIsLight(),b=this._model.options.renderMinimap,y=this._model.options.charRenderer(),I=this._model.options.fontScale,E=this._model.options.minimapCharWidth,w=(b===1?2:3)*I,D=n>w?Math.floor((n-w)/2):0,k=p.a/255,R=new ec(Math.round((p.r-u.r)*k+u.r),Math.round((p.g-u.g)*k+u.g),Math.round((p.b-u.b)*k+u.b),255),A=t.topPaddingLineCount*n,H=[];for(let me=0,ce=i-e+1;me<ce;me++)l[me]&&r._renderLine(o,R,p.a,f,b,E,g,m,y,A,D,c,d[me],I,n),H[me]=new JO(A),A+=n;let z=s===-1?0:s,fe=(a===-1?o.height:a)-z;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,z,o.width,fe),new e1(t,o,H)}static _renderUntouchedLines(t,e,i,n,o,s){let a=[];if(!s){for(let A=0,H=n-i+1;A<H;A++)a[A]=!0;return[-1,-1,a]}let l=s._get(),d=l.imageData.data,c=l.rendLineNumberStart,u=l.lines,p=u.length,m=t.width,g=t.data,f=(n-i+1)*o*m*4,b=-1,y=-1,I=-1,E=-1,S=-1,w=-1,D=e*o;for(let A=i;A<=n;A++){let H=A-i,z=A-c,Z=z>=0&&z<p?u[z].dy:-1;if(Z===-1){a[H]=!0,D+=o;continue}let fe=Z*m*4,Ve=(Z+o)*m*4,me=D*m*4,ce=(D+o)*m*4;E===fe&&w===me?(E=Ve,w=ce):(I!==-1&&(g.set(d.subarray(I,E),S),b===-1&&I===0&&I===S&&(b=E),y===-1&&E===f&&I===S&&(y=I)),I=fe,E=Ve,S=me,w=ce),a[H]=!1,D+=o}I!==-1&&(g.set(d.subarray(I,E),S),b===-1&&I===0&&I===S&&(b=E),y===-1&&E===f&&I===S&&(y=I));let k=b===-1?-1:b/(m*4),R=y===-1?-1:y/(m*4);return[k,R,a]}static _renderLine(t,e,i,n,o,s,a,l,d,c,u,p,m,g,f){let b=m.content,y=m.tokens,I=t.width-s,E=f===1,S=yd,w=0,D=0;for(let k=0,R=y.getCount();k<R;k++){let A=y.getEndOffset(k),H=y.getForeground(k),z=a.getColor(H);for(;w<A;w++){if(S>I)return;let Z=b.charCodeAt(w);if(Z===9){let fe=p-(w+D)%p;D+=fe-1,S+=fe*s}else if(Z===32)S+=s;else{let fe=xa(Z)?2:1;for(let Ve=0;Ve<fe;Ve++)if(o===2?d.blockRenderChar(t,S,c+u,z,l,e,i,E):d.renderChar(t,S,c+u,Z,z,l,e,i,g,n,E),S+=s,S>I)return}}}}},n1=class{_startLineNumber;_endLineNumber;_defaultValue;_values;constructor(t,e,i){this._startLineNumber=t,this._endLineNumber=e,this._defaultValue=i,this._values=[];for(let n=0,o=this._endLineNumber-this._startLineNumber+1;n<o;n++)this._values[n]=i}has(t){return this.get(t)!==this._defaultValue}set(t,e){t<this._startLineNumber||t>this._endLineNumber||(this._values[t-this._startLineNumber]=e)}get(t){return t<this._startLineNumber||t>this._endLineNumber?this._defaultValue:this._values[t-this._startLineNumber]}};var o1=class extends ji{_viewDomNode;_widgets;_viewDomNodeRect;_domNode;overflowingOverlayWidgetsDomNode;_verticalScrollbarWidth;_minimapWidth;_horizontalScrollbarHeight;_editorHeight;_editorWidth;constructor(t,e){super(t),this._viewDomNode=e;let n=this._context.configuration.options.get(147);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=ut(document.createElement("div")),Ro.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=ut(document.createElement("div")),Ro.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(t){let i=this._context.configuration.options.get(147);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(t){let e=ut(t.getDomNode());this._widgets[t.getId()]={widget:t,preference:null,domNode:e},e.setPosition("absolute"),e.setAttribute("widgetId",t.getId()),t.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(e):this._domNode.appendChild(e),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(t,e){let i=this._widgets[t.getId()],n=e?e.preference:null,o=e?.stackOridinal;return i.preference===n&&i.stack===o?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=o,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(t){let e=t.getId();if(this._widgets.hasOwnProperty(e)){let n=this._widgets[e].domNode.domNode;delete this._widgets[e],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let t=0,e=Object.keys(this._widgets);for(let i=0,n=e.length;i<n;i++){let o=e[i],a=this._widgets[o].widget.getMinContentWidthInPx?.();typeof a<"u"&&(t=Math.max(t,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(t)}_renderWidget(t,e){let i=t.domNode;if(t.preference===null){i.setTop("");return}let n=2*this._verticalScrollbarWidth+this._minimapWidth;if(t.preference===0||t.preference===1){if(t.preference===1){let o=i.domNode.clientHeight;i.setTop(this._editorHeight-o-2*this._horizontalScrollbarHeight)}else i.setTop(0);t.stack!==void 0?(i.setTop(e[t.preference]),e[t.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(t.preference===2)i.domNode.style.right="50%",t.stack!==void 0?(i.setTop(e[2]),e[2]+=i.domNode.clientHeight):i.setTop(0);else{let{top:o,left:s}=t.preference;if(this._context.configuration.options.get(43)&&t.widget.allowEditorOverflow){let l=this._viewDomNodeRect;i.setTop(o+l.top),i.setLeft(s+l.left),i.setPosition("fixed")}else i.setTop(o),i.setLeft(s),i.setPosition("absolute")}}prepareRender(t){this._viewDomNodeRect=To(this._viewDomNode.domNode)}render(t){this._domNode.setWidth(this._editorWidth);let e=Object.keys(this._widgets),i=Array.from({length:3},()=>0);e.sort((n,o)=>(this._widgets[n].stack||0)-(this._widgets[o].stack||0));for(let n=0,o=e.length;n<o;n++){let s=e[n];this._renderWidget(this._widgets[s],i)}}};var VK=class{lineHeight;pixelRatio;overviewRulerLanes;renderBorder;borderColor;hideCursor;cursorColorSingle;cursorColorPrimary;cursorColorSecondary;themeType;backgroundColor;top;right;domWidth;domHeight;canvasWidth;canvasHeight;x;w;constructor(t,e){let i=t.options;this.lineHeight=i.get(68),this.pixelRatio=i.get(145),this.overviewRulerLanes=i.get(84),this.renderBorder=i.get(83);let n=e.getColor(yY);this.borderColor=n?n.toString():null,this.hideCursor=i.get(60);let o=e.getColor(py);this.cursorColorSingle=o?o.transparent(.7).toString():null;let s=e.getColor(cR);this.cursorColorPrimary=s?s.transparent(.7).toString():null;let a=e.getColor(uR);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=e.type;let l=i.get(74),d=l.enabled,c=l.side,u=e.getColor(IY),p=ca.getDefaultBackground();u?this.backgroundColor=u:d&&c==="right"?this.backgroundColor=p:this.backgroundColor=null;let g=i.get(147).overviewRuler;this.top=g.top,this.right=g.right,this.domWidth=g.width,this.domHeight=g.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);let[f,b]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=f,this.w=b}_initLanes(t,e,i){let n=e-t;if(i>=3){let o=Math.floor(n/3),s=Math.floor(n/3),a=n-o-s,l=t,d=l+o,c=l+o+a;return[[0,l,d,l,c,l,d,l],[0,o,a,o+a,s,o+a+s,a+s,o+a+s]]}else if(i===2){let o=Math.floor(n/2),s=n-o,a=t,l=a+o;return[[0,a,a,a,l,a,a,a],[0,o,o,o,s,o+s,o+s,o+s]]}else{let o=t,s=n;return[[0,o,o,o,o,o,o,o],[0,s,s,s,s,s,s,s]]}}equals(t){return this.lineHeight===t.lineHeight&&this.pixelRatio===t.pixelRatio&&this.overviewRulerLanes===t.overviewRulerLanes&&this.renderBorder===t.renderBorder&&this.borderColor===t.borderColor&&this.hideCursor===t.hideCursor&&this.cursorColorSingle===t.cursorColorSingle&&this.cursorColorPrimary===t.cursorColorPrimary&&this.cursorColorSecondary===t.cursorColorSecondary&&this.themeType===t.themeType&&Y.equals(this.backgroundColor,t.backgroundColor)&&this.top===t.top&&this.right===t.right&&this.domWidth===t.domWidth&&this.domHeight===t.domHeight&&this.canvasWidth===t.canvasWidth&&this.canvasHeight===t.canvasHeight}};var r1=class extends ji{_actualShouldRender=0;_tokensColorTrackerListener;_domNode;_settings;_cursorPositions;_renderedDecorations=[];_renderedCursorPositions=[];constructor(t){super(t),this._domNode=ut(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=ca.onDidChange(e=>{e.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new U(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(t){let e=new VK(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(e)?!1:(this._settings=e,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,t&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(t){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(t){this._cursorPositions=[];for(let e=0,i=t.selections.length;e<i;e++){let n=this._settings.cursorColorSingle;i>1&&(n=e===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:t.selections[e].getPosition(),color:n})}return this._cursorPositions.sort((e,i)=>U.compare(e.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(t){return t.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(t){return this._markRenderingIsNeeded()}onScrollChanged(t){return t.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(t){return this._markRenderingIsNeeded()}onThemeChanged(t){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(t){}render(t){this._render(),this._actualShouldRender=0}_render(){let t=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(t?Y.Format.CSS.formatHexA(t):""),this._domNode.setDisplay("none");return}let e=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(e.sort(Yf.compareByRenderingProps),this._actualShouldRender===1&&!Yf.equalsArr(this._renderedDecorations,e)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!ti(this._renderedCursorPositions,this._cursorPositions,(g,f)=>g.position.lineNumber===f.position.lineNumber&&g.color===f.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=e,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");let i=this._settings.canvasWidth,n=this._settings.canvasHeight,o=this._settings.lineHeight,s=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,d=6*this._settings.pixelRatio|0,c=d/2|0,u=this._domNode.domNode.getContext("2d");t?t.isOpaque()?(u.fillStyle=Y.Format.CSS.formatHexA(t),u.fillRect(0,0,i,n)):(u.clearRect(0,0,i,n),u.fillStyle=Y.Format.CSS.formatHexA(t),u.fillRect(0,0,i,n)):u.clearRect(0,0,i,n);let p=this._settings.x,m=this._settings.w;for(let g of e){let f=g.color,b=g.data;u.fillStyle=f;let y=0,I=0,E=0;for(let S=0,w=b.length/3;S<w;S++){let D=b[3*S],k=b[3*S+1],R=b[3*S+2],A=s.getVerticalOffsetForLineNumber(k)*l|0,H=(s.getVerticalOffsetForLineNumber(R)+o)*l|0;if(H-A<d){let Z=(A+H)/2|0;Z<c?Z=c:Z+c>n&&(Z=n-c),A=Z-c,H=Z+c}A>E+1||D!==y?(S!==0&&u.fillRect(p[y],I,m[y],E-I),y=D,I=A,E=H):H>E&&(E=H)}u.fillRect(p[y],I,m[y],E-I)}if(!this._settings.hideCursor){let g=2*this._settings.pixelRatio|0,f=g/2|0,b=this._settings.x[7],y=this._settings.w[7],I=-100,E=-100,S=null;for(let w=0,D=this._cursorPositions.length;w<D;w++){let k=this._cursorPositions[w].color;if(!k)continue;let R=this._cursorPositions[w].position,A=s.getVerticalOffsetForLineNumber(R.lineNumber)*l|0;A<f?A=f:A+f>n&&(A=n-f);let H=A-f,z=H+g;H>E+1||k!==S?(w!==0&&S&&u.fillRect(b,I,y,E-I),I=H,E=z):z>E&&(E=z),S=k,u.fillStyle=k}S&&u.fillRect(b,I,y,E-I)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,n),u.moveTo(1,0),u.lineTo(i,0),u.stroke())}};var s1=class extends Nl{_context;_domNode;_zoneManager;constructor(t,e){super(),this._context=t;let i=this._context.configuration.options;this._domNode=ut(document.createElement("canvas")),this._domNode.setClassName(e),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new r0(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(68)),this._zoneManager.setPixelRatio(i.get(145)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return t.hasChanged(68)&&(this._zoneManager.setLineHeight(e.get(68)),this._render()),t.hasChanged(145)&&(this._zoneManager.setPixelRatio(e.get(145)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(t){return this._render(),!0}onScrollChanged(t){return t.scrollHeightChanged&&(this._zoneManager.setOuterHeight(t.scrollHeight),this._render()),!0}onZonesChanged(t){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(t){this._domNode.setTop(t.top),this._domNode.setRight(t.right);let e=!1;e=this._zoneManager.setDOMWidth(t.width)||e,e=this._zoneManager.setDOMHeight(t.height)||e,e&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(t){this._zoneManager.setZones(t),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;let t=this._zoneManager.getCanvasWidth(),e=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,t,e),i.length>0&&this._renderOneLane(o,i,n,t),!0}_renderOneLane(t,e,i,n){let o=0,s=0,a=0;for(let l of e){let d=l.colorId,c=l.from,u=l.to;d!==o?(t.fillRect(0,s,n,a-s),o=d,t.fillStyle=i[o],s=c,a=u):a>=c?a=Math.max(a,u):(t.fillRect(0,s,n,a-s),s=c,a=u)}t.fillRect(0,s,n,a-s)}};var a1=class extends ji{domNode;_renderedRulers;_rulers;_typicalHalfwidthCharacterWidth;constructor(t){super(t),this.domNode=ut(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];let e=this._context.configuration.options;this._rulers=e.get(104),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return this._rulers=e.get(104),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,!0}onScrollChanged(t){return t.scrollHeightChanged}prepareRender(t){}_ensureRulersCount(){let t=this._renderedRulers.length,e=this._rulers.length;if(t===e)return;if(t<e){let{tabSize:n}=this._context.viewModel.model.getOptions(),o=n,s=e-t;for(;s>0;){let a=ut(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(o),this.domNode.appendChild(a),this._renderedRulers.push(a),s--}return}let i=t-e;for(;i>0;){let n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(t){this._ensureRulersCount();for(let e=0,i=this._rulers.length;e<i;e++){let n=this._renderedRulers[e],o=this._rulers[e];n.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),n.setHeight(Math.min(t.scrollHeight,1e6)),n.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}};var l1=class extends ji{_domNode;_scrollTop;_width;_shouldShow;_useShadows;constructor(t){super(t),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;let i=this._context.configuration.options.get(105);this._useShadows=i.useShadows,this._domNode=ut(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let t=this._useShadows&&this._scrollTop>0;return this._shouldShow!==t?(this._shouldShow=t,!0):!1}getDomNode(){return this._domNode}_updateWidth(){let e=this._context.configuration.options.get(147);e.minimap.renderMinimap===0||e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?this._width=e.width:this._width=e.width-e.verticalScrollbarWidth}onConfigurationChanged(t){let i=this._context.configuration.options.get(105);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(t){return this._scrollTop=t.scrollTop,this._updateShouldShow()}prepareRender(t){}render(t){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}};var WK=class{left;width;startStyle;endStyle;constructor(t){this.left=t.left,this.width=t.width,this.startStyle=null,this.endStyle=null}},UK=class{lineNumber;ranges;constructor(t,e){this.lineNumber=t,this.ranges=e}};function epe(r){return new WK(r)}function tpe(r){return new UK(r.lineNumber,r.ranges.map(epe))}var c1=class r extends gs{static SELECTION_CLASS_NAME="selected-text";static SELECTION_TOP_LEFT="top-left-radius";static SELECTION_BOTTOM_LEFT="bottom-left-radius";static SELECTION_TOP_RIGHT="top-right-radius";static SELECTION_BOTTOM_RIGHT="bottom-right-radius";static EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";static ROUNDED_PIECE_WIDTH=10;_context;_roundedSelection;_typicalHalfwidthCharacterWidth;_selections;_renderResult;constructor(t){super(),this._context=t;let e=this._context.configuration.options;this._roundedSelection=e.get(103),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=this._context.configuration.options;return this._roundedSelection=e.get(103),this._typicalHalfwidthCharacterWidth=e.get(51).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_visibleRangesHaveGaps(t){for(let e=0,i=t.length;e<i;e++)if(t[e].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(t,e,i){let n=this._typicalHalfwidthCharacterWidth/4,o=null,s=null;if(i&&i.length>0&&e.length>0){let a=e[0].lineNumber;if(a===t.startLineNumber)for(let d=0;!o&&d<i.length;d++)i[d].lineNumber===a&&(o=i[d].ranges[0]);let l=e[e.length-1].lineNumber;if(l===t.endLineNumber)for(let d=i.length-1;!s&&d>=0;d--)i[d].lineNumber===l&&(s=i[d].ranges[0]);o&&!o.startStyle&&(o=null),s&&!s.startStyle&&(s=null)}for(let a=0,l=e.length;a<l;a++){let d=e[a].ranges[0],c=d.left,u=d.left+d.width,p={top:0,bottom:0},m={top:0,bottom:0};if(a>0){let g=e[a-1].ranges[0].left,f=e[a-1].ranges[0].left+e[a-1].ranges[0].width;d1(c-g)<n?p.top=2:c>g&&(p.top=1),d1(u-f)<n?m.top=2:g<u&&u<f&&(m.top=1)}else o&&(p.top=o.startStyle.top,m.top=o.endStyle.top);if(a+1<l){let g=e[a+1].ranges[0].left,f=e[a+1].ranges[0].left+e[a+1].ranges[0].width;d1(c-g)<n?p.bottom=2:g<c&&c<f&&(p.bottom=1),d1(u-f)<n?m.bottom=2:u<f&&(m.bottom=1)}else s&&(p.bottom=s.startStyle.bottom,m.bottom=s.endStyle.bottom);d.startStyle=p,d.endStyle=m}}_getVisibleRangesWithStyle(t,e,i){let o=(e.linesVisibleRangesForRange(t,!0)||[]).map(tpe);return!this._visibleRangesHaveGaps(o)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(e.visibleRange,o,i),o}_createSelectionPiece(t,e,i,n,o){return'<div class="cslr '+i+'" style="top:'+t.toString()+"px;bottom:"+e.toString()+"px;left:"+n.toString()+"px;width:"+o.toString()+'px;"></div>'}_actualRenderOneSelection(t,e,i,n){if(n.length===0)return;let o=!!n[0].ranges[0].startStyle,s=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,d=n.length;l<d;l++){let c=n[l],u=c.lineNumber,p=u-e,m=i&&u===s?1:0,g=i&&u!==s&&u===a?1:0,f="",b="";for(let y=0,I=c.ranges.length;y<I;y++){let E=c.ranges[y];if(o){let w=E.startStyle,D=E.endStyle;if(w.top===1||w.bottom===1){f+=this._createSelectionPiece(m,g,r.SELECTION_CLASS_NAME,E.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH);let k=r.EDITOR_BACKGROUND_CLASS_NAME;w.top===1&&(k+=" "+r.SELECTION_TOP_RIGHT),w.bottom===1&&(k+=" "+r.SELECTION_BOTTOM_RIGHT),f+=this._createSelectionPiece(m,g,k,E.left-r.ROUNDED_PIECE_WIDTH,r.ROUNDED_PIECE_WIDTH)}if(D.top===1||D.bottom===1){f+=this._createSelectionPiece(m,g,r.SELECTION_CLASS_NAME,E.left+E.width,r.ROUNDED_PIECE_WIDTH);let k=r.EDITOR_BACKGROUND_CLASS_NAME;D.top===1&&(k+=" "+r.SELECTION_TOP_LEFT),D.bottom===1&&(k+=" "+r.SELECTION_BOTTOM_LEFT),f+=this._createSelectionPiece(m,g,k,E.left+E.width,r.ROUNDED_PIECE_WIDTH)}}let S=r.SELECTION_CLASS_NAME;if(o){let w=E.startStyle,D=E.endStyle;w.top===0&&(S+=" "+r.SELECTION_TOP_LEFT),w.bottom===0&&(S+=" "+r.SELECTION_BOTTOM_LEFT),D.top===0&&(S+=" "+r.SELECTION_TOP_RIGHT),D.bottom===0&&(S+=" "+r.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(m,g,S,E.left,E.width)}t[p][0]+=f,t[p][1]+=b}}_previousFrameVisibleRangesWithStyle=[];prepareRender(t){let e=[],i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber;for(let s=i;s<=n;s++){let a=s-i;e[a]=["",""]}let o=[];for(let s=0,a=this._selections.length;s<a;s++){let l=this._selections[s];if(l.isEmpty()){o[s]=null;continue}let d=this._getVisibleRangesWithStyle(l,t,this._previousFrameVisibleRangesWithStyle[s]);o[s]=d,this._actualRenderOneSelection(e,i,this._selections.length>1,d)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=e.map(([s,a])=>s+a)}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};co((r,t)=>{let e=r.getColor(H3);e&&!e.isTransparent()&&t.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${e}; }`)});function d1(r){return r<0?-r:r}var u1=class r extends ji{static BLINK_INTERVAL=500;_readOnly;_cursorBlinking;_cursorStyle;_cursorSmoothCaretAnimation;_selectionIsEmpty;_isComposingInput;_isVisible;_domNode;_startCursorBlinkAnimation;_cursorFlatBlinkInterval;_blinkingEnabled;_editorHasFocus;_primaryCursor;_secondaryCursors;_renderData;constructor(t){super(t);let e=this._context.configuration.options;this._readOnly=e.get(93),this._cursorBlinking=e.get(26),this._cursorStyle=e.get(28),this._cursorSmoothCaretAnimation=e.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new Tx(this._context,0),this._secondaryCursors=[],this._renderData=[],this._domNode=ut(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new td,this._cursorFlatBlinkInterval=new Uv,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(t){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(t){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(t){let e=this._context.configuration.options;this._readOnly=e.get(93),this._cursorBlinking=e.get(26),this._cursorStyle=e.get(28),this._cursorSmoothCaretAnimation=e.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(t);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(t);return!0}_onCursorPositionChanged(t,e,i){let n=this._secondaryCursors.length!==e.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(e.length?1:0),this._primaryCursor.onCursorPositionChanged(t,n),this._updateBlinking(),this._secondaryCursors.length<e.length){let o=e.length-this._secondaryCursors.length;for(let s=0;s<o;s++){let a=new Tx(this._context,2);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>e.length){let o=this._secondaryCursors.length-e.length;for(let s=0;s<o;s++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let o=0;o<e.length;o++)this._secondaryCursors[o].onCursorPositionChanged(e[o],n)}onCursorStateChanged(t){let e=[];for(let n=0,o=t.selections.length;n<o;n++)e[n]=t.selections[n].getPosition();this._onCursorPositionChanged(e[0],e.slice(1),t.reason);let i=t.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onFocusChanged(t){return this._editorHasFocus=t.isFocused,this._updateBlinking(),!1}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return!0}onTokensChanged(t){let e=i=>{for(let n=0,o=t.ranges.length;n<o;n++)if(t.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=t.ranges[n].toLineNumber)return!0;return!1};if(e(this._primaryCursor.getPosition()))return!0;for(let i of this._secondaryCursors)if(e(i.getPosition()))return!0;return!1}onZonesChanged(t){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();let t=this._getCursorBlinking(),e=t===0,i=t===5;e?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!e&&!i&&(t===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},r.BLINK_INTERVAL,oe(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},r.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let t="cursors-layer";switch(this._selectionIsEmpty||(t+=" has-selection"),this._cursorStyle){case 1:t+=" cursor-line-style";break;case 2:t+=" cursor-block-style";break;case 3:t+=" cursor-underline-style";break;case 4:t+=" cursor-line-thin-style";break;case 5:t+=" cursor-block-outline-style";break;case 6:t+=" cursor-underline-thin-style";break;default:t+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:t+=" cursor-blink";break;case 2:t+=" cursor-smooth";break;case 3:t+=" cursor-phase";break;case 4:t+=" cursor-expand";break;case 5:t+=" cursor-solid";break;default:t+=" cursor-solid"}else t+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(t+=" cursor-smooth-caret-animation"),t}_show(){this._primaryCursor.show();for(let t=0,e=this._secondaryCursors.length;t<e;t++)this._secondaryCursors[t].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let t=0,e=this._secondaryCursors.length;t<e;t++)this._secondaryCursors[t].hide();this._isVisible=!1}prepareRender(t){this._primaryCursor.prepareRender(t);for(let e=0,i=this._secondaryCursors.length;e<i;e++)this._secondaryCursors[e].prepareRender(t)}render(t){let e=[],i=0,n=this._primaryCursor.render(t);n&&(e[i++]=n);for(let o=0,s=this._secondaryCursors.length;o<s;o++){let a=this._secondaryCursors[o].render(t);a&&(e[i++]=a)}this._renderData=e}getLastRenderData(){return this._renderData}};co((r,t)=>{let e=[{class:".cursor",foreground:py,background:dR},{class:".cursor-primary",foreground:cR,background:nY},{class:".cursor-secondary",foreground:uR,background:oY}];for(let i of e){let n=r.getColor(i.foreground);if(n){let o=r.getColor(i.background);o||(o=n.opposite()),t.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${o}; }`),Ra(r.type)&&t.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${o}; border-right: 1px solid ${o}; }`)}}});var HK=()=>{throw new Error("Invalid change accessor")},p1=class extends ji{_zones;_lineHeight;_contentWidth;_contentLeft;domNode;marginDomNode;constructor(t){super(t);let e=this._context.configuration.options,i=e.get(147);this._lineHeight=e.get(68),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=ut(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=ut(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let t=this._context.viewLayout.getWhitespaces(),e=new Map;for(let n of t)e.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],c=this._computeWhitespaceProps(d.delegate);d.isInHiddenArea=c.isInHiddenArea;let u=e.get(l);u&&(u.afterLineNumber!==c.afterViewLineNumber||u.height!==c.heightInPx)&&(n.changeOneWhitespace(l,c.afterViewLineNumber,c.heightInPx),this._safeCallOnComputedHeight(d.delegate,c.heightInPx),i=!0)}}),i}onConfigurationChanged(t){let e=this._context.configuration.options,i=e.get(147);return this._lineHeight=e.get(68),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,t.hasChanged(68)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(t){return this._recomputeWhitespacesProps()}onLinesDeleted(t){return!0}onScrollChanged(t){return t.scrollTopChanged||t.scrollWidthChanged}onZonesChanged(t){return!0}onLinesInserted(t){return!0}_getZoneOrdinal(t){return t.ordinal??t.afterColumn??1e4}_computeWhitespaceProps(t){if(t.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(t),minWidthInPx:this._minWidthInPixels(t)};let e;if(typeof t.afterColumn<"u")e=this._context.viewModel.model.validatePosition({lineNumber:t.afterLineNumber,column:t.afterColumn});else{let s=this._context.viewModel.model.validatePosition({lineNumber:t.afterLineNumber,column:1}).lineNumber;e=new U(s,this._context.viewModel.model.getLineMaxColumn(s))}let i;e.column===this._context.viewModel.model.getLineMaxColumn(e.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:e.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:e.lineNumber,column:e.column+1});let n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e,t.afterColumnAffinity,!0),o=t.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!o,afterViewLineNumber:n.lineNumber,heightInPx:o?this._heightInPixels(t):0,minWidthInPx:this._minWidthInPixels(t)}}changeViewZones(t){let e=!1;return this._context.viewModel.changeWhitespace(i=>{let n={addZone:o=>(e=!0,this._addZone(i,o)),removeZone:o=>{o&&(e=this._removeZone(i,o)||e)},layoutZone:o=>{o&&(e=this._layoutZone(i,o)||e)}};ipe(t,n),n.addZone=HK,n.removeZone=HK,n.layoutZone=HK}),e}_addZone(t,e){let i=this._computeWhitespaceProps(e),o={whitespaceId:t.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(e),i.heightInPx,i.minWidthInPx),delegate:e,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:ut(e.domNode),marginDomNode:e.marginDomNode?ut(e.marginDomNode):null};return this._safeCallOnComputedHeight(o.delegate,i.heightInPx),o.domNode.setPosition("absolute"),o.domNode.domNode.style.width="100%",o.domNode.setDisplay("none"),o.domNode.setAttribute("monaco-view-zone",o.whitespaceId),this.domNode.appendChild(o.domNode),o.marginDomNode&&(o.marginDomNode.setPosition("absolute"),o.marginDomNode.domNode.style.width="100%",o.marginDomNode.setDisplay("none"),o.marginDomNode.setAttribute("monaco-view-zone",o.whitespaceId),this.marginDomNode.appendChild(o.marginDomNode)),this._zones[o.whitespaceId]=o,this.setShouldRender(),o.whitespaceId}_removeZone(t,e){if(this._zones.hasOwnProperty(e)){let i=this._zones[e];return delete this._zones[e],t.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(t,e){if(this._zones.hasOwnProperty(e)){let i=this._zones[e],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,t.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(t){return this._zones.hasOwnProperty(t)?!!this._zones[t].delegate.suppressMouseDown:!1}_heightInPixels(t){return typeof t.heightInPx=="number"?t.heightInPx:typeof t.heightInLines=="number"?this._lineHeight*t.heightInLines:this._lineHeight}_minWidthInPixels(t){return typeof t.minWidthInPx=="number"?t.minWidthInPx:0}_safeCallOnComputedHeight(t,e){if(typeof t.onComputedHeight=="function")try{t.onComputedHeight(e)}catch(i){Ke(i)}}_safeCallOnDomNodeTop(t,e){if(typeof t.onDomNodeTop=="function")try{t.onDomNodeTop(e)}catch(i){Ke(i)}}prepareRender(t){}render(t){let e=t.viewportData.whitespaceViewportData,i={},n=!1;for(let s of e)this._zones[s.id].isInHiddenArea||(i[s.id]=s,n=!0);let o=Object.keys(this._zones);for(let s=0,a=o.length;s<a;s++){let l=o[s],d=this._zones[l],c=0,u=0,p="none";i.hasOwnProperty(l)?(c=i[l].verticalOffset-t.bigNumbersDelta,u=i[l].height,p="block",d.isVisible||(d.domNode.setAttribute("monaco-visible-view-zone","true"),d.isVisible=!0),this._safeCallOnDomNodeTop(d.delegate,t.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(d.isVisible&&(d.domNode.removeAttribute("monaco-visible-view-zone"),d.isVisible=!1),this._safeCallOnDomNodeTop(d.delegate,t.getScrolledTopFromAbsoluteTop(-1e6))),d.domNode.setTop(c),d.domNode.setHeight(u),d.domNode.setDisplay(p),d.marginDomNode&&(d.marginDomNode.setTop(c),d.marginDomNode.setHeight(u),d.marginDomNode.setDisplay(p))}n&&(this.domNode.setWidth(Math.max(t.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}};function ipe(r,t){try{return r(t)}catch(e){Ke(e)}}var h1=class extends gs{_context;_options;_selection;_renderResult;constructor(t){super(),this._context=t,this._options=new m1(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){let e=new m1(this._context.configuration);return this._options.equals(e)?t.hasChanged(147):(this._options=e,!0)}onCursorStateChanged(t){return this._selection=t.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}prepareRender(t){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}let e=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber-e+1,o=new Array(n);for(let a=0;a<n;a++)o[a]=!0;let s=this._context.viewModel.getMinimapLinesRenderingData(t.viewportData.startLineNumber,t.viewportData.endLineNumber,o);this._renderResult=[];for(let a=t.viewportData.startLineNumber;a<=t.viewportData.endLineNumber;a++){let l=a-t.viewportData.startLineNumber,d=s.data[l],c=null;if(this._options.renderWhitespace==="selection"){let u=this._selection;for(let p of u){if(p.endLineNumber<a||p.startLineNumber>a)continue;let m=p.startLineNumber===a?p.startColumn:d.minColumn,g=p.endLineNumber===a?p.endColumn:d.maxColumn;m<g&&(c||(c=[]),c.push(new sC(m-1,g-1)))}}this._renderResult[l]=this._applyRenderWhitespace(t,a,c,d)}}_applyRenderWhitespace(t,e,i,n){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";let o=this._context.theme.getColor(pR),s=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),d=n.continuesWithWrappedLine,c=n.minColumn-1,u=this._options.renderWhitespace==="boundary",p=this._options.renderWhitespace==="trailing",m=this._options.lineHeight,g=this._options.middotWidth,f=this._options.wsmiddotWidth,b=this._options.spaceWidth,y=Math.abs(f-b),I=Math.abs(g-b),E=y<I?11825:183,S=this._options.canUseHalfwidthRightwardsArrow,w="",D=!1,k=Rn(a),R;k===-1?(D=!0,k=l,R=l):R=Ta(a);let A=0,H=i&&i[A],z=0;for(let Z=c;Z<l;Z++){let fe=a.charCodeAt(Z);if(H&&Z>=H.endOffset&&(A++,H=i&&i[A]),fe!==9&&fe!==32||p&&!D&&Z<=R)continue;if(u&&Z>=k&&Z<=R&&fe===32){let me=Z-1>=0?a.charCodeAt(Z-1):0,ce=Z+1<l?a.charCodeAt(Z+1):0;if(me!==32&&ce!==32)continue}if(u&&d&&Z===l-1){let me=Z-1>=0?a.charCodeAt(Z-1):0;if(fe===32&&me!==32&&me!==9)continue}if(i&&(!H||H.startOffset>Z||H.endOffset<=Z))continue;let Ve=t.visibleRangeForPosition(new U(e,Z+1));Ve&&(s?(z=Math.max(z,Ve.left),fe===9?w+=this._renderArrow(m,b,Ve.left):w+=`<circle cx="${(Ve.left+b/2).toFixed(2)}" cy="${(m/2).toFixed(2)}" r="${(b/7).toFixed(2)}" />`):fe===9?w+=`<div class="mwh" style="left:${Ve.left}px;height:${m}px;">${S?"\uFFEB":"\u2192"}</div>`:w+=`<div class="mwh" style="left:${Ve.left}px;height:${m}px;">${String.fromCharCode(E)}</div>`)}return s?(z=Math.round(z+b),`<svg style="bottom:0;position:absolute;width:${z}px;height:${m}px" viewBox="0 0 ${z} ${m}" xmlns="http://www.w3.org/2000/svg" fill="${o}">`+w+"</svg>"):w}_renderArrow(t,e,i){let n=e/7,o=e,s=t/2,a=i,l={x:0,y:n/2},d={x:100/125*o,y:l.y},c={x:d.x-.2*d.x,y:d.y+.2*d.x},u={x:c.x+.1*d.x,y:c.y+.1*d.x},p={x:u.x+.35*d.x,y:u.y-.35*d.x},m={x:p.x,y:-p.y},g={x:u.x,y:-u.y},f={x:c.x,y:-c.y},b={x:d.x,y:-d.y},y={x:l.x,y:-l.y};return`<path d="M ${[l,d,c,u,p,m,g,f,b,y].map(S=>`${(a+S.x).toFixed(2)} ${(s+S.y).toFixed(2)}`).join(" L ")}" />`}render(t,e){if(!this._renderResult)return"";let i=e-t;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}},m1=class{renderWhitespace;renderWithSVG;spaceWidth;middotWidth;wsmiddotWidth;canUseHalfwidthRightwardsArrow;lineHeight;stopRenderingLineAfter;constructor(t){let e=t.options,i=e.get(51),n=e.get(39);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=e.get(101),this.renderWithSVG=!0):(this.renderWhitespace=e.get(101),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=e.get(68),this.stopRenderingLineAfter=e.get(119)}equals(t){return this.renderWhitespace===t.renderWhitespace&&this.renderWithSVG===t.renderWithSVG&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineHeight===t.lineHeight&&this.stopRenderingLineAfter===t.stopRenderingLineAfter}};var DC=class extends ji{};var zK=class{_onDidChange=new T;onDidChange=this._onDidChange.event;_enabled=!0;get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},KK=new zK;var qK=class{constructor(t,e,i,n,o){this._context=t;this.modelLineNumber=e;this.distanceToModelLineStart=i;this.widthOfHiddenLineTextBefore=n;this.distanceToModelLineEnd=o}_visibleTextAreaBrand=void 0;startPosition=null;endPosition=null;visibleTextareaStart=null;visibleTextareaEnd=null;_previousPresentation=null;prepareRender(t){let e=new U(this.modelLineNumber,this.distanceToModelLineStart+1),i=new U(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=t.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=t.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(t){return this._previousPresentation||(t?this._previousPresentation=t:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}},GK=dn,LC=class extends DC{constructor(e,i,n,o,s){super(e);this._keybindingService=o;this._instantiationService=s;this._viewController=i,this._visibleRangeProvider=n,this._scrollLeft=0,this._scrollTop=0;let a=this._context.configuration.options,l=a.get(147);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(51),this._lineHeight=a.get(68),this._emptySelectionClipboard=a.get(38),this._copyWithSyntaxHighlighting=a.get(25),this._visibleTextArea=null,this._selections=[new It(1,1,1,1)],this._modelSelections=[new It(1,1,1,1)],this._lastRenderPosition=null,this.textArea=ut(document.createElement("textarea")),Ro.write(this.textArea,7),this.textArea.setClassName(`inputarea ${Zp}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:d}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${d*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",Ax(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(126))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",h("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(93)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=ut(document.createElement("div")),this.textAreaCover.setPosition("absolute");let c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:m=>this._context.viewModel.getLineMaxColumn(m),getValueInRange:(m,g)=>this._context.viewModel.getValueInRange(m,g),getValueLengthInRange:(m,g)=>this._context.viewModel.getValueLengthInRange(m,g),modifyPosition:(m,g)=>this._context.viewModel.modifyPosition(m,g)},u={getDataToCopy:()=>RO(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){let g=this._selections[0];if(be&&g.isEmpty()){let b=g.getStartPosition(),y=this._getWordBeforePosition(b);if(y.length===0&&(y=this._getCharacterBeforePosition(b)),y.length>0)return new Mo(y,y.length,y.length,F.fromPositions(b),0)}if(be&&!g.isEmpty()&&c.getValueLengthInRange(g,0)<500){let b=c.getValueInRange(g,0);return new Mo(b,0,b.length,g,0)}if(Eo&&!g.isEmpty()){let b="vscode-placeholder";return new Mo(b,0,b.length,null,void 0)}return Mo.EMPTY}if(UV){let g=this._selections[0];if(g.isEmpty()){let f=g.getStartPosition(),[b,y]=this._getAndroidWordAtPosition(f);if(b.length>0)return new Mo(b,y,y,F.fromPositions(f),0)}return Mo.EMPTY}let m=CC.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return Mo.fromScreenReaderContentState(m)},deduceModelPosition:(m,g,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(m,g,f)},p=this._register(new AO(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(SC,u,p,Hs,{isAndroid:UV,isChrome:xc,isFirefox:dn,isSafari:Eo})),this._register(this._textAreaInput.onKeyDown(m=>{this._viewController.emitKeyDown(m)})),this._register(this._textAreaInput.onKeyUp(m=>{this._viewController.emitKeyUp(m)})),this._register(this._textAreaInput.onPaste(m=>{let g=!1,f=null,b=null;m.metadata&&(g=this._emptySelectionClipboard&&!!m.metadata.isFromEmptySelection,f=typeof m.metadata.multicursorText<"u"?m.metadata.multicursorText:null,b=m.metadata.mode),this._viewController.paste(m.text,g,f,b)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(m=>{m.replacePrevCharCnt||m.replaceNextCharCnt||m.positionDelta?(Ws&&console.log(` => compositionType: <<${m.text}>>, ${m.replacePrevCharCnt}, ${m.replaceNextCharCnt}, ${m.positionDelta}`),this._viewController.compositionType(m.text,m.replacePrevCharCnt,m.replaceNextCharCnt,m.positionDelta)):(Ws&&console.log(` => type: <<${m.text}>>`),this._viewController.type(m.text))})),this._register(this._textAreaInput.onSelectionChangeRequest(m=>{this._viewController.setSelection(m)})),this._register(this._textAreaInput.onCompositionStart(m=>{let g=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:b,widthOfHiddenTextBefore:y}=(()=>{let E=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),S=E.lastIndexOf(`
`),w=E.substring(S+1),D=w.lastIndexOf("	"),k=w.length-D-1,R=f.getStartPosition(),A=Math.min(R.column-1,k),H=R.column-1-A,z=w.substring(0,w.length-A),{tabSize:Z}=this._context.viewModel.model.getOptions(),fe=npe(this.textArea.domNode.ownerDocument,z,this._fontInfo,Z);return{distanceToModelLineStart:H,widthOfHiddenTextBefore:fe}})(),{distanceToModelLineEnd:I}=(()=>{let E=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),S=E.indexOf(`
`),w=S===-1?E:E.substring(0,S),D=w.indexOf("	"),k=D===-1?w.length:w.length-D-1,R=f.getEndPosition(),A=Math.min(this._context.viewModel.model.getLineMaxColumn(R.lineNumber)-R.column,k);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(R.lineNumber)-R.column-A}})();this._context.viewModel.revealRange("keyboard",!0,F.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new qK(this._context,f.startLineNumber,b,y,I),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${Zp} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(m=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${Zp}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(KK.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}_viewController;_visibleRangeProvider;_scrollLeft;_scrollTop;_accessibilitySupport;_accessibilityPageSize;_textAreaWrapping;_textAreaWidth;_contentLeft;_contentWidth;_contentHeight;_fontInfo;_lineHeight;_emptySelectionClipboard;_copyWithSyntaxHighlighting;_visibleTextArea;_selections;_modelSelections;_lastRenderPosition;textArea;textAreaCover;_textAreaInput;get domNode(){return this.textArea}appendTo(e){e.appendChild(this.textArea),e.appendChild(this.textAreaCover)}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(e){let i='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',n=this._context.viewModel.getLineContent(e.lineNumber),o=Mc(i,[]),s=!0,a=e.column,l=!0,d=e.column,c=0;for(;c<50&&(s||l);){if(s&&a<=1&&(s=!1),s){let u=n.charCodeAt(a-2);o.get(u)!==0?s=!1:a--}if(l&&d>n.length&&(l=!1),l){let u=n.charCodeAt(d-1);o.get(u)!==0?l=!1:d++}c++}return[n.substring(a-1,d-1),e.column-a]}_getWordBeforePosition(e){let i=this._context.viewModel.getLineContent(e.lineNumber),n=Mc(this._context.configuration.options.get(133),[]),o=e.column,s=0;for(;o>1;){let a=i.charCodeAt(o-2);if(n.get(a)!==0||s>50)return i.substring(o-1,e.column-1);s++,o--}return i.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){let n=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!ln(n.charCodeAt(0)))return n}return""}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);let i=e.get(3);this._accessibilitySupport===2&&i===yl.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=i;let o=e.get(147).wrappingColumn;if(o!==-1&&this._accessibilitySupport!==1){let s=e.get(51);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(o*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=GK?0:1}onConfigurationChanged(e){let i=this._context.configuration.options,n=i.get(147);this._setAccessibilityOptions(i),this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._contentHeight=n.height,this._fontInfo=i.get(51),this._lineHeight=i.get(68),this._emptySelectionClipboard=i.get(38),this._copyWithSyntaxHighlighting=i.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");let{tabSize:o}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${o*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",Ax(i,this._keybindingService)),this.textArea.setAttribute("aria-required",i.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(i.get(126))),(e.hasChanged(34)||e.hasChanged(93))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){let e=this._context.configuration.options;!KK.enabled||e.get(34)&&e.get(93)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}_primaryCursorPosition=new U(1,1);_primaryCursorVisibleRange=null;prepareRender(e){this._primaryCursorPosition=new U(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){let n=this._visibleTextArea.visibleTextareaStart,o=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(s&&a&&n&&o&&o.left>=this._scrollLeft&&n.left<=this._scrollLeft+this._contentWidth){let l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,d=Px(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart)),c=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+n.left-this._scrollLeft,p=o.left-n.left+1;if(u<this._contentLeft){let I=this._contentLeft-u;u+=I,c+=I,p-=I}p>this._contentWidth&&(p=this._contentWidth);let m=this._context.viewModel.getViewLineData(s.lineNumber),g=m.tokens.findTokenIndexAtOffset(s.column-1),f=m.tokens.findTokenIndexAtOffset(a.column-1),b=g===f,y=this._visibleTextArea.definePresentation(b?m.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=d*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:l,left:u,width:p,height:this._lineHeight,useCover:!1,color:(ca.getColorMap()||[])[y.foreground],italic:y.italic,bold:y.bold,underline:y.underline,strikethrough:y.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}let e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}let i=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(i<0||i>this._contentHeight){this._renderAtTopLeft();return}if(be||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;let n=this._textAreaInput.textAreaState.newlineCountBeforeSelection??Px(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=n*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:GK?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:GK?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;let i=this.textArea,n=this.textAreaCover;rn(i,this._fontInfo),i.setTop(e.top),i.setLeft(e.left),i.setWidth(e.width),i.setHeight(e.height),i.setColor(e.color?Y.Format.CSS.formatHex(e.color):""),i.setFontStyle(e.italic?"italic":""),e.bold&&i.setFontWeight("bold"),i.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),n.setTop(e.useCover?e.top:0),n.setLeft(e.useCover?e.left:0),n.setWidth(e.useCover?e.width:0),n.setHeight(e.useCover?e.height:0);let o=this._context.configuration.options;o.get(58)?n.setClassName("monaco-editor-background textAreaCover "+xC.OUTER_CLASS_NAME):o.get(69).renderType!==0?n.setClassName("monaco-editor-background textAreaCover "+TC.CLASS_NAME):n.setClassName("monaco-editor-background textAreaCover")}};LC=_([v(3,at),v(4,ae)],LC);function npe(r,t,e,i){if(t.length===0)return 0;let n=r.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";let o=r.createElement("span");rn(o,e),o.style.whiteSpace="pre",o.style.tabSize=`${i*e.spaceWidth}px`,o.append(t),n.appendChild(o),r.body.appendChild(n);let s=o.offsetWidth;return n.remove(),s}var g1=class extends L{constructor(e,i){super();this._domNode=e;this._onFocusChange=i;this._register(M(this._domNode,"focus",()=>this._handleFocusedChanged(!0))),this._register(M(this._domNode,"blur",()=>this._handleFocusedChanged(!1)))}_isFocused=!1;_handleFocusedChanged(e){this._isFocused!==e&&(this._isFocused=e,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus()}get isFocused(){return this._isFocused}};function kC(r,t,e,i){return r.addEventListener(t,e,i),{dispose(){r.removeEventListener(t,e)}}}var RC=class{constructor(t,e,i){this._domNode=t;this._context=e;this._keybindingService=i;this._updateConfigurationSettings(),this._updateDomAttributes()}_contentLeft=1;_contentWidth=1;_lineHeight=1;_fontInfo;_accessibilitySupport=0;_accessibilityPageSize=1;_primarySelection=new It(1,1,1,1);_screenReaderContentState;onConfigurationChanged(t){this._updateConfigurationSettings(),this._updateDomAttributes(),t.hasChanged(2)&&this.writeScreenReaderContent()}_updateConfigurationSettings(){let t=this._context.configuration.options,e=t.get(147);this._contentLeft=e.contentLeft,this._contentWidth=e.contentWidth,this._fontInfo=t.get(51),this._lineHeight=t.get(68),this._accessibilitySupport=t.get(2),this._accessibilityPageSize=t.get(3)}_updateDomAttributes(){let t=this._context.configuration.options;this._domNode.domNode.setAttribute("aria-label",Ax(t,this._keybindingService));let e=this._context.viewModel.model.getOptions().tabSize,i=t.get(51).spaceWidth;this._domNode.domNode.style.tabSize=`${e*i}px`}onCursorStateChanged(t){this._primarySelection=t.selections[0]??new It(1,1,1,1)}prepareRender(t){this.writeScreenReaderContent()}render(t){if(!this._screenReaderContentState)return;rn(this._domNode,this._fontInfo);let e=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.positionLineNumber),i=this._context.viewLayout.getCurrentScrollTop(),n=e-i;this._domNode.setTop(n),this._domNode.setLeft(this._contentLeft),this._domNode.setWidth(this._contentWidth),this._domNode.setHeight(this._lineHeight);let o=this._screenReaderContentState.value.substring(0,this._screenReaderContentState.selectionStart),s=Px(o);this._domNode.domNode.scrollTop=s*this._lineHeight}setAriaOptions(){}writeScreenReaderContent(){this._screenReaderContentState=this._getScreenReaderContentState(),this._screenReaderContentState&&(this._domNode.domNode.textContent!==this._screenReaderContentState.value&&(this._domNode.domNode.textContent=this._screenReaderContentState.value),this._setSelectionOfScreenReaderContent(this._screenReaderContentState.selectionStart,this._screenReaderContentState.selectionEnd))}_getScreenReaderContentState(){let t=this._accessibilitySupport===1?1:this._accessibilityPageSize,e={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:i=>this._context.viewModel.getLineMaxColumn(i),getValueInRange:(i,n)=>this._context.viewModel.getValueInRange(i,n),getValueLengthInRange:(i,n)=>this._context.viewModel.getValueLengthInRange(i,n),modifyPosition:(i,n)=>this._context.viewModel.modifyPosition(i,n)};return CC.fromEditorSelection(e,this._primarySelection,t,this._accessibilitySupport===0)}_setSelectionOfScreenReaderContent(t,e){let n=uo().document.getSelection();if(!n)return;let o=this._domNode.domNode.firstChild;if(!o)return;let s=uo().document.activeElement,a=new globalThis.Range;a.setStart(o,t),a.setEnd(o,e),n.removeAllRanges(),n.addRange(a),Oi(s)&&s.focus()}};RC=_([v(2,at)],RC);var AC=class extends DC{domNode;_editContext;_screenReaderSupport;_parent;_decorations=[];_renderingContext;_primarySelection=new It(1,1,1,1);_textStartPositionWithinEditor=new U(1,1);_compositionRangeWithinEditor;_focusTracker;constructor(t,e,i,n){super(t),this.domNode=new pf(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._updateDomAttributes(),this._focusTracker=this._register(new g1(this.domNode.domNode,o=>this._context.viewModel.setHasFocus(o))),this._editContext=new EditContext,this.domNode.domNode.editContext=this._editContext,this._screenReaderSupport=i.createInstance(RC,this.domNode,t),this._register(M(this.domNode.domNode,"copy",()=>this._ensureClipboardGetsEditorSelection(n))),this._register(M(this.domNode.domNode,"cut",()=>{this._ensureClipboardGetsEditorSelection(n),e.cut()})),this._register(M(this.domNode.domNode,"keyup",o=>e.emitKeyUp(new st(o)))),this._register(M(this.domNode.domNode,"keydown",async o=>{let s=new st(o);s.keyCode===114&&s.stopPropagation(),s.keyCode===3&&this._onType(e,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}),e.emitKeyDown(s)})),this._register(kC(this._editContext,"textformatupdate",o=>this._handleTextFormatUpdate(o))),this._register(kC(this._editContext,"characterboundsupdate",o=>this._updateCharacterBounds())),this._register(kC(this._editContext,"textupdate",o=>{let s=this._compositionRangeWithinEditor;if(s){let a=this._context.viewModel.getPrimaryCursorState().modelState.position,l=F.fromPositions(s.getStartPosition(),a);this._compositionRangeWithinEditor=l}this._emitTypeEvent(e,o),this._screenReaderSupport.writeScreenReaderContent()})),this._register(kC(this._editContext,"compositionstart",o=>{let s=this._context.viewModel.getPrimaryCursorState().modelState.position,a=F.fromPositions(s,s);this._compositionRangeWithinEditor=a,e.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(kC(this._editContext,"compositionend",o=>{this._compositionRangeWithinEditor=void 0,e.compositionEnd(),this._context.viewModel.onCompositionEnd()}))}dispose(){super.dispose(),this.domNode.domNode.remove()}appendTo(t){t.appendChild(this.domNode),this._parent=t.domNode}setAriaOptions(){this._screenReaderSupport.setAriaOptions()}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(t){this._renderingContext=t,this._screenReaderSupport.prepareRender(t),this._updateEditContext(),this._updateSelectionAndControlBounds(),this._updateCharacterBounds()}render(t){this._screenReaderSupport.render(t)}onCursorStateChanged(t){return this._primarySelection=t.modelSelections[0]??new It(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(t),!0}onConfigurationChanged(t){return this._screenReaderSupport.onConfigurationChanged(t),this._updateDomAttributes(),!0}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus()}refreshFocusState(){}_updateDomAttributes(){let t=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(t.get(126)))}_updateEditContext(){let t=this._getNewEditContextState();this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,t.text),this._editContext.updateSelection(t.selectionStartOffset,t.selectionEndOffset),this._textStartPositionWithinEditor=t.textStartPositionWithinEditor}_emitTypeEvent(t,e){if(!this._editContext)return;let i=this._context.viewModel.model,n=i.getOffsetAt(this._textStartPositionWithinEditor),o=i.getOffsetAt(this._primarySelection.getEndPosition()),s=i.getOffsetAt(this._primarySelection.getStartPosition()),a=o-n,l=s-n,d=0,c=0;e.updateRangeEnd>a&&(d=e.updateRangeEnd-a),e.updateRangeStart<l&&(c=l-e.updateRangeStart);let u="";l<e.updateRangeStart&&(u+=this._editContext.text.substring(l,e.updateRangeStart)),u+=e.text,a>e.updateRangeEnd&&(u+=this._editContext.text.substring(e.updateRangeEnd,a));let p={text:u,replacePrevCharCnt:c,replaceNextCharCnt:d,positionDelta:0};this._onType(t,p);let m=l-c+u.length;this._updateCursorStatesAfterType(m,e.selectionStart,e.selectionEnd)}_onType(t,e){e.replacePrevCharCnt||e.replaceNextCharCnt||e.positionDelta?t.compositionType(e.text,e.replacePrevCharCnt,e.replaceNextCharCnt,e.positionDelta):t.type(e.text)}_updateCursorStatesAfterType(t,e,i){let n=e-t,o=i-t,l=this._context.viewModel.getCursorStates().map(d=>d.modelState.position).map(d=>{let c=d.lineNumber,u=d.column;return new It(c,u+n,c,u+o)}).map(d=>Rt.fromModelSelection(d));this._context.viewModel.setCursorStates("editContext",3,l)}_getNewEditContextState(){let t=this._primarySelection.startColumn-1,e=0;for(let a=this._primarySelection.startLineNumber;a<=this._primarySelection.endLineNumber;a++)a===this._primarySelection.endLineNumber?e+=this._primarySelection.endColumn-1:e+=this._context.viewModel.model.getLineMaxColumn(a);let i=this._context.viewModel.model.getLineMaxColumn(this._primarySelection.endLineNumber),n=new F(this._primarySelection.startLineNumber,1,this._primarySelection.endLineNumber,i),o=this._context.viewModel.model.getValueInRange(n,0),s=n.getStartPosition();return{text:o,selectionStartOffset:t,selectionEndOffset:e,textStartPositionWithinEditor:s}}_handleTextFormatUpdate(t){if(!this._editContext)return;let e=t.getTextFormats(),i=this._textStartPositionWithinEditor,n=[];e.forEach(o=>{let s=this._context.viewModel.model,a=s.getOffsetAt(i),l=s.getPositionAt(a+o.rangeStart),d=s.getPositionAt(a+o.rangeEnd),c=F.fromPositions(l,d),u=["edit-context-format-decoration",`underline-style-${o.underlineStyle.toLowerCase()}`,`underline-thickness-${o.underlineThickness.toLowerCase()}`];n.push({range:c,options:{description:"textFormatDecoration",inlineClassName:u.join(" ")}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,n)}_updateSelectionAndControlBounds(){if(!this._parent)return;let t=this._context.configuration.options,e=t.get(68),i=t.get(147).contentLeft,n=this._parent.getBoundingClientRect(),o=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primarySelection.startLineNumber),s=this._context.viewLayout.getCurrentScrollTop(),a=n.top+o-s,l=(this._primarySelection.endLineNumber-this._primarySelection.startLineNumber+1)*e,d=n.left+i,c;if(this._primarySelection.isEmpty()){if(this._renderingContext){let m=this._renderingContext.linesVisibleRangesForRange(this._primarySelection,!0)??[];m.length>0&&(d+=Math.min(...m.map(g=>Math.min(...g.ranges.map(f=>f.left)))))}c=t.get(51).typicalHalfwidthCharacterWidth/2}else c=n.width-i;let u=new DOMRect(d,a,c,l),p=u;this._editContext.updateControlBounds(p),this._editContext.updateSelectionBounds(u)}_updateCharacterBounds(){if(!this._parent||!this._compositionRangeWithinEditor)return;let t=this._context.configuration.options,e=t.get(68),i=t.get(147).contentLeft,n=this._parent.getBoundingClientRect(),o=this._compositionRangeWithinEditor,s=this._context.viewLayout.getVerticalOffsetForLineNumber(o.startLineNumber),a=this._context.viewLayout.getCurrentScrollTop(),l=n.top+s-a,d=[];if(this._renderingContext){let g=this._renderingContext.linesVisibleRangesForRange(o,!0)??[];for(let f of g)for(let b of f.ranges)d.push(new DOMRect(n.left+i+b.left,l,b.width,e))}let c=this._context.viewModel.model,u=c.getOffsetAt(this._textStartPositionWithinEditor),m=c.getOffsetAt(o.getStartPosition())-u;this._editContext.updateCharacterBounds(m,d)}_ensureClipboardGetsEditorSelection(t){let e=this._context.configuration.options,i=e.get(38),n=e.get(25),o=this._context.viewModel.getCursorStates().map(l=>l.modelState.selection),s=RO(this._context.viewModel,o,i,n),a={version:1,isFromEmptySelection:s.isFromEmptySelection,multicursorText:s.multicursorText,mode:s.mode};fb.INSTANCE.set(dn?s.text.replace(/\r\n/g,`
`):s.text,a),t.writeText(s.text)}};AC=_([v(2,ae),v(3,gI)],AC);var PC=class extends Nl{constructor(e,i,n,o,s,a,l){super();this._instantiationService=l;this._selections=[new It(1,1,1,1)],this._renderAnimationFrame=null;let d=new kO(i,o,s,e);this._context=new eO(i,n,o),this._context.addEventHandler(this),this._viewParts=[];let c=this._context.configuration.options.get(37);this._editContext=c?this._instantiationService.createInstance(AC,this._context,d):this._instantiationService.createInstance(LC,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._editContext),this._linesContent=ut(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=ut(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=ut(document.createElement("div")),Ro.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new GO(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new $O(this._context,this._linesContent),this._viewZones=new p1(this._context),this._viewParts.push(this._viewZones);let u=new r1(this._context);this._viewParts.push(u);let p=new l1(this._context);this._viewParts.push(p);let m=new NO(this._context);this._viewParts.push(m),m.addDynamicOverlay(new HO(this._context)),m.addDynamicOverlay(new c1(this._context)),m.addDynamicOverlay(new jO(this._context)),m.addDynamicOverlay(new KO(this._context)),m.addDynamicOverlay(new h1(this._context));let g=new FO(this._context);this._viewParts.push(g),g.addDynamicOverlay(new zO(this._context)),g.addDynamicOverlay(new ZO(this._context)),g.addDynamicOverlay(new YO(this._context)),g.addDynamicOverlay(new TC(this._context)),this._glyphMarginWidgets=new qO(this._context),this._viewParts.push(this._glyphMarginWidgets);let f=new xC(this._context);f.getDomNode().appendChild(this._viewZones.marginDomNode),f.getDomNode().appendChild(g.getDomNode()),f.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(f),this._contentWidgets=new VO(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new u1(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new o1(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);let b=new a1(this._context);this._viewParts.push(b);let y=new BO(this._context);this._viewParts.push(y);let I=new i1(this._context);if(this._viewParts.push(I),u){let E=this._scrollbar.getOverviewRulerLayoutInfo();E.parent.insertBefore(u.getDomNode(),E.insertBefore)}this._linesContent.appendChild(m.getDomNode()),this._linesContent.appendChild(b.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(f.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._editContext.appendTo(this._overflowGuardContainer),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(I.getDomNode()),this._overflowGuardContainer.appendChild(y.domNode),this.domNode.appendChild(this._overflowGuardContainer),a?(a.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),a.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new MO(this._context,d,this._createPointerHandlerHelper()))}_scrollbar;_context;_selections;_viewLines;_viewZones;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_viewCursors;_viewParts;_editContext;_pointerHandler;_linesContent;domNode;_overflowGuardContainer;_shouldRecomputeGlyphMarginLanes=!1;_renderAnimationFrame;_computeGlyphMarginLanes(){let e=this._context.viewModel.model,i=this._context.viewModel.glyphLanes,n=[],o=0;n=n.concat(e.getAllMarginDecorations().map(s=>{let a=s.options.glyphMargin?.position??2;return o=Math.max(o,s.range.endLineNumber),{range:s.range,lane:a,persist:s.options.glyphMargin?.persistLane}})),n=n.concat(this._glyphMarginWidgets.getWidgets().map(s=>{let a=e.validateRange(s.preference.range);return o=Math.max(o,a.endLineNumber),{range:a,lane:s.preference.lane}})),n.sort((s,a)=>F.compareRangesUsingStarts(s.range,a.range)),i.reset(o);for(let s of n)i.push(s.lane,s.range,s.persist);return i}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._editContext.domNode.domNode.dispatchEvent(e)},getLastRenderData:()=>{let e=this._viewCursors.getLastRenderData()||[],i=this._editContext.getLastRenderData();return new aO(e,i)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,i)),visibleRangeForPosition:(e,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new U(e,i))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){let i=this._context.configuration.options.get(147);this.domNode.setWidth(i.width),this.domNode.setHeight(i.height),this._overflowGuardContainer.setWidth(i.width),this._overflowGuardContainer.setHeight(i.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){let e=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(144)+" "+Ow(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(let e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new yt;if(this._renderAnimationFrame===null){let e=this._createCoordinatedRendering();this._renderAnimationFrame=jK.INSTANCE.scheduleCoordinatedRendering({window:oe(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new yt;try{return e.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new yt;return e.renderText()},prepareRender:(i,n)=>{if(this._store.isDisposed)throw new yt;return e.prepareRender(i,n)},render:(i,n)=>{if(this._store.isDisposed)throw new yt;return e.render(i,n)}})}}_flushAccumulatedAndRenderNow(){let e=this._createCoordinatedRendering();Ym(()=>e.prepareRenderText());let i=Ym(()=>e.renderText());if(i){let[n,o]=i;Ym(()=>e.prepareRender(n,o)),Ym(()=>e.render(n,o))}}_getViewPartsToRender(){let e=[],i=0;for(let n of this._viewParts)n.shouldRender()&&(e[i++]=n);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;let e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}Yp.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;let i=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(i.startLineNumber,i.endLineNumber,i.centeredLineNumber);let n=new Z0(this._selections,i,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(n),this._viewLines.shouldRender()&&(this._viewLines.renderText(n),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),[e,new X0(this._context.viewLayout,n,this._viewLines)]},prepareRender:(e,i)=>{for(let n of e)n.prepareRender(i)},render:(e,i)=>{for(let n of e)n.render(i),n.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,i){let n=this._context.viewModel.model.validatePosition({lineNumber:e,column:i}),o=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);this._flushAccumulatedAndRenderNow();let s=this._viewLines.visibleRangeForPosition(new U(o.lineNumber,o.column));return s?s.left:-1}getTargetAtClientPoint(e,i){let n=this._pointerHandler.getTargetAtClientPoint(e,i);return n?yC.convertViewToModelMouseTarget(n,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new s1(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,i){if(i){this._viewLines.forceShouldRender();for(let n of this._viewParts)n.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._editContext.writeScreenReaderContent(e)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}refreshFocusState(){this._editContext.refreshFocusState()}setAriaOptions(e){this._editContext.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){this._contentWidgets.setWidgetPosition(e.widget,e.position?.position??null,e.position?.secondaryPosition??null,e.position?.preference??null,e.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){let i=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,i)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};PC=_([v(6,ae)],PC);function Ym(r){try{return r()}catch(t){return Ke(t),null}}var jK=class r{static INSTANCE=new r;_coordinatedRenderings=[];_animationFrameRunners=new Map;constructor(){}scheduleCoordinatedRendering(t){return this._coordinatedRenderings.push(t),this._scheduleRender(t.window),{dispose:()=>{let e=this._coordinatedRenderings.indexOf(t);if(e!==-1&&(this._coordinatedRenderings.splice(e,1),this._coordinatedRenderings.length===0)){for(let[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(t){if(!this._animationFrameRunners.has(t)){let e=()=>{this._animationFrameRunners.delete(t),this._onRenderScheduled()};this._animationFrameRunners.set(t,oW(t,e,100))}}_onRenderScheduled(){let t=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(let i of t)Ym(()=>i.prepareRenderText());let e=[];for(let i=0,n=t.length;i<n;i++){let o=t[i];e[i]=Ym(()=>o.renderText())}for(let i=0,n=t.length;i<n;i++){let o=t[i],s=e[i];if(!s)continue;let[a,l]=s;Ym(()=>o.prepareRender(a,l))}for(let i=0,n=t.length;i<n;i++){let o=t[i],s=e[i];if(!s)continue;let[a,l]=s;Ym(()=>o.render(a,l))}}};var rpe=qm("domLineBreaksComputer",{createHTML:r=>r}),f1=class r{constructor(t){this.targetWindow=t}static create(t){return new r(new WeakRef(t))}createLineBreaksComputer(t,e,i,n,o){let s=[],a=[];return{addRequest:(l,d,c)=>{s.push(l),a.push(d)},finalize:()=>spe(Ue(this.targetWindow.deref()),s,t,e,i,n,o,a)}}};function spe(r,t,e,i,n,o,s,a){function l(A){let H=a[A];if(H){let z=xs.applyInjectedText(t[A],H),Z=H.map(Ve=>Ve.options),fe=H.map(Ve=>Ve.column-1);return new Vp(fe,Z,[z.length],[],0)}else return null}if(n===-1){let A=[];for(let H=0,z=t.length;H<z;H++)A[H]=l(H);return A}let d=Math.round(n*e.typicalHalfwidthCharacterWidth),c=o===3?2:o===2?1:0,u=Math.round(i*c),p=Math.ceil(e.spaceWidth*u),m=document.createElement("div");rn(m,e);let g=new Pc(1e4),f=[],b=[],y=[],I=[],E=[];for(let A=0;A<t.length;A++){let H=xs.applyInjectedText(t[A],a[A]),z=0,Z=0,fe=d;if(o!==0)if(z=Rn(H),z===-1)z=0;else{for(let xe=0;xe<z;xe++){let Ie=H.charCodeAt(xe)===9?i-Z%i:1;Z+=Ie}let ce=Math.ceil(e.spaceWidth*Z);ce+e.typicalFullwidthCharacterWidth>d?(z=0,Z=0):fe=d-ce}let Ve=H.substr(z),me=ape(Ve,Z,i,fe,g,p);f[A]=z,b[A]=Z,y[A]=Ve,I[A]=me[0],E[A]=me[1]}let S=g.build(),w=rpe?.createHTML(S)??S;m.innerHTML=w,m.style.position="absolute",m.style.top="10000",s==="keepAll"?(m.style.wordBreak="keep-all",m.style.overflowWrap="anywhere"):(m.style.wordBreak="inherit",m.style.overflowWrap="break-word"),r.document.body.appendChild(m);let D=document.createRange(),k=Array.prototype.slice.call(m.children,0),R=[];for(let A=0;A<t.length;A++){let H=k[A],z=lpe(D,H,y[A],I[A]);if(z===null){R[A]=l(A);continue}let Z=f[A],fe=b[A]+u,Ve=E[A],me=[];for(let ge=0,He=z.length;ge<He;ge++)me[ge]=Ve[z[ge]];if(Z!==0)for(let ge=0,He=z.length;ge<He;ge++)z[ge]+=Z;let ce,xe,Ie=a[A];Ie?(ce=Ie.map(ge=>ge.options),xe=Ie.map(ge=>ge.column-1)):(ce=null,xe=null),R[A]=new Vp(xe,ce,z,me,fe)}return m.remove(),R}function ape(r,t,e,i,n,o){if(o!==0){let p=String(o);n.appendString('<div style="text-indent: -'),n.appendString(p),n.appendString("px; padding-left: "),n.appendString(p),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');let s=r.length,a=t,l=0,d=[],c=[],u=0<s?r.charCodeAt(0):0;n.appendString("<span>");for(let p=0;p<s;p++){p!==0&&p%16384===0&&n.appendString("</span><span>"),d[p]=l,c[p]=a;let m=u;u=p+1<s?r.charCodeAt(p+1):0;let g=1,f=1;switch(m){case 9:g=e-a%e,f=g;for(let b=1;b<=g;b++)b<g?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:u===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:xa(m)&&f++,m<32?n.appendCharCode(9216+m):n.appendCharCode(m)}l+=g,a+=f}return n.appendString("</span>"),d[r.length]=l,c[r.length]=a,n.appendString("</div>"),[d,c]}function lpe(r,t,e,i){if(e.length<=1)return null;let n=Array.prototype.slice.call(t.children,0),o=[];try{YK(r,n,i,0,null,e.length-1,null,o)}catch(s){return console.log(s),null}return o.length===0?null:(o.push(e.length),o)}function YK(r,t,e,i,n,o,s,a){if(i===o||(n=n||$K(r,t,e[i],e[i+1]),s=s||$K(r,t,e[o],e[o+1]),Math.abs(n[0].top-s[0].top)<=.1))return;if(i+1===o){a.push(o);return}let l=i+(o-i)/2|0,d=$K(r,t,e[l],e[l+1]);YK(r,t,e,i,n,l,d,a),YK(r,t,e,l,d,o,s,a)}function $K(r,t,e,i){return r.setStart(t[e/16384|0].firstChild,e%16384),r.setEnd(t[i/16384|0].firstChild,i%16384),r.getClientRects()}var b1=class extends L{_editor=null;_instantiationService=null;_instances=this._register(new Bo);_pending=new Map;_finishedInstantiation=[];constructor(){super(),this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(t,e,i){this._editor=t,this._instantiationService=i;for(let n of e){if(this._pending.has(n.id)){Ke(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(md(oe(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(md(oe(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(md(oe(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){let t={};for(let[e,i]of this._instances)typeof i.saveViewState=="function"&&(t[e]=i.saveViewState());return t}restoreViewState(t){for(let[e,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(t[e])}get(t){return this._instantiateById(t),this._instances.get(t)||null}set(t,e){this._instances.set(t,e)}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return md(oe(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(t){if(this._finishedInstantiation[t])return;this._finishedInstantiation[t]=!0;let e=this._findPendingContributionsByInstantiation(t);for(let i of e)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(t){let e=[];for(let[,i]of this._pending)i.instantiation===t&&e.push(i);return e}_instantiateById(t){let e=this._pending.get(t);if(e){if(this._pending.delete(t),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{let i=this._instantiationService.createInstance(e.ctor,this._editor);this._instances.set(e.id,i),typeof i.restoreViewState=="function"&&e.instantiation!==0&&console.warn(`Editor contribution '${e.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){Ke(i)}}}};var v1=class{constructor(t,e,i,n,o,s,a){this.id=t;this.label=e;this.alias=i;this.metadata=n;this._precondition=o;this._run=s;this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(t){return this.isSupported()?this._run(t):Promise.resolve(void 0)}};var Tee=$("ILanguageFeaturesService");var y1=class r{static create(t){return new r(t.get(136),t.get(135))}classifier;constructor(t,e){this.classifier=new ZK(t,e)}createLineBreaksComputer(t,e,i,n,o){let s=[],a=[],l=[];return{addRequest:(d,c,u)=>{s.push(d),a.push(c),l.push(u)},finalize:()=>{let d=t.typicalFullwidthCharacterWidth/t.typicalHalfwidthCharacterWidth,c=[];for(let u=0,p=s.length;u<p;u++){let m=a[u],g=l[u];g&&!g.injectionOptions&&!m?c[u]=dpe(this.classifier,g,s[u],e,i,d,n,o):c[u]=cpe(this.classifier,s[u],m,e,i,d,n,o)}return XK.length=0,QK.length=0,c}}}};var ZK=class extends ty{constructor(t,e){super(0);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),1);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),2)}get(t){return t>=0&&t<256?this._asciiMap[t]:t>=12352&&t<=12543||t>=13312&&t<=19903||t>=19968&&t<=40959?3:this._map.get(t)||this._defaultValue}},XK=[],QK=[];function dpe(r,t,e,i,n,o,s,a){if(n===-1)return null;let l=e.length;if(l<=1)return null;let d=a==="keepAll",c=t.breakOffsets,u=t.breakOffsetsVisibleColumn,p=_ee(e,i,n,o,s),m=n-p,g=XK,f=QK,b=0,y=0,I=0,E=n,S=c.length,w=0;if(w>=0){let D=Math.abs(u[w]-E);for(;w+1<S;){let k=Math.abs(u[w+1]-E);if(k>=D)break;D=k,w++}}for(;w<S;){let D=w<0?0:c[w],k=w<0?0:u[w];y>D&&(D=y,k=I);let R=0,A=0,H=0,z=0;if(k<=E){let fe=k,Ve=D===0?0:e.charCodeAt(D-1),me=D===0?0:r.get(Ve),ce=!0;for(let xe=D;xe<l;xe++){let Ie=xe,ge=e.charCodeAt(xe),He,_e;if(ln(ge)?(xe++,He=0,_e=2):(He=r.get(ge),_e=Ox(ge,fe,i,o)),Ie>y&&JK(Ve,me,ge,He,d)&&(R=Ie,A=fe),fe+=_e,fe>E){Ie>y?(H=Ie,z=fe-_e):(H=xe+1,z=fe),fe-A>m&&(R=0),ce=!1;break}Ve=ge,me=He}if(ce){b>0&&(g[b]=c[c.length-1],f[b]=u[c.length-1],b++);break}}if(R===0){let fe=k,Ve=e.charCodeAt(D),me=r.get(Ve),ce=!1;for(let xe=D-1;xe>=y;xe--){let Ie=xe+1,ge=e.charCodeAt(xe);if(ge===9){ce=!0;break}let He,_e;if(Ih(ge)?(xe--,He=0,_e=2):(He=r.get(ge),_e=xa(ge)?o:1),fe<=E){if(H===0&&(H=Ie,z=fe),fe<=E-m)break;if(JK(ge,He,Ve,me,d)){R=Ie,A=fe;break}}fe-=_e,Ve=ge,me=He}if(R!==0){let xe=m-(z-A);if(xe<=i){let Ie=e.charCodeAt(H),ge;ln(Ie)?ge=2:ge=Ox(Ie,z,i,o),xe-ge<0&&(R=0)}}if(ce){w--;continue}}if(R===0&&(R=H,A=z),R<=y){let fe=e.charCodeAt(y);ln(fe)?(R=y+2,A=I+2):(R=y+1,A=I+Ox(fe,I,i,o))}for(y=R,g[b]=R,I=A,f[b]=A,b++,E=A+m;w<0||w<S&&u[w]<A;)w++;let Z=Math.abs(u[w]-E);for(;w+1<S;){let fe=Math.abs(u[w+1]-E);if(fe>=Z)break;Z=fe,w++}}return b===0?null:(g.length=b,f.length=b,XK=t.breakOffsets,QK=t.breakOffsetsVisibleColumn,t.breakOffsets=g,t.breakOffsetsVisibleColumn=f,t.wrappedTextIndentLength=p,t)}function cpe(r,t,e,i,n,o,s,a){let l=xs.applyInjectedText(t,e),d,c;if(e&&e.length>0?(d=e.map(A=>A.options),c=e.map(A=>A.column-1)):(d=null,c=null),n===-1)return d?new Vp(c,d,[l.length],[],0):null;let u=l.length;if(u<=1)return d?new Vp(c,d,[l.length],[],0):null;let p=a==="keepAll",m=_ee(l,i,n,o,s),g=n-m,f=[],b=[],y=0,I=0,E=0,S=n,w=l.charCodeAt(0),D=r.get(w),k=Ox(w,0,i,o),R=1;ln(w)&&(k+=1,w=l.charCodeAt(1),D=r.get(w),R++);for(let A=R;A<u;A++){let H=A,z=l.charCodeAt(A),Z,fe;ln(z)?(A++,Z=0,fe=2):(Z=r.get(z),fe=Ox(z,k,i,o)),JK(w,D,z,Z,p)&&(I=H,E=k),k+=fe,k>S&&((I===0||k-E>g)&&(I=H,E=k-fe),f[y]=I,b[y]=E,y++,S=E+g,I=0),w=z,D=Z}return y===0&&(!e||e.length===0)?null:(f[y]=u,b[y]=k,new Vp(c,d,f,b,m))}function Ox(r,t,e,i){return r===9?e-t%e:xa(r)||r<32?i:1}function xee(r,t){return t-r%t}function JK(r,t,e,i,n){return e!==32&&(t===2&&i!==2||t!==1&&i===1||!n&&t===3&&i!==2||!n&&i===3&&t!==1)}function _ee(r,t,e,i,n){let o=0;if(n!==0){let s=Rn(r);if(s!==-1){for(let l=0;l<s;l++){let d=r.charCodeAt(l)===9?xee(o,t):1;o+=d}let a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){let d=xee(o,t);o+=d}o+i>e&&(o=0)}}return o}var Nx=class{_cursorContextBrand=void 0;model;viewModel;coordinatesConverter;cursorConfig;constructor(t,e,i,n){this.model=t,this.viewModel=e,this.coordinatesConverter=i,this.cursorConfig=n}};var Fx=class r{modelState;viewState;_selTrackedRange;_trackSelection;constructor(t){this._selTrackedRange=null,this._trackSelection=!0,this._setState(t,new Yn(new F(1,1,1,1),0,0,new U(1,1),0),new Yn(new F(1,1,1,1),0,0,new U(1,1),0))}dispose(t){this._removeTrackedRange(t)}startTrackingSelection(t){this._trackSelection=!0,this._updateTrackedRange(t)}stopTrackingSelection(t){this._trackSelection=!1,this._removeTrackedRange(t)}_updateTrackedRange(t){this._trackSelection&&(this._selTrackedRange=t.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(t){this._selTrackedRange=t.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new Rt(this.modelState,this.viewState)}readSelectionFromMarkers(t){let e=t.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!e.isEmpty()?It.fromRange(e.collapseToEnd(),this.modelState.selection.getDirection()):It.fromRange(e,this.modelState.selection.getDirection())}ensureValidState(t){this._setState(t,this.modelState,this.viewState)}setState(t,e,i){this._setState(t,e,i)}static _validatePositionWithCache(t,e,i,n){return e.equals(i)?n:t.normalizePosition(e,2)}static _validateViewState(t,e){let i=e.position,n=e.selectionStart.getStartPosition(),o=e.selectionStart.getEndPosition(),s=t.normalizePosition(i,2),a=this._validatePositionWithCache(t,n,i,s),l=this._validatePositionWithCache(t,o,n,a);return i.equals(s)&&n.equals(a)&&o.equals(l)?e:new Yn(F.fromPositions(a,l),e.selectionStartKind,e.selectionStartLeftoverVisibleColumns+n.column-a.column,s,e.leftoverVisibleColumns+i.column-s.column)}_setState(t,e,i){if(i&&(i=r._validateViewState(t.viewModel,i)),e){let n=t.model.validateRange(e.selectionStart),o=e.selectionStart.equalsRange(n)?e.selectionStartLeftoverVisibleColumns:0,s=t.model.validatePosition(e.position),a=e.position.equals(s)?e.leftoverVisibleColumns:0;e=new Yn(n,e.selectionStartKind,o,s,a)}else{if(!i)return;let n=t.model.validateRange(t.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),o=t.model.validatePosition(t.coordinatesConverter.convertViewPositionToModelPosition(i.position));e=new Yn(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}if(i){let n=t.coordinatesConverter.validateViewRange(i.selectionStart,e.selectionStart),o=t.coordinatesConverter.validateViewPosition(i.position,e.position);i=new Yn(n,e.selectionStartKind,e.selectionStartLeftoverVisibleColumns,o,e.leftoverVisibleColumns)}else{let n=t.coordinatesConverter.convertModelPositionToViewPosition(new U(e.selectionStart.startLineNumber,e.selectionStart.startColumn)),o=t.coordinatesConverter.convertModelPositionToViewPosition(new U(e.selectionStart.endLineNumber,e.selectionStart.endColumn)),s=new F(n.lineNumber,n.column,o.lineNumber,o.column),a=t.coordinatesConverter.convertModelPositionToViewPosition(e.position);i=new Yn(s,e.selectionStartKind,e.selectionStartLeftoverVisibleColumns,a,e.leftoverVisibleColumns)}this.modelState=e,this.viewState=i,this._updateTrackedRange(t)}};var Bx=class{context;cursors;lastAddedCursorIndex;constructor(t){this.context=t,this.cursors=[new Fx(t)],this.lastAddedCursorIndex=0}dispose(){for(let t of this.cursors)t.dispose(this.context)}startTrackingSelections(){for(let t of this.cursors)t.startTrackingSelection(this.context)}stopTrackingSelections(){for(let t of this.cursors)t.stopTrackingSelection(this.context)}updateContext(t){this.context=t}ensureValidState(){for(let t of this.cursors)t.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(t=>t.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(t=>t.asCursorState())}getViewPositions(){return this.cursors.map(t=>t.viewState.position)}getTopMostViewPosition(){return u7(this.cursors,Qr(t=>t.viewState.position,U.compare)).viewState.position}getBottomMostViewPosition(){return c7(this.cursors,Qr(t=>t.viewState.position,U.compare)).viewState.position}getSelections(){return this.cursors.map(t=>t.modelState.selection)}getViewSelections(){return this.cursors.map(t=>t.viewState.selection)}setSelections(t){this.setStates(Rt.fromModelSelections(t))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(t){t!==null&&(this.cursors[0].setState(this.context,t[0].modelState,t[0].viewState),this._setSecondaryStates(t.slice(1)))}_setSecondaryStates(t){let e=this.cursors.length-1,i=t.length;if(e<i){let n=i-e;for(let o=0;o<n;o++)this._addSecondaryCursor()}else if(e>i){let n=e-i;for(let o=0;o<n;o++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,t[n].modelState,t[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Fx(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(t){this.lastAddedCursorIndex>=t+1&&this.lastAddedCursorIndex--,this.cursors[t+1].dispose(this.context),this.cursors.splice(t+1,1)}normalize(){if(this.cursors.length===1)return;let t=this.cursors.slice(0),e=[];for(let i=0,n=t.length;i<n;i++)e.push({index:i,selection:t[i].modelState.selection});e.sort(Qr(i=>i.selection,F.compareRangesUsingStarts));for(let i=0;i<e.length-1;i++){let n=e[i],o=e[i+1],s=n.selection,a=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||s.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(s.getEndPosition()):l=a.getStartPosition().isBefore(s.getEndPosition()),l){let d=n.index<o.index?i:i+1,c=n.index<o.index?i+1:i,u=e[c].index,p=e[d].index,m=e[c].selection,g=e[d].selection;if(!m.equalsSelection(g)){let f=m.plusRange(g),b=m.selectionStartLineNumber===m.startLineNumber&&m.selectionStartColumn===m.startColumn,y=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn,I;u===this.lastAddedCursorIndex?(I=b,this.lastAddedCursorIndex=p):I=y;let E;I?E=new It(f.startLineNumber,f.startColumn,f.endLineNumber,f.endColumn):E=new It(f.endLineNumber,f.endColumn,f.startLineNumber,f.startColumn),e[d].selection=E;let S=Rt.fromModelSelection(E);t[p].setState(this.context,S.modelState,S.viewState)}for(let f of e)f.index>u&&f.index--;t.splice(u,1),e.splice(c,1),this._removeSecondaryCursor(u-1),i--}}}};var I1=class extends L{_onEvent=this._register(new T);onEvent=this._onEvent.event;_eventHandlers;_viewEventQueue;_isConsumingViewEventQueue;_collector;_collectorCnt;_outgoingEvents;constructor(){super(),this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(t){this._addOutgoingEvent(t),this._emitOutgoingEvents()}_addOutgoingEvent(t){for(let e=0,i=this._outgoingEvents.length;e<i;e++){let n=this._outgoingEvents[e].kind===t.kind?this._outgoingEvents[e].attemptToMerge(t):null;if(n){this._outgoingEvents[e]=n;return}}this._outgoingEvents.push(t)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;let t=this._outgoingEvents.shift();t.isNoOp()||this._onEvent.fire(t)}}addViewEventHandler(t){for(let e=0,i=this._eventHandlers.length;e<i;e++)this._eventHandlers[e]===t&&console.warn("Detected duplicate listener in ViewEventDispatcher",t);this._eventHandlers.push(t)}removeViewEventHandler(t){for(let e=0;e<this._eventHandlers.length;e++)if(this._eventHandlers[e]===t){this._eventHandlers.splice(e,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new e8),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){let t=this._collector.outgoingEvents,e=this._collector.viewEvents;this._collector=null;for(let i of t)this._addOutgoingEvent(i);e.length>0&&this._emitMany(e)}this._emitOutgoingEvents()}emitSingleViewEvent(t){try{this.beginEmitViewEvents().emitViewEvent(t)}finally{this.endEmitViewEvents()}}_emitMany(t){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(t):this._viewEventQueue=t,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){let t=this._viewEventQueue;this._viewEventQueue=null;let e=this._eventHandlers.slice(0);for(let i of e)i.handleEvents(t)}}},e8=class{viewEvents;outgoingEvents;constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(t){this.viewEvents.push(t)}emitOutgoingEvent(t){this.outgoingEvents.push(t)}};var C1=class r{kind=0;_oldContentWidth;_oldContentHeight;contentWidth;contentHeight;contentWidthChanged;contentHeightChanged;constructor(t,e,i,n){this._oldContentWidth=t,this._oldContentHeight=e,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(t){return t.kind!==this.kind?null:new r(this._oldContentWidth,this._oldContentHeight,t.contentWidth,t.contentHeight)}},S1=class r{kind=1;oldHasFocus;hasFocus;constructor(t,e){this.oldHasFocus=t,this.hasFocus=e}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(t){return t.kind!==this.kind?null:new r(this.oldHasFocus,t.hasFocus)}},w1=class r{kind=2;_oldScrollWidth;_oldScrollLeft;_oldScrollHeight;_oldScrollTop;scrollWidth;scrollLeft;scrollHeight;scrollTop;scrollWidthChanged;scrollLeftChanged;scrollHeightChanged;scrollTopChanged;constructor(t,e,i,n,o,s,a,l){this._oldScrollWidth=t,this._oldScrollLeft=e,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=o,this.scrollLeft=s,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(t){return t.kind!==this.kind?null:new r(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,t.scrollWidth,t.scrollLeft,t.scrollHeight,t.scrollTop)}},E1=class{kind=3;constructor(){}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}},T1=class{kind=4;constructor(){}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}},x1=class r{kind=6;oldSelections;selections;oldModelVersionId;modelVersionId;source;reason;reachedMaxCursorCount;constructor(t,e,i,n,o,s,a){this.oldSelections=t,this.selections=e,this.oldModelVersionId=i,this.modelVersionId=n,this.source=o,this.reason=s,this.reachedMaxCursorCount=a}static _selectionsAreEqual(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;let i=t.length,n=e.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!t[o].equalsSelection(e[o]))return!1;return!0}isNoOp(){return r._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(t){return t.kind!==this.kind?null:new r(this.oldSelections,t.selections,this.oldModelVersionId,t.modelVersionId,t.source,t.reason,this.reachedMaxCursorCount||t.reachedMaxCursorCount)}},_1=class{kind=5;constructor(){}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}},D1=class{constructor(t){this.event=t}kind=7;isNoOp(){return!1}attemptToMerge(t){return null}},L1=class{constructor(t){this.event=t}kind=8;isNoOp(){return!1}attemptToMerge(t){return null}},k1=class{constructor(t){this.event=t}kind=9;isNoOp(){return!1}attemptToMerge(t){return null}},R1=class{constructor(t){this.event=t}kind=10;isNoOp(){return!1}attemptToMerge(t){return null}},A1=class{constructor(t){this.event=t}kind=11;isNoOp(){return!1}attemptToMerge(t){return null}},P1=class{constructor(t){this.event=t}kind=12;isNoOp(){return!1}attemptToMerge(t){return null}};var M1=class extends L{_model;_knownModelVersionId;_viewModel;_coordinatesConverter;context;_cursors;_hasFocus;_isHandling;_compositionState;_columnSelectData;_autoClosedActions;_prevEditOperationType;constructor(t,e,i,n){super(),this._model=t,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=e,this._coordinatesConverter=i,this.context=new Nx(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new Bx(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=nt(this._autoClosedActions),super.dispose()}updateConfiguration(t){this.context=new Nx(this._model,this._viewModel,this._coordinatesConverter,t),this._cursors.updateContext(this.context)}onLineMappingChanged(t){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(t,"viewModel",0,this.getCursorStates())}setHasFocus(t){this._hasFocus=t}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let t=this._cursors.getSelections();for(let e=0;e<this._autoClosedActions.length;e++){let i=this._autoClosedActions[e];i.isValid(t)||(i.dispose(),this._autoClosedActions.splice(e,1),e--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(t,e,i,n){let o=!1,s=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>s&&(n=n.slice(0,s),o=!0);let a=Vx.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,e,i,a,o)}setCursorColumnSelectData(t){this._columnSelectData=t}revealAll(t,e,i,n,o,s){let a=this._cursors.getViewPositions(),l=null,d=null;a.length>1?d=this._cursors.getViewSelections():l=F.fromPositions(a[0],a[0]),t.emitViewEvent(new Up(e,i,l,d,n,o,s))}revealPrimary(t,e,i,n,o,s){let l=[this._cursors.getPrimaryCursor().viewState.selection];t.emitViewEvent(new Up(e,i,null,l,n,o,s))}saveState(){let t=[],e=this._cursors.getSelections();for(let i=0,n=e.length;i<n;i++){let o=e[i];t.push({inSelectionMode:!o.isEmpty(),selectionStart:{lineNumber:o.selectionStartLineNumber,column:o.selectionStartColumn},position:{lineNumber:o.positionLineNumber,column:o.positionColumn}})}return t}restoreState(t,e){let i=[];for(let n=0,o=e.length;n<o;n++){let s=e[n],a=1,l=1;s.position&&s.position.lineNumber&&(a=s.position.lineNumber),s.position&&s.position.column&&(l=s.position.column);let d=a,c=l;s.selectionStart&&s.selectionStart.lineNumber&&(d=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(c=s.selectionStart.column),i.push({selectionStartLineNumber:d,selectionStartColumn:c,positionLineNumber:a,positionColumn:l})}this.setStates(t,"restoreState",0,Rt.fromModelSelections(i)),this.revealAll(t,"restoreState",!1,0,!0,1)}onModelContentChanged(t,e){if(e instanceof ay){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(t,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{let i=e.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;let n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new Bx(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){let o=Rt.fromModelSelections(i.resultingSelection);this.setStates(t,"modelChange",i.isUndoing?5:i.isRedoing?6:2,o)&&this.revealAll(t,"modelChange",!1,0,!0,0)}else{let o=this._cursors.readSelectionFromMarkers();this.setStates(t,"modelChange",2,Rt.fromModelSelections(o))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;let t=this._cursors.getPrimaryCursor(),e=t.viewState.selectionStart.getStartPosition(),i=t.viewState.position;return{isReal:!1,fromViewLineNumber:e.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,e),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(t,e,i,n){this.setStates(t,e,n,Rt.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(t){this._prevEditOperationType=t}_pushAutoClosedAction(t,e){let i=[],n=[];for(let a=0,l=t.length;a<l;a++)i.push({range:t[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:e[a],options:{description:"auto-closed-enclosing",stickiness:1}});let o=this._model.deltaDecorations([],i),s=this._model.deltaDecorations([],n);this._autoClosedActions.push(new O1(this._model,o,s))}_executeEditOperation(t){if(!t)return;t.shouldPushStackElementBefore&&this._model.pushStackElement();let e=t8.executeCommands(this._model,this._cursors.getSelections(),t.commands);if(e){this._interpretCommandResult(e);let i=[],n=[];for(let o=0;o<t.commands.length;o++){let s=t.commands[o];s instanceof gC&&s.enclosingRange&&s.closeCharacterRange&&(i.push(s.closeCharacterRange),n.push(s.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,n),this._prevEditOperationType=t.type}t.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(t){(!t||t.length===0)&&(t=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(t),this._cursors.normalize()}_emitStateChangedIfNecessary(t,e,i,n,o){let s=Vx.from(this._model,this);if(s.equals(n))return!1;let a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(t.emitViewEvent(new $M(l,a,i)),!n||n.cursorState.length!==s.cursorState.length||s.cursorState.some((d,c)=>!d.modelState.equals(n.cursorState[c].modelState))){let d=n?n.cursorState.map(u=>u.modelState.selection):null,c=n?n.modelVersionId:0;t.emitOutgoingEvent(new x1(d,a,c,s.modelVersionId,e||"keyboard",i,o))}return!0}_findAutoClosingPairs(t){if(!t.length)return null;let e=[];for(let i=0,n=t.length;i<n;i++){let o=t[i];if(!o.text||o.text.indexOf(`
`)>=0)return null;let s=o.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!s)return null;let a=s[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;let d=l[0].open,c=o.text.length-s[2].length-1,u=o.text.lastIndexOf(d,c-1);if(u===-1)return null;e.push([u,c])}return e}executeEdits(t,e,i,n){let o=null;e==="snippet"&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);let s=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,d=>{if(o)for(let u=0,p=o.length;u<p;u++){let[m,g]=o[u],f=d[u],b=f.range.startLineNumber,y=f.range.startColumn-1+m,I=f.range.startColumn-1+g;s.push(new F(b,I+1,b,I+2)),a.push(new F(b,y+1,b,I+2))}let c=n(d);return c&&(this._isHandling=!0),c});l&&(this._isHandling=!1,this.setSelections(t,e,l,0)),s.length>0&&this._pushAutoClosedAction(s,a)}_executeEdit(t,e,i,n=0){if(this.context.cursorConfig.readOnly)return;let o=Vx.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),t()}catch(s){Ke(s)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,i,n,o,!1)&&this.revealAll(e,i,!1,0,!0,0)}getAutoClosedCharacters(){return O1.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(t){this._compositionState=new n8(this._model,this.getSelections())}endComposition(t,e){let i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{e==="keyboard"&&this._executeEditOperation(Jd.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},t,e)}type(t,e,i){this._executeEdit(()=>{if(i==="keyboard"){let n=e.length,o=0;for(;o<n;){let s=tw(e,o),a=e.substr(o,s);this._executeEditOperation(Jd.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),o+=s}}else this._executeEditOperation(Jd.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),e))},t,i)}compositionType(t,e,i,n,o,s){if(e.length===0&&i===0&&n===0){if(o!==0){let a=this.getSelections().map(l=>{let d=l.getPosition();return new It(d.lineNumber,d.column+o,d.lineNumber,d.column+o)});this.setSelections(t,s,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Jd.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),e,i,n,o))},t,s)}paste(t,e,i,n,o){this._executeEdit(()=>{this._executeEditOperation(Jd.paste(this.context.cursorConfig,this._model,this.getSelections(),e,i,n||[]))},t,o,4)}cut(t,e){this._executeEdit(()=>{this._executeEditOperation(Xp.cut(this.context.cursorConfig,this._model,this.getSelections()))},t,e)}executeCommand(t,e,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new fo(0,[e],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},t,i)}executeCommands(t,e,i){this._executeEdit(()=>{this._executeEditOperation(new fo(0,e,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},t,i)}},Vx=class r{constructor(t,e){this.modelVersionId=t;this.cursorState=e}static from(t,e){return new r(t.getVersionId(),e.getCursorStates())}equals(t){if(!t||this.modelVersionId!==t.modelVersionId||this.cursorState.length!==t.cursorState.length)return!1;for(let e=0,i=this.cursorState.length;e<i;e++)if(!this.cursorState[e].equals(t.cursorState[e]))return!1;return!0}},O1=class{static getAllAutoClosedCharacters(t){let e=[];for(let i of t)e=e.concat(i.getAutoClosedCharactersRanges());return e}_model;_autoClosedCharactersDecorations;_autoClosedEnclosingDecorations;constructor(t,e,i){this._model=t,this._autoClosedCharactersDecorations=e,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let t=[];for(let e=0;e<this._autoClosedCharactersDecorations.length;e++){let i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[e]);i&&t.push(i)}return t}isValid(t){let e=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){let n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(e.push(n),n.startLineNumber!==n.endLineNumber))return!1}e.sort(F.compareRangesUsingStarts),t.sort(F.compareRangesUsingStarts);for(let i=0;i<t.length;i++)if(i>=e.length||!e[i].strictContainsRange(t[i]))return!1;return!0}},t8=class{static executeCommands(t,e,i){let n={model:t,selectionsBefore:e,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(n,i);for(let s=0,a=n.trackedRanges.length;s<a;s++)n.model._setTrackedRange(n.trackedRanges[s],null,0);return o}static _innerExecuteCommands(t,e){if(this._arrayIsEmpty(e))return null;let i=this._getEditOperations(t,e);if(i.operations.length===0)return null;let n=i.operations,o=this._getLoserCursorMap(n);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let s=[];for(let d=0,c=n.length;d<c;d++)o.hasOwnProperty(n[d].identifier.major.toString())||s.push(n[d]);i.hadTrackedEditOperation&&s.length>0&&(s[0]._isTracked=!0);let a=t.model.pushEditOperations(t.selectionsBefore,s,d=>{let c=[];for(let m=0;m<t.selectionsBefore.length;m++)c[m]=[];for(let m of d)m.identifier&&c[m.identifier.major].push(m);let u=(m,g)=>m.identifier.minor-g.identifier.minor,p=[];for(let m=0;m<t.selectionsBefore.length;m++)c[m].length>0?(c[m].sort(u),p[m]=e[m].computeCursorState(t.model,{getInverseEditOperations:()=>c[m],getTrackedSelection:g=>{let f=parseInt(g,10),b=t.model._getTrackedRange(t.trackedRanges[f]);return t.trackedRangesDirection[f]===0?new It(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn):new It(b.endLineNumber,b.endColumn,b.startLineNumber,b.startColumn)}})):p[m]=t.selectionsBefore[m];return p});a||(a=t.selectionsBefore);let l=[];for(let d in o)o.hasOwnProperty(d)&&l.push(parseInt(d,10));l.sort((d,c)=>c-d);for(let d of l)a.splice(d,1);return a}static _arrayIsEmpty(t){for(let e=0,i=t.length;e<i;e++)if(t[e])return!1;return!0}static _getEditOperations(t,e){let i=[],n=!1;for(let o=0,s=e.length;o<s;o++){let a=e[o];if(a){let l=this._getEditOperationsFromCommand(t,o,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(t,e,i){let n=[],o=0,s=(u,p,m=!1)=>{F.isEmpty(u)&&p===""||n.push({identifier:{major:e,minor:o++},range:u,text:p,forceMoveMarkers:m,isAutoWhitespaceEdit:i.insertsAutoWhitespace})},a=!1,c={addEditOperation:s,addTrackedEditOperation:(u,p,m)=>{a=!0,s(u,p,m)},trackSelection:(u,p)=>{let m=It.liftSelection(u),g;if(m.isEmpty())if(typeof p=="boolean")p?g=2:g=3;else{let y=t.model.getLineMaxColumn(m.startLineNumber);m.startColumn===y?g=2:g=3}else g=1;let f=t.trackedRanges.length,b=t.model._setTrackedRange(null,m,g);return t.trackedRanges[f]=b,t.trackedRangesDirection[f]=m.getDirection(),f.toString()}};try{i.getEditOperations(t.model,c)}catch(u){return Ke(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(t){t=t.slice(0),t.sort((i,n)=>-F.compareRangesUsingEnds(i.range,n.range));let e={};for(let i=1;i<t.length;i++){let n=t[i-1],o=t[i];if(F.getStartPosition(n.range).isBefore(F.getEndPosition(o.range))){let s;n.identifier.major>o.identifier.major?s=n.identifier.major:s=o.identifier.major,e[s.toString()]=!0;for(let a=0;a<t.length;a++)t[a].identifier.major===s&&(t.splice(a,1),a<i&&i--,a--);i>0&&i--}}return e}},i8=class{constructor(t,e,i){this.text=t;this.startSelection=e;this.endSelection=i}},n8=class r{_original;static _capture(t,e){let i=[];for(let n of e){if(n.startLineNumber!==n.endLineNumber)return null;i.push(new i8(t.getLineContent(n.startLineNumber),n.startColumn-1,n.endColumn-1))}return i}constructor(t,e){this._original=r._capture(t,e)}deduceOutcome(t,e){if(!this._original)return null;let i=r._capture(t,e);if(!i||this._original.length!==i.length)return null;let n=[];for(let o=0,s=this._original.length;o<s;o++)n.push(r._deduceOutcome(this._original[o],i[o]));return n}static _deduceOutcome(t,e){let i=Math.min(t.startSelection,e.startSelection,JS(t.text,e.text)),n=Math.min(t.text.length-t.endSelection,e.text.length-e.endSelection,ew(t.text,e.text)),o=t.text.substring(i,t.text.length-n),s=e.text.substring(i,e.text.length-n);return new DO(o,t.startSelection-i,t.endSelection-i,s,e.startSelection-i,e.endSelection-i)}};function Dee(r,t,e,i,n,o,s){let a="<div>",l=i,d=0,c=!0;for(let u=0,p=t.getCount();u<p;u++){let m=t.getEndOffset(u);if(m<=i)continue;let g="";for(;l<m&&l<n;l++){let f=r.charCodeAt(l);switch(f){case 9:{let b=o-(l+d)%o;for(d+=b-1;b>0;)s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0),b--;break}case 60:g+="&lt;",c=!1;break;case 62:g+="&gt;",c=!1;break;case 38:g+="&amp;",c=!1;break;case 0:g+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:g+="\uFFFD",c=!1;break;case 13:g+="&#8203",c=!1;break;case 32:s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0);break;default:g+=String.fromCharCode(f),c=!1}}if(a+=`<span style="${t.getInlineStyle(u,e)}">${g}</span>`,m>n||l>=n)break}return a+="</div>",a}var o8=class{_hasPending;_inserts;_changes;_removes;constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(t){this._hasPending=!0,this._inserts.push(t)}change(t){this._hasPending=!0,this._changes.push(t)}remove(t){this._hasPending=!0,this._removes.push(t)}mustCommit(){return this._hasPending}commit(t){if(!this._hasPending)return;let e=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],t._commitPendingChanges(e,i,n)}},r8=class{id;afterLineNumber;ordinal;height;minWidth;prefixSum;constructor(t,e,i,n,o){this.id=t,this.afterLineNumber=e,this.ordinal=i,this.height=n,this.minWidth=o,this.prefixSum=0}},N1=class r{static INSTANCE_COUNT=0;_instanceId;_pendingChanges;_lastWhitespaceId;_arr;_prefixSumValidIndex;_minWidth;_lineCount;_lineHeight;_paddingTop;_paddingBottom;constructor(t,e,i,n){this._instanceId=gD(++r.INSTANCE_COUNT),this._pendingChanges=new o8,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=t,this._lineHeight=e,this._paddingTop=i,this._paddingBottom=n}static findInsertionIndex(t,e,i){let n=0,o=t.length;for(;n<o;){let s=n+o>>>1;e===t[s].afterLineNumber?i<t[s].ordinal?o=s:n=s+1:e<t[s].afterLineNumber?o=s:n=s+1}return n}setLineHeight(t){this._checkPendingChanges(),this._lineHeight=t}setPadding(t,e){this._paddingTop=t,this._paddingBottom=e}onFlushed(t){this._checkPendingChanges(),this._lineCount=t}changeWhitespace(t){let e=!1;try{t({insertWhitespace:(n,o,s,a)=>{e=!0,n=n|0,o=o|0,s=s|0,a=a|0;let l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new r8(l,n,o,s,a)),l},changeOneWhitespace:(n,o,s)=>{e=!0,o=o|0,s=s|0,this._pendingChanges.change({id:n,newAfterLineNumber:o,newHeight:s})},removeWhitespace:n=>{e=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return e}_commitPendingChanges(t,e,i){if((t.length>0||i.length>0)&&(this._minWidth=-1),t.length+e.length+i.length<=1){for(let l of t)this._insertWhitespace(l);for(let l of e)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(let l of i){let d=this._findWhitespaceIndex(l.id);d!==-1&&this._removeWhitespace(d)}return}let n=new Set;for(let l of i)n.add(l.id);let o=new Map;for(let l of e)o.set(l.id,l);let s=l=>{let d=[];for(let c of l)if(!n.has(c.id)){if(o.has(c.id)){let u=o.get(c.id);c.afterLineNumber=u.newAfterLineNumber,c.height=u.newHeight}d.push(c)}return d},a=s(this._arr).concat(s(t));a.sort((l,d)=>l.afterLineNumber===d.afterLineNumber?l.ordinal-d.ordinal:l.afterLineNumber-d.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(t){let e=r.findInsertionIndex(this._arr,t.afterLineNumber,t.ordinal);this._arr.splice(e,0,t),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}_findWhitespaceIndex(t){let e=this._arr;for(let i=0,n=e.length;i<n;i++)if(e[i].id===t)return i;return-1}_changeOneWhitespace(t,e,i){let n=this._findWhitespaceIndex(t);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==e)){let o=this._arr[n];this._removeWhitespace(n),o.afterLineNumber=e,this._insertWhitespace(o)}}_removeWhitespace(t){this._arr.splice(t,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}onLinesDeleted(t,e){this._checkPendingChanges(),t=t|0,e=e|0,this._lineCount-=e-t+1;for(let i=0,n=this._arr.length;i<n;i++){let o=this._arr[i].afterLineNumber;t<=o&&o<=e?this._arr[i].afterLineNumber=t-1:o>e&&(this._arr[i].afterLineNumber-=e-t+1)}}onLinesInserted(t,e){this._checkPendingChanges(),t=t|0,e=e|0,this._lineCount+=e-t+1;for(let i=0,n=this._arr.length;i<n;i++){let o=this._arr[i].afterLineNumber;t<=o&&(this._arr[i].afterLineNumber+=e-t+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(t){this._checkPendingChanges(),t=t|0;let e=Math.max(0,this._prefixSumValidIndex+1);e===0&&(this._arr[0].prefixSum=this._arr[0].height,e++);for(let i=e;i<=t;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,t),this._arr[t].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();let t=this._lineHeight*this._lineCount,e=this.getWhitespacesTotalHeight();return t+e+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(t){this._checkPendingChanges(),t=t|0;let e=this._findLastWhitespaceBeforeLineNumber(t);return e===-1?0:this.getWhitespacesAccumulatedHeight(e)}_findLastWhitespaceBeforeLineNumber(t){t=t|0;let e=this._arr,i=0,n=e.length-1;for(;i<=n;){let s=(n-i|0)/2|0,a=i+s|0;if(e[a].afterLineNumber<t){if(a+1>=e.length||e[a+1].afterLineNumber>=t)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(t){t=t|0;let i=this._findLastWhitespaceBeforeLineNumber(t)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(t){return this._checkPendingChanges(),t=t|0,this._findFirstWhitespaceAfterLineNumber(t)}getVerticalOffsetForLineNumber(t,e=!1){this._checkPendingChanges(),t=t|0;let i;t>1?i=this._lineHeight*(t-1):i=0;let n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(t-(e?1:0));return i+n+this._paddingTop}getVerticalOffsetAfterLineNumber(t,e=!1){this._checkPendingChanges(),t=t|0;let i=this._lineHeight*t,n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(t+(e?1:0));return i+n+this._paddingTop}hasWhitespace(){return this._checkPendingChanges(),this.getWhitespacesCount()>0}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let t=0;for(let e=0,i=this._arr.length;e<i;e++)t=Math.max(t,this._arr[e].minWidth);this._minWidth=t}return this._minWidth}isAfterLines(t){this._checkPendingChanges();let e=this.getLinesTotalHeight();return t>e}isInTopPadding(t){return this._paddingTop===0?!1:(this._checkPendingChanges(),t<this._paddingTop)}isInBottomPadding(t){if(this._paddingBottom===0)return!1;this._checkPendingChanges();let e=this.getLinesTotalHeight();return t>=e-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(t){if(this._checkPendingChanges(),t=t|0,t<0)return 1;let e=this._lineCount|0,i=this._lineHeight,n=1,o=e;for(;n<o;){let s=(n+o)/2|0,a=this.getVerticalOffsetForLineNumber(s)|0;if(t>=a+i)n=s+1;else{if(t>=a)return s;o=s}}return n>e?e:n}getLinesViewportData(t,e){this._checkPendingChanges(),t=t|0,e=e|0;let i=this._lineHeight,n=this.getLineNumberAtOrAfterVerticalOffset(t)|0,o=this.getVerticalOffsetForLineNumber(n)|0,s=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(n)|0,l=this.getWhitespacesCount()|0,d,c;a===-1?(a=l,c=s+1,d=0):(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);let u=o,p=u,m=5e5,g=0;o>=m&&(g=Math.floor(o/m)*m,g=Math.floor(g/i)*i,p-=g);let f=[],b=t+(e-t)/2,y=-1;for(let w=n;w<=s;w++){if(y===-1){let D=u,k=u+i;(D<=b&&b<k||D>b)&&(y=w)}for(u+=i,f[w-n]=p,p+=i;c===w;)p+=d,u+=d,a++,a>=l?c=s+1:(c=this.getAfterLineNumberForWhitespaceIndex(a)|0,d=this.getHeightForWhitespaceIndex(a)|0);if(u>=e){s=w;break}}y===-1&&(y=s);let I=this.getVerticalOffsetForLineNumber(s)|0,E=n,S=s;return E<S&&o<t&&E++,E<S&&I+i>e&&S--,{bigNumbersDelta:g,startLineNumber:n,endLineNumber:s,relativeVerticalOffset:f,centeredLineNumber:y,completelyVisibleStartLineNumber:E,completelyVisibleEndLineNumber:S,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(t){this._checkPendingChanges(),t=t|0;let e=this.getAfterLineNumberForWhitespaceIndex(t),i;e>=1?i=this._lineHeight*e:i=0;let n;return t>0?n=this.getWhitespacesAccumulatedHeight(t-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(t){this._checkPendingChanges(),t=t|0;let e=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;let n=this.getVerticalOffsetForWhitespaceIndex(i),o=this.getHeightForWhitespaceIndex(i);if(t>=n+o)return-1;for(;e<i;){let s=Math.floor((e+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(t>=a+l)e=s+1;else{if(t>=a)return s;i=s}}return e}getWhitespaceAtVerticalOffset(t){this._checkPendingChanges(),t=t|0;let e=this.getWhitespaceIndexAtOrAfterVerticallOffset(t);if(e<0||e>=this.getWhitespacesCount())return null;let i=this.getVerticalOffsetForWhitespaceIndex(e);if(i>t)return null;let n=this.getHeightForWhitespaceIndex(e),o=this.getIdForWhitespaceIndex(e),s=this.getAfterLineNumberForWhitespaceIndex(e);return{id:o,afterLineNumber:s,verticalOffset:i,height:n}}getWhitespaceViewportData(t,e){this._checkPendingChanges(),t=t|0,e=e|0;let i=this.getWhitespaceIndexAtOrAfterVerticallOffset(t),n=this.getWhitespacesCount()-1;if(i<0)return[];let o=[];for(let s=i;s<=n;s++){let a=this.getVerticalOffsetForWhitespaceIndex(s),l=this.getHeightForWhitespaceIndex(s);if(a>=e)break;o.push({id:this.getIdForWhitespaceIndex(s),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(s),verticalOffset:a,height:l})}return o}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(t){return this._checkPendingChanges(),t=t|0,this._arr[t].id}getAfterLineNumberForWhitespaceIndex(t){return this._checkPendingChanges(),t=t|0,this._arr[t].afterLineNumber}getHeightForWhitespaceIndex(t){return this._checkPendingChanges(),t=t|0,this._arr[t].height}};var ppe=125,Ib=class{width;contentWidth;scrollWidth;height;contentHeight;scrollHeight;constructor(t,e,i,n){t=t|0,e=e|0,i=i|0,n=n|0,t<0&&(t=0),e<0&&(e=0),i<0&&(i=0),n<0&&(n=0),this.width=t,this.contentWidth=e,this.scrollWidth=Math.max(t,e),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(t){return this.width===t.width&&this.contentWidth===t.contentWidth&&this.height===t.height&&this.contentHeight===t.contentHeight}},s8=class extends L{_scrollable;_dimensions;onDidScroll;_onDidContentSizeChange=this._register(new T);onDidContentSizeChange=this._onDidContentSizeChange.event;constructor(t,e){super(),this._dimensions=new Ib(0,0,0,0),this._scrollable=this._register(new fd({forceIntegerValues:!0,smoothScrollDuration:t,scheduleAtNextAnimationFrame:e})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(t){this._scrollable.setSmoothScrollDuration(t)}validateScrollPosition(t){return this._scrollable.validateScrollPosition(t)}getScrollDimensions(){return this._dimensions}setScrollDimensions(t){if(this._dimensions.equals(t))return;let e=this._dimensions;this._dimensions=t,this._scrollable.setScrollDimensions({width:t.width,scrollWidth:t.scrollWidth,height:t.height,scrollHeight:t.scrollHeight},!0);let i=e.contentWidth!==t.contentWidth,n=e.contentHeight!==t.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new C1(e.contentWidth,e.contentHeight,t.contentWidth,t.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(t){this._scrollable.setScrollPositionNow(t)}setScrollPositionSmooth(t){this._scrollable.setScrollPositionSmooth(t)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}},F1=class extends L{_configuration;_linesLayout;_maxLineWidth;_overlayWidgetsMinWidth;_scrollable;onDidScroll;onDidContentSizeChange;constructor(t,e,i){super(),this._configuration=t;let n=this._configuration.options,o=n.get(147),s=n.get(85);this._linesLayout=new N1(e,n.get(68),s.top,s.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new s8(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Ib(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(116)?ppe:0)}onConfigurationChanged(t){let e=this._configuration.options;if(t.hasChanged(68)&&this._linesLayout.setLineHeight(e.get(68)),t.hasChanged(85)){let i=e.get(85);this._linesLayout.setPadding(i.top,i.bottom)}if(t.hasChanged(147)){let i=e.get(147),n=i.contentWidth,o=i.height,s=this._scrollable.getScrollDimensions(),a=s.contentWidth;this._scrollable.setScrollDimensions(new Ib(n,s.contentWidth,o,this._getContentHeight(n,o,a)))}else this._updateHeight();t.hasChanged(116)&&this._configureSmoothScrollDuration()}onFlushed(t){this._linesLayout.onFlushed(t)}onLinesDeleted(t,e){this._linesLayout.onLinesDeleted(t,e)}onLinesInserted(t,e){this._linesLayout.onLinesInserted(t,e)}_getHorizontalScrollbarHeight(t,e){let n=this._configuration.options.get(105);return n.horizontal===2||t>=e?0:n.horizontalScrollbarSize}_getContentHeight(t,e,i){let n=this._configuration.options,o=this._linesLayout.getLinesTotalHeight();return n.get(107)?o+=Math.max(0,e-n.get(68)-n.get(85).bottom):n.get(105).ignoreHorizontalScrollbarInContentHeight||(o+=this._getHorizontalScrollbarHeight(t,i)),o}_updateHeight(){let t=this._scrollable.getScrollDimensions(),e=t.width,i=t.height,n=t.contentWidth;this._scrollable.setScrollDimensions(new Ib(e,t.contentWidth,i,this._getContentHeight(e,i,n)))}getCurrentViewport(){let t=this._scrollable.getScrollDimensions(),e=this._scrollable.getCurrentScrollPosition();return new YT(e.scrollTop,e.scrollLeft,t.width,t.height)}getFutureViewport(){let t=this._scrollable.getScrollDimensions(),e=this._scrollable.getFutureScrollPosition();return new YT(e.scrollTop,e.scrollLeft,t.width,t.height)}_computeContentWidth(){let t=this._configuration.options,e=this._maxLineWidth,i=t.get(148),n=t.get(51),o=t.get(147);if(i.isViewportWrapping){let s=t.get(74);return e>o.contentWidth+n.typicalHalfwidthCharacterWidth&&s.enabled&&s.side==="right"?e+o.verticalScrollbarWidth:e}else{let s=t.get(106)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(e+s+o.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(t){this._maxLineWidth=t,this._updateContentWidth()}setOverlayWidgetsMinWidth(t){this._overlayWidgetsMinWidth=t,this._updateContentWidth()}_updateContentWidth(){let t=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Ib(t.width,this._computeContentWidth(),t.height,t.contentHeight)),this._updateHeight()}saveState(){let t=this._scrollable.getFutureScrollPosition(),e=t.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:e,scrollTopWithoutViewZones:e-n,scrollLeft:t.scrollLeft}}changeWhitespace(t){let e=this._linesLayout.changeWhitespace(t);return e&&this.onHeightMaybeChanged(),e}getVerticalOffsetForLineNumber(t,e=!1){return this._linesLayout.getVerticalOffsetForLineNumber(t,e)}getVerticalOffsetAfterLineNumber(t,e=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(t,e)}isAfterLines(t){return this._linesLayout.isAfterLines(t)}isInTopPadding(t){return this._linesLayout.isInTopPadding(t)}isInBottomPadding(t){return this._linesLayout.isInBottomPadding(t)}getLineNumberAtVerticalOffset(t){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t)}getWhitespaceAtVerticalOffset(t){return this._linesLayout.getWhitespaceAtVerticalOffset(t)}getLinesViewportData(){let t=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(t.top,t.top+t.height)}getLinesViewportDataAtScrollTop(t){let e=this._scrollable.getScrollDimensions();return t+e.height>e.scrollHeight&&(t=e.scrollHeight-e.height),t<0&&(t=0),this._linesLayout.getLinesViewportData(t,t+e.height)}getWhitespaceViewportData(){let t=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(t.top,t.top+t.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(t){return this._scrollable.validateScrollPosition(t)}setScrollPosition(t,e){e===1?this._scrollable.setScrollPositionNow(t):this._scrollable.setScrollPositionSmooth(t)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(t,e){let i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+t,scrollTop:i.scrollTop+e})}};function W1(r,t){return r===null?t?B1.INSTANCE:V1.INSTANCE:new l8(r,t)}var l8=class{_projectionData;_isVisible;constructor(t,e){this._projectionData=t,this._isVisible=e}isVisible(){return this._isVisible}setVisible(t){return this._isVisible=t,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(t,e,i){this._assertVisible();let n=i>0?this._projectionData.breakOffsets[i-1]:0,o=this._projectionData.breakOffsets[i],s;if(this._projectionData.injectionOffsets!==null){let a=this._projectionData.injectionOffsets.map((d,c)=>new xs(0,0,d+1,this._projectionData.injectionOptions[c],0));s=xs.applyInjectedText(t.getLineContent(e),a).substring(n,o)}else s=t.getValueInRange({startLineNumber:e,startColumn:n+1,endLineNumber:e,endColumn:o+1});return i>0&&(s=Lee(this._projectionData.wrappedTextIndentLength)+s),s}getViewLineLength(t,e,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(t,e,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(t,e,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(t,e,i){let n=new Array;return this.getViewLinesData(t,e,i,1,0,[!0],n),n[0]}getViewLinesData(t,e,i,n,o,s,a){this._assertVisible();let l=this._projectionData,d=l.injectionOffsets,c=l.injectionOptions,u=null;if(d){u=[];let m=0,g=0;for(let f=0;f<l.getOutputLineCount();f++){let b=new Array;u[f]=b;let y=f>0?l.breakOffsets[f-1]:0,I=l.breakOffsets[f];for(;g<d.length;){let E=c[g].content.length,S=d[g]+m,w=S+E;if(S>I)break;if(y<w){let D=c[g];if(D.inlineClassName){let k=f>0?l.wrappedTextIndentLength:0,R=k+Math.max(S-y,0),A=k+Math.min(w-y,I-y);R!==A&&b.push(new n0(R,A,D.inlineClassName,D.inlineClassNameAffectsLetterSpacing))}}if(w<=I)m+=E,g++;else break}}}let p;if(d){let m=[];for(let g=0;g<d.length;g++){let f=d[g],b=c[g].tokens;b?b.forEach((y,I)=>{m.push({offset:f,text:y.substring(c[g].content),tokenMetadata:I.metadata})}):m.push({offset:f,text:c[g].content,tokenMetadata:Mn.defaultTokenMetadata})}p=t.tokenization.getLineTokens(e).withInserted(m)}else p=t.tokenization.getLineTokens(e);for(let m=i;m<i+n;m++){let g=o+m-i;if(!s[g]){a[g]=null;continue}a[g]=this._getViewLineData(p,u?u[m]:null,m)}}_getViewLineData(t,e,i){this._assertVisible();let n=this._projectionData,o=i>0?n.wrappedTextIndentLength:0,s=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=t.sliceAndInflate(s,a,o),d=l.getLineContent();i>0&&(d=Lee(n.wrappedTextIndentLength)+d);let c=this._projectionData.getMinOutputOffset(i)+1,u=d.length+1,p=i+1<this.getViewLineCount(),m=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new $f(d,p,c,u,m,l,e)}getModelColumnOfViewPosition(t,e){return this._assertVisible(),this._projectionData.translateToInputOffset(t,e-1)+1}getViewPositionOfModelPosition(t,e,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(e-1,i).toPosition(t)}getViewLineNumberOfModelPosition(t,e){this._assertVisible();let i=this._projectionData.translateToOutputPosition(e-1);return t+i.outputLineIndex}normalizePosition(t,e,i){let n=e.lineNumber-t;return this._projectionData.normalizeOutputPosition(t,e.column-1,i).toPosition(n)}getInjectedTextAt(t,e){return this._projectionData.getInjectedText(t,e-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}},B1=class r{static INSTANCE=new r;constructor(){}isVisible(){return!0}setVisible(t){return t?this:V1.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(t,e,i){return t.getLineContent(e)}getViewLineLength(t,e,i){return t.getLineLength(e)}getViewLineMinColumn(t,e,i){return t.getLineMinColumn(e)}getViewLineMaxColumn(t,e,i){return t.getLineMaxColumn(e)}getViewLineData(t,e,i){let n=t.tokenization.getLineTokens(e),o=n.getLineContent();return new $f(o,!1,1,o.length+1,0,n.inflate(),null)}getViewLinesData(t,e,i,n,o,s,a){if(!s[o]){a[o]=null;return}a[o]=this.getViewLineData(t,e,0)}getModelColumnOfViewPosition(t,e){return e}getViewPositionOfModelPosition(t,e){return new U(t,e)}getViewLineNumberOfModelPosition(t,e){return t}normalizePosition(t,e,i){return e}getInjectedTextAt(t,e){return null}},V1=class r{static INSTANCE=new r;constructor(){}isVisible(){return!1}setVisible(t){return t?B1.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(t,e,i){throw new Error("Not supported")}getViewLineLength(t,e,i){throw new Error("Not supported")}getViewLineMinColumn(t,e,i){throw new Error("Not supported")}getViewLineMaxColumn(t,e,i){throw new Error("Not supported")}getViewLineData(t,e,i){throw new Error("Not supported")}getViewLinesData(t,e,i,n,o,s,a){throw new Error("Not supported")}getModelColumnOfViewPosition(t,e){throw new Error("Not supported")}getViewPositionOfModelPosition(t,e){throw new Error("Not supported")}getViewLineNumberOfModelPosition(t,e){throw new Error("Not supported")}normalizePosition(t,e,i){throw new Error("Not supported")}getInjectedTextAt(t,e){throw new Error("Not supported")}},a8=[""];function Lee(r){if(r>=a8.length)for(let t=1;t<=r;t++)a8[t]=hpe(t);return a8[r]}function hpe(r){return new Array(r+1).join(" ")}var U1=class{_values;_isValid;_validEndIndex;_prefixSum;_indexBySum;constructor(t){this._values=t,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(t){return this._ensureValid(),t===0?0:this._prefixSum[t-1]}getIndexOf(t){this._ensureValid();let e=this._indexBySum[t],i=e>0?this._prefixSum[e-1]:0;return new d8(e,t-i)}removeValues(t,e){this._values.splice(t,e),this._invalidate(t)}insertValues(t,e){this._values=pc(this._values,t,e),this._invalidate(t)}_invalidate(t){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,t-1)}_ensureValid(){if(!this._isValid){for(let t=this._validEndIndex+1,e=this._values.length;t<e;t++){let i=this._values[t],n=t>0?this._prefixSum[t-1]:0;this._prefixSum[t]=n+i;for(let o=0;o<i;o++)this._indexBySum[n+o]=t}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(t,e){this._values[t]!==e&&(this._values[t]=e,this._invalidate(t))}},d8=class{constructor(t,e){this.index=t;this.remainder=e;this.index=t,this.remainder=e}_prefixSumIndexOfResultBrand=void 0};var H1=class{_editorId;model;_validModelVersionId;_domLineBreaksComputerFactory;_monospaceLineBreaksComputerFactory;fontInfo;tabSize;wrappingColumn;wrappingIndent;wordBreak;wrappingStrategy;modelLineProjections;projectedModelLineLineCounts;hiddenAreasDecorationIds;constructor(t,e,i,n,o,s,a,l,d,c){this._editorId=t,this.model=e,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=o,this.tabSize=s,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=d,this.wordBreak=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new c8(this)}_constructLines(t,e){this.modelLineProjections=[],t&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));let i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),o=i.length,s=this.createLineBreaksComputer(),a=new Sr(xs.fromDecorations(n));for(let f=0;f<o;f++){let b=a.takeWhile(y=>y.lineNumber===f+1);s.addRequest(i[f],b,e?e[f]:null)}let l=s.finalize(),d=[],c=this.hiddenAreasDecorationIds.map(f=>this.model.getDecorationRange(f)).sort(F.compareRangesUsingStarts),u=1,p=0,m=-1,g=m+1<c.length?p+1:o+2;for(let f=0;f<o;f++){let b=f+1;b===g&&(m++,u=c[m].startLineNumber,p=c[m].endLineNumber,g=m+1<c.length?p+1:o+2);let y=b>=u&&b<=p,I=W1(l[f],!y);d[f]=I.getViewLineCount(),this.modelLineProjections[f]=I}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new U1(d)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(t=>this.model.getDecorationRange(t))}setHiddenAreas(t){let e=t.map(p=>this.model.validateRange(p)),i=mpe(e),n=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(F.compareRangesUsingStarts);if(i.length===n.length){let p=!1;for(let m=0;m<i.length;m++)if(!i[m].equalsRange(n[m])){p=!0;break}if(!p)return!1}let o=i.map(p=>({range:p,options:On.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,o);let s=i,a=1,l=0,d=-1,c=d+1<s.length?l+1:this.modelLineProjections.length+2,u=!1;for(let p=0;p<this.modelLineProjections.length;p++){let m=p+1;m===c&&(d++,a=s[d].startLineNumber,l=s[d].endLineNumber,c=d+1<s.length?l+1:this.modelLineProjections.length+2);let g=!1;if(m>=a&&m<=l?this.modelLineProjections[p].isVisible()&&(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!1),g=!0):(u=!0,this.modelLineProjections[p].isVisible()||(this.modelLineProjections[p]=this.modelLineProjections[p].setVisible(!0),g=!0)),g){let f=this.modelLineProjections[p].getViewLineCount();this.projectedModelLineLineCounts.setValue(p,f)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(t,e){return t<1||t>this.modelLineProjections.length?!1:this.modelLineProjections[t-1].isVisible()}getModelLineViewLineCount(t){return t<1||t>this.modelLineProjections.length?1:this.modelLineProjections[t-1].getViewLineCount()}setTabSize(t){return this.tabSize===t?!1:(this.tabSize=t,this._constructLines(!1,null),!0)}setWrappingSettings(t,e,i,n,o){let s=this.fontInfo.equals(t),a=this.wrappingStrategy===e,l=this.wrappingColumn===i,d=this.wrappingIndent===n,c=this.wordBreak===o;if(s&&a&&l&&d&&c)return!1;let u=s&&a&&!l&&d&&c;this.fontInfo=t,this.wrappingStrategy=e,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=o;let p=null;if(u){p=[];for(let m=0,g=this.modelLineProjections.length;m<g;m++)p[m]=this.modelLineProjections[m].getProjectionData()}return this._constructLines(!1,p),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(t,e,i){if(!t||t<=this._validModelVersionId)return null;let n=e===1?1:this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(e-1,i-e+1),this.projectedModelLineLineCounts.removeValues(e-1,i-e+1),new OI(n,o)}onModelLinesInserted(t,e,i,n){if(!t||t<=this._validModelVersionId)return null;let o=e>2&&!this.modelLineProjections[e-2].isVisible(),s=e===1?1:this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,a=0,l=[],d=[];for(let c=0,u=n.length;c<u;c++){let p=W1(n[c],!o);l.push(p);let m=p.getViewLineCount();a+=m,d[c]=m}return this.modelLineProjections=this.modelLineProjections.slice(0,e-1).concat(l).concat(this.modelLineProjections.slice(e-1)),this.projectedModelLineLineCounts.insertValues(e-1,d),new NI(s,s+a-1)}onModelLineChanged(t,e,i){if(t!==null&&t<=this._validModelVersionId)return[!1,null,null,null];let n=e-1,o=this.modelLineProjections[n].getViewLineCount(),s=this.modelLineProjections[n].isVisible(),a=W1(i,s);this.modelLineProjections[n]=a;let l=this.modelLineProjections[n].getViewLineCount(),d=!1,c=0,u=-1,p=0,m=-1,g=0,f=-1;o>l?(c=this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,u=c+l-1,g=u+1,f=g+(o-l)-1,d=!0):o<l?(c=this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,u=c+o-1,p=u+1,m=p+(l-o)-1,d=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(e-1)+1,u=c+l-1),this.projectedModelLineLineCounts.setValue(n,l);let b=c<=u?new $T(c,u-c+1):null,y=p<=m?new NI(p,m):null,I=g<=f?new OI(g,f):null;return[d,b,y,I]}acceptVersionId(t){this._validModelVersionId=t,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(t){if(t<1)return 1;let e=this.getViewLineCount();return t>e?e:t|0}getActiveIndentGuide(t,e,i){t=this._toValidViewLineNumber(t),e=this._toValidViewLineNumber(e),i=this._toValidViewLineNumber(i);let n=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),s=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,o.lineNumber,s.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),d=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:d.lineNumber,indent:a.indent}}getViewLineInfo(t){t=this._toValidViewLineNumber(t);let e=this.projectedModelLineLineCounts.getIndexOf(t-1),i=e.index,n=e.remainder;return new z1(i+1,n)}getMinColumnOfViewLine(t){return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(t){return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(t){let e=this.modelLineProjections[t.modelLineNumber-1],i=e.getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx),n=e.getModelColumnOfViewPosition(t.modelLineWrappedLineIdx,i);return new U(t.modelLineNumber,n)}getModelEndPositionOfViewLine(t){let e=this.modelLineProjections[t.modelLineNumber-1],i=e.getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx),n=e.getModelColumnOfViewPosition(t.modelLineWrappedLineIdx,i);return new U(t.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(t,e){let i=this.getViewLineInfo(t),n=this.getViewLineInfo(e),o=new Array,s=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){let d=this.modelLineProjections[l-1];if(d.isVisible()){let c=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,u=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:d.getViewLineCount();for(let p=c;p<u;p++)a.push(new z1(l,p))}if(!d.isVisible()&&s){let c=new U(l-1,this.model.getLineMaxColumn(l-1)+1),u=F.fromPositions(s,c);o.push(new K1(u,a)),a=[],s=null}else d.isVisible()&&!s&&(s=new U(l,1))}if(s){let l=F.fromPositions(s,this.getModelEndPositionOfViewLine(n));o.push(new K1(l,a))}return o}getViewLinesBracketGuides(t,e,i,n){let o=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,s=[];for(let a of this.getViewLineInfosGroupedByModelRanges(t,e)){let l=a.modelRange.startLineNumber,d=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,o,n);for(let c of a.viewLines){let p=d[c.modelLineNumber-l].map(m=>{if(m.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesAfterColumn).lineNumber>=c.modelLineWrappedLineIdx||m.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.forWrappedLinesBeforeOrAtColumn).lineNumber<c.modelLineWrappedLineIdx)return;if(!m.horizontalLine)return m;let g=-1;if(m.column!==-1){let y=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.column);if(y.lineNumber===c.modelLineWrappedLineIdx)g=y.column;else if(y.lineNumber<c.modelLineWrappedLineIdx)g=this.getMinColumnOfViewLine(c);else if(y.lineNumber>c.modelLineWrappedLineIdx)return}let f=this.convertModelPositionToViewPosition(c.modelLineNumber,m.horizontalLine.endColumn),b=this.modelLineProjections[c.modelLineNumber-1].getViewPositionOfModelPosition(0,m.horizontalLine.endColumn);return b.lineNumber===c.modelLineWrappedLineIdx?new Sl(m.visibleColumn,g,m.className,new bp(m.horizontalLine.top,f.column),-1,-1):b.lineNumber<c.modelLineWrappedLineIdx||m.visibleColumn!==-1?void 0:new Sl(m.visibleColumn,g,m.className,new bp(m.horizontalLine.top,this.getMaxColumnOfViewLine(c)),-1,-1)});s.push(p.filter(m=>!!m))}}return s}getViewLinesIndentGuides(t,e){t=this._toValidViewLineNumber(t),e=this._toValidViewLineNumber(e);let i=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),n=this.convertViewPositionToModelPosition(e,this.getViewLineMaxColumn(e)),o=[],s=[],a=[],l=i.lineNumber-1,d=n.lineNumber-1,c=null;for(let g=l;g<=d;g++){let f=this.modelLineProjections[g];if(f.isVisible()){let b=f.getViewLineNumberOfModelPosition(0,g===l?i.column:1),y=f.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),I=y-b+1,E=0;I>1&&f.getViewLineMinColumn(this.model,g+1,y)===1&&(E=b===0?1:2),s.push(I),a.push(E),c===null&&(c=new U(g+1,0))}else c!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,g)),c=null)}c!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(c.lineNumber,n.lineNumber)),c=null);let u=e-t+1,p=new Array(u),m=0;for(let g=0,f=o.length;g<f;g++){let b=o[g],y=Math.min(u-m,s[g]),I=a[g],E;I===2?E=0:I===1?E=1:E=y;for(let S=0;S<y;S++)S===E&&(b=0),p[m++]=b}return p}getViewLineContent(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineContent(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineLength(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineLength(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineMinColumn(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineMaxColumn(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLineData(t){let e=this.getViewLineInfo(t);return this.modelLineProjections[e.modelLineNumber-1].getViewLineData(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getViewLinesData(t,e,i){t=this._toValidViewLineNumber(t),e=this._toValidViewLineNumber(e);let n=this.projectedModelLineLineCounts.getIndexOf(t-1),o=t,s=n.index,a=n.remainder,l=[];for(let d=s,c=this.model.getLineCount();d<c;d++){let u=this.modelLineProjections[d];if(!u.isVisible())continue;let p=d===s?a:0,m=u.getViewLineCount()-p,g=!1;if(o+m>e&&(g=!0,m=e-o+1),u.getViewLinesData(this.model,d+1,p,m,o-t,i,l),o+=m,g)break}return l}validateViewPosition(t,e,i){t=this._toValidViewLineNumber(t);let n=this.projectedModelLineLineCounts.getIndexOf(t-1),o=n.index,s=n.remainder,a=this.modelLineProjections[o],l=a.getViewLineMinColumn(this.model,o+1,s),d=a.getViewLineMaxColumn(this.model,o+1,s);e<l&&(e=l),e>d&&(e=d);let c=a.getModelColumnOfViewPosition(s,e);return this.model.validatePosition(new U(o+1,c)).equals(i)?new U(t,e):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(t,e){let i=this.validateViewPosition(t.startLineNumber,t.startColumn,e.getStartPosition()),n=this.validateViewPosition(t.endLineNumber,t.endColumn,e.getEndPosition());return new F(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(t,e){let i=this.getViewLineInfo(t),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,e);return this.model.validatePosition(new U(i.modelLineNumber,n))}convertViewRangeToModelRange(t){let e=this.convertViewPositionToModelPosition(t.startLineNumber,t.startColumn),i=this.convertViewPositionToModelPosition(t.endLineNumber,t.endColumn);return new F(e.lineNumber,e.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(t,e,i=2,n=!1,o=!1){let s=this.model.validatePosition(new U(t,e)),a=s.lineNumber,l=s.column,d=a-1,c=!1;if(o)for(;d<this.modelLineProjections.length&&!this.modelLineProjections[d].isVisible();)d++,c=!0;else for(;d>0&&!this.modelLineProjections[d].isVisible();)d--,c=!0;if(d===0&&!this.modelLineProjections[d].isVisible())return new U(n?0:1,1);let u=1+this.projectedModelLineLineCounts.getPrefixSum(d),p;return c?o?p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,1,i):p=this.modelLineProjections[d].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(d+1),i):p=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,i),p}convertModelRangeToViewRange(t,e=0){if(t.isEmpty()){let i=this.convertModelPositionToViewPosition(t.startLineNumber,t.startColumn,e);return F.fromPositions(i)}else{let i=this.convertModelPositionToViewPosition(t.startLineNumber,t.startColumn,1),n=this.convertModelPositionToViewPosition(t.endLineNumber,t.endColumn,0);return new F(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(t,e){let i=t-1;if(this.modelLineProjections[i].isVisible()){let o=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(o,e)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;let n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(t,e,i,n,o){let s=this.convertViewPositionToModelPosition(t.startLineNumber,t.startColumn),a=this.convertViewPositionToModelPosition(t.endLineNumber,t.endColumn);if(a.lineNumber-s.lineNumber<=t.endLineNumber-t.startLineNumber)return this.model.getDecorationsInRange(new F(s.lineNumber,1,a.lineNumber,a.column),e,i,n,o);let l=[],d=s.lineNumber-1,c=a.lineNumber-1,u=null;for(let f=d;f<=c;f++)if(this.modelLineProjections[f].isVisible())u===null&&(u=new U(f+1,f===d?s.column:1));else if(u!==null){let y=this.model.getLineMaxColumn(f);l=l.concat(this.model.getDecorationsInRange(new F(u.lineNumber,u.column,f,y),e,i,n)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new F(u.lineNumber,u.column,a.lineNumber,a.column),e,i,n)),u=null),l.sort((f,b)=>{let y=F.compareRangesUsingStarts(f.range,b.range);return y===0?f.id<b.id?-1:f.id>b.id?1:0:y});let p=[],m=0,g=null;for(let f of l){let b=f.id;g!==b&&(g=b,p[m++]=f)}return p}getInjectedTextAt(t){let e=this.getViewLineInfo(t.lineNumber);return this.modelLineProjections[e.modelLineNumber-1].getInjectedTextAt(e.modelLineWrappedLineIdx,t.column)}normalizePosition(t,e){let i=this.getViewLineInfo(t.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,t,e)}getLineIndentColumn(t){let e=this.getViewLineInfo(t);return e.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(e.modelLineNumber):0}};function mpe(r){if(r.length===0)return[];let t=r.slice();t.sort(F.compareRangesUsingStarts);let e=[],i=t[0].startLineNumber,n=t[0].endLineNumber;for(let o=1,s=t.length;o<s;o++){let a=t[o];a.startLineNumber>n+1?(e.push(new F(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return e.push(new F(i,1,n,1)),e}var z1=class{constructor(t,e){this.modelLineNumber=t;this.modelLineWrappedLineIdx=e}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}},K1=class{constructor(t,e){this.modelRange=t;this.viewLines=e}},c8=class{_lines;constructor(t){this._lines=t}convertViewPositionToModelPosition(t){return this._lines.convertViewPositionToModelPosition(t.lineNumber,t.column)}convertViewRangeToModelRange(t){return this._lines.convertViewRangeToModelRange(t)}validateViewPosition(t,e){return this._lines.validateViewPosition(t.lineNumber,t.column,e)}validateViewRange(t,e){return this._lines.validateViewRange(t,e)}convertModelPositionToViewPosition(t,e,i,n){return this._lines.convertModelPositionToViewPosition(t.lineNumber,t.column,e,i,n)}convertModelRangeToViewRange(t,e){return this._lines.convertModelRangeToViewRange(t,e)}modelPositionIsVisible(t){return this._lines.modelPositionIsVisible(t.lineNumber,t.column)}getModelLineViewLineCount(t){return this._lines.getModelLineViewLineCount(t)}getViewLineNumberOfModelPosition(t,e){return this._lines.getViewLineNumberOfModelPosition(t,e)}};var G1=class{model;constructor(t){this.model=t}dispose(){}createCoordinatesConverter(){return new u8(this)}getHiddenAreas(){return[]}setHiddenAreas(t){return!1}setTabSize(t){return!1}setWrappingSettings(t,e,i,n){return!1}createLineBreaksComputer(){let t=[];return{addRequest:(e,i,n)=>{t.push(null)},finalize:()=>t}}onModelFlushed(){}onModelLinesDeleted(t,e,i){return new OI(e,i)}onModelLinesInserted(t,e,i,n){return new NI(e,i)}onModelLineChanged(t,e,i){return[!1,new $T(e,1),null,null]}acceptVersionId(t){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(t,e,i){return{startLineNumber:t,endLineNumber:t,indent:0}}getViewLinesBracketGuides(t,e,i){return new Array(e-t+1).fill([])}getViewLinesIndentGuides(t,e){let i=e-t+1,n=new Array(i);for(let o=0;o<i;o++)n[o]=0;return n}getViewLineContent(t){return this.model.getLineContent(t)}getViewLineLength(t){return this.model.getLineLength(t)}getViewLineMinColumn(t){return this.model.getLineMinColumn(t)}getViewLineMaxColumn(t){return this.model.getLineMaxColumn(t)}getViewLineData(t){let e=this.model.tokenization.getLineTokens(t),i=e.getLineContent();return new $f(i,!1,1,i.length+1,0,e.inflate(),null)}getViewLinesData(t,e,i){let n=this.model.getLineCount();t=Math.min(Math.max(1,t),n),e=Math.min(Math.max(1,e),n);let o=[];for(let s=t;s<=e;s++){let a=s-t;o[a]=i[a]?this.getViewLineData(s):null}return o}getDecorationsInRange(t,e,i,n,o){return this.model.getDecorationsInRange(t,e,i,n,o)}normalizePosition(t,e){return this.model.normalizePosition(t,e)}getLineIndentColumn(t){return this.model.getLineIndentColumn(t)}getInjectedTextAt(t){return null}},u8=class{_lines;constructor(t){this._lines=t}_validPosition(t){return this._lines.model.validatePosition(t)}_validRange(t){return this._lines.model.validateRange(t)}convertViewPositionToModelPosition(t){return this._validPosition(t)}convertViewRangeToModelRange(t){return this._validRange(t)}validateViewPosition(t,e){return this._validPosition(e)}validateViewRange(t,e){return this._validRange(e)}convertModelPositionToViewPosition(t){return this._validPosition(t)}convertModelRangeToViewRange(t){return this._validRange(t)}modelPositionIsVisible(t){let e=this._lines.model.getLineCount();return!(t.lineNumber<1||t.lineNumber>e)}modelRangeIsVisible(t){let e=this._lines.model.getLineCount();return!(t.startLineNumber<1||t.startLineNumber>e||t.endLineNumber<1||t.endLineNumber>e)}getModelLineViewLineCount(t){return 1}getViewLineNumberOfModelPosition(t,e){return t}};var q1=class{editorId;model;configuration;_linesCollection;_coordinatesConverter;_decorationsCache;_cachedModelDecorationsResolver;_cachedModelDecorationsResolverViewRange;constructor(t,e,i,n,o){this.editorId=t,this.model=e,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(t){let e=t.id,i=this._decorationsCache[e];if(!i){let n=t.range,o=t.options,s;if(o.isWholeLine){let a=this._coordinatesConverter.convertModelPositionToViewPosition(new U(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new U(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);s=new F(a.lineNumber,a.column,l.lineNumber,l.column)}else s=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new BI(s,o),this._decorationsCache[e]=i}return i}getMinimapDecorationsInRange(t){return this._getDecorationsInRange(t,!0,!1).decorations}getDecorationsViewportData(t){let e=this._cachedModelDecorationsResolver!==null;return e=e&&t.equalsRange(this._cachedModelDecorationsResolverViewRange),e||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(t,!1,!1),this._cachedModelDecorationsResolverViewRange=t),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(t,e=!1,i=!1){let n=new F(t,this._linesCollection.getViewLineMinColumn(t),t,this._linesCollection.getViewLineMaxColumn(t));return this._getDecorationsInRange(n,e,i).inlineDecorations[0]}_getDecorationsInRange(t,e,i){let n=this._linesCollection.getDecorationsInRange(t,this.editorId,Gg(this.configuration.options),e,i),o=t.startLineNumber,s=t.endLineNumber,a=[],l=0,d=[];for(let c=o;c<=s;c++)d[c-o]=[];for(let c=0,u=n.length;c<u;c++){let p=n[c],m=p.options;if(!gpe(this.model,p))continue;let g=this._getOrCreateViewModelDecoration(p),f=g.range;if(a[l++]=g,m.inlineClassName){let b=new Hp(f,m.inlineClassName,m.inlineClassNameAffectsLetterSpacing?3:0),y=Math.max(o,f.startLineNumber),I=Math.min(s,f.endLineNumber);for(let E=y;E<=I;E++)d[E-o].push(b)}if(m.beforeContentClassName&&o<=f.startLineNumber&&f.startLineNumber<=s){let b=new Hp(new F(f.startLineNumber,f.startColumn,f.startLineNumber,f.startColumn),m.beforeContentClassName,1);d[f.startLineNumber-o].push(b)}if(m.afterContentClassName&&o<=f.endLineNumber&&f.endLineNumber<=s){let b=new Hp(new F(f.endLineNumber,f.endColumn,f.endLineNumber,f.endColumn),m.afterContentClassName,2);d[f.endLineNumber-o].push(b)}}return{decorations:a,inlineDecorations:d}}};function gpe(r,t){return!(t.options.hideInCommentTokens&&fpe(r,t)||t.options.hideInStringTokens&&bpe(r,t))}function fpe(r,t){return kee(r,t.range,e=>e===1)}function bpe(r,t){return kee(r,t.range,e=>e===2)}function kee(r,t,e){for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let n=r.tokenization.getLineTokens(i),o=i===t.startLineNumber,s=i===t.endLineNumber,a=o?n.findTokenIndexAtOffset(t.startColumn-1):0;for(;a<n.getCount()&&!(s&&n.getStartOffset(a)>t.endColumn-1);){if(!e(n.getStandardTokenType(a)))return!1;a++}}return!0}var Cb=3,j1=class{lanes;persist=0;_requiredLanes=1;constructor(t){this.lanes=new Uint8Array(Math.ceil((t+1)*Cb/8))}reset(t){let e=Math.ceil((t+1)*Cb/8);this.lanes.length<e?this.lanes=new Uint8Array(e):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(t,e,i){i&&(this.persist|=1<<t-1);for(let n=e.startLineNumber;n<=e.endLineNumber;n++){let o=Cb*n+(t-1);this.lanes[o>>>3]|=1<<o%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(t){let e=[],i=Cb*t;for(let n=0;n<Cb;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&e.push(n+1),i++;return e.length?e:[2]}countAtLine(t){let e=Cb*t,i=0;for(let n=0;n<Cb;n++)(this.persist&1<<n||this.lanes[e>>>3]&1<<e%8)&&i++,e++;return i}};var vpe=!0,$1=class extends L{constructor(e,i,n,o,s,a,l,d,c,u){super();this.languageConfigurationService=l;this._themeService=d;this._attachedView=c;this._transactionalTarget=u;if(this._editorId=e,this._configuration=i,this.model=n,this._eventDispatcher=new I1,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Wp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Et(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=p8.create(this.model),this.glyphLanes=new j1(0),vpe&&this.model.isTooLargeForTokenization())this._lines=new G1(this.model);else{let p=this._configuration.options,m=p.get(51),g=p.get(141),f=p.get(148),b=p.get(140),y=p.get(131);this._lines=new H1(this._editorId,this.model,o,s,m,this.model.getOptions().tabSize,g,f.wrappingColumn,b,y)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new M1(n,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new F1(this._configuration,this.getLineCount(),a)),this._register(this.viewLayout.onDidScroll(p=>{p.scrollTopChanged&&this._handleVisibleLinesChanged(),p.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new XM(p)),this._eventDispatcher.emitOutgoingEvent(new w1(p.oldScrollWidth,p.oldScrollLeft,p.oldScrollHeight,p.oldScrollTop,p.scrollWidth,p.scrollLeft,p.scrollHeight,p.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(p=>{this._eventDispatcher.emitOutgoingEvent(p)})),this._decorations=new q1(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(p=>{try{let m=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(m,p)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(_C.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new e0)})),this._register(this._themeService.onDidColorThemeChange(p=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new QM(p))})),this._updateConfigurationViewLineCountNow()}_editorId;_configuration;model;_eventDispatcher;onEvent;cursorConfig;_updateConfigurationViewLineCount;_hasFocus;_viewportStart;_lines;coordinatesConverter;viewLayout;_cursor;_decorations;glyphLanes;dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){let e=this.viewLayout.getLinesViewportData(),i=new F(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(i)}visibleLinesStabilized(){let e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){let e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new YM(e)),this._eventDispatcher.emitOutgoingEvent(new S1(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new GM)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new qM)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){let e=new U(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),i=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new Y1(i,this._viewportStart.startLineDelta)}return new Y1(null,0)}_onConfigurationChanged(e,i){let n=this._captureStableViewport(),o=this._configuration.options,s=o.get(51),a=o.get(141),l=o.get(148),d=o.get(140),c=o.get(131);this._lines.setWrappingSettings(s,a,l.wrappingColumn,d,c)&&(e.emitViewEvent(new qf),e.emitViewEvent(new jf),e.emitViewEvent(new mu(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),i.hasChanged(93)&&(this._decorations.reset(),e.emitViewEvent(new mu(null))),i.hasChanged(100)&&(this._decorations.reset(),e.emitViewEvent(new mu(null))),e.emitViewEvent(new jM(i)),this.viewLayout.onConfigurationChanged(i),n.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Wp.shouldRecreate(i)&&(this.cursorConfig=new Wp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{let n=this._eventDispatcher.beginEmitViewEvents(),o=!1,s=!1,a=e instanceof qh?e.rawContentChangedEvent.changes:e.changes,l=e instanceof qh?e.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(let p of a)switch(p.changeType){case 4:{for(let m=0;m<p.detail.length;m++){let g=p.detail[m],f=p.injectedTexts[m];f&&(f=f.filter(b=>!b.ownerId||b.ownerId===this._editorId)),d.addRequest(g,f,null)}break}case 2:{let m=null;p.injectedText&&(m=p.injectedText.filter(g=>!g.ownerId||g.ownerId===this._editorId)),d.addRequest(p.detail,m,null);break}}let c=d.finalize(),u=new Sr(c);for(let p of a)switch(p.changeType){case 1:{this._lines.onModelFlushed(),n.emitViewEvent(new qf),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),o=!0;break}case 3:{let m=this._lines.onModelLinesDeleted(l,p.fromLineNumber,p.toLineNumber);m!==null&&(n.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber)),o=!0;break}case 4:{let m=u.takeCount(p.detail.length),g=this._lines.onModelLinesInserted(l,p.fromLineNumber,p.toLineNumber,m);g!==null&&(n.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),o=!0;break}case 2:{let m=u.dequeue(),[g,f,b,y]=this._lines.onModelLineChanged(l,p.lineNumber,m);s=g,f&&n.emitViewEvent(f),b&&(n.emitViewEvent(b),this.viewLayout.onLinesInserted(b.fromLineNumber,b.toLineNumber)),y&&(n.emitViewEvent(y),this.viewLayout.onLinesDeleted(y.fromLineNumber,y.toLineNumber));break}case 5:break}l!==null&&this._lines.acceptVersionId(l),this.viewLayout.onHeightMaybeChanged(),!o&&s&&(n.emitViewEvent(new jf),n.emitViewEvent(new mu(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}let i=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&i){let n=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(n){let o=this.coordinatesConverter.convertModelPositionToViewPosition(n.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{let n=this._eventDispatcher.beginEmitViewEvents();e instanceof qh&&n.emitOutgoingEvent(new R1(e.contentChangedEvent)),this._cursor.onModelContentChanged(n,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(e=>{let i=[];for(let n=0,o=e.ranges.length;n<o;n++){let s=e.ranges[n],a=this.coordinatesConverter.convertModelPositionToViewPosition(new U(s.fromLineNumber,1)).lineNumber,l=this.coordinatesConverter.convertModelPositionToViewPosition(new U(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;i[n]={fromLineNumber:a,toLineNumber:l}}this._eventDispatcher.emitSingleViewEvent(new JM(i)),this._eventDispatcher.emitOutgoingEvent(new P1(e))})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new ZM),this.cursorConfig=new Wp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new k1(e))})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new Wp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new L1(e))})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{let i=this._eventDispatcher.beginEmitViewEvents();i.emitViewEvent(new qf),i.emitViewEvent(new jf),i.emitViewEvent(new mu(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Wp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new A1(e))})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new mu(e)),this._eventDispatcher.emitOutgoingEvent(new D1(e))}))}hiddenAreasModel=new m8;previousHiddenAreas=[];setHiddenAreas(e,i){this.hiddenAreasModel.setHiddenAreas(i,e);let n=this.hiddenAreasModel.getMergedRanges();if(n===this.previousHiddenAreas)return;this.previousHiddenAreas=n;let o=this._captureStableViewport(),s=!1;try{let a=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(n),s&&(a.emitViewEvent(new qf),a.emitViewEvent(new jf),a.emitViewEvent(new mu(null)),this._cursor.onLineMappingChanged(a),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());let l=o.viewportStartModelPosition?.lineNumber;l&&n.some(c=>c.startLineNumber<=l&&l<=c.endLineNumber)||o.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new T1)}getVisibleRangesPlusViewportAboveBelow(){let e=this._configuration.options.get(147),i=this._configuration.options.get(68),n=Math.max(20,Math.round(e.height/i)),o=this.viewLayout.getLinesViewportData(),s=Math.max(1,o.completelyVisibleStartLineNumber-n),a=Math.min(this.getLineCount(),o.completelyVisibleEndLineNumber+n);return this._toModelVisibleRanges(new F(s,this.getLineMinColumn(s),a,this.getLineMaxColumn(a)))}getVisibleRanges(){let e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){let i=this.coordinatesConverter.convertViewRangeToModelRange(e),n=this._lines.getHiddenAreas();if(n.length===0)return[i];let o=[],s=0,a=i.startLineNumber,l=i.startColumn,d=i.endLineNumber,c=i.endColumn;for(let u=0,p=n.length;u<p;u++){let m=n[u].startLineNumber,g=n[u].endLineNumber;g<a||m>d||(a<m&&(o[s++]=new F(a,l,m-1,this.model.getLineMaxColumn(m-1))),a=g+1,l=1)}return(a<d||a===d&&l<c)&&(o[s++]=new F(a,l,d,c)),o}getCompletelyVisibleViewRange(){let e=this.viewLayout.getLinesViewportData(),i=e.completelyVisibleStartLineNumber,n=e.completelyVisibleEndLineNumber;return new F(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}getCompletelyVisibleViewRangeAtScrollTop(e){let i=this.viewLayout.getLinesViewportDataAtScrollTop(e),n=i.completelyVisibleStartLineNumber,o=i.completelyVisibleEndLineNumber;return new F(n,this.getLineMinColumn(n),o,this.getLineMaxColumn(o))}saveState(){let e=this.viewLayout.saveState(),i=e.scrollTop,n=this.viewLayout.getLineNumberAtVerticalOffset(i),o=this.coordinatesConverter.convertViewPositionToModelPosition(new U(n,this.getLineMinColumn(n))),s=this.viewLayout.getVerticalOffsetForLineNumber(n)-i;return{scrollLeft:e.scrollLeft,firstPosition:o,firstPositionDeltaTop:s}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);let i=this.model.validatePosition(e.firstPosition),n=this.coordinatesConverter.convertModelPositionToViewPosition(i),o=this.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:o}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,i,n){this._viewportStart.update(this,e)}getActiveIndentGuide(e,i,n){return this._lines.getActiveIndentGuide(e,i,n)}getLinesIndentGuides(e,i){return this._lines.getViewLinesIndentGuides(e,i)}getBracketGuidesInRangeByLine(e,i,n,o){return this._lines.getViewLinesBracketGuides(e,i,n,o)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){let i=Rn(this.getLineContent(e));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(e){let i=Ta(this.getLineContent(e));return i===-1?0:i+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewportViewLineRenderingData(e,i){let o=this._decorations.getDecorationsViewportData(e).inlineDecorations[i-e.startLineNumber];return this._getViewLineRenderingData(i,o)}getViewLineRenderingData(e){let i=this._decorations.getInlineDecorationsOnLine(e);return this._getViewLineRenderingData(e,i)}_getViewLineRenderingData(e,i){let n=this.model.mightContainRTL(),o=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),a=this._lines.getViewLineData(e);return a.inlineDecorations&&(i=[...i,...a.inlineDecorations.map(l=>l.toInlineDecoration(e))]),new gu(a.minColumn,a.maxColumn,a.content,a.continuesWithWrappedLine,n,o,a.tokens,i,s,a.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,i,n){let o=this._lines.getViewLinesData(e,i,n);return new i0(this.getTabSize(),o)}getAllOverviewRulerDecorations(e){let i=this.model.getOverviewRulerDecorations(this._editorId,Gg(this._configuration.options)),n=new h8;for(let o of i){let s=o.options,a=s.overviewRuler;if(!a)continue;let l=a.position;if(l===0)continue;let d=a.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.startLineNumber,o.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(o.range.endLineNumber,o.range.endColumn);n.accept(d,s.zIndex,c,u,l)}return n.asArray}_invalidateDecorationsColorCache(){let e=this.model.getOverviewRulerDecorations();for(let i of e)i.options.overviewRuler?.invalidateCachedColor(),i.options.minimap?.invalidateCachedColor()}getValueInRange(e,i){let n=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(n,i)}getValueLengthInRange(e,i){let n=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(n,i)}modifyPosition(e,i){let n=this.coordinatesConverter.convertViewPositionToModelPosition(e),o=this.model.modifyPosition(n,i);return this.coordinatesConverter.convertModelPositionToViewPosition(o)}deduceModelPositionRelativeToViewPosition(e,i,n){let o=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(i<0?i-=n:i+=n);let a=this.model.getOffsetAt(o)+i;return this.model.getPositionAt(a)}getPlainTextToCopy(e,i,n){let o=n?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(F.compareRangesUsingStarts);let s=!1,a=!1;for(let d of e)d.isEmpty()?s=!0:a=!0;if(!a){if(!i)return"";let d=e.map(u=>u.startLineNumber),c="";for(let u=0;u<d.length;u++)u>0&&d[u-1]===d[u]||(c+=this.model.getLineContent(d[u])+o);return c}if(s&&i){let d=[],c=0;for(let u of e){let p=u.startLineNumber;u.isEmpty()?p!==c&&d.push(this.model.getLineContent(p)):d.push(this.model.getValueInRange(u,n?2:0)),c=p}return d.length===1?d[0]:d}let l=[];for(let d of e)d.isEmpty()||l.push(this.model.getValueInRange(d,n?2:0));return l.length===1?l[0]:l}getRichTextToCopy(e,i){let n=this.model.getLanguageId();if(n===Cd||e.length!==1)return null;let o=e[0];if(o.isEmpty()){if(!i)return null;let u=o.startLineNumber;o=new F(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}let s=this._configuration.options.get(51),a=this._getColorMap(),d=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===Ss.fontFamily,c;return d?c=Ss.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${Ss.fontFamily}`),{mode:n,html:`<div style="color: ${a[1]};background-color: ${a[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(o,a)+"</div>"}}_getHTMLToCopy(e,i){let n=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn,l=this.getTabSize(),d="";for(let c=n;c<=s;c++){let u=this.model.tokenization.getLineTokens(c),p=u.getLineContent(),m=c===n?o-1:0,g=c===s?a-1:p.length;p===""?d+="<br>":d+=Dee(p,u.inflate(),i,m,g,l,rt)}return d}_getColorMap(){let e=ca.getColorMap(),i=["#000000"];if(e)for(let n=1,o=e.length;n<o;n++)i[n]=Y.Format.CSS.formatHex(e[n]);return i}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,i,n){return this._withViewEventsCollector(o=>this._cursor.setStates(o,e,i,n))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,i,n=0){this._withViewEventsCollector(o=>this._cursor.setSelections(o,e,i,n))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(i=>this._cursor.restoreState(i,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new _1);return}this._withViewEventsCollector(e)}executeEdits(e,i,n){this._executeCursorEdit(o=>this._cursor.executeEdits(o,e,i,n))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(i=>this._cursor.endComposition(i,e))}type(e,i){this._executeCursorEdit(n=>this._cursor.type(n,e,i))}compositionType(e,i,n,o,s){this._executeCursorEdit(a=>this._cursor.compositionType(a,e,i,n,o,s))}paste(e,i,n,o){this._executeCursorEdit(s=>this._cursor.paste(s,e,i,n,o))}cut(e){this._executeCursorEdit(i=>this._cursor.cut(i,e))}executeCommand(e,i){this._executeCursorEdit(n=>this._cursor.executeCommand(n,e,i))}executeCommands(e,i){this._executeCursorEdit(n=>this._cursor.executeCommands(n,e,i))}revealAllCursors(e,i,n=!1){this._withViewEventsCollector(o=>this._cursor.revealAll(o,e,n,0,i,0))}revealPrimaryCursor(e,i,n=!1){this._withViewEventsCollector(o=>this._cursor.revealPrimary(o,e,n,0,i,0))}revealTopMostCursor(e){let i=this._cursor.getTopMostViewPosition(),n=new F(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector(o=>o.emitViewEvent(new Up(e,!1,n,null,0,!0,0)))}revealBottomMostCursor(e){let i=this._cursor.getBottomMostViewPosition(),n=new F(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector(o=>o.emitViewEvent(new Up(e,!1,n,null,0,!0,0)))}revealRange(e,i,n,o,s){this._withViewEventsCollector(a=>a.emitViewEvent(new Up(e,!1,n,null,o,i,s)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new t0),this._eventDispatcher.emitOutgoingEvent(new E1))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{let i=this._eventDispatcher.beginEmitViewEvents();return e(i)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,i){return this._lines.normalizePosition(e,i)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}},p8=class r{constructor(t,e,i,n,o){this._model=t;this._viewLineNumber=e;this._isValid=i;this._modelTrackedRange=n;this._startLineDelta=o}static create(t){let e=t._setTrackedRange(null,new F(1,1,1,1),1);return new r(t,1,!1,e,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(t,e){let i=t.coordinatesConverter.convertViewPositionToModelPosition(new U(e,t.getLineMinColumn(e))),n=t.model._setTrackedRange(this._modelTrackedRange,new F(i.lineNumber,i.column,i.lineNumber,i.column),1),o=t.viewLayout.getVerticalOffsetForLineNumber(e),s=t.viewLayout.getCurrentScrollTop();this._viewLineNumber=e,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=s-o}invalidate(){this._isValid=!1}},h8=class{_asMap=Object.create(null);asArray=[];accept(t,e,i,n,o){let s=this._asMap[t];if(s){let a=s.data,l=a[a.length-3],d=a[a.length-1];if(l===o&&d+1>=i){n>d&&(a[a.length-1]=n);return}a.push(o,i,n)}else{let a=new Yf(t,e,[o,i,n]);this._asMap[t]=a,this.asArray.push(a)}}},m8=class{hiddenAreas=new Map;shouldRecompute=!1;ranges=[];setHiddenAreas(t,e){let i=this.hiddenAreas.get(t);i&&Ree(i,e)||(this.hiddenAreas.set(t,e),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;let t=Array.from(this.hiddenAreas.values()).reduce((e,i)=>ype(e,i),[]);return Ree(this.ranges,t)?this.ranges:(this.ranges=t,this.ranges)}};function ype(r,t){let e=[],i=0,n=0;for(;i<r.length&&n<t.length;){let o=r[i],s=t[n];if(o.endLineNumber<s.startLineNumber-1)e.push(r[i++]);else if(s.endLineNumber<o.startLineNumber-1)e.push(t[n++]);else{let a=Math.min(o.startLineNumber,s.startLineNumber),l=Math.max(o.endLineNumber,s.endLineNumber);e.push(new F(a,1,l,1)),i++,n++}}for(;i<r.length;)e.push(r[i++]);for(;n<t.length;)e.push(t[n++]);return e}function Ree(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(!r[e].equalsRange(t[e]))return!1;return!0}var Y1=class{constructor(t,e){this.viewportStartModelPosition=t;this.startLineDelta=e}recoverViewportStart(t,e){if(!this.viewportStartModelPosition)return;let i=t.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=e.getVerticalOffsetForLineNumber(i.lineNumber);e.setScrollPosition({scrollTop:n+this.startLineDelta},1)}};var Ul=class extends L{constructor(e,i,n,o,s,a,l,d,c,u,p,m){super();this.languageConfigurationService=p;s.willCreateCodeEditor();let g={...i};this._domElement=e,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++Ipe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=n.telemetryData,this._configuration=this._register(this._createConfiguration(n.isSimpleWidget||!1,n.contextMenuId??(n.isSimpleWidget?ee.SimpleEditorContext:ee.EditorContext),g,u)),this._register(this._configuration.onDidChange(y=>{this._onDidChangeConfiguration.fire(y);let I=this._configuration.options;if(y.hasChanged(147)){let E=I.get(147);this._onDidLayoutChange.fire(E)}})),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=a,this._themeService=d,this._register(new b8(this,this._contextKeyService)),this._register(new v8(this,this._contextKeyService,m)),this._instantiationService=this._register(o.createChild(new Wr([ke,this._contextKeyService]))),this._modelData=null,this._focusTracker=new y8(e,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let f;Array.isArray(n.contributions)?f=n.contributions:f=Xf.getEditorContributions(),this._contributions.initialize(this,f,this._instantiationService);for(let y of Xf.getEditorActions()){if(this._actions.has(y.id)){Ke(new Error(`Cannot have two actions with the same id ${y.id}`));continue}let I=new v1(y.id,y.label,y.alias,y.metadata,y.precondition??void 0,E=>this._instantiationService.invokeFunction(S=>Promise.resolve(y.runEditorCommand(S,this,E))),this._contextKeyService);this._actions.set(I.id,I)}let b=()=>!this._configuration.options.get(93)&&this._configuration.options.get(36).enabled;this._register(new ra(this._domElement,{onDragOver:y=>{if(!b())return;let I=this.getTargetAtClientPoint(y.clientX,y.clientY);I?.position&&this.showDropIndicatorAt(I.position)},onDrop:async y=>{if(!b()||(this.removeDropIndicator(),!y.dataTransfer))return;let I=this.getTargetAtClientPoint(y.clientX,y.clientY);I?.position&&this._onDropIntoEditor.fire({position:I.position,event:y})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}static dropIntoEditorDecorationOptions=On.register({description:"workbench-dnd-target",className:"dnd-target"});_deliveryQueue=q7();_contributions=this._register(new b1);_onDidDispose=this._register(new T);onDidDispose=this._onDidDispose.event;_onDidChangeModelContent=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelContent=this._onDidChangeModelContent.event;_onDidChangeModelLanguage=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguage=this._onDidChangeModelLanguage.event;_onDidChangeModelLanguageConfiguration=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event;_onDidChangeModelOptions=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelOptions=this._onDidChangeModelOptions.event;_onDidChangeModelDecorations=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelDecorations=this._onDidChangeModelDecorations.event;_onDidChangeModelTokens=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModelTokens=this._onDidChangeModelTokens.event;_onDidChangeConfiguration=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeModel=this._register(new T({deliveryQueue:this._deliveryQueue}));onWillChangeModel=this._onWillChangeModel.event;_onDidChangeModel=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeModel=this._onDidChangeModel.event;_onDidChangeCursorPosition=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeCursorPosition=this._onDidChangeCursorPosition.event;_onDidChangeCursorSelection=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeCursorSelection=this._onDidChangeCursorSelection.event;_onDidAttemptReadOnlyEdit=this._register(new Yo(this._contributions,this._deliveryQueue));onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event;_onDidLayoutChange=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidLayoutChange=this._onDidLayoutChange.event;_editorTextFocus=this._register(new Z1({deliveryQueue:this._deliveryQueue}));onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue;onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse;_editorWidgetFocus=this._register(new Z1({deliveryQueue:this._deliveryQueue}));onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue;onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse;_onWillType=this._register(new Yo(this._contributions,this._deliveryQueue));onWillType=this._onWillType.event;_onDidType=this._register(new Yo(this._contributions,this._deliveryQueue));onDidType=this._onDidType.event;_onDidCompositionStart=this._register(new Yo(this._contributions,this._deliveryQueue));onDidCompositionStart=this._onDidCompositionStart.event;_onDidCompositionEnd=this._register(new Yo(this._contributions,this._deliveryQueue));onDidCompositionEnd=this._onDidCompositionEnd.event;_onDidPaste=this._register(new Yo(this._contributions,this._deliveryQueue));onDidPaste=this._onDidPaste.event;_onMouseUp=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseUp=this._onMouseUp.event;_onMouseDown=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseDown=this._onMouseDown.event;_onMouseDrag=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseDrag=this._onMouseDrag.event;_onMouseDrop=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseDrop=this._onMouseDrop.event;_onMouseDropCanceled=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseDropCanceled=this._onMouseDropCanceled.event;_onDropIntoEditor=this._register(new Yo(this._contributions,this._deliveryQueue));onDropIntoEditor=this._onDropIntoEditor.event;_onContextMenu=this._register(new Yo(this._contributions,this._deliveryQueue));onContextMenu=this._onContextMenu.event;_onMouseMove=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseMove=this._onMouseMove.event;_onMouseLeave=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseLeave=this._onMouseLeave.event;_onMouseWheel=this._register(new Yo(this._contributions,this._deliveryQueue));onMouseWheel=this._onMouseWheel.event;_onKeyUp=this._register(new Yo(this._contributions,this._deliveryQueue));onKeyUp=this._onKeyUp.event;_onKeyDown=this._register(new Yo(this._contributions,this._deliveryQueue));onKeyDown=this._onKeyDown.event;_onDidContentSizeChange=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidContentSizeChange=this._onDidContentSizeChange.event;_onDidScrollChange=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidScrollChange=this._onDidScrollChange.event;_onDidChangeViewZones=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeViewZones=this._onDidChangeViewZones.event;_onDidChangeHiddenAreas=this._register(new T({deliveryQueue:this._deliveryQueue}));onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;_updateCounter=0;_onBeginUpdate=this._register(new T);onBeginUpdate=this._onBeginUpdate.event;_onEndUpdate=this._register(new T);onEndUpdate=this._onEndUpdate.event;get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}_telemetryData;_domElement;_overflowWidgetsDomNode;_id;_configuration;_contributionsDisposable;_actions=new Map;_modelData;_instantiationService;_contextKeyService;get contextKeyService(){return this._contextKeyService}_notificationService;_codeEditorService;_commandService;_themeService;_focusTracker;_contentWidgets;_overlayWidgets;_glyphMarginWidgets;_decorationTypeKeysToIds;_decorationTypeSubtypes;_bannerDomNode=null;_dropIntoEditorDecorations=this.createDecorationsCollection();writeScreenReaderContent(e){this._modelData?.view.writeScreenReaderContent(e)}_createConfiguration(e,i,n,o){return new AI(e,i,n,this._domElement,o)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Yg.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?pC.getWordAtPosition(this._modelData.model,this._configuration.options.get(133),this._configuration.options.get(132),e):null}getValue(e=null){if(!this._modelData)return"";let i=!!(e&&e.preserveBOM),n=0;return e&&e.lineEnding&&e.lineEnding===`
`?n=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(n=2),this._modelData.model.getValue(n,i)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){try{this._beginUpdate();let i=e;if(this._modelData===null&&i===null||this._modelData&&this._modelData.model===i)return;let n={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:i?.uri||null};this._onWillChangeModel.fire(n);let o=this.hasTextFocus(),s=this._detachModel();this._attachModel(i),o&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let e in this._decorationTypeSubtypes){let i=this._decorationTypeSubtypes[e];for(let n in i)this._removeDecorationType(e+"-"+n)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,i,n,o){let s=e.model.validatePosition({lineNumber:i,column:n}),a=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(a.lineNumber,o)}getTopForLineNumber(e,i=!1){return this._modelData?Ul._getVerticalOffsetForPosition(this._modelData,e,1,i):-1}getTopForPosition(e,i){return this._modelData?Ul._getVerticalOffsetForPosition(this._modelData,e,i,!1):-1}static _getVerticalOffsetForPosition(e,i,n,o=!1){let s=e.model.validatePosition({lineNumber:i,column:n}),a=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(a.lineNumber,o)}getBottomForLineNumber(e,i=!1){if(!this._modelData)return-1;let n=this._modelData.model.getLineMaxColumn(e);return Ul._getVerticalOffsetAfterPosition(this._modelData,e,n,i)}setHiddenAreas(e,i){this._modelData?.viewModel.setHiddenAreas(e.map(n=>F.lift(n)),i)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;let i=this._modelData.model.validatePosition(e),n=this._modelData.model.getOptions().tabSize;return Ni.visibleColumnFromColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,n)+1}getStatusbarColumn(e){if(!this._modelData)return e.column;let i=this._modelData.model.validatePosition(e),n=this._modelData.model.getOptions().tabSize;return Ni.toStatusbarColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,n)}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,i="api"){if(this._modelData){if(!U.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,i,n,o){if(!this._modelData)return;if(!F.isIRange(e))throw new Error("Invalid arguments");let s=this._modelData.model.validateRange(e),a=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",n,a,i,o)}revealLine(e,i=0){this._revealLine(e,0,i)}revealLineInCenter(e,i=0){this._revealLine(e,1,i)}revealLineInCenterIfOutsideViewport(e,i=0){this._revealLine(e,2,i)}revealLineNearTop(e,i=0){this._revealLine(e,5,i)}_revealLine(e,i,n){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new F(e,1,e,1),i,!1,n)}revealPosition(e,i=0){this._revealPosition(e,0,!0,i)}revealPositionInCenter(e,i=0){this._revealPosition(e,1,!0,i)}revealPositionInCenterIfOutsideViewport(e,i=0){this._revealPosition(e,2,!0,i)}revealPositionNearTop(e,i=0){this._revealPosition(e,5,!0,i)}_revealPosition(e,i,n,o){if(!U.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new F(e.lineNumber,e.column,e.lineNumber,e.column),i,n,o)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,i="api"){let n=It.isISelection(e),o=F.isIRange(e);if(!n&&!o)throw new Error("Invalid arguments");if(n)this._setSelectionImpl(e,i);else if(o){let s={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(s,i)}}_setSelectionImpl(e,i){if(!this._modelData)return;let n=new It(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(i,[n])}revealLines(e,i,n=0){this._revealLines(e,i,0,n)}revealLinesInCenter(e,i,n=0){this._revealLines(e,i,1,n)}revealLinesInCenterIfOutsideViewport(e,i,n=0){this._revealLines(e,i,2,n)}revealLinesNearTop(e,i,n=0){this._revealLines(e,i,5,n)}_revealLines(e,i,n,o){if(typeof e!="number"||typeof i!="number")throw new Error("Invalid arguments");this._sendRevealRange(new F(e,1,i,1),n,!1,o)}revealRange(e,i=0,n=!1,o=!0){this._revealRange(e,n?1:0,o,i)}revealRangeInCenter(e,i=0){this._revealRange(e,1,!0,i)}revealRangeInCenterIfOutsideViewport(e,i=0){this._revealRange(e,2,!0,i)}revealRangeNearTop(e,i=0){this._revealRange(e,5,!0,i)}revealRangeNearTopIfOutsideViewport(e,i=0){this._revealRange(e,6,!0,i)}revealRangeAtTop(e,i=0){this._revealRange(e,3,!0,i)}_revealRange(e,i,n,o){if(!F.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(F.lift(e),i,n,o)}setSelections(e,i="api",n=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let o=0,s=e.length;o<s;o++)if(!It.isISelection(e[o]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,e,n)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,i=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},i)}}setScrollTop(e,i=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},i)}}setScrollPosition(e,i=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,i)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;let e=this._contributions.saveViewState(),i=this._modelData.viewModel.saveCursorState(),n=this._modelData.viewModel.saveState();return{cursorState:i,viewState:n,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;let i=e;if(i&&i.cursorState&&i.viewState){let n=i.cursorState;Array.isArray(n)?n.length>0&&this._modelData.viewModel.restoreCursorState(n):this._modelData.viewModel.restoreCursorState([n]),this._contributions.restoreViewState(i.contributionsState||{});let o=this._modelData.viewModel.reduceRestoreState(i.viewState);this._modelData.view.restoreState(o)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}onVisible(){this._modelData?.view.refreshFocusState()}onHide(){this._modelData?.view.refreshFocusState(),this._focusTracker.refreshState()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(i=>i.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,i,n){n=n||{};try{switch(this._beginUpdate(),i){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{let s=n;this._type(e,s.text||"");return}case"replacePreviousChar":{let s=n;this._compositionType(e,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{let s=n;this._compositionType(e,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{let s=n;this._paste(e,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(e);return}let o=this.getAction(i);if(o){Promise.resolve(o.run(n)).then(void 0,Ke);return}if(!this._modelData||this._triggerEditorCommand(e,i,n))return;this._triggerCommand(i,n)}finally{this._endUpdate()}}_triggerCommand(e,i){this._commandService.executeCommand(e,i)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,i){!this._modelData||i.length===0||(e==="keyboard"&&this._onWillType.fire(i),this._modelData.viewModel.type(i,e),e==="keyboard"&&this._onDidType.fire(i))}_compositionType(e,i,n,o,s){this._modelData&&this._modelData.viewModel.compositionType(i,n,o,s,e)}_paste(e,i,n,o,s,a){if(!this._modelData)return;let l=this._modelData.viewModel,d=l.getSelection().getStartPosition();l.paste(i,n,o,e);let c=l.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:a,range:new F(d.lineNumber,d.column,c.lineNumber,c.column),languageId:s})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,i,n){let o=Xf.getEditorCommand(i);return o?(n=n||{},n.source=e,this._instantiationService.invokeFunction(s=>{Promise.resolve(o.runEditorCommand(s,this,n)).then(void 0,Ke)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(93)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,i,n){if(!this._modelData||this._configuration.options.get(93))return!1;let o;return n?Array.isArray(n)?o=()=>n:o=n:o=()=>null,this._modelData.viewModel.executeEdits(e,i,o),!0}executeCommand(e,i){this._modelData&&this._modelData.viewModel.executeCommand(i,e)}executeCommands(e,i){this._modelData&&this._modelData.viewModel.executeCommands(i,e)}createDecorationsCollection(e){return new I8(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,Gg(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,Gg(this._configuration.options)):null}deltaDecorations(e,i){return this._modelData?e.length===0&&i.length===0?e:this._modelData.model.deltaDecorations(e,i,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(i=>{i.deltaDecorations(e,[])})}setDecorationsByType(e,i,n){let o={},s=this._decorationTypeSubtypes[i]||{};this._decorationTypeSubtypes[i]=o;let a=[];for(let d of n){let c=i;if(d.renderOptions){let p=Xn(d.renderOptions).toString(16);c=i+"-"+p,!s[p]&&!o[p]&&this._registerDecorationType(e,c,d.renderOptions,i),o[p]=!0}let u=this._resolveDecorationOptions(c,!!d.hoverMessage);d.hoverMessage&&(u.hoverMessage=d.hoverMessage),a.push({range:d.range,options:u})}for(let d in s)o[d]||this._removeDecorationType(i+"-"+d);let l=this._decorationTypeKeysToIds[i]||[];this.changeDecorations(d=>this._decorationTypeKeysToIds[i]=d.deltaDecorations(l,a))}setDecorationsByTypeFast(e,i){let n=this._decorationTypeSubtypes[e]||{};for(let l in n)this._removeDecorationType(e+"-"+l);this._decorationTypeSubtypes[e]={};let o=On.createDynamic(this._resolveDecorationOptions(e,!1)),s=new Array(i.length);for(let l=0,d=i.length;l<d;l++)s[l]={range:i[l],options:o};let a=this._decorationTypeKeysToIds[e]||[];this.changeDecorations(l=>this._decorationTypeKeysToIds[e]=l.deltaDecorations(a,s))}removeDecorationsByType(e){let i=this._decorationTypeKeysToIds[e];i&&this.changeDecorations(n=>n.deltaDecorations(i,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(147)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,i=!1){this._configuration.observeContainer(e),i||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){let i={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(i)}layoutContentWidget(e){let i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){let n=this._contentWidgets[i];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(n)}}removeContentWidget(e){let i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){let n=this._contentWidgets[i];delete this._contentWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(n)}}addOverlayWidget(e){let i={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(i)}layoutOverlayWidget(e){let i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){let n=this._overlayWidgets[i];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(n)}}removeOverlayWidget(e){let i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){let n=this._overlayWidgets[i];delete this._overlayWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(n)}}addGlyphMarginWidget(e){let i={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(i)}layoutGlyphMarginWidget(e){let i=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){let n=this._glyphMarginWidgets[i];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(n)}}removeGlyphMarginWidget(e){let i=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){let n=this._glyphMarginWidgets[i];delete this._glyphMarginWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(n)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,i){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,i)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;let i=this._modelData.model.validatePosition(e),n=this._configuration.options,o=n.get(147),s=Ul._getVerticalOffsetForPosition(this._modelData,i.lineNumber,i.column)-this.getScrollTop(),a=this._modelData.view.getOffsetForColumn(i.lineNumber,i.column)+o.glyphMarginWidth+o.lineNumbersWidth+o.decorationsWidth-this.getScrollLeft();return{top:s,left:a,height:n.get(68)}}getOffsetForColumn(e,i){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,i)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){rn(e,this._configuration.options.get(51))}setBanner(e,i){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?i:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}let i=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());let n=e.onBeforeAttached(),o=new $1(this._id,this._configuration,e,f1.create(oe(this._domElement)),y1.create(this._configuration.options),l=>nn(oe(this._domElement),l),this.languageConfigurationService,this._themeService,n,{batchChanges:l=>{try{return this._beginUpdate(),l()}finally{this._endUpdate()}}});i.push(e.onWillDispose(()=>this.setModel(null))),i.push(o.onEvent(l=>{switch(l.kind){case 0:this._onDidContentSizeChange.fire(l);break;case 1:this._editorTextFocus.setValue(l.hasFocus);break;case 2:this._onDidScrollChange.fire(l);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(l.reachedMaxCursorCount){let p=this.getOption(81),m=h("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",p);this._notificationService.prompt(ui.Warning,m,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:h("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}let d=[];for(let p=0,m=l.selections.length;p<m;p++)d[p]=l.selections[p].getPosition();let c={position:d[0],secondaryPositions:d.slice(1),reason:l.reason,source:l.source};this._onDidChangeCursorPosition.fire(c);let u={selection:l.selections[0],secondarySelections:l.selections.slice(1),modelVersionId:l.modelVersionId,oldSelections:l.oldSelections,oldModelVersionId:l.oldModelVersionId,source:l.source,reason:l.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(l.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(l.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(l.event);break;case 10:this._onDidChangeModelContent.fire(l.event);break;case 11:this._onDidChangeModelOptions.fire(l.event);break;case 12:this._onDidChangeModelTokens.fire(l.event);break}}));let[s,a]=this._createView(o);if(a){this._domElement.appendChild(s.domNode.domNode);let l=Object.keys(this._contentWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addContentWidget(this._contentWidgets[u])}l=Object.keys(this._overlayWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addOverlayWidget(this._overlayWidgets[u])}l=Object.keys(this._glyphMarginWidgets);for(let d=0,c=l.length;d<c;d++){let u=l[d];s.addGlyphMarginWidget(this._glyphMarginWidgets[u])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new f8(e,o,s,a,i,n)}_createView(e){let i;this.isSimpleWidget?i={paste:(s,a,l,d)=>{this._paste("keyboard",s,a,l,d)},type:s=>{this._type("keyboard",s)},compositionType:(s,a,l,d)=>{this._compositionType("keyboard",s,a,l,d)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:i={paste:(s,a,l,d)=>{let c={text:s,pasteOnNewLine:a,multicursorText:l,mode:d};this._commandService.executeCommand("paste",c)},type:s=>{let a={text:s};this._commandService.executeCommand("type",a)},compositionType:(s,a,l,d)=>{if(l||d){let c={text:s,replacePrevCharCnt:a,replaceNextCharCnt:l,positionDelta:d};this._commandService.executeCommand("compositionType",c)}else{let c={text:s,replaceCharCnt:a};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};let n=new yC(e.coordinatesConverter);return n.onKeyDown=s=>this._onKeyDown.fire(s),n.onKeyUp=s=>this._onKeyUp.fire(s),n.onContextMenu=s=>this._onContextMenu.fire(s),n.onMouseMove=s=>this._onMouseMove.fire(s),n.onMouseLeave=s=>this._onMouseLeave.fire(s),n.onMouseDown=s=>this._onMouseDown.fire(s),n.onMouseUp=s=>this._onMouseUp.fire(s),n.onMouseDrag=s=>this._onMouseDrag.fire(s),n.onMouseDrop=s=>this._onMouseDrop.fire(s),n.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),n.onMouseWheel=s=>this._onMouseWheel.fire(s),[new PC(i,this._configuration,this._themeService.getColorTheme(),e,n,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;let e=this._modelData.model,i=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),i&&this._domElement.contains(i)&&i.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_registerDecorationType(e,i,n,o){this._codeEditorService.registerDecorationType(e,i,n,o,this)}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}_resolveDecorationOptions(e,i){return this._codeEditorService.resolveDecorationOptions(e,i)}getTelemetryData(){return this._telemetryData}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){let i=[{range:new F(e.lineNumber,e.column,e.lineNumber,e.column),options:Ul.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(i),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,i){this._contextKeyService.createKey(e,i)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}};Ul=_([v(3,ae),v(4,fu),v(5,ni),v(6,ke),v(7,Ze),v(8,jt),v(9,zo),v(10,fp),v(11,Tee)],Ul);var Ipe=0,f8=class{constructor(t,e,i,n,o,s){this.model=t;this.viewModel=e;this.view=i;this.hasRealView=n;this.listenersToRemove=o;this.attachedView=s}dispose(){nt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};var Z1=class extends L{constructor(e){super();this._emitterOptions=e;this._value=0}_onDidChangeToTrue=this._register(new T(this._emitterOptions));onDidChangeToTrue=this._onDidChangeToTrue.event;_onDidChangeToFalse=this._register(new T(this._emitterOptions));onDidChangeToFalse=this._onDidChangeToFalse.event;_value;setValue(e){let i=e?2:1;this._value!==i&&(this._value=i,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}},Yo=class extends T{constructor(e,i){super({deliveryQueue:i});this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}},b8=class extends L{_editor;_editorSimpleInput;_editorFocus;_textInputFocus;_editorTextFocus;_tabMovesFocus;_editorReadonly;_inDiffEditor;_editorColumnSelection;_hasMultipleSelections;_hasNonEmptySelection;_canUndo;_canRedo;constructor(t,e){super(),this._editor=t,e.createKey("editorId",t.getId()),this._editorSimpleInput=Re.editorSimpleInput.bindTo(e),this._editorFocus=Re.focus.bindTo(e),this._textInputFocus=Re.textInputFocus.bindTo(e),this._editorTextFocus=Re.editorTextFocus.bindTo(e),this._tabMovesFocus=Re.tabMovesFocus.bindTo(e),this._editorReadonly=Re.readOnly.bindTo(e),this._inDiffEditor=Re.inDiffEditor.bindTo(e),this._editorColumnSelection=Re.columnSelection.bindTo(e),this._hasMultipleSelections=Re.hasMultipleSelections.bindTo(e),this._hasNonEmptySelection=Re.hasNonEmptySelection.bindTo(e),this._canUndo=Re.canUndo.bindTo(e),this._canRedo=Re.canRedo.bindTo(e),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(RI.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){let t=this._editor.getOptions();this._tabMovesFocus.set(RI.getTabFocusMode()),this._editorReadonly.set(t.get(93)),this._inDiffEditor.set(t.get(62)),this._editorColumnSelection.set(t.get(22))}_updateFromSelection(){let t=this._editor.getSelections();t?(this._hasMultipleSelections.set(t.length>1),this._hasNonEmptySelection.set(t.some(e=>!e.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){let t=this._editor.getModel();this._canUndo.set(!!(t&&t.canUndo())),this._canRedo.set(!!(t&&t.canRedo()))}},v8=class extends L{constructor(e,i,n){super();this._editor=e;this._contextKeyService=i;this._languageFeaturesService=n;this._langId=Re.languageId.bindTo(i),this._hasCompletionItemProvider=Re.hasCompletionItemProvider.bindTo(i),this._hasCodeActionsProvider=Re.hasCodeActionsProvider.bindTo(i),this._hasCodeLensProvider=Re.hasCodeLensProvider.bindTo(i),this._hasDefinitionProvider=Re.hasDefinitionProvider.bindTo(i),this._hasDeclarationProvider=Re.hasDeclarationProvider.bindTo(i),this._hasImplementationProvider=Re.hasImplementationProvider.bindTo(i),this._hasTypeDefinitionProvider=Re.hasTypeDefinitionProvider.bindTo(i),this._hasHoverProvider=Re.hasHoverProvider.bindTo(i),this._hasDocumentHighlightProvider=Re.hasDocumentHighlightProvider.bindTo(i),this._hasDocumentSymbolProvider=Re.hasDocumentSymbolProvider.bindTo(i),this._hasReferenceProvider=Re.hasReferenceProvider.bindTo(i),this._hasRenameProvider=Re.hasRenameProvider.bindTo(i),this._hasSignatureHelpProvider=Re.hasSignatureHelpProvider.bindTo(i),this._hasInlayHintsProvider=Re.hasInlayHintsProvider.bindTo(i),this._hasDocumentFormattingProvider=Re.hasDocumentFormattingProvider.bindTo(i),this._hasDocumentSelectionFormattingProvider=Re.hasDocumentSelectionFormattingProvider.bindTo(i),this._hasMultipleDocumentFormattingProvider=Re.hasMultipleDocumentFormattingProvider.bindTo(i),this._hasMultipleDocumentSelectionFormattingProvider=Re.hasMultipleDocumentSelectionFormattingProvider.bindTo(i),this._isInEmbeddedEditor=Re.isInEmbeddedEditor.bindTo(i);let o=()=>this._update();this._register(e.onDidChangeModel(o)),this._register(e.onDidChangeModelLanguage(o)),this._register(n.completionProvider.onDidChange(o)),this._register(n.codeActionProvider.onDidChange(o)),this._register(n.codeLensProvider.onDidChange(o)),this._register(n.definitionProvider.onDidChange(o)),this._register(n.declarationProvider.onDidChange(o)),this._register(n.implementationProvider.onDidChange(o)),this._register(n.typeDefinitionProvider.onDidChange(o)),this._register(n.hoverProvider.onDidChange(o)),this._register(n.documentHighlightProvider.onDidChange(o)),this._register(n.documentSymbolProvider.onDidChange(o)),this._register(n.referenceProvider.onDidChange(o)),this._register(n.renameProvider.onDidChange(o)),this._register(n.documentFormattingEditProvider.onDidChange(o)),this._register(n.documentRangeFormattingEditProvider.onDidChange(o)),this._register(n.signatureHelpProvider.onDidChange(o)),this._register(n.inlayHintsProvider.onDidChange(o)),o()}_langId;_hasCompletionItemProvider;_hasCodeActionsProvider;_hasCodeLensProvider;_hasDefinitionProvider;_hasDeclarationProvider;_hasImplementationProvider;_hasTypeDefinitionProvider;_hasHoverProvider;_hasDocumentHighlightProvider;_hasDocumentSymbolProvider;_hasReferenceProvider;_hasRenameProvider;_hasDocumentFormattingProvider;_hasDocumentSelectionFormattingProvider;_hasMultipleDocumentFormattingProvider;_hasMultipleDocumentSelectionFormattingProvider;_hasSignatureHelpProvider;_hasInlayHintsProvider;_isInEmbeddedEditor;dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){let e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===he.walkThroughSnippet||e.uri.scheme===he.vscodeChatCodeBlock)})}},y8=class extends L{_hasDomElementFocus;_domFocusTracker;_overflowWidgetsDomNode;_onChange=this._register(new T);onChange=this._onChange.event;_overflowWidgetsDomNodeHasFocus;_hadFocus=void 0;constructor(t,e){super(),this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Un(t)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),e&&(this._overflowWidgetsDomNode=this._register(Un(e)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){let t=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==t&&(this._hadFocus=t,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}refreshState(){this._domFocusTracker.refreshState(),this._overflowWidgetsDomNode?.refreshState?.()}},I8=class{constructor(t,e){this._editor=t;Array.isArray(e)&&e.length>0&&this.set(e)}_decorationIds=[];_isChangingDecorations=!1;get length(){return this._decorationIds.length}onDidChange(t,e,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||t.call(e,n)},i)}getRange(t){return!this._editor.hasModel()||t>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[t])}getRanges(){if(!this._editor.hasModel())return[];let t=this._editor.getModel(),e=[];for(let i of this._decorationIds){let n=t.getDecorationRange(i);n&&e.push(n)}return e}has(t){return this._decorationIds.includes(t.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(t){try{this._isChangingDecorations=!0,this._editor.changeDecorations(e=>{this._decorationIds=e.deltaDecorations(this._decorationIds,t)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(t){let e=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{e=i.deltaDecorations([],t),this._decorationIds=this._decorationIds.concat(e)})}finally{this._isChangingDecorations=!1}return e}},Cpe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),Spe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function g8(r){return Cpe+encodeURIComponent(r.toString())+Spe}var wpe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),Epe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function Tpe(r){return wpe+encodeURIComponent(r.toString())+Epe}co((r,t)=>{let e=r.getColor(Mg);e&&t.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${g8(e)}") repeat-x bottom left; }`);let i=r.getColor(is);i&&t.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${g8(i)}") repeat-x bottom left; }`);let n=r.getColor(ea);n&&t.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${g8(n)}") repeat-x bottom left; }`);let o=r.getColor(U3);o&&t.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${Tpe(o)}") no-repeat bottom left; }`);let s=r.getColor(CY);s&&t.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${s.rgba.a}; }`)});function Aee(r,t,e,i){if(r.length===0)return t;if(t.length===0)return r;let n=[],o=0,s=0;for(;o<r.length&&s<t.length;){let a=r[o],l=t[s],d=e(a),c=e(l);d<c?(n.push(a),o++):d>c?(n.push(l),s++):(n.push(i(a,l)),o++,s++)}for(;o<r.length;)n.push(r[o]),o++;for(;s<t.length;)n.push(t[s]),s++;return n}function MC(r,t){let e=new W,i=r.createDecorationsCollection();return e.add(Wu({debugName:()=>`Apply decorations from ${t.debugName}`},n=>{let o=t.read(n);i.set(o)})),e.add({dispose:()=>{i.clear()}}),e}function Eb(r,t){return r.appendChild(t),te(()=>{t.remove()})}function Pee(r,t){return r.prepend(t),te(()=>{t.remove()})}var X1=class extends L{elementSizeObserver;_width;get width(){return this._width}_height;get height(){return this._height}_automaticLayout=!1;get automaticLayout(){return this._automaticLayout}constructor(t,e){super(),this.elementSizeObserver=this._register(new kI(t,e)),this._width=Kt(this,this.elementSizeObserver.getWidth()),this._height=Kt(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>Yi(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(t){this.elementSizeObserver.observe(t)}setAutomaticLayout(t){this._automaticLayout=t,t?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}};function w8(r,t,e){let i=t.get(),n=i,o=i,s=Kt("animatedValue",i),a=-1,l=300,d;e.add(ch({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(u,p)=>(u.didChange(t)&&(p.animate=p.animate||u.change),!0)},(u,p)=>{d!==void 0&&(r.cancelAnimationFrame(d),d=void 0),n=o,i=t.read(u),a=Date.now()-(p.animate?0:l),c()}));function c(){let u=Date.now()-a;o=Math.floor(xpe(u,n,i-n,l)),u<l?d=r.requestAnimationFrame(c):o=i,s.set(o,void 0)}return s}function xpe(r,t,e,i){return r===i?t+e:e*(-Math.pow(2,-10*r/i)+1)+t}var Sb=class extends L{constructor(t,e,i){super(),this._register(new C8(t,i)),this._register(tl(i,{height:e.actualHeight,top:e.actualTop}))}},Su=class{constructor(t,e){this._afterLineNumber=t;this.heightInPx=e}domNode=document.createElement("div");_actualTop=Kt(this,void 0);_actualHeight=Kt(this,void 0);actualTop=this._actualTop;actualHeight=this._actualHeight;showInHiddenAreas=!0;get afterLineNumber(){return this._afterLineNumber.get()}onChange=this._afterLineNumber;onDomNodeTop=t=>{this._actualTop.set(t,void 0)};onComputedHeight=t=>{this._actualHeight.set(t,void 0)}},C8=class r{constructor(t,e){this._editor=t;this._domElement=e;this._editor.addOverlayWidget(this._overlayWidget)}static _counter=0;_overlayWidgetId=`managedOverlayWidget-${r._counter++}`;_overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null};dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};function tl(r,t){return Ut(e=>{for(let[i,n]of Object.entries(t))n&&typeof n=="object"&&"read"in n&&(n=n.read(e)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,o=>"-"+o.toLowerCase()),r.style[i]=n})}function OC(r,t,e,i){let n=new W,o=[];return n.add(Qo((s,a)=>{let l=t.read(s),d=new Map,c=new Map;e&&e(!0),r.changeViewZones(u=>{for(let p of o)u.removeZone(p),i?.delete(p);o.length=0;for(let p of l){let m=u.addZone(p);p.setZoneId&&p.setZoneId(m),o.push(m),i?.add(m),d.set(p,m)}}),e&&e(!1),a.add(ch({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(u,p){let m=c.get(u.changedObservable);return m!==void 0&&p.zoneIds.push(m),!0}},(u,p)=>{for(let m of l)m.onChange&&(c.set(m.onChange,d.get(m)),m.onChange.read(u));e&&e(!0),r.changeViewZones(m=>{for(let g of p.zoneIds)m.layoutZone(g)}),e&&e(!1)}))})),n.add({dispose(){e&&e(!0),r.changeViewZones(s=>{for(let a of o)s.removeZone(a)}),i?.clear(),e&&e(!1)}}),n}function E8(r,t){let e=ug(t,n=>n.original.startLineNumber<=r.lineNumber);if(!e)return F.fromPositions(r);if(e.original.endLineNumberExclusive<=r.lineNumber){let n=r.lineNumber-e.original.endLineNumberExclusive+e.modified.endLineNumberExclusive;return F.fromPositions(new U(n,r.column))}if(!e.innerChanges)return F.fromPositions(new U(e.modified.startLineNumber,1));let i=ug(e.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(r));if(!i){let n=r.lineNumber-e.original.startLineNumber+e.modified.startLineNumber;return F.fromPositions(new U(n,r.column))}if(i.originalRange.containsPosition(r))return i.modifiedRange;{let n=_pe(i.originalRange.getEndPosition(),r);return F.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function _pe(r,t){return r.lineNumber===t.lineNumber?new Ts(0,t.column-r.column):new Ts(t.lineNumber-r.lineNumber,t.column-1)}function Mee(r,t){let e;return r.filter(i=>{let n=t(i,e);return e=i,n})}var wb=class{static create(t,e=void 0){return new Wx(t,t,e)}static createWithDisposable(t,e,i=void 0){let n=new W;return n.add(e),n.add(t),new Wx(t,n,i)}static createOfNonDisposable(t,e,i=void 0){return new Wx(t,e,i)}},Wx=class extends wb{constructor(e,i,n){super();this.object=e;this._disposable=i;this._debugOwner=n;n&&this._addOwner(n)}_refCount=1;_isDisposed=!1;_owners=[];_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new S8(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){let i=this._owners.indexOf(e);i!==-1&&this._owners.splice(i,1)}}},S8=class extends wb{constructor(e,i){super();this._base=e;this._debugOwner=i}_isDisposed=!1;get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}};function Tb(r){return T8.get(r)}var T8=class r extends L{constructor(e){super();this.editor=e;this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}}))}static _map=new Map;static get(e){let i=r._map.get(e);if(!i){i=new r(e),r._map.set(e,i);let n=e.onDidDispose(()=>{let o=r._map.get(e);o&&(r._map.delete(e),o.dispose(),n.dispose())})}return i}_updateCounter=0;_currentTransaction=void 0;_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new ph(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){let e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}_model=Kt(this,this.editor.getModel());model=this._model;isReadonly=Ti(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(93));_versionId=tD({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null);versionId=this._versionId;_selections=tD({owner:this,equalsFn:j_(oB(It.selectionsEqual)),lazy:!0},this.editor.getSelections()??null);selections=this._selections;positions=gc({owner:this,equalsFn:j_(oB(U.equals))},e=>this.selections.read(e)?.map(i=>i.getStartPosition())??null);isFocused=Ti(this,e=>{let i=this.editor.onDidFocusEditorWidget(e),n=this.editor.onDidBlurEditorWidget(e);return{dispose(){i.dispose(),n.dispose()}}},()=>this.editor.hasWidgetFocus());value=zb(this,e=>(this.versionId.read(e),this.model.read(e)?.getValue()??""),(e,i)=>{let n=this.model.get();n!==null&&e!==n.getValue()&&n.setValue(e)});valueIsEmpty=et(this,e=>(this.versionId.read(e),this.editor.getModel()?.getValueLength()===0));cursorSelection=gc({owner:this,equalsFn:j_(It.selectionsEqual)},e=>this.selections.read(e)?.[0]??null);cursorPosition=gc({owner:this,equalsFn:U.equals},e=>this.selections.read(e)?.[0]?.getPosition()??null);onDidType=bg(this);scrollTop=Ti(this.editor.onDidScrollChange,()=>this.editor.getScrollTop());scrollLeft=Ti(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft());layoutInfo=Ti(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo());layoutInfoContentLeft=this.layoutInfo.map(e=>e.contentLeft);layoutInfoDecorationsLeft=this.layoutInfo.map(e=>e.decorationsLeft);contentWidth=Ti(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth());getOption(e){return Ti(this,i=>this.editor.onDidChangeConfiguration(n=>{n.hasChanged(e)&&i(void 0)}),()=>this.editor.getOption(e))}setDecorations(e){let i=new W,n=this.editor.createDecorationsCollection();return i.add(Wu({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},o=>{let s=e.read(o);n.set(s)})),i.add({dispose:()=>{n.clear()}}),i}_overlayWidgetCounter=0;createOverlayWidget(e){let i="observableOverlayWidget"+this._overlayWidgetCounter++,n={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>i,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(n);let o=Ut(s=>{e.position.read(s),e.minContentWidthInPx.read(s),this.editor.layoutOverlayWidget(n)});return te(()=>{o.dispose(),this.editor.removeOverlayWidget(n)})}};var bYi=new RegExp("\\bMARK:\\s*(.*)$","d");var Oee=$("editorWorkerService");var x8=$("diffProviderFactoryService"),Ux=class{constructor(t){this.instantiationService=t}_serviceBrand;createDiffProvider(t){return this.instantiationService.createInstance(tc,t)}};Ux=_([v(0,ae)],Ux);vi(x8,Ux,1);var tc=class{constructor(t,e,i){this.editorWorkerService=e;this.telemetryService=i;this.setOptions(t)}onDidChangeEventEmitter=new T;onDidChange=this.onDidChangeEventEmitter.event;diffAlgorithm="advanced";diffAlgorithmOnDidChangeSubscription=void 0;static diffCache=new Map;dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(t,e,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(t,e,i,n);if(t.isDisposed()||e.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(t.getLineCount()===1&&t.getLineMaxColumn(1)===1)return e.getLineCount()===1&&e.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new ya(new Ye(1,2),new Ye(1,e.getLineCount()+1),[new $r(t.getFullModelRange(),e.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};let o=JSON.stringify([t.uri.toString(),e.uri.toString()]),s=JSON.stringify([t.id,e.id,t.getAlternativeVersionId(),e.getAlternativeVersionId(),JSON.stringify(i)]),a=tc.diffCache.get(o);if(a&&a.context===s)return a.result;let l=ll.create(),d=await this.editorWorkerService.computeDiff(t.uri,e.uri,i,this.diffAlgorithm),c=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:c,timedOut:d?.quitEarly??!0,detectedMoves:i.computeMoves?d?.moves.length??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!d)throw new Error("no diff result available");return tc.diffCache.size>10&&tc.diffCache.delete(tc.diffCache.keys().next().value),tc.diffCache.set(o,{result:d,context:s}),d}setOptions(t){let e=!1;t.diffAlgorithm&&this.diffAlgorithm!==t.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=t.diffAlgorithm,typeof t.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=t.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),e=!0),e&&this.onDidChangeEventEmitter.fire()}};tc=_([v(1,Oee),v(2,qt)],tc);function J1(){return zs&&!!zs.VSCODE_DEV}function _8(r){if(J1()){let t=Dpe();return t.add(r),{dispose(){t.delete(r)}}}else return{dispose(){}}}function Dpe(){Q1||(Q1=new Set);let r=globalThis;return r.$hotReload_applyNewExports||(r.$hotReload_applyNewExports=t=>{let e={config:{mode:void 0},...t},i=[];for(let n of Q1){let o=n(e);o&&i.push(o)}if(i.length>0)return n=>{let o=!1;for(let s of i)s(n)&&(o=!0);return o}}),Q1}var Q1;J1()&&_8(({oldExports:r,newSrc:t,config:e})=>{if(e.mode==="patch-prototype")return i=>{for(let n in i){let o=i[n];if(console.log(`[hot-reload] Patching prototype methods of '${n}'`,{exportedItem:o}),typeof o=="function"&&o.prototype){let s=r[n];if(s){for(let a of Object.getOwnPropertyNames(o.prototype)){let l=Object.getOwnPropertyDescriptor(o.prototype,a),d=Object.getOwnPropertyDescriptor(s.prototype,a);l?.value?.toString()!==d?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${n}.${a}'`),Object.defineProperty(s.prototype,a,l)}i[n]=s}}}return!0}});function Hl(r,t){return Lpe([r],t),r}function Lpe(r,t){J1()&&Jo("reload",i=>_8(({oldExports:n})=>{if([...Object.values(n)].some(o=>r.includes(o)))return o=>(i(void 0),!0)})).read(t)}var Eu=class r{constructor(t,e){this.diffs=t;this.hitTimeout=e}static trivial(t,e){return new r([new Nn(Xe.ofLength(t.length),Xe.ofLength(e.length))],!1)}static trivialTimedOut(t,e){return new r([new Nn(Xe.ofLength(t.length),Xe.ofLength(e.length))],!0)}},Nn=class r{constructor(t,e){this.seq1Range=t;this.seq2Range=e}static invert(t,e){let i=[];return G_(t,(n,o)=>{i.push(r.fromOffsetPairs(n?n.getEndExclusives():wu.zero,o?o.getStarts():new wu(e,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+e)))}),i}static fromOffsetPairs(t,e){return new r(new Xe(t.offset1,e.offset1),new Xe(t.offset2,e.offset2))}static assertSorted(t){let e;for(let i of t){if(e&&!(e.seq1Range.endExclusive<=i.seq1Range.start&&e.seq2Range.endExclusive<=i.seq2Range.start))throw new yt("Sequence diffs must be sorted");e=i}}swap(){return new r(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(t){return new r(this.seq1Range.join(t.seq1Range),this.seq2Range.join(t.seq2Range))}delta(t){return t===0?this:new r(this.seq1Range.delta(t),this.seq2Range.delta(t))}deltaStart(t){return t===0?this:new r(this.seq1Range.deltaStart(t),this.seq2Range.deltaStart(t))}deltaEnd(t){return t===0?this:new r(this.seq1Range.deltaEnd(t),this.seq2Range.deltaEnd(t))}intersectsOrTouches(t){return this.seq1Range.intersectsOrTouches(t.seq1Range)||this.seq2Range.intersectsOrTouches(t.seq2Range)}intersect(t){let e=this.seq1Range.intersect(t.seq1Range),i=this.seq2Range.intersect(t.seq2Range);if(!(!e||!i))return new r(e,i)}getStarts(){return new wu(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new wu(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}},wu=class r{constructor(t,e){this.offset1=t;this.offset2=e}static zero=new r(0,0);static max=new r(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);toString(){return`${this.offset1} <-> ${this.offset2}`}delta(t){return t===0?this:new r(this.offset1+t,this.offset2+t)}equals(t){return this.offset1===t.offset1&&this.offset2===t.offset2}},Zm=class r{static instance=new r;isValid(){return!0}},eN=class{constructor(t){this.timeout=t;if(t<=0)throw new yt("timeout must be positive")}startTime=Date.now();valid=!0;isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}disable(){this.timeout=Number.MAX_SAFE_INTEGER,this.isValid=()=>!0,this.valid=!0}};var NC=class{constructor(t,e){this.width=t;this.height=e;this.array=new Array(t*e)}array=[];get(t,e){return this.array[t+e*this.width]}set(t,e,i){this.array[t+e*this.width]=i}};function zx(r){return r===32||r===9}var Hx=class r{constructor(t,e,i){this.range=t;this.lines=e;this.source=i;let n=0;for(let o=t.startLineNumber-1;o<t.endLineNumberExclusive-1;o++){let s=e[o];for(let l=0;l<s.length;l++){n++;let d=s[l],c=r.getKey(d);this.histogram[c]=(this.histogram[c]||0)+1}n++;let a=r.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}static chrKeys=new Map;static getKey(t){let e=this.chrKeys.get(t);return e===void 0&&(e=this.chrKeys.size,this.chrKeys.set(t,e)),e}totalCount;histogram=[];computeSimilarity(t){let e=0,i=Math.max(this.histogram.length,t.histogram.length);for(let n=0;n<i;n++)e+=Math.abs((this.histogram[n]??0)-(t.histogram[n]??0));return 1-e/(this.totalCount+t.totalCount)}};var tN=class{compute(t,e,i=Zm.instance,n){if(t.length===0||e.length===0)return Eu.trivial(t,e);let o=new NC(t.length,e.length),s=new NC(t.length,e.length),a=new NC(t.length,e.length);for(let g=0;g<t.length;g++)for(let f=0;f<e.length;f++){if(!i.isValid())return Eu.trivialTimedOut(t,e);let b=g===0?0:o.get(g-1,f),y=f===0?0:o.get(g,f-1),I;t.getElement(g)===e.getElement(f)?(g===0||f===0?I=0:I=o.get(g-1,f-1),g>0&&f>0&&s.get(g-1,f-1)===3&&(I+=a.get(g-1,f-1)),I+=n?n(g,f):1):I=-1;let E=Math.max(b,y,I);if(E===I){let S=g>0&&f>0?a.get(g-1,f-1):0;a.set(g,f,S+1),s.set(g,f,3)}else E===b?(a.set(g,f,0),s.set(g,f,1)):E===y&&(a.set(g,f,0),s.set(g,f,2));o.set(g,f,E)}let l=[],d=t.length,c=e.length;function u(g,f){(g+1!==d||f+1!==c)&&l.push(new Nn(new Xe(g+1,d),new Xe(f+1,c))),d=g,c=f}let p=t.length-1,m=e.length-1;for(;p>=0&&m>=0;)s.get(p,m)===3?(u(p,m),p--,m--):s.get(p,m)===1?p--:m--;return u(-1,-1),l.reverse(),new Eu(l,!1)}};var FC=class{compute(t,e,i=Zm.instance){if(t.length===0||e.length===0)return Eu.trivial(t,e);let n=t,o=e;function s(f,b){for(;f<n.length&&b<o.length&&n.getElement(f)===o.getElement(b);)f++,b++;return f}let a=0,l=new D8;l.set(0,s(0,0));let d=new L8;d.set(0,l.get(0)===0?null:new iN(null,0,0,l.get(0)));let c=0;e:for(;;){if(a++,!i.isValid())return Eu.trivialTimedOut(n,o);let f=-Math.min(a,o.length+a%2),b=Math.min(a,n.length+a%2);for(c=f;c<=b;c+=2){let y=0,I=c===b?-1:l.get(c+1),E=c===f?-1:l.get(c-1)+1;y++;let S=Math.min(Math.max(I,E),n.length),w=S-c;if(y++,S>n.length||w>o.length)continue;let D=s(S,w);l.set(c,D);let k=S===I?d.get(c+1):d.get(c-1);if(d.set(c,D!==S?new iN(k,S,w,D-S):k),l.get(c)===n.length&&l.get(c)-c===o.length)break e}}let u=d.get(c),p=[],m=n.length,g=o.length;for(;;){let f=u?u.x+u.length:0,b=u?u.y+u.length:0;if((f!==m||b!==g)&&p.push(new Nn(new Xe(f,m),new Xe(b,g))),!u)break;m=u.x,g=u.y,u=u.prev}return p.reverse(),new Eu(p,!1)}},iN=class{constructor(t,e,i,n){this.prev=t;this.x=e;this.y=i;this.length=n}},D8=class{positiveArr=new Int32Array(10);negativeArr=new Int32Array(10);get(t){return t<0?(t=-t-1,this.negativeArr[t]):this.positiveArr[t]}set(t,e){if(t<0){if(t=-t-1,t>=this.negativeArr.length){let i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[t]=e}else{if(t>=this.positiveArr.length){let i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[t]=e}}},L8=class{positiveArr=[];negativeArr=[];get(t){return t<0?(t=-t-1,this.negativeArr[t]):this.positiveArr[t]}set(t,e){t<0?(t=-t-1,this.negativeArr[t]=e):this.positiveArr[t]=e}};var Xm=class{constructor(t,e,i){this.lines=t;this.range=e;this.considerWhitespaceChanges=i;this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let o=t[n-1],s=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(s=this.range.startColumn-1,o=o.substring(s)),this.lineStartOffsets.push(s);let a=0;if(!i){let d=o.trimStart();a=o.length-d.length,o=d.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);let l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-s-a,o.length):o.length;for(let d=0;d<l;d++)this.elements.push(o.charCodeAt(d));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}elements=[];firstElementOffsetByLineIdx=[];lineStartOffsets=[];trimmedWsLengthsByLineIdx=[];toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new Xe(0,this.length))}getText(t){return this.elements.slice(t.start,t.endExclusive).map(e=>String.fromCharCode(e)).join("")}getElement(t){return this.elements[t]}get length(){return this.elements.length}getBoundaryScore(t){let e=Fee(t>0?this.elements[t-1]:-1),i=Fee(t<this.elements.length?this.elements[t]:-1);if(e===7&&i===8)return 0;if(e===8)return 150;let n=0;return e!==i&&(n+=10,e===0&&i===1&&(n+=1)),n+=Nee(e),n+=Nee(i),n}translateOffset(t,e="right"){let i=Ou(this.firstElementOffsetByLineIdx,o=>o<=t),n=t-this.firstElementOffsetByLineIdx[i];return new U(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&e==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(t){let e=this.translateOffset(t.start,"right"),i=this.translateOffset(t.endExclusive,"left");return i.isBefore(e)?F.fromPositions(i,i):F.fromPositions(e,i)}findWordContaining(t){if(t<0||t>=this.elements.length||!k8(this.elements[t]))return;let e=t;for(;e>0&&k8(this.elements[e-1]);)e--;let i=t;for(;i<this.elements.length&&k8(this.elements[i]);)i++;return new Xe(e,i)}countLinesIn(t){return this.translateOffset(t.endExclusive).lineNumber-this.translateOffset(t.start).lineNumber}isStronglyEqual(t,e){return this.elements[t]===this.elements[e]}extendToFullLines(t){let e=Mu(this.firstElementOffsetByLineIdx,n=>n<=t.start)??0,i=d7(this.firstElementOffsetByLineIdx,n=>t.endExclusive<=n)??this.elements.length;return new Xe(e,i)}};function k8(r){return r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57}var kpe={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function Nee(r){return kpe[r]}function Fee(r){return r===10?8:r===13?7:zx(r)?6:r>=97&&r<=122?0:r>=65&&r<=90?1:r>=48&&r<=57?2:r===-1?3:r===44||r===59?5:4}function Vee(r,t,e,i,n,o){let{moves:s,excludedChanges:a}=Ape(r,t,e,o);if(!o.isValid())return[];let l=r.filter(c=>!a.has(c)),d=Ppe(l,i,n,t,e,o);return VS(s,d),s=Mpe(s),s=s.filter(c=>{let u=c.original.toOffsetRange().slice(t).map(m=>m.trim());return u.join(`
`).length>=15&&Rpe(u,m=>m.length>=2)>=2}),s=Ope(r,s),s}function Rpe(r,t){let e=0;for(let i of r)t(i)&&e++;return e}function Ape(r,t,e,i){let n=[],o=r.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new Hx(l.original,t,l)),s=new Set(r.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new Hx(l.modified,e,l))),a=new Set;for(let l of o){let d=-1,c;for(let u of s){let p=l.computeSimilarity(u);p>d&&(d=p,c=u)}if(d>.9&&c&&(s.delete(c),n.push(new Nr(l.range,c.range)),a.add(l.source),a.add(c.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function Ppe(r,t,e,i,n,o){let s=[],a=new Vu;for(let p of r)for(let m=p.original.startLineNumber;m<p.original.endLineNumberExclusive-2;m++){let g=`${t[m-1]}:${t[m+1-1]}:${t[m+2-1]}`;a.add(g,{range:new Ye(m,m+3)})}let l=[];r.sort(Qr(p=>p.modified.startLineNumber,hc));for(let p of r){let m=[];for(let g=p.modified.startLineNumber;g<p.modified.endLineNumberExclusive-2;g++){let f=`${e[g-1]}:${e[g+1-1]}:${e[g+2-1]}`,b=new Ye(g,g+3),y=[];a.forEach(f,({range:I})=>{for(let S of m)if(S.originalLineRange.endLineNumberExclusive+1===I.endLineNumberExclusive&&S.modifiedLineRange.endLineNumberExclusive+1===b.endLineNumberExclusive){S.originalLineRange=new Ye(S.originalLineRange.startLineNumber,I.endLineNumberExclusive),S.modifiedLineRange=new Ye(S.modifiedLineRange.startLineNumber,b.endLineNumberExclusive),y.push(S);return}let E={modifiedLineRange:b,originalLineRange:I};l.push(E),y.push(E)}),m=y}if(!o.isValid())return[]}l.sort(S7(Qr(p=>p.modifiedLineRange.length,hc)));let d=new Fa,c=new Fa;for(let p of l){let m=p.modifiedLineRange.startLineNumber-p.originalLineRange.startLineNumber,g=d.subtractFrom(p.modifiedLineRange),f=c.subtractFrom(p.originalLineRange).getWithDelta(m),b=g.getIntersection(f);for(let y of b.ranges){if(y.length<3)continue;let I=y,E=y.delta(-m);s.push(new Nr(E,I)),d.addRange(I),c.addRange(E)}}s.sort(Qr(p=>p.original.startLineNumber,hc));let u=new OS(r);for(let p=0;p<s.length;p++){let m=s[p],g=u.findLastMonotonous(D=>D.original.startLineNumber<=m.original.startLineNumber),f=Mu(r,D=>D.modified.startLineNumber<=m.modified.startLineNumber),b=Math.max(m.original.startLineNumber-g.original.startLineNumber,m.modified.startLineNumber-f.modified.startLineNumber),y=u.findLastMonotonous(D=>D.original.startLineNumber<m.original.endLineNumberExclusive),I=Mu(r,D=>D.modified.startLineNumber<m.modified.endLineNumberExclusive),E=Math.max(y.original.endLineNumberExclusive-m.original.endLineNumberExclusive,I.modified.endLineNumberExclusive-m.modified.endLineNumberExclusive),S;for(S=0;S<b;S++){let D=m.original.startLineNumber-S-1,k=m.modified.startLineNumber-S-1;if(D>i.length||k>n.length||d.contains(k)||c.contains(D)||!Bee(i[D-1],n[k-1],o))break}S>0&&(c.addRange(new Ye(m.original.startLineNumber-S,m.original.startLineNumber)),d.addRange(new Ye(m.modified.startLineNumber-S,m.modified.startLineNumber)));let w;for(w=0;w<E;w++){let D=m.original.endLineNumberExclusive+w,k=m.modified.endLineNumberExclusive+w;if(D>i.length||k>n.length||d.contains(k)||c.contains(D)||!Bee(i[D-1],n[k-1],o))break}w>0&&(c.addRange(new Ye(m.original.endLineNumberExclusive,m.original.endLineNumberExclusive+w)),d.addRange(new Ye(m.modified.endLineNumberExclusive,m.modified.endLineNumberExclusive+w))),(S>0||w>0)&&(s[p]=new Nr(new Ye(m.original.startLineNumber-S,m.original.endLineNumberExclusive+w),new Ye(m.modified.startLineNumber-S,m.modified.endLineNumberExclusive+w)))}return s}function Bee(r,t,e){if(r.trim()===t.trim())return!0;if(r.length>300&&t.length>300)return!1;let n=new FC().compute(new Xm([r],new F(1,1,1,r.length),!1),new Xm([t],new F(1,1,1,t.length),!1),e),o=0,s=Nn.invert(n.diffs,r.length);for(let c of s)c.seq1Range.forEach(u=>{zx(r.charCodeAt(u))||o++});function a(c){let u=0;for(let p=0;p<r.length;p++)zx(c.charCodeAt(p))||u++;return u}let l=a(r.length>t.length?r:t);return o/l>.6&&l>10}function Mpe(r){if(r.length===0)return r;r.sort(Qr(e=>e.original.startLineNumber,hc));let t=[r[0]];for(let e=1;e<r.length;e++){let i=t[t.length-1],n=r[e],o=n.original.startLineNumber-i.original.endLineNumberExclusive,s=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(o>=0&&s>=0&&o+s<=2){t[t.length-1]=i.join(n);continue}t.push(n)}return t}function Ope(r,t){let e=new OS(r);return t=t.filter(i=>{let n=e.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new Nr(new Ye(1,1),new Ye(1,1)),o=Mu(r,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==o}),t}var Kx=class{constructor(t,e){this.trimmedHash=t;this.lines=e}getElement(t){return this.trimmedHash[t]}get length(){return this.trimmedHash.length}getBoundaryScore(t){let e=t===0?0:Wee(this.lines[t-1]),i=t===this.lines.length?0:Wee(this.lines[t]);return 1e3-(e+i)}getText(t){return this.lines.slice(t.start,t.endExclusive).join(`
`)}isStronglyEqual(t,e){return this.lines[t]===this.lines[e]}};function Wee(r){let t=0;for(;t<r.length&&(r.charCodeAt(t)===32||r.charCodeAt(t)===9);)t++;return t}function Gx(r,t,e){let i=e;return i=Uee(r,t,i),i=Uee(r,t,i),i=Npe(r,t,i),i}function Uee(r,t,e){if(e.length===0)return e;let i=[];i.push(e[0]);for(let o=1;o<e.length;o++){let s=i[i.length-1],a=e[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=a.seq1Range.start-s.seq1Range.endExclusive,d;for(d=1;d<=l&&!(r.getElement(a.seq1Range.start-d)!==r.getElement(a.seq1Range.endExclusive-d)||t.getElement(a.seq2Range.start-d)!==t.getElement(a.seq2Range.endExclusive-d));d++);if(d--,d===l){i[i.length-1]=new Nn(new Xe(s.seq1Range.start,a.seq1Range.endExclusive-l),new Xe(s.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-d)}i.push(a)}let n=[];for(let o=0;o<i.length-1;o++){let s=i[o+1],a=i[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){let l=s.seq1Range.start-a.seq1Range.endExclusive,d;for(d=0;d<l&&!(!r.isStronglyEqual(a.seq1Range.start+d,a.seq1Range.endExclusive+d)||!t.isStronglyEqual(a.seq2Range.start+d,a.seq2Range.endExclusive+d));d++);if(d===l){i[o+1]=new Nn(new Xe(a.seq1Range.start+l,s.seq1Range.endExclusive),new Xe(a.seq2Range.start+l,s.seq2Range.endExclusive));continue}d>0&&(a=a.delta(d))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function Npe(r,t,e){if(!r.getBoundaryScore||!t.getBoundaryScore)return e;for(let i=0;i<e.length;i++){let n=i>0?e[i-1]:void 0,o=e[i],s=i+1<e.length?e[i+1]:void 0,a=new Xe(n?n.seq1Range.endExclusive+1:0,s?s.seq1Range.start-1:r.length),l=new Xe(n?n.seq2Range.endExclusive+1:0,s?s.seq2Range.start-1:t.length);o.seq1Range.isEmpty?e[i]=Hee(o,r,t,a,l):o.seq2Range.isEmpty&&(e[i]=Hee(o.swap(),t,r,l,a).swap())}return e}function Hee(r,t,e,i,n){let s=1;for(;r.seq1Range.start-s>=i.start&&r.seq2Range.start-s>=n.start&&e.isStronglyEqual(r.seq2Range.start-s,r.seq2Range.endExclusive-s)&&s<100;)s++;s--;let a=0;for(;r.seq1Range.start+a<i.endExclusive&&r.seq2Range.endExclusive+a<n.endExclusive&&e.isStronglyEqual(r.seq2Range.start+a,r.seq2Range.endExclusive+a)&&a<100;)a++;if(s===0&&a===0)return r;let l=0,d=-1;for(let c=-s;c<=a;c++){let u=r.seq2Range.start+c,p=r.seq2Range.endExclusive+c,m=r.seq1Range.start+c,g=t.getBoundaryScore(m)+e.getBoundaryScore(u)+e.getBoundaryScore(p);g>d&&(d=g,l=c)}return r.delta(l)}function zee(r,t,e){let i=[];for(let n of e){let o=i[i.length-1];if(!o){i.push(n);continue}n.seq1Range.start-o.seq1Range.endExclusive<=2||n.seq2Range.start-o.seq2Range.endExclusive<=2?i[i.length-1]=new Nn(o.seq1Range.join(n.seq1Range),o.seq2Range.join(n.seq2Range)):i.push(n)}return i}function Kee(r,t,e){let i=Nn.invert(e,r.length),n=[],o=new wu(0,0);function s(l,d){if(l.offset1<o.offset1||l.offset2<o.offset2)return;let c=r.findWordContaining(l.offset1),u=t.findWordContaining(l.offset2);if(!c||!u)return;let p=new Nn(c,u),m=p.intersect(d),g=m.seq1Range.length,f=m.seq2Range.length;for(;i.length>0;){let b=i[0];if(!(b.seq1Range.intersects(p.seq1Range)||b.seq2Range.intersects(p.seq2Range)))break;let I=r.findWordContaining(b.seq1Range.start),E=t.findWordContaining(b.seq2Range.start),S=new Nn(I,E),w=S.intersect(b);if(g+=w.seq1Range.length,f+=w.seq2Range.length,p=p.join(S),p.seq1Range.endExclusive>=b.seq1Range.endExclusive)i.shift();else break}g+f<(p.seq1Range.length+p.seq2Range.length)*2/3&&n.push(p),o=p.getEndExclusives()}for(;i.length>0;){let l=i.shift();l.seq1Range.isEmpty||(s(l.getStarts(),l),s(l.getEndExclusives().delta(-1),l))}return Fpe(e,n)}function Fpe(r,t){let e=[];for(;r.length>0||t.length>0;){let i=r[0],n=t[0],o;i&&(!n||i.seq1Range.start<n.seq1Range.start)?o=r.shift():o=t.shift(),e.length>0&&e[e.length-1].seq1Range.endExclusive>=o.seq1Range.start?e[e.length-1]=e[e.length-1].join(o):e.push(o)}return e}function Gee(r,t,e){let i=e;if(i.length===0)return i;let n=0,o;do{o=!1;let a=[i[0]];for(let l=1;l<i.length;l++){let u=function(m,g){let f=new Xe(c.seq1Range.endExclusive,d.seq1Range.start);return r.getText(f).replace(/\s/g,"").length<=4&&(m.seq1Range.length+m.seq2Range.length>5||g.seq1Range.length+g.seq2Range.length>5)};var s=u;let d=i[l],c=a[a.length-1];u(c,d)?(o=!0,a[a.length-1]=a[a.length-1].join(d)):a.push(d)}i=a}while(n++<10&&o);return i}function qee(r,t,e){let i=e;if(i.length===0)return i;let n=0,o;do{o=!1;let l=[i[0]];for(let d=1;d<i.length;d++){let p=function(g,f){let b=new Xe(u.seq1Range.endExclusive,c.seq1Range.start);if(r.countLinesIn(b)>5||b.length>500)return!1;let I=r.getText(b).trim();if(I.length>20||I.split(/\r\n|\r|\n/).length>1)return!1;let E=r.countLinesIn(g.seq1Range),S=g.seq1Range.length,w=t.countLinesIn(g.seq2Range),D=g.seq2Range.length,k=r.countLinesIn(f.seq1Range),R=f.seq1Range.length,A=t.countLinesIn(f.seq2Range),H=f.seq2Range.length,z=2*40+50;function Z(fe){return Math.min(fe,z)}return Math.pow(Math.pow(Z(E*40+S),1.5)+Math.pow(Z(w*40+D),1.5),1.5)+Math.pow(Math.pow(Z(k*40+R),1.5)+Math.pow(Z(A*40+H),1.5),1.5)>(z**1.5)**1.5*1.3};var a=p;let c=i[d],u=l[l.length-1];p(u,c)?(o=!0,l[l.length-1]=l[l.length-1].join(c)):l.push(c)}i=l}while(n++<10&&o);let s=[];return f7(i,(l,d,c)=>{let u=d;function p(I){return I.length>0&&I.trim().length<=3&&d.seq1Range.length+d.seq2Range.length>100}let m=r.extendToFullLines(d.seq1Range),g=r.getText(new Xe(m.start,d.seq1Range.start));p(g)&&(u=u.deltaStart(-g.length));let f=r.getText(new Xe(d.seq1Range.endExclusive,m.endExclusive));p(f)&&(u=u.deltaEnd(f.length));let b=Nn.fromOffsetPairs(l?l.getEndExclusives():wu.zero,c?c.getStarts():wu.max),y=u.intersect(b);s.length>0&&y.getStarts().equals(s[s.length-1].getEndExclusives())?s[s.length-1]=s[s.length-1].join(y):s.push(y)}),s}var nN=class{dynamicProgrammingDiffing=new tN;myersDiffingAlgorithm=new FC;computeDiff(t,e,i){if(t.length<=1&&ti(t,e,(w,D)=>w===D))return new Kf([],[],!1);if(t.length===1&&t[0].length===0||e.length===1&&e[0].length===0)return new Kf([new ya(new Ye(1,t.length+1),new Ye(1,e.length+1),[new $r(new F(1,1,t.length,t[t.length-1].length+1),new F(1,1,e.length,e[e.length-1].length+1))])],[],!1);let n=i.maxComputationTimeMs===0?Zm.instance:new eN(i.maxComputationTimeMs),o=!i.ignoreTrimWhitespace,s=new Map;function a(w){let D=s.get(w);return D===void 0&&(D=s.size,s.set(w,D)),D}let l=t.map(w=>a(w.trim())),d=e.map(w=>a(w.trim())),c=new Kx(l,t),u=new Kx(d,e),p=c.length+u.length<1700?this.dynamicProgrammingDiffing.compute(c,u,n,(w,D)=>t[w]===e[D]?e[D].length===0?.1:1+Math.log(1+e[D].length):.99):this.myersDiffingAlgorithm.compute(c,u,n),m=p.diffs,g=p.hitTimeout;m=Gx(c,u,m),m=Gee(c,u,m);let f=[],b=w=>{if(o)for(let D=0;D<w;D++){let k=y+D,R=I+D;if(t[k]!==e[R]){let A=this.refineDiff(t,e,new Nn(new Xe(k,k+1),new Xe(R,R+1)),n,o);for(let H of A.mappings)f.push(H);A.hitTimeout&&(g=!0)}}},y=0,I=0;for(let w of m){$l(()=>w.seq1Range.start-y===w.seq2Range.start-I);let D=w.seq1Range.start-y;b(D),y=w.seq1Range.endExclusive,I=w.seq2Range.endExclusive;let k=this.refineDiff(t,e,w,n,o);k.hitTimeout&&(g=!0);for(let R of k.mappings)f.push(R)}b(t.length-y);let E=jee(f,t,e),S=[];return i.computeMoves&&(S=this.computeMoves(E,t,e,l,d,n,o)),$l(()=>{function w(k,R){if(k.lineNumber<1||k.lineNumber>R.length)return!1;let A=R[k.lineNumber-1];return!(k.column<1||k.column>A.length+1)}function D(k,R){return!(k.startLineNumber<1||k.startLineNumber>R.length+1||k.endLineNumberExclusive<1||k.endLineNumberExclusive>R.length+1)}for(let k of E){if(!k.innerChanges)return!1;for(let R of k.innerChanges)if(!(w(R.modifiedRange.getStartPosition(),e)&&w(R.modifiedRange.getEndPosition(),e)&&w(R.originalRange.getStartPosition(),t)&&w(R.originalRange.getEndPosition(),t)))return!1;if(!D(k.modified,e)||!D(k.original,t))return!1}return!0}),new Kf(E,S,g)}computeMoves(t,e,i,n,o,s,a){return Vee(t,e,i,n,o,s).map(c=>{let u=this.refineDiff(e,i,new Nn(c.original.toOffsetRange(),c.modified.toOffsetRange()),s,a),p=jee(u.mappings,e,i,!0);return new zM(c,p)})}refineDiff(t,e,i,n,o){let a=Vpe(i).toRangeMapping2(t,e),l=new Xm(t,a.originalRange,o),d=new Xm(e,a.modifiedRange,o),c=l.length+d.length<500?this.dynamicProgrammingDiffing.compute(l,d,n):this.myersDiffingAlgorithm.compute(l,d,n),u=!1,p=c.diffs;u&&Nn.assertSorted(p),p=Gx(l,d,p),u&&Nn.assertSorted(p),p=Kee(l,d,p),u&&Nn.assertSorted(p),p=zee(l,d,p),u&&Nn.assertSorted(p),p=qee(l,d,p),u&&Nn.assertSorted(p);let m=p.map(g=>new $r(l.translateRange(g.seq1Range),d.translateRange(g.seq2Range)));return u&&$r.assertSorted(m),{mappings:m,hitTimeout:c.hitTimeout}}};function jee(r,t,e,i=!1){let n=[];for(let o of Vb(r.map(s=>Bpe(s,t,e)),(s,a)=>s.original.overlapOrTouch(a.original)||s.modified.overlapOrTouch(a.modified))){let s=o[0],a=o[o.length-1];n.push(new ya(s.original.join(a.original),s.modified.join(a.modified),o.map(l=>l.innerChanges[0])))}return $l(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||e.length-n[n.length-1].modified.endLineNumberExclusive!==t.length-n[n.length-1].original.endLineNumberExclusive)?!1:HS(n,(o,s)=>s.original.startLineNumber-o.original.endLineNumberExclusive===s.modified.startLineNumber-o.modified.endLineNumberExclusive&&o.original.endLineNumberExclusive<s.original.startLineNumber&&o.modified.endLineNumberExclusive<s.modified.startLineNumber)),n}function Bpe(r,t,e){let i=0,n=0;r.modifiedRange.endColumn===1&&r.originalRange.endColumn===1&&r.originalRange.startLineNumber+i<=r.originalRange.endLineNumber&&r.modifiedRange.startLineNumber+i<=r.modifiedRange.endLineNumber&&(n=-1),r.modifiedRange.startColumn-1>=e[r.modifiedRange.startLineNumber-1].length&&r.originalRange.startColumn-1>=t[r.originalRange.startLineNumber-1].length&&r.originalRange.startLineNumber<=r.originalRange.endLineNumber+n&&r.modifiedRange.startLineNumber<=r.modifiedRange.endLineNumber+n&&(i=1);let o=new Ye(r.originalRange.startLineNumber+i,r.originalRange.endLineNumber+1+n),s=new Ye(r.modifiedRange.startLineNumber+i,r.modifiedRange.endLineNumber+1+n);return new ya(o,s,[r])}function Vpe(r){return new Nr(new Ye(r.seq1Range.start+1,r.seq1Range.endExclusive+1),new Ye(r.seq2Range.start+1,r.seq2Range.endExclusive+1))}var jXi=x("diffEditor.move.border","#8b8b8b9c",h("diffEditor.move.border","The border color for text that got moved in the diff editor.")),$Xi=x("diffEditor.moveActive.border","#FFA500",h("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor.")),YXi=x("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},h("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets.")),Wpe=Tt("diff-insert",B.add,h("diffInsertIcon","Line decoration for inserts in the diff editor.")),R8=Tt("diff-remove",B.remove,h("diffRemoveIcon","Line decoration for removals in the diff editor.")),A8=On.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+ye.asClassName(Wpe),marginClassName:"gutter-insert"}),P8=On.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+ye.asClassName(R8),marginClassName:"gutter-delete"}),M8=On.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),O8=On.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),N8=On.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),$ee=On.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),Yee=On.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),qx=On.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),Zee=On.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),Xee=On.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var oN=class extends L{constructor(e,i,n,o,s,a,l,d,c){super();this._getViewZoneId=e;this._marginDomNode=i;this._modifiedEditor=n;this._diff=o;this._editor=s;this._viewLineCounts=a;this._originalTextModel=l;this._contextMenuService=d;this._clipboardService=c;this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=ye.asClassName(B.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";let u=this._modifiedEditor.getOption(68);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${u}px`,this._diffActions.style.lineHeight=`${u}px`,this._marginDomNode.appendChild(this._diffActions);let p=0,m=n.getOption(129)&&!Xo,g=(f,b)=>{this._contextMenuService.showContextMenu({domForShadowRoot:m?n.getDomNode()??void 0:void 0,getAnchor:()=>({x:f,y:b}),getActions:()=>{let y=[],I=o.modified.isEmpty;return y.push(new ot("diff.clipboard.copyDeletedContent",I?o.original.length>1?h("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):h("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.original.length>1?h("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):h("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{let S=this._originalTextModel.getValueInRange(o.original.toExclusiveRange());await this._clipboardService.writeText(S)})),o.original.length>1&&y.push(new ot("diff.clipboard.copyDeletedLineContent",I?h("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.original.startLineNumber+p):h("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.original.startLineNumber+p),void 0,!0,async()=>{let S=this._originalTextModel.getLineContent(o.original.startLineNumber+p);S===""&&(S=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(S)})),n.getOption(93)||y.push(new ot("diff.inline.revertChange",h("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),y},autoSelectFirstItem:!0})};this._register(Wi(this._diffActions,"mousedown",f=>{if(!f.leftButton)return;let{top:b,height:y}=To(this._diffActions),I=Math.floor(u/3);f.preventDefault(),g(f.posx,b+y+I)})),this._register(n.onMouseMove(f=>{(f.target.type===8||f.target.type===5)&&f.target.detail.viewZoneId===this._getViewZoneId()?(p=this._updateLightBulbPosition(this._marginDomNode,f.event.browserEvent.y,u),this.visibility=!0):this.visibility=!1})),this._register(n.onMouseDown(f=>{f.event.leftButton&&(f.target.type===8||f.target.type===5)&&f.target.detail.viewZoneId===this._getViewZoneId()&&(f.event.preventDefault(),p=this._updateLightBulbPosition(this._marginDomNode,f.event.browserEvent.y,u),g(f.event.posx,f.event.posy+u))}))}_diffActions;_visibility=!1;get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}_updateLightBulbPosition(e,i,n){let{top:o}=To(e),s=i-o,a=Math.floor(s/n),l=a*n;if(this._diffActions.style.top=`${l}px`,this._viewLineCounts){let d=0;for(let c=0;c<this._viewLineCounts.length;c++)if(d+=this._viewLineCounts[c],a<d)return c}return a}};var Qee=qm("diffEditorWidget",{createHTML:r=>r});function ete(r,t,e,i){rn(i,t.fontInfo);let n=e.length>0,o=new Pc(1e4),s=0,a=0,l=[];for(let p=0;p<r.lineTokens.length;p++){let m=p+1,g=r.lineTokens[p],f=r.lineBreakData[p],b=Wl.filter(e,m,1,Number.MAX_SAFE_INTEGER);if(f){let y=0;for(let I of f.breakOffsets){let E=g.sliceAndInflate(y,I,0);s=Math.max(s,Jee(a,E,Wl.extractWrapped(b,y,I),n,r.mightContainNonBasicASCII,r.mightContainRTL,t,o)),a++,y=I}l.push(f.breakOffsets.length)}else l.push(1),s=Math.max(s,Jee(a,g,b,n,r.mightContainNonBasicASCII,r.mightContainRTL,t,o)),a++}s+=t.scrollBeyondLastColumn;let d=o.build(),c=Qee?Qee.createHTML(d):d;i.innerHTML=c;let u=s*t.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:u,viewLineCounts:l}}var rN=class{constructor(t,e,i,n){this.lineTokens=t;this.lineBreakData=e;this.mightContainNonBasicASCII=i;this.mightContainRTL=n}},sN=class r{constructor(t,e,i,n,o,s,a,l,d,c,u){this.tabSize=t;this.fontInfo=e;this.disableMonospaceOptimizations=i;this.typicalHalfwidthCharacterWidth=n;this.scrollBeyondLastColumn=o;this.lineHeight=s;this.lineDecorationsWidth=a;this.stopRenderingLineAfter=l;this.renderWhitespace=d;this.renderControlCharacters=c;this.fontLigatures=u}static fromEditor(t){let e=t.getOptions(),i=e.get(51),n=e.get(147);return new r(t.getModel()?.getOptions().tabSize||0,i,e.get(33),i.typicalHalfwidthCharacterWidth,e.get(106),e.get(68),n.decorationsWidth,e.get(119),e.get(101),e.get(96),e.get(52))}};function Jee(r,t,e,i,n,o,s,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(r*s.lineHeight)),a.appendString('px;width:1000000px;">');let l=t.getLineContent(),d=gu.isBasicASCII(l,n),c=gu.containsRTL(l,d,o),u=wx(new jm(s.fontInfo.isMonospace&&!s.disableMonospaceOptimizations,s.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,d,c,0,t,e,s.tabSize,0,s.fontInfo.spaceWidth,s.fontInfo.middotWidth,s.fontInfo.wsmiddotWidth,s.stopRenderingLineAfter,s.renderWhitespace,s.renderControlCharacters,s.fontLigatures!==vd.OFF,null),a);return a.appendString("</div>"),u.characterMapping.getHorizontalOffset(u.characterMapping.length)}var BC=class extends L{constructor(e,i,n,o,s,a,l,d,c,u){super();this._targetWindow=e;this._editors=i;this._diffModel=n;this._options=o;this._diffEditorWidget=s;this._canIgnoreViewZoneUpdateEvent=a;this._origViewZonesToIgnore=l;this._modViewZonesToIgnore=d;this._clipboardService=c;this._contextMenuService=u;let p=Kt("invalidateAlignmentsState",0),m=this._register(new Et(()=>{p.set(p.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(S=>{this._canIgnoreViewZoneUpdateEvent()||m.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(S=>{this._canIgnoreViewZoneUpdateEvent()||m.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(S=>{(S.hasChanged(148)||S.hasChanged(68))&&m.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(S=>{(S.hasChanged(148)||S.hasChanged(68))&&m.schedule()}));let g=this._diffModel.map(S=>S?Ti(this,S.model.original.onDidChangeTokens,()=>S.model.original.tokenization.backgroundTokenizationState===2):void 0).map((S,w)=>S?.read(w)),f=et(S=>{let w=this._diffModel.read(S),D=w?.diff.read(S);if(!w||!D)return null;p.read(S);let R=this._options.renderSideBySide.read(S);return tte(this._editors.original,this._editors.modified,D.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,R)}),b=et(S=>{let w=this._diffModel.read(S)?.movedTextToCompare.read(S);if(!w)return null;p.read(S);let D=w.changes.map(k=>new $x(k));return tte(this._editors.original,this._editors.modified,D,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function y(){let S=document.createElement("div");return S.className="diagonal-fill",S}let I=this._register(new W);this.viewZones=Hu(this,(S,w)=>{I.clear();let D=f.read(S)||[],k=[],R=[],A=this._modifiedTopPadding.read(S);A>0&&R.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:A,showInHiddenAreas:!0,suppressMouseDown:!0});let H=this._originalTopPadding.read(S);H>0&&k.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:H,showInHiddenAreas:!0,suppressMouseDown:!0});let z=this._options.renderSideBySide.read(S),Z=z?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(Z){let _e=this._editors.original.getModel();for(let xt of D)if(xt.diff)for(let bt=xt.originalRange.startLineNumber;bt<xt.originalRange.endLineNumberExclusive;bt++){if(bt>_e.getLineCount())return{orig:k,mod:R};Z?.addRequest(_e.getLineContent(bt),null,null)}}let fe=Z?.finalize()??[],Ve=0,me=this._editors.modified.getOption(68),ce=this._diffModel.read(S)?.movedTextToCompare.read(S),xe=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,Ie=this._editors.original.getModel()?.mightContainRTL()??!1,ge=sN.fromEditor(this._editors.modified);for(let _e of D)if(_e.diff&&!z&&(!this._options.useTrueInlineDiffRendering.read(S)||!jx(_e.diff))){if(!_e.originalRange.isEmpty){g.read(S);let bt=document.createElement("div");bt.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");let je=this._editors.original.getModel();if(_e.originalRange.endLineNumberExclusive-1>je.getLineCount())return{orig:k,mod:R};let _n=new rN(_e.originalRange.mapToLineArray(Ai=>je.tokenization.getLineTokens(Ai)),_e.originalRange.mapToLineArray(Ai=>fe[Ve++]),xe,Ie),pn=[];for(let Ai of _e.diff.innerChanges||[])pn.push(new Hp(Ai.originalRange.delta(-(_e.diff.original.startLineNumber-1)),qx.className,0));let no=ete(_n,ge,pn,bt),No=document.createElement("div");if(No.className="inline-deleted-margin-view-zone",rn(No,ge.fontInfo),this._options.renderIndicators.read(S))for(let Ai=0;Ai<no.heightInLines;Ai++){let br=document.createElement("div");br.className=`delete-sign ${ye.asClassName(R8)}`,br.setAttribute("style",`position:absolute;top:${Ai*me}px;width:${ge.lineDecorationsWidth}px;height:${me}px;right:0;`),No.appendChild(br)}let zl;I.add(new oN(()=>Ue(zl),No,this._editors.modified,_e.diff,this._diffEditorWidget,no.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let Ai=0;Ai<no.viewLineCounts.length;Ai++){let br=no.viewLineCounts[Ai];br>1&&k.push({afterLineNumber:_e.originalRange.startLineNumber+Ai,domNode:y(),heightInPx:(br-1)*me,showInHiddenAreas:!0,suppressMouseDown:!0})}R.push({afterLineNumber:_e.modifiedRange.startLineNumber-1,domNode:bt,heightInPx:no.heightInLines*me,minWidthInPx:no.minWidthInPx,marginDomNode:No,setZoneId(Ai){zl=Ai},showInHiddenAreas:!0,suppressMouseDown:!0})}let xt=document.createElement("div");xt.className="gutter-delete",k.push({afterLineNumber:_e.originalRange.endLineNumberExclusive-1,domNode:y(),heightInPx:_e.modifiedHeightInPx,marginDomNode:xt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let xt=_e.modifiedHeightInPx-_e.originalHeightInPx;if(xt>0){if(ce?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(_e.originalRange.endLineNumberExclusive-1))continue;k.push({afterLineNumber:_e.originalRange.endLineNumberExclusive-1,domNode:y(),heightInPx:xt,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let bt=function(){let _n=document.createElement("div");return _n.className="arrow-revert-change "+ye.asClassName(B.arrowRight),w.add(M(_n,"mousedown",pn=>pn.stopPropagation())),w.add(M(_n,"click",pn=>{pn.stopPropagation(),s.revert(_e.diff)})),re("div",{},_n)};var He=bt;if(ce?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(_e.modifiedRange.endLineNumberExclusive-1))continue;let je;_e.diff&&_e.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(S)&&(je=bt()),R.push({afterLineNumber:_e.modifiedRange.endLineNumberExclusive-1,domNode:y(),heightInPx:-xt,marginDomNode:je,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(let _e of b.read(S)??[]){if(!ce?.lineRangeMapping.original.intersect(_e.originalRange)||!ce?.lineRangeMapping.modified.intersect(_e.modifiedRange))continue;let xt=_e.modifiedHeightInPx-_e.originalHeightInPx;xt>0?k.push({afterLineNumber:_e.originalRange.endLineNumberExclusive-1,domNode:y(),heightInPx:xt,showInHiddenAreas:!0,suppressMouseDown:!0}):R.push({afterLineNumber:_e.modifiedRange.endLineNumberExclusive-1,domNode:y(),heightInPx:-xt,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:k,mod:R}});let E=!1;this._register(this._editors.original.onDidScrollChange(S=>{S.scrollLeftChanged&&!E&&(E=!0,this._editors.modified.setScrollLeft(S.scrollLeft),E=!1)})),this._register(this._editors.modified.onDidScrollChange(S=>{S.scrollLeftChanged&&!E&&(E=!0,this._editors.original.setScrollLeft(S.scrollLeft),E=!1)})),this._originalScrollTop=Ti(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=Ti(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(Ut(S=>{let w=this._originalScrollTop.read(S)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(S))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(S));w!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(w,1)})),this._register(Ut(S=>{let w=this._modifiedScrollTop.read(S)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(S))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(S));w!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(w,1)})),this._register(Ut(S=>{let w=this._diffModel.read(S)?.movedTextToCompare.read(S),D=0;if(w){let k=this._editors.original.getTopForLineNumber(w.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();D=this._editors.modified.getTopForLineNumber(w.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-k}D>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(D,void 0)):D<0?(this._modifiedTopPadding.set(-D,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-D,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+D,void 0,!0)}))}_originalTopPadding=Kt(this,0);_originalScrollTop;_originalScrollOffset=Kt(this,0);_originalScrollOffsetAnimated=w8(this._targetWindow,this._originalScrollOffset,this._store);_modifiedTopPadding=Kt(this,0);_modifiedScrollTop;_modifiedScrollOffset=Kt(this,0);_modifiedScrollOffsetAnimated=w8(this._targetWindow,this._modifiedScrollOffset,this._store);viewZones};BC=_([v(8,gI),v(9,Mt)],BC);function tte(r,t,e,i,n,o){let s=new Sr(ite(r,i)),a=new Sr(ite(t,n)),l=r.getOption(68),d=t.getOption(68),c=[],u=0,p=0;function m(f,b){for(;;){let y=s.peek(),I=a.peek();if(y&&y.lineNumber>=f&&(y=void 0),I&&I.lineNumber>=b&&(I=void 0),!y&&!I)break;let E=y?y.lineNumber-u:Number.MAX_VALUE,S=I?I.lineNumber-p:Number.MAX_VALUE;E<S?(s.dequeue(),I={lineNumber:y.lineNumber-u+p,heightInPx:0}):E>S?(a.dequeue(),y={lineNumber:I.lineNumber-p+u,heightInPx:0}):(s.dequeue(),a.dequeue()),c.push({originalRange:Ye.ofLength(y.lineNumber,1),modifiedRange:Ye.ofLength(I.lineNumber,1),originalHeightInPx:l+y.heightInPx,modifiedHeightInPx:d+I.heightInPx,diff:void 0})}}for(let f of e){let S=function(w,D,k=!1){if(w<E||D<I)return;if(y)y=!1;else if(!k&&(w===E||D===I))return;let R=new Ye(E,w),A=new Ye(I,D);if(R.isEmpty&&A.isEmpty)return;let H=s.takeWhile(Z=>Z.lineNumber<w)?.reduce((Z,fe)=>Z+fe.heightInPx,0)??0,z=a.takeWhile(Z=>Z.lineNumber<D)?.reduce((Z,fe)=>Z+fe.heightInPx,0)??0;c.push({originalRange:R,modifiedRange:A,originalHeightInPx:R.length*l+H,modifiedHeightInPx:A.length*d+z,diff:f.lineRangeMapping}),E=w,I=D};var g=S;let b=f.lineRangeMapping;m(b.original.startLineNumber,b.modified.startLineNumber);let y=!0,I=b.modified.startLineNumber,E=b.original.startLineNumber;if(o)for(let w of b.innerChanges||[]){w.originalRange.startColumn>1&&w.modifiedRange.startColumn>1&&S(w.originalRange.startLineNumber,w.modifiedRange.startLineNumber);let D=r.getModel(),k=w.originalRange.endLineNumber<=D.getLineCount()?D.getLineMaxColumn(w.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;w.originalRange.endColumn<k&&S(w.originalRange.endLineNumber,w.modifiedRange.endLineNumber)}S(b.original.endLineNumberExclusive,b.modified.endLineNumberExclusive,!0),u=b.original.endLineNumberExclusive,p=b.modified.endLineNumberExclusive}return m(Number.MAX_VALUE,Number.MAX_VALUE),c}function ite(r,t){let e=[],i=[],n=r.getOption(148).wrappingColumn!==-1,o=r._getViewModel().coordinatesConverter,s=r.getOption(68);if(n)for(let l=1;l<=r.getModel().getLineCount();l++){let d=o.getModelLineViewLineCount(l);d>1&&i.push({lineNumber:l,heightInPx:s*(d-1)})}for(let l of r.getWhitespaces()){if(t.has(l.id))continue;let d=l.afterLineNumber===0?0:o.convertViewPositionToModelPosition(new U(l.afterLineNumber,1)).lineNumber;e.push({lineNumber:d,heightInPx:l.height})}return Aee(e,i,l=>l.lineNumber,(l,d)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+d.heightInPx}))}function jx(r){return r.innerChanges?r.innerChanges.every(t=>nte(t.modifiedRange)&&nte(t.originalRange)||t.originalRange.equalsRange(new F(1,1,1,1))):!1}function nte(r){return r.startLineNumber===r.endLineNumber}var ote={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1};var VC=class{constructor(t,e){this._accessibilityService=e;let i={...t,...rte(t,ote)};this._options=Kt(this,i)}_options;get editorOptions(){return this._options}_diffEditorWidth=Kt(this,0);_screenReaderMode=Ti(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized());couldShowInlineViewBecauseOfSize=et(this,t=>this._options.read(t).renderSideBySide&&this._diffEditorWidth.read(t)<=this._options.read(t).renderSideBySideInlineBreakpoint);renderOverviewRuler=et(this,t=>this._options.read(t).renderOverviewRuler);renderSideBySide=et(this,t=>this.compactMode.read(t)&&this.shouldRenderInlineViewInSmartMode.read(t)?!1:this._options.read(t).renderSideBySide&&!(this._options.read(t).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(t)&&!this._screenReaderMode.read(t)));readOnly=et(this,t=>this._options.read(t).readOnly);shouldRenderOldRevertArrows=et(this,t=>!(!this._options.read(t).renderMarginRevertIcon||!this.renderSideBySide.read(t)||this.readOnly.read(t)||this.shouldRenderGutterMenu.read(t)));shouldRenderGutterMenu=et(this,t=>this._options.read(t).renderGutterMenu);renderIndicators=et(this,t=>this._options.read(t).renderIndicators);enableSplitViewResizing=et(this,t=>this._options.read(t).enableSplitViewResizing);splitViewDefaultRatio=et(this,t=>this._options.read(t).splitViewDefaultRatio);ignoreTrimWhitespace=et(this,t=>this._options.read(t).ignoreTrimWhitespace);maxComputationTimeMs=et(this,t=>this._options.read(t).maxComputationTime);showMoves=et(this,t=>this._options.read(t).experimental.showMoves&&this.renderSideBySide.read(t));isInEmbeddedEditor=et(this,t=>this._options.read(t).isInEmbeddedEditor);diffWordWrap=et(this,t=>this._options.read(t).diffWordWrap);originalEditable=et(this,t=>this._options.read(t).originalEditable);diffCodeLens=et(this,t=>this._options.read(t).diffCodeLens);accessibilityVerbose=et(this,t=>this._options.read(t).accessibilityVerbose);diffAlgorithm=et(this,t=>this._options.read(t).diffAlgorithm);showEmptyDecorations=et(this,t=>this._options.read(t).experimental.showEmptyDecorations);onlyShowAccessibleDiffViewer=et(this,t=>this._options.read(t).onlyShowAccessibleDiffViewer);compactMode=et(this,t=>this._options.read(t).compactMode);trueInlineDiffRenderingEnabled=et(this,t=>this._options.read(t).experimental.useTrueInlineView);useTrueInlineDiffRendering=et(this,t=>!this.renderSideBySide.read(t)&&this.trueInlineDiffRenderingEnabled.read(t));hideUnchangedRegions=et(this,t=>this._options.read(t).hideUnchangedRegions.enabled);hideUnchangedRegionsRevealLineCount=et(this,t=>this._options.read(t).hideUnchangedRegions.revealLineCount);hideUnchangedRegionsContextLineCount=et(this,t=>this._options.read(t).hideUnchangedRegions.contextLineCount);hideUnchangedRegionsMinimumLineCount=et(this,t=>this._options.read(t).hideUnchangedRegions.minimumLineCount);updateOptions(t){let e=rte(t,this._options.get()),i={...this._options.get(),...t,...e};this._options.set(i,void 0,{changedOptions:t})}setWidth(t){this._diffEditorWidth.set(t,void 0)}_model=Kt(this,void 0);setModel(t){this._model.set(t,void 0)}shouldRenderInlineViewInSmartMode=this._model.map(this,t=>N7(this,e=>{let i=t?.diff.read(e);return i?Upe(i,this.trueInlineDiffRenderingEnabled.read(e)):void 0})).flatten().map(this,t=>!!t);inlineViewHideOriginalLineNumbers=this.compactMode};VC=_([v(1,zo)],VC);function Upe(r,t){return r.mappings.every(e=>Hpe(e.lineRangeMapping)||zpe(e.lineRangeMapping)||t&&jx(e.lineRangeMapping))}function Hpe(r){return r.original.length===0}function zpe(r){return r.modified.length===0}function rte(r,t){return{enableSplitViewResizing:Pe(r.enableSplitViewResizing,t.enableSplitViewResizing),splitViewDefaultRatio:I$(r.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:Pe(r.renderSideBySide,t.renderSideBySide),renderMarginRevertIcon:Pe(r.renderMarginRevertIcon,t.renderMarginRevertIcon),maxComputationTime:Hh(r.maxComputationTime,t.maxComputationTime,0,1073741824),maxFileSize:Hh(r.maxFileSize,t.maxFileSize,0,1073741824),ignoreTrimWhitespace:Pe(r.ignoreTrimWhitespace,t.ignoreTrimWhitespace),renderIndicators:Pe(r.renderIndicators,t.renderIndicators),originalEditable:Pe(r.originalEditable,t.originalEditable),diffCodeLens:Pe(r.diffCodeLens,t.diffCodeLens),renderOverviewRuler:Pe(r.renderOverviewRuler,t.renderOverviewRuler),diffWordWrap:Qi(r.diffWordWrap,t.diffWordWrap,["off","on","inherit"]),diffAlgorithm:Qi(r.diffAlgorithm,t.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:Pe(r.accessibilityVerbose,t.accessibilityVerbose),experimental:{showMoves:Pe(r.experimental?.showMoves,t.experimental.showMoves),showEmptyDecorations:Pe(r.experimental?.showEmptyDecorations,t.experimental.showEmptyDecorations),useTrueInlineView:Pe(r.experimental?.useTrueInlineView,t.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:Pe(r.hideUnchangedRegions?.enabled??r.experimental?.collapseUnchangedRegions,t.hideUnchangedRegions.enabled),contextLineCount:Hh(r.hideUnchangedRegions?.contextLineCount,t.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:Hh(r.hideUnchangedRegions?.minimumLineCount,t.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:Hh(r.hideUnchangedRegions?.revealLineCount,t.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:Pe(r.isInEmbeddedEditor,t.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:Pe(r.onlyShowAccessibleDiffViewer,t.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:Hh(r.renderSideBySideInlineBreakpoint,t.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:Pe(r.useInlineViewWhenSpaceIsLimited,t.useInlineViewWhenSpaceIsLimited),renderGutterMenu:Pe(r.renderGutterMenu,t.renderGutterMenu),compactMode:Pe(r.compactMode,t.compactMode)}}var WC=class extends L{constructor(e,i,n){super();this.model=e;this._options=i;this._diffProviderFactoryService=n;this._register(te(()=>this._cancellationTokenSource.cancel()));let o=bg("contentChangedSignal"),s=this._register(new Et(()=>o.trigger(void 0),200));this._register(Ut(l=>{let d=this._unchangedRegions.read(l);if(!d||d.regions.some(f=>f.isDragged.read(l)))return;let c=d.originalDecorationIds.map(f=>e.original.getDecorationRange(f)).map(f=>f?Ye.fromRangeInclusive(f):void 0),u=d.modifiedDecorationIds.map(f=>e.modified.getDecorationRange(f)).map(f=>f?Ye.fromRangeInclusive(f):void 0),p=d.regions.map((f,b)=>!c[b]||!u[b]?void 0:new UC(c[b].startLineNumber,u[b].startLineNumber,c[b].length,f.visibleLineCountTop.read(l),f.visibleLineCountBottom.read(l))).filter(zu),m=[],g=!1;for(let f of Vb(p,(b,y)=>b.getHiddenModifiedRange(l).endLineNumberExclusive===y.getHiddenModifiedRange(l).startLineNumber))if(f.length>1){g=!0;let b=f.reduce((I,E)=>I+E.lineCount,0),y=new UC(f[0].originalLineNumber,f[0].modifiedLineNumber,b,f[0].visibleLineCountTop.get(),f[f.length-1].visibleLineCountBottom.get());m.push(y)}else m.push(f[0]);if(g){let f=e.original.deltaDecorations(d.originalDecorationIds,m.map(y=>({range:y.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=e.modified.deltaDecorations(d.modifiedDecorationIds,m.map(y=>({range:y.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));Yi(y=>{this._unchangedRegions.set({regions:m,originalDecorationIds:f,modifiedDecorationIds:b},y)})}}));let a=(l,d,c)=>{let u=UC.fromDiffs(l.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c)),p,m=this._unchangedRegions.get();if(m){let y=m.originalDecorationIds.map(w=>e.original.getDecorationRange(w)).map(w=>w?Ye.fromRangeInclusive(w):void 0),I=m.modifiedDecorationIds.map(w=>e.modified.getDecorationRange(w)).map(w=>w?Ye.fromRangeInclusive(w):void 0),S=Mee(m.regions.map((w,D)=>{if(!y[D]||!I[D])return;let k=y[D].length;return new UC(y[D].startLineNumber,I[D].startLineNumber,k,Math.min(w.visibleLineCountTop.get(),k),Math.min(w.visibleLineCountBottom.get(),k-w.visibleLineCountTop.get()))}).filter(zu),(w,D)=>!D||w.modifiedLineNumber>=D.modifiedLineNumber+D.lineCount&&w.originalLineNumber>=D.originalLineNumber+D.lineCount).map(w=>new Nr(w.getHiddenOriginalRange(c),w.getHiddenModifiedRange(c)));S=Nr.clip(S,Ye.ofLength(1,e.original.getLineCount()),Ye.ofLength(1,e.modified.getLineCount())),p=Nr.inverse(S,e.original.getLineCount(),e.modified.getLineCount())}let g=[];if(p)for(let y of u){let I=p.filter(E=>E.original.intersectsStrict(y.originalUnchangedRange)&&E.modified.intersectsStrict(y.modifiedUnchangedRange));g.push(...y.setVisibleRanges(I,d))}else g.push(...u);let f=e.original.deltaDecorations(m?.originalDecorationIds||[],g.map(y=>({range:y.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),b=e.modified.deltaDecorations(m?.modifiedDecorationIds||[],g.map(y=>({range:y.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:g,originalDecorationIds:f,modifiedDecorationIds:b},d)};this._register(e.modified.onDidChangeContent(l=>{if(this._diff.get()){let c=wl.fromModelContentChanges(l.changes),u=(this._lastDiff,e.original,e.modified,void 0);u&&(this._lastDiff=u,Yi(p=>{this._diff.set(Yx.fromDiffResult(this._lastDiff),p),a(u,p);let m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(g=>g.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(e.original.onDidChangeContent(l=>{if(this._diff.get()){let c=wl.fromModelContentChanges(l.changes),u=(this._lastDiff,e.original,e.modified,void 0);u&&(this._lastDiff=u,Yi(p=>{this._diff.set(Yx.fromDiffResult(this._lastDiff),p),a(u,p);let m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(g=>g.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,p)}))}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(Qo(async(l,d)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(l),this._options.hideUnchangedRegionsContextLineCount.read(l),s.cancel(),o.read(l);let c=this._diffProvider.read(l);c.onChangeSignal.read(l),Hl(nN,l),Hl(Gx,l),this._isDiffUpToDate.set(!1,void 0);let u=[];d.add(e.original.onDidChangeContent(g=>{let f=wl.fromModelContentChanges(g.changes);u=uy(u,f)}));let p=[];d.add(e.modified.onDidChangeContent(g=>{let f=wl.fromModelContentChanges(g.changes);p=uy(p,f)}));let m=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(l),maxComputationTimeMs:this._options.maxComputationTimeMs.read(l),computeMoves:this._options.showMoves.read(l)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(m=Kpe(m,e.original,e.modified),m=(e.original,e.modified,void 0)??m,m=(e.original,e.modified,void 0)??m,Yi(g=>{a(m,g),this._lastDiff=m;let f=Yx.fromDiffResult(m);this._diff.set(f,g),this._isDiffUpToDate.set(!0,g);let b=this.movedTextToCompare.get();this.movedTextToCompare.set(b?this._lastDiff.moves.find(y=>y.lineRangeMapping.modified.intersect(b.lineRangeMapping.modified)):void 0,g)}))}))}_isDiffUpToDate=Kt(this,!1);isDiffUpToDate=this._isDiffUpToDate;_lastDiff;_diff=Kt(this,void 0);diff=this._diff;_unchangedRegions=Kt(this,void 0);unchangedRegions=et(this,e=>this._options.hideUnchangedRegions.read(e)?this._unchangedRegions.read(e)?.regions??[]:(Yi(i=>{for(let n of this._unchangedRegions.get()?.regions||[])n.collapseAll(i)}),[]));movedTextToCompare=Kt(this,void 0);_activeMovedText=Kt(this,void 0);_hoveredMovedText=Kt(this,void 0);activeMovedText=et(this,e=>this.movedTextToCompare.read(e)??this._hoveredMovedText.read(e)??this._activeMovedText.read(e));setActiveMovedText(e){this._activeMovedText.set(e,void 0)}setHoveredMovedText(e){this._hoveredMovedText.set(e,void 0)}_cancellationTokenSource=new Cn;_diffProvider=et(this,e=>{let i=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(e)}),n=Jo("onDidChange",i.onDidChange);return{diffProvider:i,onChangeSignal:n}});ensureModifiedLineIsVisible(e,i,n){if(this.diff.get()?.mappings.length===0)return;let o=this._unchangedRegions.get()?.regions||[];for(let s of o)if(s.getHiddenModifiedRange(void 0).contains(e)){s.showModifiedLine(e,i,n);return}}ensureOriginalLineIsVisible(e,i,n){if(this.diff.get()?.mappings.length===0)return;let o=this._unchangedRegions.get()?.regions||[];for(let s of o)if(s.getHiddenOriginalRange(void 0).contains(e)){s.showOriginalLine(e,i,n);return}}async waitForDiff(){await hB(this.isDiffUpToDate,e=>e)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(i=>({range:i.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){let i=e.collapsedRegions?.map(o=>Ye.deserialize(o.range)),n=this._unchangedRegions.get();!n||!i||Yi(o=>{for(let s of n.regions)for(let a of i)if(s.modifiedUnchangedRange.intersect(a)){s.setHiddenModifiedRange(a,o);break}})}};WC=_([v(2,x8)],WC);function Kpe(r,t,e){return{changes:r.changes.map(i=>new ya(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>Gpe(n,t,e)):void 0)),moves:r.moves,identical:r.identical,quitEarly:r.quitEarly}}function Gpe(r,t,e){let i=r.originalRange,n=r.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===t.getLineMaxColumn(i.endLineNumber)&&n.endColumn===e.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<t.getLineCount()&&n.endLineNumber<e.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new $r(i,n)}var Yx=class r{constructor(t,e,i,n){this.mappings=t;this.movedTexts=e;this.identical=i;this.quitEarly=n}static fromDiffResult(t){return new r(t.changes.map(e=>new $x(e)),t.moves||[],t.identical,t.quitEarly)}},$x=class{constructor(t){this.lineRangeMapping=t}},UC=class r{constructor(t,e,i,n,o){this.originalLineNumber=t;this.modifiedLineNumber=e;this.lineCount=i;let s=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(o,this.lineCount-n),0);sB(n===s),sB(o===a),this._visibleLineCountTop.set(s,void 0),this._visibleLineCountBottom.set(a,void 0)}static fromDiffs(t,e,i,n,o){let s=ya.inverse(t,e,i),a=[];for(let l of s){let d=l.original.startLineNumber,c=l.modified.startLineNumber,u=l.original.length,p=d===1&&c===1,m=d+u===e+1&&c+u===i+1;(p||m)&&u>=o+n?(p&&!m&&(u-=o),m&&!p&&(d+=o,c+=o,u-=o),a.push(new r(d,c,u,0,0))):u>=o*2+n&&(d+=o,c+=o,u-=o*2,a.push(new r(d,c,u,0,0)))}return a}get originalUnchangedRange(){return Ye.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Ye.ofLength(this.modifiedLineNumber,this.lineCount)}_visibleLineCountTop=Kt(this,0);visibleLineCountTop=this._visibleLineCountTop;_visibleLineCountBottom=Kt(this,0);visibleLineCountBottom=this._visibleLineCountBottom;_shouldHideControls=et(this,t=>this.visibleLineCountTop.read(t)+this.visibleLineCountBottom.read(t)===this.lineCount&&!this.isDragged.read(t));isDragged=Kt(this,void 0);setVisibleRanges(t,e){let i=[],n=new Fa(t.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange),o=this.originalLineNumber,s=this.modifiedLineNumber,a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(e),i.push(this);else{let l=0;for(let d of n.ranges){let c=l===n.ranges.length-1;l++;let u=(c?a:d.endLineNumberExclusive)-s,p=new r(o,s,u,0,0);p.setHiddenModifiedRange(d,e),i.push(p),o=p.originalUnchangedRange.endLineNumberExclusive,s=p.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(t){return this._shouldHideControls.read(t)}getHiddenOriginalRange(t){return Ye.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(t),this.lineCount-this._visibleLineCountTop.read(t)-this._visibleLineCountBottom.read(t))}getHiddenModifiedRange(t){return Ye.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(t),this.lineCount-this._visibleLineCountTop.read(t)-this._visibleLineCountBottom.read(t))}setHiddenModifiedRange(t,e){let i=t.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-t.endLineNumberExclusive;this.setState(i,n,e)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(t=10,e){let i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+t,i),e)}showMoreBelow(t=10,e){let i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+t,i),e)}showAll(t){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),t)}showModifiedLine(t,e,i){let n=t+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),o=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-t;e===0&&n<o||e===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+o,i)}showOriginalLine(t,e,i){let n=t-this.originalLineNumber,o=this.originalLineNumber+this.lineCount-t;e===0&&n<o||e===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+o-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-o,this.getMaxVisibleLineCountBottom()),i)}collapseAll(t){this._visibleLineCountTop.set(0,t),this._visibleLineCountBottom.set(0,t)}setState(t,e,i){t=Math.max(Math.min(t,this.lineCount),0),e=Math.max(Math.min(e,this.lineCount-t),0),this._visibleLineCountTop.set(t,i),this._visibleLineCountBottom.set(e,i)}};var Zo=class extends L{constructor(e,i,n,o,s,a,l){super();this._editors=e;this._rootElement=i;this._diffModel=n;this._rootWidth=o;this._rootHeight=s;this._modifiedEditorLayoutInfo=a;this._themeService=l;let d=Ti(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=et(m=>{let g=d.read(m),f=g.getColor(j3)||(g.getColor(G3)||vL).transparent(2),b=g.getColor($3)||(g.getColor(q3)||yL).transparent(2);return{insertColor:f,removeColor:b}}),u=ut(document.createElement("div"));u.setClassName("diffViewport"),u.setPosition("absolute");let p=gi("div.diffOverview",{style:{position:"absolute",top:"0px",width:Zo.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(Eb(p,u.domNode)),this._register(Wi(p,G.POINTER_DOWN,m=>{this._editors.modified.delegateVerticalScrollbarPointerDown(m)})),this._register(M(p,G.MOUSE_WHEEL,m=>{this._editors.modified.delegateScrollFromMouseWheelEvent(m)},{passive:!1})),this._register(Eb(this._rootElement,p)),this._register(Qo((m,g)=>{let f=this._diffModel.read(m),b=this._editors.original.createOverviewRuler("original diffOverviewRuler");b&&(g.add(b),g.add(Eb(p,b.getDomNode())));let y=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(y&&(g.add(y),g.add(Eb(p,y.getDomNode()))),!b||!y)return;let I=Jo("viewZoneChanged",this._editors.original.onDidChangeViewZones),E=Jo("viewZoneChanged",this._editors.modified.onDidChangeViewZones),S=Jo("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),w=Jo("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);g.add(Ut(D=>{I.read(D),E.read(D),S.read(D),w.read(D);let k=c.read(D),R=f?.diff.read(D)?.mappings;function A(Z,fe,Ve){let me=Ve._getViewModel();return me?Z.filter(ce=>ce.length>0).map(ce=>{let xe=me.coordinatesConverter.convertModelPositionToViewPosition(new U(ce.startLineNumber,1)),Ie=me.coordinatesConverter.convertModelPositionToViewPosition(new U(ce.endLineNumberExclusive,1)),ge=Ie.lineNumber-xe.lineNumber;return new ZT(xe.lineNumber,Ie.lineNumber,ge,fe.toString())}):[]}let H=A((R||[]).map(Z=>Z.lineRangeMapping.original),k.removeColor,this._editors.original),z=A((R||[]).map(Z=>Z.lineRangeMapping.modified),k.insertColor,this._editors.modified);b?.setZones(H),y?.setZones(z)})),g.add(Ut(D=>{let k=this._rootHeight.read(D),R=this._rootWidth.read(D),A=this._modifiedEditorLayoutInfo.read(D);if(A){let H=Zo.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Zo.ONE_OVERVIEW_WIDTH;b.setLayout({top:0,height:k,right:H+Zo.ONE_OVERVIEW_WIDTH,width:Zo.ONE_OVERVIEW_WIDTH}),y.setLayout({top:0,height:k,right:0,width:Zo.ONE_OVERVIEW_WIDTH});let z=this._editors.modifiedScrollTop.read(D),Z=this._editors.modifiedScrollHeight.read(D),fe=this._editors.modified.getOption(105),Ve=new im(fe.verticalHasArrows?fe.arrowSize:0,fe.verticalScrollbarSize,0,A.height,Z,z);u.setTop(Ve.getSliderPosition()),u.setHeight(Ve.getSliderSize())}else u.setTop(0),u.setHeight(0);p.style.height=k+"px",p.style.left=R-Zo.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",u.setWidth(Zo.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}static ONE_OVERVIEW_WIDTH=15;static ENTIRE_DIFF_OVERVIEW_WIDTH=this.ONE_OVERVIEW_WIDTH*2;width=Zo.ENTIRE_DIFF_OVERVIEW_WIDTH};Zo=_([v(6,Ze)],Zo);var HC=class extends L{constructor(e,i,n,o,s,a,l){super();this.originalEditorElement=e;this.modifiedEditorElement=i;this._options=n;this._argCodeEditorWidgetOptions=o;this._createInnerEditor=s;this._instantiationService=a;this._keybindingService=l;this._argCodeEditorWidgetOptions=null,this._register(ch({createEmptyChangeSummary:()=>({}),handleChange:(d,c)=>(d.didChange(n.editorOptions)&&Object.assign(c,d.change.changedOptions),!0)},(d,c)=>{n.editorOptions.read(d),this._options.renderSideBySide.read(d),this.modified.updateOptions(this._adjustOptionsForRightHandSide(d,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(d,c))}))}original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{}));modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{}));_onDidContentSizeChange=this._register(new T);get onDidContentSizeChange(){return this._onDidContentSizeChange.event}modifiedScrollTop=Ti(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop());modifiedScrollHeight=Ti(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight());modifiedObs=Tb(this.modified);originalObs=Tb(this.original);modifiedModel=this.modifiedObs.model;modifiedSelections=Ti(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]);modifiedCursor=gc({owner:this,equalsFn:U.equals},e=>this.modifiedSelections.read(e)[0]?.getPosition()??new U(1,1));originalCursor=Ti(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new U(1,1));isOriginalFocused=Tb(this.original).isFocused;isModifiedFocused=Tb(this.modified).isFocused;isFocused=et(this,e=>this.isOriginalFocused.read(e)||this.isModifiedFocused.read(e));_createLeftHandSideEditor(e,i){let n=this._adjustOptionsForLeftHandSide(void 0,e),o=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,n,i);return o.setContextValue("isInDiffLeftEditor",!0),o}_createRightHandSideEditor(e,i){let n=this._adjustOptionsForRightHandSide(void 0,e),o=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,n,i);return o.setContextValue("isInDiffRightEditor",!0),o}_constructInnerEditor(e,i,n,o){let s=this._createInnerEditor(e,i,n,o);return this._register(s.onDidContentSizeChange(a=>{let l=this.original.getContentWidth()+this.modified.getContentWidth()+Zo.ENTIRE_DIFF_OVERVIEW_WIDTH,d=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:d,contentWidth:l,contentHeightChanged:a.contentHeightChanged,contentWidthChanged:a.contentWidthChanged})})),s}_adjustOptionsForLeftHandSide(e,i){let n=this._adjustOptionsForSubEditor(i);return this._options.renderSideBySide.get()?(n.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},n.wordWrapOverride1=this._options.diffWordWrap.get()):(n.wordWrapOverride1="off",n.wordWrapOverride2="off",n.stickyScroll={enabled:!1},n.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),n.glyphMargin=this._options.renderSideBySide.get(),i.originalAriaLabel&&(n.ariaLabel=i.originalAriaLabel),n.ariaLabel=this._updateAriaLabel(n.ariaLabel),n.readOnly=!this._options.originalEditable.get(),n.dropIntoEditor={enabled:!n.readOnly},n.extraEditorClassName="original-in-monaco-diff-editor",n}_adjustOptionsForRightHandSide(e,i){let n=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(n.ariaLabel=i.modifiedAriaLabel),n.ariaLabel=this._updateAriaLabel(n.ariaLabel),n.wordWrapOverride1=this._options.diffWordWrap.get(),n.revealHorizontalRightPadding=yl.revealHorizontalRightPadding.defaultValue+Zo.ENTIRE_DIFF_OVERVIEW_WIDTH,n.scrollbar.verticalHasArrows=!1,n.extraEditorClassName="modified-in-monaco-diff-editor",n}_adjustOptionsForSubEditor(e){let i={...e,dimension:{height:0,width:0}};return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar={...i.scrollbar||{}},i.folding=!1,i.codeLens=this._options.diffCodeLens.get(),i.fixedOverflowWidgets=!0,i.minimap={...i.minimap||{}},i.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?i.stickyScroll={enabled:!1}:i.stickyScroll=this._options.editorOptions.get().stickyScroll,i}_updateAriaLabel(e){e||(e="");let i=h("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?e+i:e?e.replaceAll(i,""):""}};HC=_([v(5,ae),v(6,at)],HC);var qpe=Tt("diff-review-insert",B.add,h("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),jpe=Tt("diff-review-remove",B.remove,h("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),$pe=Tt("diff-review-close",B.close,h("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer.")),Tu=class extends L{constructor(e,i,n,o,s,a,l,d,c){super();this._parentNode=e;this._visible=i;this._setVisible=n;this._canClose=o;this._width=s;this._height=a;this._diffs=l;this._models=d;this._instantiationService=c}static _ttPolicy=qm("diffReview",{createHTML:e=>e});_state=Hu(this,(e,i)=>{let n=this._visible.read(e);if(this._parentNode.style.visibility=n?"visible":"hidden",!n)return null;let o=i.add(this._instantiationService.createInstance(Xx,this._diffs,this._models,this._setVisible,this._canClose)),s=i.add(this._instantiationService.createInstance(Qx,this._parentNode,o,this._width,this._height,this._models));return{model:o,view:s}}).recomputeInitiallyAndOnChange(this._store);next(){Yi(e=>{let i=this._visible.get();this._setVisible(!0,e),i&&this._state.get().model.nextGroup(e)})}prev(){Yi(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){Yi(e=>{this._setVisible(!1,e)})}};Tu=_([v(8,ae)],Tu);var Xx=class extends L{constructor(e,i,n,o,s){super();this._diffs=e;this._models=i;this._setVisible=n;this.canClose=o;this._accessibilitySignalService=s;this._register(Ut(a=>{let l=this._diffs.read(a);if(!l){this._groups.set([],void 0);return}let d=Ype(l,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());Yi(c=>{let u=this._models.getModifiedPosition();if(u){let p=d.findIndex(m=>u?.lineNumber<m.range.modified.endLineNumberExclusive);p!==-1&&this._currentGroupIdx.set(p,c)}this._groups.set(d,c)})})),this._register(Ut(a=>{let l=this.currentElement.read(a);l?.type===2?this._accessibilitySignalService.playSignal(mo.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):l?.type===3&&this._accessibilitySignalService.playSignal(mo.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(Ut(a=>{let l=this.currentElement.read(a);if(l&&l.type!==0){let d=l.modifiedLineNumber??l.diff.modified.startLineNumber;this._models.modifiedSetSelection(F.fromPositions(new U(d,1)))}}))}_groups=Kt(this,[]);_currentGroupIdx=Kt(this,0);_currentElementIdx=Kt(this,0);groups=this._groups;currentGroup=this._currentGroupIdx.map((e,i)=>this._groups.read(i)[e]);currentGroupIndex=this._currentGroupIdx;currentElement=this._currentElementIdx.map((e,i)=>this.currentGroup.read(i)?.lines[e]);_goToGroupDelta(e,i){let n=this.groups.get();!n||n.length<=1||vg(i,o=>{this._currentGroupIdx.set(Xe.ofLength(n.length).clipCyclic(this._currentGroupIdx.get()+e),o),this._currentElementIdx.set(0,o)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){let i=this.currentGroup.get();!i||i.lines.length<=1||Yi(n=>{this._currentElementIdx.set(Xe.ofLength(i.lines.length).clip(this._currentElementIdx.get()+e),n)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){let i=this.currentGroup.get();if(!i)return;let n=i.lines.indexOf(e);n!==-1&&Yi(o=>{this._currentElementIdx.set(n,o)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);let e=this.currentElement.get();e&&(e.type===2?this._models.originalReveal(F.fromPositions(new U(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==0?F.fromPositions(new U(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};Xx=_([v(4,Rl)],Xx);var Zx=3;function Ype(r,t,e){let i=[];for(let n of Vb(r,(o,s)=>s.modified.startLineNumber-o.modified.endLineNumberExclusive<2*Zx)){let o=[];o.push(new B8);let s=new Ye(Math.max(1,n[0].original.startLineNumber-Zx),Math.min(n[n.length-1].original.endLineNumberExclusive+Zx,t+1)),a=new Ye(Math.max(1,n[0].modified.startLineNumber-Zx),Math.min(n[n.length-1].modified.endLineNumberExclusive+Zx,e+1));G_(n,(c,u)=>{let p=new Ye(c?c.original.endLineNumberExclusive:s.startLineNumber,u?u.original.startLineNumber:s.endLineNumberExclusive),m=new Ye(c?c.modified.endLineNumberExclusive:a.startLineNumber,u?u.modified.startLineNumber:a.endLineNumberExclusive);p.forEach(g=>{o.push(new U8(g,m.startLineNumber+(g-p.startLineNumber)))}),u&&(u.original.forEach(g=>{o.push(new V8(u,g))}),u.modified.forEach(g=>{o.push(new W8(u,g))}))});let l=n[0].modified.join(n[n.length-1].modified),d=n[0].original.join(n[n.length-1].original);i.push(new F8(new Nr(l,d),o))}return i}var F8=class{constructor(t,e){this.range=t;this.lines=e}},B8=class{type=0},V8=class{constructor(t,e){this.diff=t;this.originalLineNumber=e}type=2;modifiedLineNumber=void 0},W8=class{constructor(t,e){this.diff=t;this.modifiedLineNumber=e}type=3;originalLineNumber=void 0},U8=class{constructor(t,e){this.originalLineNumber=t;this.modifiedLineNumber=e}type=1},Qx=class extends L{constructor(e,i,n,o,s,a){super();this._element=e;this._model=i;this._width=n;this._height=o;this._models=s;this._languageService=a;this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";let l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new gn(l)),this._register(Ut(d=>{this._actionBar.clear(),this._model.canClose.read(d)&&this._actionBar.push(new ot("diffreview.close",h("label.close","Close"),"close-diff-review "+ye.asClassName($pe),!0,async()=>i.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new Rd(this._content,{})),Tn(this.domNode,this._scrollbar.getDomNode(),l),this._register(Ut(d=>{this._height.read(d),this._width.read(d),this._scrollbar.scanDomNode()})),this._register(te(()=>{Tn(this.domNode)})),this._register(tl(this.domNode,{width:this._width,height:this._height})),this._register(tl(this._content,{width:this._width,height:this._height})),this._register(Qo((d,c)=>{this._model.currentGroup.read(d),this._render(c)})),this._register(Wi(this.domNode,"keydown",d=>{(d.equals(18)||d.equals(2066)||d.equals(530))&&(d.preventDefault(),this._model.goToNextLine()),(d.equals(16)||d.equals(2064)||d.equals(528))&&(d.preventDefault(),this._model.goToPreviousLine()),(d.equals(9)||d.equals(2057)||d.equals(521)||d.equals(1033))&&(d.preventDefault(),this._model.close()),(d.equals(10)||d.equals(3))&&(d.preventDefault(),this._model.revealCurrentElementInEditor())}))}domNode;_content;_scrollbar;_actionBar;_render(e){let i=this._models.getOriginalOptions(),n=this._models.getModifiedOptions(),o=document.createElement("div");o.className="diff-review-table",o.setAttribute("role","list"),o.setAttribute("aria-label",h("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),rn(o,n.get(51)),Tn(this._content,o);let s=this._models.getOriginalModel(),a=this._models.getModifiedModel();if(!s||!a)return;let l=s.getOptions(),d=a.getOptions(),c=n.get(68),u=this._model.currentGroup.get();for(let p of u?.lines||[]){if(!u)break;let m;if(p.type===0){let f=document.createElement("div");f.className="diff-review-row",f.setAttribute("role","listitem");let b=u.range,y=this._model.currentGroupIndex.get(),I=this._model.groups.get().length,E=k=>k===0?h("no_lines_changed","no lines changed"):k===1?h("one_line_changed","1 line changed"):h("more_lines_changed","{0} lines changed",k),S=E(b.original.length),w=E(b.modified.length);f.setAttribute("aria-label",h({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",y+1,I,b.original.startLineNumber,S,b.modified.startLineNumber,w));let D=document.createElement("div");D.className="diff-review-cell diff-review-summary",D.appendChild(document.createTextNode(`${y+1}/${I}: @@ -${b.original.startLineNumber},${b.original.length} +${b.modified.startLineNumber},${b.modified.length} @@`)),f.appendChild(D),m=f}else m=this._createRow(p,c,this._width.get(),i,s,l,n,a,d);o.appendChild(m);let g=et(f=>this._model.currentElement.read(f)===p);e.add(Ut(f=>{let b=g.read(f);m.tabIndex=b?0:-1,b&&m.focus()})),e.add(M(m,"focus",()=>{this._model.goToLine(p)}))}this._scrollbar.scanDomNode()}_createRow(e,i,n,o,s,a,l,d,c){let u=o.get(147),p=u.glyphMarginWidth+u.lineNumbersWidth,m=l.get(147),g=10+m.glyphMarginWidth+m.lineNumbersWidth,f="diff-review-row",b="",y="diff-review-spacer",I=null;switch(e.type){case 3:f="diff-review-row line-insert",b=" char-insert",I=qpe;break;case 2:f="diff-review-row line-delete",b=" char-delete",I=jpe;break}let E=document.createElement("div");E.style.minWidth=n+"px",E.className=f,E.setAttribute("role","listitem"),E.ariaLevel="";let S=document.createElement("div");S.className="diff-review-cell",S.style.height=`${i}px`,E.appendChild(S);let w=document.createElement("span");w.style.width=p+"px",w.style.minWidth=p+"px",w.className="diff-review-line-number"+b,e.originalLineNumber!==void 0?w.appendChild(document.createTextNode(String(e.originalLineNumber))):w.innerText="\xA0",S.appendChild(w);let D=document.createElement("span");D.style.width=g+"px",D.style.minWidth=g+"px",D.style.paddingRight="10px",D.className="diff-review-line-number"+b,e.modifiedLineNumber!==void 0?D.appendChild(document.createTextNode(String(e.modifiedLineNumber))):D.innerText="\xA0",S.appendChild(D);let k=document.createElement("span");if(k.className=y,I){let H=document.createElement("span");H.className=ye.asClassName(I),H.innerText="\xA0\xA0",k.appendChild(H)}else k.innerText="\xA0\xA0";S.appendChild(k);let R;if(e.modifiedLineNumber!==void 0){let H=this._getLineHtml(d,l,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);Tu._ttPolicy&&(H=Tu._ttPolicy.createHTML(H)),S.insertAdjacentHTML("beforeend",H),R=d.getLineContent(e.modifiedLineNumber)}else{let H=this._getLineHtml(s,o,a.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);Tu._ttPolicy&&(H=Tu._ttPolicy.createHTML(H)),S.insertAdjacentHTML("beforeend",H),R=s.getLineContent(e.originalLineNumber)}R.length===0&&(R=h("blankLine","blank"));let A="";switch(e.type){case 1:e.originalLineNumber===e.modifiedLineNumber?A=h({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",R,e.originalLineNumber):A=h("equalLine","{0} original line {1} modified line {2}",R,e.originalLineNumber,e.modifiedLineNumber);break;case 3:A=h("insertLine","+ {0} modified line {1}",R,e.modifiedLineNumber);break;case 2:A=h("deleteLine","- {0} original line {1}",R,e.originalLineNumber);break}return E.setAttribute("aria-label",A),E}_getLineHtml(e,i,n,o,s){let a=e.getLineContent(o),l=i.get(51),d=Mn.createEmpty(a,s),c=gu.isBasicASCII(a,e.mightContainNonBasicASCII()),u=gu.containsRTL(a,c,e.mightContainRTL());return see(new jm(l.isMonospace&&!i.get(33),l.canUseHalfwidthRightwardsArrow,a,!1,c,u,0,d,[],n,0,l.spaceWidth,l.middotWidth,l.wsmiddotWidth,i.get(119),i.get(101),i.get(96),i.get(52)!==vd.OFF,null)).html}};Qx=_([v(5,Hn)],Qx);var aN=class{constructor(t){this.editors=t}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(t){this.editors.original.revealRange(t),this.editors.original.setSelection(t),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(t){t&&(this.editors.modified.revealRange(t),this.editors.modified.setSelection(t)),this.editors.modified.focus()}modifiedSetSelection(t){this.editors.modified.setSelection(t)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}};var Qm=class r extends L{constructor(e,i,n,o,s){super();this._rootElement=e;this._diffModel=i;this._originalEditorLayoutInfo=n;this._modifiedEditorLayoutInfo=o;this._editors=s;this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(te(()=>this._element.remove())),this._register(Ut(u=>{let p=this._originalEditorLayoutInfo.read(u),m=this._modifiedEditorLayoutInfo.read(u);!p||!m||(this._element.style.left=`${p.width-p.verticalScrollbarWidth}px`,this._element.style.height=`${p.height}px`,this._element.style.width=`${p.verticalScrollbarWidth+p.contentLeft-r.movedCodeBlockPadding+this.width.read(u)}px`)})),this._register(Kb(this._state));let a=et(u=>{let m=this._diffModel.read(u)?.diff.read(u);return m?m.movedTexts.map(g=>({move:g,original:new Su(uh(g.lineRangeMapping.original.startLineNumber-1),18),modified:new Su(uh(g.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(OC(this._editors.original,a.map(u=>u.map(p=>p.original)))),this._register(OC(this._editors.modified,a.map(u=>u.map(p=>p.modified)))),this._register(Qo((u,p)=>{let m=a.read(u);for(let g of m)p.add(new lN(this._editors.original,g.original,g.move,"original",this._diffModel.get())),p.add(new lN(this._editors.modified,g.modified,g.move,"modified",this._diffModel.get()))}));let l=Jo("original.onDidFocusEditorWidget",u=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),d=Jo("modified.onDidFocusEditorWidget",u=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>u(void 0),0))),c="modified";this._register(ch({createEmptyChangeSummary:()=>{},handleChange:(u,p)=>(u.didChange(l)&&(c="original"),u.didChange(d)&&(c="modified"),!0)},u=>{l.read(u),d.read(u);let p=this._diffModel.read(u);if(!p)return;let m=p.diff.read(u),g;if(m&&c==="original"){let f=this._editors.originalCursor.read(u);f&&(g=m.movedTexts.find(b=>b.lineRangeMapping.original.contains(f.lineNumber)))}if(m&&c==="modified"){let f=this._editors.modifiedCursor.read(u);f&&(g=m.movedTexts.find(b=>b.lineRangeMapping.modified.contains(f.lineNumber)))}g!==p.movedTextToCompare.get()&&p.movedTextToCompare.set(void 0,void 0),p.setActiveMovedText(g)}))}static movedCodeBlockPadding=4;_element;_originalScrollTop=Ti(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop());_modifiedScrollTop=Ti(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop());_viewZonesChanged=Jo("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);width=Kt(this,0);_modifiedViewZonesChangedSignal=Jo("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);_originalViewZonesChangedSignal=Jo("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones);_state=Hu(this,(e,i)=>{this._element.replaceChildren();let n=this._diffModel.read(e),o=n?.diff.read(e)?.movedTexts;if(!o||o.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(e);let s=this._originalEditorLayoutInfo.read(e),a=this._modifiedEditorLayoutInfo.read(e);if(!s||!a){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(e),this._originalViewZonesChangedSignal.read(e);let l=o.map(f=>{function b(A,H){let z=H.getTopForLineNumber(A.startLineNumber,!0),Z=H.getTopForLineNumber(A.endLineNumberExclusive,!0);return(z+Z)/2}let y=b(f.lineRangeMapping.original,this._editors.original),I=this._originalScrollTop.read(e),E=b(f.lineRangeMapping.modified,this._editors.modified),S=this._modifiedScrollTop.read(e),w=y-I,D=E-S,k=Math.min(y,E),R=Math.max(y,E);return{range:new Xe(k,R),from:w,to:D,fromWithoutScroll:y,toWithoutScroll:E,move:f}});l.sort(I7(Qr(f=>f.fromWithoutScroll>f.toWithoutScroll,C7),Qr(f=>f.fromWithoutScroll>f.toWithoutScroll?f.fromWithoutScroll:-f.toWithoutScroll,hc)));let d=H8.compute(l.map(f=>f.range)),c=10,u=s.verticalScrollbarWidth,p=(d.getTrackCount()-1)*10+c*2,m=u+p+(a.contentLeft-r.movedCodeBlockPadding),g=0;for(let f of l){let b=d.getTrack(g),y=u+c+b*10,I=15,E=15,S=m,w=a.glyphMarginWidth+a.lineNumbersWidth,D=18,k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.classList.add("arrow-rectangle"),k.setAttribute("x",`${S-w}`),k.setAttribute("y",`${f.to-D/2}`),k.setAttribute("width",`${w}`),k.setAttribute("height",`${D}`),this._element.appendChild(k);let R=document.createElementNS("http://www.w3.org/2000/svg","g"),A=document.createElementNS("http://www.w3.org/2000/svg","path");A.setAttribute("d",`M 0 ${f.from} L ${y} ${f.from} L ${y} ${f.to} L ${S-E} ${f.to}`),A.setAttribute("fill","none"),R.appendChild(A);let H=document.createElementNS("http://www.w3.org/2000/svg","polygon");H.classList.add("arrow"),i.add(Ut(z=>{A.classList.toggle("currentMove",f.move===n.activeMovedText.read(z)),H.classList.toggle("currentMove",f.move===n.activeMovedText.read(z))})),H.setAttribute("points",`${S-E},${f.to-I/2} ${S},${f.to} ${S-E},${f.to+I/2}`),R.appendChild(H),this._element.appendChild(R),g++}this.width.set(p,void 0)})},H8=class r{constructor(t,e){this._trackCount=t;this.trackPerLineIdx=e}static compute(t){let e=[],i=[];for(let n of t){let o=e.findIndex(s=>!s.intersectsStrict(n));o===-1&&(e.length>=6?o=p7(e,Qr(a=>a.intersectWithRangeLength(n),hc)):(o=e.length,e.push(new Sk))),e[o].addRange(n),i.push(o)}return new r(e.length,i)}getTrack(t){return this.trackPerLineIdx[t]}getTrackCount(){return this._trackCount}},lN=class extends Sb{constructor(e,i,n,o,s){let a=gi("div.diff-hidden-lines-widget");super(e,i,a.root);this._editor=e;this._move=n;this._kind=o;this._diffModel=s;a.root.appendChild(this._nodes.root);let l=Ti(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(tl(this._nodes.root,{paddingRight:l.map(m=>m.verticalScrollbarWidth)}));let d;n.changes.length>0?d=this._kind==="original"?h("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):h("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):d=this._kind==="original"?h("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):h("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);let c=this._register(new gn(this._nodes.actionBar,{highlightToggledItems:!0})),u=new ot("",d,"",!1);c.push(u,{icon:!1,label:!0});let p=new ot("","Compare",ye.asClassName(B.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===n?void 0:this._move,void 0)});this._register(Ut(m=>{let g=this._diffModel.movedTextToCompare.read(m)===n;p.checked=g})),c.push(p,{icon:!1,label:!0})}_nodes=gi("div.diff-moved-code-block",{style:{marginRight:"4px"}},[gi("div.text-content@textContent"),gi("div.action-bar@actionBar")])};var dN=class extends L{constructor(e,i,n,o){super();this._editors=e;this._diffModel=i;this._options=n;this._register(MC(this._editors.original,this._decorations.map(s=>s?.originalDecorations||[]))),this._register(MC(this._editors.modified,this._decorations.map(s=>s?.modifiedDecorations||[])))}_decorations=et(this,e=>{let i=this._diffModel.read(e),n=i?.diff.read(e);if(!n)return null;let o=this._diffModel.read(e).movedTextToCompare.read(e),s=this._options.renderIndicators.read(e),a=this._options.showEmptyDecorations.read(e),l=[],d=[];if(!o)for(let u of n.mappings)if(u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:s?P8:O8}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:s?A8:M8}),u.lineRangeMapping.modified.isEmpty||u.lineRangeMapping.original.isEmpty)u.lineRangeMapping.original.isEmpty||l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:Zee}),u.lineRangeMapping.modified.isEmpty||d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:$ee});else{let p=this._options.useTrueInlineDiffRendering.read(e)&&jx(u.lineRangeMapping);for(let m of u.lineRangeMapping.innerChanges||[])if(u.lineRangeMapping.original.contains(m.originalRange.startLineNumber)&&l.push({range:m.originalRange,options:m.originalRange.isEmpty()&&a?Xee:qx}),u.lineRangeMapping.modified.contains(m.modifiedRange.startLineNumber)&&d.push({range:m.modifiedRange,options:m.modifiedRange.isEmpty()&&a&&!p?Yee:N8}),p){let g=i.model.original.getValueInRange(m.originalRange);d.push({range:m.modifiedRange,options:{description:"deleted-text",before:{content:g,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(o)for(let u of o.changes){let p=u.original.toInclusiveRange();p&&l.push({range:p,options:s?P8:O8});let m=u.modified.toInclusiveRange();m&&d.push({range:m,options:s?A8:M8});for(let g of u.innerChanges||[])l.push({range:g.originalRange,options:qx}),d.push({range:g.modifiedRange,options:N8})}let c=this._diffModel.read(e).activeMovedText.read(e);for(let u of n.movedTexts)l.push({range:u.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(u===c?" currentMove":""),blockPadding:[Qm.movedCodeBlockPadding,0,Qm.movedCodeBlockPadding,Qm.movedCodeBlockPadding]}}),d.push({range:u.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(u===c?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:l,modifiedDecorations:d}})};var cN=class{constructor(t,e){this._options=t;this.dimensions=e}sashLeft=zb(this,t=>{let e=this._sashRatio.read(t)??this._options.splitViewDefaultRatio.read(t);return this._computeSashLeft(e,t)},(t,e)=>{let i=this.dimensions.width.get();this._sashRatio.set(t/i,e)});_sashRatio=Kt(this,void 0);resetSash(){this._sashRatio.set(void 0,void 0)}_computeSashLeft(t,e){let i=this.dimensions.width.read(e),n=Math.floor(this._options.splitViewDefaultRatio.read(e)*i),o=this._options.enableSplitViewResizing.read(e)?Math.floor(t*i):n,s=100;return i<=s*2?n:o<s?s:o>i-s?i-s:o}},zC=class extends L{constructor(e,i,n,o,s,a){super();this._domNode=e;this._dimensions=i;this._enabled=n;this._boundarySashes=o;this.sashLeft=s;this._resetSash=a;this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(l=>{this.sashLeft.set(this._startSashPosition+(l.currentX-l.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(Ut(l=>{let d=this._boundarySashes.read(l);d&&(this._sash.orthogonalEndSash=d.bottom)})),this._register(Ut(l=>{let d=this._enabled.read(l);this._sash.state=d?3:0,this.sashLeft.read(l),this._dimensions.height.read(l),this._sash.layout()}))}_sash=this._register(new uf(this._domNode,{getVerticalSashTop:e=>0,getVerticalSashLeft:e=>this.sashLeft.get(),getVerticalSashHeight:e=>this._dimensions.height.get()},{orientation:0}));_startSashPosition=void 0};var uN=class extends L{constructor(e,i,n){super();this._editor=e;this._domNode=i;this.itemProvider=n;this._domNode.className="gutter monaco-editor";let o=this._domNode.appendChild(gi("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{Yi(a=>{this.domNodeSizeChanged.trigger(a)})});s.observe(this._domNode),this._register(te(()=>s.disconnect())),this._register(Ut(a=>{o.className=this.isScrollTopZero.read(a)?"":"scroll-decoration"})),this._register(Ut(a=>this.render(a)))}scrollTop=Ti(this,this._editor.onDidScrollChange,e=>this._editor.getScrollTop());isScrollTopZero=this.scrollTop.map(e=>e===0);modelAttached=Ti(this,this._editor.onDidChangeModel,e=>this._editor.hasModel());editorOnDidChangeViewZones=Jo("onDidChangeViewZones",this._editor.onDidChangeViewZones);editorOnDidContentSizeChange=Jo("onDidContentSizeChange",this._editor.onDidContentSizeChange);domNodeSizeChanged=bg("domNodeSizeChanged");dispose(){super.dispose(),Tn(this._domNode)}views=new Map;render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);let i=this.scrollTop.read(e),n=this._editor.getVisibleRanges(),o=new Set(this.views.keys()),s=Xe.ofStartAndLength(0,this._domNode.clientHeight);if(!s.isEmpty)for(let a of n){let l=new Ye(a.startLineNumber,a.endLineNumber+1),d=this.itemProvider.getIntersectingGutterItems(l,e);Yi(c=>{for(let u of d){if(!u.range.intersect(l))continue;o.delete(u.id);let p=this.views.get(u.id);if(p)p.item.set(u,c);else{let b=document.createElement("div");this._domNode.appendChild(b);let y=Kt("item",u),I=this.itemProvider.createView(y,b);p=new z8(y,I,b),this.views.set(u.id,p)}let m=u.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(u.range.startLineNumber,!0)-i:this._editor.getBottomForLineNumber(u.range.startLineNumber-1,!1)-i,f=(u.range.endLineNumberExclusive===1?Math.max(m,this._editor.getTopForLineNumber(u.range.startLineNumber,!1)-i):Math.max(m,this._editor.getBottomForLineNumber(u.range.endLineNumberExclusive-1,!0)-i))-m;p.domNode.style.top=`${m}px`,p.domNode.style.height=`${f}px`,p.gutterItemView.layout(Xe.ofStartAndLength(m,f),s)}})}for(let a of o){let l=this.views.get(a);l.gutterItemView.dispose(),l.domNode.remove(),this.views.delete(a)}}},z8=class{constructor(t,e,i){this.item=t;this.gutterItemView=e;this.domNode=i}};var pN=class extends wn{constructor(e){super();this._getContext=e}runAction(e,i){let n=this._getContext();return super.runAction(e,n)}};var Jx=class extends jT{constructor(e){super();this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}get length(){let e=this._textModel.getLineCount(),i=this._textModel.getLineLength(e);return new Ts(e-1,i)}};var K8=[],hN=35,KC=class extends L{constructor(e,i,n,o,s,a,l,d,c){super();this._diffModel=i;this._editors=n;this._options=o;this._sashLayout=s;this._boundarySashes=a;this._instantiationService=l;this._contextKeyService=d;this._menuService=c;this._register(Pee(e,this.elements.root)),this._register(M(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(tl(this.elements.root,{display:this._hasActions.map(p=>p?"block":"none")})),Ea(this,p=>this._showSash.read(p)?new zC(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,zb(this,g=>this._sashLayout.sashLeft.read(g)-hN,(g,f)=>this._sashLayout.sashLeft.set(g+hN,f)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);let u=et(this,p=>{let m=this._diffModel.read(p);if(!m)return[];let g=m.diff.read(p);if(!g)return[];let f=this._selectedDiffs.read(p);if(f.length>0){let y=ya.fromRangeMappings(f.flatMap(I=>I.rangeMappings));return[new mN(y,!0,ee.DiffEditorSelectionToolbar,void 0,m.model.original.uri,m.model.modified.uri)]}let b=this._currentDiff.read(p);return g.mappings.map(y=>new mN(y.lineRangeMapping.withInnerChangesFromLineRanges(),y.lineRangeMapping===b?.lineRangeMapping,ee.DiffEditorHunkToolbar,void 0,m.model.original.uri,m.model.modified.uri))});this._register(new uN(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(p,m)=>u.read(m),createView:(p,m)=>this._instantiationService.createInstance(e_,p,m,this)})),this._register(M(this.elements.gutter,G.MOUSE_WHEEL,p=>{this._editors.modified.getOption(105).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(p)},{passive:!1}))}_menu=this._register(this._menuService.createMenu(ee.DiffEditorHunkToolbar,this._contextKeyService));_actions=Ti(this,this._menu.onDidChange,()=>this._menu.getActions());_hasActions=this._actions.map(e=>e.length>0);_showSash=et(this,e=>this._options.renderSideBySide.read(e)&&this._hasActions.read(e));width=et(this,e=>this._hasActions.read(e)?hN:0);elements=gi("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:hN+"px"}},[]);computeStagedValue(e){let i=e.innerChanges??[],n=new Jx(this._editors.modifiedModel.get()),o=new Jx(this._editors.original.getModel());return new HM(i.map(l=>l.toTextEdit(n))).apply(o)}_currentDiff=et(this,e=>{let i=this._diffModel.read(e);if(!i)return;let n=i.diff.read(e)?.mappings,o=this._editors.modifiedCursor.read(e);if(o)return n?.find(s=>s.lineRangeMapping.modified.contains(o.lineNumber))});_selectedDiffs=et(this,e=>{let n=this._diffModel.read(e)?.diff.read(e);if(!n)return K8;let o=this._editors.modifiedSelections.read(e);if(o.every(d=>d.isEmpty()))return K8;let s=new Fa(o.map(d=>Ye.fromRangeInclusive(d))),l=n.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>o.some(u=>F.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?K8:l});layout(e){this.elements.gutter.style.left=e+"px"}};KC=_([v(6,ae),v(7,ke),v(8,Ri)],KC);var mN=class{constructor(t,e,i,n,o,s){this.mapping=t;this.showAlways=e;this.menuId=i;this.rangeOverride=n;this.originalUri=o;this.modifiedUri=s}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}},e_=class extends L{constructor(e,i,n,o){super();this._item=e;let s=this._register(o.createInstance(du,"element",!0,{position:{hoverPosition:1}}));this._register(Eb(i,this._elements.root)),this._register(Ut(a=>{let l=this._showAlways.read(a);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",l),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(Qo((a,l)=>{this._elements.buttons.replaceChildren();let d=l.add(o.createInstance(pu,this._elements.buttons,this._menuId.read(a),{orientation:1,hoverDelegate:s,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(a)?1:3},hiddenItemStrategy:0,actionRunner:new pN(()=>{let c=this._item.get(),u=c.mapping;return{mapping:u,originalWithModifiedChanges:n.computeStagedValue(u),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));l.add(d.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}_elements=gi("div.gutterItem",{style:{height:"20px",width:"34px"}},[gi("div.background@background",{},[]),gi("div.buttons@buttons",{},[])]);_showAlways=this._item.map(this,e=>e.showAlways);_menuId=this._item.map(this,e=>e.menuId);_isSmall=Kt(this,!1);_lastItemRange=void 0;_lastViewRange=void 0;layout(e,i){this._lastItemRange=e,this._lastViewRange=i;let n=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),n=this._elements.buttons.clientHeight;let o=e.length/2-n/2,s=n,a=e.start+o,l=Xe.tryCreate(s,i.endExclusive-s-n),d=Xe.tryCreate(e.start+s,e.endExclusive-n-s);d&&l&&d.start<d.endExclusive&&(a=l.clip(a),a=d.clip(a)),this._elements.buttons.style.top=`${a-e.start}px`}};e_=_([v(3,ae)],e_);var Qp=class extends L{constructor(e,i,n,o){super();this._editors=e;this._diffModel=i;this._options=n;this._instantiationService=o;this._register(this._editors.original.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();Yi(u=>{for(let p of this._editors.original.getSelections()||[])c?.ensureOriginalLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureOriginalLineIsVisible(p.getEndPosition().lineNumber,0,u)})})),this._register(this._editors.modified.onDidChangeCursorPosition(d=>{if(d.reason===1)return;let c=this._diffModel.get();Yi(u=>{for(let p of this._editors.modified.getSelections()||[])c?.ensureModifiedLineIsVisible(p.getStartPosition().lineNumber,0,u),c?.ensureModifiedLineIsVisible(p.getEndPosition().lineNumber,0,u)})}));let s=this._diffModel.map((d,c)=>{let u=d?.unchangedRegions.read(c)??[];return u.length===1&&u[0].modifiedLineNumber===1&&u[0].lineCount===this._editors.modifiedModel.read(c)?.getLineCount()?[]:u});this.viewZones=Hu(this,(d,c)=>{let u=this._modifiedOutlineSource.read(d);if(!u)return{origViewZones:[],modViewZones:[]};let p=[],m=[],g=this._options.renderSideBySide.read(d),f=this._options.compactMode.read(d),b=s.read(d);for(let y=0;y<b.length;y++){let I=b[y];if(!I.shouldHideControls(d)&&!(f&&(y===0||y===b.length-1)))if(f){{let E=et(this,w=>I.getHiddenOriginalRange(w).startLineNumber-1),S=new Su(E,12);p.push(S),c.add(new gN(this._editors.original,S,I,!g))}{let E=et(this,w=>I.getHiddenModifiedRange(w).startLineNumber-1),S=new Su(E,12);m.push(S),c.add(new gN(this._editors.modified,S,I))}}else{{let E=et(this,w=>I.getHiddenOriginalRange(w).startLineNumber-1),S=new Su(E,24);p.push(S),c.add(new fN(this._editors.original,S,I,I.originalUnchangedRange,!g,u,w=>this._diffModel.get().ensureModifiedLineIsVisible(w,2,void 0),this._options))}{let E=et(this,w=>I.getHiddenModifiedRange(w).startLineNumber-1),S=new Su(E,24);m.push(S),c.add(new fN(this._editors.modified,S,I,I.modifiedUnchangedRange,!1,u,w=>this._diffModel.get().ensureModifiedLineIsVisible(w,2,void 0),this._options))}}}return{origViewZones:p,modViewZones:m}});let a={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},l={description:"Fold Unchanged",glyphMarginHoverMessage:new kg(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(h("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+ye.asClassName(B.fold),zIndex:10001};this._register(MC(this._editors.original,et(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.originalUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:F.fromPositions(new U(p.originalLineNumber,1)),options:l});return u}))),this._register(MC(this._editors.modified,et(this,d=>{let c=s.read(d),u=c.map(p=>({range:p.modifiedUnchangedRange.toInclusiveRange(),options:a}));for(let p of c)p.shouldHideControls(d)&&u.push({range:Ye.ofLength(p.modifiedLineNumber,1).toInclusiveRange(),options:l});return u}))),this._register(Ut(d=>{let c=s.read(d);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(u=>u.getHiddenOriginalRange(d).toInclusiveRange()).filter(zu)),this._editors.modified.setHiddenAreas(c.map(u=>u.getHiddenModifiedRange(d).toInclusiveRange()).filter(zu))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(m=>m.modifiedUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(d=>{if(!d.event.rightButton&&d.target.position&&d.target.element?.className.includes("fold-unchanged")){let c=d.target.position.lineNumber,u=this._diffModel.get();if(!u)return;let p=u.unchangedRegions.get().find(m=>m.originalUnchangedRange.includes(c));if(!p)return;p.collapseAll(void 0),d.event.stopPropagation(),d.event.preventDefault()}}))}static _breadcrumbsSourceFactory=Kt(Qp,()=>({dispose(){},getBreadcrumbItems(e,i){return[]}}));static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}_modifiedOutlineSource=Ea(this,e=>{let i=this._editors.modifiedModel.read(e),n=Qp._breadcrumbsSourceFactory.read(e);return!i||!n?void 0:n(i,this._instantiationService)});viewZones;_isUpdatingHiddenAreas=!1;get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}};Qp=_([v(3,ae)],Qp);var gN=class extends Sb{constructor(e,i,n,o=!1){let s=gi("div.diff-hidden-lines-widget");super(e,i,s.root);this._unchangedRegion=n;this._hide=o;s.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(Ut(a=>{if(!this._hide){let l=this._unchangedRegion.getHiddenModifiedRange(a).length,d=h("hiddenLines","{0} hidden lines",l);this._nodes.text.innerText=d}}))}_nodes=gi("div.diff-hidden-lines-compact",[gi("div.line-left",[]),gi("div.text@text",[]),gi("div.line-right",[])])},fN=class extends Sb{constructor(e,i,n,o,s,a,l,d){let c=gi("div.diff-hidden-lines-widget");super(e,i,c.root);this._editor=e;this._unchangedRegion=n;this._unchangedRegionRange=o;this._hide=s;this._modifiedOutlineSource=a;this._revealModifiedHiddenLine=l;this._options=d;c.root.appendChild(this._nodes.root),this._hide?Tn(this._nodes.first):this._register(tl(this._nodes.first,{width:Tb(this._editor).layoutInfoContentLeft})),this._register(Ut(p=>{let m=this._unchangedRegion.visibleLineCountTop.read(p)+this._unchangedRegion.visibleLineCountBottom.read(p)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!m),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),this._nodes.top.classList.toggle("canMoveBottom",!m);let g=this._unchangedRegion.isDragged.read(p),f=this._editor.getDomNode();f&&(f.classList.toggle("draggingUnchangedRegion",!!g),g==="top"?(f.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(p)>0),f.classList.toggle("canMoveBottom",!m)):g==="bottom"?(f.classList.toggle("canMoveTop",!m),f.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(p)>0)):(f.classList.toggle("canMoveTop",!1),f.classList.toggle("canMoveBottom",!1)))}));let u=this._editor;this._register(M(this._nodes.top,"mousedown",p=>{if(p.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let m=p.clientY,g=!1,f=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);let b=oe(this._nodes.top),y=M(b,"mousemove",E=>{let w=E.clientY-m;g=g||Math.abs(w)>2;let D=Math.round(w/u.getOption(68)),k=Math.max(0,Math.min(f+D,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(k,void 0)}),I=M(b,"mouseup",E=>{g||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),y.dispose(),I.dispose()})})),this._register(M(this._nodes.bottom,"mousedown",p=>{if(p.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),p.preventDefault();let m=p.clientY,g=!1,f=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);let b=oe(this._nodes.bottom),y=M(b,"mousemove",E=>{let w=E.clientY-m;g=g||Math.abs(w)>2;let D=Math.round(w/u.getOption(68)),k=Math.max(0,Math.min(f-D,this._unchangedRegion.getMaxVisibleLineCountBottom())),R=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(k,void 0);let A=this._unchangedRegionRange.endLineNumberExclusive>u.getModel().getLineCount()?u.getContentHeight():u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(A-R))}),I=M(b,"mouseup",E=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!g){let S=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);let w=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(w-S))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),y.dispose(),I.dispose()})})),this._register(Ut(p=>{let m=[];if(!this._hide){let g=n.getHiddenModifiedRange(p).length,f=h("hiddenLines","{0} hidden lines",g),b=re("span",{title:h("diff.hiddenLines.expandAll","Double click to unfold")},f);b.addEventListener("dblclick",E=>{E.button===0&&(E.preventDefault(),this._unchangedRegion.showAll(void 0))}),m.push(b);let y=this._unchangedRegion.getHiddenModifiedRange(p),I=this._modifiedOutlineSource.getBreadcrumbItems(y,p);if(I.length>0){m.push(re("span",void 0,"\xA0\xA0|\xA0\xA0"));for(let E=0;E<I.length;E++){let S=I[E],w=gU.toIcon(S.kind),D=gi("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[Md(w),"\xA0",S.name,...E===I.length-1?[]:[Md(B.chevronRight)]]).root;m.push(D),D.onclick=()=>{this._revealModifiedHiddenLine(S.startLineNumber)}}}}Tn(this._nodes.others,...m)}))}_nodes=gi("div.diff-hidden-lines",[gi("div.top@top",{title:h("diff.hiddenLines.top","Click or drag to show more above")}),gi("div.center@content",{style:{display:"flex"}},[gi("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[re("a",{title:h("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Rs("$(unfold)"))]),gi("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),gi("div.bottom@bottom",{title:h("diff.bottom","Click or drag to show more below"),role:"button"})])};var G8=[],bN=class extends L{constructor(e,i,n,o){super();this._editors=e;this._diffModel=i;this._options=n;this._widget=o;this._register(Qo((s,a)=>{if(!this._options.shouldRenderOldRevertArrows.read(s))return;let l=this._diffModel.read(s),d=l?.diff.read(s);if(!l||!d||l.movedTextToCompare.read(s))return;let c=[],u=this._selectedDiffs.read(s),p=new Set(u.map(m=>m.mapping));if(u.length>0){let m=this._editors.modifiedSelections.read(s),g=a.add(new vN(m[m.length-1].positionLineNumber,this._widget,u.flatMap(f=>f.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}for(let m of d.mappings)if(!p.has(m)&&!m.lineRangeMapping.modified.isEmpty&&m.lineRangeMapping.innerChanges){let g=a.add(new vN(m.lineRangeMapping.modified.startLineNumber,this._widget,m.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}a.add(te(()=>{for(let m of c)this._editors.modified.removeGlyphMarginWidget(m)}))}))}_selectedDiffs=et(this,e=>{let n=this._diffModel.read(e)?.diff.read(e);if(!n)return G8;let o=this._editors.modifiedSelections.read(e);if(o.every(d=>d.isEmpty()))return G8;let s=new Fa(o.map(d=>Ye.fromRangeInclusive(d))),l=n.mappings.filter(d=>d.lineRangeMapping.innerChanges&&s.intersects(d.lineRangeMapping.modified)).map(d=>({mapping:d,rangeMappings:d.lineRangeMapping.innerChanges.filter(c=>o.some(u=>F.areIntersecting(c.modifiedRange,u)))}));return l.length===0||l.every(d=>d.rangeMappings.length===0)?G8:l})},vN=class r extends L{constructor(e,i,n,o){super();this._lineNumber=e;this._widget=i;this._diffs=n;this._revertSelection=o;this._register(M(this._domNode,G.MOUSE_DOWN,s=>{s.button!==2&&(s.stopPropagation(),s.preventDefault())})),this._register(M(this._domNode,G.MOUSE_UP,s=>{s.stopPropagation(),s.preventDefault()})),this._register(M(this._domNode,G.CLICK,s=>{this._diffs instanceof Nr?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),s.stopPropagation(),s.preventDefault()}))}static counter=0;_id=`revertButton${r.counter++}`;getId(){return this._id}_domNode=gi("div.revertButton",{title:this._revertSelection?h("revertSelectedChanges","Revert Selected Changes"):h("revertChange","Revert Change")},[Md(B.arrowRight)]).root;getDomNode(){return this._domNode}getPosition(){return{lane:3,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};var yN=class r extends L{static idCounter=0;_id=++r.idCounter;_onDidDispose=this._register(new T);onDidDispose=this._onDidDispose.event;getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(t){return this._targetEditor.getVisibleColumnFromPosition(t)}getStatusbarColumn(t){return this._targetEditor.getStatusbarColumn(t)}getPosition(){return this._targetEditor.getPosition()}setPosition(t,e="api"){this._targetEditor.setPosition(t,e)}revealLine(t,e=0){this._targetEditor.revealLine(t,e)}revealLineInCenter(t,e=0){this._targetEditor.revealLineInCenter(t,e)}revealLineInCenterIfOutsideViewport(t,e=0){this._targetEditor.revealLineInCenterIfOutsideViewport(t,e)}revealLineNearTop(t,e=0){this._targetEditor.revealLineNearTop(t,e)}revealPosition(t,e=0){this._targetEditor.revealPosition(t,e)}revealPositionInCenter(t,e=0){this._targetEditor.revealPositionInCenter(t,e)}revealPositionInCenterIfOutsideViewport(t,e=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(t,e)}revealPositionNearTop(t,e=0){this._targetEditor.revealPositionNearTop(t,e)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(t,e="api"){this._targetEditor.setSelection(t,e)}setSelections(t,e="api"){this._targetEditor.setSelections(t,e)}revealLines(t,e,i=0){this._targetEditor.revealLines(t,e,i)}revealLinesInCenter(t,e,i=0){this._targetEditor.revealLinesInCenter(t,e,i)}revealLinesInCenterIfOutsideViewport(t,e,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(t,e,i)}revealLinesNearTop(t,e,i=0){this._targetEditor.revealLinesNearTop(t,e,i)}revealRange(t,e=0,i=!1,n=!0){this._targetEditor.revealRange(t,e,i,n)}revealRangeInCenter(t,e=0){this._targetEditor.revealRangeInCenter(t,e)}revealRangeInCenterIfOutsideViewport(t,e=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(t,e)}revealRangeNearTop(t,e=0){this._targetEditor.revealRangeNearTop(t,e)}revealRangeNearTopIfOutsideViewport(t,e=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(t,e)}revealRangeAtTop(t,e=0){this._targetEditor.revealRangeAtTop(t,e)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(t,e,i){this._targetEditor.trigger(t,e,i)}createDecorationsCollection(t){return this._targetEditor.createDecorationsCollection(t)}changeDecorations(t){return this._targetEditor.changeDecorations(t)}};var xb=class extends yN{constructor(e,i,n,o,s,a,l,d){super();this._domElement=e;this._parentContextKeyService=o;this._parentInstantiationService=s;this._accessibilitySignalService=l;this._editorProgressService=d;a.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(te(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new X1(this.elements.root,i.dimension)),this._rootSizeObserver.setAutomaticLayout(i.automaticLayout??!1),this._options=this._instantiationService.createInstance(VC,i),this._register(Ut(w=>{this._options.setWidth(this._rootSizeObserver.width.read(w))})),this._contextKeyService.createKey(Re.isEmbeddedDiffEditor.key,!1),this._register(lu(Re.isEmbeddedDiffEditor,this._contextKeyService,w=>this._options.isInEmbeddedEditor.read(w))),this._register(lu(Re.comparingMovedCode,this._contextKeyService,w=>!!this._diffModel.read(w)?.movedTextToCompare.read(w))),this._register(lu(Re.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,w=>this._options.couldShowInlineViewBecauseOfSize.read(w))),this._register(lu(Re.diffEditorInlineMode,this._contextKeyService,w=>!this._options.renderSideBySide.read(w))),this._register(lu(Re.hasChanges,this._contextKeyService,w=>(this._diffModel.read(w)?.diff.read(w)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(HC,this.elements.original,this.elements.modified,this._options,n,(w,D,k,R)=>this._createInnerEditor(w,D,k,R))),this._register(lu(Re.diffEditorOriginalWritable,this._contextKeyService,w=>this._options.originalEditable.read(w))),this._register(lu(Re.diffEditorModifiedWritable,this._contextKeyService,w=>!this._options.readOnly.read(w))),this._register(lu(Re.diffEditorOriginalUri,this._contextKeyService,w=>this._diffModel.read(w)?.model.original.uri.toString()??"")),this._register(lu(Re.diffEditorModifiedUri,this._contextKeyService,w=>this._diffModel.read(w)?.model.modified.uri.toString()??"")),this._overviewRulerPart=Ea(this,w=>this._options.renderOverviewRuler.read(w)?this._instantiationService.createInstance(Hl(Zo,w),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(D=>D.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);let c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((w,D)=>w-(this._overviewRulerPart.read(D)?.width??0))};this._sashLayout=new cN(this._options,c),this._sash=Ea(this,w=>{let D=this._options.renderSideBySide.read(w);return this.elements.root.classList.toggle("side-by-side",D),D?new zC(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);let u=Ea(this,w=>this._instantiationService.createInstance(Hl(Qp,w),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);Ea(this,w=>this._instantiationService.createInstance(Hl(dN,w),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);let p=new Set,m=new Set,g=!1,f=Ea(this,w=>this._instantiationService.createInstance(Hl(BC,w),oe(this._domElement),this._editors,this._diffModel,this._options,this,()=>g||u.get().isUpdatingHiddenAreas,p,m)).recomputeInitiallyAndOnChange(this._store),b=et(this,w=>{let D=f.read(w).viewZones.read(w).orig,k=u.read(w).viewZones.read(w).origViewZones;return D.concat(k)}),y=et(this,w=>{let D=f.read(w).viewZones.read(w).mod,k=u.read(w).viewZones.read(w).modViewZones;return D.concat(k)});this._register(OC(this._editors.original,b,w=>{g=w},p));let I;this._register(OC(this._editors.modified,y,w=>{g=w,g?I=K0.capture(this._editors.modified):(I?.restore(this._editors.modified),I=void 0)},m)),this._accessibleDiffViewer=Ea(this,w=>this._instantiationService.createInstance(Hl(Tu,w),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(D,k)=>this._accessibleDiffViewerShouldBeVisible.set(D,k),this._options.onlyShowAccessibleDiffViewer.map(D=>!D),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((D,k)=>D?.diff.read(k)?.mappings.map(R=>R.lineRangeMapping)),new aN(this._editors))).recomputeInitiallyAndOnChange(this._store);let E=this._accessibleDiffViewerVisible.map(w=>w?"hidden":"visible");this._register(tl(this.elements.modified,{visibility:E})),this._register(tl(this.elements.original,{visibility:E})),this._createDiffEditorContributions(),a.addDiffEditor(this),this._gutter=Ea(this,w=>this._options.shouldRenderGutterMenu.read(w)?this._instantiationService.createInstance(Hl(KC,w),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(Kb(this._layoutInfo)),Ea(this,w=>new(Hl(Qm,w))(this.elements.root,this._diffModel,this._layoutInfo.map(D=>D.originalEditor),this._layoutInfo.map(D=>D.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,w=>{this._movedBlocksLinesPart.set(w,void 0)}),this._register(O.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,w=>this._handleCursorPositionChange(w,!0))),this._register(O.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,w=>this._handleCursorPositionChange(w,!1)));let S=this._diffModel.map(this,(w,D)=>{if(w)return w.diff.read(D)===void 0&&!w.isDiffUpToDate.read(D)});this._register(Qo((w,D)=>{if(S.read(w)===!0){let k=this._editorProgressService.show(!0,1e3);D.add(te(()=>k.done()))}})),this._register(Qo((w,D)=>{D.add(new(Hl(bN,w))(this._editors,this._diffModel,this._options,this))})),this._register(Qo((w,D)=>{let k=this._diffModel.read(w);if(k)for(let R of[k.model.original,k.model.modified])D.add(R.onWillDispose(A=>{Ke(new yt("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(Ut(w=>{this._options.setModel(this._diffModel.read(w))}))}static ENTIRE_DIFF_OVERVIEW_WIDTH=Zo.ENTIRE_DIFF_OVERVIEW_WIDTH;elements=gi("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[gi("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),gi("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),gi("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]);_diffModelSrc=this._register(pB(this,void 0));_diffModel=et(this,e=>this._diffModelSrc.read(e)?.object);onDidChangeModel=O.fromObservableLight(this._diffModel);get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}_contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement));_instantiationService=this._register(this._parentInstantiationService.createChild(new Wr([ke,this._contextKeyService])));_rootSizeObserver;_sashLayout;_sash;_boundarySashes=Kt(this,void 0);_accessibleDiffViewerShouldBeVisible=Kt(this,!1);_accessibleDiffViewerVisible=et(this,e=>this._options.onlyShowAccessibleDiffViewer.read(e)?!0:this._accessibleDiffViewerShouldBeVisible.read(e));_accessibleDiffViewer;_options;_editors;_overviewRulerPart;_movedBlocksLinesPart=Kt(this,void 0);_gutter;get collapseUnchangedRegions(){return this._options.hideUnchangedRegions.get()}getViewWidth(){return this._rootSizeObserver.width.get()}getContentHeight(){return this._editors.modified.getContentHeight()}_createInnerEditor(e,i,n,o){return e.createInstance(Ul,i,n,o)}_layoutInfo=et(this,e=>{let i=this._rootSizeObserver.width.read(e),n=this._rootSizeObserver.height.read(e);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=n+"px";let o=this._sash.read(e),s=this._gutter.read(e),a=s?.width.read(e)??0,l=this._overviewRulerPart.read(e)?.width??0,d,c,u,p,m;if(!!o){let f=o.sashLeft.read(e),b=this._movedBlocksLinesPart.read(e)?.width.read(e)??0;d=0,c=f-a-b,m=f-a,u=f,p=i-u-l}else{m=0;let f=this._options.inlineViewHideOriginalLineNumbers.read(e);d=a,f?c=0:c=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(e)),u=a+c,p=i-u-l}return this.elements.original.style.left=d+"px",this.elements.original.style.width=c+"px",this._editors.original.layout({width:c,height:n},!0),s?.layout(m),this.elements.modified.style.left=u+"px",this.elements.modified.style.width=p+"px",this._editors.modified.layout({width:p,height:n},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}});_createDiffEditorContributions(){let e=Xf.getDiffEditorContributions();for(let i of e)try{this._register(this._instantiationService.createInstance(i.ctor,this))}catch(n){Ke(n)}}get _targetEditor(){return this._editors.modified}getEditorType(){return Yg.IDiffEditor}onVisible(){this._editors.original.onVisible(),this._editors.modified.onVisible()}onHide(){this._editors.original.onHide(),this._editors.modified.onHide()}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){let e=this._editors.original.saveViewState(),i=this._editors.modified.saveViewState();return{original:e,modified:i,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(e){if(e&&e.original&&e.modified){let i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&this._diffModel.get()?.restoreSerializedState(i.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(WC,e,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(e){let i=e?"model"in e?wb.create(e).createNewRef(this):wb.create(this.createViewModel(e),this):null;this.setDiffModel(i)}setDiffModel(e,i){let n=this._diffModel.get();!e&&n&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==e?.object&&vg(i,o=>{let s=e?.object;Ti.batchEventsGlobally(o,()=>{this._editors.original.setModel(s?s.model.original:null),this._editors.modified.setModel(s?s.model.modified:null)});let a=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(e?.createNewRef(this),o),setTimeout(()=>{a?.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}setBoundarySashes(e){this._boundarySashes.set(e,void 0)}_diffValue=this._diffModel.map((e,i)=>e?.diff.read(i));onDidUpdateDiff=O.fromObservableLight(this._diffValue);get ignoreTrimWhitespace(){return this._options.ignoreTrimWhitespace.get()}get maxComputationTime(){return this._options.maxComputationTimeMs.get()}get renderSideBySide(){return this._options.renderSideBySide.get()}getLineChanges(){let e=this._diffModel.get()?.diff.get();return e?Zpe(e):null}getDiffComputationResult(){let e=this._diffModel.get()?.diff.get();return e?{changes:this.getLineChanges(),changes2:e.mappings.map(i=>i.lineRangeMapping),identical:e.identical,quitEarly:e.quitEarly}:null}revert(e){let i=this._diffModel.get();!i||!i.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:i.model.original.getValueInRange(e.original.toExclusiveRange())}])}revertRangeMappings(e){let i=this._diffModel.get();if(!i||!i.isDiffUpToDate.get())return;let n=e.map(o=>({range:o.modifiedRange,text:i.model.original.getValueInRange(o.originalRange)}));this._editors.modified.executeEdits("diffEditor",n)}_goTo(e){this._editors.modified.setPosition(new U(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){let i=this._diffModel.get()?.diff.get()?.mappings;if(!i||i.length===0)return;let n=this._editors.modified.getPosition().lineNumber,o;e==="next"?o=i.find(s=>s.lineRangeMapping.modified.startLineNumber>n)??i[0]:o=ug(i,s=>s.lineRangeMapping.modified.startLineNumber<n)??i[i.length-1],this._goTo(o),o.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(mo.diffLineDeleted,{source:"diffEditor.goToDiff"}):o.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(mo.diffLineInserted,{source:"diffEditor.goToDiff"}):o&&this._accessibilitySignalService.playSignal(mo.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){let e=this._diffModel.get();e&&this.waitForDiff().then(()=>{let i=e.diff.get()?.mappings;!i||i.length===0||this._goTo(i[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){let e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){let e=this._editors.modified.hasWidgetFocus(),i=e?this._editors.modified:this._editors.original,n=e?this._editors.original:this._editors.modified,o,s=i.getSelection();if(s){let a=this._diffModel.get()?.diff.get()?.mappings.map(l=>e?l.lineRangeMapping.flip():l.lineRangeMapping);if(a){let l=E8(s.getStartPosition(),a),d=E8(s.getEndPosition(),a);o=F.plusRange(l,d)}}return{destination:n,destinationSelection:o}}switchSide(){let{destination:e,destinationSelection:i}=this.mapToOtherSide();e.focus(),i&&e.setSelection(i)}exitCompareMove(){let e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){let e=this._diffModel.get()?.unchangedRegions.get();e&&Yi(i=>{for(let n of e)n.collapseAll(i)})}showAllUnchangedRegions(){let e=this._diffModel.get()?.unchangedRegions.get();e&&Yi(i=>{for(let n of e)n.showAll(i)})}_handleCursorPositionChange(e,i){if(e?.reason===3){let n=this._diffModel.get()?.diff.get()?.mappings.find(o=>i?o.lineRangeMapping.modified.contains(e.position.lineNumber):o.lineRangeMapping.original.contains(e.position.lineNumber));n?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(mo.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):n?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(mo.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):n&&this._accessibilitySignalService.playSignal(mo.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};xb=_([v(3,ke),v(4,ae),v(5,fu),v(6,Rl),v(7,qR)],xb);function Zpe(r){return r.mappings.map(t=>{let e=t.lineRangeMapping,i,n,o,s,a=e.innerChanges;return e.original.isEmpty?(i=e.original.startLineNumber-1,n=0,a=void 0):(i=e.original.startLineNumber,n=e.original.endLineNumberExclusive-1),e.modified.isEmpty?(o=e.modified.startLineNumber-1,s=0,a=void 0):(o=e.modified.startLineNumber,s=e.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:o,modifiedEndLineNumber:s,charChanges:a?.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var Jm=class extends Km{constructor(e,i,n,o,s,a,l,d,c,u){super(Jm.ID,e,i,n,o,s,l,a,d,c);this.preferencesService=u}static ID=eA;diffEditorControl=void 0;inputLifecycleStopWatch=void 0;get scopedContextKeyService(){if(!this.diffEditorControl)return;let e=this.diffEditorControl.getOriginalEditor(),i=this.diffEditorControl.getModifiedEditor();return(e.hasTextFocus()?e:i).invokeWithinContext(n=>n.get(ke))}getTitle(){return this.input?this.input.getName():h("textDiffEditor","Text Diff Editor")}createEditorControl(e,i){this.diffEditorControl=this._register(this.instantiationService.createInstance(xb,e,i,{}))}updateEditorControlOptions(e){this.diffEditorControl?.updateOptions(e)}getMainControl(){return this.diffEditorControl?.getModifiedEditor()}_previousViewModel=null;async setInput(e,i,n,o){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),this.inputLifecycleStopWatch=void 0,await super.setInput(e,i,n,o);try{let s=await e.resolve();if(o.isCancellationRequested)return;if(!(s instanceof tC)){this.openAsBinary(e,i);return}let a=Ue(this.diffEditorControl),l=s,d=l.textDiffEditorModel?a.createViewModel(l.textDiffEditorModel):null;this._previousViewModel=d,await d?.waitForDiff(),a.setModel(d);let c=!1;zE(i?.viewState)||(c=this.restoreTextDiffEditorViewState(e,i,n,a));let u=!1;i&&(u=J4(i,a,1)),!u&&!c&&a.revealFirstDiff(),a.updateOptions({...this.getReadonlyConfiguration(l.modifiedModel?.isReadonly()),originalEditable:!l.originalModel?.isReadonly()}),a.handleInitialized(),this.inputLifecycleStopWatch=new ll(!1)}catch(s){await this.handleSetInputError(s,e,i)}}async handleSetInputError(e,i,n){if(this.isFileBinaryError(e))return this.openAsBinary(i,n);if(e.fileOperationResult===7){let o;throw e instanceof _h?o=h("fileTooLargeForHeapErrorWithSize","At least one file is not displayed in the text compare editor because it is very large ({0}).",uv.formatSize(e.size)):o=h("fileTooLargeForHeapErrorWithoutSize","At least one file is not displayed in the text compare editor because it is very large."),MZ(this.group,i,n,o,this.preferencesService)}throw e}restoreTextDiffEditorViewState(e,i,n,o){let s=this.loadEditorViewState(e,n);return s?(i?.selection&&s.modified&&(s.modified.cursorState=[]),o.restoreViewState(s),i?.revealIfVisible&&o.revealFirstDiff(),!0):!1}openAsBinary(e,i){let n=e.original,o=e.modified,s=this.instantiationService.createInstance(Yr,e.getName(),e.getDescription(),n,o,!0),a=Ne.as(Ua.EditorFactory).getFileEditorFactory();a.isFileEditor(n)&&n.setForceOpenAsBinary(),a.isFileEditor(o)&&o.setForceOpenAsBinary(),this.group.replaceEditors([{editor:e,replacement:s,options:{...i,activation:3,pinned:this.group.isPinned(e),sticky:this.group.isSticky(e)}}])}setOptions(e){super.setOptions(e),e&&J4(e,Ue(this.diffEditorControl),0)}shouldHandleConfigurationChangeEvent(e,i){return super.shouldHandleConfigurationChangeEvent(e,i)?!0:e.affectsConfiguration(i,"diffEditor")||e.affectsConfiguration(i,"accessibility.verbosity.diffEditor")}computeConfiguration(e){let i=super.computeConfiguration(e);if(Mi(e.diffEditor)){let o=Cs(e.diffEditor);o.diffCodeLens=o.codeLens,delete o.codeLens,o.diffWordWrap=o.wordWrap,delete o.wordWrap,Object.assign(i,o)}let n=e.accessibility?.verbosity?.diffEditor??!1;return i.accessibilityVerbose=n,i}getConfigurationOverrides(e){return{...super.getConfigurationOverrides(e),...this.getReadonlyConfiguration(this.input?.isReadonly()),originalEditable:this.input instanceof Yr&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"}}updateReadonly(e){e instanceof Yr?this.diffEditorControl?.updateOptions({...this.getReadonlyConfiguration(e.isReadonly()),originalEditable:!e.original.isReadonly()}):super.updateReadonly(e)}isFileBinaryError(e){return Array.isArray(e)?e.some(n=>this.isFileBinaryError(n)):e.textFileOperationResult===0}clearInput(){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),super.clearInput();let e=this.inputLifecycleStopWatch?.elapsed();this.inputLifecycleStopWatch=void 0,typeof e=="number"&&this.logInputLifecycleTelemetry(e,this.getControl()?.getModel()?.modified?.getLanguageId()),this.diffEditorControl?.setModel(null)}logInputLifecycleTelemetry(e,i){let n=!1;this.diffEditorControl instanceof xb&&(n=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:e,languageId:i??"",collapseUnchangedRegions:n})}getControl(){return this.diffEditorControl}focus(){super.focus(),this.diffEditorControl?.focus()}hasFocus(){return this.diffEditorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e),e?this.diffEditorControl?.onVisible():this.diffEditorControl?.onHide()}layout(e){this.diffEditorControl?.layout(e)}setBoundarySashes(e){this.diffEditorControl?.setBoundarySashes(e)}tracksEditorViewState(e){return e instanceof Yr}computeEditorViewState(e){if(!this.diffEditorControl)return;let i=this.diffEditorControl.getModel();if(!i||!i.modified||!i.original)return;let n=this.toEditorViewStateResource(i);if(n&&Wn(n,e))return this.diffEditorControl.saveViewState()??void 0}toEditorViewStateResource(e){let i,n;if(e instanceof Yr?(i=e.original.resource,n=e.modified.resource):Do(e)||(i=e.original.uri,n=e.modified.uri),!(!i||!n))return q.from({scheme:"diff",path:`${Gv(i.toString())}${Gv(n.toString())}`})}};Jm=_([v(1,qt),v(2,ae),v(3,tt),v(4,_s),v(5,kt),v(6,Ze),v(7,di),v(8,ai),v(9,Ld)],Jm);var q8=$("pathService"),GC=class{constructor(t,e,i,n){this.localUserHome=t;this.remoteAgentService=e;this.environmentService=i;this.contextService=n;this.resolveOS=(async()=>(await this.remoteAgentService.getEnvironment())?.os||Hs)(),this.resolveUserHome=(async()=>{let o=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=o?.userHome??t})()}resolveOS;resolveUserHome;maybeUnresolvedUserHome;hasValidBasename(t,e,i){return typeof e=="string"||typeof e>"u"?this.resolveOS.then(n=>this.doHasValidBasename(t,n,e)):this.doHasValidBasename(t,e,i)}doHasValidBasename(t,e,i){return t.scheme===he.file||t.scheme===he.vscodeRemote?rG(i??Tr(t),e===1):!0}get defaultUriScheme(){return GC.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(t,e){if(t.remoteAuthority)return he.vscodeRemote;let i=T0(e.getWorkspace());if(i)return i;let n=e.getWorkspace().folders[0];if(n)return n.uri.scheme;let o=e.getWorkspace().configuration;return o?o.scheme:he.file}userHome(t){return t?.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(t=>t===1?hn:Ft)}async fileURI(t){let e="";if(await this.resolveOS===1&&(t=t.replace(/\\/g,"/")),t[0]==="/"&&t[1]==="/"){let n=t.indexOf("/",2);n===-1?(e=t.substring(2),t="/"):(e=t.substring(2,n),t=t.substring(n)||"/")}return q.from({scheme:he.file,authority:e,path:t,query:"",fragment:""})}};GC=_([v(1,vm),v(2,on),v(3,Xt)],GC);var t_="workbench.action.closeActiveEditor";var ste="copyActiveEditor";var i_="workbench.action.unlockEditorGroup";var j8="workbench.action.unpinEditor",ate="workbench.action.splitEditor",$8="workbench.action.splitEditorUp",Y8="workbench.action.splitEditorDown";var lte="workbench.action.toggleMaximizeEditorGroup";var IN=[ate,t_,j8,i_,lte];var CN=class{_serviceBrand;_dragOperations=new Map;removeDragOperationTransfer(t){if(t&&this._dragOperations.has(t)){let e=this._dragOperations.get(t);return this._dragOperations.delete(t),e}}addDragOperationTransfer(t,e){this._dragOperations.set(t,e)}},qC=class{constructor(t){this.identifier=t}};var eg=class r extends L{constructor(e,i){super();this.options=i;this.supportIcons=i?.supportIcons??!1,this.domNode=Ee(e,re("span.monaco-highlighted-label"))}domNode;text="";title="";highlights=[];supportIcons;didEverRender=!1;customHover;get element(){return this.domNode}set(e,i=[],n="",o){e||(e=""),o&&(e=r.escapeNewLines(e,i)),!(this.didEverRender&&this.text===e&&this.title===n&&$t(this.highlights,i))&&(this.text=e,this.title=n,this.highlights=i,this.render())}render(){let e=[],i=0;for(let n of this.highlights){if(n.end===n.start)continue;if(i<n.start){let a=this.text.substring(i,n.start);this.supportIcons?e.push(...Rs(a)):e.push(a),i=n.start}let o=this.text.substring(i,n.end),s=re("span.highlight",void 0,...this.supportIcons?Rs(o):[o]);n.extraClasses&&s.classList.add(...n.extraClasses),e.push(s),i=n.end}if(i<this.text.length){let n=this.text.substring(i);this.supportIcons?e.push(...Rs(n)):e.push(n)}if(Tn(this.domNode,...e),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){let n=this.options?.hoverDelegate??zt("mouse");this.customHover=this._register($n().setupManagedHover(n,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,i){let n=0,o=0;return e.replace(/\r\n|\r|\n/g,(s,a)=>{o=s===`\r
`?-1:0,a+=n;for(let l of i)l.end<=a||(l.start>=a&&(l.start+=o),l.end>=a&&(l.end+=o));return n+=o,"\u23CE"})}};var _b=class{constructor(t){this._element=t}disposed;_textContent;_classNames;_empty;get element(){return this._element}set textContent(t){this.disposed||t===this._textContent||(this._textContent=t,this._element.textContent=t)}set classNames(t){this.disposed||$t(t,this._classNames)||(this._classNames=t,this._element.classList.value="",this._element.classList.add(...t))}set empty(t){this.disposed||t===this._empty||(this._empty=t,this._element.style.marginLeft=t?"0":"")}dispose(){this.disposed=!0}},SN=class extends L{creationOptions;domNode;nameContainer;nameNode;descriptionNode;suffixNode;labelContainer;hoverDelegate;customHovers=new Map;constructor(t,e){super(),this.creationOptions=e,this.domNode=this._register(new _b(Ee(t,re(".monaco-icon-label")))),this.labelContainer=Ee(this.domNode.element,re(".monaco-icon-label-container")),this.nameContainer=Ee(this.labelContainer,re("span.monaco-icon-name-container")),e?.supportHighlights||e?.supportIcons?this.nameNode=this._register(new X8(this.nameContainer,!!e.supportIcons)):this.nameNode=new Z8(this.nameContainer),this.hoverDelegate=e?.hoverDelegate??zt("mouse")}get element(){return this.domNode.element}setLabel(t,e,i){let n=["monaco-icon-label"],o=["monaco-icon-label-container"],s="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&o.push("disabled"),i.title&&(typeof i.title=="string"?s+=i.title:s+=t));let a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i?.iconPath){let l;!a||!Oi(a)?(l=re(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=vl(i?.iconPath)}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",s),this.labelContainer.classList.value="",this.labelContainer.classList.add(...o),this.setupHover(i?.descriptionTitle?this.labelContainer:this.element,i?.title),this.nameNode.setLabel(t,i),e||this.descriptionNode){let l=this.getOrCreateDescriptionNode();l instanceof eg?(l.set(e||"",i?i.descriptionMatches:void 0,void 0,i?.labelEscapeNewLines),this.setupHover(l.element,i?.descriptionTitle)):(l.textContent=e&&i?.labelEscapeNewLines?eg.escapeNewLines(e,[]):e||"",this.setupHover(l.element,i?.descriptionTitle||""),l.empty=!e)}if(i?.suffix||this.suffixNode){let l=this.getOrCreateSuffixNode();l.textContent=i?.suffix??""}}setupHover(t,e){let i=this.customHovers.get(t);if(i&&(i.dispose(),this.customHovers.delete(t)),!e){t.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover){let o=function(s,a){si(a)?s.title=HD(a):a?.markdownNotSupportedFallback?s.title=a.markdownNotSupportedFallback:s.removeAttribute("title")};var n=o;o(t,e)}else{let o=$n().setupManagedHover(this.hoverDelegate,t,e);o&&this.customHovers.set(t,o)}}dispose(){super.dispose();for(let t of this.customHovers.values())t.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){let t=this._register(new _b(dk(this.nameContainer,re("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new _b(Ee(t.element,re("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){let t=this._register(new _b(Ee(this.labelContainer,re("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new eg(Ee(t.element,re("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new _b(Ee(t.element,re("span.label-description"))))}return this.descriptionNode}},Z8=class{constructor(t){this.container=t}label=void 0;singleLabel=void 0;options;setLabel(t,e){if(!(this.label===t&&$t(this.options,e)))if(this.label=t,this.options=e,typeof t=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=Ee(this.container,re("a.label-name",{id:e?.domId}))),this.singleLabel.textContent=t;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<t.length;i++){let n=t[i],o=e?.domId&&`${e?.domId}_${i}`;Ee(this.container,re("a.label-name",{id:o,"data-icon-label-count":t.length,"data-icon-label-index":i,role:"treeitem"},n)),i<t.length-1&&Ee(this.container,re("span.label-separator",void 0,e?.separator||"/"))}}}};function the(r,t,e){if(!e)return;let i=0;return r.map(n=>{let o={start:i,end:i+n.length},s=e.map(a=>jo.intersect(o,a)).filter(a=>!jo.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=o.end+t.length,s})}var X8=class extends L{constructor(e,i){super();this.container=e;this.supportIcons=i}label=void 0;singleLabel=void 0;options;setLabel(e,i){if(!(this.label===e&&$t(this.options,i)))if(this.label=e,this.options=i,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new eg(Ee(this.container,re("a.label-name",{id:i?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(e,i?.matches,void 0,i?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;let n=i?.separator||"/",o=the(e,n,i?.matches);for(let s=0;s<e.length;s++){let a=e[s],l=o?o[s]:void 0,d=i?.domId&&`${i?.domId}_${s}`,c=re("a.label-name",{id:d,"data-icon-label-count":e.length,"data-icon-label-index":s,role:"treeitem"});this._register(new eg(Ee(this.container,c),{supportIcons:this.supportIcons})).set(a,l,void 0,i?.labelEscapeNewLines),s<e.length-1&&Ee(c,re("span.label-separator",void 0,n))}}}};var wN=$("IFileDecorationsService");var J8=$("notebookDocumentService"),ihe=["W","X","Y","Z","a","b","c","d","e","f"],nhe=new RegExp(`^[${ihe.join("")}]+`),ohe=7;function rhe(r){if(r.scheme!==he.vscodeNotebookCell)return;let t=r.fragment.indexOf("s");if(t<0)return;let e=parseInt(r.fragment.substring(0,t).replace(nhe,""),ohe),i=BG(r.fragment.substring(t+1)).toString();if(!isNaN(e))return{handle:e,notebook:r.with({scheme:i,fragment:null})}}var Q8=class{_documents=new Ci;getNotebook(t){if(t.scheme===he.vscodeNotebookCell){let e=rhe(t);if(e){let i=this._documents.get(e.notebook);if(i)return i}}return this._documents.get(t)}addNotebookDocument(t){this._documents.set(t.uri,t)}removeNotebookDocument(t){this._documents.delete(t.uri)}};vi(J8,Q8,1);function xu(r){if(!(!r||!r.resource))return q.isUri(r.resource)?r.resource:r.resource.primary}var Db={onDidChangeVisibility:O.None},ic=class extends L{constructor(e,i,n,o,s,a,l,d,c,u){super();this.instantiationService=i;this.configurationService=n;this.modelService=o;this.workspaceService=s;this.languageService=a;this.decorationsService=l;this.themeService=d;this.labelService=c;this.textFileService=u;this.registerListeners(e)}_onDidChangeDecorations=this._register(new T);onDidChangeDecorations=this._onDidChangeDecorations.event;widgets=[];labels=[];registerListeners(e){this._register(e.onDidChangeVisibility(i=>{this.widgets.forEach(n=>n.notifyVisibilityChanged(i))})),this._register(this.languageService.onDidChange(()=>this.widgets.forEach(i=>i.notifyExtensionsRegistered()))),this._register(this.modelService.onModelLanguageChanged(i=>{i.model.uri&&this.widgets.forEach(n=>n.notifyModelLanguageChanged(i.model))})),this._register(this.modelService.onModelAdded(i=>{i.uri&&this.widgets.forEach(n=>n.notifyModelAdded(i))})),this._register(this.workspaceService.onDidChangeWorkspaceFolders(()=>{this.widgets.forEach(i=>i.notifyWorkspaceFoldersChange())})),this._register(this.decorationsService.onDidChangeDecorations(i=>{let n=!1;this.widgets.forEach(o=>{o.notifyFileDecorationsChanges(i)&&(n=!0)}),n&&this._onDidChangeDecorations.fire()})),this._register(this.themeService.onDidColorThemeChange(()=>this.widgets.forEach(i=>i.notifyThemeChange()))),this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(h3)&&this.widgets.forEach(n=>n.notifyFileAssociationsChange())})),this._register(this.labelService.onDidChangeFormatters(i=>{this.widgets.forEach(n=>n.notifyFormattersChange(i.scheme))})),this._register(this.textFileService.untitled.onDidChangeLabel(i=>{this.widgets.forEach(n=>n.notifyUntitledLabelChange(i.resource))}))}get(e){return this.labels[e]}create(e,i){let n=this.instantiationService.createInstance(n_,e,i),o={element:n.element,onDidRender:n.onDidRender,setLabel:(s,a,l)=>n.setLabel(s,a,l),setResource:(s,a)=>n.setResource(s,a),setFile:(s,a)=>n.setFile(s,a),clear:()=>n.clear(),dispose:()=>this.disposeWidget(n)};return this.labels.push(o),this.widgets.push(n),o}disposeWidget(e){let i=this.widgets.indexOf(e);i>-1&&(this.widgets.splice(i,1),this.labels.splice(i,1)),nt(e)}clear(){this.widgets=nt(this.widgets),this.labels=[]}dispose(){super.dispose(),this.clear()}};ic=_([v(1,ae),v(2,de),v(3,Rr),v(4,Xt),v(5,Hn),v(6,wN),v(7,Ze),v(8,qo),v(9,qc)],ic);var jC=class extends ic{label;get element(){return this.label}constructor(t,e,i,n,o,s,a,l,d,c,u){super(Db,i,n,o,s,a,l,d,c,u),this.label=this._register(this.create(t,e))}};jC=_([v(2,ae),v(3,de),v(4,Rr),v(5,Xt),v(6,Hn),v(7,wN),v(8,Ze),v(9,qo),v(10,qc)],jC);var n_=class extends SN{constructor(e,i,n,o,s,a,l,d,c){super(e,i);this.languageService=n;this.modelService=o;this.decorationsService=s;this.labelService=a;this.textFileService=l;this.contextService=d;this.notebookDocumentService=c}_onDidRender=this._register(new T);onDidRender=this._onDidRender.event;label=void 0;decoration=this._register(new mt);options=void 0;computedIconClasses=void 0;computedLanguageId=void 0;computedPathLabel=void 0;computedWorkspaceFolderLabel=void 0;needsRedraw=void 0;isHidden=!1;notifyVisibilityChanged(e){e===this.isHidden&&(this.isHidden=!e,e&&this.needsRedraw&&(this.render({updateIcon:this.needsRedraw===2,updateDecoration:this.needsRedraw===2}),this.needsRedraw=void 0))}notifyModelLanguageChanged(e){this.handleModelEvent(e)}notifyModelAdded(e){this.handleModelEvent(e)}handleModelEvent(e){let i=xu(this.label);i&&Wn(e.uri,i)&&this.computedLanguageId!==e.getLanguageId()&&(this.computedLanguageId=e.getLanguageId(),this.render({updateIcon:!0,updateDecoration:!1}))}notifyFileDecorationsChanges(e){if(!this.options)return!1;let i=xu(this.label);return i&&this.options.fileDecorations&&e.affectsResource(i)?this.render({updateIcon:!1,updateDecoration:!0}):!1}notifyExtensionsRegistered(){this.render({updateIcon:!0,updateDecoration:!1})}notifyThemeChange(){this.render({updateIcon:!1,updateDecoration:!1})}notifyFileAssociationsChange(){this.render({updateIcon:!0,updateDecoration:!1})}notifyFormattersChange(e){xu(this.label)?.scheme===e&&this.render({updateIcon:!1,updateDecoration:!1})}notifyUntitledLabelChange(e){Wn(e,xu(this.label))&&this.render({updateIcon:!1,updateDecoration:!1})}notifyWorkspaceFoldersChange(){if(typeof this.computedWorkspaceFolderLabel=="string"){let e=xu(this.label);q.isUri(e)&&this.label?.name===this.computedWorkspaceFolderLabel&&this.setFile(e,this.options)}}setFile(e,i){let n=i?.hideLabel,o;if(!n){if(i?.fileKind===2){let a=this.contextService.getWorkspaceFolder(e);a&&(o=a.name,this.computedWorkspaceFolderLabel=o)}o||(o=HR(tv(e)))}let s;if(!i?.hidePath){let a=this.labelService.getUriLabel(er(e),{relative:!0});a&&a!=="."&&(s=a)}this.setResource({resource:e,name:o,description:s,range:i?.range},i)}setResource(e,i=Object.create(null)){let n=xu(e),o=e?.resource&&!q.isUri(e.resource);if(!i.forceLabel&&!o&&n?.scheme===he.untitled){let c=this.textFileService.untitled.get(n);if(c&&!c.hasAssociatedFilePath){if(typeof e.name=="string"&&(e.name=c.name),typeof e.description=="string"){let p=c.resource.path;e.name!==p?e.description=p:e.description=void 0}let u=c.resource.path;c.name!==u?i.title=`${c.name} \u2022 ${u}`:i.title=u}}if(!i.forceLabel&&!o&&n?.scheme===he.vscodeNotebookCell){let c=this.notebookDocumentService.getNotebook(n),u=c?.getCellIndex(n);c&&u!==void 0&&typeof e.name=="string"&&(i.title=h("notebookCellLabel","{0} \u2022 Cell {1}",e.name,`${u+1}`)),typeof e.name=="string"&&c&&u!==void 0&&typeof e.name=="string"&&(e.name=h("notebookCellLabel","{0} \u2022 Cell {1}",e.name,`${u+1}`))}let s=this.hasResourceChanged(e),a=s||this.hasPathLabelChanged(e),l=this.hasFileKindChanged(i),d=this.hasIconChanged(i);this.label=e,this.options=i,s&&(this.computedLanguageId=void 0),a&&(this.computedPathLabel=void 0),this.render({updateIcon:s||l||d,updateDecoration:s||l})}hasFileKindChanged(e){let i=e?.fileKind,n=this.options?.fileKind;return i!==n}hasResourceChanged(e){let i=xu(e),n=xu(this.label);return i&&n?i.toString()!==n.toString():!(!i&&!n)}hasPathLabelChanged(e){let i=xu(e);return!!i&&this.computedPathLabel!==this.labelService.getUriLabel(i)}hasIconChanged(e){return this.options?.icon!==e?.icon}clear(){this.label=void 0,this.options=void 0,this.computedLanguageId=void 0,this.computedIconClasses=void 0,this.computedPathLabel=void 0,this.setLabel("")}render(e){if(this.isHidden)return this.needsRedraw!==2&&(this.needsRedraw=e.updateIcon||e.updateDecoration?2:1),!1;if(e.updateIcon&&(this.computedIconClasses=void 0),!this.label)return!1;let i={title:"",italic:this.options?.italic,strikethrough:this.options?.strikethrough,matches:this.options?.matches,descriptionMatches:this.options?.descriptionMatches,extraClasses:[],separator:this.options?.separator,domId:this.options?.domId,disabledCommand:this.options?.disabledCommand,labelEscapeNewLines:this.options?.labelEscapeNewLines,descriptionTitle:this.options?.descriptionTitle},n=xu(this.label);if(this.options?.title!==void 0&&(i.title=this.options.title),n&&n.scheme!==he.data&&(!this.options?.title||typeof this.options.title!="string"&&!this.options.title.markdownNotSupportedFallback)&&(this.computedPathLabel||(this.computedPathLabel=this.labelService.getUriLabel(n)),!i.title||typeof i.title=="string"?i.title=this.computedPathLabel:i.title.markdownNotSupportedFallback||(i.title.markdownNotSupportedFallback=this.computedPathLabel)),this.options&&!this.options.hideIcon&&(this.computedIconClasses||(this.computedIconClasses=Bm(this.modelService,this.languageService,n,this.options.fileKind,this.options.icon)),q.isUri(this.options.icon)&&(i.iconPath=this.options.icon),i.extraClasses=this.computedIconClasses.slice(0)),this.options?.extraClasses&&i.extraClasses.push(...this.options.extraClasses),this.options?.fileDecorations&&n){e.updateDecoration&&(this.decoration.value=this.decorationsService.getDecoration(n,this.options.fileKind!==0));let o=this.decoration.value;if(o){if(o.tooltip){if(typeof i.title=="string")i.title=`${i.title} \u2022 ${o.tooltip}`;else if(typeof i.title?.markdown=="string"){let s=`${i.title.markdown} \u2022 ${o.tooltip}`;i.title={markdown:s,markdownNotSupportedFallback:s}}}o.strikethrough&&(i.strikethrough=!0),this.options.fileDecorations.colors&&i.extraClasses.push(o.labelClassName),this.options.fileDecorations.badges&&(i.extraClasses.push(o.badgeClassName),i.extraClasses.push(o.iconClassName))}}return this.label.range&&(i.suffix=this.label.range.startLineNumber!==this.label.range.endLineNumber?`:${this.label.range.startLineNumber}-${this.label.range.endLineNumber}`:`:${this.label.range.startLineNumber}`),this.setLabel(this.label.name??"",this.label.description,i),this._onDidRender.fire(),!0}dispose(){super.dispose(),this.label=void 0,this.options=void 0,this.computedLanguageId=void 0,this.computedIconClasses=void 0,this.computedPathLabel=void 0,this.computedWorkspaceFolderLabel=void 0}};n_=_([v(2,Hn),v(3,Rr),v(4,wN),v(5,qo),v(6,qc),v(7,Xt),v(8,J8)],n_);var nc=$("IEditorBreadcrumbsService"),e9=class{_map=new Map;register(t,e){if(this._map.has(t))throw new Error(`group (${t}) has already a widget`);return this._map.set(t,e),{dispose:()=>this._map.delete(t)}}getWidget(t){return this._map.get(t)}};vi(nc,e9,1);var Us=class r{constructor(){}static IsEnabled=r._stub("breadcrumbs.enabled");static UseQuickPick=r._stub("breadcrumbs.useQuickPick");static FilePath=r._stub("breadcrumbs.filePath");static SymbolPath=r._stub("breadcrumbs.symbolPath");static SymbolSortOrder=r._stub("breadcrumbs.symbolSortOrder");static Icons=r._stub("breadcrumbs.icons");static TitleScrollbarSizing=r._stub("workbench.editor.titleScrollbarSizing");static FileExcludes=r._stub("files.exclude");static _stub(t){return{bindTo(e){let i=new T,n=e.onDidChangeConfiguration(o=>{o.affectsConfiguration(t)&&i.fire(void 0)});return new class{name=t;onDidChange=i.event;getValue(o){return o?e.getValue(t,o):e.getValue(t)}updateValue(o,s){return s?e.updateValue(t,o,s):e.updateValue(t,o)}dispose(){n.dispose(),i.dispose()}}}}}};Ne.as(xi.Configuration).registerConfiguration({id:"breadcrumbs",title:h("title","Breadcrumb Navigation"),order:101,type:"object",properties:{"breadcrumbs.enabled":{description:h("enabled","Enable/disable navigation breadcrumbs."),type:"boolean",default:!0},"breadcrumbs.filePath":{description:h("filepath","Controls whether and how file paths are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[h("filepath.on","Show the file path in the breadcrumbs view."),h("filepath.off","Do not show the file path in the breadcrumbs view."),h("filepath.last","Only show the last element of the file path in the breadcrumbs view.")]},"breadcrumbs.symbolPath":{description:h("symbolpath","Controls whether and how symbols are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[h("symbolpath.on","Show all symbols in the breadcrumbs view."),h("symbolpath.off","Do not show symbols in the breadcrumbs view."),h("symbolpath.last","Only show the current symbol in the breadcrumbs view.")]},"breadcrumbs.symbolSortOrder":{description:h("symbolSortOrder","Controls how symbols are sorted in the breadcrumbs outline view."),type:"string",default:"position",scope:5,enum:["position","name","type"],enumDescriptions:[h("symbolSortOrder.position","Show symbol outline in file position order."),h("symbolSortOrder.name","Show symbol outline in alphabetical order."),h("symbolSortOrder.type","Show symbol outline in symbol type order.")]},"breadcrumbs.icons":{description:h("icons","Render breadcrumb items with icons."),type:"boolean",default:!0},"breadcrumbs.showFiles":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.file","When enabled breadcrumbs show `file`-symbols.")},"breadcrumbs.showModules":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.module","When enabled breadcrumbs show `module`-symbols.")},"breadcrumbs.showNamespaces":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.namespace","When enabled breadcrumbs show `namespace`-symbols.")},"breadcrumbs.showPackages":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.package","When enabled breadcrumbs show `package`-symbols.")},"breadcrumbs.showClasses":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.class","When enabled breadcrumbs show `class`-symbols.")},"breadcrumbs.showMethods":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.method","When enabled breadcrumbs show `method`-symbols.")},"breadcrumbs.showProperties":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.property","When enabled breadcrumbs show `property`-symbols.")},"breadcrumbs.showFields":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.field","When enabled breadcrumbs show `field`-symbols.")},"breadcrumbs.showConstructors":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.constructor","When enabled breadcrumbs show `constructor`-symbols.")},"breadcrumbs.showEnums":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.enum","When enabled breadcrumbs show `enum`-symbols.")},"breadcrumbs.showInterfaces":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.interface","When enabled breadcrumbs show `interface`-symbols.")},"breadcrumbs.showFunctions":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.function","When enabled breadcrumbs show `function`-symbols.")},"breadcrumbs.showVariables":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.variable","When enabled breadcrumbs show `variable`-symbols.")},"breadcrumbs.showConstants":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.constant","When enabled breadcrumbs show `constant`-symbols.")},"breadcrumbs.showStrings":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.string","When enabled breadcrumbs show `string`-symbols.")},"breadcrumbs.showNumbers":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.number","When enabled breadcrumbs show `number`-symbols.")},"breadcrumbs.showBooleans":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.boolean","When enabled breadcrumbs show `boolean`-symbols.")},"breadcrumbs.showArrays":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.array","When enabled breadcrumbs show `array`-symbols.")},"breadcrumbs.showObjects":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.object","When enabled breadcrumbs show `object`-symbols.")},"breadcrumbs.showKeys":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.key","When enabled breadcrumbs show `key`-symbols.")},"breadcrumbs.showNull":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.null","When enabled breadcrumbs show `null`-symbols.")},"breadcrumbs.showEnumMembers":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.enumMember","When enabled breadcrumbs show `enumMember`-symbols.")},"breadcrumbs.showStructs":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.struct","When enabled breadcrumbs show `struct`-symbols.")},"breadcrumbs.showEvents":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.event","When enabled breadcrumbs show `event`-symbols.")},"breadcrumbs.showOperators":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.operator","When enabled breadcrumbs show `operator`-symbols.")},"breadcrumbs.showTypeParameters":{type:"boolean",default:!0,scope:5,markdownDescription:h("filteredTypes.typeParameter","When enabled breadcrumbs show `typeParameter`-symbols.")}}});var dte=$("IOutlineService");var Lb=class{constructor(t,e){this.uri=t;this.kind=e}},YC=class{constructor(t,e){this.element=t;this.outline=e}},$C=class{constructor(t,e,i,n,o){this.resource=t;this._workspaceService=n;this._outlineService=o;this._cfgFilePath=Us.FilePath.bindTo(i),this._cfgSymbolPath=Us.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(s=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(s=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(t),e&&(this._bindToEditor(e),this._disposables.add(o.onDidChange(()=>this._bindToEditor(e))),this._disposables.add(e.onDidChangeControl(()=>this._bindToEditor(e)))),this._onDidUpdate.fire(this)}_disposables=new W;_fileInfo;_cfgFilePath;_cfgSymbolPath;_currentOutline=new mt;_outlineDisposables=new W;_onDidUpdate=new T;onDidUpdate=this._onDidUpdate.event;dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let t=[];if(this._cfgFilePath.getValue()==="on"?t=t.concat(this._fileInfo.path):this._cfgFilePath.getValue()==="last"&&this._fileInfo.path.length>0&&(t=t.concat(this._fileInfo.path.slice(-1))),this._cfgSymbolPath.getValue()==="off"||!this._currentOutline.value)return t;let e=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i=this._cfgSymbolPath.getValue()==="last"&&e.length>0?e.length-1:0;i<e.length;i++)t.push(new YC(e[i],this._currentOutline.value));return e.length===0&&!this._currentOutline.value.isEmpty&&t.push(new YC(this._currentOutline.value,this._currentOutline.value)),t}_initFilePathInfo(t){if(uG(t,he.untitled,he.data))return{folder:void 0,path:[]};let e={folder:this._workspaceService.getWorkspaceFolder(t)??void 0,path:[]},i=t;for(;i&&i.path!=="/"&&!(e.folder&&Wn(e.folder.uri,i));){e.path.unshift(new Lb(i,e.path.length===0?0:1));let n=i.path.length;if(i=er(i),i.path.length===n)break}return e.folder&&this._workspaceService.getWorkbenchState()===3&&e.path.unshift(new Lb(e.folder.uri,2)),e}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(t){let e=new Cn;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add(te(()=>e.dispose(!0))),this._outlineService.createOutline(t,2,e.token).then(i=>{e.token.isCancellationRequested&&(i?.dispose(),i=void 0),this._currentOutline.value=i,this._onDidUpdate.fire(this),i&&this._outlineDisposables.add(i.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(i=>{this._onDidUpdate.fire(this),Ke(i)})}};$C=_([v(2,de),v(3,Xt),v(4,dte)],$C);var ZC=class{constructor(t,e,i,n,o){this.resource=e;this._instantiationService=i;this._themeService=n;this._configurationService=o;this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",t.appendChild(this._domNode)}_disposables=new W;_domNode;_arrow;_treeContainer;_tree;_fakeEvent=new UIEvent("fakeEvent");_layoutInfo;_onWillPickElement=new T;onWillPickElement=this._onWillPickElement.event;_previewDispoables=new mt;dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(t,e,i,n,o){let a=this._themeService.getColorTheme().getColor(CV);this._arrow=document.createElement("div"),this._arrow.className="arrow",this._arrow.style.borderColor=`transparent transparent ${a?a.toString():""}`,this._domNode.appendChild(this._arrow),this._treeContainer=document.createElement("div"),this._treeContainer.style.background=a?a.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow=`0 0 8px 2px ${this._themeService.getColorTheme().getColor(pl)}`,this._treeContainer.style.border=`1px solid ${this._themeService.getColorTheme().getColor(Og)}`,this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:e,width:i,arrowSize:n,arrowOffset:o,inputHeight:0},this._tree=this._createTree(this._treeContainer,t),this._disposables.add(this._tree.onDidOpen(async l=>{let{element:d,editorOptions:c,sideBySide:u}=l;await this._revealElement(d,{...c,preserveFocus:!1},u)})),this._disposables.add(this._tree.onDidChangeFocus(l=>{this._previewDispoables.value=this._previewElement(l.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(t),this._layout()}catch(l){Ke(l)}}_layout(){let t=2*this._layoutInfo.arrowSize,e=Math.min(this._layoutInfo.maxHeight-t,this._tree.contentHeight),i=e+t;this._domNode.style.height=`${i}px`,this._domNode.style.width=`${this._layoutInfo.width}px`,this._arrow.style.top=`-${2*this._layoutInfo.arrowSize}px`,this._arrow.style.borderWidth=`${this._layoutInfo.arrowSize}px`,this._arrow.style.marginLeft=`${this._layoutInfo.arrowOffset}px`,this._treeContainer.style.height=`${e}px`,this._treeContainer.style.width=`${this._layoutInfo.width}px`,this._tree.layout(e,this._layoutInfo.width)}restoreViewState(){}};ZC=_([v(2,ae),v(3,Ze),v(4,de)],ZC);var t9=class{getHeight(t){return 22}getTemplateId(t){return"FileStat"}},i9=class{getId(t){return q.isUri(t)?t.toString():yD(t)?t.id:cl(t)?t.uri.toString():t.resource.toString()}},o_=class{constructor(t){this._fileService=t}hasChildren(t){return q.isUri(t)||yD(t)||cl(t)||t.isDirectory}async getChildren(t){if(yD(t))return t.folders;let e;return cl(t)?e=t.uri:q.isUri(t)?e=t:e=t.resource,(await this._fileService.resolve(e)).children??[]}};o_=_([v(0,ai)],o_);var r_=class{constructor(t,e){this._labels=t;this._configService=e}templateId="FileStat";renderTemplate(t){return this._labels.create(t,{supportHighlights:!0})}renderElement(t,e,i){let n=this._configService.getValue("explorer.decorations"),{element:o}=t,s,a;cl(o)?(s=o.uri,a=2):(s=o.resource,a=o.isDirectory?1:0),i.setFile(s,{fileKind:a,hidePath:!0,fileDecorations:n,matches:VD(t.filterData),extraClasses:["picker-item"]})}disposeTemplate(t){t.dispose()}};r_=_([v(1,de)],r_);var n9=class{getKeyboardNavigationLabel(t){return t.name}},o9=class{getWidgetAriaLabel(){return h("breadcrumbs","Breadcrumbs")}getAriaLabel(t){return t.name}},s_=class{constructor(t,e){this._workspaceService=t;let i=Us.FileExcludes.bindTo(e),n=()=>{t.getWorkspace().folders.forEach(o=>{let s=i.getValue({resource:o.uri});if(!s)return;let a={};for(let l in s){if(typeof s[l]!="boolean")continue;let d=l.indexOf("**/")!==0?Ft.join(o.uri.path,l):l;a[d]=s[l]}this._cachedExpressions.set(o.uri.toString(),lv(a))})};n(),this._disposables.add(i),this._disposables.add(i.onDidChange(n)),this._disposables.add(t.onDidChangeWorkspaceFolders(n))}_cachedExpressions=new Map;_disposables=new W;dispose(){this._disposables.dispose()}filter(t,e){if(cl(t))return!0;let i=this._workspaceService.getWorkspaceFolder(t.resource);return!i||!this._cachedExpressions.has(i.uri.toString())?!0:!this._cachedExpressions.get(i.uri.toString())(F_(i.uri.path,t.resource.path),Tr(t.resource))}};s_=_([v(0,Xt),v(1,de)],s_);var r9=class{compare(t,e){return cl(t)&&cl(e)?t.index-e.index:t.isDirectory===e.isDirectory?n5(t.name,e.name):t.isDirectory?-1:1}},XC=class extends ZC{constructor(e,i,n,o,s,a,l){super(e,i,n,o,s);this._workspaceService=a;this._editorService=l}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");let i=o=>{this._treeContainer.classList.toggle("align-icons-and-twisties",o.hasFileIcons&&!o.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",o.hidesExplorerArrows===!0)};this._disposables.add(this._themeService.onDidFileIconThemeChange(i)),i(this._themeService.getFileIconTheme());let n=this._instantiationService.createInstance(ic,Db);return this._disposables.add(n),this._instantiationService.createInstance(mm,"BreadcrumbsFilePicker",e,new t9,[this._instantiationService.createInstance(r_,n)],this._instantiationService.createInstance(o_),{multipleSelectionSupport:!1,sorter:new r9,filter:this._instantiationService.createInstance(s_),identityProvider:new i9,keyboardNavigationLabelProvider:new n9,accessibilityProvider:this._instantiationService.createInstance(o9),showNotFoundMessage:!1,overrideStyles:{listBackground:CV}})}async _setInput(e){let{uri:i,kind:n}=e,o;n===2?o=this._workspaceService.getWorkspace():o=er(i);let s=this._tree;await s.setInput(o);let a;for(let{element:l}of s.getNode().children)if(cl(l)&&Wn(l.uri,i)){a=l;break}else if(Wn(l.resource,i)){a=l;break}a&&(s.reveal(a,.5),s.setFocus([a],this._fakeEvent)),s.domFocus()}_previewElement(e){return L.None}async _revealElement(e,i,n){return!cl(e)&&e.isFile?(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:e.resource,options:i},n?Xh:void 0),!0):!1}};XC=_([v(2,ae),v(3,Ze),v(4,de),v(5,Xt),v(6,kt)],XC);var a_=class{constructor(t,e,i){this.comparator=t;this._order=i.getValue(e,"breadcrumbs.symbolSortOrder")}_order;compare(t,e){return this._order==="name"?this.comparator.compareByName(t,e):this._order==="type"?this.comparator.compareByType(t,e):this.comparator.compareByPosition(t,e)}};a_=_([v(2,_s)],a_);var EN=class extends ZC{_createTree(t,e){let{config:i}=e.outline;return this._instantiationService.createInstance(hm,"BreadcrumbsOutlinePicker",t,i.delegate,i.renderers,i.treeDataSource,{...i.options,sorter:this._instantiationService.createInstance(a_,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1})}_setInput(t){let e=t.outline.captureViewState();this.restoreViewState=()=>{e.dispose()};let i=this._tree;return i.setInput(t.outline),t.element!==t.outline&&(i.reveal(t.element,.5),i.setFocus([t.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(t){return this._tree.getInput().preview(t)}async _revealElement(t,e,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(t,e,i,!1),!0}};var TN=class r extends Jy{constructor(e,i,n){super();this.model=e;this.element=i;this.options=n}_disposables=new W;dispose(){this._disposables.dispose()}equals(e){return e instanceof r?this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){let{element:i,outline:n}=this.element;if(i===n){let l=re("span",void 0,"\u2026");e.appendChild(l);return}let o=n.config.delegate.getTemplateId(i),s=n.config.renderers.find(l=>l.templateId===o);if(!s){e.innerText="<<NO RENDERER>>";return}let a=s.renderTemplate(e);s.renderElement({element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,a,void 0),this._disposables.add(te(()=>{s.disposeTemplate(a)}))}},xN=class r extends Jy{constructor(e,i,n,o,s){super();this.model=e;this.element=i;this.options=n;this._labels=o;this._hoverDelegate=s}_disposables=new W;dispose(){this._disposables.dispose()}equals(e){return e instanceof r?ii.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){let i=this._labels.create(e,{hoverDelegate:this._hoverDelegate});i.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===1||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add(kh[this.element.kind].toLowerCase()),this._disposables.add(i)}},she=Tt("breadcrumb-separator",B.chevronRight,h("separatorIcon","Icon for the separator in the breadcrumbs.")),bi=class{constructor(t,e,i,n,o,s,a,l,d,c,u,p){this._options=e;this._editorGroup=i;this._contextKeyService=n;this._contextViewService=o;this._instantiationService=s;this._quickInputService=a;this._fileService=l;this._editorService=d;this._labelService=c;this.domNode=document.createElement("div"),this.domNode.classList.add("breadcrumbs-control"),Ee(t,this.domNode),this._cfUseQuickPick=Us.UseQuickPick.bindTo(u),this._cfShowIcons=Us.Icons.bindTo(u),this._cfTitleScrollbarSizing=Us.TitleScrollbarSizing.bindTo(u),this._labels=this._instantiationService.createInstance(ic,Db);let m=this._cfTitleScrollbarSizing.getValue()??"default",g=e.widgetStyles??fP;this._widget=new mP(this.domNode,bi.SCROLLBAR_SIZES[m],she,g),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=bi.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=bi.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=bi.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._hoverDelegate=zt("mouse"),this._disposables.add(p.register(this._editorGroup.id,this._widget)),this.hide()}static HEIGHT=22;static SCROLLBAR_SIZES={default:3,large:8};static Payload_Reveal={};static Payload_RevealAside={};static Payload_Pick={};static CK_BreadcrumbsPossible=new ie("breadcrumbsPossible",!1,h("breadcrumbsPossible","Whether the editor can show breadcrumbs"));static CK_BreadcrumbsVisible=new ie("breadcrumbsVisible",!1,h("breadcrumbsVisible","Whether breadcrumbs are currently visible"));static CK_BreadcrumbsActive=new ie("breadcrumbsActive",!1,h("breadcrumbsActive","Whether breadcrumbs have focus"));_ckBreadcrumbsPossible;_ckBreadcrumbsVisible;_ckBreadcrumbsActive;_cfUseQuickPick;_cfShowIcons;_cfTitleScrollbarSizing;domNode;_widget;_disposables=new W;_breadcrumbsDisposables=new W;_labels;_model=new mt;_breadcrumbsPickerShowing=!1;_breadcrumbsPickerIgnoreOnceItem;_hoverDelegate;_onDidVisibilityChange=this._disposables.add(new T);get onDidVisibilityChange(){return this._onDidVisibilityChange.event}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(t){this._widget.layout(t)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){let t=this.isHidden();this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0),t||this._onDidVisibilityChange.fire()}show(){let t=this.isHidden();this._ckBreadcrumbsVisible.set(!0),this.domNode.classList.toggle("hidden",!1),t&&this._onDidVisibilityChange.fire()}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();let t=Ui.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:1}),e=this.isHidden();if(!t||!this._fileService.hasProvider(t))return this._ckBreadcrumbsPossible.set(!1),e?!1:(this.hide(),!0);let i=Ui.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:1});this.show(),this._ckBreadcrumbsPossible.set(!0);let n=this._instantiationService.createInstance($C,i??t,this._editorGroup.activeEditorPane);this._model.value=n,this.domNode.classList.toggle("backslash-path",this._labelService.getSeparator(t.scheme,t.authority)==="\\");let o=()=>{this.domNode.classList.toggle("relative-path",n.isRelative());let c=this._cfShowIcons.getValue(),u={...this._options,showFileIcons:this._options.showFileIcons&&c,showSymbolIcons:this._options.showSymbolIcons&&c},p=n.getElements().map(m=>m instanceof Lb?new xN(n,m,u,this._labels,this._hoverDelegate):new TN(n,m,u));p.length===0?(this._widget.setEnabled(!1),this._widget.setItems([new class extends Jy{render(m){m.innerText=h("empty","no elements")}equals(m){return m===this}dispose(){}}])):(this._widget.setEnabled(!0),this._widget.setItems(p),this._widget.reveal(p[p.length-1]))},s=n.onDidUpdate(o),a=this._cfShowIcons.onDidChange(o);o(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(s),this._breadcrumbsDisposables.add(te(()=>this._model.clear())),this._breadcrumbsDisposables.add(a),this._breadcrumbsDisposables.add(te(()=>this._widget.setItems([])));let l=()=>{let c=this._cfTitleScrollbarSizing.getValue()??"default";this._widget.setHorizontalScrollbarSize(bi.SCROLLBAR_SIZES[c])};l();let d=this._cfTitleScrollbarSizing.onDidChange(l);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),e!==this.isHidden()}_onFocusEvent(t){t.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(t.item))}_onSelectEvent(t){if(!t.item)return;if(t.item===this._breadcrumbsPickerIgnoreOnceItem){this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),this._widget.setSelection(void 0);return}let{element:e}=t.item;this._editorGroup.focus();let i=this._getEditorGroup(t.payload);if(i!==void 0){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._revealInEditor(t,e,i);return}if(this._cfUseQuickPick.getValue()){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._quickInputService.quickAccess.show(e instanceof YC?"@":"");return}let n,o;this._contextViewService.showContextView({render:s=>{t.item instanceof xN?n=this._instantiationService.createInstance(XC,s,t.item.model.resource):t.item instanceof TN&&(n=this._instantiationService.createInstance(EN,s,t.item.model.resource));let a=n.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),l=hu.getInstance(oe(this.domNode)).onDidChange(()=>this._contextViewService.hideContextView({source:this})),d=Un(s),c=d.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?t.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),Ln(n,a,l,d,c)},getAnchor:()=>{if(!o){let s=oe(this.domNode),a=s.innerWidth-8,l=Math.min(s.innerHeight*.7,300),d=Math.min(a,Math.max(240,a/4.17)),c=8,u,p=To(t.node.firstChild),m=p.top+p.height+c;m+l>=s.innerHeight&&(l=s.innerHeight-m-30);let g=p.left;if(g+d>=a&&(g=a-d),t.payload instanceof ri){let f=d-2*c;u=t.payload.posx-g,u>f&&(g=Math.min(a-d,g+u-f),u=f)}else u=p.left+p.width*.3-g;n.show(e,l,d,c,Math.max(0,u)),o={x:g,y:m}}return o},onHide:s=>{s?.didPick||n.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),s?.source===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),n.dispose()}})}_updateCkBreadcrumbsActive(){let t=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(t)}async _revealInEditor(t,e,i,n=!1){if(e instanceof Lb)if(e.kind===0)await this._editorService.openEditor({resource:e.uri,options:{pinned:n}},i);else{let o=this._widget.getItems(),s=o.indexOf(t.item);this._widget.setFocused(o[s+1]),this._widget.setSelection(o[s+1],bi.Payload_Pick)}else e.outline.reveal(e,{pinned:n},i===Xh,!1)}_getEditorGroup(t){return t===bi.Payload_RevealAside?Xh:t===bi.Payload_Reveal?_H:void 0}};bi=_([v(3,ke),v(4,um),v(5,ae),v(6,$o),v(7,ai),v(8,kt),v(9,qo),v(10,de),v(11,nc)],bi);var tg=class{constructor(t,e,i,n,o,s){this._container=t;this._editorGroup=e;this._options=i;this._instantiationService=o;let a=this._disposables.add(Us.IsEnabled.bindTo(n));this._disposables.add(a.onDidChange(()=>{let l=a.getValue();!l&&this._control?(this._controlDisposables.clear(),this._control=void 0,this._onDidEnablementChange.fire()):l&&!this._control&&(this._control=this.createControl(),this._control.update(),this._onDidEnablementChange.fire())})),a.getValue()&&(this._control=this.createControl()),this._disposables.add(s.onDidChangeFileSystemProviderRegistrations(l=>{this._control?.model&&this._control.model.resource.scheme!==l.scheme||this._control?.update()&&this._onDidEnablementChange.fire()}))}_disposables=new W;_controlDisposables=new W;_control;get control(){return this._control}_onDidEnablementChange=this._disposables.add(new T);get onDidEnablementChange(){return this._onDidEnablementChange.event}_onDidVisibilityChange=this._disposables.add(new T);get onDidVisibilityChange(){return this._onDidVisibilityChange.event}createControl(){let t=this._controlDisposables.add(this._instantiationService.createInstance(bi,this._container,this._options,this._editorGroup));return this._controlDisposables.add(t.onDidVisibilityChange(()=>this._onDidVisibilityChange.fire())),t}dispose(){this._disposables.dispose(),this._controlDisposables.dispose()}};tg=_([v(3,de),v(4,ae),v(5,ai)],tg);Me(class extends We{constructor(){super({id:"breadcrumbs.toggle",title:{...pe("cmd.toggle","Toggle Breadcrumbs"),mnemonicTitle:h({key:"miBreadcrumbs",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs")},category:gt.View,toggled:{condition:X.equals("config.breadcrumbs.enabled",!0),title:h("cmd.toggle2","Toggle Breadcrumbs"),mnemonicTitle:h({key:"miBreadcrumbs2",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs")},menu:[{id:ee.CommandPalette},{id:ee.MenubarAppearanceMenu,group:"4_editor",order:2},{id:ee.NotebookToolbar,group:"notebookLayout",order:2},{id:ee.StickyScrollContext},{id:ee.NotebookStickyScrollContext,group:"notebookView",order:2}]})}run(t){let e=t.get(de),i=Us.IsEnabled.bindTo(e).getValue();Us.IsEnabled.bindTo(e).updateValue(!i)}});function s9(r,t){let e=r.get(di),n=r.get(nc).getWidget(e.activeGroup.id);if(n){let o=Vr(n.getItems());n.setFocused(o),t&&n.setSelection(o,bi.Payload_Pick)}}Me(class extends We{constructor(){super({id:"breadcrumbs.focusAndSelect",title:pe("cmd.focusAndSelect","Focus and Select Breadcrumbs"),precondition:bi.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3161,when:bi.CK_BreadcrumbsPossible},f1:!0})}run(t,...e){s9(t,!0)}});Me(class extends We{constructor(){super({id:"breadcrumbs.focus",title:pe("cmd.focus","Focus Breadcrumbs"),precondition:bi.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3157,when:bi.CK_BreadcrumbsPossible},f1:!0})}run(t,...e){s9(t,!1)}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:200,primary:3161,when:X.not("config.breadcrumbs.enabled"),handler:async r=>{let t=r.get(ae),e=r.get(de),i=Us.IsEnabled.bindTo(e);return i.getValue()||(await i.updateValue(!0),await Sn(50)),t.invokeFunction(s9,!0)}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:200,primary:17,secondary:[2065],mac:{primary:17,secondary:[529]},when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive),handler(r){let t=r.get(di),i=r.get(nc).getWidget(t.activeGroup.id);i&&i.focusNext()}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:200,primary:15,secondary:[2063],mac:{primary:15,secondary:[527]},when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive),handler(r){let t=r.get(di),i=r.get(nc).getWidget(t.activeGroup.id);i&&i.focusPrev()}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:201,primary:2065,mac:{primary:529},when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive,kP),handler(r){let t=r.get(di),i=r.get(nc).getWidget(t.activeGroup.id);i&&i.focusNext()}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:201,primary:2063,mac:{primary:527},when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive,kP),handler(r){let t=r.get(di),i=r.get(nc).getWidget(t.activeGroup.id);i&&i.focusPrev()}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:200,primary:3,secondary:[18],when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive),handler(r){let t=r.get(di),i=r.get(nc).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),bi.Payload_Pick)}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:200,primary:10,secondary:[2051],when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive),handler(r){let t=r.get(di),i=r.get(nc).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),bi.Payload_Reveal)}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:201,primary:9,when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive),handler(r){let t=r.get(di),i=r.get(nc).getWidget(t.activeGroup.id);i&&(i.setFocused(void 0),i.setSelection(void 0),t.activeGroup.activeEditorPane?.focus())}});Zt.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:200,primary:2051,when:X.and(bi.CK_BreadcrumbsVisible,bi.CK_BreadcrumbsActive,kP),handler(r){let t=r.get(kt),i=r.get(ko).lastFocusedList;if(!(i instanceof hm)&&!(i instanceof mm))return;let n=i.getFocus()[0];if(q.isUri(n?.resource))return t.openEditor({resource:n.resource,options:{pinned:!0}},Xh);let o=i.getInput();if(o&&typeof o.outlineKind=="string")return o.reveal(n,{pinned:!0,preserveFocus:!1},!0,!1)}});var a9=$("historyService");var l_=class extends We{constructor(e,i,n){super(e);this.commandId=i;this.commandArgs=n}run(e){return e.get(ni).executeCommand(this.commandId,this.commandArgs)}};var cte=class extends l_{static LABEL=h("splitEditorGroupUp","Split Editor Up");constructor(){super({id:$8,title:pe("splitEditorGroupUp","Split Editor Up"),f1:!0,keybinding:{weight:200,primary:Kr(2089,2141)},category:gt.View},$8)}},ute=class extends l_{static LABEL=h("splitEditorGroupDown","Split Editor Down");constructor(){super({id:Y8,title:pe("splitEditorGroupDown","Split Editor Down"),f1:!0,keybinding:{weight:200,primary:Kr(2089,2141)},category:gt.View},Y8)}};var _N=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(B.close));this.commandService=n}static ID="workbench.action.closeActiveEditor";static LABEL=h("closeEditor","Close Editor");run(e){return this.commandService.executeCommand(t_,void 0,e)}};_N=_([v(2,ni)],_N);var ig=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(B.pinned));this.commandService=n}static ID="workbench.action.unpinActiveEditor";static LABEL=h("unpinEditor","Unpin Editor");run(e){return this.commandService.executeCommand(j8,void 0,e)}};ig=_([v(2,ni)],ig);var ng=class extends ot{constructor(e,i,n){super(e,i,ye.asClassName(B.close));this.editorGroupService=n}static ID="workbench.action.closeActiveEditor";static LABEL=h("closeOneEditor","Close");async run(e){let i=e?this.editorGroupService.getGroup(e.groupId):this.editorGroupService.activeGroup;if(!i)return;let n=e?.editorIndex!==void 0?i.getEditorByIndex(e.editorIndex):i.activeEditor;if(!n)return;let o=[];i.isSelected(n)?o.push(...i.selectedEditors):o.push(n);for(let s of o)await i.closeEditor(s,{preserveFocus:e?.preserveFocus})}};ng=_([v(2,di)],ng);var l9=class extends We{groupsToClose(t){let e=[],i=t.getGroups(2);for(let n=i.length-1;n>=0;n--)e.push(i[n]);return e}async run(t){let e=t.get(kt),i=t.get(Gt),n=t.get(sf),o=t.get(di),s=t.get(af),a=t.get(uZ),l=new Set,d=new Set,c=new Set,u=new Map;for(let{editor:p,groupId:m}of e.getEditors(1,{excludeSticky:this.excludeSticky})){let g=!1;if(p.closeHandler?g=p.closeHandler.showConfirm():g=p.isDirty()&&!p.isSaving(),!!g)if(typeof p.closeHandler?.confirm=="function"){let f=u.get(p.typeId);f||(f=new Set,u.set(p.typeId,f)),f.add({editor:p,groupId:m})}else!p.hasCapability(4)&&s.getAutoSaveMode(p).mode===3?d.add({editor:p,groupId:m}):Pi&&(rt||_t)&&!p.hasCapability(4)&&s.getAutoSaveMode(p).mode===4?c.add({editor:p,groupId:m}):l.add({editor:p,groupId:m})}if(l.size>0){let p=Array.from(l.values());switch(await this.revealEditorsToConfirm(p,o),await a.showSaveConfirm(p.map(({editor:g})=>g instanceof qn?g.primary.getName():g.getName()))){case 2:return;case 1:await this.revertEditors(e,i,n,p);break;case 0:await e.save(p,{reason:1});break}}for(let[,p]of u){let m=Array.from(p.values());await this.revealEditorsToConfirm(m,o);let g=await m.at(0)?.editor.closeHandler?.confirm?.(m);if(typeof g=="number")switch(g){case 2:return;case 1:await this.revertEditors(e,i,n,m);break;case 0:await e.save(m,{reason:1});break}}if(d.size>0){let p=Array.from(d.values());await e.save(p,{reason:3})}if(c.size>0){let p=Array.from(c.values());await e.save(p,{reason:4})}return this.doCloseAll(o)}revertEditors(t,e,i,n){return i.withProgress({location:10,delay:800,title:h("reverting","Reverting Editors...")},()=>this.doRevertEditors(t,e,n))}async doRevertEditors(t,e,i){try{await t.revert(i)}catch(n){e.error(n),await t.revert(i,{soft:!0})}}async revealEditorsToConfirm(t,e){try{let i=new Set;for(let{editor:n,groupId:o}of t){if(i.has(o))continue;i.add(o),await e.getGroup(o)?.openEditor(n)}}catch{}}async doCloseAll(t){await Promise.all(this.groupsToClose(t).map(e=>e.closeAllEditors({excludeSticky:this.excludeSticky})))}},pte=class r extends l9{static ID="workbench.action.closeAllEditors";static LABEL=pe("closeAllEditors","Close All Editors");constructor(){super({id:r.ID,title:r.LABEL,f1:!0,keybinding:{weight:200,primary:Kr(2089,2101)},icon:B.closeAll,category:gt.View})}get excludeSticky(){return!0}};var hte=class r extends We{static ID="workbench.action.navigateForward";static LABEL=h("navigateForward","Go Forward");constructor(){super({id:r.ID,title:{...pe("navigateForward","Go Forward"),mnemonicTitle:h({key:"miForward",comment:["&& denotes a mnemonic"]},"&&Forward")},f1:!0,icon:B.arrowRight,precondition:X.has("canNavigateForward"),keybinding:{weight:200,win:{primary:529},mac:{primary:1368},linux:{primary:3160}},menu:[{id:ee.MenubarGoMenu,group:"1_history_nav",order:2},{id:ee.CommandCenter,order:2}]})}async run(t){await t.get(a9).goForward(0)}},mte=class r extends We{static ID="workbench.action.navigateBack";static LABEL=h("navigateBack","Go Back");constructor(){super({id:r.ID,title:{...pe("navigateBack","Go Back"),mnemonicTitle:h({key:"miBack",comment:["&& denotes a mnemonic"]},"&&Back")},f1:!0,precondition:X.has("canNavigateBack"),icon:B.arrowLeft,keybinding:{weight:200,win:{primary:527},mac:{primary:344},linux:{primary:2648}},menu:[{id:ee.MenubarGoMenu,group:"1_history_nav",order:1},{id:ee.CommandCenter,order:1}]})}async run(t){await t.get(a9).goBack(0)}};var gte=class extends l_{static ID="workbench.action.splitEditorToLeftGroup";static LABEL=h("splitEditorToLeftGroup","Split Editor into Left Group");constructor(){super({id:"workbench.action.splitEditorToLeftGroup",title:pe("splitEditorToLeftGroup","Split Editor into Left Group"),f1:!0,category:gt.View},ste,{to:"left",by:"group"})}};var d9=$("treeViewsDndService");vi(d9,CN,1);var DN=class extends L{constructor(e){super();this.model=e;this._register(this.model.onDidModelChange(i=>{let n=i.editorIndex??i.editor;n!==void 0&&!this.filter(n)||this._onDidModelChange.fire(i)}))}_onDidModelChange=this._register(new T);onDidModelChange=this._onDidModelChange.event;get id(){return this.model.id}get isLocked(){return this.model.isLocked}get stickyCount(){return this.model.stickyCount}get activeEditor(){return this.model.activeEditor&&this.filter(this.model.activeEditor)?this.model.activeEditor:null}get previewEditor(){return this.model.previewEditor&&this.filter(this.model.previewEditor)?this.model.previewEditor:null}get selectedEditors(){return this.model.selectedEditors.filter(e=>this.filter(e))}isPinned(e){return this.model.isPinned(e)}isTransient(e){return this.model.isTransient(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}isSelected(e){return this.model.isSelected(e)}isFirst(e){return this.model.isFirst(e,this.getEditors(1))}isLast(e){return this.model.isLast(e,this.getEditors(1))}getEditors(e,i){return this.model.getEditors(e,i).filter(o=>this.filter(o))}findEditor(e,i){let n=this.model.findEditor(e,i);if(n)return this.filter(n[1])?n:void 0}},QC=class extends DN{get count(){return this.model.stickyCount}getEditors(t,e){return e?.excludeSticky?[]:t===1?this.model.getEditors(1).slice(0,this.model.stickyCount):super.getEditors(t,e)}isSticky(t){return!0}getEditorByIndex(t){return t<this.count?this.model.getEditorByIndex(t):void 0}indexOf(t,e,i){let n=this.model.indexOf(t,e,i);return n<0||n>=this.model.stickyCount?-1:n}contains(t,e){let i=this.model.indexOf(t,void 0,e);return i>=0&&i<this.model.stickyCount}filter(t){return this.model.isSticky(t)}},JC=class extends DN{get count(){return this.model.count-this.model.stickyCount}get stickyCount(){return 0}isSticky(t){return!1}getEditors(t,e){return t===1?this.model.getEditors(1).slice(this.model.stickyCount):super.getEditors(t,e)}getEditorByIndex(t){return t>=0?this.model.getEditorByIndex(t+this.model.stickyCount):void 0}indexOf(t,e,i){let n=this.model.indexOf(t,e,i);return n<this.model.stickyCount||n>=this.model.count?-1:n-this.model.stickyCount}contains(t,e){let i=this.model.indexOf(t,void 0,e);return i>=this.model.stickyCount&&i<this.model.count}filter(t){return!this.model.isSticky(t)}};var Oo=class extends il{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y,I){super(e,i,n,o,s,a,l,d,c,u,p,m,y,I);this.editorService=g;this.pathService=f;this.treeViewsDragAndDropService=b;(async()=>this.path=await this.pathService.path)(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}static SCROLLBAR_SIZES={default:3,large:10};static TAB_WIDTH={compact:38,shrink:80,fit:120};static DRAG_OVER_OPEN_TAB_THRESHOLD=1500;static MOUSE_WHEEL_EVENT_THRESHOLD=150;static MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5;titleContainer;tabsAndActionsContainer;tabsContainer;tabsScrollbar;tabSizingFixedDisposables;closeEditorAction=this._register(this.instantiationService.createInstance(ng,ng.ID,ng.LABEL));unpinEditorAction=this._register(this.instantiationService.createInstance(ig,ig.ID,ig.LABEL));tabResourceLabels=this._register(this.instantiationService.createInstance(ic,Db));tabLabels=[];activeTabLabel;tabActionBars=[];tabDisposables=[];dimensions={container:dt.None,available:dt.None};layoutScheduler=this._register(new mt);blockRevealActiveTab;path=rt?hn:Ft;lastMouseWheelEventTime=0;isMouseOverTabs=!1;create(e){super.create(e),this.titleContainer=e,this.tabsAndActionsContainer=document.createElement("div"),this.tabsAndActionsContainer.classList.add("tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=document.createElement("div"),this.tabsContainer.setAttribute("role","tablist"),this.tabsContainer.draggable=!0,this.tabsContainer.classList.add("tabs-container"),this._register(Wt.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new W),this.updateTabSizing(!1),this.tabsScrollbar=this.createTabsScrollbar(this.tabsContainer),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.createEditorActionsToolBar(this.tabsAndActionsContainer,["editor-actions"]),this.updateTabsControlVisibility()}createTabsScrollbar(e){let i=this._register(new Fy(e,{horizontal:1,horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:2,scrollYToX:!0,useShadows:!1}));return this._register(i.onScroll(n=>{n.scrollLeftChanged&&(e.scrollLeft=n.scrollLeft)})),i}updateTabsScrollbarSizing(){this.tabsScrollbar?.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabSizing(e){let[i,n]=Zs(this.tabsContainer,this.tabSizingFixedDisposables);n.clear();let o=this.groupsView.partOptions;o.tabSizing==="fixed"?(i.style.setProperty("--tab-sizing-fixed-min-width",`${o.tabSizingFixedMinWidth}px`),i.style.setProperty("--tab-sizing-fixed-max-width",`${o.tabSizingFixedMaxWidth}px`),n.add(M(i,G.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),n.add(M(i,G.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(i.style.removeProperty("--tab-sizing-fixed-min-width"),i.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((i,n,o)=>{if(e){let{width:s}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width",`${s}px`)}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return this.groupsView.partOptions.titleScrollbarSizing!=="large"?Oo.SCROLLBAR_SIZES.default:Oo.SCROLLBAR_SIZES.large}registerTabsContainerListeners(e,i){this._register(M(e,G.SCROLL,()=>{e.classList.contains("scroll")&&i.setScrollPosition({scrollLeft:e.scrollLeft})}));for(let a of[it.Tap,G.DBLCLICK])this._register(M(e,a,l=>{if(a===G.DBLCLICK){if(l.target!==e)return}else if(l.tapCount!==2||l.initialTarget!==e)return;Te.stop(l),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.groupView.count,override:Ry.id}},this.groupView.id)}));this._register(M(e,G.MOUSE_DOWN,a=>{a.button===1&&a.preventDefault()})),_t&&this._register(M(e,G.MOUSE_UP,a=>{a.button===1&&a.preventDefault()}));let n,o=!1;this._register(new ra(e,{onDragStart:a=>{o=this.onGroupDragStart(a,e)},onDrag:a=>{n=a},onDragEnter:a=>{if(e.classList.add("scroll"),a.target===e){if(!this.isSupportedDropTransfer(a)){a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(Ya.prototype)||a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,a)}},onDragLeave:a=>{this.updateDropFeedback(e,!1,a),e.classList.remove("scroll")},onDragEnd:a=>{this.updateDropFeedback(e,!1,a),e.classList.remove("scroll"),this.onGroupDragEnd(a,n,e,o)},onDrop:a=>{if(this.updateDropFeedback(e,!1,a),e.classList.remove("scroll"),a.target===e){let l=this.groupTransfer.hasData(Za.prototype);this.onDrop(a,l?this.groupView.count:this.tabsModel.count,e)}}})),this._register(M(e,G.MOUSE_WHEEL,a=>{let l=this.groupView.activeEditor;if(!l||this.groupView.count<2)return;if(this.groupsView.partOptions.scrollToSwitchTabs===!0){if(a.shiftKey)return}else if(!a.shiftKey)return;let d=Date.now();if(d-this.lastMouseWheelEventTime<Oo.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(a.deltaX)+Math.abs(a.deltaY)))return;this.lastMouseWheelEventTime=d;let c;if(a.deltaX+a.deltaY<-Oo.MOUSE_WHEEL_DISTANCE_THRESHOLD)c=-1;else if(a.deltaX+a.deltaY>Oo.MOUSE_WHEEL_DISTANCE_THRESHOLD)c=1;else return;let u=this.groupView.getEditorByIndex(this.groupView.getIndexOfEditor(l)+c);u&&(this.groupView.openEditor(u),Te.stop(a,!0))}));let s=a=>{Te.stop(a);let l=e;Na(a)&&(l=new ri(oe(this.parent),a)),this.contextMenuService.showContextMenu({getAnchor:()=>l,menuId:ee.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.groupView.id}),getKeyBinding:d=>this.getKeybinding(d),onHide:()=>this.groupView.focus()})};this._register(M(e,it.Contextmenu,a=>s(a))),this._register(M(e,G.CONTEXT_MENU,a=>s(a)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e,i){let n=this.handleOpenedEditors();return i?.focusTabControl&&this.withTab(e,(o,s,a)=>a.focus()),n}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){this.updateTabsControlVisibility();let[e,i]=Zs(this.tabsContainer,this.tabsScrollbar);for(let l=e.children.length;l<this.tabsModel.count;l++)e.appendChild(this.createTab(l,e,i));let n=this.didActiveEditorChange(),o=this.activeTabLabel,s=this.tabLabels.length;this.computeTabLabels();let a=!1;return n||s!==this.tabLabels.length||!this.equalsEditorInputLabel(o,this.activeTabLabel)?(this.redraw({forceRevealActiveTab:!0}),a=!0):this.layout(this.dimensions,{forceRevealActiveTab:!0}),a}didActiveEditorChange(){return!!(!this.activeTabLabel?.editor&&this.tabsModel.activeEditor||this.activeTabLabel?.editor&&!this.tabsModel.activeEditor||!this.activeTabLabel?.editor||!this.tabsModel.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,i){return e===i?!0:!e||!i?!1:e.name===i.name&&e.description===i.description&&e.forceDescription===i.forceDescription&&e.title===i.title&&e.ariaLabel===i.ariaLabel}beforeCloseEditor(e){if(this.isMouseOverTabs&&this.groupsView.partOptions.tabSizing==="fixed"){let i=this.tabsModel.isLast(e);this.updateTabsFixedWidth(!i)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){if(this.tabsModel.count){let e=Ue(this.tabsContainer);for(;e.children.length>this.tabsModel.count;)e.lastChild?.remove(),nt(this.tabDisposables.pop());this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&ci(this.tabsContainer),this.tabDisposables=nt(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),this.updateTabsControlVisibility()}moveEditor(e,i,n){let o=this.tabLabels[i];this.tabLabels.splice(i,1),this.tabLabels.splice(n,0,o),this.forEachTab((s,a,l,d,c,u)=>{this.redrawTab(s,a,l,d,c,u)},Math.min(i,n),Math.max(i,n)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(i,n,o,s,a)=>this.redrawTabLabel(i,n,o,s,a))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(i,n,o,s,a,l)=>this.redrawTab(i,n,o,s,a,l)),this.forEachTab((i,n,o,s,a)=>{this.redrawTabBorders(n,o)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((i,n,o,s,a,l)=>{this.redrawTabSelectedActiveAndDirty(e,i,o,l)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorSelections(){this.forEachTab((e,i,n,o,s,a)=>{this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,n,a)})}updateEditorLabelScheduler=this._register(new Et(()=>this.doUpdateEditorLabels(),0));updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,i,n,o,s)=>{this.redrawTabLabel(e,i,n,o,s)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(i,n,o,s,a,l)=>this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,i,o,l))}updateOptions(e,i){super.updateOptions(e,i),e.labelFormat!==i.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==i.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),e.alwaysShowEditorActions!==i.alwaysShowEditorActions&&this.updateEditorActionsToolbar(),(e.tabSizingFixedMinWidth!==i.tabSizingFixedMinWidth||e.tabSizingFixedMaxWidth!==i.tabSizingFixedMaxWidth||e.tabSizing!==i.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==i.labelFormat||e.tabActionLocation!==i.tabActionLocation||e.tabActionCloseVisibility!==i.tabActionCloseVisibility||e.tabActionUnpinVisibility!==i.tabActionUnpinVisibility||e.tabSizing!==i.tabSizing||e.pinnedTabSizing!==i.pinnedTabSizing||e.showIcons!==i.showIcons||e.hasIcons!==i.hasIcons||e.highlightModifiedTabs!==i.highlightModifiedTabs||e.wrapTabs!==i.wrapTabs||!$t(e.decorations,i.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,i,n){this.tabsModel.getEditors(1).forEach((o,s)=>{typeof i=="number"&&i>s||typeof n=="number"&&n<s||this.doWithTab(s,o,e)})}withTab(e,i){this.doWithTab(this.tabsModel.indexOf(e),e,i)}doWithTab(e,i,n){let s=Ue(this.tabsContainer).children[e],a=this.tabResourceLabels.get(e),l=this.tabLabels[e],d=this.tabActionBars[e];s&&a&&l&&n(i,e,s,a,l,d)}createTab(e,i,n){let o=document.createElement("div");o.draggable=!0,o.setAttribute("role","tab"),o.classList.add("tab"),this._register(Wt.addTarget(o));let s=document.createElement("div");s.classList.add("tab-border-top-container"),o.appendChild(s);let a=this.tabResourceLabels.create(o,{hoverDelegate:this.getHoverDelegate()}),l=document.createElement("div");l.classList.add("tab-actions"),o.appendChild(l);let d=this,c=new kb({groupId:this.groupView.id,get editorIndex(){return d.toEditorIndex(e)}}),u=new gn(l,{ariaLabel:h("ariaLabelTabActions","Tab actions"),actionRunner:c}),p=u.onWillRun(y=>{y.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()}),m=Ln(u,p,te(Bu(this.tabActionBars,u))),g=document.createElement("div");g.classList.add("tab-fade-hider"),o.appendChild(g);let f=document.createElement("div");f.classList.add("tab-border-bottom-container"),o.appendChild(f);let b=this.registerTabListeners(o,e,i,n);return this.tabDisposables.push(Ln(b,m,c,a)),o}toEditorIndex(e){let i=Ue(this.tabsModel.getEditorByIndex(e));return this.groupView.getIndexOfEditor(i)}lastSingleSelectSelectedEditor;registerTabListeners(e,i,n,o){let s=new W,a=async(u,p)=>{if(e.blur(),Na(u)&&(u.button!==0||be&&u.ctrlKey)){u.button===1&&u.preventDefault();return}if(this.originatesFromTabActionBar(u))return;let m=this.tabsModel.getEditorByIndex(i);if(m)if(u.shiftKey){let g;if(this.lastSingleSelectSelectedEditor&&this.tabsModel.isSelected(this.lastSingleSelectSelectedEditor))g=this.lastSingleSelectSelectedEditor;else{let f=Ue(this.groupView.activeEditor);this.lastSingleSelectSelectedEditor=f,g=f}await this.selectEditorsBetween(m,g)}else if(u.ctrlKey&&!be||u.metaKey&&be)this.tabsModel.isSelected(m)?await this.unselectEditor(m):(await this.selectEditor(m),this.lastSingleSelectSelectedEditor=m);else{let g=this.tabsModel.isSelected(m)?this.groupView.selectedEditors.filter(f=>!f.matches(m)):[];await this.groupView.openEditor(m,{preserveFocus:p,activation:1},{inactiveSelection:g,focusTabControl:!0})}},l=u=>{Te.stop(u);let p=this.tabsModel.getEditorByIndex(i);p&&this.onTabContextMenu(p,u,e)};s.add(M(e,G.MOUSE_DOWN,u=>a(u,!1))),s.add(M(e,it.Tap,u=>a(u,!0))),s.add(M(e,it.Change,u=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-u.translationX})})),s.add(M(e,G.MOUSE_UP,async u=>{if(Te.stop(u),e.blur(),Na(u)&&(u.button!==0||be&&u.ctrlKey)||this.originatesFromTabActionBar(u))return;!(u.ctrlKey&&!be||u.metaKey&&be)&&!u.shiftKey&&this.groupView.selectedEditors.length>1&&await this.unselectAllEditors()})),s.add(M(e,G.AUXCLICK,u=>{if(u.button===1){Te.stop(u,!0);let p=this.tabsModel.getEditorByIndex(i);if(p){if(iA(this.tabsModel,p,2,this.groupsView.partOptions))return;this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(p)})}}})),s.add(M(e,G.KEY_DOWN,u=>{let p=new st(u);p.shiftKey&&p.keyCode===68&&l(u)})),s.add(M(e,it.Contextmenu,u=>{l(u)})),s.add(M(e,G.KEY_UP,u=>{let p=new st(u),m=!1;if(p.equals(3)||p.equals(10)){m=!0;let g=this.tabsModel.getEditorByIndex(i);g&&this.groupView.openEditor(g)}else if([15,17,16,18,14,13].some(g=>p.equals(g))){let g=this.toEditorIndex(i);p.equals(15)||p.equals(16)?g=g-1:p.equals(17)||p.equals(18)?g=g+1:p.equals(14)?g=0:g=this.groupView.count-1;let f=this.groupView.getEditorByIndex(g);f&&(m=!0,this.groupView.openEditor(f,{preserveFocus:!0},{focusTabControl:!0}))}m&&Te.stop(u,!0),o.setScrollPosition({scrollLeft:n.scrollLeft})}));for(let u of[it.Tap,G.DBLCLICK])s.add(M(e,u,p=>{if(u===G.DBLCLICK)Te.stop(p);else if(p.tapCount!==2)return;let m=this.tabsModel.getEditorByIndex(i);if(m&&this.tabsModel.isPinned(m))switch(this.groupsView.partOptions.doubleClickTabToToggleEditorGroupSizes){case"maximize":this.groupsView.toggleMaximizeGroup(this.groupView);break;case"expand":this.groupsView.toggleExpandGroup(this.groupView);break;case"off":break}else this.groupView.pinEditor(m)}));s.add(M(e,G.CONTEXT_MENU,u=>{Te.stop(u,!0);let p=this.tabsModel.getEditorByIndex(i);p&&this.onTabContextMenu(p,u,e)},!0));let d,c=!1;return s.add(new ra(e,{onDragStart:u=>{let p=this.tabsModel.getEditorByIndex(i);if(!p)return;c=this.isNewWindowOperation(u);let m=this.groupView.selectedEditors;if(this.editorTransfer.setData(m.map(g=>new Ya({editor:g,groupId:this.groupView.id})),Ya.prototype),u.dataTransfer)if(u.dataTransfer.effectAllowed="copyMove",m.length>1){let g=`${p.getName()} + ${m.length-1}`;CA(u,g,"monaco-editor-group-drag-image",this.getColor(or),this.getColor(ta))}else u.dataTransfer.setDragImage(e,0,0);this.doFillResourceDataTransfers(m,u,c),nn(oe(this.parent),()=>this.updateDropFeedback(e,!1,u,i))},onDrag:u=>{d=u},onDragEnter:u=>{if(!this.isSupportedDropTransfer(u)){u.dataTransfer&&(u.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(Ya.prototype)||u.dataTransfer&&(u.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,u,i)},onDragOver:(u,p)=>{if(p>=Oo.DRAG_OVER_OPEN_TAB_THRESHOLD){let m=this.tabsModel.getEditorByIndex(i);m&&this.tabsModel.activeEditor!==m&&this.groupView.openEditor(m,{preserveFocus:!0})}this.updateDropFeedback(e,!0,u,i)},onDragEnd:async u=>{this.updateDropFeedback(e,!1,u,i);let p=this.editorTransfer.getData(Ya.prototype);if(this.editorTransfer.clearData(Ya.prototype),!c||SM()||!p||p.length===0)return;let m=await this.maybeCreateAuxiliaryEditorPartAt(u,e);if(!m)return;let g=m.activeGroup,f=p.map(b=>({editor:b.identifier.editor}));this.isMoveOperation(d??u,g.id,p[0].identifier.editor)?this.groupView.moveEditors(f,g):this.groupView.copyEditors(f,g),g.focus()},onDrop:u=>{this.updateDropFeedback(e,!1,u,i);let p=i;this.getTabDragOverLocation(u,e)==="right"&&p++,this.onDrop(u,p,n)}})),s}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(Za.prototype)){let i=this.groupTransfer.getData(Za.prototype);return!(Array.isArray(i)&&i.length>0&&i[0].identifier===this.groupView.id)}return!!(this.editorTransfer.hasData(Ya.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,i,n,o){let s=typeof o=="number",a;i?s?a=this.computeDropTarget(n,o,e):a={leftElement:e.lastElementChild,rightElement:void 0}:a=void 0,this.updateDropTarget(a)}dropTarget;updateDropTarget(e){let i=this.dropTarget;if(i===e||i&&e&&i.leftElement===e.leftElement&&i.rightElement===e.rightElement)return;let n="drop-target-left",o="drop-target-right";i&&(i.leftElement?.classList.remove(n),i.rightElement?.classList.remove(o)),e&&(e.leftElement?.classList.add(n),e.rightElement?.classList.add(o)),this.dropTarget=e}getTabDragOverLocation(e,i){let n=i.getBoundingClientRect();return e.clientX-n.left<=n.width/2?"left":"right"}computeDropTarget(e,i,n){let o=this.getTabDragOverLocation(e,n)==="left",s=i===this.tabsModel.count-1;if(o&&i===0)return{leftElement:void 0,rightElement:n};if(!o&&s)return{leftElement:n,rightElement:void 0};let l=o?n.previousElementSibling:n,d=o?n:n.nextElementSibling;return{leftElement:l,rightElement:d}}async selectEditor(e){this.groupView.isActive(e)||await this.groupView.setSelection(e,this.groupView.selectedEditors)}async selectEditorsBetween(e,i){let n=this.groupView.getIndexOfEditor(e);if(n===-1)throw new yt;let o=this.groupView.getIndexOfEditor(i);if(o===-1)throw new yt;let s=this.groupView.selectedEditors,a=o;for(;a>=0&&a<=this.groupView.count-1;){a=o<n?a-1:a+1;let p=this.groupView.getEditorByIndex(a);if(!p||!this.groupView.isSelected(p))break;s=s.filter(m=>!m.matches(p))}let l=o<n?o:n,d=o<n?n:o,c=this.groupView.getEditors(1).slice(l,d+1);for(let p of c)this.groupView.isSelected(p)||s.push(p);let u=s.filter(p=>!p.matches(e));await this.groupView.setSelection(e,u)}async unselectEditor(e){let i=this.groupView.isActive(e);if(i&&this.groupView.selectedEditors.length===1)return;let n=Ue(this.groupView.activeEditor);if(i){let s=this.groupView.getEditors(0);for(let a=1;a<s.length;a++){let l=s[a];if(this.groupView.isSelected(l)){n=l;break}}}let o=this.groupView.selectedEditors.filter(s=>!s.matches(e)&&!s.matches(n));await this.groupView.setSelection(n,o)}async unselectAllEditors(){if(this.groupView.selectedEditors.length>1){let e=Ue(this.groupView.activeEditor);await this.groupView.setSelection(e,[])}}computeTabLabels(){let{labelFormat:e}=this.groupsView.partOptions,{verbosity:i,shortenDuplicates:n}=this.getLabelConfigFlags(e),o=[],s=-1;this.tabsModel.getEditors(1).forEach((a,l)=>{o.push({editor:a,name:a.getName(),description:a.getDescription(i),forceDescription:a.hasCapability(64),title:a.getTitle(2),ariaLabel:z0(a,l,this.groupView,this.editorPartsView.count)}),a===this.tabsModel.activeEditor&&(s=l)}),n&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[s]}shortenTabLabels(e){let i=new Map;for(let n of e)typeof n.description=="string"?ql(i,n.name,[]).push(n):n.description="";for(let[,n]of i){if(n.length===1&&!n[0].forceDescription){n[0].description="";continue}let o=new Map;for(let d of n)ql(o,d.description,[]).push(d);let s=!1;for(let[,d]of o)if(!s&&d.length>1){let[c,...u]=d.map(({editor:p})=>p.getDescription(2));s=u.some(p=>p!==c)}if(s){o.clear();for(let d of n)d.description=d.editor.getDescription(2),ql(o,d.description,[]).push(d)}let a=[];for(let[d]of o)a.push(d);if(a.length===1){for(let d of o.get(a[0])||[])d.forceDescription||(d.description="");continue}let l=zR(a,this.path.sep);a.forEach((d,c)=>{for(let u of o.get(d)||[])u.description=l[c]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:0,shortenDuplicates:!1};case"medium":return{verbosity:1,shortenDuplicates:!1};case"long":return{verbosity:2,shortenDuplicates:!1};default:return{verbosity:1,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let i=this.getColor(Oq);!i&&Ra(this.theme.type)&&(i=this.getColor(AL)||this.getColor(Le)),i?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",i.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((i,n,o,s,a,l)=>{this.redrawTab(i,n,o,s,a,l)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,i,n,o,s,a){let l=this.tabsModel.isSticky(i),d=this.groupsView.partOptions;this.redrawTabLabel(e,i,n,o,s);let c=l&&d.tabActionUnpinVisibility,u=!c&&d.tabActionCloseVisibility,p=c||u,m;p?m=c?this.unpinEditorAction:this.closeEditorAction:m=l?this.unpinEditorAction:this.closeEditorAction,a.hasAction(m)||(a.isEmpty()||a.clear(),a.push(m,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(m)})),n.classList.toggle("pinned-action-off",l&&!c),n.classList.toggle("close-action-off",!c&&!u);for(let f of["left","right"])n.classList.toggle(`tab-actions-${f}`,p&&d.tabActionLocation===f);let g=l&&d.pinnedTabSizing==="shrink"?"shrink":d.tabSizing;for(let f of["fit","shrink","fixed"])n.classList.toggle(`sizing-${f}`,g===f);n.classList.toggle("has-icon",d.showIcons&&d.hasIcons),n.classList.toggle("sticky",l);for(let f of["normal","compact","shrink"])n.classList.toggle(`sticky-${f}`,l&&d.pinnedTabSizing===f);if(!d.wrapTabs&&l&&d.pinnedTabSizing!=="normal"){let f=0;switch(d.pinnedTabSizing){case"compact":f=Oo.TAB_WIDTH.compact;break;case"shrink":f=Oo.TAB_WIDTH.shrink;break}n.style.left=`${i*f}px`}else n.style.left="auto";this.redrawTabBorders(i,n),this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,n,a)}redrawTabLabel(e,i,n,o,s){let a=this.groupsView.partOptions,l,d=!1,c=!!a.decorations?.badges,u=!!a.decorations?.colors,p;a.pinnedTabSizing==="compact"&&this.tabsModel.isSticky(i)?(l=a.showIcons&&a.hasIcons?"":s.name?.charAt(0).toUpperCase(),p="",d=!0,c=!1):(l=s.name,p=s.description||""),s.ariaLabel&&(n.setAttribute("aria-label",s.ariaLabel),n.setAttribute("aria-description","")),o.setResource({name:l,description:p,resource:Ui.getOriginalUri(e,{supportSideBySide:3})},{title:this.getHoverTitle(e),extraClasses:Ei(["tab-label",c?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.tabsModel.isPinned(e),forceLabel:d,fileDecorations:{colors:u,badges:c},icon:e.getIcon(),hideIcon:a.showIcons===!1});let m=Ui.getOriginalUri(e,{supportSideBySide:1});m?n.setAttribute("data-resource-name",tv(m)):n.removeAttribute("data-resource-name")}redrawTabSelectedActiveAndDirty(e,i,n,o){let s=this.tabsModel.isActive(i),a=this.doRedrawTabDirty(e,s,i,n);this.doRedrawTabActive(e,!a,i,n,o)}doRedrawTabActive(e,i,n,o,s){let a=this.tabsModel.isActive(n),l=this.tabsModel.isSelected(n);if(o.classList.toggle("active",a),o.classList.toggle("selected",l),o.setAttribute("aria-selected",a?"true":"false"),o.tabIndex=a?0:-1,s.setFocusable(a),a){let c=this.getColor(e?DL:Dq);o.classList.toggle("tab-border-bottom",!!c),o.style.setProperty("--tab-border-bottom-color",c??"")}let d=null;i&&(a&&(d=this.getColor(e?Fw:Lq)),d===null&&l&&(d=this.getColor(kq))),o.classList.toggle("tab-border-top",!!d),o.style.setProperty("--tab-border-top-color",d??"")}doRedrawTabDirty(e,i,n,o){let s=!1;if(n.isDirty()&&!n.isSaving())if(o.classList.add("dirty"),this.groupsView.partOptions.highlightModifiedTabs){let a;e&&i?a=this.getColor(kv):e&&!i?a=this.getColor(kL):!e&&i?a=this.getColor(Aq):a=this.getColor(Pq),a&&(s=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",a))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return s}redrawTabBorders(e,i){let o=this.tabsModel.isSticky(e)&&this.tabsModel.stickyCount===e+1,s=this.tabsModel.stickyCount!==this.tabsModel.count,a=(o&&s?this.getColor(_q):void 0)||this.getColor(AL)||this.getColor(Le);i.style.borderRight=a?`1px solid ${a}`:"",i.style.outlineColor=this.getColor(oi)||""}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(n=>n.id===i_),secondary:e.secondary}}getHeight(){return this.dimensions.used?this.dimensions.used.height:this.computeHeight()}computeHeight(){let e;return this.visible?this.groupsView.partOptions.wrapTabs&&this.tabsAndActionsContainer?.classList.contains("wrapping")?e=this.tabsAndActionsContainer.offsetHeight:e=this.tabHeight:e=0,e}layout(e,i){if(Object.assign(this.dimensions,e),this.visible){if(!this.layoutScheduler.value){let n=nn(oe(this.parent),()=>{this.doLayout(this.dimensions,this.layoutScheduler.value?.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:i,dispose:()=>n.dispose()}}i?.forceRevealActiveTab&&(this.layoutScheduler.value.options={...this.layoutScheduler.value.options,forceRevealActiveTab:!0})}return this.dimensions.used||(this.dimensions.used=new dt(e.container.width,this.computeHeight())),this.dimensions.used}doLayout(e,i){e.container!==dt.None&&e.available!==dt.None&&this.doLayoutTabs(e,i);let n=this.dimensions.used,o=this.dimensions.used=new dt(e.container.width,this.computeHeight());n&&n.height!==o.height&&this.groupView.relayout()}doLayoutTabs(e,i){this.doLayoutTabsWrapping(e)||this.doLayoutTabsNonWrapping(i)}doLayoutTabsWrapping(e){let[i,n,o,s]=Zs(this.tabsAndActionsContainer,this.tabsContainer,this.editorActionsToolbarContainer,this.tabsScrollbar),a=i.classList.contains("wrapping"),l=a;function d(c){l=c,i.classList.toggle("wrapping",l),n.style.setProperty("--last-tab-margin-right",l?`${o.offsetWidth}px`:"0");for(let u of n.children)u.classList.remove("last-in-row")}if(this.groupsView.partOptions.wrapTabs){let c=n.offsetWidth,u=n.scrollWidth,p=()=>{let m=this.getLastTab();return m?!(m.offsetWidth+o.offsetWidth-e.available.width>1):!0};(l||u>c&&p())&&d(!0),l&&(n.offsetHeight>e.available.height||u===c&&n.offsetHeight===this.tabHeight||!p())&&d(!1)}else a&&d(!1);if(l&&!a){let c=n.offsetWidth;s.setScrollDimensions({width:c,scrollWidth:c})}if(l){let c=new Map,u,p;for(let m of n.children){let g=m,f=g.offsetTop;f!==u&&(u=f,p&&c.set(p,!0)),p=g,c.set(g,!1)}p&&c.set(p,!0);for(let[m,g]of c)m.classList.toggle("last-in-row",g)}return l}doLayoutTabsNonWrapping(e){let[i,n]=Zs(this.tabsContainer,this.tabsScrollbar),o=i.offsetWidth,s=i.scrollWidth,a=0;if(this.tabsModel.stickyCount>0){let w=0;switch(this.groupsView.partOptions.pinnedTabSizing){case"compact":w=Oo.TAB_WIDTH.compact;break;case"shrink":w=Oo.TAB_WIDTH.shrink;break}a=this.tabsModel.stickyCount*w}let l=this.tabsModel.activeEditor?this.getTabAndIndex(this.tabsModel.activeEditor):void 0,[d,c]=l??[void 0,void 0],u=this.groupsView.partOptions.pinnedTabSizing!=="normal"&&typeof c=="number"&&this.tabsModel.isSticky(c),p=o-a;this.tabsModel.stickyCount>0&&p<Oo.TAB_WIDTH.fit?(i.classList.add("disable-sticky-tabs"),p=o,a=0,u=!1):i.classList.remove("disable-sticky-tabs");let m,g;!this.blockRevealActiveTab&&d&&(m=d.offsetLeft,g=d.offsetWidth);let{width:f,scrollWidth:b}=n.getScrollDimensions();n.setScrollDimensions({width:o,scrollWidth:s});let y=f!==o||b!==s;if(this.blockRevealActiveTab||typeof m!="number"||typeof g!="number"||u||!y&&!e?.forceRevealActiveTab){this.blockRevealActiveTab=!1;return}let I=n.getScrollPosition().scrollLeft,E=g<=p,S=m-a;E&&I+p<S+g?n.setScrollPosition({scrollLeft:I+(S+g-(I+p))}):(I>S||!E)&&n.setScrollPosition({scrollLeft:S})}updateTabsControlVisibility(){Ue(this.tabsAndActionsContainer).classList.toggle("empty",!this.visible),!this.visible&&this.dimensions&&(this.dimensions.used=void 0)}get visible(){return this.tabsModel.count>0}getTabAndIndex(e){let i=this.tabsModel.indexOf(e),n=this.getTabAtIndex(i);if(n)return[n,i]}getTabAtIndex(e){if(e>=0)return Ue(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.tabsModel.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let i;return Na(e)?i=e.target||e.srcElement:i=e.initialTarget,!!lW(i,"action-item","tab")}async onDrop(e,i,n){Te.stop(e,!0),this.updateDropFeedback(n,!1,e,i),n.classList.remove("scroll");let o=this.tabsModel instanceof JC?i+this.groupView.stickyCount:i,s={sticky:this.tabsModel instanceof QC&&this.tabsModel.stickyCount===o,index:o};if(this.groupTransfer.hasData(Za.prototype)){let a=this.groupTransfer.getData(Za.prototype);if(Array.isArray(a)&&a.length>0){let l=this.editorPartsView.getGroup(a[0].identifier);if(l){let d={index:o};this.isMoveOperation(e,l.id)||(d.mode=0),this.groupsView.mergeGroup(l,this.groupView,d)}this.groupView.focus(),this.groupTransfer.clearData(Za.prototype)}}else if(this.editorTransfer.hasData(Ya.prototype)){let a=this.editorTransfer.getData(Ya.prototype);if(Array.isArray(a)&&a.length>0){let l=this.editorPartsView.getGroup(a[0].identifier.groupId);if(l)for(let d of a){let c=d.identifier.editor;if(l.id!==d.identifier.groupId)continue;let u=l.getIndexOfEditor(c);l===this.groupView&&u<o&&o--,this.isMoveOperation(e,d.identifier.groupId,c)?l.moveEditor(c,this.groupView,{...s,index:o}):l.copyEditor(c,this.groupView,{...s,index:o}),o++}}this.groupView.focus(),this.editorTransfer.clearData(Ya.prototype)}else if(this.treeItemsTransfer.hasData(qC.prototype)){let a=this.treeItemsTransfer.getData(qC.prototype);if(Array.isArray(a)&&a.length>0){let l=[];for(let d of a){let c=await this.treeViewsDragAndDropService.removeDragOperationTransfer(d.identifier);if(c){let u=await iJ(c);l.push(...u.map(p=>({...p,options:{...p.options,pinned:!0,index:o}})))}}this.editorService.openEditors(l,this.groupView,{validateTrust:!0})}this.treeItemsTransfer.clearData(qC.prototype)}else this.instantiationService.createInstance(yI,{allowWorkspaceOpen:!1}).handleDrop(e,oe(this.parent),()=>this.groupView,()=>this.groupView.focus(),s)}dispose(){super.dispose(),this.tabDisposables=nt(this.tabDisposables)}};Oo=_([v(5,Mt),v(6,ae),v(7,ke),v(8,at),v(9,jt),v(10,$o),v(11,Ze),v(12,kt),v(13,q8),v(14,d9),v(15,hI),v(16,en)],Oo);co((r,t)=>{let e=r.getColor(AL);e&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {
				border-bottom: 1px solid ${e};
			}
		`);let i=r.getColor(oi);i&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {
				outline: 1px solid;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.selected:not(.active):not(:hover)  {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:focus {
				outline-style: dashed;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				outline: 1px dashed;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {
				opacity: 1 !important;
			}
		`);let n=r.getColor(Le);n&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {
				outline: 1px solid ${n}
			}
		`);let o=r.getColor(xL);o&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover {
				background-color: ${o} !important;
			}
		`);let s=r.getColor(Tq);s&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				background-color: ${s} !important;
			}
		`);let a=r.getColor(_L);a&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${a} !important;
			}
		`);let l=r.getColor(xq);l&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${l} !important;
			}
		`);let d=r.getColor(LL);d&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${d};
			}
		`);let c=r.getColor(Rq);if(c&&t.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${c};
			}
		`),!Ra(r.type)&&!Eo&&!i){let u=Av(r),p=r.getColor(Js),m=r.getColor(Mq),g=r.getColor(Pv),f;m&&p&&(f=m.flatten(p,p,u));let b;m&&p&&g&&p&&(b=m.flatten(p,g,p,u));let y=(k,R,A=!1)=>`
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${k}, transparent) !important;
			}

			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${R}, transparent) !important;
			}
		`;if(o&&f&&b){let k=o.flatten(f),R=o.flatten(b);t.addRule(y(k,R,!0))}if(s&&f&&b){let k=s.flatten(f),R=s.flatten(b);t.addRule(y(k,R))}if(g&&b){let k=g.flatten(b);t.addRule(`
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${k}, transparent) !important;
				}
		`)}let I=(k,R,A,H)=>`
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${H?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${H?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${k}, transparent);
				}

				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${H?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${A?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${H?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${R}, transparent);
				}
		`,E=r.getColor(RL);if(E&&f&&b){let k=E.flatten(f),R=E.flatten(b);t.addRule(I(k,R,!0,!0))}let S=r.getColor(Sq);if(S&&f&&b){let k=S.flatten(f),R=S.flatten(b);t.addRule(I(k,R,!1,!0))}let w=r.getColor(MV);if(w&&f&&b){let k=w.flatten(f),R=w.flatten(b);t.addRule(I(k,R,!0,!1))}let D=r.getColor(wq);if(D&&f&&b){let k=D.flatten(f),R=D.flatten(b);t.addRule(I(k,R,!1,!1))}}});var LN=class extends il{titleContainer;editorLabel;activeLabel=Object.create(null);breadcrumbsControlFactory;get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}create(t){super.create(t);let e=this.titleContainer=t;e.draggable=!0,this.registerContainerListeners(e),this._register(Wt.addTarget(e));let i=document.createElement("div");i.classList.add("label-container"),e.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(jC,i,{hoverDelegate:this.getHoverDelegate()})).element,this._register(M(this.editorLabel.element,G.CLICK,n=>this.onTitleLabelClick(n))),this.breadcrumbsControlFactory=this._register(this.instantiationService.createInstance(tg,i,this.groupView,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:{...fP,breadcrumbsBackground:Y.transparent.toString()},showPlaceholder:!1})),this._register(this.breadcrumbsControlFactory.onDidEnablementChange(()=>this.handleBreadcrumbsEnablementChange())),e.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register(te(()=>e.classList.remove("breadcrumbs"))),this.createEditorActionsToolBar(e,["title-actions"])}registerContainerListeners(t){let e,i=!1;this._register(new ra(t,{onDragStart:n=>{i=this.onGroupDragStart(n,t)},onDrag:n=>{e=n},onDragEnd:n=>{this.onGroupDragEnd(n,e,t,i)}})),this._register(M(t,G.DBLCLICK,n=>this.onTitleDoubleClick(n))),this._register(M(t,G.AUXCLICK,n=>this.onTitleAuxClick(n))),this._register(M(t,it.Tap,n=>this.onTitleTap(n)));for(let n of[G.CONTEXT_MENU,it.Contextmenu])this._register(M(t,n,o=>{this.tabsModel.activeEditor&&this.onTabContextMenu(this.tabsModel.activeEditor,o,t)}))}onTitleLabelClick(t){Te.stop(t,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(t){Te.stop(t),this.groupView.pinEditor()}onTitleAuxClick(t){t.button===1&&this.tabsModel.activeEditor&&(Te.stop(t,!0),iA(this.tabsModel,this.tabsModel.activeEditor,2,this.groupsView.partOptions)||this.groupView.closeEditor(this.tabsModel.activeEditor))}onTitleTap(t){let e=t.initialTarget;!Oi(e)||!this.editorLabel||!Xi(e,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(t){return this.doHandleOpenEditor()}openEditors(t){return this.doHandleOpenEditor()}doHandleOpenEditor(){let t=this.ifActiveEditorChanged(()=>this.redraw());return t||this.ifActiveEditorPropertiesChanged(()=>this.redraw()),t}beforeCloseEditor(t){}closeEditor(t){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(t){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(t,e,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(t){this.ifEditorIsActive(t,()=>this.redraw())}stickEditor(t){}unstickEditor(t){}setActive(t){this.redraw()}updateEditorSelections(){}updateEditorLabel(t){this.ifEditorIsActive(t,()=>this.redraw())}updateEditorDirty(t){this.ifEditorIsActive(t,()=>{let e=Ue(this.titleContainer);t.isDirty()&&!t.isSaving()?e.classList.add("dirty"):e.classList.remove("dirty")})}updateOptions(t,e){super.updateOptions(t,e),(t.labelFormat!==e.labelFormat||!$t(t.decorations,e.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){Ue(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(t){return!this.activeLabel.editor&&this.tabsModel.activeEditor||this.activeLabel.editor&&!this.tabsModel.activeEditor||!this.activeLabel.editor||!this.tabsModel.isActive(this.activeLabel.editor)?(t(),!0):!1}ifActiveEditorPropertiesChanged(t){!this.activeLabel.editor||!this.tabsModel.activeEditor||this.activeLabel.pinned!==this.tabsModel.isPinned(this.tabsModel.activeEditor)&&t()}ifEditorIsActive(t,e){this.tabsModel.isActive(t)&&e()}redraw(){let t=this.tabsModel.activeEditor??void 0,e=this.groupsView.partOptions,i=t?this.tabsModel.isPinned(t):!1,n=this.groupsView.activeGroup===this.groupView;this.activeLabel={editor:t,pinned:i},this.breadcrumbsControl&&(n?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!i)):this.breadcrumbsControl.hide());let[o,s]=Zs(this.titleContainer,this.editorLabel);if(!t)o.classList.remove("dirty"),s.clear(),this.clearEditorActionsToolbar();else{this.updateEditorDirty(t);let{labelFormat:a}=this.groupsView.partOptions,l;this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||a==="default"&&!n?l="":l=t.getDescription(this.getVerbosity(a))||"",s.setResource({resource:Ui.getOriginalUri(t,{supportSideBySide:3}),name:t.getName(),description:l},{title:this.getHoverTitle(t),italic:!i,extraClasses:["single-tab","title-label"].concat(t.getLabelExtraClasses()),fileDecorations:{colors:!!e.decorations?.colors,badges:!!e.decorations?.badges},icon:t.getIcon(),hideIcon:e.showIcons===!1}),n?o.style.color=this.getColor(op)||"":o.style.color=this.getColor(Eq)||"",this.updateEditorActionsToolbar()}}getVerbosity(t){switch(t){case"short":return 0;case"long":return 2;default:return 1}}prepareEditorActions(t){return this.groupsView.activeGroup===this.groupView?t:{primary:this.groupsView.partOptions.alwaysShowEditorActions?t.primary:t.primary.filter(i=>i.id===t_||i.id===i_),secondary:t.secondary}}getHeight(){return this.tabHeight}layout(t){return this.breadcrumbsControl?.layout(void 0),new dt(t.container.width,this.getHeight())}};var eS=class extends L{constructor(e,i,n,o,s,a){super();this.parent=e;this.groupsView=n;this.groupView=o;this.model=s;this.instantiationService=a;let l=this._register(new QC(this.model)),d=this._register(new JC(this.model));this.stickyEditorTabsControl=this._register(this.instantiationService.createInstance(Oo,this.parent,i,this.groupsView,this.groupView,l)),this.unstickyEditorTabsControl=this._register(this.instantiationService.createInstance(Oo,this.parent,i,this.groupsView,this.groupView,d)),this.handleTabBarsStateChange()}stickyEditorTabsControl;unstickyEditorTabsControl;activeControl;handleTabBarsStateChange(){this.activeControl=this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0,this.handleTabBarsLayoutChange()}handleTabBarsLayoutChange(){if(this.groupView.count===0)return;let e=this.parent.classList.contains("two-tab-bars"),i=this.groupView.count!==this.groupView.stickyCount&&this.groupView.stickyCount>0;this.parent.classList.toggle("two-tab-bars",i),e!==i&&this.groupView.relayout()}didActiveControlChange(){return this.activeControl!==(this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0)}getEditorTabsController(e){return this.model.isSticky(e)?this.stickyEditorTabsControl:this.unstickyEditorTabsControl}openEditor(e,i){let n=this.didActiveControlChange(),s=this.getEditorTabsController(e).openEditor(e,i)||n;return s&&this.handleOpenedEditors(),s}openEditors(e){let i=e.filter(d=>this.model.isSticky(d)),n=e.filter(d=>!this.model.isSticky(d)),o=this.didActiveControlChange(),s=this.stickyEditorTabsControl.openEditors(i),a=this.unstickyEditorTabsControl.openEditors(n),l=s||a||o;return l&&this.handleOpenedEditors(),l}handleOpenedEditors(){this.handleTabBarsStateChange()}beforeCloseEditor(e){this.getEditorTabsController(e).beforeCloseEditor(e)}closeEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){let i=e.filter(o=>this.model.isSticky(o)),n=e.filter(o=>!this.model.isSticky(o));this.stickyEditorTabsControl.closeEditors(i),this.unstickyEditorTabsControl.closeEditors(n),this.handleClosedEditors()}handleClosedEditors(){this.handleTabBarsStateChange()}moveEditor(e,i,n,o){o?(this.model.isSticky(e)?(this.stickyEditorTabsControl.openEditor(e),this.unstickyEditorTabsControl.closeEditor(e)):(this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e)),this.handleTabBarsStateChange()):this.model.isSticky(e)?this.stickyEditorTabsControl.moveEditor(e,i,n,o):this.unstickyEditorTabsControl.moveEditor(e,i-this.model.stickyCount,n-this.model.stickyCount,o)}pinEditor(e){this.getEditorTabsController(e).pinEditor(e)}stickEditor(e){this.unstickyEditorTabsControl.closeEditor(e),this.stickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}unstickEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}setActive(e){this.stickyEditorTabsControl.setActive(e),this.unstickyEditorTabsControl.setActive(e)}updateEditorSelections(){this.stickyEditorTabsControl.updateEditorSelections(),this.unstickyEditorTabsControl.updateEditorSelections()}updateEditorLabel(e){this.getEditorTabsController(e).updateEditorLabel(e)}updateEditorDirty(e){this.getEditorTabsController(e).updateEditorDirty(e)}updateOptions(e,i){this.stickyEditorTabsControl.updateOptions(e,i),this.unstickyEditorTabsControl.updateOptions(e,i)}layout(e){let i=this.stickyEditorTabsControl.layout(e),n={container:e.container,available:new dt(e.available.width,e.available.height-i.height)},o=this.unstickyEditorTabsControl.layout(n);return new dt(e.container.width,i.height+o.height)}getHeight(){return this.stickyEditorTabsControl.getHeight()+this.unstickyEditorTabsControl.getHeight()}dispose(){this.parent.classList.toggle("two-tab-bars",!1),super.dispose()}};eS=_([v(5,ae)],eS);var kN=class extends il{activeEditor=null;prepareEditorActions(t){return{primary:[],secondary:[]}}openEditor(t){return this.handleOpenedEditors()}openEditors(t){return this.handleOpenedEditors()}handleOpenedEditors(){let t=this.activeEditorChanged();return this.activeEditor=this.tabsModel.activeEditor,t}activeEditorChanged(){return!!(!this.activeEditor&&this.tabsModel.activeEditor||this.activeEditor&&!this.tabsModel.activeEditor||!this.activeEditor||!this.tabsModel.isActive(this.activeEditor))}beforeCloseEditor(t){}closeEditor(t){this.handleClosedEditors()}closeEditors(t){this.handleClosedEditors()}handleClosedEditors(){this.activeEditor=this.tabsModel.activeEditor}moveEditor(t,e,i){}pinEditor(t){}stickEditor(t){}unstickEditor(t){}setActive(t){}updateEditorSelections(){}updateEditorLabel(t){}updateEditorDirty(t){}getHeight(){return 0}layout(t){return new dt(t.container.width,this.getHeight())}};var RN=class extends ia{constructor(e,i,n,o,s,a,l){super(l);this.parent=e;this.editorPartsView=i;this.groupsView=n;this.groupView=o;this.model=s;this.instantiationService=a;this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()}editorTabsControl;editorTabsControlDisposable=this._register(new W);breadcrumbsControlFactory;breadcrumbsControlDisposables=this._register(new W);get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}createEditorTabsControl(){let e;switch(this.groupsView.partOptions.showTabs){case"none":e=kN;break;case"single":e=LN;break;case"multiple":default:e=this.groupsView.partOptions.pinnedTabsOnSeparateRow?eS:Oo;break}let i=this.instantiationService.createInstance(e,this.parent,this.editorPartsView,this.groupsView,this.groupView,this.model);return this.editorTabsControlDisposable.add(i)}createBreadcrumbsControl(){if(this.groupsView.partOptions.showTabs==="single")return;let e=document.createElement("div");e.classList.add("breadcrumbs-below-tabs"),this.parent.appendChild(e);let i=this.breadcrumbsControlDisposables.add(this.instantiationService.createInstance(tg,e,this.groupView,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0}));return this.breadcrumbsControlDisposables.add(i.onDidEnablementChange(()=>this.groupView.relayout())),this.breadcrumbsControlDisposables.add(i.onDidVisibilityChange(()=>this.groupView.relayout())),i}openEditor(e,i){let n=this.editorTabsControl.openEditor(e,i);this.handleOpenedEditors(n)}openEditors(e){let i=this.editorTabsControl.openEditors(e);this.handleOpenedEditors(i)}handleOpenedEditors(e){e?this.breadcrumbsControl?.update():this.breadcrumbsControl?.revealLast()}beforeCloseEditor(e){return this.editorTabsControl.beforeCloseEditor(e)}closeEditor(e){this.editorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){this.editorTabsControl.closeEditors(e),this.handleClosedEditors()}handleClosedEditors(){this.groupView.activeEditor||this.breadcrumbsControl?.update()}moveEditor(e,i,n,o){return this.editorTabsControl.moveEditor(e,i,n,o)}pinEditor(e){return this.editorTabsControl.pinEditor(e)}stickEditor(e){return this.editorTabsControl.stickEditor(e)}unstickEditor(e){return this.editorTabsControl.unstickEditor(e)}setActive(e){return this.editorTabsControl.setActive(e)}updateEditorSelections(){this.editorTabsControl.updateEditorSelections()}updateEditorLabel(e){return this.editorTabsControl.updateEditorLabel(e)}updateEditorDirty(e){return this.editorTabsControl.updateEditorDirty(e)}updateOptions(e,i){e.showTabs!==i.showTabs||i.showTabs!=="single"&&e.pinnedTabsOnSeparateRow!==i.pinnedTabsOnSeparateRow?(this.editorTabsControlDisposable.clear(),this.breadcrumbsControlDisposables.clear(),ci(this.parent),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()):this.editorTabsControl.updateOptions(e,i)}layout(e){let i=this.editorTabsControl.layout(e),n;return this.breadcrumbsControl?.isHidden()===!1&&(n=new dt(e.container.width,bi.HEIGHT),this.breadcrumbsControl.layout(n)),new dt(e.container.width,i.height+(n?n.height:0))}getHeight(){let e=this.editorTabsControl.getHeight(),i=this.breadcrumbsControl?.isHidden()===!1?bi.HEIGHT:0;return{total:e+i,offset:e}}};RN=_([v(5,ae),v(6,Ze)],RN);var kb=class extends wn{constructor(e){super();this.context=e}run(e,i){let n=this.context;return i?.preserveFocus&&(n={...this.context,preserveFocus:!0}),super.run(e,n)}},il=class extends ia{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f){super(m);this.parent=e;this.editorPartsView=i;this.groupsView=n;this.groupView=o;this.tabsModel=s;this.contextMenuService=a;this.instantiationService=l;this.contextKeyService=d;this.keybindingService=c;this.notificationService=u;this.quickInputService=p;this.editorResolverService=g;this.hostService=f;this.contextMenuContextKeyService=this._register(this.contextKeyService.createScoped(e));let b=this._register(this.instantiationService.createChild(new Wr([ke,this.contextMenuContextKeyService])));this.resourceContext=this._register(b.createInstance(us)),this.editorPinnedContext=uQ.bindTo(this.contextMenuContextKeyService),this.editorIsFirstContext=pQ.bindTo(this.contextMenuContextKeyService),this.editorIsLastContext=hQ.bindTo(this.contextMenuContextKeyService),this.editorStickyContext=Qz.bindTo(this.contextMenuContextKeyService),this.editorAvailableEditorIds=e5.bindTo(this.contextMenuContextKeyService),this.editorCanSplitInGroupContext=Jz.bindTo(this.contextMenuContextKeyService),this.sideBySideEditorContext=t5.bindTo(this.contextMenuContextKeyService),this.groupLockedContext=TT.bindTo(this.contextMenuContextKeyService),this.renderDropdownAsChildElement=!1,this.tabsHoverDelegate=zt("mouse"),this.create(e)}editorTransfer=Lm.getInstance();groupTransfer=Lm.getInstance();treeItemsTransfer=Lm.getInstance();static EDITOR_TAB_HEIGHT={normal:35,compact:22};editorActionsToolbarContainer;editorActionsToolbar;editorActionsToolbarDisposables=this._register(new W);editorActionsDisposables=this._register(new W);contextMenuContextKeyService;resourceContext;editorPinnedContext;editorIsFirstContext;editorIsLastContext;editorStickyContext;editorAvailableEditorIds;editorCanSplitInGroupContext;sideBySideEditorContext;groupLockedContext;renderDropdownAsChildElement;tabsHoverDelegate;create(e){this.updateTabHeight()}get editorActionsEnabled(){return this.groupsView.partOptions.editorActionsLocation==="default"&&this.groupsView.partOptions.showTabs!=="none"}createEditorActionsToolBar(e,i){this.editorActionsToolbarContainer=document.createElement("div"),this.editorActionsToolbarContainer.classList.add(...i),e.appendChild(this.editorActionsToolbarContainer),this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer)}handleEditorActionToolBarVisibility(e){let i=this.editorActionsEnabled,n=!!this.editorActionsToolbar;i&&!n?this.doCreateEditorActionsToolBar(e):!i&&n&&(this.editorActionsToolbar?.getElement().remove(),this.editorActionsToolbar=void 0,this.editorActionsToolbarDisposables.clear(),this.editorActionsDisposables.clear()),e.classList.toggle("hidden",!i)}doCreateEditorActionsToolBar(e){let i={groupId:this.groupView.id};this.editorActionsToolbar=this.editorActionsToolbarDisposables.add(this.instantiationService.createInstance(pr,e,{actionViewItemProvider:(n,o)=>this.actionViewItemProvider(n,o),orientation:0,ariaLabel:h("ariaLabelEditorActions","Editor actions"),getKeyBinding:n=>this.getKeybinding(n),actionRunner:this.editorActionsToolbarDisposables.add(new kb(i)),anchorAlignmentProvider:()=>1,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:ee.EditorTitle,overflowBehavior:{maxItems:9,exempted:IN},highlightToggledItems:!0})),this.editorActionsToolbar.context=i,this.editorActionsToolbarDisposables.add(this.editorActionsToolbar.actionRunner.onDidRun(n=>{n.error&&!al(n.error)&&this.notificationService.error(n.error)}))}actionViewItemProvider(e,i){let n=this.groupView.activeEditorPane;if(n instanceof Hm){let o=n.getActionViewItem(e,i);if(o)return o}return ja(this.instantiationService,e,{...i,menuAsChild:this.renderDropdownAsChildElement})}updateEditorActionsToolbar(){if(!this.editorActionsEnabled)return;this.editorActionsDisposables.clear();let e=this.groupView.createEditorActions(this.editorActionsDisposables);this.editorActionsDisposables.add(e.onDidChange(()=>this.updateEditorActionsToolbar()));let i=Ue(this.editorActionsToolbar),{primary:n,secondary:o}=this.prepareEditorActions(e.actions);i.setActions(Or(n),Or(o))}getEditorPaneAwareContextKeyService(){return this.groupView.activeEditorPane?.scopedContextKeyService??this.contextKeyService}clearEditorActionsToolbar(){if(!this.editorActionsEnabled)return;Ue(this.editorActionsToolbar).setActions([],[])}onGroupDragStart(e,i){if(e.target!==i)return!1;let n=this.isNewWindowOperation(e);this.groupTransfer.setData([new Za(this.groupView.id)],Za.prototype),e.dataTransfer&&(e.dataTransfer.effectAllowed="copyMove");let o=!1;if(this.groupsView.partOptions.showTabs==="multiple"?o=this.doFillResourceDataTransfers(this.groupView.getEditors(1),e,n):this.groupView.activeEditor&&(o=this.doFillResourceDataTransfers([this.groupView.activeEditor],e,n)),!o&&dn&&e.dataTransfer?.setData(cs.TEXT,String(this.groupView.label)),this.groupView.activeEditor){let s=this.groupView.activeEditor.getName();this.groupsView.partOptions.showTabs==="multiple"&&this.groupView.count>1&&(s=h("draggedEditorGroup","{0} (+{1})",s,this.groupView.count-1)),CA(e,s,"monaco-editor-group-drag-image",this.getColor(or),this.getColor(ta))}return n}async onGroupDragEnd(e,i,n,o){if(this.groupTransfer.clearData(Za.prototype),e.target!==n||!o||SM())return;let s=await this.maybeCreateAuxiliaryEditorPartAt(e,n);if(!s)return;let a=s.activeGroup;this.groupsView.mergeGroup(this.groupView,a.id,{mode:this.isMoveOperation(i??e,a.id)?1:0}),a.focus()}async maybeCreateAuxiliaryEditorPartAt(e,i){let{point:n,display:o}=await this.hostService.getCursorScreenPoint()??{point:{x:e.screenX,y:e.screenY}},s=uo();if(s.document.visibilityState==="visible"&&s.document.hasFocus()&&n.x>=s.screenX&&n.x<=s.screenX+s.outerWidth&&n.y>=s.screenY&&n.y<=s.screenY+s.outerHeight)return;let a=i.offsetWidth/2,l=30+i.offsetHeight/2,d={x:n.x-a,y:n.y-l};return o&&(d.x<o.x&&(d.x=o.x),d.y<o.y&&(d.y=o.y)),this.editorPartsView.createAuxiliaryEditorPart({bounds:d})}isNewWindowOperation(e){return this.groupsView.partOptions.dragToOpenWindow?!e.altKey:e.altKey}isMoveOperation(e,i,n){return n?.hasCapability(8)?!0:!(e.ctrlKey&&!be||e.altKey&&be)||i===this.groupView.id}doFillResourceDataTransfers(e,i,n){return e.length?(this.instantiationService.invokeFunction(E5,e.map(o=>({editor:o,groupId:this.groupView.id})),i,{disableStandardTransfer:n}),!0):!1}onTabContextMenu(e,i,n){this.resourceContext.set(Ui.getOriginalUri(e,{supportSideBySide:1})),this.editorPinnedContext.set(this.tabsModel.isPinned(e)),this.editorIsFirstContext.set(this.tabsModel.isFirst(e)),this.editorIsLastContext.set(this.tabsModel.isLast(e)),this.editorStickyContext.set(this.tabsModel.isSticky(e)),this.groupLockedContext.set(this.tabsModel.isLocked),this.editorCanSplitInGroupContext.set(e.hasCapability(32)),this.sideBySideEditorContext.set(e.typeId===qn.ID),_Q(this.editorAvailableEditorIds,e,this.editorResolverService);let o=n;Na(i)&&(o=new ri(oe(n),i)),this.contextMenuService.showContextMenu({getAnchor:()=>o,menuId:ee.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextMenuContextKeyService,getActionsContext:()=>({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(e)}),getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id,this.contextMenuContextKeyService),onHide:()=>this.groupsView.activeGroup.focus()})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){let i=this.getKeybinding(e);return i?i.getLabel()??void 0:void 0}get tabHeight(){return this.groupsView.partOptions.tabHeight!=="compact"?il.EDITOR_TAB_HEIGHT.normal:il.EDITOR_TAB_HEIGHT.compact}getHoverTitle(e){let i=e.getTitle(2);return this.tabsModel.isPinned(e)?i:{markdown:new kg("",{supportThemeIcons:!0,isTrusted:!0}).appendText(i).appendMarkdown(' (_preview_ [$(gear)](command:workbench.action.openSettings?%5B%22workbench.editor.enablePreview%22%5D "Configure Preview Mode"))'),markdownNotSupportedFallback:i+" (preview)"}}getHoverDelegate(){return this.tabsHoverDelegate}updateTabHeight(){this.parent.style.setProperty("--editor-group-tab-height",`${this.tabHeight}px`)}updateOptions(e,i){e.tabHeight!==i.tabHeight&&this.updateTabHeight(),(e.editorActionsLocation!==i.editorActionsLocation||e.showTabs!==i.showTabs)&&this.editorActionsToolbarContainer&&(this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer),this.updateEditorActionsToolbar())}};il=_([v(5,Mt),v(6,ae),v(7,ke),v(8,at),v(9,jt),v(10,$o),v(11,Ze),v(12,hI),v(13,en)],il);var AN=class extends We{constructor(e,i,n,o,s){let a=s?ps.toNegated():X.true();super({id:`toggle.${e}`,title:i,metadata:n?{description:n}:void 0,toggled:X.equals(`config.${e}`,!0),menu:[{id:ee.TitleBarContext,when:a,order:o,group:"2_config"},{id:ee.TitleBarTitleContext,when:a,order:o,group:"2_config"}]});this.section=e}run(e,...i){let n=e.get(de),o=n.getValue(this.section);n.updateValue(this.section,!o)}};Me(class extends AN{constructor(){super("window.commandCenter",h("toggle.commandCenter","Command Center"),h("toggle.commandCenterDescription","Toggle visibility of the Command Center in title bar"),1,!1)}});Me(class extends AN{constructor(){super("workbench.layoutControl.enabled",h("toggle.layout","Layout Controls"),h("toggle.layoutDescription","Toggle visibility of the Layout Controls in title bar"),2,!0)}});Me(class extends We{constructor(){super({id:"toggle.window.customTitleBarVisibility",title:h("toggle.hideCustomTitleBar","Hide Custom Title Bar"),menu:[{id:ee.TitleBarContext,order:0,when:X.equals(Im.key,"native"),group:"3_toggle"},{id:ee.TitleBarTitleContext,order:0,when:X.equals(Im.key,"native"),group:"3_toggle"}]})}run(t,...e){t.get(de).updateValue("window.customTitleBarVisibility","never")}});Me(class extends We{constructor(){super({id:"toggle.window.customTitleBarVisibility.windowed",title:h("toggle.hideCustomTitleBarInFullScreen","Hide Custom Title Bar In Full Screen"),menu:[{id:ee.TitleBarContext,order:1,when:Ga,group:"3_toggle"},{id:ee.TitleBarTitleContext,order:1,when:Ga,group:"3_toggle"}]})}run(t,...e){t.get(de).updateValue("window.customTitleBarVisibility","windowed")}});var c9=class extends We{constructor(){super({id:"toggle.toggleCustomTitleBar",title:h("toggle.customTitleBar","Custom Title Bar"),toggled:_f,menu:[{id:ee.MenubarAppearanceMenu,order:6,when:X.or(X.and(X.equals(Im.key,"native"),X.and(X.equals("config.workbench.layoutControl.enabled",!1),X.equals("config.window.commandCenter",!1),X.notEquals("config.workbench.editor.editorActionsLocation","titleBar"),X.notEquals("config.workbench.activityBar.location","top"),X.notEquals("config.workbench.activityBar.location","bottom"))?.negate()),Ga),group:"2_workbench_layout"}]})}run(t,...e){let i=t.get(de),n=t.get(ke);switch(i.getValue("window.customTitleBarVisibility")){case"never":i.updateValue("window.customTitleBarVisibility","auto");break;case"windowed":{Ga.evaluate(n.getContext(null))?i.updateValue("window.customTitleBarVisibility","auto"):i.updateValue("window.customTitleBarVisibility","never");break}case"auto":default:i.updateValue("window.customTitleBarVisibility","never");break}}};Me(c9);Me(class extends We{constructor(){super({id:"showCustomTitleBar",title:pe("showCustomTitleBar","Show Custom Title Bar"),precondition:_f.negate(),f1:!0})}run(t,...e){t.get(de).updateValue("window.customTitleBarVisibility","auto")}});Me(class extends We{constructor(){super({id:"hideCustomTitleBar",title:pe("hideCustomTitleBar","Hide Custom Title Bar"),precondition:_f,f1:!0})}run(t,...e){t.get(de).updateValue("window.customTitleBarVisibility","never")}});Me(class extends We{constructor(){super({id:"hideCustomTitleBarInFullScreen",title:pe("hideCustomTitleBarInFullScreen","Hide Custom Title Bar In Full Screen"),precondition:X.and(_f,Ga),f1:!0})}run(t,...e){t.get(de).updateValue("window.customTitleBarVisibility","windowed")}});Me(class oc extends We{static settingsID="workbench.editor.editorActionsLocation";constructor(){let t=X.and(X.equals("config.workbench.editor.showTabs","none").negate(),X.equals(`config.${oc.settingsID}`,"default"))?.negate();super({id:`toggle.${oc.settingsID}`,title:h("toggle.editorActions","Editor Actions"),toggled:X.equals(`config.${oc.settingsID}`,"hidden").negate(),menu:[{id:ee.TitleBarContext,order:3,when:t,group:"2_config"},{id:ee.TitleBarTitleContext,order:3,when:t,group:"2_config"}]})}run(t,...e){let i=t.get(de),n=t.get(tt),o=i.getValue(oc.settingsID);if(o==="hidden"){if(i.getValue("workbench.editor.showTabs")!=="none")i.updateValue(oc.settingsID,"titleBar");else{let a=n.get(oc.settingsID,0);i.updateValue(oc.settingsID,a??"default")}n.remove(oc.settingsID,0)}else i.updateValue(oc.settingsID,"hidden"),n.store(oc.settingsID,o,0,0)}});var bte={id:jp,label:h("accounts","Accounts"),tooltip:h("accounts","Accounts"),class:void 0,enabled:!0,run:function(){}},vte={id:qp,label:h("manage","Manage"),tooltip:h("manage","Manage"),class:void 0,enabled:!0,run:function(){}};var PN=class extends By{constructor(e,i,n){super("workbench.titleService",n,i);this.instantiationService=e;this._register(this.registerPart(this.mainPart)),this.registerActions(),this.registerAPICommands()}mainPart=this._register(this.createMainTitlebarPart());createMainTitlebarPart(){return this.instantiationService.createInstance(d_)}registerActions(){let e=this;this._register(Me(class extends We{constructor(){super({id:"workbench.action.focusTitleBar",title:pe("focusTitleBar","Focus Title Bar"),category:gt.View,f1:!0})}run(){e.getPartByDocument(Dc()).focus()}}))}registerAPICommands(){this._register(En.registerCommand({id:"registerWindowTitleVariable",handler:(e,i,n)=>{this.registerVariables([{name:i,contextKey:n}])},metadata:{description:"Registers a new title variable",args:[{name:"name",schema:{type:"string"},description:"The name of the variable to register"},{name:"contextKey",schema:{type:"string"},description:"The context key to use for the value of the variable"}]}}))}createAuxiliaryTitlebarPart(e,i){let n=document.createElement("div");n.classList.add("part","titlebar"),n.setAttribute("role","none"),n.style.position="relative",e.insertBefore(n,e.firstChild);let o=new W,s=this.doCreateAuxiliaryTitlebarPart(n,i);return o.add(this.registerPart(s)),o.add(O.runAndSubscribe(s.onDidChange,()=>n.style.height=`${s.height}px`)),s.create(n),this.properties&&s.updateProperties(this.properties),this.variables.size&&s.registerVariables(Array.from(this.variables.values())),O.once(s.onWillDispose)(()=>o.dispose()),s}doCreateAuxiliaryTitlebarPart(e,i){return this.instantiationService.createInstance(Rb,e,i,this.mainPart)}onMenubarVisibilityChange=this.mainPart.onMenubarVisibilityChange;properties=void 0;updateProperties(e){this.properties=e;for(let i of this.parts)i.updateProperties(e)}variables=new Map;registerVariables(e){let i=[];for(let n of e)this.variables.has(n.name)||(this.variables.set(n.name,n),i.push(n));for(let n of this.parts)n.registerVariables(i)}};PN=_([v(0,ae),v(1,tt),v(2,Ze)],PN);var tS=class extends xl{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y){super(e,{hasTitle:!1},d,c,u);this.contextMenuService=o;this.configurationService=s;this.environmentService=a;this.instantiationService=l;this.storageService=c;this.contextKeyService=p;this.hostService=m;this.editorGroupService=g;this.menuService=b;this.keybindingService=y;this.isAuxiliary=n!=="main",this.editorService=f.createScoped(n,this._store),this.editorGroupsContainer=n==="main"?g.mainPart:n,this.windowTitle=this._register(l.createInstance(Ja,i,n)),this.hoverDelegate=this._register(Ha()),this.registerListeners(oa(i))}minimumWidth=0;maximumWidth=Number.POSITIVE_INFINITY;get minimumHeight(){let e=wt&&Vg(),i=this.isCommandCenterVisible||e?bq:30;return e&&(i=Math.max(i,Cj(oe(this.element))?.height??0)),i/(this.preventZoom?ap(oe(this.element)):1)}get maximumHeight(){return this.minimumHeight}_onMenubarVisibilityChange=this._register(new T);onMenubarVisibilityChange=this._onMenubarVisibilityChange.event;_onWillDispose=this._register(new T);onWillDispose=this._onWillDispose.event;rootContainer;windowControlsContainer;dragRegion;title;leftContent;centerContent;rightContent;customMenubar;appIcon;appIconBadge;menubar;lastLayoutDimensions;actionToolBar;actionToolBarDisposable=this._register(new W);editorActionsChangeDisposable=this._register(new W);actionToolBarElement;layoutToolbarMenu;editorToolbarMenuDisposables=this._register(new W);layoutToolbarMenuDisposables=this._register(new W);activityToolbarDisposables=this._register(new W);hoverDelegate;titleDisposables=this._register(new W);titleBarStyle=Nw(this.configurationService);isInactive=!1;isAuxiliary;windowTitle;editorService;editorGroupsContainer;registerListeners(e){this._register(this.hostService.onDidChangeFocus(i=>i?this.onFocus():this.onBlur())),this._register(this.hostService.onDidChangeActiveWindow(i=>i===e?this.onFocus():this.onBlur())),this._register(this.configurationService.onDidChangeConfiguration(i=>this.onConfigurationChanged(i))),this._register(this.editorGroupService.onDidChangeEditorPartOptions(i=>this.onEditorPartConfigurationChange(i)))}onBlur(){this.isInactive=!0,this.updateStyles()}onFocus(){this.isInactive=!1,this.updateStyles()}onEditorPartConfigurationChange({oldPartOptions:e,newPartOptions:i}){(e.editorActionsLocation!==i.editorActionsLocation||e.showTabs!==i.showTabs)&&np(this.configurationService,this.titleBarStyle)&&this.actionToolBar&&(this.createActionToolBar(),this.createActionToolBarMenus({editorActions:!0}),this._onDidChange.fire(void 0))}onConfigurationChanged(e){if(!this.isAuxiliary&&!Dr(this.configurationService,this.titleBarStyle)&&(!be||wt)&&e.affectsConfiguration("window.menuBarVisibility")&&(this.currentMenubarVisibility==="compact"?this.uninstallMenubar():this.installMenubar()),np(this.configurationService,this.titleBarStyle)&&this.actionToolBar){let i=e.affectsConfiguration("workbench.layoutControl.enabled"),n=e.affectsConfiguration("workbench.activityBar.location");(i||n)&&(this.createActionToolBarMenus({layoutActions:i,activityActions:n}),this._onDidChange.fire(void 0))}e.affectsConfiguration("window.commandCenter")&&(this.createTitle(),this._onDidChange.fire(void 0))}installMenubar(){this.menubar||(this.customMenubar=this._register(this.instantiationService.createInstance(Vm)),this.menubar=Ee(this.leftContent,re("div.menubar")),this.menubar.setAttribute("role","menubar"),this._register(this.customMenubar.onVisibilityChange(e=>this.onMenubarVisibilityChanged(e))),this.customMenubar.create(this.menubar))}uninstallMenubar(){this.customMenubar?.dispose(),this.customMenubar=void 0,this.menubar?.remove(),this.menubar=void 0,this.onMenubarVisibilityChanged(!1)}onMenubarVisibilityChanged(e){(wt||rt||_t)&&(this.lastLayoutDimensions&&this.layout(this.lastLayoutDimensions.width,this.lastLayoutDimensions.height),this._onMenubarVisibilityChange.fire(e))}updateProperties(e){this.windowTitle.updateProperties(e)}registerVariables(e){this.windowTitle.registerVariables(e)}createContentArea(e){if(this.element=e,this.rootContainer=Ee(e,re(".titlebar-container")),this.leftContent=Ee(this.rootContainer,re(".titlebar-left")),this.centerContent=Ee(this.rootContainer,re(".titlebar-center")),this.rightContent=Ee(this.rootContainer,re(".titlebar-right")),!be&&!wt&&!Dr(this.configurationService,this.titleBarStyle)&&(this.appIcon=up(this.leftContent,re("a.window-appicon")),!this.isAuxiliary&&wt)){let i=this.environmentService.options?.homeIndicator;if(i){let n=pq().getIcon(i.icon)?{id:i.icon}:B.code;this.appIcon.setAttribute("href",i.href),this.appIcon.classList.add(...ye.asClassNameArray(n)),this.appIconBadge=document.createElement("div"),this.appIconBadge.classList.add("home-bar-icon-badge"),this.appIcon.appendChild(this.appIconBadge)}}if(this.dragRegion=up(this.rootContainer,re("div.titlebar-drag-region")),!this.isAuxiliary&&!Dr(this.configurationService,this.titleBarStyle)&&(!be||wt)&&this.currentMenubarVisibility!=="compact"&&this.installMenubar(),this.title=Ee(this.centerContent,re("div.window-title")),this.createTitle(),np(this.configurationService,this.titleBarStyle)&&(this.actionToolBarElement=Ee(this.rightContent,re("div.action-toolbar-container")),this.createActionToolBar(),this.createActionToolBarMenus()),!Dr(this.configurationService,this.titleBarStyle)){let i=be?"left":"right";be&&Pi&&new Intl.Locale($9)?.textInfo?.direction==="rtl"&&(i="right"),be&&Pi&&i==="left"||(this.windowControlsContainer=Ee(i==="left"?this.leftContent:this.rightContent,re("div.window-controls-container")),wt&&Ee(i==="left"?this.rightContent:this.leftContent,re("div.window-controls-container")),Vg()&&this.windowControlsContainer.classList.add("wco-enabled"))}return this._register(M(this.rootContainer,G.CONTEXT_MENU,i=>{Te.stop(i);let n;be&&Oi(i.target)&&Xi(i.target,this.title)?n=ee.TitleBarTitleContext:n=ee.TitleBarContext,this.onContextMenu(i,n)})),be&&this._register(M(this.title,G.MOUSE_DOWN,i=>{i.metaKey&&(Te.stop(i,!0),this.onContextMenu(i,ee.TitleBarTitleContext))},!0)),this.updateStyles(),this.element}createTitle(){if(this.titleDisposables.clear(),!this.isCommandCenterVisible)this.title.innerText=this.windowTitle.value,this.titleDisposables.add(this.windowTitle.onDidChange(()=>{this.title.innerText=this.windowTitle.value}));else{let e=this.instantiationService.createInstance(JI,this.windowTitle,this.hoverDelegate);Tn(this.title,e.element),this.titleDisposables.add(e)}}actionViewItemProvider(e,i){if(!this.isAuxiliary){if(e.id===qp)return this.instantiationService.createInstance(QI,{position:()=>2},i);if(e.id===jp)return this.instantiationService.createInstance(XI,{position:()=>2},i)}let n=this.editorGroupsContainer.activeGroup?.activeEditorPane;if(n&&n instanceof Hm){let o=n.getActionViewItem(e,i);if(o)return o}return ja(this.instantiationService,e,{...i,menuAsChild:!1})}getKeybinding(e){let i=this.editorGroupsContainer.activeGroup?.activeEditorPane?.scopedContextKeyService??this.contextKeyService;return this.keybindingService.lookupKeybinding(e.id,i)}createActionToolBar(){this.actionToolBarDisposable.clear(),this.actionToolBar=this.actionToolBarDisposable.add(this.instantiationService.createInstance(pr,this.actionToolBarElement,{contextMenu:ee.TitleBarContext,orientation:0,ariaLabel:h("ariaLabelTitleActions","Title actions"),getKeyBinding:e=>this.getKeybinding(e),overflowBehavior:{maxItems:9,exempted:[jp,qp,...IN]},anchorAlignmentProvider:()=>1,telemetrySource:"titlePart",highlightToggledItems:this.editorActionsEnabled,actionViewItemProvider:(e,i)=>this.actionViewItemProvider(e,i),hoverDelegate:this.hoverDelegate})),this.editorActionsEnabled&&this.actionToolBarDisposable.add(this.editorGroupsContainer.onDidChangeActiveGroup(()=>this.createActionToolBarMenus({editorActions:!0})))}createActionToolBarMenus(e=!0){e===!0&&(e={editorActions:!0,layoutActions:!0,activityActions:!0});let i=()=>{let n={primary:[],secondary:[]};if(this.editorActionsEnabled){this.editorActionsChangeDisposable.clear();let o=this.editorGroupsContainer.activeGroup;if(o){let s=o.createEditorActions(this.editorActionsChangeDisposable);n.primary.push(...s.actions.primary),n.secondary.push(...s.actions.secondary),this.editorActionsChangeDisposable.add(s.onDidChange(()=>i()))}}this.layoutToolbarMenu&&qa(this.layoutToolbarMenu,{},n,()=>!this.editorActionsEnabled),this.activityActionsEnabled&&(gx(this.storageService)&&n.primary.push(bte),n.primary.push(vte)),this.actionToolBar.setActions(Or(n.primary),Or(n.secondary))};if(e.editorActions)if(this.editorToolbarMenuDisposables.clear(),this.editorActionsEnabled&&this.editorService.activeEditor!==void 0){let n={groupId:this.editorGroupsContainer.activeGroup.id};this.actionToolBar.actionRunner=new kb(n),this.actionToolBar.context=n,this.editorToolbarMenuDisposables.add(this.actionToolBar.actionRunner)}else this.actionToolBar.actionRunner=new wn,this.actionToolBar.context=void 0,this.editorToolbarMenuDisposables.add(this.actionToolBar.actionRunner);e.layoutActions&&(this.layoutToolbarMenuDisposables.clear(),this.layoutControlEnabled?(this.layoutToolbarMenu=this.menuService.createMenu(ee.LayoutControlMenu,this.contextKeyService),this.layoutToolbarMenuDisposables.add(this.layoutToolbarMenu),this.layoutToolbarMenuDisposables.add(this.layoutToolbarMenu.onDidChange(()=>i()))):this.layoutToolbarMenu=void 0),e.activityActions&&(this.activityToolbarDisposables.clear(),this.activityActionsEnabled&&this.activityToolbarDisposables.add(this.storageService.onDidChangeValue(0,Yd.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,this._store)(()=>i()))),i()}updateStyles(){if(super.updateStyles(),this.element){this.isInactive?this.element.classList.add("inactive"):this.element.classList.remove("inactive");let e=this.getColor(this.isInactive?cj:Rv,(o,s)=>o.isOpaque()?o:o.makeOpaque(Av(s)))||"";this.element.style.backgroundColor=e,this.appIconBadge&&(this.appIconBadge.style.backgroundColor=e),e&&Y.fromHex(e).isLighter()?this.element.classList.add("light"):this.element.classList.remove("light");let i=this.getColor(this.isInactive?WL:ml);this.element.style.color=i||"";let n=this.getColor(uj);this.element.style.borderBottom=n?`1px solid ${n}`:""}}onContextMenu(e,i){let n=new ri(oe(this.element),e);this.contextMenuService.showContextMenu({getAnchor:()=>n,menuId:i,contextKeyService:this.contextKeyService,domForShadowRoot:be&&Pi?n.target:void 0})}get currentMenubarVisibility(){return this.isAuxiliary?"hidden":na(this.configurationService)}get layoutControlEnabled(){return!this.isAuxiliary&&this.configurationService.getValue("workbench.layoutControl.enabled")!==!1}get isCommandCenterVisible(){return this.configurationService.getValue("window.commandCenter")!==!1}get editorActionsEnabled(){return this.editorGroupService.partOptions.editorActionsLocation==="titleBar"||this.editorGroupService.partOptions.editorActionsLocation==="default"&&this.editorGroupService.partOptions.showTabs==="none"}get activityActionsEnabled(){let e=this.configurationService.getValue("workbench.activityBar.location");return!this.isAuxiliary&&(e==="top"||e==="bottom")}get hasZoomableElements(){let e=!(this.currentMenubarVisibility==="hidden"||this.currentMenubarVisibility==="compact"||!wt&&be),i=this.isCommandCenterVisible,n=this.layoutControlEnabled||this.editorActionsEnabled||this.activityActionsEnabled;return e||i||n}get preventZoom(){return ap(oe(this.element))<1||!this.hasZoomableElements}layout(e,i){this.updateLayout(new dt(e,i)),super.layoutContents(e,i)}updateLayout(e){if(this.lastLayoutDimensions=e,np(this.configurationService,this.titleBarStyle)){let i=ap(oe(this.element));if(this.element.style.setProperty("--zoom-factor",i.toString()),this.rootContainer.classList.toggle("counter-zoom",this.preventZoom),this.customMenubar){let n=new dt(0,e.height);this.customMenubar.layout(n)}}}focus(){this.customMenubar?this.customMenubar.toggleFocus():this.element.querySelector('[tabindex]:not([tabindex="-1"])').focus()}toJSON(){return{type:"workbench.parts.titlebar"}}dispose(){this._onWillDispose.fire(),super.dispose()}};tS=_([v(3,Mt),v(4,de),v(5,Ml),v(6,ae),v(7,Ze),v(8,tt),v(9,Qe),v(10,ke),v(11,en),v(12,di),v(13,kt),v(14,Ri),v(15,at)],tS);var d_=class extends tS{constructor(t,e,i,n,o,s,a,l,d,c,u,p,m){super("workbench.parts.titlebar",ne,"main",t,e,i,n,o,s,a,l,d,c,u,p,m)}};d_=_([v(0,Mt),v(1,de),v(2,Ml),v(3,ae),v(4,Ze),v(5,tt),v(6,Qe),v(7,ke),v(8,en),v(9,di),v(10,kt),v(11,Ri),v(12,at)],d_);var Rb=class extends tS{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y){let I=Rb.COUNTER++;super(`workbench.parts.auxiliaryTitle.${I}`,oe(e),i,o,s,a,l,d,c,u,p,m,g,f,b,y);this.container=e;this.mainTitlebar=n}static COUNTER=1;get height(){return this.minimumHeight}get preventZoom(){return ap(oe(this.element))<1||!this.mainTitlebar.hasZoomableElements}};Rb=_([v(3,Mt),v(4,de),v(5,Ml),v(6,ae),v(7,Ze),v(8,tt),v(9,Qe),v(10,ke),v(11,en),v(12,di),v(13,kt),v(14,Ri),v(15,at)],Rb);var MN=$("titleService");var ON=$("bannerService");var rc=class extends Bl{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f){super("workbench.parts.auxiliarybar",{hasTitle:!0,borderWidth:()=>this.getColor(Ov)||this.getColor(Le)?1:0},rc.activePanelSettingsKey,wQ.bindTo(u),EQ.bindTo(u),"auxiliarybar","auxiliarybar",void 0,e,i,n,o,s,a,l,d,c,u,p,g);this.commandService=m;this.configurationService=f;this._register(f.onDidChangeConfiguration(b=>{b.affectsConfiguration("workbench.activityBar.location")&&this.onDidChangeActivityBarLocation()}))}static activePanelSettingsKey="workbench.auxiliarybar.activepanelid";static pinnedPanelsKey="workbench.auxiliarybar.pinnedPanels";static placeholdeViewContainersKey="workbench.auxiliarybar.placeholderPanels";static viewContainersWorkspaceStateKey="workbench.auxiliarybar.viewContainersWorkspaceState";minimumWidth=170;maximumWidth=Number.POSITIVE_INFINITY;minimumHeight=0;maximumHeight=Number.POSITIVE_INFINITY;get preferredHeight(){return this.layoutService.mainContainerDimension.height*.4}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let i=e.getOptimalWidth();if(typeof i=="number")return Math.max(i,300)}priority=1;onDidChangeActivityBarLocation(){this.updateCompositeBar();let e=this.getActiveComposite()?.getId();e&&this.onTitleAreaUpdate(e)}updateStyles(){super.updateStyles();let e=Ue(this.getContainer());e.style.backgroundColor=this.getColor(gl)||"";let i=this.getColor(Ov)||this.getColor(Le),n=this.layoutService.getSideBarPosition()===1;e.style.color=this.getColor(Mv)||"",e.style.borderLeftColor=i??"",e.style.borderRightColor=i??"",e.style.borderLeftStyle=i&&!n?"solid":"none",e.style.borderRightStyle=i&&n?"solid":"none",e.style.borderLeftWidth=i&&!n?"1px":"0px",e.style.borderRightWidth=i&&n?"1px":"0px"}getCompositeBarOptions(){let e=this;return{partContainerClass:"auxiliarybar",pinnedViewContainersKey:rc.pinnedPanelsKey,placeholderViewContainersKey:rc.placeholdeViewContainersKey,viewContainersWorkspaceStateKey:rc.viewContainersWorkspaceStateKey,icon:!0,orientation:0,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===2?3:2},fillExtraContextMenuActions:i=>this.fillExtraContextMenuActions(i),compositeSize:0,iconSize:16,get overflowActionSize(){return e.getCompositeBarPosition()===1?40:30},colors:i=>({activeBackgroundColor:i.getColor(gl),inactiveBackgroundColor:i.getColor(gl),get activeBorderBottomColor(){return e.getCompositeBarPosition()===1?i.getColor(OL):i.getColor(FL)},get activeForegroundColor(){return e.getCompositeBarPosition()===1?i.getColor(rp):i.getColor(sp)},get inactiveForegroundColor(){return e.getCompositeBarPosition()===1?i.getColor(ML):i.getColor(BL)},badgeBackground:i.getColor(sd),badgeForeground:i.getColor(ad),get dragAndDropBorder(){return e.getCompositeBarPosition()===1?i.getColor(NL):i.getColor(VL)}}),compact:!0}}fillExtraContextMenuActions(e){let i=this.layoutService.getSideBarPosition()===0,n=this.getViewsSubmenuAction();n&&(e.push(new pt),e.push(n));let o=this.menuService.getMenuActions(ee.ActivityBarPositionMenu,this.contextKeyService,{shouldForwardArgs:!0,renderShortTitle:!0}),s=[];Mp(o,{primary:[],secondary:s}),e.push(new pt,new mn("workbench.action.panel.position",h("activity bar position","Activity Bar Position"),s),Ht({id:Fr.ID,label:i?h("move second side bar left","Move Secondary Side Bar Left"):h("move second side bar right","Move Secondary Side Bar Right"),run:()=>this.commandService.executeCommand(Fr.ID)}),Ht({id:Ol.ID,label:h("hide second side bar","Hide Secondary Side Bar"),run:()=>this.commandService.executeCommand(Ol.ID)}))}shouldShowCompositeBar(){return this.configurationService.getValue("workbench.activityBar.location")!=="hidden"}getCompositeBarPosition(){switch(this.configurationService.getValue("workbench.activityBar.location")){case"top":return 0;case"bottom":return 2;case"hidden":return 1;case"default":return 1;default:return 1}}createHeaderArea(){let e=super.createHeaderArea(),i=re(".auxiliary-bar-global-header"),n=this.headerFooterCompositeBarDispoables.add(this.instantiationService.createInstance(Pl,ee.AuxiliaryBarHeader,void 0,void 0)),o=this.headerFooterCompositeBarDispoables.add(this.instantiationService.createInstance(pr,i,{actionViewItemProvider:(s,a)=>this.headerActionViewItemProvider(s,a),orientation:0,hiddenItemStrategy:-1,getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id)}));return o.setActions(Or(n.getPrimaryActions())),this.headerFooterCompositeBarDispoables.add(n.onDidChange(()=>o.setActions(Or(n.getPrimaryActions())))),e.appendChild(i),e}headerActionViewItemProvider(e,i){if(e.id===Ol.ID)return this.instantiationService.createInstance(Nd,void 0,e,i)}toJSON(){return{type:"workbench.parts.auxiliarybar"}}};rc=_([v(0,jt),v(1,tt),v(2,Mt),v(3,Qe),v(4,at),v(5,qi),v(6,ae),v(7,Ze),v(8,zi),v(9,ke),v(10,xn),v(11,ni),v(12,Ri),v(13,de)],rc);var lhe=["workbench.activityBar.location","window.commandCenter","workbench.editor.editorActionsLocation","workbench.layoutControl.enabled","window.menuBarVisibility","window.titleBarStyle","window.customTitleBarVisibility"],NN=class extends L{constructor(e){super();this.parent=e}_onDidChangeZenMode=this._register(new T);onDidChangeZenMode=this._onDidChangeZenMode.event;_onDidChangeMainEditorCenteredLayout=this._register(new T);onDidChangeMainEditorCenteredLayout=this._onDidChangeMainEditorCenteredLayout.event;_onDidChangePanelAlignment=this._register(new T);onDidChangePanelAlignment=this._onDidChangePanelAlignment.event;_onDidChangeWindowMaximized=this._register(new T);onDidChangeWindowMaximized=this._onDidChangeWindowMaximized.event;_onDidChangePanelPosition=this._register(new T);onDidChangePanelPosition=this._onDidChangePanelPosition.event;_onDidChangePartVisibility=this._register(new T);onDidChangePartVisibility=this._onDidChangePartVisibility.event;_onDidChangeNotificationsVisibility=this._register(new T);onDidChangeNotificationsVisibility=this._onDidChangeNotificationsVisibility.event;_onDidLayoutMainContainer=this._register(new T);onDidLayoutMainContainer=this._onDidLayoutMainContainer.event;_onDidLayoutActiveContainer=this._register(new T);onDidLayoutActiveContainer=this._onDidLayoutActiveContainer.event;_onDidLayoutContainer=this._register(new T);onDidLayoutContainer=this._onDidLayoutContainer.event;_onDidAddContainer=this._register(new T);onDidAddContainer=this._onDidAddContainer.event;_onDidChangeActiveContainer=this._register(new T);onDidChangeActiveContainer=this._onDidChangeActiveContainer.event;mainContainer=document.createElement("div");get activeContainer(){return this.getContainerFromDocument(Dc())}get containers(){let e=[];for(let{window:i}of hd())e.push(this.getContainerFromDocument(i.document));return e}getContainerFromDocument(e){return e===this.mainContainer.ownerDocument?this.mainContainer:e.body.getElementsByClassName("monaco-workbench")[0]}containerStylesLoaded=new Map;whenContainerStylesLoaded(e){return this.containerStylesLoaded.get(e.vscodeWindowId)}_mainContainerDimension;get mainContainerDimension(){return this._mainContainerDimension}get activeContainerDimension(){return this.getContainerDimension(this.activeContainer)}getContainerDimension(e){return e===this.mainContainer?this.mainContainerDimension:gd(e)}get mainContainerOffset(){return this.computeContainerOffset(ne)}get activeContainerOffset(){return this.computeContainerOffset(oe(this.activeContainer))}computeContainerOffset(e){let i=0,n=0;this.isVisible("workbench.parts.banner")&&(i=this.getPart("workbench.parts.banner").maximumHeight,n=i);let o=this.isVisible("workbench.parts.titlebar",e);return o&&(i+=this.getPart("workbench.parts.titlebar").maximumHeight,n=i),o&&this.configurationService.getValue("window.commandCenter")!==!1&&(n=6),{top:i,quickPickTop:n}}parts=new Map;initialized=!1;workbenchGrid;titleBarPartView;bannerPartView;activityBarPartView;sideBarPartView;panelPartView;auxiliaryBarPartView;editorPartView;statusBarPartView;environmentService;extensionService;configurationService;storageService;hostService;editorService;mainPartEditorService;editorGroupService;paneCompositeService;titleService;viewDescriptorService;contextService;workingCopyBackupService;notificationService;themeService;statusBarService;logService;telemetryService;auxiliaryWindowService;state;stateModel;disposed=!1;initLayout(e){this.environmentService=e.get(Ml),this.configurationService=e.get(de),this.hostService=e.get(en),this.contextService=e.get(Xt),this.storageService=e.get(tt),this.workingCopyBackupService=e.get(cy),this.themeService=e.get(Ze),this.extensionService=e.get(xn),this.logService=e.get(Gt),this.telemetryService=e.get(qt),this.auxiliaryWindowService=e.get(D5),this.editorService=e.get(kt),this.mainPartEditorService=this.editorService.createScoped("main",this._store),this.editorGroupService=e.get(di),this.paneCompositeService=e.get(hs),this.viewDescriptorService=e.get(zi),this.titleService=e.get(MN),this.notificationService=e.get(jt),this.statusBarService=e.get(Bs),e.get(ON),this.registerLayoutListeners(),this.initLayoutState(e.get(Pn),e.get(ai))}registerLayoutListeners(){let e=()=>{this.isVisible("workbench.parts.editor",ne)||this.toggleMaximizedPanel()};this.editorGroupService.whenRestored.then(()=>{this._register(this.mainPartEditorService.onDidVisibleEditorsChange(e)),this._register(this.editorGroupService.mainPart.onDidActivateGroup(e)),this._register(this.mainPartEditorService.onDidActiveEditorChange(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED))))}),this._register(this.configurationService.onDidChangeConfiguration(n=>{if([...lhe,"workbench.sideBar.location","workbench.statusBar.visible"].some(o=>n.affectsConfiguration(o))){let o=n.affectsConfiguration("workbench.editor.editorActionsLocation")&&this.configurationService.getValue("workbench.editor.editorActionsLocation")==="titleBar",s=!1;if(n.affectsConfiguration("workbench.activityBar.location")){let a=this.configurationService.getValue("workbench.activityBar.location");s=a==="top"||a==="bottom"}(s||o)&&this.configurationService.getValue("window.customTitleBarVisibility")==="never"&&this.configurationService.updateValue("window.customTitleBarVisibility","auto"),this.doUpdateLayoutConfiguration()}})),this._register(Nv(n=>this.onFullscreenChanged(n))),this._register(this.editorGroupService.mainPart.onDidAddGroup(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED)))),this._register(this.editorGroupService.mainPart.onDidRemoveGroup(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED)))),this._register(this.editorGroupService.mainPart.onDidChangeGroupMaximized(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED)))),this._register(M(this.mainContainer,G.SCROLL,()=>this.mainContainer.scrollTop=0)),(rt||_t||wt)&&!Dr(this.configurationService)&&this._register(this.titleService.onMenubarVisibilityChange(n=>this.onMenubarToggled(n))),this._register(this.themeService.onDidColorThemeChange(()=>this.updateWindowsBorder())),this._register(this.hostService.onDidChangeFocus(n=>this.onWindowFocusChanged(n))),this._register(this.hostService.onDidChangeActiveWindow(()=>this.onActiveWindowChanged())),wt&&typeof navigator.windowControlsOverlay=="object"&&this._register(M(navigator.windowControlsOverlay,"geometrychange",()=>this.onDidChangeWCO())),this._register(this.auxiliaryWindowService.onDidOpenAuxiliaryWindow(({window:n,disposables:o})=>{let s=n.window.vscodeWindowId;this.containerStylesLoaded.set(s,n.whenStylesHaveLoaded),n.whenStylesHaveLoaded.then(()=>this.containerStylesLoaded.delete(s)),o.add(te(()=>this.containerStylesLoaded.delete(s)));let a=o.add(new W);this._onDidAddContainer.fire({container:n.container,disposables:a}),o.add(n.onDidLayout(l=>this.handleContainerDidLayout(n.container,l)))}))}onMenubarToggled(e){if(e!==this.state.runtime.menuBar.toggled){this.state.runtime.menuBar.toggled=e;let i=na(this.configurationService);wt&&i==="toggle"?this.workbenchGrid.setViewVisible(this.titleBarPartView,rm(this.configurationService,ne,this.state.runtime.menuBar.toggled,this.isZenModeActive())):this.state.runtime.mainWindowFullscreen&&(i==="toggle"||i==="classic")&&this.workbenchGrid.setViewVisible(this.titleBarPartView,rm(this.configurationService,ne,this.state.runtime.menuBar.toggled,this.isZenModeActive())),this.handleContainerDidLayout(this.mainContainer,this._mainContainerDimension)}}handleContainerDidLayout(e,i){e===this.mainContainer&&this._onDidLayoutMainContainer.fire(i),Yw(e)&&this._onDidLayoutActiveContainer.fire(i),this._onDidLayoutContainer.fire({container:e,dimension:i})}onFullscreenChanged(e){e===ne.vscodeWindowId&&(this.state.runtime.mainWindowFullscreen=ld(ne),this.state.runtime.mainWindowFullscreen?this.mainContainer.classList.add("fullscreen"):(this.mainContainer.classList.remove("fullscreen"),this.stateModel.getRuntimeValue(ve.ZEN_MODE_EXIT_INFO).transitionedToFullScreen&&this.isZenModeActive()&&this.toggleZenMode()),this.workbenchGrid.edgeSnapping=this.state.runtime.mainWindowFullscreen,np(this.configurationService)&&(this.workbenchGrid.setViewVisible(this.titleBarPartView,rm(this.configurationService,ne,this.state.runtime.menuBar.toggled,this.isZenModeActive())),this.updateWindowsBorder(!0)))}onActiveWindowChanged(){let e=this.getActiveContainerId();this.state.runtime.activeContainerId!==e&&(this.state.runtime.activeContainerId=e,this.updateWindowsBorder(),this._onDidChangeActiveContainer.fire())}onWindowFocusChanged(e){this.state.runtime.hasFocus!==e&&(this.state.runtime.hasFocus=e,this.updateWindowsBorder())}getActiveContainerId(){let e=this.activeContainer;return oe(e).vscodeWindowId}doUpdateLayoutConfiguration(e){this.updateCustomTitleBarVisibility(),this.updateMenubarVisibility(!!e),this.editorGroupService.whenRestored.then(()=>{this.centerMainEditorLayout(this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED),e)})}setSideBarPosition(e){let i=this.getPart("workbench.parts.activitybar"),n=this.getPart("workbench.parts.sidebar"),o=this.getPart("workbench.parts.auxiliarybar"),s=e===0?"left":"right",a=e===1?"left":"right",l=this.getPanelAlignment(),d=this.getPanelPosition();this.stateModel.setRuntimeValue(ve.SIDEBAR_POSITON,e);let c=Ue(i.getContainer()),u=Ue(n.getContainer()),p=Ue(o.getContainer());c.classList.remove(a),u.classList.remove(a),c.classList.add(s),u.classList.add(s),p.classList.remove(s),p.classList.add(a),i.updateStyles(),n.updateStyles(),o.updateStyles(),this.adjustPartPositions(e,l,d)}updateWindowsBorder(e=!1){if(wt||rt||vq(this.configurationService)||Dr(this.configurationService))return;let i=this.themeService.getColorTheme(),n=i.getColor(gj),o=i.getColor(fj),s=this.hasMainWindowBorder();for(let a of this.containers){let l=a===this.mainContainer,d=this.activeContainer===a,c=oa(oe(a)),u=!1;if(!this.state.runtime.mainWindowFullscreen&&!this.state.runtime.maximized.has(c)&&(n||o)){u=!0;let p=d&&this.state.runtime.hasFocus?n:o??n;a.style.setProperty("--window-border-color",p?.toString()??"transparent")}l&&(this.state.runtime.mainWindowBorder=u),a.classList.toggle("border",u)}!e&&s!==this.hasMainWindowBorder()&&this.layout()}initLayoutState(e,i){this.stateModel=new u9(this.storageService,this.configurationService,this.contextService,this.parent),this.stateModel.load(),this.stateModel.getRuntimeValue(ve.PANEL_HIDDEN)&&this.stateModel.getRuntimeValue(ve.EDITOR_HIDDEN)&&this.stateModel.setRuntimeValue(ve.EDITOR_HIDDEN,!1),this._register(this.stateModel.onDidChangeState(c=>{c.key===ve.ACTIVITYBAR_HIDDEN&&this.setActivityBarHidden(c.value),c.key===ve.STATUSBAR_HIDDEN&&this.setStatusBarHidden(c.value),c.key===ve.SIDEBAR_POSITON&&this.setSideBarPosition(c.value),c.key===ve.PANEL_POSITION&&this.setPanelPosition(c.value),c.key===ve.PANEL_ALIGNMENT&&this.setPanelAlignment(c.value),this.doUpdateLayoutConfiguration()}));let n=this.getInitialEditorsState();n&&this.logService.trace("Initial editor state",n);let o={layout:{editors:n?.layout},editor:{restoreEditors:this.shouldRestoreEditors(this.contextService,n),editorsToOpen:this.resolveEditorsToOpen(i,n)},views:{defaults:this.getDefaultLayoutViews(this.environmentService,this.storageService),containerToRestore:{}}},s={activeContainerId:this.getActiveContainerId(),mainWindowFullscreen:ld(ne),hasFocus:this.hostService.hasFocus,maximized:new Set,mainWindowBorder:!1,menuBar:{toggled:!1},zenMode:{transitionDisposables:new Bo}};this.state={initialization:o,runtime:s};let a=e.startupKind===1,l=this.configurationService.getValue("workbench.activityBar.location")!=="default";if(this.isVisible("workbench.parts.sidebar")){let c;!this.environmentService.isBuilt||e.startupKind===3||this.environmentService.isExtensionDevelopment&&!this.environmentService.extensionTestsLocationURI?c=this.storageService.get($p.activeViewletSettingsKey,1,this.viewDescriptorService.getDefaultViewContainer(0)?.id):c=this.viewDescriptorService.getDefaultViewContainer(0)?.id,c?this.state.initialization.views.containerToRestore.sideBar=c:this.stateModel.setRuntimeValue(ve.SIDEBAR_HIDDEN,!0)}else if(a&&l){let c=this.storageService.get($p.activeViewletSettingsKey,1,this.viewDescriptorService.getDefaultViewContainer(0)?.id);c&&(this.state.initialization.views.containerToRestore.sideBar=c,this.stateModel.setRuntimeValue(ve.SIDEBAR_HIDDEN,!1))}if(this.isVisible("workbench.parts.panel")){let c=this.storageService.get(Wm.activePanelSettingsKey,1,this.viewDescriptorService.getDefaultViewContainer(1)?.id);c?this.state.initialization.views.containerToRestore.panel=c:this.stateModel.setRuntimeValue(ve.PANEL_HIDDEN,!0)}let d=this.isVisible("workbench.parts.auxiliarybar");if(d||a&&l){let c=this.storageService.get(rc.activePanelSettingsKey,1,this.viewDescriptorService.getDefaultViewContainer(2)?.id);c&&(this.state.initialization.views.containerToRestore.auxiliaryBar=c),d!==!!c&&this.stateModel.setRuntimeValue(ve.AUXILIARYBAR_HIDDEN,!d)}this.updateWindowsBorder(!0)}getDefaultLayoutViews(e,i){let n=e.options?.defaultLayout;if(!n||!n.force&&!i.isNew(1))return;let{views:o}=n;if(o?.length)return o.map(s=>s.id)}shouldRestoreEditors(e,i){return Yu(e.getWorkspace())?!1:!!(this.configurationService.getValue("window.restoreWindows")==="preserve")||i===void 0}willRestoreEditors(){return this.state.initialization.editor.restoreEditors}async resolveEditorsToOpen(e,i){if(i){let n=Ei(await Ay(i.filesToMerge,e,this.logService));if(n.length===4&&ha(n[0])&&ha(n[1])&&ha(n[2])&&ha(n[3]))return[{editor:{input1:{resource:n[0].resource},input2:{resource:n[1].resource},base:{resource:n[2].resource},result:{resource:n[3].resource},options:{pinned:!0}}}];let o=Ei(await Ay(i.filesToDiff,e,this.logService));if(o.length===2)return[{editor:{original:{resource:o[0].resource},modified:{resource:o[1].resource},options:{pinned:!0}}}];let s=[],a=await Ay(i.filesToOpenOrCreate,e,this.logService);for(let l=0;l<a.length;l++){let d=a[l];d&&s.push({editor:d,viewColumn:i.filesToOpenOrCreate?.[l].viewColumn})}return s}else if(this.contextService.getWorkbenchState()===1&&this.configurationService.getValue("workbench.startupEditor")==="newUntitledFile")return this.editorGroupService.hasRestorableState?[]:await this.workingCopyBackupService.hasBackups()?[]:[{editor:{resource:void 0}}];return[]}_openedDefaultEditors=!1;get openedDefaultEditors(){return this._openedDefaultEditors}getInitialEditorsState(){let e=this.environmentService.options?.defaultLayout;if((e?.editors?.length||e?.layout?.editors)&&(e.force||this.storageService.isNew(1)))return this._openedDefaultEditors=!0,{layout:e.layout?.editors,filesToOpenOrCreate:e?.editors?.map(s=>({viewColumn:s.viewColumn,fileUri:q.revive(s.uri),openOnlyIfExists:s.openOnlyIfExists,options:s.options}))};let{filesToOpenOrCreate:i,filesToDiff:n,filesToMerge:o}=this.environmentService;if(i||n||o)return{filesToOpenOrCreate:i,filesToDiff:n,filesToMerge:o}}whenReadyPromise=new xr;whenReady=this.whenReadyPromise.p;whenRestoredPromise=new xr;whenRestored=this.whenRestoredPromise.p;restored=!1;isRestored(){return this.restored}restoreParts(){let e=[],i=[];e.push((async()=>{Dt("code/willRestoreEditors"),await this.editorGroupService.whenReady,Dt("code/restoreEditors/editorGroupsReady"),this.state.initialization.layout?.editors&&this.editorGroupService.mainPart.applyLayout(this.state.initialization.layout.editors);let a=await this.state.initialization.editor.editorsToOpen;Dt("code/restoreEditors/editorsToOpenResolved");let l;if(a.length){let d=this.editorGroupService.mainPart.getGroups(2),c=new Map;for(let u of a){let p=d[(u.viewColumn??1)-1],m=c.get(p.id);m||(m=new Set,c.set(p.id,m)),m.add(u.editor)}l=Promise.all(Array.from(c).map(async([u,p])=>{try{await this.editorService.openEditors(Array.from(p),u,{validateTrust:!0})}catch(m){this.logService.error(m)}}))}i.push(Promise.all([l?.finally(()=>Dt("code/restoreEditors/editorsOpened")),this.editorGroupService.whenRestored.finally(()=>Dt("code/restoreEditors/editorGroupsRestored"))]).finally(()=>{Dt("code/didRestoreEditors")}))})());let n=(async()=>{if(this.state.initialization.views.defaults?.length){Dt("code/willOpenDefaultViews");let a=[],l=u=>{let p=this.viewDescriptorService.getViewLocationById(u.id);if(p!==null){let m=this.viewDescriptorService.getViewContainerByViewId(u.id);if(m){u.order>=(a?.[p]?.order??0)&&(a[p]={id:m.id,order:u.order});let g=this.viewDescriptorService.getViewContainerModel(m);return g.setCollapsed(u.id,!1),g.setVisible(u.id,!0),!0}}return!1},d=[...this.state.initialization.views.defaults].reverse().map((u,p)=>({id:u,order:p})),c=d.length;for(;c;)c--,l(d[c])&&d.splice(c,1);if(d.length){await this.extensionService.whenInstalledExtensionsRegistered();let u=d.length;for(;u;)u--,l(d[u])&&d.splice(u,1)}a[0]&&(this.state.initialization.views.containerToRestore.sideBar=a[0].id),a[1]&&(this.state.initialization.views.containerToRestore.panel=a[1].id),a[2]&&(this.state.initialization.views.containerToRestore.auxiliaryBar=a[2].id),Dt("code/didOpenDefaultViews")}})();e.push(n),e.push((async()=>{if(await n,!this.state.initialization.views.containerToRestore.sideBar)return;Dt("code/willRestoreViewlet"),await this.paneCompositeService.openPaneComposite(this.state.initialization.views.containerToRestore.sideBar,0)||await this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(0)?.id,0),Dt("code/didRestoreViewlet")})()),e.push((async()=>{if(await n,!this.state.initialization.views.containerToRestore.panel)return;Dt("code/willRestorePanel"),await this.paneCompositeService.openPaneComposite(this.state.initialization.views.containerToRestore.panel,1)||await this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(1)?.id,1),Dt("code/didRestorePanel")})()),e.push((async()=>{if(await n,!this.state.initialization.views.containerToRestore.auxiliaryBar)return;Dt("code/willRestoreAuxiliaryBar"),await this.paneCompositeService.openPaneComposite(this.state.initialization.views.containerToRestore.auxiliaryBar,2)||await this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(2)?.id,2),Dt("code/didRestoreAuxiliaryBar")})());let o=this.isZenModeActive(),s=yte(this.configurationService).restore;o&&(this.setZenModeActive(!s),this.toggleZenMode(!1,!0)),this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED)&&this.centerMainEditorLayout(!0,!0),Vi.settled(e).finally(()=>{this.whenReadyPromise.complete(),Vi.settled(i).finally(()=>{this.restored=!0,this.whenRestoredPromise.complete()})})}registerPart(e){let i=e.getId();return this.parts.set(i,e),te(()=>this.parts.delete(i))}getPart(e){let i=this.parts.get(e);if(!i)throw new Error(`Unknown part ${e}`);return i}registerNotifications(e){this._register(e.onDidChangeNotificationsVisibility(i=>this._onDidChangeNotificationsVisibility.fire(i)))}hasFocus(e){let i=this.getContainer(uo(),e);if(!i)return!1;let n=An();return n?jj(n,i):!1}focusPart(e,i=ne){let n=this.getContainer(i,e)??this.mainContainer;switch(e){case"workbench.parts.editor":this.editorGroupService.getPart(n).activeGroup.focus();break;case"workbench.parts.panel":{this.paneCompositeService.getActivePaneComposite(1)?.focus();break}case"workbench.parts.sidebar":{this.paneCompositeService.getActivePaneComposite(0)?.focus();break}case"workbench.parts.auxiliarybar":{this.paneCompositeService.getActivePaneComposite(2)?.focus();break}case"workbench.parts.activitybar":this.getPart("workbench.parts.sidebar").focusActivityBar();break;case"workbench.parts.statusbar":this.statusBarService.getPart(n).focus();break;default:n?.focus()}}getContainer(e,i){if(typeof i>"u")return this.getContainerFromDocument(e.document);if(e===ne)return this.getPart(i).getContainer();let n;if(i==="workbench.parts.editor"?n=this.editorGroupService.getPart(this.getContainerFromDocument(e.document)):i==="workbench.parts.statusbar"?n=this.statusBarService.getPart(this.getContainerFromDocument(e.document)):i==="workbench.parts.titlebar"&&(n=this.titleService.getPart(this.getContainerFromDocument(e.document))),n instanceof xl)return n.getContainer()}isVisible(e,i=ne){if(i!==ne&&e==="workbench.parts.editor")return!0;if(this.initialized)switch(e){case"workbench.parts.titlebar":return this.workbenchGrid.isViewVisible(this.titleBarPartView);case"workbench.parts.sidebar":return!this.stateModel.getRuntimeValue(ve.SIDEBAR_HIDDEN);case"workbench.parts.panel":return!this.stateModel.getRuntimeValue(ve.PANEL_HIDDEN);case"workbench.parts.auxiliarybar":return!this.stateModel.getRuntimeValue(ve.AUXILIARYBAR_HIDDEN);case"workbench.parts.statusbar":return!this.stateModel.getRuntimeValue(ve.STATUSBAR_HIDDEN);case"workbench.parts.activitybar":return!this.stateModel.getRuntimeValue(ve.ACTIVITYBAR_HIDDEN);case"workbench.parts.editor":return!this.stateModel.getRuntimeValue(ve.EDITOR_HIDDEN);case"workbench.parts.banner":return this.workbenchGrid.isViewVisible(this.bannerPartView);default:return!1}switch(e){case"workbench.parts.titlebar":return rm(this.configurationService,ne,this.state.runtime.menuBar.toggled,this.isZenModeActive());case"workbench.parts.sidebar":return!this.stateModel.getRuntimeValue(ve.SIDEBAR_HIDDEN);case"workbench.parts.panel":return!this.stateModel.getRuntimeValue(ve.PANEL_HIDDEN);case"workbench.parts.auxiliarybar":return!this.stateModel.getRuntimeValue(ve.AUXILIARYBAR_HIDDEN);case"workbench.parts.statusbar":return!this.stateModel.getRuntimeValue(ve.STATUSBAR_HIDDEN);case"workbench.parts.activitybar":return!this.stateModel.getRuntimeValue(ve.ACTIVITYBAR_HIDDEN);case"workbench.parts.editor":return!this.stateModel.getRuntimeValue(ve.EDITOR_HIDDEN);default:return!1}}shouldShowBannerFirst(){return wt&&!Vg()}focus(){this.focusPart("workbench.parts.editor",oe(this.activeContainer))}focusPanelOrEditor(){let e=this.paneCompositeService.getActivePaneComposite(1);(this.hasFocus("workbench.parts.panel")||!this.isVisible("workbench.parts.editor"))&&e?e.focus():this.focus()}getMaximumEditorDimensions(e){let i=oe(e),n=this.getContainerDimension(e);if(e===this.mainContainer){let o=ho(this.getPanelPosition()),s=(this.isVisible("workbench.parts.activitybar")?this.activityBarPartView.minimumWidth:0)+(this.isVisible("workbench.parts.sidebar")?this.sideBarPartView.minimumWidth:0)+(this.isVisible("workbench.parts.panel")&&!o?this.panelPartView.minimumWidth:0)+(this.isVisible("workbench.parts.auxiliarybar")?this.auxiliaryBarPartView.minimumWidth:0),a=(this.isVisible("workbench.parts.titlebar",i)?this.titleBarPartView.minimumHeight:0)+(this.isVisible("workbench.parts.statusbar",i)?this.statusBarPartView.minimumHeight:0)+(this.isVisible("workbench.parts.panel")&&o?this.panelPartView.minimumHeight:0),l=n.width-s,d=n.height-a;return{width:l,height:d}}else{let o=(this.isVisible("workbench.parts.titlebar",i)?this.titleBarPartView.minimumHeight:0)+(this.isVisible("workbench.parts.statusbar",i)?this.statusBarPartView.minimumHeight:0);return{width:n.width,height:n.height-o}}}isZenModeActive(){return this.stateModel.getRuntimeValue(ve.ZEN_MODE_ACTIVE)}setZenModeActive(e){this.stateModel.setRuntimeValue(ve.ZEN_MODE_ACTIVE,e)}toggleZenMode(e,i=!1){this.setZenModeActive(!this.isZenModeActive()),this.state.runtime.zenMode.transitionDisposables.clearAndDisposeAll();let n=l=>{for(let d of this.mainPartEditorService.visibleTextEditorControls){if(!l&&XT(d)&&d.hasModel()){let c=d.getModel();l=this.configurationService.getValue("editor.lineNumbers",{resource:c.uri,overrideIdentifier:c.getLanguageId()})}l||(l=this.configurationService.getValue("editor.lineNumbers")),d.updateOptions({lineNumbers:l})}},o=!1,s=yte(this.configurationService),a=this.stateModel.getRuntimeValue(ve.ZEN_MODE_EXIT_INFO);this.isZenModeActive()?(o=!this.state.runtime.mainWindowFullscreen&&s.fullScreen&&!Xo,i||(a.transitionedToFullScreen=o,a.transitionedToCenteredEditorLayout=!this.isMainEditorLayoutCentered()&&s.centerLayout,a.handleNotificationsDoNotDisturbMode=this.notificationService.getFilter()===0,a.wasVisible.sideBar=this.isVisible("workbench.parts.sidebar"),a.wasVisible.panel=this.isVisible("workbench.parts.panel"),a.wasVisible.auxiliaryBar=this.isVisible("workbench.parts.auxiliarybar"),this.stateModel.setRuntimeValue(ve.ZEN_MODE_EXIT_INFO,a)),this.setPanelHidden(!0,!0),this.setAuxiliaryBarHidden(!0,!0),this.setSideBarHidden(!0,!0),s.hideActivityBar&&this.setActivityBarHidden(!0,!0),s.hideStatusBar&&this.setStatusBarHidden(!0,!0),s.hideLineNumbers&&(n("off"),this.state.runtime.zenMode.transitionDisposables.set("zenMode.hideLineNumbers",this.mainPartEditorService.onDidVisibleEditorsChange(()=>n("off")))),s.showTabs!==this.editorGroupService.partOptions.showTabs&&this.state.runtime.zenMode.transitionDisposables.set("zenMode.showTabs",this.editorGroupService.mainPart.enforcePartOptions({showTabs:s.showTabs})),s.silentNotifications&&a.handleNotificationsDoNotDisturbMode&&this.notificationService.setFilter(1),s.centerLayout&&this.centerMainEditorLayout(!0,!0),this.state.runtime.zenMode.transitionDisposables.set("configurationChange",this.configurationService.onDidChangeConfiguration(l=>{if(l.affectsConfiguration("zenMode.hideActivityBar")){let d=this.configurationService.getValue("zenMode.hideActivityBar");this.setActivityBarHidden(d,!0)}if(l.affectsConfiguration("zenMode.hideStatusBar")){let d=this.configurationService.getValue("zenMode.hideStatusBar");this.setStatusBarHidden(d,!0)}if(l.affectsConfiguration("zenMode.centerLayout")){let d=this.configurationService.getValue("zenMode.centerLayout");this.centerMainEditorLayout(d,!0)}if(l.affectsConfiguration("zenMode.showTabs")){let d=this.configurationService.getValue("zenMode.showTabs")??"multiple";this.state.runtime.zenMode.transitionDisposables.set("zenMode.showTabs",this.editorGroupService.mainPart.enforcePartOptions({showTabs:d}))}if(l.affectsConfiguration("zenMode.silentNotifications")){let d=!!this.configurationService.getValue("zenMode.silentNotifications");a.handleNotificationsDoNotDisturbMode&&this.notificationService.setFilter(d?1:0)}if(l.affectsConfiguration("zenMode.hideLineNumbers")){let d=this.configurationService.getValue("zenMode.hideLineNumbers")?"off":void 0;n(d),this.state.runtime.zenMode.transitionDisposables.set("zenMode.hideLineNumbers",this.mainPartEditorService.onDidVisibleEditorsChange(()=>n(d)))}}))):(a.wasVisible.panel&&this.setPanelHidden(!1,!0),a.wasVisible.auxiliaryBar&&this.setAuxiliaryBarHidden(!1,!0),a.wasVisible.sideBar&&this.setSideBarHidden(!1,!0),this.stateModel.getRuntimeValue(ve.ACTIVITYBAR_HIDDEN,!0)||this.setActivityBarHidden(!1,!0),this.stateModel.getRuntimeValue(ve.STATUSBAR_HIDDEN,!0)||this.setStatusBarHidden(!1,!0),a.transitionedToCenteredEditorLayout&&this.centerMainEditorLayout(!1,!0),a.handleNotificationsDoNotDisturbMode&&this.notificationService.setFilter(0),n(),this.focus(),o=a.transitionedToFullScreen&&this.state.runtime.mainWindowFullscreen),e||this.layout(),o&&this.hostService.toggleFullScreen(ne),this._onDidChangeZenMode.fire(this.isZenModeActive())}setStatusBarHidden(e,i){this.stateModel.setRuntimeValue(ve.STATUSBAR_HIDDEN,e),e?this.mainContainer.classList.add("nostatusbar"):this.mainContainer.classList.remove("nostatusbar"),this.workbenchGrid.setViewVisible(this.statusBarPartView,!e)}createWorkbenchLayout(){let e=this.getPart("workbench.parts.titlebar"),i=this.getPart("workbench.parts.banner"),n=this.getPart("workbench.parts.editor"),o=this.getPart("workbench.parts.activitybar"),s=this.getPart("workbench.parts.panel"),a=this.getPart("workbench.parts.auxiliarybar"),l=this.getPart("workbench.parts.sidebar"),d=this.getPart("workbench.parts.statusbar");this.titleBarPartView=e,this.bannerPartView=i,this.sideBarPartView=l,this.activityBarPartView=o,this.editorPartView=n,this.panelPartView=s,this.auxiliaryBarPartView=a,this.statusBarPartView=d;let c={"workbench.parts.activitybar":this.activityBarPartView,"workbench.parts.banner":this.bannerPartView,"workbench.parts.titlebar":this.titleBarPartView,"workbench.parts.editor":this.editorPartView,"workbench.parts.panel":this.panelPartView,"workbench.parts.sidebar":this.sideBarPartView,"workbench.parts.statusbar":this.statusBarPartView,"workbench.parts.auxiliarybar":this.auxiliaryBarPartView},u=({type:m})=>c[m],p=mA.deserialize(this.createGridDescriptor(),{fromJSON:u},{proportionalLayout:!1});this.mainContainer.prepend(p.element),this.mainContainer.setAttribute("role","application"),this.workbenchGrid=p,this.workbenchGrid.edgeSnapping=this.state.runtime.mainWindowFullscreen;for(let m of[e,n,o,s,l,d,a,i])this._register(m.onDidVisibilityChange(g=>{m===l?this.setSideBarHidden(!g,!0):m===s?this.setPanelHidden(!g,!0):m===a?this.setAuxiliaryBarHidden(!g,!0):m===n&&this.setEditorHidden(!g,!0),this._onDidChangePartVisibility.fire(),this.handleContainerDidLayout(this.mainContainer,this._mainContainerDimension)}));this._register(this.storageService.onWillSaveState(m=>{let g=this.stateModel.getRuntimeValue(ve.SIDEBAR_HIDDEN)?this.workbenchGrid.getViewCachedVisibleSize(this.sideBarPartView):this.workbenchGrid.getViewSize(this.sideBarPartView).width;this.stateModel.setInitializationValue(ve.SIDEBAR_SIZE,g);let f=this.stateModel.getRuntimeValue(ve.PANEL_HIDDEN)?this.workbenchGrid.getViewCachedVisibleSize(this.panelPartView):ho(this.stateModel.getRuntimeValue(ve.PANEL_POSITION))?this.workbenchGrid.getViewSize(this.panelPartView).height:this.workbenchGrid.getViewSize(this.panelPartView).width;this.stateModel.setInitializationValue(ve.PANEL_SIZE,f);let b=this.stateModel.getRuntimeValue(ve.AUXILIARYBAR_HIDDEN)?this.workbenchGrid.getViewCachedVisibleSize(this.auxiliaryBarPartView):this.workbenchGrid.getViewSize(this.auxiliaryBarPartView).width;this.stateModel.setInitializationValue(ve.AUXILIARYBAR_SIZE,b),this.stateModel.save(!0,!0)}))}layout(){this.disposed||(this._mainContainerDimension=gd(this.state.runtime.mainWindowFullscreen?ne.document.body:this.parent),this.logService.trace(`Layout#layout, height: ${this._mainContainerDimension.height}, width: ${this._mainContainerDimension.width}`),tk(this.mainContainer,0,0,0,0,"relative"),ek(this.mainContainer,this._mainContainerDimension.width,this._mainContainerDimension.height),this.workbenchGrid.layout(this._mainContainerDimension.width,this._mainContainerDimension.height),this.initialized=!0,this.handleContainerDidLayout(this.mainContainer,this._mainContainerDimension))}isMainEditorLayoutCentered(){return this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED)}centerMainEditorLayout(e,i){this.stateModel.setRuntimeValue(ve.MAIN_EDITOR_CENTERED,e);let n=this.mainPartEditorService.activeEditor,o=!1;n instanceof Yr?o=this.configurationService.getValue("diffEditor.renderSideBySide"):n?.hasCapability(256)&&(o=!0),this.configurationService.getValue("workbench.editor.centeredLayoutAutoResize")&&(this.editorGroupService.mainPart.groups.length>1&&!this.editorGroupService.mainPart.hasMaximizedGroup()||o)&&(e=!1),this.editorGroupService.mainPart.isLayoutCentered()!==e&&(this.editorGroupService.mainPart.centerLayout(e),i||this.layout()),this._onDidChangeMainEditorCenteredLayout.fire(this.stateModel.getRuntimeValue(ve.MAIN_EDITOR_CENTERED))}resizePart(e,i,n){let o=Math.sign(i)*Kv(uo(),Math.abs(i)),s=Math.sign(n)*Kv(uo(),Math.abs(n)),a;switch(e){case"workbench.parts.sidebar":a=this.workbenchGrid.getViewSize(this.sideBarPartView),this.workbenchGrid.resizeView(this.sideBarPartView,{width:a.width+o,height:a.height});break;case"workbench.parts.panel":a=this.workbenchGrid.getViewSize(this.panelPartView),this.workbenchGrid.resizeView(this.panelPartView,{width:a.width+(ho(this.getPanelPosition())?0:o),height:a.height+(ho(this.getPanelPosition())?s:0)});break;case"workbench.parts.auxiliarybar":a=this.workbenchGrid.getViewSize(this.auxiliaryBarPartView),this.workbenchGrid.resizeView(this.auxiliaryBarPartView,{width:a.width+o,height:a.height});break;case"workbench.parts.editor":if(a=this.workbenchGrid.getViewSize(this.editorPartView),this.editorGroupService.mainPart.count===1)this.workbenchGrid.resizeView(this.editorPartView,{width:a.width+o,height:a.height+s});else{let l=this.editorGroupService.mainPart.activeGroup,{width:d,height:c}=this.editorGroupService.mainPart.getSize(l);this.editorGroupService.mainPart.setSize(l,{width:d+o,height:c+s});let{width:u,height:p}=this.editorGroupService.mainPart.getSize(l);(s&&c===p||o&&d===u)&&this.workbenchGrid.resizeView(this.editorPartView,{width:a.width+(o&&d===u?o:0),height:a.height+(s&&c===p?s:0)})}break;default:return}}setActivityBarHidden(e,i){this.stateModel.setRuntimeValue(ve.ACTIVITYBAR_HIDDEN,e),this.workbenchGrid.setViewVisible(this.activityBarPartView,!e)}setBannerHidden(e){this.workbenchGrid.setViewVisible(this.bannerPartView,!e)}setEditorHidden(e,i){this.stateModel.setRuntimeValue(ve.EDITOR_HIDDEN,e),e?this.mainContainer.classList.add("nomaineditorarea"):this.mainContainer.classList.remove("nomaineditorarea"),this.workbenchGrid.setViewVisible(this.editorPartView,!e),e&&!this.isVisible("workbench.parts.panel")&&this.setPanelHidden(!1,!0)}getLayoutClasses(){return Ei([this.isVisible("workbench.parts.sidebar")?void 0:"nosidebar",this.isVisible("workbench.parts.editor",ne)?void 0:"nomaineditorarea",this.isVisible("workbench.parts.panel")?void 0:"nopanel",this.isVisible("workbench.parts.auxiliarybar")?void 0:"noauxiliarybar",this.isVisible("workbench.parts.statusbar")?void 0:"nostatusbar",this.state.runtime.mainWindowFullscreen?"fullscreen":void 0])}setSideBarHidden(e,i){if(this.stateModel.setRuntimeValue(ve.SIDEBAR_HIDDEN,e),e?this.mainContainer.classList.add("nosidebar"):this.mainContainer.classList.remove("nosidebar"),e&&this.paneCompositeService.getActivePaneComposite(0))this.paneCompositeService.hideActivePaneComposite(0),this.focusPanelOrEditor();else if(!e&&!this.paneCompositeService.getActivePaneComposite(0)){let n=this.paneCompositeService.getLastActivePaneCompositeId(0);n&&(this.paneCompositeService.openPaneComposite(n,0,!0)||this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(0)?.id,0,!0))}this.workbenchGrid.setViewVisible(this.sideBarPartView,!e)}hasViews(e){let i=this.viewDescriptorService.getViewContainerById(e);if(!i)return!1;let n=this.viewDescriptorService.getViewContainerModel(i);return n?n.activeViewDescriptors.length>=1:!1}adjustPartPositions(e,i,n){let o=!ho(n),s=o||!(i==="center"||e===0&&i==="right"||e===1&&i==="left"),a=o||!(i==="center"||e===1&&i==="right"||e===0&&i==="left"),l=this.isVisible("workbench.parts.panel")?this.workbenchGrid.getViewSize(this.panelPartView).width:om.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.panelPartView)??this.panelPartView.minimumWidth),d=this.isVisible("workbench.parts.panel")?this.workbenchGrid.getViewSize(this.panelPartView).height:om.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.panelPartView)??this.panelPartView.minimumHeight),c=this.isVisible("workbench.parts.sidebar")?this.workbenchGrid.getViewSize(this.sideBarPartView).width:om.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.sideBarPartView)??this.sideBarPartView.minimumWidth),u=this.isVisible("workbench.parts.auxiliarybar")?this.workbenchGrid.getViewSize(this.auxiliaryBarPartView).width:om.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.auxiliaryBarPartView)??this.auxiliaryBarPartView.minimumWidth);e===0?(this.workbenchGrid.moveViewTo(this.activityBarPartView,[2,0]),this.workbenchGrid.moveView(this.sideBarPartView,c,s?this.editorPartView:this.activityBarPartView,s?2:3),a?this.workbenchGrid.moveView(this.auxiliaryBarPartView,u,this.editorPartView,3):this.workbenchGrid.moveViewTo(this.auxiliaryBarPartView,[2,-1])):(this.workbenchGrid.moveViewTo(this.activityBarPartView,[2,-1]),this.workbenchGrid.moveView(this.sideBarPartView,c,s?this.editorPartView:this.activityBarPartView,s?3:2),a?this.workbenchGrid.moveView(this.auxiliaryBarPartView,u,this.editorPartView,2):this.workbenchGrid.moveViewTo(this.auxiliaryBarPartView,[2,0])),o&&(this.workbenchGrid.moveView(this.panelPartView,l,this.editorPartView,n===0?2:3),this.workbenchGrid.resizeView(this.panelPartView,{height:d,width:l})),this.isVisible("workbench.parts.sidebar")&&this.workbenchGrid.resizeView(this.sideBarPartView,{height:this.workbenchGrid.getViewSize(this.sideBarPartView).height,width:c}),this.isVisible("workbench.parts.auxiliarybar")&&this.workbenchGrid.resizeView(this.auxiliaryBarPartView,{height:this.workbenchGrid.getViewSize(this.auxiliaryBarPartView).height,width:u})}setPanelAlignment(e,i){ho(this.getPanelPosition())||this.setPanelPosition(2),e!=="center"&&this.isPanelMaximized()&&this.toggleMaximizedPanel(),this.stateModel.setRuntimeValue(ve.PANEL_ALIGNMENT,e),this.adjustPartPositions(this.getSideBarPosition(),e,this.getPanelPosition()),this._onDidChangePanelAlignment.fire(e)}setPanelHidden(e,i){if(!this.workbenchGrid)return;let n=!this.isVisible("workbench.parts.panel");this.stateModel.setRuntimeValue(ve.PANEL_HIDDEN,e);let o=this.isPanelMaximized(),s=this.panelOpensMaximized();e?this.mainContainer.classList.add("nopanel"):this.mainContainer.classList.remove("nopanel");let a=!1;if(e&&this.paneCompositeService.getActivePaneComposite(1))this.paneCompositeService.hideActivePaneComposite(1),a=!Xo;else if(!e&&!this.paneCompositeService.getActivePaneComposite(1)){let l=this.paneCompositeService.getLastActivePaneCompositeId(1);if((!l||!this.hasViews(l))&&(l=this.viewDescriptorService.getViewContainersByLocation(1).find(d=>this.hasViews(d.id))?.id),l){let d=!i;this.paneCompositeService.openPaneComposite(l,1,d)}}e&&o&&this.toggleMaximizedPanel(),n!==e&&(this.workbenchGrid.setViewVisible(this.panelPartView,!e),e?this.stateModel.setRuntimeValue(ve.PANEL_WAS_LAST_MAXIMIZED,o):!i&&o!==s&&this.toggleMaximizedPanel(),a&&this.editorGroupService.mainPart.activeGroup.focus())}toggleMaximizedPanel(){let e=this.workbenchGrid.getViewSize(this.panelPartView),i=this.getPanelPosition(),n=this.isPanelMaximized();n?(this.setEditorHidden(!1),this.workbenchGrid.resizeView(this.panelPartView,{width:ho(i)?e.width:this.stateModel.getRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_WIDTH),height:ho(i)?this.stateModel.getRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_HEIGHT):e.height})):(this.isVisible("workbench.parts.panel")&&(ho(i)?this.stateModel.setRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_HEIGHT,e.height):this.stateModel.setRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_WIDTH,e.width)),this.setEditorHidden(!0)),this.stateModel.setRuntimeValue(ve.PANEL_WAS_LAST_MAXIMIZED,!n)}panelOpensMaximized(){if(this.getPanelAlignment()!=="center"&&ho(this.getPanelPosition()))return!1;let e=JZ(this.configurationService.getValue("workbench.panel.opensMaximized")),i=this.stateModel.getRuntimeValue(ve.PANEL_WAS_LAST_MAXIMIZED);return e===0||e===2&&i}setAuxiliaryBarHidden(e,i){if(this.stateModel.setRuntimeValue(ve.AUXILIARYBAR_HIDDEN,e),e?this.mainContainer.classList.add("noauxiliarybar"):this.mainContainer.classList.remove("noauxiliarybar"),e&&this.paneCompositeService.getActivePaneComposite(2))this.paneCompositeService.hideActivePaneComposite(2),this.focusPanelOrEditor();else if(!e&&!this.paneCompositeService.getActivePaneComposite(2)){let n=this.paneCompositeService.getLastActivePaneCompositeId(2);if((!n||!this.hasViews(n))&&(n=this.viewDescriptorService.getViewContainersByLocation(2).find(o=>this.hasViews(o.id))?.id),n){let o=!i;this.paneCompositeService.openPaneComposite(n,2,o)}}this.workbenchGrid.setViewVisible(this.auxiliaryBarPartView,!e)}setPartHidden(e,i,n=ne){switch(i){case"workbench.parts.activitybar":return this.setActivityBarHidden(e);case"workbench.parts.sidebar":return this.setSideBarHidden(e);case"workbench.parts.editor":return this.setEditorHidden(e);case"workbench.parts.banner":return this.setBannerHidden(e);case"workbench.parts.auxiliarybar":return this.setAuxiliaryBarHidden(e);case"workbench.parts.panel":return this.setPanelHidden(e)}}hasMainWindowBorder(){return this.state.runtime.mainWindowBorder}getMainWindowBorderRadius(){return this.state.runtime.mainWindowBorder&&be?"5px":void 0}isPanelMaximized(){return(this.getPanelAlignment()==="center"||!ho(this.getPanelPosition()))&&!this.isVisible("workbench.parts.editor",ne)}getSideBarPosition(){return this.stateModel.getRuntimeValue(ve.SIDEBAR_POSITON)}getPanelAlignment(){return this.stateModel.getRuntimeValue(ve.PANEL_ALIGNMENT)}updateMenubarVisibility(e){let i=rm(this.configurationService,ne,this.state.runtime.menuBar.toggled,this.isZenModeActive());!e&&this.workbenchGrid&&i!==this.isVisible("workbench.parts.titlebar",ne)&&this.workbenchGrid.setViewVisible(this.titleBarPartView,i)}updateCustomTitleBarVisibility(){let e=rm(this.configurationService,ne,this.state.runtime.menuBar.toggled,this.isZenModeActive()),i=this.isVisible("workbench.parts.titlebar");e!==i&&this.workbenchGrid.setViewVisible(this.titleBarPartView,e)}toggleMenuBar(){let e=na(this.configurationService);typeof e!="string"&&(e="classic");let i;e==="visible"||e==="classic"?i=Dr(this.configurationService)?"toggle":"compact":i="classic",this.configurationService.updateValue("window.menuBarVisibility",i)}getPanelPosition(){return this.stateModel.getRuntimeValue(ve.PANEL_POSITION)}setPanelPosition(e){this.isVisible("workbench.parts.panel")||this.setPanelHidden(!1);let i=this.getPart("workbench.parts.panel"),n=Mr(this.getPanelPosition()),o=Mr(e),s=Ue(i.getContainer());s.classList.remove(n),s.classList.add(o),i.updateStyles();let a=this.workbenchGrid.getViewSize(this.panelPartView),l=this.workbenchGrid.getViewSize(this.sideBarPartView),d=this.workbenchGrid.getViewSize(this.auxiliaryBarPartView),c=!this.isVisible("workbench.parts.editor",ne);o!==n&&!c&&(ho(e)?this.stateModel.setRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_WIDTH,a.width):ho(mf(n))&&this.stateModel.setRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_HEIGHT,a.height)),ho(e)&&this.getPanelAlignment()!=="center"&&c&&(this.toggleMaximizedPanel(),c=!1),this.stateModel.setRuntimeValue(ve.PANEL_POSITION,e);let u=this.isVisible("workbench.parts.sidebar"),p=this.isVisible("workbench.parts.auxiliarybar");e===2?this.workbenchGrid.moveView(this.panelPartView,c?a.height:this.stateModel.getRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_HEIGHT),this.editorPartView,1):e===3?this.workbenchGrid.moveView(this.panelPartView,c?a.height:this.stateModel.getRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_HEIGHT),this.editorPartView,0):e===1?this.workbenchGrid.moveView(this.panelPartView,c?a.width:this.stateModel.getRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_WIDTH),this.editorPartView,3):this.workbenchGrid.moveView(this.panelPartView,c?a.width:this.stateModel.getRuntimeValue(ve.PANEL_LAST_NON_MAXIMIZED_WIDTH),this.editorPartView,2),this.workbenchGrid.resizeView(this.sideBarPartView,l),u||this.setSideBarHidden(!0),this.workbenchGrid.resizeView(this.auxiliaryBarPartView,d),p||this.setAuxiliaryBarHidden(!0),ho(e)&&this.adjustPartPositions(this.getSideBarPosition(),this.getPanelAlignment(),e),this._onDidChangePanelPosition.fire(o)}isWindowMaximized(e){return this.state.runtime.maximized.has(oa(e))}updateWindowMaximizedState(e,i){this.mainContainer.classList.toggle("maximized",i);let n=oa(e);i!==this.state.runtime.maximized.has(n)&&(i?this.state.runtime.maximized.add(n):this.state.runtime.maximized.delete(n),this.updateWindowsBorder(),this._onDidChangeWindowMaximized.fire({windowId:n,maximized:i}))}getVisibleNeighborPart(e,i){if(!this.workbenchGrid||!this.isVisible(e,ne))return;let n=this.workbenchGrid.getNeighborViews(this.getPart(e),i,!1);if(n)for(let o of n){let s=["workbench.parts.activitybar","workbench.parts.editor","workbench.parts.panel","workbench.parts.auxiliarybar","workbench.parts.sidebar","workbench.parts.statusbar","workbench.parts.titlebar"].find(a=>this.getPart(a)===o&&this.isVisible(a,ne));if(s!==void 0)return s}}onDidChangeWCO(){let e=this.workbenchGrid.getNeighborViews(this.titleBarPartView,0,!1).length>0,i=this.shouldShowBannerFirst();e!==i&&this.workbenchGrid.moveView(this.bannerPartView,om.Distribute,this.titleBarPartView,i?0:1),this.workbenchGrid.setViewVisible(this.titleBarPartView,rm(this.configurationService,ne,this.state.runtime.menuBar.toggled,this.isZenModeActive()))}arrangeEditorNodes(e,i,n){if(!e.sideBar&&!e.auxiliaryBar)return e.editor.size=i,e.editor;let o=[e.editor];return e.editor.size=n,e.sideBar&&(this.stateModel.getRuntimeValue(ve.SIDEBAR_POSITON)===0?o.splice(0,0,e.sideBar):o.push(e.sideBar),e.editor.size-=this.stateModel.getRuntimeValue(ve.SIDEBAR_HIDDEN)?0:e.sideBar.size),e.auxiliaryBar&&(this.stateModel.getRuntimeValue(ve.SIDEBAR_POSITON)===1?o.splice(0,0,e.auxiliaryBar):o.push(e.auxiliaryBar),e.editor.size-=this.stateModel.getRuntimeValue(ve.AUXILIARYBAR_HIDDEN)?0:e.auxiliaryBar.size),{type:"branch",data:o,size:i}}arrangeMiddleSectionNodes(e,i,n){let o=this.stateModel.getRuntimeValue(ve.ACTIVITYBAR_HIDDEN)?0:e.activityBar.size,s=this.stateModel.getRuntimeValue(ve.SIDEBAR_HIDDEN)?0:e.sideBar.size,a=this.stateModel.getRuntimeValue(ve.AUXILIARYBAR_HIDDEN)?0:e.auxiliaryBar.size,l=this.stateModel.getInitializationValue(ve.PANEL_SIZE)?0:e.panel.size,d=this.stateModel.getRuntimeValue(ve.PANEL_POSITION),c=this.stateModel.getRuntimeValue(ve.SIDEBAR_POSITON),u=[];if(!ho(d))u.push(e.editor),e.editor.size=i-o-s-l-a,d===1?u.push(e.panel):u.splice(0,0,e.panel),c===0?(u.push(e.auxiliaryBar),u.splice(0,0,e.sideBar),u.splice(0,0,e.activityBar)):(u.splice(0,0,e.auxiliaryBar),u.push(e.sideBar),u.push(e.activityBar));else{let p=this.stateModel.getRuntimeValue(ve.PANEL_ALIGNMENT),m=!(p==="center"||c===0&&p==="right"||c===1&&p==="left"),g=!(p==="center"||c===1&&p==="right"||c===0&&p==="left"),f=i-o-(m?0:s)-(g?0:a),b=this.arrangeEditorNodes({editor:e.editor,sideBar:m?e.sideBar:void 0,auxiliaryBar:g?e.auxiliaryBar:void 0},n-l,f);u.push({type:"branch",data:d===2?[b,e.panel]:[e.panel,b],size:f}),m||(c===0?u.splice(0,0,e.sideBar):u.push(e.sideBar)),g||(c===1?u.splice(0,0,e.auxiliaryBar):u.push(e.auxiliaryBar)),c===0?u.splice(0,0,e.activityBar):u.push(e.activityBar)}return u}createGridDescriptor(){let{width:e,height:i}=this.stateModel.getInitializationValue(ve.GRID_SIZE),n=this.stateModel.getInitializationValue(ve.SIDEBAR_SIZE),o=this.stateModel.getInitializationValue(ve.AUXILIARYBAR_SIZE),s=this.stateModel.getInitializationValue(ve.PANEL_SIZE),a=this.titleBarPartView.minimumHeight,l=this.bannerPartView.minimumHeight,d=this.statusBarPartView.minimumHeight,c=this.activityBarPartView.minimumWidth,u=i-a-d,p=[{type:"leaf",data:{type:"workbench.parts.titlebar"},size:a,visible:this.isVisible("workbench.parts.titlebar",ne)},{type:"leaf",data:{type:"workbench.parts.banner"},size:l,visible:!1}],m={type:"leaf",data:{type:"workbench.parts.activitybar"},size:c,visible:!this.stateModel.getRuntimeValue(ve.ACTIVITYBAR_HIDDEN)},g={type:"leaf",data:{type:"workbench.parts.sidebar"},size:n,visible:!this.stateModel.getRuntimeValue(ve.SIDEBAR_HIDDEN)},f={type:"leaf",data:{type:"workbench.parts.auxiliarybar"},size:o,visible:this.isVisible("workbench.parts.auxiliarybar")},b={type:"leaf",data:{type:"workbench.parts.editor"},size:0,visible:!this.stateModel.getRuntimeValue(ve.EDITOR_HIDDEN)},y={type:"leaf",data:{type:"workbench.parts.panel"},size:s,visible:!this.stateModel.getRuntimeValue(ve.PANEL_HIDDEN)},I=this.arrangeMiddleSectionNodes({activityBar:m,auxiliaryBar:f,editor:b,panel:y,sideBar:g},e,u),E={root:{type:"branch",size:e,data:[...this.shouldShowBannerFirst()?p.reverse():p,{type:"branch",data:I,size:u},{type:"leaf",data:{type:"workbench.parts.statusbar"},size:d,visible:!this.stateModel.getRuntimeValue(ve.STATUSBAR_HIDDEN)}]},orientation:0,width:e,height:i},S={activityBarVisible:!this.stateModel.getRuntimeValue(ve.ACTIVITYBAR_HIDDEN),sideBarVisible:!this.stateModel.getRuntimeValue(ve.SIDEBAR_HIDDEN),auxiliaryBarVisible:!this.stateModel.getRuntimeValue(ve.AUXILIARYBAR_HIDDEN),panelVisible:!this.stateModel.getRuntimeValue(ve.PANEL_HIDDEN),statusbarVisible:!this.stateModel.getRuntimeValue(ve.STATUSBAR_HIDDEN),sideBarPosition:Mr(this.stateModel.getRuntimeValue(ve.SIDEBAR_POSITON)),panelPosition:Mr(this.stateModel.getRuntimeValue(ve.PANEL_POSITION))};return this.telemetryService.publicLog2("startupLayout",S),E}dispose(){super.dispose(),this.disposed=!0}};function yte(r){return r.getValue("zenMode")}var FN=class{constructor(t,e,i,n){this.name=t;this.scope=e;this.target=i;this.defaultValue=n}},fr=class extends FN{constructor(e,i,n,o,s){super(e,i,n,o);this.zenModeIgnore=s}runtime=!0},iS=class extends FN{runtime=!1},ve={MAIN_EDITOR_CENTERED:new fr("editor.centered",1,1,!1),ZEN_MODE_ACTIVE:new fr("zenMode.active",1,1,!1),ZEN_MODE_EXIT_INFO:new fr("zenMode.exitInfo",1,1,{transitionedToCenteredEditorLayout:!1,transitionedToFullScreen:!1,handleNotificationsDoNotDisturbMode:!1,wasVisible:{auxiliaryBar:!1,panel:!1,sideBar:!1}}),GRID_SIZE:new iS("grid.size",0,1,{width:800,height:600}),SIDEBAR_SIZE:new iS("sideBar.size",0,1,200),AUXILIARYBAR_SIZE:new iS("auxiliaryBar.size",0,1,200),PANEL_SIZE:new iS("panel.size",0,1,300),PANEL_LAST_NON_MAXIMIZED_HEIGHT:new fr("panel.lastNonMaximizedHeight",0,1,300),PANEL_LAST_NON_MAXIMIZED_WIDTH:new fr("panel.lastNonMaximizedWidth",0,1,300),PANEL_WAS_LAST_MAXIMIZED:new fr("panel.wasLastMaximized",1,1,!1),SIDEBAR_POSITON:new fr("sideBar.position",1,1,0),PANEL_POSITION:new fr("panel.position",1,1,2),PANEL_ALIGNMENT:new fr("panel.alignment",0,0,"center"),ACTIVITYBAR_HIDDEN:new fr("activityBar.hidden",1,1,!1,!0),SIDEBAR_HIDDEN:new fr("sideBar.hidden",1,1,!1),EDITOR_HIDDEN:new fr("editor.hidden",1,1,!1),PANEL_HIDDEN:new fr("panel.hidden",1,1,!0),AUXILIARYBAR_HIDDEN:new fr("auxiliaryBar.hidden",1,1,!0),STATUSBAR_HIDDEN:new fr("statusBar.hidden",1,1,!1,!0)};var u9=class r extends L{constructor(e,i,n,o){super();this.storageService=e;this.configurationService=i;this.contextService=n;this.container=o;this._register(this.configurationService.onDidChangeConfiguration(s=>this.updateStateFromLegacySettings(s)))}static STORAGE_PREFIX="workbench.";_onDidChangeState=this._register(new T);onDidChangeState=this._onDidChangeState.event;stateCache=new Map;updateStateFromLegacySettings(e){e.affectsConfiguration("workbench.activityBar.location")&&this.setRuntimeValueAndFire(ve.ACTIVITYBAR_HIDDEN,this.isActivityBarHidden()),e.affectsConfiguration("workbench.statusBar.visible")&&this.setRuntimeValueAndFire(ve.STATUSBAR_HIDDEN,!this.configurationService.getValue("workbench.statusBar.visible")),e.affectsConfiguration("workbench.sideBar.location")&&this.setRuntimeValueAndFire(ve.SIDEBAR_POSITON,mf(this.configurationService.getValue("workbench.sideBar.location")??"left"))}updateLegacySettingsFromState(e,i){let n=this.getRuntimeValue(ve.ZEN_MODE_ACTIVE);e.zenModeIgnore&&n||(e===ve.ACTIVITYBAR_HIDDEN?this.configurationService.updateValue("workbench.activityBar.location",i?"hidden":void 0):e===ve.STATUSBAR_HIDDEN?this.configurationService.updateValue("workbench.statusBar.visible",!i):e===ve.SIDEBAR_POSITON&&this.configurationService.updateValue("workbench.sideBar.location",Mr(i)))}load(){let e;for(e in ve){let n=ve[e],o=this.loadKeyFromStorage(n);o!==void 0&&this.stateCache.set(n.name,o)}this.stateCache.set(ve.ACTIVITYBAR_HIDDEN.name,this.isActivityBarHidden()),this.stateCache.set(ve.STATUSBAR_HIDDEN.name,!this.configurationService.getValue("workbench.statusBar.visible")),this.stateCache.set(ve.SIDEBAR_POSITON.name,mf(this.configurationService.getValue("workbench.sideBar.location")??"left"));let i=gd(this.container);ve.PANEL_POSITION.defaultValue=mf(this.configurationService.getValue("workbench.panel.defaultLocation")??"bottom"),ve.GRID_SIZE.defaultValue={height:i.height,width:i.width},ve.SIDEBAR_SIZE.defaultValue=Math.min(300,i.width/4),ve.AUXILIARYBAR_SIZE.defaultValue=Math.min(300,i.width/4),ve.PANEL_SIZE.defaultValue=this.stateCache.get(ve.PANEL_POSITION.name)??ho(ve.PANEL_POSITION.defaultValue)?i.height/3:i.width/4,ve.SIDEBAR_HIDDEN.defaultValue=this.contextService.getWorkbenchState()===1;for(e in ve){let n=ve[e];this.stateCache.get(n.name)===void 0&&this.stateCache.set(n.name,n.defaultValue)}this._register(this.storageService.onDidChangeValue(0,void 0,this._register(new W))(n=>{let o;for(o in ve){let s=ve[o];if(s instanceof fr&&s.scope===0&&s.target===0&&`${r.STORAGE_PREFIX}${s.name}`===n.key){let a=this.loadKeyFromStorage(s)??s.defaultValue;this.stateCache.get(s.name)!==a&&(this.stateCache.set(s.name,a),this._onDidChangeState.fire({key:s,value:a}))}}}))}save(e,i){let n,o=this.getRuntimeValue(ve.ZEN_MODE_ACTIVE);for(n in ve){let s=ve[n];if(e&&s.scope===1||i&&s.scope===0){if(o&&s instanceof fr&&s.zenModeIgnore)continue;this.saveKeyToStorage(s)}}}getInitializationValue(e){return this.stateCache.get(e.name)}setInitializationValue(e,i){this.stateCache.set(e.name,i)}getRuntimeValue(e,i){if(i)switch(e){case ve.ACTIVITYBAR_HIDDEN:this.stateCache.set(e.name,this.isActivityBarHidden());break;case ve.STATUSBAR_HIDDEN:this.stateCache.set(e.name,!this.configurationService.getValue("workbench.statusBar.visible"));break;case ve.SIDEBAR_POSITON:this.stateCache.set(e.name,this.configurationService.getValue("workbench.sideBar.location")??"left");break}return this.stateCache.get(e.name)}setRuntimeValue(e,i){this.stateCache.set(e.name,i);let n=this.getRuntimeValue(ve.ZEN_MODE_ACTIVE);e.scope===0&&(!n||!e.zenModeIgnore)&&(this.saveKeyToStorage(e),this.updateLegacySettingsFromState(e,i))}isActivityBarHidden(){let e=this.configurationService.getValue("workbench.activityBar.visible");return e!==void 0?!e:this.configurationService.getValue("workbench.activityBar.location")!=="default"}setRuntimeValueAndFire(e,i){this.stateCache.get(e.name)!==i&&(this.setRuntimeValue(e,i),this._onDidChangeState.fire({key:e,value:i}))}saveKeyToStorage(e){let i=this.stateCache.get(e.name);this.storageService.store(`${r.STORAGE_PREFIX}${e.name}`,typeof i=="object"?JSON.stringify(i):i,e.scope,e.target)}loadKeyFromStorage(e){let i=this.storageService.get(`${r.STORAGE_PREFIX}${e.name}`,e.scope);if(i!==void 0)switch(typeof e.defaultValue){case"boolean":i=i==="true";break;case"number":i=parseInt(i);break;case"object":i=JSON.parse(i);break}return i}};var dhe=5e3,nS=class extends L{constructor(e,i,n){super();this._accessibilitySignalService=n;this._scheduler=new Et(()=>{this._signalLoop=this._accessibilitySignalService.playSignalLoop(mo.progress,i??dhe)},e),this._scheduler.schedule()}_scheduler;_signalLoop;dispose(){super.dispose(),this._signalLoop?.dispose(),this._scheduler.dispose()}};nS=_([v(2,Rl)],nS);var Ite=$("accessibleViewService");var BN=class extends L{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g){super();this.id=e;this.options=i;this.provideContent=n;this.onClose=o;this.verbositySettingKey=s;this.onOpen=a;this.actions=l;this.provideNextContent=d;this.providePreviousContent=c;this.onDidChangeContent=u;this.onKeyDown=p;this.getSymbols=m;this.onDidRequestClearLastProvider=g}};var Cte=new class{_implementations=[];register(t){return this._implementations.push(t),{dispose:()=>{let e=this._implementations.indexOf(t);e!==-1&&this._implementations.splice(e,1)}}}getImplementations(){return this._implementations}};var VN=class{priority=90;name="notifications";when=Ps;type="view";getProvider(t){let e=t.get(Ite),i=t.get(ko),n=t.get(ni),o=t.get(Rl);function s(){let a=Cm(i);if(!a)return;n.executeCommand("notifications.showList");let l,d=i.lastFocusedList;if(d instanceof tu&&(l=d.indexOf(a)),l===void 0)return;function c(){if(n.executeCommand("notifications.showList"),d&&l!==void 0){d.domFocus();try{d.setFocus([l])}catch{}}}function u(){let m=Cm(i),g=m?.message.original.toString();if(m)return m.source?h("notification.accessibleViewSrc","{0} Source: {1}",g,m.source):h("notification.accessibleView","{0}",g)}let p=u();if(p)return a.onDidClose(()=>e.next()),new BN("notification",{type:"view"},()=>p,()=>c(),"accessibility.verbosity.notification",void 0,che(a,o),()=>{if(d)return c(),d.focusNext(),u()},()=>{if(d)return c(),d.focusPrevious(),u()})}return s()}};function che(r,t){let e;if(r.actions&&(e=[],r.actions.primary&&e.push(...r.actions.primary),r.actions.secondary&&e.push(...r.actions.secondary)),e)for(let n of e){n.class=ye.asClassName(B.bell);let o=n.run;n.run=()=>{o(),r.close()}}let i=e?.find(n=>n.label.includes("Manage Extension"));return i&&(i.class=ye.asClassName(B.gear)),e&&e.push({id:"clearNotification",label:h("clearNotification","Clear Notification"),tooltip:h("clearNotification","Clear Notification"),run:()=>{r.close(),t.playSignal(mo.clear)},enabled:!0,class:ye.asClassName(B.clearAll)}),e}var WN=class extends NN{constructor(e,i,n,o){super(e);this.options=i;this.serviceCollection=n;Dt("code/willStartWorkbench"),this.registerErrorHandler(o)}_onWillShutdown=this._register(new T);onWillShutdown=this._onWillShutdown.event;_onDidShutdown=this._register(new T);onDidShutdown=this._onDidShutdown.event;registerErrorHandler(e){ne.addEventListener("unhandledrejection",i=>{Ke(i.reason),i.preventDefault()}),h7(i=>this.handleUnexpectedError(i,e)),!!0&&typeof ne.require?.config=="function"&&ne.require.config({onError:i=>{i.phase==="loading"&&Ke(new Error(h("loaderErrorNative","Failed to load a required file. Please restart the application to try again. Details: {0}",JSON.stringify(i)))),console.error(i)}})}previousUnexpectedError={message:void 0,time:0};handleUnexpectedError(e,i){let n=lo(e,!0);if(!n)return;let o=Date.now();n===this.previousUnexpectedError.message&&o-this.previousUnexpectedError.time<=1e3||(this.previousUnexpectedError.time=o,this.previousUnexpectedError.message=n,i.error(n))}startup(){try{this._register(K7(175));let e=this.initServices(this.serviceCollection);return e.invokeFunction(i=>{let n=i.get(Pn),o=i.get(tt),s=i.get(de),a=i.get(en),l=i.get(qi),d=i.get(Ar),c=i.get(jt);dX((u,p)=>e.createInstance(du,u,p,{})),lX(l),this.initLayout(i),Ne.as(Qh.Workbench).start(i),Ne.as(Ua.EditorFactory).start(i),this._register(e.createInstance(GI)),this.registerListeners(n,o,s,a,d),this.renderWorkbench(e,c,o,s),this.createWorkbenchLayout(),this.layout(),this.restore(n)}),e}catch(e){throw Ke(e),e}}initServices(e){e.set(Qe,this);let i=W$();for(let[o,s]of i)e.set(o,s);let n=new _0(e,!0);return n.invokeFunction(o=>{let s=o.get(Pn),a=o.get(de);typeof a.acquireInstantiationService=="function"&&a.acquireInstantiationService(n),s.phase=2}),n}registerListeners(e,i,n,o,s){this._register(n.onDidChangeConfiguration(a=>this.updateFontAliasing(a,n))),Pi?this._register(i.onWillSaveState(a=>{a.reason===1&&this.storeFontInfo(i)})):this._register(e.onWillShutdown(()=>this.storeFontInfo(i))),this._register(e.onWillShutdown(a=>this._onWillShutdown.fire(a))),this._register(e.onDidShutdown(()=>{this._onDidShutdown.fire(),this.dispose()})),this._register(o.onDidChangeFocus(a=>{a||i.flush()})),this._register(s.onWillShowDialog(()=>this.mainContainer.classList.add("modal-dialog-visible"))),this._register(s.onDidShowDialog(()=>this.mainContainer.classList.remove("modal-dialog-visible")))}fontAliasing;updateFontAliasing(e,i){if(!be||e&&!e.affectsConfiguration("workbench.fontAliasing"))return;let n=i.getValue("workbench.fontAliasing");if(this.fontAliasing===n)return;this.fontAliasing=n;let o=["antialiased","none","auto"];this.mainContainer.classList.remove(...o.map(s=>`monaco-font-aliasing-${s}`)),o.some(s=>s===n)&&this.mainContainer.classList.add(`monaco-font-aliasing-${n}`)}restoreFontInfo(e,i){let n=e.get("editorFontInfo",-1);if(n)try{let o=JSON.parse(n);Array.isArray(o)&&Uf.restoreFontInfo(ne,o)}catch{}Uf.readFontInfo(ne,Ug.createFromRawSettings(i.getValue("editor"),hu.getInstance(ne).value))}storeFontInfo(e){let i=Uf.serializeFontInfo(ne);i&&e.store("editorFontInfo",JSON.stringify(i),-1,1)}renderWorkbench(e,i,n,o){iX(this.mainContainer),NX((l,d)=>e.createInstance(nS,l,d));let s=rt?"windows":_t?"linux":"mac",a=Ei(["monaco-workbench",s,wt?"web":void 0,xc?"chromium":dn?"firefox":Eo?"safari":void 0,...this.getLayoutClasses(),...this.options?.extraClasses?this.options.extraClasses:[]]);this.mainContainer.classList.add(...a),ne.document.body.classList.add(s),wt&&ne.document.body.classList.add("web"),this.updateFontAliasing(void 0,o),this.restoreFontInfo(n,o);for(let{id:l,role:d,classes:c,options:u}of[{id:"workbench.parts.titlebar",role:"none",classes:["titlebar"]},{id:"workbench.parts.banner",role:"banner",classes:["banner"]},{id:"workbench.parts.activitybar",role:"none",classes:["activitybar",this.getSideBarPosition()===0?"left":"right"]},{id:"workbench.parts.sidebar",role:"none",classes:["sidebar",this.getSideBarPosition()===0?"left":"right"]},{id:"workbench.parts.editor",role:"main",classes:["editor"],options:{restorePreviousState:this.willRestoreEditors()}},{id:"workbench.parts.panel",role:"none",classes:["panel","basepanel",Mr(this.getPanelPosition())]},{id:"workbench.parts.auxiliarybar",role:"none",classes:["auxiliarybar","basepanel",this.getSideBarPosition()===0?"right":"left"]},{id:"workbench.parts.statusbar",role:"status",classes:["statusbar"]}]){let p=this.createPart(l,d,c);Dt(`code/willCreatePart/${l}`),this.getPart(l).create(p,u),Dt(`code/didCreatePart/${l}`)}this.createNotificationsHandlers(e,i),this.parent.appendChild(this.mainContainer)}createPart(e,i,n){let o=document.createElement(i==="status"?"footer":"div");return o.classList.add("part",...n),o.id=e,o.setAttribute("role",i),i==="status"&&o.setAttribute("aria-live","off"),o}createNotificationsHandlers(e,i){let n=this._register(e.createInstance(zd,this.mainContainer,i.model)),o=this._register(e.createInstance(Fl,this.mainContainer,i.model));this._register(e.createInstance(cM,i.model));let s=e.createInstance(KI,i.model);this._register(e.createInstance(iI)),this._register(n.onDidChangeVisibility(()=>{s.update(n.isVisible,o.isVisible),o.update(n.isVisible)})),this._register(o.onDidChangeVisibility(()=>{s.update(n.isVisible,o.isVisible)})),zQ(n,o,i.model),Cte.register(new VN),this.registerNotifications({onDidChangeNotificationsVisibility:O.map(O.any(o.onDidChangeVisibility,n.onDidChangeVisibility),()=>o.isVisible||n.isVisible)})}restore(e){try{this.restoreParts()}catch(i){Ke(i)}this.whenReady.finally(()=>Promise.race([this.whenRestored,Sn(2e3)]).finally(()=>{function i(){Dt("code/didStartWorkbench"),performance.measure("perf: workbench create & restore","code/didLoadWorkbenchMain","code/didStartWorkbench")}this.isRestored()?i():this.whenRestored.finally(()=>i()),e.phase=3,this._register(new Et(()=>{this._register(md(ne,()=>e.phase=4,2500))},2500)).schedule()}))}};var Ste=Ze;var uhe;(i=>{function r(n){return n&&{_extensionId:n.extensionId,_extensionIsBuiltin:n.extensionIsBuiltin,_extensionName:n.extensionName,_extensionPublisher:n.extensionPublisher}}i.toJSONObject=r;function t(n){if(n&&si(n._extensionId)&&gh(n._extensionIsBuiltin)&&si(n._extensionName)&&si(n._extensionPublisher))return{extensionId:n._extensionId,extensionIsBuiltin:n._extensionIsBuiltin,extensionName:n._extensionName,extensionPublisher:n._extensionPublisher}}i.fromJSONObject=t;function e(n,o,s=!1){return{extensionPublisher:n,extensionId:`${n}.${o}`,extensionName:o,extensionIsBuiltin:s}}i.fromName=e})(uhe||={});var oS=globalThis.vscode,un=oS.ipcRenderer,wte=oS.ipcMessagePort,Ete=oS.webFrame,Tte=oS.process,iDn=oS.context,nDn=oS.webUtils;var phe=8,hhe=-8;function UN(r,t){r=Math.min(Math.max(r,hhe),phe);let e=[];t===1?e.push(uo()):t===2?e.push(...Array.from(hd()).map(({window:i})=>i)):e.push(t);for(let i of e)mhe(i)?.webFrame?.setZoomLevel(r),yj(yq(r),i),bj(r,i)}function mhe(r){if(r===ne)return{ipcRenderer:un,webFrame:Ete};{let t=r;if(t?.vscode?.ipcRenderer&&t?.vscode?.webFrame)return t.vscode}}var xte=$("integrityService");var HN=tr,bn=class extends Bi{constructor(e,i){super(e,{homeDir:e.homeDir,tmpDir:e.tmpDir,userDataDir:e.userDataDir},i);this.configuration=e}get mainPid(){return this.configuration.mainPid}get machineId(){return this.configuration.machineId}get sqmId(){return this.configuration.sqmId}get devDeviceId(){return this.configuration.devDeviceId}get remoteAuthority(){return this.configuration.remoteAuthority}get expectsResolverExtension(){return!!this.configuration.remoteAuthority?.includes("+")}get execPath(){return this.configuration.execPath}get backupPath(){return this.configuration.backupPath}get window(){return{id:this.configuration.windowId,colorScheme:this.configuration.colorScheme,maximized:this.configuration.maximized,accessibilitySupport:this.configuration.accessibilitySupport,perfMarks:this.configuration.perfMarks,isInitialStartup:this.configuration.isInitialStartup,isCodeCaching:typeof this.configuration.codeCachePath=="string"}}get windowLogsPath(){return Ot(this.logsHome,`window${this.configuration.windowId}`)}get logFile(){return Ot(this.windowLogsPath,"renderer.log")}get extHostLogsPath(){return Ot(this.windowLogsPath,"exthost")}get extHostTelemetryLogFile(){return Ot(this.extHostLogsPath,"extensionTelemetry.log")}get webviewExternalEndpoint(){return`${he.vscodeWebview}://{{uuid}}`}get skipReleaseNotes(){return!!this.args["skip-release-notes"]}get skipWelcome(){return!!this.args["skip-welcome"]}get logExtensionHostCommunication(){return!!this.args.logExtensionHostCommunication}get enableSmokeTestDriver(){return!!this.args["enable-smoke-test-driver"]}get extensionEnabledProposedApi(){if(Array.isArray(this.args["enable-proposed-api"]))return this.args["enable-proposed-api"];if("enable-proposed-api"in this.args)return[]}get os(){return this.configuration.os}get filesToOpenOrCreate(){return this.configuration.filesToOpenOrCreate}get filesToDiff(){return this.configuration.filesToDiff}get filesToMerge(){return this.configuration.filesToMerge}get filesToWait(){return this.configuration.filesToWait}};_([ue],bn.prototype,"mainPid",1),_([ue],bn.prototype,"machineId",1),_([ue],bn.prototype,"sqmId",1),_([ue],bn.prototype,"devDeviceId",1),_([ue],bn.prototype,"remoteAuthority",1),_([ue],bn.prototype,"expectsResolverExtension",1),_([ue],bn.prototype,"execPath",1),_([ue],bn.prototype,"backupPath",1),_([ue],bn.prototype,"window",1),_([ue],bn.prototype,"windowLogsPath",1),_([ue],bn.prototype,"logFile",1),_([ue],bn.prototype,"extHostLogsPath",1),_([ue],bn.prototype,"extHostTelemetryLogFile",1),_([ue],bn.prototype,"webviewExternalEndpoint",1),_([ue],bn.prototype,"skipReleaseNotes",1),_([ue],bn.prototype,"skipWelcome",1),_([ue],bn.prototype,"logExtensionHostCommunication",1),_([ue],bn.prototype,"enableSmokeTestDriver",1),_([ue],bn.prototype,"extensionEnabledProposedApi",1),_([ue],bn.prototype,"os",1),_([ue],bn.prototype,"filesToOpenOrCreate",1),_([ue],bn.prototype,"filesToDiff",1),_([ue],bn.prototype,"filesToMerge",1),_([ue],bn.prototype,"filesToWait",1);var rLn=$("requestService");var p9;function ghe(r){let t=Ne.as(xi.Configuration),e=p9;p9={id:"http",order:15,title:h("httpConfigurationTitle","HTTP"),type:"object",scope:r,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:h("proxy","The proxy setting to use. If not set, will be inherited from the `http_proxy` and `https_proxy` environment variables."),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,description:h("strictSSL","Controls whether the proxy server certificate should be verified against the list of supplied CAs."),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:h("proxyKerberosServicePrincipal","Overrides the principal service name for Kerberos authentication with the HTTP proxy. A default based on the proxy hostname is used when this is not set."),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:h("noProxy","Specifies domain names for which proxy settings should be ignored for HTTP/HTTPS requests."),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:h("proxyAuthorization","The value to send as the `Proxy-Authorization` header for every network request."),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[h("proxySupportOff","Disable proxy support for extensions."),h("proxySupportOn","Enable proxy support for extensions."),h("proxySupportFallback","Enable proxy support for extensions, fall back to request options, when no proxy found."),h("proxySupportOverride","Enable proxy support for extensions, override request options.")],default:"override",description:h("proxySupport","Use the proxy support for extensions."),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,description:h("systemCertificates","Controls whether CA certificates should be loaded from the OS. (On Windows and macOS, a reload of the window is required after turning this off.)"),restricted:!0},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,description:h("systemCertificatesV2","Controls whether experimental loading of CA certificates from the OS should be enabled. This uses a more general approach than the default implemenation."),restricted:!0}}},t.updateConfigurations({add:[p9],remove:e?[e]:[]})}ghe(1);var zN=$("nativeHostService");var Lte=$("tunnelService"),ZLn=$("sharedTunnelsService");function GN(r){if(r.scheme!=="http"&&r.scheme!=="https")return;let t=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(r.authority);if(t)return{address:t[1],port:+t[2]}}function kte(r){if(r.scheme!=="http"&&r.scheme!=="https"||!r.query)return;let t=r.query.split("&");for(let e of t){let i=e.split("=")[1];if(/^https?:/.exec(i)){let n=GN(q.parse(i));if(n)return n}}}var h9=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function _te(r){return h9.indexOf(r)>=0}var m9=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function Dte(r){return m9.indexOf(r)>=0}var KN=class extends L{constructor(e,i){super();this.logService=e;this.configurationService=i}_onTunnelOpened=new T;onTunnelOpened=this._onTunnelOpened.event;_onTunnelClosed=new T;onTunnelClosed=this._onTunnelClosed.event;_onAddedTunnelProvider=new T;onAddedTunnelProvider=this._onAddedTunnelProvider.event;_tunnels=new Map;_tunnelProvider;_canElevate=!1;_canChangeProtocol=!0;_privacyOptions=[];_factoryInProgress=new Set;get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){let e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){let e=[],i=Array.from(this._tunnels.values());for(let n of i){let o=Array.from(n.values());for(let s of o){let a=await s.value;a&&typeof a!="string"&&e.push(a)}}return e}async dispose(){super.dispose();for(let e of this._tunnels.values()){for(let{value:i}of e.values())await i.then(n=>typeof n!="string"?n?.dispose():void 0);e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,i,n,o,s){this.addTunnelToMap(e,i,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:i,localAddress:n,privacy:o,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,i){(Dte(e)||_te(e))&&(e=h9[0]);let n=this.getTunnelFromMap(e,i);if(n)return++n.refcount,n.value}openTunnel(e,i,n,o,s,a=!1,l,d){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${n} on local port ${s}.`);let c=this._tunnelProvider??e;if(!c)return;if(i||(i="localhost"),o||(o=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(n)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}let u=this.retainOrCreateTunnel(c,i,n,o,s,a,l,d);return u?u.then(p=>{if(p){if(typeof p=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(i,n),p}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(i,n);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");let m=this.makeTunnel(p);return(p.tunnelRemoteHost!==i||p.tunnelRemotePort!==n)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),l&&p.privacy!==l&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(m),m}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);let i=this._tunnels.get(e.tunnelRemoteHost);if(i){let n=i.get(e.tunnelRemotePort);n&&(n.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,n))}}}}async tryDisposeTunnel(e,i,n){if(n.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${i}.`);let o=n.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(i),o}}async closeTunnel(e,i){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${i} `);let n=this._tunnels.get(e);if(n&&n.has(i)){let o=n.get(i);o.refcount=0,await this.tryDisposeTunnel(e,i,o)}}addTunnelToMap(e,i,n){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(i,{refcount:1,value:n})}async removeEmptyOrErrorTunnelFromMap(e,i){let n=this._tunnels.get(e);if(n){let o=n.get(i),s=o?await o.value:void 0;(!s||typeof s=="string")&&n.delete(i),n.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,i){let n=[e];_te(e)?(n.push(...h9),n.push(...m9)):Dte(e)&&n.push(...m9);let o=n.map(s=>this._tunnels.get(s));for(let s of o){let a=s?.get(i);if(a)return a}}canTunnel(e){return!!GN(e)}createWithProvider(e,i,n,o,s,a,l){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${n} on local port ${o}.`);let d=n;this._factoryInProgress.add(d);let c=o===void 0?n:o,u={elevationRequired:s?this.isPortPrivileged(c):!1},p={remoteAddress:{host:i,port:n},localAddressPort:o,privacy:a,public:a?a!=="private":void 0,protocol:l},m=e.forwardPort(p,u);return m?(this.addTunnelToMap(i,n,m),m.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(d)})):this._factoryInProgress.delete(d),m}};KN=_([v(0,Gt),v(1,de)],KN);var _u=$("mainProcessService");var $N=class{constructor(t,e,i,n){let o=i.getChannel(t);return fhe(e)?n.createInstance(new Xs(e.channelClientCtor,[o])):Wd.toService(o,e?.proxyOptions)}};function fhe(r){return!!r?.channelClientCtor}var qN=class extends $N{constructor(t,e,i,n){super(t,e,i,n)}};qN=_([v(2,_u),v(3,ae)],qN);var c_=$("sharedProcessService"),jN=class extends $N{constructor(t,e,i,n){super(t,e,i,n)}};jN=_([v(2,c_),v(3,ae)],jN);var g9=class{constructor(t){this.port=t;t.start()}onMessage=O.fromDOMEventEmitter(this.port,"message",t=>t.data?qe.wrap(t.data):qe.alloc(0));send(t){this.port.postMessage(t.buffer)}disconnect(){this.port.close()}},rS=class extends fm{protocol;constructor(t,e){let i=new g9(t);super(i,e),this.protocol=i}dispose(){this.protocol.disconnect(),super.dispose()}};async function u_(r,t,e=zr()){wte.acquire(t,e),typeof r=="string"&&un.send(r,e);let i=O.fromDOMEventEmitter(ne,"message",o=>({nonce:o.data,port:o.ports[0],source:o.source})),{port:n}=await O.toPromise(O.once(O.filter(i,o=>o.nonce===e&&o.source===ne)));return n}var Rte="utilityProcessWorker";var YN=$("utilityProcessWorkerWorkbenchService"),sS=class extends L{constructor(e,i,n){super();this.windowId=e;this.logService=i;this.mainProcessService=n}_utilityProcessWorkerService=void 0;get utilityProcessWorkerService(){if(!this._utilityProcessWorkerService){let e=this.mainProcessService.getChannel(Rte);this._utilityProcessWorkerService=Wd.toService(e)}return this._utilityProcessWorkerService}restoredBarrier=new La;async createWorker(e){this.logService.trace("Renderer->UtilityProcess#createWorker"),await Promise.race([this.restoredBarrier.wait(),Sn(2e3)]);let i=zr(),n="vscode:createUtilityProcessWorkerMessageChannelResult",o=u_(void 0,n,i),s=this.utilityProcessWorkerService.createWorker({process:e,reply:{windowId:this.windowId,channel:n,nonce:i}}),a=new W;a.add(te(()=>{this.logService.trace("Renderer->UtilityProcess#disposeWorker",e),this.utilityProcessWorkerService.disposeWorker({process:e,reply:{windowId:this.windowId}})}));let l=await o,d=a.add(new rS(l,`window:${this.windowId},module:${e.moduleId}`));return this.logService.trace("Renderer->UtilityProcess#createWorkerChannel: connection established"),s.then(({reason:c})=>{c?.code===0?this.logService.trace(`[UtilityProcessWorker]: terminated normally with code ${c.code}, signal: ${c.signal}`):this.logService.error(`[UtilityProcessWorker]: terminated unexpectedly with code ${c?.code}, signal: ${c?.signal}`)}),{client:d,onDidTerminate:s,dispose:()=>a.dispose()}}notifyRestored(){this.restoredBarrier.isOpen()||this.restoredBarrier.open()}};sS=_([v(1,Gt),v(2,_u)],sS);var p_=class extends Bf{constructor(e,i,n,o,s){super(i,n,o,s);this.helper=e}exitApplication(){return this.helper.exitApplication()}};p_=_([v(1,ai),v(2,tr),v(3,Pn),v(4,Gt)],p_);function Ate(r,t){Object.assign(ne,{driver:r.createInstance(p_,t)})}var og=class extends Ns{constructor(e,i,n,o,s,a,l,d,c,u,p,m,g,f,b,y,I,E,S,w,D,k,R,A,H,z,Z,fe,Ve,me,ce,xe,Ie,ge,He,_e,xt){super(ne,void 0,xt,b);this.editorService=e;this.editorGroupService=i;this.configurationService=n;this.titleService=o;this.themeService=s;this.notificationService=a;this.commandService=l;this.keybindingService=d;this.telemetryService=c;this.workspaceEditingService=u;this.fileService=p;this.menuService=m;this.lifecycleService=g;this.integrityService=f;this.nativeEnvironmentService=b;this.accessibilityService=y;this.contextService=I;this.openerService=E;this.nativeHostService=S;this.tunnelService=w;this.layoutService=D;this.workingCopyService=k;this.filesConfigurationService=R;this.productService=A;this.remoteAuthorityResolverService=H;this.dialogService=z;this.storageService=Z;this.logService=fe;this.instantiationService=Ve;this.sharedProcessService=me;this.progressService=ce;this.labelService=xe;this.bannerService=Ie;this.uriIdentityService=ge;this.preferencesService=He;this.utilityProcessWorkerWorkbenchService=_e;this.registerListeners(),this.create()}customTitleContextMenuDisposable=this._register(new W);addFoldersScheduler=this._register(new Et(()=>this.doAddFolders(),100));pendingFoldersToAdd=[];isDocumentedEdited=!1;registerListeners(){this._register(M(ne,G.RESIZE,()=>this.layoutService.layout())),this._register(this.editorService.onDidActiveEditorChange(()=>this.updateTouchbarMenu()));for(let i of[G.DRAG_OVER,G.DROP])this._register(M(ne.document.body,i,n=>{Te.stop(n)}));un.on("vscode:runAction",async(i,n)=>{let o=n.args||[];if(n.from==="touchbar"){let s=this.editorService.activeEditor;if(s){let a=Ui.getOriginalUri(s,{supportSideBySide:1});a&&o.push(a)}}else o.push({from:n.from});try{await this.commandService.executeCommand(n.id,...o),this.telemetryService.publicLog2("workbenchActionExecuted",{id:n.id,from:n.from})}catch(s){this.notificationService.error(s)}}),un.on("vscode:runKeybinding",(i,n)=>{let o=An();o&&this.keybindingService.dispatchByUserSettingsLabel(n.userSettingsLabel,o)}),un.on("vscode:reportError",(i,n)=>{n&&Ke(JSON.parse(n))}),un.on("vscode:reportSharedProcessCrash",(i,n)=>{this.notificationService.prompt(ui.Error,h("sharedProcessCrash","A shared background process terminated unexpectedly. Please restart the application to recover."),[{label:h("restart","Restart"),run:()=>this.nativeHostService.relaunch()}],{priority:2})}),un.on("vscode:openFiles",(i,n)=>{this.onOpenFiles(n)}),un.on("vscode:addFolders",(i,n)=>{this.onAddFoldersRequest(n)}),un.on("vscode:showInfoMessage",(i,n)=>{this.notificationService.info(n)}),un.on("vscode:showResolveShellEnvError",(i,n)=>{this.notificationService.prompt(ui.Error,n,[{label:h("restart","Restart"),run:()=>this.nativeHostService.relaunch()},{label:h("configure","Configure"),run:()=>this.preferencesService.openUserSettings({query:"application.shellEnvironmentResolutionTimeout"})},{label:h("learnMore","Learn More"),run:()=>this.openerService.open("https://go.microsoft.com/fwlink/?linkid=2149667")}])}),un.on("vscode:showCredentialsError",(i,n)=>{this.notificationService.prompt(ui.Error,h("keychainWriteError","Writing login information to the keychain failed with error '{0}'.",n),[{label:h("troubleshooting","Troubleshooting Guide"),run:()=>this.openerService.open("https://go.microsoft.com/fwlink/?linkid=2190713")}])}),un.on("vscode:showTranslatedBuildWarning",()=>{this.notificationService.prompt(ui.Warning,h("runningTranslated","You are running an emulated version of {0}. For better performance download the native arm64 version of {0} build for your machine.",this.productService.nameLong),[{label:h("downloadArmBuild","Download"),run:()=>{let i=this.productService.quality;this.openerService.open(i==="stable"?"https://code.visualstudio.com/docs/?dv=osx":"https://code.visualstudio.com/docs/?dv=osx&build=insiders")}}],{priority:2})}),un.on("vscode:showArgvParseWarning",(i,n)=>{this.notificationService.prompt(ui.Warning,h("showArgvParseWarning","The runtime arguments file 'argv.json' contains errors. Please correct them and restart."),[{label:h("showArgvParseWarningAction","Open File"),run:()=>this.editorService.openEditor({resource:this.nativeEnvironmentService.argvResource})}],{priority:2})}),un.on("vscode:enterFullScreen",()=>Bg(!0,ne)),un.on("vscode:leaveFullScreen",()=>Bg(!1,ne)),un.on("vscode:openProxyAuthenticationDialog",async(i,n)=>{let o="window.rememberProxyCredentials",s=this.storageService.getBoolean(o,-1),a=await this.dialogService.input({type:"warning",message:h("proxyAuthRequired","Proxy Authentication Required"),primaryButton:h({key:"loginButton",comment:["&& denotes a mnemonic"]},"&&Log In"),inputs:[{placeholder:h("username","Username"),value:n.username},{placeholder:h("password","Password"),type:"password",value:n.password}],detail:h("proxyDetail","The proxy {0} requires a username and password.",`${n.authInfo.host}:${n.authInfo.port}`),checkbox:{label:h("rememberCredentials","Remember my credentials"),checked:s}});if(!a.confirmed||!a.values)un.send(n.replyChannel);else{a.checkboxChecked?this.storageService.store(o,!0,-1,1):this.storageService.remove(o,-1);let[l,d]=a.values;un.send(n.replyChannel,{username:l,password:d,remember:!!a.checkboxChecked})}}),un.on("vscode:accessibilitySupportChanged",(i,n)=>{this.accessibilityService.setAccessibilitySupport(n?2:1)}),un.on("vscode:configureAllowedUNCHost",async(i,n)=>{if(!rt)return;let o=new Set,s=this.configurationService.getValue("security.allowedUNCHosts")??[];if(Array.isArray(s))for(let a of s)typeof a=="string"&&o.add(a);o.has(n)||(o.add(n),await BZ(uI.ID).ready,this.configurationService.updateValue("security.allowedUNCHosts",[...o.values()],2))}),un.on("vscode:disablePromptForProtocolHandling",(i,n)=>{let o=n==="local"?"security.promptForLocalFileProtocolHandling":"security.promptForRemoteFileProtocolHandling";this.configurationService.updateValue(o,!1)}),this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration("window.zoomLevel")||i.affectsConfiguration("window.zoomPerWindow")&&this.configurationService.getValue("window.zoomPerWindow")===!1?this.onDidChangeConfiguredWindowZoomLevel():(i.affectsConfiguration("keyboard.touchbar.enabled")||i.affectsConfiguration("keyboard.touchbar.ignored"))&&this.updateTouchbarMenu()})),this._register(vj(i=>this.handleOnDidChangeZoomLevel(i)));for(let i of this.editorGroupService.parts)this.createWindowZoomStatusEntry(i);this._register(this.editorGroupService.onDidCreateAuxiliaryEditorPart(i=>this.createWindowZoomStatusEntry(i))),this._register(O.debounce(this.editorService.onDidVisibleEditorsChange,()=>{},0,void 0,void 0,void 0,this._store)(()=>this.maybeCloseWindow()));let e=this.nativeEnvironmentService.filesToWait;if(e&&this.trackClosedWaitFiles(e.waitMarkerFileUri,Ei(e.paths.map(i=>i.fileUri))),be){for(let i of this.editorGroupService.parts)this.handleRepresentedFilename(i);this._register(this.editorGroupService.onDidCreateAuxiliaryEditorPart(i=>this.handleRepresentedFilename(i)))}be&&!Dr(this.configurationService)&&this._register(O.runAndSubscribe(this.layoutService.onDidAddContainer,({container:i,disposables:n})=>{let o=oe(i),s=o.vscodeWindowId,a=Ue(this.layoutService.getContainer(o,"workbench.parts.titlebar"));n.add(M(a,G.DBLCLICK,l=>{Te.stop(l),this.nativeHostService.handleTitleDoubleClick({targetWindowId:s})}))},{container:this.layoutService.mainContainer,disposables:this._store})),this._register(this.workingCopyService.onDidChangeDirty(i=>{let n=i.isDirty();n&&!(i.capabilities&2)&&this.filesConfigurationService.hasShortAutoSaveDelay(i.resource)||this.updateDocumentEdited(n?!0:void 0)})),this.updateDocumentEdited(void 0),this._register(O.any(O.map(O.filter(this.nativeHostService.onDidMaximizeWindow,i=>!!nW(i)),i=>({maximized:!0,windowId:i})),O.map(O.filter(this.nativeHostService.onDidUnmaximizeWindow,i=>!!nW(i)),i=>({maximized:!1,windowId:i})))(i=>this.layoutService.updateWindowMaximizedState(Ma(i.windowId).window,i.maximized))),this.layoutService.updateWindowMaximizedState(ne,this.nativeEnvironmentService.window.maximized??!1),this._register(this.layoutService.onDidChangePanelPosition(i=>this.onDidChangePanelPosition(mf(i)))),this.onDidChangePanelPosition(this.layoutService.getPanelPosition()),this._register(this.lifecycleService.onBeforeShutdown(i=>this.onBeforeShutdown(i))),this._register(this.lifecycleService.onBeforeShutdownError(i=>this.onBeforeShutdownError(i))),this._register(this.lifecycleService.onWillShutdown(i=>this.onWillShutdown(i)))}handleRepresentedFilename(e){let i=new W;O.once(e.onWillDispose)(()=>i.dispose());let n=this.editorGroupService.getScopedInstantiationService(e).invokeFunction(o=>o.get(kt));i.add(n.onDidActiveEditorChange(()=>this.updateRepresentedFilename(n,e.windowId)))}updateRepresentedFilename(e,i){let n=Ui.getOriginalUri(e.activeEditor,{supportSideBySide:1,filterByScheme:he.file});this.nativeHostService.setRepresentedFilename(n?.fsPath??"",{targetWindowId:i}),i===ne.vscodeWindowId&&this.provideCustomTitleContextMenu(n?.fsPath)}onBeforeShutdown({veto:e,reason:i}){if(i===1){let n=this.configurationService.getValue("window.confirmBeforeClose"),o=n==="always"||n==="keyboardOnly"&&pd.getInstance().isModifierPressed;if(o)return e((async()=>{let s=i;i===1&&!be&&await this.nativeHostService.getWindowCount()===1&&(s=2);let a=!0;return o&&(a=await this.instantiationService.invokeFunction(l=>og.confirmOnShutdown(l,s))),a&&this.progressOnBeforeShutdown(i),!a})(),"veto.confirmBeforeClose")}this.progressOnBeforeShutdown(i)}progressOnBeforeShutdown(e){this.progressService.withProgress({location:10,delay:800,title:this.toShutdownLabel(e,!1)},()=>O.toPromise(O.any(this.lifecycleService.onWillShutdown,this.lifecycleService.onShutdownVeto,this.dialogService.onWillShowDialog)))}onBeforeShutdownError({error:e,reason:i}){this.dialogService.error(this.toShutdownLabel(i,!0),h("shutdownErrorDetail","Error: {0}",lo(e)))}onWillShutdown({reason:e,force:i,joiners:n}){let o=new Et(()=>{let s=n();this.progressService.withProgress({location:20,buttons:[this.toForceShutdownLabel(e)],cancellable:!1,sticky:!0,title:this.toShutdownLabel(e,!1),detail:s.length>0?h("willShutdownDetail",`The following operations are still running: 
{0}`,s.map(a=>`- ${a.label}`).join(`
`)):void 0},()=>O.toPromise(this.lifecycleService.onDidShutdown),()=>{i()})},1200);o.schedule(),O.once(this.lifecycleService.onDidShutdown)(()=>o.dispose())}toShutdownLabel(e,i){if(i)switch(e){case 1:return h("shutdownErrorClose","An unexpected error prevented the window to close");case 2:return h("shutdownErrorQuit","An unexpected error prevented the application to quit");case 3:return h("shutdownErrorReload","An unexpected error prevented the window to reload");case 4:return h("shutdownErrorLoad","An unexpected error prevented to change the workspace")}switch(e){case 1:return h("shutdownTitleClose","Closing the window is taking a bit longer...");case 2:return h("shutdownTitleQuit","Quitting the application is taking a bit longer...");case 3:return h("shutdownTitleReload","Reloading the window is taking a bit longer...");case 4:return h("shutdownTitleLoad","Changing the workspace is taking a bit longer...")}}toForceShutdownLabel(e){switch(e){case 1:return h("shutdownForceClose","Close Anyway");case 2:return h("shutdownForceQuit","Quit Anyway");case 3:return h("shutdownForceReload","Reload Anyway");case 4:return h("shutdownForceLoad","Change Anyway")}}updateDocumentEdited(e){let i;typeof e=="boolean"?i=e:i=this.workingCopyService.hasDirty,(!this.isDocumentedEdited&&i||this.isDocumentedEdited&&!i)&&(this.isDocumentedEdited=i,this.nativeHostService.setDocumentEdited(i))}getWindowMinimumWidth(e=this.layoutService.getPanelPosition()){return e===0||e===1?Lv.WIDTH_WITH_VERTICAL_PANEL:Lv.WIDTH}onDidChangePanelPosition(e){let i=this.getWindowMinimumWidth(e);this.nativeHostService.setMinimumSize(i,void 0)}maybeCloseWindow(){if(this.configurationService.getValue("window.closeWhenEmpty")||this.nativeEnvironmentService.args.wait)for(let i of this.editorGroupService.parts)i.groups.some(n=>!n.isEmpty)||i===this.editorGroupService.mainPart&&(this.contextService.getWorkbenchState()!==1||this.environmentService.isExtensionDevelopment||this.editorService.visibleEditors.length>0)||(i===this.editorGroupService.mainPart?this.nativeHostService.closeWindow():i.removeGroup(i.activeGroup))}provideCustomTitleContextMenu(e){if(this.customTitleContextMenuDisposable.clear(),!e||Dr(this.configurationService))return;let i=e.split(Ft.sep);for(let n=i.length;n>0;n--){let o=n===i.length,s=n;o||s++;let a=q.file(i.slice(0,s).join(Ft.sep)),l;o?l=this.labelService.getUriBasenameLabel(a):l=this.labelService.getUriBasenameLabel(er(a));let d=`workbench.action.revealPathInFinder${n}`;this.customTitleContextMenuDisposable.add(En.registerCommand(d,()=>this.nativeHostService.showItemInFolder(a.fsPath))),this.customTitleContextMenuDisposable.add(Ct.appendMenuItem(ee.TitleBarTitleContext,{command:{id:d,title:l||Ft.sep},order:-n,group:"1_file"}))}}create(){this.setupOpenHandlers(),this.lifecycleService.when(2).then(()=>this.nativeHostService.notifyReady()),this.lifecycleService.when(3).then(()=>{this.sharedProcessService.notifyRestored(),this.utilityProcessWorkerWorkbenchService.notifyRestored()}),this.handleWarnings(),this.updateTouchbarMenu(),this.environmentService.enableSmokeTestDriver&&this.setupDriver()}async handleWarnings(){if(!!0&&typeof D_.hasDependencyCycle=="function"&&D_.hasDependencyCycle()&&(A_?(this.logService.error("Error: There is a dependency cycle in the AMD modules that needs to be resolved!"),this.nativeHostService.exit(37)):(this.dialogService.error(h("loaderCycle","There is a dependency cycle in the AMD modules that needs to be resolved!")),this.nativeHostService.openDevTools())),await this.lifecycleService.when(3),(async()=>{let i=await this.nativeHostService.isAdmin(),{isPure:n}=await this.integrityService.isPure();this.titleService.updateProperties({isPure:n,isAdmin:i}),i&&!rt&&this.notificationService.warn(h("runningAsRoot","It is not recommended to run {0} as root user.",this.productService.nameShort))})(),this.environmentService.isBuilt){let i;be?i=er(er(er(q.file(this.nativeEnvironmentService.appRoot)))):i=er(er(q.file(this.nativeEnvironmentService.appRoot)));for(let n of this.contextService.getWorkspace().folders)if(this.uriIdentityService.extUri.isEqualOrParent(n.uri,i)){this.bannerService.show({id:"appRootWarning.banner",message:h("appRootWarning.banner","Files you store within the installation folder ('{0}') may be OVERWRITTEN or DELETED IRREVERSIBLY without warning at update time.",this.labelService.getUriLabel(i)),icon:B.warning});break}}if(be){let i=this.nativeEnvironmentService.os.release.split(".")[0],n=new Map([["17","macOS High Sierra"],["18","macOS Mojave"]]);if(n.has(i)){let o=h("macoseolmessage","{0} on {1} will soon stop receiving updates. Consider upgrading your macOS version.",this.productService.nameLong,n.get(i));this.notificationService.prompt(ui.Warning,o,[{label:h("learnMore","Learn More"),run:()=>this.openerService.open(q.parse("https://aka.ms/vscode-faq-old-macOS"))}],{neverShowAgain:{id:"macoseol",isSecondary:!0,scope:2},priority:2,sticky:!0})}}let e=Tte.shellEnv();this.progressService.withProgress({title:h("resolveShellEnvironment","Resolving shell environment..."),location:10,delay:1600,buttons:[h("learnMore","Learn More")]},()=>e,()=>this.openerService.open("https://go.microsoft.com/fwlink/?linkid=2149667"))}setupDriver(){let e=this,i=!1;Ate(this.instantiationService,{async exitApplication(){if(i){e.logService.info("[driver] not handling exitApplication() due to pending quit() call");return}return e.logService.info("[driver] handling exitApplication()"),i=!0,e.nativeHostService.quit()}})}async openTunnel(e,i){let n=this.environmentService.remoteAuthority,o=n?{getAddress:async()=>(await this.remoteAuthorityResolverService.resolveAuthority(n)).authority}:void 0,s=await this.tunnelService.getExistingTunnel(e,i);return!s||typeof s=="string"?this.tunnelService.openTunnel(o,e,i):s}async resolveExternalUri(e,i){let n;if(i?.allowTunneling){let o=GN(e),s=kte(e);if(s&&(n=await this.openTunnel(s.address,s.port),n&&typeof n!="string")){if(n.tunnelRemotePort!==s.port)n.dispose(),n=void 0;else if(!o){let a=n;return{resolved:e,dispose:()=>a.dispose()}}}if(o){let a=await this.openTunnel(o.address,o.port);if(a&&typeof a!="string"){let l=q.parse(a.localAddress);return{resolved:l.scheme.startsWith(e.scheme)?l:e.with({authority:a.localAddress}),dispose(){a.dispose(),n&&typeof n!="string"&&n.dispose()}}}}}if(!i?.openExternal&&await this.fileService.canHandleResource(e))return{resolved:q.from({scheme:this.productService.urlProtocol,path:"workspace",query:e.toString()}),dispose(){}}}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async e=>{if(!await this.nativeHostService.openExternal(e,this.configurationService.getValue("workbench.externalBrowser"))){let n=q.parse(e);n.scheme===he.file&&await this.nativeHostService.showItemInFolder(n.fsPath)}return!0}}),this.openerService.registerExternalUriResolver({resolveExternalUri:async(e,i)=>this.resolveExternalUri(e,i)})}touchBarMenu;touchBarDisposables=this._register(new W);lastInstalledTouchedBar;updateTouchbarMenu(){if(!be)return;this.touchBarDisposables.clear(),this.touchBarMenu=void 0;let e=this.touchBarDisposables.add(new Et(()=>this.doUpdateTouchbarMenu(e),300));e.schedule()}doUpdateTouchbarMenu(e){if(!this.touchBarMenu){let d=this.editorService.activeEditorPane?.scopedContextKeyService||this.editorGroupService.activeGroup.scopedContextKeyService;this.touchBarMenu=this.menuService.createMenu(ee.TouchBarContext,d),this.touchBarDisposables.add(this.touchBarMenu),this.touchBarDisposables.add(this.touchBarMenu.onDidChange(()=>e.schedule()))}let i=[],n=this.configurationService.getValue("keyboard.touchbar.enabled")===!1,o=this.configurationService.getValue("keyboard.touchbar.ignored"),s=Array.isArray(o)?o:[];qa(this.touchBarMenu,void 0,i);let a=[],l=[];if(!n){for(let d of i)if(d instanceof po){if(s.indexOf(d.item.id)>=0)continue;l.push(d.item)}else d instanceof pt&&(l.length&&a.push(l),l=[]);l.length&&a.push(l)}$t(this.lastInstalledTouchedBar,a)||(this.lastInstalledTouchedBar=a,this.nativeHostService.updateTouchBar(a))}onAddFoldersRequest(e){this.pendingFoldersToAdd.push(...e.foldersToAdd.map(i=>q.revive(i))),this.addFoldersScheduler.isScheduled()||this.addFoldersScheduler.schedule()}doAddFolders(){let e=[];for(let i of this.pendingFoldersToAdd)e.push({uri:i});this.pendingFoldersToAdd=[],this.workspaceEditingService.addFolders(e)}async onOpenFiles(e){let i=!!(e.filesToDiff&&e.filesToDiff.length===2),n=!!(e.filesToMerge&&e.filesToMerge.length===4),o=Ei(await Ay(n?e.filesToMerge:i?e.filesToDiff:e.filesToOpenOrCreate,this.fileService,this.logService));if(o.length){let s=await this.openResources(o,i,n);if(e.filesToWait)return s.length?this.trackClosedWaitFiles(q.revive(e.filesToWait.waitMarkerFileUri),Ei(e.filesToWait.paths.map(a=>q.revive(a.fileUri)))):this.fileService.del(q.revive(e.filesToWait.waitMarkerFileUri))}}async trackClosedWaitFiles(e,i){await this.instantiationService.invokeFunction(n=>oee(n,i)),await this.fileService.del(e)}async openResources(e,i,n){let o=[];if(n&&ha(e[0])&&ha(e[1])&&ha(e[2])&&ha(e[3])){let s={input1:{resource:e[0].resource},input2:{resource:e[1].resource},base:{resource:e[2].resource},result:{resource:e[3].resource},options:{pinned:!0}};o.push(s)}else if(i&&ha(e[0])&&ha(e[1])){let s={original:{resource:e[0].resource},modified:{resource:e[1].resource},options:{pinned:!0}};o.push(s)}else o.push(...e);return this.editorService.openEditors(o,void 0,{validateTrust:!0})}mapWindowIdToZoomStatusEntry=new Map;configuredWindowZoomLevel=this.resolveConfiguredWindowZoomLevel();resolveConfiguredWindowZoomLevel(){let e=this.configurationService.getValue("window.zoomLevel");return typeof e=="number"?e:0}handleOnDidChangeZoomLevel(e){if(this.updateWindowZoomStatusEntry(e),e===ne.vscodeWindowId){let i=Wh(ne),n;this.configuredWindowZoomLevel!==i&&(n=i),un.invoke("vscode:notifyZoomLevel",n)}}createWindowZoomStatusEntry(e){let i=new W;O.once(e.onWillDispose)(()=>i.dispose());let n=this.editorGroupService.getScopedInstantiationService(e);this.mapWindowIdToZoomStatusEntry.set(e.windowId,i.add(n.createInstance(h_))),i.add(te(()=>this.mapWindowIdToZoomStatusEntry.delete(e.windowId))),this.updateWindowZoomStatusEntry(e.windowId)}updateWindowZoomStatusEntry(e){let i=Ma(e),n=this.mapWindowIdToZoomStatusEntry.get(e);if(n&&i){let o=Wh(i.window),s;o<this.configuredWindowZoomLevel?s="$(zoom-out)":o>this.configuredWindowZoomLevel&&(s="$(zoom-in)"),n.updateZoomEntry(s??!1,e)}}onDidChangeConfiguredWindowZoomLevel(){this.configuredWindowZoomLevel=this.resolveConfiguredWindowZoomLevel();let e=!1;for(let{window:i}of hd())if(Wh(i)!==this.configuredWindowZoomLevel){e=!0;break}e&&UN(this.configuredWindowZoomLevel,2);for(let[i]of this.mapWindowIdToZoomStatusEntry)this.updateWindowZoomStatusEntry(i)}dispose(){super.dispose();for(let[,e]of this.mapWindowIdToZoomStatusEntry)e.dispose()}};og=_([v(0,kt),v(1,di),v(2,de),v(3,MN),v(4,Ste),v(5,jt),v(6,ni),v(7,at),v(8,qt),v(9,yM),v(10,ai),v(11,Ri),v(12,Pn),v(13,xte),v(14,HN),v(15,zo),v(16,Xt),v(17,Os),v(18,zN),v(19,Lte),v(20,Qe),v(21,Va),v(22,af),v(23,Qn),v(24,Ud),v(25,Ar),v(26,tt),v(27,Gt),v(28,ae),v(29,c_),v(30,sf),v(31,qo),v(32,ON),v(33,_r),v(34,Ld),v(35,YN),v(36,en)],og);var h_=class extends L{constructor(e,i,n){super();this.statusbarService=e;this.commandService=i;this.keybindingService=n}disposable=this._register(new mt);zoomLevelLabel=void 0;updateZoomEntry(e,i){typeof e=="string"?(this.disposable.value||this.createZoomEntry(e),this.updateZoomLevelLabel(i)):this.disposable.clear()}createZoomEntry(e){let i=new W;this.disposable.value=i;let n=document.createElement("div");n.classList.add("zoom-status");let o=document.createElement("div");o.classList.add("zoom-status-left"),n.appendChild(o);let s=i.add(new ot("workbench.action.zoomOut",h("zoomOut","Zoom Out"),ye.asClassName(B.remove),!0,()=>this.commandService.executeCommand(s.id))),a=i.add(new ot("workbench.action.zoomIn",h("zoomIn","Zoom In"),ye.asClassName(B.plus),!0,()=>this.commandService.executeCommand(a.id))),l=i.add(new ot("workbench.action.zoomReset",h("zoomReset","Reset"),void 0,!0,()=>this.commandService.executeCommand(l.id)));l.tooltip=h("zoomResetLabel","{0} ({1})",l.label,this.keybindingService.lookupKeybinding(l.id)?.getLabel());let d=i.add(new ot("workbench.action.openSettings",h("zoomSettings","Settings"),ye.asClassName(B.settingsGear),!0,()=>this.commandService.executeCommand(d.id,"window.zoom"))),c=i.add(new ot("zoomLabel",void 0,void 0,!1));this.zoomLevelLabel=c,i.add(te(()=>this.zoomLevelLabel=void 0));let u=i.add(new gn(o,{hoverDelegate:c5}));u.push(s,{icon:!0,label:!1,keybinding:this.keybindingService.lookupKeybinding(s.id)?.getLabel()}),u.push(this.zoomLevelLabel,{icon:!1,label:!0}),u.push(a,{icon:!0,label:!1,keybinding:this.keybindingService.lookupKeybinding(a.id)?.getLabel()});let p=document.createElement("div");p.classList.add("zoom-status-right"),n.appendChild(p);let m=i.add(new gn(p,{hoverDelegate:c5}));m.push(l,{icon:!1,label:!0}),m.push(d,{icon:!0,label:!1,keybinding:this.keybindingService.lookupKeybinding(d.id)?.getLabel()});let g=h("status.windowZoom","Window Zoom");i.add(this.statusbarService.addEntry({name:g,text:e,tooltip:n,ariaLabel:g,command:zI,kind:"prominent"},"status.windowZoom",1,102))}updateZoomLevelLabel(e){if(this.zoomLevelLabel){let i=Ma(e,!0).window,n=Math.round(ap(i)*100),o=Wh(i);this.zoomLevelLabel.label=`${o}`,this.zoomLevelLabel.tooltip=h("zoomNumber","Zoom Level: {0} ({1}%)",o,n)}}};h_=_([v(0,Bs),v(1,ni),v(2,at)],h_);function m_(r){return Object.isFrozen(r)?r:u$(r)}var yi=class r{constructor(t,e,i,n,o){this._contents=t;this._keys=e;this._overrides=i;this.raw=n;this.logService=o}static createEmptyModel(t){return new r({},[],[],void 0,t)}overrideConfigurations=new Map;_rawConfiguration;get rawConfiguration(){if(!this._rawConfiguration)if(this.raw?.length){let t=this.raw.map(e=>{if(e instanceof r)return e;let i=new nl("",this.logService);return i.parseRaw(e),i.configurationModel});this._rawConfiguration=t.reduce((e,i)=>i===e?i:e.merge(i),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(t){return t?dw(this.contents,t):this.contents}inspect(t,e){let i=this;return{get value(){return m_(i.rawConfiguration.getValue(t))},get override(){return e?m_(i.rawConfiguration.getOverrideValue(t,e)):void 0},get merged(){return m_(e?i.rawConfiguration.override(e).getValue(t):i.rawConfiguration.getValue(t))},get overrides(){let n=[];for(let{contents:o,identifiers:s,keys:a}of i.rawConfiguration.overrides){let l=new r(o,a,[],void 0,i.logService).getValue(t);l!==void 0&&n.push({identifiers:s,value:l})}return n.length?m_(n):void 0}}}getOverrideValue(t,e){let i=this.getContentsForOverrideIdentifer(e);return i?t?dw(i,t):i:void 0}getKeysForOverrideIdentifier(t){let e=[];for(let i of this.overrides)i.identifiers.includes(t)&&e.push(...i.keys);return yo(e)}getAllOverrideIdentifiers(){let t=[];for(let e of this.overrides)t.push(...e.identifiers);return yo(t)}override(t){let e=this.overrideConfigurations.get(t);return e||(e=this.createOverrideConfigurationModel(t),this.overrideConfigurations.set(t,e)),e}merge(...t){let e=Cs(this.contents),i=Cs(this.overrides),n=[...this.keys],o=this.raw?.length?[...this.raw]:[this];for(let s of t)if(o.push(...s.raw?.length?s.raw:[s]),!s.isEmpty()){this.mergeContents(e,s.contents);for(let a of s.overrides){let[l]=i.filter(d=>ti(d.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=yo(l.keys)):i.push(Cs(a))}for(let a of s.keys)n.indexOf(a)===-1&&n.push(a)}return new r(e,n,i,o.every(s=>s instanceof r)?void 0:o,this.logService)}createOverrideConfigurationModel(t){let e=this.getContentsForOverrideIdentifer(t);if(!e||typeof e!="object"||!Object.keys(e).length)return this;let i={};for(let n of yo([...Object.keys(this.contents),...Object.keys(e)])){let o=this.contents[n],s=e[n];s&&(typeof o=="object"&&typeof s=="object"?(o=Cs(o),this.mergeContents(o,s)):o=s),i[n]=o}return new r(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(t,e){for(let i of Object.keys(e)){if(i in t&&Mi(t[i])&&Mi(e[i])){this.mergeContents(t[i],e[i]);continue}t[i]=Cs(e[i])}}getContentsForOverrideIdentifer(t){let e=null,i=null,n=o=>{o&&(i?this.mergeContents(i,o):i=Cs(o))};for(let o of this.overrides)o.identifiers.length===1&&o.identifiers[0]===t?e=o.contents:o.identifiers.includes(t)&&n(o.contents);return n(e),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(t,e){this.updateValue(t,e,!0)}setValue(t,e){this.updateValue(t,e,!1)}removeValue(t){let e=this.keys.indexOf(t);e!==-1&&(this.keys.splice(e,1),EG(this.contents,t),Gr.test(t)&&this.overrides.splice(this.overrides.findIndex(i=>ti(i.identifiers,Yv(t))),1))}updateValue(t,e,i){if(PB(this.contents,t,e,n=>this.logService.error(n)),i=i||this.keys.indexOf(t)===-1,i&&this.keys.push(t),Gr.test(t)){let n=Yv(t),o={identifiers:n,keys:Object.keys(this.contents[t]),contents:Tg(this.contents[t],a=>this.logService.error(a))},s=this.overrides.findIndex(a=>ti(a.identifiers,n));s!==-1?this.overrides[s]=o:this.overrides.push(o)}}},nl=class{constructor(t,e){this._name=t;this.logService=e}_raw=null;_configurationModel=null;_restrictedConfigurations=[];_parseErrors=[];get configurationModel(){return this._configurationModel||yi.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(t,e){if(!Zi(t)){let i=this.doParseContent(t);this.parseRaw(i,e)}}reparse(t){this._raw&&this.parseRaw(this._raw,t)}parseRaw(t,e){this._raw=t;let{contents:i,keys:n,overrides:o,restricted:s,hasExcludedProperties:a}=this.doParseRaw(t,e);this._configurationModel=new yi(i,n,o,a?[t]:void 0,this.logService),this._restrictedConfigurations=s||[]}doParseContent(t){let e={},i=null,n=[],o=[],s=[];function a(d){Array.isArray(n)?n.push(d):i!==null&&(n[i]=d)}let l={onObjectBegin:()=>{let d={};a(d),o.push(n),n=d,i=null},onObjectProperty:d=>{i=d},onObjectEnd:()=>{n=o.pop()},onArrayBegin:()=>{let d=[];a(d),o.push(n),n=d,i=null},onArrayEnd:()=>{n=o.pop()},onLiteralValue:a,onError:(d,c,u)=>{s.push({error:d,offset:c,length:u})}};if(t)try{VE(t,l),e=n[0]||{}}catch(d){this.logService.error(`Error while parsing settings file ${this._name}: ${d}`),this._parseErrors=[d]}return e}doParseRaw(t,e){let i=Ne.as(xi.Configuration).getConfigurationProperties(),n=this.filter(t,i,!0,e);t=n.raw;let o=Tg(t,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),s=Object.keys(t),a=this.toOverrides(t,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:o,keys:s,overrides:a,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}filter(t,e,i,n){let o=!1;if(!n?.scopes&&!n?.skipRestricted&&!n?.exclude?.length)return{raw:t,restricted:[],hasExcludedProperties:o};let s={},a=[];for(let l in t)if(Gr.test(l)&&i){let d=this.filter(t[l],e,!1,n);s[l]=d.raw,o=o||d.hasExcludedProperties,a.push(...d.restricted)}else{let d=e[l],c=d?typeof d.scope<"u"?d.scope:3:void 0;d?.restricted&&a.push(l),!n.exclude?.includes(l)&&(n.include?.includes(l)||(c===void 0||n.scopes===void 0||n.scopes.includes(c))&&!(n.skipRestricted&&d?.restricted))?s[l]=t[l]:o=!0}return{raw:s,restricted:a,hasExcludedProperties:o}}toOverrides(t,e){let i=[];for(let n of Object.keys(t))if(Gr.test(n)){let o={};for(let s in t[n])o[s]=t[n][s];i.push({identifiers:Yv(n),keys:Object.keys(o),contents:Tg(o,e)})}return i}},g_=class extends L{constructor(e,i,n,o,s){super();this.userSettingsResource=e;this.parseOptions=i;this.fileService=o;this.logService=s;this.parser=new nl(this.userSettingsResource.toString(),s),this._register(this.fileService.watch(n.dirname(this.userSettingsResource))),this._register(this.fileService.watch(this.userSettingsResource)),this._register(O.any(O.filter(this.fileService.onDidFilesChange,a=>a.contains(this.userSettingsResource)),O.filter(this.fileService.onDidRunOperation,a=>(a.isOperation(0)||a.isOperation(3)||a.isOperation(1)||a.isOperation(4))&&n.isEqual(a.resource,e)))(()=>this._onDidChange.fire()))}parser;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;async loadConfiguration(){try{let e=await this.fileService.readFile(this.userSettingsResource);return this.parser.parse(e.value.toString()||"{}",this.parseOptions),this.parser.configurationModel}catch{return yi.createEmptyModel(this.logService)}}reparse(e){return e&&(this.parseOptions=e),this.parser.reparse(this.parseOptions),this.parser.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}},f9=class{constructor(t,e,i,n,o,s,a,l,d,c,u,p,m){this.key=t;this.overrides=e;this._value=i;this.overrideIdentifiers=n;this.defaultConfiguration=o;this.policyConfiguration=s;this.applicationConfiguration=a;this.userConfiguration=l;this.localUserConfiguration=d;this.remoteUserConfiguration=c;this.workspaceConfiguration=u;this.folderConfigurationModel=p;this.memoryConfigurationModel=m}get value(){return m_(this._value)}toInspectValue(t){return t?.value!==void 0||t?.override!==void 0||t?.overrides!==void 0?t:void 0}_defaultInspectValue;get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}_policyInspectValue;get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){return this.policyInspectValue?.merged}get policy(){return this.policyInspectValue?.value!==void 0?{value:this.policyInspectValue.value}:void 0}_applicationInspectValue;get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){return this.applicationInspectValue?.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}_userInspectValue;get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}_userLocalInspectValue;get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}_userRemoteInspectValue;get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}_workspaceInspectValue;get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){return this.workspaceInspectValue?.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}_workspaceFolderInspectValue;get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){return this.workspaceFolderInspectValue?.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}_memoryInspectValue;get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}},f_=class r{constructor(t,e,i,n,o,s,a,l,d,c){this._defaultConfiguration=t;this._policyConfiguration=e;this._applicationConfiguration=i;this._localUserConfiguration=n;this._remoteUserConfiguration=o;this._workspaceConfiguration=s;this._folderConfigurations=a;this._memoryConfiguration=l;this._memoryConfigurationByResource=d;this.logService=c}_workspaceConsolidatedConfiguration=null;_foldersConsolidatedConfigurations=new Ci;getValue(t,e,i){return this.getConsolidatedConfigurationModel(t,e,i).getValue(t)}updateValue(t,e,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=yi.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,e===void 0?n.removeValue(t):n.setValue(t,e),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(t,e,i){let n=this.getConsolidatedConfigurationModel(t,e,i),o=this.getFolderConfigurationModelForResource(e.resource,i),s=e.resource?this._memoryConfigurationByResource.get(e.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(let l of n.overrides)for(let d of l.identifiers)n.getOverrideValue(t,d)!==void 0&&a.add(d);return new f9(t,e,n.getValue(t),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,o||void 0,s)}keys(t){let e=this.getFolderConfigurationModelForResource(void 0,t);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:e?e.keys.slice(0):[]}}updateDefaultConfiguration(t){this._defaultConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(t){this._policyConfiguration=t}updateApplicationConfiguration(t){this._applicationConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(t){this._localUserConfiguration=t,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(t){this._remoteUserConfiguration=t,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(t){this._workspaceConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(t,e){this._folderConfigurations.set(t,e),this._foldersConsolidatedConfigurations.delete(t)}deleteFolderConfiguration(t){this.folderConfigurations.delete(t),this._foldersConsolidatedConfigurations.delete(t)}compareAndUpdateDefaultConfiguration(t,e){let i=[];if(!e){let{added:n,updated:o,removed:s}=rg(this._defaultConfiguration,t);e=[...n,...o,...s]}for(let n of e)for(let o of Yv(n)){let s=this._defaultConfiguration.getKeysForOverrideIdentifier(o),a=t.getKeysForOverrideIdentifier(o),l=[...a.filter(d=>s.indexOf(d)===-1),...s.filter(d=>a.indexOf(d)===-1),...s.filter(d=>!$t(this._defaultConfiguration.override(o).getValue(d),t.override(o).getValue(d)))];i.push([o,l])}return this.updateDefaultConfiguration(t),{keys:e,overrides:i}}compareAndUpdatePolicyConfiguration(t){let{added:e,updated:i,removed:n}=rg(this._policyConfiguration,t),o=[...e,...i,...n];return o.length&&this.updatePolicyConfiguration(t),{keys:o,overrides:[]}}compareAndUpdateApplicationConfiguration(t){let{added:e,updated:i,removed:n,overrides:o}=rg(this.applicationConfiguration,t),s=[...e,...i,...n];return s.length&&this.updateApplicationConfiguration(t),{keys:s,overrides:o}}compareAndUpdateLocalUserConfiguration(t){let{added:e,updated:i,removed:n,overrides:o}=rg(this.localUserConfiguration,t),s=[...e,...i,...n];return s.length&&this.updateLocalUserConfiguration(t),{keys:s,overrides:o}}compareAndUpdateRemoteUserConfiguration(t){let{added:e,updated:i,removed:n,overrides:o}=rg(this.remoteUserConfiguration,t),s=[...e,...i,...n];return s.length&&this.updateRemoteUserConfiguration(t),{keys:s,overrides:o}}compareAndUpdateWorkspaceConfiguration(t){let{added:e,updated:i,removed:n,overrides:o}=rg(this.workspaceConfiguration,t),s=[...e,...i,...n];return s.length&&this.updateWorkspaceConfiguration(t),{keys:s,overrides:o}}compareAndUpdateFolderConfiguration(t,e){let i=this.folderConfigurations.get(t),{added:n,updated:o,removed:s,overrides:a}=rg(i,e),l=[...n,...o,...s];return(l.length||!i)&&this.updateFolderConfiguration(t,e),{keys:l,overrides:a}}compareAndDeleteFolderConfiguration(t){let e=this.folderConfigurations.get(t);if(!e)throw new Error("Unknown folder");this.deleteFolderConfiguration(t);let{added:i,updated:n,removed:o,overrides:s}=rg(e,void 0);return{keys:[...i,...n,...o],overrides:s}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}_userConfiguration=null;get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(t,e,i){let n=this.getConsolidatedConfigurationModelForResource(e,i);return e.overrideIdentifier&&(n=n.override(e.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(t)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:t},e){let i=this.getWorkspaceConsolidatedConfiguration();if(e&&t){let n=e.getFolder(t);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);let o=this._memoryConfigurationByResource.get(t);o&&(i=i.merge(o))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(t){let e=this._foldersConsolidatedConfigurations.get(t);if(!e){let i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(t);n?(e=i.merge(n),this._foldersConsolidatedConfigurations.set(t,e)):e=i}return e}getFolderConfigurationModelForResource(t,e){if(e&&t){let i=e.getFolder(t);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((t,e)=>{let{contents:i,overrides:n,keys:o}=this._folderConfigurations.get(e);return t.push([e,{contents:i,overrides:n,keys:o}]),t},[])}}allKeys(){let t=new Set;return this._defaultConfiguration.keys.forEach(e=>t.add(e)),this.userConfiguration.keys.forEach(e=>t.add(e)),this._workspaceConfiguration.keys.forEach(e=>t.add(e)),this._folderConfigurations.forEach(e=>e.keys.forEach(i=>t.add(i))),[...t.values()]}allOverrideIdentifiers(){let t=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(e=>t.add(e)),this.userConfiguration.getAllOverrideIdentifiers().forEach(e=>t.add(e)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(e=>t.add(e)),this._folderConfigurations.forEach(e=>e.getAllOverrideIdentifiers().forEach(i=>t.add(i))),[...t.values()]}getAllKeysForOverrideIdentifier(t){let e=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(t).forEach(i=>e.add(i)),this.userConfiguration.getKeysForOverrideIdentifier(t).forEach(i=>e.add(i)),this._workspaceConfiguration.getKeysForOverrideIdentifier(t).forEach(i=>e.add(i)),this._folderConfigurations.forEach(i=>i.getKeysForOverrideIdentifier(t).forEach(n=>e.add(n))),[...e.values()]}static parse(t,e){let i=this.parseConfigurationModel(t.defaults,e),n=this.parseConfigurationModel(t.policy,e),o=this.parseConfigurationModel(t.application,e),s=this.parseConfigurationModel(t.user,e),a=this.parseConfigurationModel(t.workspace,e),l=t.folders.reduce((d,c)=>(d.set(q.revive(c[0]),this.parseConfigurationModel(c[1],e)),d),new Ci);return new r(i,n,o,s,yi.createEmptyModel(e),a,l,yi.createEmptyModel(e),new Ci,e)}static parseConfigurationModel(t,e){return new yi(t.contents,t.keys,t.overrides,void 0,e)}};function b9(...r){if(r.length===0)return{keys:[],overrides:[]};if(r.length===1)return r[0];let t=new Set,e=new Map;for(let n of r)n.keys.forEach(o=>t.add(o)),n.overrides.forEach(([o,s])=>{let a=ql(e,o,new Set);s.forEach(l=>a.add(l))});let i=[];return e.forEach((n,o)=>i.push([o,[...n.values()]])),{keys:[...t.values()],overrides:i}}var ZN=class{constructor(t,e,i,n,o){this.change=t;this.previous=e;this.currentConfiguraiton=i;this.currentWorkspace=n;this.logService=o;for(let s of t.keys)this.affectedKeys.add(s);for(let[,s]of t.overrides)for(let a of s)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(let s of this.affectedKeys)this._affectsConfigStr+=s+this._marker}_marker=`
`;_markerCode1=this._marker.charCodeAt(0);_markerCode2=46;_affectsConfigStr;affectedKeys=new Set;source;_previousConfiguration=void 0;get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=f_.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(t,e){let i=this._marker+t,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;let o=n+i.length;if(o>=this._affectsConfigStr.length)return!1;let s=this._affectsConfigStr.charCodeAt(o);if(s!==this._markerCode1&&s!==this._markerCode2)return!1;if(e){let a=this.previousConfiguration?this.previousConfiguration.getValue(t,e,this.previous?.workspace):void 0,l=this.currentConfiguraiton.getValue(t,e,this.currentWorkspace);return!$t(a,l)}return!0}};function rg(r,t){let{added:e,removed:i,updated:n}=Pte(t?.rawConfiguration,r?.rawConfiguration),o=[],s=r?.getAllOverrideIdentifiers()||[],a=t?.getAllOverrideIdentifiers()||[];if(t){let l=a.filter(d=>!s.includes(d));for(let d of l)o.push([d,t.getKeysForOverrideIdentifier(d)])}if(r){let l=s.filter(d=>!a.includes(d));for(let d of l)o.push([d,r.getKeysForOverrideIdentifier(d)])}if(t&&r){for(let l of s)if(a.includes(l)){let d=Pte({contents:r.getOverrideValue(void 0,l)||{},keys:r.getKeysForOverrideIdentifier(l)},{contents:t.getOverrideValue(void 0,l)||{},keys:t.getKeysForOverrideIdentifier(l)});o.push([l,[...d.added,...d.removed,...d.updated]])}}return{added:e,removed:i,updated:n,overrides:o}}function Pte(r,t){let e=r?t?r.keys.filter(o=>t.keys.indexOf(o)===-1):[...r.keys]:[],i=t?r?t.keys.filter(o=>r.keys.indexOf(o)===-1):[...t.keys]:[],n=[];if(r&&t){for(let o of t.keys)if(r.keys.indexOf(o)!==-1){let s=dw(t.contents,o),a=dw(r.contents,o);$t(s,a)||n.push(o)}}return{added:e,removed:i,updated:n}}var XN=class extends L{constructor(e){super();this.logService=e}_onDidChangeConfiguration=this._register(new T);onDidChangeConfiguration=this._onDidChangeConfiguration.event;_configurationModel=yi.createEmptyModel(this.logService);get configurationModel(){return this._configurationModel}async initialize(){return this.resetConfigurationModel(),this._register(Ne.as(xi.Configuration).onDidUpdateConfiguration(({properties:e,defaultsOverrides:i})=>this.onDidUpdateConfiguration(Array.from(e),i))),this.configurationModel}reload(){return this.resetConfigurationModel(),this.configurationModel}onDidUpdateConfiguration(e,i){this.updateConfigurationModel(e,Ne.as(xi.Configuration).getConfigurationProperties()),this._onDidChangeConfiguration.fire({defaults:this.configurationModel,properties:e})}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=yi.createEmptyModel(this.logService);let e=Ne.as(xi.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,i){let n=this.getConfigurationDefaultOverrides();for(let o of e){let s=n[o],a=i[o];s!==void 0?this._configurationModel.setValue(o,s):a?this._configurationModel.setValue(o,a.default):this._configurationModel.removeValue(o)}}},QN=class{onDidChangeConfiguration=O.None;configurationModel=yi.createEmptyModel(new aL);async initialize(){return this.configurationModel}},aS=class extends L{constructor(e,i,n){super();this.defaultConfiguration=e;this.policyService=i;this.logService=n}_onDidChangeConfiguration=this._register(new T);onDidChangeConfiguration=this._onDidChangeConfiguration.event;_configurationModel=yi.createEmptyModel(this.logService);get configurationModel(){return this._configurationModel}async initialize(){return this.logService.trace("PolicyConfiguration#initialize"),this.update(await this.updatePolicyDefinitions(this.defaultConfiguration.configurationModel.keys),!1),this._register(this.policyService.onDidChange(e=>this.onDidChangePolicies(e))),this._register(this.defaultConfiguration.onDidChangeConfiguration(async({properties:e})=>this.update(await this.updatePolicyDefinitions(e),!0))),this._configurationModel}async updatePolicyDefinitions(e){this.logService.trace("PolicyConfiguration#updatePolicyDefinitions",e);let i={},n=[],o=Ne.as(xi.Configuration).getConfigurationProperties();for(let s of e){let a=o[s];if(!a){n.push(s);continue}if(a.policy){if(a.type!=="string"&&a.type!=="number"){this.logService.warn(`Policy ${a.policy.name} has unsupported type ${a.type}`);continue}n.push(s),i[a.policy.name]={type:a.type}}}return Xl(i)||await this.policyService.updatePolicyDefinitions(i),n}onDidChangePolicies(e){this.logService.trace("PolicyConfiguration#onDidChangePolicies",e);let i=Ne.as(xi.Configuration).getPolicyConfigurations(),n=Ei(e.map(o=>i.get(o)));this.update(n,!0)}update(e,i){this.logService.trace("PolicyConfiguration#update",e);let n=Ne.as(xi.Configuration).getConfigurationProperties(),o=[],s=this._configurationModel.isEmpty();for(let a of e){let l=n[a]?.policy?.name;if(l){let d=this.policyService.getPolicyValue(l);(s?d!==void 0:!$t(this._configurationModel.getValue(a),d))&&o.push([a,d])}else this._configurationModel.getValue(a)!==void 0&&o.push([a,void 0])}if(o.length){this.logService.trace("PolicyConfiguration#changed",o);let a=this._configurationModel;this._configurationModel=yi.createEmptyModel(this.logService);for(let l of a.keys)this._configurationModel.setValue(l,a.getValue(l));for(let[l,d]of o)d===void 0?this._configurationModel.removeValue(l):this._configurationModel.setValue(l,d);i&&this._onDidChangeConfiguration.fire(this._configurationModel)}}};aS=_([v(1,uL),v(2,Gt)],aS);var Ab=class extends nl{_folders=[];_transient=!1;_settingsModelParser;_launchModel;_tasksModel;constructor(t,e){super(t,e),this._settingsModelParser=new nl(t,e),this._launchModel=yi.createEmptyModel(e),this._tasksModel=yi.createEmptyModel(e)}get folders(){return this._folders}get transient(){return this._transient}get settingsModel(){return this._settingsModelParser.configurationModel}get launchModel(){return this._launchModel}get tasksModel(){return this._tasksModel}reparseWorkspaceSettings(t){this._settingsModelParser.reparse(t)}getRestrictedWorkspaceSettings(){return this._settingsModelParser.restrictedConfigurations}doParseRaw(t,e){return this._folders=t.folders||[],this._transient=gh(t.transient)&&t.transient,this._settingsModelParser.parseRaw(t.settings,e),this._launchModel=this.createConfigurationModelFrom(t,"launch"),this._tasksModel=this.createConfigurationModelFrom(t,"tasks"),super.doParseRaw(t,e)}createConfigurationModelFrom(t,e){let i=t[e];if(i){let n=Tg(i,a=>console.error(`Conflict in settings file ${this._name}: ${a}`)),o=Object.create(null);o[e]=n;let s=Object.keys(i).map(a=>`${e}.${a}`);return new yi(o,s,[],void 0,this.logService)}return yi.createEmptyModel(this.logService)}},b_=class extends nl{constructor(e,i,n){super(e,n);this.scope=i}doParseRaw(e,i){let n=Tg(e,a=>console.error(`Conflict in settings file ${this._name}: ${a}`)),o=Object.create(null);o[this.scope]=n;let s=Object.keys(e).map(a=>`${this.scope}.${a}`);return{contents:o,keys:s,overrides:[]}}},v_=class extends f_{constructor(e,i,n,o,s,a,l,d,c,u,p){super(e,i,n,o,s,a,l,d,c,p);this._workspace=u}getValue(e,i={}){return super.getValue(e,i,this._workspace)}inspect(e,i={}){return super.inspect(e,i,this._workspace)}keys(){return super.keys(this._workspace)}compareAndDeleteFolderConfiguration(e){return this._workspace&&this._workspace.folders.length>0&&this._workspace.folders[0].uri.toString()===e.toString()?{keys:[],overrides:[]}:super.compareAndDeleteFolderConfiguration(e)}compare(e){let i=(a,l,d)=>{let c=[];return c.push(...l.filter(u=>a.indexOf(u)===-1)),c.push(...a.filter(u=>l.indexOf(u)===-1)),c.push(...a.filter(u=>l.indexOf(u)===-1?!1:$t(this.getValue(u,{overrideIdentifier:d}),e.getValue(u,{overrideIdentifier:d}))?this._workspace&&this._workspace.folders.some(p=>!$t(this.getValue(u,{resource:p.uri,overrideIdentifier:d}),e.getValue(u,{resource:p.uri,overrideIdentifier:d}))):!0)),c},n=i(this.allKeys(),e.allKeys()),o=[],s=yo([...this.allOverrideIdentifiers(),...e.allOverrideIdentifiers()]);for(let a of s){let l=i(this.getAllKeysForOverrideIdentifier(a),e.getAllKeysForOverrideIdentifier(a),a);l.length&&o.push([a,l])}return{keys:n,overrides:o}}};var JN=class extends Br{constructor(e,i){super(e);this.code=i}};var lS=class{constructor(t,e,i,n,o,s,a,l,d,c,u,p){this.remoteSettingsResource=t;this.configurationService=e;this.contextService=i;this.userDataProfileService=n;this.userDataProfilesService=o;this.fileService=s;this.textModelResolverService=a;this.textFileService=l;this.notificationService=d;this.preferencesService=c;this.editorService=u;this.uriIdentityService=p;this.queue=new Xu}_serviceBrand;queue;async writeConfiguration(t,e,i={}){let n=this.getConfigurationEditOperation(t,e,i.scopes||{});return this.queue.queue(async()=>{try{await this.doWriteConfiguration(n,i)}catch(o){if(i.donotNotifyError)throw o;await this.onError(o,n,i.scopes)}})}async doWriteConfiguration(t,e){await this.validate(t.target,t,!e.handleDirtyFile,e.scopes||{});let i=t.resource,n=await this.resolveModelReference(i);try{let o=this.getFormattingOptions(n.object.textEditorModel);await this.updateConfiguration(t,n.object.textEditorModel,o,e)}finally{n.dispose()}}async updateConfiguration(t,e,i,n){if(this.hasParseErrors(e.getValue(),t))throw this.toConfigurationEditingError(11,t.target,t);if(this.textFileService.isDirty(e.uri)&&n.handleDirtyFile)switch(n.handleDirtyFile){case"save":await this.save(e,t);break;case"revert":await this.textFileService.revert(e.uri);break}let o=this.getEdits(t,e.getValue(),i)[0];o&&this.applyEditsToBuffer(o,e)&&await this.save(e,t)}async save(t,e){try{await this.textFileService.save(t.uri,{ignoreErrorHandler:!0})}catch(i){throw i.fileOperationResult===3?this.toConfigurationEditingError(10,e.target,e):new JN(h("fsError","Error while writing to {0}. {1}",this.stringifyTarget(e.target),i.message),13)}}applyEditsToBuffer(t,e){let i=e.getPositionAt(t.offset),n=e.getPositionAt(t.offset+t.length),o=new F(i.lineNumber,i.column,n.lineNumber,n.column),s=e.getValueInRange(o);if(t.content!==s){let a=s?ey.replace(o,t.content):ey.insert(i,t.content);return e.pushEditOperations([new It(i.lineNumber,i.column,i.lineNumber,i.column)],[a],()=>[]),!0}return!1}getEdits({value:t,jsonPath:e},i,n){return e.length?I5(i,e,t,n):[{content:JSON.stringify(t,null,n.insertSpaces&&n.tabSize?" ".repeat(n.tabSize):"	"),length:i.length,offset:0}]}getFormattingOptions(t){let{insertSpaces:e,tabSize:i}=t.getOptions(),n=t.getEOL();return{insertSpaces:e,tabSize:i,eol:n}}async onError(t,e,i){switch(t.code){case 11:this.onInvalidConfigurationError(t,e);break;case 9:this.onConfigurationFileDirtyError(t,e,i);break;case 10:return this.doWriteConfiguration(e,{scopes:i,handleDirtyFile:"revert"});default:this.notificationService.error(t.message)}}onInvalidConfigurationError(t,e){let i=e.workspaceStandAloneConfigurationKey===ds?h("openTasksConfiguration","Open Tasks Configuration"):e.workspaceStandAloneConfigurationKey===jc?h("openLaunchConfiguration","Open Launch Configuration"):null;i?this.notificationService.prompt(ui.Error,t.message,[{label:i,run:()=>this.openFile(e.resource)}]):this.notificationService.prompt(ui.Error,t.message,[{label:h("open","Open Settings"),run:()=>this.openSettings(e)}])}onConfigurationFileDirtyError(t,e,i){let n=e.workspaceStandAloneConfigurationKey===ds?h("openTasksConfiguration","Open Tasks Configuration"):e.workspaceStandAloneConfigurationKey===jc?h("openLaunchConfiguration","Open Launch Configuration"):null;n?this.notificationService.prompt(ui.Error,t.message,[{label:h("saveAndRetry","Save and Retry"),run:()=>{let o=e.key?`${e.workspaceStandAloneConfigurationKey}.${e.key}`:e.workspaceStandAloneConfigurationKey;this.writeConfiguration(e.target,{key:o,value:e.value},{handleDirtyFile:"save",scopes:i})}},{label:n,run:()=>this.openFile(e.resource)}]):this.notificationService.prompt(ui.Error,t.message,[{label:h("saveAndRetry","Save and Retry"),run:()=>this.writeConfiguration(e.target,{key:e.key,value:e.value},{handleDirtyFile:"save",scopes:i})},{label:h("open","Open Settings"),run:()=>this.openSettings(e)}])}openSettings(t){let e={jsonEditor:!0};switch(t.target){case 1:this.preferencesService.openUserSettings(e);break;case 2:this.preferencesService.openRemoteSettings(e);break;case 3:this.preferencesService.openWorkspaceSettings(e);break;case 4:if(t.resource){let i=this.contextService.getWorkspaceFolder(t.resource);i&&this.preferencesService.openFolderSettings({folderUri:i.uri,jsonEditor:!0})}break}}openFile(t){this.editorService.openEditor({resource:t,options:{pinned:!0}})}toConfigurationEditingError(t,e,i){let n=this.toErrorMessage(t,e,i);return new JN(n,t)}toErrorMessage(t,e,i){switch(t){case 12:return h("errorPolicyConfiguration","Unable to write {0} because it is configured in system policy.",i.key);case 0:return h("errorUnknownKey","Unable to write to {0} because {1} is not a registered configuration.",this.stringifyTarget(e),i.key);case 1:return h("errorInvalidWorkspaceConfigurationApplication","Unable to write {0} to Workspace Settings. This setting can be written only into User settings.",i.key);case 2:return h("errorInvalidWorkspaceConfigurationMachine","Unable to write {0} to Workspace Settings. This setting can be written only into User settings.",i.key);case 3:return h("errorInvalidFolderConfiguration","Unable to write to Folder Settings because {0} does not support the folder resource scope.",i.key);case 4:return h("errorInvalidUserTarget","Unable to write to User Settings because {0} does not support for global scope.",i.key);case 5:return h("errorInvalidWorkspaceTarget","Unable to write to Workspace Settings because {0} does not support for workspace scope in a multi folder workspace.",i.key);case 6:return h("errorInvalidFolderTarget","Unable to write to Folder Settings because no resource is provided.");case 7:return h("errorInvalidResourceLanguageConfiguration","Unable to write to Language Settings because {0} is not a resource language setting.",i.key);case 8:return h("errorNoWorkspaceOpened","Unable to write to {0} because no workspace is opened. Please open a workspace first and try again.",this.stringifyTarget(e));case 11:{if(i.workspaceStandAloneConfigurationKey===ds)return h("errorInvalidTaskConfiguration","Unable to write into the tasks configuration file. Please open it to correct errors/warnings in it and try again.");if(i.workspaceStandAloneConfigurationKey===jc)return h("errorInvalidLaunchConfiguration","Unable to write into the launch configuration file. Please open it to correct errors/warnings in it and try again.");switch(e){case 1:return h("errorInvalidConfiguration","Unable to write into user settings. Please open the user settings to correct errors/warnings in it and try again.");case 2:return h("errorInvalidRemoteConfiguration","Unable to write into remote user settings. Please open the remote user settings to correct errors/warnings in it and try again.");case 3:return h("errorInvalidConfigurationWorkspace","Unable to write into workspace settings. Please open the workspace settings to correct errors/warnings in the file and try again.");case 4:{let n="<<unknown>>";if(i.resource){let o=this.contextService.getWorkspaceFolder(i.resource);o&&(n=o.name)}return h("errorInvalidConfigurationFolder","Unable to write into folder settings. Please open the '{0}' folder settings to correct errors/warnings in it and try again.",n)}default:return""}}case 9:{if(i.workspaceStandAloneConfigurationKey===ds)return h("errorTasksConfigurationFileDirty","Unable to write into tasks configuration file because the file has unsaved changes. Please save it first and then try again.");if(i.workspaceStandAloneConfigurationKey===jc)return h("errorLaunchConfigurationFileDirty","Unable to write into launch configuration file because the file has unsaved changes. Please save it first and then try again.");switch(e){case 1:return h("errorConfigurationFileDirty","Unable to write into user settings because the file has unsaved changes. Please save the user settings file first and then try again.");case 2:return h("errorRemoteConfigurationFileDirty","Unable to write into remote user settings because the file has unsaved changes. Please save the remote user settings file first and then try again.");case 3:return h("errorConfigurationFileDirtyWorkspace","Unable to write into workspace settings because the file has unsaved changes. Please save the workspace settings file first and then try again.");case 4:{let n="<<unknown>>";if(i.resource){let o=this.contextService.getWorkspaceFolder(i.resource);o&&(n=o.name)}return h("errorConfigurationFileDirtyFolder","Unable to write into folder settings because the file has unsaved changes. Please save the '{0}' folder settings file first and then try again.",n)}default:return""}}case 10:if(i.workspaceStandAloneConfigurationKey===ds)return h("errorTasksConfigurationFileModifiedSince","Unable to write into tasks configuration file because the content of the file is newer.");if(i.workspaceStandAloneConfigurationKey===jc)return h("errorLaunchConfigurationFileModifiedSince","Unable to write into launch configuration file because the content of the file is newer.");switch(e){case 1:return h("errorConfigurationFileModifiedSince","Unable to write into user settings because the content of the file is newer.");case 2:return h("errorRemoteConfigurationFileModifiedSince","Unable to write into remote user settings because the content of the file is newer.");case 3:return h("errorConfigurationFileModifiedSinceWorkspace","Unable to write into workspace settings because the content of the file is newer.");case 4:return h("errorConfigurationFileModifiedSinceFolder","Unable to write into folder settings because the content of the file is newer.")}case 13:return h("errorUnknown","Unable to write to {0} because of an internal error.",this.stringifyTarget(e))}}stringifyTarget(t){switch(t){case 1:return h("userTarget","User Settings");case 2:return h("remoteUserTarget","Remote User Settings");case 3:return h("workspaceTarget","Workspace Settings");case 4:return h("folderTarget","Folder Settings");default:return""}}defaultResourceValue(t){let e=this.uriIdentityService.extUri.basename(t);switch(e.substr(0,e.length-this.uriIdentityService.extUri.extname(t).length)){case ds:return kZ;default:return"{}"}}async resolveModelReference(t){return await this.fileService.exists(t)||await this.textFileService.write(t,this.defaultResourceValue(t),{encoding:"utf8"}),this.textModelResolverService.createModelReference(t)}hasParseErrors(t,e){if(e.workspaceStandAloneConfigurationKey&&!e.key)return!1;let i=[];return WH(t,i,{allowTrailingComma:!0,allowEmptyContent:!0}),i.length>0}async validate(t,e,i,n){if(this.configurationService.inspect(e.key).policyValue!==void 0)throw this.toConfigurationEditingError(12,t,e);let s=Ne.as(xi.Configuration).getConfigurationProperties()[e.key]?.scope;if(!e.workspaceStandAloneConfigurationKey&&this.configurationService.keys().default.indexOf(e.key)<0&&!Gr.test(e.key)&&e.value!==void 0)throw this.toConfigurationEditingError(0,t,e);if(e.workspaceStandAloneConfigurationKey&&e.workspaceStandAloneConfigurationKey!==ds&&(t===1||t===2))throw this.toConfigurationEditingError(4,t,e);if((t===3||t===4)&&this.contextService.getWorkbenchState()===1)throw this.toConfigurationEditingError(8,t,e);if(t===3&&!e.workspaceStandAloneConfigurationKey&&!Gr.test(e.key)){if(s===1)throw this.toConfigurationEditingError(1,t,e);if(s===2)throw this.toConfigurationEditingError(2,t,e)}if(t===4){if(!e.resource)throw this.toConfigurationEditingError(6,t,e);if(!e.workspaceStandAloneConfigurationKey&&!Gr.test(e.key)&&s!==void 0&&!HE.includes(s))throw this.toConfigurationEditingError(3,t,e)}if(n.overrideIdentifiers?.length&&s!==5)throw this.toConfigurationEditingError(7,t,e);if(!e.resource)throw this.toConfigurationEditingError(6,t,e);if(i&&this.textFileService.isDirty(e.resource))throw this.toConfigurationEditingError(9,t,e)}getConfigurationEditOperation(t,e,i){if(e.key){let d=t===1?KH:ZR,c=Object.keys(d);for(let u of c){let p=this.getConfigurationFileResource(t,u,d[u],i.resource,void 0);if(e.key===u){let g=this.isWorkspaceConfigurationResource(p)?[u]:[];return{key:g[g.length-1],jsonPath:g,value:e.value,resource:p??void 0,workspaceStandAloneConfigurationKey:u,target:t}}let m=`${u}.`;if(e.key.indexOf(m)===0){let g=this.isWorkspaceConfigurationResource(p)?[u,e.key.substr(m.length)]:[e.key.substr(m.length)];return{key:g[g.length-1],jsonPath:g,value:e.value,resource:p??void 0,workspaceStandAloneConfigurationKey:u,target:t}}}}let n=e.key,s=Ne.as(xi.Configuration).getConfigurationProperties()[n]?.scope,a=i.overrideIdentifiers?.length?[vk(i.overrideIdentifiers),n]:[n];if(t===1||t===2)return{key:n,jsonPath:a,value:e.value,resource:this.getConfigurationFileResource(t,n,"",null,s)??void 0,target:t};let l=this.getConfigurationFileResource(t,n,CZ,i.resource,s);return this.isWorkspaceConfigurationResource(l)&&(a=["settings",...a]),{key:n,jsonPath:a,value:e.value,resource:l??void 0,target:t}}isWorkspaceConfigurationResource(t){let e=this.contextService.getWorkspace();return!!(e.configuration&&t&&e.configuration.fsPath===t.fsPath)}getConfigurationFileResource(t,e,i,n,o){if(t===1)return e===ds?this.userDataProfileService.currentProfile.tasksResource:!this.userDataProfileService.currentProfile.isDefault&&this.configurationService.isSettingAppliedForAllProfiles(e)?this.userDataProfilesService.defaultProfile.settingsResource:this.userDataProfileService.currentProfile.settingsResource;if(t===2)return this.remoteSettingsResource;let s=this.contextService.getWorkbenchState();if(s!==1){let a=this.contextService.getWorkspace();if(t===3){if(s===3)return a.configuration??null;if(s===2)return a.folders[0].toResource(i)}if(t===4&&n){let l=this.contextService.getWorkspaceFolder(n);if(l)return l.toResource(i)}}return null}};lS=_([v(1,XR),v(2,Xt),v(3,Qa),v(4,Dv),v(5,ai),v(6,PU),v(7,qc),v(8,jt),v(9,Ld),v(10,kt),v(11,_r)],lS);var Mte=$("jsonEditingService");var eF=class r extends XN{constructor(e,i,n){super(n);this.configurationCache=e;i.options?.configurationDefaults&&this.configurationRegistry.registerDefaultConfigurations([{overrides:i.options.configurationDefaults}])}static DEFAULT_OVERRIDES_CACHE_EXISTS_KEY="DefaultOverridesCacheExists";configurationRegistry=Ne.as(xi.Configuration);cachedConfigurationDefaultsOverrides={};cacheKey={type:"defaults",key:"configurationDefaultsOverrides"};updateCache=!1;getConfigurationDefaultOverrides(){return this.cachedConfigurationDefaultsOverrides}async initialize(){return await this.initializeCachedConfigurationDefaultsOverrides(),super.initialize()}reload(){return this.updateCache=!0,this.cachedConfigurationDefaultsOverrides={},this.updateCachedConfigurationDefaultsOverrides(),super.reload()}hasCachedConfigurationDefaultsOverrides(){return!Xl(this.cachedConfigurationDefaultsOverrides)}initiaizeCachedConfigurationDefaultsOverridesPromise;initializeCachedConfigurationDefaultsOverrides(){return this.initiaizeCachedConfigurationDefaultsOverridesPromise||(this.initiaizeCachedConfigurationDefaultsOverridesPromise=(async()=>{try{if(localStorage.getItem(r.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY)){let e=await this.configurationCache.read(this.cacheKey);e&&(this.cachedConfigurationDefaultsOverrides=JSON.parse(e))}}catch{}this.cachedConfigurationDefaultsOverrides=Mi(this.cachedConfigurationDefaultsOverrides)?this.cachedConfigurationDefaultsOverrides:{}})()),this.initiaizeCachedConfigurationDefaultsOverridesPromise}onDidUpdateConfiguration(e,i){super.onDidUpdateConfiguration(e,i),i&&this.updateCachedConfigurationDefaultsOverrides()}async updateCachedConfigurationDefaultsOverrides(){if(!this.updateCache)return;let e={},i=this.configurationRegistry.getConfigurationDefaultsOverrides();for(let[n,o]of i)!Gr.test(n)&&o.value!==void 0&&(e[n]=o.value);try{Object.keys(e).length?(localStorage.setItem(r.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY,"yes"),await this.configurationCache.write(this.cacheKey,JSON.stringify(e))):(localStorage.removeItem(r.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY),await this.configurationCache.remove(this.cacheKey))}catch{}}},tF=class extends g_{_onDidChangeConfiguration=this._register(new T);onDidChangeConfiguration=this._onDidChangeConfiguration.event;reloadConfigurationScheduler;constructor(t,e,i,n){super(t.defaultProfile.settingsResource,{scopes:[1]},i.extUri,e,n),this._register(this.onDidChange(()=>this.reloadConfigurationScheduler.schedule())),this.reloadConfigurationScheduler=this._register(new Et(()=>this.loadConfiguration().then(o=>this._onDidChangeConfiguration.fire(o)),50))}async initialize(){return this.loadConfiguration()}async loadConfiguration(){let t=await super.loadConfiguration(),e=t.getValue(Dd),i=Array.isArray(e)?e:[];return this.parseOptions.include||i.length?this.reparse({...this.parseOptions,include:i}):t}},iF=class extends L{constructor(e,i,n,o,s,a){super();this.settingsResource=e;this.tasksResource=i;this.configurationParseOptions=n;this.fileService=o;this.uriIdentityService=s;this.logService=a;this.userConfiguration.value=new g_(e,this.configurationParseOptions,s.extUri,this.fileService,a),this.userConfigurationChangeDisposable.value=this.userConfiguration.value.onDidChange(()=>this.reloadConfigurationScheduler.schedule()),this.reloadConfigurationScheduler=this._register(new Et(()=>this.userConfiguration.value.loadConfiguration().then(l=>this._onDidChangeConfiguration.fire(l)),50))}_onDidChangeConfiguration=this._register(new T);onDidChangeConfiguration=this._onDidChangeConfiguration.event;userConfiguration=this._register(new mt);userConfigurationChangeDisposable=this._register(new mt);reloadConfigurationScheduler;get hasTasksLoaded(){return this.userConfiguration.value instanceof cS}async reset(e,i,n){return this.settingsResource=e,this.tasksResource=i,this.configurationParseOptions=n,this.doReset()}async doReset(e){let i=this.uriIdentityService.extUri.dirname(this.settingsResource),n=this.tasksResource?[[ds,this.tasksResource]]:[],o=new cS(i.toString(),this.settingsResource,n,this.configurationParseOptions,this.fileService,this.uriIdentityService,this.logService),s=await o.loadConfiguration(e);return this.userConfiguration.value=o,this.userConfigurationChangeDisposable.value&&(this.userConfigurationChangeDisposable.value=this.userConfiguration.value.onDidChange(()=>this.reloadConfigurationScheduler.schedule())),s}async initialize(){return this.userConfiguration.value.loadConfiguration()}async reload(e){return this.hasTasksLoaded?this.userConfiguration.value.loadConfiguration():this.doReset(e)}reparse(e){return this.configurationParseOptions={...this.configurationParseOptions,...e},this.userConfiguration.value.reparse(this.configurationParseOptions)}getRestrictedSettings(){return this.userConfiguration.value.getRestrictedSettings()}},cS=class extends L{constructor(e,i,n,o,s,a,l){super();this.settingsResource=i;this.standAloneConfigurationResources=n;this.fileService=s;this.uriIdentityService=a;this.logService=l;this.allResources=[this.settingsResource,...this.standAloneConfigurationResources.map(([,d])=>d)],this._register(Ln(...this.allResources.map(d=>Ln(this.fileService.watch(a.extUri.dirname(d)),this.fileService.watch(d))))),this._folderSettingsModelParser=new nl(e,l),this._folderSettingsParseOptions=o,this._standAloneConfigurations=[],this._cache=yi.createEmptyModel(this.logService),this._register(O.debounce(O.any(O.filter(this.fileService.onDidFilesChange,d=>this.handleFileChangesEvent(d)),O.filter(this.fileService.onDidRunOperation,d=>this.handleFileOperationEvent(d))),()=>{},100)(()=>this._onDidChange.fire()))}allResources;_folderSettingsModelParser;_folderSettingsParseOptions;_standAloneConfigurations;_cache;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;async resolveContents(e){let i=async s=>Promise.all(s.map(async a=>{try{return(await this.fileService.readFile(a,{atomic:!0})).value.toString()}catch(l){this.logService.trace(`Error while resolving configuration file '${a.toString()}': ${Nu(l)}`),l.fileOperationResult!==1&&l.fileOperationResult!==9&&this.logService.error(l)}return"{}"})),[[n],o]=await Promise.all([e?Promise.resolve([void 0]):i([this.settingsResource]),i(this.standAloneConfigurationResources.map(([,s])=>s))]);return[n,o.map((s,a)=>[this.standAloneConfigurationResources[a][0],s])]}async loadConfiguration(e){let[i,n]=await this.resolveContents(!!e);this._standAloneConfigurations=[],this._folderSettingsModelParser.parse("",this._folderSettingsParseOptions),i!==void 0&&this._folderSettingsModelParser.parse(i,this._folderSettingsParseOptions);for(let o=0;o<n.length;o++){let s=n[o][1];if(s!==void 0){let a=new b_(this.standAloneConfigurationResources[o][1].toString(),this.standAloneConfigurationResources[o][0],this.logService);a.parse(s),this._standAloneConfigurations.push(a.configurationModel)}}return this.consolidate(e),this._cache}getRestrictedSettings(){return this._folderSettingsModelParser.restrictedConfigurations}reparse(e){let i=this._folderSettingsModelParser.configurationModel.contents;return this._folderSettingsParseOptions=e,this._folderSettingsModelParser.reparse(this._folderSettingsParseOptions),$t(i,this._folderSettingsModelParser.configurationModel.contents)||this.consolidate(),this._cache}consolidate(e){this._cache=(e??this._folderSettingsModelParser.configurationModel).merge(...this._standAloneConfigurations)}handleFileChangesEvent(e){return!!(this.allResources.some(i=>e.contains(i))||this.allResources.some(i=>e.contains(this.uriIdentityService.extUri.dirname(i),2)))}handleFileOperationEvent(e){return!!((e.isOperation(0)||e.isOperation(3)||e.isOperation(1)||e.isOperation(4))&&this.allResources.some(i=>this.uriIdentityService.extUri.isEqual(e.resource,i))||e.isOperation(1)&&this.allResources.some(i=>this.uriIdentityService.extUri.isEqual(e.resource,this.uriIdentityService.extUri.dirname(i))))}},nF=class extends L{_cachedConfiguration;_fileService;_userConfiguration;_userConfigurationInitializationPromise=null;_onDidChangeConfiguration=this._register(new T);onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onDidInitialize=this._register(new T);onDidInitialize=this._onDidInitialize.event;constructor(t,e,i,n,o,s){super(),this._fileService=i,this._userConfiguration=this._cachedConfiguration=new v9(t,e,{scopes:YR},s),o.getEnvironment().then(async a=>{if(a){let l=this._register(new y_(a.settingsPath,{scopes:YR},this._fileService,n,s));this._register(l.onDidChangeConfiguration(c=>this.onDidUserConfigurationChange(c))),this._userConfigurationInitializationPromise=l.initialize();let d=await this._userConfigurationInitializationPromise;this._userConfiguration.dispose(),this._userConfiguration=l,this.onDidUserConfigurationChange(d),this._onDidInitialize.fire(d)}})}async initialize(){if(this._userConfiguration instanceof y_)return this._userConfiguration.initialize();let t=await this._userConfiguration.initialize();return this._userConfigurationInitializationPromise&&(t=await this._userConfigurationInitializationPromise,this._userConfigurationInitializationPromise=null),t}reload(){return this._userConfiguration.reload()}reparse(){return this._userConfiguration.reparse({scopes:YR})}getRestrictedSettings(){return this._userConfiguration.getRestrictedSettings()}onDidUserConfigurationChange(t){this.updateCache(),this._onDidChangeConfiguration.fire(t)}async updateCache(){if(this._userConfiguration instanceof y_){let t;try{t=await this._userConfiguration.resolveContent()}catch(e){if(e.fileOperationResult!==1)return}await this._cachedConfiguration.updateConfiguration(t)}}},y_=class extends L{constructor(e,i,n,o,s){super();this.configurationResource=e;this.fileService=n;this.uriIdentityService=o;this.logService=s;this.parser=new nl(this.configurationResource.toString(),s),this.parseOptions=i,this._register(n.onDidFilesChange(a=>this.handleFileChangesEvent(a))),this._register(n.onDidRunOperation(a=>this.handleFileOperationEvent(a))),this.reloadConfigurationScheduler=this._register(new Et(()=>this.reload().then(a=>this._onDidChangeConfiguration.fire(a)),50)),this._register(te(()=>{this.stopWatchingResource(),this.stopWatchingDirectory()}))}parser;parseOptions;reloadConfigurationScheduler;_onDidChangeConfiguration=this._register(new T);onDidChangeConfiguration=this._onDidChangeConfiguration.event;fileWatcherDisposable=this._register(new mt);directoryWatcherDisposable=this._register(new mt);watchResource(){this.fileWatcherDisposable.value=this.fileService.watch(this.configurationResource)}stopWatchingResource(){this.fileWatcherDisposable.value=void 0}watchDirectory(){let e=this.uriIdentityService.extUri.dirname(this.configurationResource);this.directoryWatcherDisposable.value=this.fileService.watch(e)}stopWatchingDirectory(){this.directoryWatcherDisposable.value=void 0}async initialize(){let e=await this.fileService.exists(this.configurationResource);return this.onResourceExists(e),this.reload()}async resolveContent(){return(await this.fileService.readFile(this.configurationResource,{atomic:!0})).value.toString()}async reload(){try{let e=await this.resolveContent();return this.parser.parse(e,this.parseOptions),this.parser.configurationModel}catch{return yi.createEmptyModel(this.logService)}}reparse(e){return this.parseOptions=e,this.parser.reparse(this.parseOptions),this.parser.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}handleFileChangesEvent(e){let i=e.contains(this.configurationResource,0);e.contains(this.configurationResource,1)?(i=!0,this.onResourceExists(!0)):e.contains(this.configurationResource,2)&&(i=!0,this.onResourceExists(!1)),i&&this.reloadConfigurationScheduler.schedule()}handleFileOperationEvent(e){(e.isOperation(0)||e.isOperation(3)||e.isOperation(1)||e.isOperation(4))&&this.uriIdentityService.extUri.isEqual(e.resource,this.configurationResource)&&this.reloadConfigurationScheduler.schedule()}onResourceExists(e){e?(this.stopWatchingDirectory(),this.watchResource()):(this.stopWatchingResource(),this.watchDirectory())}},v9=class extends L{constructor(e,i,n,o){super();this.configurationCache=i;this.key={type:"user",key:e},this.parser=new nl("CachedRemoteUserConfiguration",o),this.parseOptions=n,this.configurationModel=yi.createEmptyModel(o)}_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;key;parser;parseOptions;configurationModel;getConfigurationModel(){return this.configurationModel}initialize(){return this.reload()}reparse(e){return this.parseOptions=e,this.parser.reparse(this.parseOptions),this.configurationModel=this.parser.configurationModel,this.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}async reload(){try{let e=await this.configurationCache.read(this.key),i=JSON.parse(e);i.content&&(this.parser.parse(i.content,this.parseOptions),this.configurationModel=this.parser.configurationModel)}catch{}return this.configurationModel}async updateConfiguration(e){return e?this.configurationCache.write(this.key,JSON.stringify({content:e})):this.configurationCache.remove(this.key)}},oF=class extends L{constructor(e,i,n,o){super();this.configurationCache=e;this.fileService=i;this.uriIdentityService=n;this.logService=o;this.fileService=i,this._workspaceConfiguration=this._cachedConfiguration=new y9(e,o)}_cachedConfiguration;_workspaceConfiguration;_workspaceConfigurationDisposables=this._register(new W);_workspaceIdentifier=null;_isWorkspaceTrusted=!1;_onDidUpdateConfiguration=this._register(new T);onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;_initialized=!1;get initialized(){return this._initialized}async initialize(e,i){this._workspaceIdentifier=e,this._isWorkspaceTrusted=i,this._initialized||(this.configurationCache.needsCaching(this._workspaceIdentifier.configPath)?(this._workspaceConfiguration=this._cachedConfiguration,this.waitAndInitialize(this._workspaceIdentifier)):this.doInitialize(new dS(this.fileService,this.uriIdentityService,this.logService))),await this.reload()}async reload(){this._workspaceIdentifier&&await this._workspaceConfiguration.load(this._workspaceIdentifier,{scopes:ky,skipRestricted:this.isUntrusted()})}getFolders(){return this._workspaceConfiguration.getFolders()}setFolders(e,i){return this._workspaceIdentifier?i.write(this._workspaceIdentifier.configPath,[{path:["folders"],value:e}],!0).then(()=>this.reload()):Promise.resolve()}isTransient(){return this._workspaceConfiguration.isTransient()}getConfiguration(){return this._workspaceConfiguration.getWorkspaceSettings()}updateWorkspaceTrust(e){return this._isWorkspaceTrusted=e,this.reparseWorkspaceSettings()}reparseWorkspaceSettings(){return this._workspaceConfiguration.reparseWorkspaceSettings({scopes:ky,skipRestricted:this.isUntrusted()}),this.getConfiguration()}getRestrictedSettings(){return this._workspaceConfiguration.getRestrictedSettings()}async waitAndInitialize(e){if(await iV(e.configPath,this.fileService),!(this._workspaceConfiguration instanceof dS)){let i=this._register(new dS(this.fileService,this.uriIdentityService,this.logService));await i.load(e,{scopes:ky,skipRestricted:this.isUntrusted()}),this.doInitialize(i),this.onDidWorkspaceConfigurationChange(!1,!0)}}doInitialize(e){this._workspaceConfigurationDisposables.clear(),this._workspaceConfiguration=this._workspaceConfigurationDisposables.add(e),this._workspaceConfigurationDisposables.add(this._workspaceConfiguration.onDidChange(i=>this.onDidWorkspaceConfigurationChange(!0,!1))),this._initialized=!0}isUntrusted(){return!this._isWorkspaceTrusted}async onDidWorkspaceConfigurationChange(e,i){e&&await this.reload(),this.updateCache(),this._onDidUpdateConfiguration.fire(i)}async updateCache(){if(this._workspaceIdentifier&&this.configurationCache.needsCaching(this._workspaceIdentifier.configPath)&&this._workspaceConfiguration instanceof dS){let e=await this._workspaceConfiguration.resolveContent(this._workspaceIdentifier);await this._cachedConfiguration.updateWorkspace(this._workspaceIdentifier,e)}}},dS=class extends L{constructor(e,i,n){super();this.fileService=e;this.logService=n;this.workspaceConfigurationModelParser=new Ab("",n),this.workspaceSettings=yi.createEmptyModel(n),this._register(O.any(O.filter(this.fileService.onDidFilesChange,o=>!!this._workspaceIdentifier&&o.contains(this._workspaceIdentifier.configPath)),O.filter(this.fileService.onDidRunOperation,o=>!!this._workspaceIdentifier&&(o.isOperation(0)||o.isOperation(3)||o.isOperation(1)||o.isOperation(4))&&i.extUri.isEqual(o.resource,this._workspaceIdentifier.configPath)))(()=>this.reloadConfigurationScheduler.schedule())),this.reloadConfigurationScheduler=this._register(new Et(()=>this._onDidChange.fire(),50)),this.workspaceConfigWatcher=this._register(this.watchWorkspaceConfigurationFile())}workspaceConfigurationModelParser;workspaceSettings;_workspaceIdentifier=null;workspaceConfigWatcher;reloadConfigurationScheduler;_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;get workspaceIdentifier(){return this._workspaceIdentifier}async resolveContent(e){return(await this.fileService.readFile(e.configPath,{atomic:!0})).value.toString()}async load(e,i){(!this._workspaceIdentifier||this._workspaceIdentifier.id!==e.id)&&(this._workspaceIdentifier=e,this.workspaceConfigurationModelParser=new Ab(this._workspaceIdentifier.id,this.logService),nt(this.workspaceConfigWatcher),this.workspaceConfigWatcher=this._register(this.watchWorkspaceConfigurationFile()));let n="";try{n=await this.resolveContent(this._workspaceIdentifier)}catch(o){await this.fileService.exists(this._workspaceIdentifier.configPath)&&this.logService.error(o)}this.workspaceConfigurationModelParser.parse(n,i),this.consolidate()}getConfigurationModel(){return this.workspaceConfigurationModelParser.configurationModel}getFolders(){return this.workspaceConfigurationModelParser.folders}isTransient(){return this.workspaceConfigurationModelParser.transient}getWorkspaceSettings(){return this.workspaceSettings}reparseWorkspaceSettings(e){return this.workspaceConfigurationModelParser.reparseWorkspaceSettings(e),this.consolidate(),this.getWorkspaceSettings()}getRestrictedSettings(){return this.workspaceConfigurationModelParser.getRestrictedWorkspaceSettings()}consolidate(){this.workspaceSettings=this.workspaceConfigurationModelParser.settingsModel.merge(this.workspaceConfigurationModelParser.launchModel,this.workspaceConfigurationModelParser.tasksModel)}watchWorkspaceConfigurationFile(){return this._workspaceIdentifier?this.fileService.watch(this._workspaceIdentifier.configPath):L.None}},y9=class{constructor(t,e){this.configurationCache=t;this.logService=e;this.workspaceConfigurationModelParser=new Ab("",e),this.workspaceSettings=yi.createEmptyModel(e)}onDidChange=O.None;workspaceConfigurationModelParser;workspaceSettings;async load(t,e){try{let i=this.getKey(t),n=await this.configurationCache.read(i),o=JSON.parse(n);o.content&&(this.workspaceConfigurationModelParser=new Ab(i.key,this.logService),this.workspaceConfigurationModelParser.parse(o.content,e),this.consolidate())}catch{}}get workspaceIdentifier(){return null}getConfigurationModel(){return this.workspaceConfigurationModelParser.configurationModel}getFolders(){return this.workspaceConfigurationModelParser.folders}isTransient(){return this.workspaceConfigurationModelParser.transient}getWorkspaceSettings(){return this.workspaceSettings}reparseWorkspaceSettings(t){return this.workspaceConfigurationModelParser.reparseWorkspaceSettings(t),this.consolidate(),this.getWorkspaceSettings()}getRestrictedSettings(){return this.workspaceConfigurationModelParser.getRestrictedWorkspaceSettings()}consolidate(){this.workspaceSettings=this.workspaceConfigurationModelParser.settingsModel.merge(this.workspaceConfigurationModelParser.launchModel,this.workspaceConfigurationModelParser.tasksModel)}async updateWorkspace(t,e){try{let i=this.getKey(t);e?await this.configurationCache.write(i,JSON.stringify({content:e})):await this.configurationCache.remove(i)}catch{}}getKey(t){return{type:"workspaces",key:t.id}}},I9=class{constructor(t,e,i,n,o){this.configurationCache=n;this.logService=o;this.key={type:"folder",key:Xn(Ot(t,e).toString()).toString(16)},this._folderSettingsModelParser=new nl("CachedFolderConfiguration",o),this._folderSettingsParseOptions=i,this._standAloneConfigurations=[],this.configurationModel=yi.createEmptyModel(o)}onDidChange=O.None;_folderSettingsModelParser;_folderSettingsParseOptions;_standAloneConfigurations;configurationModel;key;async loadConfiguration(){try{let t=await this.configurationCache.read(this.key),{content:e}=JSON.parse(t.toString());if(e)for(let i of Object.keys(e))if(i===UE)this._folderSettingsModelParser.parse(e[i],this._folderSettingsParseOptions);else{let n=new b_(i,i,this.logService);n.parse(e[i]),this._standAloneConfigurations.push(n.configurationModel)}this.consolidate()}catch{}return this.configurationModel}async updateConfiguration(t,e){let i={};t&&(i[UE]=t),e.forEach(([n,o])=>{o&&(i[n]=o)}),Object.keys(i).length?await this.configurationCache.write(this.key,JSON.stringify({content:i})):await this.configurationCache.remove(this.key)}getRestrictedSettings(){return this._folderSettingsModelParser.restrictedConfigurations}reparse(t){return this._folderSettingsParseOptions=t,this._folderSettingsModelParser.reparse(this._folderSettingsParseOptions),this.consolidate(),this.configurationModel}consolidate(){this.configurationModel=this._folderSettingsModelParser.configurationModel.merge(...this._standAloneConfigurations)}getUnsupportedKeys(){return[]}},rF=class extends L{constructor(e,i,n,o,s,a,l,d,c){super();this.workspaceFolder=i;this.workbenchState=o;this.workspaceTrusted=s;this.configurationCache=c;this.scopes=3===this.workbenchState?HE:ky,this.configurationFolder=l.extUri.joinPath(i.uri,n),this.cachedFolderConfiguration=new I9(i.uri,n,{scopes:this.scopes,skipRestricted:this.isUntrusted()},c,d),e&&this.configurationCache.needsCaching(i.uri)?(this.folderConfiguration=this.cachedFolderConfiguration,iV(i.uri,a).then(()=>{this.folderConfiguration=this._register(this.createFileServiceBasedConfiguration(a,l,d)),this._register(this.folderConfiguration.onDidChange(u=>this.onDidFolderConfigurationChange())),this.onDidFolderConfigurationChange()})):(this.folderConfiguration=this._register(this.createFileServiceBasedConfiguration(a,l,d)),this._register(this.folderConfiguration.onDidChange(u=>this.onDidFolderConfigurationChange())))}_onDidChange=this._register(new T);onDidChange=this._onDidChange.event;folderConfiguration;scopes;configurationFolder;cachedFolderConfiguration;loadConfiguration(){return this.folderConfiguration.loadConfiguration()}updateWorkspaceTrust(e){return this.workspaceTrusted=e,this.reparse()}reparse(){let e=this.folderConfiguration.reparse({scopes:this.scopes,skipRestricted:this.isUntrusted()});return this.updateCache(),e}getRestrictedSettings(){return this.folderConfiguration.getRestrictedSettings()}isUntrusted(){return!this.workspaceTrusted}onDidFolderConfigurationChange(){this.updateCache(),this._onDidChange.fire()}createFileServiceBasedConfiguration(e,i,n){let o=i.extUri.joinPath(this.configurationFolder,`${UE}.json`),s=[ds,jc].map(a=>[a,i.extUri.joinPath(this.configurationFolder,`${a}.json`)]);return new cS(this.configurationFolder.toString(),o,s,{scopes:this.scopes,skipRestricted:this.isUntrusted()},e,i,n)}async updateCache(){if(this.configurationCache.needsCaching(this.configurationFolder)&&this.folderConfiguration instanceof cS){let[e,i]=await this.folderConfiguration.resolveContents();this.cachedFolderConfiguration.updateConfiguration(e,i)}}};var sF=$("workspaceTrustEnablementService"),uS=$("workspaceTrustManagementService");var Ote=$("workspaceTrustRequestService");var Nte="VSCode.ABExp.FeatureData",Fte=0;var Bte=(d=>(d.Market="X-MSEdge-Market",d.CorpNet="X-FD-Corpnet",d.ApplicationVersion="X-VSCode-AppVersion",d.Build="X-VSCode-Build",d.ClientId="X-MSEdge-ClientId",d.ExtensionName="X-VSCode-ExtensionName",d.ExtensionVersion="X-VSCode-ExtensionVersion",d.Language="X-VSCode-Language",d.TargetPopulation="X-VSCode-TargetPopulation",d))(Bte||{}),aF=class r{constructor(t,e,i,n){this.version=t;this.appName=e;this.machineId=i;this.targetPopulation=n}static trimVersionSuffix(t){let e=/\-[a-zA-Z0-9]+$/;return t.split(e)[0]}getFilterValue(t){switch(t){case"X-VSCode-AppVersion":return r.trimVersionSuffix(this.version);case"X-VSCode-Build":return this.appName;case"X-MSEdge-ClientId":return this.machineId;case"X-VSCode-Language":return rl;case"X-VSCode-ExtensionName":return"vscode-core";case"X-VSCode-ExtensionVersion":return"999999.0";case"X-VSCode-TargetPopulation":return this.targetPopulation;default:return""}}getFilters(){let t=new Map,e=Object.values(Bte);for(let i of e)t.set(i,this.getFilterValue(i));return t}};var lF=class{constructor(t,e,i,n,o,s){this.machineId=t;this.configurationService=e;this.productService=i;this.environmentService=n;this.telemetry=o;this.keyValueStorage=s;!(n.extensionTestsLocationURI!==void 0)&&i.tasConfig&&this.experimentsEnabled&&IJ(this.configurationService)===3&&(this.tasClient=this.setupTASClient());let l=this.configurationService.getValue("experiments.overrideDelay"),d=typeof l=="number"?l:0;this.overrideInitDelay=new Promise(c=>setTimeout(c,d))}_serviceBrand;tasClient;networkInitialized=!1;overrideInitDelay;get experimentsEnabled(){return!0}async getTreatment(t){await this.overrideInitDelay;let e=this.configurationService.getValue("experiments.override."+t);if(e!==void 0)return e;if(!this.tasClient||!this.experimentsEnabled)return;let i,n=await this.tasClient;return this.networkInitialized?i=n.getTreatmentVariable("vscode",t):i=await n.getTreatmentVariableAsync("vscode",t,!0),i=n.getTreatmentVariable("vscode",t),i}async setupTASClient(){let t=this.productService.quality==="stable"?"public":this.productService.quality==="exploration"?"exploration":"insider",e=new aF(this.productService.version,this.productService.nameLong,this.machineId,t),i=this.productService.tasConfig,n=new(await RH("tas-client-umd","lib/tas-client-umd.js")).ExperimentationService({filterProviders:[e],telemetry:this.telemetry,storageKey:Nte,keyValueStorage:this.keyValueStorage,assignmentContextTelemetryPropertyName:i.assignmentContextTelemetryPropertyName,telemetryEventName:i.telemetryEventName,endpoint:i.endpoint,refetchInterval:Fte});return await n.initializePromise,n.initialFetch.then(()=>this.networkInitialized=!0),n}};var w9=$("WorkbenchAssignmentService"),C9=class{constructor(t){this.memento=t;this.mementoObj=t.getMemento(-1,1)}mementoObj;async getValue(t,e){return await this.mementoObj[t]||e}setValue(t,e){this.mementoObj[t]=e,this.memento.saveMemento()}},S9=class{constructor(t,e){this.telemetryService=t;this.productService=e}_lastAssignmentContext;get assignmentContext(){return this._lastAssignmentContext?.split(";")}setSharedProperty(t,e){t===this.productService.tasConfig?.assignmentContextTelemetryPropertyName&&(this._lastAssignmentContext=e),this.telemetryService.setExperimentProperty(t,e)}postEvent(t,e){let i={};for(let[n,o]of e.entries())i[n]=o;this.telemetryService.publicLog(t,i)}},I_=class extends lF{constructor(e,i,n,o,s){super(e.machineId,n,o,s,new S9(e,o),new C9(new em("experiment.service.memento",i)));this.telemetryService=e}get experimentsEnabled(){return this.configurationService.getValue("workbench.enableExperiments")===!0}async getTreatment(e){let i=await super.getTreatment(e);return this.telemetryService.publicLog2("tasClientReadTreatmentComplete",{treatmentName:e,treatmentValue:JSON.stringify(i)}),i}async getCurrentExperiments(){if(this.tasClient&&this.experimentsEnabled)return await this.tasClient,this.telemetry?.assignmentContext}};I_=_([v(0,qt),v(1,tt),v(2,de),v(3,Qn),v(4,tr)],I_);vi(w9,I_,1);var bhe=Ne.as(xi.Configuration);bhe.registerConfiguration({...pI,properties:{"workbench.enableExperiments":{type:"boolean",description:h("workbench.enableExperiments","Fetches experiments to run from a Microsoft online service."),default:!0,scope:1,restricted:!0,tags:["usesOnlineServices"]}}});function Vte(r,t){return r.isDefault||r.useDefaultFlags?.settings?t?LZ:void 0:t?zH:DZ}var w_=class extends vD{initialized=!1},dF=class extends L{constructor({remoteAuthority:e,configurationCache:i},n,o,s,a,l,d,c,u){super();this.userDataProfileService=o;this.userDataProfilesService=s;this.fileService=a;this.remoteAgentService=l;this.uriIdentityService=d;this.logService=c;if(this.configurationRegistry=Ne.as(xi.Configuration),this.initRemoteUserConfigurationBarrier=new La,this.completeWorkspaceBarrier=new La,this.defaultConfiguration=this._register(new eF(i,n,c)),this.policyConfiguration=u instanceof fv?new QN:this._register(new aS(this.defaultConfiguration,u,c)),this.configurationCache=i,this._configuration=new v_(this.defaultConfiguration.configurationModel,this.policyConfiguration.configurationModel,yi.createEmptyModel(c),yi.createEmptyModel(c),yi.createEmptyModel(c),yi.createEmptyModel(c),new Ci,yi.createEmptyModel(c),new Ci,this.workspace,c),this.applicationConfigurationDisposables=this._register(new W),this.createApplicationConfiguration(),this.localUserConfiguration=this._register(new iF(o.currentProfile.settingsResource,o.currentProfile.tasksResource,{scopes:Vte(o.currentProfile,!!e)},a,d,c)),this.cachedFolderConfigs=new Ci,this._register(this.localUserConfiguration.onDidChangeConfiguration(p=>this.onLocalUserConfigurationChanged(p))),e){let p=this.remoteUserConfiguration=this._register(new nF(e,i,a,d,l,c));this._register(p.onDidInitialize(m=>{this._register(p.onDidChangeConfiguration(g=>this.onRemoteUserConfigurationChanged(g))),this.onRemoteUserConfigurationChanged(m),this.initRemoteUserConfigurationBarrier.open()}))}else this.initRemoteUserConfigurationBarrier.open();this.workspaceConfiguration=this._register(new oF(i,a,d,c)),this._register(this.workspaceConfiguration.onDidUpdateConfiguration(p=>{this.onWorkspaceConfigurationChanged(p).then(()=>{this.workspace.initialized=this.workspaceConfiguration.initialized,this.checkAndMarkWorkspaceComplete(p)})})),this._register(this.defaultConfiguration.onDidChangeConfiguration(({properties:p,defaults:m})=>this.onDefaultConfigurationChanged(m,p))),this._register(this.policyConfiguration.onDidChangeConfiguration(p=>this.onPolicyConfigurationChanged(p))),this._register(o.onDidChangeCurrentProfile(p=>this.onUserDataProfileChanged(p))),this.workspaceEditingQueue=new Xu}_serviceBrand;workspace;initRemoteUserConfigurationBarrier;completeWorkspaceBarrier;configurationCache;_configuration;initialized=!1;defaultConfiguration;policyConfiguration;applicationConfiguration=null;applicationConfigurationDisposables;localUserConfiguration;remoteUserConfiguration=null;workspaceConfiguration;cachedFolderConfigs;workspaceEditingQueue;_onDidChangeConfiguration=this._register(new T);onDidChangeConfiguration=this._onDidChangeConfiguration.event;_onWillChangeWorkspaceFolders=this._register(new T);onWillChangeWorkspaceFolders=this._onWillChangeWorkspaceFolders.event;_onDidChangeWorkspaceFolders=this._register(new T);onDidChangeWorkspaceFolders=this._onDidChangeWorkspaceFolders.event;_onDidChangeWorkspaceName=this._register(new T);onDidChangeWorkspaceName=this._onDidChangeWorkspaceName.event;_onDidChangeWorkbenchState=this._register(new T);onDidChangeWorkbenchState=this._onDidChangeWorkbenchState.event;isWorkspaceTrusted=!0;_restrictedSettings={default:[]};get restrictedSettings(){return this._restrictedSettings}_onDidChangeRestrictedSettings=this._register(new T);onDidChangeRestrictedSettings=this._onDidChangeRestrictedSettings.event;configurationRegistry;instantiationService;configurationEditing;createApplicationConfiguration(){this.applicationConfigurationDisposables.clear(),this.userDataProfileService.currentProfile.isDefault||this.userDataProfileService.currentProfile.useDefaultFlags?.settings?this.applicationConfiguration=null:(this.applicationConfiguration=this.applicationConfigurationDisposables.add(this._register(new tF(this.userDataProfilesService,this.fileService,this.uriIdentityService,this.logService))),this.applicationConfigurationDisposables.add(this.applicationConfiguration.onDidChangeConfiguration(e=>this.onApplicationConfigurationChanged(e))))}async getCompleteWorkspace(){return await this.completeWorkspaceBarrier.wait(),this.getWorkspace()}getWorkspace(){return this.workspace}getWorkbenchState(){return this.workspace.configuration?3:this.workspace.folders.length===1?2:1}getWorkspaceFolder(e){return this.workspace.getFolder(e)}addFolders(e,i){return this.updateFolders(e,[],i)}removeFolders(e){return this.updateFolders([],e)}async updateFolders(e,i,n){return this.workspaceEditingQueue.queue(()=>this.doUpdateFolders(e,i,n))}isInsideWorkspace(e){return!!this.getWorkspaceFolder(e)}isCurrentWorkspace(e){switch(this.getWorkbenchState()){case 2:{let i;return q.isUri(e)?i=e:dl(e)&&(i=e.uri),q.isUri(i)&&this.uriIdentityService.extUri.isEqual(i,this.workspace.folders[0].uri)}case 3:return $u(e)&&this.workspace.id===e.id}return!1}async doUpdateFolders(e,i,n){if(this.getWorkbenchState()!==3||e.length+i.length===0)return Promise.resolve(void 0);let o=!1,s=this.getWorkspace().folders,a=s.map(l=>l.raw).filter((l,d)=>QQ(l)?!this.contains(i,s[d].uri):!0);if(o=s.length!==a.length,e.length){let l=this.getWorkspace().configuration,d=this.uriIdentityService.extUri.dirname(l);s=vM(a,l,this.uriIdentityService.extUri);let c=s.map(p=>p.uri),u=[];for(let p of e){let m=p.uri;if(!this.contains(c,m)){try{if(!(await this.fileService.stat(m)).isDirectory)continue}catch{}u.push(tJ(m,!1,p.name,d,this.uriIdentityService.extUri))}}u.length>0&&(o=!0,typeof n=="number"&&n>=0&&n<a.length?(a=a.slice(0),a.splice(n,0,...u)):a=[...a,...u])}return o?this.setFolders(a):Promise.resolve(void 0)}async setFolders(e){if(!this.instantiationService)throw new Error("Cannot update workspace folders because workspace service is not yet ready to accept writes.");return await this.instantiationService.invokeFunction(i=>this.workspaceConfiguration.setFolders(e,i.get(Mte))),this.onWorkspaceConfigurationChanged(!1)}contains(e,i){return e.some(n=>this.uriIdentityService.extUri.isEqual(n,i))}getConfigurationData(){return this._configuration.toData()}getValue(e,i){let n=typeof e=="string"?e:void 0,o=ID(e)?e:ID(i)?i:void 0;return this._configuration.getValue(n,o)}async updateValue(e,i,n,o,s){let a=SG(n)?n:ID(n)?{resource:n.resource,overrideIdentifiers:n.overrideIdentifier?[n.overrideIdentifier]:void 0}:void 0,l=a?o:n,d=l?[l]:[];if(a?.overrideIdentifiers&&(a.overrideIdentifiers=yo(a.overrideIdentifiers),a.overrideIdentifiers=a.overrideIdentifiers.length?a.overrideIdentifiers:void 0),!d.length){if(a?.overrideIdentifiers&&a.overrideIdentifiers.length>1)throw new Error("Configuration Target is required while updating the value for multiple override identifiers");let c=this.inspect(e,{resource:a?.resource,overrideIdentifier:a?.overrideIdentifiers?a.overrideIdentifiers[0]:void 0});d.push(...this.deriveConfigurationTargets(e,i,c)),$t(i,c.defaultValue)&&d.length===1&&(d[0]===2||d[0]===3)&&(i=void 0)}await Vi.settled(d.map(c=>this.writeConfigurationValue(e,i,c,a,s)))}async reloadConfiguration(e){if(e===void 0){this.reloadDefaultConfiguration();let i=await this.reloadApplicationConfiguration(!0),{local:n,remote:o}=await this.reloadUserConfiguration();await this.reloadWorkspaceConfiguration(),await this.loadConfiguration(i,n,o,!0);return}if(cl(e)){await this.reloadWorkspaceFolderConfiguration(e);return}switch(e){case 7:this.reloadDefaultConfiguration();return;case 2:{let{local:i,remote:n}=await this.reloadUserConfiguration();await this.loadConfiguration(this._configuration.applicationConfiguration,i,n,!0);return}case 3:await this.reloadLocalUserConfiguration();return;case 4:await this.reloadRemoteUserConfiguration();return;case 5:case 6:await this.reloadWorkspaceConfiguration();return}}hasCachedConfigurationDefaultsOverrides(){return this.defaultConfiguration.hasCachedConfigurationDefaultsOverrides()}inspect(e,i){return this._configuration.inspect(e,i)}keys(){return this._configuration.keys()}async whenRemoteConfigurationLoaded(){await this.initRemoteUserConfigurationBarrier.wait()}async initialize(e){Dt("code/willInitWorkspaceService");let i=this.initialized;this.initialized=!1;let n=await this.createWorkspace(e);await this.updateWorkspaceAndInitializeConfiguration(n,i),this.checkAndMarkWorkspaceComplete(!1),Dt("code/didInitWorkspaceService")}updateWorkspaceTrust(e){if(this.isWorkspaceTrusted!==e){this.isWorkspaceTrusted=e;let i=this._configuration.toData(),n=[];for(let s of this.workspace.folders){let a=this.cachedFolderConfigs.get(s.uri),l;a&&(l=a.updateWorkspaceTrust(this.isWorkspaceTrusted),this._configuration.updateFolderConfiguration(s.uri,l)),n.push(l)}this.getWorkbenchState()===2?n[0]&&this._configuration.updateWorkspaceConfiguration(n[0]):this._configuration.updateWorkspaceConfiguration(this.workspaceConfiguration.updateWorkspaceTrust(this.isWorkspaceTrusted)),this.updateRestrictedSettings();let o=[];this.restrictedSettings.userLocal&&o.push(...this.restrictedSettings.userLocal),this.restrictedSettings.userRemote&&o.push(...this.restrictedSettings.userRemote),this.restrictedSettings.workspace&&o.push(...this.restrictedSettings.workspace),this.restrictedSettings.workspaceFolder?.forEach(s=>o.push(...s)),o=yo(o),o.length&&this.triggerConfigurationChange({keys:o,overrides:[]},{data:i,workspace:this.workspace},5)}}acquireInstantiationService(e){this.instantiationService=e}isSettingAppliedForAllProfiles(e){if(this.configurationRegistry.getConfigurationProperties()[e]?.scope===1)return!0;let i=this.getValue(Dd)??[];return Array.isArray(i)&&i.includes(e)}async createWorkspace(e){return $u(e)?this.createMultiFolderWorkspace(e):dl(e)?this.createSingleFolderWorkspace(e):this.createEmptyWorkspace(e)}async createMultiFolderWorkspace(e){await this.workspaceConfiguration.initialize({id:e.id,configPath:e.configPath},this.isWorkspaceTrusted);let i=e.configPath,n=vM(this.workspaceConfiguration.getFolders(),i,this.uriIdentityService.extUri),o=e.id,s=new w_(o,n,this.workspaceConfiguration.isTransient(),i,a=>this.uriIdentityService.extUri.ignorePathCasing(a));return s.initialized=this.workspaceConfiguration.initialized,s}createSingleFolderWorkspace(e){let i=new w_(e.id,[yG(e.uri)],!1,null,n=>this.uriIdentityService.extUri.ignorePathCasing(n));return i.initialized=!0,i}createEmptyWorkspace(e){let i=new w_(e.id,[],!1,null,n=>this.uriIdentityService.extUri.ignorePathCasing(n));return i.initialized=!0,Promise.resolve(i)}checkAndMarkWorkspaceComplete(e){!this.completeWorkspaceBarrier.isOpen()&&this.workspace.initialized&&(this.completeWorkspaceBarrier.open(),this.validateWorkspaceFoldersAndReload(e))}async updateWorkspaceAndInitializeConfiguration(e,i){let n=!!this.workspace,o,s,a=[];if(n?(o=this.getWorkbenchState(),s=this.workspace.configuration?this.workspace.configuration.fsPath:void 0,a=this.workspace.folders,this.workspace.update(e)):this.workspace=e,await this.initializeConfiguration(i),n){let l=this.getWorkbenchState();o&&l!==o&&this._onDidChangeWorkbenchState.fire(l);let d=this.workspace.configuration?this.workspace.configuration.fsPath:void 0;(s&&d!==s||l!==o)&&this._onDidChangeWorkspaceName.fire();let c=this.compareFolders(a,this.workspace.folders);c&&(c.added.length||c.removed.length||c.changed.length)&&(await this.handleWillChangeWorkspaceFolders(c,!1),this._onDidChangeWorkspaceFolders.fire(c))}this.localUserConfiguration.hasTasksLoaded||this._register(md(ne,()=>this.reloadLocalUserConfiguration(!1,this._configuration.localUserConfiguration)))}compareFolders(e,i){let n={added:[],removed:[],changed:[]};n.added=i.filter(o=>!e.some(s=>o.uri.toString()===s.uri.toString()));for(let o=0;o<e.length;o++){let s=e[o],a=0;for(a=0;a<i.length&&s.uri.toString()!==i[a].uri.toString();a++);a<i.length?(o!==a||s.name!==i[a].name)&&n.changed.push(s):n.removed.push(s)}return n}async initializeConfiguration(e){await this.defaultConfiguration.initialize();let i=this.policyConfiguration.initialize(),n=this.applicationConfiguration?this.applicationConfiguration.initialize():Promise.resolve(yi.createEmptyModel(this.logService)),o=async()=>{Dt("code/willInitUserConfiguration");let d=await Promise.all([this.localUserConfiguration.initialize(),this.remoteUserConfiguration?this.remoteUserConfiguration.initialize():Promise.resolve(yi.createEmptyModel(this.logService))]);if(this.applicationConfiguration){let c=await n;d[0]=this.localUserConfiguration.reparse({exclude:c.getValue(Dd)})}return Dt("code/didInitUserConfiguration"),d},[,s,[a,l]]=await Promise.all([i,n,o()]);Dt("code/willInitWorkspaceConfiguration"),await this.loadConfiguration(s,a,l,e),Dt("code/didInitWorkspaceConfiguration")}reloadDefaultConfiguration(){this.onDefaultConfigurationChanged(this.defaultConfiguration.reload())}async reloadApplicationConfiguration(e){if(!this.applicationConfiguration)return yi.createEmptyModel(this.logService);let i=await this.applicationConfiguration.loadConfiguration();return e||this.onApplicationConfigurationChanged(i),i}async reloadUserConfiguration(){let[e,i]=await Promise.all([this.reloadLocalUserConfiguration(!0),this.reloadRemoteUserConfiguration(!0)]);return{local:e,remote:i}}async reloadLocalUserConfiguration(e,i){let n=await this.localUserConfiguration.reload(i);return e||this.onLocalUserConfigurationChanged(n),n}async reloadRemoteUserConfiguration(e){if(this.remoteUserConfiguration){let i=await this.remoteUserConfiguration.reload();return e||this.onRemoteUserConfigurationChanged(i),i}return yi.createEmptyModel(this.logService)}async reloadWorkspaceConfiguration(){let e=this.getWorkbenchState();if(e===2)return this.onWorkspaceFolderConfigurationChanged(this.workspace.folders[0]);if(e===3)return this.workspaceConfiguration.reload().then(()=>this.onWorkspaceConfigurationChanged(!1))}reloadWorkspaceFolderConfiguration(e){return this.onWorkspaceFolderConfigurationChanged(e)}async loadConfiguration(e,i,n,o){this.cachedFolderConfigs=new Ci;let s=this.workspace.folders,a=await this.loadFolderConfigurations(s),l=this.getWorkspaceConfigurationModel(a),d=new Ci;a.forEach((u,p)=>d.set(s[p].uri,u));let c=this._configuration;if(this._configuration=new v_(this.defaultConfiguration.configurationModel,this.policyConfiguration.configurationModel,e,i,n,l,d,yi.createEmptyModel(this.logService),new Ci,this.workspace,this.logService),this.initialized=!0,o){let u=this._configuration.compare(c);this.triggerConfigurationChange(u,{data:c.toData(),workspace:this.workspace},5)}this.updateRestrictedSettings()}getWorkspaceConfigurationModel(e){switch(this.getWorkbenchState()){case 2:return e[0];case 3:return this.workspaceConfiguration.getConfiguration();default:return yi.createEmptyModel(this.logService)}}onUserDataProfileChanged(e){e.join((async()=>{let i=[];i.push(this.localUserConfiguration.reset(e.profile.settingsResource,e.profile.tasksResource,{scopes:Vte(e.profile,!!this.remoteUserConfiguration)})),(e.previous.isDefault!==e.profile.isDefault||!!e.previous.useDefaultFlags?.settings!=!!e.profile.useDefaultFlags?.settings)&&(this.createApplicationConfiguration(),this.applicationConfiguration&&i.push(this.reloadApplicationConfiguration(!0)));let[n,o]=await Promise.all(i);o=o??this._configuration.applicationConfiguration,this.applicationConfiguration&&(n=this.localUserConfiguration.reparse({exclude:o.getValue(Dd)})),await this.loadConfiguration(o,n,this._configuration.remoteUserConfiguration,!0)})())}onDefaultConfigurationChanged(e,i){if(this.workspace){let n=this._configuration.toData(),o=this._configuration.compareAndUpdateDefaultConfiguration(e,i);if(this.applicationConfiguration&&this._configuration.updateApplicationConfiguration(this.applicationConfiguration.reparse()),this.remoteUserConfiguration&&(this._configuration.updateLocalUserConfiguration(this.localUserConfiguration.reparse()),this._configuration.updateRemoteUserConfiguration(this.remoteUserConfiguration.reparse())),this.getWorkbenchState()===2){let s=this.cachedFolderConfigs.get(this.workspace.folders[0].uri);s&&(this._configuration.updateWorkspaceConfiguration(s.reparse()),this._configuration.updateFolderConfiguration(this.workspace.folders[0].uri,s.reparse()))}else{this._configuration.updateWorkspaceConfiguration(this.workspaceConfiguration.reparseWorkspaceSettings());for(let s of this.workspace.folders){let a=this.cachedFolderConfigs.get(s.uri);a&&this._configuration.updateFolderConfiguration(s.uri,a.reparse())}}this.triggerConfigurationChange(o,{data:n,workspace:this.workspace},7),this.updateRestrictedSettings()}}onPolicyConfigurationChanged(e){let i={data:this._configuration.toData(),workspace:this.workspace},n=this._configuration.compareAndUpdatePolicyConfiguration(e);this.triggerConfigurationChange(n,i,7)}onApplicationConfigurationChanged(e){let i={data:this._configuration.toData(),workspace:this.workspace},n=this._configuration.applicationConfiguration.getValue(Dd)??[],o=this._configuration.compareAndUpdateApplicationConfiguration(e),s=this.getValue(Dd)??[],a=this.configurationRegistry.getConfigurationProperties(),l=[];for(let d of o.keys)if(a[d]?.scope===1){if(l.push(d),d===Dd){for(let c of n)s.includes(c)||l.push(c);for(let c of s)n.includes(c)||l.push(c)}}else s.includes(d)&&l.push(d);o.keys=l,o.keys.includes(Dd)&&this._configuration.updateLocalUserConfiguration(this.localUserConfiguration.reparse({exclude:s})),this.triggerConfigurationChange(o,i,2)}onLocalUserConfigurationChanged(e){let i={data:this._configuration.toData(),workspace:this.workspace},n=this._configuration.compareAndUpdateLocalUserConfiguration(e);this.triggerConfigurationChange(n,i,2)}onRemoteUserConfigurationChanged(e){let i={data:this._configuration.toData(),workspace:this.workspace},n=this._configuration.compareAndUpdateRemoteUserConfiguration(e);this.triggerConfigurationChange(n,i,2)}async onWorkspaceConfigurationChanged(e){if(this.workspace&&this.workspace.configuration){let i=vM(this.workspaceConfiguration.getFolders(),this.workspace.configuration,this.uriIdentityService.extUri);if(this.workspace.initialized){let{added:n,removed:o,changed:s}=this.compareFolders(this.workspace.folders,i);n.length||o.length||s.length?i=await this.toValidWorkspaceFolders(i):i=this.workspace.folders}await this.updateWorkspaceConfiguration(i,this.workspaceConfiguration.getConfiguration(),e)}}updateRestrictedSettings(){let e=[],i=this.configurationRegistry.getConfigurationProperties(),n=Object.keys(i).filter(f=>i[f].restricted).sort((f,b)=>f.localeCompare(b)),o=pg(n,this._restrictedSettings.default,(f,b)=>f.localeCompare(b));e.push(...o.added,...o.removed);let s=(this.applicationConfiguration?.getRestrictedSettings()||[]).sort((f,b)=>f.localeCompare(b)),a=pg(s,this._restrictedSettings.application||[],(f,b)=>f.localeCompare(b));e.push(...a.added,...a.removed);let l=this.localUserConfiguration.getRestrictedSettings().sort((f,b)=>f.localeCompare(b)),d=pg(l,this._restrictedSettings.userLocal||[],(f,b)=>f.localeCompare(b));e.push(...d.added,...d.removed);let c=(this.remoteUserConfiguration?.getRestrictedSettings()||[]).sort((f,b)=>f.localeCompare(b)),u=pg(c,this._restrictedSettings.userRemote||[],(f,b)=>f.localeCompare(b));e.push(...u.added,...u.removed);let p=new Ci;for(let f of this.workspace.folders){let y=(this.cachedFolderConfigs.get(f.uri)?.getRestrictedSettings()||[]).sort((S,w)=>S.localeCompare(w));y.length&&p.set(f.uri,y);let I=this._restrictedSettings.workspaceFolder?.get(f.uri)||[],E=pg(y,I,(S,w)=>S.localeCompare(w));e.push(...E.added,...E.removed)}let m=this.getWorkbenchState()===3?this.workspaceConfiguration.getRestrictedSettings().sort((f,b)=>f.localeCompare(b)):this.workspace.folders[0]?p.get(this.workspace.folders[0].uri)||[]:[],g=pg(m,this._restrictedSettings.workspace||[],(f,b)=>f.localeCompare(b));e.push(...g.added,...g.removed),e.length&&(this._restrictedSettings={default:n,application:s.length?s:void 0,userLocal:l.length?l:void 0,userRemote:c.length?c:void 0,workspace:m.length?m:void 0,workspaceFolder:p.size?p:void 0},this._onDidChangeRestrictedSettings.fire(this.restrictedSettings))}async updateWorkspaceConfiguration(e,i,n){let o={data:this._configuration.toData(),workspace:this.workspace},s=this._configuration.compareAndUpdateWorkspaceConfiguration(i),a=this.compareFolders(this.workspace.folders,e);if(a.added.length||a.removed.length||a.changed.length){this.workspace.folders=e;let l=await this.onFoldersChanged();await this.handleWillChangeWorkspaceFolders(a,n),this.triggerConfigurationChange(l,o,6),this._onDidChangeWorkspaceFolders.fire(a)}else this.triggerConfigurationChange(s,o,5);this.updateRestrictedSettings()}async handleWillChangeWorkspaceFolders(e,i){let n=[];this._onWillChangeWorkspaceFolders.fire({join(o){n.push(o)},changes:e,fromCache:i});try{await Vi.settled(n)}catch{}}async onWorkspaceFolderConfigurationChanged(e){let[i]=await this.loadFolderConfigurations([e]),n={data:this._configuration.toData(),workspace:this.workspace},o=this._configuration.compareAndUpdateFolderConfiguration(e.uri,i);if(this.getWorkbenchState()===2){let s=this._configuration.compareAndUpdateWorkspaceConfiguration(i);this.triggerConfigurationChange(b9(o,s),n,5)}else this.triggerConfigurationChange(o,n,6);this.updateRestrictedSettings()}async onFoldersChanged(){let e=[];for(let n of this.cachedFolderConfigs.keys())this.workspace.folders.filter(o=>o.uri.toString()===n.toString())[0]||(this.cachedFolderConfigs.get(n).dispose(),this.cachedFolderConfigs.delete(n),e.push(this._configuration.compareAndDeleteFolderConfiguration(n)));let i=this.workspace.folders.filter(n=>!this.cachedFolderConfigs.has(n.uri));return i.length&&(await this.loadFolderConfigurations(i)).forEach((o,s)=>{e.push(this._configuration.compareAndUpdateFolderConfiguration(i[s].uri,o))}),b9(...e)}loadFolderConfigurations(e){return Promise.all([...e.map(i=>{let n=this.cachedFolderConfigs.get(i.uri);return n||(n=new rF(!this.initialized,i,WE,this.getWorkbenchState(),this.isWorkspaceTrusted,this.fileService,this.uriIdentityService,this.logService,this.configurationCache),this._register(n.onDidChange(()=>this.onWorkspaceFolderConfigurationChanged(i))),this.cachedFolderConfigs.set(i.uri,this._register(n))),n.loadConfiguration()})])}async validateWorkspaceFoldersAndReload(e){let i=await this.toValidWorkspaceFolders(this.workspace.folders),{removed:n}=this.compareFolders(this.workspace.folders,i);n.length&&await this.updateWorkspaceConfiguration(i,this.workspaceConfiguration.getConfiguration(),e)}async toValidWorkspaceFolders(e){let i=[];for(let n of e){try{if(!(await this.fileService.stat(n.uri)).isDirectory)continue}catch(o){this.logService.warn(`Ignoring the error while validating workspace folder ${n.uri.toString()} - ${lo(o)}`)}i.push(n)}return i}async writeConfigurationValue(e,i,n,o,s){if(!this.instantiationService)throw new Error("Cannot write configuration because the configuration service is not yet ready to accept writes.");if(n===7)throw new Error("Invalid configuration target");if(n===8){let l={data:this._configuration.toData(),workspace:this.workspace};this._configuration.updateValue(e,i,o),this.triggerConfigurationChange({keys:o?.overrideIdentifiers?.length?[vk(o.overrideIdentifiers),e]:[e],overrides:o?.overrideIdentifiers?.length?o.overrideIdentifiers.map(d=>[d,[e]]):[]},l,n);return}let a=this.toEditableConfigurationTarget(n,e);if(!a)throw new Error("Invalid configuration target");if(a===2&&!this.remoteUserConfiguration)throw new Error("Invalid configuration target");if(o?.overrideIdentifiers?.length&&o.overrideIdentifiers.length>1){let l=this.getConfigurationModelForEditableConfigurationTarget(a,o.resource);if(l){let d=o.overrideIdentifiers.sort(),c=l.overrides.find(u=>ti([...u.identifiers].sort(),d));c&&(o.overrideIdentifiers=c.identifiers)}}switch(this.configurationEditing=this.configurationEditing??this.createConfigurationEditingService(this.instantiationService),await(await this.configurationEditing).writeConfiguration(a,{key:e,value:i},{scopes:o,...s}),a){case 1:this.applicationConfiguration&&this.isSettingAppliedForAllProfiles(e)?await this.reloadApplicationConfiguration():await this.reloadLocalUserConfiguration();return;case 2:return this.reloadRemoteUserConfiguration().then(()=>{});case 3:return this.reloadWorkspaceConfiguration();case 4:{let l=o&&o.resource?this.workspace.getFolder(o.resource):null;if(l)return this.reloadWorkspaceFolderConfiguration(l)}}}async createConfigurationEditingService(e){let i=(await this.remoteAgentService.getEnvironment())?.settingsPath??null;return e.createInstance(lS,i)}getConfigurationModelForEditableConfigurationTarget(e,i){switch(e){case 1:return this._configuration.localUserConfiguration;case 2:return this._configuration.remoteUserConfiguration;case 3:return this._configuration.workspaceConfiguration;case 4:return i?this._configuration.folderConfigurations.get(i):void 0}}getConfigurationModel(e,i){switch(e){case 3:return this._configuration.localUserConfiguration;case 4:return this._configuration.remoteUserConfiguration;case 5:return this._configuration.workspaceConfiguration;case 6:return i?this._configuration.folderConfigurations.get(i):void 0;default:return}}deriveConfigurationTargets(e,i,n){if($t(i,n.value))return[];let o=[];return n.workspaceFolderValue!==void 0&&o.push(6),n.workspaceValue!==void 0&&o.push(5),n.userRemoteValue!==void 0&&o.push(4),n.userLocalValue!==void 0&&o.push(3),n.applicationValue!==void 0&&o.push(1),i===void 0?o:[o[0]||2]}triggerConfigurationChange(e,i,n){if(e.keys.length){n!==7&&this.logService.debug(`Configuration keys changed in ${wG(n)} target`,...e.keys);let o=new ZN(e,i,this._configuration,this.workspace,this.logService);o.source=n,this._onDidChangeConfiguration.fire(o)}}toEditableConfigurationTarget(e,i){if(e===1)return 1;if(e===2){if(this.remoteUserConfiguration){let n=this.configurationRegistry.getConfigurationProperties()[i]?.scope;if(n===2||n===6)return 2;if(this.inspect(i).userRemoteValue!==void 0)return 2}return 1}return e===3?1:e===4?2:e===5?3:e===6?4:null}},C_=class extends L{constructor(e,i,n,o,s){super();this.workspaceContextService=e;this.environmentService=i;this.workspaceTrustManagementService=n;o.whenInstalledExtensionsRegistered().then(()=>{this.registerConfigurationSchemas();let a=Ne.as(xi.Configuration),l=this._register(new bs(50));this._register(O.any(a.onDidUpdateConfiguration,a.onDidSchemaChange,n.onDidChangeTrust)(()=>l.trigger(()=>this.registerConfigurationSchemas(),s.phase===4?void 0:2500)))})}registerConfigurationSchemas(){let e={properties:ss.properties,patternProperties:ss.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},i=this.environmentService.remoteAuthority?{properties:Object.assign({},$v.properties,Ac.properties,Il.properties),patternProperties:ss.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0}:e,n={properties:Object.assign({},Hg.properties,Rc.properties,Ac.properties,Il.properties),patternProperties:ss.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},o={properties:Object.assign({},Hg.properties,Rc.properties,Ac.properties,Il.properties),patternProperties:ss.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},s={properties:Object.assign({},this.checkAndFilterPropertiesRequiringTrust(Rc.properties),this.checkAndFilterPropertiesRequiringTrust(Ac.properties),this.checkAndFilterPropertiesRequiringTrust(Il.properties)),patternProperties:ss.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},a={properties:Object.keys(ss.properties).reduce((c,u)=>(c[u]=Object.assign({deprecationMessage:void 0},ss.properties[u]),c),{}),patternProperties:Object.keys(ss.patternProperties).reduce((c,u)=>(c[u]=Object.assign({deprecationMessage:void 0},ss.patternProperties[u]),c),{}),additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},l=3===this.workspaceContextService.getWorkbenchState()?{properties:Object.assign({},this.checkAndFilterPropertiesRequiringTrust(Rc.properties),this.checkAndFilterPropertiesRequiringTrust(Il.properties)),patternProperties:ss.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0}:s,d={type:"object",description:h("configurationDefaults.description","Contribute defaults for configurations"),properties:Object.assign({},this.filterDefaultOverridableProperties(Rc.properties),this.filterDefaultOverridableProperties(Ac.properties),this.filterDefaultOverridableProperties(Il.properties)),patternProperties:{[hp]:{type:"object",default:{},$ref:pp}},additionalProperties:!1};this.registerSchemas({defaultSettingsSchema:a,userSettingsSchema:i,profileSettingsSchema:n,machineSettingsSchema:o,workspaceSettingsSchema:s,folderSettingsSchema:l,configDefaultsSchema:d})}registerSchemas(e){let i=Ne.as(nd.JSONContribution);i.registerSchema(SZ,e.defaultSettingsSchema),i.registerSchema(wZ,e.userSettingsSchema),i.registerSchema(EZ,e.profileSettingsSchema),i.registerSchema(TZ,e.machineSettingsSchema),i.registerSchema(xZ,e.workspaceSettingsSchema),i.registerSchema(_Z,e.folderSettingsSchema),i.registerSchema(b$,e.configDefaultsSchema)}checkAndFilterPropertiesRequiringTrust(e){if(this.workspaceTrustManagementService.isWorkspaceTrusted())return e;let i={};return Object.entries(e).forEach(([n,o])=>{o.restricted||(i[n]=o)}),i}filterDefaultOverridableProperties(e){let i={};return Object.entries(e).forEach(([n,o])=>{o.disallowConfigurationDefault||(i[n]=o)}),i}};C_=_([v(0,Xt),v(1,on),v(2,uS),v(3,xn),v(4,Pn)],C_);var S_=class extends L{constructor(t,e){super(),t.hasCachedConfigurationDefaultsOverrides()&&e.whenInstalledExtensionsRegistered().then(()=>t.reloadConfiguration(7))}};S_=_([v(0,de),v(1,xn)],S_);var pS=class extends L{constructor(e){super();this.workbenchAssignmentService=e;this.processExperimentalSettings(Object.keys(this.configurationRegistry.getConfigurationProperties())),this._register(this.configurationRegistry.onDidUpdateConfiguration(({properties:i})=>this.processExperimentalSettings(i)))}static ID="workbench.contrib.updateExperimentalSettingsDefaults";processedExperimentalSettings=new Set;configurationRegistry=Ne.as(xi.Configuration);async processExperimentalSettings(e){let i={},n=this.configurationRegistry.getConfigurationProperties();for(let o of e){let s=n[o];if(s?.tags?.includes("experimental")&&!this.processedExperimentalSettings.has(o)){this.processedExperimentalSettings.add(o);try{let a=await this.workbenchAssignmentService.getTreatment(`config.${o}`);!Vn(a)&&!$t(a,s.default)&&(i[o]=a)}catch{}}}Object.keys(i).length&&this.configurationRegistry.registerDefaultConfigurations([{overrides:i}])}};pS=_([v(0,w9)],pS);var Wte=Ne.as(Qh.Workbench);Wte.registerWorkbenchContribution(C_,3);Wte.registerWorkbenchContribution(S_,4);nA(pS.ID,pS,kd.BlockRestore);var vhe=Ne.as(xi.Configuration);vhe.registerConfiguration({...pI,properties:{[Dd]:{type:"array",description:h("setting description","Configure settings to be applied for all profiles."),default:[],scope:1,additionalProperties:!0,uniqueItems:!0}}});var cF=class extends L{constructor(e,i,n){super();this.channel=e;this.profile=i;this.workspace=n}async getItems(){let e={profile:this.profile,workspace:this.workspace},i=await this.channel.call("getItems",e);return new Map(i)}updateItems(e){let i={profile:this.profile,workspace:this.workspace};return e.insert&&(i.insert=Array.from(e.insert.entries())),e.delete&&(i.delete=Array.from(e.delete.values())),this.channel.call("updateItems",i)}optimize(){let e={profile:this.profile,workspace:this.workspace};return this.channel.call("optimize",e)}},uF=class extends cF{_onDidChangeItemsExternal=this._register(new T);onDidChangeItemsExternal=this._onDidChangeItemsExternal.event;constructor(t,e){super(t,e,void 0),this.registerListeners()}registerListeners(){this._register(this.channel.listen("onDidChangeStorage",{profile:this.profile})(t=>this.onDidChangeStorage(t)))}onDidChangeStorage(t){(Array.isArray(t.changed)||Array.isArray(t.deleted))&&this._onDidChangeItemsExternal.fire({changed:t.changed?new Map(t.changed):void 0,deleted:t.deleted?new Set(t.deleted):void 0})}},pF=class extends uF{constructor(t){super(t,void 0)}async close(){this.dispose()}},hF=class extends uF{constructor(t,e){super(t,e)}async close(){this.dispose()}},mF=class extends cF{onDidChangeItemsExternal=O.None;constructor(t,e){super(t,void 0,e)}async close(){this.dispose()}};var gF=class extends KE{constructor(e,i,n,o){super();this.initialWorkspace=e;this.initialProfiles=i;this.remoteService=n;this.environmentService=o}applicationStorageProfile=this.initialProfiles.defaultProfile;applicationStorage=this.createApplicationStorage();profileStorageProfile=this.initialProfiles.currentProfile;profileStorageDisposables=this._register(new W);profileStorage=this.createProfileStorage(this.profileStorageProfile);workspaceStorageId=this.initialWorkspace?.id;workspaceStorageDisposables=this._register(new W);workspaceStorage=this.createWorkspaceStorage(this.initialWorkspace);createApplicationStorage(){let e=this._register(new pF(this.remoteService.getChannel("storage"))),i=this._register(new $c(e));return this._register(i.onDidChangeStorage(n=>this.emitDidChangeValue(-1,n))),i}createProfileStorage(e){this.profileStorageDisposables.clear(),this.profileStorageProfile=e;let i;if(sA(e))i=this.applicationStorage;else{let n=this.profileStorageDisposables.add(new hF(this.remoteService.getChannel("storage"),e));i=this.profileStorageDisposables.add(new $c(n))}return this.profileStorageDisposables.add(i.onDidChangeStorage(n=>this.emitDidChangeValue(0,n))),i}createWorkspaceStorage(e){this.workspaceStorageDisposables.clear(),this.workspaceStorageId=e?.id;let i;if(e){let n=this.workspaceStorageDisposables.add(new mF(this.remoteService.getChannel("storage"),e));i=this.workspaceStorageDisposables.add(new $c(n)),this.workspaceStorageDisposables.add(i.onDidChangeStorage(o=>this.emitDidChangeValue(1,o)))}return i}async doInitialize(){await Vi.settled([this.applicationStorage.init(),this.profileStorage.init(),this.workspaceStorage?.init()??Promise.resolve()])}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}getLogDetails(e){switch(e){case-1:return this.applicationStorageProfile.globalStorageHome.with({scheme:he.file}).fsPath;case 0:return this.profileStorageProfile?.globalStorageHome.with({scheme:he.file}).fsPath;default:return this.workspaceStorageId?`${Ot(this.environmentService.workspaceStorageHome,this.workspaceStorageId,"state.vscdb").with({scheme:he.file}).fsPath}`:void 0}}async close(){this.stopFlushWhenIdle(),this.emitWillSaveState(1),await Vi.settled([this.applicationStorage.close(),this.profileStorage.close(),this.workspaceStorage?.close()??Promise.resolve()])}async switchToProfile(e){if(!this.canSwitchProfile(this.profileStorageProfile,e))return;let i=this.profileStorage,n=i.items;i!==this.applicationStorage&&await i.close(),this.profileStorage=this.createProfileStorage(e),await this.profileStorage.init(),this.switchData(n,this.profileStorage,0)}async switchToWorkspace(e,i){let n=this.workspaceStorage,o=n?.items??new Map;await n?.close(),this.workspaceStorage=this.createWorkspaceStorage(e),await this.workspaceStorage.init(),this.switchData(o,this.workspaceStorage,1)}hasScope(e){return TL(e)?this.profileStorageProfile.id===e.id:this.workspaceStorageId===e.id}};var fF=class extends gF{constructor(e,i,n,o,s){super(e,{currentProfile:i.currentProfile,defaultProfile:n.defaultProfile},o,s);this.userDataProfileService=i;this.registerListeners()}registerListeners(){this._register(this.userDataProfileService.onDidChangeCurrentProfile(e=>e.join(this.switchToProfile(e.profile))))}};var E9={request:"vscode:createSharedProcessChannelConnection",response:"vscode:createSharedProcessChannelConnectionResult"},T9={request:"vscode:createSharedProcessRawConnection",response:"vscode:createSharedProcessRawConnectionResult"};var hS=class extends L{constructor(e,i){super();this.windowId=e;this.logService=i;this.withSharedProcessConnection=this.connect()}withSharedProcessConnection;restoredBarrier=new La;async connect(){this.logService.trace("Renderer->SharedProcess#connect"),await Promise.race([this.restoredBarrier.wait(),Sn(2e3)]),Dt("code/willConnectSharedProcess"),this.logService.trace("Renderer->SharedProcess#connect: before acquirePort");let e=await u_(E9.request,E9.response);return Dt("code/didConnectSharedProcess"),this.logService.trace("Renderer->SharedProcess#connect: connection established"),this._register(new rS(e,`window:${this.windowId}`))}notifyRestored(){this.restoredBarrier.isOpen()||this.restoredBarrier.open()}getChannel(e){return aI(this.withSharedProcessConnection.then(i=>i.getChannel(e)))}registerChannel(e,i){this.withSharedProcessConnection.then(n=>n.registerChannel(e,i))}async createRawConnection(){await this.withSharedProcessConnection,this.logService.trace("Renderer->SharedProcess#createRawConnection: before acquirePort");let e=await u_(T9.request,T9.response);return this.logService.trace("Renderer->SharedProcess#createRawConnection: connection established"),e}};hS=_([v(1,Gt)],hS);var Ute="request",Hte="remoteResourceHandler";var mS=class extends L{constructor(e,i,n){super();this.windowId=e;this.fileService=n;let o={listen(s,a){throw new Error(`Event not found: ${a}`)},call:(s,a,l)=>{switch(a){case Ute:return this.doRequest(q.revive(l[0]))}throw new Error(`Call not found: ${a}`)}};i.registerChannel(Hte,o)}async doRequest(e){let i;try{let o=new URLSearchParams(e.query),s=e.with({scheme:o.get("scheme"),authority:o.get("authority"),query:""});i=await this.fileService.readFile(s)}catch(o){let s=_D(qe.fromString(o.message));return o instanceof So&&o.fileOperationResult===1?{statusCode:404,body:s}:{statusCode:500,body:s}}let n=e.path&&U$(e.path);return{statusCode:200,body:_D(i.value),mimeType:n}}getResourceUriProvider(){return e=>e.with({scheme:he.vscodeManagedRemoteResource,authority:`window:${this.windowId}`,query:new URLSearchParams({authority:e.authority,scheme:e.scheme}).toString()})}};mS=_([v(1,_u),v(2,ai)],mS);var gS=class extends L{constructor(e,i){super();this.remoteResourceLoader=i;this._resolveAuthorityRequests=new Map,this._connectionTokens=new Map,this._canonicalURIRequests=new Map,this._canonicalURIProvider=null,Jl.setServerRootPath(e,void 0)}_onDidChangeConnectionData=this._register(new T);onDidChangeConnectionData=this._onDidChangeConnectionData.event;_resolveAuthorityRequests;_connectionTokens;_canonicalURIRequests;_canonicalURIProvider;resolveAuthority(e){return this._resolveAuthorityRequests.has(e)||this._resolveAuthorityRequests.set(e,new xr),this._resolveAuthorityRequests.get(e).p}async getCanonicalURI(e){let i=e.toString(),n=this._canonicalURIRequests.get(i);if(n)return n.result.p;let o=new xr;return this._canonicalURIProvider?.(e).then(s=>o.complete(s),s=>o.error(s)),this._canonicalURIRequests.set(i,{input:e,result:o}),o.p}getConnectionData(e){if(!this._resolveAuthorityRequests.has(e))return null;let i=this._resolveAuthorityRequests.get(e);if(!i.isResolved)return null;let n=this._connectionTokens.get(e);return{connectTo:i.value.authority.connectTo,connectionToken:n}}_clearResolvedAuthority(e){this._resolveAuthorityRequests.has(e)&&(this._resolveAuthorityRequests.get(e).cancel(),this._resolveAuthorityRequests.delete(e))}_setResolvedAuthority(e,i){if(this._resolveAuthorityRequests.has(e.authority)){let n=this._resolveAuthorityRequests.get(e.authority);e.connectTo.type===0?Jl.set(e.authority,e.connectTo.host,e.connectTo.port):Jl.setDelegate(this.remoteResourceLoader.getResourceUriProvider()),e.connectionToken&&Jl.setConnectionToken(e.authority,e.connectionToken),n.complete({authority:e,options:i}),this._onDidChangeConnectionData.fire()}}_setResolvedAuthorityError(e,i){this._resolveAuthorityRequests.has(e)&&this._resolveAuthorityRequests.get(e).error(Br.fromError(i))}_setAuthorityConnectionToken(e,i){this._connectionTokens.set(e,i),Jl.setConnectionToken(e,i),this._onDidChangeConnectionData.fire()}_setCanonicalURIProvider(e){this._canonicalURIProvider=e,this._canonicalURIRequests.forEach(({result:i,input:n})=>{this._canonicalURIProvider(n).then(o=>i.complete(o),o=>i.error(o))})}};gS=_([v(0,Qn)],gS);var Du=class{static async getEnvironmentData(t,e,i){let n={remoteAuthority:e,profile:i},o=await t.call("getEnvironmentData",n);return{pid:o.pid,connectionToken:o.connectionToken,appRoot:q.revive(o.appRoot),settingsPath:q.revive(o.settingsPath),logsPath:q.revive(o.logsPath),extensionHostLogsPath:q.revive(o.extensionHostLogsPath),globalStorageHome:q.revive(o.globalStorageHome),workspaceStorageHome:q.revive(o.workspaceStorageHome),localHistoryHome:q.revive(o.localHistoryHome),userHome:q.revive(o.userHome),os:o.os,arch:o.arch,marks:o.marks,useHostProxy:o.useHostProxy,profiles:Jh(o.profiles),isUnsupportedGlibc:o.isUnsupportedGlibc}}static async getExtensionHostExitInfo(t,e,i){let n={remoteAuthority:e,reconnectionToken:i};return t.call("getExtensionHostExitInfo",n)}static getDiagnosticInfo(t,e){return t.call("getDiagnosticInfo",e)}static updateTelemetryLevel(t,e){return t.call("updateTelemetryLevel",{telemetryLevel:e})}static logTelemetry(t,e,i){return t.call("logTelemetry",{eventName:e,data:i})}static flushTelemetry(t){return t.call("flushTelemetry")}static async ping(t){await t.call("ping")}};var fS=class extends L{constructor(e,i,n,o,s,a,l){super();this.remoteSocketFactoryService=e;this.userDataProfileService=i;this._environmentService=n;this._remoteAuthorityResolverService=s;this._environmentService.remoteAuthority?this._connection=this._register(new x9(this._environmentService.remoteAuthority,o.commit,o.quality,this.remoteSocketFactoryService,this._remoteAuthorityResolverService,a,l)):this._connection=null,this._environment=null}_connection;_environment;getConnection(){return this._connection}getEnvironment(){return this.getRawEnvironment().then(void 0,()=>null)}getRawEnvironment(){return this._environment||(this._environment=this._withChannel(async(e,i)=>{let n=await Du.getEnvironmentData(e,i.remoteAuthority,this.userDataProfileService.currentProfile.isDefault?void 0:this.userDataProfileService.currentProfile.id);return this._remoteAuthorityResolverService._setAuthorityConnectionToken(i.remoteAuthority,n.connectionToken),n},null)),this._environment}getExtensionHostExitInfo(e){return this._withChannel((i,n)=>Du.getExtensionHostExitInfo(i,n.remoteAuthority,e),null)}getDiagnosticInfo(e){return this._withChannel(i=>Du.getDiagnosticInfo(i,e),void 0)}updateTelemetryLevel(e){return this._withTelemetryChannel(i=>Du.updateTelemetryLevel(i,e),void 0)}logTelemetry(e,i){return this._withTelemetryChannel(n=>Du.logTelemetry(n,e,i),void 0)}flushTelemetry(){return this._withTelemetryChannel(e=>Du.flushTelemetry(e),void 0)}getRoundTripTime(){return this._withTelemetryChannel(async e=>{let i=Date.now();return await Du.ping(e),Date.now()-i},void 0)}async endConnection(){this._connection&&(await this._connection.end(),this._connection.dispose())}_withChannel(e,i){let n=this.getConnection();return n?n.withChannel("remoteextensionsenvironment",o=>e(o,n)):Promise.resolve(i)}_withTelemetryChannel(e,i){let n=this.getConnection();return n?n.withChannel("telemetry",o=>e(o,n)):Promise.resolve(i)}};fS=_([v(0,lI),v(1,Qa),v(2,on),v(3,Qn),v(4,Ud),v(5,dI),v(6,Gt)],fS);var x9=class extends L{constructor(e,i,n,o,s,a,l){super();this._commit=i;this._quality=n;this._remoteSocketFactoryService=o;this._remoteAuthorityResolverService=s;this._signService=a;this._logService=l;this.remoteAuthority=e,this._connection=null}_onReconnecting=this._register(new T);onReconnecting=this._onReconnecting.event;_onDidStateChange=this._register(new T);onDidStateChange=this._onDidStateChange.event;remoteAuthority;_connection;_initialConnectionMs;end=()=>Promise.resolve();getChannel(e){return aI(this._getOrCreateConnection().then(i=>i.getChannel(e)))}withChannel(e,i){let n=this.getChannel(e);return i(n)}registerChannel(e,i){this._getOrCreateConnection().then(n=>n.registerChannel(e,i))}async getInitialConnectionTimeMs(){try{await this._getOrCreateConnection()}catch{}return this._initialConnectionMs}_getOrCreateConnection(){return this._connection||(this._connection=this._createConnection()),this._connection}async _createConnection(){let e=!0,i={commit:this._commit,quality:this._quality,addressProvider:{getAddress:async()=>{e?e=!1:this._onReconnecting.fire(void 0);let{authority:s}=await this._remoteAuthorityResolverService.resolveAuthority(this.remoteAuthority);return{connectTo:s.connectTo,connectionToken:s.connectionToken}}},remoteSocketFactoryService:this._remoteSocketFactoryService,signService:this._signService,logService:this._logService,ipcLogger:null},n,o=Date.now();try{n=this._register(await XX(i,this.remoteAuthority,"renderer"))}finally{this._initialConnectionMs=Date.now()-o}return n.protocol.onDidDispose(()=>{n.dispose()}),this.end=()=>(n.protocol.sendDisconnect(),n.protocol.drain()),this._register(n.onDidStateChange(s=>this._onDidStateChange.fire(s))),n.client}};var bS=class extends fS{constructor(t,e,i,n,o,s,a){super(t,e,i,n,o,s,a)}};bS=_([v(0,lI),v(1,Qa),v(2,on),v(3,Qn),v(4,Ud),v(5,dI),v(6,Gt)],bS);var vS=class{constructor(t,e,i,n,o,s,a){this._remoteAgentService=t;this._remoteAuthorityResolverService=s;this._remoteAgentService.getRawEnvironment().then(void 0,l=>{if(!_l.isHandled(l)){let d=[{label:h("devTools","Open Developer Tools"),run:()=>o.openDevTools()}],c=this._getTroubleshootingURL();c&&d.push({label:h("directUrl","Open in browser"),run:()=>a.open(c,{openExternal:!0})}),e.prompt(ui.Error,h("connectionError","Failed to connect to the remote extension host server (Error: {0})",l?l.message:""),d)}})}static ID="workbench.contrib.nativeRemoteConnectionFailureNotification";_getTroubleshootingURL(){let t=this._remoteAgentService.getConnection();if(!t)return null;let e=this._remoteAuthorityResolverService.getConnectionData(t.remoteAuthority);return!e||e.connectTo.type!==0?null:q.from({scheme:"http",authority:`${e.connectTo.host}:${e.connectTo.port}`,path:"/version"})}};vS=_([v(0,vm),v(1,jt),v(2,on),v(3,qt),v(4,zN),v(5,Ud),v(6,Os)],vS);nA(vS.ID,vS,kd.BlockRestore);async function Kte(r,t,e,i,n,o){let s;try{await yhe(r,t,e,i,n,o)}catch(a){s=a}finally{s&&n.errorTransformer&&(s=n.errorTransformer(s)),typeof s<"u"&&e.error(s),e.end()}}async function yhe(r,t,e,i,n,o){_9(o);let s=await r.open(t,{create:!1});try{_9(o);let a=0,l=0,d=n&&typeof n.length=="number"?n.length:void 0,c=qe.alloc(Math.min(n.bufferSize,typeof d=="number"?d:n.bufferSize)),u=n&&typeof n.position=="number"?n.position:0,p=0;do l=await r.read(s,u,c.buffer,p,c.byteLength-p),u+=l,p+=l,a+=l,typeof d=="number"&&(d-=l),p===c.byteLength&&(await e.write(i(c)),c=qe.alloc(Math.min(n.bufferSize,typeof d=="number"?d:n.bufferSize)),p=0);while(l>0&&(typeof d!="number"||d>0)&&_9(o)&&Ihe(a,n));if(p>0){let m=p;typeof d=="number"&&(m=Math.min(p,d)),e.write(i(c.slice(0,m)))}}catch(a){throw ep(a)}finally{await r.close(s)}}function _9(r){if(r.isCancellationRequested)throw H_();return!0}function Ihe(r,t){if(typeof t?.limits?.size=="number"&&r>t.limits.size)throw Lh(h("fileTooLargeError","File is too large to open"),"EntryTooLarge");return!0}var sg=class extends L{constructor(e){super();this.logService=e}BUFFER_SIZE=256*1024;_onDidChangeFileSystemProviderRegistrations=this._register(new T);onDidChangeFileSystemProviderRegistrations=this._onDidChangeFileSystemProviderRegistrations.event;_onWillActivateFileSystemProvider=this._register(new T);onWillActivateFileSystemProvider=this._onWillActivateFileSystemProvider.event;_onDidChangeFileSystemProviderCapabilities=this._register(new T);onDidChangeFileSystemProviderCapabilities=this._onDidChangeFileSystemProviderCapabilities.event;provider=new Map;registerProvider(e,i){if(this.provider.has(e))throw new Error(`A filesystem provider for the scheme '${e}' is already registered.`);Dt(`code/registerFilesystem/${e}`);let n=new W;return this.provider.set(e,i),this._onDidChangeFileSystemProviderRegistrations.fire({added:!0,scheme:e,provider:i}),n.add(i.onDidChangeFile(o=>{let s=new GD(o,!this.isPathCaseSensitive(i));this.internalOnDidFilesChange.fire(s),s.hasCorrelation()||this._onDidUncorrelatedFilesChange.fire(s)})),typeof i.onDidWatchError=="function"&&n.add(i.onDidWatchError(o=>this._onDidWatchError.fire(new Error(o)))),n.add(i.onDidChangeCapabilities(()=>this._onDidChangeFileSystemProviderCapabilities.fire({provider:i,scheme:e}))),te(()=>{this._onDidChangeFileSystemProviderRegistrations.fire({added:!1,scheme:e,provider:i}),this.provider.delete(e),nt(n)})}getProvider(e){return this.provider.get(e)}async activateProvider(e){let i=[];this._onWillActivateFileSystemProvider.fire({scheme:e,join(n){i.push(n)}}),!this.provider.has(e)&&await Vi.settled(i)}async canHandleResource(e){return await this.activateProvider(e.scheme),this.hasProvider(e)}hasProvider(e){return this.provider.has(e.scheme)}hasCapability(e,i){let n=this.provider.get(e.scheme);return!!(n&&n.capabilities&i)}listCapabilities(){return Lt.map(this.provider,([e,i])=>({scheme:e,capabilities:i.capabilities}))}async withProvider(e){if(!bG(e))throw new So(h("invalidPath","Unable to resolve filesystem provider with relative file path '{0}'",this.resourceForError(e)),8);await this.activateProvider(e.scheme);let i=this.provider.get(e.scheme);if(!i){let n=new Br;throw n.message=h("noProviderFound","ENOPRO: No file system provider found for resource '{0}'",e.toString()),n}return i}async withReadProvider(e){let i=await this.withProvider(e);if(Ju(i)||ka(i)||jD(i))return i;throw new Error(`Filesystem provider for scheme '${e.scheme}' neither has FileReadWrite, FileReadStream nor FileOpenReadWriteClose capability which is needed for the read operation.`)}async withWriteProvider(e){let i=await this.withProvider(e);if(Ju(i)||ka(i))return i;throw new Error(`Filesystem provider for scheme '${e.scheme}' neither has FileReadWrite nor FileOpenReadWriteClose capability which is needed for the write operation.`)}_onDidRunOperation=this._register(new T);onDidRunOperation=this._onDidRunOperation.event;async resolve(e,i){try{return await this.doResolveFile(e,i)}catch(n){throw bw(n)==="EntryNotFound"?new So(h("fileNotFoundError","Unable to resolve nonexistent file '{0}'",this.resourceForError(e)),1):ep(n)}}async doResolveFile(e,i){let n=await this.withProvider(e),o=this.isPathCaseSensitive(n),s=i?.resolveTo,a=i?.resolveSingleChildDescendants,l=i?.resolveMetadata,d=await n.stat(e),c;return this.toFileStat(n,e,d,void 0,!!l,(u,p)=>(c||(c=_a.forUris(()=>!o),c.set(e,!0),s&&c.fill(!0,s)),c.get(u.resource)||c.findSuperstr(u.resource.with({query:null,fragment:null}))?!0:u.isDirectory&&a?p===1:!1))}async toFileStat(e,i,n,o,s,a){let{providerExtUri:l}=this.getExtUri(e),d={resource:i,name:l.basename(i),isFile:(n.type&1)!==0,isDirectory:(n.type&2)!==0,isSymbolicLink:(n.type&64)!==0,mtime:n.mtime,ctime:n.ctime,size:n.size,readonly:!!((n.permissions??0)&1)||!!(e.capabilities&2048),locked:!!((n.permissions??0)&2),etag:tV({mtime:n.mtime,size:n.size}),children:void 0};if(d.isDirectory&&a(d,o)){try{let c=await e.readdir(i),u=await Vi.settled(c.map(async([p,m])=>{try{let g=l.joinPath(i,p),f=s?await e.stat(g):{type:m};return await this.toFileStat(e,g,f,c.length,s,a)}catch(g){return this.logService.trace(g),null}}));d.children=Ei(u)}catch(c){this.logService.trace(c),d.children=[]}return d}return d}async resolveAll(e){return Vi.settled(e.map(async i=>{try{return{stat:await this.doResolveFile(i.resource,i.options),success:!0}}catch(n){return this.logService.trace(n),{stat:void 0,success:!1}}}))}async stat(e){let i=await this.withProvider(e),n=await i.stat(e);return this.toFileStat(i,e,n,void 0,!0,()=>!1)}async exists(e){let i=await this.withProvider(e);try{return!!await i.stat(e)}catch{return!1}}async canCreateFile(e,i){try{await this.doValidateCreateFile(e,i)}catch(n){return n}return!0}async doValidateCreateFile(e,i){if(!i?.overwrite&&await this.exists(e))throw new So(h("fileExists","Unable to create file '{0}' that already exists when overwrite flag is not set",this.resourceForError(e)),3,i)}async createFile(e,i=qe.fromString(""),n){await this.doValidateCreateFile(e,n);let o=await this.writeFile(e,i);return this._onDidRunOperation.fire(new Qu(e,0,o)),o}async writeFile(e,i,n){let o=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e),{providerExtUri:s}=this.getExtUri(o),a=n;if(eV(o)&&!a?.atomic){let l=o.enforceAtomicWriteFile?.(e);l&&(a={...n,atomic:l})}try{await this.validateWriteFile(o,e,a)||await this.mkdirp(o,s.dirname(e));let d;if(ka(o)&&!(i instanceof qe))if(cw(i)){let c=await LG(i,3);c.ended?d=qe.concat(c.buffer):d=c}else d=DG(i,c=>qe.concat(c),3);else d=i;!Ju(o)||ka(o)&&d instanceof qe||ka(o)&&eV(o)&&a?.atomic?await this.doWriteUnbuffered(o,e,a,d):await this.doWriteBuffered(o,e,a,d instanceof qe?xD(d):d),this._onDidRunOperation.fire(new Qu(e,4))}catch(l){throw new So(h("err.write","Unable to write file '{0}' ({1})",this.resourceForError(e),ep(l).toString()),vw(l),a)}return this.resolve(e,{resolveMetadata:!0})}async validateWriteFile(e,i,n){let o=!!n?.unlock;if(o&&!(e.capabilities&8192))throw new Error(h("writeFailedUnlockUnsupported","Unable to unlock file '{0}' because provider does not support it.",this.resourceForError(i)));if(!!n?.atomic){if(!(e.capabilities&32768))throw new Error(h("writeFailedAtomicUnsupported1","Unable to atomically write file '{0}' because provider does not support it.",this.resourceForError(i)));if(!(e.capabilities&2))throw new Error(h("writeFailedAtomicUnsupported2","Unable to atomically write file '{0}' because provider does not support unbuffered writes.",this.resourceForError(i)));if(o)throw new Error(h("writeFailedAtomicUnlock","Unable to unlock file '{0}' because atomic write is enabled.",this.resourceForError(i)))}let a;try{a=await e.stat(i)}catch{return}if(a.type&2)throw new So(h("fileIsDirectoryWriteError","Unable to write file '{0}' that is actually a directory",this.resourceForError(i)),0,n);if(this.throwIfFileIsReadonly(i,a),typeof n?.mtime=="number"&&typeof n.etag=="string"&&n.etag!==tp&&typeof a.mtime=="number"&&typeof a.size=="number"&&n.mtime<a.mtime&&n.etag!==tV({mtime:n.mtime,size:a.size}))throw new So(h("fileModifiedError","File Modified Since"),3,n);return a}async readFile(e,i,n){let o=await this.withReadProvider(e);return i?.atomic?this.doReadFileAtomic(o,e,i,n):this.doReadFile(o,e,i,n)}async doReadFileAtomic(e,i,n,o){return new Promise((s,a)=>{this.writeQueue.queueFor(i,async()=>{try{let l=await this.doReadFile(e,i,n,o);s(l)}catch(l){a(l)}},this.getExtUri(e).providerExtUri)})}async doReadFile(e,i,n,o){let s=await this.doReadFileStream(e,i,{...n,preferUnbuffered:!0},o);return{...s,value:await rv(s.value)}}async readFileStream(e,i,n){let o=await this.withReadProvider(e);return this.doReadFileStream(o,e,i,n)}async doReadFileStream(e,i,n,o){let s=new Cn(o),a=n;$D(e)&&e.enforceAtomicReadFile?.(i)&&(a={...n,atomic:!0});let l=this.validateReadFile(i,a).then(c=>c,c=>{throw s.dispose(!0),c}),d;try{return typeof a?.etag=="string"&&a.etag!==tp&&await l,a?.atomic&&$D(e)||!(Ju(e)||jD(e))||ka(e)&&a?.preferUnbuffered?d=this.readFileUnbuffered(e,i,a):jD(e)?d=this.readFileStreamed(e,i,s.token,a):d=this.readFileBuffered(e,i,s.token,a),d.on("end",()=>s.dispose()),d.on("error",()=>s.dispose()),{...await l,value:d}}catch(c){throw d&&await SD(d),this.restoreReadError(c,i,a)}}restoreReadError(e,i,n){let o=h("err.read","Unable to read file '{0}' ({1})",this.resourceForError(i),ep(e).toString());return e instanceof Dh?new Dh(o,e.stat,n):e instanceof _h?new _h(o,e.fileOperationResult,e.size,e.options):new So(o,vw(e),n)}readFileStreamed(e,i,n,o=Object.create(null)){let s=e.readFileStream(i,o,n);return NB(s,{data:a=>a instanceof qe?a:qe.wrap(a),error:a=>this.restoreReadError(a,i,o)},a=>qe.concat(a))}readFileBuffered(e,i,n,o=Object.create(null)){let s=FG();return Kte(e,i,s,a=>a,{...o,bufferSize:this.BUFFER_SIZE,errorTransformer:a=>this.restoreReadError(a,i,o)},n),s}readFileUnbuffered(e,i,n){let o=ed(s=>qe.concat(s));return(async()=>{try{let s;n?.atomic&&$D(e)?s=await e.readFile(i,{atomic:!0}):s=await e.readFile(i),typeof n?.position=="number"&&(s=s.slice(n.position)),typeof n?.length=="number"&&(s=s.slice(0,n.length)),this.validateReadFileLimits(i,s.byteLength,n),o.end(qe.wrap(s))}catch(s){o.error(s),o.end()}})(),o}async validateReadFile(e,i){let n=await this.resolve(e,{resolveMetadata:!0});if(n.isDirectory)throw new So(h("fileIsDirectoryReadError","Unable to read file '{0}' that is actually a directory",this.resourceForError(e)),0,i);if(typeof i?.etag=="string"&&i.etag!==tp&&i.etag===n.etag)throw new Dh(h("fileNotModifiedError","File not modified since"),n,i);return this.validateReadFileLimits(e,n.size,i),n}validateReadFileLimits(e,i,n){if(typeof n?.limits?.size=="number"&&i>n.limits.size)throw new _h(h("fileTooLargeError","Unable to read file '{0}' that is too large to open",this.resourceForError(e)),7,i,n)}async canMove(e,i,n){return this.doCanMoveCopy(e,i,"move",n)}async canCopy(e,i,n){return this.doCanMoveCopy(e,i,"copy",n)}async doCanMoveCopy(e,i,n,o){if(e.toString()!==i.toString())try{let s=n==="move"?this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e):await this.withReadProvider(e),a=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(i),i);await this.doValidateMoveCopy(s,e,a,i,n,o)}catch(s){return s}return!0}async move(e,i,n){let o=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e),s=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(i),i),a=await this.doMoveCopy(o,e,s,i,"move",!!n),l=await this.resolve(i,{resolveMetadata:!0});return this._onDidRunOperation.fire(new Qu(e,a==="move"?2:3,l)),l}async copy(e,i,n){let o=await this.withReadProvider(e),s=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(i),i),a=await this.doMoveCopy(o,e,s,i,"copy",!!n),l=await this.resolve(i,{resolveMetadata:!0});return this._onDidRunOperation.fire(new Qu(e,a==="copy"?3:2,l)),l}async doMoveCopy(e,i,n,o,s,a){if(i.toString()===o.toString())return s;let{exists:l,isSameResourceWithDifferentPathCase:d}=await this.doValidateMoveCopy(e,i,n,o,s,a);if(l&&!d&&a&&await this.del(o,{recursive:!0}),await this.mkdirp(n,this.getExtUri(n).providerExtUri.dirname(o)),s==="copy"){if(e===n&&fw(e))await e.copy(i,o,{overwrite:a});else{let c=await this.resolve(i);c.isDirectory?await this.doCopyFolder(e,c,n,o):await this.doCopyFile(e,i,n,o)}return s}else return e===n?(await e.rename(i,o,{overwrite:a}),s):(await this.doMoveCopy(e,i,n,o,"copy",a),await this.del(i,{recursive:!0}),"copy")}async doCopyFile(e,i,n,o){if(Ju(e)&&Ju(n))return this.doPipeBuffered(e,i,n,o);if(Ju(e)&&ka(n))return this.doPipeBufferedToUnbuffered(e,i,n,o);if(ka(e)&&Ju(n))return this.doPipeUnbufferedToBuffered(e,i,n,o);if(ka(e)&&ka(n))return this.doPipeUnbuffered(e,i,n,o)}async doCopyFolder(e,i,n,o){await n.mkdir(o),Array.isArray(i.children)&&await Vi.settled(i.children.map(async s=>{let a=this.getExtUri(n).providerExtUri.joinPath(o,s.name);return s.isDirectory?this.doCopyFolder(e,await this.resolve(s.resource),n,a):this.doCopyFile(e,s.resource,n,a)}))}async doValidateMoveCopy(e,i,n,o,s,a){let l=!1;if(e===n){let{providerExtUri:c,isPathCaseSensitive:u}=this.getExtUri(e);if(u||(l=c.isEqual(i,o)),l&&s==="copy")throw new Error(h("unableToMoveCopyError1","Unable to copy when source '{0}' is same as target '{1}' with different path case on a case insensitive file system",this.resourceForError(i),this.resourceForError(o)));if(!l&&c.isEqualOrParent(o,i))throw new Error(h("unableToMoveCopyError2","Unable to move/copy when source '{0}' is parent of target '{1}'.",this.resourceForError(i),this.resourceForError(o)))}let d=await this.exists(o);if(d&&!l){if(!a)throw new So(h("unableToMoveCopyError3","Unable to move/copy '{0}' because target '{1}' already exists at destination.",this.resourceForError(i),this.resourceForError(o)),4);if(e===n){let{providerExtUri:c}=this.getExtUri(e);if(c.isEqualOrParent(i,o))throw new Error(h("unableToMoveCopyError4","Unable to move/copy '{0}' into '{1}' since a file would replace the folder it is contained in.",this.resourceForError(i),this.resourceForError(o)))}}return{exists:d,isSameResourceWithDifferentPathCase:l}}getExtUri(e){let i=this.isPathCaseSensitive(e);return{providerExtUri:i?ii:sw,isPathCaseSensitive:i}}isPathCaseSensitive(e){return!!(e.capabilities&1024)}async createFolder(e){let i=this.throwIfFileSystemIsReadonly(await this.withProvider(e),e);await this.mkdirp(i,e);let n=await this.resolve(e,{resolveMetadata:!0});return this._onDidRunOperation.fire(new Qu(e,0,n)),n}async mkdirp(e,i){let n=[],{providerExtUri:o}=this.getExtUri(e);for(;!o.isEqual(i,o.dirname(i));)try{if(!((await e.stat(i)).type&2))throw new Error(h("mkdirExistsError","Unable to create folder '{0}' that already exists but is not a directory",this.resourceForError(i)));break}catch(s){if(bw(s)!=="EntryNotFound")throw s;n.push(o.basename(i)),i=o.dirname(i)}for(let s=n.length-1;s>=0;s--){i=o.joinPath(i,n[s]);try{await e.mkdir(i)}catch(a){if(bw(a)!=="EntryExists")throw a}}}async canDelete(e,i){try{await this.doValidateDelete(e,i)}catch(n){return n}return!0}async doValidateDelete(e,i){let n=this.throwIfFileSystemIsReadonly(await this.withProvider(e),e),o=!!i?.useTrash;if(o&&!(n.capabilities&4096))throw new Error(h("deleteFailedTrashUnsupported","Unable to delete file '{0}' via trash because provider does not support it.",this.resourceForError(e)));let s=i?.atomic;if(s&&!(n.capabilities&65536))throw new Error(h("deleteFailedAtomicUnsupported","Unable to delete file '{0}' atomically because provider does not support it.",this.resourceForError(e)));if(o&&s)throw new Error(h("deleteFailedTrashAndAtomicUnsupported","Unable to atomically delete file '{0}' because using trash is enabled.",this.resourceForError(e)));let a;try{a=await n.stat(e)}catch{}if(a)this.throwIfFileIsReadonly(e,a);else throw new So(h("deleteFailedNotFound","Unable to delete nonexistent file '{0}'",this.resourceForError(e)),1);if(!!!i?.recursive){let d=await this.resolve(e);if(d.isDirectory&&Array.isArray(d.children)&&d.children.length>0)throw new Error(h("deleteFailedNonEmptyFolder","Unable to delete non-empty folder '{0}'.",this.resourceForError(e)))}return n}async del(e,i){let n=await this.doValidateDelete(e,i),o=i;if(u3(n)&&!o?.atomic){let d=n.enforceAtomicDelete?.(e);d&&(o={...i,atomic:d})}let s=!!o?.useTrash,a=!!o?.recursive,l=o?.atomic??!1;await n.delete(e,{recursive:a,useTrash:s,atomic:l}),this._onDidRunOperation.fire(new Qu(e,1))}async cloneFile(e,i){let n=await this.withProvider(e),o=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(i),i);if(!(n===o&&this.getExtUri(n).providerExtUri.isEqual(e,i)))return n===o&&qD(n)?n.cloneFile(e,i):(await this.mkdirp(o,this.getExtUri(o).providerExtUri.dirname(i)),n===o&&fw(n)?this.writeQueue.queueFor(e,()=>n.copy(e,i,{overwrite:!0}),this.getExtUri(n).providerExtUri):this.writeQueue.queueFor(e,()=>this.doCopyFile(n,e,o,i),this.getExtUri(n).providerExtUri))}internalOnDidFilesChange=this._register(new T);_onDidUncorrelatedFilesChange=this._register(new T);onDidFilesChange=this._onDidUncorrelatedFilesChange.event;_onDidWatchError=this._register(new T);onDidWatchError=this._onDidWatchError.event;activeWatchers=new Map;static WATCHER_CORRELATION_IDS=0;createWatcher(e,i){return this.watch(e,{...i,correlationId:sg.WATCHER_CORRELATION_IDS++})}watch(e,i={recursive:!1,excludes:[]}){let n=new W,o=!1,s=()=>{o=!0};n.add(te(()=>s())),(async()=>{try{let l=await this.doWatch(e,i);o?nt(l):s=()=>nt(l)}catch(l){this.logService.error(l)}})();let a=i.correlationId;if(typeof a=="number"){let l=n.add(new T);return n.add(this.internalOnDidFilesChange.event(c=>{c.correlates(a)&&l.fire(c)})),{onDidChange:l.event,dispose:()=>n.dispose()}}return n}async doWatch(e,i){let n=await this.withProvider(e),o=Xn([this.getExtUri(n).providerExtUri.getComparisonKey(e),i]),s=this.activeWatchers.get(o);return s||(s={count:0,disposable:n.watch(e,i)},this.activeWatchers.set(o,s)),s.count+=1,te(()=>{s&&(s.count--,s.count===0&&(nt(s.disposable),this.activeWatchers.delete(o)))})}dispose(){super.dispose();for(let[,e]of this.activeWatchers)nt(e.disposable);this.activeWatchers.clear()}writeQueue=this._register(new LD);async doWriteBuffered(e,i,n,o){return this.writeQueue.queueFor(i,async()=>{let s=await e.open(i,{create:!0,unlock:n?.unlock??!1});try{cw(o)||CD(o)?await this.doWriteStreamBufferedQueued(e,s,o):await this.doWriteReadableBufferedQueued(e,s,o)}catch(a){throw ep(a)}finally{await e.close(s)}},this.getExtUri(e).providerExtUri)}async doWriteStreamBufferedQueued(e,i,n){let o=0,s;if(CD(n)){if(n.buffer.length>0){let a=qe.concat(n.buffer);await this.doWriteBuffer(e,i,a,a.byteLength,o,0),o+=a.byteLength}if(n.ended)return;s=n.stream}else s=n;return new Promise((a,l)=>{xg(s,{onData:async d=>{s.pause();try{await this.doWriteBuffer(e,i,d,d.byteLength,o,0)}catch(c){return l(c)}o+=d.byteLength,setTimeout(()=>s.resume())},onError:d=>l(d),onEnd:()=>a()})})}async doWriteReadableBufferedQueued(e,i,n){let o=0,s;for(;(s=n.read())!==null;)await this.doWriteBuffer(e,i,s,s.byteLength,o,0),o+=s.byteLength}async doWriteBuffer(e,i,n,o,s,a){let l=0;for(;l<o;){let d=await e.write(i,s+l,n.buffer,a+l,o-l);l+=d}}async doWriteUnbuffered(e,i,n,o){return this.writeQueue.queueFor(i,()=>this.doWriteUnbufferedQueued(e,i,n,o),this.getExtUri(e).providerExtUri)}async doWriteUnbufferedQueued(e,i,n,o){let s;o instanceof qe?s=o:cw(o)?s=await rv(o):CD(o)?s=await OG(o):s=MG(o),await e.writeFile(i,s.buffer,{create:!0,overwrite:!0,unlock:n?.unlock??!1,atomic:n?.atomic??!1})}async doPipeBuffered(e,i,n,o){return this.writeQueue.queueFor(o,()=>this.doPipeBufferedQueued(e,i,n,o),this.getExtUri(n).providerExtUri)}async doPipeBufferedQueued(e,i,n,o){let s,a;try{s=await e.open(i,{create:!1}),a=await n.open(o,{create:!0,unlock:!1});let l=qe.alloc(this.BUFFER_SIZE),d=0,c=0,u=0;do u=await e.read(s,d,l.buffer,c,l.byteLength-c),await this.doWriteBuffer(n,a,l,u,d,c),d+=u,c+=u,c===l.byteLength&&(c=0);while(u>0)}catch(l){throw ep(l)}finally{await Vi.settled([typeof s=="number"?e.close(s):Promise.resolve(),typeof a=="number"?n.close(a):Promise.resolve()])}}async doPipeUnbuffered(e,i,n,o){return this.writeQueue.queueFor(o,()=>this.doPipeUnbufferedQueued(e,i,n,o),this.getExtUri(n).providerExtUri)}async doPipeUnbufferedQueued(e,i,n,o){return n.writeFile(o,await e.readFile(i),{create:!0,overwrite:!0,unlock:!1,atomic:!1})}async doPipeUnbufferedToBuffered(e,i,n,o){return this.writeQueue.queueFor(o,()=>this.doPipeUnbufferedToBufferedQueued(e,i,n,o),this.getExtUri(n).providerExtUri)}async doPipeUnbufferedToBufferedQueued(e,i,n,o){let s=await n.open(o,{create:!0,unlock:!1});try{let a=await e.readFile(i);await this.doWriteBuffer(n,s,qe.wrap(a),a.byteLength,0,0)}catch(a){throw ep(a)}finally{await n.close(s)}}async doPipeBufferedToUnbuffered(e,i,n,o){let s=await rv(this.readFileBuffered(e,i,In.None));await this.doWriteUnbuffered(n,o,void 0,s)}throwIfFileSystemIsReadonly(e,i){if(e.capabilities&2048)throw new So(h("err.readonly","Unable to modify read-only file '{0}'",this.resourceForError(i)),6);return e}throwIfFileIsReadonly(e,i){if((i.permissions??0)&1)throw new So(h("err.readonly","Unable to modify read-only file '{0}'",this.resourceForError(e)),6)}resourceForError(e){return e.scheme===he.file?e.fsPath:e.toString(!0)}};sg=_([v(0,Gt)],sg);function L9(r){return r.recursive===!0}var D9=class r extends L{constructor(e,i,n,o){super();this.onFileChanges=e;this.onLogMessage=i;this.verboseLogging=n;this.options=o}static MAX_RESTARTS=5;watcher;watcherDisposables=this._register(new mt);requests=void 0;restartCounter=0;init(){let e=new W;this.watcherDisposables.value=e,this.watcher=this.createWatcher(e),this.watcher.setVerboseLogging(this.verboseLogging),e.add(this.watcher.onDidChangeFile(i=>this.onFileChanges(i))),e.add(this.watcher.onDidLogMessage(i=>this.onLogMessage(i))),e.add(this.watcher.onDidError(i=>this.onError(i.error,i.request)))}onError(e,i){this.canRestart(e,i)?this.restartCounter<r.MAX_RESTARTS&&this.requests?(this.error(`restarting watcher after unexpected error: ${e}`),this.restart(this.requests)):this.error(`gave up attempting to restart watcher after unexpected error: ${e}`):this.error(e)}canRestart(e,i){return!(!this.options.restartOnError||i||e.indexOf("No space left on device")!==-1||e.indexOf("EMFILE")!==-1)}restart(e){this.restartCounter++,this.init(),this.watch(e)}async watch(e){this.requests=e,await this.watcher?.watch(e)}async setVerboseLogging(e){this.verboseLogging=e,await this.watcher?.setVerboseLogging(e)}error(e){this.onLogMessage({type:"error",message:`[File Watcher (${this.options.type})] ${e}`})}trace(e){this.onLogMessage({type:"trace",message:`[File Watcher (${this.options.type})] ${e}`})}dispose(){return this.watcher=void 0,super.dispose()}};var bF=class extends D9{constructor(t,e,i){super(t,e,i,{type:"universal",restartOnError:!0})}};function E_(r){return r.map(t=>({type:t.type,resource:q.revive(t.resource),cId:t.cId}))}var Gte="localFilesystem",yS=class extends L{constructor(e,i){super();this.channel=e;this.extraCapabilities=i;this.registerFileChangeListeners()}onDidChangeCapabilities=O.None;_capabilities;get capabilities(){return this._capabilities||(this._capabilities=253982,this.extraCapabilities.pathCaseSensitive&&(this._capabilities|=1024),this.extraCapabilities.trash&&(this._capabilities|=4096)),this._capabilities}stat(e){return this.channel.call("stat",[e])}readdir(e){return this.channel.call("readdir",[e])}async readFile(e,i){let{buffer:n}=await this.channel.call("readFile",[e,i]);return n}readFileStream(e,i,n){let o=ed(a=>qe.concat(a.map(l=>qe.wrap(l))).buffer),s=new W;return s.add(this.channel.listen("readFileStream",[e,i])(a=>{if(a instanceof qe)o.write(a.buffer);else{if(a==="end")o.end();else{let l;if(a instanceof Error)l=a;else{let d=a;l=Lh(d.message??lo(d),d.code??"Unknown")}o.error(l),o.end()}s.dispose()}})),s.add(n.onCancellationRequested(()=>{o.error(H_()),o.end(),s.dispose()})),o}writeFile(e,i,n){return this.channel.call("writeFile",[e,qe.wrap(i),n])}open(e,i){return this.channel.call("open",[e,i])}close(e){return this.channel.call("close",[e])}async read(e,i,n,o,s){let[a,l]=await this.channel.call("read",[e,i,s]);return n.set(a.buffer.slice(0,l),o),l}write(e,i,n,o,s){return this.channel.call("write",[e,i,qe.wrap(n),o,s])}mkdir(e){return this.channel.call("mkdir",[e])}delete(e,i){return this.channel.call("delete",[e,i])}rename(e,i,n){return this.channel.call("rename",[e,i,n])}copy(e,i,n){return this.channel.call("copy",[e,i,n])}cloneFile(e,i){return this.channel.call("cloneFile",[e,i])}_onDidChange=this._register(new T);onDidChangeFile=this._onDidChange.event;_onDidWatchError=this._register(new T);onDidWatchError=this._onDidWatchError.event;sessionId=zr();registerFileChangeListeners(){this._register(this.channel.listen("fileChange",[this.sessionId])(e=>{if(Array.isArray(e)){let i=e;this._onDidChange.fire(E_(i))}else{let i=e;this._onDidWatchError.fire(i)}}))}watch(e,i){let n=zr();return this.channel.call("watch",[this.sessionId,n,e,i]),te(()=>this.channel.call("unwatch",[this.sessionId,n]))}};var Che="remoteFilesystem",vF=class r extends yS{static register(t,e,i){let n=t.getConnection();if(!n)return L.None;let o=new W,s=(async()=>{try{let a=await t.getRawEnvironment();a?e.registerProvider(he.vscodeRemote,o.add(new r(a,n))):i.error("Cannot register remote filesystem provider. Remote environment doesnot exist.")}catch(a){i.error("Cannot register remote filesystem provider. Error while fetching remote environment.",Nu(a))}})();return o.add(e.onWillActivateFileSystemProvider(a=>{a.scheme===he.vscodeRemote&&a.join(s)})),o}constructor(t,e){super(e.getChannel(Che),{pathCaseSensitive:t.os===3})}};var yF=class{constructor(t,e,i){this.donotCacheResourcesWithSchemes=t;this.fileService=i;this.cacheHome=e.cacheHome}cacheHome;cachedConfigurations=new Map;needsCaching(t){return!this.donotCacheResourcesWithSchemes.includes(t.scheme)}read(t){return this.getCachedConfiguration(t).read()}write(t,e){return this.getCachedConfiguration(t).save(e)}remove(t){return this.getCachedConfiguration(t).remove()}getCachedConfiguration({type:t,key:e}){let i=`${t}:${e}`,n=this.cachedConfigurations.get(i);return n||(n=new k9({type:t,key:e},this.cacheHome,this.fileService),this.cachedConfigurations.set(i,n)),n}},k9=class{constructor({type:t,key:e},i,n){this.fileService=n;this.cachedConfigurationFolderResource=Ot(i,"CachedConfigurations",t,e),this.cachedConfigurationFileResource=Ot(this.cachedConfigurationFolderResource,t==="workspaces"?"workspace.json":"configuration.json"),this.queue=new Xu}queue;cachedConfigurationFolderResource;cachedConfigurationFileResource;async read(){try{return(await this.fileService.readFile(this.cachedConfigurationFileResource)).value.toString()}catch{return""}}async save(t){await this.createCachedFolder()&&await this.queue.queue(async()=>{await this.fileService.writeFile(this.cachedConfigurationFileResource,qe.fromString(t))})}async remove(){try{await this.queue.queue(()=>this.fileService.del(this.cachedConfigurationFolderResource,{recursive:!0,useTrash:!1}))}catch(t){if(t.fileOperationResult!==1)throw t}}async createCachedFolder(){if(await this.fileService.exists(this.cachedConfigurationFolderResource))return!0;try{return await this.fileService.createFolder(this.cachedConfigurationFolderResource),!0}catch{return!1}}};var x_=class{constructor(t,e,i){this.level=t;this.key=e;this.value=i;this.forward=[]}forward},T_=void 0,IF=class r{constructor(t,e=2**16){this.comparator=t;this._maxLevel=Math.max(1,Math.log2(e)|0),this._header=new x_(this._maxLevel,T_,T_)}[Symbol.toStringTag]="SkipList";_maxLevel;_level=0;_header;_size=0;get size(){return this._size}clear(){this._header=new x_(this._maxLevel,T_,T_),this._size=0}has(t){return!!r._search(this,t,this.comparator)}get(t){return r._search(this,t,this.comparator)?.value}set(t,e){return r._insert(this,t,e,this.comparator)&&(this._size+=1),this}delete(t){let e=r._delete(this,t,this.comparator);return e&&(this._size-=1),e}forEach(t,e){let i=this._header.forward[0];for(;i;)t.call(e,i.value,i.key,this),i=i.forward[0]}[Symbol.iterator](){return this.entries()}*entries(){let t=this._header.forward[0];for(;t;)yield[t.key,t.value],t=t.forward[0]}*keys(){let t=this._header.forward[0];for(;t;)yield t.key,t=t.forward[0]}*values(){let t=this._header.forward[0];for(;t;)yield t.value,t=t.forward[0]}toString(){let t="[SkipList]:",e=this._header.forward[0];for(;e;)t+=`node(${e.key}, ${e.value}, lvl:${e.level})`,e=e.forward[0];return t}static _search(t,e,i){let n=t._header;for(let o=t._level-1;o>=0;o--)for(;n.forward[o]&&i(n.forward[o].key,e)<0;)n=n.forward[o];if(n=n.forward[0],n&&i(n.key,e)===0)return n}static _insert(t,e,i,n){let o=[],s=t._header;for(let a=t._level-1;a>=0;a--){for(;s.forward[a]&&n(s.forward[a].key,e)<0;)s=s.forward[a];o[a]=s}if(s=s.forward[0],s&&n(s.key,e)===0)return s.value=i,!1;{let a=r._randomLevel(t);if(a>t._level){for(let l=t._level;l<a;l++)o[l]=t._header;t._level=a}s=new x_(a,e,i);for(let l=0;l<a;l++)s.forward[l]=o[l].forward[l],o[l].forward[l]=s;return!0}}static _randomLevel(t,e=.5){let i=1;for(;Math.random()<e&&i<t._maxLevel;)i+=1;return i}static _delete(t,e,i){let n=[],o=t._header;for(let s=t._level-1;s>=0;s--){for(;o.forward[s]&&i(o.forward[s].key,e)<0;)o=o.forward[s];n[s]=o}if(o=o.forward[0],!o||i(o.key,e)!==0)return!1;for(let s=0;s<t._level&&n[s].forward[s]===o;s++)n[s].forward[s]=o.forward[s];for(;t._level>0&&t._header.forward[t._level-1]===T_;)t._level-=1;return!0}};var CF=class r{constructor(t){this.uri=t}static _clock=0;time=r._clock++;touch(){return this.time=r._clock++,this}},Pb=class{constructor(t){this._fileService=t;let e=new Map,i=n=>{let o=e.get(n.scheme);return o===void 0&&(o=t.hasProvider(n)&&!this._fileService.hasCapability(n,1024),e.set(n.scheme,o)),o};this._dispooables.add(O.any(t.onDidChangeFileSystemProviderRegistrations,t.onDidChangeFileSystemProviderCapabilities)(n=>{e.delete(n.scheme)})),this.extUri=new Eg(i),this._canonicalUris=new IF((n,o)=>this.extUri.compare(n,o,!0),this._limit)}extUri;_dispooables=new W;_canonicalUris;_limit=2**16;dispose(){this._dispooables.dispose(),this._canonicalUris.clear()}asCanonicalUri(t){this._fileService.hasProvider(t)&&(t=fG(t));let e=this._canonicalUris.get(t);return e?e.touch().uri.with({fragment:t.fragment}):(this._canonicalUris.set(t,new CF(t)),this._checkTrim(),t)}_checkTrim(){if(this._canonicalUris.size<this._limit)return;let t=[...this._canonicalUris.entries()].sort((i,n)=>i[1].time<n[1].time?1:i[1].time>n[1].time?-1:0);CF._clock=0,this._canonicalUris.clear();let e=this._limit*.5;for(let i=0;i<e;i++)this._canonicalUris.set(t[i][0],t[i][1].touch())}};Pb=_([v(0,ai)],Pb);vi(_r,Pb,1);var r2n=$("keyboardLayoutService");function She(r,t){return!r&&!t?!0:!r||!t?!1:r.vkey===t.vkey&&r.value===t.value&&r.withShift===t.withShift&&r.withAltGr===t.withAltGr&&r.withShiftAltGr===t.withShiftAltGr}function qte(r,t){if(!r&&!t)return!0;if(!r||!t)return!1;for(let e=0;e<193;e++){let i=Uw.toString(e),n=r[i],o=t[i];if(!She(n,o))return!1}return!0}function whe(r,t){return!r&&!t?!0:!r||!t?!1:r.value===t.value&&r.withShift===t.withShift&&r.withAltGr===t.withAltGr&&r.withShiftAltGr===t.withShiftAltGr}function jte(r,t){if(!r&&!t)return!0;if(!r||!t)return!1;for(let e=0;e<193;e++){let i=Uw.toString(e),n=r[i],o=t[i];if(!whe(n,o))return!1}return!0}var $te=$("nativeKeyboardLayoutService"),IS=class extends L{_onDidChangeKeyboardLayout=this._register(new T);onDidChangeKeyboardLayout=this._onDidChangeKeyboardLayout.event;_keyboardLayoutService;_initPromise;_keyboardMapping;_keyboardLayoutInfo;constructor(t){super(),this._keyboardLayoutService=Wd.toService(t.getChannel("keyboardLayout")),this._initPromise=null,this._keyboardMapping=null,this._keyboardLayoutInfo=null,this._register(this._keyboardLayoutService.onDidChangeKeyboardLayout(async({keyboardLayoutInfo:e,keyboardMapping:i})=>{await this.initialize(),!Ehe(this._keyboardMapping,i)&&(this._keyboardMapping=i,this._keyboardLayoutInfo=e,this._onDidChangeKeyboardLayout.fire())}))}initialize(){return this._initPromise||(this._initPromise=this._doInitialize()),this._initPromise}async _doInitialize(){let t=await this._keyboardLayoutService.getKeyboardLayoutData(),{keyboardLayoutInfo:e,keyboardMapping:i}=t;this._keyboardMapping=i,this._keyboardLayoutInfo=e}getRawKeyboardMapping(){return this._keyboardMapping}getCurrentKeyboardLayout(){return this._keyboardLayoutInfo}};IS=_([v(0,_u)],IS);function Ehe(r,t){return Hs===1?qte(r,t):jte(r,t)}var SF=class{constructor(t,e){this.sender=t;this.onMessage=e}send(t){try{this.sender.send("vscode:message",t.buffer)}catch{}}disconnect(){this.sender.send("vscode:disconnect",null)}};var wF=class r extends fm{protocol;static createProtocol(){let t=O.fromNodeEventEmitter(un,"vscode:message",(e,i)=>qe.wrap(i));return un.send("vscode:hello"),new SF(un,t)}constructor(t){let e=r.createProtocol();super(e,t),this.protocol=e}dispose(){this.protocol.disconnect(),super.dispose()}};var EF=class extends L{mainProcessConnection;constructor(t){super(),this.mainProcessConnection=this._register(new wF(`window:${t}`))}getChannel(t){return this.mainProcessConnection.getChannel(t)}registerChannel(t,e){this.mainProcessConnection.registerChannel(t,e)}};var nzn=new class{transformIncoming(r){return r}transformOutgoing(r){return r}transformOutgoingURI(r){return r}transformOutgoingScheme(r){return r}};var TF=class extends sL{constructor(e,i,n,o,s){super(i,n,o);this.windowId=e;this.channel=s;this._register(s.listen("onDidChangeLogLevel",e)(a=>{_3(a)?super.setLogLevel(a):super.setLogLevel(q.revive(a[0]),a[1])})),this._register(s.listen("onDidChangeVisibility",e)(([a,l])=>super.setVisibility(q.revive(a),l))),this._register(s.listen("onDidChangeLoggers",e)(({added:a,removed:l})=>{for(let d of a)super.registerLogger({...d,resource:q.revive(d.resource)});for(let d of l)super.deregisterLogger(d.resource)}))}createConsoleMainLogger(){return new kw({log:(e,i)=>{this.channel.call("consoleLog",[e,i])}})}registerLogger(e){super.registerLogger(e),this.channel.call("registerLogger",[e,this.windowId])}deregisterLogger(e){super.deregisterLogger(e),this.channel.call("deregisterLogger",[e,this.windowId])}setLogLevel(e,i){super.setLogLevel(e,i),this.channel.call("setLogLevel",[e,i])}setVisibility(e,i){super.setVisibility(e,i),this.channel.call("setVisibility",[this.toResource(e),i])}doCreateLogger(e,i,n){return new R9(this.channel,e,i,n,this.windowId)}static setLogLevel(e,i,n){return e.call("setLogLevel",[i,n])}},R9=class extends nL{constructor(e,i,n,o,s){super(o?.logLevel==="always");this.channel=e;this.file=i;this.setLevel(n),this.channel.call("createLogger",[i,o,s]).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}isLoggerCreated=!1;buffer=[];log(e,i){let n=[[e,i]];this.isLoggerCreated?this.doLog(n):this.buffer.push(...n)}doLog(e){this.channel.call("log",[this.file,e])}};var Yte="rendererLog";var CS=class extends L{logger;constructor(t,e=[]){super(),this.logger=new rL([t,...e]),this._register(t.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(t){this.logger.setLevel(t)}getLevel(){return this.logger.getLevel()}trace(t,...e){this.logger.trace(t,...e)}debug(t,...e){this.logger.debug(t,...e)}info(t,...e){this.logger.info(t,...e)}warn(t,...e){this.logger.warn(t,...e)}error(t,...e){this.logger.error(t,...e)}flush(){this.logger.flush()}};var xF=class extends CS{constructor(t,e){let i=new W,n=i.add(t.createLogger(e.logFile,{id:Yte,name:h("rendererLog","Window")})),o;e.isExtensionDevelopment&&e.extensionTestsLocationURI?o=t.createConsoleMainLogger():o=new oL(n.getLevel()),super(n,[o]),this._register(i)}};var The="security.workspace.trust.enabled";var Zte="security.workspace.trust.untrustedFiles",xhe="security.workspace.trust.emptyWindow";var _he="content.trust.model.key",A9=class{constructor(t,e,i){this.originalWorkspace=t;this.canonicalFolderUris=e;this.canonicalConfiguration=i}get folders(){return this.originalWorkspace.folders.map((t,e)=>({index:t.index,name:t.name,toResource:t.toResource,uri:this.canonicalFolderUris[e]}))}get transient(){return this.originalWorkspace.transient}get configuration(){return this.canonicalConfiguration??this.originalWorkspace.configuration}get id(){return this.originalWorkspace.id}},SS=class extends L{constructor(e,i){super();this.configurationService=e;this.environmentService=i}_serviceBrand;isWorkspaceTrustEnabled(){return this.environmentService.disableWorkspaceTrust?!1:!!this.configurationService.getValue(The)}};SS=_([v(0,de),v(1,on)],SS);var wS=class extends L{constructor(e,i,n,o,s,a,l,d){super();this.configurationService=e;this.remoteAuthorityResolverService=i;this.storageService=n;this.uriIdentityService=o;this.environmentService=s;this.workspaceService=a;this.workspaceTrustEnablementService=l;this.fileService=d;this._canonicalUrisResolved=!1,this._canonicalWorkspace=this.workspaceService.getWorkspace(),{promise:this._workspaceResolvedPromise,resolve:this._workspaceResolvedPromiseResolve}=av(),{promise:this._workspaceTrustInitializedPromise,resolve:this._workspaceTrustInitializedPromiseResolve}=av(),this._storedTrustState=new M9(wt&&this.isEmptyWorkspace()?void 0:this.storageService),this._trustTransitionManager=this._register(new P9),this._trustStateInfo=this.loadTrustInfo(),this._isTrusted=this.calculateWorkspaceTrust(),this.initializeWorkspaceTrust(),this.registerListeners()}_serviceBrand;storageKey=_he;_workspaceResolvedPromise;_workspaceResolvedPromiseResolve;_workspaceTrustInitializedPromise;_workspaceTrustInitializedPromiseResolve;_onDidChangeTrust=this._register(new T);onDidChangeTrust=this._onDidChangeTrust.event;_onDidChangeTrustedFolders=this._register(new T);onDidChangeTrustedFolders=this._onDidChangeTrustedFolders.event;_canonicalStartupFiles=[];_canonicalWorkspace;_canonicalUrisResolved;_isTrusted;_trustStateInfo;_remoteAuthority;_storedTrustState;_trustTransitionManager;initializeWorkspaceTrust(){this.resolveCanonicalUris().then(async()=>{this._canonicalUrisResolved=!0,await this.updateWorkspaceTrust()}).finally(()=>{this._workspaceResolvedPromiseResolve(),this.environmentService.remoteAuthority||this._workspaceTrustInitializedPromiseResolve()}),this.environmentService.remoteAuthority&&this.remoteAuthorityResolverService.resolveAuthority(this.environmentService.remoteAuthority).then(async e=>{this._remoteAuthority=e,await this.fileService.activateProvider(he.vscodeRemote),await this.updateWorkspaceTrust()}).finally(()=>{this._workspaceTrustInitializedPromiseResolve()}),this.isEmptyWorkspace()&&this._workspaceTrustInitializedPromise.then(()=>{this._storedTrustState.isEmptyWorkspaceTrusted===void 0&&(this._storedTrustState.isEmptyWorkspaceTrusted=this.isWorkspaceTrusted())})}registerListeners(){this._register(this.workspaceService.onDidChangeWorkspaceFolders(async()=>await this.updateWorkspaceTrust())),this._register(this.storageService.onDidChangeValue(-1,this.storageKey,this._register(new W))(async()=>{JSON.stringify(this._trustStateInfo)!==JSON.stringify(this.loadTrustInfo())&&(this._trustStateInfo=this.loadTrustInfo(),this._onDidChangeTrustedFolders.fire(),await this.updateWorkspaceTrust())}))}async getCanonicalUri(e){let i=e;if(this.environmentService.remoteAuthority&&e.scheme===he.vscodeRemote)i=await this.remoteAuthorityResolverService.getCanonicalURI(e);else if(e.scheme==="vscode-vfs"){let n=e.authority.indexOf("+");n!==-1&&(i=e.with({authority:e.authority.substr(0,n)}))}return i.with({query:null,fragment:null})}async resolveCanonicalUris(){let e=[];if(this.environmentService.filesToOpenOrCreate&&e.push(...this.environmentService.filesToOpenOrCreate),this.environmentService.filesToDiff&&e.push(...this.environmentService.filesToDiff),this.environmentService.filesToMerge&&e.push(...this.environmentService.filesToMerge),e.length){let s=e.filter(l=>!!l.fileUri).map(l=>l.fileUri),a=await Promise.all(s.map(l=>this.getCanonicalUri(l)));this._canonicalStartupFiles.push(...a.filter(l=>this._canonicalStartupFiles.every(d=>!this.uriIdentityService.extUri.isEqual(l,d))))}let i=this.workspaceService.getWorkspace().folders.map(s=>s.uri),n=await Promise.all(i.map(s=>this.getCanonicalUri(s))),o=this.workspaceService.getWorkspace().configuration;o&&AB(o,this.environmentService)&&(o=await this.getCanonicalUri(o)),this._canonicalWorkspace=new A9(this.workspaceService.getWorkspace(),n,o)}loadTrustInfo(){let e=this.storageService.get(this.storageKey,-1),i;try{e&&(i=JSON.parse(e))}catch{}return i||(i={uriTrustInfo:[]}),i.uriTrustInfo||(i.uriTrustInfo=[]),i.uriTrustInfo=i.uriTrustInfo.map(n=>({uri:q.revive(n.uri),trusted:n.trusted})),i.uriTrustInfo=i.uriTrustInfo.filter(n=>n.trusted),i}async saveTrustInfo(){this.storageService.store(this.storageKey,JSON.stringify(this._trustStateInfo),-1,1),this._onDidChangeTrustedFolders.fire(),await this.updateWorkspaceTrust()}getWorkspaceUris(){let e=this._canonicalWorkspace.folders.map(n=>n.uri),i=this._canonicalWorkspace.configuration;return i&&AB(i,this.environmentService)&&e.push(i),e}calculateWorkspaceTrust(){return this.workspaceTrustEnablementService.isWorkspaceTrustEnabled()?this._canonicalUrisResolved?this.environmentService.remoteAuthority&&this._remoteAuthority?.options?.isTrusted?this._remoteAuthority.options.isTrusted:this.isEmptyWorkspace()?this._storedTrustState.isEmptyWorkspaceTrusted!==void 0?this._storedTrustState.isEmptyWorkspaceTrusted:this._canonicalStartupFiles.length?this.getUrisTrust(this._canonicalStartupFiles):!!this.configurationService.getValue(xhe):this.getUrisTrust(this.getWorkspaceUris()):!1:!0}async updateWorkspaceTrust(e){this.workspaceTrustEnablementService.isWorkspaceTrustEnabled()&&(e===void 0&&(await this.resolveCanonicalUris(),e=this.calculateWorkspaceTrust()),this.isWorkspaceTrusted()!==e&&(this.isTrusted=e,await this._trustTransitionManager.participate(e),this._onDidChangeTrust.fire(e)))}getUrisTrust(e){let i=!0;for(let n of e){let{trusted:o}=this.doGetUriTrustInfo(n);if(!o)return i=o,i}return i}doGetUriTrustInfo(e){if(!this.workspaceTrustEnablementService.isWorkspaceTrustEnabled())return{trusted:!0,uri:e};if(this.isTrustedVirtualResource(e))return{trusted:!0,uri:e};if(this.isTrustedByRemote(e))return{trusted:!0,uri:e};let i=!1,n=-1,o=e;for(let s of this._trustStateInfo.uriTrustInfo)if(this.uriIdentityService.extUri.isEqualOrParent(e,s.uri)){let a=s.uri.fsPath;a.length>n&&(n=a.length,i=s.trusted,o=s.uri)}return{trusted:i,uri:o}}async doSetUrisTrust(e,i){let n=!1;for(let o of e)if(i){if(this.isTrustedVirtualResource(o)||this.isTrustedByRemote(o))continue;this._trustStateInfo.uriTrustInfo.find(a=>this.uriIdentityService.extUri.isEqual(a.uri,o))||(this._trustStateInfo.uriTrustInfo.push({uri:o,trusted:!0}),n=!0)}else{let s=this._trustStateInfo.uriTrustInfo.length;this._trustStateInfo.uriTrustInfo=this._trustStateInfo.uriTrustInfo.filter(a=>!this.uriIdentityService.extUri.isEqual(a.uri,o)),s!==this._trustStateInfo.uriTrustInfo.length&&(n=!0)}n&&await this.saveTrustInfo()}isEmptyWorkspace(){if(this.workspaceService.getWorkbenchState()===1)return!0;let e=this.workspaceService.getWorkspace();return e?Yu(this.workspaceService.getWorkspace())&&e.folders.length===0:!1}isTrustedVirtualResource(e){return E0(e)&&e.scheme!=="vscode-vfs"}isTrustedByRemote(e){return!this.environmentService.remoteAuthority||!this._remoteAuthority?!1:rw(mU(e),this._remoteAuthority.authority.authority)&&!!this._remoteAuthority.options?.isTrusted}set isTrusted(e){this._isTrusted=e,e||(this._storedTrustState.acceptsOutOfWorkspaceFiles=!1),this.isEmptyWorkspace()&&(this._storedTrustState.isEmptyWorkspaceTrusted=e)}get workspaceResolved(){return this._workspaceResolvedPromise}get workspaceTrustInitialized(){return this._workspaceTrustInitializedPromise}get acceptsOutOfWorkspaceFiles(){return this._storedTrustState.acceptsOutOfWorkspaceFiles}set acceptsOutOfWorkspaceFiles(e){this._storedTrustState.acceptsOutOfWorkspaceFiles=e}isWorkspaceTrusted(){return this._isTrusted}isWorkspaceTrustForced(){return!!(this.environmentService.remoteAuthority&&this._remoteAuthority&&this._remoteAuthority.options?.isTrusted!==void 0||this.getWorkspaceUris().filter(i=>!this.isTrustedVirtualResource(i)).length===0)}canSetParentFolderTrust(){let e=ov(this._canonicalWorkspace);if(!dl(e)||e.uri.scheme!==he.file&&e.uri.scheme!==he.vscodeRemote)return!1;let i=this.uriIdentityService.extUri.dirname(e.uri);return!this.uriIdentityService.extUri.isEqual(e.uri,i)}async setParentFolderTrust(e){if(this.canSetParentFolderTrust()){let i=ov(this._canonicalWorkspace).uri,n=this.uriIdentityService.extUri.dirname(i);await this.setUrisTrust([n],e)}}canSetWorkspaceTrust(){if(this.environmentService.remoteAuthority&&(!this._remoteAuthority||this._remoteAuthority.options?.isTrusted!==void 0))return!1;if(this.isEmptyWorkspace())return!0;if(this.getWorkspaceUris().filter(o=>!this.isTrustedVirtualResource(o)).length===0)return!1;if(!this.isWorkspaceTrusted())return!0;let i=ov(this._canonicalWorkspace);if(!dl(i)||i.uri.scheme!==he.file&&i.uri.scheme!=="vscode-vfs")return!1;let n=this.doGetUriTrustInfo(i.uri);if(!n.trusted||!this.uriIdentityService.extUri.isEqual(i.uri,n.uri))return!1;if(this.canSetParentFolderTrust()){let o=this.uriIdentityService.extUri.dirname(i.uri);if(this.doGetUriTrustInfo(o).trusted)return!1}return!0}async setWorkspaceTrust(e){if(this.isEmptyWorkspace()){await this.updateWorkspaceTrust(e);return}let i=this.getWorkspaceUris();await this.setUrisTrust(i,e)}async getUriTrustInfo(e){return this.workspaceTrustEnablementService.isWorkspaceTrustEnabled()?this.isTrustedByRemote(e)?{trusted:!0,uri:e}:this.doGetUriTrustInfo(await this.getCanonicalUri(e)):{trusted:!0,uri:e}}async setUrisTrust(e,i){this.doSetUrisTrust(await Promise.all(e.map(n=>this.getCanonicalUri(n))),i)}getTrustedUris(){return this._trustStateInfo.uriTrustInfo.map(e=>e.uri)}async setTrustedUris(e){this._trustStateInfo.uriTrustInfo=[];for(let i of e){let n=await this.getCanonicalUri(i),o=this.uriIdentityService.extUri.removeTrailingPathSeparator(n),s=!1;for(let a of this._trustStateInfo.uriTrustInfo)if(this.uriIdentityService.extUri.isEqual(a.uri,o)){s=!0;break}s||this._trustStateInfo.uriTrustInfo.push({trusted:!0,uri:o})}await this.saveTrustInfo()}addWorkspaceTrustTransitionParticipant(e){return this._trustTransitionManager.addWorkspaceTrustTransitionParticipant(e)}};wS=_([v(0,de),v(1,Ud),v(2,tt),v(3,_r),v(4,on),v(5,Xt),v(6,sF),v(7,ai)],wS);var __=class extends L{constructor(e,i){super();this.configurationService=e;this.workspaceTrustManagementService=i}_serviceBrand;_openFilesTrustRequestPromise;_openFilesTrustRequestResolver;_workspaceTrustRequestPromise;_workspaceTrustRequestResolver;_onDidInitiateOpenFilesTrustRequest=this._register(new T);onDidInitiateOpenFilesTrustRequest=this._onDidInitiateOpenFilesTrustRequest.event;_onDidInitiateWorkspaceTrustRequest=this._register(new T);onDidInitiateWorkspaceTrustRequest=this._onDidInitiateWorkspaceTrustRequest.event;_onDidInitiateWorkspaceTrustRequestOnStartup=this._register(new T);onDidInitiateWorkspaceTrustRequestOnStartup=this._onDidInitiateWorkspaceTrustRequestOnStartup.event;get untrustedFilesSetting(){return this.configurationService.getValue(Zte)}set untrustedFilesSetting(e){this.configurationService.updateValue(Zte,e)}async completeOpenFilesTrustRequest(e,i){this._openFilesTrustRequestResolver&&(e===1&&(this.workspaceTrustManagementService.acceptsOutOfWorkspaceFiles=!0),i&&(e===1&&(this.untrustedFilesSetting="open"),e===2&&(this.untrustedFilesSetting="newWindow")),this._openFilesTrustRequestResolver(e),this._openFilesTrustRequestResolver=void 0,this._openFilesTrustRequestPromise=void 0)}async requestOpenFilesTrust(e){if(!this.workspaceTrustManagementService.isWorkspaceTrusted())return 1;if((await Promise.all(e.map(n=>this.workspaceTrustManagementService.getUriTrustInfo(n)))).map(n=>n.trusted).every(n=>n))return 1;if(this.untrustedFilesSetting!=="prompt"){if(this.untrustedFilesSetting==="newWindow")return 2;if(this.untrustedFilesSetting==="open")return 1}if(this.workspaceTrustManagementService.acceptsOutOfWorkspaceFiles)return 1;if(!this._openFilesTrustRequestPromise)this._openFilesTrustRequestPromise=new Promise(n=>{this._openFilesTrustRequestResolver=n});else return this._openFilesTrustRequestPromise;return this._onDidInitiateOpenFilesTrustRequest.fire(),this._openFilesTrustRequestPromise}resolveWorkspaceTrustRequest(e){this._workspaceTrustRequestResolver&&(this._workspaceTrustRequestResolver(e??this.workspaceTrustManagementService.isWorkspaceTrusted()),this._workspaceTrustRequestResolver=void 0,this._workspaceTrustRequestPromise=void 0)}cancelWorkspaceTrustRequest(){this._workspaceTrustRequestResolver&&(this._workspaceTrustRequestResolver(void 0),this._workspaceTrustRequestResolver=void 0,this._workspaceTrustRequestPromise=void 0)}async completeWorkspaceTrustRequest(e){if(e===void 0||e===this.workspaceTrustManagementService.isWorkspaceTrusted()){this.resolveWorkspaceTrustRequest(e);return}O.once(this.workspaceTrustManagementService.onDidChangeTrust)(i=>this.resolveWorkspaceTrustRequest(i)),await this.workspaceTrustManagementService.setWorkspaceTrust(e)}async requestWorkspaceTrust(e){if(this.workspaceTrustManagementService.isWorkspaceTrusted())return this.workspaceTrustManagementService.isWorkspaceTrusted();if(!this._workspaceTrustRequestPromise)this._workspaceTrustRequestPromise=new Promise(i=>{this._workspaceTrustRequestResolver=i});else return this._workspaceTrustRequestPromise;return this._onDidInitiateWorkspaceTrustRequest.fire(e),this._workspaceTrustRequestPromise}requestWorkspaceTrustOnStartup(){this._workspaceTrustRequestPromise||(this._workspaceTrustRequestPromise=new Promise(e=>{this._workspaceTrustRequestResolver=e})),this._onDidInitiateWorkspaceTrustRequestOnStartup.fire()}};__=_([v(0,de),v(1,uS)],__);var P9=class extends L{participants=new ao;addWorkspaceTrustTransitionParticipant(t){let e=this.participants.push(t);return te(()=>e())}async participate(t){for(let e of this.participants)await e.participate(t)}dispose(){this.participants.clear(),super.dispose()}},M9=class{_memento;_mementoObject;_acceptsOutOfWorkspaceFilesKey="acceptsOutOfWorkspaceFiles";_isEmptyWorkspaceTrustedKey="isEmptyWorkspaceTrusted";constructor(t){t?(this._memento=new em("workspaceTrust",t),this._mementoObject=this._memento.getMemento(1,1)):this._mementoObject={}}get acceptsOutOfWorkspaceFiles(){return this._mementoObject[this._acceptsOutOfWorkspaceFilesKey]??!1}set acceptsOutOfWorkspaceFiles(t){this._mementoObject[this._acceptsOutOfWorkspaceFilesKey]=t,this._memento?.saveMemento()}get isEmptyWorkspaceTrusted(){return this._mementoObject[this._isEmptyWorkspaceTrustedKey]}set isEmptyWorkspaceTrusted(t){this._mementoObject[this._isEmptyWorkspaceTrustedKey]=t,this._memento?.saveMemento()}};vi(Ote,__,1);var _F=class extends L{constructor(e,i){super();this.logService=e;this.options=i}_onDidChangeFile=this._register(new T);onDidChangeFile=this._onDidChangeFile.event;_onDidWatchError=this._register(new T);onDidWatchError=this._onDidWatchError.event;watch(e,i){return i.recursive||this.options?.watcher?.forceUniversal?this.watchUniversal(e,i):this.watchNonRecursive(e,i)}universalWatcher;universalWatchRequests=[];universalWatchRequestDelayer=this._register(new Zu(0));watchUniversal(e,i){let n={path:this.toWatchPath(e),excludes:i.excludes,includes:i.includes,recursive:i.recursive,filter:i.filter,correlationId:i.correlationId},o=Bu(this.universalWatchRequests,n);return this.refreshUniversalWatchers(),te(()=>{o(),this.refreshUniversalWatchers()})}refreshUniversalWatchers(){this.universalWatchRequestDelayer.trigger(()=>this.doRefreshUniversalWatchers()).catch(e=>Ke(e))}doRefreshUniversalWatchers(){this.universalWatcher||(this.universalWatcher=this._register(this.createUniversalWatcher(i=>this._onDidChangeFile.fire(E_(i)),i=>this.onWatcherLogMessage(i),this.logService.getLevel()===1)),this._register(this.logService.onDidChangeLogLevel(()=>{this.universalWatcher?.setVerboseLogging(this.logService.getLevel()===1)})));let e=this.options?.watcher?.recursive?.usePolling;if(e===!0)for(let i of this.universalWatchRequests)L9(i)&&(i.pollingInterval=this.options?.watcher?.recursive?.pollingInterval??5e3);else if(Array.isArray(e))for(let i of this.universalWatchRequests)L9(i)&&e.includes(i.path)&&(i.pollingInterval=this.options?.watcher?.recursive?.pollingInterval??5e3);return this.universalWatcher.watch(this.universalWatchRequests)}nonRecursiveWatcher;nonRecursiveWatchRequests=[];nonRecursiveWatchRequestDelayer=this._register(new Zu(0));watchNonRecursive(e,i){let n={path:this.toWatchPath(e),excludes:i.excludes,includes:i.includes,recursive:!1,filter:i.filter,correlationId:i.correlationId},o=Bu(this.nonRecursiveWatchRequests,n);return this.refreshNonRecursiveWatchers(),te(()=>{o(),this.refreshNonRecursiveWatchers()})}refreshNonRecursiveWatchers(){this.nonRecursiveWatchRequestDelayer.trigger(()=>this.doRefreshNonRecursiveWatchers()).catch(e=>Ke(e))}doRefreshNonRecursiveWatchers(){return this.nonRecursiveWatcher||(this.nonRecursiveWatcher=this._register(this.createNonRecursiveWatcher(e=>this._onDidChangeFile.fire(E_(e)),e=>this.onWatcherLogMessage(e),this.logService.getLevel()===1)),this._register(this.logService.onDidChangeLogLevel(()=>{this.nonRecursiveWatcher?.setVerboseLogging(this.logService.getLevel()===1)}))),this.nonRecursiveWatcher.watch(this.nonRecursiveWatchRequests)}onWatcherLogMessage(e){e.type==="error"&&this._onDidWatchError.fire(e.message),this.logWatcherMessage(e)}logWatcherMessage(e){this.logService[e.type](e.message)}toFilePath(e){return sl(e.fsPath)}toWatchPath(e){let i=this.toFilePath(e);return aG(i)}};var DF=class extends bF{constructor(e,i,n,o){super(e,i,n);this.utilityProcessWorkerWorkbenchService=o;this.init()}createWatcher(e){return Wd.toService(aI((async()=>{let{client:n,onDidTerminate:o}=e.add(await this.utilityProcessWorkerWorkbenchService.createWorker({moduleId:"vs/platform/files/node/watcher/watcherMain",type:"fileWatcher"}));return o.then(({reason:s})=>{s?.code===0?this.trace(`terminated by itself with code ${s.code}, signal: ${s.signal}`):this.onError(`terminated by itself unexpectedly with code ${s?.code}, signal: ${s?.signal} (ETERM)`)}),n.getChannel("watcher")})()))}};var LF=class extends _F{constructor(e,i,n,o){super(n,{watcher:{forceUniversal:!0}});this.mainProcessService=e;this.utilityProcessWorkerWorkbenchService=i;this.loggerService=o;this.registerListeners()}provider=this._register(new yS(this.mainProcessService.getChannel(Gte),{pathCaseSensitive:_t,trash:!0}));registerListeners(){this._register(this.provider.onDidChangeFile(e=>this._onDidChangeFile.fire(e))),this._register(this.provider.onDidWatchError(e=>this._onDidWatchError.fire(e)))}get onDidChangeCapabilities(){return this.provider.onDidChangeCapabilities}get capabilities(){return this.provider.capabilities}stat(e){return this.provider.stat(e)}readdir(e){return this.provider.readdir(e)}readFile(e,i){return this.provider.readFile(e,i)}readFileStream(e,i,n){return this.provider.readFileStream(e,i,n)}writeFile(e,i,n){return this.provider.writeFile(e,i,n)}open(e,i){return this.provider.open(e,i)}close(e){return this.provider.close(e)}read(e,i,n,o,s){return this.provider.read(e,i,n,o,s)}write(e,i,n,o,s){return this.provider.write(e,i,n,o,s)}mkdir(e){return this.provider.mkdir(e)}delete(e,i){return this.provider.delete(e,i)}rename(e,i,n){return this.provider.rename(e,i,n)}copy(e,i,n){return this.provider.copy(e,i,n)}cloneFile(e,i){return this.provider.cloneFile(e,i)}createUniversalWatcher(e,i,n){return new DF(o=>e(o),o=>i(o),n,this.utilityProcessWorkerWorkbenchService)}createNonRecursiveWatcher(){throw new Error("Method not implemented in sandbox.")}_watcherLogService=void 0;get watcherLogService(){return this._watcherLogService||(this._watcherLogService=new CS(this.loggerService.createLogger("fileWatcher",{name:h("fileWatcher","File Watcher")}))),this._watcherLogService}logWatcherMessage(e){this.watcherLogService[e.type](e.message),e.type!=="trace"&&e.type!=="debug"&&super.logWatcherMessage(e)}};var kF=class extends L{constructor(e,i,n,o,s,a){super();this.fileSystemScheme=e;this.fileSystemProvider=i;this.userDataScheme=n;this.userDataProfilesService=o;this.uriIdentityService=s;this.logService=a;this.updateAtomicReadWritesResources(),this._register(o.onDidChangeProfiles(()=>this.updateAtomicReadWritesResources())),this._register(this.fileSystemProvider.onDidChangeFile(l=>this.handleFileChanges(l)))}capabilities=this.fileSystemProvider.capabilities;onDidChangeCapabilities=this.fileSystemProvider.onDidChangeCapabilities;_onDidChangeFile=this._register(new T);onDidChangeFile=this._onDidChangeFile.event;watchResources=_a.forUris(()=>!(this.capabilities&1024));atomicReadWriteResources=new Wb(e=>this.uriIdentityService.extUri.getComparisonKey(this.toFileSystemResource(e)));updateAtomicReadWritesResources(){this.atomicReadWriteResources.clear();for(let e of this.userDataProfilesService.profiles)this.atomicReadWriteResources.add(e.settingsResource),this.atomicReadWriteResources.add(e.keybindingsResource),this.atomicReadWriteResources.add(e.tasksResource),this.atomicReadWriteResources.add(e.extensionsResource)}open(e,i){return this.fileSystemProvider.open(this.toFileSystemResource(e),i)}close(e){return this.fileSystemProvider.close(e)}read(e,i,n,o,s){return this.fileSystemProvider.read(e,i,n,o,s)}write(e,i,n,o,s){return this.fileSystemProvider.write(e,i,n,o,s)}watch(e,i){this.watchResources.set(e,e);let n=this.fileSystemProvider.watch(this.toFileSystemResource(e),i);return te(()=>{this.watchResources.delete(e),n.dispose()})}stat(e){return this.fileSystemProvider.stat(this.toFileSystemResource(e))}mkdir(e){return this.fileSystemProvider.mkdir(this.toFileSystemResource(e))}rename(e,i,n){return this.fileSystemProvider.rename(this.toFileSystemResource(e),this.toFileSystemResource(i),n)}readFile(e,i){return this.fileSystemProvider.readFile(this.toFileSystemResource(e),i)}readFileStream(e,i,n){return this.fileSystemProvider.readFileStream(this.toFileSystemResource(e),i,n)}readdir(e){return this.fileSystemProvider.readdir(this.toFileSystemResource(e))}enforceAtomicReadFile(e){return this.atomicReadWriteResources.has(e)}writeFile(e,i,n){return this.fileSystemProvider.writeFile(this.toFileSystemResource(e),i,n)}enforceAtomicWriteFile(e){return this.atomicReadWriteResources.has(e)?{postfix:".vsctmp"}:!1}delete(e,i){return this.fileSystemProvider.delete(this.toFileSystemResource(e),i)}copy(e,i,n){if(fw(this.fileSystemProvider))return this.fileSystemProvider.copy(this.toFileSystemResource(e),this.toFileSystemResource(i),n);throw new Error("copy not supported")}cloneFile(e,i){if(qD(this.fileSystemProvider))return this.fileSystemProvider.cloneFile(this.toFileSystemResource(e),this.toFileSystemResource(i));throw new Error("clone not supported")}handleFileChanges(e){let i=[];for(let n of e){if(n.resource.scheme!==this.fileSystemScheme)continue;let o=this.toUserDataResource(n.resource);this.watchResources.findSubstr(o)&&i.push({resource:o,type:n.type,cId:n.cId})}i.length&&(this.logService.debug("User data changed"),this._onDidChangeFile.fire(i))}toFileSystemResource(e){return e.with({scheme:this.fileSystemScheme})}toUserDataResource(e){return e.with({scheme:this.userDataScheme})}};var RF=class extends L{constructor(e,i,n){super();this.profilesHome=i;this.channel=n;this._profiles=e.map(o=>hl(o,this.profilesHome.scheme)),this._register(this.channel.listen("onDidChangeProfiles")(o=>{let s=o.added.map(d=>hl(d,this.profilesHome.scheme)),a=o.removed.map(d=>hl(d,this.profilesHome.scheme)),l=o.updated.map(d=>hl(d,this.profilesHome.scheme));this._profiles=o.all.map(d=>hl(d,this.profilesHome.scheme)),this._onDidChangeProfiles.fire({added:s,removed:a,updated:l,all:this.profiles})})),this.onDidResetWorkspaces=this.channel.listen("onDidResetWorkspaces")}_serviceBrand;get defaultProfile(){return this.profiles[0]}_profiles=[];get profiles(){return this._profiles}_onDidChangeProfiles=this._register(new T);onDidChangeProfiles=this._onDidChangeProfiles.event;onDidResetWorkspaces;enabled=!0;setEnablement(e){this.enabled=e}isEnabled(){return this.enabled}async createNamedProfile(e,i,n){let o=await this.channel.call("createNamedProfile",[e,i,n]);return hl(o,this.profilesHome.scheme)}async createProfile(e,i,n,o){let s=await this.channel.call("createProfile",[e,i,n,o]);return hl(s,this.profilesHome.scheme)}async createTransientProfile(e){let i=await this.channel.call("createTransientProfile",[e]);return hl(i,this.profilesHome.scheme)}async setProfileForWorkspace(e,i){await this.channel.call("setProfileForWorkspace",[e,i])}removeProfile(e){return this.channel.call("removeProfile",[e])}async updateProfile(e,i){let n=await this.channel.call("updateProfile",[e,i]);return hl(n,this.profilesHome.scheme)}resetWorkspaces(){return this.channel.call("resetWorkspaces")}cleanUp(){return this.channel.call("cleanUp")}cleanUpTransientProfiles(){return this.channel.call("cleanUpTransientProfiles")}};var AF=class extends cL{constructor(e,i){super();this.channel=i;for(let n in e){let{definition:o,value:s}=e[n];this.policyDefinitions[n]=o,s!==void 0&&this.policies.set(n,s)}this.channel.listen("onDidChange")(n=>{for(let o in n){let s=n[o];s===null?this.policies.delete(o):this.policies.set(o,s)}this._onDidChange.fire(Object.keys(n))})}async _updatePolicyDefinitions(e){let i=await this.channel.call("updatePolicyDefinitions",e);for(let n in i)this.policies.set(n,i[n])}};var PF=class extends L{_serviceBrand;_onDidChangeCurrentProfile=this._register(new T);onDidChangeCurrentProfile=this._onDidChangeCurrentProfile.event;_currentProfile;get currentProfile(){return this._currentProfile}constructor(t){super(),this._currentProfile=t}async updateCurrentProfile(t){if($t(this._currentProfile,t))return;let e=this._currentProfile;this._currentProfile=t;let i=[];this._onDidChangeCurrentProfile.fire({previous:e,profile:t,join(n){i.push(n)}}),await Vi.settled(i)}getShortName(t){return!t.isDefault&&t.shortName&&ye.fromId(t.shortName)?t.shortName:`$(${JJ.id})`}};var O9=class extends L{_onData=new T;onData=this._onData.event;_onOpen=this._register(new T);onOpen=this._onOpen.event;_onClose=this._register(new T);onClose=this._onClose.event;_onError=this._register(new T);onError=this._onError.event;_debugLabel;_socket;_fileReader;_queue;_isReading;_isClosed;_socketMessageListener;traceSocketEvent(t,e){WP.traceSocketEvent(this._socket,this._debugLabel,t,e)}constructor(t,e){super(),this._debugLabel=e,this._socket=new WebSocket(t),this.traceSocketEvent("created",{type:"BrowserWebSocket",url:t}),this._fileReader=new FileReader,this._queue=[],this._isReading=!1,this._isClosed=!1,this._fileReader.onload=d=>{this._isReading=!1;let c=d.target.result;this.traceSocketEvent("read",c),this._onData.fire(c),this._queue.length>0&&i(this._queue.shift())};let i=d=>{if(this._isReading){this._queue.push(d);return}this._isReading=!0,this._fileReader.readAsArrayBuffer(d)};this._socketMessageListener=d=>{let c=d.data;this.traceSocketEvent("browserWebSocketBlobReceived",{type:c.type,size:c.size}),i(c)},this._socket.addEventListener("message",this._socketMessageListener),this._register(M(this._socket,"open",d=>{this.traceSocketEvent("open"),this._onOpen.fire()}));let n=null,o=()=>{let d=n;n=null,this._onError.fire(d)},s=this._register(new Et(o,0)),a=d=>{s.cancel(),n=d,s.schedule()},l=d=>{s.cancel(),n=d,o()};this._register(M(this._socket,"close",d=>{this.traceSocketEvent("close",{code:d.code,reason:d.reason,wasClean:d.wasClean}),this._isClosed=!0,n&&(navigator.onLine?d.wasClean?(s.cancel(),o()):l(new _l(d.reason||`WebSocket close with status code ${d.code}`,"TemporarilyNotAvailable",d)):l(new _l("Browser is offline","TemporarilyNotAvailable",d))),this._onClose.fire({code:d.code,reason:d.reason,wasClean:d.wasClean,event:d})})),this._register(M(this._socket,"error",d=>{this.traceSocketEvent("error",{message:d?.message}),a(d)}))}send(t){this._isClosed||(this.traceSocketEvent("write",t),this._socket.send(t))}close(){this._isClosed=!0,this.traceSocketEvent("close"),this._socket.close(),this._socket.removeEventListener("message",this._socketMessageListener),this.dispose()}},Dhe=new class{create(r,t){return new O9(r,t)}},N9=class{socket;debugLabel;traceSocketEvent(t,e){typeof this.socket.traceSocketEvent=="function"?this.socket.traceSocketEvent(t,e):WP.traceSocketEvent(this.socket,this.debugLabel,t,e)}constructor(t,e){this.socket=t,this.debugLabel=e}dispose(){this.socket.close()}onData(t){return this.socket.onData(e=>t(qe.wrap(new Uint8Array(e))))}onClose(t){let e=i=>{t(typeof i>"u"?i:{type:1,code:i.code,reason:i.reason,wasClean:i.wasClean,event:i.event})};return this.socket.onClose(e)}onEnd(t){return L.None}write(t){this.socket.send(t.buffer)}end(){this.socket.close()}drain(){return Promise.resolve()}},MF=class{_webSocketFactory;constructor(t){this._webSocketFactory=t||Dhe}supports(t){return!0}connect({host:t,port:e},i,n,o){return new Promise((s,a)=>{let l=/^https:/.test(ne.location.href)?"wss":"ws",d=this._webSocketFactory.create(`${l}://${/:/.test(t)&&!/\[/.test(t)?`[${t}]`:t}:${e}${i}?${n}&skipWebSocketFrames=false`,o),c=d.onError(a);d.onOpen(()=>{c.dispose(),s(new N9(d,o))})})}};var F9=class extends L{constructor(e){super();this.configuration=e;this.init()}init(){this.reviveUris(),Bg(!!this.configuration.fullscreen,ne)}reviveUris(){let e=vG(this.configuration.workspace);($u(e)||dl(e))&&(this.configuration.workspace=e);let i=this.configuration.filesToWait,n=i?.paths;for(let o of[n,this.configuration.filesToOpenOrCreate,this.configuration.filesToDiff,this.configuration.filesToMerge])if(Array.isArray(o))for(let s of o)s.fileUri&&(s.fileUri=q.revive(s.fileUri));i&&(i.waitMarkerFileUri=q.revive(i.waitMarkerFileUri))}async open(){let[e]=await Promise.all([this.initServices(),r$(ne)]);this.applyWindowZoomLevel(e.configurationService);let i=new WN(ne.document.body,{extraClasses:this.getExtraClasses()},e.serviceCollection,e.logService);this.registerListeners(i,e.storageService);let n=i.startup();this._register(n.createInstance(og))}applyWindowZoomLevel(e){let i;if(this.configuration.isCustomZoomLevel&&typeof this.configuration.zoomLevel=="number")i=this.configuration.zoomLevel;else{let n=e.getValue();i=typeof n.window?.zoomLevel=="number"?n.window.zoomLevel:0}UN(i,ne)}getExtraClasses(){return be&&J9(this.configuration.os.release)?["macos-bigsur-or-newer"]:[]}registerListeners(e,i){this._register(e.onWillShutdown(n=>n.join(i.close(),{id:"join.closeStorage",label:h("join.closeStorage","Saving UI state")}))),this._register(e.onDidShutdown(()=>this.dispose()))}async initServices(){let e=new Wr,i=this._register(new EF(this.configuration.windowId));e.set(_u,i);let n=this.configuration.policiesData?new AF(this.configuration.policiesData,i.getChannel("policy")):new fv;e.set(uL,n);let o={_serviceBrand:void 0,...t7};e.set(Qn,o);let s=new bn(this.configuration,o);e.set(HN,s);let a=[...this.configuration.loggers.global.map(H=>({...H,resource:q.revive(H.resource)})),...this.configuration.loggers.window.map(H=>({...H,resource:q.revive(H.resource),hidden:!0}))],l=new TF(this.configuration.windowId,this.configuration.logLevel,s.windowLogsPath,a,i.getChannel("logger"));e.set(x3,l);let d=this._register(new xF(l,s));e.set(Gt,d),A_&&d.info("workbench#open()"),d.getLevel()===1&&d.trace("workbench#open(): with configuration",hW({...this.configuration,nls:void 0}));let c=new hS(this.configuration.windowId,d);e.set(c_,c);let u=new sS(this.configuration.windowId,d,i);e.set(YN,u);let p=Wd.toService(i.getChannel("sign"));e.set(dI,p);let m=this._register(new sg(d));e.set(ai,m);let g=new gS(o,new mS(s.window.id,i,m));e.set(Ud,g);let f=this._register(new LF(i,u,d,l));m.registerProvider(he.file,f);let b=new Pb(m);e.set(_r,b);let y=new RF(this.configuration.profiles.all,q.revive(this.configuration.profiles.home).with({scheme:s.userRoamingDataHome.scheme}),i.getChannel("userDataProfiles"));e.set(Dv,y);let I=new PF(hl(this.configuration.profiles.profile,y.profilesHome.scheme));e.set(Qa,I),m.registerProvider(he.vscodeUserData,this._register(new kF(he.file,f,he.vscodeUserData,y,b,d)));let E=new UP;E.register(0,new MF(null)),e.set(lI,E);let S=this._register(new bS(E,I,s,o,g,p,d));e.set(vm,S),this._register(vF.register(S,m,d));let w=this.resolveWorkspaceIdentifier(s),[D,k]=await Promise.all([this.createWorkspaceService(w,s,I,y,m,S,b,d,n).then(H=>(e.set(Xt,H),e.set(XR,H),H)),this.createStorageService(w,s,I,y,i).then(H=>(e.set(tt,H),H)),this.createKeyboardLayoutService(i).then(H=>(e.set($te,H),H))]),R=new SS(D,s);e.set(sF,R);let A=new wS(D,g,k,b,s,D,R,m);return e.set(uS,A),D.updateWorkspaceTrust(A.isWorkspaceTrusted()),this._register(A.onDidChangeTrust(()=>D.updateWorkspaceTrust(A.isWorkspaceTrusted()))),{serviceCollection:e,logService:d,storageService:k,configurationService:D}}resolveWorkspaceIdentifier(e){return this.configuration.workspace?this.configuration.workspace:ov(this.configuration.backupPath,e.isExtensionDevelopment)}async createWorkspaceService(e,i,n,o,s,a,l,d,c){let u=new yF([he.file,he.vscodeUserData],i,s),p=new dF({remoteAuthority:i.remoteAuthority,configurationCache:u},i,n,o,s,a,l,d,c);try{return await p.initialize(e),p}catch(m){return Ke(m),p}}async createStorageService(e,i,n,o,s){let a=new fF(e,n,o,s,i);try{return await a.initialize(),a}catch(l){return Ke(l),a}}async createKeyboardLayoutService(e){let i=new IS(e);try{return await i.initialize(),i}catch(n){return Ke(n),i}}};function $9n(r){return new F9(r).open()}export{F9 as DesktopMain,$9n as main};
