{
  "version": 3,
  "sources": ["../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/electron-sandbox/window.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport \"./media/window.css\";\nimport {\n\tgetZoomFactor,\n\tgetZoomLevel,\n\tonDidChangeZoomLevel,\n\tsetFullscreen,\n} from \"../../base/browser/browser.js\";\nimport {\n\tEventHelper,\n\tEventType,\n\tModifierKeyEmitter,\n\taddDisposableListener,\n\tgetActiveElement,\n\tgetWindow,\n\tgetWindowById,\n\tgetWindows,\n\thasWindow,\n} from \"../../base/browser/dom.js\";\nimport { ActionBar } from \"../../base/browser/ui/actionbar/actionbar.js\";\nimport { mainWindow } from \"../../base/browser/window.js\";\nimport {\n\tAction,\n\tSeparator,\n\ttype WorkbenchActionExecutedClassification,\n\ttype WorkbenchActionExecutedEvent,\n} from \"../../base/common/actions.js\";\nimport { isESM } from \"../../base/common/amd.js\";\nimport { coalesce } from \"../../base/common/arrays.js\";\nimport { RunOnceScheduler } from \"../../base/common/async.js\";\nimport { Codicon } from \"../../base/common/codicons.js\";\nimport { toErrorMessage } from \"../../base/common/errorMessage.js\";\nimport { onUnexpectedError } from \"../../base/common/errors.js\";\nimport { Event } from \"../../base/common/event.js\";\nimport {\n\tDisposable,\n\tDisposableStore,\n\tMutableDisposable,\n\ttoDisposable,\n} from \"../../base/common/lifecycle.js\";\nimport { Schemas } from \"../../base/common/network.js\";\nimport { equals } from \"../../base/common/objects.js\";\nimport { posix } from \"../../base/common/path.js\";\nimport { isCI, isMacintosh, isWindows } from \"../../base/common/platform.js\";\nimport { dirname } from \"../../base/common/resources.js\";\nimport { ThemeIcon } from \"../../base/common/themables.js\";\nimport { assertIsDefined } from \"../../base/common/types.js\";\nimport { URI } from \"../../base/common/uri.js\";\nimport type { AuthInfo } from \"../../base/parts/sandbox/electron-sandbox/electronTypes.js\";\nimport {\n\tipcRenderer,\n\tprocess,\n} from \"../../base/parts/sandbox/electron-sandbox/globals.js\";\nimport { localize } from \"../../nls.js\";\nimport {\n\tAccessibilitySupport,\n\tIAccessibilityService,\n} from \"../../platform/accessibility/common/accessibility.js\";\nimport type { ICommandAction } from \"../../platform/action/common/action.js\";\nimport { createAndFillInActionBarActions } from \"../../platform/actions/browser/menuEntryActionViewItem.js\";\nimport {\n\ttype IMenu,\n\tIMenuService,\n\tMenuId,\n\tMenuItemAction,\n\tMenuRegistry,\n} from \"../../platform/actions/common/actions.js\";\nimport {\n\tCommandsRegistry,\n\tICommandService,\n} from \"../../platform/commands/common/commands.js\";\nimport {\n\tConfigurationTarget,\n\tIConfigurationService,\n} from \"../../platform/configuration/common/configuration.js\";\nimport { IDialogService } from \"../../platform/dialogs/common/dialogs.js\";\nimport type { IResourceEditorInput } from \"../../platform/editor/common/editor.js\";\nimport { IFileService } from \"../../platform/files/common/files.js\";\nimport { nativeHoverDelegate } from \"../../platform/hover/browser/hover.js\";\nimport { IInstantiationService } from \"../../platform/instantiation/common/instantiation.js\";\nimport { ISharedProcessService } from \"../../platform/ipc/electron-sandbox/services.js\";\nimport { IKeybindingService } from \"../../platform/keybinding/common/keybinding.js\";\nimport { ILabelService } from \"../../platform/label/common/label.js\";\nimport { ILogService } from \"../../platform/log/common/log.js\";\nimport { INativeHostService } from \"../../platform/native/common/native.js\";\nimport {\n\tINotificationService,\n\tNeverShowAgainScope,\n\tNotificationPriority,\n\tSeverity,\n} from \"../../platform/notification/common/notification.js\";\nimport {\n\tIOpenerService,\n\ttype IResolvedExternalUri,\n\ttype OpenOptions,\n} from \"../../platform/opener/common/opener.js\";\nimport { IProductService } from \"../../platform/product/common/productService.js\";\nimport {\n\tIProgressService,\n\tProgressLocation,\n} from \"../../platform/progress/common/progress.js\";\nimport type {\n\tIAddress,\n\tIAddressProvider,\n} from \"../../platform/remote/common/remoteAgentConnection.js\";\nimport { IRemoteAuthorityResolverService } from \"../../platform/remote/common/remoteAuthorityResolver.js\";\nimport {\n\tIStorageService,\n\tStorageScope,\n\tStorageTarget,\n} from \"../../platform/storage/common/storage.js\";\nimport { ITelemetryService } from \"../../platform/telemetry/common/telemetry.js\";\nimport {\n\tITunnelService,\n\ttype RemoteTunnel,\n\textractLocalHostUriMetaDataForPortMapping,\n\textractQueryLocalHostUriMetaDataForPortMapping,\n} from \"../../platform/tunnel/common/tunnel.js\";\nimport { IUriIdentityService } from \"../../platform/uriIdentity/common/uriIdentity.js\";\nimport {\n\ttype IAddFoldersRequest,\n\ttype INativeOpenFileRequest,\n\ttype INativeRunActionInWindowRequest,\n\ttype INativeRunKeybindingInWindowRequest,\n\ttype IOpenFileRequest,\n\tWindowMinimumSize,\n\thasNativeTitlebar,\n} from \"../../platform/window/common/window.js\";\nimport {\n\tApplyZoomTarget,\n\tapplyZoom,\n} from \"../../platform/window/electron-sandbox/window.js\";\nimport {\n\tIWorkspaceContextService,\n\tWorkbenchState,\n} from \"../../platform/workspace/common/workspace.js\";\nimport type { IWorkspaceFolderCreationData } from \"../../platform/workspaces/common/workspaces.js\";\nimport { whenEditorClosed } from \"../browser/editor.js\";\nimport { BaseWindow } from \"../browser/window.js\";\nimport { DynamicWorkbenchSecurityConfiguration } from \"../common/configuration.js\";\nimport { getWorkbenchContribution } from \"../common/contributions.js\";\nimport {\n\tEditorResourceAccessor,\n\ttype IEditorPane,\n\ttype IResourceDiffEditorInput,\n\ttype IResourceMergeEditorInput,\n\ttype IUntitledTextResourceEditorInput,\n\ttype IUntypedEditorInput,\n\tSideBySideEditor,\n\tisResourceEditorInput,\n\tpathsToEditors,\n} from \"../common/editor.js\";\nimport { IBannerService } from \"../services/banner/browser/bannerService.js\";\nimport { registerWindowDriver } from \"../services/driver/electron-sandbox/driver.js\";\nimport {\n\tIEditorGroupsService,\n\ttype IEditorPart,\n} from \"../services/editor/common/editorGroupsService.js\";\nimport { IEditorService } from \"../services/editor/common/editorService.js\";\nimport { INativeWorkbenchEnvironmentService } from \"../services/environment/electron-sandbox/environmentService.js\";\nimport { IFilesConfigurationService } from \"../services/filesConfiguration/common/filesConfigurationService.js\";\nimport { IHostService } from \"../services/host/browser/host.js\";\nimport { IIntegrityService } from \"../services/integrity/common/integrity.js\";\nimport {\n\tIWorkbenchLayoutService,\n\tParts,\n\tPosition,\n\tpositionFromString,\n} from \"../services/layout/browser/layoutService.js\";\nimport {\n\ttype BeforeShutdownErrorEvent,\n\ttype BeforeShutdownEvent,\n\tILifecycleService,\n\tLifecyclePhase,\n\tShutdownReason,\n\ttype WillShutdownEvent,\n} from \"../services/lifecycle/common/lifecycle.js\";\nimport { IPreferencesService } from \"../services/preferences/common/preferences.js\";\nimport {\n\tIStatusbarService,\n\tShowTooltipCommand,\n\tStatusbarAlignment,\n} from \"../services/statusbar/browser/statusbar.js\";\nimport { IWorkbenchThemeService } from \"../services/themes/common/workbenchThemeService.js\";\nimport { ITitleService } from \"../services/title/browser/titleService.js\";\nimport { IUtilityProcessWorkerWorkbenchService } from \"../services/utilityProcess/electron-sandbox/utilityProcessWorkerWorkbenchService.js\";\nimport { WorkingCopyCapabilities } from \"../services/workingCopy/common/workingCopy.js\";\nimport { IWorkingCopyService } from \"../services/workingCopy/common/workingCopyService.js\";\nimport { IWorkspaceEditingService } from \"../services/workspaces/common/workspaceEditing.js\";\n\nexport class NativeWindow extends BaseWindow {\n\tprivate readonly customTitleContextMenuDisposable = this._register(\n\t\tnew DisposableStore(),\n\t);\n\n\tprivate readonly addFoldersScheduler = this._register(\n\t\tnew RunOnceScheduler(() => this.doAddFolders(), 100),\n\t);\n\tprivate pendingFoldersToAdd: URI[] = [];\n\n\tprivate isDocumentedEdited = false;\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IEditorGroupsService\n\t\tprivate readonly editorGroupService: IEditorGroupsService,\n\t\t@IConfigurationService\n\t\tprivate readonly configurationService: IConfigurationService,\n\t\t@ITitleService private readonly titleService: ITitleService,\n\t\t@IWorkbenchThemeService protected themeService: IWorkbenchThemeService,\n\t\t@INotificationService\n\t\tprivate readonly notificationService: INotificationService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IKeybindingService\n\t\tprivate readonly keybindingService: IKeybindingService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IWorkspaceEditingService\n\t\tprivate readonly workspaceEditingService: IWorkspaceEditingService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@IIntegrityService private readonly integrityService: IIntegrityService,\n\t\t@INativeWorkbenchEnvironmentService\n\t\tprivate readonly nativeEnvironmentService: INativeWorkbenchEnvironmentService,\n\t\t@IAccessibilityService\n\t\tprivate readonly accessibilityService: IAccessibilityService,\n\t\t@IWorkspaceContextService\n\t\tprivate readonly contextService: IWorkspaceContextService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@INativeHostService\n\t\tprivate readonly nativeHostService: INativeHostService,\n\t\t@ITunnelService private readonly tunnelService: ITunnelService,\n\t\t@IWorkbenchLayoutService\n\t\tprivate readonly layoutService: IWorkbenchLayoutService,\n\t\t@IWorkingCopyService\n\t\tprivate readonly workingCopyService: IWorkingCopyService,\n\t\t@IFilesConfigurationService\n\t\tprivate readonly filesConfigurationService: IFilesConfigurationService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IRemoteAuthorityResolverService\n\t\tprivate readonly remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IInstantiationService\n\t\tprivate readonly instantiationService: IInstantiationService,\n\t\t@ISharedProcessService\n\t\tprivate readonly sharedProcessService: ISharedProcessService,\n\t\t@IProgressService private readonly progressService: IProgressService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IBannerService private readonly bannerService: IBannerService,\n\t\t@IUriIdentityService\n\t\tprivate readonly uriIdentityService: IUriIdentityService,\n\t\t@IPreferencesService\n\t\tprivate readonly preferencesService: IPreferencesService,\n\t\t@IUtilityProcessWorkerWorkbenchService\n\t\tprivate readonly utilityProcessWorkerWorkbenchService: IUtilityProcessWorkerWorkbenchService,\n\t\t@IHostService hostService: IHostService,\n\t) {\n\t\tsuper(mainWindow, undefined, hostService, nativeEnvironmentService);\n\n\t\tthis.registerListeners();\n\t\tthis.create();\n\t}\n\n\tprotected registerListeners(): void {\n\t\t// Layout\n\t\tthis._register(\n\t\t\taddDisposableListener(mainWindow, EventType.RESIZE, () =>\n\t\t\t\tthis.layoutService.layout(),\n\t\t\t),\n\t\t);\n\n\t\t// React to editor input changes\n\t\tthis._register(\n\t\t\tthis.editorService.onDidActiveEditorChange(() =>\n\t\t\t\tthis.updateTouchbarMenu(),\n\t\t\t),\n\t\t);\n\n\t\t// Prevent opening a real URL inside the window\n\t\tfor (const event of [EventType.DRAG_OVER, EventType.DROP]) {\n\t\t\tthis._register(\n\t\t\t\taddDisposableListener(\n\t\t\t\t\tmainWindow.document.body,\n\t\t\t\t\tevent,\n\t\t\t\t\t(e: DragEvent) => {\n\t\t\t\t\t\tEventHelper.stop(e);\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\t// Support `runAction` event\n\t\tipcRenderer.on(\n\t\t\t\"vscode:runAction\",\n\t\t\tasync (\n\t\t\t\tevent: unknown,\n\t\t\t\trequest: INativeRunActionInWindowRequest,\n\t\t\t) => {\n\t\t\t\tconst args: unknown[] = request.args || [];\n\n\t\t\t\t// If we run an action from the touchbar, we fill in the currently active resource\n\t\t\t\t// as payload because the touch bar items are context aware depending on the editor\n\t\t\t\tif (request.from === \"touchbar\") {\n\t\t\t\t\tconst activeEditor = this.editorService.activeEditor;\n\t\t\t\t\tif (activeEditor) {\n\t\t\t\t\t\tconst resource = EditorResourceAccessor.getOriginalUri(\n\t\t\t\t\t\t\tactiveEditor,\n\t\t\t\t\t\t\t{ supportSideBySide: SideBySideEditor.PRIMARY },\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (resource) {\n\t\t\t\t\t\t\targs.push(resource);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\targs.push({ from: request.from });\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tawait this.commandService.executeCommand(\n\t\t\t\t\t\trequest.id,\n\t\t\t\t\t\t...args,\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.telemetryService.publicLog2<\n\t\t\t\t\t\tWorkbenchActionExecutedEvent,\n\t\t\t\t\t\tWorkbenchActionExecutedClassification\n\t\t\t\t\t>(\"workbenchActionExecuted\", {\n\t\t\t\t\t\tid: request.id,\n\t\t\t\t\t\tfrom: request.from,\n\t\t\t\t\t});\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\t// Support runKeybinding event\n\t\tipcRenderer.on(\n\t\t\t\"vscode:runKeybinding\",\n\t\t\t(event: unknown, request: INativeRunKeybindingInWindowRequest) => {\n\t\t\t\tconst activeElement = getActiveElement();\n\t\t\t\tif (activeElement) {\n\t\t\t\t\tthis.keybindingService.dispatchByUserSettingsLabel(\n\t\t\t\t\t\trequest.userSettingsLabel,\n\t\t\t\t\t\tactiveElement,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\t// Error reporting from main\n\t\tipcRenderer.on(\n\t\t\t\"vscode:reportError\",\n\t\t\t(event: unknown, error: string) => {\n\t\t\t\tif (error) {\n\t\t\t\t\tonUnexpectedError(JSON.parse(error));\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\t// Shared Process crash reported from main\n\t\tipcRenderer.on(\n\t\t\t\"vscode:reportSharedProcessCrash\",\n\t\t\t(event: unknown, error: string) => {\n\t\t\t\tthis.notificationService.prompt(\n\t\t\t\t\tSeverity.Error,\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"sharedProcessCrash\",\n\t\t\t\t\t\t\"A shared background process terminated unexpectedly. Please restart the application to recover.\",\n\t\t\t\t\t),\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: localize(\"restart\", \"Restart\"),\n\t\t\t\t\t\t\trun: () => this.nativeHostService.relaunch(),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t{\n\t\t\t\t\t\tpriority: NotificationPriority.URGENT,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\t// Support openFiles event for existing and new files\n\t\tipcRenderer.on(\n\t\t\t\"vscode:openFiles\",\n\t\t\t(event: unknown, request: IOpenFileRequest) => {\n\t\t\t\tthis.onOpenFiles(request);\n\t\t\t},\n\t\t);\n\n\t\t// Support addFolders event if we have a workspace opened\n\t\tipcRenderer.on(\n\t\t\t\"vscode:addFolders\",\n\t\t\t(event: unknown, request: IAddFoldersRequest) => {\n\t\t\t\tthis.onAddFoldersRequest(request);\n\t\t\t},\n\t\t);\n\n\t\t// Message support\n\t\tipcRenderer.on(\n\t\t\t\"vscode:showInfoMessage\",\n\t\t\t(event: unknown, message: string) => {\n\t\t\t\tthis.notificationService.info(message);\n\t\t\t},\n\t\t);\n\n\t\t// Shell Environment Issue Notifications\n\t\tipcRenderer.on(\n\t\t\t\"vscode:showResolveShellEnvError\",\n\t\t\t(event: unknown, message: string) => {\n\t\t\t\tthis.notificationService.prompt(Severity.Error, message, [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: localize(\"restart\", \"Restart\"),\n\t\t\t\t\t\trun: () => this.nativeHostService.relaunch(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: localize(\"configure\", \"Configure\"),\n\t\t\t\t\t\trun: () =>\n\t\t\t\t\t\t\tthis.preferencesService.openUserSettings({\n\t\t\t\t\t\t\t\tquery: \"application.shellEnvironmentResolutionTimeout\",\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: localize(\"learnMore\", \"Learn More\"),\n\t\t\t\t\t\trun: () =>\n\t\t\t\t\t\t\tthis.openerService.open(\n\t\t\t\t\t\t\t\t\"https://go.microsoft.com/fwlink/?linkid=2149667\",\n\t\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t},\n\t\t);\n\n\t\tipcRenderer.on(\n\t\t\t\"vscode:showCredentialsError\",\n\t\t\t(event: unknown, message: string) => {\n\t\t\t\tthis.notificationService.prompt(\n\t\t\t\t\tSeverity.Error,\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"keychainWriteError\",\n\t\t\t\t\t\t\"Writing login information to the keychain failed with error '{0}'.\",\n\t\t\t\t\t\tmessage,\n\t\t\t\t\t),\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: localize(\n\t\t\t\t\t\t\t\t\"troubleshooting\",\n\t\t\t\t\t\t\t\t\"Troubleshooting Guide\",\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\trun: () =>\n\t\t\t\t\t\t\t\tthis.openerService.open(\n\t\t\t\t\t\t\t\t\t\"https://go.microsoft.com/fwlink/?linkid=2190713\",\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\tipcRenderer.on(\"vscode:showTranslatedBuildWarning\", () => {\n\t\t\tthis.notificationService.prompt(\n\t\t\t\tSeverity.Warning,\n\t\t\t\tlocalize(\n\t\t\t\t\t\"runningTranslated\",\n\t\t\t\t\t\"You are running an emulated version of {0}. For better performance download the native arm64 version of {0} build for your machine.\",\n\t\t\t\t\tthis.productService.nameLong,\n\t\t\t\t),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: localize(\"downloadArmBuild\", \"Download\"),\n\t\t\t\t\t\trun: () => {\n\t\t\t\t\t\t\tconst quality = this.productService.quality;\n\t\t\t\t\t\t\tconst stableURL =\n\t\t\t\t\t\t\t\t\"https://code.visualstudio.com/docs/?dv=osx\";\n\t\t\t\t\t\t\tconst insidersURL =\n\t\t\t\t\t\t\t\t\"https://code.visualstudio.com/docs/?dv=osx&build=insiders\";\n\t\t\t\t\t\t\tthis.openerService.open(\n\t\t\t\t\t\t\t\tquality === \"stable\" ? stableURL : insidersURL,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tpriority: NotificationPriority.URGENT,\n\t\t\t\t},\n\t\t\t);\n\t\t});\n\n\t\tipcRenderer.on(\n\t\t\t\"vscode:showArgvParseWarning\",\n\t\t\t(event: unknown, message: string) => {\n\t\t\t\tthis.notificationService.prompt(\n\t\t\t\t\tSeverity.Warning,\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"showArgvParseWarning\",\n\t\t\t\t\t\t\"The runtime arguments file 'argv.json' contains errors. Please correct them and restart.\",\n\t\t\t\t\t),\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: localize(\n\t\t\t\t\t\t\t\t\"showArgvParseWarningAction\",\n\t\t\t\t\t\t\t\t\"Open File\",\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\trun: () =>\n\t\t\t\t\t\t\t\tthis.editorService.openEditor({\n\t\t\t\t\t\t\t\t\tresource:\n\t\t\t\t\t\t\t\t\t\tthis.nativeEnvironmentService\n\t\t\t\t\t\t\t\t\t\t\t.argvResource,\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t{\n\t\t\t\t\t\tpriority: NotificationPriority.URGENT,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\t// Fullscreen Events\n\t\tipcRenderer.on(\"vscode:enterFullScreen\", () =>\n\t\t\tsetFullscreen(true, mainWindow),\n\t\t);\n\t\tipcRenderer.on(\"vscode:leaveFullScreen\", () =>\n\t\t\tsetFullscreen(false, mainWindow),\n\t\t);\n\n\t\t// Proxy Login Dialog\n\t\tipcRenderer.on(\n\t\t\t\"vscode:openProxyAuthenticationDialog\",\n\t\t\tasync (\n\t\t\t\tevent: unknown,\n\t\t\t\tpayload: {\n\t\t\t\t\tauthInfo: AuthInfo;\n\t\t\t\t\tusername?: string;\n\t\t\t\t\tpassword?: string;\n\t\t\t\t\treplyChannel: string;\n\t\t\t\t},\n\t\t\t) => {\n\t\t\t\tconst rememberCredentialsKey =\n\t\t\t\t\t\"window.rememberProxyCredentials\";\n\t\t\t\tconst rememberCredentials = this.storageService.getBoolean(\n\t\t\t\t\trememberCredentialsKey,\n\t\t\t\t\tStorageScope.APPLICATION,\n\t\t\t\t);\n\t\t\t\tconst result = await this.dialogService.input({\n\t\t\t\t\ttype: \"warning\",\n\t\t\t\t\tmessage: localize(\n\t\t\t\t\t\t\"proxyAuthRequired\",\n\t\t\t\t\t\t\"Proxy Authentication Required\",\n\t\t\t\t\t),\n\t\t\t\t\tprimaryButton: localize(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkey: \"loginButton\",\n\t\t\t\t\t\t\tcomment: [\"&& denotes a mnemonic\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"&&Log In\",\n\t\t\t\t\t),\n\t\t\t\t\tinputs: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tplaceholder: localize(\"username\", \"Username\"),\n\t\t\t\t\t\t\tvalue: payload.username,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tplaceholder: localize(\"password\", \"Password\"),\n\t\t\t\t\t\t\ttype: \"password\",\n\t\t\t\t\t\t\tvalue: payload.password,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tdetail: localize(\n\t\t\t\t\t\t\"proxyDetail\",\n\t\t\t\t\t\t\"The proxy {0} requires a username and password.\",\n\t\t\t\t\t\t`${payload.authInfo.host}:${payload.authInfo.port}`,\n\t\t\t\t\t),\n\t\t\t\t\tcheckbox: {\n\t\t\t\t\t\tlabel: localize(\n\t\t\t\t\t\t\t\"rememberCredentials\",\n\t\t\t\t\t\t\t\"Remember my credentials\",\n\t\t\t\t\t\t),\n\t\t\t\t\t\tchecked: rememberCredentials,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\t// Reply back to the channel without result to indicate\n\t\t\t\t// that the login dialog was cancelled\n\t\t\t\tif (!result.confirmed || !result.values) {\n\t\t\t\t\tipcRenderer.send(payload.replyChannel);\n\t\t\t\t}\n\n\t\t\t\t// Other reply back with the picked credentials\n\t\t\t\telse {\n\t\t\t\t\t// Update state based on checkbox\n\t\t\t\t\tif (result.checkboxChecked) {\n\t\t\t\t\t\tthis.storageService.store(\n\t\t\t\t\t\t\trememberCredentialsKey,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tStorageScope.APPLICATION,\n\t\t\t\t\t\t\tStorageTarget.MACHINE,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.storageService.remove(\n\t\t\t\t\t\t\trememberCredentialsKey,\n\t\t\t\t\t\t\tStorageScope.APPLICATION,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reply back to main side with credentials\n\t\t\t\t\tconst [username, password] = result.values;\n\t\t\t\t\tipcRenderer.send(payload.replyChannel, {\n\t\t\t\t\t\tusername,\n\t\t\t\t\t\tpassword,\n\t\t\t\t\t\tremember: !!result.checkboxChecked,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\t// Accessibility support changed event\n\t\tipcRenderer.on(\n\t\t\t\"vscode:accessibilitySupportChanged\",\n\t\t\t(event: unknown, accessibilitySupportEnabled: boolean) => {\n\t\t\t\tthis.accessibilityService.setAccessibilitySupport(\n\t\t\t\t\taccessibilitySupportEnabled\n\t\t\t\t\t\t? AccessibilitySupport.Enabled\n\t\t\t\t\t\t: AccessibilitySupport.Disabled,\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\n\t\t// Allow to update security settings around allowed UNC Host\n\t\tipcRenderer.on(\n\t\t\t\"vscode:configureAllowedUNCHost\",\n\t\t\tasync (event: unknown, host: string) => {\n\t\t\t\tif (!isWindows) {\n\t\t\t\t\treturn; // only supported on Windows\n\t\t\t\t}\n\n\t\t\t\tconst allowedUncHosts = new Set<string>();\n\n\t\t\t\tconst configuredAllowedUncHosts =\n\t\t\t\t\tthis.configurationService.getValue<string[] | undefined>(\n\t\t\t\t\t\t\"security.allowedUNCHosts\",\n\t\t\t\t\t) ?? [];\n\t\t\t\tif (Array.isArray(configuredAllowedUncHosts)) {\n\t\t\t\t\tfor (const configuredAllowedUncHost of configuredAllowedUncHosts) {\n\t\t\t\t\t\tif (typeof configuredAllowedUncHost === \"string\") {\n\t\t\t\t\t\t\tallowedUncHosts.add(configuredAllowedUncHost);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!allowedUncHosts.has(host)) {\n\t\t\t\t\tallowedUncHosts.add(host);\n\n\t\t\t\t\tawait getWorkbenchContribution<DynamicWorkbenchSecurityConfiguration>(\n\t\t\t\t\t\tDynamicWorkbenchSecurityConfiguration.ID,\n\t\t\t\t\t).ready; // ensure this setting is registered\n\t\t\t\t\tthis.configurationService.updateValue(\n\t\t\t\t\t\t\"security.allowedUNCHosts\",\n\t\t\t\t\t\t[...allowedUncHosts.values()],\n\t\t\t\t\t\tConfigurationTarget.USER,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\t// Allow to update security settings around protocol handlers\n\t\tipcRenderer.on(\n\t\t\t\"vscode:disablePromptForProtocolHandling\",\n\t\t\t(event: unknown, kind: \"local\" | \"remote\") => {\n\t\t\t\tconst setting =\n\t\t\t\t\tkind === \"local\"\n\t\t\t\t\t\t? \"security.promptForLocalFileProtocolHandling\"\n\t\t\t\t\t\t: \"security.promptForRemoteFileProtocolHandling\";\n\t\t\t\tthis.configurationService.updateValue(setting, false);\n\t\t\t},\n\t\t);\n\n\t\t// Window Zoom\n\t\tthis._register(\n\t\t\tthis.configurationService.onDidChangeConfiguration((e) => {\n\t\t\t\tif (\n\t\t\t\t\te.affectsConfiguration(\"window.zoomLevel\") ||\n\t\t\t\t\t(e.affectsConfiguration(\"window.zoomPerWindow\") &&\n\t\t\t\t\t\tthis.configurationService.getValue(\n\t\t\t\t\t\t\t\"window.zoomPerWindow\",\n\t\t\t\t\t\t) === false)\n\t\t\t\t) {\n\t\t\t\t\tthis.onDidChangeConfiguredWindowZoomLevel();\n\t\t\t\t} else if (\n\t\t\t\t\te.affectsConfiguration(\"keyboard.touchbar.enabled\") ||\n\t\t\t\t\te.affectsConfiguration(\"keyboard.touchbar.ignored\")\n\t\t\t\t) {\n\t\t\t\t\tthis.updateTouchbarMenu();\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\n\t\tthis._register(\n\t\t\tonDidChangeZoomLevel((targetWindowId) =>\n\t\t\t\tthis.handleOnDidChangeZoomLevel(targetWindowId),\n\t\t\t),\n\t\t);\n\n\t\tfor (const part of this.editorGroupService.parts) {\n\t\t\tthis.createWindowZoomStatusEntry(part);\n\t\t}\n\n\t\tthis._register(\n\t\t\tthis.editorGroupService.onDidCreateAuxiliaryEditorPart((part) =>\n\t\t\t\tthis.createWindowZoomStatusEntry(part),\n\t\t\t),\n\t\t);\n\n\t\t// Listen to visible editor changes (debounced in case a new editor opens immediately after)\n\t\tthis._register(\n\t\t\tEvent.debounce(\n\t\t\t\tthis.editorService.onDidVisibleEditorsChange,\n\t\t\t\t() => undefined,\n\t\t\t\t0,\n\t\t\t\tundefined,\n\t\t\t\tundefined,\n\t\t\t\tundefined,\n\t\t\t\tthis._store,\n\t\t\t)(() => this.maybeCloseWindow()),\n\t\t);\n\n\t\t// Listen to editor closing (if we run with --wait)\n\t\tconst filesToWait = this.nativeEnvironmentService.filesToWait;\n\t\tif (filesToWait) {\n\t\t\tthis.trackClosedWaitFiles(\n\t\t\t\tfilesToWait.waitMarkerFileUri,\n\t\t\t\tcoalesce(filesToWait.paths.map((path) => path.fileUri)),\n\t\t\t);\n\t\t}\n\n\t\t// macOS OS integration: represented file name\n\t\tif (isMacintosh) {\n\t\t\tfor (const part of this.editorGroupService.parts) {\n\t\t\t\tthis.handleRepresentedFilename(part);\n\t\t\t}\n\n\t\t\tthis._register(\n\t\t\t\tthis.editorGroupService.onDidCreateAuxiliaryEditorPart((part) =>\n\t\t\t\t\tthis.handleRepresentedFilename(part),\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\t// Maximize/Restore on doubleclick (for macOS custom title)\n\t\tif (isMacintosh && !hasNativeTitlebar(this.configurationService)) {\n\t\t\tthis._register(\n\t\t\t\tEvent.runAndSubscribe(\n\t\t\t\t\tthis.layoutService.onDidAddContainer,\n\t\t\t\t\t({ container, disposables }) => {\n\t\t\t\t\t\tconst targetWindow = getWindow(container);\n\t\t\t\t\t\tconst targetWindowId = targetWindow.vscodeWindowId;\n\t\t\t\t\t\tconst titlePart = assertIsDefined(\n\t\t\t\t\t\t\tthis.layoutService.getContainer(\n\t\t\t\t\t\t\t\ttargetWindow,\n\t\t\t\t\t\t\t\tParts.TITLEBAR_PART,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tdisposables.add(\n\t\t\t\t\t\t\taddDisposableListener(\n\t\t\t\t\t\t\t\ttitlePart,\n\t\t\t\t\t\t\t\tEventType.DBLCLICK,\n\t\t\t\t\t\t\t\t(e) => {\n\t\t\t\t\t\t\t\t\tEventHelper.stop(e);\n\n\t\t\t\t\t\t\t\t\tthis.nativeHostService.handleTitleDoubleClick(\n\t\t\t\t\t\t\t\t\t\t{ targetWindowId },\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcontainer: this.layoutService.mainContainer,\n\t\t\t\t\t\tdisposables: this._store,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\t// Document edited: indicate for dirty working copies\n\t\tthis._register(\n\t\t\tthis.workingCopyService.onDidChangeDirty((workingCopy) => {\n\t\t\t\tconst gotDirty = workingCopy.isDirty();\n\t\t\t\tif (\n\t\t\t\t\tgotDirty &&\n\t\t\t\t\t!(\n\t\t\t\t\t\tworkingCopy.capabilities &\n\t\t\t\t\t\tWorkingCopyCapabilities.Untitled\n\t\t\t\t\t) &&\n\t\t\t\t\tthis.filesConfigurationService.hasShortAutoSaveDelay(\n\t\t\t\t\t\tworkingCopy.resource,\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\treturn; // do not indicate dirty of working copies that are auto saved after short delay\n\t\t\t\t}\n\n\t\t\t\tthis.updateDocumentEdited(gotDirty ? true : undefined);\n\t\t\t}),\n\t\t);\n\n\t\tthis.updateDocumentEdited(undefined);\n\n\t\t// Detect minimize / maximize\n\t\tthis._register(\n\t\t\tEvent.any(\n\t\t\t\tEvent.map(\n\t\t\t\t\tEvent.filter(\n\t\t\t\t\t\tthis.nativeHostService.onDidMaximizeWindow,\n\t\t\t\t\t\t(windowId) => !!hasWindow(windowId),\n\t\t\t\t\t),\n\t\t\t\t\t(windowId) => ({ maximized: true, windowId }),\n\t\t\t\t),\n\t\t\t\tEvent.map(\n\t\t\t\t\tEvent.filter(\n\t\t\t\t\t\tthis.nativeHostService.onDidUnmaximizeWindow,\n\t\t\t\t\t\t(windowId) => !!hasWindow(windowId),\n\t\t\t\t\t),\n\t\t\t\t\t(windowId) => ({ maximized: false, windowId }),\n\t\t\t\t),\n\t\t\t)((e) =>\n\t\t\t\tthis.layoutService.updateWindowMaximizedState(\n\t\t\t\t\tgetWindowById(e.windowId)!.window,\n\t\t\t\t\te.maximized,\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\t\tthis.layoutService.updateWindowMaximizedState(\n\t\t\tmainWindow,\n\t\t\tthis.nativeEnvironmentService.window.maximized ?? false,\n\t\t);\n\n\t\t// Detect panel position to determine minimum width\n\t\tthis._register(\n\t\t\tthis.layoutService.onDidChangePanelPosition((pos) =>\n\t\t\t\tthis.onDidChangePanelPosition(positionFromString(pos)),\n\t\t\t),\n\t\t);\n\t\tthis.onDidChangePanelPosition(this.layoutService.getPanelPosition());\n\n\t\t// Lifecycle\n\t\tthis._register(\n\t\t\tthis.lifecycleService.onBeforeShutdown((e) =>\n\t\t\t\tthis.onBeforeShutdown(e),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.lifecycleService.onBeforeShutdownError((e) =>\n\t\t\t\tthis.onBeforeShutdownError(e),\n\t\t\t),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.lifecycleService.onWillShutdown((e) => this.onWillShutdown(e)),\n\t\t);\n\t}\n\n\tprivate handleRepresentedFilename(part: IEditorPart): void {\n\t\tconst disposables = new DisposableStore();\n\t\tEvent.once(part.onWillDispose)(() => disposables.dispose());\n\n\t\tconst scopedEditorService = this.editorGroupService\n\t\t\t.getScopedInstantiationService(part)\n\t\t\t.invokeFunction((accessor) => accessor.get(IEditorService));\n\t\tdisposables.add(\n\t\t\tscopedEditorService.onDidActiveEditorChange(() =>\n\t\t\t\tthis.updateRepresentedFilename(\n\t\t\t\t\tscopedEditorService,\n\t\t\t\t\tpart.windowId,\n\t\t\t\t),\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate updateRepresentedFilename(\n\t\teditorService: IEditorService,\n\t\ttargetWindowId: number,\n\t): void {\n\t\tconst file = EditorResourceAccessor.getOriginalUri(\n\t\t\teditorService.activeEditor,\n\t\t\t{\n\t\t\t\tsupportSideBySide: SideBySideEditor.PRIMARY,\n\t\t\t\tfilterByScheme: Schemas.file,\n\t\t\t},\n\t\t);\n\n\t\t// Represented Filename\n\t\tthis.nativeHostService.setRepresentedFilename(file?.fsPath ?? \"\", {\n\t\t\ttargetWindowId,\n\t\t});\n\n\t\t// Custom title menu (main window only currently)\n\t\tif (targetWindowId === mainWindow.vscodeWindowId) {\n\t\t\tthis.provideCustomTitleContextMenu(file?.fsPath);\n\t\t}\n\t}\n\n\t//#region Window Lifecycle\n\n\tprivate onBeforeShutdown({ veto, reason }: BeforeShutdownEvent): void {\n\t\tif (reason === ShutdownReason.CLOSE) {\n\t\t\tconst confirmBeforeCloseSetting =\n\t\t\t\tthis.configurationService.getValue<\n\t\t\t\t\t\"always\" | \"never\" | \"keyboardOnly\"\n\t\t\t\t>(\"window.confirmBeforeClose\");\n\n\t\t\tconst confirmBeforeClose =\n\t\t\t\tconfirmBeforeCloseSetting === \"always\" ||\n\t\t\t\t(confirmBeforeCloseSetting === \"keyboardOnly\" &&\n\t\t\t\t\tModifierKeyEmitter.getInstance().isModifierPressed);\n\t\t\tif (confirmBeforeClose) {\n\t\t\t\t// When we need to confirm on close or quit, veto the shutdown\n\t\t\t\t// with a long running promise to figure out whether shutdown\n\t\t\t\t// can proceed or not.\n\n\t\t\t\treturn veto(\n\t\t\t\t\t(async () => {\n\t\t\t\t\t\tlet actualReason: ShutdownReason = reason;\n\t\t\t\t\t\tif (reason === ShutdownReason.CLOSE && !isMacintosh) {\n\t\t\t\t\t\t\tconst windowCount =\n\t\t\t\t\t\t\t\tawait this.nativeHostService.getWindowCount();\n\t\t\t\t\t\t\tif (windowCount === 1) {\n\t\t\t\t\t\t\t\tactualReason = ShutdownReason.QUIT; // Windows/Linux: closing last window means to QUIT\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet confirmed = true;\n\t\t\t\t\t\tif (confirmBeforeClose) {\n\t\t\t\t\t\t\tconfirmed =\n\t\t\t\t\t\t\t\tawait this.instantiationService.invokeFunction(\n\t\t\t\t\t\t\t\t\t(accessor) =>\n\t\t\t\t\t\t\t\t\t\tNativeWindow.confirmOnShutdown(\n\t\t\t\t\t\t\t\t\t\t\taccessor,\n\t\t\t\t\t\t\t\t\t\t\tactualReason,\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Progress for long running shutdown\n\t\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\t\tthis.progressOnBeforeShutdown(reason);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn !confirmed;\n\t\t\t\t\t})(),\n\t\t\t\t\t\"veto.confirmBeforeClose\",\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Progress for long running shutdown\n\t\tthis.progressOnBeforeShutdown(reason);\n\t}\n\n\tprivate progressOnBeforeShutdown(reason: ShutdownReason): void {\n\t\tthis.progressService.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Window, // use window progress to not be too annoying about this operation\n\t\t\t\tdelay: 800, // delay so that it only appears when operation takes a long time\n\t\t\t\ttitle: this.toShutdownLabel(reason, false),\n\t\t\t},\n\t\t\t() => {\n\t\t\t\treturn Event.toPromise(\n\t\t\t\t\tEvent.any(\n\t\t\t\t\t\tthis.lifecycleService.onWillShutdown, // dismiss this dialog when we shutdown\n\t\t\t\t\t\tthis.lifecycleService.onShutdownVeto, // or when shutdown was vetoed\n\t\t\t\t\t\tthis.dialogService.onWillShowDialog, // or when a dialog asks for input\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\t}\n\n\tprivate onBeforeShutdownError({\n\t\terror,\n\t\treason,\n\t}: BeforeShutdownErrorEvent): void {\n\t\tthis.dialogService.error(\n\t\t\tthis.toShutdownLabel(reason, true),\n\t\t\tlocalize(\n\t\t\t\t\"shutdownErrorDetail\",\n\t\t\t\t\"Error: {0}\",\n\t\t\t\ttoErrorMessage(error),\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate onWillShutdown({\n\t\treason,\n\t\tforce,\n\t\tjoiners,\n\t}: WillShutdownEvent): void {\n\t\t// Delay so that the dialog only appears after timeout\n\t\tconst shutdownDialogScheduler = new RunOnceScheduler(() => {\n\t\t\tconst pendingJoiners = joiners();\n\n\t\t\tthis.progressService.withProgress(\n\t\t\t\t{\n\t\t\t\t\tlocation: ProgressLocation.Dialog, // use a dialog to prevent the user from making any more interactions now\n\t\t\t\t\tbuttons: [this.toForceShutdownLabel(reason)], // allow to force shutdown anyway\n\t\t\t\t\tcancellable: false, // do not allow to cancel\n\t\t\t\t\tsticky: true, // do not allow to dismiss\n\t\t\t\t\ttitle: this.toShutdownLabel(reason, false),\n\t\t\t\t\tdetail:\n\t\t\t\t\t\tpendingJoiners.length > 0\n\t\t\t\t\t\t\t? localize(\n\t\t\t\t\t\t\t\t\t\"willShutdownDetail\",\n\t\t\t\t\t\t\t\t\t\"The following operations are still running: \\n{0}\",\n\t\t\t\t\t\t\t\t\tpendingJoiners\n\t\t\t\t\t\t\t\t\t\t.map((joiner) => `- ${joiner.label}`)\n\t\t\t\t\t\t\t\t\t\t.join(\"\\n\"),\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\treturn Event.toPromise(this.lifecycleService.onDidShutdown); // dismiss this dialog when we actually shutdown\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tforce();\n\t\t\t\t},\n\t\t\t);\n\t\t}, 1200);\n\t\tshutdownDialogScheduler.schedule();\n\n\t\t// Dispose scheduler when we actually shutdown\n\t\tEvent.once(this.lifecycleService.onDidShutdown)(() =>\n\t\t\tshutdownDialogScheduler.dispose(),\n\t\t);\n\t}\n\n\tprivate toShutdownLabel(reason: ShutdownReason, isError: boolean): string {\n\t\tif (isError) {\n\t\t\tswitch (reason) {\n\t\t\t\tcase ShutdownReason.CLOSE:\n\t\t\t\t\treturn localize(\n\t\t\t\t\t\t\"shutdownErrorClose\",\n\t\t\t\t\t\t\"An unexpected error prevented the window to close\",\n\t\t\t\t\t);\n\t\t\t\tcase ShutdownReason.QUIT:\n\t\t\t\t\treturn localize(\n\t\t\t\t\t\t\"shutdownErrorQuit\",\n\t\t\t\t\t\t\"An unexpected error prevented the application to quit\",\n\t\t\t\t\t);\n\t\t\t\tcase ShutdownReason.RELOAD:\n\t\t\t\t\treturn localize(\n\t\t\t\t\t\t\"shutdownErrorReload\",\n\t\t\t\t\t\t\"An unexpected error prevented the window to reload\",\n\t\t\t\t\t);\n\t\t\t\tcase ShutdownReason.LOAD:\n\t\t\t\t\treturn localize(\n\t\t\t\t\t\t\"shutdownErrorLoad\",\n\t\t\t\t\t\t\"An unexpected error prevented to change the workspace\",\n\t\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tswitch (reason) {\n\t\t\tcase ShutdownReason.CLOSE:\n\t\t\t\treturn localize(\n\t\t\t\t\t\"shutdownTitleClose\",\n\t\t\t\t\t\"Closing the window is taking a bit longer...\",\n\t\t\t\t);\n\t\t\tcase ShutdownReason.QUIT:\n\t\t\t\treturn localize(\n\t\t\t\t\t\"shutdownTitleQuit\",\n\t\t\t\t\t\"Quitting the application is taking a bit longer...\",\n\t\t\t\t);\n\t\t\tcase ShutdownReason.RELOAD:\n\t\t\t\treturn localize(\n\t\t\t\t\t\"shutdownTitleReload\",\n\t\t\t\t\t\"Reloading the window is taking a bit longer...\",\n\t\t\t\t);\n\t\t\tcase ShutdownReason.LOAD:\n\t\t\t\treturn localize(\n\t\t\t\t\t\"shutdownTitleLoad\",\n\t\t\t\t\t\"Changing the workspace is taking a bit longer...\",\n\t\t\t\t);\n\t\t}\n\t}\n\n\tprivate toForceShutdownLabel(reason: ShutdownReason): string {\n\t\tswitch (reason) {\n\t\t\tcase ShutdownReason.CLOSE:\n\t\t\t\treturn localize(\"shutdownForceClose\", \"Close Anyway\");\n\t\t\tcase ShutdownReason.QUIT:\n\t\t\t\treturn localize(\"shutdownForceQuit\", \"Quit Anyway\");\n\t\t\tcase ShutdownReason.RELOAD:\n\t\t\t\treturn localize(\"shutdownForceReload\", \"Reload Anyway\");\n\t\t\tcase ShutdownReason.LOAD:\n\t\t\t\treturn localize(\"shutdownForceLoad\", \"Change Anyway\");\n\t\t}\n\t}\n\n\t//#endregion\n\n\tprivate updateDocumentEdited(documentEdited: true | undefined): void {\n\t\tlet setDocumentEdited: boolean;\n\t\tif (typeof documentEdited === \"boolean\") {\n\t\t\tsetDocumentEdited = documentEdited;\n\t\t} else {\n\t\t\tsetDocumentEdited = this.workingCopyService.hasDirty;\n\t\t}\n\n\t\tif (\n\t\t\t(!this.isDocumentedEdited && setDocumentEdited) ||\n\t\t\t(this.isDocumentedEdited && !setDocumentEdited)\n\t\t) {\n\t\t\tthis.isDocumentedEdited = setDocumentEdited;\n\n\t\t\tthis.nativeHostService.setDocumentEdited(setDocumentEdited);\n\t\t}\n\t}\n\n\tprivate getWindowMinimumWidth(\n\t\tpanelPosition: Position = this.layoutService.getPanelPosition(),\n\t): number {\n\t\t// if panel is on the side, then return the larger minwidth\n\t\tconst panelOnSide =\n\t\t\tpanelPosition === Position.LEFT || panelPosition === Position.RIGHT;\n\t\tif (panelOnSide) {\n\t\t\treturn WindowMinimumSize.WIDTH_WITH_VERTICAL_PANEL;\n\t\t}\n\n\t\treturn WindowMinimumSize.WIDTH;\n\t}\n\n\tprivate onDidChangePanelPosition(pos: Position): void {\n\t\tconst minWidth = this.getWindowMinimumWidth(pos);\n\n\t\tthis.nativeHostService.setMinimumSize(minWidth, undefined);\n\t}\n\n\tprivate maybeCloseWindow(): void {\n\t\tconst closeWhenEmpty =\n\t\t\tthis.configurationService.getValue(\"window.closeWhenEmpty\") ||\n\t\t\tthis.nativeEnvironmentService.args.wait;\n\t\tif (!closeWhenEmpty) {\n\t\t\treturn; // return early if configured to not close when empty\n\t\t}\n\n\t\t// Close empty editor groups based on setting and environment\n\t\tfor (const editorPart of this.editorGroupService.parts) {\n\t\t\tif (editorPart.groups.some((group) => !group.isEmpty)) {\n\t\t\t\tcontinue; // not empty\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\teditorPart === this.editorGroupService.mainPart &&\n\t\t\t\t(this.contextService.getWorkbenchState() !==\n\t\t\t\t\tWorkbenchState.EMPTY || // only for empty windows\n\t\t\t\t\tthis.environmentService.isExtensionDevelopment || // not when developing an extension\n\t\t\t\t\tthis.editorService.visibleEditors.length > 0) // not when there are still editors open in other windows\n\t\t\t) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (editorPart === this.editorGroupService.mainPart) {\n\t\t\t\tthis.nativeHostService.closeWindow();\n\t\t\t} else {\n\t\t\t\teditorPart.removeGroup(editorPart.activeGroup);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate provideCustomTitleContextMenu(filePath: string | undefined): void {\n\t\t// Clear old menu\n\t\tthis.customTitleContextMenuDisposable.clear();\n\n\t\t// Only provide a menu when we have a file path and custom titlebar\n\t\tif (!filePath || hasNativeTitlebar(this.configurationService)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Split up filepath into segments\n\t\tconst segments = filePath.split(posix.sep);\n\t\tfor (let i = segments.length; i > 0; i--) {\n\t\t\tconst isFile = i === segments.length;\n\n\t\t\tlet pathOffset = i;\n\t\t\tif (!isFile) {\n\t\t\t\tpathOffset++; // for segments which are not the file name we want to open the folder\n\t\t\t}\n\n\t\t\tconst path = URI.file(\n\t\t\t\tsegments.slice(0, pathOffset).join(posix.sep),\n\t\t\t);\n\n\t\t\tlet label: string;\n\t\t\tif (isFile) {\n\t\t\t\tlabel = this.labelService.getUriBasenameLabel(path);\n\t\t\t} else {\n\t\t\t\tlabel = this.labelService.getUriBasenameLabel(dirname(path));\n\t\t\t}\n\n\t\t\tconst commandId = `workbench.action.revealPathInFinder${i}`;\n\t\t\tthis.customTitleContextMenuDisposable.add(\n\t\t\t\tCommandsRegistry.registerCommand(commandId, () =>\n\t\t\t\t\tthis.nativeHostService.showItemInFolder(path.fsPath),\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis.customTitleContextMenuDisposable.add(\n\t\t\t\tMenuRegistry.appendMenuItem(MenuId.TitleBarTitleContext, {\n\t\t\t\t\tcommand: { id: commandId, title: label || posix.sep },\n\t\t\t\t\torder: -i,\n\t\t\t\t\tgroup: \"1_file\",\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected create(): void {\n\t\t// Handle open calls\n\t\tthis.setupOpenHandlers();\n\n\t\t// Notify some services about lifecycle phases\n\t\tthis.lifecycleService\n\t\t\t.when(LifecyclePhase.Ready)\n\t\t\t.then(() => this.nativeHostService.notifyReady());\n\t\tthis.lifecycleService.when(LifecyclePhase.Restored).then(() => {\n\t\t\tthis.sharedProcessService.notifyRestored();\n\t\t\tthis.utilityProcessWorkerWorkbenchService.notifyRestored();\n\t\t});\n\n\t\t// Check for situations that are worth warning the user about\n\t\tthis.handleWarnings();\n\n\t\t// Touchbar menu (if enabled)\n\t\tthis.updateTouchbarMenu();\n\n\t\t// Smoke Test Driver\n\t\tif (this.environmentService.enableSmokeTestDriver) {\n\t\t\tthis.setupDriver();\n\t\t}\n\t}\n\n\tprivate async handleWarnings(): Promise<void> {\n\t\t// Check for cyclic dependencies\n\t\tif (\n\t\t\t!isESM &&\n\t\t\ttypeof require.hasDependencyCycle === \"function\" &&\n\t\t\trequire.hasDependencyCycle()\n\t\t) {\n\t\t\tif (isCI) {\n\t\t\t\tthis.logService.error(\n\t\t\t\t\t\"Error: There is a dependency cycle in the AMD modules that needs to be resolved!\",\n\t\t\t\t);\n\t\t\t\tthis.nativeHostService.exit(37); // running on a build machine, just exit without showing a dialog\n\t\t\t} else {\n\t\t\t\tthis.dialogService.error(\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"loaderCycle\",\n\t\t\t\t\t\t\"There is a dependency cycle in the AMD modules that needs to be resolved!\",\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tthis.nativeHostService.openDevTools();\n\t\t\t}\n\t\t}\n\n\t\t// After restored phase is fine for the following ones\n\t\tawait this.lifecycleService.when(LifecyclePhase.Restored);\n\n\t\t// Integrity / Root warning\n\t\t(async () => {\n\t\t\tconst isAdmin = await this.nativeHostService.isAdmin();\n\t\t\tconst { isPure } = await this.integrityService.isPure();\n\n\t\t\t// Update to title\n\t\t\tthis.titleService.updateProperties({ isPure, isAdmin });\n\n\t\t\t// Show warning message (unix only)\n\t\t\tif (isAdmin && !isWindows) {\n\t\t\t\tthis.notificationService.warn(\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"runningAsRoot\",\n\t\t\t\t\t\t\"It is not recommended to run {0} as root user.\",\n\t\t\t\t\t\tthis.productService.nameShort,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t})();\n\n\t\t// Installation Dir Warning\n\t\tif (this.environmentService.isBuilt) {\n\t\t\tlet installLocationUri: URI;\n\t\t\tif (isMacintosh) {\n\t\t\t\t// appRoot = /Applications/Visual Studio Code - Insiders.app/Contents/Resources/app\n\t\t\t\tinstallLocationUri = dirname(\n\t\t\t\t\tdirname(\n\t\t\t\t\t\tdirname(\n\t\t\t\t\t\t\tURI.file(this.nativeEnvironmentService.appRoot),\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t// appRoot = C:\\Users\\<name>\\AppData\\Local\\Programs\\Microsoft VS Code Insiders\\resources\\app\n\t\t\t\t// appRoot = /usr/share/code-insiders/resources/app\n\t\t\t\tinstallLocationUri = dirname(\n\t\t\t\t\tdirname(URI.file(this.nativeEnvironmentService.appRoot)),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tfor (const folder of this.contextService.getWorkspace().folders) {\n\t\t\t\tif (\n\t\t\t\t\tthis.uriIdentityService.extUri.isEqualOrParent(\n\t\t\t\t\t\tfolder.uri,\n\t\t\t\t\t\tinstallLocationUri,\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tthis.bannerService.show({\n\t\t\t\t\t\tid: \"appRootWarning.banner\",\n\t\t\t\t\t\tmessage: localize(\n\t\t\t\t\t\t\t\"appRootWarning.banner\",\n\t\t\t\t\t\t\t\"Files you store within the installation folder ('{0}') may be OVERWRITTEN or DELETED IRREVERSIBLY without warning at update time.\",\n\t\t\t\t\t\t\tthis.labelService.getUriLabel(installLocationUri),\n\t\t\t\t\t\t),\n\t\t\t\t\t\ticon: Codicon.warning,\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// macOS 10.13 and 10.14 warning\n\t\tif (isMacintosh) {\n\t\t\tconst majorVersion =\n\t\t\t\tthis.nativeEnvironmentService.os.release.split(\".\")[0];\n\t\t\tconst eolReleases = new Map<string, string>([\n\t\t\t\t[\"17\", \"macOS High Sierra\"],\n\t\t\t\t[\"18\", \"macOS Mojave\"],\n\t\t\t]);\n\n\t\t\tif (eolReleases.has(majorVersion)) {\n\t\t\t\tconst message = localize(\n\t\t\t\t\t\"macoseolmessage\",\n\t\t\t\t\t\"{0} on {1} will soon stop receiving updates. Consider upgrading your macOS version.\",\n\t\t\t\t\tthis.productService.nameLong,\n\t\t\t\t\teolReleases.get(majorVersion),\n\t\t\t\t);\n\n\t\t\t\tthis.notificationService.prompt(\n\t\t\t\t\tSeverity.Warning,\n\t\t\t\t\tmessage,\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: localize(\"learnMore\", \"Learn More\"),\n\t\t\t\t\t\t\trun: () =>\n\t\t\t\t\t\t\t\tthis.openerService.open(\n\t\t\t\t\t\t\t\t\tURI.parse(\n\t\t\t\t\t\t\t\t\t\t\"https://aka.ms/vscode-faq-old-macOS\",\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t{\n\t\t\t\t\t\tneverShowAgain: {\n\t\t\t\t\t\t\tid: \"macoseol\",\n\t\t\t\t\t\t\tisSecondary: true,\n\t\t\t\t\t\t\tscope: NeverShowAgainScope.APPLICATION,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpriority: NotificationPriority.URGENT,\n\t\t\t\t\t\tsticky: true,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Slow shell environment progress indicator\n\t\tconst shellEnv = process.shellEnv();\n\t\tthis.progressService.withProgress(\n\t\t\t{\n\t\t\t\ttitle: localize(\n\t\t\t\t\t\"resolveShellEnvironment\",\n\t\t\t\t\t\"Resolving shell environment...\",\n\t\t\t\t),\n\t\t\t\tlocation: ProgressLocation.Window,\n\t\t\t\tdelay: 1600,\n\t\t\t\tbuttons: [localize(\"learnMore\", \"Learn More\")],\n\t\t\t},\n\t\t\t() => shellEnv,\n\t\t\t() =>\n\t\t\t\tthis.openerService.open(\n\t\t\t\t\t\"https://go.microsoft.com/fwlink/?linkid=2149667\",\n\t\t\t\t),\n\t\t);\n\t}\n\n\tprivate setupDriver(): void {\n\t\tconst that = this;\n\t\tlet pendingQuit = false;\n\n\t\tregisterWindowDriver(this.instantiationService, {\n\t\t\tasync exitApplication(): Promise<void> {\n\t\t\t\tif (pendingQuit) {\n\t\t\t\t\tthat.logService.info(\n\t\t\t\t\t\t\"[driver] not handling exitApplication() due to pending quit() call\",\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthat.logService.info(\"[driver] handling exitApplication()\");\n\n\t\t\t\tpendingQuit = true;\n\t\t\t\treturn that.nativeHostService.quit();\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate async openTunnel(\n\t\taddress: string,\n\t\tport: number,\n\t): Promise<RemoteTunnel | string | undefined> {\n\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\tconst addressProvider: IAddressProvider | undefined = remoteAuthority\n\t\t\t? {\n\t\t\t\t\tgetAddress: async (): Promise<IAddress> => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tawait this.remoteAuthorityResolverService.resolveAuthority(\n\t\t\t\t\t\t\t\tremoteAuthority,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t).authority;\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t: undefined;\n\t\tconst tunnel = await this.tunnelService.getExistingTunnel(\n\t\t\taddress,\n\t\t\tport,\n\t\t);\n\t\tif (!tunnel || typeof tunnel === \"string\") {\n\t\t\treturn this.tunnelService.openTunnel(\n\t\t\t\taddressProvider,\n\t\t\t\taddress,\n\t\t\t\tport,\n\t\t\t);\n\t\t}\n\t\treturn tunnel;\n\t}\n\n\tasync resolveExternalUri(\n\t\turi: URI,\n\t\toptions?: OpenOptions,\n\t): Promise<IResolvedExternalUri | undefined> {\n\t\tlet queryTunnel: RemoteTunnel | string | undefined;\n\t\tif (options?.allowTunneling) {\n\t\t\tconst portMappingRequest =\n\t\t\t\textractLocalHostUriMetaDataForPortMapping(uri);\n\t\t\tconst queryPortMapping =\n\t\t\t\textractQueryLocalHostUriMetaDataForPortMapping(uri);\n\t\t\tif (queryPortMapping) {\n\t\t\t\tqueryTunnel = await this.openTunnel(\n\t\t\t\t\tqueryPortMapping.address,\n\t\t\t\t\tqueryPortMapping.port,\n\t\t\t\t);\n\t\t\t\tif (queryTunnel && typeof queryTunnel !== \"string\") {\n\t\t\t\t\t// If the tunnel was mapped to a different port, dispose it, because some services\n\t\t\t\t\t// validate the port number in the query string.\n\t\t\t\t\tif (\n\t\t\t\t\t\tqueryTunnel.tunnelRemotePort !== queryPortMapping.port\n\t\t\t\t\t) {\n\t\t\t\t\t\tqueryTunnel.dispose();\n\t\t\t\t\t\tqueryTunnel = undefined;\n\t\t\t\t\t} else if (!portMappingRequest) {\n\t\t\t\t\t\tconst tunnel = queryTunnel;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tresolved: uri,\n\t\t\t\t\t\t\tdispose: () => tunnel.dispose(),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (portMappingRequest) {\n\t\t\t\tconst tunnel = await this.openTunnel(\n\t\t\t\t\tportMappingRequest.address,\n\t\t\t\t\tportMappingRequest.port,\n\t\t\t\t);\n\t\t\t\tif (tunnel && typeof tunnel !== \"string\") {\n\t\t\t\t\tconst addressAsUri = URI.parse(tunnel.localAddress);\n\t\t\t\t\tconst resolved = addressAsUri.scheme.startsWith(uri.scheme)\n\t\t\t\t\t\t? addressAsUri\n\t\t\t\t\t\t: uri.with({ authority: tunnel.localAddress });\n\t\t\t\t\treturn {\n\t\t\t\t\t\tresolved,\n\t\t\t\t\t\tdispose() {\n\t\t\t\t\t\t\ttunnel.dispose();\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tqueryTunnel &&\n\t\t\t\t\t\t\t\ttypeof queryTunnel !== \"string\"\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tqueryTunnel.dispose();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!options?.openExternal) {\n\t\t\tconst canHandleResource =\n\t\t\t\tawait this.fileService.canHandleResource(uri);\n\t\t\tif (canHandleResource) {\n\t\t\t\treturn {\n\t\t\t\t\tresolved: URI.from({\n\t\t\t\t\t\tscheme: this.productService.urlProtocol,\n\t\t\t\t\t\tpath: \"workspace\",\n\t\t\t\t\t\tquery: uri.toString(),\n\t\t\t\t\t}),\n\t\t\t\t\tdispose() {},\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate setupOpenHandlers(): void {\n\t\t// Handle external open() calls\n\t\tthis.openerService.setDefaultExternalOpener({\n\t\t\topenExternal: async (href: string) => {\n\t\t\t\tconst success = await this.nativeHostService.openExternal(\n\t\t\t\t\thref,\n\t\t\t\t\tthis.configurationService.getValue<string>(\n\t\t\t\t\t\t\"workbench.externalBrowser\",\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tif (!success) {\n\t\t\t\t\tconst fileCandidate = URI.parse(href);\n\t\t\t\t\tif (fileCandidate.scheme === Schemas.file) {\n\t\t\t\t\t\t// if opening failed, and this is a file, we can still try to reveal it\n\t\t\t\t\t\tawait this.nativeHostService.showItemInFolder(\n\t\t\t\t\t\t\tfileCandidate.fsPath,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t});\n\n\t\t// Register external URI resolver\n\t\tthis.openerService.registerExternalUriResolver({\n\t\t\tresolveExternalUri: async (uri: URI, options?: OpenOptions) => {\n\t\t\t\treturn this.resolveExternalUri(uri, options);\n\t\t\t},\n\t\t});\n\t}\n\n\t//#region Touchbar\n\n\tprivate touchBarMenu: IMenu | undefined;\n\tprivate readonly touchBarDisposables = this._register(\n\t\tnew DisposableStore(),\n\t);\n\tprivate lastInstalledTouchedBar: ICommandAction[][] | undefined;\n\n\tprivate updateTouchbarMenu(): void {\n\t\tif (!isMacintosh) {\n\t\t\treturn; // macOS only\n\t\t}\n\n\t\t// Dispose old\n\t\tthis.touchBarDisposables.clear();\n\t\tthis.touchBarMenu = undefined;\n\n\t\t// Create new (delayed)\n\t\tconst scheduler: RunOnceScheduler = this.touchBarDisposables.add(\n\t\t\tnew RunOnceScheduler(\n\t\t\t\t() => this.doUpdateTouchbarMenu(scheduler),\n\t\t\t\t300,\n\t\t\t),\n\t\t);\n\t\tscheduler.schedule();\n\t}\n\n\tprivate doUpdateTouchbarMenu(scheduler: RunOnceScheduler): void {\n\t\tif (!this.touchBarMenu) {\n\t\t\tconst scopedContextKeyService =\n\t\t\t\tthis.editorService.activeEditorPane?.scopedContextKeyService ||\n\t\t\t\tthis.editorGroupService.activeGroup.scopedContextKeyService;\n\t\t\tthis.touchBarMenu = this.menuService.createMenu(\n\t\t\t\tMenuId.TouchBarContext,\n\t\t\t\tscopedContextKeyService,\n\t\t\t);\n\t\t\tthis.touchBarDisposables.add(this.touchBarMenu);\n\t\t\tthis.touchBarDisposables.add(\n\t\t\t\tthis.touchBarMenu.onDidChange(() => scheduler.schedule()),\n\t\t\t);\n\t\t}\n\n\t\tconst actions: Array<MenuItemAction | Separator> = [];\n\n\t\tconst disabled =\n\t\t\tthis.configurationService.getValue(\"keyboard.touchbar.enabled\") ===\n\t\t\tfalse;\n\t\tconst touchbarIgnored = this.configurationService.getValue(\n\t\t\t\"keyboard.touchbar.ignored\",\n\t\t);\n\t\tconst ignoredItems = Array.isArray(touchbarIgnored)\n\t\t\t? touchbarIgnored\n\t\t\t: [];\n\n\t\t// Fill actions into groups respecting order\n\t\tcreateAndFillInActionBarActions(this.touchBarMenu, undefined, actions);\n\n\t\t// Convert into command action multi array\n\t\tconst items: ICommandAction[][] = [];\n\t\tlet group: ICommandAction[] = [];\n\t\tif (!disabled) {\n\t\t\tfor (const action of actions) {\n\t\t\t\t// Command\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tif (ignoredItems.indexOf(action.item.id) >= 0) {\n\t\t\t\t\t\tcontinue; // ignored\n\t\t\t\t\t}\n\n\t\t\t\t\tgroup.push(action.item);\n\t\t\t\t}\n\n\t\t\t\t// Separator\n\t\t\t\telse if (action instanceof Separator) {\n\t\t\t\t\tif (group.length) {\n\t\t\t\t\t\titems.push(group);\n\t\t\t\t\t}\n\n\t\t\t\t\tgroup = [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (group.length) {\n\t\t\t\titems.push(group);\n\t\t\t}\n\t\t}\n\n\t\t// Only update if the actions have changed\n\t\tif (!equals(this.lastInstalledTouchedBar, items)) {\n\t\t\tthis.lastInstalledTouchedBar = items;\n\t\t\tthis.nativeHostService.updateTouchBar(items);\n\t\t}\n\t}\n\n\t//#endregion\n\n\tprivate onAddFoldersRequest(request: IAddFoldersRequest): void {\n\t\t// Buffer all pending requests\n\t\tthis.pendingFoldersToAdd.push(\n\t\t\t...request.foldersToAdd.map((folder) => URI.revive(folder)),\n\t\t);\n\n\t\t// Delay the adding of folders a bit to buffer in case more requests are coming\n\t\tif (!this.addFoldersScheduler.isScheduled()) {\n\t\t\tthis.addFoldersScheduler.schedule();\n\t\t}\n\t}\n\n\tprivate doAddFolders(): void {\n\t\tconst foldersToAdd: IWorkspaceFolderCreationData[] = [];\n\n\t\tfor (const folder of this.pendingFoldersToAdd) {\n\t\t\tfoldersToAdd.push({ uri: folder });\n\t\t}\n\n\t\tthis.pendingFoldersToAdd = [];\n\n\t\tthis.workspaceEditingService.addFolders(foldersToAdd);\n\t}\n\n\tprivate async onOpenFiles(request: INativeOpenFileRequest): Promise<void> {\n\t\tconst diffMode = !!(\n\t\t\trequest.filesToDiff && request.filesToDiff.length === 2\n\t\t);\n\t\tconst mergeMode = !!(\n\t\t\trequest.filesToMerge && request.filesToMerge.length === 4\n\t\t);\n\n\t\tconst inputs = coalesce(\n\t\t\tawait pathsToEditors(\n\t\t\t\tmergeMode\n\t\t\t\t\t? request.filesToMerge\n\t\t\t\t\t: diffMode\n\t\t\t\t\t\t? request.filesToDiff\n\t\t\t\t\t\t: request.filesToOpenOrCreate,\n\t\t\t\tthis.fileService,\n\t\t\t\tthis.logService,\n\t\t\t),\n\t\t);\n\t\tif (inputs.length) {\n\t\t\tconst openedEditorPanes = await this.openResources(\n\t\t\t\tinputs,\n\t\t\t\tdiffMode,\n\t\t\t\tmergeMode,\n\t\t\t);\n\n\t\t\tif (request.filesToWait) {\n\t\t\t\t// In wait mode, listen to changes to the editors and wait until the files\n\t\t\t\t// are closed that the user wants to wait for. When this happens we delete\n\t\t\t\t// the wait marker file to signal to the outside that editing is done.\n\t\t\t\t// However, it is possible that opening of the editors failed, as such we\n\t\t\t\t// check for whether editor panes got opened and otherwise delete the marker\n\t\t\t\t// right away.\n\n\t\t\t\tif (openedEditorPanes.length) {\n\t\t\t\t\treturn this.trackClosedWaitFiles(\n\t\t\t\t\t\tURI.revive(request.filesToWait.waitMarkerFileUri),\n\t\t\t\t\t\tcoalesce(\n\t\t\t\t\t\t\trequest.filesToWait.paths.map((path) =>\n\t\t\t\t\t\t\t\tURI.revive(path.fileUri),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\treturn this.fileService.del(\n\t\t\t\t\t\tURI.revive(request.filesToWait.waitMarkerFileUri),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async trackClosedWaitFiles(\n\t\twaitMarkerFile: URI,\n\t\tresourcesToWaitFor: URI[],\n\t): Promise<void> {\n\t\t// Wait for the resources to be closed in the text editor...\n\t\tawait this.instantiationService.invokeFunction((accessor) =>\n\t\t\twhenEditorClosed(accessor, resourcesToWaitFor),\n\t\t);\n\n\t\t// ...before deleting the wait marker file\n\t\tawait this.fileService.del(waitMarkerFile);\n\t}\n\n\tprivate async openResources(\n\t\tresources: Array<\n\t\t\tIResourceEditorInput | IUntitledTextResourceEditorInput\n\t\t>,\n\t\tdiffMode: boolean,\n\t\tmergeMode: boolean,\n\t): Promise<readonly IEditorPane[]> {\n\t\tconst editors: IUntypedEditorInput[] = [];\n\n\t\tif (\n\t\t\tmergeMode &&\n\t\t\tisResourceEditorInput(resources[0]) &&\n\t\t\tisResourceEditorInput(resources[1]) &&\n\t\t\tisResourceEditorInput(resources[2]) &&\n\t\t\tisResourceEditorInput(resources[3])\n\t\t) {\n\t\t\tconst mergeEditor: IResourceMergeEditorInput = {\n\t\t\t\tinput1: { resource: resources[0].resource },\n\t\t\t\tinput2: { resource: resources[1].resource },\n\t\t\t\tbase: { resource: resources[2].resource },\n\t\t\t\tresult: { resource: resources[3].resource },\n\t\t\t\toptions: { pinned: true },\n\t\t\t};\n\t\t\teditors.push(mergeEditor);\n\t\t} else if (\n\t\t\tdiffMode &&\n\t\t\tisResourceEditorInput(resources[0]) &&\n\t\t\tisResourceEditorInput(resources[1])\n\t\t) {\n\t\t\tconst diffEditor: IResourceDiffEditorInput = {\n\t\t\t\toriginal: { resource: resources[0].resource },\n\t\t\t\tmodified: { resource: resources[1].resource },\n\t\t\t\toptions: { pinned: true },\n\t\t\t};\n\t\t\teditors.push(diffEditor);\n\t\t} else {\n\t\t\teditors.push(...resources);\n\t\t}\n\n\t\treturn this.editorService.openEditors(editors, undefined, {\n\t\t\tvalidateTrust: true,\n\t\t});\n\t}\n\n\t//#region Window Zoom\n\n\tprivate readonly mapWindowIdToZoomStatusEntry = new Map<\n\t\tnumber,\n\t\tZoomStatusEntry\n\t>();\n\n\tprivate configuredWindowZoomLevel = this.resolveConfiguredWindowZoomLevel();\n\n\tprivate resolveConfiguredWindowZoomLevel(): number {\n\t\tconst windowZoomLevel =\n\t\t\tthis.configurationService.getValue(\"window.zoomLevel\");\n\n\t\treturn typeof windowZoomLevel === \"number\" ? windowZoomLevel : 0;\n\t}\n\n\tprivate handleOnDidChangeZoomLevel(targetWindowId: number): void {\n\t\t// Zoom status entry\n\t\tthis.updateWindowZoomStatusEntry(targetWindowId);\n\n\t\t// Notify main process about a custom zoom level\n\t\tif (targetWindowId === mainWindow.vscodeWindowId) {\n\t\t\tconst currentWindowZoomLevel = getZoomLevel(mainWindow);\n\n\t\t\tlet notifyZoomLevel: number | undefined;\n\t\t\tif (this.configuredWindowZoomLevel !== currentWindowZoomLevel) {\n\t\t\t\tnotifyZoomLevel = currentWindowZoomLevel;\n\t\t\t}\n\n\t\t\tipcRenderer.invoke(\"vscode:notifyZoomLevel\", notifyZoomLevel);\n\t\t}\n\t}\n\n\tprivate createWindowZoomStatusEntry(part: IEditorPart): void {\n\t\tconst disposables = new DisposableStore();\n\t\tEvent.once(part.onWillDispose)(() => disposables.dispose());\n\n\t\tconst scopedInstantiationService =\n\t\t\tthis.editorGroupService.getScopedInstantiationService(part);\n\t\tthis.mapWindowIdToZoomStatusEntry.set(\n\t\t\tpart.windowId,\n\t\t\tdisposables.add(\n\t\t\t\tscopedInstantiationService.createInstance(ZoomStatusEntry),\n\t\t\t),\n\t\t);\n\t\tdisposables.add(\n\t\t\ttoDisposable(() =>\n\t\t\t\tthis.mapWindowIdToZoomStatusEntry.delete(part.windowId),\n\t\t\t),\n\t\t);\n\n\t\tthis.updateWindowZoomStatusEntry(part.windowId);\n\t}\n\n\tprivate updateWindowZoomStatusEntry(targetWindowId: number): void {\n\t\tconst targetWindow = getWindowById(targetWindowId);\n\t\tconst entry = this.mapWindowIdToZoomStatusEntry.get(targetWindowId);\n\t\tif (entry && targetWindow) {\n\t\t\tconst currentZoomLevel = getZoomLevel(targetWindow.window);\n\n\t\t\tlet text: string | undefined;\n\t\t\tif (currentZoomLevel < this.configuredWindowZoomLevel) {\n\t\t\t\ttext = \"$(zoom-out)\";\n\t\t\t} else if (currentZoomLevel > this.configuredWindowZoomLevel) {\n\t\t\t\ttext = \"$(zoom-in)\";\n\t\t\t}\n\n\t\t\tentry.updateZoomEntry(text ?? false, targetWindowId);\n\t\t}\n\t}\n\n\tprivate onDidChangeConfiguredWindowZoomLevel(): void {\n\t\tthis.configuredWindowZoomLevel =\n\t\t\tthis.resolveConfiguredWindowZoomLevel();\n\n\t\tlet applyZoomLevel = false;\n\t\tfor (const { window } of getWindows()) {\n\t\t\tif (getZoomLevel(window) !== this.configuredWindowZoomLevel) {\n\t\t\t\tapplyZoomLevel = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (applyZoomLevel) {\n\t\t\tapplyZoom(\n\t\t\t\tthis.configuredWindowZoomLevel,\n\t\t\t\tApplyZoomTarget.ALL_WINDOWS,\n\t\t\t);\n\t\t}\n\n\t\tfor (const [windowId] of this.mapWindowIdToZoomStatusEntry) {\n\t\t\tthis.updateWindowZoomStatusEntry(windowId);\n\t\t}\n\t}\n\n\t//#endregion\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tfor (const [, entry] of this.mapWindowIdToZoomStatusEntry) {\n\t\t\tentry.dispose();\n\t\t}\n\t}\n}\n\nclass ZoomStatusEntry extends Disposable {\n\tprivate readonly disposable = this._register(\n\t\tnew MutableDisposable<DisposableStore>(),\n\t);\n\n\tprivate zoomLevelLabel: Action | undefined = undefined;\n\n\tconstructor(\n\t\t@IStatusbarService private readonly statusbarService: IStatusbarService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IKeybindingService\n\t\tprivate readonly keybindingService: IKeybindingService,\n\t) {\n\t\tsuper();\n\t}\n\n\tupdateZoomEntry(\n\t\tvisibleOrText: false | string,\n\t\ttargetWindowId: number,\n\t): void {\n\t\tif (typeof visibleOrText === \"string\") {\n\t\t\tif (!this.disposable.value) {\n\t\t\t\tthis.createZoomEntry(visibleOrText);\n\t\t\t}\n\n\t\t\tthis.updateZoomLevelLabel(targetWindowId);\n\t\t} else {\n\t\t\tthis.disposable.clear();\n\t\t}\n\t}\n\n\tprivate createZoomEntry(visibleOrText: string): void {\n\t\tconst disposables = new DisposableStore();\n\t\tthis.disposable.value = disposables;\n\n\t\tconst container = document.createElement(\"div\");\n\t\tcontainer.classList.add(\"zoom-status\");\n\n\t\tconst left = document.createElement(\"div\");\n\t\tleft.classList.add(\"zoom-status-left\");\n\t\tcontainer.appendChild(left);\n\n\t\tconst zoomOutAction: Action = disposables.add(\n\t\t\tnew Action(\n\t\t\t\t\"workbench.action.zoomOut\",\n\t\t\t\tlocalize(\"zoomOut\", \"Zoom Out\"),\n\t\t\t\tThemeIcon.asClassName(Codicon.remove),\n\t\t\t\ttrue,\n\t\t\t\t() => this.commandService.executeCommand(zoomOutAction.id),\n\t\t\t),\n\t\t);\n\t\tconst zoomInAction: Action = disposables.add(\n\t\t\tnew Action(\n\t\t\t\t\"workbench.action.zoomIn\",\n\t\t\t\tlocalize(\"zoomIn\", \"Zoom In\"),\n\t\t\t\tThemeIcon.asClassName(Codicon.plus),\n\t\t\t\ttrue,\n\t\t\t\t() => this.commandService.executeCommand(zoomInAction.id),\n\t\t\t),\n\t\t);\n\t\tconst zoomResetAction: Action = disposables.add(\n\t\t\tnew Action(\n\t\t\t\t\"workbench.action.zoomReset\",\n\t\t\t\tlocalize(\"zoomReset\", \"Reset\"),\n\t\t\t\tundefined,\n\t\t\t\ttrue,\n\t\t\t\t() => this.commandService.executeCommand(zoomResetAction.id),\n\t\t\t),\n\t\t);\n\t\tzoomResetAction.tooltip = localize(\n\t\t\t\"zoomResetLabel\",\n\t\t\t\"{0} ({1})\",\n\t\t\tzoomResetAction.label,\n\t\t\tthis.keybindingService\n\t\t\t\t.lookupKeybinding(zoomResetAction.id)\n\t\t\t\t?.getLabel(),\n\t\t);\n\t\tconst zoomSettingsAction: Action = disposables.add(\n\t\t\tnew Action(\n\t\t\t\t\"workbench.action.openSettings\",\n\t\t\t\tlocalize(\"zoomSettings\", \"Settings\"),\n\t\t\t\tThemeIcon.asClassName(Codicon.settingsGear),\n\t\t\t\ttrue,\n\t\t\t\t() =>\n\t\t\t\t\tthis.commandService.executeCommand(\n\t\t\t\t\t\tzoomSettingsAction.id,\n\t\t\t\t\t\t\"window.zoom\",\n\t\t\t\t\t),\n\t\t\t),\n\t\t);\n\t\tconst zoomLevelLabel = disposables.add(\n\t\t\tnew Action(\"zoomLabel\", undefined, undefined, false),\n\t\t);\n\n\t\tthis.zoomLevelLabel = zoomLevelLabel;\n\t\tdisposables.add(toDisposable(() => (this.zoomLevelLabel = undefined)));\n\n\t\tconst actionBarLeft = disposables.add(\n\t\t\tnew ActionBar(left, { hoverDelegate: nativeHoverDelegate }),\n\t\t);\n\t\tactionBarLeft.push(zoomOutAction, {\n\t\t\ticon: true,\n\t\t\tlabel: false,\n\t\t\tkeybinding: this.keybindingService\n\t\t\t\t.lookupKeybinding(zoomOutAction.id)\n\t\t\t\t?.getLabel(),\n\t\t});\n\t\tactionBarLeft.push(this.zoomLevelLabel, { icon: false, label: true });\n\t\tactionBarLeft.push(zoomInAction, {\n\t\t\ticon: true,\n\t\t\tlabel: false,\n\t\t\tkeybinding: this.keybindingService\n\t\t\t\t.lookupKeybinding(zoomInAction.id)\n\t\t\t\t?.getLabel(),\n\t\t});\n\n\t\tconst right = document.createElement(\"div\");\n\t\tright.classList.add(\"zoom-status-right\");\n\t\tcontainer.appendChild(right);\n\n\t\tconst actionBarRight = disposables.add(\n\t\t\tnew ActionBar(right, { hoverDelegate: nativeHoverDelegate }),\n\t\t);\n\n\t\tactionBarRight.push(zoomResetAction, { icon: false, label: true });\n\t\tactionBarRight.push(zoomSettingsAction, {\n\t\t\ticon: true,\n\t\t\tlabel: false,\n\t\t\tkeybinding: this.keybindingService\n\t\t\t\t.lookupKeybinding(zoomSettingsAction.id)\n\t\t\t\t?.getLabel(),\n\t\t});\n\n\t\tconst name = localize(\"status.windowZoom\", \"Window Zoom\");\n\t\tdisposables.add(\n\t\t\tthis.statusbarService.addEntry(\n\t\t\t\t{\n\t\t\t\t\tname,\n\t\t\t\t\ttext: visibleOrText,\n\t\t\t\t\ttooltip: container,\n\t\t\t\t\tariaLabel: name,\n\t\t\t\t\tcommand: ShowTooltipCommand,\n\t\t\t\t\tkind: \"prominent\",\n\t\t\t\t},\n\t\t\t\t\"status.windowZoom\",\n\t\t\t\tStatusbarAlignment.RIGHT,\n\t\t\t\t102,\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate updateZoomLevelLabel(targetWindowId: number): void {\n\t\tif (this.zoomLevelLabel) {\n\t\t\tconst targetWindow = getWindowById(targetWindowId, true).window;\n\t\t\tconst zoomFactor = Math.round(getZoomFactor(targetWindow) * 100);\n\t\t\tconst zoomLevel = getZoomLevel(targetWindow);\n\n\t\t\tthis.zoomLevelLabel.label = `${zoomLevel}`;\n\t\t\tthis.zoomLevelLabel.tooltip = localize(\n\t\t\t\t\"zoomNumber\",\n\t\t\t\t\"Zoom Level: {0} ({1}%)\",\n\t\t\t\tzoomLevel,\n\t\t\t\tzoomFactor,\n\t\t\t);\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
