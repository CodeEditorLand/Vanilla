import{asArray as Qe,coalesce as _,isNonEmptyArray as $e}from"../../../base/common/arrays.js";import{VSBuffer as ge,encodeBase64 as Je}from"../../../base/common/buffer.js";import{UriList as Ce}from"../../../base/common/dataTransfer.js";import{createSingleCallFunction as qe}from"../../../base/common/functional.js";import*as k from"../../../base/common/htmlContent.js";import"../../../base/common/lifecycle.js";import{ResourceMap as Xe,ResourceSet as Ye}from"../../../base/common/map.js";import*as xe from"../../../base/common/marked/marked.js";import{parse as Ze,revive as L}from"../../../base/common/marshalling.js";import{Mimes as Ie}from"../../../base/common/mime.js";import{cloneAndChange as et}from"../../../base/common/objects.js";import{WellDefinedPrefixTree as tt}from"../../../base/common/prefixTree.js";import{basename as nt}from"../../../base/common/resources.js";import{ThemeIcon as ot}from"../../../base/common/themables.js";import{isDefined as rt,isEmptyObject as at,isNumber as it,isString as ve,isUndefinedOrNull as ye}from"../../../base/common/types.js";import{URI as p,isUriComponents as he}from"../../../base/common/uri.js";import"../../../base/common/uriIpc.js";import{RenderLineNumbersType as T}from"../../../editor/common/config/editorOptions.js";import"../../../editor/common/core/position.js";import*as be from"../../../editor/common/core/range.js";import"../../../editor/common/core/selection.js";import"../../../editor/common/editorCommon.js";import*as N from"../../../editor/common/encodedTokenAttributes.js";import"../../../editor/common/languageSelector.js";import*as c from"../../../editor/common/languages.js";import{EndOfLineSequence as H,TrackedRangeStickiness as O}from"../../../editor/common/model.js";import"../../../platform/editor/common/editor.js";import"../../../platform/extensions/common/extensions.js";import{MarkerSeverity as y,MarkerTag as A}from"../../../platform/markers/common/markers.js";import{ProgressLocation as B}from"../../../platform/progress/common/progress.js";import{DEFAULT_EDITOR_ASSOCIATION as st,SaveReason as F}from"../../common/editor.js";import"../../common/views.js";import{ChatAgentLocation as R}from"../../contrib/chat/common/chatAgents.js";import"../../contrib/chat/common/chatModel.js";import"../../contrib/chat/common/chatService.js";import"../../contrib/chat/common/languageModelToolsService.js";import*as S from"../../contrib/chat/common/languageModels.js";import{DebugTreeItemCollapsibleState as ct}from"../../contrib/debug/common/debug.js";import*as I from"../../contrib/notebook/common/notebookCommon.js";import"../../contrib/notebook/common/notebookRange.js";import"../../contrib/search/common/search.js";import{TestId as U}from"../../contrib/testing/common/testId.js";import{DetailType as G,TestMessageType as Te,denamespaceTestTag as lt,namespaceTestTag as dt}from"../../contrib/testing/common/testTypes.js";import"../../services/editor/common/editorGroupColumn.js";import{ACTIVE_GROUP as ut,SIDE_GROUP as mt}from"../../services/editor/common/editorService.js";import"../../services/extensions/common/proxyIdentifier.js";import"./extHost.protocol.js";import"./extHostCommands.js";import{getPrivateApiFor as pt}from"./extHostTestingPrivateApi.js";import*as o from"./extHostTypes.js";var ft;(t=>{function a(e){const{selectionStartLineNumber:n,selectionStartColumn:i,positionLineNumber:l,positionColumn:r}=e,d=new o.Position(n-1,i-1),m=new o.Position(l-1,r-1);return new o.Selection(d,m)}t.to=a;function s(e){const{anchor:n,active:i}=e;return{selectionStartLineNumber:n.line+1,selectionStartColumn:n.character+1,positionLineNumber:i.line+1,positionColumn:i.character+1}}t.from=s})(ft||={});var u;(t=>{function a(e){if(!e)return;const{start:n,end:i}=e;return{startLineNumber:n.line+1,startColumn:n.character+1,endLineNumber:i.line+1,endColumn:i.character+1}}t.from=a;function s(e){if(!e)return;const{startLineNumber:n,startColumn:i,endLineNumber:l,endColumn:r}=e;return new o.Range(n-1,i-1,l-1,r-1)}t.to=s})(u||={});var P;(t=>{function a(e){return{uri:e.uri,range:u.from(e.range)}}t.from=a;function s(e){return new o.Location(p.revive(e.uri),u.to(e.range))}t.to=s})(P||={});var gt;(s=>{function a(t){switch(t){case N.StandardTokenType.Comment:return o.StandardTokenType.Comment;case N.StandardTokenType.Other:return o.StandardTokenType.Other;case N.StandardTokenType.RegEx:return o.StandardTokenType.RegEx;case N.StandardTokenType.String:return o.StandardTokenType.String}}s.to=a})(gt||={});var K;(t=>{function a(e){return new o.Position(e.lineNumber-1,e.column-1)}t.to=a;function s(e){return{lineNumber:e.line+1,column:e.character+1}}t.from=s})(K||={});var Ct;(e=>{function a(n,i,l){return _(Qe(n).map(r=>s(r,i,l)))}e.from=a;function s(n,i,l){if(typeof n=="string")return{$serialized:!0,language:n,isBuiltin:l?.isBuiltin};if(n)return{$serialized:!0,language:n.language,scheme:t(n.scheme,i),pattern:b.from(n.pattern)??void 0,exclusive:n.exclusive,notebookType:n.notebookType,isBuiltin:l?.isBuiltin}}function t(n,i){return i&&typeof n=="string"?i.transformOutgoingScheme(n):n}})(Ct||={});var j;(t=>{function a(e){switch(e){case o.DiagnosticTag.Unnecessary:return A.Unnecessary;case o.DiagnosticTag.Deprecated:return A.Deprecated}}t.from=a;function s(e){switch(e){case A.Unnecessary:return o.DiagnosticTag.Unnecessary;case A.Deprecated:return o.DiagnosticTag.Deprecated;default:return}}t.to=s})(j||={});var xt;(t=>{function a(e){let n;return e.code&&(ve(e.code)||it(e.code)?n=String(e.code):n={value:String(e.code.value),target:e.code.target}),{...u.from(e.range),message:e.message,source:e.source,code:n,severity:Q.from(e.severity),relatedInformation:e.relatedInformation&&e.relatedInformation.map(z.from),tags:Array.isArray(e.tags)?_(e.tags.map(j.from)):void 0}}t.from=a;function s(e){const n=new o.Diagnostic(u.to(e),e.message,Q.to(e.severity));return n.source=e.source,n.code=ve(e.code)?e.code:e.code?.value,n.relatedInformation=e.relatedInformation&&e.relatedInformation.map(z.to),n.tags=e.tags&&_(e.tags.map(j.to)),n}t.to=s})(xt||={});var z;(t=>{function a(e){return{...u.from(e.location.range),message:e.message,resource:e.location.uri}}t.from=a;function s(e){return new o.DiagnosticRelatedInformation(new o.Location(e.resource,u.to(e)),e.message)}t.to=s})(z||={});var Q;(t=>{function a(e){switch(e){case o.DiagnosticSeverity.Error:return y.Error;case o.DiagnosticSeverity.Warning:return y.Warning;case o.DiagnosticSeverity.Information:return y.Info;case o.DiagnosticSeverity.Hint:return y.Hint}return y.Error}t.from=a;function s(e){switch(e){case y.Info:return o.DiagnosticSeverity.Information;case y.Warning:return o.DiagnosticSeverity.Warning;case y.Error:return o.DiagnosticSeverity.Error;case y.Hint:return o.DiagnosticSeverity.Hint;default:return o.DiagnosticSeverity.Error}}t.to=s})(Q||={});var It;(t=>{function a(e){return typeof e=="number"&&e>=o.ViewColumn.One?e-1:e===o.ViewColumn.Beside?mt:ut}t.from=a;function s(e){if(typeof e=="number"&&e>=0)return e+1;throw new Error("invalid 'EditorGroupColumn'")}t.to=s})(It||={});function vt(a){return typeof a.range<"u"}function yt(a){return a.length===0?!0:!!vt(a[0])}var f;(l=>{function a(r){return r.map(l.from)}l.fromMany=a;function s(r){return r&&typeof r=="object"&&typeof r.language=="string"&&typeof r.value=="string"}function t(r){let d;if(s(r)){const{language:g,value:C}=r;d={value:"```"+g+`
`+C+"\n```\n"}}else o.MarkdownString.isMarkdownString(r)?d={value:r.value,isTrusted:r.isTrusted,supportThemeIcons:r.supportThemeIcons,supportHtml:r.supportHtml,baseUri:r.baseUri}:typeof r=="string"?d={value:r}:d={value:""};const m=Object.create(null);d.uris=m;const x=({href:g})=>{try{let C=p.parse(g,!0);C=C.with({query:e(C.query,m)}),m[g]=C}catch{}return""};return xe.marked.walkTokens(xe.marked.lexer(d.value),g=>{g.type==="link"?x({href:g.href}):g.type==="image"&&typeof g.href=="string"&&x(k.parseHrefAndDimensions(g.href))}),d}l.from=t;function e(r,d){if(!r)return r;let m;try{m=Ze(r)}catch{}if(!m)return r;let x=!1;return m=et(m,g=>{if(p.isUri(g)){const C=`__uri_${Math.random().toString(16).slice(2,8)}`;return d[C]=g,x=!0,C}else return}),x?JSON.stringify(m):r}function n(r){const d=new o.MarkdownString(r.value,r.supportThemeIcons);return d.isTrusted=r.isTrusted,d.supportHtml=r.supportHtml,d.baseUri=r.baseUri?p.from(r.baseUri):void 0,d}l.to=n;function i(r){if(r)return typeof r=="string"?r:l.from(r)}l.fromStrict=i})(f||={});function ir(a){return yt(a)?a.map(s=>({range:u.from(s.range),hoverMessage:Array.isArray(s.hoverMessage)?f.fromMany(s.hoverMessage):s.hoverMessage?f.from(s.hoverMessage):void 0,renderOptions:s.renderOptions})):a.map(s=>({range:u.from(s)}))}function $(a){return typeof a>"u"?a:typeof a=="string"?p.file(a):a}var w;(s=>{function a(t){return typeof t>"u"?t:{contentText:t.contentText,contentIconPath:t.contentIconPath?$(t.contentIconPath):void 0,border:t.border,borderColor:t.borderColor,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,color:t.color,backgroundColor:t.backgroundColor,margin:t.margin,width:t.width,height:t.height}}s.from=a})(w||={});var J;(s=>{function a(t){return typeof t>"u"?t:{backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?$(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?w.from(t.before):void 0,after:t.after?w.from(t.after):void 0}}s.from=a})(J||={});var Re;(s=>{function a(t){if(typeof t>"u")return t;switch(t){case o.DecorationRangeBehavior.OpenOpen:return O.AlwaysGrowsWhenTypingAtEdges;case o.DecorationRangeBehavior.ClosedClosed:return O.NeverGrowsWhenTypingAtEdges;case o.DecorationRangeBehavior.OpenClosed:return O.GrowsOnlyWhenTypingBefore;case o.DecorationRangeBehavior.ClosedOpen:return O.GrowsOnlyWhenTypingAfter}}s.from=a})(Re||={});var ht;(s=>{function a(t){return{isWholeLine:t.isWholeLine,rangeBehavior:t.rangeBehavior?Re.from(t.rangeBehavior):void 0,overviewRulerLane:t.overviewRulerLane,light:t.light?J.from(t.light):void 0,dark:t.dark?J.from(t.dark):void 0,backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?$(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?w.from(t.before):void 0,after:t.after?w.from(t.after):void 0}}s.from=a})(ht||={});var v;(t=>{function a(e){return{text:e.newText,eol:e.newEol&&te.from(e.newEol),range:u.from(e.range)}}t.from=a;function s(e){const n=new o.TextEdit(u.to(e.range),e.text);return n.newEol=typeof e.eol>"u"?void 0:te.to(e.eol),n}t.to=s})(v||={});var bt;(t=>{function a(e,n){const i={edits:[]};if(e instanceof o.WorkspaceEdit){const l=new Ye;for(const r of e._allEntries())r._type===o.FileEditType.File&&p.isUri(r.to)&&r.from===void 0&&l.add(r.to);for(const r of e._allEntries())if(r._type===o.FileEditType.File){let d;r.options?.contents&&(ArrayBuffer.isView(r.options.contents)?d={type:"base64",value:Je(ge.wrap(r.options.contents))}:d={type:"dataTransferItem",id:r.options.contents._itemId}),i.edits.push({oldResource:r.from,newResource:r.to,options:{...r.options,contents:d},metadata:r.metadata})}else r._type===o.FileEditType.Text?i.edits.push({resource:r.uri,textEdit:v.from(r.edit),versionId:l.has(r.uri)?void 0:n?.getTextDocumentVersion(r.uri),metadata:r.metadata}):r._type===o.FileEditType.Snippet?i.edits.push({resource:r.uri,textEdit:{range:u.from(r.range),text:r.edit.value,insertAsSnippet:!0},versionId:l.has(r.uri)?void 0:n?.getTextDocumentVersion(r.uri),metadata:r.metadata}):r._type===o.FileEditType.Cell?i.edits.push({metadata:r.metadata,resource:r.uri,cellEdit:r.edit,notebookMetadata:r.notebookMetadata,notebookVersionId:n?.getNotebookDocumentVersion(r.uri)}):r._type===o.FileEditType.CellReplace&&i.edits.push({metadata:r.metadata,resource:r.uri,notebookVersionId:n?.getNotebookDocumentVersion(r.uri),cellEdit:{editType:I.CellEditType.Replace,index:r.index,count:r.count,cells:r.cells.map(V.from)}})}return i}t.from=a;function s(e){const n=new o.WorkspaceEdit,i=new Xe;for(const l of e.edits)if(l.textEdit){const r=l,d=p.revive(r.resource),m=u.to(r.textEdit.range),x=r.textEdit.text,g=r.textEdit.insertAsSnippet;let C;g?C=o.SnippetTextEdit.replace(m,new o.SnippetString(x)):C=o.TextEdit.replace(m,x);const fe=i.get(d);fe?fe.push(C):i.set(d,[C])}else n.renameFile(p.revive(l.oldResource),p.revive(l.newResource),l.options);for(const[l,r]of i)n.set(l,r);return n}t.to=s})(bt||={});var h;(e=>{const a=Object.create(null);a[o.SymbolKind.File]=c.SymbolKind.File,a[o.SymbolKind.Module]=c.SymbolKind.Module,a[o.SymbolKind.Namespace]=c.SymbolKind.Namespace,a[o.SymbolKind.Package]=c.SymbolKind.Package,a[o.SymbolKind.Class]=c.SymbolKind.Class,a[o.SymbolKind.Method]=c.SymbolKind.Method,a[o.SymbolKind.Property]=c.SymbolKind.Property,a[o.SymbolKind.Field]=c.SymbolKind.Field,a[o.SymbolKind.Constructor]=c.SymbolKind.Constructor,a[o.SymbolKind.Enum]=c.SymbolKind.Enum,a[o.SymbolKind.Interface]=c.SymbolKind.Interface,a[o.SymbolKind.Function]=c.SymbolKind.Function,a[o.SymbolKind.Variable]=c.SymbolKind.Variable,a[o.SymbolKind.Constant]=c.SymbolKind.Constant,a[o.SymbolKind.String]=c.SymbolKind.String,a[o.SymbolKind.Number]=c.SymbolKind.Number,a[o.SymbolKind.Boolean]=c.SymbolKind.Boolean,a[o.SymbolKind.Array]=c.SymbolKind.Array,a[o.SymbolKind.Object]=c.SymbolKind.Object,a[o.SymbolKind.Key]=c.SymbolKind.Key,a[o.SymbolKind.Null]=c.SymbolKind.Null,a[o.SymbolKind.EnumMember]=c.SymbolKind.EnumMember,a[o.SymbolKind.Struct]=c.SymbolKind.Struct,a[o.SymbolKind.Event]=c.SymbolKind.Event,a[o.SymbolKind.Operator]=c.SymbolKind.Operator,a[o.SymbolKind.TypeParameter]=c.SymbolKind.TypeParameter;function s(n){return typeof a[n]=="number"?a[n]:c.SymbolKind.Property}e.from=s;function t(n){for(const i in a)if(a[i]===n)return Number(i);return o.SymbolKind.Property}e.to=t})(h||={});var D;(t=>{function a(e){switch(e){case o.SymbolTag.Deprecated:return c.SymbolTag.Deprecated}}t.from=a;function s(e){switch(e){case c.SymbolTag.Deprecated:return o.SymbolTag.Deprecated}}t.to=s})(D||={});var q;(t=>{function a(e){return{name:e.name,kind:h.from(e.kind),tags:e.tags&&e.tags.map(D.from),containerName:e.containerName,location:E.from(e.location)}}t.from=a;function s(e){const n=new o.SymbolInformation(e.name,h.to(e.kind),e.containerName,E.to(e.location));return n.tags=e.tags&&e.tags.map(D.to),n}t.to=s})(q||={});var Tt;(t=>{function a(e){const n={name:e.name||"!!MISSING: name!!",detail:e.detail,range:u.from(e.range),selectionRange:u.from(e.selectionRange),kind:h.from(e.kind),tags:e.tags?.map(D.from)??[]};return e.children&&(n.children=e.children.map(a)),n}t.from=a;function s(e){const n=new o.DocumentSymbol(e.name,e.detail,h.to(e.kind),u.to(e.range),u.to(e.selectionRange));return $e(e.tags)&&(n.tags=e.tags.map(D.to)),e.children&&(n.children=e.children.map(s)),n}t.to=s})(Tt||={});var X;(t=>{function a(e){const n=new o.CallHierarchyItem(h.to(e.kind),e.name,e.detail||"",p.revive(e.uri),u.to(e.range),u.to(e.selectionRange));return n._sessionId=e._sessionId,n._itemId=e._itemId,n}t.to=a;function s(e,n,i){if(n=n??e._sessionId,i=i??e._itemId,n===void 0||i===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:i,name:e.name,detail:e.detail,kind:h.from(e.kind),uri:e.uri,range:u.from(e.range),selectionRange:u.from(e.selectionRange),tags:e.tags?.map(D.from)}}t.from=s})(X||={});var Rt;(s=>{function a(t){return new o.CallHierarchyIncomingCall(X.to(t.from),t.fromRanges.map(e=>u.to(e)))}s.to=a})(Rt||={});var St;(s=>{function a(t){return new o.CallHierarchyOutgoingCall(X.to(t.to),t.fromRanges.map(e=>u.to(e)))}s.to=a})(St||={});var E;(t=>{function a(e){return{range:e.range&&u.from(e.range),uri:e.uri}}t.from=a;function s(e){return new o.Location(p.revive(e.uri),u.to(e.range))}t.to=s})(E||={});var Pt;(t=>{function a(e){const n=e,i=e;return{originSelectionRange:n.originSelectionRange?u.from(n.originSelectionRange):void 0,uri:n.targetUri?n.targetUri:i.uri,range:u.from(n.targetRange?n.targetRange:i.range),targetSelectionRange:n.targetSelectionRange?u.from(n.targetSelectionRange):void 0}}t.from=a;function s(e){return{targetUri:p.revive(e.uri),targetRange:u.to(e.range),targetSelectionRange:e.targetSelectionRange?u.to(e.targetSelectionRange):void 0,originSelectionRange:e.originSelectionRange?u.to(e.originSelectionRange):void 0}}t.to=s})(Pt||={});var Dt;(t=>{function a(e){return{range:u.from(e.range),contents:f.fromMany(e.contents),canIncreaseVerbosity:e.canIncreaseVerbosity,canDecreaseVerbosity:e.canDecreaseVerbosity}}t.from=a;function s(e){const n=e.contents.map(f.to),i=u.to(e.range),l=e.canIncreaseVerbosity,r=e.canDecreaseVerbosity;return new o.VerboseHover(n,i,l,r)}t.to=s})(Dt||={});var kt;(t=>{function a(e){return{range:u.from(e.range),expression:e.expression}}t.from=a;function s(e){return new o.EvaluatableExpression(u.to(e.range),e.expression)}t.to=s})(kt||={});var Kt;(t=>{function a(e){if(e instanceof o.InlineValueText)return{type:"text",range:u.from(e.range),text:e.text};if(e instanceof o.InlineValueVariableLookup)return{type:"variable",range:u.from(e.range),variableName:e.variableName,caseSensitiveLookup:e.caseSensitiveLookup};if(e instanceof o.InlineValueEvaluatableExpression)return{type:"expression",range:u.from(e.range),expression:e.expression};throw new Error("Unknown 'InlineValue' type")}t.from=a;function s(e){switch(e.type){case"text":return{range:u.to(e.range),text:e.text};case"variable":return{range:u.to(e.range),variableName:e.variableName,caseSensitiveLookup:e.caseSensitiveLookup};case"expression":return{range:u.to(e.range),expression:e.expression}}}t.to=s})(Kt||={});var wt;(t=>{function a(e){return{frameId:e.frameId,stoppedLocation:u.from(e.stoppedLocation)}}t.from=a;function s(e){return new o.InlineValueContext(e.frameId,u.to(e.stoppedLocation))}t.to=s})(wt||={});var Y;(t=>{function a(e){return{range:u.from(e.range),kind:e.kind}}t.from=a;function s(e){return new o.DocumentHighlight(u.to(e.range),e.kind)}t.to=s})(Y||={});var Et;(t=>{function a(e){return{uri:e.uri,highlights:e.highlights.map(Y.from)}}t.from=a;function s(e){return new o.MultiDocumentHighlight(p.revive(e.uri),e.highlights.map(Y.to))}t.to=s})(Et||={});var Se;(s=>{function a(t){switch(t){case c.CompletionTriggerKind.TriggerCharacter:return o.CompletionTriggerKind.TriggerCharacter;case c.CompletionTriggerKind.TriggerForIncompleteCompletions:return o.CompletionTriggerKind.TriggerForIncompleteCompletions;case c.CompletionTriggerKind.Invoke:default:return o.CompletionTriggerKind.Invoke}}s.to=a})(Se||={});var Mt;(s=>{function a(t){return{triggerKind:Se.to(t.triggerKind),triggerCharacter:t.triggerCharacter}}s.to=a})(Mt||={});var Pe;(t=>{function a(e){switch(e){case o.CompletionItemTag.Deprecated:return c.CompletionItemTag.Deprecated}}t.from=a;function s(e){switch(e){case c.CompletionItemTag.Deprecated:return o.CompletionItemTag.Deprecated}}t.to=s})(Pe||={});var De;(n=>{const a=new Map([[o.CompletionItemKind.Method,c.CompletionItemKind.Method],[o.CompletionItemKind.Function,c.CompletionItemKind.Function],[o.CompletionItemKind.Constructor,c.CompletionItemKind.Constructor],[o.CompletionItemKind.Field,c.CompletionItemKind.Field],[o.CompletionItemKind.Variable,c.CompletionItemKind.Variable],[o.CompletionItemKind.Class,c.CompletionItemKind.Class],[o.CompletionItemKind.Interface,c.CompletionItemKind.Interface],[o.CompletionItemKind.Struct,c.CompletionItemKind.Struct],[o.CompletionItemKind.Module,c.CompletionItemKind.Module],[o.CompletionItemKind.Property,c.CompletionItemKind.Property],[o.CompletionItemKind.Unit,c.CompletionItemKind.Unit],[o.CompletionItemKind.Value,c.CompletionItemKind.Value],[o.CompletionItemKind.Constant,c.CompletionItemKind.Constant],[o.CompletionItemKind.Enum,c.CompletionItemKind.Enum],[o.CompletionItemKind.EnumMember,c.CompletionItemKind.EnumMember],[o.CompletionItemKind.Keyword,c.CompletionItemKind.Keyword],[o.CompletionItemKind.Snippet,c.CompletionItemKind.Snippet],[o.CompletionItemKind.Text,c.CompletionItemKind.Text],[o.CompletionItemKind.Color,c.CompletionItemKind.Color],[o.CompletionItemKind.File,c.CompletionItemKind.File],[o.CompletionItemKind.Reference,c.CompletionItemKind.Reference],[o.CompletionItemKind.Folder,c.CompletionItemKind.Folder],[o.CompletionItemKind.Event,c.CompletionItemKind.Event],[o.CompletionItemKind.Operator,c.CompletionItemKind.Operator],[o.CompletionItemKind.TypeParameter,c.CompletionItemKind.TypeParameter],[o.CompletionItemKind.Issue,c.CompletionItemKind.Issue],[o.CompletionItemKind.User,c.CompletionItemKind.User]]);function s(i){return a.get(i)??c.CompletionItemKind.Property}n.from=s;const t=new Map([[c.CompletionItemKind.Method,o.CompletionItemKind.Method],[c.CompletionItemKind.Function,o.CompletionItemKind.Function],[c.CompletionItemKind.Constructor,o.CompletionItemKind.Constructor],[c.CompletionItemKind.Field,o.CompletionItemKind.Field],[c.CompletionItemKind.Variable,o.CompletionItemKind.Variable],[c.CompletionItemKind.Class,o.CompletionItemKind.Class],[c.CompletionItemKind.Interface,o.CompletionItemKind.Interface],[c.CompletionItemKind.Struct,o.CompletionItemKind.Struct],[c.CompletionItemKind.Module,o.CompletionItemKind.Module],[c.CompletionItemKind.Property,o.CompletionItemKind.Property],[c.CompletionItemKind.Unit,o.CompletionItemKind.Unit],[c.CompletionItemKind.Value,o.CompletionItemKind.Value],[c.CompletionItemKind.Constant,o.CompletionItemKind.Constant],[c.CompletionItemKind.Enum,o.CompletionItemKind.Enum],[c.CompletionItemKind.EnumMember,o.CompletionItemKind.EnumMember],[c.CompletionItemKind.Keyword,o.CompletionItemKind.Keyword],[c.CompletionItemKind.Snippet,o.CompletionItemKind.Snippet],[c.CompletionItemKind.Text,o.CompletionItemKind.Text],[c.CompletionItemKind.Color,o.CompletionItemKind.Color],[c.CompletionItemKind.File,o.CompletionItemKind.File],[c.CompletionItemKind.Reference,o.CompletionItemKind.Reference],[c.CompletionItemKind.Folder,o.CompletionItemKind.Folder],[c.CompletionItemKind.Event,o.CompletionItemKind.Event],[c.CompletionItemKind.Operator,o.CompletionItemKind.Operator],[c.CompletionItemKind.TypeParameter,o.CompletionItemKind.TypeParameter],[c.CompletionItemKind.User,o.CompletionItemKind.User],[c.CompletionItemKind.Issue,o.CompletionItemKind.Issue]]);function e(i){return t.get(i)??o.CompletionItemKind.Property}n.to=e})(De||={});var Lt;(s=>{function a(t,e){const n=new o.CompletionItem(t.label);return n.insertText=t.insertText,n.kind=De.to(t.kind),n.tags=t.tags?.map(Pe.to),n.detail=t.detail,n.documentation=k.isMarkdownString(t.documentation)?f.to(t.documentation):t.documentation,n.sortText=t.sortText,n.filterText=t.filterText,n.preselect=t.preselect,n.commitCharacters=t.commitCharacters,be.Range.isIRange(t.range)?n.range=u.to(t.range):typeof t.range=="object"&&(n.range={inserting:u.to(t.range.insert),replacing:u.to(t.range.replace)}),n.keepWhitespace=typeof t.insertTextRules>"u"?!1:!!(t.insertTextRules&c.CompletionItemInsertTextRule.KeepWhitespace),typeof t.insertTextRules<"u"&&t.insertTextRules&c.CompletionItemInsertTextRule.InsertAsSnippet?n.insertText=new o.SnippetString(t.insertText):(n.insertText=t.insertText,n.textEdit=n.range instanceof o.Range?new o.TextEdit(n.range,n.insertText):void 0),t.additionalTextEdits&&t.additionalTextEdits.length>0&&(n.additionalTextEdits=t.additionalTextEdits.map(i=>v.to(i))),n.command=e&&t.command?e.fromInternal(t.command):void 0,n}s.to=a})(Lt||={});var Z;(t=>{function a(e){if(typeof e.label!="string"&&!Array.isArray(e.label))throw new TypeError("Invalid label");return{label:e.label,documentation:f.fromStrict(e.documentation)}}t.from=a;function s(e){return{label:e.label,documentation:k.isMarkdownString(e.documentation)?f.to(e.documentation):e.documentation}}t.to=s})(Z||={});var ee;(t=>{function a(e){return{label:e.label,documentation:f.fromStrict(e.documentation),parameters:Array.isArray(e.parameters)?e.parameters.map(Z.from):[],activeParameter:e.activeParameter}}t.from=a;function s(e){return{label:e.label,documentation:k.isMarkdownString(e.documentation)?f.to(e.documentation):e.documentation,parameters:Array.isArray(e.parameters)?e.parameters.map(Z.to):[],activeParameter:e.activeParameter}}t.to=s})(ee||={});var Nt;(t=>{function a(e){return{activeSignature:e.activeSignature,activeParameter:e.activeParameter,signatures:Array.isArray(e.signatures)?e.signatures.map(ee.from):[]}}t.from=a;function s(e){return{activeSignature:e.activeSignature,activeParameter:e.activeParameter,signatures:Array.isArray(e.signatures)?e.signatures.map(ee.to):[]}}t.to=s})(Nt||={});var Ht;(s=>{function a(t,e){const n=new o.InlayHint(K.to(e.position),typeof e.label=="string"?e.label:e.label.map(ke.to.bind(void 0,t)),e.kind&&Ke.to(e.kind));return n.textEdits=e.textEdits&&e.textEdits.map(v.to),n.tooltip=k.isMarkdownString(e.tooltip)?f.to(e.tooltip):e.tooltip,n.paddingLeft=e.paddingLeft,n.paddingRight=e.paddingRight,n}s.to=a})(Ht||={});var ke;(s=>{function a(t,e){const n=new o.InlayHintLabelPart(e.label);return n.tooltip=k.isMarkdownString(e.tooltip)?f.to(e.tooltip):e.tooltip,c.Command.is(e.command)&&(n.command=t.fromInternal(e.command)),e.location&&(n.location=E.to(e.location)),n}s.to=a})(ke||={});var Ke;(t=>{function a(e){return e}t.from=a;function s(e){return e}t.to=s})(Ke||={});var Ot;(t=>{function a(e){return{range:u.from(e.range),url:e.target,tooltip:e.tooltip}}t.from=a;function s(e){let n;if(e.url)try{n=typeof e.url=="string"?p.parse(e.url,!0):p.revive(e.url)}catch{}const i=new o.DocumentLink(u.to(e.range),n);return i.tooltip=e.tooltip,i}t.to=s})(Ot||={});var At;(t=>{function a(e){const n=new o.ColorPresentation(e.label);return e.textEdit&&(n.textEdit=v.to(e.textEdit)),e.additionalTextEdits&&(n.additionalTextEdits=e.additionalTextEdits.map(i=>v.to(i))),n}t.to=a;function s(e){return{label:e.label,textEdit:e.textEdit?v.from(e.textEdit):void 0,additionalTextEdits:e.additionalTextEdits?e.additionalTextEdits.map(n=>v.from(n)):void 0}}t.from=s})(At||={});var Ft;(t=>{function a(e){return new o.Color(e[0],e[1],e[2],e[3])}t.to=a;function s(e){return[e.red,e.green,e.blue,e.alpha]}t.from=s})(Ft||={});var Ut;(t=>{function a(e){return{range:u.from(e.range)}}t.from=a;function s(e){return new o.SelectionRange(u.to(e.range))}t.to=s})(Ut||={});var Wt;(s=>{function a(t){switch(t){case F.AUTO:return o.TextDocumentSaveReason.AfterDelay;case F.EXPLICIT:return o.TextDocumentSaveReason.Manual;case F.FOCUS_CHANGE:case F.WINDOW_CHANGE:return o.TextDocumentSaveReason.FocusOut}}s.to=a})(Wt||={});var Vt;(t=>{function a(e){switch(e){case o.TextEditorLineNumbersStyle.Off:return T.Off;case o.TextEditorLineNumbersStyle.Relative:return T.Relative;case o.TextEditorLineNumbersStyle.Interval:return T.Interval;case o.TextEditorLineNumbersStyle.On:default:return T.On}}t.from=a;function s(e){switch(e){case T.Off:return o.TextEditorLineNumbersStyle.Off;case T.Relative:return o.TextEditorLineNumbersStyle.Relative;case T.Interval:return o.TextEditorLineNumbersStyle.Interval;case T.On:default:return o.TextEditorLineNumbersStyle.On}}t.to=s})(Vt||={});var te;(t=>{function a(e){if(e===o.EndOfLine.CRLF)return H.CRLF;if(e===o.EndOfLine.LF)return H.LF}t.from=a;function s(e){if(e===H.CRLF)return o.EndOfLine.CRLF;if(e===H.LF)return o.EndOfLine.LF}t.to=s})(te||={});var _t;(s=>{function a(t){if(typeof t=="object")return t.viewId;switch(t){case o.ProgressLocation.SourceControl:return B.Scm;case o.ProgressLocation.Window:return B.Window;case o.ProgressLocation.Notification:return B.Notification}throw new Error("Unknown 'ProgressLocation'")}s.from=a})(_t||={});var Bt;(t=>{function a(e){const n={start:e.start+1,end:e.end+1};return e.kind&&(n.kind=ne.from(e.kind)),n}t.from=a;function s(e){const n={start:e.start-1,end:e.end-1};return e.kind&&(n.kind=ne.to(e.kind)),n}t.to=s})(Bt||={});var ne;(t=>{function a(e){if(e)switch(e){case o.FoldingRangeKind.Comment:return c.FoldingRangeKind.Comment;case o.FoldingRangeKind.Imports:return c.FoldingRangeKind.Imports;case o.FoldingRangeKind.Region:return c.FoldingRangeKind.Region}}t.from=a;function s(e){if(e)switch(e.value){case c.FoldingRangeKind.Comment.value:return o.FoldingRangeKind.Comment;case c.FoldingRangeKind.Imports.value:return o.FoldingRangeKind.Imports;case c.FoldingRangeKind.Region.value:return o.FoldingRangeKind.Region}}t.to=s})(ne||={});var Gt;(s=>{function a(t){if(t)return{pinned:typeof t.preview=="boolean"?!t.preview:void 0,inactive:t.background,preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?u.from(t.selection):void 0,override:typeof t.override=="boolean"?st.id:void 0}}s.from=a})(Gt||={});var b;(n=>{function a(i){return i instanceof o.RelativePattern?i.toJSON():typeof i=="string"?i:s(i)||t(i)?new o.RelativePattern(i.baseUri??i.base,i.pattern).toJSON():i}n.from=a;function s(i){const l=i;return l?p.isUri(l.baseUri)&&typeof l.pattern=="string":!1}function t(i){const l=i;return l?typeof l.base=="string"&&typeof l.pattern=="string":!1}function e(i){return typeof i=="string"?i:new o.RelativePattern(p.revive(i.baseUri),i.pattern)}n.to=e})(b||={});var jt;(s=>{function a(t){if(t){if(Array.isArray(t))return t.map(a);if(typeof t=="string")return t;{const e=t;return{language:e.language,scheme:e.scheme,pattern:b.from(e.pattern),exclusive:e.exclusive,notebookType:e.notebookType}}}else return}s.from=a})(jt||={});var zt;(t=>{function a(e){return!!e&&typeof e=="object"&&"documents"in e&&Array.isArray(e.documents)&&e.documents.every(n=>Array.isArray(n)&&n.every(W.is))}t.is=a;function s(e){return{documents:e.documents.map(n=>n.map(W.from)),conversation:e.conversation?.map(n=>n.type==="request"?{type:"request",message:n.message}:{type:"response",message:n.message,references:n.references?.map(W.from)})}}t.from=s})(zt||={});var W;(t=>{function a(e){return typeof e=="object"&&e!==null&&"uri"in e&&p.isUri(e.uri)&&"version"in e&&typeof e.version=="number"&&"ranges"in e&&Array.isArray(e.ranges)&&e.ranges.every(n=>n instanceof o.Range)}t.is=a;function s(e){return{uri:p.from(e.uri),version:e.version,ranges:e.ranges.map(n=>u.from(n))}}t.from=s})(W||={});var Qt;(t=>{function a(e){return{start:e.start,end:e.end}}t.from=a;function s(e){return new o.NotebookRange(e.start,e.end)}t.to=s})(Qt||={});var oe;(t=>{function a(e){return{timing:typeof e.runStartTime=="number"&&typeof e.runEndTime=="number"?{startTime:e.runStartTime,endTime:e.runEndTime}:void 0,executionOrder:e.executionOrder,success:e.lastRunSuccess}}t.to=a;function s(e){return{lastRunSuccess:e.success,runStartTime:e.timing?.startTime,runEndTime:e.timing?.endTime,executionOrder:e.executionOrder}}t.from=s})(oe||={});var $t;(s=>{function a(t){if(t===I.NotebookCellExecutionState.Unconfirmed)return o.NotebookCellExecutionState.Pending;if(t===I.NotebookCellExecutionState.Pending)return;if(t===I.NotebookCellExecutionState.Executing)return o.NotebookCellExecutionState.Executing;throw new Error(`Unknown state: ${t}`)}s.to=a})($t||={});var re;(t=>{function a(e){switch(e){case o.NotebookCellKind.Markup:return I.CellKind.Markup;case o.NotebookCellKind.Code:default:return I.CellKind.Code}}t.from=a;function s(e){switch(e){case I.CellKind.Markup:return o.NotebookCellKind.Markup;case I.CellKind.Code:default:return o.NotebookCellKind.Code}}t.to=s})(re||={});var Jt;(t=>{function a(e){const n={metadata:e.metadata??Object.create(null),cells:[]};for(const i of e.cells)o.NotebookCellData.validate(i),n.cells.push(V.from(i));return n}t.from=a;function s(e){const n=new o.NotebookData(e.cells.map(V.to));return at(e.metadata)||(n.metadata=e.metadata),n}t.to=s})(Jt||={});var V;(t=>{function a(e){return{cellKind:re.from(e.kind),language:e.languageId,mime:e.mime,source:e.value,metadata:e.metadata,internalMetadata:oe.from(e.executionSummary??{}),outputs:e.outputs?e.outputs.map(ie.from):[]}}t.from=a;function s(e){return new o.NotebookCellData(re.to(e.cellKind),e.source,e.language,e.mime,e.outputs?e.outputs.map(ie.to):void 0,e.metadata,e.internalMetadata?oe.to(e.internalMetadata):void 0)}t.to=s})(V||={});var ae;(t=>{function a(e){return{mime:e.mime,valueBytes:ge.wrap(e.data)}}t.from=a;function s(e){return new o.NotebookCellOutputItem(e.valueBytes.buffer,e.mime)}t.to=s})(ae||={});var ie;(t=>{function a(e){return{outputId:e.id,items:e.items.map(ae.from),metadata:e.metadata}}t.from=a;function s(e){const n=e.items.map(ae.to);return new o.NotebookCellOutput(n,e.outputId,e.metadata)}t.to=s})(ie||={});var qt;(e=>{function a(n){return t(n)?{include:b.from(n.include)??void 0,exclude:b.from(n.exclude)??void 0}:b.from(n)??void 0}e.from=a;function s(n){return t(n)?{include:b.to(n.include),exclude:b.to(n.exclude)}:b.to(n)}e.to=s;function t(n){const i=n;return i?!ye(i.include)&&!ye(i.exclude):!1}})(qt||={});var Xt;(s=>{function a(t,e,n){const i=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{alignment:t.alignment===o.NotebookCellStatusBarAlignment.Left?I.CellStatusbarAlignment.Left:I.CellStatusbarAlignment.Right,command:e.toInternal(i,n),text:t.text,tooltip:t.tooltip,accessibilityInformation:t.accessibilityInformation,priority:t.priority}}s.from=a})(Xt||={});var Yt;(s=>{function a(t,e,n){const i=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{command:e.toInternal(i,n),label:t.label,description:t.description,detail:t.detail,documentation:t.documentation}}s.from=a})(Yt||={});var Zt;(s=>{function a(t){return{transientOutputs:t?.transientOutputs??!1,transientCellMetadata:t?.transientCellMetadata??{},transientDocumentMetadata:t?.transientDocumentMetadata??{},cellContentMetadata:t?.cellContentMetadata??{}}}s.from=a})(Zt||={});var en;(t=>{function a(e){return{uri:e.uri,provides:e.provides}}t.from=a;function s(e){return new o.NotebookRendererScript(p.revive(e.uri),e.provides)}t.to=s})(en||={});var we;(t=>{function a(e){return{message:f.fromStrict(e.message)||"",type:Te.Error,expected:e.expectedOutput,actual:e.actualOutput,contextValue:e.contextValue,location:e.location&&{range:u.from(e.location.range),uri:e.location.uri},stackTrace:e.stackTrace?.map(n=>({label:n.label,position:n.position&&K.from(n.position),uri:n.uri&&p.revive(n.uri).toJSON()}))}}t.from=a;function s(e){const n=new o.TestMessage(typeof e.message=="string"?e.message:f.to(e.message));return n.actualOutput=e.actual,n.expectedOutput=e.expected,n.contextValue=e.contextValue,n.location=e.location?E.to(e.location):void 0,n}t.to=s})(we||={});var M;(t=>(t.namespace=dt,t.denamespace=lt))(M||={});var Ee;(t=>{function a(e){const n=pt(e).controllerId;return{extId:U.fromExtHostTestItem(e,n).toString(),label:e.label,uri:p.revive(e.uri),busy:e.busy,tags:e.tags.map(i=>M.namespace(n,i.id)),range:be.Range.lift(u.from(e.range)),description:e.description||null,sortText:e.sortText||null,error:e.error&&f.fromStrict(e.error)||null}}t.from=a;function s(e){return{parent:void 0,error:void 0,id:U.fromString(e.extId).localId,label:e.label,uri:p.revive(e.uri),tags:(e.tags||[]).map(n=>{const{tagId:i}=M.denamespace(n);return new o.TestTag(i)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:u.to(e.range||void 0),canResolveChildren:!1,busy:e.busy,description:e.description||void 0,sortText:e.sortText||void 0}}t.toPlain=s})(Ee||={}),(t=>{function a(e){return{id:e.id}}t.from=a;function s(e){return new o.TestTag(e.id)}t.to=s})(M||={});var tn;(t=>{const a=(e,n)=>{const i=e.value;if(!i)return;const l={...Ee.toPlain(i.item),parent:n,taskStates:i.tasks.map(r=>({state:r.state,duration:r.duration,messages:r.messages.filter(d=>d.type===Te.Error).map(we.to)})),children:[]};if(e.children)for(const r of e.children.values()){const d=a(r,l);d&&l.children.push(d)}return l};function s(e){const n=new tt;for(const r of e.items)n.insert(U.fromString(r.item.extId).path,r);const i=[n.nodes],l=[];for(;i.length;)for(const r of i.pop())r.value?l.push(r):r.children&&i.push(r.children.values());return{completedAt:e.completedAt,results:l.map(r=>a(r)).filter(rt)}}t.to=s})(tn||={});var nn;(l=>{function a(r){return{covered:r.covered,total:r.total}}function s(r){return"line"in r?K.from(r):u.from(r)}function t(r){if(r)return"endLineNumber"in r?u.to(r):K.to(r)}function e(r){if(r.type===G.Statement){const d=[];if(r.branches)for(const m of r.branches)d.push({executed:m.count,location:t(m.location),label:m.label});return new o.StatementCoverage(r.count,t(r.location),r.branches?.map(m=>new o.BranchCoverage(m.count,t(m.location),m.label)))}else return new o.DeclarationCoverage(r.name,r.count,t(r.location))}l.to=e;function n(r){if(typeof r.executed=="number"&&r.executed<0)throw new Error(`Invalid coverage count ${r.executed}`);return"branches"in r?{count:r.executed,location:s(r.location),type:G.Statement,branches:r.branches.length?r.branches.map(d=>({count:d.executed,location:d.location&&s(d.location),label:d.label})):void 0}:{type:G.Declaration,name:r.name,count:r.executed,location:s(r.location)}}l.fromDetails=n;function i(r,d,m){return o.validateTestCoverageCount(m.statementCoverage),o.validateTestCoverageCount(m.branchCoverage),o.validateTestCoverageCount(m.declarationCoverage),{id:d,uri:m.uri,statement:a(m.statementCoverage),branch:m.branchCoverage&&a(m.branchCoverage),declaration:m.declarationCoverage&&a(m.declarationCoverage),testIds:m instanceof o.FileCoverage&&m.fromTests.length?m.fromTests.map(x=>U.fromExtHostTestItem(x,r).toString()):void 0}}l.fromFile=i})(nn||={});var on;(s=>{function a(t){switch(t){case c.CodeActionTriggerType.Invoke:return o.CodeActionTriggerKind.Invoke;case c.CodeActionTriggerType.Auto:return o.CodeActionTriggerKind.Automatic}}s.to=a})(on||={});var rn;(t=>{function a(e){const n=new o.TypeHierarchyItem(h.to(e.kind),e.name,e.detail||"",p.revive(e.uri),u.to(e.range),u.to(e.selectionRange));return n._sessionId=e._sessionId,n._itemId=e._itemId,n}t.to=a;function s(e,n,i){if(n=n??e._sessionId,i=i??e._itemId,n===void 0||i===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:i,kind:h.from(e.kind),name:e.name,detail:e.detail??"",uri:e.uri,range:u.from(e.range),selectionRange:u.from(e.selectionRange),tags:e.tags?.map(D.from)}}t.from=s})(rn||={});var an;(s=>{function a(t){if(t)return{value:t.value,tooltip:t.tooltip}}s.from=a})(an||={});var se;(n=>{function a(i,l,r){const d=l.fileData;return d?new o.InternalFileDataTransferItem(new o.DataTransferFile(d.name,p.revive(d.uri),d.id,qe(()=>r(d.id)))):i===Ie.uriList&&l.uriListData?new o.InternalDataTransferItem(e(l.uriListData)):new o.InternalDataTransferItem(l.asString)}n.to=a;async function s(i,l){const r=await l.asString();if(i===Ie.uriList)return{asString:r,fileData:void 0,uriListData:t(r)};const d=l.asFile();return{asString:r,fileData:d?{name:d.name,uri:d.uri,id:d._itemId??d.id}:void 0}}n.from=s;function t(i){return Ce.split(i).map(l=>{if(l.startsWith("#"))return l;try{return p.parse(l)}catch{}return l})}function e(i){return Ce.create(i.map(l=>typeof l=="string"?l:p.revive(l)))}})(se||={});var sn;(t=>{function a(e,n){const i=e.items.map(([l,r])=>[l,se.to(l,r,n)]);return new o.DataTransfer(i)}t.toDataTransfer=a;async function s(e){const n={items:[]},i=[];for(const[l,r]of e)i.push((async()=>{n.items.push([l,await se.from(l,r)])})());return await Promise.all(i),n}t.from=s})(sn||={});var Me;(t=>{function a(e,n){return{kind:"reply",agentId:e.participant??n?.agentId??"",subCommand:e.command??n?.command,message:e.prompt,title:e.label}}t.from=a;function s(e){return{prompt:e.message,label:e.title,participant:e.agentId,command:e.subCommand}}t.to=s})(Me||={});var ce;(t=>{function a(e){switch(e){case S.ChatMessageRole.System:return o.LanguageModelChatMessageRole.System;case S.ChatMessageRole.User:return o.LanguageModelChatMessageRole.User;case S.ChatMessageRole.Assistant:return o.LanguageModelChatMessageRole.Assistant}}t.to=a;function s(e){switch(e){case o.LanguageModelChatMessageRole.System:return S.ChatMessageRole.System;case o.LanguageModelChatMessageRole.User:return S.ChatMessageRole.User;case o.LanguageModelChatMessageRole.Assistant:return S.ChatMessageRole.Assistant}return S.ChatMessageRole.User}t.from=s})(ce||={});var cn;(t=>{function a(e){const n=e.content.map(d=>d.type==="text"?d.value:d.type==="tool_result"?new o.LanguageModelToolResultPart(d.toolCallId,d.value,d.isError):new o.LanguageModelToolCallPart(d.name,d.toolCallId,d.parameters)),i=n.find(d=>typeof d=="string")??"",l=ce.to(e.role),r=new o.LanguageModelChatMessage(l,i,e.name);return r.content2=n,r}t.to=a;function s(e){const n=ce.from(e.role),i=e.name,l=e.content2.map(r=>{if(r instanceof o.LanguageModelToolResultPart)return{type:"tool_result",toolCallId:r.toolCallId,value:r.content,isError:r.isError};if(r instanceof o.LanguageModelToolCallPart)return{type:"tool_use",toolCallId:r.toolCallId,name:r.name,parameters:r.parameters};if(typeof r!="string")throw new Error("Unexpected chat message content type");return{type:"text",value:r}});return{role:n,name:i,content:l}}t.from=s})(cn||={});var le;(t=>{function a(e){return{kind:"markdownContent",content:f.from(e.value)}}t.from=a;function s(e){return new o.ChatResponseMarkdownPart(f.to(e.content))}t.to=s})(le||={});var Le;(t=>{function a(e){return{kind:"codeblockUri",uri:e.value}}t.from=a;function s(e){return new o.ChatResponseCodeblockUriPart(p.revive(e.uri))}t.to=s})(Le||={});var Ne;(t=>{function a(e){return{kind:"markdownVuln",content:f.from(e.value),vulnerabilities:e.vulnerabilities}}t.from=a;function s(e){return new o.ChatResponseMarkdownWithVulnerabilitiesPart(f.to(e.content),e.vulnerabilities)}t.to=s})(Ne||={});var He;(t=>{function a(e){return{kind:"agentDetection",agentId:e.participant,command:e.command}}t.from=a;function s(e){return new o.ChatResponseDetectedParticipantPart(e.agentId,e.command)}t.to=s})(He||={});var Oe;(s=>{function a(t){return{kind:"confirmation",title:t.title,message:t.message,data:t.data,buttons:t.buttons}}s.from=a})(Oe||={});var de;(t=>{function a(e){const{value:n,baseUri:i}=e;function l(r,d){return r.map(m=>{const x=p.joinPath(d,m.name);return{label:m.name,uri:x,children:m.children&&l(m.children,x)}})}return{kind:"treeData",treeData:{label:nt(i),uri:i,children:l(n,i)}}}t.from=a;function s(e){const n=L(e.treeData);function i(d){return d.map(m=>({name:m.label,children:m.children&&i(m.children)}))}const l=n.uri,r=n.children?i(n.children):[];return new o.ChatResponseFileTreePart(r,l)}t.to=s})(de||={});var ue;(t=>{function a(e){const n=l=>p.isUri(l),i=l=>l instanceof o.SymbolInformation;return{kind:"inlineReference",name:e.title,inlineReference:n(e.value)?e.value:i(e.value)?q.from(e.value):P.from(e.value)}}t.from=a;function s(e){const n=L(e);return new o.ChatResponseAnchorPart(p.isUri(n.inlineReference)?n.inlineReference:"location"in n.inlineReference?q.to(n.inlineReference):P.to(n.inlineReference),e.name)}t.to=s})(ue||={});var Ae;(t=>{function a(e){return{kind:"progressMessage",content:f.from(e.value)}}t.from=a;function s(e){return new o.ChatResponseProgressPart(e.content.value)}t.to=s})(Ae||={});var Fe;(t=>{function a(e){return{kind:"warning",content:f.from(e.value)}}t.from=a;function s(e){return new o.ChatResponseWarningPart(e.content.value)}t.to=s})(Fe||={});var Ue;(t=>{function a(e){return{kind:"move",uri:e.uri,range:u.from(e.range)}}t.from=a;function s(e){return new o.ChatResponseMovePart(p.revive(e.uri),u.to(e.range))}t.to=s})(Ue||={});var ln;(s=>{function a(t){return{kind:"progressTask",content:f.from(t.value)}}s.from=a})(ln||={});var dn;(s=>{function a(t){return{kind:"progressTaskResult",content:typeof t=="string"?f.from(t):void 0}}s.from=a})(dn||={});var me;(t=>{function a(e,n,i){return{kind:"command",command:n.toInternal(e.value,i)??{command:e.value.command,title:e.value.title}}}t.from=a;function s(e,n){return new o.ChatResponseCommandButtonPart(n.fromInternal(e.command)??{command:e.command.id,title:e.command.title})}t.to=s})(me||={});var We;(t=>{function a(e){return{kind:"textEdit",uri:e.uri,edits:e.edits.map(n=>v.from(n))}}t.from=a;function s(e){return new o.ChatResponseTextEditPart(p.revive(e.uri),e.edits.map(n=>v.to(n)))}t.to=s})(We||={});var pe;(t=>{function a(e){const n=ot.isThemeIcon(e.iconPath)?e.iconPath:p.isUri(e.iconPath)?{light:p.revive(e.iconPath)}:e.iconPath&&"light"in e.iconPath&&"dark"in e.iconPath&&p.isUri(e.iconPath.light)&&p.isUri(e.iconPath.dark)?{light:p.revive(e.iconPath.light),dark:p.revive(e.iconPath.dark)}:void 0;return typeof e.value=="object"&&"variableName"in e.value?{kind:"reference",reference:{variableName:e.value.variableName,value:p.isUri(e.value.value)||!e.value.value?e.value.value:P.from(e.value.value)},iconPath:n,options:e.options}:{kind:"reference",reference:p.isUri(e.value)||typeof e.value=="string"?e.value:P.from(e.value),iconPath:n,options:e.options}}t.from=a;function s(e){const n=L(e),i=l=>p.isUri(l)?l:P.to(l);return new o.ChatResponseReferencePart(typeof n.reference=="string"?n.reference:"variableName"in n.reference?{variableName:n.reference.variableName,value:n.reference.value&&i(n.reference.value)}:i(n.reference))}t.to=s})(pe||={});var Ve;(s=>{function a(t){return{kind:"codeCitation",value:t.value,license:t.license,snippet:t.snippet}}s.from=a})(Ve||={});var un;(e=>{function a(n,i,l){return n instanceof o.ChatResponseMarkdownPart?le.from(n):n instanceof o.ChatResponseAnchorPart?ue.from(n):n instanceof o.ChatResponseReferencePart?pe.from(n):n instanceof o.ChatResponseProgressPart?Ae.from(n):n instanceof o.ChatResponseFileTreePart?de.from(n):n instanceof o.ChatResponseCommandButtonPart?me.from(n,i,l):n instanceof o.ChatResponseTextEditPart?We.from(n):n instanceof o.ChatResponseMarkdownWithVulnerabilitiesPart?Ne.from(n):n instanceof o.ChatResponseCodeblockUriPart?Le.from(n):n instanceof o.ChatResponseDetectedParticipantPart?He.from(n):n instanceof o.ChatResponseWarningPart?Fe.from(n):n instanceof o.ChatResponseConfirmationPart?Oe.from(n):n instanceof o.ChatResponseCodeCitationPart?Ve.from(n):n instanceof o.ChatResponseMovePart?Ue.from(n):{kind:"markdownContent",content:f.from("")}}e.from=a;function s(n,i){switch(n.kind){case"reference":return pe.to(n);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return t(n,i)}}e.to=s;function t(n,i){switch(n.kind){case"markdownContent":return le.to(n);case"inlineReference":return ue.to(n);case"progressMessage":return;case"treeData":return de.to(n);case"command":return me.to(n,i)}}e.toContent=t})(un||={});var mn;(s=>{function a(t,e){const n=t.variables.variables.filter(l=>l.isTool),i=t.variables.variables.filter(l=>!l.isTool);return{prompt:t.message,command:t.command,attempt:t.attempt??0,enableCommandDetection:t.enableCommandDetection??!0,isParticipantDetected:t.isParticipantDetected??!1,references:i.map(Be.to),toolReferences:n.map(Ge.to),location:_e.to(t.location),acceptedConfirmationData:t.acceptedConfirmationData,rejectedConfirmationData:t.rejectedConfirmationData,location2:e,toolInvocationToken:Object.freeze({sessionId:t.sessionId})}}s.to=a})(mn||={});var _e;(t=>{function a(e){switch(e){case R.Notebook:return o.ChatLocation.Notebook;case R.Terminal:return o.ChatLocation.Terminal;case R.Panel:return o.ChatLocation.Panel;case R.Editor:return o.ChatLocation.Editor}}t.to=a;function s(e){switch(e){case o.ChatLocation.Notebook:return R.Notebook;case o.ChatLocation.Terminal:return R.Terminal;case o.ChatLocation.Panel:return R.Panel;case o.ChatLocation.Editor:return R.Editor}}t.from=s})(_e||={});var Be;(s=>{function a(t){const e=t.value;if(!e)throw new Error("Invalid value reference");return{id:t.id,name:t.name,range:t.range&&[t.range.start,t.range.endExclusive],value:he(e)?p.revive(e):e&&typeof e=="object"&&"uri"in e&&"range"in e&&he(e.uri)?P.to(L(e)):e,modelDescription:t.modelDescription}}s.to=a})(Be||={});var Ge;(s=>{function a(t){if(t.value)throw new Error("Invalid tool reference");return{id:t.id,range:t.range&&[t.range.start,t.range.endExclusive]}}s.to=a})(Ge||={});var pn;(s=>{function a(t,e,n){return{id:t.id,label:t.label,fullName:t.fullName,icon:t.icon?.id,value:t.values[0].value,insertText:t.insertText,detail:t.detail,documentation:t.documentation,command:e.toInternal(t.command,n)}}s.from=a})(pn||={});var je;(s=>{function a(t){return{errorDetails:t.errorDetails,metadata:t.metadata,nextQuestion:t.nextQuestion}}s.to=a})(je||={});var fn;(s=>{function a(t,e,n){if(e.action.kind==="vote")return;const i=je.to(t);if(e.action.kind==="command"){const l=e.action.commandButton.command;return{action:{kind:"command",commandButton:{command:n.fromInternal(l)??{command:l.id,title:l.title}}},result:i}}else return e.action.kind==="followUp"?{action:{kind:"followUp",followup:Me.to(e.action.followup)},result:i}:e.action.kind==="inlineChat"?{action:{kind:"editor",accepted:e.action.action==="accepted"},result:i}:{action:e.action,result:i}}s.to=a})(fn||={});var gn;(s=>{function a(t,e,n){return"terminalCommand"in t?{terminalCommand:t.terminalCommand,shouldExecute:t.shouldExecute}:"uri"in t?{uri:t.uri}:e.toInternal(t,n)}s.from=a})(gn||={});var Cn;(s=>{function a(t){return{kind:ze.to(t.kind)}}s.to=a})(Cn||={});var ze;(s=>{function a(t){switch(t){case c.PartialAcceptTriggerKind.Word:return o.PartialAcceptTriggerKind.Word;case c.PartialAcceptTriggerKind.Line:return o.PartialAcceptTriggerKind.Line;case c.PartialAcceptTriggerKind.Suggest:return o.PartialAcceptTriggerKind.Suggest;default:return o.PartialAcceptTriggerKind.Unknown}}s.to=a})(ze||={});var xn;(s=>{function a(t,e){return{id:e,label:t.label,description:t.description,canEdit:t.canEdit,collapsibleState:t.collapsibleState||ct.None,contextValue:t.contextValue}}s.from=a})(xn||={});var In;(s=>{function a(t){return{id:t.id,modelDescription:t.modelDescription,parametersSchema:t.parametersSchema,displayName:t.displayName,supportedContentTypes:t.supportedContentTypes}}s.to=a})(In||={});export{Rt as CallHierarchyIncomingCall,X as CallHierarchyItem,St as CallHierarchyOutgoingCall,pn as ChatAgentCompletionItem,mn as ChatAgentRequest,je as ChatAgentResult,fn as ChatAgentUserActionEvent,Me as ChatFollowup,Ge as ChatLanguageModelToolReference,_e as ChatLocation,Be as ChatPromptReference,ue as ChatResponseAnchorPart,Ve as ChatResponseCodeCitationPart,Le as ChatResponseCodeblockUriPart,me as ChatResponseCommandButtonPart,Oe as ChatResponseConfirmationPart,He as ChatResponseDetectedParticipantPart,de as ChatResponseFilesPart,le as ChatResponseMarkdownPart,Ne as ChatResponseMarkdownWithVulnerabilitiesPart,Ue as ChatResponseMovePart,un as ChatResponsePart,Ae as ChatResponseProgressPart,pe as ChatResponseReferencePart,We as ChatResponseTextEditPart,Fe as ChatResponseWarningPart,ln as ChatTask,dn as ChatTaskResult,on as CodeActionTriggerKind,Ft as Color,At as ColorPresentation,Mt as CompletionContext,Lt as CompletionItem,De as CompletionItemKind,Pe as CompletionItemTag,Se as CompletionTriggerKind,sn as DataTransfer,se as DataTransferItem,xn as DebugTreeItem,Re as DecorationRangeBehavior,ht as DecorationRenderOptions,Pt as DefinitionLink,xt as Diagnostic,z as DiagnosticRelatedInformation,Q as DiagnosticSeverity,j as DiagnosticTag,W as DocumentContextItem,Y as DocumentHighlight,Ot as DocumentLink,Ct as DocumentSelector,Tt as DocumentSymbol,te as EndOfLine,kt as EvaluatableExpression,Bt as FoldingRange,ne as FoldingRangeKind,b as GlobPattern,Dt as Hover,Ht as InlayHint,Ke as InlayHintKind,ke as InlayHintLabelPart,Kt as InlineValue,wt as InlineValueContext,cn as LanguageModelChatMessage,ce as LanguageModelChatMessageRole,In as LanguageModelToolDescription,jt as LanguageSelector,P as Location,zt as MappedEditsContext,f as MarkdownString,Et as MultiDocumentHighlight,V as NotebookCellData,$t as NotebookCellExecutionState,oe as NotebookCellExecutionSummary,re as NotebookCellKind,ie as NotebookCellOutput,ae as NotebookCellOutputItem,Jt as NotebookData,Zt as NotebookDocumentContentOptions,qt as NotebookExclusiveDocumentPattern,Yt as NotebookKernelSourceAction,Qt as NotebookRange,en as NotebookRendererScript,Xt as NotebookStatusBarItem,Z as ParameterInformation,Cn as PartialAcceptInfo,ze as PartialAcceptTriggerKind,K as Position,_t as ProgressLocation,u as Range,ft as Selection,Ut as SelectionRange,Nt as SignatureHelp,ee as SignatureInformation,h as SymbolKind,D as SymbolTag,gn as TerminalQuickFix,nn as TestCoverage,Ee as TestItem,we as TestMessage,tn as TestResults,M as TestTag,Wt as TextDocumentSaveReason,v as TextEdit,Vt as TextEditorLineNumbersStyle,Gt as TextEditorOpenOptions,w as ThemableDecorationAttachmentRenderOptions,J as ThemableDecorationRenderOptions,gt as TokenType,rn as TypeHierarchyItem,an as ViewBadge,It as ViewColumn,bt as WorkspaceEdit,q as WorkspaceSymbol,ir as fromRangeOrRangeWithMessage,yt as isDecorationOptionsArr,E as location,$ as pathOrURIToURI};
