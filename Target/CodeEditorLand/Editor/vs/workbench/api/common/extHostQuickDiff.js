import{asPromise as p}from"../../../base/common/async.js";import{URI as a}from"../../../base/common/uri.js";import{MainContext as c}from"./extHost.protocol.js";import{DocumentSelector as m}from"./extHostTypeConverters.js";class n{constructor(r,o){this.uriTransformer=o;this.proxy=r.getProxy(c.MainThreadQuickDiff)}static handlePool=0;proxy;providers=new Map;$provideOriginalResource(r,o,i){const t=a.revive(o),e=this.providers.get(r);return e?p(()=>e.provideOriginalResource(t,i)).then(s=>s||null):Promise.resolve(null)}registerQuickDiffProvider(r,o,i,t){const e=n.handlePool++;return this.providers.set(e,o),this.proxy.$registerQuickDiffProvider(e,m.from(r,this.uriTransformer),i,t),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(e),this.providers.delete(e)}}}}export{n as ExtHostQuickDiff};
