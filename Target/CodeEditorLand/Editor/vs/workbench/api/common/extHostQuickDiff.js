import{asPromise as a}from"../../../../vs/base/common/async.js";import"../../../../vs/base/common/cancellation.js";import{URI as p}from"../../../../vs/base/common/uri.js";import"../../../../vs/base/common/uriIpc.js";import{MainContext as f}from"../../../../vs/workbench/api/common/extHost.protocol.js";import{DocumentSelector as m}from"../../../../vs/workbench/api/common/extHostTypeConverters.js";class n{constructor(e,i){this.uriTransformer=i;this.proxy=e.getProxy(f.MainThreadQuickDiff)}static handlePool=0;proxy;providers=new Map;$provideOriginalResource(e,i,o){const t=p.revive(i),r=this.providers.get(e);return r?a(()=>r.provideOriginalResource(t,o)).then(s=>s||null):Promise.resolve(null)}registerQuickDiffProvider(e,i,o,t){const r=n.handlePool++;return this.providers.set(r,i),this.proxy.$registerQuickDiffProvider(r,m.from(e,this.uriTransformer),o,t),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(r),this.providers.delete(r)}}}}export{n as ExtHostQuickDiff};
