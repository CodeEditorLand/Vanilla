var y=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var l=(t,e,n,o)=>{for(var s=o>1?void 0:o?u(e,n):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=(o?i(e,n,s):i(s))||s);return o&&s&&y(e,n,s),s},v=(t,e)=>(n,o)=>e(n,o,t);import{ILogService as h}from"../../../platform/log/common/log.js";import{checkProposedApiEnabled as I}from"../../services/extensions/common/extensions.js";import{MainContext as C}from"./extHost.protocol.js";function S(t){return t&&t.title}let m=class{constructor(e,n){this._logService=n;this._proxy=e.getProxy(C.MainThreadMessageService)}_proxy;showMessage(e,n,o,s,a){const i={source:{identifier:e.identifier,label:e.displayName||e.name}};let g;typeof s=="string"||S(s)?g=[s,...a]:(i.modal=s?.modal,i.useCustom=s?.useCustom,i.detail=s?.detail,g=a),i.useCustom&&I(e,"resolvers");const c=[];let f=!1;for(let r=0;r<g.length;r++){const d=g[r];if(typeof d=="string")c.push({title:d,handle:r,isCloseAffordance:!1});else if(typeof d=="object"){const{title:M,isCloseAffordance:p}=d;c.push({title:M,isCloseAffordance:!!p,handle:r}),p&&(f?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d):f=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}return this._proxy.$showMessage(n,o,i,c).then(r=>{if(typeof r=="number")return g[r]})}};m=l([v(1,h)],m);export{m as ExtHostMessageService};
