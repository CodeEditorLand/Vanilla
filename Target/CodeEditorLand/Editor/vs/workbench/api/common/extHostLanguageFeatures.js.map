{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/api/common/extHostLanguageFeatures.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from \"vscode\";\nimport {\n\tasArray,\n\tcoalesce,\n\tisFalsyOrEmpty,\n\tisNonEmptyArray,\n} from \"../../../base/common/arrays.js\";\nimport { raceCancellationError } from \"../../../base/common/async.js\";\nimport type { VSBuffer } from \"../../../base/common/buffer.js\";\nimport { CancellationToken } from \"../../../base/common/cancellation.js\";\nimport {\n\tNotImplementedError,\n\tisCancellationError,\n} from \"../../../base/common/errors.js\";\nimport { IdGenerator } from \"../../../base/common/idGenerator.js\";\nimport { DisposableStore } from \"../../../base/common/lifecycle.js\";\nimport { equals, mixin } from \"../../../base/common/objects.js\";\nimport { StopWatch } from \"../../../base/common/stopwatch.js\";\nimport { regExpLeadsToEndlessLoop } from \"../../../base/common/strings.js\";\nimport { assertType, isObject } from \"../../../base/common/types.js\";\nimport { URI, type UriComponents } from \"../../../base/common/uri.js\";\nimport type { IURITransformer } from \"../../../base/common/uriIpc.js\";\nimport type { ISingleEditOperation } from \"../../../editor/common/core/editOperation.js\";\nimport type { IPosition } from \"../../../editor/common/core/position.js\";\nimport {\n\tRange as EditorRange,\n\ttype IRange,\n} from \"../../../editor/common/core/range.js\";\nimport {\n\ttype ISelection,\n\tSelection,\n} from \"../../../editor/common/core/selection.js\";\nimport * as languages from \"../../../editor/common/languages.js\";\nimport type { IAutoClosingPairConditional } from \"../../../editor/common/languages/languageConfiguration.js\";\nimport { encodeSemanticTokensDto } from \"../../../editor/common/services/semanticTokensDto.js\";\nimport { localize } from \"../../../nls.js\";\nimport {\n\tExtensionIdentifier,\n\ttype IExtensionDescription,\n} from \"../../../platform/extensions/common/extensions.js\";\nimport type { ILogService } from \"../../../platform/log/common/log.js\";\nimport {\n\tcheckProposedApiEnabled,\n\tisProposedApiEnabled,\n} from \"../../services/extensions/common/extensions.js\";\nimport { Cache } from \"./cache.js\";\nimport * as extHostProtocol from \"./extHost.protocol.js\";\nimport type { IExtHostApiDeprecationService } from \"./extHostApiDeprecationService.js\";\nimport type { CommandsConverter, ExtHostCommands } from \"./extHostCommands.js\";\nimport type { ExtHostDiagnostics } from \"./extHostDiagnostics.js\";\nimport type { ExtHostDocuments } from \"./extHostDocuments.js\";\nimport type {\n\tExtHostTelemetry,\n\tIExtHostTelemetry,\n} from \"./extHostTelemetry.js\";\nimport * as typeConvert from \"./extHostTypeConverters.js\";\nimport {\n\tCodeActionKind,\n\tCompletionList,\n\tDisposable,\n\tDocumentDropOrPasteEditKind,\n\tDocumentSymbol,\n\tInlineCompletionTriggerKind,\n\tInlineEditTriggerKind,\n\tInternalDataTransferItem,\n\tLocation,\n\tNewSymbolNameTriggerKind,\n\tRange,\n\tSemanticTokens,\n\tSemanticTokensEdit,\n\tSemanticTokensEdits,\n\tSnippetString,\n\ttype SymbolInformation,\n\tSyntaxTokenType,\n} from \"./extHostTypes.js\";\n\n// --- adapter\n\nclass DocumentSymbolAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentSymbolProvider,\n\t) {}\n\n\tasync provideDocumentSymbols(\n\t\tresource: URI,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.DocumentSymbol[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst value = await this._provider.provideDocumentSymbols(doc, token);\n\t\tif (isFalsyOrEmpty(value)) {\n\t\t\treturn undefined;\n\t\t} else if (value![0] instanceof DocumentSymbol) {\n\t\t\treturn (<DocumentSymbol[]>value).map(\n\t\t\t\ttypeConvert.DocumentSymbol.from,\n\t\t\t);\n\t\t} else {\n\t\t\treturn DocumentSymbolAdapter._asDocumentSymbolTree(\n\t\t\t\t<SymbolInformation[]>value,\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate static _asDocumentSymbolTree(\n\t\tinfos: SymbolInformation[],\n\t): languages.DocumentSymbol[] {\n\t\t// first sort by start (and end) and then loop over all elements\n\t\t// and build a tree based on containment.\n\t\tinfos = infos.slice(0).sort((a, b) => {\n\t\t\tlet res = a.location.range.start.compareTo(b.location.range.start);\n\t\t\tif (res === 0) {\n\t\t\t\tres = b.location.range.end.compareTo(a.location.range.end);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\t\tconst res: languages.DocumentSymbol[] = [];\n\t\tconst parentStack: languages.DocumentSymbol[] = [];\n\t\tfor (const info of infos) {\n\t\t\tconst element: languages.DocumentSymbol = {\n\t\t\t\tname: info.name || \"!!MISSING: name!!\",\n\t\t\t\tkind: typeConvert.SymbolKind.from(info.kind),\n\t\t\t\ttags: info.tags?.map(typeConvert.SymbolTag.from) || [],\n\t\t\t\tdetail: \"\",\n\t\t\t\tcontainerName: info.containerName,\n\t\t\t\trange: typeConvert.Range.from(info.location.range),\n\t\t\t\tselectionRange: typeConvert.Range.from(info.location.range),\n\t\t\t\tchildren: [],\n\t\t\t};\n\n\t\t\twhile (true) {\n\t\t\t\tif (parentStack.length === 0) {\n\t\t\t\t\tparentStack.push(element);\n\t\t\t\t\tres.push(element);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconst parent = parentStack[parentStack.length - 1];\n\t\t\t\tif (\n\t\t\t\t\tEditorRange.containsRange(parent.range, element.range) &&\n\t\t\t\t\t!EditorRange.equalsRange(parent.range, element.range)\n\t\t\t\t) {\n\t\t\t\t\tparent.children?.push(element);\n\t\t\t\t\tparentStack.push(element);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tparentStack.pop();\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n}\n\nclass CodeLensAdapter {\n\tprivate readonly _cache = new Cache<vscode.CodeLens>(\"CodeLens\");\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.CodeLensProvider,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\tprivate readonly _extTelemetry: ExtHostTelemetry,\n\t\tprivate readonly _logService: ILogService,\n\t) {}\n\n\tasync provideCodeLenses(\n\t\tresource: URI,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICodeLensListDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\n\t\tconst lenses = await this._provider.provideCodeLenses(doc, token);\n\t\tif (!lenses || token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst cacheId = this._cache.add(lenses);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(cacheId, disposables);\n\t\tconst result: extHostProtocol.ICodeLensListDto = {\n\t\t\tcacheId,\n\t\t\tlenses: [],\n\t\t};\n\t\tfor (let i = 0; i < lenses.length; i++) {\n\t\t\tresult.lenses.push({\n\t\t\t\tcacheId: [cacheId, i],\n\t\t\t\trange: typeConvert.Range.from(lenses[i].range),\n\t\t\t\tcommand: this._commands.toInternal(\n\t\t\t\t\tlenses[i].command,\n\t\t\t\t\tdisposables,\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tasync resolveCodeLens(\n\t\tsymbol: extHostProtocol.ICodeLensDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICodeLensDto | undefined> {\n\t\tconst lens = symbol.cacheId && this._cache.get(...symbol.cacheId);\n\t\tif (!lens) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tlet resolvedLens: vscode.CodeLens | undefined | null;\n\t\tif (\n\t\t\ttypeof this._provider.resolveCodeLens !== \"function\" ||\n\t\t\tlens.isResolved\n\t\t) {\n\t\t\tresolvedLens = lens;\n\t\t} else {\n\t\t\tresolvedLens = await this._provider.resolveCodeLens(lens, token);\n\t\t}\n\t\tif (!resolvedLens) {\n\t\t\tresolvedLens = lens;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst disposables =\n\t\t\tsymbol.cacheId && this._disposables.get(symbol.cacheId[0]);\n\t\tif (!disposables) {\n\t\t\t// disposed in the meantime\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (!resolvedLens.command) {\n\t\t\tconst error = new Error(\n\t\t\t\t\"INVALID code lens resolved, lacks command: \" +\n\t\t\t\t\tthis._extension.identifier.value,\n\t\t\t);\n\t\t\tthis._extTelemetry.onExtensionError(\n\t\t\t\tthis._extension.identifier,\n\t\t\t\terror,\n\t\t\t);\n\t\t\tthis._logService.error(error);\n\t\t\treturn undefined;\n\t\t}\n\n\t\tsymbol.command = this._commands.toInternal(\n\t\t\tresolvedLens.command,\n\t\t\tdisposables,\n\t\t);\n\t\treturn symbol;\n\t}\n\n\treleaseCodeLenses(cachedId: number): void {\n\t\tthis._disposables.get(cachedId)?.dispose();\n\t\tthis._disposables.delete(cachedId);\n\t\tthis._cache.delete(cachedId);\n\t}\n}\n\nfunction convertToLocationLinks(\n\tvalue:\n\t\t| vscode.Location\n\t\t| vscode.Location[]\n\t\t| vscode.LocationLink[]\n\t\t| undefined\n\t\t| null,\n): languages.LocationLink[] {\n\tif (Array.isArray(value)) {\n\t\treturn (<any>value).map(typeConvert.DefinitionLink.from);\n\t} else if (value) {\n\t\treturn [typeConvert.DefinitionLink.from(value)];\n\t}\n\treturn [];\n}\n\nclass DefinitionAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DefinitionProvider,\n\t) {}\n\n\tasync provideDefinition(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideDefinition(doc, pos, token);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass DeclarationAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DeclarationProvider,\n\t) {}\n\n\tasync provideDeclaration(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideDeclaration(doc, pos, token);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass ImplementationAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.ImplementationProvider,\n\t) {}\n\n\tasync provideImplementation(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideImplementation(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass TypeDefinitionAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.TypeDefinitionProvider,\n\t) {}\n\n\tasync provideTypeDefinition(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideTypeDefinition(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass HoverAdapter {\n\tprivate _hoverCounter = 0;\n\tprivate _hoverMap: Map<number, vscode.Hover> = new Map<\n\t\tnumber,\n\t\tvscode.Hover\n\t>();\n\n\tprivate static HOVER_MAP_MAX_SIZE = 10;\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.HoverProvider,\n\t) {}\n\n\tasync provideHover(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tcontext: languages.HoverContext<{ id: number }> | undefined,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.HoverWithId | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tlet value: vscode.Hover | null | undefined;\n\t\tif (context && context.verbosityRequest) {\n\t\t\tconst previousHoverId = context.verbosityRequest.previousHover.id;\n\t\t\tconst previousHover = this._hoverMap.get(previousHoverId);\n\t\t\tif (!previousHover) {\n\t\t\t\tthrow new Error(`Hover with id ${previousHoverId} not found`);\n\t\t\t}\n\t\t\tconst hoverContext: vscode.HoverContext = {\n\t\t\t\tverbosityDelta: context.verbosityRequest.verbosityDelta,\n\t\t\t\tpreviousHover,\n\t\t\t};\n\t\t\tvalue = await this._provider.provideHover(\n\t\t\t\tdoc,\n\t\t\t\tpos,\n\t\t\t\ttoken,\n\t\t\t\thoverContext,\n\t\t\t);\n\t\t} else {\n\t\t\tvalue = await this._provider.provideHover(doc, pos, token);\n\t\t}\n\t\tif (!value || isFalsyOrEmpty(value.contents)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!value.range) {\n\t\t\tvalue.range = doc.getWordRangeAtPosition(pos);\n\t\t}\n\t\tif (!value.range) {\n\t\t\tvalue.range = new Range(pos, pos);\n\t\t}\n\t\tconst convertedHover: languages.Hover = typeConvert.Hover.from(value);\n\t\tconst id = this._hoverCounter;\n\t\t// Check if hover map has more than 10 elements and if yes, remove oldest from the map\n\t\tif (this._hoverMap.size === HoverAdapter.HOVER_MAP_MAX_SIZE) {\n\t\t\tconst minimumId = Math.min(...this._hoverMap.keys());\n\t\t\tthis._hoverMap.delete(minimumId);\n\t\t}\n\t\tthis._hoverMap.set(id, value);\n\t\tthis._hoverCounter += 1;\n\t\tconst hover: extHostProtocol.HoverWithId = {\n\t\t\t...convertedHover,\n\t\t\tid,\n\t\t};\n\t\treturn hover;\n\t}\n\n\treleaseHover(id: number): void {\n\t\tthis._hoverMap.delete(id);\n\t}\n}\n\nclass EvaluatableExpressionAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.EvaluatableExpressionProvider,\n\t) {}\n\n\tasync provideEvaluatableExpression(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.EvaluatableExpression | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideEvaluatableExpression(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t);\n\t\tif (value) {\n\t\t\treturn typeConvert.EvaluatableExpression.from(value);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass InlineValuesAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineValuesProvider,\n\t) {}\n\n\tasync provideInlineValues(\n\t\tresource: URI,\n\t\tviewPort: IRange,\n\t\tcontext: extHostProtocol.IInlineValueContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.InlineValue[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst value = await this._provider.provideInlineValues(\n\t\t\tdoc,\n\t\t\ttypeConvert.Range.to(viewPort),\n\t\t\ttypeConvert.InlineValueContext.to(context),\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map((iv) => typeConvert.InlineValue.from(iv));\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass DocumentHighlightAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentHighlightProvider,\n\t) {}\n\n\tasync provideDocumentHighlights(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.DocumentHighlight[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideDocumentHighlights(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.DocumentHighlight.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass MultiDocumentHighlightAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.MultiDocumentHighlightProvider,\n\t) {}\n\n\tasync provideMultiDocumentHighlights(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\totherResources: URI[],\n\t\ttoken: CancellationToken,\n\t): Promise<languages.MultiDocumentHighlight[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst otherDocuments = otherResources.map((r) =>\n\t\t\tthis._documents.getDocument(r),\n\t\t);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideMultiDocumentHighlights(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\totherDocuments,\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.MultiDocumentHighlight.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass LinkedEditingRangeAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.LinkedEditingRangeProvider,\n\t) {}\n\n\tasync provideLinkedEditingRanges(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LinkedEditingRanges | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideLinkedEditingRanges(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t);\n\t\tif (value && Array.isArray(value.ranges)) {\n\t\t\treturn {\n\t\t\t\tranges: coalesce(value.ranges.map(typeConvert.Range.from)),\n\t\t\t\twordPattern: value.wordPattern,\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass ReferenceAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.ReferenceProvider,\n\t) {}\n\n\tasync provideReferences(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tcontext: languages.ReferenceContext,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.Location[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideReferences(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\tcontext,\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.location.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport interface CustomCodeAction extends extHostProtocol.ICodeActionDto {\n\t_isSynthetic?: boolean;\n}\n\nclass CodeActionAdapter {\n\tprivate static readonly _maxCodeActionsPerFile: number = 1000;\n\n\tprivate readonly _cache = new Cache<vscode.CodeAction | vscode.Command>(\n\t\t\"CodeAction\",\n\t);\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _diagnostics: ExtHostDiagnostics,\n\t\tprivate readonly _provider: vscode.CodeActionProvider,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService,\n\t) {}\n\n\tasync provideCodeActions(\n\t\tresource: URI,\n\t\trangeOrSelection: IRange | ISelection,\n\t\tcontext: languages.CodeActionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICodeActionListDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst ran = Selection.isISelection(rangeOrSelection)\n\t\t\t? <vscode.Selection>typeConvert.Selection.to(rangeOrSelection)\n\t\t\t: <vscode.Range>typeConvert.Range.to(rangeOrSelection);\n\t\tconst allDiagnostics: vscode.Diagnostic[] = [];\n\n\t\tfor (const diagnostic of this._diagnostics.getDiagnostics(resource)) {\n\t\t\tif (ran.intersection(diagnostic.range)) {\n\t\t\t\tconst newLen = allDiagnostics.push(diagnostic);\n\t\t\t\tif (newLen > CodeActionAdapter._maxCodeActionsPerFile) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst codeActionContext: vscode.CodeActionContext = {\n\t\t\tdiagnostics: allDiagnostics,\n\t\t\tonly: context.only ? new CodeActionKind(context.only) : undefined,\n\t\t\ttriggerKind: typeConvert.CodeActionTriggerKind.to(context.trigger),\n\t\t};\n\n\t\tconst commandsOrActions = await this._provider.provideCodeActions(\n\t\t\tdoc,\n\t\t\tran,\n\t\t\tcodeActionContext,\n\t\t\ttoken,\n\t\t);\n\t\tif (\n\t\t\t!isNonEmptyArray(commandsOrActions) ||\n\t\t\ttoken.isCancellationRequested\n\t\t) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst cacheId = this._cache.add(commandsOrActions);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(cacheId, disposables);\n\t\tconst actions: CustomCodeAction[] = [];\n\t\tfor (let i = 0; i < commandsOrActions.length; i++) {\n\t\t\tconst candidate = commandsOrActions[i];\n\t\t\tif (!candidate) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (CodeActionAdapter._isCommand(candidate)) {\n\t\t\t\t// old school: synthetic code action\n\t\t\t\tthis._apiDeprecation.report(\n\t\t\t\t\t\"CodeActionProvider.provideCodeActions - return commands\",\n\t\t\t\t\tthis._extension,\n\t\t\t\t\t`Return 'CodeAction' instances instead.`,\n\t\t\t\t);\n\n\t\t\t\tactions.push({\n\t\t\t\t\t_isSynthetic: true,\n\t\t\t\t\ttitle: candidate.title,\n\t\t\t\t\tcommand: this._commands.toInternal(candidate, disposables),\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (codeActionContext.only) {\n\t\t\t\t\tif (!candidate.kind) {\n\t\t\t\t\t\tthis._logService.warn(\n\t\t\t\t\t\t\t`${this._extension.identifier.value} - Code actions of kind '${codeActionContext.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (\n\t\t\t\t\t\t!codeActionContext.only.contains(candidate.kind)\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis._logService.warn(\n\t\t\t\t\t\t\t`${this._extension.identifier.value} - Code actions of kind '${codeActionContext.only.value}' requested but returned code action is of kind '${candidate.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Ensures that this is either a Range[] or an empty array so we don't get Array<Range | undefined>\n\t\t\t\tconst range = candidate.ranges ?? [];\n\n\t\t\t\t// new school: convert code action\n\t\t\t\tactions.push({\n\t\t\t\t\tcacheId: [cacheId, i],\n\t\t\t\t\ttitle: candidate.title,\n\t\t\t\t\tcommand:\n\t\t\t\t\t\tcandidate.command &&\n\t\t\t\t\t\tthis._commands.toInternal(\n\t\t\t\t\t\t\tcandidate.command,\n\t\t\t\t\t\t\tdisposables,\n\t\t\t\t\t\t),\n\t\t\t\t\tdiagnostics:\n\t\t\t\t\t\tcandidate.diagnostics &&\n\t\t\t\t\t\tcandidate.diagnostics.map(typeConvert.Diagnostic.from),\n\t\t\t\t\tedit:\n\t\t\t\t\t\tcandidate.edit &&\n\t\t\t\t\t\ttypeConvert.WorkspaceEdit.from(\n\t\t\t\t\t\t\tcandidate.edit,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t),\n\t\t\t\t\tkind: candidate.kind && candidate.kind.value,\n\t\t\t\t\tisPreferred: candidate.isPreferred,\n\t\t\t\t\tisAI: isProposedApiEnabled(this._extension, \"codeActionAI\")\n\t\t\t\t\t\t? candidate.isAI\n\t\t\t\t\t\t: false,\n\t\t\t\t\tranges: isProposedApiEnabled(\n\t\t\t\t\t\tthis._extension,\n\t\t\t\t\t\t\"codeActionRanges\",\n\t\t\t\t\t)\n\t\t\t\t\t\t? coalesce(range.map(typeConvert.Range.from))\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tdisabled: candidate.disabled?.reason,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn { cacheId, actions };\n\t}\n\n\tasync resolveCodeAction(\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<{\n\t\tedit?: extHostProtocol.IWorkspaceEditDto;\n\t\tcommand?: extHostProtocol.ICommandDto;\n\t}> {\n\t\tconst [sessionId, itemId] = id;\n\t\tconst item = this._cache.get(sessionId, itemId);\n\t\tif (!item || CodeActionAdapter._isCommand(item)) {\n\t\t\treturn {}; // code actions only!\n\t\t}\n\t\tif (!this._provider.resolveCodeAction) {\n\t\t\treturn {}; // this should not happen...\n\t\t}\n\n\t\tconst resolvedItem =\n\t\t\t(await this._provider.resolveCodeAction(item, token)) ?? item;\n\n\t\tlet resolvedEdit: extHostProtocol.IWorkspaceEditDto | undefined;\n\t\tif (resolvedItem.edit) {\n\t\t\tresolvedEdit = typeConvert.WorkspaceEdit.from(\n\t\t\t\tresolvedItem.edit,\n\t\t\t\tundefined,\n\t\t\t);\n\t\t}\n\n\t\tlet resolvedCommand: extHostProtocol.ICommandDto | undefined;\n\t\tif (resolvedItem.command) {\n\t\t\tconst disposables = this._disposables.get(sessionId);\n\t\t\tif (disposables) {\n\t\t\t\tresolvedCommand = this._commands.toInternal(\n\t\t\t\t\tresolvedItem.command,\n\t\t\t\t\tdisposables,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn { edit: resolvedEdit, command: resolvedCommand };\n\t}\n\n\treleaseCodeActions(cachedId: number): void {\n\t\tthis._disposables.get(cachedId)?.dispose();\n\t\tthis._disposables.delete(cachedId);\n\t\tthis._cache.delete(cachedId);\n\t}\n\n\tprivate static _isCommand(thing: any): thing is vscode.Command {\n\t\treturn (\n\t\t\ttypeof (<vscode.Command>thing).command === \"string\" &&\n\t\t\ttypeof (<vscode.Command>thing).title === \"string\"\n\t\t);\n\t}\n}\n\nclass DocumentPasteEditProvider {\n\tprivate readonly _cache = new Cache<vscode.DocumentPasteEdit>(\n\t\t\"DocumentPasteEdit\",\n\t);\n\n\tconstructor(\n\t\tprivate readonly _proxy: extHostProtocol.MainThreadLanguageFeaturesShape,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentPasteEditProvider,\n\t\tprivate readonly _handle: number,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) {}\n\n\tasync prepareDocumentPaste(\n\t\tresource: URI,\n\t\tranges: IRange[],\n\t\tdataTransferDto: extHostProtocol.DataTransferDTO,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.DataTransferDTO | undefined> {\n\t\tif (!this._provider.prepareDocumentPaste) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst vscodeRanges = ranges.map((range) => typeConvert.Range.to(range));\n\n\t\tconst dataTransfer = typeConvert.DataTransfer.toDataTransfer(\n\t\t\tdataTransferDto,\n\t\t\t() => {\n\t\t\t\tthrow new NotImplementedError();\n\t\t\t},\n\t\t);\n\t\tawait this._provider.prepareDocumentPaste(\n\t\t\tdoc,\n\t\t\tvscodeRanges,\n\t\t\tdataTransfer,\n\t\t\ttoken,\n\t\t);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Only send back values that have been added to the data transfer\n\t\tconst entries = Array.from(dataTransfer).filter(\n\t\t\t([, value]) => !(value instanceof InternalDataTransferItem),\n\t\t);\n\t\treturn typeConvert.DataTransfer.from(entries);\n\t}\n\n\tasync providePasteEdits(\n\t\trequestId: number,\n\t\tresource: URI,\n\t\tranges: IRange[],\n\t\tdataTransferDto: extHostProtocol.DataTransferDTO,\n\t\tcontext: extHostProtocol.IDocumentPasteContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IPasteEditDto[]> {\n\t\tif (!this._provider.provideDocumentPasteEdits) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst vscodeRanges = ranges.map((range) => typeConvert.Range.to(range));\n\n\t\tconst dataTransfer = typeConvert.DataTransfer.toDataTransfer(\n\t\t\tdataTransferDto,\n\t\t\tasync (id) => {\n\t\t\t\treturn (\n\t\t\t\t\tawait this._proxy.$resolvePasteFileData(\n\t\t\t\t\t\tthis._handle,\n\t\t\t\t\t\trequestId,\n\t\t\t\t\t\tid,\n\t\t\t\t\t)\n\t\t\t\t).buffer;\n\t\t\t},\n\t\t);\n\n\t\tconst edits = await this._provider.provideDocumentPasteEdits(\n\t\t\tdoc,\n\t\t\tvscodeRanges,\n\t\t\tdataTransfer,\n\t\t\t{\n\t\t\t\tonly: context.only\n\t\t\t\t\t? new DocumentDropOrPasteEditKind(context.only)\n\t\t\t\t\t: undefined,\n\t\t\t\ttriggerKind: context.triggerKind,\n\t\t\t},\n\t\t\ttoken,\n\t\t);\n\t\tif (!edits || token.isCancellationRequested) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst cacheId = this._cache.add(edits);\n\n\t\treturn edits.map(\n\t\t\t(edit, i): extHostProtocol.IPasteEditDto => ({\n\t\t\t\t_cacheId: [cacheId, i],\n\t\t\t\ttitle:\n\t\t\t\t\tedit.title ??\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"defaultPasteLabel\",\n\t\t\t\t\t\t\"Paste using '{0}' extension\",\n\t\t\t\t\t\tthis._extension.displayName || this._extension.name,\n\t\t\t\t\t),\n\t\t\t\tkind: edit.kind,\n\t\t\t\tyieldTo: edit.yieldTo?.map((x) => x.value),\n\t\t\t\tinsertText:\n\t\t\t\t\ttypeof edit.insertText === \"string\"\n\t\t\t\t\t\t? edit.insertText\n\t\t\t\t\t\t: { snippet: edit.insertText.value },\n\t\t\t\tadditionalEdit: edit.additionalEdit\n\t\t\t\t\t? typeConvert.WorkspaceEdit.from(\n\t\t\t\t\t\t\tedit.additionalEdit,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined,\n\t\t\t}),\n\t\t);\n\t}\n\n\tasync resolvePasteEdit(\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<{ additionalEdit?: extHostProtocol.IWorkspaceEditDto }> {\n\t\tconst [sessionId, itemId] = id;\n\t\tconst item = this._cache.get(sessionId, itemId);\n\t\tif (!item || !this._provider.resolveDocumentPasteEdit) {\n\t\t\treturn {}; // this should not happen...\n\t\t}\n\n\t\tconst resolvedItem =\n\t\t\t(await this._provider.resolveDocumentPasteEdit(item, token)) ??\n\t\t\titem;\n\t\tconst additionalEdit = resolvedItem.additionalEdit\n\t\t\t? typeConvert.WorkspaceEdit.from(\n\t\t\t\t\tresolvedItem.additionalEdit,\n\t\t\t\t\tundefined,\n\t\t\t\t)\n\t\t\t: undefined;\n\t\treturn { additionalEdit };\n\t}\n\n\treleasePasteEdits(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass DocumentFormattingAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentFormattingEditProvider,\n\t) {}\n\n\tasync provideDocumentFormattingEdits(\n\t\tresource: URI,\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\tconst document = this._documents.getDocument(resource);\n\n\t\tconst value = await this._provider.provideDocumentFormattingEdits(\n\t\t\tdocument,\n\t\t\t<any>options,\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass RangeFormattingAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentRangeFormattingEditProvider,\n\t) {}\n\n\tasync provideDocumentRangeFormattingEdits(\n\t\tresource: URI,\n\t\trange: IRange,\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst ran = typeConvert.Range.to(range);\n\n\t\tconst value = await this._provider.provideDocumentRangeFormattingEdits(\n\t\t\tdocument,\n\t\t\tran,\n\t\t\t<any>options,\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tasync provideDocumentRangesFormattingEdits(\n\t\tresource: URI,\n\t\tranges: IRange[],\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\tassertType(\n\t\t\ttypeof this._provider.provideDocumentRangesFormattingEdits ===\n\t\t\t\t\"function\",\n\t\t\t\"INVALID invocation of `provideDocumentRangesFormattingEdits`\",\n\t\t);\n\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst _ranges = <Range[]>ranges.map(typeConvert.Range.to);\n\t\tconst value = await this._provider.provideDocumentRangesFormattingEdits(\n\t\t\tdocument,\n\t\t\t_ranges,\n\t\t\t<any>options,\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass OnTypeFormattingAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.OnTypeFormattingEditProvider,\n\t) {}\n\n\tautoFormatTriggerCharacters: string[] = []; // not here\n\n\tasync provideOnTypeFormattingEdits(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tch: string,\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideOnTypeFormattingEdits(\n\t\t\tdocument,\n\t\t\tpos,\n\t\t\tch,\n\t\t\t<any>options,\n\t\t\ttoken,\n\t\t);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass NavigateTypeAdapter {\n\tprivate readonly _cache = new Cache<vscode.SymbolInformation>(\n\t\t\"WorkspaceSymbols\",\n\t);\n\n\tconstructor(\n\t\tprivate readonly _provider: vscode.WorkspaceSymbolProvider,\n\t\tprivate readonly _logService: ILogService,\n\t) {}\n\n\tasync provideWorkspaceSymbols(\n\t\tsearch: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IWorkspaceSymbolsDto> {\n\t\tconst value = await this._provider.provideWorkspaceSymbols(\n\t\t\tsearch,\n\t\t\ttoken,\n\t\t);\n\n\t\tif (!isNonEmptyArray(value)) {\n\t\t\treturn { symbols: [] };\n\t\t}\n\n\t\tconst sid = this._cache.add(value);\n\t\tconst result: extHostProtocol.IWorkspaceSymbolsDto = {\n\t\t\tcacheId: sid,\n\t\t\tsymbols: [],\n\t\t};\n\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst item = value[i];\n\t\t\tif (!item || !item.name) {\n\t\t\t\tthis._logService.warn(\"INVALID SymbolInformation\", item);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult.symbols.push({\n\t\t\t\t...typeConvert.WorkspaceSymbol.from(item),\n\t\t\t\tcacheId: [sid, i],\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tasync resolveWorkspaceSymbol(\n\t\tsymbol: extHostProtocol.IWorkspaceSymbolDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IWorkspaceSymbolDto | undefined> {\n\t\tif (typeof this._provider.resolveWorkspaceSymbol !== \"function\") {\n\t\t\treturn symbol;\n\t\t}\n\t\tif (!symbol.cacheId) {\n\t\t\treturn symbol;\n\t\t}\n\t\tconst item = this._cache.get(...symbol.cacheId);\n\t\tif (item) {\n\t\t\tconst value = await this._provider.resolveWorkspaceSymbol(\n\t\t\t\titem,\n\t\t\t\ttoken,\n\t\t\t);\n\t\t\treturn (\n\t\t\t\tvalue &&\n\t\t\t\tmixin(symbol, typeConvert.WorkspaceSymbol.from(value), true)\n\t\t\t);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\treleaseWorkspaceSymbols(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass RenameAdapter {\n\tstatic supportsResolving(provider: vscode.RenameProvider): boolean {\n\t\treturn typeof provider.prepareRename === \"function\";\n\t}\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.RenameProvider,\n\t\tprivate readonly _logService: ILogService,\n\t) {}\n\n\tasync provideRenameEdits(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tnewName: string,\n\t\ttoken: CancellationToken,\n\t): Promise<\n\t\t(extHostProtocol.IWorkspaceEditDto & languages.Rejection) | undefined\n\t> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\ttry {\n\t\t\tconst value = await this._provider.provideRenameEdits(\n\t\t\t\tdoc,\n\t\t\t\tpos,\n\t\t\t\tnewName,\n\t\t\t\ttoken,\n\t\t\t);\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn typeConvert.WorkspaceEdit.from(value);\n\t\t} catch (err) {\n\t\t\tconst rejectReason = RenameAdapter._asMessage(err);\n\t\t\tif (rejectReason) {\n\t\t\t\treturn { rejectReason, edits: undefined! };\n\t\t\t} else {\n\t\t\t\t// generic error\n\t\t\t\treturn Promise.reject<extHostProtocol.IWorkspaceEditDto>(err);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync resolveRenameLocation(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<(languages.RenameLocation & languages.Rejection) | undefined> {\n\t\tif (typeof this._provider.prepareRename !== \"function\") {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\ttry {\n\t\t\tconst rangeOrLocation = await this._provider.prepareRename(\n\t\t\t\tdoc,\n\t\t\t\tpos,\n\t\t\t\ttoken,\n\t\t\t);\n\n\t\t\tlet range: vscode.Range | undefined;\n\t\t\tlet text: string | undefined;\n\t\t\tif (Range.isRange(rangeOrLocation)) {\n\t\t\t\trange = rangeOrLocation;\n\t\t\t\ttext = doc.getText(rangeOrLocation);\n\t\t\t} else if (isObject(rangeOrLocation)) {\n\t\t\t\trange = rangeOrLocation.range;\n\t\t\t\ttext = rangeOrLocation.placeholder;\n\t\t\t}\n\n\t\t\tif (!range || !text) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (range.start.line > pos.line || range.end.line < pos.line) {\n\t\t\t\tthis._logService.warn(\n\t\t\t\t\t\"INVALID rename location: position line must be within range start/end lines\",\n\t\t\t\t);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn { range: typeConvert.Range.from(range), text };\n\t\t} catch (err) {\n\t\t\tconst rejectReason = RenameAdapter._asMessage(err);\n\t\t\tif (rejectReason) {\n\t\t\t\treturn { rejectReason, range: undefined!, text: undefined! };\n\t\t\t} else {\n\t\t\t\treturn Promise.reject<any>(err);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static _asMessage(err: any): string | undefined {\n\t\tif (typeof err === \"string\") {\n\t\t\treturn err;\n\t\t} else if (err instanceof Error && typeof err.message === \"string\") {\n\t\t\treturn err.message;\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nclass NewSymbolNamesAdapter {\n\tprivate static languageTriggerKindToVSCodeTriggerKind: Record<\n\t\tlanguages.NewSymbolNameTriggerKind,\n\t\tvscode.NewSymbolNameTriggerKind\n\t> = {\n\t\t[languages.NewSymbolNameTriggerKind.Invoke]:\n\t\t\tNewSymbolNameTriggerKind.Invoke,\n\t\t[languages.NewSymbolNameTriggerKind.Automatic]:\n\t\t\tNewSymbolNameTriggerKind.Automatic,\n\t};\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.NewSymbolNamesProvider,\n\t\tprivate readonly _logService: ILogService,\n\t) {}\n\n\tasync supportsAutomaticNewSymbolNamesTriggerKind() {\n\t\treturn this._provider.supportsAutomaticTriggerKind;\n\t}\n\n\tasync provideNewSymbolNames(\n\t\tresource: URI,\n\t\trange: IRange,\n\t\ttriggerKind: languages.NewSymbolNameTriggerKind,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.NewSymbolName[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Range.to(range);\n\n\t\ttry {\n\t\t\tconst kind =\n\t\t\t\tNewSymbolNamesAdapter.languageTriggerKindToVSCodeTriggerKind[\n\t\t\t\t\ttriggerKind\n\t\t\t\t];\n\t\t\tconst value = await this._provider.provideNewSymbolNames(\n\t\t\t\tdoc,\n\t\t\t\tpos,\n\t\t\t\tkind,\n\t\t\t\ttoken,\n\t\t\t);\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn value.map((v) =>\n\t\t\t\ttypeof v ===\n\t\t\t\t\"string\" /* @ulugbekna: for backward compatibility because `value` used to be just `string[]` */\n\t\t\t\t\t? { newSymbolName: v }\n\t\t\t\t\t: { newSymbolName: v.newSymbolName, tags: v.tags },\n\t\t\t);\n\t\t} catch (err: unknown) {\n\t\t\tthis._logService.error(\n\t\t\t\tNewSymbolNamesAdapter._asMessage(err) ??\n\t\t\t\t\tJSON.stringify(\n\t\t\t\t\t\terr,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\"\\t\",\n\t\t\t\t\t) /* @ulugbekna: assuming `err` doesn't have circular references that could result in an exception when converting to JSON */,\n\t\t\t);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t// @ulugbekna: this method is also defined in RenameAdapter but seems OK to be duplicated\n\tprivate static _asMessage(err: any): string | undefined {\n\t\tif (typeof err === \"string\") {\n\t\t\treturn err;\n\t\t} else if (err instanceof Error && typeof err.message === \"string\") {\n\t\t\treturn err.message;\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nclass SemanticTokensPreviousResult {\n\tconstructor(\n\t\treadonly resultId: string | undefined,\n\t\treadonly tokens?: Uint32Array,\n\t) {}\n}\n\ntype RelaxedSemanticTokens = {\n\treadonly resultId?: string;\n\treadonly data: number[];\n};\ntype RelaxedSemanticTokensEdit = {\n\treadonly start: number;\n\treadonly deleteCount: number;\n\treadonly data?: number[];\n};\ntype RelaxedSemanticTokensEdits = {\n\treadonly resultId?: string;\n\treadonly edits: RelaxedSemanticTokensEdit[];\n};\n\ntype ProvidedSemanticTokens = vscode.SemanticTokens | RelaxedSemanticTokens;\ntype ProvidedSemanticTokensEdits =\n\t| vscode.SemanticTokensEdits\n\t| RelaxedSemanticTokensEdits;\n\nclass DocumentSemanticTokensAdapter {\n\tprivate readonly _previousResults: Map<\n\t\tnumber,\n\t\tSemanticTokensPreviousResult\n\t>;\n\tprivate _nextResultId = 1;\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentSemanticTokensProvider,\n\t) {\n\t\tthis._previousResults = new Map<number, SemanticTokensPreviousResult>();\n\t}\n\n\tasync provideDocumentSemanticTokens(\n\t\tresource: URI,\n\t\tpreviousResultId: number,\n\t\ttoken: CancellationToken,\n\t): Promise<VSBuffer | null> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst previousResult =\n\t\t\tpreviousResultId !== 0\n\t\t\t\t? this._previousResults.get(previousResultId)\n\t\t\t\t: null;\n\t\tlet value =\n\t\t\ttypeof previousResult?.resultId === \"string\" &&\n\t\t\ttypeof this._provider.provideDocumentSemanticTokensEdits ===\n\t\t\t\t\"function\"\n\t\t\t\t? await this._provider.provideDocumentSemanticTokensEdits(\n\t\t\t\t\t\tdoc,\n\t\t\t\t\t\tpreviousResult.resultId,\n\t\t\t\t\t\ttoken,\n\t\t\t\t\t)\n\t\t\t\t: await this._provider.provideDocumentSemanticTokens(\n\t\t\t\t\t\tdoc,\n\t\t\t\t\t\ttoken,\n\t\t\t\t\t);\n\n\t\tif (previousResult) {\n\t\t\tthis._previousResults.delete(previousResultId);\n\t\t}\n\t\tif (!value) {\n\t\t\treturn null;\n\t\t}\n\t\tvalue = DocumentSemanticTokensAdapter._fixProvidedSemanticTokens(value);\n\t\treturn this._send(\n\t\t\tDocumentSemanticTokensAdapter._convertToEdits(\n\t\t\t\tpreviousResult,\n\t\t\t\tvalue,\n\t\t\t),\n\t\t\tvalue,\n\t\t);\n\t}\n\n\tasync releaseDocumentSemanticColoring(\n\t\tsemanticColoringResultId: number,\n\t): Promise<void> {\n\t\tthis._previousResults.delete(semanticColoringResultId);\n\t}\n\n\tprivate static _fixProvidedSemanticTokens(\n\t\tv: ProvidedSemanticTokens | ProvidedSemanticTokensEdits,\n\t): vscode.SemanticTokens | vscode.SemanticTokensEdits {\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(v)) {\n\t\t\tif (DocumentSemanticTokensAdapter._isCorrectSemanticTokens(v)) {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn new SemanticTokens(new Uint32Array(v.data), v.resultId);\n\t\t} else if (DocumentSemanticTokensAdapter._isSemanticTokensEdits(v)) {\n\t\t\tif (\n\t\t\t\tDocumentSemanticTokensAdapter._isCorrectSemanticTokensEdits(v)\n\t\t\t) {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn new SemanticTokensEdits(\n\t\t\t\tv.edits.map(\n\t\t\t\t\t(edit) =>\n\t\t\t\t\t\tnew SemanticTokensEdit(\n\t\t\t\t\t\t\tedit.start,\n\t\t\t\t\t\t\tedit.deleteCount,\n\t\t\t\t\t\t\tedit.data ? new Uint32Array(edit.data) : edit.data,\n\t\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t\tv.resultId,\n\t\t\t);\n\t\t}\n\t\treturn v;\n\t}\n\n\tprivate static _isSemanticTokens(\n\t\tv: ProvidedSemanticTokens | ProvidedSemanticTokensEdits,\n\t): v is ProvidedSemanticTokens {\n\t\treturn v && !!(v as ProvidedSemanticTokens).data;\n\t}\n\n\tprivate static _isCorrectSemanticTokens(\n\t\tv: ProvidedSemanticTokens,\n\t): v is vscode.SemanticTokens {\n\t\treturn v.data instanceof Uint32Array;\n\t}\n\n\tprivate static _isSemanticTokensEdits(\n\t\tv: ProvidedSemanticTokens | ProvidedSemanticTokensEdits,\n\t): v is ProvidedSemanticTokensEdits {\n\t\treturn v && Array.isArray((v as ProvidedSemanticTokensEdits).edits);\n\t}\n\n\tprivate static _isCorrectSemanticTokensEdits(\n\t\tv: ProvidedSemanticTokensEdits,\n\t): v is vscode.SemanticTokensEdits {\n\t\tfor (const edit of v.edits) {\n\t\t\tif (!(edit.data instanceof Uint32Array)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate static _convertToEdits(\n\t\tpreviousResult: SemanticTokensPreviousResult | null | undefined,\n\t\tnewResult: vscode.SemanticTokens | vscode.SemanticTokensEdits,\n\t): vscode.SemanticTokens | vscode.SemanticTokensEdits {\n\t\tif (!DocumentSemanticTokensAdapter._isSemanticTokens(newResult)) {\n\t\t\treturn newResult;\n\t\t}\n\t\tif (!previousResult || !previousResult.tokens) {\n\t\t\treturn newResult;\n\t\t}\n\t\tconst oldData = previousResult.tokens;\n\t\tconst oldLength = oldData.length;\n\t\tconst newData = newResult.data;\n\t\tconst newLength = newData.length;\n\n\t\tlet commonPrefixLength = 0;\n\t\tconst maxCommonPrefixLength = Math.min(oldLength, newLength);\n\t\twhile (\n\t\t\tcommonPrefixLength < maxCommonPrefixLength &&\n\t\t\toldData[commonPrefixLength] === newData[commonPrefixLength]\n\t\t) {\n\t\t\tcommonPrefixLength++;\n\t\t}\n\n\t\tif (\n\t\t\tcommonPrefixLength === oldLength &&\n\t\t\tcommonPrefixLength === newLength\n\t\t) {\n\t\t\t// complete overlap!\n\t\t\treturn new SemanticTokensEdits([], newResult.resultId);\n\t\t}\n\n\t\tlet commonSuffixLength = 0;\n\t\tconst maxCommonSuffixLength =\n\t\t\tmaxCommonPrefixLength - commonPrefixLength;\n\t\twhile (\n\t\t\tcommonSuffixLength < maxCommonSuffixLength &&\n\t\t\toldData[oldLength - commonSuffixLength - 1] ===\n\t\t\t\tnewData[newLength - commonSuffixLength - 1]\n\t\t) {\n\t\t\tcommonSuffixLength++;\n\t\t}\n\n\t\treturn new SemanticTokensEdits(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tstart: commonPrefixLength,\n\t\t\t\t\tdeleteCount:\n\t\t\t\t\t\toldLength - commonPrefixLength - commonSuffixLength,\n\t\t\t\t\tdata: newData.subarray(\n\t\t\t\t\t\tcommonPrefixLength,\n\t\t\t\t\t\tnewLength - commonSuffixLength,\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t],\n\t\t\tnewResult.resultId,\n\t\t);\n\t}\n\n\tprivate _send(\n\t\tvalue: vscode.SemanticTokens | vscode.SemanticTokensEdits,\n\t\toriginal: vscode.SemanticTokens | vscode.SemanticTokensEdits,\n\t): VSBuffer | null {\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(value)) {\n\t\t\tconst myId = this._nextResultId++;\n\t\t\tthis._previousResults.set(\n\t\t\t\tmyId,\n\t\t\t\tnew SemanticTokensPreviousResult(value.resultId, value.data),\n\t\t\t);\n\t\t\treturn encodeSemanticTokensDto({\n\t\t\t\tid: myId,\n\t\t\t\ttype: \"full\",\n\t\t\t\tdata: value.data,\n\t\t\t});\n\t\t}\n\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokensEdits(value)) {\n\t\t\tconst myId = this._nextResultId++;\n\t\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(original)) {\n\t\t\t\t// store the original\n\t\t\t\tthis._previousResults.set(\n\t\t\t\t\tmyId,\n\t\t\t\t\tnew SemanticTokensPreviousResult(\n\t\t\t\t\t\toriginal.resultId,\n\t\t\t\t\t\toriginal.data,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis._previousResults.set(\n\t\t\t\t\tmyId,\n\t\t\t\t\tnew SemanticTokensPreviousResult(value.resultId),\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn encodeSemanticTokensDto({\n\t\t\t\tid: myId,\n\t\t\t\ttype: \"delta\",\n\t\t\t\tdeltas: (value.edits || []).map((edit) => ({\n\t\t\t\t\tstart: edit.start,\n\t\t\t\t\tdeleteCount: edit.deleteCount,\n\t\t\t\t\tdata: edit.data,\n\t\t\t\t})),\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nclass DocumentRangeSemanticTokensAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentRangeSemanticTokensProvider,\n\t) {}\n\n\tasync provideDocumentRangeSemanticTokens(\n\t\tresource: URI,\n\t\trange: IRange,\n\t\ttoken: CancellationToken,\n\t): Promise<VSBuffer | null> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst value = await this._provider.provideDocumentRangeSemanticTokens(\n\t\t\tdoc,\n\t\t\ttypeConvert.Range.to(range),\n\t\t\ttoken,\n\t\t);\n\t\tif (!value) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._send(value);\n\t}\n\n\tprivate _send(value: vscode.SemanticTokens): VSBuffer {\n\t\treturn encodeSemanticTokensDto({\n\t\t\tid: 0,\n\t\t\ttype: \"full\",\n\t\t\tdata: value.data,\n\t\t});\n\t}\n}\n\nclass CompletionsAdapter {\n\tstatic supportsResolving(provider: vscode.CompletionItemProvider): boolean {\n\t\treturn typeof provider.resolveCompletionItem === \"function\";\n\t}\n\n\tprivate _cache = new Cache<vscode.CompletionItem>(\"CompletionItem\");\n\tprivate _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.CompletionItemProvider,\n\t\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) {}\n\n\tasync provideCompletionItems(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tcontext: languages.CompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ISuggestResultDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\t// The default insert/replace ranges. It's important to compute them\n\t\t// before asynchronously asking the provider for its results. See\n\t\t// https://github.com/microsoft/vscode/issues/83400#issuecomment-546851421\n\t\tconst replaceRange =\n\t\t\tdoc.getWordRangeAtPosition(pos) || new Range(pos, pos);\n\t\tconst insertRange = replaceRange.with({ end: pos });\n\n\t\tconst sw = new StopWatch();\n\t\tconst itemsOrList = await this._provider.provideCompletionItems(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t\ttypeConvert.CompletionContext.to(context),\n\t\t);\n\n\t\tif (!itemsOrList) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst list = Array.isArray(itemsOrList)\n\t\t\t? new CompletionList(itemsOrList)\n\t\t\t: itemsOrList;\n\n\t\t// keep result for providers that support resolving\n\t\tconst pid: number = CompletionsAdapter.supportsResolving(this._provider)\n\t\t\t? this._cache.add(list.items)\n\t\t\t: this._cache.add([]);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(pid, disposables);\n\n\t\tconst completions: extHostProtocol.ISuggestDataDto[] = [];\n\t\tconst result: extHostProtocol.ISuggestResultDto = {\n\t\t\tx: pid,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.completions]: completions,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.defaultRanges]: {\n\t\t\t\treplace: typeConvert.Range.from(replaceRange),\n\t\t\t\tinsert: typeConvert.Range.from(insertRange),\n\t\t\t},\n\t\t\t[extHostProtocol.ISuggestResultDtoField.isIncomplete]:\n\t\t\t\tlist.isIncomplete || undefined,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.duration]: sw.elapsed(),\n\t\t};\n\n\t\tfor (let i = 0; i < list.items.length; i++) {\n\t\t\tconst item = list.items[i];\n\t\t\t// check for bad completion item first\n\t\t\tconst dto = this._convertCompletionItem(\n\t\t\t\titem,\n\t\t\t\t[pid, i],\n\t\t\t\tinsertRange,\n\t\t\t\treplaceRange,\n\t\t\t);\n\t\t\tcompletions.push(dto);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tasync resolveCompletionItem(\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ISuggestDataDto | undefined> {\n\t\tif (typeof this._provider.resolveCompletionItem !== \"function\") {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst dto1 = this._convertCompletionItem(item, id);\n\n\t\tconst resolvedItem = await this._provider.resolveCompletionItem(\n\t\t\titem,\n\t\t\ttoken,\n\t\t);\n\n\t\tif (!resolvedItem) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst dto2 = this._convertCompletionItem(resolvedItem, id);\n\n\t\tif (\n\t\t\tdto1[extHostProtocol.ISuggestDataDtoField.insertText] !==\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.insertText] ||\n\t\t\tdto1[extHostProtocol.ISuggestDataDtoField.insertTextRules] !==\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.insertTextRules]\n\t\t) {\n\t\t\tthis._apiDeprecation.report(\n\t\t\t\t\"CompletionItem.insertText\",\n\t\t\t\tthis._extension,\n\t\t\t\t\"extension MAY NOT change 'insertText' of a CompletionItem during resolve\",\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tdto1[extHostProtocol.ISuggestDataDtoField.commandIdent] !==\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.commandIdent] ||\n\t\t\tdto1[extHostProtocol.ISuggestDataDtoField.commandId] !==\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.commandId] ||\n\t\t\t!equals(\n\t\t\t\tdto1[extHostProtocol.ISuggestDataDtoField.commandArguments],\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.commandArguments],\n\t\t\t)\n\t\t) {\n\t\t\tthis._apiDeprecation.report(\n\t\t\t\t\"CompletionItem.command\",\n\t\t\t\tthis._extension,\n\t\t\t\t\"extension MAY NOT change 'command' of a CompletionItem during resolve\",\n\t\t\t);\n\t\t}\n\n\t\treturn {\n\t\t\t...dto1,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.documentation]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.documentation],\n\t\t\t[extHostProtocol.ISuggestDataDtoField.detail]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.detail],\n\t\t\t[extHostProtocol.ISuggestDataDtoField.additionalTextEdits]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.additionalTextEdits],\n\n\t\t\t// (fishy) async insertText\n\t\t\t[extHostProtocol.ISuggestDataDtoField.insertText]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.insertText],\n\t\t\t[extHostProtocol.ISuggestDataDtoField.insertTextRules]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.insertTextRules],\n\n\t\t\t// (fishy) async command\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commandIdent]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.commandIdent],\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commandId]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.commandId],\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commandArguments]:\n\t\t\t\tdto2[extHostProtocol.ISuggestDataDtoField.commandArguments],\n\t\t};\n\t}\n\n\treleaseCompletionItems(id: number): any {\n\t\tthis._disposables.get(id)?.dispose();\n\t\tthis._disposables.delete(id);\n\t\tthis._cache.delete(id);\n\t}\n\n\tprivate _convertCompletionItem(\n\t\titem: vscode.CompletionItem,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\tdefaultInsertRange?: vscode.Range,\n\t\tdefaultReplaceRange?: vscode.Range,\n\t): extHostProtocol.ISuggestDataDto {\n\t\tconst disposables = this._disposables.get(id[0]);\n\t\tif (!disposables) {\n\t\t\tthrow Error(\"DisposableStore is missing...\");\n\t\t}\n\n\t\tconst command = this._commands.toInternal(item.command, disposables);\n\t\tconst result: extHostProtocol.ISuggestDataDto = {\n\t\t\t//\n\t\t\tx: id,\n\t\t\t//\n\t\t\t[extHostProtocol.ISuggestDataDtoField.label]: item.label,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.kind]:\n\t\t\t\titem.kind !== undefined\n\t\t\t\t\t? typeConvert.CompletionItemKind.from(item.kind)\n\t\t\t\t\t: undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.kindModifier]:\n\t\t\t\titem.tags && item.tags.map(typeConvert.CompletionItemTag.from),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.detail]: item.detail,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.documentation]:\n\t\t\t\ttypeof item.documentation === \"undefined\"\n\t\t\t\t\t? undefined\n\t\t\t\t\t: typeConvert.MarkdownString.fromStrict(item.documentation),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.sortText]:\n\t\t\t\titem.sortText !== item.label ? item.sortText : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.filterText]:\n\t\t\t\titem.filterText !== item.label ? item.filterText : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.preselect]:\n\t\t\t\titem.preselect || undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.insertTextRules]:\n\t\t\t\titem.keepWhitespace\n\t\t\t\t\t? languages.CompletionItemInsertTextRule.KeepWhitespace\n\t\t\t\t\t: languages.CompletionItemInsertTextRule.None,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commitCharacters]:\n\t\t\t\titem.commitCharacters?.join(\"\"),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.additionalTextEdits]:\n\t\t\t\titem.additionalTextEdits &&\n\t\t\t\titem.additionalTextEdits.map(typeConvert.TextEdit.from),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commandIdent]:\n\t\t\t\tcommand?.$ident,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commandId]: command?.id,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commandArguments]:\n\t\t\t\tcommand?.$ident ? undefined : command?.arguments, // filled in on main side from $ident\n\t\t};\n\n\t\t// 'insertText'-logic\n\t\tif (item.textEdit) {\n\t\t\tthis._apiDeprecation.report(\n\t\t\t\t\"CompletionItem.textEdit\",\n\t\t\t\tthis._extension,\n\t\t\t\t`Use 'CompletionItem.insertText' and 'CompletionItem.range' instead.`,\n\t\t\t);\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] =\n\t\t\t\titem.textEdit.newText;\n\t\t} else if (typeof item.insertText === \"string\") {\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] =\n\t\t\t\titem.insertText;\n\t\t} else if (item.insertText instanceof SnippetString) {\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] =\n\t\t\t\titem.insertText.value;\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertTextRules]! |=\n\t\t\t\tlanguages.CompletionItemInsertTextRule.InsertAsSnippet;\n\t\t}\n\n\t\t// 'overwrite[Before|After]'-logic\n\t\tlet range:\n\t\t\t| vscode.Range\n\t\t\t| { inserting: vscode.Range; replacing: vscode.Range }\n\t\t\t| undefined;\n\t\tif (item.textEdit) {\n\t\t\trange = item.textEdit.range;\n\t\t} else if (item.range) {\n\t\t\trange = item.range;\n\t\t}\n\n\t\tif (Range.isRange(range)) {\n\t\t\t// \"old\" range\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.range] =\n\t\t\t\ttypeConvert.Range.from(range);\n\t\t} else if (\n\t\t\trange &&\n\t\t\t(!defaultInsertRange?.isEqual(range.inserting) ||\n\t\t\t\t!defaultReplaceRange?.isEqual(range.replacing))\n\t\t) {\n\t\t\t// ONLY send range when it's different from the default ranges (safe bandwidth)\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.range] = {\n\t\t\t\tinsert: typeConvert.Range.from(range.inserting),\n\t\t\t\treplace: typeConvert.Range.from(range.replacing),\n\t\t\t};\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nclass InlineCompletionAdapterBase {\n\tasync provideInlineCompletions(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tcontext: languages.InlineCompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\treturn undefined;\n\t}\n\n\tasync provideInlineEditsForRange(\n\t\tresource: URI,\n\t\trange: IRange,\n\t\tcontext: languages.InlineCompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\treturn undefined;\n\t}\n\n\tdisposeCompletions(pid: number): void {}\n\n\thandleDidShowCompletionItem(\n\t\tpid: number,\n\t\tidx: number,\n\t\tupdatedInsertText: string,\n\t): void {}\n\n\thandlePartialAccept(\n\t\tpid: number,\n\t\tidx: number,\n\t\tacceptedCharacters: number,\n\t\tinfo: languages.PartialAcceptInfo,\n\t): void {}\n}\n\nclass InlineCompletionAdapter extends InlineCompletionAdapterBase {\n\tprivate readonly _references = new ReferenceMap<{\n\t\tdispose(): void;\n\t\titems: readonly vscode.InlineCompletionItem[];\n\t}>();\n\n\tprivate readonly _isAdditionsProposedApiEnabled = isProposedApiEnabled(\n\t\tthis._extension,\n\t\t\"inlineCompletionsAdditions\",\n\t);\n\n\tconstructor(\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineCompletionItemProvider,\n\t\tprivate readonly _commands: CommandsConverter,\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic get supportsHandleEvents(): boolean {\n\t\treturn (\n\t\t\tisProposedApiEnabled(\n\t\t\t\tthis._extension,\n\t\t\t\t\"inlineCompletionsAdditions\",\n\t\t\t) &&\n\t\t\t(typeof this._provider.handleDidShowCompletionItem === \"function\" ||\n\t\t\t\ttypeof this._provider.handleDidPartiallyAcceptCompletionItem ===\n\t\t\t\t\t\"function\")\n\t\t);\n\t}\n\n\tprivate readonly languageTriggerKindToVSCodeTriggerKind: Record<\n\t\tlanguages.InlineCompletionTriggerKind,\n\t\tInlineCompletionTriggerKind\n\t> = {\n\t\t[languages.InlineCompletionTriggerKind.Automatic]:\n\t\t\tInlineCompletionTriggerKind.Automatic,\n\t\t[languages.InlineCompletionTriggerKind.Explicit]:\n\t\t\tInlineCompletionTriggerKind.Invoke,\n\t};\n\n\toverride async provideInlineCompletions(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tcontext: languages.InlineCompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst result = await this._provider.provideInlineCompletionItems(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\t{\n\t\t\t\tselectedCompletionInfo: context.selectedSuggestionInfo\n\t\t\t\t\t? {\n\t\t\t\t\t\t\trange: typeConvert.Range.to(\n\t\t\t\t\t\t\t\tcontext.selectedSuggestionInfo.range,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\ttext: context.selectedSuggestionInfo.text,\n\t\t\t\t\t\t}\n\t\t\t\t\t: undefined,\n\t\t\t\ttriggerKind:\n\t\t\t\t\tthis.languageTriggerKindToVSCodeTriggerKind[\n\t\t\t\t\t\tcontext.triggerKind\n\t\t\t\t\t],\n\t\t\t},\n\t\t\ttoken,\n\t\t);\n\n\t\tif (!result) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst normalizedResult = Array.isArray(result) ? result : result.items;\n\t\tconst commands = this._isAdditionsProposedApiEnabled\n\t\t\t? Array.isArray(result)\n\t\t\t\t? []\n\t\t\t\t: result.commands || []\n\t\t\t: [];\n\t\tconst enableForwardStability =\n\t\t\tthis._isAdditionsProposedApiEnabled && !Array.isArray(result)\n\t\t\t\t? result.enableForwardStability\n\t\t\t\t: undefined;\n\n\t\tlet disposableStore: DisposableStore | undefined;\n\t\tconst pid = this._references.createReferenceId({\n\t\t\tdispose() {\n\t\t\t\tdisposableStore?.dispose();\n\t\t\t},\n\t\t\titems: normalizedResult,\n\t\t});\n\n\t\treturn {\n\t\t\tpid,\n\t\t\titems: normalizedResult.map<extHostProtocol.IdentifiableInlineCompletion>(\n\t\t\t\t(item, idx) => {\n\t\t\t\t\tlet command: languages.Command | undefined;\n\t\t\t\t\tif (item.command) {\n\t\t\t\t\t\tif (!disposableStore) {\n\t\t\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcommand = this._commands.toInternal(\n\t\t\t\t\t\t\titem.command,\n\t\t\t\t\t\t\tdisposableStore,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst insertText = item.insertText;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tinsertText:\n\t\t\t\t\t\t\ttypeof insertText === \"string\"\n\t\t\t\t\t\t\t\t? insertText\n\t\t\t\t\t\t\t\t: { snippet: insertText.value },\n\t\t\t\t\t\tfilterText: item.filterText,\n\t\t\t\t\t\trange: item.range\n\t\t\t\t\t\t\t? typeConvert.Range.from(item.range)\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\tcommand,\n\t\t\t\t\t\tidx: idx,\n\t\t\t\t\t\tcompleteBracketPairs: this\n\t\t\t\t\t\t\t._isAdditionsProposedApiEnabled\n\t\t\t\t\t\t\t? item.completeBracketPairs\n\t\t\t\t\t\t\t: false,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t),\n\t\t\tcommands: commands.map((c) => {\n\t\t\t\tif (!disposableStore) {\n\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t}\n\t\t\t\treturn this._commands.toInternal(c, disposableStore);\n\t\t\t}),\n\t\t\tsuppressSuggestions: false,\n\t\t\tenableForwardStability,\n\t\t};\n\t}\n\n\toverride async provideInlineEditsForRange(\n\t\tresource: URI,\n\t\trange: IRange,\n\t\tcontext: languages.InlineCompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\tif (!this._provider.provideInlineEditsForRange) {\n\t\t\treturn undefined;\n\t\t}\n\t\tcheckProposedApiEnabled(this._extension, \"inlineCompletionsAdditions\");\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst r = typeConvert.Range.to(range);\n\n\t\tconst result = await this._provider.provideInlineEditsForRange(\n\t\t\tdoc,\n\t\t\tr,\n\t\t\t{\n\t\t\t\tselectedCompletionInfo: context.selectedSuggestionInfo\n\t\t\t\t\t? {\n\t\t\t\t\t\t\trange: typeConvert.Range.to(\n\t\t\t\t\t\t\t\tcontext.selectedSuggestionInfo.range,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\ttext: context.selectedSuggestionInfo.text,\n\t\t\t\t\t\t}\n\t\t\t\t\t: undefined,\n\t\t\t\ttriggerKind:\n\t\t\t\t\tthis.languageTriggerKindToVSCodeTriggerKind[\n\t\t\t\t\t\tcontext.triggerKind\n\t\t\t\t\t],\n\t\t\t\tuserPrompt: context.userPrompt,\n\t\t\t},\n\t\t\ttoken,\n\t\t);\n\n\t\tif (!result) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst normalizedResult = Array.isArray(result) ? result : result.items;\n\t\tconst commands = this._isAdditionsProposedApiEnabled\n\t\t\t? Array.isArray(result)\n\t\t\t\t? []\n\t\t\t\t: result.commands || []\n\t\t\t: [];\n\t\tconst enableForwardStability =\n\t\t\tthis._isAdditionsProposedApiEnabled && !Array.isArray(result)\n\t\t\t\t? result.enableForwardStability\n\t\t\t\t: undefined;\n\n\t\tlet disposableStore: DisposableStore | undefined;\n\t\tconst pid = this._references.createReferenceId({\n\t\t\tdispose() {\n\t\t\t\tdisposableStore?.dispose();\n\t\t\t},\n\t\t\titems: normalizedResult,\n\t\t});\n\n\t\treturn {\n\t\t\tpid,\n\t\t\titems: normalizedResult.map<extHostProtocol.IdentifiableInlineCompletion>(\n\t\t\t\t(item, idx) => {\n\t\t\t\t\tlet command: languages.Command | undefined;\n\t\t\t\t\tif (item.command) {\n\t\t\t\t\t\tif (!disposableStore) {\n\t\t\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcommand = this._commands.toInternal(\n\t\t\t\t\t\t\titem.command,\n\t\t\t\t\t\t\tdisposableStore,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst insertText = item.insertText;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tinsertText:\n\t\t\t\t\t\t\ttypeof insertText === \"string\"\n\t\t\t\t\t\t\t\t? insertText\n\t\t\t\t\t\t\t\t: { snippet: insertText.value },\n\t\t\t\t\t\tfilterText: item.filterText,\n\t\t\t\t\t\trange: item.range\n\t\t\t\t\t\t\t? typeConvert.Range.from(item.range)\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\tcommand,\n\t\t\t\t\t\tidx: idx,\n\t\t\t\t\t\tcompleteBracketPairs: this\n\t\t\t\t\t\t\t._isAdditionsProposedApiEnabled\n\t\t\t\t\t\t\t? item.completeBracketPairs\n\t\t\t\t\t\t\t: false,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t),\n\t\t\tcommands: commands.map((c) => {\n\t\t\t\tif (!disposableStore) {\n\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t}\n\t\t\t\treturn this._commands.toInternal(c, disposableStore);\n\t\t\t}),\n\t\t\tsuppressSuggestions: false,\n\t\t\tenableForwardStability,\n\t\t};\n\t}\n\n\toverride disposeCompletions(pid: number) {\n\t\tconst data = this._references.disposeReferenceId(pid);\n\t\tdata?.dispose();\n\t}\n\n\toverride handleDidShowCompletionItem(\n\t\tpid: number,\n\t\tidx: number,\n\t\tupdatedInsertText: string,\n\t): void {\n\t\tconst completionItem = this._references.get(pid)?.items[idx];\n\t\tif (completionItem) {\n\t\t\tif (\n\t\t\t\tthis._provider.handleDidShowCompletionItem &&\n\t\t\t\tthis._isAdditionsProposedApiEnabled\n\t\t\t) {\n\t\t\t\tthis._provider.handleDidShowCompletionItem(\n\t\t\t\t\tcompletionItem,\n\t\t\t\t\tupdatedInsertText,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\toverride handlePartialAccept(\n\t\tpid: number,\n\t\tidx: number,\n\t\tacceptedCharacters: number,\n\t\tinfo: languages.PartialAcceptInfo,\n\t): void {\n\t\tconst completionItem = this._references.get(pid)?.items[idx];\n\t\tif (completionItem) {\n\t\t\tif (\n\t\t\t\tthis._provider.handleDidPartiallyAcceptCompletionItem &&\n\t\t\t\tthis._isAdditionsProposedApiEnabled\n\t\t\t) {\n\t\t\t\tthis._provider.handleDidPartiallyAcceptCompletionItem(\n\t\t\t\t\tcompletionItem,\n\t\t\t\t\tacceptedCharacters,\n\t\t\t\t);\n\t\t\t\tthis._provider.handleDidPartiallyAcceptCompletionItem(\n\t\t\t\t\tcompletionItem,\n\t\t\t\t\ttypeConvert.PartialAcceptInfo.to(info),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass InlineEditAdapter {\n\tprivate readonly _references = new ReferenceMap<{\n\t\tdispose(): void;\n\t\titem: vscode.InlineEdit;\n\t}>();\n\n\tprivate languageTriggerKindToVSCodeTriggerKind: Record<\n\t\tlanguages.InlineEditTriggerKind,\n\t\tInlineEditTriggerKind\n\t> = {\n\t\t[languages.InlineEditTriggerKind.Automatic]:\n\t\t\tInlineEditTriggerKind.Automatic,\n\t\t[languages.InlineEditTriggerKind.Invoke]: InlineEditTriggerKind.Invoke,\n\t};\n\n\tasync provideInlineEdits(\n\t\turi: URI,\n\t\tcontext: languages.IInlineEditContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineEdit | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst result = await this._provider.provideInlineEdit(\n\t\t\tdoc,\n\t\t\t{\n\t\t\t\ttriggerKind:\n\t\t\t\t\tthis.languageTriggerKindToVSCodeTriggerKind[\n\t\t\t\t\t\tcontext.triggerKind\n\t\t\t\t\t],\n\t\t\t},\n\t\t\ttoken,\n\t\t);\n\n\t\tif (!result) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\t\tlet disposableStore: DisposableStore | undefined;\n\t\tconst pid = this._references.createReferenceId({\n\t\t\tdispose() {\n\t\t\t\tdisposableStore?.dispose();\n\t\t\t},\n\t\t\titem: result,\n\t\t});\n\n\t\tlet acceptCommand: languages.Command | undefined;\n\t\tif (result.accepted) {\n\t\t\tif (!disposableStore) {\n\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t}\n\t\t\tacceptCommand = this._commands.toInternal(\n\t\t\t\tresult.accepted,\n\t\t\t\tdisposableStore,\n\t\t\t);\n\t\t}\n\t\tlet rejectCommand: languages.Command | undefined;\n\t\tif (result.rejected) {\n\t\t\tif (!disposableStore) {\n\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t}\n\t\t\trejectCommand = this._commands.toInternal(\n\t\t\t\tresult.rejected,\n\t\t\t\tdisposableStore,\n\t\t\t);\n\t\t}\n\n\t\tconst langResult: extHostProtocol.IdentifiableInlineEdit = {\n\t\t\tpid,\n\t\t\ttext: result.text,\n\t\t\trange: typeConvert.Range.from(result.range),\n\t\t\taccepted: acceptCommand,\n\t\t\trejected: rejectCommand,\n\t\t};\n\n\t\treturn langResult;\n\t}\n\n\tdisposeEdit(pid: number) {\n\t\tconst data = this._references.disposeReferenceId(pid);\n\t\tdata?.dispose();\n\t}\n\n\tconstructor(\n\t\t_extension: IExtensionDescription,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineEditProvider,\n\t\tprivate readonly _commands: CommandsConverter,\n\t) {}\n}\n\nclass ReferenceMap<T> {\n\tprivate readonly _references = new Map<number, T>();\n\tprivate _idPool = 1;\n\n\tcreateReferenceId(value: T): number {\n\t\tconst id = this._idPool++;\n\t\tthis._references.set(id, value);\n\t\treturn id;\n\t}\n\n\tdisposeReferenceId(referenceId: number): T | undefined {\n\t\tconst value = this._references.get(referenceId);\n\t\tthis._references.delete(referenceId);\n\t\treturn value;\n\t}\n\n\tget(referenceId: number): T | undefined {\n\t\treturn this._references.get(referenceId);\n\t}\n}\n\nclass SignatureHelpAdapter {\n\tprivate readonly _cache = new Cache<vscode.SignatureHelp>(\"SignatureHelp\");\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.SignatureHelpProvider,\n\t) {}\n\n\tasync provideSignatureHelp(\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\tcontext: extHostProtocol.ISignatureHelpContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ISignatureHelpDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst vscodeContext = this.reviveContext(context);\n\n\t\tconst value = await this._provider.provideSignatureHelp(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t\tvscodeContext,\n\t\t);\n\t\tif (value) {\n\t\t\tconst id = this._cache.add([value]);\n\t\t\treturn { ...typeConvert.SignatureHelp.from(value), id };\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate reviveContext(\n\t\tcontext: extHostProtocol.ISignatureHelpContextDto,\n\t): vscode.SignatureHelpContext {\n\t\tlet activeSignatureHelp: vscode.SignatureHelp | undefined;\n\t\tif (context.activeSignatureHelp) {\n\t\t\tconst revivedSignatureHelp = typeConvert.SignatureHelp.to(\n\t\t\t\tcontext.activeSignatureHelp,\n\t\t\t);\n\t\t\tconst saved = this._cache.get(context.activeSignatureHelp.id, 0);\n\t\t\tif (saved) {\n\t\t\t\tactiveSignatureHelp = saved;\n\t\t\t\tactiveSignatureHelp.activeSignature =\n\t\t\t\t\trevivedSignatureHelp.activeSignature;\n\t\t\t\tactiveSignatureHelp.activeParameter =\n\t\t\t\t\trevivedSignatureHelp.activeParameter;\n\t\t\t} else {\n\t\t\t\tactiveSignatureHelp = revivedSignatureHelp;\n\t\t\t}\n\t\t}\n\t\treturn { ...context, activeSignatureHelp };\n\t}\n\n\treleaseSignatureHelp(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass InlayHintsAdapter {\n\tprivate _cache = new Cache<vscode.InlayHint>(\"InlayHints\");\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.InlayHintsProvider,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) {}\n\n\tasync provideInlayHints(\n\t\tresource: URI,\n\t\tran: IRange,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IInlayHintsDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst range = typeConvert.Range.to(ran);\n\n\t\tconst hints = await this._provider.provideInlayHints(doc, range, token);\n\t\tif (!Array.isArray(hints) || hints.length === 0) {\n\t\t\t// bad result\n\t\t\tthis._logService.trace(\n\t\t\t\t`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(ran)}`,\n\t\t\t);\n\t\t\treturn undefined;\n\t\t}\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\t\tconst pid = this._cache.add(hints);\n\t\tthis._disposables.set(pid, new DisposableStore());\n\t\tconst result: extHostProtocol.IInlayHintsDto = {\n\t\t\thints: [],\n\t\t\tcacheId: pid,\n\t\t};\n\t\tfor (let i = 0; i < hints.length; i++) {\n\t\t\tif (this._isValidInlayHint(hints[i], range)) {\n\t\t\t\tresult.hints.push(this._convertInlayHint(hints[i], [pid, i]));\n\t\t\t}\n\t\t}\n\t\tthis._logService.trace(\n\t\t\t`[InlayHints] ${result.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(ran)}`,\n\t\t);\n\t\treturn result;\n\t}\n\n\tasync resolveInlayHint(\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t) {\n\t\tif (typeof this._provider.resolveInlayHint !== \"function\") {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst hint = await this._provider.resolveInlayHint(item, token);\n\t\tif (!hint) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!this._isValidInlayHint(hint)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._convertInlayHint(hint, id);\n\t}\n\n\treleaseHints(id: number): any {\n\t\tthis._disposables.get(id)?.dispose();\n\t\tthis._disposables.delete(id);\n\t\tthis._cache.delete(id);\n\t}\n\n\tprivate _isValidInlayHint(\n\t\thint: vscode.InlayHint,\n\t\trange?: vscode.Range,\n\t): boolean {\n\t\tif (\n\t\t\thint.label.length === 0 ||\n\t\t\t(Array.isArray(hint.label) &&\n\t\t\t\thint.label.every((part) => part.value.length === 0))\n\t\t) {\n\t\t\tconsole.log(\"INVALID inlay hint, empty label\", hint);\n\t\t\treturn false;\n\t\t}\n\t\tif (range && !range.contains(hint.position)) {\n\t\t\t// console.log('INVALID inlay hint, position outside range', range, hint);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate _convertInlayHint(\n\t\thint: vscode.InlayHint,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t): extHostProtocol.IInlayHintDto {\n\t\tconst disposables = this._disposables.get(id[0]);\n\t\tif (!disposables) {\n\t\t\tthrow Error(\"DisposableStore is missing...\");\n\t\t}\n\n\t\tconst result: extHostProtocol.IInlayHintDto = {\n\t\t\tlabel: \"\", // fill-in below\n\t\t\tcacheId: id,\n\t\t\ttooltip: typeConvert.MarkdownString.fromStrict(hint.tooltip),\n\t\t\tposition: typeConvert.Position.from(hint.position),\n\t\t\ttextEdits:\n\t\t\t\thint.textEdits && hint.textEdits.map(typeConvert.TextEdit.from),\n\t\t\tkind: hint.kind && typeConvert.InlayHintKind.from(hint.kind),\n\t\t\tpaddingLeft: hint.paddingLeft,\n\t\t\tpaddingRight: hint.paddingRight,\n\t\t};\n\n\t\tif (typeof hint.label === \"string\") {\n\t\t\tresult.label = hint.label;\n\t\t} else {\n\t\t\tconst parts: languages.InlayHintLabelPart[] = [];\n\t\t\tresult.label = parts;\n\n\t\t\tfor (const part of hint.label) {\n\t\t\t\tif (!part.value) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\"INVALID inlay hint, empty label part\",\n\t\t\t\t\t\tthis._extension.identifier.value,\n\t\t\t\t\t);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst part2: languages.InlayHintLabelPart = {\n\t\t\t\t\tlabel: part.value,\n\t\t\t\t\ttooltip: typeConvert.MarkdownString.fromStrict(\n\t\t\t\t\t\tpart.tooltip,\n\t\t\t\t\t),\n\t\t\t\t};\n\t\t\t\tif (Location.isLocation(part.location)) {\n\t\t\t\t\tpart2.location = typeConvert.location.from(part.location);\n\t\t\t\t}\n\t\t\t\tif (part.command) {\n\t\t\t\t\tpart2.command = this._commands.toInternal(\n\t\t\t\t\t\tpart.command,\n\t\t\t\t\t\tdisposables,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tparts.push(part2);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nclass LinkProviderAdapter {\n\tprivate _cache = new Cache<vscode.DocumentLink>(\"DocumentLink\");\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentLinkProvider,\n\t) {}\n\n\tasync provideLinks(\n\t\tresource: URI,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ILinksListDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\n\t\tconst links = await this._provider.provideDocumentLinks(doc, token);\n\t\tif (!Array.isArray(links) || links.length === 0) {\n\t\t\t// bad result\n\t\t\treturn undefined;\n\t\t}\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\t\tif (typeof this._provider.resolveDocumentLink !== \"function\") {\n\t\t\t// no resolve -> no caching\n\t\t\treturn {\n\t\t\t\tlinks: links\n\t\t\t\t\t.filter(LinkProviderAdapter._validateLink)\n\t\t\t\t\t.map(typeConvert.DocumentLink.from),\n\t\t\t};\n\t\t} else {\n\t\t\t// cache links for future resolving\n\t\t\tconst pid = this._cache.add(links);\n\t\t\tconst result: extHostProtocol.ILinksListDto = {\n\t\t\t\tlinks: [],\n\t\t\t\tcacheId: pid,\n\t\t\t};\n\t\t\tfor (let i = 0; i < links.length; i++) {\n\t\t\t\tif (!LinkProviderAdapter._validateLink(links[i])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst dto: extHostProtocol.ILinkDto =\n\t\t\t\t\ttypeConvert.DocumentLink.from(links[i]);\n\t\t\t\tdto.cacheId = [pid, i];\n\t\t\t\tresult.links.push(dto);\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tprivate static _validateLink(link: vscode.DocumentLink): boolean {\n\t\tif (link.target && link.target.path.length > 50_000) {\n\t\t\tconsole.warn(\"DROPPING link because it is too long\");\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tasync resolveLink(\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ILinkDto | undefined> {\n\t\tif (typeof this._provider.resolveDocumentLink !== \"function\") {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst link = await this._provider.resolveDocumentLink(item, token);\n\t\tif (!link || !LinkProviderAdapter._validateLink(link)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn typeConvert.DocumentLink.from(link);\n\t}\n\n\treleaseLinks(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass ColorProviderAdapter {\n\tconstructor(\n\t\tprivate _documents: ExtHostDocuments,\n\t\tprivate _provider: vscode.DocumentColorProvider,\n\t) {}\n\n\tasync provideColors(\n\t\tresource: URI,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IRawColorInfo[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst colors = await this._provider.provideDocumentColors(doc, token);\n\t\tif (!Array.isArray(colors)) {\n\t\t\treturn [];\n\t\t}\n\t\tconst colorInfos: extHostProtocol.IRawColorInfo[] = colors.map((ci) => {\n\t\t\treturn {\n\t\t\t\tcolor: typeConvert.Color.from(ci.color),\n\t\t\t\trange: typeConvert.Range.from(ci.range),\n\t\t\t};\n\t\t});\n\t\treturn colorInfos;\n\t}\n\n\tasync provideColorPresentations(\n\t\tresource: URI,\n\t\traw: extHostProtocol.IRawColorInfo,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.IColorPresentation[] | undefined> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst range = typeConvert.Range.to(raw.range);\n\t\tconst color = typeConvert.Color.to(raw.color);\n\t\tconst value = await this._provider.provideColorPresentations(\n\t\t\tcolor,\n\t\t\t{ document, range },\n\t\t\ttoken,\n\t\t);\n\t\tif (!Array.isArray(value)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value.map(typeConvert.ColorPresentation.from);\n\t}\n}\n\nclass FoldingProviderAdapter {\n\tconstructor(\n\t\tprivate _documents: ExtHostDocuments,\n\t\tprivate _provider: vscode.FoldingRangeProvider,\n\t) {}\n\n\tasync provideFoldingRanges(\n\t\tresource: URI,\n\t\tcontext: languages.FoldingContext,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.FoldingRange[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst ranges = await this._provider.provideFoldingRanges(\n\t\t\tdoc,\n\t\t\tcontext,\n\t\t\ttoken,\n\t\t);\n\t\tif (!Array.isArray(ranges)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn ranges.map(typeConvert.FoldingRange.from);\n\t}\n}\n\nclass SelectionRangeAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.SelectionRangeProvider,\n\t\tprivate readonly _logService: ILogService,\n\t) {}\n\n\tasync provideSelectionRanges(\n\t\tresource: URI,\n\t\tpos: IPosition[],\n\t\ttoken: CancellationToken,\n\t): Promise<languages.SelectionRange[][]> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst positions = pos.map(typeConvert.Position.to);\n\n\t\tconst allProviderRanges = await this._provider.provideSelectionRanges(\n\t\t\tdocument,\n\t\t\tpositions,\n\t\t\ttoken,\n\t\t);\n\t\tif (!isNonEmptyArray(allProviderRanges)) {\n\t\t\treturn [];\n\t\t}\n\t\tif (allProviderRanges.length !== positions.length) {\n\t\t\tthis._logService.warn(\n\t\t\t\t\"BAD selection ranges, provider must return ranges for each position\",\n\t\t\t);\n\t\t\treturn [];\n\t\t}\n\t\tconst allResults: languages.SelectionRange[][] = [];\n\t\tfor (let i = 0; i < positions.length; i++) {\n\t\t\tconst oneResult: languages.SelectionRange[] = [];\n\t\t\tallResults.push(oneResult);\n\n\t\t\tlet last: vscode.Position | vscode.Range = positions[i];\n\t\t\tlet selectionRange = allProviderRanges[i];\n\n\t\t\twhile (true) {\n\t\t\t\tif (!selectionRange.range.contains(last)) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\"INVALID selection range, must contain the previous range\",\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\toneResult.push(typeConvert.SelectionRange.from(selectionRange));\n\t\t\t\tif (!selectionRange.parent) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlast = selectionRange.range;\n\t\t\t\tselectionRange = selectionRange.parent;\n\t\t\t}\n\t\t}\n\t\treturn allResults;\n\t}\n}\n\nclass CallHierarchyAdapter {\n\tprivate readonly _idPool = new IdGenerator(\"\");\n\tprivate readonly _cache = new Map<\n\t\tstring,\n\t\tMap<string, vscode.CallHierarchyItem>\n\t>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.CallHierarchyProvider,\n\t) {}\n\n\tasync prepareSession(\n\t\turi: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICallHierarchyItemDto[] | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst items = await this._provider.prepareCallHierarchy(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t);\n\t\tif (!items) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst sessionId = this._idPool.nextId();\n\t\tthis._cache.set(sessionId, new Map());\n\n\t\tif (Array.isArray(items)) {\n\t\t\treturn items.map((item) =>\n\t\t\t\tthis._cacheAndConvertItem(sessionId, item),\n\t\t\t);\n\t\t} else {\n\t\t\treturn [this._cacheAndConvertItem(sessionId, items)];\n\t\t}\n\t}\n\n\tasync provideCallsTo(\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IIncomingCallDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error(\"missing call hierarchy item\");\n\t\t}\n\t\tconst calls = await this._provider.provideCallHierarchyIncomingCalls(\n\t\t\titem,\n\t\t\ttoken,\n\t\t);\n\t\tif (!calls) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn calls.map((call) => {\n\t\t\treturn {\n\t\t\t\tfrom: this._cacheAndConvertItem(sessionId, call.from),\n\t\t\t\tfromRanges: call.fromRanges.map((r) =>\n\t\t\t\t\ttypeConvert.Range.from(r),\n\t\t\t\t),\n\t\t\t};\n\t\t});\n\t}\n\n\tasync provideCallsFrom(\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IOutgoingCallDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error(\"missing call hierarchy item\");\n\t\t}\n\t\tconst calls = await this._provider.provideCallHierarchyOutgoingCalls(\n\t\t\titem,\n\t\t\ttoken,\n\t\t);\n\t\tif (!calls) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn calls.map((call) => {\n\t\t\treturn {\n\t\t\t\tto: this._cacheAndConvertItem(sessionId, call.to),\n\t\t\t\tfromRanges: call.fromRanges.map((r) =>\n\t\t\t\t\ttypeConvert.Range.from(r),\n\t\t\t\t),\n\t\t\t};\n\t\t});\n\t}\n\n\treleaseSession(sessionId: string): void {\n\t\tthis._cache.delete(sessionId);\n\t}\n\n\tprivate _cacheAndConvertItem(\n\t\tsessionId: string,\n\t\titem: vscode.CallHierarchyItem,\n\t): extHostProtocol.ICallHierarchyItemDto {\n\t\tconst map = this._cache.get(sessionId)!;\n\t\tconst dto = typeConvert.CallHierarchyItem.from(\n\t\t\titem,\n\t\t\tsessionId,\n\t\t\tmap.size.toString(36),\n\t\t);\n\t\tmap.set(dto._itemId, item);\n\t\treturn dto;\n\t}\n\n\tprivate _itemFromCache(\n\t\tsessionId: string,\n\t\titemId: string,\n\t): vscode.CallHierarchyItem | undefined {\n\t\tconst map = this._cache.get(sessionId);\n\t\treturn map?.get(itemId);\n\t}\n}\n\nclass TypeHierarchyAdapter {\n\tprivate readonly _idPool = new IdGenerator(\"\");\n\tprivate readonly _cache = new Map<\n\t\tstring,\n\t\tMap<string, vscode.TypeHierarchyItem>\n\t>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.TypeHierarchyProvider,\n\t) {}\n\n\tasync prepareSession(\n\t\turi: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst items = await this._provider.prepareTypeHierarchy(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\ttoken,\n\t\t);\n\t\tif (!items) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst sessionId = this._idPool.nextId();\n\t\tthis._cache.set(sessionId, new Map());\n\n\t\tif (Array.isArray(items)) {\n\t\t\treturn items.map((item) =>\n\t\t\t\tthis._cacheAndConvertItem(sessionId, item),\n\t\t\t);\n\t\t} else {\n\t\t\treturn [this._cacheAndConvertItem(sessionId, items)];\n\t\t}\n\t}\n\n\tasync provideSupertypes(\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error(\"missing type hierarchy item\");\n\t\t}\n\t\tconst supertypes = await this._provider.provideTypeHierarchySupertypes(\n\t\t\titem,\n\t\t\ttoken,\n\t\t);\n\t\tif (!supertypes) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn supertypes.map((supertype) => {\n\t\t\treturn this._cacheAndConvertItem(sessionId, supertype);\n\t\t});\n\t}\n\n\tasync provideSubtypes(\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error(\"missing type hierarchy item\");\n\t\t}\n\t\tconst subtypes = await this._provider.provideTypeHierarchySubtypes(\n\t\t\titem,\n\t\t\ttoken,\n\t\t);\n\t\tif (!subtypes) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn subtypes.map((subtype) => {\n\t\t\treturn this._cacheAndConvertItem(sessionId, subtype);\n\t\t});\n\t}\n\n\treleaseSession(sessionId: string): void {\n\t\tthis._cache.delete(sessionId);\n\t}\n\n\tprivate _cacheAndConvertItem(\n\t\tsessionId: string,\n\t\titem: vscode.TypeHierarchyItem,\n\t): extHostProtocol.ITypeHierarchyItemDto {\n\t\tconst map = this._cache.get(sessionId)!;\n\t\tconst dto = typeConvert.TypeHierarchyItem.from(\n\t\t\titem,\n\t\t\tsessionId,\n\t\t\tmap.size.toString(36),\n\t\t);\n\t\tmap.set(dto._itemId, item);\n\t\treturn dto;\n\t}\n\n\tprivate _itemFromCache(\n\t\tsessionId: string,\n\t\titemId: string,\n\t): vscode.TypeHierarchyItem | undefined {\n\t\tconst map = this._cache.get(sessionId);\n\t\treturn map?.get(itemId);\n\t}\n}\n\nclass DocumentDropEditAdapter {\n\tprivate readonly _cache = new Cache<vscode.DocumentDropEdit>(\n\t\t\"DocumentDropEdit\",\n\t);\n\n\tconstructor(\n\t\tprivate readonly _proxy: extHostProtocol.MainThreadLanguageFeaturesShape,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentDropEditProvider,\n\t\tprivate readonly _handle: number,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) {}\n\n\tasync provideDocumentOnDropEdits(\n\t\trequestId: number,\n\t\turi: URI,\n\t\tposition: IPosition,\n\t\tdataTransferDto: extHostProtocol.DataTransferDTO,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IDocumentDropEditDto[] | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst dataTransfer = typeConvert.DataTransfer.toDataTransfer(\n\t\t\tdataTransferDto,\n\t\t\tasync (id) => {\n\t\t\t\treturn (\n\t\t\t\t\tawait this._proxy.$resolveDocumentOnDropFileData(\n\t\t\t\t\t\tthis._handle,\n\t\t\t\t\t\trequestId,\n\t\t\t\t\t\tid,\n\t\t\t\t\t)\n\t\t\t\t).buffer;\n\t\t\t},\n\t\t);\n\n\t\tconst edits = await this._provider.provideDocumentDropEdits(\n\t\t\tdoc,\n\t\t\tpos,\n\t\t\tdataTransfer,\n\t\t\ttoken,\n\t\t);\n\t\tif (!edits) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst editsArray = asArray(edits);\n\t\tconst cacheId = this._cache.add(editsArray);\n\n\t\treturn editsArray.map(\n\t\t\t(edit, i): extHostProtocol.IDocumentDropEditDto => ({\n\t\t\t\t_cacheId: [cacheId, i],\n\t\t\t\ttitle:\n\t\t\t\t\tedit.title ??\n\t\t\t\t\tlocalize(\n\t\t\t\t\t\t\"defaultDropLabel\",\n\t\t\t\t\t\t\"Drop using '{0}' extension\",\n\t\t\t\t\t\tthis._extension.displayName || this._extension.name,\n\t\t\t\t\t),\n\t\t\t\tkind: edit.kind?.value,\n\t\t\t\tyieldTo: edit.yieldTo?.map((x) => x.value),\n\t\t\t\tinsertText:\n\t\t\t\t\ttypeof edit.insertText === \"string\"\n\t\t\t\t\t\t? edit.insertText\n\t\t\t\t\t\t: { snippet: edit.insertText.value },\n\t\t\t\tadditionalEdit: edit.additionalEdit\n\t\t\t\t\t? typeConvert.WorkspaceEdit.from(\n\t\t\t\t\t\t\tedit.additionalEdit,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined,\n\t\t\t}),\n\t\t);\n\t}\n\n\tasync resolveDropEdit(\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<{ additionalEdit?: extHostProtocol.IWorkspaceEditDto }> {\n\t\tconst [sessionId, itemId] = id;\n\t\tconst item = this._cache.get(sessionId, itemId);\n\t\tif (!item || !this._provider.resolveDocumentDropEdit) {\n\t\t\treturn {}; // this should not happen...\n\t\t}\n\n\t\tconst resolvedItem =\n\t\t\t(await this._provider.resolveDocumentDropEdit(item, token)) ?? item;\n\t\tconst additionalEdit = resolvedItem.additionalEdit\n\t\t\t? typeConvert.WorkspaceEdit.from(\n\t\t\t\t\tresolvedItem.additionalEdit,\n\t\t\t\t\tundefined,\n\t\t\t\t)\n\t\t\t: undefined;\n\t\treturn { additionalEdit };\n\t}\n\n\treleaseDropEdits(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass MappedEditsAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.MappedEditsProvider,\n\t) {}\n\n\tasync provideMappedEdits(\n\t\tresource: UriComponents,\n\t\tcodeBlocks: string[],\n\t\tcontext: extHostProtocol.IMappedEditsContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IWorkspaceEditDto | null> {\n\t\tconst uri = URI.revive(resource);\n\t\tconst doc = this._documents.getDocument(uri);\n\n\t\tconst reviveContextItem = (\n\t\t\titem: extHostProtocol.IDocumentContextItemDto,\n\t\t) =>\n\t\t\t({\n\t\t\t\turi: URI.revive(item.uri),\n\t\t\t\tversion: item.version,\n\t\t\t\tranges: item.ranges.map((r) => typeConvert.Range.to(r)),\n\t\t\t}) satisfies vscode.DocumentContextItem;\n\n\t\tconst usedContext = context.documents.map((docSubArray) =>\n\t\t\tdocSubArray.map(reviveContextItem),\n\t\t);\n\n\t\tconst ctx = {\n\t\t\tdocuments: usedContext,\n\t\t\tselections: usedContext[0]?.[0]?.ranges ?? [], // @ulugbekna: this is a hack for backward compatibility\n\t\t\tconversation: context.conversation?.map((c) => {\n\t\t\t\tif (c.type === \"response\") {\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttype: \"response\",\n\t\t\t\t\t\tmessage: c.message,\n\t\t\t\t\t\treferences: c.references?.map(reviveContextItem),\n\t\t\t\t\t} satisfies vscode.ConversationResponse;\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttype: \"request\",\n\t\t\t\t\t\tmessage: c.message,\n\t\t\t\t\t} satisfies vscode.ConversationRequest;\n\t\t\t\t}\n\t\t\t}),\n\t\t};\n\n\t\tconst mappedEdits = await this._provider.provideMappedEdits(\n\t\t\tdoc,\n\t\t\tcodeBlocks,\n\t\t\tctx,\n\t\t\ttoken,\n\t\t);\n\n\t\treturn mappedEdits ? typeConvert.WorkspaceEdit.from(mappedEdits) : null;\n\t}\n}\n\ntype Adapter =\n\t| DocumentSymbolAdapter\n\t| CodeLensAdapter\n\t| DefinitionAdapter\n\t| HoverAdapter\n\t| DocumentHighlightAdapter\n\t| MultiDocumentHighlightAdapter\n\t| ReferenceAdapter\n\t| CodeActionAdapter\n\t| DocumentPasteEditProvider\n\t| DocumentFormattingAdapter\n\t| RangeFormattingAdapter\n\t| OnTypeFormattingAdapter\n\t| NavigateTypeAdapter\n\t| RenameAdapter\n\t| CompletionsAdapter\n\t| SignatureHelpAdapter\n\t| LinkProviderAdapter\n\t| ImplementationAdapter\n\t| TypeDefinitionAdapter\n\t| ColorProviderAdapter\n\t| FoldingProviderAdapter\n\t| DeclarationAdapter\n\t| SelectionRangeAdapter\n\t| CallHierarchyAdapter\n\t| TypeHierarchyAdapter\n\t| DocumentSemanticTokensAdapter\n\t| DocumentRangeSemanticTokensAdapter\n\t| EvaluatableExpressionAdapter\n\t| InlineValuesAdapter\n\t| LinkedEditingRangeAdapter\n\t| InlayHintsAdapter\n\t| InlineCompletionAdapter\n\t| DocumentDropEditAdapter\n\t| MappedEditsAdapter\n\t| NewSymbolNamesAdapter\n\t| InlineEditAdapter;\n\nclass AdapterData {\n\tconstructor(\n\t\treadonly adapter: Adapter,\n\t\treadonly extension: IExtensionDescription,\n\t) {}\n}\n\nexport class ExtHostLanguageFeatures\n\timplements extHostProtocol.ExtHostLanguageFeaturesShape\n{\n\tprivate static _handlePool = 0;\n\n\tprivate readonly _proxy: extHostProtocol.MainThreadLanguageFeaturesShape;\n\tprivate readonly _adapter = new Map<number, AdapterData>();\n\n\tconstructor(\n\t\tmainContext: extHostProtocol.IMainContext,\n\t\tprivate readonly _uriTransformer: IURITransformer,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: ExtHostCommands,\n\t\tprivate readonly _diagnostics: ExtHostDiagnostics,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService,\n\t\tprivate readonly _extensionTelemetry: IExtHostTelemetry,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(\n\t\t\textHostProtocol.MainContext.MainThreadLanguageFeatures,\n\t\t);\n\t}\n\n\tprivate _transformDocumentSelector(\n\t\tselector: vscode.DocumentSelector,\n\t\textension: IExtensionDescription,\n\t): Array<extHostProtocol.IDocumentFilterDto> {\n\t\treturn typeConvert.DocumentSelector.from(\n\t\t\tselector,\n\t\t\tthis._uriTransformer,\n\t\t\textension,\n\t\t);\n\t}\n\n\tprivate _createDisposable(handle: number): Disposable {\n\t\treturn new Disposable(() => {\n\t\t\tthis._adapter.delete(handle);\n\t\t\tthis._proxy.$unregister(handle);\n\t\t});\n\t}\n\n\tprivate _nextHandle(): number {\n\t\treturn ExtHostLanguageFeatures._handlePool++;\n\t}\n\n\tprivate async _withAdapter<A, R>(\n\t\thandle: number,\n\t\tctor: { new (...args: any[]): A },\n\t\tcallback: (adapter: A, extension: IExtensionDescription) => Promise<R>,\n\t\tfallbackValue: R,\n\t\ttokenToRaceAgainst: CancellationToken | undefined,\n\t\tdoNotLog = false,\n\t): Promise<R> {\n\t\tconst data = this._adapter.get(handle);\n\t\tif (!data || !(data.adapter instanceof ctor)) {\n\t\t\treturn fallbackValue;\n\t\t}\n\n\t\tconst t1: number = Date.now();\n\t\tif (!doNotLog) {\n\t\t\tthis._logService.trace(\n\t\t\t\t`[${data.extension.identifier.value}] INVOKE provider '${callback.toString().replace(/[\\r\\n]/g, \"\")}'`,\n\t\t\t);\n\t\t}\n\n\t\tconst result = callback(data.adapter, data.extension);\n\n\t\t// logging,tracing\n\t\tPromise.resolve(result)\n\t\t\t.catch((err) => {\n\t\t\t\tif (!isCancellationError(err)) {\n\t\t\t\t\tthis._logService.error(\n\t\t\t\t\t\t`[${data.extension.identifier.value}] provider FAILED`,\n\t\t\t\t\t);\n\t\t\t\t\tthis._logService.error(err);\n\n\t\t\t\t\tthis._extensionTelemetry.onExtensionError(\n\t\t\t\t\t\tdata.extension.identifier,\n\t\t\t\t\t\terr,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tif (!doNotLog) {\n\t\t\t\t\tthis._logService.trace(\n\t\t\t\t\t\t`[${data.extension.identifier.value}] provider DONE after ${Date.now() - t1}ms`,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\n\t\tif (CancellationToken.isCancellationToken(tokenToRaceAgainst)) {\n\t\t\treturn raceCancellationError(result, tokenToRaceAgainst);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _addNewAdapter(\n\t\tadapter: Adapter,\n\t\textension: IExtensionDescription,\n\t): number {\n\t\tconst handle = this._nextHandle();\n\t\tthis._adapter.set(handle, new AdapterData(adapter, extension));\n\t\treturn handle;\n\t}\n\n\tprivate static _extLabel(ext: IExtensionDescription): string {\n\t\treturn ext.displayName || ext.name;\n\t}\n\n\tprivate static _extId(ext: IExtensionDescription): string {\n\t\treturn ext.identifier.value;\n\t}\n\n\t// --- outline\n\n\tregisterDocumentSymbolProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentSymbolProvider,\n\t\tmetadata?: vscode.DocumentSymbolProviderMetadata,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew DocumentSymbolAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tconst displayName =\n\t\t\t(metadata && metadata.label) ||\n\t\t\tExtHostLanguageFeatures._extLabel(extension);\n\t\tthis._proxy.$registerDocumentSymbolProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\tdisplayName,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentSymbols(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.DocumentSymbol[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentSymbolAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDocumentSymbols(URI.revive(resource), token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- code lens\n\n\tregisterCodeLensProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.CodeLensProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tconst eventHandle =\n\t\t\ttypeof provider.onDidChangeCodeLenses === \"function\"\n\t\t\t\t? this._nextHandle()\n\t\t\t\t: undefined;\n\n\t\tthis._adapter.set(\n\t\t\thandle,\n\t\t\tnew AdapterData(\n\t\t\t\tnew CodeLensAdapter(\n\t\t\t\t\tthis._documents,\n\t\t\t\t\tthis._commands.converter,\n\t\t\t\t\tprovider,\n\t\t\t\t\textension,\n\t\t\t\t\tthis._extensionTelemetry,\n\t\t\t\t\tthis._logService,\n\t\t\t\t),\n\t\t\t\textension,\n\t\t\t),\n\t\t);\n\t\tthis._proxy.$registerCodeLensSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\teventHandle,\n\t\t);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeCodeLenses!((_) =>\n\t\t\t\tthis._proxy.$emitCodeLensEvent(eventHandle),\n\t\t\t);\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideCodeLenses(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICodeLensListDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCodeLensAdapter,\n\t\t\t(adapter) => adapter.provideCodeLenses(URI.revive(resource), token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t\tresource.scheme === \"output\",\n\t\t);\n\t}\n\n\t$resolveCodeLens(\n\t\thandle: number,\n\t\tsymbol: extHostProtocol.ICodeLensDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICodeLensDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCodeLensAdapter,\n\t\t\t(adapter) => adapter.resolveCodeLens(symbol, token),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\t}\n\n\t$releaseCodeLenses(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tCodeLensAdapter,\n\t\t\t(adapter) => Promise.resolve(adapter.releaseCodeLenses(cacheId)),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\t}\n\n\t// --- declaration\n\n\tregisterDefinitionProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DefinitionProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew DefinitionAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerDefinitionSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDefinition(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDefinitionAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDefinition(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\t[],\n\t\t\ttoken,\n\t\t);\n\t}\n\n\tregisterDeclarationProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DeclarationProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew DeclarationAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerDeclarationSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDeclaration(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDeclarationAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDeclaration(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\t[],\n\t\t\ttoken,\n\t\t);\n\t}\n\n\tregisterImplementationProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.ImplementationProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew ImplementationAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerImplementationSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideImplementation(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tImplementationAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideImplementation(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\t[],\n\t\t\ttoken,\n\t\t);\n\t}\n\n\tregisterTypeDefinitionProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.TypeDefinitionProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew TypeDefinitionAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerTypeDefinitionSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideTypeDefinition(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tTypeDefinitionAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideTypeDefinition(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\t[],\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- extra info\n\n\tregisterHoverProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.HoverProvider,\n\t\textensionId?: ExtensionIdentifier,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew HoverAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerHoverProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideHover(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tcontext: languages.HoverContext<{ id: number }> | undefined,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.HoverWithId | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tHoverAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideHover(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$releaseHover(handle: number, id: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tHoverAdapter,\n\t\t\t(adapter) => Promise.resolve(adapter.releaseHover(id)),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- debug hover\n\n\tregisterEvaluatableExpressionProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.EvaluatableExpressionProvider,\n\t\textensionId?: ExtensionIdentifier,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew EvaluatableExpressionAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerEvaluatableExpressionProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideEvaluatableExpression(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.EvaluatableExpression | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tEvaluatableExpressionAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideEvaluatableExpression(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- debug inline values\n\n\tregisterInlineValuesProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.InlineValuesProvider,\n\t\textensionId?: ExtensionIdentifier,\n\t): vscode.Disposable {\n\t\tconst eventHandle =\n\t\t\ttypeof provider.onDidChangeInlineValues === \"function\"\n\t\t\t\t? this._nextHandle()\n\t\t\t\t: undefined;\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew InlineValuesAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\n\t\tthis._proxy.$registerInlineValuesProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\teventHandle,\n\t\t);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeInlineValues!((_) =>\n\t\t\t\tthis._proxy.$emitInlineValuesEvent(eventHandle),\n\t\t\t);\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\t\treturn result;\n\t}\n\n\t$provideInlineValues(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\trange: IRange,\n\t\tcontext: extHostProtocol.IInlineValueContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.InlineValue[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tInlineValuesAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideInlineValues(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\trange,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- occurrences\n\n\tregisterDocumentHighlightProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentHighlightProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew DocumentHighlightAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerDocumentHighlightProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\tregisterMultiDocumentHighlightProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.MultiDocumentHighlightProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew MultiDocumentHighlightAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerMultiDocumentHighlightProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentHighlights(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.DocumentHighlight[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentHighlightAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDocumentHighlights(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideMultiDocumentHighlights(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\totherModels: UriComponents[],\n\t\ttoken: CancellationToken,\n\t): Promise<languages.MultiDocumentHighlight[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tMultiDocumentHighlightAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideMultiDocumentHighlights(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\totherModels.map((model) => URI.revive(model)),\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- linked editing\n\n\tregisterLinkedEditingRangeProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.LinkedEditingRangeProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew LinkedEditingRangeAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerLinkedEditingRangeProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideLinkedEditingRanges(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ILinkedEditingRangesDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tLinkedEditingRangeAdapter,\n\t\t\tasync (adapter) => {\n\t\t\t\tconst res = await adapter.provideLinkedEditingRanges(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t);\n\t\t\t\tif (res) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tranges: res.ranges,\n\t\t\t\t\t\twordPattern: res.wordPattern\n\t\t\t\t\t\t\t? ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\t\t\t\t\t\tres.wordPattern,\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- references\n\n\tregisterReferenceProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.ReferenceProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew ReferenceAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerReferenceSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideReferences(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tcontext: languages.ReferenceContext,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.Location[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tReferenceAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideReferences(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- code actions\n\n\tregisterCodeActionProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.CodeActionProvider,\n\t\tmetadata?: vscode.CodeActionProviderMetadata,\n\t): vscode.Disposable {\n\t\tconst store = new DisposableStore();\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew CodeActionAdapter(\n\t\t\t\tthis._documents,\n\t\t\t\tthis._commands.converter,\n\t\t\t\tthis._diagnostics,\n\t\t\t\tprovider,\n\t\t\t\tthis._logService,\n\t\t\t\textension,\n\t\t\t\tthis._apiDeprecation,\n\t\t\t),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerCodeActionSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\t{\n\t\t\t\tprovidedKinds: metadata?.providedCodeActionKinds?.map(\n\t\t\t\t\t(kind) => kind.value,\n\t\t\t\t),\n\t\t\t\tdocumentation: metadata?.documentation?.map((x) => ({\n\t\t\t\t\tkind: x.kind.value,\n\t\t\t\t\tcommand: this._commands.converter.toInternal(\n\t\t\t\t\t\tx.command,\n\t\t\t\t\t\tstore,\n\t\t\t\t\t),\n\t\t\t\t})),\n\t\t\t},\n\t\t\tExtHostLanguageFeatures._extLabel(extension),\n\t\t\tExtHostLanguageFeatures._extId(extension),\n\t\t\tBoolean(provider.resolveCodeAction),\n\t\t);\n\t\tstore.add(this._createDisposable(handle));\n\t\treturn store;\n\t}\n\n\t$provideCodeActions(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\trangeOrSelection: IRange | ISelection,\n\t\tcontext: languages.CodeActionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICodeActionListDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCodeActionAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideCodeActions(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\trangeOrSelection,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$resolveCodeAction(\n\t\thandle: number,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<{\n\t\tedit?: extHostProtocol.IWorkspaceEditDto;\n\t\tcommand?: extHostProtocol.ICommandDto;\n\t}> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCodeActionAdapter,\n\t\t\t(adapter) => adapter.resolveCodeAction(id, token),\n\t\t\t{},\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$releaseCodeActions(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tCodeActionAdapter,\n\t\t\t(adapter) => Promise.resolve(adapter.releaseCodeActions(cacheId)),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- formatting\n\n\tregisterDocumentFormattingEditProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentFormattingEditProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew DocumentFormattingAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerDocumentFormattingSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\textension.identifier,\n\t\t\textension.displayName || extension.name,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentFormattingEdits(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentFormattingAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDocumentFormattingEdits(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\toptions,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\tregisterDocumentRangeFormattingEditProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentRangeFormattingEditProvider,\n\t): vscode.Disposable {\n\t\tconst canFormatMultipleRanges =\n\t\t\ttypeof provider.provideDocumentRangesFormattingEdits === \"function\";\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew RangeFormattingAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerRangeFormattingSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\textension.identifier,\n\t\t\textension.displayName || extension.name,\n\t\t\tcanFormatMultipleRanges,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentRangeFormattingEdits(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\trange: IRange,\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tRangeFormattingAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDocumentRangeFormattingEdits(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\trange,\n\t\t\t\t\toptions,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideDocumentRangesFormattingEdits(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tranges: IRange[],\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tRangeFormattingAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDocumentRangesFormattingEdits(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tranges,\n\t\t\t\t\toptions,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\tregisterOnTypeFormattingEditProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.OnTypeFormattingEditProvider,\n\t\ttriggerCharacters: string[],\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew OnTypeFormattingAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerOnTypeFormattingSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\ttriggerCharacters,\n\t\t\textension.identifier,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideOnTypeFormattingEdits(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tch: string,\n\t\toptions: languages.FormattingOptions,\n\t\ttoken: CancellationToken,\n\t): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tOnTypeFormattingAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideOnTypeFormattingEdits(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\tch,\n\t\t\t\t\toptions,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- navigate types\n\n\tregisterWorkspaceSymbolProvider(\n\t\textension: IExtensionDescription,\n\t\tprovider: vscode.WorkspaceSymbolProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew NavigateTypeAdapter(provider, this._logService),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerNavigateTypeSupport(\n\t\t\thandle,\n\t\t\ttypeof provider.resolveWorkspaceSymbol === \"function\",\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideWorkspaceSymbols(\n\t\thandle: number,\n\t\tsearch: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IWorkspaceSymbolsDto> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tNavigateTypeAdapter,\n\t\t\t(adapter) => adapter.provideWorkspaceSymbols(search, token),\n\t\t\t{ symbols: [] },\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$resolveWorkspaceSymbol(\n\t\thandle: number,\n\t\tsymbol: extHostProtocol.IWorkspaceSymbolDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IWorkspaceSymbolDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tNavigateTypeAdapter,\n\t\t\t(adapter) => adapter.resolveWorkspaceSymbol(symbol, token),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$releaseWorkspaceSymbols(handle: number, id: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tNavigateTypeAdapter,\n\t\t\t(adapter) => adapter.releaseWorkspaceSymbols(id),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- rename\n\n\tregisterRenameProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.RenameProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew RenameAdapter(this._documents, provider, this._logService),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerRenameSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\tRenameAdapter.supportsResolving(provider),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideRenameEdits(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tnewName: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tRenameAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideRenameEdits(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\tnewName,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$resolveRenameLocation(\n\t\thandle: number,\n\t\tresource: URI,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.RenameLocation | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tRenameAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.resolveRenameLocation(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\tregisterNewSymbolNamesProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.NewSymbolNamesProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew NewSymbolNamesAdapter(\n\t\t\t\tthis._documents,\n\t\t\t\tprovider,\n\t\t\t\tthis._logService,\n\t\t\t),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerNewSymbolNamesProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$supportsAutomaticNewSymbolNamesTriggerKind(\n\t\thandle: number,\n\t): Promise<boolean | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tNewSymbolNamesAdapter,\n\t\t\t(adapter) => adapter.supportsAutomaticNewSymbolNamesTriggerKind(),\n\t\t\tfalse,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$provideNewSymbolNames(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\trange: IRange,\n\t\ttriggerKind: languages.NewSymbolNameTriggerKind,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.NewSymbolName[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tNewSymbolNamesAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideNewSymbolNames(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\trange,\n\t\t\t\t\ttriggerKind,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t//#region semantic coloring\n\n\tregisterDocumentSemanticTokensProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentSemanticTokensProvider,\n\t\tlegend: vscode.SemanticTokensLegend,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew DocumentSemanticTokensAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tconst eventHandle =\n\t\t\ttypeof provider.onDidChangeSemanticTokens === \"function\"\n\t\t\t\t? this._nextHandle()\n\t\t\t\t: undefined;\n\t\tthis._proxy.$registerDocumentSemanticTokensProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\tlegend,\n\t\t\teventHandle,\n\t\t);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle) {\n\t\t\tconst subscription = provider.onDidChangeSemanticTokens!((_) =>\n\t\t\t\tthis._proxy.$emitDocumentSemanticTokensEvent(eventHandle),\n\t\t\t);\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideDocumentSemanticTokens(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tpreviousResultId: number,\n\t\ttoken: CancellationToken,\n\t): Promise<VSBuffer | null> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentSemanticTokensAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDocumentSemanticTokens(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tpreviousResultId,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tnull,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$releaseDocumentSemanticTokens(\n\t\thandle: number,\n\t\tsemanticColoringResultId: number,\n\t): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentSemanticTokensAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.releaseDocumentSemanticColoring(\n\t\t\t\t\tsemanticColoringResultId,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\tregisterDocumentRangeSemanticTokensProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentRangeSemanticTokensProvider,\n\t\tlegend: vscode.SemanticTokensLegend,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew DocumentRangeSemanticTokensAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerDocumentRangeSemanticTokensProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\tlegend,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentRangeSemanticTokens(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\trange: IRange,\n\t\ttoken: CancellationToken,\n\t): Promise<VSBuffer | null> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentRangeSemanticTokensAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideDocumentRangeSemanticTokens(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\trange,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tnull,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t//#endregion\n\n\t// --- suggestion\n\n\tregisterCompletionItemProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.CompletionItemProvider,\n\t\ttriggerCharacters: string[],\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew CompletionsAdapter(\n\t\t\t\tthis._documents,\n\t\t\t\tthis._commands.converter,\n\t\t\t\tprovider,\n\t\t\t\tthis._apiDeprecation,\n\t\t\t\textension,\n\t\t\t),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerCompletionsProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\ttriggerCharacters,\n\t\t\tCompletionsAdapter.supportsResolving(provider),\n\t\t\textension.identifier,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideCompletionItems(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tcontext: languages.CompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ISuggestResultDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCompletionsAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideCompletionItems(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$resolveCompletionItem(\n\t\thandle: number,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ISuggestDataDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCompletionsAdapter,\n\t\t\t(adapter) => adapter.resolveCompletionItem(id, token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$releaseCompletionItems(handle: number, id: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tCompletionsAdapter,\n\t\t\t(adapter) => adapter.releaseCompletionItems(id),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- ghost test\n\n\tregisterInlineCompletionsProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.InlineCompletionItemProvider,\n\t\tmetadata: vscode.InlineCompletionItemProviderMetadata | undefined,\n\t): vscode.Disposable {\n\t\tconst adapter = new InlineCompletionAdapter(\n\t\t\textension,\n\t\t\tthis._documents,\n\t\t\tprovider,\n\t\t\tthis._commands.converter,\n\t\t);\n\t\tconst handle = this._addNewAdapter(adapter, extension);\n\t\tthis._proxy.$registerInlineCompletionsSupport(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\tadapter.supportsHandleEvents,\n\t\t\tExtensionIdentifier.toKey(extension.identifier.value),\n\t\t\tmetadata?.yieldTo?.map((extId) =>\n\t\t\t\tExtensionIdentifier.toKey(extId),\n\t\t\t) || [],\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideInlineCompletions(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tcontext: languages.InlineCompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tInlineCompletionAdapterBase,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideInlineCompletions(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideInlineEditsForRange(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\trange: IRange,\n\t\tcontext: languages.InlineCompletionContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tInlineCompletionAdapterBase,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideInlineEditsForRange(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\trange,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$handleInlineCompletionDidShow(\n\t\thandle: number,\n\t\tpid: number,\n\t\tidx: number,\n\t\tupdatedInsertText: string,\n\t): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tInlineCompletionAdapterBase,\n\t\t\tasync (adapter) => {\n\t\t\t\tadapter.handleDidShowCompletionItem(\n\t\t\t\t\tpid,\n\t\t\t\t\tidx,\n\t\t\t\t\tupdatedInsertText,\n\t\t\t\t);\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$handleInlineCompletionPartialAccept(\n\t\thandle: number,\n\t\tpid: number,\n\t\tidx: number,\n\t\tacceptedCharacters: number,\n\t\tinfo: languages.PartialAcceptInfo,\n\t): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tInlineCompletionAdapterBase,\n\t\t\tasync (adapter) => {\n\t\t\t\tadapter.handlePartialAccept(pid, idx, acceptedCharacters, info);\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$freeInlineCompletionsList(handle: number, pid: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tInlineCompletionAdapterBase,\n\t\t\tasync (adapter) => {\n\t\t\t\tadapter.disposeCompletions(pid);\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- inline edit\n\n\tregisterInlineEditProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.InlineEditProvider,\n\t): vscode.Disposable {\n\t\tconst adapter = new InlineEditAdapter(\n\t\t\textension,\n\t\t\tthis._documents,\n\t\t\tprovider,\n\t\t\tthis._commands.converter,\n\t\t);\n\t\tconst handle = this._addNewAdapter(adapter, extension);\n\t\tthis._proxy.$registerInlineEditProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\textension.identifier,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideInlineEdit(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tcontext: languages.IInlineEditContext,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IdentifiableInlineEdit | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tInlineEditAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideInlineEdits(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$freeInlineEdit(handle: number, pid: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tInlineEditAdapter,\n\t\t\tasync (adapter) => {\n\t\t\t\tadapter.disposeEdit(pid);\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- parameter hints\n\n\tregisterSignatureHelpProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.SignatureHelpProvider,\n\t\tmetadataOrTriggerChars: string[] | vscode.SignatureHelpProviderMetadata,\n\t): vscode.Disposable {\n\t\tconst metadata:\n\t\t\t| extHostProtocol.ISignatureHelpProviderMetadataDto\n\t\t\t| undefined = Array.isArray(metadataOrTriggerChars)\n\t\t\t? {\n\t\t\t\t\ttriggerCharacters: metadataOrTriggerChars,\n\t\t\t\t\tretriggerCharacters: [],\n\t\t\t\t}\n\t\t\t: metadataOrTriggerChars;\n\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew SignatureHelpAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerSignatureHelpProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\tmetadata,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideSignatureHelp(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tcontext: extHostProtocol.ISignatureHelpContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ISignatureHelpDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tSignatureHelpAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideSignatureHelp(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tposition,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$releaseSignatureHelp(handle: number, id: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tSignatureHelpAdapter,\n\t\t\t(adapter) => adapter.releaseSignatureHelp(id),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- inline hints\n\n\tregisterInlayHintsProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.InlayHintsProvider,\n\t): vscode.Disposable {\n\t\tconst eventHandle =\n\t\t\ttypeof provider.onDidChangeInlayHints === \"function\"\n\t\t\t\t? this._nextHandle()\n\t\t\t\t: undefined;\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew InlayHintsAdapter(\n\t\t\t\tthis._documents,\n\t\t\t\tthis._commands.converter,\n\t\t\t\tprovider,\n\t\t\t\tthis._logService,\n\t\t\t\textension,\n\t\t\t),\n\t\t\textension,\n\t\t);\n\n\t\tthis._proxy.$registerInlayHintsProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\ttypeof provider.resolveInlayHint === \"function\",\n\t\t\teventHandle,\n\t\t\tExtHostLanguageFeatures._extLabel(extension),\n\t\t);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeInlayHints!((uri) =>\n\t\t\t\tthis._proxy.$emitInlayHintsEvent(eventHandle),\n\t\t\t);\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\t\treturn result;\n\t}\n\n\t$provideInlayHints(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\trange: IRange,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IInlayHintsDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tInlayHintsAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideInlayHints(URI.revive(resource), range, token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$resolveInlayHint(\n\t\thandle: number,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IInlayHintDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tInlayHintsAdapter,\n\t\t\t(adapter) => adapter.resolveInlayHint(id, token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$releaseInlayHints(handle: number, id: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tInlayHintsAdapter,\n\t\t\t(adapter) => adapter.releaseHints(id),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- links\n\n\tregisterDocumentLinkProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentLinkProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew LinkProviderAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerDocumentLinkProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\ttypeof provider.resolveDocumentLink === \"function\",\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentLinks(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ILinksListDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tLinkProviderAdapter,\n\t\t\t(adapter) => adapter.provideLinks(URI.revive(resource), token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t\tresource.scheme === \"output\",\n\t\t);\n\t}\n\n\t$resolveDocumentLink(\n\t\thandle: number,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ILinkDto | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tLinkProviderAdapter,\n\t\t\t(adapter) => adapter.resolveLink(id, token),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\t}\n\n\t$releaseDocumentLinks(handle: number, id: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tLinkProviderAdapter,\n\t\t\t(adapter) => adapter.releaseLinks(id),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t);\n\t}\n\n\tregisterColorProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentColorProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew ColorProviderAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerDocumentColorProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentColors(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IRawColorInfo[]> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tColorProviderAdapter,\n\t\t\t(adapter) => adapter.provideColors(URI.revive(resource), token),\n\t\t\t[],\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideColorPresentations(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tcolorInfo: extHostProtocol.IRawColorInfo,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.IColorPresentation[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tColorProviderAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideColorPresentations(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tcolorInfo,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\tregisterFoldingRangeProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.FoldingRangeProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tconst eventHandle =\n\t\t\ttypeof provider.onDidChangeFoldingRanges === \"function\"\n\t\t\t\t? this._nextHandle()\n\t\t\t\t: undefined;\n\n\t\tthis._adapter.set(\n\t\t\thandle,\n\t\t\tnew AdapterData(\n\t\t\t\tnew FoldingProviderAdapter(this._documents, provider),\n\t\t\t\textension,\n\t\t\t),\n\t\t);\n\t\tthis._proxy.$registerFoldingRangeProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\textension.identifier,\n\t\t\teventHandle,\n\t\t);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeFoldingRanges!(() =>\n\t\t\t\tthis._proxy.$emitFoldingRangeEvent(eventHandle),\n\t\t\t);\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideFoldingRanges(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tcontext: vscode.FoldingContext,\n\t\ttoken: CancellationToken,\n\t): Promise<languages.FoldingRange[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tFoldingProviderAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideFoldingRanges(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- smart select\n\n\tregisterSelectionRangeProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.SelectionRangeProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew SelectionRangeAdapter(\n\t\t\t\tthis._documents,\n\t\t\t\tprovider,\n\t\t\t\tthis._logService,\n\t\t\t),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerSelectionRangeProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideSelectionRanges(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tpositions: IPosition[],\n\t\ttoken: CancellationToken,\n\t): Promise<languages.SelectionRange[][]> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tSelectionRangeAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.provideSelectionRanges(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tpositions,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\t[],\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- call hierarchy\n\n\tregisterCallHierarchyProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.CallHierarchyProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew CallHierarchyAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerCallHierarchyProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$prepareCallHierarchy(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ICallHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCallHierarchyAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tPromise.resolve(\n\t\t\t\t\tadapter.prepareSession(\n\t\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\t\tposition,\n\t\t\t\t\t\ttoken,\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideCallHierarchyIncomingCalls(\n\t\thandle: number,\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IIncomingCallDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCallHierarchyAdapter,\n\t\t\t(adapter) => adapter.provideCallsTo(sessionId, itemId, token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideCallHierarchyOutgoingCalls(\n\t\thandle: number,\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IOutgoingCallDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tCallHierarchyAdapter,\n\t\t\t(adapter) => adapter.provideCallsFrom(sessionId, itemId, token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$releaseCallHierarchy(handle: number, sessionId: string): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tCallHierarchyAdapter,\n\t\t\t(adapter) => Promise.resolve(adapter.releaseSession(sessionId)),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- type hierarchy\n\tregisterTypeHierarchyProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.TypeHierarchyProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew TypeHierarchyAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerTypeHierarchyProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$prepareTypeHierarchy(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tTypeHierarchyAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tPromise.resolve(\n\t\t\t\t\tadapter.prepareSession(\n\t\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\t\tposition,\n\t\t\t\t\t\ttoken,\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideTypeHierarchySupertypes(\n\t\thandle: number,\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tTypeHierarchyAdapter,\n\t\t\t(adapter) => adapter.provideSupertypes(sessionId, itemId, token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$provideTypeHierarchySubtypes(\n\t\thandle: number,\n\t\tsessionId: string,\n\t\titemId: string,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tTypeHierarchyAdapter,\n\t\t\t(adapter) => adapter.provideSubtypes(sessionId, itemId, token),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$releaseTypeHierarchy(handle: number, sessionId: string): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tTypeHierarchyAdapter,\n\t\t\t(adapter) => Promise.resolve(adapter.releaseSession(sessionId)),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- Document on drop\n\n\tregisterDocumentOnDropEditProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentDropEditProvider,\n\t\tmetadata?: vscode.DocumentDropEditProviderMetadata,\n\t) {\n\t\tconst handle = this._nextHandle();\n\t\tthis._adapter.set(\n\t\t\thandle,\n\t\t\tnew AdapterData(\n\t\t\t\tnew DocumentDropEditAdapter(\n\t\t\t\t\tthis._proxy,\n\t\t\t\t\tthis._documents,\n\t\t\t\t\tprovider,\n\t\t\t\t\thandle,\n\t\t\t\t\textension,\n\t\t\t\t),\n\t\t\t\textension,\n\t\t\t),\n\t\t);\n\n\t\tthis._proxy.$registerDocumentOnDropEditProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\tisProposedApiEnabled(extension, \"documentPaste\") && metadata\n\t\t\t\t? {\n\t\t\t\t\t\tsupportsResolve: !!provider.resolveDocumentDropEdit,\n\t\t\t\t\t\tdropMimeTypes: metadata.dropMimeTypes,\n\t\t\t\t\t}\n\t\t\t\t: undefined,\n\t\t);\n\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentOnDropEdits(\n\t\thandle: number,\n\t\trequestId: number,\n\t\tresource: UriComponents,\n\t\tposition: IPosition,\n\t\tdataTransferDto: extHostProtocol.DataTransferDTO,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IDocumentDropEditDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentDropEditAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tPromise.resolve(\n\t\t\t\t\tadapter.provideDocumentOnDropEdits(\n\t\t\t\t\t\trequestId,\n\t\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\t\tposition,\n\t\t\t\t\t\tdataTransferDto,\n\t\t\t\t\t\ttoken,\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$resolveDropEdit(\n\t\thandle: number,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<{ additionalEdit?: extHostProtocol.IWorkspaceEditDto }> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentDropEditAdapter,\n\t\t\t(adapter) => adapter.resolveDropEdit(id, token),\n\t\t\t{},\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$releaseDocumentOnDropEdits(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentDropEditAdapter,\n\t\t\t(adapter) => Promise.resolve(adapter.releaseDropEdits(cacheId)),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- mapped edits\n\n\tregisterMappedEditsProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.MappedEditsProvider,\n\t): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(\n\t\t\tnew MappedEditsAdapter(this._documents, provider),\n\t\t\textension,\n\t\t);\n\t\tthis._proxy.$registerMappedEditsProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\textension.displayName ?? extension.name,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideMappedEdits(\n\t\thandle: number,\n\t\tdocument: UriComponents,\n\t\tcodeBlocks: string[],\n\t\tcontext: extHostProtocol.IMappedEditsContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IWorkspaceEditDto | null> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tMappedEditsAdapter,\n\t\t\t(adapter) =>\n\t\t\t\tPromise.resolve(\n\t\t\t\t\tadapter.provideMappedEdits(\n\t\t\t\t\t\tdocument,\n\t\t\t\t\t\tcodeBlocks,\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\ttoken,\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\tnull,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t// --- copy/paste actions\n\n\tregisterDocumentPasteEditProvider(\n\t\textension: IExtensionDescription,\n\t\tselector: vscode.DocumentSelector,\n\t\tprovider: vscode.DocumentPasteEditProvider,\n\t\tmetadata: vscode.DocumentPasteProviderMetadata,\n\t): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tthis._adapter.set(\n\t\t\thandle,\n\t\t\tnew AdapterData(\n\t\t\t\tnew DocumentPasteEditProvider(\n\t\t\t\t\tthis._proxy,\n\t\t\t\t\tthis._documents,\n\t\t\t\t\tprovider,\n\t\t\t\t\thandle,\n\t\t\t\t\textension,\n\t\t\t\t),\n\t\t\t\textension,\n\t\t\t),\n\t\t);\n\t\tthis._proxy.$registerPasteEditProvider(\n\t\t\thandle,\n\t\t\tthis._transformDocumentSelector(selector, extension),\n\t\t\t{\n\t\t\t\tsupportsCopy: !!provider.prepareDocumentPaste,\n\t\t\t\tsupportsPaste: !!provider.provideDocumentPasteEdits,\n\t\t\t\tsupportsResolve: !!provider.resolveDocumentPasteEdit,\n\t\t\t\tprovidedPasteEditKinds: metadata.providedPasteEditKinds?.map(\n\t\t\t\t\t(x) => x.value,\n\t\t\t\t),\n\t\t\t\tcopyMimeTypes: metadata.copyMimeTypes,\n\t\t\t\tpasteMimeTypes: metadata.pasteMimeTypes,\n\t\t\t},\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$prepareDocumentPaste(\n\t\thandle: number,\n\t\tresource: UriComponents,\n\t\tranges: IRange[],\n\t\tdataTransfer: extHostProtocol.DataTransferDTO,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.DataTransferDTO | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentPasteEditProvider,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.prepareDocumentPaste(\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tranges,\n\t\t\t\t\tdataTransfer,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$providePasteEdits(\n\t\thandle: number,\n\t\trequestId: number,\n\t\tresource: UriComponents,\n\t\tranges: IRange[],\n\t\tdataTransferDto: extHostProtocol.DataTransferDTO,\n\t\tcontext: extHostProtocol.IDocumentPasteContextDto,\n\t\ttoken: CancellationToken,\n\t): Promise<extHostProtocol.IPasteEditDto[] | undefined> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentPasteEditProvider,\n\t\t\t(adapter) =>\n\t\t\t\tadapter.providePasteEdits(\n\t\t\t\t\trequestId,\n\t\t\t\t\tURI.revive(resource),\n\t\t\t\t\tranges,\n\t\t\t\t\tdataTransferDto,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttoken,\n\t\t\t\t),\n\t\t\tundefined,\n\t\t\ttoken,\n\t\t);\n\t}\n\n\t$resolvePasteEdit(\n\t\thandle: number,\n\t\tid: extHostProtocol.ChainedCacheId,\n\t\ttoken: CancellationToken,\n\t): Promise<{ additionalEdit?: extHostProtocol.IWorkspaceEditDto }> {\n\t\treturn this._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentPasteEditProvider,\n\t\t\t(adapter) => adapter.resolvePasteEdit(id, token),\n\t\t\t{},\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t$releasePasteEdits(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(\n\t\t\thandle,\n\t\t\tDocumentPasteEditProvider,\n\t\t\t(adapter) => Promise.resolve(adapter.releasePasteEdits(cacheId)),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t);\n\t}\n\n\t// --- configuration\n\n\tprivate static _serializeRegExp(\n\t\tregExp: RegExp,\n\t): extHostProtocol.IRegExpDto {\n\t\treturn {\n\t\t\tpattern: regExp.source,\n\t\t\tflags: regExp.flags,\n\t\t};\n\t}\n\n\tprivate static _serializeIndentationRule(\n\t\tindentationRule: vscode.IndentationRule,\n\t): extHostProtocol.IIndentationRuleDto {\n\t\treturn {\n\t\t\tdecreaseIndentPattern: ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\tindentationRule.decreaseIndentPattern,\n\t\t\t),\n\t\t\tincreaseIndentPattern: ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\tindentationRule.increaseIndentPattern,\n\t\t\t),\n\t\t\tindentNextLinePattern: indentationRule.indentNextLinePattern\n\t\t\t\t? ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\t\t\tindentationRule.indentNextLinePattern,\n\t\t\t\t\t)\n\t\t\t\t: undefined,\n\t\t\tunIndentedLinePattern: indentationRule.unIndentedLinePattern\n\t\t\t\t? ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\t\t\tindentationRule.unIndentedLinePattern,\n\t\t\t\t\t)\n\t\t\t\t: undefined,\n\t\t};\n\t}\n\n\tprivate static _serializeOnEnterRule(\n\t\tonEnterRule: vscode.OnEnterRule,\n\t): extHostProtocol.IOnEnterRuleDto {\n\t\treturn {\n\t\t\tbeforeText: ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\tonEnterRule.beforeText,\n\t\t\t),\n\t\t\tafterText: onEnterRule.afterText\n\t\t\t\t? ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\t\t\tonEnterRule.afterText,\n\t\t\t\t\t)\n\t\t\t\t: undefined,\n\t\t\tpreviousLineText: onEnterRule.previousLineText\n\t\t\t\t? ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\t\t\tonEnterRule.previousLineText,\n\t\t\t\t\t)\n\t\t\t\t: undefined,\n\t\t\taction: onEnterRule.action,\n\t\t};\n\t}\n\n\tprivate static _serializeOnEnterRules(\n\t\tonEnterRules: vscode.OnEnterRule[],\n\t): extHostProtocol.IOnEnterRuleDto[] {\n\t\treturn onEnterRules.map(ExtHostLanguageFeatures._serializeOnEnterRule);\n\t}\n\n\tprivate static _serializeAutoClosingPair(\n\t\tautoClosingPair: vscode.AutoClosingPair,\n\t): IAutoClosingPairConditional {\n\t\treturn {\n\t\t\topen: autoClosingPair.open,\n\t\t\tclose: autoClosingPair.close,\n\t\t\tnotIn: autoClosingPair.notIn\n\t\t\t\t? autoClosingPair.notIn.map((v) => SyntaxTokenType.toString(v))\n\t\t\t\t: undefined,\n\t\t};\n\t}\n\n\tprivate static _serializeAutoClosingPairs(\n\t\tautoClosingPairs: vscode.AutoClosingPair[],\n\t): IAutoClosingPairConditional[] {\n\t\treturn autoClosingPairs.map(\n\t\t\tExtHostLanguageFeatures._serializeAutoClosingPair,\n\t\t);\n\t}\n\n\tsetLanguageConfiguration(\n\t\textension: IExtensionDescription,\n\t\tlanguageId: string,\n\t\tconfiguration: vscode.LanguageConfiguration,\n\t): vscode.Disposable {\n\t\tconst { wordPattern } = configuration;\n\n\t\t// check for a valid word pattern\n\t\tif (wordPattern && regExpLeadsToEndlessLoop(wordPattern)) {\n\t\t\tthrow new Error(\n\t\t\t\t`Invalid language configuration: wordPattern '${wordPattern}' is not allowed to match the empty string.`,\n\t\t\t);\n\t\t}\n\n\t\t// word definition\n\t\tif (wordPattern) {\n\t\t\tthis._documents.setWordDefinitionFor(languageId, wordPattern);\n\t\t} else {\n\t\t\tthis._documents.setWordDefinitionFor(languageId, undefined);\n\t\t}\n\n\t\tif (configuration.__electricCharacterSupport) {\n\t\t\tthis._apiDeprecation.report(\n\t\t\t\t\"LanguageConfiguration.__electricCharacterSupport\",\n\t\t\t\textension,\n\t\t\t\t`Do not use.`,\n\t\t\t);\n\t\t}\n\n\t\tif (configuration.__characterPairSupport) {\n\t\t\tthis._apiDeprecation.report(\n\t\t\t\t\"LanguageConfiguration.__characterPairSupport\",\n\t\t\t\textension,\n\t\t\t\t`Do not use.`,\n\t\t\t);\n\t\t}\n\n\t\tconst handle = this._nextHandle();\n\t\tconst serializedConfiguration: extHostProtocol.ILanguageConfigurationDto =\n\t\t\t{\n\t\t\t\tcomments: configuration.comments,\n\t\t\t\tbrackets: configuration.brackets,\n\t\t\t\twordPattern: configuration.wordPattern\n\t\t\t\t\t? ExtHostLanguageFeatures._serializeRegExp(\n\t\t\t\t\t\t\tconfiguration.wordPattern,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined,\n\t\t\t\tindentationRules: configuration.indentationRules\n\t\t\t\t\t? ExtHostLanguageFeatures._serializeIndentationRule(\n\t\t\t\t\t\t\tconfiguration.indentationRules,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined,\n\t\t\t\tonEnterRules: configuration.onEnterRules\n\t\t\t\t\t? ExtHostLanguageFeatures._serializeOnEnterRules(\n\t\t\t\t\t\t\tconfiguration.onEnterRules,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined,\n\t\t\t\t__electricCharacterSupport:\n\t\t\t\t\tconfiguration.__electricCharacterSupport,\n\t\t\t\t__characterPairSupport: configuration.__characterPairSupport,\n\t\t\t\tautoClosingPairs: configuration.autoClosingPairs\n\t\t\t\t\t? ExtHostLanguageFeatures._serializeAutoClosingPairs(\n\t\t\t\t\t\t\tconfiguration.autoClosingPairs,\n\t\t\t\t\t\t)\n\t\t\t\t\t: undefined,\n\t\t\t};\n\n\t\tthis._proxy.$setLanguageConfiguration(\n\t\t\thandle,\n\t\t\tlanguageId,\n\t\t\tserializedConfiguration,\n\t\t);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$setWordDefinitions(\n\t\twordDefinitions: extHostProtocol.ILanguageWordDefinitionDto[],\n\t): void {\n\t\tfor (const wordDefinition of wordDefinitions) {\n\t\t\tthis._documents.setWordDefinitionFor(\n\t\t\t\twordDefinition.languageId,\n\t\t\t\tnew RegExp(\n\t\t\t\t\twordDefinition.regexSource,\n\t\t\t\t\twordDefinition.regexFlags,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n}\n"],
  "mappings": ";;AAMA;AAAA,EACC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACM;AACP,SAAS,6BAA6B;AAEtC,SAAS,yBAAyB;AAClC;AAAA,EACC;AAAA,EACA;AAAA,OACM;AACP,SAAS,mBAAmB;AAC5B,SAAS,uBAAuB;AAChC,SAAS,QAAQ,aAAa;AAC9B,SAAS,iBAAiB;AAC1B,SAAS,gCAAgC;AACzC,SAAS,YAAY,gBAAgB;AACrC,SAAS,WAA+B;AAIxC;AAAA,EACC,SAAS;AAAA,OAEH;AACP;AAAA,EAEC;AAAA,OACM;AACP,YAAY,eAAe;AAE3B,SAAS,+BAA+B;AACxC,SAAS,gBAAgB;AACzB;AAAA,EACC;AAAA,OAEM;AAEP;AAAA,EACC;AAAA,EACA;AAAA,OACM;AACP,SAAS,aAAa;AACtB,YAAY,qBAAqB;AASjC,YAAY,iBAAiB;AAC7B;AAAA,EACC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAEA;AAAA,OACM;AAIP,MAAM,sBAAsB;AAAA,EAC3B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAvFJ,OAmF4B;AAAA;AAAA;AAAA,EAM3B,MAAM,uBACL,UACA,OACkD;AAClD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,QAAQ,MAAM,KAAK,UAAU,uBAAuB,KAAK,KAAK;AACpE,QAAI,eAAe,KAAK,GAAG;AAC1B,aAAO;AAAA,IACR,WAAW,MAAO,CAAC,aAAa,gBAAgB;AAC/C,aAA0B,MAAO;AAAA,QAChC,YAAY,eAAe;AAAA,MAC5B;AAAA,IACD,OAAO;AACN,aAAO,sBAAsB;AAAA,QACP;AAAA,MACtB;AAAA,IACD;AAAA,EACD;AAAA,EAEA,OAAe,sBACd,OAC6B;AAG7B,YAAQ,MAAM,MAAM,CAAC,EAAE,KAAK,CAAC,GAAG,MAAM;AACrC,UAAIA,OAAM,EAAE,SAAS,MAAM,MAAM,UAAU,EAAE,SAAS,MAAM,KAAK;AACjE,UAAIA,SAAQ,GAAG;AACd,QAAAA,OAAM,EAAE,SAAS,MAAM,IAAI,UAAU,EAAE,SAAS,MAAM,GAAG;AAAA,MAC1D;AACA,aAAOA;AAAA,IACR,CAAC;AACD,UAAM,MAAkC,CAAC;AACzC,UAAM,cAA0C,CAAC;AACjD,eAAW,QAAQ,OAAO;AACzB,YAAM,UAAoC;AAAA,QACzC,MAAM,KAAK,QAAQ;AAAA,QACnB,MAAM,YAAY,WAAW,KAAK,KAAK,IAAI;AAAA,QAC3C,MAAM,KAAK,MAAM,IAAI,YAAY,UAAU,IAAI,KAAK,CAAC;AAAA,QACrD,QAAQ;AAAA,QACR,eAAe,KAAK;AAAA,QACpB,OAAO,YAAY,MAAM,KAAK,KAAK,SAAS,KAAK;AAAA,QACjD,gBAAgB,YAAY,MAAM,KAAK,KAAK,SAAS,KAAK;AAAA,QAC1D,UAAU,CAAC;AAAA,MACZ;AAEA,aAAO,MAAM;AACZ,YAAI,YAAY,WAAW,GAAG;AAC7B,sBAAY,KAAK,OAAO;AACxB,cAAI,KAAK,OAAO;AAChB;AAAA,QACD;AACA,cAAM,SAAS,YAAY,YAAY,SAAS,CAAC;AACjD,YACC,YAAY,cAAc,OAAO,OAAO,QAAQ,KAAK,KACrD,CAAC,YAAY,YAAY,OAAO,OAAO,QAAQ,KAAK,GACnD;AACD,iBAAO,UAAU,KAAK,OAAO;AAC7B,sBAAY,KAAK,OAAO;AACxB;AAAA,QACD;AACA,oBAAY,IAAI;AAAA,MACjB;AAAA,IACD;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,gBAAgB;AAAA,EAIrB,YACkB,YACA,WACA,WACA,YACA,eACA,aAChB;AANgB;AACA;AACA;AACA;AACA;AACA;AAAA,EACf;AAAA,EAvKJ,OA4JsB;AAAA;AAAA;AAAA,EACJ,SAAS,IAAI,MAAuB,UAAU;AAAA,EAC9C,eAAe,oBAAI,IAA6B;AAAA,EAWjE,MAAM,kBACL,UACA,OACwD;AACxD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAEhD,UAAM,SAAS,MAAM,KAAK,UAAU,kBAAkB,KAAK,KAAK;AAChE,QAAI,CAAC,UAAU,MAAM,yBAAyB;AAC7C,aAAO;AAAA,IACR;AACA,UAAM,UAAU,KAAK,OAAO,IAAI,MAAM;AACtC,UAAM,cAAc,IAAI,gBAAgB;AACxC,SAAK,aAAa,IAAI,SAAS,WAAW;AAC1C,UAAM,SAA2C;AAAA,MAChD;AAAA,MACA,QAAQ,CAAC;AAAA,IACV;AACA,aAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACvC,aAAO,OAAO,KAAK;AAAA,QAClB,SAAS,CAAC,SAAS,CAAC;AAAA,QACpB,OAAO,YAAY,MAAM,KAAK,OAAO,CAAC,EAAE,KAAK;AAAA,QAC7C,SAAS,KAAK,UAAU;AAAA,UACvB,OAAO,CAAC,EAAE;AAAA,UACV;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,gBACL,QACA,OACoD;AACpD,UAAM,OAAO,OAAO,WAAW,KAAK,OAAO,IAAI,GAAG,OAAO,OAAO;AAChE,QAAI,CAAC,MAAM;AACV,aAAO;AAAA,IACR;AAEA,QAAI;AACJ,QACC,OAAO,KAAK,UAAU,oBAAoB,cAC1C,KAAK,YACJ;AACD,qBAAe;AAAA,IAChB,OAAO;AACN,qBAAe,MAAM,KAAK,UAAU,gBAAgB,MAAM,KAAK;AAAA,IAChE;AACA,QAAI,CAAC,cAAc;AAClB,qBAAe;AAAA,IAChB;AAEA,QAAI,MAAM,yBAAyB;AAClC,aAAO;AAAA,IACR;AACA,UAAM,cACL,OAAO,WAAW,KAAK,aAAa,IAAI,OAAO,QAAQ,CAAC,CAAC;AAC1D,QAAI,CAAC,aAAa;AAEjB,aAAO;AAAA,IACR;AAEA,QAAI,CAAC,aAAa,SAAS;AAC1B,YAAM,QAAQ,IAAI;AAAA,QACjB,gDACC,KAAK,WAAW,WAAW;AAAA,MAC7B;AACA,WAAK,cAAc;AAAA,QAClB,KAAK,WAAW;AAAA,QAChB;AAAA,MACD;AACA,WAAK,YAAY,MAAM,KAAK;AAC5B,aAAO;AAAA,IACR;AAEA,WAAO,UAAU,KAAK,UAAU;AAAA,MAC/B,aAAa;AAAA,MACb;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,kBAAkB,UAAwB;AACzC,SAAK,aAAa,IAAI,QAAQ,GAAG,QAAQ;AACzC,SAAK,aAAa,OAAO,QAAQ;AACjC,SAAK,OAAO,OAAO,QAAQ;AAAA,EAC5B;AACD;AAEA,SAAS,uBACR,OAM2B;AAC3B,MAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,WAAa,MAAO,IAAI,YAAY,eAAe,IAAI;AAAA,EACxD,WAAW,OAAO;AACjB,WAAO,CAAC,YAAY,eAAe,KAAK,KAAK,CAAC;AAAA,EAC/C;AACA,SAAO,CAAC;AACT;AAdS;AAgBT,MAAM,kBAAkB;AAAA,EACvB,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAtRJ,OAkRwB;AAAA;AAAA;AAAA,EAMvB,MAAM,kBACL,UACA,UACA,OACoC;AACpC,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAC5C,UAAM,QAAQ,MAAM,KAAK,UAAU,kBAAkB,KAAK,KAAK,KAAK;AACpE,WAAO,uBAAuB,KAAK;AAAA,EACpC;AACD;AAEA,MAAM,mBAAmB;AAAA,EACxB,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAxSJ,OAoSyB;AAAA;AAAA;AAAA,EAMxB,MAAM,mBACL,UACA,UACA,OACoC;AACpC,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAC5C,UAAM,QAAQ,MAAM,KAAK,UAAU,mBAAmB,KAAK,KAAK,KAAK;AACrE,WAAO,uBAAuB,KAAK;AAAA,EACpC;AACD;AAEA,MAAM,sBAAsB;AAAA,EAC3B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA1TJ,OAsT4B;AAAA;AAAA;AAAA,EAM3B,MAAM,sBACL,UACA,UACA,OACoC;AACpC,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAC5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,WAAO,uBAAuB,KAAK;AAAA,EACpC;AACD;AAEA,MAAM,sBAAsB;AAAA,EAC3B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAhVJ,OA4U4B;AAAA;AAAA;AAAA,EAM3B,MAAM,sBACL,UACA,UACA,OACoC;AACpC,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAC5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,WAAO,uBAAuB,KAAK;AAAA,EACpC;AACD;AAEA,MAAM,aAAa;AAAA,EASlB,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA9WJ,OAkWmB;AAAA;AAAA;AAAA,EACV,gBAAgB;AAAA,EAChB,YAAuC,oBAAI,IAGjD;AAAA,EAEF,OAAe,qBAAqB;AAAA,EAOpC,MAAM,aACL,UACA,UACA,SACA,OACmD;AACnD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,QAAI;AACJ,QAAI,WAAW,QAAQ,kBAAkB;AACxC,YAAM,kBAAkB,QAAQ,iBAAiB,cAAc;AAC/D,YAAM,gBAAgB,KAAK,UAAU,IAAI,eAAe;AACxD,UAAI,CAAC,eAAe;AACnB,cAAM,IAAI,MAAM,iBAAiB,eAAe,YAAY;AAAA,MAC7D;AACA,YAAM,eAAoC;AAAA,QACzC,gBAAgB,QAAQ,iBAAiB;AAAA,QACzC;AAAA,MACD;AACA,cAAQ,MAAM,KAAK,UAAU;AAAA,QAC5B;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,IACD,OAAO;AACN,cAAQ,MAAM,KAAK,UAAU,aAAa,KAAK,KAAK,KAAK;AAAA,IAC1D;AACA,QAAI,CAAC,SAAS,eAAe,MAAM,QAAQ,GAAG;AAC7C,aAAO;AAAA,IACR;AACA,QAAI,CAAC,MAAM,OAAO;AACjB,YAAM,QAAQ,IAAI,uBAAuB,GAAG;AAAA,IAC7C;AACA,QAAI,CAAC,MAAM,OAAO;AACjB,YAAM,QAAQ,IAAI,MAAM,KAAK,GAAG;AAAA,IACjC;AACA,UAAM,iBAAkC,YAAY,MAAM,KAAK,KAAK;AACpE,UAAM,KAAK,KAAK;AAEhB,QAAI,KAAK,UAAU,SAAS,aAAa,oBAAoB;AAC5D,YAAM,YAAY,KAAK,IAAI,GAAG,KAAK,UAAU,KAAK,CAAC;AACnD,WAAK,UAAU,OAAO,SAAS;AAAA,IAChC;AACA,SAAK,UAAU,IAAI,IAAI,KAAK;AAC5B,SAAK,iBAAiB;AACtB,UAAM,QAAqC;AAAA,MAC1C,GAAG;AAAA,MACH;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,aAAa,IAAkB;AAC9B,SAAK,UAAU,OAAO,EAAE;AAAA,EACzB;AACD;AAEA,MAAM,6BAA6B;AAAA,EAClC,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA/aJ,OA2amC;AAAA;AAAA;AAAA,EAMlC,MAAM,6BACL,UACA,UACA,OACuD;AACvD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,OAAO;AACV,aAAO,YAAY,sBAAsB,KAAK,KAAK;AAAA,IACpD;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,oBAAoB;AAAA,EACzB,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAzcJ,OAqc0B;AAAA;AAAA;AAAA,EAMzB,MAAM,oBACL,UACA,UACA,SACA,OAC+C;AAC/C,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA,YAAY,MAAM,GAAG,QAAQ;AAAA,MAC7B,YAAY,mBAAmB,GAAG,OAAO;AAAA,MACzC;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,CAAC,OAAO,YAAY,YAAY,KAAK,EAAE,CAAC;AAAA,IAC1D;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,yBAAyB;AAAA,EAC9B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAneJ,OA+d+B;AAAA;AAAA;AAAA,EAM9B,MAAM,0BACL,UACA,UACA,OACqD;AACrD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,YAAY,kBAAkB,IAAI;AAAA,IACpD;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,8BAA8B;AAAA,EACnC,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA7fJ,OAyfoC;AAAA;AAAA;AAAA,EAMnC,MAAM,+BACL,UACA,UACA,gBACA,OAC0D;AAC1D,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,iBAAiB,eAAe;AAAA,MAAI,CAAC,MAC1C,KAAK,WAAW,YAAY,CAAC;AAAA,IAC9B;AACA,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,YAAY,uBAAuB,IAAI;AAAA,IACzD;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,0BAA0B;AAAA,EAC/B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA5hBJ,OAwhBgC;AAAA;AAAA;AAAA,EAM/B,MAAM,2BACL,UACA,UACA,OACqD;AACrD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,SAAS,MAAM,QAAQ,MAAM,MAAM,GAAG;AACzC,aAAO;AAAA,QACN,QAAQ,SAAS,MAAM,OAAO,IAAI,YAAY,MAAM,IAAI,CAAC;AAAA,QACzD,aAAa,MAAM;AAAA,MACpB;AAAA,IACD;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,iBAAiB;AAAA,EACtB,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAzjBJ,OAqjBuB;AAAA;AAAA;AAAA,EAMtB,MAAM,kBACL,UACA,UACA,SACA,OAC4C;AAC5C,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,YAAY,SAAS,IAAI;AAAA,IAC3C;AACA,WAAO;AAAA,EACR;AACD;AAMA,MAAM,kBAAkB;AAAA,EAQvB,YACkB,YACA,WACA,cACA,WACA,aACA,YACA,iBAChB;AAPgB;AACA;AACA;AACA;AACA;AACA;AACA;AAAA,EACf;AAAA,EArmBJ,OAqlBwB;AAAA;AAAA;AAAA,EACvB,OAAwB,yBAAiC;AAAA,EAExC,SAAS,IAAI;AAAA,IAC7B;AAAA,EACD;AAAA,EACiB,eAAe,oBAAI,IAA6B;AAAA,EAYjE,MAAM,mBACL,UACA,kBACA,SACA,OAC0D;AAC1D,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,UAAU,aAAa,gBAAgB,IAC9B,YAAY,UAAU,GAAG,gBAAgB,IAC7C,YAAY,MAAM,GAAG,gBAAgB;AACtD,UAAM,iBAAsC,CAAC;AAE7C,eAAW,cAAc,KAAK,aAAa,eAAe,QAAQ,GAAG;AACpE,UAAI,IAAI,aAAa,WAAW,KAAK,GAAG;AACvC,cAAM,SAAS,eAAe,KAAK,UAAU;AAC7C,YAAI,SAAS,kBAAkB,wBAAwB;AACtD;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAEA,UAAM,oBAA8C;AAAA,MACnD,aAAa;AAAA,MACb,MAAM,QAAQ,OAAO,IAAI,eAAe,QAAQ,IAAI,IAAI;AAAA,MACxD,aAAa,YAAY,sBAAsB,GAAG,QAAQ,OAAO;AAAA,IAClE;AAEA,UAAM,oBAAoB,MAAM,KAAK,UAAU;AAAA,MAC9C;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QACC,CAAC,gBAAgB,iBAAiB,KAClC,MAAM,yBACL;AACD,aAAO;AAAA,IACR;AAEA,UAAM,UAAU,KAAK,OAAO,IAAI,iBAAiB;AACjD,UAAM,cAAc,IAAI,gBAAgB;AACxC,SAAK,aAAa,IAAI,SAAS,WAAW;AAC1C,UAAM,UAA8B,CAAC;AACrC,aAAS,IAAI,GAAG,IAAI,kBAAkB,QAAQ,KAAK;AAClD,YAAM,YAAY,kBAAkB,CAAC;AACrC,UAAI,CAAC,WAAW;AACf;AAAA,MACD;AACA,UAAI,kBAAkB,WAAW,SAAS,GAAG;AAE5C,aAAK,gBAAgB;AAAA,UACpB;AAAA,UACA,KAAK;AAAA,UACL;AAAA,QACD;AAEA,gBAAQ,KAAK;AAAA,UACZ,cAAc;AAAA,UACd,OAAO,UAAU;AAAA,UACjB,SAAS,KAAK,UAAU,WAAW,WAAW,WAAW;AAAA,QAC1D,CAAC;AAAA,MACF,OAAO;AACN,YAAI,kBAAkB,MAAM;AAC3B,cAAI,CAAC,UAAU,MAAM;AACpB,iBAAK,YAAY;AAAA,cAChB,GAAG,KAAK,WAAW,WAAW,KAAK,4BAA4B,kBAAkB,KAAK,KAAK;AAAA,YAC5F;AAAA,UACD,WACC,CAAC,kBAAkB,KAAK,SAAS,UAAU,IAAI,GAC9C;AACD,iBAAK,YAAY;AAAA,cAChB,GAAG,KAAK,WAAW,WAAW,KAAK,4BAA4B,kBAAkB,KAAK,KAAK,oDAAoD,UAAU,KAAK,KAAK;AAAA,YACpK;AAAA,UACD;AAAA,QACD;AAGA,cAAM,QAAQ,UAAU,UAAU,CAAC;AAGnC,gBAAQ,KAAK;AAAA,UACZ,SAAS,CAAC,SAAS,CAAC;AAAA,UACpB,OAAO,UAAU;AAAA,UACjB,SACC,UAAU,WACV,KAAK,UAAU;AAAA,YACd,UAAU;AAAA,YACV;AAAA,UACD;AAAA,UACD,aACC,UAAU,eACV,UAAU,YAAY,IAAI,YAAY,WAAW,IAAI;AAAA,UACtD,MACC,UAAU,QACV,YAAY,cAAc;AAAA,YACzB,UAAU;AAAA,YACV;AAAA,UACD;AAAA,UACD,MAAM,UAAU,QAAQ,UAAU,KAAK;AAAA,UACvC,aAAa,UAAU;AAAA,UACvB,MAAM,qBAAqB,KAAK,YAAY,cAAc,IACvD,UAAU,OACV;AAAA,UACH,QAAQ;AAAA,YACP,KAAK;AAAA,YACL;AAAA,UACD,IACG,SAAS,MAAM,IAAI,YAAY,MAAM,IAAI,CAAC,IAC1C;AAAA,UACH,UAAU,UAAU,UAAU;AAAA,QAC/B,CAAC;AAAA,MACF;AAAA,IACD;AACA,WAAO,EAAE,SAAS,QAAQ;AAAA,EAC3B;AAAA,EAEA,MAAM,kBACL,IACA,OAIE;AACF,UAAM,CAAC,WAAW,MAAM,IAAI;AAC5B,UAAM,OAAO,KAAK,OAAO,IAAI,WAAW,MAAM;AAC9C,QAAI,CAAC,QAAQ,kBAAkB,WAAW,IAAI,GAAG;AAChD,aAAO,CAAC;AAAA,IACT;AACA,QAAI,CAAC,KAAK,UAAU,mBAAmB;AACtC,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,eACJ,MAAM,KAAK,UAAU,kBAAkB,MAAM,KAAK,KAAM;AAE1D,QAAI;AACJ,QAAI,aAAa,MAAM;AACtB,qBAAe,YAAY,cAAc;AAAA,QACxC,aAAa;AAAA,QACb;AAAA,MACD;AAAA,IACD;AAEA,QAAI;AACJ,QAAI,aAAa,SAAS;AACzB,YAAM,cAAc,KAAK,aAAa,IAAI,SAAS;AACnD,UAAI,aAAa;AAChB,0BAAkB,KAAK,UAAU;AAAA,UAChC,aAAa;AAAA,UACb;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAEA,WAAO,EAAE,MAAM,cAAc,SAAS,gBAAgB;AAAA,EACvD;AAAA,EAEA,mBAAmB,UAAwB;AAC1C,SAAK,aAAa,IAAI,QAAQ,GAAG,QAAQ;AACzC,SAAK,aAAa,OAAO,QAAQ;AACjC,SAAK,OAAO,OAAO,QAAQ;AAAA,EAC5B;AAAA,EAEA,OAAe,WAAW,OAAqC;AAC9D,WACC,OAAwB,MAAO,YAAY,YAC3C,OAAwB,MAAO,UAAU;AAAA,EAE3C;AACD;AAEA,MAAM,0BAA0B;AAAA,EAK/B,YACkB,QACA,YACA,WACA,SACA,YAChB;AALgB;AACA;AACA;AACA;AACA;AAAA,EACf;AAAA,EA9xBJ,OAmxBgC;AAAA;AAAA;AAAA,EACd,SAAS,IAAI;AAAA,IAC7B;AAAA,EACD;AAAA,EAUA,MAAM,qBACL,UACA,QACA,iBACA,OACuD;AACvD,QAAI,CAAC,KAAK,UAAU,sBAAsB;AACzC;AAAA,IACD;AAEA,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,eAAe,OAAO,IAAI,CAAC,UAAU,YAAY,MAAM,GAAG,KAAK,CAAC;AAEtE,UAAM,eAAe,YAAY,aAAa;AAAA,MAC7C;AAAA,MACA,MAAM;AACL,cAAM,IAAI,oBAAoB;AAAA,MAC/B;AAAA,IACD;AACA,UAAM,KAAK,UAAU;AAAA,MACpB;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,MAAM,yBAAyB;AAClC;AAAA,IACD;AAGA,UAAM,UAAU,MAAM,KAAK,YAAY,EAAE;AAAA,MACxC,CAAC,CAAC,EAAE,KAAK,MAAM,EAAE,iBAAiB;AAAA,IACnC;AACA,WAAO,YAAY,aAAa,KAAK,OAAO;AAAA,EAC7C;AAAA,EAEA,MAAM,kBACL,WACA,UACA,QACA,iBACA,SACA,OAC2C;AAC3C,QAAI,CAAC,KAAK,UAAU,2BAA2B;AAC9C,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,eAAe,OAAO,IAAI,CAAC,UAAU,YAAY,MAAM,GAAG,KAAK,CAAC;AAEtE,UAAM,eAAe,YAAY,aAAa;AAAA,MAC7C;AAAA,MACA,OAAO,OAAO;AACb,gBACC,MAAM,KAAK,OAAO;AAAA,UACjB,KAAK;AAAA,UACL;AAAA,UACA;AAAA,QACD,GACC;AAAA,MACH;AAAA,IACD;AAEA,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,QACC,MAAM,QAAQ,OACX,IAAI,4BAA4B,QAAQ,IAAI,IAC5C;AAAA,QACH,aAAa,QAAQ;AAAA,MACtB;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,SAAS,MAAM,yBAAyB;AAC5C,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,UAAU,KAAK,OAAO,IAAI,KAAK;AAErC,WAAO,MAAM;AAAA,MACZ,CAAC,MAAM,OAAsC;AAAA,QAC5C,UAAU,CAAC,SAAS,CAAC;AAAA,QACrB,OACC,KAAK,SACL;AAAA,UACC;AAAA,UACA;AAAA,UACA,KAAK,WAAW,eAAe,KAAK,WAAW;AAAA,QAChD;AAAA,QACD,MAAM,KAAK;AAAA,QACX,SAAS,KAAK,SAAS,IAAI,CAAC,MAAM,EAAE,KAAK;AAAA,QACzC,YACC,OAAO,KAAK,eAAe,WACxB,KAAK,aACL,EAAE,SAAS,KAAK,WAAW,MAAM;AAAA,QACrC,gBAAgB,KAAK,iBAClB,YAAY,cAAc;AAAA,UAC1B,KAAK;AAAA,UACL;AAAA,QACD,IACC;AAAA,MACJ;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAM,iBACL,IACA,OACkE;AAClE,UAAM,CAAC,WAAW,MAAM,IAAI;AAC5B,UAAM,OAAO,KAAK,OAAO,IAAI,WAAW,MAAM;AAC9C,QAAI,CAAC,QAAQ,CAAC,KAAK,UAAU,0BAA0B;AACtD,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,eACJ,MAAM,KAAK,UAAU,yBAAyB,MAAM,KAAK,KAC1D;AACD,UAAM,iBAAiB,aAAa,iBACjC,YAAY,cAAc;AAAA,MAC1B,aAAa;AAAA,MACb;AAAA,IACD,IACC;AACH,WAAO,EAAE,eAAe;AAAA,EACzB;AAAA,EAEA,kBAAkB,IAAiB;AAClC,SAAK,OAAO,OAAO,EAAE;AAAA,EACtB;AACD;AAEA,MAAM,0BAA0B;AAAA,EAC/B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA36BJ,OAu6BgC;AAAA;AAAA;AAAA,EAM/B,MAAM,+BACL,UACA,SACA,OAC8C;AAC9C,UAAM,WAAW,KAAK,WAAW,YAAY,QAAQ;AAErD,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACK;AAAA,MACL;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,YAAY,SAAS,IAAI;AAAA,IAC3C;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,uBAAuB;AAAA,EAC5B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAp8BJ,OAg8B6B;AAAA;AAAA;AAAA,EAM5B,MAAM,oCACL,UACA,OACA,SACA,OAC8C;AAC9C,UAAM,WAAW,KAAK,WAAW,YAAY,QAAQ;AACrD,UAAM,MAAM,YAAY,MAAM,GAAG,KAAK;AAEtC,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACK;AAAA,MACL;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,YAAY,SAAS,IAAI;AAAA,IAC3C;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,qCACL,UACA,QACA,SACA,OAC8C;AAC9C;AAAA,MACC,OAAO,KAAK,UAAU,yCACrB;AAAA,MACD;AAAA,IACD;AAEA,UAAM,WAAW,KAAK,WAAW,YAAY,QAAQ;AACrD,UAAM,UAAmB,OAAO,IAAI,YAAY,MAAM,EAAE;AACxD,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACK;AAAA,MACL;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,YAAY,SAAS,IAAI;AAAA,IAC3C;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,wBAAwB;AAAA,EAC7B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA1/BJ,OAs/B8B;AAAA;AAAA;AAAA,EAM7B,8BAAwC,CAAC;AAAA;AAAA,EAEzC,MAAM,6BACL,UACA,UACA,IACA,SACA,OAC8C;AAC9C,UAAM,WAAW,KAAK,WAAW,YAAY,QAAQ;AACrD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,MACK;AAAA,MACL;AAAA,IACD;AACA,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM,IAAI,YAAY,SAAS,IAAI;AAAA,IAC3C;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,oBAAoB;AAAA,EAKzB,YACkB,WACA,aAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA9hCJ,OAshC0B;AAAA;AAAA;AAAA,EACR,SAAS,IAAI;AAAA,IAC7B;AAAA,EACD;AAAA,EAOA,MAAM,wBACL,QACA,OACgD;AAChD,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,IACD;AAEA,QAAI,CAAC,gBAAgB,KAAK,GAAG;AAC5B,aAAO,EAAE,SAAS,CAAC,EAAE;AAAA,IACtB;AAEA,UAAM,MAAM,KAAK,OAAO,IAAI,KAAK;AACjC,UAAM,SAA+C;AAAA,MACpD,SAAS;AAAA,MACT,SAAS,CAAC;AAAA,IACX;AAEA,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,YAAM,OAAO,MAAM,CAAC;AACpB,UAAI,CAAC,QAAQ,CAAC,KAAK,MAAM;AACxB,aAAK,YAAY,KAAK,6BAA6B,IAAI;AACvD;AAAA,MACD;AACA,aAAO,QAAQ,KAAK;AAAA,QACnB,GAAG,YAAY,gBAAgB,KAAK,IAAI;AAAA,QACxC,SAAS,CAAC,KAAK,CAAC;AAAA,MACjB,CAAC;AAAA,IACF;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,uBACL,QACA,OAC2D;AAC3D,QAAI,OAAO,KAAK,UAAU,2BAA2B,YAAY;AAChE,aAAO;AAAA,IACR;AACA,QAAI,CAAC,OAAO,SAAS;AACpB,aAAO;AAAA,IACR;AACA,UAAM,OAAO,KAAK,OAAO,IAAI,GAAG,OAAO,OAAO;AAC9C,QAAI,MAAM;AACT,YAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,QAClC;AAAA,QACA;AAAA,MACD;AACA,aACC,SACA,MAAM,QAAQ,YAAY,gBAAgB,KAAK,KAAK,GAAG,IAAI;AAAA,IAE7D;AACA,WAAO;AAAA,EACR;AAAA,EAEA,wBAAwB,IAAiB;AACxC,SAAK,OAAO,OAAO,EAAE;AAAA,EACtB;AACD;AAEA,MAAM,cAAc;AAAA,EAKnB,YACkB,YACA,WACA,aAChB;AAHgB;AACA;AACA;AAAA,EACf;AAAA,EAxmCJ,OA+lCoB;AAAA;AAAA;AAAA,EACnB,OAAO,kBAAkB,UAA0C;AAClE,WAAO,OAAO,SAAS,kBAAkB;AAAA,EAC1C;AAAA,EAQA,MAAM,mBACL,UACA,UACA,SACA,OAGC;AACD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,QAAI;AACH,YAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,QAClC;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACD;AACA,UAAI,CAAC,OAAO;AACX,eAAO;AAAA,MACR;AACA,aAAO,YAAY,cAAc,KAAK,KAAK;AAAA,IAC5C,SAAS,KAAK;AACb,YAAM,eAAe,cAAc,WAAW,GAAG;AACjD,UAAI,cAAc;AACjB,eAAO,EAAE,cAAc,OAAO,OAAW;AAAA,MAC1C,OAAO;AAEN,eAAO,QAAQ,OAA0C,GAAG;AAAA,MAC7D;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAM,sBACL,UACA,UACA,OACwE;AACxE,QAAI,OAAO,KAAK,UAAU,kBAAkB,YAAY;AACvD,aAAO,QAAQ,QAAQ,MAAS;AAAA,IACjC;AAEA,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,QAAI;AACH,YAAM,kBAAkB,MAAM,KAAK,UAAU;AAAA,QAC5C;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAEA,UAAI;AACJ,UAAI;AACJ,UAAI,MAAM,QAAQ,eAAe,GAAG;AACnC,gBAAQ;AACR,eAAO,IAAI,QAAQ,eAAe;AAAA,MACnC,WAAW,SAAS,eAAe,GAAG;AACrC,gBAAQ,gBAAgB;AACxB,eAAO,gBAAgB;AAAA,MACxB;AAEA,UAAI,CAAC,SAAS,CAAC,MAAM;AACpB,eAAO;AAAA,MACR;AACA,UAAI,MAAM,MAAM,OAAO,IAAI,QAAQ,MAAM,IAAI,OAAO,IAAI,MAAM;AAC7D,aAAK,YAAY;AAAA,UAChB;AAAA,QACD;AACA,eAAO;AAAA,MACR;AACA,aAAO,EAAE,OAAO,YAAY,MAAM,KAAK,KAAK,GAAG,KAAK;AAAA,IACrD,SAAS,KAAK;AACb,YAAM,eAAe,cAAc,WAAW,GAAG;AACjD,UAAI,cAAc;AACjB,eAAO,EAAE,cAAc,OAAO,QAAY,MAAM,OAAW;AAAA,MAC5D,OAAO;AACN,eAAO,QAAQ,OAAY,GAAG;AAAA,MAC/B;AAAA,IACD;AAAA,EACD;AAAA,EAEA,OAAe,WAAW,KAA8B;AACvD,QAAI,OAAO,QAAQ,UAAU;AAC5B,aAAO;AAAA,IACR,WAAW,eAAe,SAAS,OAAO,IAAI,YAAY,UAAU;AACnE,aAAO,IAAI;AAAA,IACZ,OAAO;AACN,aAAO;AAAA,IACR;AAAA,EACD;AACD;AAEA,MAAM,sBAAsB;AAAA,EAW3B,YACkB,YACA,WACA,aAChB;AAHgB;AACA;AACA;AAAA,EACf;AAAA,EAttCJ,OAusC4B;AAAA;AAAA;AAAA,EAC3B,OAAe,yCAGX;AAAA,IACH,CAAC,UAAU,yBAAyB,MAAM,GACzC,yBAAyB;AAAA,IAC1B,CAAC,UAAU,yBAAyB,SAAS,GAC5C,yBAAyB;AAAA,EAC3B;AAAA,EAQA,MAAM,6CAA6C;AAClD,WAAO,KAAK,UAAU;AAAA,EACvB;AAAA,EAEA,MAAM,sBACL,UACA,OACA,aACA,OACiD;AACjD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,MAAM,GAAG,KAAK;AAEtC,QAAI;AACH,YAAM,OACL,sBAAsB,uCACrB,WACD;AACD,YAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,QAClC;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACD;AACA,UAAI,CAAC,OAAO;AACX,eAAO;AAAA,MACR;AACA,aAAO,MAAM;AAAA,QAAI,CAAC,MACjB,OAAO,MACP,WACG,EAAE,eAAe,EAAE,IACnB,EAAE,eAAe,EAAE,eAAe,MAAM,EAAE,KAAK;AAAA,MACnD;AAAA,IACD,SAAS,KAAc;AACtB,WAAK,YAAY;AAAA,QAChB,sBAAsB,WAAW,GAAG,KACnC,KAAK;AAAA,UACJ;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,MACF;AACA,aAAO;AAAA,IACR;AAAA,EACD;AAAA;AAAA,EAGA,OAAe,WAAW,KAA8B;AACvD,QAAI,OAAO,QAAQ,UAAU;AAC5B,aAAO;AAAA,IACR,WAAW,eAAe,SAAS,OAAO,IAAI,YAAY,UAAU;AACnE,aAAO,IAAI;AAAA,IACZ,OAAO;AACN,aAAO;AAAA,IACR;AAAA,EACD;AACD;AAEA,MAAM,6BAA6B;AAAA,EAClC,YACU,UACA,QACR;AAFQ;AACA;AAAA,EACP;AAAA,EAtxCJ,OAkxCmC;AAAA;AAAA;AAKnC;AAqBA,MAAM,8BAA8B;AAAA,EAOnC,YACkB,YACA,WAChB;AAFgB;AACA;AAEjB,SAAK,mBAAmB,oBAAI,IAA0C;AAAA,EACvE;AAAA,EAxzCD,OA4yCoC;AAAA;AAAA;AAAA,EAClB;AAAA,EAIT,gBAAgB;AAAA,EASxB,MAAM,8BACL,UACA,kBACA,OAC2B;AAC3B,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,iBACL,qBAAqB,IAClB,KAAK,iBAAiB,IAAI,gBAAgB,IAC1C;AACJ,QAAI,QACH,OAAO,gBAAgB,aAAa,YACpC,OAAO,KAAK,UAAU,uCACrB,aACE,MAAM,KAAK,UAAU;AAAA,MACrB;AAAA,MACA,eAAe;AAAA,MACf;AAAA,IACD,IACC,MAAM,KAAK,UAAU;AAAA,MACrB;AAAA,MACA;AAAA,IACD;AAEH,QAAI,gBAAgB;AACnB,WAAK,iBAAiB,OAAO,gBAAgB;AAAA,IAC9C;AACA,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AACA,YAAQ,8BAA8B,2BAA2B,KAAK;AACtE,WAAO,KAAK;AAAA,MACX,8BAA8B;AAAA,QAC7B;AAAA,QACA;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAM,gCACL,0BACgB;AAChB,SAAK,iBAAiB,OAAO,wBAAwB;AAAA,EACtD;AAAA,EAEA,OAAe,2BACd,GACqD;AACrD,QAAI,8BAA8B,kBAAkB,CAAC,GAAG;AACvD,UAAI,8BAA8B,yBAAyB,CAAC,GAAG;AAC9D,eAAO;AAAA,MACR;AACA,aAAO,IAAI,eAAe,IAAI,YAAY,EAAE,IAAI,GAAG,EAAE,QAAQ;AAAA,IAC9D,WAAW,8BAA8B,uBAAuB,CAAC,GAAG;AACnE,UACC,8BAA8B,8BAA8B,CAAC,GAC5D;AACD,eAAO;AAAA,MACR;AACA,aAAO,IAAI;AAAA,QACV,EAAE,MAAM;AAAA,UACP,CAAC,SACA,IAAI;AAAA,YACH,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK,OAAO,IAAI,YAAY,KAAK,IAAI,IAAI,KAAK;AAAA,UAC/C;AAAA,QACF;AAAA,QACA,EAAE;AAAA,MACH;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,OAAe,kBACd,GAC8B;AAC9B,WAAO,KAAK,CAAC,CAAE,EAA6B;AAAA,EAC7C;AAAA,EAEA,OAAe,yBACd,GAC6B;AAC7B,WAAO,EAAE,gBAAgB;AAAA,EAC1B;AAAA,EAEA,OAAe,uBACd,GACmC;AACnC,WAAO,KAAK,MAAM,QAAS,EAAkC,KAAK;AAAA,EACnE;AAAA,EAEA,OAAe,8BACd,GACkC;AAClC,eAAW,QAAQ,EAAE,OAAO;AAC3B,UAAI,EAAE,KAAK,gBAAgB,cAAc;AACxC,eAAO;AAAA,MACR;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,OAAe,gBACd,gBACA,WACqD;AACrD,QAAI,CAAC,8BAA8B,kBAAkB,SAAS,GAAG;AAChE,aAAO;AAAA,IACR;AACA,QAAI,CAAC,kBAAkB,CAAC,eAAe,QAAQ;AAC9C,aAAO;AAAA,IACR;AACA,UAAM,UAAU,eAAe;AAC/B,UAAM,YAAY,QAAQ;AAC1B,UAAM,UAAU,UAAU;AAC1B,UAAM,YAAY,QAAQ;AAE1B,QAAI,qBAAqB;AACzB,UAAM,wBAAwB,KAAK,IAAI,WAAW,SAAS;AAC3D,WACC,qBAAqB,yBACrB,QAAQ,kBAAkB,MAAM,QAAQ,kBAAkB,GACzD;AACD;AAAA,IACD;AAEA,QACC,uBAAuB,aACvB,uBAAuB,WACtB;AAED,aAAO,IAAI,oBAAoB,CAAC,GAAG,UAAU,QAAQ;AAAA,IACtD;AAEA,QAAI,qBAAqB;AACzB,UAAM,wBACL,wBAAwB;AACzB,WACC,qBAAqB,yBACrB,QAAQ,YAAY,qBAAqB,CAAC,MACzC,QAAQ,YAAY,qBAAqB,CAAC,GAC1C;AACD;AAAA,IACD;AAEA,WAAO,IAAI;AAAA,MACV;AAAA,QACC;AAAA,UACC,OAAO;AAAA,UACP,aACC,YAAY,qBAAqB;AAAA,UAClC,MAAM,QAAQ;AAAA,YACb;AAAA,YACA,YAAY;AAAA,UACb;AAAA,QACD;AAAA,MACD;AAAA,MACA,UAAU;AAAA,IACX;AAAA,EACD;AAAA,EAEQ,MACP,OACA,UACkB;AAClB,QAAI,8BAA8B,kBAAkB,KAAK,GAAG;AAC3D,YAAM,OAAO,KAAK;AAClB,WAAK,iBAAiB;AAAA,QACrB;AAAA,QACA,IAAI,6BAA6B,MAAM,UAAU,MAAM,IAAI;AAAA,MAC5D;AACA,aAAO,wBAAwB;AAAA,QAC9B,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,MAAM,MAAM;AAAA,MACb,CAAC;AAAA,IACF;AAEA,QAAI,8BAA8B,uBAAuB,KAAK,GAAG;AAChE,YAAM,OAAO,KAAK;AAClB,UAAI,8BAA8B,kBAAkB,QAAQ,GAAG;AAE9D,aAAK,iBAAiB;AAAA,UACrB;AAAA,UACA,IAAI;AAAA,YACH,SAAS;AAAA,YACT,SAAS;AAAA,UACV;AAAA,QACD;AAAA,MACD,OAAO;AACN,aAAK,iBAAiB;AAAA,UACrB;AAAA,UACA,IAAI,6BAA6B,MAAM,QAAQ;AAAA,QAChD;AAAA,MACD;AACA,aAAO,wBAAwB;AAAA,QAC9B,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,SAAS,MAAM,SAAS,CAAC,GAAG,IAAI,CAAC,UAAU;AAAA,UAC1C,OAAO,KAAK;AAAA,UACZ,aAAa,KAAK;AAAA,UAClB,MAAM,KAAK;AAAA,QACZ,EAAE;AAAA,MACH,CAAC;AAAA,IACF;AAEA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,mCAAmC;AAAA,EACxC,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAlhDJ,OA8gDyC;AAAA;AAAA;AAAA,EAMxC,MAAM,mCACL,UACA,OACA,OAC2B;AAC3B,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA,YAAY,MAAM,GAAG,KAAK;AAAA,MAC1B;AAAA,IACD;AACA,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AACA,WAAO,KAAK,MAAM,KAAK;AAAA,EACxB;AAAA,EAEQ,MAAM,OAAwC;AACrD,WAAO,wBAAwB;AAAA,MAC9B,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,MAAM,MAAM;AAAA,IACb,CAAC;AAAA,EACF;AACD;AAEA,MAAM,mBAAmB;AAAA,EAQxB,YACkB,YACA,WACA,WACA,iBACA,YAChB;AALgB;AACA;AACA;AACA;AACA;AAAA,EACf;AAAA,EA5jDJ,OA8iDyB;AAAA;AAAA;AAAA,EACxB,OAAO,kBAAkB,UAAkD;AAC1E,WAAO,OAAO,SAAS,0BAA0B;AAAA,EAClD;AAAA,EAEQ,SAAS,IAAI,MAA6B,gBAAgB;AAAA,EAC1D,eAAe,oBAAI,IAA6B;AAAA,EAUxD,MAAM,uBACL,UACA,UACA,SACA,OACyD;AACzD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAK5C,UAAM,eACL,IAAI,uBAAuB,GAAG,KAAK,IAAI,MAAM,KAAK,GAAG;AACtD,UAAM,cAAc,aAAa,KAAK,EAAE,KAAK,IAAI,CAAC;AAElD,UAAM,KAAK,IAAI,UAAU;AACzB,UAAM,cAAc,MAAM,KAAK,UAAU;AAAA,MACxC;AAAA,MACA;AAAA,MACA;AAAA,MACA,YAAY,kBAAkB,GAAG,OAAO;AAAA,IACzC;AAEA,QAAI,CAAC,aAAa;AAEjB,aAAO;AAAA,IACR;AAEA,QAAI,MAAM,yBAAyB;AAGlC,aAAO;AAAA,IACR;AAEA,UAAM,OAAO,MAAM,QAAQ,WAAW,IACnC,IAAI,eAAe,WAAW,IAC9B;AAGH,UAAM,MAAc,mBAAmB,kBAAkB,KAAK,SAAS,IACpE,KAAK,OAAO,IAAI,KAAK,KAAK,IAC1B,KAAK,OAAO,IAAI,CAAC,CAAC;AACrB,UAAM,cAAc,IAAI,gBAAgB;AACxC,SAAK,aAAa,IAAI,KAAK,WAAW;AAEtC,UAAM,cAAiD,CAAC;AACxD,UAAM,SAA4C;AAAA,MACjD,GAAG;AAAA,MACH,CAAC,gBAAgB,uBAAuB,WAAW,GAAG;AAAA,MACtD,CAAC,gBAAgB,uBAAuB,aAAa,GAAG;AAAA,QACvD,SAAS,YAAY,MAAM,KAAK,YAAY;AAAA,QAC5C,QAAQ,YAAY,MAAM,KAAK,WAAW;AAAA,MAC3C;AAAA,MACA,CAAC,gBAAgB,uBAAuB,YAAY,GACnD,KAAK,gBAAgB;AAAA,MACtB,CAAC,gBAAgB,uBAAuB,QAAQ,GAAG,GAAG,QAAQ;AAAA,IAC/D;AAEA,aAAS,IAAI,GAAG,IAAI,KAAK,MAAM,QAAQ,KAAK;AAC3C,YAAM,OAAO,KAAK,MAAM,CAAC;AAEzB,YAAM,MAAM,KAAK;AAAA,QAChB;AAAA,QACA,CAAC,KAAK,CAAC;AAAA,QACP;AAAA,QACA;AAAA,MACD;AACA,kBAAY,KAAK,GAAG;AAAA,IACrB;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,sBACL,IACA,OACuD;AACvD,QAAI,OAAO,KAAK,UAAU,0BAA0B,YAAY;AAC/D,aAAO;AAAA,IACR;AAEA,UAAM,OAAO,KAAK,OAAO,IAAI,GAAG,EAAE;AAClC,QAAI,CAAC,MAAM;AACV,aAAO;AAAA,IACR;AAEA,UAAM,OAAO,KAAK,uBAAuB,MAAM,EAAE;AAEjD,UAAM,eAAe,MAAM,KAAK,UAAU;AAAA,MACzC;AAAA,MACA;AAAA,IACD;AAEA,QAAI,CAAC,cAAc;AAClB,aAAO;AAAA,IACR;AAEA,UAAM,OAAO,KAAK,uBAAuB,cAAc,EAAE;AAEzD,QACC,KAAK,gBAAgB,qBAAqB,UAAU,MACnD,KAAK,gBAAgB,qBAAqB,UAAU,KACrD,KAAK,gBAAgB,qBAAqB,eAAe,MACxD,KAAK,gBAAgB,qBAAqB,eAAe,GACzD;AACD,WAAK,gBAAgB;AAAA,QACpB;AAAA,QACA,KAAK;AAAA,QACL;AAAA,MACD;AAAA,IACD;AAEA,QACC,KAAK,gBAAgB,qBAAqB,YAAY,MACrD,KAAK,gBAAgB,qBAAqB,YAAY,KACvD,KAAK,gBAAgB,qBAAqB,SAAS,MAClD,KAAK,gBAAgB,qBAAqB,SAAS,KACpD,CAAC;AAAA,MACA,KAAK,gBAAgB,qBAAqB,gBAAgB;AAAA,MAC1D,KAAK,gBAAgB,qBAAqB,gBAAgB;AAAA,IAC3D,GACC;AACD,WAAK,gBAAgB;AAAA,QACpB;AAAA,QACA,KAAK;AAAA,QACL;AAAA,MACD;AAAA,IACD;AAEA,WAAO;AAAA,MACN,GAAG;AAAA,MACH,CAAC,gBAAgB,qBAAqB,aAAa,GAClD,KAAK,gBAAgB,qBAAqB,aAAa;AAAA,MACxD,CAAC,gBAAgB,qBAAqB,MAAM,GAC3C,KAAK,gBAAgB,qBAAqB,MAAM;AAAA,MACjD,CAAC,gBAAgB,qBAAqB,mBAAmB,GACxD,KAAK,gBAAgB,qBAAqB,mBAAmB;AAAA;AAAA,MAG9D,CAAC,gBAAgB,qBAAqB,UAAU,GAC/C,KAAK,gBAAgB,qBAAqB,UAAU;AAAA,MACrD,CAAC,gBAAgB,qBAAqB,eAAe,GACpD,KAAK,gBAAgB,qBAAqB,eAAe;AAAA;AAAA,MAG1D,CAAC,gBAAgB,qBAAqB,YAAY,GACjD,KAAK,gBAAgB,qBAAqB,YAAY;AAAA,MACvD,CAAC,gBAAgB,qBAAqB,SAAS,GAC9C,KAAK,gBAAgB,qBAAqB,SAAS;AAAA,MACpD,CAAC,gBAAgB,qBAAqB,gBAAgB,GACrD,KAAK,gBAAgB,qBAAqB,gBAAgB;AAAA,IAC5D;AAAA,EACD;AAAA,EAEA,uBAAuB,IAAiB;AACvC,SAAK,aAAa,IAAI,EAAE,GAAG,QAAQ;AACnC,SAAK,aAAa,OAAO,EAAE;AAC3B,SAAK,OAAO,OAAO,EAAE;AAAA,EACtB;AAAA,EAEQ,uBACP,MACA,IACA,oBACA,qBACkC;AAClC,UAAM,cAAc,KAAK,aAAa,IAAI,GAAG,CAAC,CAAC;AAC/C,QAAI,CAAC,aAAa;AACjB,YAAM,MAAM,+BAA+B;AAAA,IAC5C;AAEA,UAAM,UAAU,KAAK,UAAU,WAAW,KAAK,SAAS,WAAW;AACnE,UAAM,SAA0C;AAAA;AAAA,MAE/C,GAAG;AAAA;AAAA,MAEH,CAAC,gBAAgB,qBAAqB,KAAK,GAAG,KAAK;AAAA,MACnD,CAAC,gBAAgB,qBAAqB,IAAI,GACzC,KAAK,SAAS,SACX,YAAY,mBAAmB,KAAK,KAAK,IAAI,IAC7C;AAAA,MACJ,CAAC,gBAAgB,qBAAqB,YAAY,GACjD,KAAK,QAAQ,KAAK,KAAK,IAAI,YAAY,kBAAkB,IAAI;AAAA,MAC9D,CAAC,gBAAgB,qBAAqB,MAAM,GAAG,KAAK;AAAA,MACpD,CAAC,gBAAgB,qBAAqB,aAAa,GAClD,OAAO,KAAK,kBAAkB,cAC3B,SACA,YAAY,eAAe,WAAW,KAAK,aAAa;AAAA,MAC5D,CAAC,gBAAgB,qBAAqB,QAAQ,GAC7C,KAAK,aAAa,KAAK,QAAQ,KAAK,WAAW;AAAA,MAChD,CAAC,gBAAgB,qBAAqB,UAAU,GAC/C,KAAK,eAAe,KAAK,QAAQ,KAAK,aAAa;AAAA,MACpD,CAAC,gBAAgB,qBAAqB,SAAS,GAC9C,KAAK,aAAa;AAAA,MACnB,CAAC,gBAAgB,qBAAqB,eAAe,GACpD,KAAK,iBACF,UAAU,6BAA6B,iBACvC,UAAU,6BAA6B;AAAA,MAC3C,CAAC,gBAAgB,qBAAqB,gBAAgB,GACrD,KAAK,kBAAkB,KAAK,EAAE;AAAA,MAC/B,CAAC,gBAAgB,qBAAqB,mBAAmB,GACxD,KAAK,uBACL,KAAK,oBAAoB,IAAI,YAAY,SAAS,IAAI;AAAA,MACvD,CAAC,gBAAgB,qBAAqB,YAAY,GACjD,SAAS;AAAA,MACV,CAAC,gBAAgB,qBAAqB,SAAS,GAAG,SAAS;AAAA,MAC3D,CAAC,gBAAgB,qBAAqB,gBAAgB,GACrD,SAAS,SAAS,SAAY,SAAS;AAAA;AAAA,IACzC;AAGA,QAAI,KAAK,UAAU;AAClB,WAAK,gBAAgB;AAAA,QACpB;AAAA,QACA,KAAK;AAAA,QACL;AAAA,MACD;AACA,aAAO,gBAAgB,qBAAqB,UAAU,IACrD,KAAK,SAAS;AAAA,IAChB,WAAW,OAAO,KAAK,eAAe,UAAU;AAC/C,aAAO,gBAAgB,qBAAqB,UAAU,IACrD,KAAK;AAAA,IACP,WAAW,KAAK,sBAAsB,eAAe;AACpD,aAAO,gBAAgB,qBAAqB,UAAU,IACrD,KAAK,WAAW;AACjB,aAAO,gBAAgB,qBAAqB,eAAe,KAC1D,UAAU,6BAA6B;AAAA,IACzC;AAGA,QAAI;AAIJ,QAAI,KAAK,UAAU;AAClB,cAAQ,KAAK,SAAS;AAAA,IACvB,WAAW,KAAK,OAAO;AACtB,cAAQ,KAAK;AAAA,IACd;AAEA,QAAI,MAAM,QAAQ,KAAK,GAAG;AAEzB,aAAO,gBAAgB,qBAAqB,KAAK,IAChD,YAAY,MAAM,KAAK,KAAK;AAAA,IAC9B,WACC,UACC,CAAC,oBAAoB,QAAQ,MAAM,SAAS,KAC5C,CAAC,qBAAqB,QAAQ,MAAM,SAAS,IAC7C;AAED,aAAO,gBAAgB,qBAAqB,KAAK,IAAI;AAAA,QACpD,QAAQ,YAAY,MAAM,KAAK,MAAM,SAAS;AAAA,QAC9C,SAAS,YAAY,MAAM,KAAK,MAAM,SAAS;AAAA,MAChD;AAAA,IACD;AAEA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,4BAA4B;AAAA,EAn0DlC,OAm0DkC;AAAA;AAAA;AAAA,EACjC,MAAM,yBACL,UACA,UACA,SACA,OACqE;AACrE,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,2BACL,UACA,OACA,SACA,OACqE;AACrE,WAAO;AAAA,EACR;AAAA,EAEA,mBAAmB,KAAmB;AAAA,EAAC;AAAA,EAEvC,4BACC,KACA,KACA,mBACO;AAAA,EAAC;AAAA,EAET,oBACC,KACA,KACA,oBACA,MACO;AAAA,EAAC;AACV;AAEA,MAAM,gCAAgC,4BAA4B;AAAA,EAWjE,YACkB,YACA,YACA,WACA,WAChB;AACD,UAAM;AALW;AACA;AACA;AACA;AAAA,EAGlB;AAAA,EAx3DD,OAs2DkE;AAAA;AAAA;AAAA,EAChD,cAAc,IAAI,aAGhC;AAAA,EAEc,iCAAiC;AAAA,IACjD,KAAK;AAAA,IACL;AAAA,EACD;AAAA,EAWA,IAAW,uBAAgC;AAC1C,WACC;AAAA,MACC,KAAK;AAAA,MACL;AAAA,IACD,MACC,OAAO,KAAK,UAAU,gCAAgC,cACtD,OAAO,KAAK,UAAU,2CACrB;AAAA,EAEJ;AAAA,EAEiB,yCAGb;AAAA,IACH,CAAC,UAAU,4BAA4B,SAAS,GAC/C,4BAA4B;AAAA,IAC7B,CAAC,UAAU,4BAA4B,QAAQ,GAC9C,4BAA4B;AAAA,EAC9B;AAAA,EAEA,MAAe,yBACd,UACA,UACA,SACA,OACqE;AACrE,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,SAAS,MAAM,KAAK,UAAU;AAAA,MACnC;AAAA,MACA;AAAA,MACA;AAAA,QACC,wBAAwB,QAAQ,yBAC7B;AAAA,UACA,OAAO,YAAY,MAAM;AAAA,YACxB,QAAQ,uBAAuB;AAAA,UAChC;AAAA,UACA,MAAM,QAAQ,uBAAuB;AAAA,QACtC,IACC;AAAA,QACH,aACC,KAAK,uCACJ,QAAQ,WACT;AAAA,MACF;AAAA,MACA;AAAA,IACD;AAEA,QAAI,CAAC,QAAQ;AAEZ,aAAO;AAAA,IACR;AAEA,QAAI,MAAM,yBAAyB;AAGlC,aAAO;AAAA,IACR;AAEA,UAAM,mBAAmB,MAAM,QAAQ,MAAM,IAAI,SAAS,OAAO;AACjE,UAAM,WAAW,KAAK,iCACnB,MAAM,QAAQ,MAAM,IACnB,CAAC,IACD,OAAO,YAAY,CAAC,IACrB,CAAC;AACJ,UAAM,yBACL,KAAK,kCAAkC,CAAC,MAAM,QAAQ,MAAM,IACzD,OAAO,yBACP;AAEJ,QAAI;AACJ,UAAM,MAAM,KAAK,YAAY,kBAAkB;AAAA,MAC9C,UAAU;AACT,yBAAiB,QAAQ;AAAA,MAC1B;AAAA,MACA,OAAO;AAAA,IACR,CAAC;AAED,WAAO;AAAA,MACN;AAAA,MACA,OAAO,iBAAiB;AAAA,QACvB,CAAC,MAAM,QAAQ;AACd,cAAI;AACJ,cAAI,KAAK,SAAS;AACjB,gBAAI,CAAC,iBAAiB;AACrB,gCAAkB,IAAI,gBAAgB;AAAA,YACvC;AACA,sBAAU,KAAK,UAAU;AAAA,cACxB,KAAK;AAAA,cACL;AAAA,YACD;AAAA,UACD;AAEA,gBAAM,aAAa,KAAK;AACxB,iBAAO;AAAA,YACN,YACC,OAAO,eAAe,WACnB,aACA,EAAE,SAAS,WAAW,MAAM;AAAA,YAChC,YAAY,KAAK;AAAA,YACjB,OAAO,KAAK,QACT,YAAY,MAAM,KAAK,KAAK,KAAK,IACjC;AAAA,YACH;AAAA,YACA;AAAA,YACA,sBAAsB,KACpB,iCACC,KAAK,uBACL;AAAA,UACJ;AAAA,QACD;AAAA,MACD;AAAA,MACA,UAAU,SAAS,IAAI,CAAC,MAAM;AAC7B,YAAI,CAAC,iBAAiB;AACrB,4BAAkB,IAAI,gBAAgB;AAAA,QACvC;AACA,eAAO,KAAK,UAAU,WAAW,GAAG,eAAe;AAAA,MACpD,CAAC;AAAA,MACD,qBAAqB;AAAA,MACrB;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAe,2BACd,UACA,OACA,SACA,OACqE;AACrE,QAAI,CAAC,KAAK,UAAU,4BAA4B;AAC/C,aAAO;AAAA,IACR;AACA,4BAAwB,KAAK,YAAY,4BAA4B;AAErE,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,IAAI,YAAY,MAAM,GAAG,KAAK;AAEpC,UAAM,SAAS,MAAM,KAAK,UAAU;AAAA,MACnC;AAAA,MACA;AAAA,MACA;AAAA,QACC,wBAAwB,QAAQ,yBAC7B;AAAA,UACA,OAAO,YAAY,MAAM;AAAA,YACxB,QAAQ,uBAAuB;AAAA,UAChC;AAAA,UACA,MAAM,QAAQ,uBAAuB;AAAA,QACtC,IACC;AAAA,QACH,aACC,KAAK,uCACJ,QAAQ,WACT;AAAA,QACD,YAAY,QAAQ;AAAA,MACrB;AAAA,MACA;AAAA,IACD;AAEA,QAAI,CAAC,QAAQ;AAEZ,aAAO;AAAA,IACR;AAEA,QAAI,MAAM,yBAAyB;AAGlC,aAAO;AAAA,IACR;AAEA,UAAM,mBAAmB,MAAM,QAAQ,MAAM,IAAI,SAAS,OAAO;AACjE,UAAM,WAAW,KAAK,iCACnB,MAAM,QAAQ,MAAM,IACnB,CAAC,IACD,OAAO,YAAY,CAAC,IACrB,CAAC;AACJ,UAAM,yBACL,KAAK,kCAAkC,CAAC,MAAM,QAAQ,MAAM,IACzD,OAAO,yBACP;AAEJ,QAAI;AACJ,UAAM,MAAM,KAAK,YAAY,kBAAkB;AAAA,MAC9C,UAAU;AACT,yBAAiB,QAAQ;AAAA,MAC1B;AAAA,MACA,OAAO;AAAA,IACR,CAAC;AAED,WAAO;AAAA,MACN;AAAA,MACA,OAAO,iBAAiB;AAAA,QACvB,CAAC,MAAM,QAAQ;AACd,cAAI;AACJ,cAAI,KAAK,SAAS;AACjB,gBAAI,CAAC,iBAAiB;AACrB,gCAAkB,IAAI,gBAAgB;AAAA,YACvC;AACA,sBAAU,KAAK,UAAU;AAAA,cACxB,KAAK;AAAA,cACL;AAAA,YACD;AAAA,UACD;AAEA,gBAAM,aAAa,KAAK;AACxB,iBAAO;AAAA,YACN,YACC,OAAO,eAAe,WACnB,aACA,EAAE,SAAS,WAAW,MAAM;AAAA,YAChC,YAAY,KAAK;AAAA,YACjB,OAAO,KAAK,QACT,YAAY,MAAM,KAAK,KAAK,KAAK,IACjC;AAAA,YACH;AAAA,YACA;AAAA,YACA,sBAAsB,KACpB,iCACC,KAAK,uBACL;AAAA,UACJ;AAAA,QACD;AAAA,MACD;AAAA,MACA,UAAU,SAAS,IAAI,CAAC,MAAM;AAC7B,YAAI,CAAC,iBAAiB;AACrB,4BAAkB,IAAI,gBAAgB;AAAA,QACvC;AACA,eAAO,KAAK,UAAU,WAAW,GAAG,eAAe;AAAA,MACpD,CAAC;AAAA,MACD,qBAAqB;AAAA,MACrB;AAAA,IACD;AAAA,EACD;AAAA,EAES,mBAAmB,KAAa;AACxC,UAAM,OAAO,KAAK,YAAY,mBAAmB,GAAG;AACpD,UAAM,QAAQ;AAAA,EACf;AAAA,EAES,4BACR,KACA,KACA,mBACO;AACP,UAAM,iBAAiB,KAAK,YAAY,IAAI,GAAG,GAAG,MAAM,GAAG;AAC3D,QAAI,gBAAgB;AACnB,UACC,KAAK,UAAU,+BACf,KAAK,gCACJ;AACD,aAAK,UAAU;AAAA,UACd;AAAA,UACA;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAES,oBACR,KACA,KACA,oBACA,MACO;AACP,UAAM,iBAAiB,KAAK,YAAY,IAAI,GAAG,GAAG,MAAM,GAAG;AAC3D,QAAI,gBAAgB;AACnB,UACC,KAAK,UAAU,0CACf,KAAK,gCACJ;AACD,aAAK,UAAU;AAAA,UACd;AAAA,UACA;AAAA,QACD;AACA,aAAK,UAAU;AAAA,UACd;AAAA,UACA,YAAY,kBAAkB,GAAG,IAAI;AAAA,QACtC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AACD;AAEA,MAAM,kBAAkB;AAAA,EAuFvB,YACC,YACiB,YACA,WACA,WAChB;AAHgB;AACA;AACA;AAAA,EACf;AAAA,EAnvEJ,OAupEwB;AAAA;AAAA;AAAA,EACN,cAAc,IAAI,aAGhC;AAAA,EAEK,yCAGJ;AAAA,IACH,CAAC,UAAU,sBAAsB,SAAS,GACzC,sBAAsB;AAAA,IACvB,CAAC,UAAU,sBAAsB,MAAM,GAAG,sBAAsB;AAAA,EACjE;AAAA,EAEA,MAAM,mBACL,KACA,SACA,OAC8D;AAC9D,UAAM,MAAM,KAAK,WAAW,YAAY,GAAG;AAC3C,UAAM,SAAS,MAAM,KAAK,UAAU;AAAA,MACnC;AAAA,MACA;AAAA,QACC,aACC,KAAK,uCACJ,QAAQ,WACT;AAAA,MACF;AAAA,MACA;AAAA,IACD;AAEA,QAAI,CAAC,QAAQ;AAEZ,aAAO;AAAA,IACR;AAEA,QAAI,MAAM,yBAAyB;AAGlC,aAAO;AAAA,IACR;AACA,QAAI;AACJ,UAAM,MAAM,KAAK,YAAY,kBAAkB;AAAA,MAC9C,UAAU;AACT,yBAAiB,QAAQ;AAAA,MAC1B;AAAA,MACA,MAAM;AAAA,IACP,CAAC;AAED,QAAI;AACJ,QAAI,OAAO,UAAU;AACpB,UAAI,CAAC,iBAAiB;AACrB,0BAAkB,IAAI,gBAAgB;AAAA,MACvC;AACA,sBAAgB,KAAK,UAAU;AAAA,QAC9B,OAAO;AAAA,QACP;AAAA,MACD;AAAA,IACD;AACA,QAAI;AACJ,QAAI,OAAO,UAAU;AACpB,UAAI,CAAC,iBAAiB;AACrB,0BAAkB,IAAI,gBAAgB;AAAA,MACvC;AACA,sBAAgB,KAAK,UAAU;AAAA,QAC9B,OAAO;AAAA,QACP;AAAA,MACD;AAAA,IACD;AAEA,UAAM,aAAqD;AAAA,MAC1D;AAAA,MACA,MAAM,OAAO;AAAA,MACb,OAAO,YAAY,MAAM,KAAK,OAAO,KAAK;AAAA,MAC1C,UAAU;AAAA,MACV,UAAU;AAAA,IACX;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,YAAY,KAAa;AACxB,UAAM,OAAO,KAAK,YAAY,mBAAmB,GAAG;AACpD,UAAM,QAAQ;AAAA,EACf;AAQD;AAEA,MAAM,aAAgB;AAAA,EAtvEtB,OAsvEsB;AAAA;AAAA;AAAA,EACJ,cAAc,oBAAI,IAAe;AAAA,EAC1C,UAAU;AAAA,EAElB,kBAAkB,OAAkB;AACnC,UAAM,KAAK,KAAK;AAChB,SAAK,YAAY,IAAI,IAAI,KAAK;AAC9B,WAAO;AAAA,EACR;AAAA,EAEA,mBAAmB,aAAoC;AACtD,UAAM,QAAQ,KAAK,YAAY,IAAI,WAAW;AAC9C,SAAK,YAAY,OAAO,WAAW;AACnC,WAAO;AAAA,EACR;AAAA,EAEA,IAAI,aAAoC;AACvC,WAAO,KAAK,YAAY,IAAI,WAAW;AAAA,EACxC;AACD;AAEA,MAAM,qBAAqB;AAAA,EAG1B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAjxEJ,OA2wE2B;AAAA;AAAA;AAAA,EACT,SAAS,IAAI,MAA4B,eAAe;AAAA,EAOzE,MAAM,qBACL,UACA,UACA,SACA,OACyD;AACzD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAC5C,UAAM,gBAAgB,KAAK,cAAc,OAAO;AAEhD,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,OAAO;AACV,YAAM,KAAK,KAAK,OAAO,IAAI,CAAC,KAAK,CAAC;AAClC,aAAO,EAAE,GAAG,YAAY,cAAc,KAAK,KAAK,GAAG,GAAG;AAAA,IACvD;AACA,WAAO;AAAA,EACR;AAAA,EAEQ,cACP,SAC8B;AAC9B,QAAI;AACJ,QAAI,QAAQ,qBAAqB;AAChC,YAAM,uBAAuB,YAAY,cAAc;AAAA,QACtD,QAAQ;AAAA,MACT;AACA,YAAM,QAAQ,KAAK,OAAO,IAAI,QAAQ,oBAAoB,IAAI,CAAC;AAC/D,UAAI,OAAO;AACV,8BAAsB;AACtB,4BAAoB,kBACnB,qBAAqB;AACtB,4BAAoB,kBACnB,qBAAqB;AAAA,MACvB,OAAO;AACN,8BAAsB;AAAA,MACvB;AAAA,IACD;AACA,WAAO,EAAE,GAAG,SAAS,oBAAoB;AAAA,EAC1C;AAAA,EAEA,qBAAqB,IAAiB;AACrC,SAAK,OAAO,OAAO,EAAE;AAAA,EACtB;AACD;AAEA,MAAM,kBAAkB;AAAA,EAIvB,YACkB,YACA,WACA,WACA,aACA,YAChB;AALgB;AACA;AACA;AACA;AACA;AAAA,EACf;AAAA,EA/0EJ,OAq0EwB;AAAA;AAAA;AAAA,EACf,SAAS,IAAI,MAAwB,YAAY;AAAA,EACxC,eAAe,oBAAI,IAA6B;AAAA,EAUjE,MAAM,kBACL,UACA,KACA,OACsD;AACtD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,QAAQ,YAAY,MAAM,GAAG,GAAG;AAEtC,UAAM,QAAQ,MAAM,KAAK,UAAU,kBAAkB,KAAK,OAAO,KAAK;AACtE,QAAI,CAAC,MAAM,QAAQ,KAAK,KAAK,MAAM,WAAW,GAAG;AAEhD,WAAK,YAAY;AAAA,QAChB,qCAAqC,KAAK,WAAW,WAAW,KAAK,eAAe,KAAK,UAAU,GAAG,CAAC;AAAA,MACxG;AACA,aAAO;AAAA,IACR;AACA,QAAI,MAAM,yBAAyB;AAGlC,aAAO;AAAA,IACR;AACA,UAAM,MAAM,KAAK,OAAO,IAAI,KAAK;AACjC,SAAK,aAAa,IAAI,KAAK,IAAI,gBAAgB,CAAC;AAChD,UAAM,SAAyC;AAAA,MAC9C,OAAO,CAAC;AAAA,MACR,SAAS;AAAA,IACV;AACA,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,UAAI,KAAK,kBAAkB,MAAM,CAAC,GAAG,KAAK,GAAG;AAC5C,eAAO,MAAM,KAAK,KAAK,kBAAkB,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;AAAA,MAC7D;AAAA,IACD;AACA,SAAK,YAAY;AAAA,MAChB,gBAAgB,OAAO,MAAM,MAAM,sBAAsB,KAAK,WAAW,WAAW,KAAK,eAAe,KAAK,UAAU,GAAG,CAAC;AAAA,IAC5H;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,iBACL,IACA,OACC;AACD,QAAI,OAAO,KAAK,UAAU,qBAAqB,YAAY;AAC1D,aAAO;AAAA,IACR;AACA,UAAM,OAAO,KAAK,OAAO,IAAI,GAAG,EAAE;AAClC,QAAI,CAAC,MAAM;AACV,aAAO;AAAA,IACR;AACA,UAAM,OAAO,MAAM,KAAK,UAAU,iBAAiB,MAAM,KAAK;AAC9D,QAAI,CAAC,MAAM;AACV,aAAO;AAAA,IACR;AACA,QAAI,CAAC,KAAK,kBAAkB,IAAI,GAAG;AAClC,aAAO;AAAA,IACR;AACA,WAAO,KAAK,kBAAkB,MAAM,EAAE;AAAA,EACvC;AAAA,EAEA,aAAa,IAAiB;AAC7B,SAAK,aAAa,IAAI,EAAE,GAAG,QAAQ;AACnC,SAAK,aAAa,OAAO,EAAE;AAC3B,SAAK,OAAO,OAAO,EAAE;AAAA,EACtB;AAAA,EAEQ,kBACP,MACA,OACU;AACV,QACC,KAAK,MAAM,WAAW,KACrB,MAAM,QAAQ,KAAK,KAAK,KACxB,KAAK,MAAM,MAAM,CAAC,SAAS,KAAK,MAAM,WAAW,CAAC,GAClD;AACD,cAAQ,IAAI,mCAAmC,IAAI;AACnD,aAAO;AAAA,IACR;AACA,QAAI,SAAS,CAAC,MAAM,SAAS,KAAK,QAAQ,GAAG;AAE5C,aAAO;AAAA,IACR;AACA,WAAO;AAAA,EACR;AAAA,EAEQ,kBACP,MACA,IACgC;AAChC,UAAM,cAAc,KAAK,aAAa,IAAI,GAAG,CAAC,CAAC;AAC/C,QAAI,CAAC,aAAa;AACjB,YAAM,MAAM,+BAA+B;AAAA,IAC5C;AAEA,UAAM,SAAwC;AAAA,MAC7C,OAAO;AAAA;AAAA,MACP,SAAS;AAAA,MACT,SAAS,YAAY,eAAe,WAAW,KAAK,OAAO;AAAA,MAC3D,UAAU,YAAY,SAAS,KAAK,KAAK,QAAQ;AAAA,MACjD,WACC,KAAK,aAAa,KAAK,UAAU,IAAI,YAAY,SAAS,IAAI;AAAA,MAC/D,MAAM,KAAK,QAAQ,YAAY,cAAc,KAAK,KAAK,IAAI;AAAA,MAC3D,aAAa,KAAK;AAAA,MAClB,cAAc,KAAK;AAAA,IACpB;AAEA,QAAI,OAAO,KAAK,UAAU,UAAU;AACnC,aAAO,QAAQ,KAAK;AAAA,IACrB,OAAO;AACN,YAAM,QAAwC,CAAC;AAC/C,aAAO,QAAQ;AAEf,iBAAW,QAAQ,KAAK,OAAO;AAC9B,YAAI,CAAC,KAAK,OAAO;AAChB,kBAAQ;AAAA,YACP;AAAA,YACA,KAAK,WAAW,WAAW;AAAA,UAC5B;AACA;AAAA,QACD;AACA,cAAM,QAAsC;AAAA,UAC3C,OAAO,KAAK;AAAA,UACZ,SAAS,YAAY,eAAe;AAAA,YACnC,KAAK;AAAA,UACN;AAAA,QACD;AACA,YAAI,SAAS,WAAW,KAAK,QAAQ,GAAG;AACvC,gBAAM,WAAW,YAAY,SAAS,KAAK,KAAK,QAAQ;AAAA,QACzD;AACA,YAAI,KAAK,SAAS;AACjB,gBAAM,UAAU,KAAK,UAAU;AAAA,YAC9B,KAAK;AAAA,YACL;AAAA,UACD;AAAA,QACD;AACA,cAAM,KAAK,KAAK;AAAA,MACjB;AAAA,IACD;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,oBAAoB;AAAA,EAGzB,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAp+EJ,OA89E0B;AAAA;AAAA;AAAA,EACjB,SAAS,IAAI,MAA2B,cAAc;AAAA,EAO9D,MAAM,aACL,UACA,OACqD;AACrD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAEhD,UAAM,QAAQ,MAAM,KAAK,UAAU,qBAAqB,KAAK,KAAK;AAClE,QAAI,CAAC,MAAM,QAAQ,KAAK,KAAK,MAAM,WAAW,GAAG;AAEhD,aAAO;AAAA,IACR;AACA,QAAI,MAAM,yBAAyB;AAGlC,aAAO;AAAA,IACR;AACA,QAAI,OAAO,KAAK,UAAU,wBAAwB,YAAY;AAE7D,aAAO;AAAA,QACN,OAAO,MACL,OAAO,oBAAoB,aAAa,EACxC,IAAI,YAAY,aAAa,IAAI;AAAA,MACpC;AAAA,IACD,OAAO;AAEN,YAAM,MAAM,KAAK,OAAO,IAAI,KAAK;AACjC,YAAM,SAAwC;AAAA,QAC7C,OAAO,CAAC;AAAA,QACR,SAAS;AAAA,MACV;AACA,eAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACtC,YAAI,CAAC,oBAAoB,cAAc,MAAM,CAAC,CAAC,GAAG;AACjD;AAAA,QACD;AAEA,cAAM,MACL,YAAY,aAAa,KAAK,MAAM,CAAC,CAAC;AACvC,YAAI,UAAU,CAAC,KAAK,CAAC;AACrB,eAAO,MAAM,KAAK,GAAG;AAAA,MACtB;AACA,aAAO;AAAA,IACR;AAAA,EACD;AAAA,EAEA,OAAe,cAAc,MAAoC;AAChE,QAAI,KAAK,UAAU,KAAK,OAAO,KAAK,SAAS,KAAQ;AACpD,cAAQ,KAAK,sCAAsC;AACnD,aAAO;AAAA,IACR;AACA,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,YACL,IACA,OACgD;AAChD,QAAI,OAAO,KAAK,UAAU,wBAAwB,YAAY;AAC7D,aAAO;AAAA,IACR;AACA,UAAM,OAAO,KAAK,OAAO,IAAI,GAAG,EAAE;AAClC,QAAI,CAAC,MAAM;AACV,aAAO;AAAA,IACR;AACA,UAAM,OAAO,MAAM,KAAK,UAAU,oBAAoB,MAAM,KAAK;AACjE,QAAI,CAAC,QAAQ,CAAC,oBAAoB,cAAc,IAAI,GAAG;AACtD,aAAO;AAAA,IACR;AACA,WAAO,YAAY,aAAa,KAAK,IAAI;AAAA,EAC1C;AAAA,EAEA,aAAa,IAAiB;AAC7B,SAAK,OAAO,OAAO,EAAE;AAAA,EACtB;AACD;AAEA,MAAM,qBAAqB;AAAA,EAC1B,YACS,YACA,WACP;AAFO;AACA;AAAA,EACN;AAAA,EArjFJ,OAijF2B;AAAA;AAAA;AAAA,EAM1B,MAAM,cACL,UACA,OAC2C;AAC3C,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,SAAS,MAAM,KAAK,UAAU,sBAAsB,KAAK,KAAK;AACpE,QAAI,CAAC,MAAM,QAAQ,MAAM,GAAG;AAC3B,aAAO,CAAC;AAAA,IACT;AACA,UAAM,aAA8C,OAAO,IAAI,CAAC,OAAO;AACtE,aAAO;AAAA,QACN,OAAO,YAAY,MAAM,KAAK,GAAG,KAAK;AAAA,QACtC,OAAO,YAAY,MAAM,KAAK,GAAG,KAAK;AAAA,MACvC;AAAA,IACD,CAAC;AACD,WAAO;AAAA,EACR;AAAA,EAEA,MAAM,0BACL,UACA,KACA,OACsD;AACtD,UAAM,WAAW,KAAK,WAAW,YAAY,QAAQ;AACrD,UAAM,QAAQ,YAAY,MAAM,GAAG,IAAI,KAAK;AAC5C,UAAM,QAAQ,YAAY,MAAM,GAAG,IAAI,KAAK;AAC5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA,EAAE,UAAU,MAAM;AAAA,MAClB;AAAA,IACD;AACA,QAAI,CAAC,MAAM,QAAQ,KAAK,GAAG;AAC1B,aAAO;AAAA,IACR;AACA,WAAO,MAAM,IAAI,YAAY,kBAAkB,IAAI;AAAA,EACpD;AACD;AAEA,MAAM,uBAAuB;AAAA,EAC5B,YACS,YACA,WACP;AAFO;AACA;AAAA,EACN;AAAA,EAjmFJ,OA6lF6B;AAAA;AAAA;AAAA,EAM5B,MAAM,qBACL,UACA,SACA,OACgD;AAChD,UAAM,MAAM,KAAK,WAAW,YAAY,QAAQ;AAChD,UAAM,SAAS,MAAM,KAAK,UAAU;AAAA,MACnC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,MAAM,QAAQ,MAAM,GAAG;AAC3B,aAAO;AAAA,IACR;AACA,WAAO,OAAO,IAAI,YAAY,aAAa,IAAI;AAAA,EAChD;AACD;AAEA,MAAM,sBAAsB;AAAA,EAC3B,YACkB,YACA,WACA,aAChB;AAHgB;AACA;AACA;AAAA,EACf;AAAA,EA1nFJ,OAqnF4B;AAAA;AAAA;AAAA,EAO3B,MAAM,uBACL,UACA,KACA,OACwC;AACxC,UAAM,WAAW,KAAK,WAAW,YAAY,QAAQ;AACrD,UAAM,YAAY,IAAI,IAAI,YAAY,SAAS,EAAE;AAEjD,UAAM,oBAAoB,MAAM,KAAK,UAAU;AAAA,MAC9C;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,gBAAgB,iBAAiB,GAAG;AACxC,aAAO,CAAC;AAAA,IACT;AACA,QAAI,kBAAkB,WAAW,UAAU,QAAQ;AAClD,WAAK,YAAY;AAAA,QAChB;AAAA,MACD;AACA,aAAO,CAAC;AAAA,IACT;AACA,UAAM,aAA2C,CAAC;AAClD,aAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AAC1C,YAAM,YAAwC,CAAC;AAC/C,iBAAW,KAAK,SAAS;AAEzB,UAAI,OAAuC,UAAU,CAAC;AACtD,UAAI,iBAAiB,kBAAkB,CAAC;AAExC,aAAO,MAAM;AACZ,YAAI,CAAC,eAAe,MAAM,SAAS,IAAI,GAAG;AACzC,gBAAM,IAAI;AAAA,YACT;AAAA,UACD;AAAA,QACD;AACA,kBAAU,KAAK,YAAY,eAAe,KAAK,cAAc,CAAC;AAC9D,YAAI,CAAC,eAAe,QAAQ;AAC3B;AAAA,QACD;AACA,eAAO,eAAe;AACtB,yBAAiB,eAAe;AAAA,MACjC;AAAA,IACD;AACA,WAAO;AAAA,EACR;AACD;AAEA,MAAM,qBAAqB;AAAA,EAO1B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EAtrFJ,OA4qF2B;AAAA;AAAA;AAAA,EACT,UAAU,IAAI,YAAY,EAAE;AAAA,EAC5B,SAAS,oBAAI,IAG5B;AAAA,EAOF,MAAM,eACL,KACA,UACA,OAC+D;AAC/D,UAAM,MAAM,KAAK,WAAW,YAAY,GAAG;AAC3C,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AAEA,UAAM,YAAY,KAAK,QAAQ,OAAO;AACtC,SAAK,OAAO,IAAI,WAAW,oBAAI,IAAI,CAAC;AAEpC,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM;AAAA,QAAI,CAAC,SACjB,KAAK,qBAAqB,WAAW,IAAI;AAAA,MAC1C;AAAA,IACD,OAAO;AACN,aAAO,CAAC,KAAK,qBAAqB,WAAW,KAAK,CAAC;AAAA,IACpD;AAAA,EACD;AAAA,EAEA,MAAM,eACL,WACA,QACA,OAC0D;AAC1D,UAAM,OAAO,KAAK,eAAe,WAAW,MAAM;AAClD,QAAI,CAAC,MAAM;AACV,YAAM,IAAI,MAAM,6BAA6B;AAAA,IAC9C;AACA,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AACA,WAAO,MAAM,IAAI,CAAC,SAAS;AAC1B,aAAO;AAAA,QACN,MAAM,KAAK,qBAAqB,WAAW,KAAK,IAAI;AAAA,QACpD,YAAY,KAAK,WAAW;AAAA,UAAI,CAAC,MAChC,YAAY,MAAM,KAAK,CAAC;AAAA,QACzB;AAAA,MACD;AAAA,IACD,CAAC;AAAA,EACF;AAAA,EAEA,MAAM,iBACL,WACA,QACA,OAC0D;AAC1D,UAAM,OAAO,KAAK,eAAe,WAAW,MAAM;AAClD,QAAI,CAAC,MAAM;AACV,YAAM,IAAI,MAAM,6BAA6B;AAAA,IAC9C;AACA,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AACA,WAAO,MAAM,IAAI,CAAC,SAAS;AAC1B,aAAO;AAAA,QACN,IAAI,KAAK,qBAAqB,WAAW,KAAK,EAAE;AAAA,QAChD,YAAY,KAAK,WAAW;AAAA,UAAI,CAAC,MAChC,YAAY,MAAM,KAAK,CAAC;AAAA,QACzB;AAAA,MACD;AAAA,IACD,CAAC;AAAA,EACF;AAAA,EAEA,eAAe,WAAyB;AACvC,SAAK,OAAO,OAAO,SAAS;AAAA,EAC7B;AAAA,EAEQ,qBACP,WACA,MACwC;AACxC,UAAM,MAAM,KAAK,OAAO,IAAI,SAAS;AACrC,UAAM,MAAM,YAAY,kBAAkB;AAAA,MACzC;AAAA,MACA;AAAA,MACA,IAAI,KAAK,SAAS,EAAE;AAAA,IACrB;AACA,QAAI,IAAI,IAAI,SAAS,IAAI;AACzB,WAAO;AAAA,EACR;AAAA,EAEQ,eACP,WACA,QACuC;AACvC,UAAM,MAAM,KAAK,OAAO,IAAI,SAAS;AACrC,WAAO,KAAK,IAAI,MAAM;AAAA,EACvB;AACD;AAEA,MAAM,qBAAqB;AAAA,EAO1B,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA9yFJ,OAoyF2B;AAAA;AAAA;AAAA,EACT,UAAU,IAAI,YAAY,EAAE;AAAA,EAC5B,SAAS,oBAAI,IAG5B;AAAA,EAOF,MAAM,eACL,KACA,UACA,OAC+D;AAC/D,UAAM,MAAM,KAAK,WAAW,YAAY,GAAG;AAC3C,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAE5C,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AAEA,UAAM,YAAY,KAAK,QAAQ,OAAO;AACtC,SAAK,OAAO,IAAI,WAAW,oBAAI,IAAI,CAAC;AAEpC,QAAI,MAAM,QAAQ,KAAK,GAAG;AACzB,aAAO,MAAM;AAAA,QAAI,CAAC,SACjB,KAAK,qBAAqB,WAAW,IAAI;AAAA,MAC1C;AAAA,IACD,OAAO;AACN,aAAO,CAAC,KAAK,qBAAqB,WAAW,KAAK,CAAC;AAAA,IACpD;AAAA,EACD;AAAA,EAEA,MAAM,kBACL,WACA,QACA,OAC+D;AAC/D,UAAM,OAAO,KAAK,eAAe,WAAW,MAAM;AAClD,QAAI,CAAC,MAAM;AACV,YAAM,IAAI,MAAM,6BAA6B;AAAA,IAC9C;AACA,UAAM,aAAa,MAAM,KAAK,UAAU;AAAA,MACvC;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,YAAY;AAChB,aAAO;AAAA,IACR;AACA,WAAO,WAAW,IAAI,CAAC,cAAc;AACpC,aAAO,KAAK,qBAAqB,WAAW,SAAS;AAAA,IACtD,CAAC;AAAA,EACF;AAAA,EAEA,MAAM,gBACL,WACA,QACA,OAC+D;AAC/D,UAAM,OAAO,KAAK,eAAe,WAAW,MAAM;AAClD,QAAI,CAAC,MAAM;AACV,YAAM,IAAI,MAAM,6BAA6B;AAAA,IAC9C;AACA,UAAM,WAAW,MAAM,KAAK,UAAU;AAAA,MACrC;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,UAAU;AACd,aAAO;AAAA,IACR;AACA,WAAO,SAAS,IAAI,CAAC,YAAY;AAChC,aAAO,KAAK,qBAAqB,WAAW,OAAO;AAAA,IACpD,CAAC;AAAA,EACF;AAAA,EAEA,eAAe,WAAyB;AACvC,SAAK,OAAO,OAAO,SAAS;AAAA,EAC7B;AAAA,EAEQ,qBACP,WACA,MACwC;AACxC,UAAM,MAAM,KAAK,OAAO,IAAI,SAAS;AACrC,UAAM,MAAM,YAAY,kBAAkB;AAAA,MACzC;AAAA,MACA;AAAA,MACA,IAAI,KAAK,SAAS,EAAE;AAAA,IACrB;AACA,QAAI,IAAI,IAAI,SAAS,IAAI;AACzB,WAAO;AAAA,EACR;AAAA,EAEQ,eACP,WACA,QACuC;AACvC,UAAM,MAAM,KAAK,OAAO,IAAI,SAAS;AACrC,WAAO,KAAK,IAAI,MAAM;AAAA,EACvB;AACD;AAEA,MAAM,wBAAwB;AAAA,EAK7B,YACkB,QACA,YACA,WACA,SACA,YAChB;AALgB;AACA;AACA;AACA;AACA;AAAA,EACf;AAAA,EA75FJ,OAk5F8B;AAAA;AAAA;AAAA,EACZ,SAAS,IAAI;AAAA,IAC7B;AAAA,EACD;AAAA,EAUA,MAAM,2BACL,WACA,KACA,UACA,iBACA,OAC8D;AAC9D,UAAM,MAAM,KAAK,WAAW,YAAY,GAAG;AAC3C,UAAM,MAAM,YAAY,SAAS,GAAG,QAAQ;AAC5C,UAAM,eAAe,YAAY,aAAa;AAAA,MAC7C;AAAA,MACA,OAAO,OAAO;AACb,gBACC,MAAM,KAAK,OAAO;AAAA,UACjB,KAAK;AAAA,UACL;AAAA,UACA;AAAA,QACD,GACC;AAAA,MACH;AAAA,IACD;AAEA,UAAM,QAAQ,MAAM,KAAK,UAAU;AAAA,MAClC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,QAAI,CAAC,OAAO;AACX,aAAO;AAAA,IACR;AAEA,UAAM,aAAa,QAAQ,KAAK;AAChC,UAAM,UAAU,KAAK,OAAO,IAAI,UAAU;AAE1C,WAAO,WAAW;AAAA,MACjB,CAAC,MAAM,OAA6C;AAAA,QACnD,UAAU,CAAC,SAAS,CAAC;AAAA,QACrB,OACC,KAAK,SACL;AAAA,UACC;AAAA,UACA;AAAA,UACA,KAAK,WAAW,eAAe,KAAK,WAAW;AAAA,QAChD;AAAA,QACD,MAAM,KAAK,MAAM;AAAA,QACjB,SAAS,KAAK,SAAS,IAAI,CAAC,MAAM,EAAE,KAAK;AAAA,QACzC,YACC,OAAO,KAAK,eAAe,WACxB,KAAK,aACL,EAAE,SAAS,KAAK,WAAW,MAAM;AAAA,QACrC,gBAAgB,KAAK,iBAClB,YAAY,cAAc;AAAA,UAC1B,KAAK;AAAA,UACL;AAAA,QACD,IACC;AAAA,MACJ;AAAA,IACD;AAAA,EACD;AAAA,EAEA,MAAM,gBACL,IACA,OACkE;AAClE,UAAM,CAAC,WAAW,MAAM,IAAI;AAC5B,UAAM,OAAO,KAAK,OAAO,IAAI,WAAW,MAAM;AAC9C,QAAI,CAAC,QAAQ,CAAC,KAAK,UAAU,yBAAyB;AACrD,aAAO,CAAC;AAAA,IACT;AAEA,UAAM,eACJ,MAAM,KAAK,UAAU,wBAAwB,MAAM,KAAK,KAAM;AAChE,UAAM,iBAAiB,aAAa,iBACjC,YAAY,cAAc;AAAA,MAC1B,aAAa;AAAA,MACb;AAAA,IACD,IACC;AACH,WAAO,EAAE,eAAe;AAAA,EACzB;AAAA,EAEA,iBAAiB,IAAiB;AACjC,SAAK,OAAO,OAAO,EAAE;AAAA,EACtB;AACD;AAEA,MAAM,mBAAmB;AAAA,EACxB,YACkB,YACA,WAChB;AAFgB;AACA;AAAA,EACf;AAAA,EA1/FJ,OAs/FyB;AAAA;AAAA;AAAA,EAMxB,MAAM,mBACL,UACA,YACA,SACA,OACoD;AACpD,UAAM,MAAM,IAAI,OAAO,QAAQ;AAC/B,UAAM,MAAM,KAAK,WAAW,YAAY,GAAG;AAE3C,UAAM,oBAAoB,wBACzB,UAEC;AAAA,MACA,KAAK,IAAI,OAAO,KAAK,GAAG;AAAA,MACxB,SAAS,KAAK;AAAA,MACd,QAAQ,KAAK,OAAO,IAAI,CAAC,MAAM,YAAY,MAAM,GAAG,CAAC,CAAC;AAAA,IACvD,IAPyB;AAS1B,UAAM,cAAc,QAAQ,UAAU;AAAA,MAAI,CAAC,gBAC1C,YAAY,IAAI,iBAAiB;AAAA,IAClC;AAEA,UAAM,MAAM;AAAA,MACX,WAAW;AAAA,MACX,YAAY,YAAY,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;AAAA;AAAA,MAC5C,cAAc,QAAQ,cAAc,IAAI,CAAC,MAAM;AAC9C,YAAI,EAAE,SAAS,YAAY;AAC1B,iBAAO;AAAA,YACN,MAAM;AAAA,YACN,SAAS,EAAE;AAAA,YACX,YAAY,EAAE,YAAY,IAAI,iBAAiB;AAAA,UAChD;AAAA,QACD,OAAO;AACN,iBAAO;AAAA,YACN,MAAM;AAAA,YACN,SAAS,EAAE;AAAA,UACZ;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAEA,UAAM,cAAc,MAAM,KAAK,UAAU;AAAA,MACxC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAEA,WAAO,cAAc,YAAY,cAAc,KAAK,WAAW,IAAI;AAAA,EACpE;AACD;AAwCA,MAAM,YAAY;AAAA,EACjB,YACU,SACA,WACR;AAFQ;AACA;AAAA,EACP;AAAA,EA1lGJ,OAslGkB;AAAA;AAAA;AAKlB;AAEO,MAAM,wBAEb;AAAA,EAMC,YACC,aACiB,iBACA,YACA,WACA,cACA,aACA,iBACA,qBAChB;AAPgB;AACA;AACA;AACA;AACA;AACA;AACA;AAEjB,SAAK,SAAS,YAAY;AAAA,MACzB,gBAAgB,YAAY;AAAA,IAC7B;AAAA,EACD;AAAA,EAlnGD,OA+lGA;AAAA;AAAA;AAAA,EACC,OAAe,cAAc;AAAA,EAEZ;AAAA,EACA,WAAW,oBAAI,IAAyB;AAAA,EAiBjD,2BACP,UACA,WAC4C;AAC5C,WAAO,YAAY,iBAAiB;AAAA,MACnC;AAAA,MACA,KAAK;AAAA,MACL;AAAA,IACD;AAAA,EACD;AAAA,EAEQ,kBAAkB,QAA4B;AACrD,WAAO,IAAI,WAAW,MAAM;AAC3B,WAAK,SAAS,OAAO,MAAM;AAC3B,WAAK,OAAO,YAAY,MAAM;AAAA,IAC/B,CAAC;AAAA,EACF;AAAA,EAEQ,cAAsB;AAC7B,WAAO,wBAAwB;AAAA,EAChC;AAAA,EAEA,MAAc,aACb,QACA,MACA,UACA,eACA,oBACA,WAAW,OACE;AACb,UAAM,OAAO,KAAK,SAAS,IAAI,MAAM;AACrC,QAAI,CAAC,QAAQ,EAAE,KAAK,mBAAmB,OAAO;AAC7C,aAAO;AAAA,IACR;AAEA,UAAM,KAAa,KAAK,IAAI;AAC5B,QAAI,CAAC,UAAU;AACd,WAAK,YAAY;AAAA,QAChB,IAAI,KAAK,UAAU,WAAW,KAAK,sBAAsB,SAAS,SAAS,EAAE,QAAQ,WAAW,EAAE,CAAC;AAAA,MACpG;AAAA,IACD;AAEA,UAAM,SAAS,SAAS,KAAK,SAAS,KAAK,SAAS;AAGpD,YAAQ,QAAQ,MAAM,EACpB,MAAM,CAAC,QAAQ;AACf,UAAI,CAAC,oBAAoB,GAAG,GAAG;AAC9B,aAAK,YAAY;AAAA,UAChB,IAAI,KAAK,UAAU,WAAW,KAAK;AAAA,QACpC;AACA,aAAK,YAAY,MAAM,GAAG;AAE1B,aAAK,oBAAoB;AAAA,UACxB,KAAK,UAAU;AAAA,UACf;AAAA,QACD;AAAA,MACD;AAAA,IACD,CAAC,EACA,QAAQ,MAAM;AACd,UAAI,CAAC,UAAU;AACd,aAAK,YAAY;AAAA,UAChB,IAAI,KAAK,UAAU,WAAW,KAAK,yBAAyB,KAAK,IAAI,IAAI,EAAE;AAAA,QAC5E;AAAA,MACD;AAAA,IACD,CAAC;AAEF,QAAI,kBAAkB,oBAAoB,kBAAkB,GAAG;AAC9D,aAAO,sBAAsB,QAAQ,kBAAkB;AAAA,IACxD;AACA,WAAO;AAAA,EACR;AAAA,EAEQ,eACP,SACA,WACS;AACT,UAAM,SAAS,KAAK,YAAY;AAChC,SAAK,SAAS,IAAI,QAAQ,IAAI,YAAY,SAAS,SAAS,CAAC;AAC7D,WAAO;AAAA,EACR;AAAA,EAEA,OAAe,UAAU,KAAoC;AAC5D,WAAO,IAAI,eAAe,IAAI;AAAA,EAC/B;AAAA,EAEA,OAAe,OAAO,KAAoC;AACzD,WAAO,IAAI,WAAW;AAAA,EACvB;AAAA;AAAA,EAIA,+BACC,WACA,UACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,sBAAsB,KAAK,YAAY,QAAQ;AAAA,MACnD;AAAA,IACD;AACA,UAAM,cACJ,YAAY,SAAS,SACtB,wBAAwB,UAAU,SAAS;AAC5C,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,IACD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,wBACC,QACA,UACA,OACkD;AAClD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ,uBAAuB,IAAI,OAAO,QAAQ,GAAG,KAAK;AAAA,MAC3D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,yBACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK,YAAY;AAChC,UAAM,cACL,OAAO,SAAS,0BAA0B,aACvC,KAAK,YAAY,IACjB;AAEJ,SAAK,SAAS;AAAA,MACb;AAAA,MACA,IAAI;AAAA,QACH,IAAI;AAAA,UACH,KAAK;AAAA,UACL,KAAK,UAAU;AAAA,UACf;AAAA,UACA;AAAA,UACA,KAAK;AAAA,UACL,KAAK;AAAA,QACN;AAAA,QACA;AAAA,MACD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,IACD;AACA,QAAI,SAAS,KAAK,kBAAkB,MAAM;AAE1C,QAAI,gBAAgB,QAAW;AAC9B,YAAM,eAAe,SAAS;AAAA,QAAuB,CAAC,MACrD,KAAK,OAAO,mBAAmB,WAAW;AAAA,MAC3C;AACA,eAAS,WAAW,KAAK,QAAQ,YAAY;AAAA,IAC9C;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,mBACC,QACA,UACA,OACwD;AACxD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,kBAAkB,IAAI,OAAO,QAAQ,GAAG,KAAK;AAAA,MAClE;AAAA,MACA;AAAA,MACA,SAAS,WAAW;AAAA,IACrB;AAAA,EACD;AAAA,EAEA,iBACC,QACA,QACA,OACoD;AACpD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,gBAAgB,QAAQ,KAAK;AAAA,MAClD;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,mBAAmB,QAAgB,SAAuB;AACzD,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,QAAQ,QAAQ,kBAAkB,OAAO,CAAC;AAAA,MAC/D;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,2BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,kBAAkB,KAAK,YAAY,QAAQ;AAAA,MAC/C;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,mBACC,QACA,UACA,UACA,OACoC;AACpC,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,4BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,mBAAmB,KAAK,YAAY,QAAQ;AAAA,MAChD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,oBACC,QACA,UACA,UACA,OACoC;AACpC,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,+BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,sBAAsB,KAAK,YAAY,QAAQ;AAAA,MACnD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,uBACC,QACA,UACA,UACA,OACoC;AACpC,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,+BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,sBAAsB,KAAK,YAAY,QAAQ;AAAA,MACnD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,uBACC,QACA,UACA,UACA,OACoC;AACpC,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,sBACC,WACA,UACA,UACA,aACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,aAAa,KAAK,YAAY,QAAQ;AAAA,MAC1C;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,cACC,QACA,UACA,UACA,SACA,OACmD;AACnD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,cAAc,QAAgB,IAAkB;AAC/C,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,QAAQ,QAAQ,aAAa,EAAE,CAAC;AAAA,MACrD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,sCACC,WACA,UACA,UACA,aACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,6BAA6B,KAAK,YAAY,QAAQ;AAAA,MAC1D;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,8BACC,QACA,UACA,UACA,OACuD;AACvD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,6BACC,WACA,UACA,UACA,aACoB;AACpB,UAAM,cACL,OAAO,SAAS,4BAA4B,aACzC,KAAK,YAAY,IACjB;AACJ,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,oBAAoB,KAAK,YAAY,QAAQ;AAAA,MACjD;AAAA,IACD;AAEA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,IACD;AACA,QAAI,SAAS,KAAK,kBAAkB,MAAM;AAE1C,QAAI,gBAAgB,QAAW;AAC9B,YAAM,eAAe,SAAS;AAAA,QAAyB,CAAC,MACvD,KAAK,OAAO,uBAAuB,WAAW;AAAA,MAC/C;AACA,eAAS,WAAW,KAAK,QAAQ,YAAY;AAAA,IAC9C;AACA,WAAO;AAAA,EACR;AAAA,EAEA,qBACC,QACA,UACA,OACA,SACA,OAC+C;AAC/C,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,kCACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,yBAAyB,KAAK,YAAY,QAAQ;AAAA,MACtD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,uCACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,8BAA8B,KAAK,YAAY,QAAQ;AAAA,MAC3D;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,2BACC,QACA,UACA,UACA,OACqD;AACrD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,gCACC,QACA,UACA,UACA,aACA,OAC0D;AAC1D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA,YAAY,IAAI,CAAC,UAAU,IAAI,OAAO,KAAK,CAAC;AAAA,QAC5C;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,mCACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,0BAA0B,KAAK,YAAY,QAAQ;AAAA,MACvD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,4BACC,QACA,UACA,UACA,OAC+D;AAC/D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,OAAO,YAAY;AAClB,cAAM,MAAM,MAAM,QAAQ;AAAA,UACzB,IAAI,OAAO,QAAQ;AAAA,UACnB;AAAA,UACA;AAAA,QACD;AACA,YAAI,KAAK;AACR,iBAAO;AAAA,YACN,QAAQ,IAAI;AAAA,YACZ,aAAa,IAAI,cACd,wBAAwB;AAAA,cACxB,IAAI;AAAA,YACL,IACC;AAAA,UACJ;AAAA,QACD;AACA,eAAO;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,0BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,iBAAiB,KAAK,YAAY,QAAQ;AAAA,MAC9C;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,mBACC,QACA,UACA,UACA,SACA,OAC4C;AAC5C,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,2BACC,WACA,UACA,UACA,UACoB;AACpB,UAAM,QAAQ,IAAI,gBAAgB;AAClC,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI;AAAA,QACH,KAAK;AAAA,QACL,KAAK,UAAU;AAAA,QACf,KAAK;AAAA,QACL;AAAA,QACA,KAAK;AAAA,QACL;AAAA,QACA,KAAK;AAAA,MACN;AAAA,MACA;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,QACC,eAAe,UAAU,yBAAyB;AAAA,UACjD,CAAC,SAAS,KAAK;AAAA,QAChB;AAAA,QACA,eAAe,UAAU,eAAe,IAAI,CAAC,OAAO;AAAA,UACnD,MAAM,EAAE,KAAK;AAAA,UACb,SAAS,KAAK,UAAU,UAAU;AAAA,YACjC,EAAE;AAAA,YACF;AAAA,UACD;AAAA,QACD,EAAE;AAAA,MACH;AAAA,MACA,wBAAwB,UAAU,SAAS;AAAA,MAC3C,wBAAwB,OAAO,SAAS;AAAA,MACxC,QAAQ,SAAS,iBAAiB;AAAA,IACnC;AACA,UAAM,IAAI,KAAK,kBAAkB,MAAM,CAAC;AACxC,WAAO;AAAA,EACR;AAAA,EAEA,oBACC,QACA,UACA,kBACA,SACA,OAC0D;AAC1D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,mBACC,QACA,IACA,OAIE;AACF,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,kBAAkB,IAAI,KAAK;AAAA,MAChD,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,oBAAoB,QAAgB,SAAuB;AAC1D,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,QAAQ,QAAQ,mBAAmB,OAAO,CAAC;AAAA,MAChE;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,uCACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,0BAA0B,KAAK,YAAY,QAAQ;AAAA,MACvD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,UAAU;AAAA,MACV,UAAU,eAAe,UAAU;AAAA,IACpC;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,gCACC,QACA,UACA,SACA,OAC8C;AAC9C,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,4CACC,WACA,UACA,UACoB;AACpB,UAAM,0BACL,OAAO,SAAS,yCAAyC;AAC1D,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,uBAAuB,KAAK,YAAY,QAAQ;AAAA,MACpD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,UAAU;AAAA,MACV,UAAU,eAAe,UAAU;AAAA,MACnC;AAAA,IACD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,qCACC,QACA,UACA,OACA,SACA,OAC8C;AAC9C,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,sCACC,QACA,UACA,QACA,SACA,OAC8C;AAC9C,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,qCACC,WACA,UACA,UACA,mBACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,wBAAwB,KAAK,YAAY,QAAQ;AAAA,MACrD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,MACA,UAAU;AAAA,IACX;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,8BACC,QACA,UACA,UACA,IACA,SACA,OAC8C;AAC9C,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,gCACC,WACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,oBAAoB,UAAU,KAAK,WAAW;AAAA,MAClD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,OAAO,SAAS,2BAA2B;AAAA,IAC5C;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,yBACC,QACA,QACA,OACgD;AAChD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,wBAAwB,QAAQ,KAAK;AAAA,MAC1D,EAAE,SAAS,CAAC,EAAE;AAAA,MACd;AAAA,IACD;AAAA,EACD;AAAA,EAEA,wBACC,QACA,QACA,OAC2D;AAC3D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,uBAAuB,QAAQ,KAAK;AAAA,MACzD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,yBAAyB,QAAgB,IAAkB;AAC1D,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,wBAAwB,EAAE;AAAA,MAC/C;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,uBACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,cAAc,KAAK,YAAY,UAAU,KAAK,WAAW;AAAA,MAC7D;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,cAAc,kBAAkB,QAAQ;AAAA,IACzC;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,oBACC,QACA,UACA,UACA,SACA,OACyD;AACzD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,uBACC,QACA,UACA,UACA,OACgD;AAChD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,+BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI;AAAA,QACH,KAAK;AAAA,QACL;AAAA,QACA,KAAK;AAAA,MACN;AAAA,MACA;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,4CACC,QAC+B;AAC/B,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,2CAA2C;AAAA,MAChE;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,uBACC,QACA,UACA,OACA,aACA,OACiD;AACjD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,uCACC,WACA,UACA,UACA,QACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,8BAA8B,KAAK,YAAY,QAAQ;AAAA,MAC3D;AAAA,IACD;AACA,UAAM,cACL,OAAO,SAAS,8BAA8B,aAC3C,KAAK,YAAY,IACjB;AACJ,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,MACA;AAAA,IACD;AACA,QAAI,SAAS,KAAK,kBAAkB,MAAM;AAE1C,QAAI,aAAa;AAChB,YAAM,eAAe,SAAS;AAAA,QAA2B,CAAC,MACzD,KAAK,OAAO,iCAAiC,WAAW;AAAA,MACzD;AACA,eAAS,WAAW,KAAK,QAAQ,YAAY;AAAA,IAC9C;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,+BACC,QACA,UACA,kBACA,OAC2B;AAC3B,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,+BACC,QACA,0BACO;AACP,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,4CACC,WACA,UACA,UACA,QACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,mCAAmC,KAAK,YAAY,QAAQ;AAAA,MAChE;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,IACD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,oCACC,QACA,UACA,OACA,OAC2B;AAC3B,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA;AAAA,EAMA,+BACC,WACA,UACA,UACA,mBACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI;AAAA,QACH,KAAK;AAAA,QACL,KAAK,UAAU;AAAA,QACf;AAAA,QACA,KAAK;AAAA,QACL;AAAA,MACD;AAAA,MACA;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,MACA,mBAAmB,kBAAkB,QAAQ;AAAA,MAC7C,UAAU;AAAA,IACX;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,wBACC,QACA,UACA,UACA,SACA,OACyD;AACzD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,uBACC,QACA,IACA,OACuD;AACvD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,sBAAsB,IAAI,KAAK;AAAA,MACpD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,wBAAwB,QAAgB,IAAkB;AACzD,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,uBAAuB,EAAE;AAAA,MAC9C;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,kCACC,WACA,UACA,UACA,UACoB;AACpB,UAAM,UAAU,IAAI;AAAA,MACnB;AAAA,MACA,KAAK;AAAA,MACL;AAAA,MACA,KAAK,UAAU;AAAA,IAChB;AACA,UAAM,SAAS,KAAK,eAAe,SAAS,SAAS;AACrD,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,QAAQ;AAAA,MACR,oBAAoB,MAAM,UAAU,WAAW,KAAK;AAAA,MACpD,UAAU,SAAS;AAAA,QAAI,CAAC,UACvB,oBAAoB,MAAM,KAAK;AAAA,MAChC,KAAK,CAAC;AAAA,IACP;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,0BACC,QACA,UACA,UACA,SACA,OACqE;AACrE,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,4BACC,QACA,UACA,OACA,SACA,OACqE;AACrE,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,+BACC,QACA,KACA,KACA,mBACO;AACP,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,OAAO,YAAY;AAClB,gBAAQ;AAAA,UACP;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,MACD;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,qCACC,QACA,KACA,KACA,oBACA,MACO;AACP,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,OAAO,YAAY;AAClB,gBAAQ,oBAAoB,KAAK,KAAK,oBAAoB,IAAI;AAAA,MAC/D;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,2BAA2B,QAAgB,KAAmB;AAC7D,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,OAAO,YAAY;AAClB,gBAAQ,mBAAmB,GAAG;AAAA,MAC/B;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,2BACC,WACA,UACA,UACoB;AACpB,UAAM,UAAU,IAAI;AAAA,MACnB;AAAA,MACA,KAAK;AAAA,MACL;AAAA,MACA,KAAK,UAAU;AAAA,IAChB;AACA,UAAM,SAAS,KAAK,eAAe,SAAS,SAAS;AACrD,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,UAAU;AAAA,IACX;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,mBACC,QACA,UACA,SACA,OAC8D;AAC9D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,gBAAgB,QAAgB,KAAmB;AAClD,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,OAAO,YAAY;AAClB,gBAAQ,YAAY,GAAG;AAAA,MACxB;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,8BACC,WACA,UACA,UACA,wBACoB;AACpB,UAAM,WAES,MAAM,QAAQ,sBAAsB,IAChD;AAAA,MACA,mBAAmB;AAAA,MACnB,qBAAqB,CAAC;AAAA,IACvB,IACC;AAEH,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,qBAAqB,KAAK,YAAY,QAAQ;AAAA,MAClD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,IACD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,sBACC,QACA,UACA,UACA,SACA,OACyD;AACzD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,sBAAsB,QAAgB,IAAkB;AACvD,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,qBAAqB,EAAE;AAAA,MAC5C;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,2BACC,WACA,UACA,UACoB;AACpB,UAAM,cACL,OAAO,SAAS,0BAA0B,aACvC,KAAK,YAAY,IACjB;AACJ,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI;AAAA,QACH,KAAK;AAAA,QACL,KAAK,UAAU;AAAA,QACf;AAAA,QACA,KAAK;AAAA,QACL;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAEA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,OAAO,SAAS,qBAAqB;AAAA,MACrC;AAAA,MACA,wBAAwB,UAAU,SAAS;AAAA,IAC5C;AACA,QAAI,SAAS,KAAK,kBAAkB,MAAM;AAE1C,QAAI,gBAAgB,QAAW;AAC9B,YAAM,eAAe,SAAS;AAAA,QAAuB,CAAC,QACrD,KAAK,OAAO,qBAAqB,WAAW;AAAA,MAC7C;AACA,eAAS,WAAW,KAAK,QAAQ,YAAY;AAAA,IAC9C;AACA,WAAO;AAAA,EACR;AAAA,EAEA,mBACC,QACA,UACA,OACA,OACsD;AACtD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ,kBAAkB,IAAI,OAAO,QAAQ,GAAG,OAAO,KAAK;AAAA,MAC7D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,kBACC,QACA,IACA,OACqD;AACrD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,iBAAiB,IAAI,KAAK;AAAA,MAC/C;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,mBAAmB,QAAgB,IAAkB;AACpD,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,aAAa,EAAE;AAAA,MACpC;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,6BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,oBAAoB,KAAK,YAAY,QAAQ;AAAA,MACjD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,OAAO,SAAS,wBAAwB;AAAA,IACzC;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,sBACC,QACA,UACA,OACqD;AACrD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,aAAa,IAAI,OAAO,QAAQ,GAAG,KAAK;AAAA,MAC7D;AAAA,MACA;AAAA,MACA,SAAS,WAAW;AAAA,IACrB;AAAA,EACD;AAAA,EAEA,qBACC,QACA,IACA,OACgD;AAChD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,YAAY,IAAI,KAAK;AAAA,MAC1C;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,sBAAsB,QAAgB,IAAkB;AACvD,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,aAAa,EAAE;AAAA,MACpC;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,sBACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,qBAAqB,KAAK,YAAY,QAAQ;AAAA,MAClD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,uBACC,QACA,UACA,OAC2C;AAC3C,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,cAAc,IAAI,OAAO,QAAQ,GAAG,KAAK;AAAA,MAC9D,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,2BACC,QACA,UACA,WACA,OACsD;AACtD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,6BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK,YAAY;AAChC,UAAM,cACL,OAAO,SAAS,6BAA6B,aAC1C,KAAK,YAAY,IACjB;AAEJ,SAAK,SAAS;AAAA,MACb;AAAA,MACA,IAAI;AAAA,QACH,IAAI,uBAAuB,KAAK,YAAY,QAAQ;AAAA,QACpD;AAAA,MACD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,UAAU;AAAA,MACV;AAAA,IACD;AACA,QAAI,SAAS,KAAK,kBAAkB,MAAM;AAE1C,QAAI,gBAAgB,QAAW;AAC9B,YAAM,eAAe,SAAS;AAAA,QAA0B,MACvD,KAAK,OAAO,uBAAuB,WAAW;AAAA,MAC/C;AACA,eAAS,WAAW,KAAK,QAAQ,YAAY;AAAA,IAC9C;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,sBACC,QACA,UACA,SACA,OACgD;AAChD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,+BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI;AAAA,QACH,KAAK;AAAA,QACL;AAAA,QACA,KAAK;AAAA,MACN;AAAA,MACA;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,wBACC,QACA,UACA,WACA,OACwC;AACxC,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,MACD;AAAA,MACD,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,8BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,qBAAqB,KAAK,YAAY,QAAQ;AAAA,MAClD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,sBACC,QACA,UACA,UACA,OAC+D;AAC/D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,QAAQ;AAAA,UACP,IAAI,OAAO,QAAQ;AAAA,UACnB;AAAA,UACA;AAAA,QACD;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,mCACC,QACA,WACA,QACA,OAC0D;AAC1D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,eAAe,WAAW,QAAQ,KAAK;AAAA,MAC5D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,mCACC,QACA,WACA,QACA,OAC0D;AAC1D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,iBAAiB,WAAW,QAAQ,KAAK;AAAA,MAC9D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,sBAAsB,QAAgB,WAAyB;AAC9D,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,QAAQ,QAAQ,eAAe,SAAS,CAAC;AAAA,MAC9D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAGA,8BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,qBAAqB,KAAK,YAAY,QAAQ;AAAA,MAClD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,IACpD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,sBACC,QACA,UACA,UACA,OAC+D;AAC/D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,QAAQ;AAAA,UACP,IAAI,OAAO,QAAQ;AAAA,UACnB;AAAA,UACA;AAAA,QACD;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,gCACC,QACA,WACA,QACA,OAC+D;AAC/D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,kBAAkB,WAAW,QAAQ,KAAK;AAAA,MAC/D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,8BACC,QACA,WACA,QACA,OAC+D;AAC/D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,gBAAgB,WAAW,QAAQ,KAAK;AAAA,MAC7D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,sBAAsB,QAAgB,WAAyB;AAC9D,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,QAAQ,QAAQ,eAAe,SAAS,CAAC;AAAA,MAC9D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,mCACC,WACA,UACA,UACA,UACC;AACD,UAAM,SAAS,KAAK,YAAY;AAChC,SAAK,SAAS;AAAA,MACb;AAAA,MACA,IAAI;AAAA,QACH,IAAI;AAAA,UACH,KAAK;AAAA,UACL,KAAK;AAAA,UACL;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,QACA;AAAA,MACD;AAAA,IACD;AAEA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,qBAAqB,WAAW,eAAe,KAAK,WACjD;AAAA,QACA,iBAAiB,CAAC,CAAC,SAAS;AAAA,QAC5B,eAAe,SAAS;AAAA,MACzB,IACC;AAAA,IACJ;AAEA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,4BACC,QACA,WACA,UACA,UACA,iBACA,OAC8D;AAC9D,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,QAAQ;AAAA,UACP;AAAA,UACA,IAAI,OAAO,QAAQ;AAAA,UACnB;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,iBACC,QACA,IACA,OACkE;AAClE,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,gBAAgB,IAAI,KAAK;AAAA,MAC9C,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,4BAA4B,QAAgB,SAAuB;AAClE,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,QAAQ,QAAQ,iBAAiB,OAAO,CAAC;AAAA,MAC9D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,4BACC,WACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK;AAAA,MACnB,IAAI,mBAAmB,KAAK,YAAY,QAAQ;AAAA,MAChD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD,UAAU,eAAe,UAAU;AAAA,IACpC;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,oBACC,QACA,UACA,YACA,SACA,OACoD;AACpD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,QAAQ;AAAA,UACP;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,kCACC,WACA,UACA,UACA,UACoB;AACpB,UAAM,SAAS,KAAK,YAAY;AAChC,SAAK,SAAS;AAAA,MACb;AAAA,MACA,IAAI;AAAA,QACH,IAAI;AAAA,UACH,KAAK;AAAA,UACL,KAAK;AAAA,UACL;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,QACA;AAAA,MACD;AAAA,IACD;AACA,SAAK,OAAO;AAAA,MACX;AAAA,MACA,KAAK,2BAA2B,UAAU,SAAS;AAAA,MACnD;AAAA,QACC,cAAc,CAAC,CAAC,SAAS;AAAA,QACzB,eAAe,CAAC,CAAC,SAAS;AAAA,QAC1B,iBAAiB,CAAC,CAAC,SAAS;AAAA,QAC5B,wBAAwB,SAAS,wBAAwB;AAAA,UACxD,CAAC,MAAM,EAAE;AAAA,QACV;AAAA,QACA,eAAe,SAAS;AAAA,QACxB,gBAAgB,SAAS;AAAA,MAC1B;AAAA,IACD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,sBACC,QACA,UACA,QACA,cACA,OACuD;AACvD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,mBACC,QACA,WACA,UACA,QACA,iBACA,SACA,OACuD;AACvD,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YACA,QAAQ;AAAA,QACP;AAAA,QACA,IAAI,OAAO,QAAQ;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,MACD;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA,EAEA,kBACC,QACA,IACA,OACkE;AAClE,WAAO,KAAK;AAAA,MACX;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,iBAAiB,IAAI,KAAK;AAAA,MAC/C,CAAC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,mBAAmB,QAAgB,SAAuB;AACzD,SAAK;AAAA,MACJ;AAAA,MACA;AAAA,MACA,CAAC,YAAY,QAAQ,QAAQ,QAAQ,kBAAkB,OAAO,CAAC;AAAA,MAC/D;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAAA;AAAA,EAIA,OAAe,iBACd,QAC6B;AAC7B,WAAO;AAAA,MACN,SAAS,OAAO;AAAA,MAChB,OAAO,OAAO;AAAA,IACf;AAAA,EACD;AAAA,EAEA,OAAe,0BACd,iBACsC;AACtC,WAAO;AAAA,MACN,uBAAuB,wBAAwB;AAAA,QAC9C,gBAAgB;AAAA,MACjB;AAAA,MACA,uBAAuB,wBAAwB;AAAA,QAC9C,gBAAgB;AAAA,MACjB;AAAA,MACA,uBAAuB,gBAAgB,wBACpC,wBAAwB;AAAA,QACxB,gBAAgB;AAAA,MACjB,IACC;AAAA,MACH,uBAAuB,gBAAgB,wBACpC,wBAAwB;AAAA,QACxB,gBAAgB;AAAA,MACjB,IACC;AAAA,IACJ;AAAA,EACD;AAAA,EAEA,OAAe,sBACd,aACkC;AAClC,WAAO;AAAA,MACN,YAAY,wBAAwB;AAAA,QACnC,YAAY;AAAA,MACb;AAAA,MACA,WAAW,YAAY,YACpB,wBAAwB;AAAA,QACxB,YAAY;AAAA,MACb,IACC;AAAA,MACH,kBAAkB,YAAY,mBAC3B,wBAAwB;AAAA,QACxB,YAAY;AAAA,MACb,IACC;AAAA,MACH,QAAQ,YAAY;AAAA,IACrB;AAAA,EACD;AAAA,EAEA,OAAe,uBACd,cACoC;AACpC,WAAO,aAAa,IAAI,wBAAwB,qBAAqB;AAAA,EACtE;AAAA,EAEA,OAAe,0BACd,iBAC8B;AAC9B,WAAO;AAAA,MACN,MAAM,gBAAgB;AAAA,MACtB,OAAO,gBAAgB;AAAA,MACvB,OAAO,gBAAgB,QACpB,gBAAgB,MAAM,IAAI,CAAC,MAAM,gBAAgB,SAAS,CAAC,CAAC,IAC5D;AAAA,IACJ;AAAA,EACD;AAAA,EAEA,OAAe,2BACd,kBACgC;AAChC,WAAO,iBAAiB;AAAA,MACvB,wBAAwB;AAAA,IACzB;AAAA,EACD;AAAA,EAEA,yBACC,WACA,YACA,eACoB;AACpB,UAAM,EAAE,YAAY,IAAI;AAGxB,QAAI,eAAe,yBAAyB,WAAW,GAAG;AACzD,YAAM,IAAI;AAAA,QACT,gDAAgD,WAAW;AAAA,MAC5D;AAAA,IACD;AAGA,QAAI,aAAa;AAChB,WAAK,WAAW,qBAAqB,YAAY,WAAW;AAAA,IAC7D,OAAO;AACN,WAAK,WAAW,qBAAqB,YAAY,MAAS;AAAA,IAC3D;AAEA,QAAI,cAAc,4BAA4B;AAC7C,WAAK,gBAAgB;AAAA,QACpB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,IACD;AAEA,QAAI,cAAc,wBAAwB;AACzC,WAAK,gBAAgB;AAAA,QACpB;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,IACD;AAEA,UAAM,SAAS,KAAK,YAAY;AAChC,UAAM,0BACL;AAAA,MACC,UAAU,cAAc;AAAA,MACxB,UAAU,cAAc;AAAA,MACxB,aAAa,cAAc,cACxB,wBAAwB;AAAA,QACxB,cAAc;AAAA,MACf,IACC;AAAA,MACH,kBAAkB,cAAc,mBAC7B,wBAAwB;AAAA,QACxB,cAAc;AAAA,MACf,IACC;AAAA,MACH,cAAc,cAAc,eACzB,wBAAwB;AAAA,QACxB,cAAc;AAAA,MACf,IACC;AAAA,MACH,4BACC,cAAc;AAAA,MACf,wBAAwB,cAAc;AAAA,MACtC,kBAAkB,cAAc,mBAC7B,wBAAwB;AAAA,QACxB,cAAc;AAAA,MACf,IACC;AAAA,IACJ;AAED,SAAK,OAAO;AAAA,MACX;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,WAAO,KAAK,kBAAkB,MAAM;AAAA,EACrC;AAAA,EAEA,oBACC,iBACO;AACP,eAAW,kBAAkB,iBAAiB;AAC7C,WAAK,WAAW;AAAA,QACf,eAAe;AAAA,QACf,IAAI;AAAA,UACH,eAAe;AAAA,UACf,eAAe;AAAA,QAChB;AAAA,MACD;AAAA,IACD;AAAA,EACD;AACD;",
  "names": ["res"]
}
