var g=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var c=(n,t,r,e)=>{for(var o=e>1?void 0:e?d(t,r):t,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(e?s(t,r,o):s(o))||o);return e&&o&&g(t,r,o),o},l=(n,t)=>(r,e)=>t(r,e,n);import{safeStringify as h}from"../../../base/common/objects.js";import{MainContext as u}from"./extHost.protocol.js";import{IExtHostInitDataService as f}from"./extHostInitDataService.js";import{IExtHostRpcService as p}from"./extHostRpcService.js";let a=class{_mainThreadConsole;_includeStack;_logNative;constructor(t,r){this._mainThreadConsole=t.getProxy(u.MainThreadConsole),this._includeStack=r.consoleForward.includeStack,this._logNative=r.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(t,r){const e=this,o=console[t];Object.defineProperty(console,t,{set:()=>{},get:()=>function(){e._handleConsoleCall(t,r,o,arguments)}})}_handleConsoleCall(t,r,e,o){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:r,arguments:m(o,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(t,e,o)}};a=c([l(0,p),l(1,f)],a);const _=1e5;function m(n,t){const r=[];if(n.length)for(let e=0;e<n.length;e++){let o=n[e];if(typeof o>"u")o="undefined";else if(o instanceof Error){const i=o;i.stack?o=i.stack:o=i.toString()}r.push(o)}if(t){const e=new Error().stack;e&&r.push({__$stack:e.split(`
`).slice(3).join(`
`)})}try{const e=h(r);return e.length>_?"Output omitted for a large object that exceeds the limits":e}catch(e){return`Output omitted for an object that cannot be inspected ('${e.toString()}')`}}export{a as AbstractExtHostConsoleForwarder};
