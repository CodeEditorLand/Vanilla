{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/api/browser/mainThreadDocuments.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { toErrorMessage } from \"../../../base/common/errorMessage.js\";\nimport { ErrorNoTelemetry } from \"../../../base/common/errors.js\";\nimport { Emitter, Event } from \"../../../base/common/event.js\";\nimport {\n\tDisposable,\n\ttype IReference,\n\tdispose,\n} from \"../../../base/common/lifecycle.js\";\nimport { ResourceMap } from \"../../../base/common/map.js\";\nimport { Schemas } from \"../../../base/common/network.js\";\nimport {\n\ttype IExtUri,\n\textUri,\n\ttoLocalResource,\n} from \"../../../base/common/resources.js\";\nimport { URI, type UriComponents } from \"../../../base/common/uri.js\";\nimport {\n\ttype ITextModel,\n\tshouldSynchronizeModel,\n} from \"../../../editor/common/model.js\";\nimport { IModelService } from \"../../../editor/common/services/model.js\";\nimport { ITextModelService } from \"../../../editor/common/services/resolverService.js\";\nimport {\n\tFileOperation,\n\tIFileService,\n} from \"../../../platform/files/common/files.js\";\nimport { IUriIdentityService } from \"../../../platform/uriIdentity/common/uriIdentity.js\";\nimport { IWorkbenchEnvironmentService } from \"../../services/environment/common/environmentService.js\";\nimport type { IExtHostContext } from \"../../services/extensions/common/extHostCustomers.js\";\nimport { IPathService } from \"../../services/path/common/pathService.js\";\nimport { ITextFileService } from \"../../services/textfile/common/textfiles.js\";\nimport { IWorkingCopyFileService } from \"../../services/workingCopy/common/workingCopyFileService.js\";\nimport {\n\tExtHostContext,\n\ttype ExtHostDocumentsShape,\n\ttype MainThreadDocumentsShape,\n} from \"../common/extHost.protocol.js\";\n\nexport class BoundModelReferenceCollection {\n\tprivate _data = new Array<{ uri: URI; length: number; dispose(): void }>();\n\tprivate _length = 0;\n\n\tconstructor(\n\t\tprivate readonly _extUri: IExtUri,\n\t\tprivate readonly _maxAge: number = 1000 * 60 * 3, // auto-dispse by age\n\t\tprivate readonly _maxLength: number = 1024 * 1024 * 80, // auto-dispose by total length\n\t\tprivate readonly _maxSize: number = 50, // auto-dispose by number of references\n\t) {\n\t\t//\n\t}\n\n\tdispose(): void {\n\t\tthis._data = dispose(this._data);\n\t}\n\n\tremove(uri: URI): void {\n\t\tfor (const entry of [\n\t\t\t...this._data,\n\t\t] /* copy array because dispose will modify it */) {\n\t\t\tif (this._extUri.isEqualOrParent(entry.uri, uri)) {\n\t\t\t\tentry.dispose();\n\t\t\t}\n\t\t}\n\t}\n\n\tadd(uri: URI, ref: IReference<any>, length = 0): void {\n\t\t// const length = ref.object.textEditorModel.getValueLength();\n\t\tconst dispose = () => {\n\t\t\tconst idx = this._data.indexOf(entry);\n\t\t\tif (idx >= 0) {\n\t\t\t\tthis._length -= length;\n\t\t\t\tref.dispose();\n\t\t\t\tclearTimeout(handle);\n\t\t\t\tthis._data.splice(idx, 1);\n\t\t\t}\n\t\t};\n\t\tconst handle = setTimeout(dispose, this._maxAge);\n\t\tconst entry = { uri, length, dispose };\n\n\t\tthis._data.push(entry);\n\t\tthis._length += length;\n\t\tthis._cleanup();\n\t}\n\n\tprivate _cleanup(): void {\n\t\t// clean-up wrt total length\n\t\twhile (this._length > this._maxLength) {\n\t\t\tthis._data[0].dispose();\n\t\t}\n\t\t// clean-up wrt number of documents\n\t\tconst extraSize = Math.ceil(this._maxSize * 1.2);\n\t\tif (this._data.length >= extraSize) {\n\t\t\tdispose(this._data.slice(0, extraSize - this._maxSize));\n\t\t}\n\t}\n}\n\nclass ModelTracker extends Disposable {\n\tprivate _knownVersionId: number;\n\n\tconstructor(\n\t\tprivate readonly _model: ITextModel,\n\t\tprivate readonly _onIsCaughtUpWithContentChanges: Emitter<URI>,\n\t\tprivate readonly _proxy: ExtHostDocumentsShape,\n\t\tprivate readonly _textFileService: ITextFileService,\n\t) {\n\t\tsuper();\n\t\tthis._knownVersionId = this._model.getVersionId();\n\t\tthis._store.add(\n\t\t\tthis._model.onDidChangeContent((e) => {\n\t\t\t\tthis._knownVersionId = e.versionId;\n\t\t\t\tthis._proxy.$acceptModelChanged(\n\t\t\t\t\tthis._model.uri,\n\t\t\t\t\te,\n\t\t\t\t\tthis._textFileService.isDirty(this._model.uri),\n\t\t\t\t);\n\t\t\t\tif (this.isCaughtUpWithContentChanges()) {\n\t\t\t\t\tthis._onIsCaughtUpWithContentChanges.fire(this._model.uri);\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t}\n\n\tisCaughtUpWithContentChanges(): boolean {\n\t\treturn this._model.getVersionId() === this._knownVersionId;\n\t}\n}\n\nexport class MainThreadDocuments\n\textends Disposable\n\timplements MainThreadDocumentsShape\n{\n\tprivate _onIsCaughtUpWithContentChanges = this._store.add(\n\t\tnew Emitter<URI>(),\n\t);\n\treadonly onIsCaughtUpWithContentChanges =\n\t\tthis._onIsCaughtUpWithContentChanges.event;\n\n\tprivate readonly _proxy: ExtHostDocumentsShape;\n\tprivate readonly _modelTrackers = new ResourceMap<ModelTracker>();\n\tprivate readonly _modelReferenceCollection: BoundModelReferenceCollection;\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t\t@ITextFileService private readonly _textFileService: ITextFileService,\n\t\t@IFileService private readonly _fileService: IFileService,\n\t\t@ITextModelService private readonly _textModelResolverService: ITextModelService,\n\t\t@IWorkbenchEnvironmentService private readonly _environmentService: IWorkbenchEnvironmentService,\n\t\t@IUriIdentityService private readonly _uriIdentityService: IUriIdentityService,\n\t\t@IWorkingCopyFileService workingCopyFileService: IWorkingCopyFileService,\n\t\t@IPathService private readonly _pathService: IPathService\n\t) {\n\t\tsuper();\n\n\t\tthis._modelReferenceCollection = this._store.add(new BoundModelReferenceCollection(_uriIdentityService.extUri));\n\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostDocuments);\n\n\t\tthis._store.add(_modelService.onModelLanguageChanged(this._onModelModeChanged, this));\n\n\t\tthis._store.add(_textFileService.files.onDidSave(e => {\n\t\t\tif (this._shouldHandleFileEvent(e.model.resource)) {\n\t\t\t\tthis._proxy.$acceptModelSaved(e.model.resource);\n\t\t\t}\n\t\t}));\n\t\tthis._store.add(_textFileService.files.onDidChangeDirty(m => {\n\t\t\tif (this._shouldHandleFileEvent(m.resource)) {\n\t\t\t\tthis._proxy.$acceptDirtyStateChanged(m.resource, m.isDirty());\n\t\t\t}\n\t\t}));\n\n\t\tthis._store.add(workingCopyFileService.onDidRunWorkingCopyFileOperation(e => {\n\t\t\tconst isMove = e.operation === FileOperation.MOVE;\n\t\t\tif (isMove || e.operation === FileOperation.DELETE) {\n\t\t\t\tfor (const pair of e.files) {\n\t\t\t\t\tconst removed = isMove ? pair.source : pair.target;\n\t\t\t\t\tif (removed) {\n\t\t\t\t\t\tthis._modelReferenceCollection.remove(removed);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\toverride dispose(): void {\n\t\tdispose(this._modelTrackers.values());\n\t\tthis._modelTrackers.clear();\n\t\tsuper.dispose();\n\t}\n\n\tisCaughtUpWithContentChanges(resource: URI): boolean {\n\t\tconst tracker = this._modelTrackers.get(resource);\n\t\tif (tracker) {\n\t\t\treturn tracker.isCaughtUpWithContentChanges();\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate _shouldHandleFileEvent(resource: URI): boolean {\n\t\tconst model = this._modelService.getModel(resource);\n\t\treturn !!model && shouldSynchronizeModel(model);\n\t}\n\n\thandleModelAdded(model: ITextModel): void {\n\t\t// Same filter as in mainThreadEditorsTracker\n\t\tif (!shouldSynchronizeModel(model)) {\n\t\t\t// don't synchronize too large models\n\t\t\treturn;\n\t\t}\n\t\tthis._modelTrackers.set(\n\t\t\tmodel.uri,\n\t\t\tnew ModelTracker(\n\t\t\t\tmodel,\n\t\t\t\tthis._onIsCaughtUpWithContentChanges,\n\t\t\t\tthis._proxy,\n\t\t\t\tthis._textFileService,\n\t\t\t),\n\t\t);\n\t}\n\n\tprivate _onModelModeChanged(event: {\n\t\tmodel: ITextModel;\n\t\toldLanguageId: string;\n\t}): void {\n\t\tconst { model } = event;\n\t\tif (!this._modelTrackers.has(model.uri)) {\n\t\t\treturn;\n\t\t}\n\t\tthis._proxy.$acceptModelLanguageChanged(\n\t\t\tmodel.uri,\n\t\t\tmodel.getLanguageId(),\n\t\t);\n\t}\n\n\thandleModelRemoved(modelUrl: URI): void {\n\t\tif (!this._modelTrackers.has(modelUrl)) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelTrackers.get(modelUrl)!.dispose();\n\t\tthis._modelTrackers.delete(modelUrl);\n\t}\n\n\t// --- from extension host process\n\n\tasync $trySaveDocument(uri: UriComponents): Promise<boolean> {\n\t\tconst target = await this._textFileService.save(URI.revive(uri));\n\t\treturn Boolean(target);\n\t}\n\n\tasync $tryOpenDocument(uriData: UriComponents): Promise<URI> {\n\t\tconst inputUri = URI.revive(uriData);\n\t\tif (!inputUri.scheme || !(inputUri.fsPath || inputUri.authority)) {\n\t\t\tthrow new ErrorNoTelemetry(\n\t\t\t\t`Invalid uri. Scheme and authority or path must be set.`,\n\t\t\t);\n\t\t}\n\n\t\tconst canonicalUri = this._uriIdentityService.asCanonicalUri(inputUri);\n\n\t\tlet promise: Promise<URI>;\n\t\tswitch (canonicalUri.scheme) {\n\t\t\tcase Schemas.untitled:\n\t\t\t\tpromise = this._handleUntitledScheme(canonicalUri);\n\t\t\t\tbreak;\n\t\t\tcase Schemas.file:\n\t\t\tdefault:\n\t\t\t\tpromise = this._handleAsResourceInput(canonicalUri);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet documentUri: URI | undefined;\n\t\ttry {\n\t\t\tdocumentUri = await promise;\n\t\t} catch (err) {\n\t\t\tthrow new ErrorNoTelemetry(\n\t\t\t\t`cannot open ${canonicalUri.toString()}. Detail: ${toErrorMessage(err)}`,\n\t\t\t);\n\t\t}\n\t\tif (!documentUri) {\n\t\t\tthrow new ErrorNoTelemetry(\n\t\t\t\t`cannot open ${canonicalUri.toString()}`,\n\t\t\t);\n\t\t} else if (!extUri.isEqual(documentUri, canonicalUri)) {\n\t\t\tthrow new ErrorNoTelemetry(\n\t\t\t\t`cannot open ${canonicalUri.toString()}. Detail: Actual document opened as ${documentUri.toString()}`,\n\t\t\t);\n\t\t} else if (this._modelTrackers.has(canonicalUri)) {\n\t\t\treturn canonicalUri;\n\t\t} else {\n\t\t\tthrow new ErrorNoTelemetry(\n\t\t\t\t`cannot open ${canonicalUri.toString()}. Detail: Files above 50MB cannot be synchronized with extensions.`,\n\t\t\t);\n\t\t}\n\t}\n\n\t$tryCreateDocument(options?: {\n\t\tlanguage?: string;\n\t\tcontent?: string;\n\t}): Promise<URI> {\n\t\treturn this._doCreateUntitled(\n\t\t\tundefined,\n\t\t\toptions ? options.language : undefined,\n\t\t\toptions ? options.content : undefined,\n\t\t);\n\t}\n\n\tprivate async _handleAsResourceInput(uri: URI): Promise<URI> {\n\t\tconst ref =\n\t\t\tawait this._textModelResolverService.createModelReference(uri);\n\t\tthis._modelReferenceCollection.add(\n\t\t\turi,\n\t\t\tref,\n\t\t\tref.object.textEditorModel.getValueLength(),\n\t\t);\n\t\treturn ref.object.textEditorModel.uri;\n\t}\n\n\tprivate async _handleUntitledScheme(uri: URI): Promise<URI> {\n\t\tconst asLocalUri = toLocalResource(\n\t\t\turi,\n\t\t\tthis._environmentService.remoteAuthority,\n\t\t\tthis._pathService.defaultUriScheme,\n\t\t);\n\t\tconst exists = await this._fileService.exists(asLocalUri);\n\t\tif (exists) {\n\t\t\t// don't create a new file ontop of an existing file\n\t\t\treturn Promise.reject(new Error(\"file already exists\"));\n\t\t}\n\t\treturn await this._doCreateUntitled(\n\t\t\tBoolean(uri.path) ? uri : undefined,\n\t\t);\n\t}\n\n\tprivate async _doCreateUntitled(\n\t\tassociatedResource?: URI,\n\t\tlanguageId?: string,\n\t\tinitialValue?: string,\n\t): Promise<URI> {\n\t\tconst model = this._textFileService.untitled.create({\n\t\t\tassociatedResource,\n\t\t\tlanguageId,\n\t\t\tinitialValue,\n\t\t});\n\t\tconst resource = model.resource;\n\t\tconst ref =\n\t\t\tawait this._textModelResolverService.createModelReference(resource);\n\t\tif (!this._modelTrackers.has(resource)) {\n\t\t\tref.dispose();\n\t\t\tthrow new Error(\n\t\t\t\t`expected URI ${resource.toString()} to have come to LIFE`,\n\t\t\t);\n\t\t}\n\t\tthis._modelReferenceCollection.add(\n\t\t\tresource,\n\t\t\tref,\n\t\t\tref.object.textEditorModel.getValueLength(),\n\t\t);\n\t\tEvent.once(model.onDidRevert)(() =>\n\t\t\tthis._modelReferenceCollection.remove(resource),\n\t\t);\n\t\tthis._proxy.$acceptDirtyStateChanged(resource, true); // mark as dirty\n\t\treturn resource;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["dispose"]
}
