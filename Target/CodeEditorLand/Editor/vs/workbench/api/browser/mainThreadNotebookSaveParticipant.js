var y=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var l=(i,o,t,r)=>{for(var e=r>1?void 0:r?d(o,t):o,n=i.length-1,a;n>=0;n--)(a=i[n])&&(e=(r?a(o,t,e):a(e))||e);return r&&e&&y(o,t,e),e},p=(i,o)=>(t,r)=>o(t,r,i);import{raceCancellationError as S}from"../../../base/common/async.js";import{localize as v}from"../../../nls.js";import{IInstantiationService as I}from"../../../platform/instantiation/common/instantiation.js";import{NotebookFileWorkingCopyModel as C}from"../../contrib/notebook/common/notebookEditorModel.js";import{extHostCustomer as g}from"../../services/extensions/common/extHostCustomers.js";import{IWorkingCopyFileService as k}from"../../services/workingCopy/common/workingCopyFileService.js";import{ExtHostContext as x}from"../common/extHost.protocol.js";class f{_proxy;constructor(o){this._proxy=o.getProxy(x.ExtHostNotebookDocumentSaveParticipant)}async participate(o,t,r,e){if(!o.model||!(o.model instanceof C))return;let n;const a=new Promise((m,c)=>{n=setTimeout(()=>c(new Error(v("timeout.onWillSave","Aborted onWillSaveNotebookDocument-event after 1750ms"))),1750),this._proxy.$participateInSave(o.resource,t.reason,e).then(u=>{clearTimeout(n)}).then(m,c)});return S(a,e)}}let s=class{constructor(o,t,r){this.workingCopyFileService=r;this._saveParticipantDisposable=this.workingCopyFileService.addSaveParticipant(t.createInstance(f,o))}_saveParticipantDisposable;dispose(){this._saveParticipantDisposable.dispose()}};s=l([g,p(1,I),p(2,k)],s);export{s as SaveParticipant};
