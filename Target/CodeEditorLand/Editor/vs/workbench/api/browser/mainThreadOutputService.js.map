{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/api/browser/mainThreadOutputService.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from \"../../../base/common/event.js\";\nimport { Disposable, toDisposable } from \"../../../base/common/lifecycle.js\";\nimport { isNumber } from \"../../../base/common/types.js\";\nimport { URI, type UriComponents } from \"../../../base/common/uri.js\";\nimport { Registry } from \"../../../platform/registry/common/platform.js\";\nimport {\n\ttype IExtHostContext,\n\textHostNamedCustomer,\n} from \"../../services/extensions/common/extHostCustomers.js\";\nimport {\n\tExtensions,\n\ttype IOutputChannel,\n\ttype IOutputChannelRegistry,\n\tIOutputService,\n\tOUTPUT_VIEW_ID,\n\tOutputChannelUpdateMode,\n} from \"../../services/output/common/output.js\";\nimport { IViewsService } from \"../../services/views/common/viewsService.js\";\nimport {\n\tExtHostContext,\n\ttype ExtHostOutputServiceShape,\n\tMainContext,\n\ttype MainThreadOutputServiceShape,\n} from \"../common/extHost.protocol.js\";\n\n@extHostNamedCustomer(MainContext.MainThreadOutputService)\nexport class MainThreadOutputService\n\textends Disposable\n\timplements MainThreadOutputServiceShape\n{\n\tprivate static _extensionIdPool = new Map<string, number>();\n\n\tprivate readonly _proxy: ExtHostOutputServiceShape;\n\tprivate readonly _outputService: IOutputService;\n\tprivate readonly _viewsService: IViewsService;\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IOutputService outputService: IOutputService,\n\t\t@IViewsService viewsService: IViewsService,\n\t) {\n\t\tsuper();\n\t\tthis._outputService = outputService;\n\t\tthis._viewsService = viewsService;\n\n\t\tthis._proxy = extHostContext.getProxy(\n\t\t\tExtHostContext.ExtHostOutputService,\n\t\t);\n\n\t\tconst setVisibleChannel = () => {\n\t\t\tconst visibleChannel = this._viewsService.isViewVisible(\n\t\t\t\tOUTPUT_VIEW_ID,\n\t\t\t)\n\t\t\t\t? this._outputService.getActiveChannel()\n\t\t\t\t: undefined;\n\t\t\tthis._proxy.$setVisibleChannel(\n\t\t\t\tvisibleChannel ? visibleChannel.id : null,\n\t\t\t);\n\t\t};\n\t\tthis._register(\n\t\t\tEvent.any<any>(\n\t\t\t\tthis._outputService.onActiveOutputChannel,\n\t\t\t\tEvent.filter(\n\t\t\t\t\tthis._viewsService.onDidChangeViewVisibility,\n\t\t\t\t\t({ id }) => id === OUTPUT_VIEW_ID,\n\t\t\t\t),\n\t\t\t)(() => setVisibleChannel()),\n\t\t);\n\t\tsetVisibleChannel();\n\t}\n\n\tpublic async $register(\n\t\tlabel: string,\n\t\tfile: UriComponents,\n\t\tlanguageId: string | undefined,\n\t\textensionId: string,\n\t): Promise<string> {\n\t\tconst idCounter =\n\t\t\t(MainThreadOutputService._extensionIdPool.get(extensionId) || 0) +\n\t\t\t1;\n\t\tMainThreadOutputService._extensionIdPool.set(extensionId, idCounter);\n\t\tconst id = `extension-output-${extensionId}-#${idCounter}-${label}`;\n\t\tconst resource = URI.revive(file);\n\n\t\tRegistry.as<IOutputChannelRegistry>(\n\t\t\tExtensions.OutputChannels,\n\t\t).registerChannel({\n\t\t\tid,\n\t\t\tlabel,\n\t\t\tfile: resource,\n\t\t\tlog: false,\n\t\t\tlanguageId,\n\t\t\textensionId,\n\t\t});\n\t\tthis._register(toDisposable(() => this.$dispose(id)));\n\t\treturn id;\n\t}\n\n\tpublic async $update(\n\t\tchannelId: string,\n\t\tmode: OutputChannelUpdateMode,\n\t\ttill?: number,\n\t): Promise<void> {\n\t\tconst channel = this._getChannel(channelId);\n\t\tif (channel) {\n\t\t\tif (mode === OutputChannelUpdateMode.Append) {\n\t\t\t\tchannel.update(mode);\n\t\t\t} else if (isNumber(till)) {\n\t\t\t\tchannel.update(mode, till);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async $reveal(\n\t\tchannelId: string,\n\t\tpreserveFocus: boolean,\n\t): Promise<void> {\n\t\tconst channel = this._getChannel(channelId);\n\t\tif (channel) {\n\t\t\tthis._outputService.showChannel(channel.id, preserveFocus);\n\t\t}\n\t}\n\n\tpublic async $close(channelId: string): Promise<void> {\n\t\tif (this._viewsService.isViewVisible(OUTPUT_VIEW_ID)) {\n\t\t\tconst activeChannel = this._outputService.getActiveChannel();\n\t\t\tif (activeChannel && channelId === activeChannel.id) {\n\t\t\t\tthis._viewsService.closeView(OUTPUT_VIEW_ID);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async $dispose(channelId: string): Promise<void> {\n\t\tconst channel = this._getChannel(channelId);\n\t\tchannel?.dispose();\n\t}\n\n\tprivate _getChannel(channelId: string): IOutputChannel | undefined {\n\t\treturn this._outputService.getChannel(channelId);\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
