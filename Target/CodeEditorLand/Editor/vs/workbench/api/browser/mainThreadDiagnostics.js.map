{
  "version": 3,
  "sources": ["../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/workbench/api/browser/mainThreadDiagnostics.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMarkerService, IMarkerData } from '../../../platform/markers/common/markers.js';\nimport { URI, UriComponents } from '../../../base/common/uri.js';\nimport { MainThreadDiagnosticsShape, MainContext, ExtHostDiagnosticsShape, ExtHostContext } from '../common/extHost.protocol.js';\nimport { extHostNamedCustomer, IExtHostContext } from '../../services/extensions/common/extHostCustomers.js';\nimport { IDisposable } from '../../../base/common/lifecycle.js';\nimport { IUriIdentityService } from '../../../platform/uriIdentity/common/uriIdentity.js';\n\n@extHostNamedCustomer(MainContext.MainThreadDiagnostics)\nexport class MainThreadDiagnostics implements MainThreadDiagnosticsShape {\n\n\tprivate readonly _activeOwners = new Set<string>();\n\n\tprivate readonly _proxy: ExtHostDiagnosticsShape;\n\tprivate readonly _markerListener: IDisposable;\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IMarkerService private readonly _markerService: IMarkerService,\n\t\t@IUriIdentityService private readonly _uriIdentService: IUriIdentityService,\n\t) {\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostDiagnostics);\n\n\t\tthis._markerListener = this._markerService.onMarkerChanged(this._forwardMarkers, this);\n\t}\n\n\tdispose(): void {\n\t\tthis._markerListener.dispose();\n\t\tthis._activeOwners.forEach(owner => this._markerService.changeAll(owner, []));\n\t\tthis._activeOwners.clear();\n\t}\n\n\tprivate _forwardMarkers(resources: readonly URI[]): void {\n\t\tconst data: [UriComponents, IMarkerData[]][] = [];\n\t\tfor (const resource of resources) {\n\t\t\tconst allMarkerData = this._markerService.read({ resource });\n\t\t\tif (allMarkerData.length === 0) {\n\t\t\t\tdata.push([resource, []]);\n\t\t\t} else {\n\t\t\t\tconst forgeinMarkerData = allMarkerData.filter(marker => !this._activeOwners.has(marker.owner));\n\t\t\t\tif (forgeinMarkerData.length > 0) {\n\t\t\t\t\tdata.push([resource, forgeinMarkerData]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (data.length > 0) {\n\t\t\tthis._proxy.$acceptMarkersChange(data);\n\t\t}\n\t}\n\n\t$changeMany(owner: string, entries: [UriComponents, IMarkerData[]][]): void {\n\t\tfor (const entry of entries) {\n\t\t\tconst [uri, markers] = entry;\n\t\t\tif (markers) {\n\t\t\t\tfor (const marker of markers) {\n\t\t\t\t\tif (marker.relatedInformation) {\n\t\t\t\t\t\tfor (const relatedInformation of marker.relatedInformation) {\n\t\t\t\t\t\t\trelatedInformation.resource = URI.revive(relatedInformation.resource);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (marker.code && typeof marker.code !== 'string') {\n\t\t\t\t\t\tmarker.code.target = URI.revive(marker.code.target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._markerService.changeOne(owner, this._uriIdentService.asCanonicalUri(URI.revive(uri)), markers);\n\t\t}\n\t\tthis._activeOwners.add(owner);\n\t}\n\n\t$clear(owner: string): void {\n\t\tthis._markerService.changeAll(owner, []);\n\t\tthis._activeOwners.delete(owner);\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;AAKA,SAAS,gBAAgB,mBAAmB;AAC5C,SAAS,KAAK,qBAAqB;AACnC,SAAS,4BAA4B,aAAa,yBAAyB,sBAAsB;AACjG,SAAS,sBAAsB,uBAAuB;AACtD,SAAS,mBAAmB;AAC5B,SAAS,2BAA2B;AAG7B,IAAM,wBAAN,MAAkE;AAAA,EAOxE,YACC,gBACiC,gBACK,kBACrC;AAFgC;AACK;AAEtC,SAAK,SAAS,eAAe,SAAS,eAAe,kBAAkB;AAEvE,SAAK,kBAAkB,KAAK,eAAe,gBAAgB,KAAK,iBAAiB,IAAI;AAAA,EACtF;AAAA,EAbiB,gBAAgB,oBAAI,IAAY;AAAA,EAEhC;AAAA,EACA;AAAA,EAYjB,UAAgB;AACf,SAAK,gBAAgB,QAAQ;AAC7B,SAAK,cAAc,QAAQ,WAAS,KAAK,eAAe,UAAU,OAAO,CAAC,CAAC,CAAC;AAC5E,SAAK,cAAc,MAAM;AAAA,EAC1B;AAAA,EAEQ,gBAAgB,WAAiC;AACxD,UAAM,OAAyC,CAAC;AAChD,eAAW,YAAY,WAAW;AACjC,YAAM,gBAAgB,KAAK,eAAe,KAAK,EAAE,SAAS,CAAC;AAC3D,UAAI,cAAc,WAAW,GAAG;AAC/B,aAAK,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;AAAA,MACzB,OAAO;AACN,cAAM,oBAAoB,cAAc,OAAO,YAAU,CAAC,KAAK,cAAc,IAAI,OAAO,KAAK,CAAC;AAC9F,YAAI,kBAAkB,SAAS,GAAG;AACjC,eAAK,KAAK,CAAC,UAAU,iBAAiB,CAAC;AAAA,QACxC;AAAA,MACD;AAAA,IACD;AACA,QAAI,KAAK,SAAS,GAAG;AACpB,WAAK,OAAO,qBAAqB,IAAI;AAAA,IACtC;AAAA,EACD;AAAA,EAEA,YAAY,OAAe,SAAiD;AAC3E,eAAW,SAAS,SAAS;AAC5B,YAAM,CAAC,KAAK,OAAO,IAAI;AACvB,UAAI,SAAS;AACZ,mBAAW,UAAU,SAAS;AAC7B,cAAI,OAAO,oBAAoB;AAC9B,uBAAW,sBAAsB,OAAO,oBAAoB;AAC3D,iCAAmB,WAAW,IAAI,OAAO,mBAAmB,QAAQ;AAAA,YACrE;AAAA,UACD;AACA,cAAI,OAAO,QAAQ,OAAO,OAAO,SAAS,UAAU;AACnD,mBAAO,KAAK,SAAS,IAAI,OAAO,OAAO,KAAK,MAAM;AAAA,UACnD;AAAA,QACD;AAAA,MACD;AACA,WAAK,eAAe,UAAU,OAAO,KAAK,iBAAiB,eAAe,IAAI,OAAO,GAAG,CAAC,GAAG,OAAO;AAAA,IACpG;AACA,SAAK,cAAc,IAAI,KAAK;AAAA,EAC7B;AAAA,EAEA,OAAO,OAAqB;AAC3B,SAAK,eAAe,UAAU,OAAO,CAAC,CAAC;AACvC,SAAK,cAAc,OAAO,KAAK;AAAA,EAChC;AACD;AAjEyE;AAA5D,wBAAN;AAAA,EADN,qBAAqB,YAAY,qBAAqB;AAAA,EAUpD;AAAA,EACA;AAAA,GAVU;",
  "names": []
}
