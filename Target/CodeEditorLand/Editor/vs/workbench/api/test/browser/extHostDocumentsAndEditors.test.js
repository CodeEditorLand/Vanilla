import d from"assert";import{URI as t}from"../../../../base/common/uri.js";import{ExtHostDocumentsAndEditors as c}from"../../common/extHostDocumentsAndEditors.js";import{TestRPCProtocol as m}from"../common/testRPCProtocol.js";import{NullLogService as u}from"../../../../platform/log/common/log.js";import{ensureNoDisposablesAreLeakedInTestSuite as a}from"../../../../base/test/common/utils.js";suite("ExtHostDocumentsAndEditors",()=>{let e;setup(function(){e=new c(new m,new u)}),a(),test("The value of TextDocument.isClosed is incorrect when a text document is closed, #27949",()=>(e.$acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:`
`,isDirty:!0,languageId:"fooLang",uri:t.parse("foo:bar"),versionId:1,lines:["first","second"]}]}),new Promise((s,r)=>{const n=e.onDidRemoveDocuments(i=>{try{for(const o of i)d.strictEqual(o.document.isClosed,!0);s(void 0)}catch(o){r(o)}finally{n.dispose()}});e.$acceptDocumentsAndEditorsDelta({removedDocuments:[t.parse("foo:bar")]})})))});
