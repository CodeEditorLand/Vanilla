const c=new WeakMap;function u(i){if(!i.parent||i.parent===i)return null;try{const e=i.location,n=i.parent.location;if(e.origin!=="null"&&n.origin!=="null"&&e.origin!==n.origin)return null}catch{return null}return i.parent}class d{static getSameOriginWindowChain(e){let n=c.get(e);if(!n){n=[],c.set(e,n);let t=e,r;do r=u(t),r?n.push({window:new WeakRef(t),iframeElement:t.frameElement||null}):n.push({window:new WeakRef(t),iframeElement:null}),t=r;while(t)}return n.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,n){if(!n||e===n)return{top:0,left:0};let t=0,r=0;const o=this.getSameOriginWindowChain(e);for(const a of o){const l=a.window.deref();if(t+=l?.scrollY??0,r+=l?.scrollX??0,l===n||!a.iframeElement)break;const s=a.iframeElement.getBoundingClientRect();t+=s.top,r+=s.left}return{top:t,left:r}}}async function f(i,e){if(!crypto.subtle)throw new Error("'crypto.subtle' is not available so webviews will not work. This is likely because the editor is not running in a secure context (https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts).");const n=JSON.stringify({parentOrigin:i,salt:e}),r=new TextEncoder().encode(n),o=await crypto.subtle.digest("sha-256",r);return w(o)}function w(i){const n=Array.from(new Uint8Array(i)).map(t=>t.toString(16).padStart(2,"0")).join("");return BigInt(`0x${n}`).toString(32).padStart(52,"0")}export{d as IframeUtils,f as parentOriginHash};
