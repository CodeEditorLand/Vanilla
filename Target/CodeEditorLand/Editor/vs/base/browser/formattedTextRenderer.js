import*as T from"./dom.js";import"./keyboardEvent.js";import"./mouseEvent.js";import"../common/lifecycle.js";function A(r,e={}){const o=m(e);return o.textContent=r,o}function C(r,e={}){const o=m(e);return u(o,x(r,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),o}function m(r){const e=r.inline?"span":"div",o=document.createElement(e);return r.className&&(o.className=r.className),o}class y{source;index;constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}var f=(n=>(n[n.Invalid=0]="Invalid",n[n.Root=1]="Root",n[n.Text=2]="Text",n[n.Bold=3]="Bold",n[n.Italics=4]="Italics",n[n.Action=5]="Action",n[n.ActionClose=6]="ActionClose",n[n.Code=7]="Code",n[n.NewLine=8]="NewLine",n))(f||{});function u(r,e,o,c){let t;if(e.type===2)t=document.createTextNode(e.content||"");else if(e.type===3)t=document.createElement("b");else if(e.type===4)t=document.createElement("i");else if(e.type===7&&c)t=document.createElement("code");else if(e.type===5&&o){const i=document.createElement("a");o.disposables.add(T.addStandardDisposableListener(i,"click",a=>{o.callback(String(e.index),a)})),t=i}else e.type===8?t=document.createElement("br"):e.type===1&&(t=r);t&&r!==t&&r.appendChild(t),t&&Array.isArray(e.children)&&e.children.forEach(i=>{u(t,i,o,c)})}function x(r,e){const o={type:1,children:[]};let c=0,t=o;const i=[],a=new y(r);for(;!a.eos();){let s=a.next();const p=s==="\\"&&d(a.peek(),e)!==0;if(p&&(s=a.next()),!p&&h(s,e)&&s===a.peek()){a.advance(),t.type===2&&(t=i.pop());const n=d(s,e);if(t.type===n||t.type===5&&n===6)t=i.pop();else{const l={type:n,children:[]};n===5&&(l.index=c,c++),t.children.push(l),i.push(t),t=l}}else if(s===`
`)t.type===2&&(t=i.pop()),t.children.push({type:8});else if(t.type!==2){const n={type:2,content:s};t.children.push(n),i.push(t),t=n}else t.content+=s}return t.type===2&&(t=i.pop()),i.length,o}function h(r,e){return d(r,e)!==0}function d(r,e){switch(r){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}export{m as createElement,C as renderFormattedText,A as renderText};
