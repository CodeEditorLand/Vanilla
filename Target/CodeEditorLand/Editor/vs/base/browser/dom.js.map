{
  "version": 3,
  "sources": ["../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/base/browser/dom.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as browser from './browser.js';\nimport { BrowserFeatures } from './canIUse.js';\nimport { IKeyboardEvent, StandardKeyboardEvent } from './keyboardEvent.js';\nimport { IMouseEvent, StandardMouseEvent } from './mouseEvent.js';\nimport { AbstractIdleValue, IntervalTimer, TimeoutTimer, _runWhenIdle, IdleDeadline } from '../common/async.js';\nimport { onUnexpectedError } from '../common/errors.js';\nimport * as event from '../common/event.js';\nimport * as dompurify from './dompurify/dompurify.js';\nimport { KeyCode } from '../common/keyCodes.js';\nimport { Disposable, DisposableStore, IDisposable, toDisposable } from '../common/lifecycle.js';\nimport { FileAccess, RemoteAuthorities, Schemas } from '../common/network.js';\nimport * as platform from '../common/platform.js';\nimport { URI } from '../common/uri.js';\nimport { hash } from '../common/hash.js';\nimport { CodeWindow, ensureCodeWindow, mainWindow } from './window.js';\nimport { isPointWithinTriangle } from '../common/numbers.js';\n\nexport interface IRegisteredCodeWindow {\n\treadonly window: CodeWindow;\n\treadonly disposables: DisposableStore;\n}\n\n//# region Multi-Window Support Utilities\n\nexport const {\n\tregisterWindow,\n\tgetWindow,\n\tgetDocument,\n\tgetWindows,\n\tgetWindowsCount,\n\tgetWindowId,\n\tgetWindowById,\n\thasWindow,\n\tonDidRegisterWindow,\n\tonWillUnregisterWindow,\n\tonDidUnregisterWindow\n} = (function () {\n\tconst windows = new Map<number, IRegisteredCodeWindow>();\n\n\tensureCodeWindow(mainWindow, 1);\n\tconst mainWindowRegistration = { window: mainWindow, disposables: new DisposableStore() };\n\twindows.set(mainWindow.vscodeWindowId, mainWindowRegistration);\n\n\tconst onDidRegisterWindow = new event.Emitter<IRegisteredCodeWindow>();\n\tconst onDidUnregisterWindow = new event.Emitter<CodeWindow>();\n\tconst onWillUnregisterWindow = new event.Emitter<CodeWindow>();\n\n\tfunction getWindowById(windowId: number): IRegisteredCodeWindow | undefined;\n\tfunction getWindowById(windowId: number | undefined, fallbackToMain: true): IRegisteredCodeWindow;\n\tfunction getWindowById(windowId: number | undefined, fallbackToMain?: boolean): IRegisteredCodeWindow | undefined {\n\t\tconst window = typeof windowId === 'number' ? windows.get(windowId) : undefined;\n\n\t\treturn window ?? (fallbackToMain ? mainWindowRegistration : undefined);\n\t}\n\n\treturn {\n\t\tonDidRegisterWindow: onDidRegisterWindow.event,\n\t\tonWillUnregisterWindow: onWillUnregisterWindow.event,\n\t\tonDidUnregisterWindow: onDidUnregisterWindow.event,\n\t\tregisterWindow(window: CodeWindow): IDisposable {\n\t\t\tif (windows.has(window.vscodeWindowId)) {\n\t\t\t\treturn Disposable.None;\n\t\t\t}\n\n\t\t\tconst disposables = new DisposableStore();\n\n\t\t\tconst registeredWindow = {\n\t\t\t\twindow,\n\t\t\t\tdisposables: disposables.add(new DisposableStore())\n\t\t\t};\n\t\t\twindows.set(window.vscodeWindowId, registeredWindow);\n\n\t\t\tdisposables.add(toDisposable(() => {\n\t\t\t\twindows.delete(window.vscodeWindowId);\n\t\t\t\tonDidUnregisterWindow.fire(window);\n\t\t\t}));\n\n\t\t\tdisposables.add(addDisposableListener(window, EventType.BEFORE_UNLOAD, () => {\n\t\t\t\tonWillUnregisterWindow.fire(window);\n\t\t\t}));\n\n\t\t\tonDidRegisterWindow.fire(registeredWindow);\n\n\t\t\treturn disposables;\n\t\t},\n\t\tgetWindows(): Iterable<IRegisteredCodeWindow> {\n\t\t\treturn windows.values();\n\t\t},\n\t\tgetWindowsCount(): number {\n\t\t\treturn windows.size;\n\t\t},\n\t\tgetWindowId(targetWindow: Window): number {\n\t\t\treturn (targetWindow as CodeWindow).vscodeWindowId;\n\t\t},\n\t\thasWindow(windowId: number): boolean {\n\t\t\treturn windows.has(windowId);\n\t\t},\n\t\tgetWindowById,\n\t\tgetWindow(e: Node | UIEvent | undefined | null): CodeWindow {\n\t\t\tconst candidateNode = e as Node | undefined | null;\n\t\t\tif (candidateNode?.ownerDocument?.defaultView) {\n\t\t\t\treturn candidateNode.ownerDocument.defaultView.window as CodeWindow;\n\t\t\t}\n\n\t\t\tconst candidateEvent = e as UIEvent | undefined | null;\n\t\t\tif (candidateEvent?.view) {\n\t\t\t\treturn candidateEvent.view.window as CodeWindow;\n\t\t\t}\n\n\t\t\treturn mainWindow;\n\t\t},\n\t\tgetDocument(e: Node | UIEvent | undefined | null): Document {\n\t\t\tconst candidateNode = e as Node | undefined | null;\n\t\t\treturn getWindow(candidateNode).document;\n\t\t}\n\t};\n})();\n\n//#endregion\n\nexport function clearNode(node: HTMLElement): void {\n\twhile (node.firstChild) {\n\t\tnode.firstChild.remove();\n\t}\n}\n\nclass DomListener implements IDisposable {\n\n\tprivate _handler: (e: any) => void;\n\tprivate _node: EventTarget;\n\tprivate readonly _type: string;\n\tprivate readonly _options: boolean | AddEventListenerOptions;\n\n\tconstructor(node: EventTarget, type: string, handler: (e: any) => void, options?: boolean | AddEventListenerOptions) {\n\t\tthis._node = node;\n\t\tthis._type = type;\n\t\tthis._handler = handler;\n\t\tthis._options = (options || false);\n\t\tthis._node.addEventListener(this._type, this._handler, this._options);\n\t}\n\n\tdispose(): void {\n\t\tif (!this._handler) {\n\t\t\t// Already disposed\n\t\t\treturn;\n\t\t}\n\n\t\tthis._node.removeEventListener(this._type, this._handler, this._options);\n\n\t\t// Prevent leakers from holding on to the dom or handler func\n\t\tthis._node = null!;\n\t\tthis._handler = null!;\n\t}\n}\n\nexport function addDisposableListener<K extends keyof GlobalEventHandlersEventMap>(node: EventTarget, type: K, handler: (event: GlobalEventHandlersEventMap[K]) => void, useCapture?: boolean): IDisposable;\nexport function addDisposableListener(node: EventTarget, type: string, handler: (event: any) => void, useCapture?: boolean): IDisposable;\nexport function addDisposableListener(node: EventTarget, type: string, handler: (event: any) => void, options: AddEventListenerOptions): IDisposable;\nexport function addDisposableListener(node: EventTarget, type: string, handler: (event: any) => void, useCaptureOrOptions?: boolean | AddEventListenerOptions): IDisposable {\n\treturn new DomListener(node, type, handler, useCaptureOrOptions);\n}\n\nexport interface IAddStandardDisposableListenerSignature {\n\t(node: HTMLElement, type: 'click', handler: (event: IMouseEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'mousedown', handler: (event: IMouseEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'keydown', handler: (event: IKeyboardEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'keypress', handler: (event: IKeyboardEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'keyup', handler: (event: IKeyboardEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'pointerdown', handler: (event: PointerEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'pointermove', handler: (event: PointerEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: 'pointerup', handler: (event: PointerEvent) => void, useCapture?: boolean): IDisposable;\n\t(node: HTMLElement, type: string, handler: (event: any) => void, useCapture?: boolean): IDisposable;\n}\nfunction _wrapAsStandardMouseEvent(targetWindow: Window, handler: (e: IMouseEvent) => void): (e: MouseEvent) => void {\n\treturn function (e: MouseEvent) {\n\t\treturn handler(new StandardMouseEvent(targetWindow, e));\n\t};\n}\nfunction _wrapAsStandardKeyboardEvent(handler: (e: IKeyboardEvent) => void): (e: KeyboardEvent) => void {\n\treturn function (e: KeyboardEvent) {\n\t\treturn handler(new StandardKeyboardEvent(e));\n\t};\n}\nexport const addStandardDisposableListener: IAddStandardDisposableListenerSignature = function addStandardDisposableListener(node: HTMLElement, type: string, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\tlet wrapHandler = handler;\n\n\tif (type === 'click' || type === 'mousedown' || type === 'contextmenu') {\n\t\twrapHandler = _wrapAsStandardMouseEvent(getWindow(node), handler);\n\t} else if (type === 'keydown' || type === 'keypress' || type === 'keyup') {\n\t\twrapHandler = _wrapAsStandardKeyboardEvent(handler);\n\t}\n\n\treturn addDisposableListener(node, type, wrapHandler, useCapture);\n};\n\nexport const addStandardDisposableGenericMouseDownListener = function addStandardDisposableListener(node: HTMLElement, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\tconst wrapHandler = _wrapAsStandardMouseEvent(getWindow(node), handler);\n\n\treturn addDisposableGenericMouseDownListener(node, wrapHandler, useCapture);\n};\n\nexport const addStandardDisposableGenericMouseUpListener = function addStandardDisposableListener(node: HTMLElement, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\tconst wrapHandler = _wrapAsStandardMouseEvent(getWindow(node), handler);\n\n\treturn addDisposableGenericMouseUpListener(node, wrapHandler, useCapture);\n};\nexport function addDisposableGenericMouseDownListener(node: EventTarget, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\treturn addDisposableListener(node, platform.isIOS && BrowserFeatures.pointerEvents ? EventType.POINTER_DOWN : EventType.MOUSE_DOWN, handler, useCapture);\n}\n\nexport function addDisposableGenericMouseMoveListener(node: EventTarget, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\treturn addDisposableListener(node, platform.isIOS && BrowserFeatures.pointerEvents ? EventType.POINTER_MOVE : EventType.MOUSE_MOVE, handler, useCapture);\n}\n\nexport function addDisposableGenericMouseUpListener(node: EventTarget, handler: (event: any) => void, useCapture?: boolean): IDisposable {\n\treturn addDisposableListener(node, platform.isIOS && BrowserFeatures.pointerEvents ? EventType.POINTER_UP : EventType.MOUSE_UP, handler, useCapture);\n}\n\n/**\n * Execute the callback the next time the browser is idle, returning an\n * {@link IDisposable} that will cancel the callback when disposed. This wraps\n * [requestIdleCallback] so it will fallback to [setTimeout] if the environment\n * doesn't support it.\n *\n * @param targetWindow The window for which to run the idle callback\n * @param callback The callback to run when idle, this includes an\n * [IdleDeadline] that provides the time alloted for the idle callback by the\n * browser. Not respecting this deadline will result in a degraded user\n * experience.\n * @param timeout A timeout at which point to queue no longer wait for an idle\n * callback but queue it on the regular event loop (like setTimeout). Typically\n * this should not be used.\n *\n * [IdleDeadline]: https://developer.mozilla.org/en-US/docs/Web/API/IdleDeadline\n * [requestIdleCallback]: https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback\n * [setTimeout]: https://developer.mozilla.org/en-US/docs/Web/API/Window/setTimeout\n */\nexport function runWhenWindowIdle(targetWindow: Window | typeof globalThis, callback: (idle: IdleDeadline) => void, timeout?: number): IDisposable {\n\treturn _runWhenIdle(targetWindow, callback, timeout);\n}\n\n/**\n * An implementation of the \"idle-until-urgent\"-strategy as introduced\n * here: https://philipwalton.com/articles/idle-until-urgent/\n */\nexport class WindowIdleValue<T> extends AbstractIdleValue<T> {\n\tconstructor(targetWindow: Window | typeof globalThis, executor: () => T) {\n\t\tsuper(targetWindow, executor);\n\t}\n}\n\n/**\n * Schedule a callback to be run at the next animation frame.\n * This allows multiple parties to register callbacks that should run at the next animation frame.\n * If currently in an animation frame, `runner` will be executed immediately.\n * @return token that can be used to cancel the scheduled runner (only if `runner` was not executed immediately).\n */\nexport let runAtThisOrScheduleAtNextAnimationFrame: (targetWindow: Window, runner: () => void, priority?: number) => IDisposable;\n/**\n * Schedule a callback to be run at the next animation frame.\n * This allows multiple parties to register callbacks that should run at the next animation frame.\n * If currently in an animation frame, `runner` will be executed at the next animation frame.\n * @return token that can be used to cancel the scheduled runner.\n */\nexport let scheduleAtNextAnimationFrame: (targetWindow: Window, runner: () => void, priority?: number) => IDisposable;\n\nexport function disposableWindowInterval(targetWindow: Window, handler: () => void | boolean /* stop interval */ | Promise<unknown>, interval: number, iterations?: number): IDisposable {\n\tlet iteration = 0;\n\tconst timer = targetWindow.setInterval(() => {\n\t\titeration++;\n\t\tif ((typeof iterations === 'number' && iteration >= iterations) || handler() === true) {\n\t\t\tdisposable.dispose();\n\t\t}\n\t}, interval);\n\tconst disposable = toDisposable(() => {\n\t\ttargetWindow.clearInterval(timer);\n\t});\n\treturn disposable;\n}\n\nexport class WindowIntervalTimer extends IntervalTimer {\n\n\tprivate readonly defaultTarget?: Window & typeof globalThis;\n\n\t/**\n\t *\n\t * @param node The optional node from which the target window is determined\n\t */\n\tconstructor(node?: Node) {\n\t\tsuper();\n\t\tthis.defaultTarget = node && getWindow(node);\n\t}\n\n\toverride cancelAndSet(runner: () => void, interval: number, targetWindow?: Window & typeof globalThis): void {\n\t\treturn super.cancelAndSet(runner, interval, targetWindow ?? this.defaultTarget);\n\t}\n}\n\nclass AnimationFrameQueueItem implements IDisposable {\n\n\tprivate _runner: () => void;\n\tpublic priority: number;\n\tprivate _canceled: boolean;\n\n\tconstructor(runner: () => void, priority: number = 0) {\n\t\tthis._runner = runner;\n\t\tthis.priority = priority;\n\t\tthis._canceled = false;\n\t}\n\n\tdispose(): void {\n\t\tthis._canceled = true;\n\t}\n\n\texecute(): void {\n\t\tif (this._canceled) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tthis._runner();\n\t\t} catch (e) {\n\t\t\tonUnexpectedError(e);\n\t\t}\n\t}\n\n\t// Sort by priority (largest to lowest)\n\tstatic sort(a: AnimationFrameQueueItem, b: AnimationFrameQueueItem): number {\n\t\treturn b.priority - a.priority;\n\t}\n}\n\n(function () {\n\t/**\n\t * The runners scheduled at the next animation frame\n\t */\n\tconst NEXT_QUEUE = new Map<number /* window ID */, AnimationFrameQueueItem[]>();\n\t/**\n\t * The runners scheduled at the current animation frame\n\t */\n\tconst CURRENT_QUEUE = new Map<number /* window ID */, AnimationFrameQueueItem[]>();\n\t/**\n\t * A flag to keep track if the native requestAnimationFrame was already called\n\t */\n\tconst animFrameRequested = new Map<number /* window ID */, boolean>();\n\t/**\n\t * A flag to indicate if currently handling a native requestAnimationFrame callback\n\t */\n\tconst inAnimationFrameRunner = new Map<number /* window ID */, boolean>();\n\n\tconst animationFrameRunner = (targetWindowId: number) => {\n\t\tanimFrameRequested.set(targetWindowId, false);\n\n\t\tconst currentQueue = NEXT_QUEUE.get(targetWindowId) ?? [];\n\t\tCURRENT_QUEUE.set(targetWindowId, currentQueue);\n\t\tNEXT_QUEUE.set(targetWindowId, []);\n\n\t\tinAnimationFrameRunner.set(targetWindowId, true);\n\t\twhile (currentQueue.length > 0) {\n\t\t\tcurrentQueue.sort(AnimationFrameQueueItem.sort);\n\t\t\tconst top = currentQueue.shift()!;\n\t\t\ttop.execute();\n\t\t}\n\t\tinAnimationFrameRunner.set(targetWindowId, false);\n\t};\n\n\tscheduleAtNextAnimationFrame = (targetWindow: Window, runner: () => void, priority: number = 0) => {\n\t\tconst targetWindowId = getWindowId(targetWindow);\n\t\tconst item = new AnimationFrameQueueItem(runner, priority);\n\n\t\tlet nextQueue = NEXT_QUEUE.get(targetWindowId);\n\t\tif (!nextQueue) {\n\t\t\tnextQueue = [];\n\t\t\tNEXT_QUEUE.set(targetWindowId, nextQueue);\n\t\t}\n\t\tnextQueue.push(item);\n\n\t\tif (!animFrameRequested.get(targetWindowId)) {\n\t\t\tanimFrameRequested.set(targetWindowId, true);\n\t\t\ttargetWindow.requestAnimationFrame(() => animationFrameRunner(targetWindowId));\n\t\t}\n\n\t\treturn item;\n\t};\n\n\trunAtThisOrScheduleAtNextAnimationFrame = (targetWindow: Window, runner: () => void, priority?: number) => {\n\t\tconst targetWindowId = getWindowId(targetWindow);\n\t\tif (inAnimationFrameRunner.get(targetWindowId)) {\n\t\t\tconst item = new AnimationFrameQueueItem(runner, priority);\n\t\t\tlet currentQueue = CURRENT_QUEUE.get(targetWindowId);\n\t\t\tif (!currentQueue) {\n\t\t\t\tcurrentQueue = [];\n\t\t\t\tCURRENT_QUEUE.set(targetWindowId, currentQueue);\n\t\t\t}\n\t\t\tcurrentQueue.push(item);\n\t\t\treturn item;\n\t\t} else {\n\t\t\treturn scheduleAtNextAnimationFrame(targetWindow, runner, priority);\n\t\t}\n\t};\n})();\n\nexport function measure(targetWindow: Window, callback: () => void): IDisposable {\n\treturn scheduleAtNextAnimationFrame(targetWindow, callback, 10000 /* must be early */);\n}\n\nexport function modify(targetWindow: Window, callback: () => void): IDisposable {\n\treturn scheduleAtNextAnimationFrame(targetWindow, callback, -10000 /* must be late */);\n}\n\n/**\n * Add a throttled listener. `handler` is fired at most every 8.33333ms or with the next animation frame (if browser supports it).\n */\nexport interface IEventMerger<R, E> {\n\t(lastEvent: R | null, currentEvent: E): R;\n}\n\nconst MINIMUM_TIME_MS = 8;\nconst DEFAULT_EVENT_MERGER: IEventMerger<Event, Event> = function (lastEvent: Event | null, currentEvent: Event) {\n\treturn currentEvent;\n};\n\nclass TimeoutThrottledDomListener<R, E extends Event> extends Disposable {\n\n\tconstructor(node: any, type: string, handler: (event: R) => void, eventMerger: IEventMerger<R, E> = <any>DEFAULT_EVENT_MERGER, minimumTimeMs: number = MINIMUM_TIME_MS) {\n\t\tsuper();\n\n\t\tlet lastEvent: R | null = null;\n\t\tlet lastHandlerTime = 0;\n\t\tconst timeout = this._register(new TimeoutTimer());\n\n\t\tconst invokeHandler = () => {\n\t\t\tlastHandlerTime = (new Date()).getTime();\n\t\t\thandler(<R>lastEvent);\n\t\t\tlastEvent = null;\n\t\t};\n\n\t\tthis._register(addDisposableListener(node, type, (e) => {\n\n\t\t\tlastEvent = eventMerger(lastEvent, e);\n\t\t\tconst elapsedTime = (new Date()).getTime() - lastHandlerTime;\n\n\t\t\tif (elapsedTime >= minimumTimeMs) {\n\t\t\t\ttimeout.cancel();\n\t\t\t\tinvokeHandler();\n\t\t\t} else {\n\t\t\t\ttimeout.setIfNotSet(invokeHandler, minimumTimeMs - elapsedTime);\n\t\t\t}\n\t\t}));\n\t}\n}\n\nexport function addDisposableThrottledListener<R, E extends Event = Event>(node: any, type: string, handler: (event: R) => void, eventMerger?: IEventMerger<R, E>, minimumTimeMs?: number): IDisposable {\n\treturn new TimeoutThrottledDomListener<R, E>(node, type, handler, eventMerger, minimumTimeMs);\n}\n\nexport function getComputedStyle(el: HTMLElement): CSSStyleDeclaration {\n\treturn getWindow(el).getComputedStyle(el, null);\n}\n\nexport function getClientArea(element: HTMLElement, fallback?: HTMLElement): Dimension {\n\tconst elWindow = getWindow(element);\n\tconst elDocument = elWindow.document;\n\n\t// Try with DOM clientWidth / clientHeight\n\tif (element !== elDocument.body) {\n\t\treturn new Dimension(element.clientWidth, element.clientHeight);\n\t}\n\n\t// If visual view port exits and it's on mobile, it should be used instead of window innerWidth / innerHeight, or document.body.clientWidth / document.body.clientHeight\n\tif (platform.isIOS && elWindow?.visualViewport) {\n\t\treturn new Dimension(elWindow.visualViewport.width, elWindow.visualViewport.height);\n\t}\n\n\t// Try innerWidth / innerHeight\n\tif (elWindow?.innerWidth && elWindow.innerHeight) {\n\t\treturn new Dimension(elWindow.innerWidth, elWindow.innerHeight);\n\t}\n\n\t// Try with document.body.clientWidth / document.body.clientHeight\n\tif (elDocument.body && elDocument.body.clientWidth && elDocument.body.clientHeight) {\n\t\treturn new Dimension(elDocument.body.clientWidth, elDocument.body.clientHeight);\n\t}\n\n\t// Try with document.documentElement.clientWidth / document.documentElement.clientHeight\n\tif (elDocument.documentElement && elDocument.documentElement.clientWidth && elDocument.documentElement.clientHeight) {\n\t\treturn new Dimension(elDocument.documentElement.clientWidth, elDocument.documentElement.clientHeight);\n\t}\n\n\tif (fallback) {\n\t\treturn getClientArea(fallback);\n\t}\n\n\tthrow new Error('Unable to figure out browser width and height');\n}\n\nclass SizeUtils {\n\t// Adapted from WinJS\n\t// Converts a CSS positioning string for the specified element to pixels.\n\tprivate static convertToPixels(element: HTMLElement, value: string): number {\n\t\treturn parseFloat(value) || 0;\n\t}\n\n\tprivate static getDimension(element: HTMLElement, cssPropertyName: string, jsPropertyName: string): number {\n\t\tconst computedStyle = getComputedStyle(element);\n\t\tconst value = computedStyle ? computedStyle.getPropertyValue(cssPropertyName) : '0';\n\t\treturn SizeUtils.convertToPixels(element, value);\n\t}\n\n\tstatic getBorderLeftWidth(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'border-left-width', 'borderLeftWidth');\n\t}\n\tstatic getBorderRightWidth(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'border-right-width', 'borderRightWidth');\n\t}\n\tstatic getBorderTopWidth(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'border-top-width', 'borderTopWidth');\n\t}\n\tstatic getBorderBottomWidth(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'border-bottom-width', 'borderBottomWidth');\n\t}\n\n\tstatic getPaddingLeft(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'padding-left', 'paddingLeft');\n\t}\n\tstatic getPaddingRight(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'padding-right', 'paddingRight');\n\t}\n\tstatic getPaddingTop(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'padding-top', 'paddingTop');\n\t}\n\tstatic getPaddingBottom(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'padding-bottom', 'paddingBottom');\n\t}\n\n\tstatic getMarginLeft(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'margin-left', 'marginLeft');\n\t}\n\tstatic getMarginTop(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'margin-top', 'marginTop');\n\t}\n\tstatic getMarginRight(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'margin-right', 'marginRight');\n\t}\n\tstatic getMarginBottom(element: HTMLElement): number {\n\t\treturn SizeUtils.getDimension(element, 'margin-bottom', 'marginBottom');\n\t}\n}\n\n// ----------------------------------------------------------------------------------------\n// Position & Dimension\n\nexport interface IDimension {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nexport class Dimension implements IDimension {\n\n\tstatic readonly None = new Dimension(0, 0);\n\n\tconstructor(\n\t\treadonly width: number,\n\t\treadonly height: number,\n\t) { }\n\n\twith(width: number = this.width, height: number = this.height): Dimension {\n\t\tif (width !== this.width || height !== this.height) {\n\t\t\treturn new Dimension(width, height);\n\t\t} else {\n\t\t\treturn this;\n\t\t}\n\t}\n\n\tstatic is(obj: unknown): obj is IDimension {\n\t\treturn typeof obj === 'object' && typeof (<IDimension>obj).height === 'number' && typeof (<IDimension>obj).width === 'number';\n\t}\n\n\tstatic lift(obj: IDimension): Dimension {\n\t\tif (obj instanceof Dimension) {\n\t\t\treturn obj;\n\t\t} else {\n\t\t\treturn new Dimension(obj.width, obj.height);\n\t\t}\n\t}\n\n\tstatic equals(a: Dimension | undefined, b: Dimension | undefined): boolean {\n\t\tif (a === b) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!a || !b) {\n\t\t\treturn false;\n\t\t}\n\t\treturn a.width === b.width && a.height === b.height;\n\t}\n}\n\nexport interface IDomPosition {\n\treadonly left: number;\n\treadonly top: number;\n}\n\nexport function getTopLeftOffset(element: HTMLElement): IDomPosition {\n\t// Adapted from WinJS.Utilities.getPosition\n\t// and added borders to the mix\n\n\tlet offsetParent = element.offsetParent;\n\tlet top = element.offsetTop;\n\tlet left = element.offsetLeft;\n\n\twhile (\n\t\t(element = <HTMLElement>element.parentNode) !== null\n\t\t&& element !== element.ownerDocument.body\n\t\t&& element !== element.ownerDocument.documentElement\n\t) {\n\t\ttop -= element.scrollTop;\n\t\tconst c = isShadowRoot(element) ? null : getComputedStyle(element);\n\t\tif (c) {\n\t\t\tleft -= c.direction !== 'rtl' ? element.scrollLeft : -element.scrollLeft;\n\t\t}\n\n\t\tif (element === offsetParent) {\n\t\t\tleft += SizeUtils.getBorderLeftWidth(element);\n\t\t\ttop += SizeUtils.getBorderTopWidth(element);\n\t\t\ttop += element.offsetTop;\n\t\t\tleft += element.offsetLeft;\n\t\t\toffsetParent = element.offsetParent;\n\t\t}\n\t}\n\n\treturn {\n\t\tleft: left,\n\t\ttop: top\n\t};\n}\n\nexport interface IDomNodePagePosition {\n\tleft: number;\n\ttop: number;\n\twidth: number;\n\theight: number;\n}\n\nexport function size(element: HTMLElement, width: number | null, height: number | null): void {\n\tif (typeof width === 'number') {\n\t\telement.style.width = `${width}px`;\n\t}\n\n\tif (typeof height === 'number') {\n\t\telement.style.height = `${height}px`;\n\t}\n}\n\nexport function position(element: HTMLElement, top: number, right?: number, bottom?: number, left?: number, position: string = 'absolute'): void {\n\tif (typeof top === 'number') {\n\t\telement.style.top = `${top}px`;\n\t}\n\n\tif (typeof right === 'number') {\n\t\telement.style.right = `${right}px`;\n\t}\n\n\tif (typeof bottom === 'number') {\n\t\telement.style.bottom = `${bottom}px`;\n\t}\n\n\tif (typeof left === 'number') {\n\t\telement.style.left = `${left}px`;\n\t}\n\n\telement.style.position = position;\n}\n\n/**\n * Returns the position of a dom node relative to the entire page.\n */\nexport function getDomNodePagePosition(domNode: HTMLElement): IDomNodePagePosition {\n\tconst bb = domNode.getBoundingClientRect();\n\tconst window = getWindow(domNode);\n\treturn {\n\t\tleft: bb.left + window.scrollX,\n\t\ttop: bb.top + window.scrollY,\n\t\twidth: bb.width,\n\t\theight: bb.height\n\t};\n}\n\n/**\n * Returns the effective zoom on a given element before window zoom level is applied\n */\nexport function getDomNodeZoomLevel(domNode: HTMLElement): number {\n\tlet testElement: HTMLElement | null = domNode;\n\tlet zoom = 1.0;\n\tdo {\n\t\tconst elementZoomLevel = (getComputedStyle(testElement) as any).zoom;\n\t\tif (elementZoomLevel !== null && elementZoomLevel !== undefined && elementZoomLevel !== '1') {\n\t\t\tzoom *= elementZoomLevel;\n\t\t}\n\n\t\ttestElement = testElement.parentElement;\n\t} while (testElement !== null && testElement !== testElement.ownerDocument.documentElement);\n\n\treturn zoom;\n}\n\n\n// Adapted from WinJS\n// Gets the width of the element, including margins.\nexport function getTotalWidth(element: HTMLElement): number {\n\tconst margin = SizeUtils.getMarginLeft(element) + SizeUtils.getMarginRight(element);\n\treturn element.offsetWidth + margin;\n}\n\nexport function getContentWidth(element: HTMLElement): number {\n\tconst border = SizeUtils.getBorderLeftWidth(element) + SizeUtils.getBorderRightWidth(element);\n\tconst padding = SizeUtils.getPaddingLeft(element) + SizeUtils.getPaddingRight(element);\n\treturn element.offsetWidth - border - padding;\n}\n\nexport function getTotalScrollWidth(element: HTMLElement): number {\n\tconst margin = SizeUtils.getMarginLeft(element) + SizeUtils.getMarginRight(element);\n\treturn element.scrollWidth + margin;\n}\n\n// Adapted from WinJS\n// Gets the height of the content of the specified element. The content height does not include borders or padding.\nexport function getContentHeight(element: HTMLElement): number {\n\tconst border = SizeUtils.getBorderTopWidth(element) + SizeUtils.getBorderBottomWidth(element);\n\tconst padding = SizeUtils.getPaddingTop(element) + SizeUtils.getPaddingBottom(element);\n\treturn element.offsetHeight - border - padding;\n}\n\n// Adapted from WinJS\n// Gets the height of the element, including its margins.\nexport function getTotalHeight(element: HTMLElement): number {\n\tconst margin = SizeUtils.getMarginTop(element) + SizeUtils.getMarginBottom(element);\n\treturn element.offsetHeight + margin;\n}\n\n// Gets the left coordinate of the specified element relative to the specified parent.\nfunction getRelativeLeft(element: HTMLElement, parent: HTMLElement): number {\n\tif (element === null) {\n\t\treturn 0;\n\t}\n\n\tconst elementPosition = getTopLeftOffset(element);\n\tconst parentPosition = getTopLeftOffset(parent);\n\treturn elementPosition.left - parentPosition.left;\n}\n\nexport function getLargestChildWidth(parent: HTMLElement, children: HTMLElement[]): number {\n\tconst childWidths = children.map((child) => {\n\t\treturn Math.max(getTotalScrollWidth(child), getTotalWidth(child)) + getRelativeLeft(child, parent) || 0;\n\t});\n\tconst maxWidth = Math.max(...childWidths);\n\treturn maxWidth;\n}\n\n// ----------------------------------------------------------------------------------------\n\nexport function isAncestor(testChild: Node | null, testAncestor: Node | null): boolean {\n\treturn Boolean(testAncestor?.contains(testChild));\n}\n\nconst parentFlowToDataKey = 'parentFlowToElementId';\n\n/**\n * Set an explicit parent to use for nodes that are not part of the\n * regular dom structure.\n */\nexport function setParentFlowTo(fromChildElement: HTMLElement, toParentElement: Element): void {\n\tfromChildElement.dataset[parentFlowToDataKey] = toParentElement.id;\n}\n\nfunction getParentFlowToElement(node: HTMLElement): HTMLElement | null {\n\tconst flowToParentId = node.dataset[parentFlowToDataKey];\n\tif (typeof flowToParentId === 'string') {\n\t\treturn node.ownerDocument.getElementById(flowToParentId);\n\t}\n\treturn null;\n}\n\n/**\n * Check if `testAncestor` is an ancestor of `testChild`, observing the explicit\n * parents set by `setParentFlowTo`.\n */\nexport function isAncestorUsingFlowTo(testChild: Node, testAncestor: Node): boolean {\n\tlet node: Node | null = testChild;\n\twhile (node) {\n\t\tif (node === testAncestor) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (isHTMLElement(node)) {\n\t\t\tconst flowToParentElement = getParentFlowToElement(node);\n\t\t\tif (flowToParentElement) {\n\t\t\t\tnode = flowToParentElement;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tnode = node.parentNode;\n\t}\n\n\treturn false;\n}\n\nexport function findParentWithClass(node: HTMLElement, clazz: string, stopAtClazzOrNode?: string | HTMLElement): HTMLElement | null {\n\twhile (node && node.nodeType === node.ELEMENT_NODE) {\n\t\tif (node.classList.contains(clazz)) {\n\t\t\treturn node;\n\t\t}\n\n\t\tif (stopAtClazzOrNode) {\n\t\t\tif (typeof stopAtClazzOrNode === 'string') {\n\t\t\t\tif (node.classList.contains(stopAtClazzOrNode)) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (node === stopAtClazzOrNode) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tnode = <HTMLElement>node.parentNode;\n\t}\n\n\treturn null;\n}\n\nexport function hasParentWithClass(node: HTMLElement, clazz: string, stopAtClazzOrNode?: string | HTMLElement): boolean {\n\treturn !!findParentWithClass(node, clazz, stopAtClazzOrNode);\n}\n\nexport function isShadowRoot(node: Node): node is ShadowRoot {\n\treturn (\n\t\tnode && !!(<ShadowRoot>node).host && !!(<ShadowRoot>node).mode\n\t);\n}\n\nexport function isInShadowDOM(domNode: Node): boolean {\n\treturn !!getShadowRoot(domNode);\n}\n\nexport function getShadowRoot(domNode: Node): ShadowRoot | null {\n\twhile (domNode.parentNode) {\n\t\tif (domNode === domNode.ownerDocument?.body) {\n\t\t\t// reached the body\n\t\t\treturn null;\n\t\t}\n\t\tdomNode = domNode.parentNode;\n\t}\n\treturn isShadowRoot(domNode) ? domNode : null;\n}\n\n/**\n * Returns the active element across all child windows\n * based on document focus. Falls back to the main\n * window if no window has focus.\n */\nexport function getActiveElement(): Element | null {\n\tlet result = getActiveDocument().activeElement;\n\n\twhile (result?.shadowRoot) {\n\t\tresult = result.shadowRoot.activeElement;\n\t}\n\n\treturn result;\n}\n\n/**\n * Returns true if the focused window active element matches\n * the provided element. Falls back to the main window if no\n * window has focus.\n */\nexport function isActiveElement(element: Element): boolean {\n\treturn getActiveElement() === element;\n}\n\n/**\n * Returns true if the focused window active element is contained in\n * `ancestor`. Falls back to the main window if no window has focus.\n */\nexport function isAncestorOfActiveElement(ancestor: Element): boolean {\n\treturn isAncestor(getActiveElement(), ancestor);\n}\n\n/**\n * Returns whether the element is in the active `document`. The active\n * document has focus or will be the main windows document.\n */\nexport function isActiveDocument(element: Element): boolean {\n\treturn element.ownerDocument === getActiveDocument();\n}\n\n/**\n * Returns the active document across main and child windows.\n * Prefers the window with focus, otherwise falls back to\n * the main windows document.\n */\nexport function getActiveDocument(): Document {\n\tif (getWindowsCount() <= 1) {\n\t\treturn mainWindow.document;\n\t}\n\n\tconst documents = Array.from(getWindows()).map(({ window }) => window.document);\n\treturn documents.find(doc => doc.hasFocus()) ?? mainWindow.document;\n}\n\n/**\n * Returns the active window across main and child windows.\n * Prefers the window with focus, otherwise falls back to\n * the main window.\n */\nexport function getActiveWindow(): CodeWindow {\n\tconst document = getActiveDocument();\n\treturn (document.defaultView?.window ?? mainWindow) as CodeWindow;\n}\n\nconst globalStylesheets = new Map<HTMLStyleElement /* main stylesheet */, Set<HTMLStyleElement /* aux window clones that track the main stylesheet */>>();\n\nexport function isGlobalStylesheet(node: Node): boolean {\n\treturn globalStylesheets.has(node as HTMLStyleElement);\n}\n\n/**\n * A version of createStyleSheet which has a unified API to initialize/set the style content.\n */\nexport function createStyleSheet2(): WrappedStyleElement {\n\treturn new WrappedStyleElement();\n}\n\nclass WrappedStyleElement {\n\tprivate _currentCssStyle = '';\n\tprivate _styleSheet: HTMLStyleElement | undefined = undefined;\n\n\tpublic setStyle(cssStyle: string): void {\n\t\tif (cssStyle === this._currentCssStyle) {\n\t\t\treturn;\n\t\t}\n\t\tthis._currentCssStyle = cssStyle;\n\n\t\tif (!this._styleSheet) {\n\t\t\tthis._styleSheet = createStyleSheet(mainWindow.document.head, (s) => s.innerText = cssStyle);\n\t\t} else {\n\t\t\tthis._styleSheet.innerText = cssStyle;\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this._styleSheet) {\n\t\t\tthis._styleSheet.remove();\n\t\t\tthis._styleSheet = undefined;\n\t\t}\n\t}\n}\n\nexport function createStyleSheet(container: HTMLElement = mainWindow.document.head, beforeAppend?: (style: HTMLStyleElement) => void, disposableStore?: DisposableStore): HTMLStyleElement {\n\tconst style = document.createElement('style');\n\tstyle.type = 'text/css';\n\tstyle.media = 'screen';\n\tbeforeAppend?.(style);\n\tcontainer.appendChild(style);\n\n\tif (disposableStore) {\n\t\tdisposableStore.add(toDisposable(() => style.remove()));\n\t}\n\n\t// With <head> as container, the stylesheet becomes global and is tracked\n\t// to support auxiliary windows to clone the stylesheet.\n\tif (container === mainWindow.document.head) {\n\t\tconst globalStylesheetClones = new Set<HTMLStyleElement>();\n\t\tglobalStylesheets.set(style, globalStylesheetClones);\n\n\t\tfor (const { window: targetWindow, disposables } of getWindows()) {\n\t\t\tif (targetWindow === mainWindow) {\n\t\t\t\tcontinue; // main window is already tracked\n\t\t\t}\n\n\t\t\tconst cloneDisposable = disposables.add(cloneGlobalStyleSheet(style, globalStylesheetClones, targetWindow));\n\t\t\tdisposableStore?.add(cloneDisposable);\n\t\t}\n\t}\n\n\treturn style;\n}\n\nexport function cloneGlobalStylesheets(targetWindow: Window): IDisposable {\n\tconst disposables = new DisposableStore();\n\n\tfor (const [globalStylesheet, clonedGlobalStylesheets] of globalStylesheets) {\n\t\tdisposables.add(cloneGlobalStyleSheet(globalStylesheet, clonedGlobalStylesheets, targetWindow));\n\t}\n\n\treturn disposables;\n}\n\nfunction cloneGlobalStyleSheet(globalStylesheet: HTMLStyleElement, globalStylesheetClones: Set<HTMLStyleElement>, targetWindow: Window): IDisposable {\n\tconst disposables = new DisposableStore();\n\n\tconst clone = globalStylesheet.cloneNode(true) as HTMLStyleElement;\n\ttargetWindow.document.head.appendChild(clone);\n\tdisposables.add(toDisposable(() => clone.remove()));\n\n\tfor (const rule of getDynamicStyleSheetRules(globalStylesheet)) {\n\t\tclone.sheet?.insertRule(rule.cssText, clone.sheet?.cssRules.length);\n\t}\n\n\tdisposables.add(sharedMutationObserver.observe(globalStylesheet, disposables, { childList: true })(() => {\n\t\tclone.textContent = globalStylesheet.textContent;\n\t}));\n\n\tglobalStylesheetClones.add(clone);\n\tdisposables.add(toDisposable(() => globalStylesheetClones.delete(clone)));\n\n\treturn disposables;\n}\n\ninterface IMutationObserver {\n\tusers: number;\n\treadonly observer: MutationObserver;\n\treadonly onDidMutate: event.Event<MutationRecord[]>;\n}\n\nexport const sharedMutationObserver = new class {\n\n\treadonly mutationObservers = new Map<Node, Map<number, IMutationObserver>>();\n\n\tobserve(target: Node, disposables: DisposableStore, options?: MutationObserverInit): event.Event<MutationRecord[]> {\n\t\tlet mutationObserversPerTarget = this.mutationObservers.get(target);\n\t\tif (!mutationObserversPerTarget) {\n\t\t\tmutationObserversPerTarget = new Map<number, IMutationObserver>();\n\t\t\tthis.mutationObservers.set(target, mutationObserversPerTarget);\n\t\t}\n\n\t\tconst optionsHash = hash(options);\n\t\tlet mutationObserverPerOptions = mutationObserversPerTarget.get(optionsHash);\n\t\tif (!mutationObserverPerOptions) {\n\t\t\tconst onDidMutate = new event.Emitter<MutationRecord[]>();\n\t\t\tconst observer = new MutationObserver(mutations => onDidMutate.fire(mutations));\n\t\t\tobserver.observe(target, options);\n\n\t\t\tconst resolvedMutationObserverPerOptions = mutationObserverPerOptions = {\n\t\t\t\tusers: 1,\n\t\t\t\tobserver,\n\t\t\t\tonDidMutate: onDidMutate.event\n\t\t\t};\n\n\t\t\tdisposables.add(toDisposable(() => {\n\t\t\t\tresolvedMutationObserverPerOptions.users -= 1;\n\n\t\t\t\tif (resolvedMutationObserverPerOptions.users === 0) {\n\t\t\t\t\tonDidMutate.dispose();\n\t\t\t\t\tobserver.disconnect();\n\n\t\t\t\t\tmutationObserversPerTarget?.delete(optionsHash);\n\t\t\t\t\tif (mutationObserversPerTarget?.size === 0) {\n\t\t\t\t\t\tthis.mutationObservers.delete(target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tmutationObserversPerTarget.set(optionsHash, mutationObserverPerOptions);\n\t\t} else {\n\t\t\tmutationObserverPerOptions.users += 1;\n\t\t}\n\n\t\treturn mutationObserverPerOptions.onDidMutate;\n\t}\n};\n\nexport function createMetaElement(container: HTMLElement = mainWindow.document.head): HTMLMetaElement {\n\treturn createHeadElement('meta', container) as HTMLMetaElement;\n}\n\nexport function createLinkElement(container: HTMLElement = mainWindow.document.head): HTMLLinkElement {\n\treturn createHeadElement('link', container) as HTMLLinkElement;\n}\n\nfunction createHeadElement(tagName: string, container: HTMLElement = mainWindow.document.head): HTMLElement {\n\tconst element = document.createElement(tagName);\n\tcontainer.appendChild(element);\n\treturn element;\n}\n\nlet _sharedStyleSheet: HTMLStyleElement | null = null;\nfunction getSharedStyleSheet(): HTMLStyleElement {\n\tif (!_sharedStyleSheet) {\n\t\t_sharedStyleSheet = createStyleSheet();\n\t}\n\treturn _sharedStyleSheet;\n}\n\nfunction getDynamicStyleSheetRules(style: HTMLStyleElement) {\n\tif (style?.sheet?.rules) {\n\t\t// Chrome, IE\n\t\treturn style.sheet.rules;\n\t}\n\tif (style?.sheet?.cssRules) {\n\t\t// FF\n\t\treturn style.sheet.cssRules;\n\t}\n\treturn [];\n}\n\nexport function createCSSRule(selector: string, cssText: string, style = getSharedStyleSheet()): void {\n\tif (!style || !cssText) {\n\t\treturn;\n\t}\n\n\tstyle.sheet?.insertRule(`${selector} {${cssText}}`, 0);\n\n\t// Apply rule also to all cloned global stylesheets\n\tfor (const clonedGlobalStylesheet of globalStylesheets.get(style) ?? []) {\n\t\tcreateCSSRule(selector, cssText, clonedGlobalStylesheet);\n\t}\n}\n\nexport function removeCSSRulesContainingSelector(ruleName: string, style = getSharedStyleSheet()): void {\n\tif (!style) {\n\t\treturn;\n\t}\n\n\tconst rules = getDynamicStyleSheetRules(style);\n\tconst toDelete: number[] = [];\n\tfor (let i = 0; i < rules.length; i++) {\n\t\tconst rule = rules[i];\n\t\tif (isCSSStyleRule(rule) && rule.selectorText.indexOf(ruleName) !== -1) {\n\t\t\ttoDelete.push(i);\n\t\t}\n\t}\n\n\tfor (let i = toDelete.length - 1; i >= 0; i--) {\n\t\tstyle.sheet?.deleteRule(toDelete[i]);\n\t}\n\n\t// Remove rules also from all cloned global stylesheets\n\tfor (const clonedGlobalStylesheet of globalStylesheets.get(style) ?? []) {\n\t\tremoveCSSRulesContainingSelector(ruleName, clonedGlobalStylesheet);\n\t}\n}\n\nfunction isCSSStyleRule(rule: CSSRule): rule is CSSStyleRule {\n\treturn typeof (rule as CSSStyleRule).selectorText === 'string';\n}\n\nexport function isHTMLElement(e: unknown): e is HTMLElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof HTMLElement || e instanceof getWindow(e as Node).HTMLElement;\n}\n\nexport function isHTMLAnchorElement(e: unknown): e is HTMLAnchorElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof HTMLAnchorElement || e instanceof getWindow(e as Node).HTMLAnchorElement;\n}\n\nexport function isHTMLSpanElement(e: unknown): e is HTMLSpanElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof HTMLSpanElement || e instanceof getWindow(e as Node).HTMLSpanElement;\n}\n\nexport function isHTMLTextAreaElement(e: unknown): e is HTMLTextAreaElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof HTMLTextAreaElement || e instanceof getWindow(e as Node).HTMLTextAreaElement;\n}\n\nexport function isHTMLInputElement(e: unknown): e is HTMLInputElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof HTMLInputElement || e instanceof getWindow(e as Node).HTMLInputElement;\n}\n\nexport function isHTMLButtonElement(e: unknown): e is HTMLButtonElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof HTMLButtonElement || e instanceof getWindow(e as Node).HTMLButtonElement;\n}\n\nexport function isHTMLDivElement(e: unknown): e is HTMLDivElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof HTMLDivElement || e instanceof getWindow(e as Node).HTMLDivElement;\n}\n\nexport function isSVGElement(e: unknown): e is SVGElement {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof SVGElement || e instanceof getWindow(e as Node).SVGElement;\n}\n\nexport function isMouseEvent(e: unknown): e is MouseEvent {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof MouseEvent || e instanceof getWindow(e as UIEvent).MouseEvent;\n}\n\nexport function isKeyboardEvent(e: unknown): e is KeyboardEvent {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof KeyboardEvent || e instanceof getWindow(e as UIEvent).KeyboardEvent;\n}\n\nexport function isPointerEvent(e: unknown): e is PointerEvent {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof PointerEvent || e instanceof getWindow(e as UIEvent).PointerEvent;\n}\n\nexport function isDragEvent(e: unknown): e is DragEvent {\n\t// eslint-disable-next-line no-restricted-syntax\n\treturn e instanceof DragEvent || e instanceof getWindow(e as UIEvent).DragEvent;\n}\n\nexport const EventType = {\n\t// Mouse\n\tCLICK: 'click',\n\tAUXCLICK: 'auxclick',\n\tDBLCLICK: 'dblclick',\n\tMOUSE_UP: 'mouseup',\n\tMOUSE_DOWN: 'mousedown',\n\tMOUSE_OVER: 'mouseover',\n\tMOUSE_MOVE: 'mousemove',\n\tMOUSE_OUT: 'mouseout',\n\tMOUSE_ENTER: 'mouseenter',\n\tMOUSE_LEAVE: 'mouseleave',\n\tMOUSE_WHEEL: 'wheel',\n\tPOINTER_UP: 'pointerup',\n\tPOINTER_DOWN: 'pointerdown',\n\tPOINTER_MOVE: 'pointermove',\n\tPOINTER_LEAVE: 'pointerleave',\n\tCONTEXT_MENU: 'contextmenu',\n\tWHEEL: 'wheel',\n\t// Keyboard\n\tKEY_DOWN: 'keydown',\n\tKEY_PRESS: 'keypress',\n\tKEY_UP: 'keyup',\n\t// HTML Document\n\tLOAD: 'load',\n\tBEFORE_UNLOAD: 'beforeunload',\n\tUNLOAD: 'unload',\n\tPAGE_SHOW: 'pageshow',\n\tPAGE_HIDE: 'pagehide',\n\tPASTE: 'paste',\n\tABORT: 'abort',\n\tERROR: 'error',\n\tRESIZE: 'resize',\n\tSCROLL: 'scroll',\n\tFULLSCREEN_CHANGE: 'fullscreenchange',\n\tWK_FULLSCREEN_CHANGE: 'webkitfullscreenchange',\n\t// Form\n\tSELECT: 'select',\n\tCHANGE: 'change',\n\tSUBMIT: 'submit',\n\tRESET: 'reset',\n\tFOCUS: 'focus',\n\tFOCUS_IN: 'focusin',\n\tFOCUS_OUT: 'focusout',\n\tBLUR: 'blur',\n\tINPUT: 'input',\n\t// Local Storage\n\tSTORAGE: 'storage',\n\t// Drag\n\tDRAG_START: 'dragstart',\n\tDRAG: 'drag',\n\tDRAG_ENTER: 'dragenter',\n\tDRAG_LEAVE: 'dragleave',\n\tDRAG_OVER: 'dragover',\n\tDROP: 'drop',\n\tDRAG_END: 'dragend',\n\t// Animation\n\tANIMATION_START: browser.isWebKit ? 'webkitAnimationStart' : 'animationstart',\n\tANIMATION_END: browser.isWebKit ? 'webkitAnimationEnd' : 'animationend',\n\tANIMATION_ITERATION: browser.isWebKit ? 'webkitAnimationIteration' : 'animationiteration'\n} as const;\n\nexport interface EventLike {\n\tpreventDefault(): void;\n\tstopPropagation(): void;\n}\n\nexport function isEventLike(obj: unknown): obj is EventLike {\n\tconst candidate = obj as EventLike | undefined;\n\n\treturn !!(candidate && typeof candidate.preventDefault === 'function' && typeof candidate.stopPropagation === 'function');\n}\n\nexport const EventHelper = {\n\tstop: <T extends EventLike>(e: T, cancelBubble?: boolean): T => {\n\t\te.preventDefault();\n\t\tif (cancelBubble) {\n\t\t\te.stopPropagation();\n\t\t}\n\t\treturn e;\n\t}\n};\n\nexport interface IFocusTracker extends Disposable {\n\treadonly onDidFocus: event.Event<void>;\n\treadonly onDidBlur: event.Event<void>;\n\trefreshState(): void;\n}\n\nexport function saveParentsScrollTop(node: Element): number[] {\n\tconst r: number[] = [];\n\tfor (let i = 0; node && node.nodeType === node.ELEMENT_NODE; i++) {\n\t\tr[i] = node.scrollTop;\n\t\tnode = <Element>node.parentNode;\n\t}\n\treturn r;\n}\n\nexport function restoreParentsScrollTop(node: Element, state: number[]): void {\n\tfor (let i = 0; node && node.nodeType === node.ELEMENT_NODE; i++) {\n\t\tif (node.scrollTop !== state[i]) {\n\t\t\tnode.scrollTop = state[i];\n\t\t}\n\t\tnode = <Element>node.parentNode;\n\t}\n}\n\nclass FocusTracker extends Disposable implements IFocusTracker {\n\n\tprivate readonly _onDidFocus = this._register(new event.Emitter<void>());\n\treadonly onDidFocus = this._onDidFocus.event;\n\n\tprivate readonly _onDidBlur = this._register(new event.Emitter<void>());\n\treadonly onDidBlur = this._onDidBlur.event;\n\n\tprivate _refreshStateHandler: () => void;\n\n\tprivate static hasFocusWithin(element: HTMLElement | Window): boolean {\n\t\tif (isHTMLElement(element)) {\n\t\t\tconst shadowRoot = getShadowRoot(element);\n\t\t\tconst activeElement = (shadowRoot ? shadowRoot.activeElement : element.ownerDocument.activeElement);\n\t\t\treturn isAncestor(activeElement, element);\n\t\t} else {\n\t\t\tconst window = element;\n\t\t\treturn isAncestor(window.document.activeElement, window.document);\n\t\t}\n\t}\n\n\tconstructor(element: HTMLElement | Window) {\n\t\tsuper();\n\t\tlet hasFocus = FocusTracker.hasFocusWithin(element);\n\t\tlet loosingFocus = false;\n\n\t\tconst onFocus = () => {\n\t\t\tloosingFocus = false;\n\t\t\tif (!hasFocus) {\n\t\t\t\thasFocus = true;\n\t\t\t\tthis._onDidFocus.fire();\n\t\t\t}\n\t\t};\n\n\t\tconst onBlur = () => {\n\t\t\tif (hasFocus) {\n\t\t\t\tloosingFocus = true;\n\t\t\t\t(isHTMLElement(element) ? getWindow(element) : element).setTimeout(() => {\n\t\t\t\t\tif (loosingFocus) {\n\t\t\t\t\t\tloosingFocus = false;\n\t\t\t\t\t\thasFocus = false;\n\t\t\t\t\t\tthis._onDidBlur.fire();\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t};\n\n\t\tthis._refreshStateHandler = () => {\n\t\t\tconst currentNodeHasFocus = FocusTracker.hasFocusWithin(<HTMLElement>element);\n\t\t\tif (currentNodeHasFocus !== hasFocus) {\n\t\t\t\tif (hasFocus) {\n\t\t\t\t\tonBlur();\n\t\t\t\t} else {\n\t\t\t\t\tonFocus();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis._register(addDisposableListener(element, EventType.FOCUS, onFocus, true));\n\t\tthis._register(addDisposableListener(element, EventType.BLUR, onBlur, true));\n\t\tif (isHTMLElement(element)) {\n\t\t\tthis._register(addDisposableListener(element, EventType.FOCUS_IN, () => this._refreshStateHandler()));\n\t\t\tthis._register(addDisposableListener(element, EventType.FOCUS_OUT, () => this._refreshStateHandler()));\n\t\t}\n\n\t}\n\n\trefreshState() {\n\t\tthis._refreshStateHandler();\n\t}\n}\n\n/**\n * Creates a new `IFocusTracker` instance that tracks focus changes on the given `element` and its descendants.\n *\n * @param element The `HTMLElement` or `Window` to track focus changes on.\n * @returns An `IFocusTracker` instance.\n */\nexport function trackFocus(element: HTMLElement | Window): IFocusTracker {\n\treturn new FocusTracker(element);\n}\n\nexport function after<T extends Node>(sibling: HTMLElement, child: T): T {\n\tsibling.after(child);\n\treturn child;\n}\n\nexport function append<T extends Node>(parent: HTMLElement, child: T): T;\nexport function append<T extends Node>(parent: HTMLElement, ...children: (T | string)[]): void;\nexport function append<T extends Node>(parent: HTMLElement, ...children: (T | string)[]): T | void {\n\tparent.append(...children);\n\tif (children.length === 1 && typeof children[0] !== 'string') {\n\t\treturn <T>children[0];\n\t}\n}\n\nexport function prepend<T extends Node>(parent: HTMLElement, child: T): T {\n\tparent.insertBefore(child, parent.firstChild);\n\treturn child;\n}\n\n/**\n * Removes all children from `parent` and appends `children`\n */\nexport function reset(parent: HTMLElement, ...children: Array<Node | string>): void {\n\tparent.innerText = '';\n\tappend(parent, ...children);\n}\n\nconst SELECTOR_REGEX = /([\\w\\-]+)?(#([\\w\\-]+))?((\\.([\\w\\-]+))*)/;\n\nexport enum Namespace {\n\tHTML = 'http://www.w3.org/1999/xhtml',\n\tSVG = 'http://www.w3.org/2000/svg'\n}\n\nfunction _$<T extends Element>(namespace: Namespace, description: string, attrs?: { [key: string]: any }, ...children: Array<Node | string>): T {\n\tconst match = SELECTOR_REGEX.exec(description);\n\n\tif (!match) {\n\t\tthrow new Error('Bad use of emmet');\n\t}\n\n\tconst tagName = match[1] || 'div';\n\tlet result: T;\n\n\tif (namespace !== Namespace.HTML) {\n\t\tresult = document.createElementNS(namespace as string, tagName) as T;\n\t} else {\n\t\tresult = document.createElement(tagName) as unknown as T;\n\t}\n\n\tif (match[3]) {\n\t\tresult.id = match[3];\n\t}\n\tif (match[4]) {\n\t\tresult.className = match[4].replace(/\\./g, ' ').trim();\n\t}\n\n\tif (attrs) {\n\t\tObject.entries(attrs).forEach(([name, value]) => {\n\t\t\tif (typeof value === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (/^on\\w+$/.test(name)) {\n\t\t\t\t(<any>result)[name] = value;\n\t\t\t} else if (name === 'selected') {\n\t\t\t\tif (value) {\n\t\t\t\t\tresult.setAttribute(name, 'true');\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tresult.setAttribute(name, value);\n\t\t\t}\n\t\t});\n\t}\n\n\tresult.append(...children);\n\n\treturn result as T;\n}\n\nexport function $<T extends HTMLElement>(description: string, attrs?: { [key: string]: any }, ...children: Array<Node | string>): T {\n\treturn _$(Namespace.HTML, description, attrs, ...children);\n}\n\n$.SVG = function <T extends SVGElement>(description: string, attrs?: { [key: string]: any }, ...children: Array<Node | string>): T {\n\treturn _$(Namespace.SVG, description, attrs, ...children);\n};\n\nexport function join(nodes: Node[], separator: Node | string): Node[] {\n\tconst result: Node[] = [];\n\n\tnodes.forEach((node, index) => {\n\t\tif (index > 0) {\n\t\t\tif (separator instanceof Node) {\n\t\t\t\tresult.push(separator.cloneNode());\n\t\t\t} else {\n\t\t\t\tresult.push(document.createTextNode(separator));\n\t\t\t}\n\t\t}\n\n\t\tresult.push(node);\n\t});\n\n\treturn result;\n}\n\nexport function setVisibility(visible: boolean, ...elements: HTMLElement[]): void {\n\tif (visible) {\n\t\tshow(...elements);\n\t} else {\n\t\thide(...elements);\n\t}\n}\n\nexport function show(...elements: HTMLElement[]): void {\n\tfor (const element of elements) {\n\t\telement.style.display = '';\n\t\telement.removeAttribute('aria-hidden');\n\t}\n}\n\nexport function hide(...elements: HTMLElement[]): void {\n\tfor (const element of elements) {\n\t\telement.style.display = 'none';\n\t\telement.setAttribute('aria-hidden', 'true');\n\t}\n}\n\nfunction findParentWithAttribute(node: Node | null, attribute: string): HTMLElement | null {\n\twhile (node && node.nodeType === node.ELEMENT_NODE) {\n\t\tif (isHTMLElement(node) && node.hasAttribute(attribute)) {\n\t\t\treturn node;\n\t\t}\n\n\t\tnode = node.parentNode;\n\t}\n\n\treturn null;\n}\n\nexport function removeTabIndexAndUpdateFocus(node: HTMLElement): void {\n\tif (!node || !node.hasAttribute('tabIndex')) {\n\t\treturn;\n\t}\n\n\t// If we are the currently focused element and tabIndex is removed,\n\t// standard DOM behavior is to move focus to the <body> element. We\n\t// typically never want that, rather put focus to the closest element\n\t// in the hierarchy of the parent DOM nodes.\n\tif (node.ownerDocument.activeElement === node) {\n\t\tconst parentFocusable = findParentWithAttribute(node.parentElement, 'tabIndex');\n\t\tparentFocusable?.focus();\n\t}\n\n\tnode.removeAttribute('tabindex');\n}\n\nexport function finalHandler<T extends Event>(fn: (event: T) => any): (event: T) => any {\n\treturn e => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tfn(e);\n\t};\n}\n\nexport function domContentLoaded(targetWindow: Window): Promise<void> {\n\treturn new Promise<void>(resolve => {\n\t\tconst readyState = targetWindow.document.readyState;\n\t\tif (readyState === 'complete' || (targetWindow.document && targetWindow.document.body !== null)) {\n\t\t\tresolve(undefined);\n\t\t} else {\n\t\t\tconst listener = () => {\n\t\t\t\ttargetWindow.window.removeEventListener('DOMContentLoaded', listener, false);\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\ttargetWindow.window.addEventListener('DOMContentLoaded', listener, false);\n\t\t}\n\t});\n}\n\n/**\n * Find a value usable for a dom node size such that the likelihood that it would be\n * displayed with constant screen pixels size is as high as possible.\n *\n * e.g. We would desire for the cursors to be 2px (CSS px) wide. Under a devicePixelRatio\n * of 1.25, the cursor will be 2.5 screen pixels wide. Depending on how the dom node aligns/\"snaps\"\n * with the screen pixels, it will sometimes be rendered with 2 screen pixels, and sometimes with 3 screen pixels.\n */\nexport function computeScreenAwareSize(window: Window, cssPx: number): number {\n\tconst screenPx = window.devicePixelRatio * cssPx;\n\treturn Math.max(1, Math.floor(screenPx)) / window.devicePixelRatio;\n}\n\n/**\n * Open safely a new window. This is the best way to do so, but you cannot tell\n * if the window was opened or if it was blocked by the browser's popup blocker.\n * If you want to tell if the browser blocked the new window, use {@link windowOpenWithSuccess}.\n *\n * See https://github.com/microsoft/monaco-editor/issues/601\n * To protect against malicious code in the linked site, particularly phishing attempts,\n * the window.opener should be set to null to prevent the linked site from having access\n * to change the location of the current page.\n * See https://mathiasbynens.github.io/rel-noopener/\n */\nexport function windowOpenNoOpener(url: string): void {\n\t// By using 'noopener' in the `windowFeatures` argument, the newly created window will\n\t// not be able to use `window.opener` to reach back to the current page.\n\t// See https://stackoverflow.com/a/46958731\n\t// See https://developer.mozilla.org/en-US/docs/Web/API/Window/open#noopener\n\t// However, this also doesn't allow us to realize if the browser blocked\n\t// the creation of the window.\n\tmainWindow.open(url, '_blank', 'noopener');\n}\n\n/**\n * Open a new window in a popup. This is the best way to do so, but you cannot tell\n * if the window was opened or if it was blocked by the browser's popup blocker.\n * If you want to tell if the browser blocked the new window, use {@link windowOpenWithSuccess}.\n *\n * Note: this does not set {@link window.opener} to null. This is to allow the opened popup to\n * be able to use {@link window.close} to close itself. Because of this, you should only use\n * this function on urls that you trust.\n *\n * In otherwords, you should almost always use {@link windowOpenNoOpener} instead of this function.\n */\nconst popupWidth = 780, popupHeight = 640;\nexport function windowOpenPopup(url: string): void {\n\tconst left = Math.floor(mainWindow.screenLeft + mainWindow.innerWidth / 2 - popupWidth / 2);\n\tconst top = Math.floor(mainWindow.screenTop + mainWindow.innerHeight / 2 - popupHeight / 2);\n\tmainWindow.open(\n\t\turl,\n\t\t'_blank',\n\t\t`width=${popupWidth},height=${popupHeight},top=${top},left=${left}`\n\t);\n}\n\n/**\n * Attempts to open a window and returns whether it succeeded. This technique is\n * not appropriate in certain contexts, like for example when the JS context is\n * executing inside a sandboxed iframe. If it is not necessary to know if the\n * browser blocked the new window, use {@link windowOpenNoOpener}.\n *\n * See https://github.com/microsoft/monaco-editor/issues/601\n * See https://github.com/microsoft/monaco-editor/issues/2474\n * See https://mathiasbynens.github.io/rel-noopener/\n *\n * @param url the url to open\n * @param noOpener whether or not to set the {@link window.opener} to null. You should leave the default\n * (true) unless you trust the url that is being opened.\n * @returns boolean indicating if the {@link window.open} call succeeded\n */\nexport function windowOpenWithSuccess(url: string, noOpener = true): boolean {\n\tconst newTab = mainWindow.open();\n\tif (newTab) {\n\t\tif (noOpener) {\n\t\t\t// see `windowOpenNoOpener` for details on why this is important\n\t\t\t(newTab as any).opener = null;\n\t\t}\n\t\tnewTab.location.href = url;\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function animate(targetWindow: Window, fn: () => void): IDisposable {\n\tconst step = () => {\n\t\tfn();\n\t\tstepDisposable = scheduleAtNextAnimationFrame(targetWindow, step);\n\t};\n\n\tlet stepDisposable = scheduleAtNextAnimationFrame(targetWindow, step);\n\treturn toDisposable(() => stepDisposable.dispose());\n}\n\nRemoteAuthorities.setPreferredWebSchema(/^https:/.test(mainWindow.location.href) ? 'https' : 'http');\n\n/**\n * returns url('...')\n */\nexport function asCSSUrl(uri: URI | null | undefined): string {\n\tif (!uri) {\n\t\treturn `url('')`;\n\t}\n\treturn `url('${FileAccess.uriToBrowserUri(uri).toString(true).replace(/'/g, '%27')}')`;\n}\n\nexport function asCSSPropertyValue(value: string) {\n\treturn `'${value.replace(/'/g, '%27')}'`;\n}\n\nexport function asCssValueWithDefault(cssPropertyValue: string | undefined, dflt: string): string {\n\tif (cssPropertyValue !== undefined) {\n\t\tconst variableMatch = cssPropertyValue.match(/^\\s*var\\((.+)\\)$/);\n\t\tif (variableMatch) {\n\t\t\tconst varArguments = variableMatch[1].split(',', 2);\n\t\t\tif (varArguments.length === 2) {\n\t\t\t\tdflt = asCssValueWithDefault(varArguments[1].trim(), dflt);\n\t\t\t}\n\t\t\treturn `var(${varArguments[0]}, ${dflt})`;\n\t\t}\n\t\treturn cssPropertyValue;\n\t}\n\treturn dflt;\n}\n\nexport function triggerDownload(dataOrUri: Uint8Array | URI, name: string): void {\n\n\t// If the data is provided as Buffer, we create a\n\t// blob URL out of it to produce a valid link\n\tlet url: string;\n\tif (URI.isUri(dataOrUri)) {\n\t\turl = dataOrUri.toString(true);\n\t} else {\n\t\tconst blob = new Blob([dataOrUri]);\n\t\turl = URL.createObjectURL(blob);\n\n\t\t// Ensure to free the data from DOM eventually\n\t\tsetTimeout(() => URL.revokeObjectURL(url));\n\t}\n\n\t// In order to download from the browser, the only way seems\n\t// to be creating a <a> element with download attribute that\n\t// points to the file to download.\n\t// See also https://developers.google.com/web/updates/2011/08/Downloading-resources-in-HTML5-a-download\n\tconst activeWindow = getActiveWindow();\n\tconst anchor = document.createElement('a');\n\tactiveWindow.document.body.appendChild(anchor);\n\tanchor.download = name;\n\tanchor.href = url;\n\tanchor.click();\n\n\t// Ensure to remove the element from DOM eventually\n\tsetTimeout(() => anchor.remove());\n}\n\nexport function triggerUpload(): Promise<FileList | undefined> {\n\treturn new Promise<FileList | undefined>(resolve => {\n\n\t\t// In order to upload to the browser, create a\n\t\t// input element of type `file` and click it\n\t\t// to gather the selected files\n\t\tconst activeWindow = getActiveWindow();\n\t\tconst input = document.createElement('input');\n\t\tactiveWindow.document.body.appendChild(input);\n\t\tinput.type = 'file';\n\t\tinput.multiple = true;\n\n\t\t// Resolve once the input event has fired once\n\t\tevent.Event.once(event.Event.fromDOMEventEmitter(input, 'input'))(() => {\n\t\t\tresolve(input.files ?? undefined);\n\t\t});\n\n\t\tinput.click();\n\n\t\t// Ensure to remove the element from DOM eventually\n\t\tsetTimeout(() => input.remove());\n\t});\n}\n\nexport enum DetectedFullscreenMode {\n\n\t/**\n\t * The document is fullscreen, e.g. because an element\n\t * in the document requested to be fullscreen.\n\t */\n\tDOCUMENT = 1,\n\n\t/**\n\t * The browser is fullscreen, e.g. because the user enabled\n\t * native window fullscreen for it.\n\t */\n\tBROWSER\n}\n\nexport interface IDetectedFullscreen {\n\n\t/**\n\t * Figure out if the document is fullscreen or the browser.\n\t */\n\tmode: DetectedFullscreenMode;\n\n\t/**\n\t * Whether we know for sure that we are in fullscreen mode or\n\t * it is a guess.\n\t */\n\tguess: boolean;\n}\n\nexport function detectFullscreen(targetWindow: Window): IDetectedFullscreen | null {\n\n\t// Browser fullscreen: use DOM APIs to detect\n\tif (targetWindow.document.fullscreenElement || (<any>targetWindow.document).webkitFullscreenElement || (<any>targetWindow.document).webkitIsFullScreen) {\n\t\treturn { mode: DetectedFullscreenMode.DOCUMENT, guess: false };\n\t}\n\n\t// There is no standard way to figure out if the browser\n\t// is using native fullscreen. Via checking on screen\n\t// height and comparing that to window height, we can guess\n\t// it though.\n\n\tif (targetWindow.innerHeight === targetWindow.screen.height) {\n\t\t// if the height of the window matches the screen height, we can\n\t\t// safely assume that the browser is fullscreen because no browser\n\t\t// chrome is taking height away (e.g. like toolbars).\n\t\treturn { mode: DetectedFullscreenMode.BROWSER, guess: false };\n\t}\n\n\tif (platform.isMacintosh || platform.isLinux) {\n\t\t// macOS and Linux do not properly report `innerHeight`, only Windows does\n\t\tif (targetWindow.outerHeight === targetWindow.screen.height && targetWindow.outerWidth === targetWindow.screen.width) {\n\t\t\t// if the height of the browser matches the screen height, we can\n\t\t\t// only guess that we are in fullscreen. It is also possible that\n\t\t\t// the user has turned off taskbars in the OS and the browser is\n\t\t\t// simply able to span the entire size of the screen.\n\t\t\treturn { mode: DetectedFullscreenMode.BROWSER, guess: true };\n\t\t}\n\t}\n\n\t// Not in fullscreen\n\treturn null;\n}\n\n// -- sanitize and trusted html\n\n/**\n * Hooks dompurify using `afterSanitizeAttributes` to check that all `href` and `src`\n * attributes are valid.\n */\nexport function hookDomPurifyHrefAndSrcSanitizer(allowedProtocols: readonly string[], allowDataImages = false): IDisposable {\n\t// https://github.com/cure53/DOMPurify/blob/main/demos/hooks-scheme-allowlist.html\n\n\t// build an anchor to map URLs to\n\tconst anchor = document.createElement('a');\n\n\tdompurify.addHook('afterSanitizeAttributes', (node) => {\n\t\t// check all href/src attributes for validity\n\t\tfor (const attr of ['href', 'src']) {\n\t\t\tif (node.hasAttribute(attr)) {\n\t\t\t\tconst attrValue = node.getAttribute(attr) as string;\n\t\t\t\tif (attr === 'href' && attrValue.startsWith('#')) {\n\t\t\t\t\t// Allow fragment links\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tanchor.href = attrValue;\n\t\t\t\tif (!allowedProtocols.includes(anchor.protocol.replace(/:$/, ''))) {\n\t\t\t\t\tif (allowDataImages && attr === 'src' && anchor.href.startsWith('data:')) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tnode.removeAttribute(attr);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\treturn toDisposable(() => {\n\t\tdompurify.removeHook('afterSanitizeAttributes');\n\t});\n}\n\nconst defaultSafeProtocols = [\n\tSchemas.http,\n\tSchemas.https,\n\tSchemas.command,\n];\n\n/**\n * List of safe, non-input html tags.\n */\nexport const basicMarkupHtmlTags = Object.freeze([\n\t'a',\n\t'abbr',\n\t'b',\n\t'bdo',\n\t'blockquote',\n\t'br',\n\t'caption',\n\t'cite',\n\t'code',\n\t'col',\n\t'colgroup',\n\t'dd',\n\t'del',\n\t'details',\n\t'dfn',\n\t'div',\n\t'dl',\n\t'dt',\n\t'em',\n\t'figcaption',\n\t'figure',\n\t'h1',\n\t'h2',\n\t'h3',\n\t'h4',\n\t'h5',\n\t'h6',\n\t'hr',\n\t'i',\n\t'img',\n\t'input',\n\t'ins',\n\t'kbd',\n\t'label',\n\t'li',\n\t'mark',\n\t'ol',\n\t'p',\n\t'pre',\n\t'q',\n\t'rp',\n\t'rt',\n\t'ruby',\n\t'samp',\n\t'small',\n\t'small',\n\t'source',\n\t'span',\n\t'strike',\n\t'strong',\n\t'sub',\n\t'summary',\n\t'sup',\n\t'table',\n\t'tbody',\n\t'td',\n\t'tfoot',\n\t'th',\n\t'thead',\n\t'time',\n\t'tr',\n\t'tt',\n\t'u',\n\t'ul',\n\t'var',\n\t'video',\n\t'wbr',\n]);\n\nconst defaultDomPurifyConfig = Object.freeze<dompurify.Config & { RETURN_TRUSTED_TYPE: true }>({\n\tALLOWED_TAGS: ['a', 'button', 'blockquote', 'code', 'div', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'input', 'label', 'li', 'p', 'pre', 'select', 'small', 'span', 'strong', 'textarea', 'ul', 'ol'],\n\tALLOWED_ATTR: ['href', 'data-href', 'data-command', 'target', 'title', 'name', 'src', 'alt', 'class', 'id', 'role', 'tabindex', 'style', 'data-code', 'width', 'height', 'align', 'x-dispatch', 'required', 'checked', 'placeholder', 'type', 'start'],\n\tRETURN_DOM: false,\n\tRETURN_DOM_FRAGMENT: false,\n\tRETURN_TRUSTED_TYPE: true\n});\n\n/**\n * Sanitizes the given `value` and reset the given `node` with it.\n */\nexport function safeInnerHtml(node: HTMLElement, value: string): void {\n\tconst hook = hookDomPurifyHrefAndSrcSanitizer(defaultSafeProtocols);\n\ttry {\n\t\tconst html = dompurify.sanitize(value, defaultDomPurifyConfig);\n\t\tnode.innerHTML = html as unknown as string;\n\t} finally {\n\t\thook.dispose();\n\t}\n}\n\n/**\n * Convert a Unicode string to a string in which each 16-bit unit occupies only one byte\n *\n * From https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/btoa\n */\nfunction toBinary(str: string): string {\n\tconst codeUnits = new Uint16Array(str.length);\n\tfor (let i = 0; i < codeUnits.length; i++) {\n\t\tcodeUnits[i] = str.charCodeAt(i);\n\t}\n\tlet binary = '';\n\tconst uint8array = new Uint8Array(codeUnits.buffer);\n\tfor (let i = 0; i < uint8array.length; i++) {\n\t\tbinary += String.fromCharCode(uint8array[i]);\n\t}\n\treturn binary;\n}\n\n/**\n * Version of the global `btoa` function that handles multi-byte characters instead\n * of throwing an exception.\n */\nexport function multibyteAwareBtoa(str: string): string {\n\treturn btoa(toBinary(str));\n}\n\ntype ModifierKey = 'alt' | 'ctrl' | 'shift' | 'meta';\n\nexport interface IModifierKeyStatus {\n\taltKey: boolean;\n\tshiftKey: boolean;\n\tctrlKey: boolean;\n\tmetaKey: boolean;\n\tlastKeyPressed?: ModifierKey;\n\tlastKeyReleased?: ModifierKey;\n\tevent?: KeyboardEvent;\n}\n\nexport class ModifierKeyEmitter extends event.Emitter<IModifierKeyStatus> {\n\n\tprivate readonly _subscriptions = new DisposableStore();\n\tprivate _keyStatus: IModifierKeyStatus;\n\tprivate static instance: ModifierKeyEmitter;\n\n\tprivate constructor() {\n\t\tsuper();\n\n\t\tthis._keyStatus = {\n\t\t\taltKey: false,\n\t\t\tshiftKey: false,\n\t\t\tctrlKey: false,\n\t\t\tmetaKey: false\n\t\t};\n\n\t\tthis._subscriptions.add(event.Event.runAndSubscribe(onDidRegisterWindow, ({ window, disposables }) => this.registerListeners(window, disposables), { window: mainWindow, disposables: this._subscriptions }));\n\t}\n\n\tprivate registerListeners(window: Window, disposables: DisposableStore): void {\n\t\tdisposables.add(addDisposableListener(window, 'keydown', e => {\n\t\t\tif (e.defaultPrevented) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\t// If Alt-key keydown event is repeated, ignore it #112347\n\t\t\t// Only known to be necessary for Alt-Key at the moment #115810\n\t\t\tif (event.keyCode === KeyCode.Alt && e.repeat) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (e.altKey && !this._keyStatus.altKey) {\n\t\t\t\tthis._keyStatus.lastKeyPressed = 'alt';\n\t\t\t} else if (e.ctrlKey && !this._keyStatus.ctrlKey) {\n\t\t\t\tthis._keyStatus.lastKeyPressed = 'ctrl';\n\t\t\t} else if (e.metaKey && !this._keyStatus.metaKey) {\n\t\t\t\tthis._keyStatus.lastKeyPressed = 'meta';\n\t\t\t} else if (e.shiftKey && !this._keyStatus.shiftKey) {\n\t\t\t\tthis._keyStatus.lastKeyPressed = 'shift';\n\t\t\t} else if (event.keyCode !== KeyCode.Alt) {\n\t\t\t\tthis._keyStatus.lastKeyPressed = undefined;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._keyStatus.altKey = e.altKey;\n\t\t\tthis._keyStatus.ctrlKey = e.ctrlKey;\n\t\t\tthis._keyStatus.metaKey = e.metaKey;\n\t\t\tthis._keyStatus.shiftKey = e.shiftKey;\n\n\t\t\tif (this._keyStatus.lastKeyPressed) {\n\t\t\t\tthis._keyStatus.event = e;\n\t\t\t\tthis.fire(this._keyStatus);\n\t\t\t}\n\t\t}, true));\n\n\t\tdisposables.add(addDisposableListener(window, 'keyup', e => {\n\t\t\tif (e.defaultPrevented) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!e.altKey && this._keyStatus.altKey) {\n\t\t\t\tthis._keyStatus.lastKeyReleased = 'alt';\n\t\t\t} else if (!e.ctrlKey && this._keyStatus.ctrlKey) {\n\t\t\t\tthis._keyStatus.lastKeyReleased = 'ctrl';\n\t\t\t} else if (!e.metaKey && this._keyStatus.metaKey) {\n\t\t\t\tthis._keyStatus.lastKeyReleased = 'meta';\n\t\t\t} else if (!e.shiftKey && this._keyStatus.shiftKey) {\n\t\t\t\tthis._keyStatus.lastKeyReleased = 'shift';\n\t\t\t} else {\n\t\t\t\tthis._keyStatus.lastKeyReleased = undefined;\n\t\t\t}\n\n\t\t\tif (this._keyStatus.lastKeyPressed !== this._keyStatus.lastKeyReleased) {\n\t\t\t\tthis._keyStatus.lastKeyPressed = undefined;\n\t\t\t}\n\n\t\t\tthis._keyStatus.altKey = e.altKey;\n\t\t\tthis._keyStatus.ctrlKey = e.ctrlKey;\n\t\t\tthis._keyStatus.metaKey = e.metaKey;\n\t\t\tthis._keyStatus.shiftKey = e.shiftKey;\n\n\t\t\tif (this._keyStatus.lastKeyReleased) {\n\t\t\t\tthis._keyStatus.event = e;\n\t\t\t\tthis.fire(this._keyStatus);\n\t\t\t}\n\t\t}, true));\n\n\t\tdisposables.add(addDisposableListener(window.document.body, 'mousedown', () => {\n\t\t\tthis._keyStatus.lastKeyPressed = undefined;\n\t\t}, true));\n\n\t\tdisposables.add(addDisposableListener(window.document.body, 'mouseup', () => {\n\t\t\tthis._keyStatus.lastKeyPressed = undefined;\n\t\t}, true));\n\n\t\tdisposables.add(addDisposableListener(window.document.body, 'mousemove', e => {\n\t\t\tif (e.buttons) {\n\t\t\t\tthis._keyStatus.lastKeyPressed = undefined;\n\t\t\t}\n\t\t}, true));\n\n\t\tdisposables.add(addDisposableListener(window, 'blur', () => {\n\t\t\tthis.resetKeyStatus();\n\t\t}));\n\t}\n\n\tget keyStatus(): IModifierKeyStatus {\n\t\treturn this._keyStatus;\n\t}\n\n\tget isModifierPressed(): boolean {\n\t\treturn this._keyStatus.altKey || this._keyStatus.ctrlKey || this._keyStatus.metaKey || this._keyStatus.shiftKey;\n\t}\n\n\t/**\n\t * Allows to explicitly reset the key status based on more knowledge (#109062)\n\t */\n\tresetKeyStatus(): void {\n\t\tthis.doResetKeyStatus();\n\t\tthis.fire(this._keyStatus);\n\t}\n\n\tprivate doResetKeyStatus(): void {\n\t\tthis._keyStatus = {\n\t\t\taltKey: false,\n\t\t\tshiftKey: false,\n\t\t\tctrlKey: false,\n\t\t\tmetaKey: false\n\t\t};\n\t}\n\n\tstatic getInstance() {\n\t\tif (!ModifierKeyEmitter.instance) {\n\t\t\tModifierKeyEmitter.instance = new ModifierKeyEmitter();\n\t\t}\n\n\t\treturn ModifierKeyEmitter.instance;\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis._subscriptions.dispose();\n\t}\n}\n\nexport function getCookieValue(name: string): string | undefined {\n\tconst match = document.cookie.match('(^|[^;]+)\\\\s*' + name + '\\\\s*=\\\\s*([^;]+)'); // See https://stackoverflow.com/a/25490531\n\n\treturn match ? match.pop() : undefined;\n}\n\nexport interface IDragAndDropObserverCallbacks {\n\treadonly onDragEnter?: (e: DragEvent) => void;\n\treadonly onDragLeave?: (e: DragEvent) => void;\n\treadonly onDrop?: (e: DragEvent) => void;\n\treadonly onDragEnd?: (e: DragEvent) => void;\n\treadonly onDragStart?: (e: DragEvent) => void;\n\treadonly onDrag?: (e: DragEvent) => void;\n\treadonly onDragOver?: (e: DragEvent, dragDuration: number) => void;\n}\n\nexport class DragAndDropObserver extends Disposable {\n\n\t// A helper to fix issues with repeated DRAG_ENTER / DRAG_LEAVE\n\t// calls see https://github.com/microsoft/vscode/issues/14470\n\t// when the element has child elements where the events are fired\n\t// repeadedly.\n\tprivate counter: number = 0;\n\n\t// Allows to measure the duration of the drag operation.\n\tprivate dragStartTime = 0;\n\n\tconstructor(private readonly element: HTMLElement, private readonly callbacks: IDragAndDropObserverCallbacks) {\n\t\tsuper();\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tif (this.callbacks.onDragStart) {\n\t\t\tthis._register(addDisposableListener(this.element, EventType.DRAG_START, (e: DragEvent) => {\n\t\t\t\tthis.callbacks.onDragStart?.(e);\n\t\t\t}));\n\t\t}\n\n\t\tif (this.callbacks.onDrag) {\n\t\t\tthis._register(addDisposableListener(this.element, EventType.DRAG, (e: DragEvent) => {\n\t\t\t\tthis.callbacks.onDrag?.(e);\n\t\t\t}));\n\t\t}\n\n\t\tthis._register(addDisposableListener(this.element, EventType.DRAG_ENTER, (e: DragEvent) => {\n\t\t\tthis.counter++;\n\t\t\tthis.dragStartTime = e.timeStamp;\n\n\t\t\tthis.callbacks.onDragEnter?.(e);\n\t\t}));\n\n\t\tthis._register(addDisposableListener(this.element, EventType.DRAG_OVER, (e: DragEvent) => {\n\t\t\te.preventDefault(); // needed so that the drop event fires (https://stackoverflow.com/questions/21339924/drop-event-not-firing-in-chrome)\n\n\t\t\tthis.callbacks.onDragOver?.(e, e.timeStamp - this.dragStartTime);\n\t\t}));\n\n\t\tthis._register(addDisposableListener(this.element, EventType.DRAG_LEAVE, (e: DragEvent) => {\n\t\t\tthis.counter--;\n\n\t\t\tif (this.counter === 0) {\n\t\t\t\tthis.dragStartTime = 0;\n\n\t\t\t\tthis.callbacks.onDragLeave?.(e);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(addDisposableListener(this.element, EventType.DRAG_END, (e: DragEvent) => {\n\t\t\tthis.counter = 0;\n\t\t\tthis.dragStartTime = 0;\n\n\t\t\tthis.callbacks.onDragEnd?.(e);\n\t\t}));\n\n\t\tthis._register(addDisposableListener(this.element, EventType.DROP, (e: DragEvent) => {\n\t\t\tthis.counter = 0;\n\t\t\tthis.dragStartTime = 0;\n\n\t\t\tthis.callbacks.onDrop?.(e);\n\t\t}));\n\t}\n}\n\ntype HTMLElementAttributeKeys<T> = Partial<{ [K in keyof T]: T[K] extends Function ? never : T[K] extends object ? HTMLElementAttributeKeys<T[K]> : T[K] }>;\ntype ElementAttributes<T> = HTMLElementAttributeKeys<T> & Record<string, any>;\ntype RemoveHTMLElement<T> = T extends HTMLElement ? never : T;\ntype UnionToIntersection<U> = (U extends any ? (k: U) => void : never) extends ((k: infer I) => void) ? I : never;\ntype ArrayToObj<T extends readonly any[]> = UnionToIntersection<RemoveHTMLElement<T[number]>>;\ntype HHTMLElementTagNameMap = HTMLElementTagNameMap & { '': HTMLDivElement };\n\ntype TagToElement<T> = T extends `${infer TStart}#${string}`\n\t? TStart extends keyof HHTMLElementTagNameMap\n\t? HHTMLElementTagNameMap[TStart]\n\t: HTMLElement\n\t: T extends `${infer TStart}.${string}`\n\t? TStart extends keyof HHTMLElementTagNameMap\n\t? HHTMLElementTagNameMap[TStart]\n\t: HTMLElement\n\t: T extends keyof HTMLElementTagNameMap\n\t? HTMLElementTagNameMap[T]\n\t: HTMLElement;\n\ntype TagToElementAndId<TTag> = TTag extends `${infer TTag}@${infer TId}`\n\t? { element: TagToElement<TTag>; id: TId }\n\t: { element: TagToElement<TTag>; id: 'root' };\n\ntype TagToRecord<TTag> = TagToElementAndId<TTag> extends { element: infer TElement; id: infer TId }\n\t? Record<(TId extends string ? TId : never) | 'root', TElement>\n\t: never;\n\ntype Child = HTMLElement | string | Record<string, HTMLElement>;\n\nconst H_REGEX = /(?<tag>[\\w\\-]+)?(?:#(?<id>[\\w\\-]+))?(?<class>(?:\\.(?:[\\w\\-]+))*)(?:@(?<name>(?:[\\w\\_])+))?/;\n\n/**\n * A helper function to create nested dom nodes.\n *\n *\n * ```ts\n * const elements = h('div.code-view', [\n * \th('div.title@title'),\n * \th('div.container', [\n * \t\th('div.gutter@gutterDiv'),\n * \t\th('div@editor'),\n * \t]),\n * ]);\n * const editor = createEditor(elements.editor);\n * ```\n*/\nexport function h<TTag extends string>\n\t(tag: TTag):\n\tTagToRecord<TTag> extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function h<TTag extends string, T extends Child[]>\n\t(tag: TTag, children: [...T]):\n\t(ArrayToObj<T> & TagToRecord<TTag>) extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function h<TTag extends string>\n\t(tag: TTag, attributes: Partial<ElementAttributes<TagToElement<TTag>>>):\n\tTagToRecord<TTag> extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function h<TTag extends string, T extends Child[]>\n\t(tag: TTag, attributes: Partial<ElementAttributes<TagToElement<TTag>>>, children: [...T]):\n\t(ArrayToObj<T> & TagToRecord<TTag>) extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function h(tag: string, ...args: [] | [attributes: { $: string } & Partial<ElementAttributes<HTMLElement>> | Record<string, any>, children?: any[]] | [children: any[]]): Record<string, HTMLElement> {\n\tlet attributes: { $?: string } & Partial<ElementAttributes<HTMLElement>>;\n\tlet children: (Record<string, HTMLElement> | HTMLElement)[] | undefined;\n\n\tif (Array.isArray(args[0])) {\n\t\tattributes = {};\n\t\tchildren = args[0];\n\t} else {\n\t\tattributes = args[0] as any || {};\n\t\tchildren = args[1];\n\t}\n\n\tconst match = H_REGEX.exec(tag);\n\n\tif (!match || !match.groups) {\n\t\tthrow new Error('Bad use of h');\n\t}\n\n\tconst tagName = match.groups['tag'] || 'div';\n\tconst el = document.createElement(tagName);\n\n\tif (match.groups['id']) {\n\t\tel.id = match.groups['id'];\n\t}\n\n\tconst classNames = [];\n\tif (match.groups['class']) {\n\t\tfor (const className of match.groups['class'].split('.')) {\n\t\t\tif (className !== '') {\n\t\t\t\tclassNames.push(className);\n\t\t\t}\n\t\t}\n\t}\n\tif (attributes.className !== undefined) {\n\t\tfor (const className of attributes.className.split('.')) {\n\t\t\tif (className !== '') {\n\t\t\t\tclassNames.push(className);\n\t\t\t}\n\t\t}\n\t}\n\tif (classNames.length > 0) {\n\t\tel.className = classNames.join(' ');\n\t}\n\n\tconst result: Record<string, HTMLElement> = {};\n\n\tif (match.groups['name']) {\n\t\tresult[match.groups['name']] = el;\n\t}\n\n\tif (children) {\n\t\tfor (const c of children) {\n\t\t\tif (isHTMLElement(c)) {\n\t\t\t\tel.appendChild(c);\n\t\t\t} else if (typeof c === 'string') {\n\t\t\t\tel.append(c);\n\t\t\t} else if ('root' in c) {\n\t\t\t\tObject.assign(result, c);\n\t\t\t\tel.appendChild(c.root);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (const [key, value] of Object.entries(attributes)) {\n\t\tif (key === 'className') {\n\t\t\tcontinue;\n\t\t} else if (key === 'style') {\n\t\t\tfor (const [cssKey, cssValue] of Object.entries(value)) {\n\t\t\t\tel.style.setProperty(\n\t\t\t\t\tcamelCaseToHyphenCase(cssKey),\n\t\t\t\t\ttypeof cssValue === 'number' ? cssValue + 'px' : '' + cssValue\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (key === 'tabIndex') {\n\t\t\tel.tabIndex = value;\n\t\t} else {\n\t\t\tel.setAttribute(camelCaseToHyphenCase(key), value.toString());\n\t\t}\n\t}\n\n\tresult['root'] = el;\n\n\treturn result;\n}\n\nexport function svgElem<TTag extends string>\n\t(tag: TTag):\n\tTagToRecord<TTag> extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function svgElem<TTag extends string, T extends Child[]>\n\t(tag: TTag, children: [...T]):\n\t(ArrayToObj<T> & TagToRecord<TTag>) extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function svgElem<TTag extends string>\n\t(tag: TTag, attributes: Partial<ElementAttributes<TagToElement<TTag>>>):\n\tTagToRecord<TTag> extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function svgElem<TTag extends string, T extends Child[]>\n\t(tag: TTag, attributes: Partial<ElementAttributes<TagToElement<TTag>>>, children: [...T]):\n\t(ArrayToObj<T> & TagToRecord<TTag>) extends infer Y ? { [TKey in keyof Y]: Y[TKey] } : never;\n\nexport function svgElem(tag: string, ...args: [] | [attributes: { $: string } & Partial<ElementAttributes<HTMLElement>> | Record<string, any>, children?: any[]] | [children: any[]]): Record<string, HTMLElement> {\n\tlet attributes: { $?: string } & Partial<ElementAttributes<HTMLElement>>;\n\tlet children: (Record<string, HTMLElement> | HTMLElement)[] | undefined;\n\n\tif (Array.isArray(args[0])) {\n\t\tattributes = {};\n\t\tchildren = args[0];\n\t} else {\n\t\tattributes = args[0] as any || {};\n\t\tchildren = args[1];\n\t}\n\n\tconst match = H_REGEX.exec(tag);\n\n\tif (!match || !match.groups) {\n\t\tthrow new Error('Bad use of h');\n\t}\n\n\tconst tagName = match.groups['tag'] || 'div';\n\tconst el = document.createElementNS('http://www.w3.org/2000/svg', tagName) as any as HTMLElement;\n\n\tif (match.groups['id']) {\n\t\tel.id = match.groups['id'];\n\t}\n\n\tconst classNames = [];\n\tif (match.groups['class']) {\n\t\tfor (const className of match.groups['class'].split('.')) {\n\t\t\tif (className !== '') {\n\t\t\t\tclassNames.push(className);\n\t\t\t}\n\t\t}\n\t}\n\tif (attributes.className !== undefined) {\n\t\tfor (const className of attributes.className.split('.')) {\n\t\t\tif (className !== '') {\n\t\t\t\tclassNames.push(className);\n\t\t\t}\n\t\t}\n\t}\n\tif (classNames.length > 0) {\n\t\tel.className = classNames.join(' ');\n\t}\n\n\tconst result: Record<string, HTMLElement> = {};\n\n\tif (match.groups['name']) {\n\t\tresult[match.groups['name']] = el;\n\t}\n\n\tif (children) {\n\t\tfor (const c of children) {\n\t\t\tif (isHTMLElement(c)) {\n\t\t\t\tel.appendChild(c);\n\t\t\t} else if (typeof c === 'string') {\n\t\t\t\tel.append(c);\n\t\t\t} else if ('root' in c) {\n\t\t\t\tObject.assign(result, c);\n\t\t\t\tel.appendChild(c.root);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (const [key, value] of Object.entries(attributes)) {\n\t\tif (key === 'className') {\n\t\t\tcontinue;\n\t\t} else if (key === 'style') {\n\t\t\tfor (const [cssKey, cssValue] of Object.entries(value)) {\n\t\t\t\tel.style.setProperty(\n\t\t\t\t\tcamelCaseToHyphenCase(cssKey),\n\t\t\t\t\ttypeof cssValue === 'number' ? cssValue + 'px' : '' + cssValue\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (key === 'tabIndex') {\n\t\t\tel.tabIndex = value;\n\t\t} else {\n\t\t\tel.setAttribute(camelCaseToHyphenCase(key), value.toString());\n\t\t}\n\t}\n\n\tresult['root'] = el;\n\n\treturn result;\n}\n\nfunction camelCaseToHyphenCase(str: string) {\n\treturn str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n}\n\nexport function copyAttributes(from: Element, to: Element, filter?: string[]): void {\n\tfor (const { name, value } of from.attributes) {\n\t\tif (!filter || filter.includes(name)) {\n\t\t\tto.setAttribute(name, value);\n\t\t}\n\t}\n}\n\nfunction copyAttribute(from: Element, to: Element, name: string): void {\n\tconst value = from.getAttribute(name);\n\tif (value) {\n\t\tto.setAttribute(name, value);\n\t} else {\n\t\tto.removeAttribute(name);\n\t}\n}\n\nexport function trackAttributes(from: Element, to: Element, filter?: string[]): IDisposable {\n\tcopyAttributes(from, to, filter);\n\n\tconst disposables = new DisposableStore();\n\n\tdisposables.add(sharedMutationObserver.observe(from, disposables, { attributes: true, attributeFilter: filter })(mutations => {\n\t\tfor (const mutation of mutations) {\n\t\t\tif (mutation.type === 'attributes' && mutation.attributeName) {\n\t\t\t\tcopyAttribute(from, to, mutation.attributeName);\n\t\t\t}\n\t\t}\n\t}));\n\n\treturn disposables;\n}\n\nexport function isEditableElement(element: Element): boolean {\n\treturn element.tagName.toLowerCase() === 'input' || element.tagName.toLowerCase() === 'textarea' || isHTMLElement(element) && !!element.editContext;\n}\n\n/**\n * Helper for calculating the \"safe triangle\" occluded by hovers to avoid early dismissal.\n * @see https://www.smashingmagazine.com/2023/08/better-context-menus-safe-triangles/ for example\n */\nexport class SafeTriangle {\n\t// 4 points (x, y), 8 length\n\tprivate points = new Int16Array(8);\n\n\tconstructor(\n\t\tprivate readonly originX: number,\n\t\tprivate readonly originY: number,\n\t\ttarget: HTMLElement\n\t) {\n\t\tconst { top, left, right, bottom } = target.getBoundingClientRect();\n\t\tconst t = this.points;\n\t\tlet i = 0;\n\n\t\tt[i++] = left;\n\t\tt[i++] = top;\n\n\t\tt[i++] = right;\n\t\tt[i++] = top;\n\n\t\tt[i++] = left;\n\t\tt[i++] = bottom;\n\n\t\tt[i++] = right;\n\t\tt[i++] = bottom;\n\t}\n\n\tpublic contains(x: number, y: number) {\n\t\tconst { points, originX, originY } = this;\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tconst p1 = 2 * i;\n\t\t\tconst p2 = 2 * ((i + 1) % 4);\n\t\t\tif (isPointWithinTriangle(x, y, originX, originY, points[p1], points[p1 + 1], points[p2], points[p2 + 1])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["onDidRegisterWindow", "onDidUnregisterWindow", "onWillUnregisterWindow", "getWindowById", "addStandardDisposableListener", "position", "document", "Namespace", "DetectedFullscreenMode", "event"]
}
