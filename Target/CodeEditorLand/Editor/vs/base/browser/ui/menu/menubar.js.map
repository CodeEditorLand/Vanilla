{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/base/browser/ui/menu/menubar.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as browser from '../../browser.js';\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { EventType, Gesture, GestureEvent } from '../../touch.js';\nimport { cleanMnemonic, HorizontalDirection, IMenuDirection, IMenuOptions, IMenuStyles, Menu, MENU_ESCAPED_MNEMONIC_REGEX, MENU_MNEMONIC_REGEX, VerticalDirection } from './menu.js';\nimport { ActionRunner, IAction, IActionRunner, Separator, SubmenuAction } from '../../../common/actions.js';\nimport { asArray } from '../../../common/arrays.js';\nimport { RunOnceScheduler } from '../../../common/async.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { ThemeIcon } from '../../../common/themables.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { KeyCode, KeyMod, ScanCode, ScanCodeUtils } from '../../../common/keyCodes.js';\nimport { ResolvedKeybinding } from '../../../common/keybindings.js';\nimport { Disposable, DisposableStore, dispose, IDisposable } from '../../../common/lifecycle.js';\nimport { isMacintosh } from '../../../common/platform.js';\nimport * as strings from '../../../common/strings.js';\nimport './menubar.css';\nimport * as nls from '../../../../nls.js';\nimport { mainWindow } from '../../window.js';\n\nconst $ = DOM.$;\n\nexport interface IMenuBarOptions {\n\tenableMnemonics?: boolean;\n\tdisableAltFocus?: boolean;\n\tvisibility?: string;\n\tgetKeybinding?: (action: IAction) => ResolvedKeybinding | undefined;\n\talwaysOnMnemonics?: boolean;\n\tcompactMode?: IMenuDirection;\n\tactionRunner?: IActionRunner;\n\tgetCompactMenuActions?: () => IAction[];\n}\n\nexport interface MenuBarMenu {\n\tactions: IAction[];\n\tlabel: string;\n}\n\ninterface MenuBarMenuWithElements extends MenuBarMenu {\n\ttitleElement?: HTMLElement;\n\tbuttonElement?: HTMLElement;\n}\n\nenum MenubarState {\n\tHIDDEN,\n\tVISIBLE,\n\tFOCUSED,\n\tOPEN\n}\n\nexport class MenuBar extends Disposable {\n\n\tstatic readonly OVERFLOW_INDEX: number = -1;\n\n\tprivate menus: MenuBarMenuWithElements[];\n\n\tprivate overflowMenu!: MenuBarMenuWithElements & { titleElement: HTMLElement; buttonElement: HTMLElement };\n\n\tprivate focusedMenu: {\n\t\tindex: number;\n\t\tholder?: HTMLElement;\n\t\twidget?: Menu;\n\t} | undefined;\n\n\tprivate focusToReturn: HTMLElement | undefined;\n\tprivate menuUpdater: RunOnceScheduler;\n\n\t// Input-related\n\tprivate _mnemonicsInUse: boolean = false;\n\tprivate openedViaKeyboard: boolean = false;\n\tprivate awaitingAltRelease: boolean = false;\n\tprivate ignoreNextMouseUp: boolean = false;\n\tprivate mnemonics: Map<string, number>;\n\n\tprivate updatePending: boolean = false;\n\tprivate _focusState: MenubarState;\n\tprivate actionRunner: IActionRunner;\n\n\tprivate readonly _onVisibilityChange: Emitter<boolean>;\n\tprivate readonly _onFocusStateChange: Emitter<boolean>;\n\n\tprivate numMenusShown: number = 0;\n\tprivate overflowLayoutScheduled: IDisposable | undefined = undefined;\n\n\tprivate readonly menuDisposables = this._register(new DisposableStore());\n\n\tconstructor(private container: HTMLElement, private options: IMenuBarOptions, private menuStyle: IMenuStyles) {\n\t\tsuper();\n\n\t\tthis.container.setAttribute('role', 'menubar');\n\t\tif (this.isCompact) {\n\t\t\tthis.container.classList.add('compact');\n\t\t}\n\n\t\tthis.menus = [];\n\t\tthis.mnemonics = new Map<string, number>();\n\n\t\tthis._focusState = MenubarState.VISIBLE;\n\n\t\tthis._onVisibilityChange = this._register(new Emitter<boolean>());\n\t\tthis._onFocusStateChange = this._register(new Emitter<boolean>());\n\n\t\tthis.createOverflowMenu();\n\n\t\tthis.menuUpdater = this._register(new RunOnceScheduler(() => this.update(), 200));\n\n\t\tthis.actionRunner = this.options.actionRunner ?? this._register(new ActionRunner());\n\t\tthis._register(this.actionRunner.onWillRun(() => {\n\t\t\tthis.setUnfocusedState();\n\t\t}));\n\n\t\tthis._register(DOM.ModifierKeyEmitter.getInstance().event(this.onModifierKeyToggled, this));\n\n\t\tthis._register(DOM.addDisposableListener(this.container, DOM.EventType.KEY_DOWN, (e) => {\n\t\t\tconst event = new StandardKeyboardEvent(e as KeyboardEvent);\n\t\t\tlet eventHandled = true;\n\t\t\tconst key = !!e.key ? e.key.toLocaleLowerCase() : '';\n\n\t\t\tconst tabNav = isMacintosh && !this.isCompact;\n\n\t\t\tif (event.equals(KeyCode.LeftArrow) || (tabNav && event.equals(KeyCode.Tab | KeyMod.Shift))) {\n\t\t\t\tthis.focusPrevious();\n\t\t\t} else if (event.equals(KeyCode.RightArrow) || (tabNav && event.equals(KeyCode.Tab))) {\n\t\t\t\tthis.focusNext();\n\t\t\t} else if (event.equals(KeyCode.Escape) && this.isFocused && !this.isOpen) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t} else if (!this.isOpen && !event.ctrlKey && this.options.enableMnemonics && this.mnemonicsInUse && this.mnemonics.has(key)) {\n\t\t\t\tconst menuIndex = this.mnemonics.get(key)!;\n\t\t\t\tthis.onMenuTriggered(menuIndex, false);\n\t\t\t} else {\n\t\t\t\teventHandled = false;\n\t\t\t}\n\n\t\t\t// Never allow default tab behavior when not compact\n\t\t\tif (!this.isCompact && (event.equals(KeyCode.Tab | KeyMod.Shift) || event.equals(KeyCode.Tab))) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\tif (eventHandled) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}));\n\n\t\tconst window = DOM.getWindow(this.container);\n\t\tthis._register(DOM.addDisposableListener(window, DOM.EventType.MOUSE_DOWN, () => {\n\t\t\t// This mouse event is outside the menubar so it counts as a focus out\n\t\t\tif (this.isFocused) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this.container, DOM.EventType.FOCUS_IN, (e) => {\n\t\t\tconst event = e as FocusEvent;\n\n\t\t\tif (event.relatedTarget) {\n\t\t\t\tif (!this.container.contains(event.relatedTarget as HTMLElement)) {\n\t\t\t\t\tthis.focusToReturn = event.relatedTarget as HTMLElement;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this.container, DOM.EventType.FOCUS_OUT, (e) => {\n\t\t\tconst event = e as FocusEvent;\n\n\t\t\t// We are losing focus and there is no related target, e.g. webview case\n\t\t\tif (!event.relatedTarget) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t}\n\t\t\t// We are losing focus and there is a target, reset focusToReturn value as not to redirect\n\t\t\telse if (event.relatedTarget && !this.container.contains(event.relatedTarget as HTMLElement)) {\n\t\t\t\tthis.focusToReturn = undefined;\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(window, DOM.EventType.KEY_DOWN, (e: KeyboardEvent) => {\n\t\t\tif (!this.options.enableMnemonics || !e.altKey || e.ctrlKey || e.defaultPrevented) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst key = e.key.toLocaleLowerCase();\n\t\t\tif (!this.mnemonics.has(key)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.mnemonicsInUse = true;\n\t\t\tthis.updateMnemonicVisibility(true);\n\n\t\t\tconst menuIndex = this.mnemonics.get(key)!;\n\t\t\tthis.onMenuTriggered(menuIndex, false);\n\t\t}));\n\n\t\tthis.setUnfocusedState();\n\t}\n\n\tpush(arg: MenuBarMenu | MenuBarMenu[]): void {\n\t\tconst menus: MenuBarMenu[] = asArray(arg);\n\n\t\tmenus.forEach((menuBarMenu) => {\n\t\t\tconst menuIndex = this.menus.length;\n\t\t\tconst cleanMenuLabel = cleanMnemonic(menuBarMenu.label);\n\n\t\t\tconst mnemonicMatches = MENU_MNEMONIC_REGEX.exec(menuBarMenu.label);\n\n\t\t\t// Register mnemonics\n\t\t\tif (mnemonicMatches) {\n\t\t\t\tconst mnemonic = !!mnemonicMatches[1] ? mnemonicMatches[1] : mnemonicMatches[3];\n\n\t\t\t\tthis.registerMnemonic(this.menus.length, mnemonic);\n\t\t\t}\n\n\t\t\tif (this.isCompact) {\n\t\t\t\tthis.menus.push(menuBarMenu);\n\t\t\t} else {\n\t\t\t\tconst buttonElement = $('div.menubar-menu-button', { 'role': 'menuitem', 'tabindex': -1, 'aria-label': cleanMenuLabel, 'aria-haspopup': true });\n\t\t\t\tconst titleElement = $('div.menubar-menu-title', { 'role': 'none', 'aria-hidden': true });\n\n\t\t\t\tbuttonElement.appendChild(titleElement);\n\t\t\t\tthis.container.insertBefore(buttonElement, this.overflowMenu.buttonElement);\n\n\t\t\t\tthis.updateLabels(titleElement, buttonElement, menuBarMenu.label);\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.KEY_UP, (e) => {\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e as KeyboardEvent);\n\t\t\t\t\tlet eventHandled = true;\n\n\t\t\t\t\tif ((event.equals(KeyCode.DownArrow) || event.equals(KeyCode.Enter)) && !this.isOpen) {\n\t\t\t\t\t\tthis.focusedMenu = { index: menuIndex };\n\t\t\t\t\t\tthis.openedViaKeyboard = true;\n\t\t\t\t\t\tthis.focusState = MenubarState.OPEN;\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventHandled = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (eventHandled) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._register(Gesture.addTarget(buttonElement));\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, EventType.Tap, (e: GestureEvent) => {\n\t\t\t\t\t// Ignore this touch if the menu is touched\n\t\t\t\t\tif (this.isOpen && this.focusedMenu && this.focusedMenu.holder && DOM.isAncestor(e.initialTarget as HTMLElement, this.focusedMenu.holder)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t\t\tthis.onMenuTriggered(menuIndex, true);\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}));\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_DOWN, (e: MouseEvent) => {\n\t\t\t\t\t// Ignore non-left-click\n\t\t\t\t\tconst mouseEvent = new StandardMouseEvent(DOM.getWindow(buttonElement), e);\n\t\t\t\t\tif (!mouseEvent.leftButton) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.isOpen) {\n\t\t\t\t\t\t// Open the menu with mouse down and ignore the following mouse up event\n\t\t\t\t\t\tthis.ignoreNextMouseUp = true;\n\t\t\t\t\t\tthis.onMenuTriggered(menuIndex, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t\t\t}\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}));\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_UP, (e) => {\n\t\t\t\t\tif (e.defaultPrevented) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.ignoreNextMouseUp) {\n\t\t\t\t\t\tif (this.isFocused) {\n\t\t\t\t\t\t\tthis.onMenuTriggered(menuIndex, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_ENTER, () => {\n\t\t\t\t\tif (this.isOpen && !this.isCurrentMenu(menuIndex)) {\n\t\t\t\t\t\tbuttonElement.focus();\n\t\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t\t\tthis.showCustomMenu(menuIndex, false);\n\t\t\t\t\t} else if (this.isFocused && !this.isOpen) {\n\t\t\t\t\t\tthis.focusedMenu = { index: menuIndex };\n\t\t\t\t\t\tbuttonElement.focus();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis.menus.push({\n\t\t\t\t\tlabel: menuBarMenu.label,\n\t\t\t\t\tactions: menuBarMenu.actions,\n\t\t\t\t\tbuttonElement: buttonElement,\n\t\t\t\t\ttitleElement: titleElement\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateOverflowMenu(): void {\n\t\tconst label = this.isCompact ? nls.localize('mAppMenu', 'Application Menu') : nls.localize('mMore', 'More');\n\t\tconst buttonElement = $('div.menubar-menu-button', { 'role': 'menuitem', 'tabindex': this.isCompact ? 0 : -1, 'aria-label': label, 'aria-haspopup': true });\n\t\tconst titleElement = $('div.menubar-menu-title.toolbar-toggle-more' + ThemeIcon.asCSSSelector(Codicon.menuBarMore), { 'role': 'none', 'aria-hidden': true });\n\n\t\tbuttonElement.appendChild(titleElement);\n\t\tthis.container.appendChild(buttonElement);\n\t\tbuttonElement.style.visibility = 'hidden';\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.KEY_UP, (e) => {\n\t\t\tconst event = new StandardKeyboardEvent(e as KeyboardEvent);\n\t\t\tlet eventHandled = true;\n\n\t\t\tconst triggerKeys = [KeyCode.Enter];\n\t\t\tif (!this.isCompact) {\n\t\t\t\ttriggerKeys.push(KeyCode.DownArrow);\n\t\t\t} else {\n\t\t\t\ttriggerKeys.push(KeyCode.Space);\n\n\t\t\t\tif (this.options.compactMode?.horizontal === HorizontalDirection.Right) {\n\t\t\t\t\ttriggerKeys.push(KeyCode.RightArrow);\n\t\t\t\t} else if (this.options.compactMode?.horizontal === HorizontalDirection.Left) {\n\t\t\t\t\ttriggerKeys.push(KeyCode.LeftArrow);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ((triggerKeys.some(k => event.equals(k)) && !this.isOpen)) {\n\t\t\t\tthis.focusedMenu = { index: MenuBar.OVERFLOW_INDEX };\n\t\t\t\tthis.openedViaKeyboard = true;\n\t\t\t\tthis.focusState = MenubarState.OPEN;\n\t\t\t} else {\n\t\t\t\teventHandled = false;\n\t\t\t}\n\n\t\t\tif (eventHandled) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(Gesture.addTarget(buttonElement));\n\t\tthis._register(DOM.addDisposableListener(buttonElement, EventType.Tap, (e: GestureEvent) => {\n\t\t\t// Ignore this touch if the menu is touched\n\t\t\tif (this.isOpen && this.focusedMenu && this.focusedMenu.holder && DOM.isAncestor(e.initialTarget as HTMLElement, this.focusedMenu.holder)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\tthis.onMenuTriggered(MenuBar.OVERFLOW_INDEX, true);\n\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_DOWN, (e) => {\n\t\t\t// Ignore non-left-click\n\t\t\tconst mouseEvent = new StandardMouseEvent(DOM.getWindow(buttonElement), e);\n\t\t\tif (!mouseEvent.leftButton) {\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isOpen) {\n\t\t\t\t// Open the menu with mouse down and ignore the following mouse up event\n\t\t\t\tthis.ignoreNextMouseUp = true;\n\t\t\t\tthis.onMenuTriggered(MenuBar.OVERFLOW_INDEX, true);\n\t\t\t} else {\n\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t}\n\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_UP, (e) => {\n\t\t\tif (e.defaultPrevented) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.ignoreNextMouseUp) {\n\t\t\t\tif (this.isFocused) {\n\t\t\t\t\tthis.onMenuTriggered(MenuBar.OVERFLOW_INDEX, true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.ignoreNextMouseUp = false;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(buttonElement, DOM.EventType.MOUSE_ENTER, () => {\n\t\t\tif (this.isOpen && !this.isCurrentMenu(MenuBar.OVERFLOW_INDEX)) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\tthis.showCustomMenu(MenuBar.OVERFLOW_INDEX, false);\n\t\t\t} else if (this.isFocused && !this.isOpen) {\n\t\t\t\tthis.focusedMenu = { index: MenuBar.OVERFLOW_INDEX };\n\t\t\t\tbuttonElement.focus();\n\t\t\t}\n\t\t}));\n\n\t\tthis.overflowMenu = {\n\t\t\tbuttonElement: buttonElement,\n\t\t\ttitleElement: titleElement,\n\t\t\tlabel: 'More',\n\t\t\tactions: []\n\t\t};\n\t}\n\n\tupdateMenu(menu: MenuBarMenu): void {\n\t\tconst menuToUpdate = this.menus.filter(menuBarMenu => menuBarMenu.label === menu.label);\n\t\tif (menuToUpdate && menuToUpdate.length) {\n\t\t\tmenuToUpdate[0].actions = menu.actions;\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.menus.forEach(menuBarMenu => {\n\t\t\tmenuBarMenu.titleElement?.remove();\n\t\t\tmenuBarMenu.buttonElement?.remove();\n\t\t});\n\n\t\tthis.overflowMenu.titleElement.remove();\n\t\tthis.overflowMenu.buttonElement.remove();\n\n\t\tdispose(this.overflowLayoutScheduled);\n\t\tthis.overflowLayoutScheduled = undefined;\n\t}\n\n\tblur(): void {\n\t\tthis.setUnfocusedState();\n\t}\n\n\tgetWidth(): number {\n\t\tif (!this.isCompact && this.menus) {\n\t\t\tconst left = this.menus[0].buttonElement!.getBoundingClientRect().left;\n\t\t\tconst right = this.hasOverflow ? this.overflowMenu.buttonElement.getBoundingClientRect().right : this.menus[this.menus.length - 1].buttonElement!.getBoundingClientRect().right;\n\t\t\treturn right - left;\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tgetHeight(): number {\n\t\treturn this.container.clientHeight;\n\t}\n\n\ttoggleFocus(): void {\n\t\tif (!this.isFocused && this.options.visibility !== 'hidden') {\n\t\t\tthis.mnemonicsInUse = true;\n\t\t\tthis.focusedMenu = { index: this.numMenusShown > 0 ? 0 : MenuBar.OVERFLOW_INDEX };\n\t\t\tthis.focusState = MenubarState.FOCUSED;\n\t\t} else if (!this.isOpen) {\n\t\t\tthis.setUnfocusedState();\n\t\t}\n\t}\n\n\tprivate updateOverflowAction(): void {\n\t\tif (!this.menus || !this.menus.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst overflowMenuOnlyClass = 'overflow-menu-only';\n\n\t\t// Remove overflow only restriction to allow the most space\n\t\tthis.container.classList.toggle(overflowMenuOnlyClass, false);\n\n\t\tconst sizeAvailable = this.container.offsetWidth;\n\t\tlet currentSize = 0;\n\t\tlet full = this.isCompact;\n\t\tconst prevNumMenusShown = this.numMenusShown;\n\t\tthis.numMenusShown = 0;\n\n\t\tconst showableMenus = this.menus.filter(menu => menu.buttonElement !== undefined && menu.titleElement !== undefined) as (MenuBarMenuWithElements & { titleElement: HTMLElement; buttonElement: HTMLElement })[];\n\t\tfor (const menuBarMenu of showableMenus) {\n\t\t\tif (!full) {\n\t\t\t\tconst size = menuBarMenu.buttonElement.offsetWidth;\n\t\t\t\tif (currentSize + size > sizeAvailable) {\n\t\t\t\t\tfull = true;\n\t\t\t\t} else {\n\t\t\t\t\tcurrentSize += size;\n\t\t\t\t\tthis.numMenusShown++;\n\t\t\t\t\tif (this.numMenusShown > prevNumMenusShown) {\n\t\t\t\t\t\tmenuBarMenu.buttonElement.style.visibility = 'visible';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (full) {\n\t\t\t\tmenuBarMenu.buttonElement.style.visibility = 'hidden';\n\t\t\t}\n\t\t}\n\n\n\t\t// If below minimium menu threshold, show the overflow menu only as hamburger menu\n\t\tif (this.numMenusShown - 1 <= showableMenus.length / 4) {\n\t\t\tfor (const menuBarMenu of showableMenus) {\n\t\t\t\tmenuBarMenu.buttonElement.style.visibility = 'hidden';\n\t\t\t}\n\n\t\t\tfull = true;\n\t\t\tthis.numMenusShown = 0;\n\t\t\tcurrentSize = 0;\n\t\t}\n\n\t\t// Overflow\n\t\tif (this.isCompact) {\n\t\t\tthis.overflowMenu.actions = [];\n\t\t\tfor (let idx = this.numMenusShown; idx < this.menus.length; idx++) {\n\t\t\t\tthis.overflowMenu.actions.push(new SubmenuAction(`menubar.submenu.${this.menus[idx].label}`, this.menus[idx].label, this.menus[idx].actions || []));\n\t\t\t}\n\n\t\t\tconst compactMenuActions = this.options.getCompactMenuActions?.();\n\t\t\tif (compactMenuActions && compactMenuActions.length) {\n\t\t\t\tthis.overflowMenu.actions.push(new Separator());\n\t\t\t\tthis.overflowMenu.actions.push(...compactMenuActions);\n\t\t\t}\n\n\t\t\tthis.overflowMenu.buttonElement.style.visibility = 'visible';\n\t\t} else if (full) {\n\t\t\t// Can't fit the more button, need to remove more menus\n\t\t\twhile (currentSize + this.overflowMenu.buttonElement.offsetWidth > sizeAvailable && this.numMenusShown > 0) {\n\t\t\t\tthis.numMenusShown--;\n\t\t\t\tconst size = showableMenus[this.numMenusShown].buttonElement.offsetWidth;\n\t\t\t\tshowableMenus[this.numMenusShown].buttonElement.style.visibility = 'hidden';\n\t\t\t\tcurrentSize -= size;\n\t\t\t}\n\n\t\t\tthis.overflowMenu.actions = [];\n\t\t\tfor (let idx = this.numMenusShown; idx < showableMenus.length; idx++) {\n\t\t\t\tthis.overflowMenu.actions.push(new SubmenuAction(`menubar.submenu.${showableMenus[idx].label}`, showableMenus[idx].label, showableMenus[idx].actions || []));\n\t\t\t}\n\n\t\t\tif (this.overflowMenu.buttonElement.nextElementSibling !== showableMenus[this.numMenusShown].buttonElement) {\n\t\t\t\tthis.overflowMenu.buttonElement.remove();\n\t\t\t\tthis.container.insertBefore(this.overflowMenu.buttonElement, showableMenus[this.numMenusShown].buttonElement);\n\t\t\t}\n\n\t\t\tthis.overflowMenu.buttonElement.style.visibility = 'visible';\n\t\t} else {\n\t\t\tthis.overflowMenu.buttonElement.remove();\n\t\t\tthis.container.appendChild(this.overflowMenu.buttonElement);\n\t\t\tthis.overflowMenu.buttonElement.style.visibility = 'hidden';\n\t\t}\n\n\t\t// If we are only showing the overflow, add this class to avoid taking up space\n\t\tthis.container.classList.toggle(overflowMenuOnlyClass, this.numMenusShown === 0);\n\t}\n\n\tprivate updateLabels(titleElement: HTMLElement, buttonElement: HTMLElement, label: string): void {\n\t\tconst cleanMenuLabel = cleanMnemonic(label);\n\n\t\t// Update the button label to reflect mnemonics\n\n\t\tif (this.options.enableMnemonics) {\n\t\t\tconst cleanLabel = strings.escape(label);\n\n\t\t\t// This is global so reset it\n\t\t\tMENU_ESCAPED_MNEMONIC_REGEX.lastIndex = 0;\n\t\t\tlet escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(cleanLabel);\n\n\t\t\t// We can't use negative lookbehind so we match our negative and skip\n\t\t\twhile (escMatch && escMatch[1]) {\n\t\t\t\tescMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(cleanLabel);\n\t\t\t}\n\n\t\t\tconst replaceDoubleEscapes = (str: string) => str.replace(/&amp;&amp;/g, '&amp;');\n\n\t\t\tif (escMatch) {\n\t\t\t\ttitleElement.innerText = '';\n\t\t\t\ttitleElement.append(\n\t\t\t\t\tstrings.ltrim(replaceDoubleEscapes(cleanLabel.substr(0, escMatch.index)), ' '),\n\t\t\t\t\t$('mnemonic', { 'aria-hidden': 'true' }, escMatch[3]),\n\t\t\t\t\tstrings.rtrim(replaceDoubleEscapes(cleanLabel.substr(escMatch.index + escMatch[0].length)), ' ')\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttitleElement.innerText = replaceDoubleEscapes(cleanLabel).trim();\n\t\t\t}\n\t\t} else {\n\t\t\ttitleElement.innerText = cleanMenuLabel.replace(/&&/g, '&');\n\t\t}\n\n\t\tconst mnemonicMatches = MENU_MNEMONIC_REGEX.exec(label);\n\n\t\t// Register mnemonics\n\t\tif (mnemonicMatches) {\n\t\t\tconst mnemonic = !!mnemonicMatches[1] ? mnemonicMatches[1] : mnemonicMatches[3];\n\n\t\t\tif (this.options.enableMnemonics) {\n\t\t\t\tbuttonElement.setAttribute('aria-keyshortcuts', 'Alt+' + mnemonic.toLocaleLowerCase());\n\t\t\t} else {\n\t\t\t\tbuttonElement.removeAttribute('aria-keyshortcuts');\n\t\t\t}\n\t\t}\n\t}\n\n\tupdate(options?: IMenuBarOptions): void {\n\t\tif (options) {\n\t\t\tthis.options = options;\n\t\t}\n\n\t\t// Don't update while using the menu\n\t\tif (this.isFocused) {\n\t\t\tthis.updatePending = true;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menus.forEach(menuBarMenu => {\n\t\t\tif (!menuBarMenu.buttonElement || !menuBarMenu.titleElement) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateLabels(menuBarMenu.titleElement, menuBarMenu.buttonElement, menuBarMenu.label);\n\t\t});\n\n\t\tif (!this.overflowLayoutScheduled) {\n\t\t\tthis.overflowLayoutScheduled = DOM.scheduleAtNextAnimationFrame(DOM.getWindow(this.container), () => {\n\t\t\t\tthis.updateOverflowAction();\n\t\t\t\tthis.overflowLayoutScheduled = undefined;\n\t\t\t});\n\t\t}\n\n\t\tthis.setUnfocusedState();\n\t}\n\n\tprivate registerMnemonic(menuIndex: number, mnemonic: string): void {\n\t\tthis.mnemonics.set(mnemonic.toLocaleLowerCase(), menuIndex);\n\t}\n\n\tprivate hideMenubar(): void {\n\t\tif (this.container.style.display !== 'none') {\n\t\t\tthis.container.style.display = 'none';\n\t\t\tthis._onVisibilityChange.fire(false);\n\t\t}\n\t}\n\n\tprivate showMenubar(): void {\n\t\tif (this.container.style.display !== 'flex') {\n\t\t\tthis.container.style.display = 'flex';\n\t\t\tthis._onVisibilityChange.fire(true);\n\n\t\t\tthis.updateOverflowAction();\n\t\t}\n\t}\n\n\tprivate get focusState(): MenubarState {\n\t\treturn this._focusState;\n\t}\n\n\tprivate set focusState(value: MenubarState) {\n\t\tif (this._focusState >= MenubarState.FOCUSED && value < MenubarState.FOCUSED) {\n\t\t\t// Losing focus, update the menu if needed\n\n\t\t\tif (this.updatePending) {\n\t\t\t\tthis.menuUpdater.schedule();\n\t\t\t\tthis.updatePending = false;\n\t\t\t}\n\t\t}\n\n\t\tif (value === this._focusState) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isVisible = this.isVisible;\n\t\tconst isOpen = this.isOpen;\n\t\tconst isFocused = this.isFocused;\n\n\t\tthis._focusState = value;\n\n\t\tswitch (value) {\n\t\t\tcase MenubarState.HIDDEN:\n\t\t\t\tif (isVisible) {\n\t\t\t\t\tthis.hideMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (isOpen) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t}\n\n\t\t\t\tif (isFocused) {\n\t\t\t\t\tthis.focusedMenu = undefined;\n\n\t\t\t\t\tif (this.focusToReturn) {\n\t\t\t\t\t\tthis.focusToReturn.focus();\n\t\t\t\t\t\tthis.focusToReturn = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\tbreak;\n\t\t\tcase MenubarState.VISIBLE:\n\t\t\t\tif (!isVisible) {\n\t\t\t\t\tthis.showMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (isOpen) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t}\n\n\t\t\t\tif (isFocused) {\n\t\t\t\t\tif (this.focusedMenu) {\n\t\t\t\t\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\t\t\t\tthis.overflowMenu.buttonElement.blur();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.menus[this.focusedMenu.index].buttonElement?.blur();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.focusedMenu = undefined;\n\n\t\t\t\t\tif (this.focusToReturn) {\n\t\t\t\t\t\tthis.focusToReturn.focus();\n\t\t\t\t\t\tthis.focusToReturn = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase MenubarState.FOCUSED:\n\t\t\t\tif (!isVisible) {\n\t\t\t\t\tthis.showMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (isOpen) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t}\n\n\t\t\t\tif (this.focusedMenu) {\n\t\t\t\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.menus[this.focusedMenu.index].buttonElement?.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase MenubarState.OPEN:\n\t\t\t\tif (!isVisible) {\n\t\t\t\t\tthis.showMenubar();\n\t\t\t\t}\n\n\t\t\t\tif (this.focusedMenu) {\n\t\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\t\tthis.showCustomMenu(this.focusedMenu.index, this.openedViaKeyboard);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._focusState = value;\n\t\tthis._onFocusStateChange.fire(this.focusState >= MenubarState.FOCUSED);\n\t}\n\n\tget isVisible(): boolean {\n\t\treturn this.focusState >= MenubarState.VISIBLE;\n\t}\n\n\tprivate get isFocused(): boolean {\n\t\treturn this.focusState >= MenubarState.FOCUSED;\n\t}\n\n\tprivate get isOpen(): boolean {\n\t\treturn this.focusState >= MenubarState.OPEN;\n\t}\n\n\tprivate get hasOverflow(): boolean {\n\t\treturn this.isCompact || this.numMenusShown < this.menus.length;\n\t}\n\n\tprivate get isCompact(): boolean {\n\t\treturn this.options.compactMode !== undefined;\n\t}\n\n\tprivate setUnfocusedState(): void {\n\t\tif (this.options.visibility === 'toggle' || this.options.visibility === 'hidden') {\n\t\t\tthis.focusState = MenubarState.HIDDEN;\n\t\t} else if (this.options.visibility === 'classic' && browser.isFullscreen(mainWindow)) {\n\t\t\tthis.focusState = MenubarState.HIDDEN;\n\t\t} else {\n\t\t\tthis.focusState = MenubarState.VISIBLE;\n\t\t}\n\n\t\tthis.ignoreNextMouseUp = false;\n\t\tthis.mnemonicsInUse = false;\n\t\tthis.updateMnemonicVisibility(false);\n\t}\n\n\tprivate focusPrevious(): void {\n\n\t\tif (!this.focusedMenu || this.numMenusShown === 0) {\n\t\t\treturn;\n\t\t}\n\n\n\t\tlet newFocusedIndex = (this.focusedMenu.index - 1 + this.numMenusShown) % this.numMenusShown;\n\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\tnewFocusedIndex = this.numMenusShown - 1;\n\t\t} else if (this.focusedMenu.index === 0 && this.hasOverflow) {\n\t\t\tnewFocusedIndex = MenuBar.OVERFLOW_INDEX;\n\t\t}\n\n\t\tif (newFocusedIndex === this.focusedMenu.index) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isOpen) {\n\t\t\tthis.cleanupCustomMenu();\n\t\t\tthis.showCustomMenu(newFocusedIndex);\n\t\t} else if (this.isFocused) {\n\t\t\tthis.focusedMenu.index = newFocusedIndex;\n\t\t\tif (newFocusedIndex === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t} else {\n\t\t\t\tthis.menus[newFocusedIndex].buttonElement?.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate focusNext(): void {\n\t\tif (!this.focusedMenu || this.numMenusShown === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet newFocusedIndex = (this.focusedMenu.index + 1) % this.numMenusShown;\n\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\tnewFocusedIndex = 0;\n\t\t} else if (this.focusedMenu.index === this.numMenusShown - 1) {\n\t\t\tnewFocusedIndex = MenuBar.OVERFLOW_INDEX;\n\t\t}\n\n\t\tif (newFocusedIndex === this.focusedMenu.index) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isOpen) {\n\t\t\tthis.cleanupCustomMenu();\n\t\t\tthis.showCustomMenu(newFocusedIndex);\n\t\t} else if (this.isFocused) {\n\t\t\tthis.focusedMenu.index = newFocusedIndex;\n\t\t\tif (newFocusedIndex === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t} else {\n\t\t\t\tthis.menus[newFocusedIndex].buttonElement?.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateMnemonicVisibility(visible: boolean): void {\n\t\tif (this.menus) {\n\t\t\tthis.menus.forEach(menuBarMenu => {\n\t\t\t\tif (menuBarMenu.titleElement && menuBarMenu.titleElement.children.length) {\n\t\t\t\t\tconst child = menuBarMenu.titleElement.children.item(0) as HTMLElement;\n\t\t\t\t\tif (child) {\n\t\t\t\t\t\tchild.style.textDecoration = (this.options.alwaysOnMnemonics || visible) ? 'underline' : '';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate get mnemonicsInUse(): boolean {\n\t\treturn this._mnemonicsInUse;\n\t}\n\n\tprivate set mnemonicsInUse(value: boolean) {\n\t\tthis._mnemonicsInUse = value;\n\t}\n\n\tprivate get shouldAltKeyFocus(): boolean {\n\t\tif (isMacintosh) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.options.disableAltFocus) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.options.visibility === 'toggle') {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic get onVisibilityChange(): Event<boolean> {\n\t\treturn this._onVisibilityChange.event;\n\t}\n\n\tpublic get onFocusStateChange(): Event<boolean> {\n\t\treturn this._onFocusStateChange.event;\n\t}\n\n\tprivate onMenuTriggered(menuIndex: number, clicked: boolean) {\n\t\tif (this.isOpen) {\n\t\t\tif (this.isCurrentMenu(menuIndex)) {\n\t\t\t\tthis.setUnfocusedState();\n\t\t\t} else {\n\t\t\t\tthis.cleanupCustomMenu();\n\t\t\t\tthis.showCustomMenu(menuIndex, this.openedViaKeyboard);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.focusedMenu = { index: menuIndex };\n\t\t\tthis.openedViaKeyboard = !clicked;\n\t\t\tthis.focusState = MenubarState.OPEN;\n\t\t}\n\t}\n\n\tprivate onModifierKeyToggled(modifierKeyStatus: DOM.IModifierKeyStatus): void {\n\t\tconst allModifiersReleased = !modifierKeyStatus.altKey && !modifierKeyStatus.ctrlKey && !modifierKeyStatus.shiftKey && !modifierKeyStatus.metaKey;\n\n\t\tif (this.options.visibility === 'hidden') {\n\t\t\treturn;\n\t\t}\n\n\t\t// Prevent alt-key default if the menu is not hidden and we use alt to focus\n\t\tif (modifierKeyStatus.event && this.shouldAltKeyFocus) {\n\t\t\tif (ScanCodeUtils.toEnum(modifierKeyStatus.event.code) === ScanCode.AltLeft) {\n\t\t\t\tmodifierKeyStatus.event.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\t// Alt key pressed while menu is focused. This should return focus away from the menubar\n\t\tif (this.isFocused && modifierKeyStatus.lastKeyPressed === 'alt' && modifierKeyStatus.altKey) {\n\t\t\tthis.setUnfocusedState();\n\t\t\tthis.mnemonicsInUse = false;\n\t\t\tthis.awaitingAltRelease = true;\n\t\t}\n\n\t\t// Clean alt key press and release\n\t\tif (allModifiersReleased && modifierKeyStatus.lastKeyPressed === 'alt' && modifierKeyStatus.lastKeyReleased === 'alt') {\n\t\t\tif (!this.awaitingAltRelease) {\n\t\t\t\tif (!this.isFocused && this.shouldAltKeyFocus) {\n\t\t\t\t\tthis.mnemonicsInUse = true;\n\t\t\t\t\tthis.focusedMenu = { index: this.numMenusShown > 0 ? 0 : MenuBar.OVERFLOW_INDEX };\n\t\t\t\t\tthis.focusState = MenubarState.FOCUSED;\n\t\t\t\t} else if (!this.isOpen) {\n\t\t\t\t\tthis.setUnfocusedState();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Alt key released\n\t\tif (!modifierKeyStatus.altKey && modifierKeyStatus.lastKeyReleased === 'alt') {\n\t\t\tthis.awaitingAltRelease = false;\n\t\t}\n\n\t\tif (this.options.enableMnemonics && this.menus && !this.isOpen) {\n\t\t\tthis.updateMnemonicVisibility((!this.awaitingAltRelease && modifierKeyStatus.altKey) || this.mnemonicsInUse);\n\t\t}\n\t}\n\n\tprivate isCurrentMenu(menuIndex: number): boolean {\n\t\tif (!this.focusedMenu) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.focusedMenu.index === menuIndex;\n\t}\n\n\tprivate cleanupCustomMenu(): void {\n\t\tif (this.focusedMenu) {\n\t\t\t// Remove focus from the menus first\n\t\t\tif (this.focusedMenu.index === MenuBar.OVERFLOW_INDEX) {\n\t\t\t\tthis.overflowMenu.buttonElement.focus();\n\t\t\t} else {\n\t\t\t\tthis.menus[this.focusedMenu.index].buttonElement?.focus();\n\t\t\t}\n\n\t\t\tif (this.focusedMenu.holder) {\n\t\t\t\tthis.focusedMenu.holder.parentElement?.classList.remove('open');\n\n\t\t\t\tthis.focusedMenu.holder.remove();\n\t\t\t}\n\n\t\t\tthis.focusedMenu.widget?.dispose();\n\n\t\t\tthis.focusedMenu = { index: this.focusedMenu.index };\n\t\t}\n\t\tthis.menuDisposables.clear();\n\t}\n\n\tprivate showCustomMenu(menuIndex: number, selectFirst = true): void {\n\t\tconst actualMenuIndex = menuIndex >= this.numMenusShown ? MenuBar.OVERFLOW_INDEX : menuIndex;\n\t\tconst customMenu = actualMenuIndex === MenuBar.OVERFLOW_INDEX ? this.overflowMenu : this.menus[actualMenuIndex];\n\n\t\tif (!customMenu.actions || !customMenu.buttonElement || !customMenu.titleElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuHolder = $('div.menubar-menu-items-holder', { 'title': '' });\n\n\t\tcustomMenu.buttonElement.classList.add('open');\n\n\t\tconst titleBoundingRect = customMenu.titleElement.getBoundingClientRect();\n\t\tconst titleBoundingRectZoom = DOM.getDomNodeZoomLevel(customMenu.titleElement);\n\n\t\tif (this.options.compactMode?.horizontal === HorizontalDirection.Right) {\n\t\t\tmenuHolder.style.left = `${titleBoundingRect.left + this.container.clientWidth}px`;\n\t\t} else if (this.options.compactMode?.horizontal === HorizontalDirection.Left) {\n\t\t\tconst windowWidth = DOM.getWindow(this.container).innerWidth;\n\t\t\tmenuHolder.style.right = `${windowWidth - titleBoundingRect.left}px`;\n\t\t\tmenuHolder.style.left = 'auto';\n\t\t} else {\n\t\t\tmenuHolder.style.left = `${titleBoundingRect.left * titleBoundingRectZoom}px`;\n\t\t}\n\n\t\tif (this.options.compactMode?.vertical === VerticalDirection.Above) {\n\t\t\t// TODO@benibenj Do not hardcode the height of the menu holder\n\t\t\tmenuHolder.style.top = `${titleBoundingRect.top - this.menus.length * 30 + this.container.clientHeight}px`;\n\t\t} else if (this.options.compactMode?.vertical === VerticalDirection.Below) {\n\t\t\tmenuHolder.style.top = `${titleBoundingRect.top}px`;\n\t\t} else {\n\t\t\tmenuHolder.style.top = `${titleBoundingRect.bottom * titleBoundingRectZoom}px`;\n\t\t}\n\n\t\tcustomMenu.buttonElement.appendChild(menuHolder);\n\n\t\tconst menuOptions: IMenuOptions = {\n\t\t\tgetKeyBinding: this.options.getKeybinding,\n\t\t\tactionRunner: this.actionRunner,\n\t\t\tenableMnemonics: this.options.alwaysOnMnemonics || (this.mnemonicsInUse && this.options.enableMnemonics),\n\t\t\tariaLabel: customMenu.buttonElement.getAttribute('aria-label') ?? undefined,\n\t\t\texpandDirection: this.isCompact ? this.options.compactMode : { horizontal: HorizontalDirection.Right, vertical: VerticalDirection.Below },\n\t\t\tuseEventAsContext: true\n\t\t};\n\n\t\tconst menuWidget = this.menuDisposables.add(new Menu(menuHolder, customMenu.actions, menuOptions, this.menuStyle));\n\t\tthis.menuDisposables.add(menuWidget.onDidCancel(() => {\n\t\t\tthis.focusState = MenubarState.FOCUSED;\n\t\t}));\n\n\t\tif (actualMenuIndex !== menuIndex) {\n\t\t\tmenuWidget.trigger(menuIndex - this.numMenusShown);\n\t\t} else {\n\t\t\tmenuWidget.focus(selectFirst);\n\t\t}\n\n\t\tthis.focusedMenu = {\n\t\t\tindex: actualMenuIndex,\n\t\t\tholder: menuHolder,\n\t\t\twidget: menuWidget\n\t\t};\n\t}\n}\n"],
  "mappings": "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",
  "names": ["MenubarState"]
}
