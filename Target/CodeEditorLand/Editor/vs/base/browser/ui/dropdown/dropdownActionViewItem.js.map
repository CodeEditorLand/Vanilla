{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/base/browser/ui/dropdown/dropdownActionViewItem.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from \"../../../../nls.js\";\nimport {\n\tAction,\n\ttype IAction,\n\ttype IActionRunner,\n} from \"../../../common/actions.js\";\nimport { Codicon } from \"../../../common/codicons.js\";\nimport { Emitter } from \"../../../common/event.js\";\nimport { KeyCode } from \"../../../common/keyCodes.js\";\nimport type { ResolvedKeybinding } from \"../../../common/keybindings.js\";\nimport type { IDisposable } from \"../../../common/lifecycle.js\";\nimport { ThemeIcon } from \"../../../common/themables.js\";\nimport type { IContextMenuProvider } from \"../../contextmenu.js\";\nimport { $, EventType, addDisposableListener, append, h } from \"../../dom.js\";\nimport { StandardKeyboardEvent } from \"../../keyboardEvent.js\";\nimport {\n\tActionViewItem,\n\tBaseActionViewItem,\n\ttype IActionViewItemOptions,\n\ttype IBaseActionViewItemOptions,\n} from \"../actionbar/actionViewItems.js\";\nimport type { IActionViewItemProvider } from \"../actionbar/actionbar.js\";\nimport type { AnchorAlignment } from \"../contextview/contextview.js\";\nimport {\n\tDropdownMenu,\n\ttype IActionProvider,\n\ttype IDropdownMenuOptions,\n\ttype ILabelRenderer,\n} from \"./dropdown.js\";\nimport \"./dropdown.css\";\nimport { getBaseLayerHoverDelegate } from \"../hover/hoverDelegate2.js\";\nimport { getDefaultHoverDelegate } from \"../hover/hoverDelegateFactory.js\";\n\nexport interface IKeybindingProvider {\n\t(action: IAction): ResolvedKeybinding | undefined;\n}\n\nexport interface IAnchorAlignmentProvider {\n\t(): AnchorAlignment;\n}\n\nexport interface IDropdownMenuActionViewItemOptions\n\textends IBaseActionViewItemOptions {\n\treadonly actionViewItemProvider?: IActionViewItemProvider;\n\treadonly keybindingProvider?: IKeybindingProvider;\n\treadonly actionRunner?: IActionRunner;\n\treadonly classNames?: string[] | string;\n\treadonly anchorAlignmentProvider?: IAnchorAlignmentProvider;\n\treadonly menuAsChild?: boolean;\n\treadonly skipTelemetry?: boolean;\n}\n\nexport class DropdownMenuActionViewItem extends BaseActionViewItem {\n\tprivate menuActionsOrProvider: readonly IAction[] | IActionProvider;\n\tprivate dropdownMenu: DropdownMenu | undefined;\n\tprivate contextMenuProvider: IContextMenuProvider;\n\tprivate actionItem: HTMLElement | null = null;\n\n\tprivate _onDidChangeVisibility = this._register(new Emitter<boolean>());\n\treadonly onDidChangeVisibility = this._onDidChangeVisibility.event;\n\n\tprotected override readonly options: IDropdownMenuActionViewItemOptions;\n\n\tconstructor(\n\t\taction: IAction,\n\t\tmenuActionsOrProvider: readonly IAction[] | IActionProvider,\n\t\tcontextMenuProvider: IContextMenuProvider,\n\t\toptions: IDropdownMenuActionViewItemOptions = Object.create(null),\n\t) {\n\t\tsuper(null, action, options);\n\n\t\tthis.menuActionsOrProvider = menuActionsOrProvider;\n\t\tthis.contextMenuProvider = contextMenuProvider;\n\t\tthis.options = options;\n\n\t\tif (this.options.actionRunner) {\n\t\t\tthis.actionRunner = this.options.actionRunner;\n\t\t}\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tthis.actionItem = container;\n\n\t\tconst labelRenderer: ILabelRenderer = (\n\t\t\tel: HTMLElement,\n\t\t): IDisposable | null => {\n\t\t\tthis.element = append(el, $(\"a.action-label\"));\n\n\t\t\tlet classNames: string[] = [];\n\n\t\t\tif (typeof this.options.classNames === \"string\") {\n\t\t\t\tclassNames = this.options.classNames\n\t\t\t\t\t.split(/\\s+/g)\n\t\t\t\t\t.filter((s) => !!s);\n\t\t\t} else if (this.options.classNames) {\n\t\t\t\tclassNames = this.options.classNames;\n\t\t\t}\n\n\t\t\t// todo@aeschli: remove codicon, should come through `this.options.classNames`\n\t\t\tif (!classNames.find((c) => c === \"icon\")) {\n\t\t\t\tclassNames.push(\"codicon\");\n\t\t\t}\n\n\t\t\tthis.element.classList.add(...classNames);\n\n\t\t\tthis.element.setAttribute(\"role\", \"button\");\n\t\t\tthis.element.setAttribute(\"aria-haspopup\", \"true\");\n\t\t\tthis.element.setAttribute(\"aria-expanded\", \"false\");\n\t\t\tif (this._action.label) {\n\t\t\t\tthis._register(\n\t\t\t\t\tgetBaseLayerHoverDelegate().setupManagedHover(\n\t\t\t\t\t\tthis.options.hoverDelegate ??\n\t\t\t\t\t\t\tgetDefaultHoverDelegate(\"mouse\"),\n\t\t\t\t\t\tthis.element,\n\t\t\t\t\t\tthis._action.label,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.element.ariaLabel = this._action.label || \"\";\n\n\t\t\treturn null;\n\t\t};\n\n\t\tconst isActionsArray = Array.isArray(this.menuActionsOrProvider);\n\t\tconst options: IDropdownMenuOptions = {\n\t\t\tcontextMenuProvider: this.contextMenuProvider,\n\t\t\tlabelRenderer: labelRenderer,\n\t\t\tmenuAsChild: this.options.menuAsChild,\n\t\t\tactions: isActionsArray\n\t\t\t\t? (this.menuActionsOrProvider as IAction[])\n\t\t\t\t: undefined,\n\t\t\tactionProvider: isActionsArray\n\t\t\t\t? undefined\n\t\t\t\t: (this.menuActionsOrProvider as IActionProvider),\n\t\t\tskipTelemetry: this.options.skipTelemetry,\n\t\t};\n\n\t\tthis.dropdownMenu = this._register(\n\t\t\tnew DropdownMenu(container, options),\n\t\t);\n\t\tthis._register(\n\t\t\tthis.dropdownMenu.onDidChangeVisibility((visible) => {\n\t\t\t\tthis.element?.setAttribute(\"aria-expanded\", `${visible}`);\n\t\t\t\tthis._onDidChangeVisibility.fire(visible);\n\t\t\t}),\n\t\t);\n\n\t\tthis.dropdownMenu.menuOptions = {\n\t\t\tactionViewItemProvider: this.options.actionViewItemProvider,\n\t\t\tactionRunner: this.actionRunner,\n\t\t\tgetKeyBinding: this.options.keybindingProvider,\n\t\t\tcontext: this._context,\n\t\t};\n\n\t\tif (this.options.anchorAlignmentProvider) {\n\t\t\tconst that = this;\n\n\t\t\tthis.dropdownMenu.menuOptions = {\n\t\t\t\t...this.dropdownMenu.menuOptions,\n\t\t\t\tget anchorAlignment(): AnchorAlignment {\n\t\t\t\t\treturn that.options.anchorAlignmentProvider!();\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tthis.updateTooltip();\n\t\tthis.updateEnabled();\n\t}\n\n\tprotected override getTooltip(): string | undefined {\n\t\tlet title: string | null = null;\n\n\t\tif (this.action.tooltip) {\n\t\t\ttitle = this.action.tooltip;\n\t\t} else if (this.action.label) {\n\t\t\ttitle = this.action.label;\n\t\t}\n\n\t\treturn title ?? undefined;\n\t}\n\n\toverride setActionContext(newContext: unknown): void {\n\t\tsuper.setActionContext(newContext);\n\n\t\tif (this.dropdownMenu) {\n\t\t\tif (this.dropdownMenu.menuOptions) {\n\t\t\t\tthis.dropdownMenu.menuOptions.context = newContext;\n\t\t\t} else {\n\t\t\t\tthis.dropdownMenu.menuOptions = { context: newContext };\n\t\t\t}\n\t\t}\n\t}\n\n\tshow(): void {\n\t\tthis.dropdownMenu?.show();\n\t}\n\n\tprotected override updateEnabled(): void {\n\t\tconst disabled = !this.action.enabled;\n\t\tthis.actionItem?.classList.toggle(\"disabled\", disabled);\n\t\tthis.element?.classList.toggle(\"disabled\", disabled);\n\t}\n}\n\nexport interface IActionWithDropdownActionViewItemOptions\n\textends IActionViewItemOptions {\n\treadonly menuActionsOrProvider: readonly IAction[] | IActionProvider;\n\treadonly menuActionClassNames?: string[];\n}\n\nexport class ActionWithDropdownActionViewItem extends ActionViewItem {\n\tprotected dropdownMenuActionViewItem:\n\t\t| DropdownMenuActionViewItem\n\t\t| undefined;\n\n\tconstructor(\n\t\tcontext: unknown,\n\t\taction: IAction,\n\t\toptions: IActionWithDropdownActionViewItemOptions,\n\t\tprivate readonly contextMenuProvider: IContextMenuProvider,\n\t) {\n\t\tsuper(context, action, options);\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tif (this.element) {\n\t\t\tthis.element.classList.add(\"action-dropdown-item\");\n\t\t\tconst menuActionsProvider = {\n\t\t\t\tgetActions: () => {\n\t\t\t\t\tconst actionsProvider = (<\n\t\t\t\t\t\tIActionWithDropdownActionViewItemOptions\n\t\t\t\t\t>this.options).menuActionsOrProvider;\n\t\t\t\t\treturn Array.isArray(actionsProvider)\n\t\t\t\t\t\t? actionsProvider\n\t\t\t\t\t\t: (actionsProvider as IActionProvider).getActions(); // TODO: microsoft/TypeScript#42768\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst menuActionClassNames =\n\t\t\t\t(<IActionWithDropdownActionViewItemOptions>this.options)\n\t\t\t\t\t.menuActionClassNames || [];\n\t\t\tconst separator = h(\"div.action-dropdown-item-separator\", [\n\t\t\t\th(\"div\", {}),\n\t\t\t]).root;\n\t\t\tseparator.classList.toggle(\n\t\t\t\t\"prominent\",\n\t\t\t\tmenuActionClassNames.includes(\"prominent\"),\n\t\t\t);\n\t\t\tappend(this.element, separator);\n\n\t\t\tthis.dropdownMenuActionViewItem = this._register(\n\t\t\t\tnew DropdownMenuActionViewItem(\n\t\t\t\t\tthis._register(\n\t\t\t\t\t\tnew Action(\n\t\t\t\t\t\t\t\"dropdownAction\",\n\t\t\t\t\t\t\tnls.localize(\"moreActions\", \"More Actions...\"),\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t\tmenuActionsProvider,\n\t\t\t\t\tthis.contextMenuProvider,\n\t\t\t\t\t{\n\t\t\t\t\t\tclassNames: [\n\t\t\t\t\t\t\t\"dropdown\",\n\t\t\t\t\t\t\t...ThemeIcon.asClassNameArray(\n\t\t\t\t\t\t\t\tCodicon.dropDownButton,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t...menuActionClassNames,\n\t\t\t\t\t\t],\n\t\t\t\t\t\thoverDelegate: this.options.hoverDelegate,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t);\n\t\t\tthis.dropdownMenuActionViewItem.render(this.element);\n\n\t\t\tthis._register(\n\t\t\t\taddDisposableListener(this.element, EventType.KEY_DOWN, (e) => {\n\t\t\t\t\t// If we don't have any actions then the dropdown is hidden so don't try to focus it #164050\n\t\t\t\t\tif (menuActionsProvider.getActions().length === 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\t\t\tlet handled = false;\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.dropdownMenuActionViewItem?.isFocused() &&\n\t\t\t\t\t\tevent.equals(KeyCode.LeftArrow)\n\t\t\t\t\t) {\n\t\t\t\t\t\thandled = true;\n\t\t\t\t\t\tthis.dropdownMenuActionViewItem?.blur();\n\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t} else if (\n\t\t\t\t\t\tthis.isFocused() &&\n\t\t\t\t\t\tevent.equals(KeyCode.RightArrow)\n\t\t\t\t\t) {\n\t\t\t\t\t\thandled = true;\n\t\t\t\t\t\tthis.blur();\n\t\t\t\t\t\tthis.dropdownMenuActionViewItem?.focus();\n\t\t\t\t\t}\n\t\t\t\t\tif (handled) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\n\toverride blur(): void {\n\t\tsuper.blur();\n\t\tthis.dropdownMenuActionViewItem?.blur();\n\t}\n\n\toverride setFocusable(focusable: boolean): void {\n\t\tsuper.setFocusable(focusable);\n\t\tthis.dropdownMenuActionViewItem?.setFocusable(focusable);\n\t}\n}\n"],
  "mappings": ";;AAKA,YAAY,SAAS;AACrB;AAAA,EACC;AAAA,OAGM;AACP,SAAS,eAAe;AACxB,SAAS,eAAe;AACxB,SAAS,eAAe;AAGxB,SAAS,iBAAiB;AAE1B,SAAS,GAAG,WAAW,uBAAuB,QAAQ,SAAS;AAC/D,SAAS,6BAA6B;AACtC;AAAA,EACC;AAAA,EACA;AAAA,OAGM;AAGP;AAAA,EACC;AAAA,OAIM;AACP,OAAO;AACP,SAAS,iCAAiC;AAC1C,SAAS,+BAA+B;AAqBjC,MAAM,mCAAmC,mBAAmB;AAAA,EAzDnE,OAyDmE;AAAA;AAAA;AAAA,EAC1D;AAAA,EACA;AAAA,EACA;AAAA,EACA,aAAiC;AAAA,EAEjC,yBAAyB,KAAK,UAAU,IAAI,QAAiB,CAAC;AAAA,EAC7D,wBAAwB,KAAK,uBAAuB;AAAA,EAEjC;AAAA,EAE5B,YACC,QACA,uBACA,qBACA,UAA8C,uBAAO,OAAO,IAAI,GAC/D;AACD,UAAM,MAAM,QAAQ,OAAO;AAE3B,SAAK,wBAAwB;AAC7B,SAAK,sBAAsB;AAC3B,SAAK,UAAU;AAEf,QAAI,KAAK,QAAQ,cAAc;AAC9B,WAAK,eAAe,KAAK,QAAQ;AAAA,IAClC;AAAA,EACD;AAAA,EAES,OAAO,WAA8B;AAC7C,SAAK,aAAa;AAElB,UAAM,gBAAgC,wBACrC,OACwB;AACxB,WAAK,UAAU,OAAO,IAAI,EAAE,gBAAgB,CAAC;AAE7C,UAAI,aAAuB,CAAC;AAE5B,UAAI,OAAO,KAAK,QAAQ,eAAe,UAAU;AAChD,qBAAa,KAAK,QAAQ,WACxB,MAAM,MAAM,EACZ,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;AAAA,MACpB,WAAW,KAAK,QAAQ,YAAY;AACnC,qBAAa,KAAK,QAAQ;AAAA,MAC3B;AAGA,UAAI,CAAC,WAAW,KAAK,CAAC,MAAM,MAAM,MAAM,GAAG;AAC1C,mBAAW,KAAK,SAAS;AAAA,MAC1B;AAEA,WAAK,QAAQ,UAAU,IAAI,GAAG,UAAU;AAExC,WAAK,QAAQ,aAAa,QAAQ,QAAQ;AAC1C,WAAK,QAAQ,aAAa,iBAAiB,MAAM;AACjD,WAAK,QAAQ,aAAa,iBAAiB,OAAO;AAClD,UAAI,KAAK,QAAQ,OAAO;AACvB,aAAK;AAAA,UACJ,0BAA0B,EAAE;AAAA,YAC3B,KAAK,QAAQ,iBACZ,wBAAwB,OAAO;AAAA,YAChC,KAAK;AAAA,YACL,KAAK,QAAQ;AAAA,UACd;AAAA,QACD;AAAA,MACD;AACA,WAAK,QAAQ,YAAY,KAAK,QAAQ,SAAS;AAE/C,aAAO;AAAA,IACR,GAtCsC;AAwCtC,UAAM,iBAAiB,MAAM,QAAQ,KAAK,qBAAqB;AAC/D,UAAM,UAAgC;AAAA,MACrC,qBAAqB,KAAK;AAAA,MAC1B;AAAA,MACA,aAAa,KAAK,QAAQ;AAAA,MAC1B,SAAS,iBACL,KAAK,wBACN;AAAA,MACH,gBAAgB,iBACb,SACC,KAAK;AAAA,MACT,eAAe,KAAK,QAAQ;AAAA,IAC7B;AAEA,SAAK,eAAe,KAAK;AAAA,MACxB,IAAI,aAAa,WAAW,OAAO;AAAA,IACpC;AACA,SAAK;AAAA,MACJ,KAAK,aAAa,sBAAsB,CAAC,YAAY;AACpD,aAAK,SAAS,aAAa,iBAAiB,GAAG,OAAO,EAAE;AACxD,aAAK,uBAAuB,KAAK,OAAO;AAAA,MACzC,CAAC;AAAA,IACF;AAEA,SAAK,aAAa,cAAc;AAAA,MAC/B,wBAAwB,KAAK,QAAQ;AAAA,MACrC,cAAc,KAAK;AAAA,MACnB,eAAe,KAAK,QAAQ;AAAA,MAC5B,SAAS,KAAK;AAAA,IACf;AAEA,QAAI,KAAK,QAAQ,yBAAyB;AACzC,YAAM,OAAO;AAEb,WAAK,aAAa,cAAc;AAAA,QAC/B,GAAG,KAAK,aAAa;AAAA,QACrB,IAAI,kBAAmC;AACtC,iBAAO,KAAK,QAAQ,wBAAyB;AAAA,QAC9C;AAAA,MACD;AAAA,IACD;AAEA,SAAK,cAAc;AACnB,SAAK,cAAc;AAAA,EACpB;AAAA,EAEmB,aAAiC;AACnD,QAAI,QAAuB;AAE3B,QAAI,KAAK,OAAO,SAAS;AACxB,cAAQ,KAAK,OAAO;AAAA,IACrB,WAAW,KAAK,OAAO,OAAO;AAC7B,cAAQ,KAAK,OAAO;AAAA,IACrB;AAEA,WAAO,SAAS;AAAA,EACjB;AAAA,EAES,iBAAiB,YAA2B;AACpD,UAAM,iBAAiB,UAAU;AAEjC,QAAI,KAAK,cAAc;AACtB,UAAI,KAAK,aAAa,aAAa;AAClC,aAAK,aAAa,YAAY,UAAU;AAAA,MACzC,OAAO;AACN,aAAK,aAAa,cAAc,EAAE,SAAS,WAAW;AAAA,MACvD;AAAA,IACD;AAAA,EACD;AAAA,EAEA,OAAa;AACZ,SAAK,cAAc,KAAK;AAAA,EACzB;AAAA,EAEmB,gBAAsB;AACxC,UAAM,WAAW,CAAC,KAAK,OAAO;AAC9B,SAAK,YAAY,UAAU,OAAO,YAAY,QAAQ;AACtD,SAAK,SAAS,UAAU,OAAO,YAAY,QAAQ;AAAA,EACpD;AACD;AAQO,MAAM,yCAAyC,eAAe;AAAA,EAKpE,YACC,SACA,QACA,SACiB,qBAChB;AACD,UAAM,SAAS,QAAQ,OAAO;AAFb;AAAA,EAGlB;AAAA,EAnOD,OAuNqE;AAAA;AAAA;AAAA,EAC1D;AAAA,EAaD,OAAO,WAA8B;AAC7C,UAAM,OAAO,SAAS;AACtB,QAAI,KAAK,SAAS;AACjB,WAAK,QAAQ,UAAU,IAAI,sBAAsB;AACjD,YAAM,sBAAsB;AAAA,QAC3B,YAAY,6BAAM;AACjB,gBAAM,kBAEL,KAAK,QAAS;AACf,iBAAO,MAAM,QAAQ,eAAe,IACjC,kBACC,gBAAoC,WAAW;AAAA,QACpD,GAPY;AAAA,MAQb;AAEA,YAAM,uBACsC,KAAK,QAC9C,wBAAwB,CAAC;AAC5B,YAAM,YAAY,EAAE,sCAAsC;AAAA,QACzD,EAAE,OAAO,CAAC,CAAC;AAAA,MACZ,CAAC,EAAE;AACH,gBAAU,UAAU;AAAA,QACnB;AAAA,QACA,qBAAqB,SAAS,WAAW;AAAA,MAC1C;AACA,aAAO,KAAK,SAAS,SAAS;AAE9B,WAAK,6BAA6B,KAAK;AAAA,QACtC,IAAI;AAAA,UACH,KAAK;AAAA,YACJ,IAAI;AAAA,cACH;AAAA,cACA,IAAI,SAAS,eAAe,iBAAiB;AAAA,YAC9C;AAAA,UACD;AAAA,UACA;AAAA,UACA,KAAK;AAAA,UACL;AAAA,YACC,YAAY;AAAA,cACX;AAAA,cACA,GAAG,UAAU;AAAA,gBACZ,QAAQ;AAAA,cACT;AAAA,cACA,GAAG;AAAA,YACJ;AAAA,YACA,eAAe,KAAK,QAAQ;AAAA,UAC7B;AAAA,QACD;AAAA,MACD;AACA,WAAK,2BAA2B,OAAO,KAAK,OAAO;AAEnD,WAAK;AAAA,QACJ,sBAAsB,KAAK,SAAS,UAAU,UAAU,CAAC,MAAM;AAE9D,cAAI,oBAAoB,WAAW,EAAE,WAAW,GAAG;AAClD;AAAA,UACD;AACA,gBAAM,QAAQ,IAAI,sBAAsB,CAAC;AACzC,cAAI,UAAU;AACd,cACC,KAAK,4BAA4B,UAAU,KAC3C,MAAM,OAAO,QAAQ,SAAS,GAC7B;AACD,sBAAU;AACV,iBAAK,4BAA4B,KAAK;AACtC,iBAAK,MAAM;AAAA,UACZ,WACC,KAAK,UAAU,KACf,MAAM,OAAO,QAAQ,UAAU,GAC9B;AACD,sBAAU;AACV,iBAAK,KAAK;AACV,iBAAK,4BAA4B,MAAM;AAAA,UACxC;AACA,cAAI,SAAS;AACZ,kBAAM,eAAe;AACrB,kBAAM,gBAAgB;AAAA,UACvB;AAAA,QACD,CAAC;AAAA,MACF;AAAA,IACD;AAAA,EACD;AAAA,EAES,OAAa;AACrB,UAAM,KAAK;AACX,SAAK,4BAA4B,KAAK;AAAA,EACvC;AAAA,EAES,aAAa,WAA0B;AAC/C,UAAM,aAAa,SAAS;AAC5B,SAAK,4BAA4B,aAAa,SAAS;AAAA,EACxD;AACD;",
  "names": []
}
