import{CharCode as m}from"./charCode.js";function M(p,t){const e=Math.pow(10,t);return Math.round(p*e)/e}class l{_rgbaBrand=void 0;r;g;b;a;constructor(t,e,r,a=1){this.r=Math.min(255,Math.max(0,t))|0,this.g=Math.min(255,Math.max(0,e))|0,this.b=Math.min(255,Math.max(0,r))|0,this.a=M(Math.max(Math.min(1,a),0),3)}static equals(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}}class f{_hslaBrand=void 0;h;s;l;a;constructor(t,e,r,a){this.h=Math.max(Math.min(360,t),0)|0,this.s=M(Math.max(Math.min(1,e),0),3),this.l=M(Math.max(Math.min(1,r),0),3),this.a=M(Math.max(Math.min(1,a),0),3)}static equals(t,e){return t.h===e.h&&t.s===e.s&&t.l===e.l&&t.a===e.a}static fromRGBA(t){const e=t.r/255,r=t.g/255,a=t.b/255,s=t.a,u=Math.max(e,r,a),c=Math.min(e,r,a);let i=0,o=0;const g=(c+u)/2,d=u-c;if(d>0){switch(o=Math.min(g<=.5?d/(2*g):d/(2-2*g),1),u){case e:i=(r-a)/d+(r<a?6:0);break;case r:i=(a-e)/d+2;break;case a:i=(e-r)/d+4;break}i*=60,i=Math.round(i)}return new f(i,o,g,s)}static _hue2rgb(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}static toRGBA(t){const e=t.h/360,{s:r,l:a,a:s}=t;let u,c,i;if(r===0)u=c=i=a;else{const o=a<.5?a*(1+r):a+r-a*r,g=2*a-o;u=f._hue2rgb(g,o,e+1/3),c=f._hue2rgb(g,o,e),i=f._hue2rgb(g,o,e-1/3)}return new l(Math.round(u*255),Math.round(c*255),Math.round(i*255),s)}}class v{_hsvaBrand=void 0;h;s;v;a;constructor(t,e,r,a){this.h=Math.max(Math.min(360,t),0)|0,this.s=M(Math.max(Math.min(1,e),0),3),this.v=M(Math.max(Math.min(1,r),0),3),this.a=M(Math.max(Math.min(1,a),0),3)}static equals(t,e){return t.h===e.h&&t.s===e.s&&t.v===e.v&&t.a===e.a}static fromRGBA(t){const e=t.r/255,r=t.g/255,a=t.b/255,s=Math.max(e,r,a),u=Math.min(e,r,a),c=s-u,i=s===0?0:c/s;let o;return c===0?o=0:s===e?o=((r-a)/c%6+6)%6:s===r?o=(a-e)/c+2:o=(e-r)/c+4,new v(Math.round(o*60),i,s,t.a)}static toRGBA(t){const{h:e,s:r,v:a,a:s}=t,u=a*r,c=u*(1-Math.abs(e/60%2-1)),i=a-u;let[o,g,d]=[0,0,0];return e<60?(o=u,g=c):e<120?(o=c,g=u):e<180?(g=u,d=c):e<240?(g=c,d=u):e<300?(o=c,d=u):e<=360&&(o=u,d=c),o=Math.round((o+i)*255),g=Math.round((g+i)*255),d=Math.round((d+i)*255),new l(o,g,d,s)}}class h{static fromHex(t){return h.Format.CSS.parseHex(t)||h.red}static equals(t,e){return!t&&!e?!0:!t||!e?!1:t.equals(e)}rgba;_hsla;get hsla(){return this._hsla?this._hsla:f.fromRGBA(this.rgba)}_hsva;get hsva(){return this._hsva?this._hsva:v.fromRGBA(this.rgba)}constructor(t){if(t)if(t instanceof l)this.rgba=t;else if(t instanceof f)this._hsla=t,this.rgba=f.toRGBA(t);else if(t instanceof v)this._hsva=t,this.rgba=v.toRGBA(t);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(t){return!!t&&l.equals(this.rgba,t.rgba)&&f.equals(this.hsla,t.hsla)&&v.equals(this.hsva,t.hsva)}getRelativeLuminance(){const t=h._relativeLuminanceForComponent(this.rgba.r),e=h._relativeLuminanceForComponent(this.rgba.g),r=h._relativeLuminanceForComponent(this.rgba.b),a=.2126*t+.7152*e+.0722*r;return M(a,4)}reduceRelativeLuminace(t,e){let{r,g:a,b:s}=t.rgba,u=this.getContrastRatio(t);for(;u<e&&(r>0||a>0||s>0);)r-=Math.max(0,Math.ceil(r*.1)),a-=Math.max(0,Math.ceil(a*.1)),s-=Math.max(0,Math.ceil(s*.1)),u=this.getContrastRatio(new h(new l(r,a,s)));return new h(new l(r,a,s))}increaseRelativeLuminace(t,e){let{r,g:a,b:s}=t.rgba,u=this.getContrastRatio(t);for(;u<e&&(r<255||a<255||s<255);)r=Math.min(255,r+Math.ceil((255-r)*.1)),a=Math.min(255,a+Math.ceil((255-a)*.1)),s=Math.min(255,s+Math.ceil((255-s)*.1)),u=this.getContrastRatio(new h(new l(r,a,s)));return new h(new l(r,a,s))}static _relativeLuminanceForComponent(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}getContrastRatio(t){const e=this.getRelativeLuminance(),r=t.getRelativeLuminance();return e>r?(e+.05)/(r+.05):(r+.05)/(e+.05)}isDarker(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3<128}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(t){const e=this.getRelativeLuminance(),r=t.getRelativeLuminance();return e>r}isDarkerThan(t){const e=this.getRelativeLuminance(),r=t.getRelativeLuminance();return e<r}ensureConstrast(t,e){const r=this.getRelativeLuminance(),a=t.getRelativeLuminance();if(this.getContrastRatio(t)<e){if(a<r){const i=this.reduceRelativeLuminace(t,e),o=this.getContrastRatio(i);if(o<e){const g=this.increaseRelativeLuminace(t,e),d=this.getContrastRatio(g);return o>d?i:g}return i}const u=this.increaseRelativeLuminace(t,e),c=this.getContrastRatio(u);if(c<e){const i=this.reduceRelativeLuminace(t,e),o=this.getContrastRatio(i);return c>o?u:i}return u}return t}lighten(t){return new h(new f(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*t,this.hsla.a))}darken(t){return new h(new f(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*t,this.hsla.a))}transparent(t){const{r:e,g:r,b:a,a:s}=this.rgba;return new h(new l(e,r,a,s*t))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new h(new l(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(t){const e=t.rgba,r=this.rgba.a,a=e.a,s=r+a*(1-r);if(s<1e-6)return h.transparent;const u=this.rgba.r*r/s+e.r*a*(1-r)/s,c=this.rgba.g*r/s+e.g*a*(1-r)/s,i=this.rgba.b*r/s+e.b*a*(1-r)/s;return new h(new l(u,c,i,s))}makeOpaque(t){if(this.isOpaque()||t.rgba.a!==1)return this;const{r:e,g:r,b:a,a:s}=this.rgba;return new h(new l(t.rgba.r-s*(t.rgba.r-e),t.rgba.g-s*(t.rgba.g-r),t.rgba.b-s*(t.rgba.b-a),1))}flatten(...t){const e=t.reduceRight((r,a)=>h._flatten(a,r));return h._flatten(this,e)}static _flatten(t,e){const r=1-t.rgba.a;return new h(new l(r*e.rgba.r+t.rgba.a*t.rgba.r,r*e.rgba.g+t.rgba.a*t.rgba.g,r*e.rgba.b+t.rgba.a*t.rgba.b))}_toString;toString(){return this._toString||(this._toString=h.Format.CSS.format(this)),this._toString}static getLighterColor(t,e,r){if(t.isLighterThan(e))return t;r=r||.5;const a=t.getRelativeLuminance(),s=e.getRelativeLuminance();return r=r*(s-a)/s,t.lighten(r)}static getDarkerColor(t,e,r){if(t.isDarkerThan(e))return t;r=r||.5;const a=t.getRelativeLuminance(),s=e.getRelativeLuminance();return r=r*(a-s)/a,t.darken(r)}static white=new h(new l(255,255,255,1));static black=new h(new l(0,0,0,1));static red=new h(new l(255,0,0,1));static blue=new h(new l(0,0,255,1));static green=new h(new l(0,255,0,1));static cyan=new h(new l(0,255,255,1));static lightgrey=new h(new l(211,211,211,1));static transparent=new h(new l(0,0,0,0))}(t=>{let p;(r=>{let e;(S=>{function a(n){return n.rgba.a===1?`rgb(${n.rgba.r}, ${n.rgba.g}, ${n.rgba.b})`:t.Format.CSS.formatRGBA(n)}S.formatRGB=a;function s(n){return`rgba(${n.rgba.r}, ${n.rgba.g}, ${n.rgba.b}, ${+n.rgba.a.toFixed(2)})`}S.formatRGBA=s;function u(n){return n.hsla.a===1?`hsl(${n.hsla.h}, ${(n.hsla.s*100).toFixed(2)}%, ${(n.hsla.l*100).toFixed(2)}%)`:t.Format.CSS.formatHSLA(n)}S.formatHSL=u;function c(n){return`hsla(${n.hsla.h}, ${(n.hsla.s*100).toFixed(2)}%, ${(n.hsla.l*100).toFixed(2)}%, ${n.hsla.a.toFixed(2)})`}S.formatHSLA=c;function i(n){const A=n.toString(16);return A.length!==2?"0"+A:A}function o(n){return`#${i(n.rgba.r)}${i(n.rgba.g)}${i(n.rgba.b)}`}S.formatHex=o;function g(n,A=!1){return A&&n.rgba.a===1?t.Format.CSS.formatHex(n):`#${i(n.rgba.r)}${i(n.rgba.g)}${i(n.rgba.b)}${i(Math.round(n.rgba.a*255))}`}S.formatHexA=g;function d(n){return n.isOpaque()?t.Format.CSS.formatHex(n):t.Format.CSS.formatRGBA(n)}S.format=d;function x(n){const A=n.length;if(A===0||n.charCodeAt(0)!==m.Hash)return null;if(A===7){const C=16*b(n.charCodeAt(1))+b(n.charCodeAt(2)),w=16*b(n.charCodeAt(3))+b(n.charCodeAt(4)),R=16*b(n.charCodeAt(5))+b(n.charCodeAt(6));return new t(new l(C,w,R,1))}if(A===9){const C=16*b(n.charCodeAt(1))+b(n.charCodeAt(2)),w=16*b(n.charCodeAt(3))+b(n.charCodeAt(4)),R=16*b(n.charCodeAt(5))+b(n.charCodeAt(6)),L=16*b(n.charCodeAt(7))+b(n.charCodeAt(8));return new t(new l(C,w,R,L/255))}if(A===4){const C=b(n.charCodeAt(1)),w=b(n.charCodeAt(2)),R=b(n.charCodeAt(3));return new t(new l(16*C+C,16*w+w,16*R+R))}if(A===5){const C=b(n.charCodeAt(1)),w=b(n.charCodeAt(2)),R=b(n.charCodeAt(3)),L=b(n.charCodeAt(4));return new t(new l(16*C+C,16*w+w,16*R+R,(16*L+L)/255))}return null}S.parseHex=x;function b(n){switch(n){case m.Digit0:return 0;case m.Digit1:return 1;case m.Digit2:return 2;case m.Digit3:return 3;case m.Digit4:return 4;case m.Digit5:return 5;case m.Digit6:return 6;case m.Digit7:return 7;case m.Digit8:return 8;case m.Digit9:return 9;case m.a:return 10;case m.A:return 10;case m.b:return 11;case m.B:return 11;case m.c:return 12;case m.C:return 12;case m.d:return 13;case m.D:return 13;case m.e:return 14;case m.E:return 14;case m.f:return 15;case m.F:return 15}return 0}})(e=r.CSS||={})})(p=t.Format||={})})(h||={});export{h as Color,f as HSLA,v as HSVA,l as RGBA};
