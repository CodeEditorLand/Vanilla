import"./autorun.js";import"./base.js";import"./derived.js";import"./utils.js";let g;function w(r){g=r}function V(){return g}class S{indentation=0;textToConsoleArgs(e){return b([i(f("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[i(" "),l(d(e.oldValue,70),{color:"red",strikeThrough:!0}),i(" "),l(d(e.newValue,60),{color:"green"})]:[i(" (unchanged)")]:[i(" "),l(d(e.newValue,60),{color:"green"}),i(" (initial)")]}handleObservableChanged(e,n){}changedObservablesSets=new WeakMap;formatChanges(e){if(e.size!==0)return l(" (changed deps: "+[...e].map(n=>n.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){const n=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(t,o)=>(this.changedObservablesSets.get(e).add(t),n.apply(e,[t,o]))}handleDerivedRecomputed(e,n){this.changedObservablesSets.get(e).clear()}handleFromEventObservableTriggered(e,n){}handleAutorunCreated(e){const n=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(t,o)=>(this.changedObservablesSets.get(e).add(t),n.apply(e,[t,o]))}handleAutorunTriggered(e){this.changedObservablesSets.get(e).clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let n=e.getDebugName();n===void 0&&(n=""),this.indentation++}handleEndTransaction(){this.indentation--}}function b(r){const e=new Array,n=[];let t="";function o(a){if("length"in a)for(const u of a)u&&o(u);else"text"in a?(t+=`%c${a.text}`,e.push(a.style),a.data&&n.push(...a.data)):"data"in a&&n.push(...a.data)}o(r);const s=[t,...e];return s.push(...n),s}function i(r){return l(r,{color:"black"})}function D(r){return l(v(`${r}: `,10),{color:"black",bold:!0})}function l(r,e={color:"black"}){function n(o){return Object.entries(o).reduce((s,[a,u])=>`${s}${a}:${u};`,"")}const t={color:e.color};return e.strikeThrough&&(t["text-decoration"]="line-through"),e.bold&&(t["font-weight"]="bold"),{text:r,style:n(t)}}function d(r,e){switch(typeof r){case"number":return""+r;case"string":return r.length+2<=e?`"${r}"`:`"${r.substr(0,e-7)}"+...`;case"boolean":return r?"true":"false";case"undefined":return"undefined";case"object":return r===null?"null":Array.isArray(r)?c(r,e):h(r,e);case"symbol":return r.toString();case"function":return`[[Function${r.name?" "+r.name:""}]]`;default:return""+r}}function c(r,e){let n="[ ",t=!0;for(const o of r){if(t||(n+=", "),n.length-5>e){n+="...";break}t=!1,n+=`${d(o,e-n.length)}`}return n+=" ]",n}function h(r,e){let n="{ ",t=!0;for(const[o,s]of Object.entries(r)){if(t||(n+=", "),n.length-5>e){n+="...";break}t=!1,n+=`${o}: ${d(s,e-n.length)}`}return n+=" }",n}function f(r,e){let n="";for(let t=1;t<=e;t++)n+=r;return n}function v(r,e){for(;r.length<e;)r+=" ";return r}export{S as ConsoleObservableLogger,V as getLogger,w as setLogger};
