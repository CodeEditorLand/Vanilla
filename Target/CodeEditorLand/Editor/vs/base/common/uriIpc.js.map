{
  "version": 3,
  "sources": ["../../../../../../Dependency/CodeEditorLand/Editor/Source/vs/base/common/uriIpc.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from './buffer.js';\nimport { MarshalledObject } from './marshalling.js';\nimport { MarshalledId } from './marshallingIds.js';\nimport { URI, UriComponents } from './uri.js';\n\nexport interface IURITransformer {\n\ttransformIncoming(uri: UriComponents): UriComponents;\n\ttransformOutgoing(uri: UriComponents): UriComponents;\n\ttransformOutgoingURI(uri: URI): URI;\n\ttransformOutgoingScheme(scheme: string): string;\n}\n\nexport interface UriParts {\n\tscheme: string;\n\tauthority?: string;\n\tpath?: string;\n\tquery?: string;\n\tfragment?: string;\n}\n\nexport interface IRawURITransformer {\n\ttransformIncoming(uri: UriParts): UriParts;\n\ttransformOutgoing(uri: UriParts): UriParts;\n\ttransformOutgoingScheme(scheme: string): string;\n}\n\nfunction toJSON(uri: URI): UriComponents {\n\treturn <UriComponents><any>uri.toJSON();\n}\n\nexport class URITransformer implements IURITransformer {\n\n\tprivate readonly _uriTransformer: IRawURITransformer;\n\n\tconstructor(uriTransformer: IRawURITransformer) {\n\t\tthis._uriTransformer = uriTransformer;\n\t}\n\n\tpublic transformIncoming(uri: UriComponents): UriComponents {\n\t\tconst result = this._uriTransformer.transformIncoming(uri);\n\t\treturn (result === uri ? uri : toJSON(URI.from(result)));\n\t}\n\n\tpublic transformOutgoing(uri: UriComponents): UriComponents {\n\t\tconst result = this._uriTransformer.transformOutgoing(uri);\n\t\treturn (result === uri ? uri : toJSON(URI.from(result)));\n\t}\n\n\tpublic transformOutgoingURI(uri: URI): URI {\n\t\tconst result = this._uriTransformer.transformOutgoing(uri);\n\t\treturn (result === uri ? uri : URI.from(result));\n\t}\n\n\tpublic transformOutgoingScheme(scheme: string): string {\n\t\treturn this._uriTransformer.transformOutgoingScheme(scheme);\n\t}\n}\n\nexport const DefaultURITransformer: IURITransformer = new class {\n\ttransformIncoming(uri: UriComponents) {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoing(uri: UriComponents): UriComponents {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoingURI(uri: URI): URI {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoingScheme(scheme: string): string {\n\t\treturn scheme;\n\t}\n};\n\nfunction _transformOutgoingURIs(obj: any, transformer: IURITransformer, depth: number): any {\n\n\tif (!obj || depth > 200) {\n\t\treturn null;\n\t}\n\n\tif (typeof obj === 'object') {\n\t\tif (obj instanceof URI) {\n\t\t\treturn transformer.transformOutgoing(obj);\n\t\t}\n\n\t\t// walk object (or array)\n\t\tfor (const key in obj) {\n\t\t\tif (Object.hasOwnProperty.call(obj, key)) {\n\t\t\t\tconst r = _transformOutgoingURIs(obj[key], transformer, depth + 1);\n\t\t\t\tif (r !== null) {\n\t\t\t\t\tobj[key] = r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function transformOutgoingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformOutgoingURIs(obj, transformer, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n\n\nfunction _transformIncomingURIs(obj: any, transformer: IURITransformer, revive: boolean, depth: number): any {\n\n\tif (!obj || depth > 200) {\n\t\treturn null;\n\t}\n\n\tif (typeof obj === 'object') {\n\n\t\tif ((<MarshalledObject>obj).$mid === MarshalledId.Uri) {\n\t\t\treturn revive ? URI.revive(transformer.transformIncoming(obj)) : transformer.transformIncoming(obj);\n\t\t}\n\n\t\tif (obj instanceof VSBuffer) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// walk object (or array)\n\t\tfor (const key in obj) {\n\t\t\tif (Object.hasOwnProperty.call(obj, key)) {\n\t\t\t\tconst r = _transformIncomingURIs(obj[key], transformer, revive, depth + 1);\n\t\t\t\tif (r !== null) {\n\t\t\t\t\tobj[key] = r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function transformIncomingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformIncomingURIs(obj, transformer, false, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n\nexport function transformAndReviveIncomingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformIncomingURIs(obj, transformer, true, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n"],
  "mappings": "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",
  "names": []
}
