import t from"assert";import*as e from"../../common/labels.js";import{isMacintosh as q,isWindows as h,OperatingSystem as a}from"../../common/platform.js";import{URI as l}from"../../common/uri.js";import{ensureNoDisposablesAreLeakedInTestSuite as x}from"./utils.js";suite("Labels",()=>{(h?test:test.skip)("shorten - windows",()=>{t.deepStrictEqual(e.shorten(["a"]),["a"]),t.deepStrictEqual(e.shorten(["a","b"]),["a","b"]),t.deepStrictEqual(e.shorten(["a","b","c"]),["a","b","c"]),t.deepStrictEqual(e.shorten(["\\\\x\\a","\\\\x\\a"]),["\\\\x\\a","\\\\x\\a"]),t.deepStrictEqual(e.shorten(["C:\\a","C:\\b"]),["C:\\a","C:\\b"]),t.deepStrictEqual(e.shorten(["a\\b","c\\d","e\\f"]),["\u2026\\b","\u2026\\d","\u2026\\f"]),t.deepStrictEqual(e.shorten(["a","a\\b"]),["a","\u2026\\b"]),t.deepStrictEqual(e.shorten(["a\\b","a\\b\\c"]),["\u2026\\b","\u2026\\c"]),t.deepStrictEqual(e.shorten(["a","a\\b","a\\b\\c"]),["a","\u2026\\b","\u2026\\c"]),t.deepStrictEqual(e.shorten(["x:\\a\\b","x:\\a\\c"]),["x:\\\u2026\\b","x:\\\u2026\\c"]),t.deepStrictEqual(e.shorten(["\\\\a\\b","\\\\a\\c"]),["\\\\a\\b","\\\\a\\c"]),t.deepStrictEqual(e.shorten(["a","b\\a"]),["a","b\\\u2026"]),t.deepStrictEqual(e.shorten(["a\\b\\c","d\\b\\c"]),["a\\\u2026","d\\\u2026"]),t.deepStrictEqual(e.shorten(["a\\b\\c\\d","f\\b\\c\\d"]),["a\\\u2026","f\\\u2026"]),t.deepStrictEqual(e.shorten(["d\\e\\a\\b\\c","d\\b\\c"]),["\u2026\\a\\\u2026","d\\b\\\u2026"]),t.deepStrictEqual(e.shorten(["a\\b\\c\\d","a\\f\\b\\c\\d"]),["a\\b\\\u2026","\u2026\\f\\\u2026"]),t.deepStrictEqual(e.shorten(["a\\b\\a","b\\b\\a"]),["a\\b\\\u2026","b\\b\\\u2026"]),t.deepStrictEqual(e.shorten(["d\\f\\a\\b\\c","h\\d\\b\\c"]),["\u2026\\a\\\u2026","h\\\u2026"]),t.deepStrictEqual(e.shorten(["a\\b\\c","x:\\0\\a\\b\\c"]),["a\\b\\c","x:\\0\\\u2026"]),t.deepStrictEqual(e.shorten(["x:\\a\\b\\c","x:\\0\\a\\b\\c"]),["x:\\a\\\u2026","x:\\0\\\u2026"]),t.deepStrictEqual(e.shorten(["x:\\a\\b","y:\\a\\b"]),["x:\\\u2026","y:\\\u2026"]),t.deepStrictEqual(e.shorten(["x:\\a","x:\\c"]),["x:\\a","x:\\c"]),t.deepStrictEqual(e.shorten(["x:\\a\\b","y:\\x\\a\\b"]),["x:\\\u2026","y:\\\u2026"]),t.deepStrictEqual(e.shorten(["\\\\x\\b","\\\\y\\b"]),["\\\\x\\\u2026","\\\\y\\\u2026"]),t.deepStrictEqual(e.shorten(["\\\\x\\a","\\\\x\\b"]),["\\\\x\\a","\\\\x\\b"]),t.deepStrictEqual(e.shorten(["a\\b","a\\c","a\\e-b"]),["\u2026\\b","\u2026\\c","\u2026\\e-b"]),t.deepStrictEqual(e.shorten(["a\\b\\c","d\\b\\e"]),["\u2026\\c","\u2026\\e"]),t.deepStrictEqual(e.shorten(["a\\b\\c","d\\b\\C"]),["\u2026\\c","\u2026\\C"]),t.deepStrictEqual(e.shorten(["",null]),[".\\",null]),t.deepStrictEqual(e.shorten(["a","a\\b","a\\b\\c","d\\b\\c","d\\b"]),["a","a\\b","a\\b\\c","d\\b\\c","d\\b"]),t.deepStrictEqual(e.shorten(["a","a\\b","b"]),["a","a\\b","b"]),t.deepStrictEqual(e.shorten(["","a","b","b\\c","a\\c"]),[".\\","a","b","b\\c","a\\c"]),t.deepStrictEqual(e.shorten(["src\\vs\\workbench\\parts\\execution\\electron-sandbox","src\\vs\\workbench\\parts\\execution\\electron-sandbox\\something","src\\vs\\workbench\\parts\\terminal\\electron-sandbox"]),["\u2026\\execution\\electron-sandbox","\u2026\\something","\u2026\\terminal\\\u2026"])}),(h?test.skip:test)("shorten - not windows",()=>{t.deepStrictEqual(e.shorten(["a"]),["a"]),t.deepStrictEqual(e.shorten(["a","b"]),["a","b"]),t.deepStrictEqual(e.shorten(["/a","/b"]),["/a","/b"]),t.deepStrictEqual(e.shorten(["~/a/b/c","~/a/b/c"]),["~/a/b/c","~/a/b/c"]),t.deepStrictEqual(e.shorten(["a","b","c"]),["a","b","c"]),t.deepStrictEqual(e.shorten(["a/b","c/d","e/f"]),["\u2026/b","\u2026/d","\u2026/f"]),t.deepStrictEqual(e.shorten(["a","a/b"]),["a","\u2026/b"]),t.deepStrictEqual(e.shorten(["a/b","a/b/c"]),["\u2026/b","\u2026/c"]),t.deepStrictEqual(e.shorten(["a","a/b","a/b/c"]),["a","\u2026/b","\u2026/c"]),t.deepStrictEqual(e.shorten(["/a/b","/a/c"]),["/a/b","/a/c"]),t.deepStrictEqual(e.shorten(["a","b/a"]),["a","b/\u2026"]),t.deepStrictEqual(e.shorten(["a/b/c","d/b/c"]),["a/\u2026","d/\u2026"]),t.deepStrictEqual(e.shorten(["a/b/c/d","f/b/c/d"]),["a/\u2026","f/\u2026"]),t.deepStrictEqual(e.shorten(["d/e/a/b/c","d/b/c"]),["\u2026/a/\u2026","d/b/\u2026"]),t.deepStrictEqual(e.shorten(["a/b/c/d","a/f/b/c/d"]),["a/b/\u2026","\u2026/f/\u2026"]),t.deepStrictEqual(e.shorten(["a/b/a","b/b/a"]),["a/b/\u2026","b/b/\u2026"]),t.deepStrictEqual(e.shorten(["d/f/a/b/c","h/d/b/c"]),["\u2026/a/\u2026","h/\u2026"]),t.deepStrictEqual(e.shorten(["/x/b","/y/b"]),["/x/\u2026","/y/\u2026"]),t.deepStrictEqual(e.shorten(["a/b","a/c","a/e-b"]),["\u2026/b","\u2026/c","\u2026/e-b"]),t.deepStrictEqual(e.shorten(["a/b/c","d/b/e"]),["\u2026/c","\u2026/e"]),t.deepStrictEqual(e.shorten(["a/b/c","d/b/C"]),["\u2026/c","\u2026/C"]),t.deepStrictEqual(e.shorten(["",null]),["./",null]),t.deepStrictEqual(e.shorten(["a","a/b","a/b/c","d/b/c","d/b"]),["a","a/b","a/b/c","d/b/c","d/b"]),t.deepStrictEqual(e.shorten(["a","a/b","b"]),["a","a/b","b"]),t.deepStrictEqual(e.shorten(["","a","b","b/c","a/c"]),["./","a","b","b/c","a/c"])}),test("template",()=>{t.strictEqual(e.template("Foo Bar"),"Foo Bar"),t.strictEqual(e.template("Foo${}Bar"),"FooBar"),t.strictEqual(e.template("$FooBar"),""),t.strictEqual(e.template("}FooBar"),"}FooBar"),t.strictEqual(e.template("Foo ${one} Bar",{one:"value"}),"Foo value Bar"),t.strictEqual(e.template("Foo ${one} Bar ${two}",{one:"value",two:"other value"}),"Foo value Bar other value"),t.strictEqual(e.template("Foo${separator}Bar"),"FooBar"),t.strictEqual(e.template("Foo${separator}Bar",{separator:{label:" - "}}),"Foo - Bar"),t.strictEqual(e.template("${separator}Foo${separator}Bar",{value:"something",separator:{label:" - "}}),"Foo - Bar"),t.strictEqual(e.template("${value} Foo${separator}Bar",{value:"something",separator:{label:" - "}}),"something Foo - Bar");let o="${activeEditorShort}${separator}${rootName}";t.strictEqual(e.template(o,{activeEditorShort:"",rootName:"",separator:{label:" - "}}),""),t.strictEqual(e.template(o,{activeEditorShort:"",rootName:"root",separator:{label:" - "}}),"root"),t.strictEqual(e.template(o,{activeEditorShort:"markdown.txt",rootName:"root",separator:{label:" - "}}),"markdown.txt - root"),o="${dirty}${activeEditorShort}${separator}${rootName}${separator}${appName}",t.strictEqual(e.template(o,{dirty:"",activeEditorShort:"",rootName:"",appName:"",separator:{label:" - "}}),""),t.strictEqual(e.template(o,{dirty:"",activeEditorShort:"",rootName:"",appName:"Visual Studio Code",separator:{label:" - "}}),"Visual Studio Code"),t.strictEqual(e.template(o,{dirty:"",activeEditorShort:"Untitled-1",rootName:"",appName:"Visual Studio Code",separator:{label:" - "}}),"Untitled-1 - Visual Studio Code"),t.strictEqual(e.template(o,{dirty:"",activeEditorShort:"",rootName:"monaco",appName:"Visual Studio Code",separator:{label:" - "}}),"monaco - Visual Studio Code"),t.strictEqual(e.template(o,{dirty:"",activeEditorShort:"somefile.txt",rootName:"monaco",appName:"Visual Studio Code",separator:{label:" - "}}),"somefile.txt - monaco - Visual Studio Code"),t.strictEqual(e.template(o,{dirty:"* ",activeEditorShort:"somefile.txt",rootName:"monaco",appName:"Visual Studio Code",separator:{label:" - "}}),"* somefile.txt - monaco - Visual Studio Code"),o="${dirty}${activeEditorShort}${separator}${rootNameShort}${separator}${appName}",t.strictEqual(e.template(o,{dirty:"",activeEditorShort:"",rootName:"monaco (Workspace)",rootNameShort:"monaco",appName:"Visual Studio Code",separator:{label:" - "}}),"monaco - Visual Studio Code")}),test("mnemonicButtonLabel",()=>{t.strictEqual(e.mnemonicButtonLabel("Hello World"),"Hello World"),t.strictEqual(e.mnemonicButtonLabel(""),""),h?(t.strictEqual(e.mnemonicButtonLabel("Hello & World"),"Hello && World"),t.strictEqual(e.mnemonicButtonLabel("Do &&not Save & Continue"),"Do &not Save && Continue")):q?(t.strictEqual(e.mnemonicButtonLabel("Hello & World"),"Hello & World"),t.strictEqual(e.mnemonicButtonLabel("Do &&not Save & Continue"),"Do not Save & Continue")):(t.strictEqual(e.mnemonicButtonLabel("Hello & World"),"Hello & World"),t.strictEqual(e.mnemonicButtonLabel("Do &&not Save & Continue"),"Do _not Save & Continue"))}),test("getPathLabel",()=>{const o=l.file("c:/some/folder/file.txt"),r=l.file("/some/folder/file.txt"),E=l.revive({scheme:"vscode",authority:"file",path:"//some/folder/file.txt"}),u=l.file("c:/some/folder/file.txt").with({authority:"auth"}),n=l.file("/some/folder/file.txt").with({scheme:"vscode-test",authority:"auth"});t.strictEqual(e.getPathLabel(o,{os:a.Windows}),"C:\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(o,{os:a.Macintosh}),"c:/some/folder/file.txt"),t.strictEqual(e.getPathLabel(o,{os:a.Linux}),"c:/some/folder/file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Windows}),"\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Macintosh}),"/some/folder/file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Linux}),"/some/folder/file.txt"),t.strictEqual(e.getPathLabel(u,{os:a.Windows}),"\\\\auth\\c:\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(u,{os:a.Macintosh}),"/auth/c:/some/folder/file.txt"),t.strictEqual(e.getPathLabel(u,{os:a.Linux}),"/auth/c:/some/folder/file.txt"),t.strictEqual(e.getPathLabel(n,{os:a.Windows}),"\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(n,{os:a.Macintosh}),"/some/folder/file.txt"),t.strictEqual(e.getPathLabel(n,{os:a.Linux}),"/some/folder/file.txt");const s=l.file("/some"),c=l.file("/some").with({scheme:"vscode-test",authority:"auth"});t.strictEqual(e.getPathLabel(r,{os:a.Windows,tildify:{userHome:s}}),"\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Macintosh,tildify:{userHome:s}}),"~/folder/file.txt"),t.strictEqual(e.getPathLabel(E,{os:a.Macintosh,tildify:{userHome:s}}),"/some/folder/file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Linux,tildify:{userHome:s}}),"~/folder/file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Windows,tildify:{userHome:c}}),"\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Macintosh,tildify:{userHome:c}}),"~/folder/file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Linux,tildify:{userHome:c}}),"~/folder/file.txt");const i=l.file("/some/folder/file.txt").with({scheme:"untitled"});t.strictEqual(e.getPathLabel(i,{os:a.Windows,tildify:{userHome:s}}),"\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Macintosh,tildify:{userHome:s}}),"~/folder/file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Linux,tildify:{userHome:s}}),"~/folder/file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Windows,tildify:{userHome:c}}),"\\some\\folder\\file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Macintosh,tildify:{userHome:c}}),"~/folder/file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Linux,tildify:{userHome:c}}),"~/folder/file.txt");const m=l.file("c:/some"),b={getWorkspace(){return{folders:[{uri:m}]}},getWorkspaceFolder(f){return{uri:m}}};t.strictEqual(e.getPathLabel(o,{os:a.Windows,relative:b}),"folder\\file.txt"),t.strictEqual(e.getPathLabel(o,{os:a.Macintosh,relative:b}),"folder/file.txt"),t.strictEqual(e.getPathLabel(o,{os:a.Linux,relative:b}),"folder/file.txt");const p=l.file("/some"),d={getWorkspace(){return{folders:[{uri:p}]}},getWorkspaceFolder(f){return{uri:p}}};t.strictEqual(e.getPathLabel(r,{os:a.Windows,relative:d}),"folder\\file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Macintosh,relative:d}),"folder/file.txt"),t.strictEqual(e.getPathLabel(r,{os:a.Linux,relative:d}),"folder/file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Windows,relative:d}),"folder\\file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Macintosh,relative:d}),"folder/file.txt"),t.strictEqual(e.getPathLabel(i,{os:a.Linux,relative:d}),"folder/file.txt")}),x()});
