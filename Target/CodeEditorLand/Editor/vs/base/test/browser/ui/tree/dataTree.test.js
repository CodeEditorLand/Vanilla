import t from"assert";import"../../../../browser/ui/list/list.js";import{DataTree as v}from"../../../../browser/ui/tree/dataTree.js";import"../../../../browser/ui/tree/tree.js";import{ensureNoDisposablesAreLeakedInTestSuite as o}from"../../../common/utils.js";suite("DataTree",function(){let l;const a={value:-1,children:[{value:0,children:[{value:10},{value:11},{value:12}]},{value:1},{value:2}]},u={value:-1,children:[]};teardown(()=>l.dispose()),o(),setup(()=>{const e=document.createElement("div");e.style.width="200px",e.style.height="200px";const r=new class{getHeight(){return 20}getTemplateId(){return"default"}},i=new class{templateId="default";renderTemplate(n){return n}renderElement(n,d,E){E.textContent=`${n.element.value}`}disposeTemplate(){}},s=new class{getChildren(n){return n.children||[]}},c=new class{getId(n){return`${n.value}`}};l=new v("test",e,r,[i],s,{identityProvider:c}),l.layout(200)}),test("view state is lost implicitly",()=>{l.setInput(a);let e=l.navigate();t.strictEqual(e.next().value,0),t.strictEqual(e.next().value,10),t.strictEqual(e.next().value,11),t.strictEqual(e.next().value,12),t.strictEqual(e.next().value,1),t.strictEqual(e.next().value,2),t.strictEqual(e.next(),null),l.collapse(a.children[0]),e=l.navigate(),t.strictEqual(e.next().value,0),t.strictEqual(e.next().value,1),t.strictEqual(e.next().value,2),t.strictEqual(e.next(),null),l.setSelection([a.children[1]]),l.setFocus([a.children[2]]),l.setInput(u),l.setInput(a),e=l.navigate(),t.strictEqual(e.next().value,0),t.strictEqual(e.next().value,10),t.strictEqual(e.next().value,11),t.strictEqual(e.next().value,12),t.strictEqual(e.next().value,1),t.strictEqual(e.next().value,2),t.strictEqual(e.next(),null),t.deepStrictEqual(l.getSelection(),[]),t.deepStrictEqual(l.getFocus(),[])}),test("view state can be preserved",()=>{l.setInput(a);let e=l.navigate();t.strictEqual(e.next().value,0),t.strictEqual(e.next().value,10),t.strictEqual(e.next().value,11),t.strictEqual(e.next().value,12),t.strictEqual(e.next().value,1),t.strictEqual(e.next().value,2),t.strictEqual(e.next(),null),l.collapse(a.children[0]),e=l.navigate(),t.strictEqual(e.next().value,0),t.strictEqual(e.next().value,1),t.strictEqual(e.next().value,2),t.strictEqual(e.next(),null),l.setSelection([a.children[1]]),l.setFocus([a.children[2]]);const r=l.getViewState();l.setInput(u),l.setInput(a,r),e=l.navigate(),t.strictEqual(e.next().value,0),t.strictEqual(e.next().value,1),t.strictEqual(e.next().value,2),t.strictEqual(e.next(),null),t.deepStrictEqual(l.getSelection(),[a.children[1]]),t.deepStrictEqual(l.getFocus(),[a.children[2]])})});
