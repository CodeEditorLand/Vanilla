import*as l from"crypto";import*as m from"fs";function u(n,r){let a=this,c=!1,e;return function(){if(c)return e;if(c=!0,r)try{e=n.apply(a,arguments)}finally{r()}else e=n.apply(a,arguments);return e}}async function g(n,r){if(await new Promise((e,h)=>{let t=m.createReadStream(n),s=l.createHash("sha256");t.pipe(s);let o=u((i,f)=>{t.removeAllListeners(),s.removeAllListeners(),i?h(i):e(f)});t.once("error",o),t.once("end",o),s.once("error",o),s.once("data",i=>o(void 0,i.toString("hex")))})!==r)throw new Error("Hash mismatch")}export{g as checksum};
