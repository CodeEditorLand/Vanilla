import*as s from"net";function E(e,n,o,u=1){let r=!1;return new Promise(i=>{const d=setTimeout(()=>{if(!r)return r=!0,i(0)},o);f(e,n,u,t=>{if(!r)return r=!0,clearTimeout(d),i(t)})})}function f(e,n,o,u){if(n===0)return u(0);const r=new s.Socket;r.once("connect",()=>(b(r),f(e+o,n-1,o,u))),r.once("data",()=>{}),r.once("error",i=>(b(r),i.code!=="ECONNREFUSED"?f(e+o,n-1,o,u):u(e))),r.connect(e,"127.0.0.1")}const a={1:!0,7:!0,9:!0,11:!0,13:!0,15:!0,17:!0,19:!0,20:!0,21:!0,22:!0,23:!0,25:!0,37:!0,42:!0,43:!0,53:!0,69:!0,77:!0,79:!0,87:!0,95:!0,101:!0,102:!0,103:!0,104:!0,109:!0,110:!0,111:!0,113:!0,115:!0,117:!0,119:!0,123:!0,135:!0,137:!0,139:!0,143:!0,161:!0,179:!0,389:!0,427:!0,465:!0,512:!0,513:!0,514:!0,515:!0,526:!0,530:!0,531:!0,532:!0,540:!0,548:!0,554:!0,556:!0,563:!0,587:!0,601:!0,636:!0,989:!0,990:!0,993:!0,995:!0,1719:!0,1720:!0,1723:!0,2049:!0,3659:!0,4045:!0,5060:!0,5061:!0,6e3:!0,6566:!0,6665:!0,6666:!0,6667:!0,6668:!0,6669:!0,6697:!0,10080:!0};function S(e,n,o,u="127.0.0.1"){let r=!1,i,d=1;const t=s.createServer({pauseOnConnect:!0});function l(m,c){r||(r=!0,t.removeAllListeners(),t.close(),i&&clearTimeout(i),c(m))}return new Promise(m=>{i=setTimeout(()=>{l(0,m)},o),t.on("listening",()=>{l(e,m)}),t.on("error",c=>{c&&(c.code==="EADDRINUSE"||c.code==="EACCES")&&d<n?(e++,d++,t.listen(e,u)):l(0,m)}),t.on("close",()=>{l(0,m)}),t.listen(e,u)})}function b(e){try{e.removeAllListeners("connect"),e.removeAllListeners("error"),e.end(),e.destroy(),e.unref()}catch{}}export{a as BROWSER_RESTRICTED_PORTS,E as findFreePort,S as findFreePortFaster};
