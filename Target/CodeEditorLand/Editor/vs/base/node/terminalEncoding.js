import{exec as s}from"child_process";import{isWindows as m}from"../common/platform.js";const a={437:"cp437",850:"cp850",852:"cp852",855:"cp855",857:"cp857",860:"cp860",861:"cp861",863:"cp863",865:"cp865",866:"cp866",869:"cp869",936:"cp936",1252:"cp1252"};function f(n){const o=n.replace(/[^a-zA-Z0-9]/g,"").toLowerCase();return E[o]||o}const E={ibm866:"cp866",big5:"cp950"},d="utf8";async function C(n){let o;const r=process.env.VSCODE_CLI_ENCODING;r?o=Promise.resolve(r):m?o=new Promise(i=>{s("chcp",(g,c,l)=>{if(c){const p=Object.keys(a);for(const t of p)if(c.indexOf(t)>=0)return i(a[t])}return i(void 0)})}):o=new Promise(i=>{s("locale charmap",(g,c,l)=>i(c))});const e=await o;return!e||e.toLowerCase()==="utf-8"||e.toLowerCase()===d?d:f(e)}export{C as resolveTerminalEncoding};
