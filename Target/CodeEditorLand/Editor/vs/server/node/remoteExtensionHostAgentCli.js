var ry=Object.create;var Fs=Object.defineProperty;var Qd=Object.getOwnPropertyDescriptor;var iy=Object.getOwnPropertyNames;var oy=Object.getPrototypeOf,sy=Object.prototype.hasOwnProperty;var st=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});var Ft=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),ay=(n,t)=>{for(var e in t)Fs(n,e,{get:t[e],enumerable:!0})},ly=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of iy(t))!sy.call(n,i)&&i!==e&&Fs(n,i,{get:()=>t[i],enumerable:!(r=Qd(t,i))||r.enumerable});return n};var bc=(n,t,e)=>(e=n!=null?ry(oy(n)):{},ly(t||!n||!n.__esModule?Fs(e,"default",{value:n,enumerable:!0}):e,n));var D=(n,t,e,r)=>{for(var i=r>1?void 0:r?Qd(t,e):t,o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=(r?s(t,e,i):s(i))||i);return r&&i&&Fs(t,e,i),i},b=(n,t)=>(e,r)=>t(e,r,n);var Bg=Ft((s7,Kg)=>{"use strict";function db(n,t){var e=n;t.slice(0,-1).forEach(function(i){e=e[i]||{}});var r=t[t.length-1];return r in e}function Vg(n){return typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}function Wg(n,t){return t==="constructor"&&typeof n[t]=="function"||t==="__proto__"}Kg.exports=function(n,t){t||(t={});var e={bools:{},strings:{},unknownFn:null};typeof t.unknown=="function"&&(e.unknownFn=t.unknown),typeof t.boolean=="boolean"&&t.boolean?e.allBools=!0:[].concat(t.boolean).filter(Boolean).forEach(function(E){e.bools[E]=!0});var r={};function i(E){return r[E].some(function(_){return e.bools[_]})}Object.keys(t.alias||{}).forEach(function(E){r[E]=[].concat(t.alias[E]),r[E].forEach(function(_){r[_]=[E].concat(r[E].filter(function(N){return _!==N}))})}),[].concat(t.string).filter(Boolean).forEach(function(E){e.strings[E]=!0,r[E]&&[].concat(r[E]).forEach(function(_){e.strings[_]=!0})});var o=t.default||{},s={_:[]};function a(E,_){return e.allBools&&/^--[^=]+$/.test(_)||e.strings[E]||e.bools[E]||r[E]}function l(E,_,N){for(var A=E,Ie=0;Ie<_.length-1;Ie++){var q=_[Ie];if(Wg(A,q))return;A[q]===void 0&&(A[q]={}),(A[q]===Object.prototype||A[q]===Number.prototype||A[q]===String.prototype)&&(A[q]={}),A[q]===Array.prototype&&(A[q]=[]),A=A[q]}var ye=_[_.length-1];Wg(A,ye)||((A===Object.prototype||A===Number.prototype||A===String.prototype)&&(A={}),A===Array.prototype&&(A=[]),A[ye]===void 0||e.bools[ye]||typeof A[ye]=="boolean"?A[ye]=N:Array.isArray(A[ye])?A[ye].push(N):A[ye]=[A[ye],N])}function c(E,_,N){if(!(N&&e.unknownFn&&!a(E,N)&&e.unknownFn(N)===!1)){var A=!e.strings[E]&&Vg(_)?Number(_):_;l(s,E.split("."),A),(r[E]||[]).forEach(function(Ie){l(s,Ie.split("."),A)})}}Object.keys(e.bools).forEach(function(E){c(E,o[E]===void 0?!1:o[E])});var u=[];n.indexOf("--")!==-1&&(u=n.slice(n.indexOf("--")+1),n=n.slice(0,n.indexOf("--")));for(var f=0;f<n.length;f++){var p=n[f],h,v;if(/^--.+=/.test(p)){var y=p.match(/^--([^=]+)=([\s\S]*)$/);h=y[1];var I=y[2];e.bools[h]&&(I=I!=="false"),c(h,I,p)}else if(/^--no-.+/.test(p))h=p.match(/^--no-(.+)/)[1],c(h,!1,p);else if(/^--.+/.test(p))h=p.match(/^--(.+)/)[1],v=n[f+1],v!==void 0&&!/^(-|--)[^-]/.test(v)&&!e.bools[h]&&!e.allBools&&(!r[h]||!i(h))?(c(h,v,p),f+=1):/^(true|false)$/.test(v)?(c(h,v==="true",p),f+=1):c(h,e.strings[h]?"":!0,p);else if(/^-[^-]+/.test(p)){for(var S=p.slice(1,-1).split(""),T=!1,k=0;k<S.length;k++){if(v=p.slice(k+2),v==="-"){c(S[k],v,p);continue}if(/[A-Za-z]/.test(S[k])&&v[0]==="="){c(S[k],v.slice(1),p),T=!0;break}if(/[A-Za-z]/.test(S[k])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(v)){c(S[k],v,p),T=!0;break}if(S[k+1]&&S[k+1].match(/\W/)){c(S[k],p.slice(k+2),p),T=!0;break}else c(S[k],e.strings[S[k]]?"":!0,p)}h=p.slice(-1)[0],!T&&h!=="-"&&(n[f+1]&&!/^(-|--)[^-]/.test(n[f+1])&&!e.bools[h]&&(!r[h]||!i(h))?(c(h,n[f+1],p),f+=1):n[f+1]&&/^(true|false)$/.test(n[f+1])?(c(h,n[f+1]==="true",p),f+=1):c(h,e.strings[h]?"":!0,p))}else if((!e.unknownFn||e.unknownFn(p)!==!1)&&s._.push(e.strings._||!Vg(p)?p:Number(p)),t.stopEarly){s._.push.apply(s._,n.slice(f+1));break}}return Object.keys(o).forEach(function(E){db(s,E.split("."))||(l(s,E.split("."),o[E]),(r[E]||[]).forEach(function(_){l(s,_.split("."),o[E])}))}),t["--"]?s["--"]=u.slice():u.forEach(function(E){s._.push(E)}),s}});var Jg=Ft((M7,Qg)=>{"use strict";var Li=1e3,Ui=Li*60,Ni=Ui*60,$r=Ni*24,bb=$r*7,Ib=$r*365.25;Qg.exports=function(n,t){t=t||{};var e=typeof n;if(e==="string"&&n.length>0)return xb(n);if(e==="number"&&isFinite(n))return t.long?Sb(n):Eb(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function xb(n){if(n=String(n),!(n.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(t){var e=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return e*Ib;case"weeks":case"week":case"w":return e*bb;case"days":case"day":case"d":return e*$r;case"hours":case"hour":case"hrs":case"hr":case"h":return e*Ni;case"minutes":case"minute":case"mins":case"min":case"m":return e*Ui;case"seconds":case"second":case"secs":case"sec":case"s":return e*Li;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function Eb(n){var t=Math.abs(n);return t>=$r?Math.round(n/$r)+"d":t>=Ni?Math.round(n/Ni)+"h":t>=Ui?Math.round(n/Ui)+"m":t>=Li?Math.round(n/Li)+"s":n+"ms"}function Sb(n){var t=Math.abs(n);return t>=$r?dl(n,t,$r,"day"):t>=Ni?dl(n,t,Ni,"hour"):t>=Ui?dl(n,t,Ui,"minute"):t>=Li?dl(n,t,Li,"second"):n+" ms"}function dl(n,t,e,r){var i=t>=e*1.5;return Math.round(n/e)+" "+r+(i?"s":"")}});var ed=Ft((V7,Xg)=>{"use strict";function wb(n){e.debug=e,e.default=e,e.coerce=l,e.disable=o,e.enable=i,e.enabled=s,e.humanize=Jg(),e.destroy=c,Object.keys(n).forEach(u=>{e[u]=n[u]}),e.names=[],e.skips=[],e.formatters={};function t(u){let f=0;for(let p=0;p<u.length;p++)f=(f<<5)-f+u.charCodeAt(p),f|=0;return e.colors[Math.abs(f)%e.colors.length]}e.selectColor=t;function e(u){let f,p=null,h,v;function y(...I){if(!y.enabled)return;let S=y,T=Number(new Date),k=T-(f||T);S.diff=k,S.prev=f,S.curr=T,f=T,I[0]=e.coerce(I[0]),typeof I[0]!="string"&&I.unshift("%O");let E=0;I[0]=I[0].replace(/%([a-zA-Z%])/g,(N,A)=>{if(N==="%%")return"%";E++;let Ie=e.formatters[A];if(typeof Ie=="function"){let q=I[E];N=Ie.call(S,q),I.splice(E,1),E--}return N}),e.formatArgs.call(S,I),(S.log||e.log).apply(S,I)}return y.namespace=u,y.useColors=e.useColors(),y.color=e.selectColor(u),y.extend=r,y.destroy=e.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(h!==e.namespaces&&(h=e.namespaces,v=e.enabled(u)),v),set:I=>{p=I}}),typeof e.init=="function"&&e.init(y),y}function r(u,f){let p=e(this.namespace+(typeof f>"u"?":":f)+u);return p.log=this.log,p}function i(u){e.save(u),e.namespaces=u,e.names=[],e.skips=[];let f,p=(typeof u=="string"?u:"").split(/[\s,]+/),h=p.length;for(f=0;f<h;f++)p[f]&&(u=p[f].replace(/\*/g,".*?"),u[0]==="-"?e.skips.push(new RegExp("^"+u.slice(1)+"$")):e.names.push(new RegExp("^"+u+"$")))}function o(){let u=[...e.names.map(a),...e.skips.map(a).map(f=>"-"+f)].join(",");return e.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let f,p;for(f=0,p=e.skips.length;f<p;f++)if(e.skips[f].test(u))return!1;for(f=0,p=e.names.length;f<p;f++)if(e.names[f].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}Xg.exports=wb});var Yg=Ft((zt,fl)=>{"use strict";zt.formatArgs=Pb;zt.save=_b;zt.load=Rb;zt.useColors=Tb;zt.storage=Cb();zt.destroy=(()=>{let n=!1;return()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();zt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Tb(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let n;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(n=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(n[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Pb(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+fl.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;n.splice(1,0,t,"color: inherit");let e=0,r=0;n[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(e++,i==="%c"&&(r=e))}),n.splice(r,0,t)}zt.log=console.debug||console.log||(()=>{});function _b(n){try{n?zt.storage.setItem("debug",n):zt.storage.removeItem("debug")}catch{}}function Rb(){let n;try{n=zt.storage.getItem("debug")}catch{}return!n&&typeof process<"u"&&"env"in process&&(n=process.env.DEBUG),n}function Cb(){try{return localStorage}catch{}}fl.exports=ed()(zt);var{formatters:Db}=fl.exports;Db.j=function(n){try{return JSON.stringify(n)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var eh=Ft((W7,Zg)=>{"use strict";Zg.exports=(n,t)=>{t=t||process.argv;let e=n.startsWith("-")?"":n.length===1?"-":"--",r=t.indexOf(e+n),i=t.indexOf("--");return r!==-1&&(i===-1?!0:r<i)}});var nh=Ft((K7,th)=>{"use strict";var kb=st("os"),mn=eh(),yt=process.env,Mi;mn("no-color")||mn("no-colors")||mn("color=false")?Mi=!1:(mn("color")||mn("colors")||mn("color=true")||mn("color=always"))&&(Mi=!0);"FORCE_COLOR"in yt&&(Mi=yt.FORCE_COLOR.length===0||parseInt(yt.FORCE_COLOR,10)!==0);function Ob(n){return n===0?!1:{level:n,hasBasic:!0,has256:n>=2,has16m:n>=3}}function Ab(n){if(Mi===!1)return 0;if(mn("color=16m")||mn("color=full")||mn("color=truecolor"))return 3;if(mn("color=256"))return 2;if(n&&!n.isTTY&&Mi!==!0)return 0;let t=Mi?1:0;if(process.platform==="win32"){let e=kb.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in yt)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in yt)||yt.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in yt)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(yt.TEAMCITY_VERSION)?1:0;if(yt.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in yt){let e=parseInt((yt.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(yt.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(yt.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(yt.TERM)||"COLORTERM"in yt?1:(yt.TERM==="dumb",t)}function td(n){let t=Ab(n);return Ob(t)}th.exports={supportsColor:td,stdout:td(process.stdout),stderr:td(process.stderr)}});var ih=Ft((nt,gl)=>{"use strict";var Fb=st("tty"),pl=st("util");nt.init=Kb;nt.log=Mb;nt.formatArgs=Ub;nt.save=Vb;nt.load=Wb;nt.useColors=Lb;nt.destroy=pl.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");nt.colors=[6,2,3,4,5,1];try{let n=nh();n&&(n.stderr||n).level>=2&&(nt.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}nt.inspectOpts=Object.keys(process.env).filter(n=>/^debug_/i.test(n)).reduce((n,t)=>{let e=t.substring(6).toLowerCase().replace(/_([a-z])/g,(i,o)=>o.toUpperCase()),r=process.env[t];return/^(yes|on|true|enabled)$/i.test(r)?r=!0:/^(no|off|false|disabled)$/i.test(r)?r=!1:r==="null"?r=null:r=Number(r),n[e]=r,n},{});function Lb(){return"colors"in nt.inspectOpts?!!nt.inspectOpts.colors:Fb.isatty(process.stderr.fd)}function Ub(n){let{namespace:t,useColors:e}=this;if(e){let r=this.color,i="\x1B[3"+(r<8?r:"8;5;"+r),o=`  ${i};1m${t} \x1B[0m`;n[0]=o+n[0].split(`
`).join(`
`+o),n.push(i+"m+"+gl.exports.humanize(this.diff)+"\x1B[0m")}else n[0]=Nb()+t+" "+n[0]}function Nb(){return nt.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Mb(...n){return process.stderr.write(pl.formatWithOptions(nt.inspectOpts,...n)+`
`)}function Vb(n){n?process.env.DEBUG=n:delete process.env.DEBUG}function Wb(){return process.env.DEBUG}function Kb(n){n.inspectOpts={};let t=Object.keys(nt.inspectOpts);for(let e=0;e<t.length;e++)n.inspectOpts[t[e]]=nt.inspectOpts[t[e]]}gl.exports=ed()(nt);var{formatters:rh}=gl.exports;rh.o=function(n){return this.inspectOpts.colors=this.useColors,pl.inspect(n,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};rh.O=function(n){return this.inspectOpts.colors=this.useColors,pl.inspect(n,this.inspectOpts)}});var hl=Ft((B7,nd)=>{"use strict";typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?nd.exports=Yg():nd.exports=ih()});var ah=Ft(Dt=>{"use strict";var Bb=Dt&&Dt.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),qb=Dt&&Dt.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),oh=Dt&&Dt.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&Bb(t,n,e);return qb(t,n),t};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.req=Dt.json=Dt.toBuffer=void 0;var $b=oh(st("http")),zb=oh(st("https"));async function sh(n){let t=0,e=[];for await(let r of n)t+=r.length,e.push(r);return Buffer.concat(e,t)}Dt.toBuffer=sh;async function jb(n){let e=(await sh(n)).toString("utf8");try{return JSON.parse(e)}catch(r){let i=r;throw i.message+=` (input: ${e})`,i}}Dt.json=jb;function Gb(n,t={}){let r=((typeof n=="string"?n:n.href).startsWith("https:")?zb:$b).request(n,t),i=new Promise((o,s)=>{r.once("response",o).once("error",s).end()});return r.then=i.then.bind(i),r}Dt.req=Gb});var id=Ft(jt=>{"use strict";var ch=jt&&jt.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),Hb=jt&&jt.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),uh=jt&&jt.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&ch(t,n,e);return Hb(t,n),t},Qb=jt&&jt.__exportStar||function(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&ch(t,n,e)};Object.defineProperty(jt,"__esModule",{value:!0});jt.Agent=void 0;var Jb=uh(st("net")),lh=uh(st("http")),Xb=st("https");Qb(ah(),jt);var kn=Symbol("AgentBaseInternalState"),rd=class extends lh.Agent{constructor(t){super(t),this[kn]={}}isSecureEndpoint(t){if(t){if(typeof t.secureEndpoint=="boolean")return t.secureEndpoint;if(typeof t.protocol=="string")return t.protocol==="https:"}let{stack:e}=new Error;return typeof e!="string"?!1:e.split(`
`).some(r=>r.indexOf("(https.js:")!==-1||r.indexOf("node:https:")!==-1)}incrementSockets(t){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[t]||(this.sockets[t]=[]);let e=new Jb.Socket({writable:!1});return this.sockets[t].push(e),this.totalSocketCount++,e}decrementSockets(t,e){if(!this.sockets[t]||e===null)return;let r=this.sockets[t],i=r.indexOf(e);i!==-1&&(r.splice(i,1),this.totalSocketCount--,r.length===0&&delete this.sockets[t])}getName(t){return(typeof t.secureEndpoint=="boolean"?t.secureEndpoint:this.isSecureEndpoint(t))?Xb.Agent.prototype.getName.call(this,t):super.getName(t)}createSocket(t,e,r){let i={...e,secureEndpoint:this.isSecureEndpoint(e)},o=this.getName(i),s=this.incrementSockets(o);Promise.resolve().then(()=>this.connect(t,i)).then(a=>{if(this.decrementSockets(o,s),a instanceof lh.Agent)return a.addRequest(t,i);this[kn].currentSocket=a,super.createSocket(t,e,r)},a=>{this.decrementSockets(o,s),r(a)})}createConnection(){let t=this[kn].currentSocket;if(this[kn].currentSocket=void 0,!t)throw new Error("No socket was returned in the `connect()` function");return t}get defaultPort(){return this[kn].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(t){this[kn]&&(this[kn].defaultPort=t)}get protocol(){return this[kn].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(t){this[kn]&&(this[kn].protocol=t)}};jt.Agent=rd});var ph=Ft(tn=>{"use strict";var Yb=tn&&tn.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),Zb=tn&&tn.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),fh=tn&&tn.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&Yb(t,n,e);return Zb(t,n),t},eI=tn&&tn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(tn,"__esModule",{value:!0});tn.HttpProxyAgent=void 0;var tI=fh(st("net")),nI=fh(st("tls")),rI=eI(hl()),iI=st("events"),oI=id(),dh=st("url"),Vi=(0,rI.default)("http-proxy-agent"),ml=class extends oI.Agent{constructor(t,e){super(e),this.proxy=typeof t=="string"?new dh.URL(t):t,this.proxyHeaders=e?.headers??{},Vi("Creating new HttpProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={...e?sI(e,"headers"):null,host:r,port:i}}addRequest(t,e){t._header=null,this.setRequestProps(t,e),super.addRequest(t,e)}setRequestProps(t,e){let{proxy:r}=this,i=e.secureEndpoint?"https:":"http:",o=t.getHeader("host")||"localhost",s=`${i}//${o}`,a=new dh.URL(t.path,s);e.port!==80&&(a.port=String(e.port)),t.path=String(a);let l=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders};if(r.username||r.password){let c=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;l["Proxy-Authorization"]=`Basic ${Buffer.from(c).toString("base64")}`}l["Proxy-Connection"]||(l["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let c of Object.keys(l)){let u=l[c];u&&t.setHeader(c,u)}}async connect(t,e){t._header=null,t.path.includes("://")||this.setRequestProps(t,e);let r,i;Vi("Regenerating stored HTTP header string for request"),t._implicitHeader(),t.outputData&&t.outputData.length>0&&(Vi("Patching connection write() output buffer with updated header"),r=t.outputData[0].data,i=r.indexOf(`\r
\r
`)+4,t.outputData[0].data=t._header+r.substring(i),Vi("Output buffer: %o",t.outputData[0].data));let o;return this.proxy.protocol==="https:"?(Vi("Creating `tls.Socket`: %o",this.connectOpts),o=nI.connect(this.connectOpts)):(Vi("Creating `net.Socket`: %o",this.connectOpts),o=tI.connect(this.connectOpts)),await(0,iI.once)(o,"connect"),o}};ml.protocols=["http","https"];tn.HttpProxyAgent=ml;function sI(n,...t){let e={},r;for(r in n)t.includes(r)||(e[r]=n[r]);return e}});var gh=Ft(Wi=>{"use strict";var aI=Wi&&Wi.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.parseProxyResponse=void 0;var lI=aI(hl()),yl=(0,lI.default)("https-proxy-agent:parse-proxy-response");function cI(n){return new Promise((t,e)=>{let r=0,i=[];function o(){let u=n.read();u?c(u):n.once("readable",o)}function s(){n.removeListener("end",a),n.removeListener("error",l),n.removeListener("readable",o)}function a(){s(),yl("onend"),e(new Error("Proxy connection ended before receiving CONNECT response"))}function l(u){s(),yl("onerror %o",u),e(u)}function c(u){i.push(u),r+=u.length;let f=Buffer.concat(i,r),p=f.indexOf(`\r
\r
`);if(p===-1){yl("have not received end of HTTP headers yet..."),o();return}let h=f.slice(0,p).toString("ascii").split(`\r
`),v=h.shift();if(!v)return n.destroy(),e(new Error("No header received from proxy CONNECT response"));let y=v.split(" "),I=+y[1],S=y.slice(2).join(" "),T={};for(let k of h){if(!k)continue;let E=k.indexOf(":");if(E===-1)return n.destroy(),e(new Error(`Invalid header from proxy CONNECT response: "${k}"`));let _=k.slice(0,E).toLowerCase(),N=k.slice(E+1).trimStart(),A=T[_];typeof A=="string"?T[_]=[A,N]:Array.isArray(A)?A.push(N):T[_]=N}yl("got proxy server response: %o %o",v,T),s(),t({connect:{statusCode:I,statusText:S,headers:T},buffered:f})}n.on("error",l),n.on("end",a),o()})}Wi.parseProxyResponse=cI});var bh=Ft(nn=>{"use strict";var uI=nn&&nn.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),dI=nn&&nn.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),yh=nn&&nn.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.prototype.hasOwnProperty.call(n,e)&&uI(t,n,e);return dI(t,n),t},vh=nn&&nn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(nn,"__esModule",{value:!0});nn.HttpsProxyAgent=void 0;var od=yh(st("net")),hh=yh(st("tls")),fI=vh(st("assert")),pI=vh(hl()),gI=id(),hI=st("url"),mI=gh(),os=(0,pI.default)("https-proxy-agent"),vl=class extends gI.Agent{constructor(t,e){super(e),this.options={path:void 0},this.proxy=typeof t=="string"?new hI.URL(t):t,this.proxyHeaders=e?.headers??{},os("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...e?mh(e,"headers"):null,host:r,port:i}}async connect(t,e){let{proxy:r}=this;if(!e.host)throw new TypeError('No "host" provided');let i;if(r.protocol==="https:"){os("Creating `tls.Socket`: %o",this.connectOpts);let p=this.connectOpts.servername||this.connectOpts.host;i=hh.connect({...this.connectOpts,servername:p})}else os("Creating `net.Socket`: %o",this.connectOpts),i=od.connect(this.connectOpts);let o=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders},s=od.isIPv6(e.host)?`[${e.host}]`:e.host,a=`CONNECT ${s}:${e.port} HTTP/1.1\r
`;if(r.username||r.password){let p=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(p).toString("base64")}`}o.Host=`${s}:${e.port}`,o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let p of Object.keys(o))a+=`${p}: ${o[p]}\r
`;let l=(0,mI.parseProxyResponse)(i);i.write(`${a}\r
`);let{connect:c,buffered:u}=await l;if(t.emit("proxyConnect",c),this.emit("proxyConnect",c,t),c.statusCode===200){if(t.once("socket",yI),e.secureEndpoint){os("Upgrading socket connection to TLS");let p=e.servername||e.host;return hh.connect({...mh(e,"host","path","port"),socket:i,servername:p})}return i}i.destroy();let f=new od.Socket({writable:!1});return f.readable=!0,t.once("socket",p=>{os("Replaying proxy buffer for failed request"),(0,fI.default)(p.listenerCount("data")>0),p.push(u),p.push(null)}),f}};vl.protocols=["http","https"];nn.HttpsProxyAgent=vl;function yI(n){n.resume()}function mh(n,...t){let e={},r;for(r in n)t.includes(r)||(e[r]=n[r]);return e}});var Ic=class{unexpectedErrorHandler;listeners;constructor(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout(()=>{throw t.stack?In.isErrorNoTelemetry(t)?new In(t.message+`

`+t.stack):new Error(t.message+`

`+t.stack):t},0)}}addListener(t){return this.listeners.push(t),()=>{this._removeListener(t)}}emit(t){this.listeners.forEach(e=>{e(t)})}_removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}setUnexpectedErrorHandler(t){this.unexpectedErrorHandler=t}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(t){this.unexpectedErrorHandler(t),this.emit(t)}onUnexpectedExternalError(t){this.unexpectedErrorHandler(t)}},Jd=new Ic;function ei(n){Jd.onUnexpectedError(n)}function Lt(n){xn(n)||Jd.onUnexpectedError(n)}var Ls="Canceled";function xn(n){return n instanceof me?!0:n instanceof Error&&n.name===Ls&&n.message===Ls}var me=class extends Error{constructor(){super(Ls),this.name=this.message}};function Us(){let n=new Error(Ls);return n.name=n.message,n}function Ns(n){return n?new Error(`Illegal state: ${n}`):new Error("Illegal state")}function G(n){return n?n.message?n.message:n.stack?n.stack.split(`
`)[0]:String(n):"Error"}var In=class n extends Error{name;constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof n)return t;let e=new n;return e.message=t.message,e.stack=t.stack,e}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},Zr=class n extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,n.prototype)}};function xc(n,t){let e=this,r=!1,i;return function(){if(r)return i;if(r=!0,t)try{i=n.apply(e,arguments)}finally{t()}else i=n.apply(e,arguments);return i}}var Re=class n{static Undefined=new n(void 0);element;next;prev;constructor(t){this.element=t,this.next=n.Undefined,this.prev=n.Undefined}},Zn=class{_first=Re.Undefined;_last=Re.Undefined;_size=0;get size(){return this._size}isEmpty(){return this._first===Re.Undefined}clear(){let t=this._first;for(;t!==Re.Undefined;){let e=t.next;t.prev=Re.Undefined,t.next=Re.Undefined,t=e}this._first=Re.Undefined,this._last=Re.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,e){let r=new Re(t);if(this._first===Re.Undefined)this._first=r,this._last=r;else if(e){let o=this._last;this._last=r,r.prev=o,o.next=r}else{let o=this._first;this._first=r,r.next=o,o.prev=r}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(r))}}shift(){if(this._first!==Re.Undefined){let t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==Re.Undefined){let t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==Re.Undefined&&t.next!==Re.Undefined){let e=t.prev;e.next=t.next,t.next.prev=e}else t.prev===Re.Undefined&&t.next===Re.Undefined?(this._first=Re.Undefined,this._last=Re.Undefined):t.next===Re.Undefined?(this._last=this._last.prev,this._last.next=Re.Undefined):t.prev===Re.Undefined&&(this._first=this._first.next,this._first.prev=Re.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==Re.Undefined;)yield t.element,t=t.next}};var Pr=(n,t)=>n===t;var an=class{constructor(t,e,r){this.owner=t;this.debugNameSource=e;this.referenceFn=r}getDebugName(t){return tf(t,this)}},Yd=new Map,Sc=new WeakMap;function tf(n,t){let e=Sc.get(n);if(e)return e;let r=cy(n,t);if(r){let i=Yd.get(r)??0;i++,Yd.set(r,i);let o=i===1?r:`${r}#${i}`;return Sc.set(n,o),o}}function cy(n,t){let e=Sc.get(n);if(e)return e;let r=t.owner?dy(t.owner)+".":"",i,o=t.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(i=o(),i!==void 0)return r+i}else return r+o;let s=t.referenceFn;if(s!==void 0&&(i=Ms(s),i!==void 0))return r+i;if(t.owner!==void 0){let a=uy(t.owner,n);if(a!==void 0)return r+a}}function uy(n,t){for(let e in n)if(n[e]===t)return e}var Zd=new Map,ef=new WeakMap;function dy(n){let t=ef.get(n);if(t)return t;let e=fy(n),r=Zd.get(e)??0;r++,Zd.set(e,r);let i=r===1?e:`${e}#${r}`;return ef.set(n,i),i}function fy(n){let t=n.constructor;return t?t.name:"Object"}function Ms(n){let t=n.toString(),r=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t);return(r?r[1]:void 0)?.trim()}function Vs(n,t){if(!n)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function Ws(n){if(!n()){debugger;n(),Lt(new Zr("Assertion Failed"))}}function vo(n){return new Ks(new an(void 0,void 0,n),n,void 0,void 0)}var Ks=class{constructor(t,e,r,i){this._debugNameData=t;this._runFn=e;this.createChangeSummary=r;this._handleChange=i;this.changeSummary=this.createChangeSummary?.(),Ut()?.handleAutorunCreated(this),this._runIfNeeded(),_r(this)}state=2;updateCount=0;disposed=!1;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),Rr(this)}_runIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t,this.state=3;let e=this.disposed;try{if(!e){Ut()?.handleAutorunTriggered(this);let r=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._runFn(this,r)}catch(i){ei(i)}}}finally{e||Ut()?.handleAutorunFinished(this);for(let r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}Ws(()=>this.updateCount>=0)}handlePossibleChange(t){this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)&&(this.state=1)}handleChange(t,e){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t))try{(this._handleChange?this._handleChange({changedObservable:t,change:e,didChange:i=>i===t},this.changeSummary):!0)&&(this.state=2)}catch(r){ei(r)}}readObservable(t){if(this.disposed)return t.get();t.addObserver(this);let e=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),e}};(t=>t.Observer=Ks)(vo||={});function wc(n,t){return new Bs(new an(n.owner,n.debugName,n.debugReferenceFn),t,void 0,void 0,n.onLastObserverRemoved,n.equalsFn??Pr)}nf(wc);var Bs=class extends Cr{constructor(e,r,i,o,s=void 0,a){super();this._debugNameData=e;this._computeFn=r;this.createChangeSummary=i;this._handleChange=o;this._handleLastObserverRemoved=s;this._equalityComparator=a;this.changeSummary=this.createChangeSummary?.(),Ut()?.handleDerivedCreated(this)}state=0;value=void 0;updateCount=0;dependencies=new Set;dependenciesToBeRemoved=new Set;changeSummary=void 0;get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let e=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),e}else{do{if(this.state===1){for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;let r=this.state!==0,i=this.value;this.state=3;let o=!1;try{let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let a of this.dependenciesToBeRemoved)a.removeObserver(this);this.dependenciesToBeRemoved.clear()}o=r&&!this._equalityComparator(i,this.value),Ut()?.handleDerivedRecomputed(this,{oldValue:i,newValue:this.value,change:void 0,didChange:o,hadValue:r})}catch(s){ei(s)}if(o)for(let s of this.observers)s.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;let r=this.updateCount===1;if(this.state===3&&(this.state=1,!r))for(let i of this.observers)i.handlePossibleChange(this);if(r)for(let i of this.observers)i.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){let r=[...this.observers];for(let i of r)i.endUpdate(this)}Ws(()=>this.updateCount>=0)}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(let r of this.observers)r.handlePossibleChange(this)}}handleChange(e,r){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:e,change:r,didChange:s=>s===e},this.changeSummary):!0}catch(s){ei(s)}let o=this.state===3;if(i&&(this.state===1||o)&&(this.state=2,o))for(let s of this.observers)s.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);let r=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),r}addObserver(e){let r=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),r&&e.beginUpdate(this)}removeObserver(e){let r=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),r&&e.endUpdate(this)}};function Tc(...n){let t,e,r;return n.length===3?[t,e,r]=n:[e,r]=n,new er(new an(t,void 0,r),e,r,()=>er.globalTransaction,Pr)}var er=class extends Cr{constructor(e,r,i,o,s){super();this._debugNameData=e;this.event=r;this._getValue=i;this._getTransaction=o;this._equalityComparator=s}static globalTransaction;value;hasValue=!1;subscription;getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}handleEvent=e=>{let r=this._getValue(e),i=this.value,o=!this.hasValue||!this._equalityComparator(i,r),s=!1;o&&(this.value=r,this.hasValue&&(s=!0,Pc(this._getTransaction(),a=>{Ut()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:r,change:void 0,didChange:o,hadValue:this.hasValue});for(let l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")})),this.hasValue=!0),s||Ut()?.handleFromEventObservableTriggered(this,{oldValue:i,newValue:r,change:void 0,didChange:o,hadValue:this.hasValue})};onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(e=>{e.Observer=er;function t(r,i){let o=!1;er.globalTransaction===void 0&&(er.globalTransaction=r,o=!0);try{i()}finally{o&&(er.globalTransaction=void 0)}}e.batchEventsGlobally=t})(Tc||={});function of(n){let t=new qs(!1,void 0);return n.addObserver(t),te(()=>{n.removeObserver(t)})}lf(of);function sf(n,t){let e=new qs(!0,t);return n.addObserver(e),t?t(n.get()):n.reportChanges(),te(()=>{n.removeObserver(e)})}af(sf);var qs=class{constructor(t,e){this._forceRecompute=t;this._handleValue=e}_counter=0;beginUpdate(t){this._counter++}endUpdate(t){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(t.get()):t.reportChanges())}handlePossibleChange(t){}handleChange(t,e){}};var uf;function df(n){uf=n}function Ut(){return uf}var js=class{indentation=0;textToConsoleArgs(t){return my([ti(by("|  ",this.indentation)),t])}formatInfo(t){return t.hadValue?t.didChange?[ti(" "),ln(Io(t.oldValue,70),{color:"red",strikeThrough:!0}),ti(" "),ln(Io(t.newValue,60),{color:"green"})]:[ti(" (unchanged)")]:[ti(" "),ln(Io(t.newValue,60),{color:"green"}),ti(" (initial)")]}handleObservableChanged(t,e){console.log(...this.textToConsoleArgs([bo("observable value changed"),ln(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e)]))}changedObservablesSets=new WeakMap;formatChanges(t){if(t.size!==0)return ln(" (changed deps: "+[...t].map(e=>e.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(t){let e=t.handleChange;this.changedObservablesSets.set(t,new Set),t.handleChange=(r,i)=>(this.changedObservablesSets.get(t).add(r),e.apply(t,[r,i]))}handleDerivedRecomputed(t,e){let r=this.changedObservablesSets.get(t);console.log(...this.textToConsoleArgs([bo("derived recomputed"),ln(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e),this.formatChanges(r),{data:[{fn:t._debugNameData.referenceFn??t._computeFn}]}])),r.clear()}handleFromEventObservableTriggered(t,e){console.log(...this.textToConsoleArgs([bo("observable from event triggered"),ln(t.debugName,{color:"BlueViolet"}),...this.formatInfo(e),{data:[{fn:t._getValue}]}]))}handleAutorunCreated(t){let e=t.handleChange;this.changedObservablesSets.set(t,new Set),t.handleChange=(r,i)=>(this.changedObservablesSets.get(t).add(r),e.apply(t,[r,i]))}handleAutorunTriggered(t){let e=this.changedObservablesSets.get(t);console.log(...this.textToConsoleArgs([bo("autorun"),ln(t.debugName,{color:"BlueViolet"}),this.formatChanges(e),{data:[{fn:t._debugNameData.referenceFn??t._runFn}]}])),e.clear(),this.indentation++}handleAutorunFinished(t){this.indentation--}handleBeginTransaction(t){let e=t.getDebugName();e===void 0&&(e=""),console.log(...this.textToConsoleArgs([bo("transaction"),ln(e,{color:"BlueViolet"}),{data:[{fn:t._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function my(n){let t=new Array,e=[],r="";function i(s){if("length"in s)for(let a of s)a&&i(a);else"text"in s?(r+=`%c${s.text}`,t.push(s.style),s.data&&e.push(...s.data)):"data"in s&&e.push(...s.data)}i(n);let o=[r,...t];return o.push(...e),o}function ti(n){return ln(n,{color:"black"})}function bo(n){return ln(Iy(`${n}: `,10),{color:"black",bold:!0})}function ln(n,t={color:"black"}){function e(i){return Object.entries(i).reduce((o,[s,a])=>`${o}${s}:${a};`,"")}let r={color:t.color};return t.strikeThrough&&(r["text-decoration"]="line-through"),t.bold&&(r["font-weight"]="bold"),{text:n,style:e(r)}}function Io(n,t){switch(typeof n){case"number":return""+n;case"string":return n.length+2<=t?`"${n}"`:`"${n.substr(0,t-7)}"+...`;case"boolean":return n?"true":"false";case"undefined":return"undefined";case"object":return n===null?"null":Array.isArray(n)?yy(n,t):vy(n,t);case"symbol":return n.toString();case"function":return`[[Function${n.name?" "+n.name:""}]]`;default:return""+n}}function yy(n,t){let e="[ ",r=!0;for(let i of n){if(r||(e+=", "),e.length-5>t){e+="...";break}r=!1,e+=`${Io(i,t-e.length)}`}return e+=" ]",e}function vy(n,t){let e="{ ",r=!0;for(let[i,o]of Object.entries(n)){if(r||(e+=", "),e.length-5>t){e+="...";break}r=!1,e+=`${i}: ${Io(o,t-e.length)}`}return e+=" }",e}function by(n,t){let e="";for(let r=1;r<=t;r++)e+=n;return e}function Iy(n,t){for(;n.length<t;)n+=" ";return n}var ff;function af(n){ff=n}var pf;function lf(n){pf=n}var _c;function nf(n){_c=n}var $s=class{get TChange(){return null}reportChanges(){this.get()}read(t){return t?t.readObservable(this):this.get()}map(t,e){let r=e===void 0?void 0:t,i=e===void 0?t:e;return _c({owner:r,debugName:()=>{let o=Ms(i);if(o!==void 0)return o;let a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(a)return`${this.debugName}.${a[2]}`;if(!r)return`${this.debugName} (mapped)`},debugReferenceFn:i},o=>i(this.read(o),o))}flatten(){return _c({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},t=>this.read(t).read(t))}recomputeInitiallyAndOnChange(t,e){return t.add(ff(this,e)),this}keepObserved(t){return t.add(pf(this)),this}get debugValue(){return this.get()}},Cr=class extends $s{observers=new Set;addObserver(t){let e=this.observers.size;this.observers.add(t),e===0&&this.onFirstObserverAdded()}removeObserver(t){this.observers.delete(t)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function zs(n,t){let e=new Gs(n,t);try{n(e)}finally{e.finish()}}function Pc(n,t,e){n?t(n):zs(t,e)}var Gs=class{constructor(t,e){this._fn=t;this._getDebugName=e;Ut()?.handleBeginTransaction(this)}updatingObservers=[];getDebugName(){return this._getDebugName?this._getDebugName():Ms(this._fn)}updateObserver(t,e){this.updatingObservers.push({observer:t,observable:e}),t.beginUpdate(e)}finish(){let t=this.updatingObservers;for(let e=0;e<t.length;e++){let{observer:r,observable:i}=t[e];r.endUpdate(i)}this.updatingObservers=null,Ut()?.handleEndTransaction()}};var xy=!1;xy&&df(new js);var Ey=globalThis.performance&&typeof globalThis.performance.now=="function",Dr=class n{_startTime;_stopTime;_now;static create(t){return new n(t)}constructor(t){this._now=Ey&&t===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var gf=Symbol("MicrotaskDelay");var Sy=!1,hf=!1,wy=!1,Z;(At=>{At.None=()=>U.None;function t(F){if(wy){let{onDidAddListener:R}=F,L=xo.create(),O=0;F.onDidAddListener=()=>{++O===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),L.print()),R?.()}}}function e(F,R){return h(F,()=>{},0,void 0,!0,void 0,R)}At.defer=e;function r(F){return(R,L=null,O)=>{let K=!1,Y;return Y=F(le=>{if(!K)return Y?Y.dispose():K=!0,R.call(L,le)},null,O),K&&Y.dispose(),Y}}At.once=r;function i(F,R){return At.once(At.filter(F,R))}At.onceIf=i;function o(F,R,L){return f((O,K=null,Y)=>F(le=>O.call(K,R(le)),null,Y),L)}At.map=o;function s(F,R,L){return f((O,K=null,Y)=>F(le=>{R(le),O.call(K,le)},null,Y),L)}At.forEach=s;function a(F,R,L){return f((O,K=null,Y)=>F(le=>R(le)&&O.call(K,le),null,Y),L)}At.filter=a;function l(F){return F}At.signal=l;function c(...F){return(R,L=null,O)=>{let K=ii(...F.map(Y=>Y(le=>R.call(L,le))));return p(K,O)}}At.any=c;function u(F,R,L,O){let K=L;return o(F,Y=>(K=R(K,Y),K),O)}At.reduce=u;function f(F,R){let L,O={onWillAddFirstListener(){L=F(K.fire,K)},onDidRemoveLastListener(){L?.dispose()}};R||t(O);let K=new C(O);return R?.add(K),K.event}function p(F,R){return R instanceof Array?R.push(F):R&&R.add(F),F}function h(F,R,L=100,O=!1,K=!1,Y,le){let ke,qe,z,Xn=0,An,Yn={leakWarningThreshold:Y,onWillAddFirstListener(){ke=F(Rs=>{Xn++,qe=R(qe,Rs),O&&!z&&(Sr.fire(qe),qe=void 0),An=()=>{let Cs=qe;qe=void 0,z=void 0,(!O||Xn>1)&&Sr.fire(Cs),Xn=0},typeof L=="number"?(clearTimeout(z),z=setTimeout(An,L)):z===void 0&&(z=0,queueMicrotask(An))})},onWillRemoveListener(){K&&Xn>0&&An?.()},onDidRemoveLastListener(){An=void 0,ke.dispose()}};le||t(Yn);let Sr=new C(Yn);return le?.add(Sr),Sr.event}At.debounce=h;function v(F,R=0,L){return At.debounce(F,(O,K)=>O?(O.push(K),O):[K],R,void 0,!0,void 0,L)}At.accumulate=v;function y(F,R=(O,K)=>O===K,L){let O=!0,K;return a(F,Y=>{let le=O||!R(Y,K);return O=!1,K=Y,le},L)}At.latch=y;function I(F,R,L){return[At.filter(F,R,L),At.filter(F,O=>!R(O),L)]}At.split=I;function S(F,R=!1,L=[],O){let K=L.slice(),Y=F(qe=>{K?K.push(qe):ke.fire(qe)});O&&O.add(Y);let le=()=>{K?.forEach(qe=>ke.fire(qe)),K=null},ke=new C({onWillAddFirstListener(){Y||(Y=F(qe=>ke.fire(qe)),O&&O.add(Y))},onDidAddFirstListener(){K&&(R?setTimeout(le):le())},onDidRemoveLastListener(){Y&&Y.dispose(),Y=null}});return O&&O.add(ke),ke.event}At.buffer=S;function T(F,R){return(O,K,Y)=>{let le=R(new E);return F(function(ke){let qe=le.evaluate(ke);qe!==k&&O.call(K,qe)},void 0,Y)}}At.chain=T;let k=Symbol("HaltChainable");class E{steps=[];map(R){return this.steps.push(R),this}forEach(R){return this.steps.push(L=>(R(L),L)),this}filter(R){return this.steps.push(L=>R(L)?L:k),this}reduce(R,L){let O=L;return this.steps.push(K=>(O=R(O,K),O)),this}latch(R=(L,O)=>L===O){let L=!0,O;return this.steps.push(K=>{let Y=L||!R(K,O);return L=!1,O=K,Y?K:k}),this}evaluate(R){for(let L of this.steps)if(R=L(R),R===k)break;return R}}function _(F,R,L=O=>O){let O=(...ke)=>le.fire(L(...ke)),K=()=>F.on(R,O),Y=()=>F.removeListener(R,O),le=new C({onWillAddFirstListener:K,onDidRemoveLastListener:Y});return le.event}At.fromNodeEventEmitter=_;function N(F,R,L=O=>O){let O=(...ke)=>le.fire(L(...ke)),K=()=>F.addEventListener(R,O),Y=()=>F.removeEventListener(R,O),le=new C({onWillAddFirstListener:K,onDidRemoveLastListener:Y});return le.event}At.fromDOMEventEmitter=N;function A(F){return new Promise(R=>r(F)(R))}At.toPromise=A;function Ie(F){let R=new C;return F.then(L=>{R.fire(L)},()=>{R.fire(void 0)}).finally(()=>{R.dispose()}),R.event}At.fromPromise=Ie;function q(F,R){return F(L=>R.fire(L))}At.forward=q;function ye(F,R,L){return R(L),F(O=>R(O))}At.runAndSubscribe=ye;class Ht{constructor(R,L){this._observable=R;let O={onWillAddFirstListener:()=>{R.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{R.removeObserver(this)}};L||t(O),this.emitter=new C(O),L&&L.add(this.emitter)}emitter;_counter=0;_hasChanged=!1;beginUpdate(R){this._counter++}handlePossibleChange(R){}handleChange(R,L){this._hasChanged=!0}endUpdate(R){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function pt(F,R){return new Ht(F,R).emitter.event}At.fromObservable=pt;function vn(F){return(R,L,O)=>{let K=0,Y=!1,le={beginUpdate(){K++},endUpdate(){K--,K===0&&(F.reportChanges(),Y&&(Y=!1,R.call(L)))},handlePossibleChange(){},handleChange(){Y=!0}};F.addObserver(le),F.reportChanges();let ke={dispose(){F.removeObserver(le)}};return O instanceof Ee?O.add(ke):Array.isArray(O)&&O.push(ke),ke}}At.fromObservableLight=vn})(Z||={});var Rc=class n{static all=new Set;static _idPool=0;name;listenerCount=0;invocationCount=0;elapsedOverall=0;durations=[];_stopWatch;constructor(t){this.name=`${t}_${n._idPool++}`,n.all.add(this)}start(t){this._stopWatch=new Dr,this.listenerCount=t}stop(){if(this._stopWatch){let t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}},mf=-1;var Cc=class n{constructor(t,e,r=(n._idPool++).toString(16).padStart(3,"0")){this._errorHandler=t;this.threshold=e;this.name=r}static _idPool=1;_stacks;_warnCountdown=0;dispose(){this._stacks?.clear()}check(t,e){let r=this.threshold;if(r<=0||e<r)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=r*.5;let[o,s]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${e} listeners already. MOST frequent listener (${s}):`;console.warn(a),console.warn(o);let l=new Dc(a,o);this._errorHandler(l)}return()=>{let o=this._stacks.get(t.value)||0;this._stacks.set(t.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let t,e=0;for(let[r,i]of this._stacks)(!t||e<i)&&(t=[r,i],e=i);return t}},xo=class n{constructor(t){this.value=t}static create(){let t=new Error;return new n(t.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},Dc=class extends Error{constructor(t,e){super(t),this.name="ListenerLeakError",this.stack=e}},kc=class extends Error{constructor(t,e){super(t),this.name="ListenerRefusalError",this.stack=e}},Ty=0,ni=class{constructor(t){this.value=t}stack;id=Ty++},Py=2,_y=(n,t)=>{if(n instanceof ni)t(n);else for(let e=0;e<n.length;e++){let r=n[e];r&&t(r)}},Hs;if(Sy){let n=[];setInterval(()=>{n.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(n.join(`
`)),n.length=0)},3e3),Hs=new FinalizationRegistry(t=>{typeof t=="string"&&n.push(t)})}var C=class{_options;_leakageMon;_perfMon;_disposed;_event;_listeners;_deliveryQueue;_size=0;constructor(t){this._options=t,this._leakageMon=mf>0||this._options?.leakWarningThreshold?new Cc(t?.onListenerError??Lt,this._options?.leakWarningThreshold??mf):void 0,this._perfMon=this._options?._profName?new Rc(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(hf){let t=this._listeners;queueMicrotask(()=>{_y(t,e=>e.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(t,e,r)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let c=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],u=new kc(`${l}. HINT: Stack shows most frequent listener (${c[1]}-times)`,c[0]);return(this._options?.onListenerError||Lt)(u),U.None}if(this._disposed)return U.None;e&&(t=t.bind(e));let i=new ni(t),o,s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=xo.create(),o=this._leakageMon.check(i.stack,this._size+1)),hf&&(i.stack=s??xo.create()),this._listeners?this._listeners instanceof ni?(this._deliveryQueue??=new Oc,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._size++;let a=te(()=>{Hs?.unregister(a),o?.(),this._removeListener(i)});if(r instanceof Ee?r.add(a):Array.isArray(r)&&r.push(a),Hs){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),c=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);Hs.register(a,c?.[2]??l,a)}return a},this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let e=this._listeners,r=e.indexOf(t);if(r===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,e[r]=void 0;let i=this._deliveryQueue.current===this;if(this._size*Py<=e.length){let o=0;for(let s=0;s<e.length;s++)e[s]?e[o++]=e[s]:i&&(this._deliveryQueue.end--,o<this._deliveryQueue.i&&this._deliveryQueue.i--);e.length=o}}_deliver(t,e){if(!t)return;let r=this._options?.onListenerError||Lt;if(!r){t.value(e);return}try{t.value(e)}catch(i){r(i)}}_deliverQueue(t){let e=t.current._listeners;for(;t.i<t.end;)this._deliver(e[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof ni)this._deliver(this._listeners,t);else{let e=this._deliveryQueue;e.enqueue(this,t,this._listeners.length),this._deliverQueue(e)}this._perfMon?.stop()}hasListeners(){return this._size>0}};var Oc=class{i=-1;end=0;current;value;enqueue(t,e,r){this.i=0,this.end=r,this.current=t,this.value=e}reset(){this.i=this.end,this.current=void 0,this.value=void 0}};var ri=class extends C{_isPaused=0;_eventQueue=new Zn;_mergeFn;get isPaused(){return this._isPaused!==0}constructor(t){super(t),this._mergeFn=t?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let t=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(t))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(t){this._size&&(this._isPaused!==0?this._eventQueue.push(t):super.fire(t))}};var Qs=class{listening=!1;inputEvent=Z.None;inputEventListener=U.None;emitter=new C({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}});event=this.emitter.event;set input(t){this.inputEvent=t,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=t(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}};var yf=Object.freeze(function(n,t){let e=setTimeout(n.bind(t),0);return{dispose(){clearTimeout(e)}}}),ce;(r=>{function n(i){return i===r.None||i===r.Cancelled||i instanceof oi?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}r.isCancellationToken=n,r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Z.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:yf})})(ce||={});var oi=class{_isCancelled=!1;_emitter=null;cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?yf:(this._emitter||(this._emitter=new C),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},at=class{_token=void 0;_parentListener=void 0;constructor(t){this._parentListener=t&&t.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new oi),this._token}cancel(){this._token?this._token instanceof oi&&this._token.cancel():this._token=ce.Cancelled}dispose(t=!1){t&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof oi&&this._token.dispose():this._token=ce.None}};function sn(n,t,e=(r,i)=>r===i){if(n===t)return!0;if(!n||!t||n.length!==t.length)return!1;for(let r=0,i=n.length;r<i;r++)if(!e(n[r],t[r]))return!1;return!0}function Jt(n){return n.filter(t=>!!t)}function Ac(n){return Array.isArray(n)&&n.length>0}function Nt(n,t=e=>e){let e=new Set;return n.filter(r=>{let i=t(r);return e.has(i)?!1:(e.add(i),!0)})}function Fc(n,t){return n.push(t),()=>Ry(n,t)}function Ry(n,t){let e=n.indexOf(t);if(e>-1)return n.splice(e,1),t}function Lc(n,t){let e;if(typeof t=="number"){let r=t;e=()=>{let i=Math.sin(r++)*179426549;return i-Math.floor(i)}}else e=Math.random;for(let r=n.length-1;r>0;r-=1){let i=Math.floor(e()*(r+1)),o=n[r];n[r]=n[i],n[i]=o}}var bf;(a=>{function n(l){return l<0}a.isLessThan=n;function t(l){return l<=0}a.isLessThanOrEqual=t;function e(l){return l>0}a.isGreaterThan=e;function r(l){return l===0}a.isNeitherLessOrGreaterThan=r,a.greaterThan=1,a.lessThan=-1,a.neitherLessOrGreaterThan=0})(bf||={});var vf=class n{constructor(t){this.iterate=t}static empty=new n(t=>{});forEach(t){this.iterate(e=>(t(e),!0))}toArray(){let t=[];return this.iterate(e=>(t.push(e),!0)),t}filter(t){return new n(e=>this.iterate(r=>t(r)?e(r):!0))}map(t){return new n(e=>this.iterate(r=>e(t(r))))}some(t){let e=!1;return this.iterate(r=>(e=t(r),!e)),e}findFirst(t){let e;return this.iterate(r=>t(r)?(e=r,!1):!0),e}findLast(t){let e;return this.iterate(r=>(t(r)&&(e=r),!0)),e}findLastMaxBy(t){let e,r=!0;return this.iterate(i=>((r||bf.isGreaterThan(t(i,e)))&&(r=!1,e=i),!0)),e}};function Uc(){return globalThis._VSCODE_NLS_MESSAGES}function Eo(){return globalThis._VSCODE_NLS_LANGUAGE}var Cy=Eo()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Js(n,t){let e;return t.length===0?e=n:e=n.replace(/\{(\d+)\}/g,(r,i)=>{let o=i[0],s=t[o],a=r;return typeof s=="string"?a=s:(typeof s=="number"||typeof s=="boolean"||s===void 0||s===null)&&(a=String(s)),a}),Cy&&(e="\uFF3B"+e.replace(/[aouei]/g,"$&$&")+"\uFF3D"),e}function g(n,t,...e){return Js(typeof n=="number"?If(n,t):t,e)}function If(n,t){let e=Uc()?.[n];if(typeof e!="string"){if(typeof t=="string")return t;throw new Error(`!!! NLS MISSING: ${n} !!!`)}return e}function En(n,t,...e){let r;typeof n=="number"?r=If(n,t):r=t;let i=Js(r,e);return{value:i,original:t===r?i:Js(t,e)}}var si="en",wo=!1,To=!1,So=!1,Dy=!1,Ef=!1,Nc=!1,ky=!1,Sf=!1,Oy=!1,Ay=!1,Xs,Ys=si,xf=si,Fy,Un,Nn=globalThis,Mt;typeof Nn.vscode<"u"&&typeof Nn.vscode.process<"u"?Mt=Nn.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Mt=process);var wf=typeof Mt?.versions?.electron=="string",Ly=wf&&Mt?.type==="renderer";if(typeof Mt=="object"){wo=Mt.platform==="win32",To=Mt.platform==="darwin",So=Mt.platform==="linux",Dy=So&&!!Mt.env.SNAP&&!!Mt.env.SNAP_REVISION,ky=wf,Oy=!!Mt.env.CI||!!Mt.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Xs=si,Ys=si;let n=Mt.env.VSCODE_NLS_CONFIG;if(n)try{let t=JSON.parse(n);Xs=t.userLocale,xf=t.osLocale,Ys=t.resolvedLanguage||si,Fy=t.languagePack?.translationsConfigFile}catch{}Ef=!0}else typeof navigator=="object"&&!Ly?(Un=navigator.userAgent,wo=Un.indexOf("Windows")>=0,To=Un.indexOf("Macintosh")>=0,Sf=(Un.indexOf("Macintosh")>=0||Un.indexOf("iPad")>=0||Un.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,So=Un.indexOf("Linux")>=0,Ay=Un?.indexOf("Mobi")>=0,Nc=!0,Ys=Eo()||si,Xs=navigator.language.toLowerCase(),xf=Xs):console.error("Unable to resolve platform.");var Zs=0;To?Zs=1:wo?Zs=3:So&&(Zs=2);var ue=wo,Vt=To,Se=So;var Tf=Ef;var Pt=Nc,Uy=Nc&&typeof Nn.importScripts=="function",Pf=Uy?Nn.origin:void 0;var Po=Zs,wn=Un,Xt=Ys,Ny;(r=>{function n(){return Xt}r.value=n;function t(){return Xt.length===2?Xt==="en":Xt.length>=3?Xt[0]==="e"&&Xt[1]==="n"&&Xt[2]==="-":!1}r.isDefaultVariant=t;function e(){return Xt==="en"}r.isDefault=e})(Ny||={});var My=typeof Nn.postMessage=="function"&&!Nn.importScripts,_f=(()=>{if(My){let n=[];Nn.addEventListener("message",e=>{if(e.data&&e.data.vscodeScheduleAsyncWork)for(let r=0,i=n.length;r<i;r++){let o=n[r];if(o.id===e.data.vscodeScheduleAsyncWork){n.splice(r,1),o.callback();return}}});let t=0;return e=>{let r=++t;n.push({id:r,callback:e}),Nn.postMessage({vscodeScheduleAsyncWork:r},"*")}}return n=>setTimeout(n)})();var _o=To||Sf?2:wo?1:3;var Mc=!!(wn&&wn.indexOf("Chrome")>=0),Rf=!!(wn&&wn.indexOf("Firefox")>=0),Cf=!!(!Mc&&wn&&wn.indexOf("Safari")>=0),Df=!!(wn&&wn.indexOf("Edg/")>=0),l2=!!(wn&&wn.indexOf("Android")>=0);var kr,Vc=globalThis.vscode;if(typeof Vc<"u"&&typeof Vc.process<"u"){let n=Vc.process;kr={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?kr={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:kr={get platform(){return ue?"win32":Vt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Mn=kr.cwd,It=kr.env,Wc=kr.platform,ea=kr.arch;var Vy=65,Wy=97,Ky=90,By=122,rr=46,Xe=47,_t=92,tr=58,qy=63,ta=class extends Error{code;constructor(t,e,r){let i;typeof e=="string"&&e.indexOf("not ")===0?(i="must not be",e=e.replace(/^not /,"")):i="must be";let o=t.indexOf(".")!==-1?"property":"argument",s=`The "${t}" ${o} ${i} of type ${e}`;s+=`. Received type ${typeof r}`,super(s),this.code="ERR_INVALID_ARG_TYPE"}};function $y(n,t){if(n===null||typeof n!="object")throw new ta(t,"Object",n)}function Fe(n,t){if(typeof n!="string")throw new ta(t,"string",n)}var Rt=Wc==="win32";function ne(n){return n===Xe||n===_t}function Kc(n){return n===Xe}function nr(n){return n>=Vy&&n<=Ky||n>=Wy&&n<=By}function na(n,t,e,r){let i="",o=0,s=-1,a=0,l=0;for(let c=0;c<=n.length;++c){if(c<n.length)l=n.charCodeAt(c);else{if(r(l))break;l=Xe}if(r(l)){if(!(s===c-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==rr||i.charCodeAt(i.length-2)!==rr){if(i.length>2){let u=i.lastIndexOf(e);u===-1?(i="",o=0):(i=i.slice(0,u),o=i.length-1-i.lastIndexOf(e)),s=c,a=0;continue}else if(i.length!==0){i="",o=0,s=c,a=0;continue}}t&&(i+=i.length>0?`${e}..`:"..",o=2)}else i.length>0?i+=`${e}${n.slice(s+1,c)}`:i=n.slice(s+1,c),o=c-s-1;s=c,a=0}else l===rr&&a!==-1?++a:a=-1}return i}function zy(n){return n?`${n[0]==="."?"":"."}${n}`:""}function Of(n,t){$y(t,"pathObject");let e=t.dir||t.root,r=t.base||`${t.name||""}${zy(t.ext)}`;return e?e===t.root?`${e}${r}`:`${e}${n}${r}`:r}var Le={resolve(...n){let t="",e="",r=!1;for(let i=n.length-1;i>=-1;i--){let o;if(i>=0){if(o=n[i],Fe(o,`paths[${i}]`),o.length===0)continue}else t.length===0?o=Mn():(o=It[`=${t}`]||Mn(),(o===void 0||o.slice(0,2).toLowerCase()!==t.toLowerCase()&&o.charCodeAt(2)===_t)&&(o=`${t}\\`));let s=o.length,a=0,l="",c=!1,u=o.charCodeAt(0);if(s===1)ne(u)&&(a=1,c=!0);else if(ne(u))if(c=!0,ne(o.charCodeAt(1))){let f=2,p=f;for(;f<s&&!ne(o.charCodeAt(f));)f++;if(f<s&&f!==p){let h=o.slice(p,f);for(p=f;f<s&&ne(o.charCodeAt(f));)f++;if(f<s&&f!==p){for(p=f;f<s&&!ne(o.charCodeAt(f));)f++;(f===s||f!==p)&&(l=`\\\\${h}\\${o.slice(p,f)}`,a=f)}}}else a=1;else nr(u)&&o.charCodeAt(1)===tr&&(l=o.slice(0,2),a=2,s>2&&ne(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(t.length>0){if(l.toLowerCase()!==t.toLowerCase())continue}else t=l;if(r){if(t.length>0)break}else if(e=`${o.slice(a)}\\${e}`,r=c,c&&t.length>0)break}return e=na(e,!r,"\\",ne),r?`${t}\\${e}`:`${t}${e}`||"."},normalize(n){Fe(n,"path");let t=n.length;if(t===0)return".";let e=0,r,i=!1,o=n.charCodeAt(0);if(t===1)return Kc(o)?"\\":n;if(ne(o))if(i=!0,ne(n.charCodeAt(1))){let a=2,l=a;for(;a<t&&!ne(n.charCodeAt(a));)a++;if(a<t&&a!==l){let c=n.slice(l,a);for(l=a;a<t&&ne(n.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!ne(n.charCodeAt(a));)a++;if(a===t)return`\\\\${c}\\${n.slice(l)}\\`;a!==l&&(r=`\\\\${c}\\${n.slice(l,a)}`,e=a)}}}else e=1;else nr(o)&&n.charCodeAt(1)===tr&&(r=n.slice(0,2),e=2,t>2&&ne(n.charCodeAt(2))&&(i=!0,e=3));let s=e<t?na(n.slice(e),!i,"\\",ne):"";return s.length===0&&!i&&(s="."),s.length>0&&ne(n.charCodeAt(t-1))&&(s+="\\"),r===void 0?i?`\\${s}`:s:i?`${r}\\${s}`:`${r}${s}`},isAbsolute(n){Fe(n,"path");let t=n.length;if(t===0)return!1;let e=n.charCodeAt(0);return ne(e)||t>2&&nr(e)&&n.charCodeAt(1)===tr&&ne(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let t,e;for(let o=0;o<n.length;++o){let s=n[o];Fe(s,"path"),s.length>0&&(t===void 0?t=e=s:t+=`\\${s}`)}if(t===void 0)return".";let r=!0,i=0;if(typeof e=="string"&&ne(e.charCodeAt(0))){++i;let o=e.length;o>1&&ne(e.charCodeAt(1))&&(++i,o>2&&(ne(e.charCodeAt(2))?++i:r=!1))}if(r){for(;i<t.length&&ne(t.charCodeAt(i));)i++;i>=2&&(t=`\\${t.slice(i)}`)}return Le.normalize(t)},relative(n,t){if(Fe(n,"from"),Fe(t,"to"),n===t)return"";let e=Le.resolve(n),r=Le.resolve(t);if(e===r||(n=e.toLowerCase(),t=r.toLowerCase(),n===t))return"";let i=0;for(;i<n.length&&n.charCodeAt(i)===_t;)i++;let o=n.length;for(;o-1>i&&n.charCodeAt(o-1)===_t;)o--;let s=o-i,a=0;for(;a<t.length&&t.charCodeAt(a)===_t;)a++;let l=t.length;for(;l-1>a&&t.charCodeAt(l-1)===_t;)l--;let c=l-a,u=s<c?s:c,f=-1,p=0;for(;p<u;p++){let v=n.charCodeAt(i+p);if(v!==t.charCodeAt(a+p))break;v===_t&&(f=p)}if(p!==u){if(f===-1)return r}else{if(c>u){if(t.charCodeAt(a+p)===_t)return r.slice(a+p+1);if(p===2)return r.slice(a+p)}s>u&&(n.charCodeAt(i+p)===_t?f=p:p===2&&(f=3)),f===-1&&(f=0)}let h="";for(p=i+f+1;p<=o;++p)(p===o||n.charCodeAt(p)===_t)&&(h+=h.length===0?"..":"\\..");return a+=f,h.length>0?`${h}${r.slice(a,l)}`:(r.charCodeAt(a)===_t&&++a,r.slice(a,l))},toNamespacedPath(n){if(typeof n!="string"||n.length===0)return n;let t=Le.resolve(n);if(t.length<=2)return n;if(t.charCodeAt(0)===_t){if(t.charCodeAt(1)===_t){let e=t.charCodeAt(2);if(e!==qy&&e!==rr)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(nr(t.charCodeAt(0))&&t.charCodeAt(1)===tr&&t.charCodeAt(2)===_t)return`\\\\?\\${t}`;return n},dirname(n){Fe(n,"path");let t=n.length;if(t===0)return".";let e=-1,r=0,i=n.charCodeAt(0);if(t===1)return ne(i)?n:".";if(ne(i)){if(e=r=1,ne(n.charCodeAt(1))){let a=2,l=a;for(;a<t&&!ne(n.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&ne(n.charCodeAt(a));)a++;if(a<t&&a!==l){for(l=a;a<t&&!ne(n.charCodeAt(a));)a++;if(a===t)return n;a!==l&&(e=r=a+1)}}}}else nr(i)&&n.charCodeAt(1)===tr&&(e=t>2&&ne(n.charCodeAt(2))?3:2,r=e);let o=-1,s=!0;for(let a=t-1;a>=r;--a)if(ne(n.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(e===-1)return".";o=e}return n.slice(0,o)},basename(n,t){t!==void 0&&Fe(t,"suffix"),Fe(n,"path");let e=0,r=-1,i=!0,o;if(n.length>=2&&nr(n.charCodeAt(0))&&n.charCodeAt(1)===tr&&(e=2),t!==void 0&&t.length>0&&t.length<=n.length){if(t===n)return"";let s=t.length-1,a=-1;for(o=n.length-1;o>=e;--o){let l=n.charCodeAt(o);if(ne(l)){if(!i){e=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(r=o):(s=-1,r=a))}return e===r?r=a:r===-1&&(r=n.length),n.slice(e,r)}for(o=n.length-1;o>=e;--o)if(ne(n.charCodeAt(o))){if(!i){e=o+1;break}}else r===-1&&(i=!1,r=o+1);return r===-1?"":n.slice(e,r)},extname(n){Fe(n,"path");let t=0,e=-1,r=0,i=-1,o=!0,s=0;n.length>=2&&n.charCodeAt(1)===tr&&nr(n.charCodeAt(0))&&(t=r=2);for(let a=n.length-1;a>=t;--a){let l=n.charCodeAt(a);if(ne(l)){if(!o){r=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===rr?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===r+1?"":n.slice(e,i)},format:Of.bind(null,"\\"),parse(n){Fe(n,"path");let t={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return t;let e=n.length,r=0,i=n.charCodeAt(0);if(e===1)return ne(i)?(t.root=t.dir=n,t):(t.base=t.name=n,t);if(ne(i)){if(r=1,ne(n.charCodeAt(1))){let f=2,p=f;for(;f<e&&!ne(n.charCodeAt(f));)f++;if(f<e&&f!==p){for(p=f;f<e&&ne(n.charCodeAt(f));)f++;if(f<e&&f!==p){for(p=f;f<e&&!ne(n.charCodeAt(f));)f++;f===e?r=f:f!==p&&(r=f+1)}}}}else if(nr(i)&&n.charCodeAt(1)===tr){if(e<=2)return t.root=t.dir=n,t;if(r=2,ne(n.charCodeAt(2))){if(e===3)return t.root=t.dir=n,t;r=3}}r>0&&(t.root=n.slice(0,r));let o=-1,s=r,a=-1,l=!0,c=n.length-1,u=0;for(;c>=r;--c){if(i=n.charCodeAt(c),ne(i)){if(!l){s=c+1;break}continue}a===-1&&(l=!1,a=c+1),i===rr?o===-1?o=c:u!==1&&(u=1):o!==-1&&(u=-1)}return a!==-1&&(o===-1||u===0||u===1&&o===a-1&&o===s+1?t.base=t.name=n.slice(s,a):(t.name=n.slice(s,o),t.base=n.slice(s,a),t.ext=n.slice(o,a))),s>0&&s!==r?t.dir=n.slice(0,s-1):t.dir=t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},jy=(()=>{if(Rt){let n=/\\/g;return()=>{let t=Mn().replace(n,"/");return t.slice(t.indexOf("/"))}}return()=>Mn()})(),oe={resolve(...n){let t="",e=!1;for(let r=n.length-1;r>=-1&&!e;r--){let i=r>=0?n[r]:jy();Fe(i,`paths[${r}]`),i.length!==0&&(t=`${i}/${t}`,e=i.charCodeAt(0)===Xe)}return t=na(t,!e,"/",Kc),e?`/${t}`:t.length>0?t:"."},normalize(n){if(Fe(n,"path"),n.length===0)return".";let t=n.charCodeAt(0)===Xe,e=n.charCodeAt(n.length-1)===Xe;return n=na(n,!t,"/",Kc),n.length===0?t?"/":e?"./":".":(e&&(n+="/"),t?`/${n}`:n)},isAbsolute(n){return Fe(n,"path"),n.length>0&&n.charCodeAt(0)===Xe},join(...n){if(n.length===0)return".";let t;for(let e=0;e<n.length;++e){let r=n[e];Fe(r,"path"),r.length>0&&(t===void 0?t=r:t+=`/${r}`)}return t===void 0?".":oe.normalize(t)},relative(n,t){if(Fe(n,"from"),Fe(t,"to"),n===t||(n=oe.resolve(n),t=oe.resolve(t),n===t))return"";let e=1,r=n.length,i=r-e,o=1,s=t.length-o,a=i<s?i:s,l=-1,c=0;for(;c<a;c++){let f=n.charCodeAt(e+c);if(f!==t.charCodeAt(o+c))break;f===Xe&&(l=c)}if(c===a)if(s>a){if(t.charCodeAt(o+c)===Xe)return t.slice(o+c+1);if(c===0)return t.slice(o+c)}else i>a&&(n.charCodeAt(e+c)===Xe?l=c:c===0&&(l=0));let u="";for(c=e+l+1;c<=r;++c)(c===r||n.charCodeAt(c)===Xe)&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(o+l)}`},toNamespacedPath(n){return n},dirname(n){if(Fe(n,"path"),n.length===0)return".";let t=n.charCodeAt(0)===Xe,e=-1,r=!0;for(let i=n.length-1;i>=1;--i)if(n.charCodeAt(i)===Xe){if(!r){e=i;break}}else r=!1;return e===-1?t?"/":".":t&&e===1?"//":n.slice(0,e)},basename(n,t){t!==void 0&&Fe(t,"ext"),Fe(n,"path");let e=0,r=-1,i=!0,o;if(t!==void 0&&t.length>0&&t.length<=n.length){if(t===n)return"";let s=t.length-1,a=-1;for(o=n.length-1;o>=0;--o){let l=n.charCodeAt(o);if(l===Xe){if(!i){e=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(r=o):(s=-1,r=a))}return e===r?r=a:r===-1&&(r=n.length),n.slice(e,r)}for(o=n.length-1;o>=0;--o)if(n.charCodeAt(o)===Xe){if(!i){e=o+1;break}}else r===-1&&(i=!1,r=o+1);return r===-1?"":n.slice(e,r)},extname(n){Fe(n,"path");let t=-1,e=0,r=-1,i=!0,o=0;for(let s=n.length-1;s>=0;--s){let a=n.charCodeAt(s);if(a===Xe){if(!i){e=s+1;break}continue}r===-1&&(i=!1,r=s+1),a===rr?t===-1?t=s:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||r===-1||o===0||o===1&&t===r-1&&t===e+1?"":n.slice(t,r)},format:Of.bind(null,"/"),parse(n){Fe(n,"path");let t={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return t;let e=n.charCodeAt(0)===Xe,r;e?(t.root="/",r=1):r=0;let i=-1,o=0,s=-1,a=!0,l=n.length-1,c=0;for(;l>=r;--l){let u=n.charCodeAt(l);if(u===Xe){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),u===rr?i===-1?i=l:c!==1&&(c=1):i!==-1&&(c=-1)}if(s!==-1){let u=o===0&&e?1:o;i===-1||c===0||c===1&&i===s-1&&i===o+1?t.base=t.name=n.slice(u,s):(t.name=n.slice(u,i),t.base=n.slice(u,s),t.ext=n.slice(i,s))}return o>0?t.dir=n.slice(0,o-1):e&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};oe.win32=Le.win32=Le;oe.posix=Le.posix=oe;var Wt=Rt?Le.normalize:oe.normalize,ir=Rt?Le.isAbsolute:oe.isAbsolute,V=Rt?Le.join:oe.join,Tn=Rt?Le.resolve:oe.resolve,ra=Rt?Le.relative:oe.relative,lt=Rt?Le.dirname:oe.dirname,je=Rt?Le.basename:oe.basename,Bc=Rt?Le.extname:oe.extname,d2=Rt?Le.format:oe.format,f2=Rt?Le.parse:oe.parse,p2=Rt?Le.toNamespacedPath:oe.toNamespacedPath,Ve=Rt?Le.sep:oe.sep,Af=Rt?Le.delimiter:oe.delimiter;var Hy=/^\w[\w\d+.-]*$/,Qy=/^\//,Jy=/^\/\//;function Xy(n,t){if(!n.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!Hy.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!Qy.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(Jy.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function Yy(n,t){return!n&&!t?"file":n}function Zy(n,t){switch(n){case"https":case"http":case"file":t?t[0]!==cn&&(t=cn+t):t=cn;break}return t}var we="",cn="/",e1=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,P=class n{static isUri(t){return t instanceof n?!0:t?typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function":!1}scheme;authority;path;query;fragment;constructor(t,e,r,i,o,s=!1){typeof t=="object"?(this.scheme=t.scheme||we,this.authority=t.authority||we,this.path=t.path||we,this.query=t.query||we,this.fragment=t.fragment||we):(this.scheme=Yy(t,s),this.authority=e||we,this.path=Zy(this.scheme,r||we),this.query=i||we,this.fragment=o||we,Xy(this,s))}get fsPath(){return Co(this,!1)}with(t){if(!t)return this;let{scheme:e,authority:r,path:i,query:o,fragment:s}=t;return e===void 0?e=this.scheme:e===null&&(e=we),r===void 0?r=this.authority:r===null&&(r=we),i===void 0?i=this.path:i===null&&(i=we),o===void 0?o=this.query:o===null&&(o=we),s===void 0?s=this.fragment:s===null&&(s=we),e===this.scheme&&r===this.authority&&i===this.path&&o===this.query&&s===this.fragment?this:new sr(e,r,i,o,s)}static parse(t,e=!1){let r=e1.exec(t);return r?new sr(r[2]||we,ia(r[4]||we),ia(r[5]||we),ia(r[7]||we),ia(r[9]||we),e):new sr(we,we,we,we,we)}static file(t){let e=we;if(ue&&(t=t.replace(/\\/g,cn)),t[0]===cn&&t[1]===cn){let r=t.indexOf(cn,2);r===-1?(e=t.substring(2),t=cn):(e=t.substring(2,r),t=t.substring(r)||cn)}return new sr("file",e,t,we,we)}static from(t,e){return new sr(t.scheme,t.authority,t.path,t.query,t.fragment,e)}static joinPath(t,...e){if(!t.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let r;return ue&&t.scheme==="file"?r=n.file(Le.join(Co(t,!0),...e)).path:r=oe.join(t.path,...e),t.with({path:r})}toString(t=!1){return qc(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof n)return t;{let e=new sr(t);return e._formatted=t.external??null,e._fsPath=t._sep===Uf?t.fsPath??null:null,e}}else return t}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var Uf=ue?1:void 0,sr=class extends P{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=Co(this,!1)),this._fsPath}toString(t=!1){return t?qc(this,!0):(this._formatted||(this._formatted=qc(this,!1)),this._formatted)}toJSON(){let t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=Uf),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t}},Nf={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function Ff(n,t,e){let r,i=-1;for(let o=0;o<n.length;o++){let s=n.charCodeAt(o);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||t&&s===47||e&&s===91||e&&s===93||e&&s===58)i!==-1&&(r+=encodeURIComponent(n.substring(i,o)),i=-1),r!==void 0&&(r+=n.charAt(o));else{r===void 0&&(r=n.substr(0,o));let a=Nf[s];a!==void 0?(i!==-1&&(r+=encodeURIComponent(n.substring(i,o)),i=-1),r+=a):i===-1&&(i=o)}}return i!==-1&&(r+=encodeURIComponent(n.substring(i))),r!==void 0?r:n}function t1(n){let t;for(let e=0;e<n.length;e++){let r=n.charCodeAt(e);r===35||r===63?(t===void 0&&(t=n.substr(0,e)),t+=Nf[r]):t!==void 0&&(t+=n[e])}return t!==void 0?t:n}function Co(n,t){let e;return n.authority&&n.path.length>1&&n.scheme==="file"?e=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===47&&(n.path.charCodeAt(1)>=65&&n.path.charCodeAt(1)<=90||n.path.charCodeAt(1)>=97&&n.path.charCodeAt(1)<=122)&&n.path.charCodeAt(2)===58?t?e=n.path.substr(1):e=n.path[1].toLowerCase()+n.path.substr(2):e=n.path,ue&&(e=e.replace(/\//g,"\\")),e}function qc(n,t){let e=t?t1:Ff,r="",{scheme:i,authority:o,path:s,query:a,fragment:l}=n;if(i&&(r+=i,r+=":"),(o||i==="file")&&(r+=cn,r+=cn),o){let c=o.indexOf("@");if(c!==-1){let u=o.substr(0,c);o=o.substr(c+1),c=u.lastIndexOf(":"),c===-1?r+=e(u,!1,!1):(r+=e(u.substr(0,c),!1,!1),r+=":",r+=e(u.substr(c+1),!1,!0)),r+="@"}o=o.toLowerCase(),c=o.lastIndexOf(":"),c===-1?r+=e(o,!1,!0):(r+=e(o.substr(0,c),!1,!0),r+=o.substr(c))}if(s){if(s.length>=3&&s.charCodeAt(0)===47&&s.charCodeAt(2)===58){let c=s.charCodeAt(1);c>=65&&c<=90&&(s=`/${String.fromCharCode(c+32)}:${s.substr(3)}`)}else if(s.length>=2&&s.charCodeAt(1)===58){let c=s.charCodeAt(0);c>=65&&c<=90&&(s=`${String.fromCharCode(c+32)}:${s.substr(2)}`)}r+=e(s,!0,!1)}return a&&(r+="?",r+=e(a,!1,!1)),l&&(r+="#",r+=t?l:Ff(l,!1,!1)),r}function Mf(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+Mf(n.substr(3)):n}}var Lf=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function ia(n){return n.match(Lf)?n.replace(Lf,t=>Mf(t)):n}var $c=class{constructor(t,e){this.uri=t;this.value=e}};function n1(n){return Array.isArray(n)}var ve=class n{static defaultToKey=t=>t.toString();[Symbol.toStringTag]="ResourceMap";map;toKey;constructor(t,e){if(t instanceof n)this.map=new Map(t.map),this.toKey=e??n.defaultToKey;else if(n1(t)){this.map=new Map,this.toKey=e??n.defaultToKey;for(let[r,i]of t)this.set(r,i)}else this.map=new Map,this.toKey=t??n.defaultToKey}set(t,e){return this.map.set(this.toKey(t),new $c(t,e)),this}get(t){return this.map.get(this.toKey(t))?.value}has(t){return this.map.has(this.toKey(t))}get size(){return this.map.size}clear(){this.map.clear()}delete(t){return this.map.delete(this.toKey(t))}forEach(t,e){typeof e<"u"&&(t=t.bind(e));for(let[r,i]of this.map)t(i.value,i.uri,this)}*values(){for(let t of this.map.values())yield t.value}*keys(){for(let t of this.map.values())yield t.uri}*entries(){for(let t of this.map.values())yield[t.uri,t.value]}*[Symbol.iterator](){for(let[,t]of this.map)yield[t.uri,t.value]}},ai=class{[Symbol.toStringTag]="ResourceSet";_map;constructor(t,e){!t||typeof t=="function"?this._map=new ve(t):(this._map=new ve(e),t.forEach(this.add,this))}get size(){return this._map.size}add(t){return this._map.set(t,t),this}clear(){this._map.clear()}delete(t){return this._map.delete(t)}forEach(t,e){this._map.forEach((r,i)=>t.call(e,i,i,this))}has(t){return this._map.has(t)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[Symbol.iterator](){return this.keys()}};var zc=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(t){return this._map.has(t)}get(t,e=0){let r=this._map.get(t);if(r)return e!==0&&this.touch(r,e),r.value}set(t,e,r=0){let i=this._map.get(t);if(i)i.value=e,r!==0&&this.touch(i,r);else{switch(i={key:t,value:e,next:void 0,previous:void 0},r){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(t,i),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){let e=this._map.get(t);if(e)return this._map.delete(t),this.removeItem(e),this._size--,e.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,e){let r=this._state,i=this._head;for(;i;){if(e?t.bind(e)(i.value,i.key,this):t(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let t=this,e=this._state,r=this._head,i={[Symbol.iterator](){return i},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){let o={value:r.key,done:!1};return r=r.next,o}else return{value:void 0,done:!0}}};return i}values(){let t=this,e=this._state,r=this._head,i={[Symbol.iterator](){return i},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){let o={value:r.value,done:!1};return r=r.next,o}else return{value:void 0,done:!0}}};return i}entries(){let t=this,e=this._state,r=this._head,i={[Symbol.iterator](){return i},next(){if(t._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){let o={value:[r.key,r.value],done:!1};return r=r.next,o}else return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let e=this._head,r=this.size;for(;e&&r>t;)this._map.delete(e.key),e=e.next,r--;this._head=e,this._size=r,e&&(e.previous=void 0),this._state++}trimNew(t){if(t>=this.size)return;if(t===0){this.clear();return}let e=this._tail,r=this.size;for(;e&&r>t;)this._map.delete(e.key),e=e.previous,r--;this._tail=e,this._size=r,e&&(e.next=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{let e=t.next,r=t.previous;if(!e||!r)throw new Error("Invalid list");e.previous=r,r.next=e}t.next=void 0,t.previous=void 0,this._state++}touch(t,e){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(e!==1&&e!==2)){if(e===1){if(t===this._head)return;let r=t.next,i=t.previous;t===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(e===2){if(t===this._tail)return;let r=t.next,i=t.previous;t===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){let t=[];return this.forEach((e,r)=>{t.push([r,e])}),t}fromJSON(t){this.clear();for(let[e,r]of t)this.set(e,r)}},jc=class extends zc{_limit;_ratio;constructor(t,e=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,e),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,e=2){return super.get(t,e)}peek(t){return super.get(t,0)}set(t,e){return super.set(t,e,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Wn=class extends jc{constructor(t,e=1){super(t,e)}trim(t){this.trimOld(t)}set(t,e){return super.set(t,e),this.checkTrim(),this}};var ar;(k=>{function n(E){return E&&typeof E=="object"&&typeof E[Symbol.iterator]=="function"}k.is=n;let t=Object.freeze([]);function e(){return t}k.empty=e;function*r(E){yield E}k.single=r;function i(E){return n(E)?E:r(E)}k.wrap=i;function o(E){return E||t}k.from=o;function*s(E){for(let _=E.length-1;_>=0;_--)yield E[_]}k.reverse=s;function a(E){return!E||E[Symbol.iterator]().next().done===!0}k.isEmpty=a;function l(E){return E[Symbol.iterator]().next().value}k.first=l;function c(E,_){let N=0;for(let A of E)if(_(A,N++))return!0;return!1}k.some=c;function u(E,_){for(let N of E)if(_(N))return N}k.find=u;function*f(E,_){for(let N of E)_(N)&&(yield N)}k.filter=f;function*p(E,_){let N=0;for(let A of E)yield _(A,N++)}k.map=p;function*h(E,_){let N=0;for(let A of E)yield*_(A,N++)}k.flatMap=h;function*v(...E){for(let _ of E)yield*_}k.concat=v;function y(E,_,N){let A=N;for(let Ie of E)A=_(A,Ie);return A}k.reduce=y;function*I(E,_,N=E.length){for(_<0&&(_+=E.length),N<0?N+=E.length:N>E.length&&(N=E.length);_<N;_++)yield E[_]}k.slice=I;function S(E,_=Number.POSITIVE_INFINITY){let N=[];if(_===0)return[N,E];let A=E[Symbol.iterator]();for(let Ie=0;Ie<_;Ie++){let q=A.next();if(q.done)return[N,k.empty()];N.push(q.value)}return[N,{[Symbol.iterator](){return A}}]}k.consume=S;async function T(E){let _=[];for await(let N of E)_.push(N);return Promise.resolve(_)}k.asyncToArray=T})(ar||={});var r1=!1,li=null;function i1(n){li=n}if(r1){let n="__is_disposable_tracked__";i1(new class{trackDisposable(t){let e=new Error("Potentially leaked disposable").stack;setTimeout(()=>{t[n]||console.log(e)},3e3)}setParent(t,e){if(t&&t!==U.None)try{t[n]=!0}catch{}}markAsDisposed(t){if(t&&t!==U.None)try{t[n]=!0}catch{}}markAsSingleton(t){}})}function _r(n){return li?.trackDisposable(n),n}function Rr(n){li?.markAsDisposed(n)}function Do(n,t){li?.setParent(n,t)}function o1(n,t){if(li)for(let e of n)li.setParent(e,t)}function Vf(n){return typeof n=="object"&&n!==null&&typeof n.dispose=="function"&&n.dispose.length===0}function ct(n){if(ar.is(n)){let t=[];for(let e of n)if(e)try{e.dispose()}catch(r){t.push(r)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(n)?[]:n}else if(n)return n.dispose(),n}function ii(...n){let t=te(()=>ct(n));return o1(n,t),t}function te(n){let t=_r({dispose:xc(()=>{Rr(t),n()})});return t}var Ee=class n{static DISABLE_DISPOSED_WARNING=!1;_toDispose=new Set;_isDisposed=!1;constructor(){_r(this)}dispose(){this._isDisposed||(Rr(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{ct(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return Do(t,this),this._isDisposed?n.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(t),t.dispose()}}deleteAndLeak(t){t&&this._toDispose.has(t)&&(this._toDispose.delete(t),Do(t,null))}},U=class{static None=Object.freeze({dispose(){}});_store=new Ee;constructor(){_r(this),Do(this._store,this)}dispose(){Rr(this),this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}},lr=class{_value;_isDisposed=!1;constructor(){_r(this)}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),t&&Do(t,this),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,Rr(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t&&Do(t,null),t}};var Ln=class{_store=new Map;_isDisposed=!1;constructor(){_r(this)}dispose(){Rr(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{ct(this._store.values())}finally{this._store.clear()}}has(t){return this._store.has(t)}get size(){return this._store.size}get(t){return this._store.get(t)}set(t,e,r=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),r||this._store.get(t)?.dispose(),this._store.set(t,e)}deleteAndDispose(t){this._store.get(t)?.dispose(),this._store.delete(t)}deleteAndLeak(t){let e=this._store.get(t);return this._store.delete(t),e}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var We=class{ctor;staticArguments;supportsDelayedInstantiation;constructor(t,e=[],r=!1){this.ctor=t,this.staticArguments=e,this.supportsDelayedInstantiation=r}};var un;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function r(o){return o[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=r})(un||={});var cr=$("instantiationService");function s1(n,t,e){t[un.DI_TARGET]===t?t[un.DI_DEPENDENCIES].push({id:n,index:e}):(t[un.DI_DEPENDENCIES]=[{id:n,index:e}],t[un.DI_TARGET]=t)}function $(n){if(un.serviceIds.has(n))return un.serviceIds.get(n);let t=function(e,r,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");s1(t,e,i)};return t.toString=()=>n,un.serviceIds.set(n,t),t}var ci=class{_entries=new Map;constructor(...t){for(let[e,r]of t)this.set(e,r)}set(t,e){let r=this._entries.get(t);return this._entries.set(t,e),r}has(t){return this._entries.has(t)}get(t){return this._entries.get(t)}};function be(n){return typeof n=="string"}function $e(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}function Wf(n){let t=Object.getPrototypeOf(Uint8Array);return typeof n=="object"&&n instanceof t}function ui(n){return typeof n=="number"&&!isNaN(n)}function Kt(n){return n===!0||n===!1}function Yt(n){return typeof n>"u"}function Kf(n){return!Ye(n)}function Ye(n){return Yt(n)||n===null}function Gc(n){if(Ye(n))throw new Error("Assertion Failed: argument is undefined or null");return n}var a1=Object.prototype.hasOwnProperty;function di(n){if(!$e(n))return!1;for(let t in n)if(a1.call(n,t))return!1;return!0}function Bf(n){return typeof n=="function"}function qf(n,t){let e=Math.min(n.length,t.length);for(let r=0;r<e;r++)l1(n[r],t[r])}function l1(n,t){if(be(t)){if(typeof n!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(Bf(t)){try{if(n instanceof t)return}catch{}if(!Ye(n)&&n.constructor===t||t.length===1&&t.call(void 0,n)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function Hc(n,t){return t&&(n.stack||n.stacktrace)?g("stackTrace.format","{0}: {1}",zf(n),$f(n.stack)||$f(n.stacktrace)):zf(n)}function $f(n){return Array.isArray(n)?n.join(`
`):n}function zf(n){return n.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${n.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof n.code=="string"&&typeof n.errno=="number"&&typeof n.syscall=="string"?g("nodeExceptionMessage","A system error occurred ({0})",n.message):n.message||g("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function dn(n=null,t=!1){if(!n)return g("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(n)){let e=Jt(n),r=dn(e[0],t);return e.length>1?g("error.moreErrors","{0} ({1} errors in total)",r,e.length):r}if(be(n))return n;if(n.detail){let e=n.detail;if(e.error)return Hc(e.error,t);if(e.exception)return Hc(e.exception,t)}return n.stack?Hc(n,t):n.message?n.message:g("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function c1(n){return n}var oa=class{lastCache=void 0;lastArgKey=void 0;_fn;_computeKey;constructor(t,e){typeof t=="function"?(this._fn=t,this._computeKey=c1):(this._fn=e,this._computeKey=t.getCacheKey)}get(t){let e=this._computeKey(t);return this.lastArgKey!==e&&(this.lastArgKey=e,this.lastCache=this._fn(t)),this.lastCache}};var ht=class{constructor(t){this.executor=t}_didRun=!1;_value;_error;get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(t){this._error=t}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function Hf(n){return!n||typeof n!="string"?!0:n.trim().length===0}function pi(n){return n.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function Qc(n,t){if(!n||!t)return n;let e=t.length;if(e===0||n.length===0)return n;let r=0;for(;n.indexOf(t,r)===r;)r=r+e;return n.substring(r)}function sa(n,t){if(!n||!t)return n;let e=t.length,r=n.length;if(e===0||r===0)return n;let i=r,o=-1;for(;o=n.lastIndexOf(t,i-1),!(o===-1||o+e!==i);){if(o===0)return"";i=o}return n.substring(0,i)}function ko(n,t){return n<t?-1:n>t?1:0}function aa(n,t,e=0,r=n.length,i=0,o=t.length){for(;e<r&&i<o;e++,i++){let l=n.charCodeAt(e),c=t.charCodeAt(i);if(l<c)return-1;if(l>c)return 1}let s=r-e,a=o-i;return s<a?-1:s>a?1:0}function Oo(n,t){return gi(n,t,0,n.length,0,t.length)}function gi(n,t,e=0,r=n.length,i=0,o=t.length){for(;e<r&&i<o;e++,i++){let l=n.charCodeAt(e),c=t.charCodeAt(i);if(l===c)continue;if(l>=128||c>=128)return aa(n.toLowerCase(),t.toLowerCase(),e,r,i,o);jf(l)&&(l-=32),jf(c)&&(c-=32);let u=l-c;if(u!==0)return u}let s=r-e,a=o-i;return s<a?-1:s>a?1:0}function jf(n){return n>=97&&n<=122}function Jc(n){return n>=65&&n<=90}function Bt(n,t){return n.length===t.length&&gi(n,t)===0}function Or(n,t){let e=t.length;return t.length>n.length?!1:gi(n,t,0,e)===0}function Qf(n){return 55296<=n&&n<=56319}function Xc(n){return 56320<=n&&n<=57343}function Jf(n,t){return(n-55296<<10)+(t-56320)+65536}var dw=String.fromCharCode(65279);var Gf=class n{constructor(t){this.confusableDictionary=t}static ambiguousCharacterData=new ht(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));static cache=new oa({getCacheKey:JSON.stringify},t=>{function e(u){let f=new Map;for(let p=0;p<u.length;p+=2)f.set(u[p],u[p+1]);return f}function r(u,f){let p=new Map(u);for(let[h,v]of f)p.set(h,v);return p}function i(u,f){if(!u)return f;let p=new Map;for(let[h,v]of u)f.has(h)&&p.set(h,v);return p}let o=this.ambiguousCharacterData.value,s=t.filter(u=>!u.startsWith("_")&&u in o);s.length===0&&(s=["_default"]);let a;for(let u of s){let f=e(o[u]);a=i(a,f)}let l=e(o._common),c=r(l,a);return new n(c)});static getInstance(t){return n.cache.get(Array.from(t))}static _locales=new ht(()=>Object.keys(n.ambiguousCharacterData.value).filter(t=>!t.startsWith("_")));static getLocales(){return n._locales.value}isAmbiguous(t){return this.confusableDictionary.has(t)}containsAmbiguousCharacter(t){for(let e=0;e<t.length;e++){let r=t.codePointAt(e);if(typeof r=="number"&&this.isAmbiguous(r))return!0}return!1}getPrimaryConfusable(t){return this.confusableDictionary.get(t)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};function Pn(n){return Zc(n,0)}function Zc(n,t){switch(typeof n){case"object":return n===null?Kn(349,t):Array.isArray(n)?d1(n,t):f1(n,t);case"string":return Zf(n,t);case"boolean":return u1(n,t);case"number":return Kn(n,t);case"undefined":return Kn(937,t);default:return Kn(617,t)}}function Kn(n,t){return(t<<5)-t+n|0}function u1(n,t){return Kn(n?433:863,t)}function Zf(n,t){t=Kn(149417,t);for(let e=0,r=n.length;e<r;e++)t=Kn(n.charCodeAt(e),t);return t}function d1(n,t){return t=Kn(104579,t),n.reduce((e,r)=>Zc(r,e),t)}function f1(n,t){return t=Kn(181387,t),Object.keys(n).sort().reduce((e,r)=>(e=Zf(r,e),Zc(n[r],e)),t)}function Yc(n,t,e=32){let r=e-t,i=~((1<<r)-1);return(n<<t|(i&n)>>>r)>>>0}function Xf(n,t=0,e=n.byteLength,r=0){for(let i=0;i<e;i++)n[t+i]=r}function p1(n,t,e="0"){for(;n.length<t;)n=e+n;return n}function Fo(n,t=32){return n instanceof ArrayBuffer?Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join(""):p1((n>>>0).toString(16),t/4)}var Yf=class n{static _bigBlock32=new DataView(new ArrayBuffer(320));_h0=1732584193;_h1=4023233417;_h2=2562383102;_h3=271733878;_h4=3285377520;_buff;_buffDV;_buffLen;_totalLen;_leftoverHighSurrogate;_finished;constructor(){this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(t){let e=t.length;if(e===0)return;let r=this._buff,i=this._buffLen,o=this._leftoverHighSurrogate,s,a;for(o!==0?(s=o,a=-1,o=0):(s=t.charCodeAt(0),a=0);;){let l=s;if(Qf(s))if(a+1<e){let c=t.charCodeAt(a+1);Xc(c)?(a++,l=Jf(s,c)):l=65533}else{o=s;break}else Xc(s)&&(l=65533);if(i=this._push(r,i,l),a++,a<e)s=t.charCodeAt(a);else break}this._buffLen=i,this._leftoverHighSurrogate=o}_push(t,e,r){return r<128?t[e++]=r:r<2048?(t[e++]=192|(r&1984)>>>6,t[e++]=128|(r&63)>>>0):r<65536?(t[e++]=224|(r&61440)>>>12,t[e++]=128|(r&4032)>>>6,t[e++]=128|(r&63)>>>0):(t[e++]=240|(r&1835008)>>>18,t[e++]=128|(r&258048)>>>12,t[e++]=128|(r&4032)>>>6,t[e++]=128|(r&63)>>>0),e>=64&&(this._step(),e-=64,this._totalLen+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),e}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Fo(this._h0)+Fo(this._h1)+Fo(this._h2)+Fo(this._h3)+Fo(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,Xf(this._buff,this._buffLen),this._buffLen>56&&(this._step(),Xf(this._buff));let t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){let t=n._bigBlock32,e=this._buffDV;for(let f=0;f<64;f+=4)t.setUint32(f,e.getUint32(f,!1),!1);for(let f=64;f<320;f+=4)t.setUint32(f,Yc(t.getUint32(f-12,!1)^t.getUint32(f-32,!1)^t.getUint32(f-56,!1)^t.getUint32(f-64,!1),1),!1);let r=this._h0,i=this._h1,o=this._h2,s=this._h3,a=this._h4,l,c,u;for(let f=0;f<80;f++)f<20?(l=i&o|~i&s,c=1518500249):f<40?(l=i^o^s,c=1859775393):f<60?(l=i&o|i&s|o&s,c=2400959708):(l=i^o^s,c=3395469782),u=Yc(r,5)+l+a+c+t.getUint32(f*4,!1)&4294967295,a=s,s=o,o=Yc(i,30),i=r,r=u;this._h0=this._h0+r&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+s&4294967295,this._h4=this._h4+a&4294967295}};function ur(n){return n===47||n===92}function eu(n){return n.replace(/[\\/]/g,oe.sep)}function ep(n){return n.indexOf("/")===-1&&(n=eu(n)),/^[a-zA-Z]:(\/|$)/.test(n)&&(n="/"+n),n}function tu(n,t=oe.sep){if(!n)return"";let e=n.length,r=n.charCodeAt(0);if(ur(r)){if(ur(n.charCodeAt(1))&&!ur(n.charCodeAt(2))){let o=3,s=o;for(;o<e&&!ur(n.charCodeAt(o));o++);if(s!==o&&!ur(n.charCodeAt(o+1))){for(o+=1;o<e;o++)if(ur(n.charCodeAt(o)))return n.slice(0,o+1).replace(/[\\/]/g,t)}}return t}else if(tp(r)&&n.charCodeAt(1)===58)return ur(n.charCodeAt(2))?n.slice(0,2)+t:n.slice(0,2);let i=n.indexOf("://");if(i!==-1){for(i+=3;i<e;i++)if(ur(n.charCodeAt(i)))return n.slice(0,i+1)}return""}function Lo(n,t,e){let r=n===t;return!e||r?r:!n||!t?!1:Bt(n,t)}function Bn(n,t,e,r=Ve){if(n===t)return!0;if(!n||!t||t.length>n.length)return!1;if(e){if(!Or(n,t))return!1;if(t.length===n.length)return!0;let o=t.length;return t.charAt(t.length-1)===r&&o--,n.charAt(o)===r}return t.charAt(t.length-1)!==r&&(t+=r),n.indexOf(t)===0}function tp(n){return n>=65&&n<=90||n>=97&&n<=122}function np(n){return ue?(n=sa(n,Ve),n.endsWith(":")&&(n+=Ve)):(n=sa(n,Ve),n||(n=Ve)),n}function rp(n){let t=Wt(n);return ue?n.length>3?!1:g1(t)&&(n.length===2||t.charCodeAt(2)===92):t===oe.sep}function g1(n,t=ue){return t?tp(n.charCodeAt(0))&&n.charCodeAt(1)===58:!1}var h1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",m1="BDEFGHIJKMOQRSTUVWXYZbdefghijkmoqrstuvwxyz0123456789";function ip(n,t,e=8){let r="";for(let o=0;o<e;o++){let s;o===0&&ue&&!t&&(e===3||e===4)?s=m1:s=h1,r+=s.charAt(Math.floor(Math.random()*s.length))}let i;return t?i=`${t}-${r}`:i=r,n?V(n,i):i}var Q;(z=>(z.inMemory="inmemory",z.vscode="vscode",z.internal="private",z.walkThrough="walkThrough",z.walkThroughSnippet="walkThroughSnippet",z.http="http",z.https="https",z.file="file",z.mailto="mailto",z.untitled="untitled",z.data="data",z.command="command",z.vscodeRemote="vscode-remote",z.vscodeRemoteResource="vscode-remote-resource",z.vscodeManagedRemoteResource="vscode-managed-remote-resource",z.vscodeUserData="vscode-userdata",z.vscodeCustomEditor="vscode-custom-editor",z.vscodeNotebookCell="vscode-notebook-cell",z.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",z.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",z.vscodeNotebookCellOutput="vscode-notebook-cell-output",z.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",z.vscodeNotebookMetadata="vscode-notebook-metadata",z.vscodeInteractiveInput="vscode-interactive-input",z.vscodeSettings="vscode-settings",z.vscodeWorkspaceTrust="vscode-workspace-trust",z.vscodeTerminal="vscode-terminal",z.vscodeChatCodeBlock="vscode-chat-code-block",z.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",z.vscodeChatSesssion="vscode-chat-editor",z.webviewPanel="webview-panel",z.vscodeWebview="vscode-webview",z.extension="extension",z.vscodeFileResource="vscode-file",z.tmp="tmp",z.vsls="vsls",z.vscodeSourceControl="vscode-scm",z.commentsInput="comment",z.codeSetting="code-setting",z.outputChannel="output"))(Q||={});var v1="tkn",nu=class{_hosts=Object.create(null);_ports=Object.create(null);_connectionTokens=Object.create(null);_preferredWebSchema="http";_delegate=null;_serverRootPath="/";setPreferredWebSchema(t){this._preferredWebSchema=t}setDelegate(t){this._delegate=t}setServerRootPath(t,e){this._serverRootPath=I1(t,e)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return oe.join(this._serverRootPath,Q.vscodeRemoteResource)}set(t,e,r){this._hosts[t]=e,this._ports[t]=r}setConnectionToken(t,e){this._connectionTokens[t]=e}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(t){if(this._delegate)try{return this._delegate(t)}catch(a){return Lt(a),t}let e=t.authority,r=this._hosts[e];r&&r.indexOf(":")!==-1&&r.indexOf("[")===-1&&(r=`[${r}]`);let i=this._ports[e],o=this._connectionTokens[e],s=`path=${encodeURIComponent(t.path)}`;return typeof o=="string"&&(s+=`&${v1}=${encodeURIComponent(o)}`),P.from({scheme:Pt?this._preferredWebSchema:Q.vscodeRemoteResource,authority:`${r}:${i}`,path:this._remoteResourcesPath,query:s})}},b1=new nu;function I1(n,t){return oe.join(t??"/",`${n.quality??"oss"}-${n.commit??"dev"}`)}var op="vs/../../node_modules",sp="vs/../../node_modules.asar";var iu="vscode-app",ru=class n{static FALLBACK_AUTHORITY=iu;asBrowserUri(t){let e=this.toUri(t);return this.uriToBrowserUri(e)}uriToBrowserUri(t){return t.scheme===Q.vscodeRemote?b1.rewrite(t):t.scheme===Q.file&&(Tf||Pf===`${Q.vscodeFileResource}://${n.FALLBACK_AUTHORITY}`)?t.with({scheme:Q.vscodeFileResource,authority:t.authority||n.FALLBACK_AUTHORITY,query:null,fragment:null}):t}asFileUri(t){let e=this.toUri(t);return this.uriToFileUri(e)}uriToFileUri(t){return t.scheme===Q.vscodeFileResource?t.with({scheme:Q.file,authority:t.authority!==n.FALLBACK_AUTHORITY?t.authority:null,query:null,fragment:null}):t}toUri(t,e){if(P.isUri(t))return t;if(globalThis._VSCODE_FILE_ROOT){let r=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(r))return P.joinPath(P.parse(r,!0),t);let i=V(r,t);return P.file(i)}return P.parse(e.toUrl(t))}},fn=new ru,x1;(o=>{let n=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);o.CoopAndCoep=Object.freeze(n.get("3"));let e="vscode-coi";function r(s){let a;typeof s=="string"?a=new URL(s).searchParams:s instanceof URL?a=s.searchParams:P.isUri(s)&&(a=new URL(s.toString(!0)).searchParams);let l=a?.get(e);if(l)return n.get(l)}o.getHeadersFromQuery=r;function i(s,a,l){if(!globalThis.crossOriginIsolated)return;let c=a&&l?"3":l?"2":"1";s instanceof URLSearchParams?s.set(e,c):s[e]=c}o.addSearchParam=i})(x1||={});function qn(n){return Co(n,!0)}var Ar=class{constructor(t){this._ignorePathCasing=t}compare(t,e,r=!1){return t===e?0:ko(this.getComparisonKey(t,r),this.getComparisonKey(e,r))}isEqual(t,e,r=!1){return t===e?!0:!t||!e?!1:this.getComparisonKey(t,r)===this.getComparisonKey(e,r)}getComparisonKey(t,e=!1){return t.with({path:this._ignorePathCasing(t)?t.path.toLowerCase():void 0,fragment:e?null:void 0}).toString()}ignorePathCasing(t){return this._ignorePathCasing(t)}isEqualOrParent(t,e,r=!1){if(t.scheme===e.scheme){if(t.scheme===Q.file)return Bn(qn(t),qn(e),this._ignorePathCasing(t))&&t.query===e.query&&(r||t.fragment===e.fragment);if(ap(t.authority,e.authority))return Bn(t.path,e.path,this._ignorePathCasing(t),"/")&&t.query===e.query&&(r||t.fragment===e.fragment)}return!1}joinPath(t,...e){return P.joinPath(t,...e)}basenameOrAuthority(t){return _n(t)||t.authority}basename(t){return oe.basename(t.path)}extname(t){return oe.extname(t.path)}dirname(t){if(t.path.length===0)return t;let e;return t.scheme===Q.file?e=P.file(lt(qn(t))).path:(e=oe.dirname(t.path),t.authority&&e.length&&e.charCodeAt(0)!==47&&(console.error(`dirname("${t.toString})) resulted in a relative path`),e="/")),t.with({path:e})}normalizePath(t){if(!t.path.length)return t;let e;return t.scheme===Q.file?e=P.file(Wt(qn(t))).path:e=oe.normalize(t.path),t.with({path:e})}relativePath(t,e){if(t.scheme!==e.scheme||!ap(t.authority,e.authority))return;if(t.scheme===Q.file){let o=ra(qn(t),qn(e));return ue?eu(o):o}let r=t.path||"/",i=e.path||"/";if(this._ignorePathCasing(t)){let o=0;for(let s=Math.min(r.length,i.length);o<s&&!(r.charCodeAt(o)!==i.charCodeAt(o)&&r.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);r=i.substr(0,o)+r.substr(o)}return oe.relative(r,i)}resolvePath(t,e){if(t.scheme===Q.file){let r=P.file(Tn(qn(t),e));return t.with({authority:r.authority,path:r.path})}return e=ep(e),t.with({path:oe.resolve(t.path,e)})}isAbsolutePath(t){return!!t.path&&t.path[0]==="/"}isEqualAuthority(t,e){return t===e||t!==void 0&&e!==void 0&&Bt(t,e)}hasTrailingPathSeparator(t,e=Ve){if(t.scheme===Q.file){let r=qn(t);return r.length>tu(r).length&&r[r.length-1]===e}else{let r=t.path;return r.length>1&&r.charCodeAt(r.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(t.fsPath)}}removeTrailingPathSeparator(t,e=Ve){return lp(t,e)?t.with({path:t.path.substr(0,t.path.length-1)}):t}addTrailingPathSeparator(t,e=Ve){let r=!1;if(t.scheme===Q.file){let i=qn(t);r=i!==void 0&&i.length===tu(i).length&&i[i.length-1]===e}else{e="/";let i=t.path;r=i.length===1&&i.charCodeAt(i.length-1)===47}return!r&&!lp(t,e)?t.with({path:t.path+"/"}):t}},ae=new Ar(()=>!1),Fr=new Ar(n=>n.scheme===Q.file?!Se:!0),cp=new Ar(n=>!0),la=ae.isEqual.bind(ae),ou=ae.isEqualOrParent.bind(ae),Pw=ae.getComparisonKey.bind(ae),E1=ae.basenameOrAuthority.bind(ae),_n=ae.basename.bind(ae),S1=ae.extname.bind(ae),up=ae.dirname.bind(ae),B=ae.joinPath.bind(ae),dp=ae.normalizePath.bind(ae),_w=ae.relativePath.bind(ae),Rw=ae.resolvePath.bind(ae),fp=ae.isAbsolutePath.bind(ae),ap=ae.isEqualAuthority.bind(ae),lp=ae.hasTrailingPathSeparator.bind(ae),Cw=ae.removeTrailingPathSeparator.bind(ae),Dw=ae.addTrailingPathSeparator.bind(ae);var w1;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(u=>{let[f,p]=u.split(":");f&&p&&a.set(f,p)});let c=s.path.substring(0,s.path.indexOf(";"));return c&&a.set(o.META_DATA_MIME,c),a}o.parseMetaData=i})(w1||={});function su(...n){switch(n.length){case 1:return g("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",n[0]);case 2:return g("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",n[0],n[1]);case 3:return g("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",n[0],n[1],n[2]);default:return}}var T1=g("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),P1=g("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),dr=class n{static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return t.lexeme;case 18:return t.lexeme;case 19:return t.lexeme;case 20:return"EOF";default:throw Ns(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}static _regexFlags=new Set(["i","g","s","m","y","u"].map(t=>t.charCodeAt(0)));static _keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);_input="";_start=0;_current=0;_tokens=[];_errors=[];get errors(){return this._errors}reset(t){return this._input=t,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){let e=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:e})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){let e=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:e})}else this._match(126)?this._addToken(9):this._error(su("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(su("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(su("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(t){return this._isAtEnd()||this._input.charCodeAt(this._current)!==t?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(t){this._tokens.push({type:t,offset:this._start})}_error(t){let e=this._start,r=this._input.substring(this._start,this._current),i={type:19,offset:this._start,lexeme:r};this._errors.push({offset:e,lexeme:r,additionalInfo:t}),this._tokens.push(i)}stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy;_string(){this.stringRe.lastIndex=this._start;let t=this.stringRe.exec(this._input);if(t){this._current=this._start+t[0].length;let e=this._input.substring(this._start,this._current),r=n._keywords.get(e);r?this._addToken(r):this._tokens.push({type:17,lexeme:e,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(T1);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let t=this._current,e=!1,r=!1;for(;;){if(t>=this._input.length){this._current=t,this._error(P1);return}let o=this._input.charCodeAt(t);if(e)e=!1;else if(o===47&&!r){t++;break}else o===91?r=!0:o===92?e=!0:o===93&&(r=!1);t++}for(;t<this._input.length&&n._regexFlags.has(this._input.charCodeAt(t));)t++;this._current=t;let i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};var Ge=new Map;Ge.set("false",!1);Ge.set("true",!0);Ge.set("isMac",Vt);Ge.set("isLinux",Se);Ge.set("isWindows",ue);Ge.set("isWeb",Pt);Ge.set("isMacNative",Vt&&!Pt);Ge.set("isEdge",Df);Ge.set("isFirefox",Rf);Ge.set("isChrome",Mc);Ge.set("isSafari",Cf);var _1=Object.prototype.hasOwnProperty;var R1={regexParsingWithErrorRecovery:!0},C1=g("contextkey.parser.error.emptyString","Empty context key expression"),D1=g("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),k1=g("contextkey.parser.error.noInAfterNot","'in' after 'not'."),pp=g("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),O1=g("contextkey.parser.error.unexpectedToken","Unexpected token"),A1=g("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),F1=g("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),L1=g("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?"),au=class n{constructor(t=R1){this._config=t}static _parseError=new Error;_scanner=new dr;_tokens=[];_current=0;_parsingErrors=[];get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}parse(t){if(t===""){this._parsingErrors.push({message:C1,offset:0,lexeme:"",additionalInfo:D1});return}this._tokens=this._scanner.reset(t).scan(),this._current=0,this._parsingErrors=[];try{let e=this._expr();if(!this._isAtEnd()){let r=this._peek(),i=r.type===17?A1:void 0;throw this._parsingErrors.push({message:O1,offset:r.offset,lexeme:dr.getLexeme(r),additionalInfo:i}),n._parseError}return e}catch(e){if(e!==n._parseError)throw e;return}}_expr(){return this._or()}_or(){let t=[this._and()];for(;this._matchOne(16);){let e=this._and();t.push(e)}return t.length===1?t[0]:Ze.or(...t)}_and(){let t=[this._term()];for(;this._matchOne(15);){let e=this._term();t.push(e)}return t.length===1?t[0]:Ze.and(...t)}_term(){if(this._matchOne(2)){let t=this._peek();switch(t.type){case 11:return this._advance(),ut.INSTANCE;case 12:return this._advance(),mt.INSTANCE;case 0:{this._advance();let e=this._expr();return this._consume(1,pp),e?.negate()}case 17:return this._advance(),Ur.create(t.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",t)}}return this._primary()}_primary(){let t=this._peek();switch(t.type){case 11:return this._advance(),Ze.true();case 12:return this._advance(),Ze.false();case 0:{this._advance();let e=this._expr();return this._consume(1,pp),e}case 17:{let e=t.lexeme;if(this._advance(),this._matchOne(9)){let i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);let o=i.lexeme,s=o.lastIndexOf("/"),a=s===o.length-1?void 0:this._removeFlagsGY(o.substring(s+1)),l;try{l=new RegExp(o.substring(1,s),a)}catch{throw this._errExpectedButGot("REGEX",i)}return qo.create(e,l)}switch(i.type){case 10:case 19:{let o=[i.lexeme];this._advance();let s=this._peek(),a=0;for(let p=0;p<i.lexeme.length;p++)i.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let p=0;p<s.lexeme.length;p++)s.lexeme.charCodeAt(p)===40?a++:i.lexeme.charCodeAt(p)===41&&a--}if(a<0)break;o.push(dr.getLexeme(s)),this._advance(),s=this._peek()}let l=o.join(""),c=l.lastIndexOf("/"),u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1)),f;try{f=new RegExp(l.substring(1,c),u)}catch{throw this._errExpectedButGot("REGEX",i)}return Ze.regex(e,f)}case 18:{let o=i.lexeme;this._advance();let s=null;if(!Hf(o)){let a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){let c=o.slice(a+1,l),u=o[l+1]==="i"?"i":"";try{s=new RegExp(c,u)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return qo.create(e,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,k1);let i=this._value();return Ze.notIn(e,i)}switch(this._peek().type){case 3:{this._advance();let i=this._value();if(this._previous().type===18)return Ze.equals(e,i);switch(i){case"true":return Ze.has(e);case"false":return Ze.not(e);default:return Ze.equals(e,i)}}case 4:{this._advance();let i=this._value();if(this._previous().type===18)return Ze.notEquals(e,i);switch(i){case"true":return Ze.not(e);case"false":return Ze.has(e);default:return Ze.notEquals(e,i)}}case 5:return this._advance(),Ko.create(e,this._value());case 6:return this._advance(),Bo.create(e,this._value());case 7:return this._advance(),Vo.create(e,this._value());case 8:return this._advance(),Wo.create(e,this._value());case 13:return this._advance(),Ze.in(e,this._value());default:return Ze.has(e)}}case 20:throw this._parsingErrors.push({message:F1,offset:t.offset,lexeme:"",additionalInfo:L1}),n._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let t=this._peek();switch(t.type){case 17:case 18:return this._advance(),t.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_flagsGYRe=/g|y/g;_removeFlagsGY(t){return t.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(t){return this._check(t)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(t,e){if(this._check(t))return this._advance();throw this._errExpectedButGot(e,this._peek())}_errExpectedButGot(t,e,r){let i=g("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,t,dr.getLexeme(e)),o=e.offset,s=dr.getLexeme(e);return this._parsingErrors.push({message:i,offset:o,lexeme:s,additionalInfo:r}),n._parseError}_check(t){return this._peek().type===t}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},Ze=class{static false(){return ut.INSTANCE}static true(){return mt.INSTANCE}static has(t){return Lr.create(t)}static equals(t,e){return No.create(t,e)}static notEquals(t,e){return Mo.create(t,e)}static regex(t,e){return qo.create(t,e)}static in(t,e){return ca.create(t,e)}static notIn(t,e){return ua.create(t,e)}static not(t){return Ur.create(t)}static and(...t){return da.create(t,null,!0)}static or(...t){return $o.create(t,null,!0)}static greater(t,e){return Vo.create(t,e)}static greaterEquals(t,e){return Wo.create(t,e)}static smaller(t,e){return Ko.create(t,e)}static smallerEquals(t,e){return Bo.create(t,e)}static _parser=new au({regexParsingWithErrorRecovery:!1});static deserialize(t){return t==null?void 0:this._parser.parse(t)}};function Uo(n,t){return n.cmp(t)}var ut=class n{static INSTANCE=new n;type=0;constructor(){}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}map(t){return this}negate(){return mt.INSTANCE}},mt=class n{static INSTANCE=new n;type=1;constructor(){}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}map(t){return this}negate(){return ut.INSTANCE}},Lr=class n{constructor(t,e){this.key=t;this.negated=e}static create(t,e=null){let r=Ge.get(t);return typeof r=="boolean"?r?mt.INSTANCE:ut.INSTANCE:new n(t,e)}type=2;cmp(t){return t.type!==this.type?this.type-t.type:yp(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){let t=Ge.get(this.key);return typeof t=="boolean"?t?mt.INSTANCE:ut.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(t){return t.mapDefined(this.key)}negate(){return this.negated||(this.negated=Ur.create(this.key,this)),this.negated}},No=class n{constructor(t,e,r){this.key=t;this.value=e;this.negated=r}static create(t,e,r=null){if(typeof e=="boolean")return e?Lr.create(t,r):Ur.create(t,r);let i=Ge.get(t);return typeof i=="boolean"?e===(i?"true":"false")?mt.INSTANCE:ut.INSTANCE:new n(t,e,r)}type=4;cmp(t){return t.type!==this.type?this.type-t.type:Nr(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){let t=Ge.get(this.key);if(typeof t=="boolean"){let e=t?"true":"false";return this.value===e?mt.INSTANCE:ut.INSTANCE}return this}evaluate(t){return t.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(t){return t.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Mo.create(this.key,this.value,this)),this.negated}},ca=class n{constructor(t,e){this.key=t;this.valueKey=e}static create(t,e){return new n(t,e)}type=10;negated=null;cmp(t){return t.type!==this.type?this.type-t.type:Nr(this.key,this.valueKey,t.key,t.valueKey)}equals(t){return t.type===this.type?this.key===t.key&&this.valueKey===t.valueKey:!1}substituteConstants(){return this}evaluate(t){let e=t.getValue(this.valueKey),r=t.getValue(this.key);return Array.isArray(e)?e.includes(r):typeof r=="string"&&typeof e=="object"&&e!==null?_1.call(e,r):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(t){return t.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=ua.create(this.key,this.valueKey)),this.negated}},ua=class n{constructor(t,e){this.key=t;this.valueKey=e;this._negated=ca.create(t,e)}static create(t,e){return new n(t,e)}type=11;_negated;cmp(t){return t.type!==this.type?this.type-t.type:this._negated.cmp(t._negated)}equals(t){return t.type===this.type?this._negated.equals(t._negated):!1}substituteConstants(){return this}evaluate(t){return!this._negated.evaluate(t)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(t){return t.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},Mo=class n{constructor(t,e,r){this.key=t;this.value=e;this.negated=r}static create(t,e,r=null){if(typeof e=="boolean")return e?Ur.create(t,r):Lr.create(t,r);let i=Ge.get(t);return typeof i=="boolean"?e===(i?"true":"false")?ut.INSTANCE:mt.INSTANCE:new n(t,e,r)}type=5;cmp(t){return t.type!==this.type?this.type-t.type:Nr(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){let t=Ge.get(this.key);if(typeof t=="boolean"){let e=t?"true":"false";return this.value===e?ut.INSTANCE:mt.INSTANCE}return this}evaluate(t){return t.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(t){return t.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=No.create(this.key,this.value,this)),this.negated}},Ur=class n{constructor(t,e){this.key=t;this.negated=e}static create(t,e=null){let r=Ge.get(t);return typeof r=="boolean"?r?ut.INSTANCE:mt.INSTANCE:new n(t,e)}type=3;cmp(t){return t.type!==this.type?this.type-t.type:yp(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){let t=Ge.get(this.key);return typeof t=="boolean"?t?ut.INSTANCE:mt.INSTANCE:this}evaluate(t){return!t.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(t){return t.mapNot(this.key)}negate(){return this.negated||(this.negated=Lr.create(this.key,this)),this.negated}};function pa(n,t){if(typeof n=="string"){let e=parseFloat(n);isNaN(e)||(n=e)}return typeof n=="string"||typeof n=="number"?t(n):ut.INSTANCE}var Vo=class n{constructor(t,e,r){this.key=t;this.value=e;this.negated=r}static create(t,e,r=null){return pa(e,i=>new n(t,i,r))}type=12;cmp(t){return t.type!==this.type?this.type-t.type:Nr(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=Bo.create(this.key,this.value,this)),this.negated}},Wo=class n{constructor(t,e,r){this.key=t;this.value=e;this.negated=r}static create(t,e,r=null){return pa(e,i=>new n(t,i,r))}type=13;cmp(t){return t.type!==this.type?this.type-t.type:Nr(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(t){return t.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Ko.create(this.key,this.value,this)),this.negated}},Ko=class n{constructor(t,e,r){this.key=t;this.value=e;this.negated=r}static create(t,e,r=null){return pa(e,i=>new n(t,i,r))}type=14;cmp(t){return t.type!==this.type?this.type-t.type:Nr(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Wo.create(this.key,this.value,this)),this.negated}},Bo=class n{constructor(t,e,r){this.key=t;this.value=e;this.negated=r}static create(t,e,r=null){return pa(e,i=>new n(t,i,r))}type=15;cmp(t){return t.type!==this.type?this.type-t.type:Nr(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type?this.key===t.key&&this.value===t.value:!1}substituteConstants(){return this}evaluate(t){return typeof this.value=="string"?!1:parseFloat(t.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(t){return t.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Vo.create(this.key,this.value,this)),this.negated}},qo=class n{constructor(t,e){this.key=t;this.regexp=e}static create(t,e){return new n(t,e)}type=7;negated=null;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.key<t.key)return-1;if(this.key>t.key)return 1;let e=this.regexp?this.regexp.source:"",r=t.regexp?t.regexp.source:"";return e<r?-1:e>r?1:0}equals(t){if(t.type===this.type){let e=this.regexp?this.regexp.source:"",r=t.regexp?t.regexp.source:"";return this.key===t.key&&e===r}return!1}substituteConstants(){return this}evaluate(t){let e=t.getValue(this.key);return this.regexp?this.regexp.test(e):!1}serialize(){let t=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${t}`}keys(){return[this.key]}map(t){return t.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=lu.create(this)),this.negated}},lu=class n{constructor(t){this._actual=t}static create(t){return new n(t)}type=8;cmp(t){return t.type!==this.type?this.type-t.type:this._actual.cmp(t._actual)}equals(t){return t.type===this.type?this._actual.equals(t._actual):!1}substituteConstants(){return this}evaluate(t){return!this._actual.evaluate(t)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(t){return new n(this._actual.map(t))}negate(){return this._actual}};function mp(n){let t=null;for(let e=0,r=n.length;e<r;e++){let i=n[e].substituteConstants();if(n[e]!==i&&t===null){t=[];for(let o=0;o<e;o++)t[o]=n[o]}t!==null&&(t[e]=i)}return t===null?n:t}var da=class n{constructor(t,e){this.expr=t;this.negated=e}static create(t,e,r){return n._normalizeArr(t,e,r)}type=6;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let e=0,r=this.expr.length;e<r;e++){let i=Uo(this.expr[e],t.expr[e]);if(i!==0)return i}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let e=0,r=this.expr.length;e<r;e++)if(!this.expr[e].equals(t.expr[e]))return!1;return!0}return!1}substituteConstants(){let t=mp(this.expr);return t===this.expr?this:n.create(t,this.negated,!1)}evaluate(t){for(let e=0,r=this.expr.length;e<r;e++)if(!this.expr[e].evaluate(t))return!1;return!0}static _normalizeArr(t,e,r){let i=[],o=!1;for(let s of t)if(s){if(s.type===1){o=!0;continue}if(s.type===0)return ut.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&o)return mt.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Uo);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){let s=i[i.length-1];if(s.type!==9)break;i.pop();let a=i.pop(),l=i.length===0,c=$o.create(s.expr.map(u=>n.create([u,a],null,r)),null,l);c&&(i.push(c),i.sort(Uo))}if(i.length===1)return i[0];if(r){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return ut.INSTANCE;if(i.length===1)return i[0]}return new n(i,e)}}serialize(){return this.expr.map(t=>t.serialize()).join(" && ")}keys(){let t=[];for(let e of this.expr)t.push(...e.keys());return t}map(t){return new n(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let t=[];for(let e of this.expr)t.push(e.negate());this.negated=$o.create(t,this,!0)}return this.negated}},$o=class n{constructor(t,e){this.expr=t;this.negated=e}static create(t,e,r){return n._normalizeArr(t,e,r)}type=9;cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let e=0,r=this.expr.length;e<r;e++){let i=Uo(this.expr[e],t.expr[e]);if(i!==0)return i}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let e=0,r=this.expr.length;e<r;e++)if(!this.expr[e].equals(t.expr[e]))return!1;return!0}return!1}substituteConstants(){let t=mp(this.expr);return t===this.expr?this:n.create(t,this.negated,!1)}evaluate(t){for(let e=0,r=this.expr.length;e<r;e++)if(this.expr[e].evaluate(t))return!0;return!1}static _normalizeArr(t,e,r){let i=[],o=!1;if(t){for(let s=0,a=t.length;s<a;s++){let l=t[s];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return mt.INSTANCE;if(l.type===9){i=i.concat(l.expr);continue}i.push(l)}}if(i.length===0&&o)return ut.INSTANCE;i.sort(Uo)}if(i.length!==0){if(i.length===1)return i[0];for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];if(r){for(let s=0;s<i.length;s++)for(let a=s+1;a<i.length;a++)if(i[s].negate().equals(i[a]))return mt.INSTANCE;if(i.length===1)return i[0]}return new n(i,e)}}serialize(){return this.expr.map(t=>t.serialize()).join(" || ")}keys(){let t=[];for(let e of this.expr)t.push(...e.keys());return t}map(t){return new n(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let t=[];for(let e of this.expr)t.push(e.negate());for(;t.length>1;){let e=t.shift(),r=t.shift(),i=[];for(let o of gp(e))for(let s of gp(r))i.push(da.create([o,s],null,!1));t.unshift(n.create(i,null,!1))}this.negated=n.create(t,this,!0)}return this.negated}},fa=class n extends Lr{static _info=[];static all(){return n._info.values()}_defaultValue;constructor(t,e,r){super(t,null),this._defaultValue=e,typeof r=="object"?n._info.push({...r,key:t}):r!==!0&&n._info.push({key:t,description:r,type:e!=null?typeof e:void 0})}bindTo(t){return t.createKey(this.key,this._defaultValue)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return No.create(this.key,t)}notEqualsTo(t){return Mo.create(this.key,t)}},Jw=$("contextKeyService");function yp(n,t){return n<t?-1:n>t?1:0}function Nr(n,t,e,r){return n<e?-1:n>e?1:t<r?-1:t>r?1:0}function gp(n){return n.type===9?n.expr:[n]}var vp=Object.create(null);function d(n,t){if(be(t)){let e=vp[t];if(e===void 0)throw new Error(`${n} references an unknown codicon: ${t}`);t=e}return vp[n]=t,{id:n}}var bp={add:d("add",6e4),plus:d("plus",6e4),gistNew:d("gist-new",6e4),repoCreate:d("repo-create",6e4),lightbulb:d("lightbulb",60001),lightBulb:d("light-bulb",60001),repo:d("repo",60002),repoDelete:d("repo-delete",60002),gistFork:d("gist-fork",60003),repoForked:d("repo-forked",60003),gitPullRequest:d("git-pull-request",60004),gitPullRequestAbandoned:d("git-pull-request-abandoned",60004),recordKeys:d("record-keys",60005),keyboard:d("keyboard",60005),tag:d("tag",60006),gitPullRequestLabel:d("git-pull-request-label",60006),tagAdd:d("tag-add",60006),tagRemove:d("tag-remove",60006),person:d("person",60007),personFollow:d("person-follow",60007),personOutline:d("person-outline",60007),personFilled:d("person-filled",60007),gitBranch:d("git-branch",60008),gitBranchCreate:d("git-branch-create",60008),gitBranchDelete:d("git-branch-delete",60008),sourceControl:d("source-control",60008),mirror:d("mirror",60009),mirrorPublic:d("mirror-public",60009),star:d("star",60010),starAdd:d("star-add",60010),starDelete:d("star-delete",60010),starEmpty:d("star-empty",60010),comment:d("comment",60011),commentAdd:d("comment-add",60011),alert:d("alert",60012),warning:d("warning",60012),search:d("search",60013),searchSave:d("search-save",60013),logOut:d("log-out",60014),signOut:d("sign-out",60014),logIn:d("log-in",60015),signIn:d("sign-in",60015),eye:d("eye",60016),eyeUnwatch:d("eye-unwatch",60016),eyeWatch:d("eye-watch",60016),circleFilled:d("circle-filled",60017),primitiveDot:d("primitive-dot",60017),closeDirty:d("close-dirty",60017),debugBreakpoint:d("debug-breakpoint",60017),debugBreakpointDisabled:d("debug-breakpoint-disabled",60017),debugHint:d("debug-hint",60017),terminalDecorationSuccess:d("terminal-decoration-success",60017),primitiveSquare:d("primitive-square",60018),edit:d("edit",60019),pencil:d("pencil",60019),info:d("info",60020),issueOpened:d("issue-opened",60020),gistPrivate:d("gist-private",60021),gitForkPrivate:d("git-fork-private",60021),lock:d("lock",60021),mirrorPrivate:d("mirror-private",60021),close:d("close",60022),removeClose:d("remove-close",60022),x:d("x",60022),repoSync:d("repo-sync",60023),sync:d("sync",60023),clone:d("clone",60024),desktopDownload:d("desktop-download",60024),beaker:d("beaker",60025),microscope:d("microscope",60025),vm:d("vm",60026),deviceDesktop:d("device-desktop",60026),file:d("file",60027),fileText:d("file-text",60027),more:d("more",60028),ellipsis:d("ellipsis",60028),kebabHorizontal:d("kebab-horizontal",60028),mailReply:d("mail-reply",60029),reply:d("reply",60029),organization:d("organization",60030),organizationFilled:d("organization-filled",60030),organizationOutline:d("organization-outline",60030),newFile:d("new-file",60031),fileAdd:d("file-add",60031),newFolder:d("new-folder",60032),fileDirectoryCreate:d("file-directory-create",60032),trash:d("trash",60033),trashcan:d("trashcan",60033),history:d("history",60034),clock:d("clock",60034),folder:d("folder",60035),fileDirectory:d("file-directory",60035),symbolFolder:d("symbol-folder",60035),logoGithub:d("logo-github",60036),markGithub:d("mark-github",60036),github:d("github",60036),terminal:d("terminal",60037),console:d("console",60037),repl:d("repl",60037),zap:d("zap",60038),symbolEvent:d("symbol-event",60038),error:d("error",60039),stop:d("stop",60039),variable:d("variable",60040),symbolVariable:d("symbol-variable",60040),array:d("array",60042),symbolArray:d("symbol-array",60042),symbolModule:d("symbol-module",60043),symbolPackage:d("symbol-package",60043),symbolNamespace:d("symbol-namespace",60043),symbolObject:d("symbol-object",60043),symbolMethod:d("symbol-method",60044),symbolFunction:d("symbol-function",60044),symbolConstructor:d("symbol-constructor",60044),symbolBoolean:d("symbol-boolean",60047),symbolNull:d("symbol-null",60047),symbolNumeric:d("symbol-numeric",60048),symbolNumber:d("symbol-number",60048),symbolStructure:d("symbol-structure",60049),symbolStruct:d("symbol-struct",60049),symbolParameter:d("symbol-parameter",60050),symbolTypeParameter:d("symbol-type-parameter",60050),symbolKey:d("symbol-key",60051),symbolText:d("symbol-text",60051),symbolReference:d("symbol-reference",60052),goToFile:d("go-to-file",60052),symbolEnum:d("symbol-enum",60053),symbolValue:d("symbol-value",60053),symbolRuler:d("symbol-ruler",60054),symbolUnit:d("symbol-unit",60054),activateBreakpoints:d("activate-breakpoints",60055),archive:d("archive",60056),arrowBoth:d("arrow-both",60057),arrowDown:d("arrow-down",60058),arrowLeft:d("arrow-left",60059),arrowRight:d("arrow-right",60060),arrowSmallDown:d("arrow-small-down",60061),arrowSmallLeft:d("arrow-small-left",60062),arrowSmallRight:d("arrow-small-right",60063),arrowSmallUp:d("arrow-small-up",60064),arrowUp:d("arrow-up",60065),bell:d("bell",60066),bold:d("bold",60067),book:d("book",60068),bookmark:d("bookmark",60069),debugBreakpointConditionalUnverified:d("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:d("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:d("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:d("debug-breakpoint-data-unverified",60072),debugBreakpointData:d("debug-breakpoint-data",60073),debugBreakpointDataDisabled:d("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:d("debug-breakpoint-log-unverified",60074),debugBreakpointLog:d("debug-breakpoint-log",60075),debugBreakpointLogDisabled:d("debug-breakpoint-log-disabled",60075),briefcase:d("briefcase",60076),broadcast:d("broadcast",60077),browser:d("browser",60078),bug:d("bug",60079),calendar:d("calendar",60080),caseSensitive:d("case-sensitive",60081),check:d("check",60082),checklist:d("checklist",60083),chevronDown:d("chevron-down",60084),chevronLeft:d("chevron-left",60085),chevronRight:d("chevron-right",60086),chevronUp:d("chevron-up",60087),chromeClose:d("chrome-close",60088),chromeMaximize:d("chrome-maximize",60089),chromeMinimize:d("chrome-minimize",60090),chromeRestore:d("chrome-restore",60091),circleOutline:d("circle-outline",60092),circle:d("circle",60092),debugBreakpointUnverified:d("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:d("terminal-decoration-incomplete",60092),circleSlash:d("circle-slash",60093),circuitBoard:d("circuit-board",60094),clearAll:d("clear-all",60095),clippy:d("clippy",60096),closeAll:d("close-all",60097),cloudDownload:d("cloud-download",60098),cloudUpload:d("cloud-upload",60099),code:d("code",60100),collapseAll:d("collapse-all",60101),colorMode:d("color-mode",60102),commentDiscussion:d("comment-discussion",60103),creditCard:d("credit-card",60105),dash:d("dash",60108),dashboard:d("dashboard",60109),database:d("database",60110),debugContinue:d("debug-continue",60111),debugDisconnect:d("debug-disconnect",60112),debugPause:d("debug-pause",60113),debugRestart:d("debug-restart",60114),debugStart:d("debug-start",60115),debugStepInto:d("debug-step-into",60116),debugStepOut:d("debug-step-out",60117),debugStepOver:d("debug-step-over",60118),debugStop:d("debug-stop",60119),debug:d("debug",60120),deviceCameraVideo:d("device-camera-video",60121),deviceCamera:d("device-camera",60122),deviceMobile:d("device-mobile",60123),diffAdded:d("diff-added",60124),diffIgnored:d("diff-ignored",60125),diffModified:d("diff-modified",60126),diffRemoved:d("diff-removed",60127),diffRenamed:d("diff-renamed",60128),diff:d("diff",60129),diffSidebyside:d("diff-sidebyside",60129),discard:d("discard",60130),editorLayout:d("editor-layout",60131),emptyWindow:d("empty-window",60132),exclude:d("exclude",60133),extensions:d("extensions",60134),eyeClosed:d("eye-closed",60135),fileBinary:d("file-binary",60136),fileCode:d("file-code",60137),fileMedia:d("file-media",60138),filePdf:d("file-pdf",60139),fileSubmodule:d("file-submodule",60140),fileSymlinkDirectory:d("file-symlink-directory",60141),fileSymlinkFile:d("file-symlink-file",60142),fileZip:d("file-zip",60143),files:d("files",60144),filter:d("filter",60145),flame:d("flame",60146),foldDown:d("fold-down",60147),foldUp:d("fold-up",60148),fold:d("fold",60149),folderActive:d("folder-active",60150),folderOpened:d("folder-opened",60151),gear:d("gear",60152),gift:d("gift",60153),gistSecret:d("gist-secret",60154),gist:d("gist",60155),gitCommit:d("git-commit",60156),gitCompare:d("git-compare",60157),compareChanges:d("compare-changes",60157),gitMerge:d("git-merge",60158),githubAction:d("github-action",60159),githubAlt:d("github-alt",60160),globe:d("globe",60161),grabber:d("grabber",60162),graph:d("graph",60163),gripper:d("gripper",60164),heart:d("heart",60165),home:d("home",60166),horizontalRule:d("horizontal-rule",60167),hubot:d("hubot",60168),inbox:d("inbox",60169),issueReopened:d("issue-reopened",60171),issues:d("issues",60172),italic:d("italic",60173),jersey:d("jersey",60174),json:d("json",60175),kebabVertical:d("kebab-vertical",60176),key:d("key",60177),law:d("law",60178),lightbulbAutofix:d("lightbulb-autofix",60179),linkExternal:d("link-external",60180),link:d("link",60181),listOrdered:d("list-ordered",60182),listUnordered:d("list-unordered",60183),liveShare:d("live-share",60184),loading:d("loading",60185),location:d("location",60186),mailRead:d("mail-read",60187),mail:d("mail",60188),markdown:d("markdown",60189),megaphone:d("megaphone",60190),mention:d("mention",60191),milestone:d("milestone",60192),gitPullRequestMilestone:d("git-pull-request-milestone",60192),mortarBoard:d("mortar-board",60193),move:d("move",60194),multipleWindows:d("multiple-windows",60195),mute:d("mute",60196),noNewline:d("no-newline",60197),note:d("note",60198),octoface:d("octoface",60199),openPreview:d("open-preview",60200),package:d("package",60201),paintcan:d("paintcan",60202),pin:d("pin",60203),play:d("play",60204),run:d("run",60204),plug:d("plug",60205),preserveCase:d("preserve-case",60206),preview:d("preview",60207),project:d("project",60208),pulse:d("pulse",60209),question:d("question",60210),quote:d("quote",60211),radioTower:d("radio-tower",60212),reactions:d("reactions",60213),references:d("references",60214),refresh:d("refresh",60215),regex:d("regex",60216),remoteExplorer:d("remote-explorer",60217),remote:d("remote",60218),remove:d("remove",60219),replaceAll:d("replace-all",60220),replace:d("replace",60221),repoClone:d("repo-clone",60222),repoForcePush:d("repo-force-push",60223),repoPull:d("repo-pull",60224),repoPush:d("repo-push",60225),report:d("report",60226),requestChanges:d("request-changes",60227),rocket:d("rocket",60228),rootFolderOpened:d("root-folder-opened",60229),rootFolder:d("root-folder",60230),rss:d("rss",60231),ruby:d("ruby",60232),saveAll:d("save-all",60233),saveAs:d("save-as",60234),save:d("save",60235),screenFull:d("screen-full",60236),screenNormal:d("screen-normal",60237),searchStop:d("search-stop",60238),server:d("server",60240),settingsGear:d("settings-gear",60241),settings:d("settings",60242),shield:d("shield",60243),smiley:d("smiley",60244),sortPrecedence:d("sort-precedence",60245),splitHorizontal:d("split-horizontal",60246),splitVertical:d("split-vertical",60247),squirrel:d("squirrel",60248),starFull:d("star-full",60249),starHalf:d("star-half",60250),symbolClass:d("symbol-class",60251),symbolColor:d("symbol-color",60252),symbolConstant:d("symbol-constant",60253),symbolEnumMember:d("symbol-enum-member",60254),symbolField:d("symbol-field",60255),symbolFile:d("symbol-file",60256),symbolInterface:d("symbol-interface",60257),symbolKeyword:d("symbol-keyword",60258),symbolMisc:d("symbol-misc",60259),symbolOperator:d("symbol-operator",60260),symbolProperty:d("symbol-property",60261),wrench:d("wrench",60261),wrenchSubaction:d("wrench-subaction",60261),symbolSnippet:d("symbol-snippet",60262),tasklist:d("tasklist",60263),telescope:d("telescope",60264),textSize:d("text-size",60265),threeBars:d("three-bars",60266),thumbsdown:d("thumbsdown",60267),thumbsup:d("thumbsup",60268),tools:d("tools",60269),triangleDown:d("triangle-down",60270),triangleLeft:d("triangle-left",60271),triangleRight:d("triangle-right",60272),triangleUp:d("triangle-up",60273),twitter:d("twitter",60274),unfold:d("unfold",60275),unlock:d("unlock",60276),unmute:d("unmute",60277),unverified:d("unverified",60278),verified:d("verified",60279),versions:d("versions",60280),vmActive:d("vm-active",60281),vmOutline:d("vm-outline",60282),vmRunning:d("vm-running",60283),watch:d("watch",60284),whitespace:d("whitespace",60285),wholeWord:d("whole-word",60286),window:d("window",60287),wordWrap:d("word-wrap",60288),zoomIn:d("zoom-in",60289),zoomOut:d("zoom-out",60290),listFilter:d("list-filter",60291),listFlat:d("list-flat",60292),listSelection:d("list-selection",60293),selection:d("selection",60293),listTree:d("list-tree",60294),debugBreakpointFunctionUnverified:d("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:d("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:d("debug-breakpoint-function-disabled",60296),debugStackframeActive:d("debug-stackframe-active",60297),circleSmallFilled:d("circle-small-filled",60298),debugStackframeDot:d("debug-stackframe-dot",60298),terminalDecorationMark:d("terminal-decoration-mark",60298),debugStackframe:d("debug-stackframe",60299),debugStackframeFocused:d("debug-stackframe-focused",60299),debugBreakpointUnsupported:d("debug-breakpoint-unsupported",60300),symbolString:d("symbol-string",60301),debugReverseContinue:d("debug-reverse-continue",60302),debugStepBack:d("debug-step-back",60303),debugRestartFrame:d("debug-restart-frame",60304),debugAlt:d("debug-alt",60305),callIncoming:d("call-incoming",60306),callOutgoing:d("call-outgoing",60307),menu:d("menu",60308),expandAll:d("expand-all",60309),feedback:d("feedback",60310),gitPullRequestReviewer:d("git-pull-request-reviewer",60310),groupByRefType:d("group-by-ref-type",60311),ungroupByRefType:d("ungroup-by-ref-type",60312),account:d("account",60313),gitPullRequestAssignee:d("git-pull-request-assignee",60313),bellDot:d("bell-dot",60314),debugConsole:d("debug-console",60315),library:d("library",60316),output:d("output",60317),runAll:d("run-all",60318),syncIgnored:d("sync-ignored",60319),pinned:d("pinned",60320),githubInverted:d("github-inverted",60321),serverProcess:d("server-process",60322),serverEnvironment:d("server-environment",60323),pass:d("pass",60324),issueClosed:d("issue-closed",60324),stopCircle:d("stop-circle",60325),playCircle:d("play-circle",60326),record:d("record",60327),debugAltSmall:d("debug-alt-small",60328),vmConnect:d("vm-connect",60329),cloud:d("cloud",60330),merge:d("merge",60331),export:d("export",60332),graphLeft:d("graph-left",60333),magnet:d("magnet",60334),notebook:d("notebook",60335),redo:d("redo",60336),checkAll:d("check-all",60337),pinnedDirty:d("pinned-dirty",60338),passFilled:d("pass-filled",60339),circleLargeFilled:d("circle-large-filled",60340),circleLarge:d("circle-large",60341),circleLargeOutline:d("circle-large-outline",60341),combine:d("combine",60342),gather:d("gather",60342),table:d("table",60343),variableGroup:d("variable-group",60344),typeHierarchy:d("type-hierarchy",60345),typeHierarchySub:d("type-hierarchy-sub",60346),typeHierarchySuper:d("type-hierarchy-super",60347),gitPullRequestCreate:d("git-pull-request-create",60348),runAbove:d("run-above",60349),runBelow:d("run-below",60350),notebookTemplate:d("notebook-template",60351),debugRerun:d("debug-rerun",60352),workspaceTrusted:d("workspace-trusted",60353),workspaceUntrusted:d("workspace-untrusted",60354),workspaceUnknown:d("workspace-unknown",60355),terminalCmd:d("terminal-cmd",60356),terminalDebian:d("terminal-debian",60357),terminalLinux:d("terminal-linux",60358),terminalPowershell:d("terminal-powershell",60359),terminalTmux:d("terminal-tmux",60360),terminalUbuntu:d("terminal-ubuntu",60361),terminalBash:d("terminal-bash",60362),arrowSwap:d("arrow-swap",60363),copy:d("copy",60364),personAdd:d("person-add",60365),filterFilled:d("filter-filled",60366),wand:d("wand",60367),debugLineByLine:d("debug-line-by-line",60368),inspect:d("inspect",60369),layers:d("layers",60370),layersDot:d("layers-dot",60371),layersActive:d("layers-active",60372),compass:d("compass",60373),compassDot:d("compass-dot",60374),compassActive:d("compass-active",60375),azure:d("azure",60376),issueDraft:d("issue-draft",60377),gitPullRequestClosed:d("git-pull-request-closed",60378),gitPullRequestDraft:d("git-pull-request-draft",60379),debugAll:d("debug-all",60380),debugCoverage:d("debug-coverage",60381),runErrors:d("run-errors",60382),folderLibrary:d("folder-library",60383),debugContinueSmall:d("debug-continue-small",60384),beakerStop:d("beaker-stop",60385),graphLine:d("graph-line",60386),graphScatter:d("graph-scatter",60387),pieChart:d("pie-chart",60388),bracket:d("bracket",60175),bracketDot:d("bracket-dot",60389),bracketError:d("bracket-error",60390),lockSmall:d("lock-small",60391),azureDevops:d("azure-devops",60392),verifiedFilled:d("verified-filled",60393),newline:d("newline",60394),layout:d("layout",60395),layoutActivitybarLeft:d("layout-activitybar-left",60396),layoutActivitybarRight:d("layout-activitybar-right",60397),layoutPanelLeft:d("layout-panel-left",60398),layoutPanelCenter:d("layout-panel-center",60399),layoutPanelJustify:d("layout-panel-justify",60400),layoutPanelRight:d("layout-panel-right",60401),layoutPanel:d("layout-panel",60402),layoutSidebarLeft:d("layout-sidebar-left",60403),layoutSidebarRight:d("layout-sidebar-right",60404),layoutStatusbar:d("layout-statusbar",60405),layoutMenubar:d("layout-menubar",60406),layoutCentered:d("layout-centered",60407),target:d("target",60408),indent:d("indent",60409),recordSmall:d("record-small",60410),errorSmall:d("error-small",60411),terminalDecorationError:d("terminal-decoration-error",60411),arrowCircleDown:d("arrow-circle-down",60412),arrowCircleLeft:d("arrow-circle-left",60413),arrowCircleRight:d("arrow-circle-right",60414),arrowCircleUp:d("arrow-circle-up",60415),layoutSidebarRightOff:d("layout-sidebar-right-off",60416),layoutPanelOff:d("layout-panel-off",60417),layoutSidebarLeftOff:d("layout-sidebar-left-off",60418),blank:d("blank",60419),heartFilled:d("heart-filled",60420),map:d("map",60421),mapHorizontal:d("map-horizontal",60421),foldHorizontal:d("fold-horizontal",60421),mapFilled:d("map-filled",60422),mapHorizontalFilled:d("map-horizontal-filled",60422),foldHorizontalFilled:d("fold-horizontal-filled",60422),circleSmall:d("circle-small",60423),bellSlash:d("bell-slash",60424),bellSlashDot:d("bell-slash-dot",60425),commentUnresolved:d("comment-unresolved",60426),gitPullRequestGoToChanges:d("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:d("git-pull-request-new-changes",60428),searchFuzzy:d("search-fuzzy",60429),commentDraft:d("comment-draft",60430),send:d("send",60431),sparkle:d("sparkle",60432),insert:d("insert",60433),mic:d("mic",60434),thumbsdownFilled:d("thumbsdown-filled",60435),thumbsupFilled:d("thumbsup-filled",60436),coffee:d("coffee",60437),snake:d("snake",60438),game:d("game",60439),vr:d("vr",60440),chip:d("chip",60441),piano:d("piano",60442),music:d("music",60443),micFilled:d("mic-filled",60444),repoFetch:d("repo-fetch",60445),copilot:d("copilot",60446),lightbulbSparkle:d("lightbulb-sparkle",60447),robot:d("robot",60448),sparkleFilled:d("sparkle-filled",60449),diffSingle:d("diff-single",60450),diffMultiple:d("diff-multiple",60451),surroundWith:d("surround-with",60452),share:d("share",60453),gitStash:d("git-stash",60454),gitStashApply:d("git-stash-apply",60455),gitStashPop:d("git-stash-pop",60456),vscode:d("vscode",60457),vscodeInsiders:d("vscode-insiders",60458),codeOss:d("code-oss",60459),runCoverage:d("run-coverage",60460),runAllCoverage:d("run-all-coverage",60461),coverage:d("coverage",60462),githubProject:d("github-project",60463),mapVertical:d("map-vertical",60464),foldVertical:d("fold-vertical",60464),mapVerticalFilled:d("map-vertical-filled",60465),foldVerticalFilled:d("fold-vertical-filled",60465),goToSearch:d("go-to-search",60466),percentage:d("percentage",60467),sortPercentage:d("sort-percentage",60467),attach:d("attach",60468)};var U1={dialogError:d("dialog-error","error"),dialogWarning:d("dialog-warning","warning"),dialogInfo:d("dialog-info","info"),dialogClose:d("dialog-close","close"),treeItemExpanded:d("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:d("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:d("tree-filter-on-type-off","list-selection"),treeFilterClear:d("tree-filter-clear","close"),treeItemLoading:d("tree-item-loading","loading"),menuSelection:d("menu-selection","check"),menuSubmenu:d("menu-submenu","chevron-right"),menuBarMore:d("menubar-more","more"),scrollbarButtonLeft:d("scrollbar-button-left","triangle-left"),scrollbarButtonRight:d("scrollbar-button-right","triangle-right"),scrollbarButtonUp:d("scrollbar-button-up","triangle-up"),scrollbarButtonDown:d("scrollbar-button-down","triangle-down"),toolBarMore:d("toolbar-more","more"),quickInputBack:d("quick-input-back","arrow-left"),dropDownButton:d("drop-down-button",60084),symbolCustomColor:d("symbol-customcolor",60252),exportIcon:d("export",60332),workspaceUnspecified:d("workspace-unspecified",60355),newLine:d("newline",60394),thumbsDownFilled:d("thumbsdown-filled",60435),thumbsUpFilled:d("thumbsup-filled",60436),gitFetch:d("git-fetch",60445),lightbulbSparkleAutofix:d("lightbulb-sparkle-autofix",60447),debugBreakpointPending:d("debug-breakpoint-pending",60377)},Ip={...bp,...U1};var xp;(t=>{function n(e){return e&&typeof e=="object"&&typeof e.id=="string"}t.isThemeColor=n})(xp||={});var zo;(y=>{y.iconNameSegment="[A-Za-z0-9]+",y.iconNameExpression="[A-Za-z0-9-]+",y.iconModifierExpression="~[A-Za-z]+",y.iconNameCharacter="[A-Za-z0-9~-]";let i=new RegExp(`^(${y.iconNameExpression})(${y.iconModifierExpression})?$`);function o(I){let S=i.exec(I.id);if(!S)return o(Ip.error);let[,T,k]=S,E=["codicon","codicon-"+T];return k&&E.push("codicon-modifier-"+k.substring(1)),E}y.asClassNameArray=o;function s(I){return o(I).join(" ")}y.asClassName=s;function a(I){return"."+o(I).join(".")}y.asCSSSelector=a;function l(I){return I&&typeof I=="object"&&typeof I.id=="string"&&(typeof I.color>"u"||xp.isThemeColor(I.color))}y.isThemeIcon=l;let c=new RegExp(`^\\$\\((${y.iconNameExpression}(?:${y.iconModifierExpression})?)\\)$`);function u(I){let S=c.exec(I);if(!S)return;let[,T]=S;return{id:T}}y.fromString=u;function f(I){return{id:I}}y.fromId=f;function p(I,S){let T=I.id,k=T.lastIndexOf("~");return k!==-1&&(T=T.substring(0,k)),S&&(T=`${T}~${S}`),{id:T}}y.modify=p;function h(I){let S=I.id.lastIndexOf("~");if(S!==-1)return I.id.substring(S+1)}y.getModifier=h;function v(I,S){return I.id===S.id&&I.color?.id===S.color?.id}y.isEqual=v})(zo||={});var fT=Object.freeze({View:En("view","View"),Help:En("help","Help"),Test:En("test","Test"),File:En("file","File"),Preferences:En("preferences","Preferences"),Developer:En({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});function Ep(n){let t=!1,e=new Map,r=new Map;if(N1(n,u=>{if(n===u)return!0;let f=JSON.stringify(u);if(f.length<30)return!0;let p=e.get(f);if(!p){let h={schemas:[u]};return e.set(f,h),r.set(u,h),!0}return p.schemas.push(u),r.set(u,p),t=!0,!1}),e.clear(),!t)return JSON.stringify(n);let o="$defs";for(;n.hasOwnProperty(o);)o+="_";let s=[];function a(u){return JSON.stringify(u,(f,p)=>{if(p!==u){let h=r.get(p);if(h&&h.schemas.length>1)return h.id||(h.id=`_${s.length}`,s.push(h.schemas[0])),{$ref:`#/${o}/${h.id}`}}return p})}let l=a(n),c=[];for(let u=0;u<s.length;u++)c.push(`"_${u}":${a(s[u])}`);return c.length?`${l.substring(0,l.length-1)},"${o}":{${c.join(",")}}}`:l}function hi(n){return typeof n=="object"&&n!==null}function N1(n,t){if(!n||typeof n!="object")return;let e=(...l)=>{for(let c of l)hi(c)&&s.push(c)},r=(...l)=>{for(let c of l)if(hi(c))for(let u in c){let f=c[u];hi(f)&&s.push(f)}},i=(...l)=>{for(let c of l)if(Array.isArray(c))for(let u of c)hi(u)&&s.push(u)},o=l=>{if(Array.isArray(l))for(let c of l)hi(c)&&s.push(c);else hi(l)&&s.push(l)},s=[n],a=s.pop();for(;a;)t(a)&&(e(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),r(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),i(a.anyOf,a.allOf,a.oneOf,a.prefixItems),o(a.items)),a=s.pop()}var M1=$("commandService"),Sp=new class{_commands=new Map;_onDidRegisterCommand=new C;onDidRegisterCommand=this._onDidRegisterCommand.event;registerCommand(n,t){if(!n)throw new Error("invalid command");if(typeof n=="string"){if(!t)throw new Error("invalid command");return this.registerCommand({id:n,handler:t})}if(n.metadata&&Array.isArray(n.metadata.args)){let s=[];for(let l of n.metadata.args)s.push(l.constraint);let a=n.handler;n.handler=function(l,...c){return qf(c,s),a(l,...c)}}let{id:e}=n,r=this._commands.get(e);r||(r=new Zn,this._commands.set(e,r));let i=r.unshift(n),o=te(()=>{i(),this._commands.get(e)?.isEmpty()&&this._commands.delete(e)});return this._onDidRegisterCommand.fire(e),o}registerCommandAlias(n,t){return Sp.registerCommand(n,(e,...r)=>e.get(M1).executeCommand(t,...r))}getCommand(n){let t=this._commands.get(n);if(!(!t||t.isEmpty()))return ar.first(t)}getCommands(){let n=new Map;for(let t of this._commands.keys()){let e=this.getCommand(t);e&&n.set(t,e)}return n}};Sp.registerCommand("noop",()=>{});var xt=$("environmentService"),dt=xt;var J=$("logService"),Tp=$("loggerService");var cu=3;function mi(n,t=!1){let e="";for(let r=0;r<n.length;r++){let i=n[r];if(i instanceof Error&&(i=dn(i,t)),typeof i=="object")try{i=JSON.stringify(i)}catch{}e+=(r>0?" ":"")+i}return e}var jo=class extends U{level=cu;_onDidChangeLogLevel=this._register(new C);onDidChangeLogLevel=this._onDidChangeLogLevel.event;setLevel(t){this.level!==t&&(this.level=t,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(t){return this.level!==0&&this.level<=t}},ga=class extends jo{constructor(e){super();this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...r){this.checkLogLevel(1)&&this.log(1,mi([e,...r],!0))}debug(e,...r){this.checkLogLevel(2)&&this.log(2,mi([e,...r]))}info(e,...r){this.checkLogLevel(3)&&this.log(3,mi([e,...r]))}warn(e,...r){this.checkLogLevel(4)&&this.log(4,mi([e,...r]))}error(e,...r){if(this.checkLogLevel(5))if(e instanceof Error){let i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.log(5,mi(i))}else this.log(5,mi([e,...r]))}flush(){}};var ha=class extends jo{constructor(e=cu,r=!0){super();this.useColors=r;this.setLevel(e)}trace(e,...r){this.checkLogLevel(1)&&(this.useColors?console.log("%cTRACE","color: #888",e,...r):console.log(e,...r))}debug(e,...r){this.checkLogLevel(2)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...r):console.log(e,...r))}info(e,...r){this.checkLogLevel(3)&&(this.useColors?console.log("%c INFO","color: #33f",e,...r):console.log(e,...r))}warn(e,...r){this.checkLogLevel(4)&&(this.useColors?console.log("%c WARN","color: #993",e,...r):console.log(e,...r))}error(e,...r){this.checkLogLevel(5)&&(this.useColors?console.log("%c  ERR","color: #f33",e,...r):console.error(e,...r))}flush(){}};var ma=class extends jo{constructor(e){super();this.loggers=e;e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(let r of this.loggers)r.setLevel(e);super.setLevel(e)}trace(e,...r){for(let i of this.loggers)i.trace(e,...r)}debug(e,...r){for(let i of this.loggers)i.debug(e,...r)}info(e,...r){for(let i of this.loggers)i.info(e,...r)}warn(e,...r){for(let i of this.loggers)i.warn(e,...r)}error(e,...r){for(let i of this.loggers)i.error(e,...r)}flush(){for(let e of this.loggers)e.flush()}dispose(){for(let e of this.loggers)e.dispose();super.dispose()}},ya=class extends U{constructor(e,r,i){super();this.logLevel=e;this.logsHome=r;if(i)for(let o of i)this._loggers.set(o.resource,{logger:void 0,info:o})}_loggers=new ve;_onDidChangeLoggers=this._register(new C);onDidChangeLoggers=this._onDidChangeLoggers.event;_onDidChangeLogLevel=this._register(new C);onDidChangeLogLevel=this._onDidChangeLogLevel.event;_onDidChangeVisibility=this._register(new C);onDidChangeVisibility=this._onDidChangeVisibility.event;getLoggerEntry(e){return be(e)?[...this._loggers.values()].find(r=>r.info.id===e):this._loggers.get(e)}getLogger(e){return this.getLoggerEntry(e)?.logger}createLogger(e,r){let i=this.toResource(e),o=be(e)?e:r?.id??Pn(i.toString()).toString(16),s=this._loggers.get(i)?.logger,a=r?.logLevel==="always"?1:r?.logLevel;s||(s=this.doCreateLogger(i,a??this.getLogLevel(i)??this.logLevel,{...r,id:o}));let l={logger:s,info:{resource:i,id:o,logLevel:a,name:r?.name,hidden:r?.hidden,extensionId:r?.extensionId,when:r?.when}};return this.registerLogger(l.info),this._loggers.set(i,l),s}toResource(e){return be(e)?B(this.logsHome,`${e}.log`):e}setLogLevel(e,r){if(P.isUri(e)){let i=e,o=r,s=this._loggers.get(i);s&&o!==s.info.logLevel&&(s.info.logLevel=o===this.logLevel?void 0:o,s.logger?.setLevel(o),this._loggers.set(s.info.resource,s),this._onDidChangeLogLevel.fire([i,o]))}else{this.logLevel=e;for(let[i,o]of this._loggers.entries())this._loggers.get(i)?.info.logLevel===void 0&&o.logger?.setLevel(this.logLevel);this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,r){let i=this.getLoggerEntry(e);i&&r!==!i.info.hidden&&(i.info.hidden=!r,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,r]))}getLogLevel(e){let r;return e&&(r=this._loggers.get(e)?.info.logLevel),r??this.logLevel}registerLogger(e){let r=this._loggers.get(e.resource);r?r.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){let r=this._loggers.get(e);r&&(r.logger&&r.logger.dispose(),this._loggers.delete(e),this._onDidChangeLoggers.fire({added:[],removed:[r.info]}))}*getRegisteredLoggers(){for(let e of this._loggers.values())yield e.info}getRegisteredLogger(e){return this._loggers.get(e)?.info}dispose(){this._loggers.forEach(e=>e.logger?.dispose()),this._loggers.clear(),super.dispose()}},Go=class{onDidChangeLogLevel=new C().event;setLevel(t){}getLevel(){return 3}trace(t,...e){}debug(t,...e){}info(t,...e){}warn(t,...e){}error(t,...e){}critical(t,...e){}dispose(){}flush(){}},va=class extends Go{};function Pp(n){if(n.verbose)return 1;if(typeof n.logLevel=="string"){let t=W1(n.logLevel.toLowerCase());if(t!==void 0)return t}return cu}function V1(n){switch(n){case 1:return"trace";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 0:return"off"}}function W1(n){switch(n){case"trace":return 1;case"debug":return 2;case"info":return 3;case"warn":return 4;case"error":return 5;case"critical":return 5;case"off":return 0}}var dP=new fa("logLevel",V1(3));function wa(n){return!!n&&typeof n.then=="function"}function qt(n){let t=new at,e=n(t.token),r=new Promise((i,o)=>{let s=t.token.onCancellationRequested(()=>{s.dispose(),o(new me)});Promise.resolve(e).then(a=>{s.dispose(),t.dispose(),i(a)},a=>{s.dispose(),t.dispose(),o(a)})});return new class{cancel(){t.cancel(),t.dispose()}then(i,o){return r.then(i,o)}catch(i){return this.then(void 0,i)}finally(i){return r.finally(i)}}}var uu=class{activePromise;queuedPromise;queuedPromiseFactory;isDisposed=!1;constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(t){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=t,!this.queuedPromise){let e=()=>{if(this.queuedPromise=null,this.isDisposed)return;let r=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,r};this.queuedPromise=new Promise(r=>{this.activePromise.then(e,e).then(r)})}return new Promise((e,r)=>{this.queuedPromise.then(e,r)})}return this.activePromise=t(),new Promise((e,r)=>{this.activePromise.then(i=>{this.activePromise=null,e(i)},i=>{this.activePromise=null,r(i)})})}dispose(){this.isDisposed=!0}},Ia=class{current=Promise.resolve(null);queue(t){return this.current=this.current.then(()=>t(),()=>t())}};var K1=(n,t)=>{let e=!0,r=setTimeout(()=>{e=!1,t()},n);return{isTriggered:()=>e,dispose:()=>{clearTimeout(r),e=!1}}},B1=n=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,n())}),{isTriggered:()=>t,dispose:()=>{t=!1}}},Ho=class{constructor(t){this.defaultDelay=t;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}deferred;completionPromise;doResolve;doReject;task;trigger(t,e=this.defaultDelay){this.task=t,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}));let r=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=e===gf?B1(r):K1(e,r),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new me),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Zt=class{delayer;throttler;constructor(t){this.delayer=new Ho(t),this.throttler=new uu}trigger(t,e){return this.delayer.trigger(()=>this.throttler.queue(t),e)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},yi=class{_isOpen;_promise;_completePromise;constructor(){this._isOpen=!1,this._promise=new Promise((t,e)=>{this._completePromise=t})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function Mr(n,t){return t?new Promise((e,r)=>{let i=setTimeout(()=>{o.dispose(),e()},n),o=t.onCancellationRequested(()=>{clearTimeout(i),o.dispose(),r(new me)})}):qt(e=>Mr(n,e))}var Qo=class{_size=0;_isDisposed=!1;runningPromises;maxDegreeOfParalellism;outstandingPromises;_onDrained;constructor(t){this.maxDegreeOfParalellism=t,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new C}whenIdle(){return this.size>0?Z.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(t){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((e,r)=>{this.outstandingPromises.push({factory:t,c:e,e:r}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let t=this.outstandingPromises.shift();this.runningPromises++;let e=t.factory();e.then(t.c,t.e),e.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}},pn=class extends Qo{constructor(){super(1)}};var vi=class{queues=new Map;drainers=new Set;drainListeners=void 0;drainListenerCount=0;async whenDrained(){if(this.isDrained())return;let t=new bi;return this.drainers.add(t),t.p}isDrained(){for(let[,t]of this.queues)if(t.size>0)return!1;return!0}queueSize(t,e=ae){let r=e.getComparisonKey(t);return this.queues.get(r)?.size??0}queueFor(t,e,r=ae){let i=r.getComparisonKey(t),o=this.queues.get(i);if(!o){o=new pn;let s=this.drainListenerCount++,a=Z.once(o.onDrained)(()=>{o?.dispose(),this.queues.delete(i),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(s),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new Ln),this.drainListeners.set(s,a),this.queues.set(i,o)}return o.queue(e)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(let t of this.drainers)t.complete();this.drainers.clear()}dispose(){for(let[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}};var fr=class{runner;timeoutToken;timeout;timeoutHandler;constructor(t,e){this.timeoutToken=-1,this.runner=t,this.timeout=e,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(t=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,t)}get delay(){return this.timeout}set delay(t){this.timeout=t}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var xa=class extends fr{units=[];constructor(t,e){super(t,e)}work(t){this.units.push(t),this.isScheduled()||this.schedule()}doRun(){let t=this.units;this.units=[],this.runner?.(t)}dispose(){this.units=[],super.dispose()}},Ea=class extends U{constructor(e,r){super();this.options=e;this.handler=r}pendingWork=[];throttler=this._register(new lr);disposed=!1;get pending(){return this.pendingWork.length}work(e){if(this.disposed)return!1;if(typeof this.options.maxBufferedWork=="number"){if(this.throttler.value){if(this.pending+e.length>this.options.maxBufferedWork)return!1}else if(this.pending+e.length-this.options.maxWorkChunkSize>this.options.maxBufferedWork)return!1}for(let r of e)this.pendingWork.push(r);return this.throttler.value||this.doWork(),!0}doWork(){this.handler(this.pendingWork.splice(0,this.options.maxWorkChunkSize)),this.pendingWork.length>0&&(this.throttler.value=new fr(()=>{this.throttler.clear(),this.doWork()},this.options.throttleDelay),this.throttler.value.schedule())}dispose(){super.dispose(),this.disposed=!0}},fu,ba;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?ba=(n,t)=>{_f(()=>{if(e)return;let r=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,r-Date.now())}}))});let e=!1;return{dispose(){e||(e=!0)}}}:ba=(n,t,e)=>{let r=n.requestIdleCallback(t,typeof e=="number"?{timeout:e}:void 0),i=!1;return{dispose(){i||(i=!0,n.cancelIdleCallback(r))}}},fu=n=>ba(globalThis,n)})();var du=class{_executor;_handle;_didRun=!1;_value;_error;constructor(t,e){this._executor=()=>{try{this._value=e()}catch(r){this._error=r}finally{this._didRun=!0}},this._handle=ba(t,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},Sa=class extends du{constructor(t){super(globalThis,t)}};async function Rp(n,t,e){let r;for(let i=0;i<e;i++)try{return await n()}catch(o){r=o,await Mr(t)}throw r}var bi=class{completeCallback;errorCallback;outcome;get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}p;constructor(){this.p=new Promise((t,e)=>{this.completeCallback=t,this.errorCallback=e})}complete(t){return new Promise(e=>{this.completeCallback(t),this.outcome={outcome:0,value:t},e()})}error(t){return new Promise(e=>{this.errorCallback(t),this.outcome={outcome:1,value:t},e()})}cancel(){return this.error(new me)}},ze;(e=>{async function n(r){let i,o=await Promise.all(r.map(s=>s.then(a=>a,a=>{i||(i=a)})));if(typeof i<"u")throw i;return o}e.settled=n;function t(r){return new Promise(async(i,o)=>{try{await r(i,o)}catch(s){o(s)}})}e.withAsyncBody=t})(ze||={});var _p=class n{static fromArray(t){return new n(e=>{e.emitMany(t)})}static fromPromise(t){return new n(async e=>{e.emitMany(await t)})}static fromPromises(t){return new n(async e=>{await Promise.all(t.map(async r=>e.emitOne(await r)))})}static merge(t){return new n(async e=>{await Promise.all(t.map(async r=>{for await(let i of r)e.emitOne(i)}))})}static EMPTY=n.fromArray([]);_state;_results;_error;_onReturn;_onStateChanged;constructor(t,e){this._state=0,this._results=[],this._error=null,this._onReturn=e,this._onStateChanged=new C,queueMicrotask(async()=>{let r={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(t(r)),this.resolve()}catch(i){this.reject(i)}finally{r.emitOne=void 0,r.emitMany=void 0,r.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await Z.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,e){return new n(async r=>{for await(let i of t)r.emitOne(e(i))})}map(t){return n.map(this,t)}static filter(t,e){return new n(async r=>{for await(let i of t)e(i)&&r.emitOne(i)})}filter(t){return n.filter(this,t)}static coalesce(t){return n.filter(t,e=>!!e)}coalesce(){return n.coalesce(this)}static async toPromise(t){let e=[];for await(let r of t)e.push(r);return e}toPromise(){return n.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}};function Jo(n){let t=n;return t?[t.on,t.pause,t.resume,t.destroy].every(e=>typeof e=="function"):!1}function Ta(n){let t=n;return t?Jo(t.stream)&&Array.isArray(t.buffer)&&typeof t.ended=="boolean":!1}function Vr(n,t){return new pu(n,t)}var pu=class{constructor(t,e){this.reducer=t;this.options=e}state={flowing:!1,ended:!1,destroyed:!1};buffer={data:[],error:[]};listeners={data:[],error:[],end:[]};pendingWritePromises=[];pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(t){if(!this.state.destroyed){if(this.state.flowing)this.emitData(t);else if(this.buffer.data.push(t),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(e=>this.pendingWritePromises.push(e))}}error(t){this.state.destroyed||(this.state.flowing?this.emitError(t):this.buffer.error.push(t))}end(t){this.state.destroyed||(typeof t<"u"&&this.write(t),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(t){this.listeners.data.slice(0).forEach(e=>e(t))}emitError(t){this.listeners.error.length===0?Lt(t):this.listeners.error.slice(0).forEach(e=>e(t))}emitEnd(){this.listeners.end.slice(0).forEach(t=>t())}on(t,e){if(!this.state.destroyed)switch(t){case"data":this.listeners.data.push(e),this.resume();break;case"end":this.listeners.end.push(e),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(e),this.state.flowing&&this.flowErrors();break}}removeListener(t,e){if(this.state.destroyed)return;let r;switch(t){case"data":r=this.listeners.data;break;case"end":r=this.listeners.end;break;case"error":r=this.listeners.error;break}if(r){let i=r.indexOf(e);i>=0&&r.splice(i,1)}}flowData(){if(this.buffer.data.length>0){let t=this.reducer(this.buffer.data);this.emitData(t),this.buffer.data.length=0;let e=[...this.pendingWritePromises];this.pendingWritePromises.length=0,e.forEach(r=>r())}}flowErrors(){if(this.listeners.error.length>0){for(let t of this.buffer.error)this.emitError(t);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function Cp(n,t){let e=[],r;for(;(r=n.read())!==null;)e.push(r);return t(e)}function Dp(n,t,e){let r=[],i;for(;(i=n.read())!==null&&r.length<e;)r.push(i);return i===null&&r.length>0?t(r):{read:()=>{if(r.length>0)return r.shift();if(typeof i<"u"){let o=i;return i=void 0,o}return n.read()}}}function Pa(n,t){return new Promise((e,r)=>{let i=[];_a(n,{onData:o=>{t&&i.push(o)},onError:o=>{t?r(o):e(void 0)},onEnd:()=>{e(t?t(i):void 0)}})})}function _a(n,t,e){n.on("error",r=>{e?.isCancellationRequested||t.onError(r)}),n.on("end",()=>{e?.isCancellationRequested||t.onEnd()}),n.on("data",r=>{e?.isCancellationRequested||t.onData(r)})}function kp(n,t){return new Promise((e,r)=>{let i=new Ee,o=[],s=c=>{if(o.push(c),o.length>t)return i.dispose(),n.pause(),e({stream:n,buffer:o,ended:!1})},a=c=>(i.dispose(),r(c)),l=()=>(i.dispose(),e({stream:n,buffer:o,ended:!0}));i.add(te(()=>n.removeListener("error",a))),n.on("error",a),i.add(te(()=>n.removeListener("end",l))),n.on("end",l),i.add(te(()=>n.removeListener("data",s))),n.on("data",s)})}function Op(n){let t=!1;return{read:()=>t?null:(t=!0,n)}}function Ra(n,t,e){let r=Vr(e);return _a(n,{onData:i=>r.write(t.data(i)),onError:i=>r.error(t.error?t.error(i):i),onEnd:()=>r.end()}),r}var Ca=typeof Buffer<"u",$1=new ht(()=>new Uint8Array(256)),gu,hu,W=class n{static alloc(t){return Ca?new n(Buffer.allocUnsafe(t)):new n(new Uint8Array(t))}static wrap(t){return Ca&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new n(t)}static fromString(t,e){return!(e?.dontUseNodeBuffer||!1)&&Ca?new n(Buffer.from(t)):(gu||(gu=new TextEncoder),new n(gu.encode(t)))}static fromByteArray(t){let e=n.alloc(t.length);for(let r=0,i=t.length;r<i;r++)e.buffer[r]=t[r];return e}static concat(t,e){if(typeof e>"u"){e=0;for(let o=0,s=t.length;o<s;o++)e+=t[o].byteLength}let r=n.alloc(e),i=0;for(let o=0,s=t.length;o<s;o++){let a=t[o];r.set(a,i),i+=a.byteLength}return r}buffer;byteLength;constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}clone(){let t=n.alloc(this.byteLength);return t.set(this),t}toString(){return Ca?this.buffer.toString():(hu||(hu=new TextDecoder),hu.decode(this.buffer))}slice(t,e){return new n(this.buffer.subarray(t,e))}set(t,e){if(t instanceof n)this.buffer.set(t.buffer,e);else if(t instanceof Uint8Array)this.buffer.set(t,e);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),e);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e);else throw new Error("Unknown argument 'array'")}readUInt32BE(t){return j1(this.buffer,t)}writeUInt32BE(t,e){G1(this.buffer,t,e)}readUInt32LE(t){return H1(this.buffer,t)}writeUInt32LE(t,e){Q1(this.buffer,t,e)}readUInt8(t){return J1(this.buffer,t)}writeUInt8(t,e){X1(this.buffer,t,e)}indexOf(t,e=0){return z1(this.buffer,t instanceof n?t.buffer:t,e)}};function z1(n,t,e=0){let r=t.byteLength,i=n.byteLength;if(r===0)return 0;if(r===1)return n.indexOf(t[0]);if(r>i-e)return-1;let o=$1.value;o.fill(t.length);for(let c=0;c<t.length;c++)o[t[c]]=t.length-c-1;let s=e+t.length-1,a=s,l=-1;for(;s<i;)if(n[s]===t[a]){if(a===0){l=s;break}s--,a--}else s+=Math.max(t.length-a,o[n[s]]),a=t.length-1;return l}function j1(n,t){return n[t]*2**24+n[t+1]*2**16+n[t+2]*2**8+n[t+3]}function G1(n,t,e){n[e+3]=t,t=t>>>8,n[e+2]=t,t=t>>>8,n[e+1]=t,t=t>>>8,n[e]=t}function H1(n,t){return n[t+0]<<0>>>0|n[t+1]<<8>>>0|n[t+2]<<16>>>0|n[t+3]<<24>>>0}function Q1(n,t,e){n[e+0]=t&255,t=t>>>8,n[e+1]=t&255,t=t>>>8,n[e+2]=t&255,t=t>>>8,n[e+3]=t&255}function J1(n,t){return n[t]}function X1(n,t,e){n[e]=t}function Ap(n){return Cp(n,t=>W.concat(t))}function Fp(n){return Op(n)}function pr(n){return Pa(n,t=>W.concat(t))}async function Lp(n){return n.ended?W.concat(n.buffer):W.concat([...n.buffer,await pr(n.stream)])}function Up(n){return Ra(n,{data:t=>typeof t=="string"?W.fromString(t):W.wrap(t)},t=>W.concat(t))}function Np(n){return Vr(t=>W.concat(t),n)}var ka;(t=>t.DEFAULT={allowTrailingComma:!0})(ka||={});function yu(n,t=!1){let e=0,r=n.length,i="",o=0,s=16,a=0;function l(y){let I=0,S=0;for(;I<y;){let T=n.charCodeAt(e);if(T>=48&&T<=57)S=S*16+T-48;else if(T>=65&&T<=70)S=S*16+T-65+10;else if(T>=97&&T<=102)S=S*16+T-97+10;else break;e++,I++}return I<y&&(S=-1),S}function c(y){e=y,i="",o=0,s=16,a=0}function u(){let y=e;if(n.charCodeAt(e)===48)e++;else for(e++;e<n.length&&Ii(n.charCodeAt(e));)e++;if(e<n.length&&n.charCodeAt(e)===46)if(e++,e<n.length&&Ii(n.charCodeAt(e)))for(e++;e<n.length&&Ii(n.charCodeAt(e));)e++;else return a=3,n.substring(y,e);let I=e;if(e<n.length&&(n.charCodeAt(e)===69||n.charCodeAt(e)===101))if(e++,(e<n.length&&n.charCodeAt(e)===43||n.charCodeAt(e)===45)&&e++,e<n.length&&Ii(n.charCodeAt(e))){for(e++;e<n.length&&Ii(n.charCodeAt(e));)e++;I=e}else a=3;return n.substring(y,I)}function f(){let y="",I=e;for(;;){if(e>=r){y+=n.substring(I,e),a=2;break}let S=n.charCodeAt(e);if(S===34){y+=n.substring(I,e),e++;break}if(S===92){if(y+=n.substring(I,e),e++,e>=r){a=2;break}switch(n.charCodeAt(e++)){case 34:y+='"';break;case 92:y+="\\";break;case 47:y+="/";break;case 98:y+="\b";break;case 102:y+="\f";break;case 110:y+=`
`;break;case 114:y+="\r";break;case 116:y+="	";break;case 117:{let k=l(4);k>=0?y+=String.fromCharCode(k):a=4;break}default:a=5}I=e;continue}if(S>=0&&S<=31)if(Da(S)){y+=n.substring(I,e),a=2;break}else a=6;e++}return y}function p(){if(i="",a=0,o=e,e>=r)return o=r,s=17;let y=n.charCodeAt(e);if(mu(y)){do e++,i+=String.fromCharCode(y),y=n.charCodeAt(e);while(mu(y));return s=15}if(Da(y))return e++,i+=String.fromCharCode(y),y===13&&n.charCodeAt(e)===10&&(e++,i+=`
`),s=14;switch(y){case 123:return e++,s=1;case 125:return e++,s=2;case 91:return e++,s=3;case 93:return e++,s=4;case 58:return e++,s=6;case 44:return e++,s=5;case 34:return e++,i=f(),s=10;case 47:{let I=e-1;if(n.charCodeAt(e+1)===47){for(e+=2;e<r&&!Da(n.charCodeAt(e));)e++;return i=n.substring(I,e),s=12}if(n.charCodeAt(e+1)===42){e+=2;let S=r-1,T=!1;for(;e<S;){if(n.charCodeAt(e)===42&&n.charCodeAt(e+1)===47){e+=2,T=!0;break}e++}return T||(e++,a=1),i=n.substring(I,e),s=13}return i+=String.fromCharCode(y),e++,s=16}case 45:if(i+=String.fromCharCode(y),e++,e===r||!Ii(n.charCodeAt(e)))return s=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return i+=u(),s=11;default:for(;e<r&&h(y);)e++,y=n.charCodeAt(e);if(o!==e){switch(i=n.substring(o,e),i){case"true":return s=8;case"false":return s=9;case"null":return s=7}return s=16}return i+=String.fromCharCode(y),e++,s=16}}function h(y){if(mu(y)||Da(y))return!1;switch(y){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function v(){let y;do y=p();while(y>=12&&y<=15);return y}return{setPosition:c,getPosition:()=>e,scan:t?v:p,getToken:()=>s,getTokenValue:()=>i,getTokenOffset:()=>o,getTokenLength:()=>e-o,getTokenError:()=>a}}function mu(n){return n===32||n===9||n===11||n===12||n===160||n===5760||n>=8192&&n<=8203||n===8239||n===8287||n===12288||n===65279}function Da(n){return n===10||n===13||n===8232||n===8233}function Ii(n){return n>=48&&n<=57}function Wr(n,t=[],e=ka.DEFAULT){let r=null,i=[],o=[];function s(l){Array.isArray(i)?i.push(l):r!==null&&(i[r]=l)}return Oa(n,{onObjectBegin:()=>{let l={};s(l),o.push(i),i=l,r=null},onObjectProperty:l=>{r=l},onObjectEnd:()=>{i=o.pop()},onArrayBegin:()=>{let l=[];s(l),o.push(i),i=l,r=null},onArrayEnd:()=>{i=o.pop()},onLiteralValue:s,onError:(l,c,u)=>{t.push({error:l,offset:c,length:u})}},e),i[0]}function Mp(n,t=[],e=ka.DEFAULT){let r={type:"array",offset:-1,length:-1,children:[],parent:void 0};function i(l){r.type==="property"&&(r.length=l-r.offset,r=r.parent)}function o(l){return r.children.push(l),l}Oa(n,{onObjectBegin:l=>{r=o({type:"object",offset:l,length:-1,parent:r,children:[]})},onObjectProperty:(l,c,u)=>{r=o({type:"property",offset:c,length:-1,parent:r,children:[]}),r.children.push({type:"string",value:l,offset:c,length:u,parent:r})},onObjectEnd:(l,c)=>{r.length=l+c-r.offset,r=r.parent,i(l+c)},onArrayBegin:(l,c)=>{r=o({type:"array",offset:l,length:-1,parent:r,children:[]})},onArrayEnd:(l,c)=>{r.length=l+c-r.offset,r=r.parent,i(l+c)},onLiteralValue:(l,c,u)=>{o({type:xi(l),offset:c,length:u,parent:r,value:l}),i(c+u)},onSeparator:(l,c,u)=>{r.type==="property"&&(l===":"?r.colonOffset=c:l===","&&i(c))},onError:(l,c,u)=>{t.push({error:l,offset:c,length:u})}},e);let a=r.children[0];return a&&delete a.parent,a}function vu(n,t){if(!n)return;let e=n;for(let r of t)if(typeof r=="string"){if(e.type!=="object"||!Array.isArray(e.children))return;let i=!1;for(let o of e.children)if(Array.isArray(o.children)&&o.children[0].value===r){e=o.children[1],i=!0;break}if(!i)return}else{let i=r;if(e.type!=="array"||i<0||!Array.isArray(e.children)||i>=e.children.length)return;e=e.children[i]}return e}function Oa(n,t,e=ka.DEFAULT){let r=yu(n,!1);function i(q){return q?()=>q(r.getTokenOffset(),r.getTokenLength()):()=>!0}function o(q){return q?ye=>q(ye,r.getTokenOffset(),r.getTokenLength()):()=>!0}let s=i(t.onObjectBegin),a=o(t.onObjectProperty),l=i(t.onObjectEnd),c=i(t.onArrayBegin),u=i(t.onArrayEnd),f=o(t.onLiteralValue),p=o(t.onSeparator),h=i(t.onComment),v=o(t.onError),y=e&&e.disallowComments,I=e&&e.allowTrailingComma;function S(){for(;;){let q=r.scan();switch(r.getTokenError()){case 4:T(14);break;case 5:T(15);break;case 3:T(13);break;case 1:y||T(11);break;case 2:T(12);break;case 6:T(16);break}switch(q){case 12:case 13:y?T(10):h();break;case 16:T(1);break;case 15:case 14:break;default:return q}}}function T(q,ye=[],Ht=[]){if(v(q),ye.length+Ht.length>0){let pt=r.getToken();for(;pt!==17;){if(ye.indexOf(pt)!==-1){S();break}else if(Ht.indexOf(pt)!==-1)break;pt=S()}}}function k(q){let ye=r.getTokenValue();return q?f(ye):a(ye),S(),!0}function E(){switch(r.getToken()){case 11:{let q=0;try{q=JSON.parse(r.getTokenValue()),typeof q!="number"&&(T(2),q=0)}catch{T(2)}f(q);break}case 7:f(null);break;case 8:f(!0);break;case 9:f(!1);break;default:return!1}return S(),!0}function _(){return r.getToken()!==10?(T(3,[],[2,5]),!1):(k(!1),r.getToken()===6?(p(":"),S(),Ie()||T(4,[],[2,5])):T(5,[],[2,5]),!0)}function N(){s(),S();let q=!1;for(;r.getToken()!==2&&r.getToken()!==17;){if(r.getToken()===5){if(q||T(4,[],[]),p(","),S(),r.getToken()===2&&I)break}else q&&T(6,[],[]);_()||T(4,[],[2,5]),q=!0}return l(),r.getToken()!==2?T(7,[2],[]):S(),!0}function A(){c(),S();let q=!1;for(;r.getToken()!==4&&r.getToken()!==17;){if(r.getToken()===5){if(q||T(4,[],[]),p(","),S(),r.getToken()===4&&I)break}else q&&T(6,[],[]);Ie()||T(4,[],[4,5]),q=!0}return u(),r.getToken()!==4?T(8,[4],[]):S(),!0}function Ie(){switch(r.getToken()){case 3:return A();case 1:return N();case 10:return k(!0);default:return E()}}return S(),r.getToken()===17?e.allowEmptyContent?!0:(T(4,[],[]),!1):Ie()?(r.getToken()!==17&&T(9,[],[]),!0):(T(4,[],[]),!1)}function xi(n){switch(typeof n){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":{if(n){if(Array.isArray(n))return"array"}else return"null";return"object"}default:return"null"}}function Vp(n,t,e){let r,i,o,s,a;if(t){for(s=t.offset,a=s+t.length,o=s;o>0&&!Xo(n,o-1);)o--;let k=a;for(;k<n.length&&!Xo(n,k);)k++;i=n.substring(o,k),r=Z1(i,e)}else i=n,r=0,o=0,s=0,a=n.length;let l=ev(e,n),c=!1,u=0,f;e.insertSpaces?f=bu(" ",e.tabSize||4):f="	";let p=yu(i,!1),h=!1;function v(){return l+bu(f,r+u)}function y(){let k=p.scan();for(c=!1;k===15||k===14;)c=c||k===14,k=p.scan();return h=k===16||p.getTokenError()!==0,k}let I=[];function S(k,E,_){!h&&E<a&&_>s&&n.substring(E,_)!==k&&I.push({offset:E,length:_-E,content:k})}let T=y();if(T!==17){let k=p.getTokenOffset()+o,E=bu(f,r);S(E,o,k)}for(;T!==17;){let k=p.getTokenOffset()+p.getTokenLength()+o,E=y(),_="";for(;!c&&(E===12||E===13);){let A=p.getTokenOffset()+o;S(" ",k,A),k=p.getTokenOffset()+p.getTokenLength()+o,_=E===12?v():"",E=y()}if(E===2)T!==1&&(u--,_=v());else if(E===4)T!==3&&(u--,_=v());else{switch(T){case 3:case 1:u++,_=v();break;case 5:case 12:_=v();break;case 13:c?_=v():_=" ";break;case 6:_=" ";break;case 10:if(E===6){_="";break}case 7:case 8:case 9:case 11:case 2:case 4:E===12||E===13?_=" ":E!==5&&E!==17&&(h=!0);break;case 16:h=!0;break}c&&(E===12||E===13)&&(_=v())}let N=p.getTokenOffset()+o;S(_,k,N),T=E}return I}function bu(n,t){let e="";for(let r=0;r<t;r++)e+=n;return e}function Z1(n,t){let e=0,r=0,i=t.tabSize||4;for(;e<n.length;){let o=n.charAt(e);if(o===" ")r++;else if(o==="	")r+=i;else break;e++}return Math.floor(r/i)}function ev(n,t){for(let e=0;e<t.length;e++){let r=t.charAt(e);if(r==="\r")return e+1<t.length&&t.charAt(e+1)===`
`?`\r
`:"\r";if(r===`
`)return`
`}return n&&n.eol||`
`}function Xo(n,t){return`\r
`.indexOf(n.charAt(t))!==-1}function Wp(n,t,e,r,i){let o=t.slice(),a=Mp(n,[]),l,c;for(;o.length>0&&(c=o.pop(),l=vu(a,o),l===void 0&&e!==void 0);)typeof c=="string"?e={[c]:e}:e=[e];if(l)if(l.type==="object"&&typeof c=="string"&&Array.isArray(l.children)){let u=vu(l,[c]);if(u!==void 0)if(e===void 0){if(!u.parent)throw new Error("Malformed AST");let f=l.children.indexOf(u.parent),p,h=u.parent.offset+u.parent.length;if(f>0){let v=l.children[f-1];p=v.offset+v.length}else p=l.offset+1,l.children.length>1&&(h=l.children[1].offset);return Ei(n,{offset:p,length:h-p,content:""},r)}else return Ei(n,{offset:u.offset,length:u.length,content:JSON.stringify(e)},r);else{if(e===void 0)return[];let f=`${JSON.stringify(c)}: ${JSON.stringify(e)}`,p=i?i(l.children.map(v=>v.children[0].value)):l.children.length,h;if(p>0){let v=l.children[p-1];h={offset:v.offset+v.length,length:0,content:","+f}}else l.children.length===0?h={offset:l.offset+1,length:0,content:f}:h={offset:l.offset+1,length:0,content:f+","};return Ei(n,h,r)}}else if(l.type==="array"&&typeof c=="number"&&Array.isArray(l.children))if(e!==void 0){let u=`${JSON.stringify(e)}`,f;if(l.children.length===0||c===0)f={offset:l.offset+1,length:0,content:l.children.length===0?u:u+","};else{let p=c===-1||c>l.children.length?l.children.length:c,h=l.children[p-1];f={offset:h.offset+h.length,length:0,content:","+u}}return Ei(n,f,r)}else{let u=c,f=l.children[u],p;if(l.children.length===1)p={offset:l.offset+1,length:l.length-2,content:""};else if(l.children.length-1===u){let h=l.children[u-1],v=h.offset+h.length,y=l.offset+l.length;p={offset:v,length:y-2-v,content:""}}else p={offset:f.offset,length:l.children[u+1].offset-f.offset,content:""};return Ei(n,p,r)}else throw new Error(`Can not add ${typeof c!="number"?"index":"property"} to parent of type ${l.type}`);else return e===void 0?[]:Ei(n,{offset:a?a.offset:0,length:a?a.length:0,content:JSON.stringify(e)},r)}function Ei(n,t,e){let r=Iu(n,t),i=t.offset,o=t.offset+t.content.length;if(t.length===0||t.content.length===0){for(;i>0&&!Xo(r,i-1);)i--;for(;o<r.length&&!Xo(r,o);)o++}let s=Vp(r,{offset:i,length:o-i},e);for(let l=s.length-1;l>=0;l--){let c=s[l];r=Iu(r,c),i=Math.min(i,c.offset),o=Math.max(o,c.offset+c.length),o+=c.content.length-c.length}let a=n.length-(r.length-o)-i;return[{offset:i,length:a,content:r.substring(i,o)}]}function Iu(n,t){return n.substring(0,t.offset)+t.content+n.substring(t.offset+t.length)}function Kp(n,t){let e=t.slice(0).sort((i,o)=>{let s=i.offset-o.offset;return s===0?i.length-o.length:s}),r=n.length;for(let i=e.length-1;i>=0;i--){let o=e[i];if(o.offset+o.length<=r)n=Iu(n,o);else throw new Error("Overlapping edit");r=o.offset}return n}function Rn(n){if(!n||typeof n!="object"||n instanceof RegExp)return n;let t=Array.isArray(n)?[]:{};return Object.entries(n).forEach(([e,r])=>{t[e]=r&&typeof r=="object"?Rn(r):r}),t}function Bp(n){if(!n||typeof n!="object")return n;let t=[n];for(;t.length>0;){let e=t.shift();Object.freeze(e);for(let r in e)if(tv.call(e,r)){let i=e[r];typeof i=="object"&&!Object.isFrozen(i)&&!Wf(i)&&t.push(i)}}return n}var tv=Object.prototype.hasOwnProperty;function Ct(n,t){if(n===t)return!0;if(n==null||t===null||t===void 0||typeof n!=typeof t||typeof n!="object"||Array.isArray(n)!==Array.isArray(t))return!1;let e,r;if(Array.isArray(n)){if(n.length!==t.length)return!1;for(e=0;e<n.length;e++)if(!Ct(n[e],t[e]))return!1}else{let i=[];for(r in n)i.push(r);i.sort();let o=[];for(r in t)o.push(r);if(o.sort(),!Ct(i,o))return!1;for(e=0;e<i.length;e++)if(!Ct(n[i[e]],t[i[e]]))return!1}return!0}var xu=class{_value="";_pos=0;reset(t){return this._value=t,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(t){let e=t.charCodeAt(0),r=this._value.charCodeAt(this._pos);return e-r}value(){return this._value[this._pos]}},Eu=class{constructor(t=!0){this._caseSensitive=t}_value;_from;_to;reset(t){return this._value=t,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let t=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(t)this._from++;else break;else t=!1;return this}cmp(t){return this._caseSensitive?aa(t,this._value,0,t.length,this._from,this._to):gi(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},Aa=class{constructor(t=!0,e=!0){this._splitOnBackslash=t;this._caseSensitive=e}_value;_valueLen;_from;_to;reset(t){this._from=0,this._to=0,this._value=t,this._valueLen=t.length;for(let e=t.length-1;e>=0;e--,this._valueLen--){let r=this._value.charCodeAt(e);if(!(r===47||this._splitOnBackslash&&r===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let t=!0;for(;this._to<this._valueLen;this._to++){let e=this._value.charCodeAt(this._to);if(e===47||this._splitOnBackslash&&e===92)if(t)this._from++;else break;else t=!1}return this}cmp(t){return this._caseSensitive?aa(t,this._value,0,t.length,this._from,this._to):gi(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}};var Su=class{constructor(t,e){this._ignorePathCasing=t;this._ignoreQueryAndFragment=e}_pathIterator;_value;_states=[];_stateIdx=0;reset(t){return this._value=t,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new Aa(!1,!this._ignorePathCasing(t)),this._pathIterator.reset(t.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(t)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(t){if(this._states[this._stateIdx]===1)return Oo(t,this._value.scheme);if(this._states[this._stateIdx]===2)return Oo(t,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(t);if(this._states[this._stateIdx]===4)return ko(t,this._value.query);if(this._states[this._stateIdx]===5)return ko(t,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}},Si=class{height=1;segment;value;key;left;mid;right;isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){let t=this.right;return this.right=t.left,t.left=this,this.updateHeight(),t.updateHeight(),t}rotateRight(){let t=this.left;return this.left=t.right,t.right=this,this.updateHeight(),t.updateHeight(),t}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}};var $n=class n{static forUris(t=()=>!1,e=()=>!1){return new n(new Su(t,e))}static forPaths(t=!1){return new n(new Aa(void 0,!t))}static forStrings(){return new n(new xu)}static forConfigKeys(){return new n(new Eu)}_iter;_root;constructor(t){this._iter=t}clear(){this._root=void 0}fill(t,e){if(e){let r=e.slice(0);Lc(r);for(let i of r)this.set(i,t)}else{let r=t.slice(0);Lc(r);for(let i of r)this.set(i[0],i[1])}}set(t,e){let r=this._iter.reset(t),i;this._root||(this._root=new Si,this._root.segment=r.value());let o=[];for(i=this._root;;){let a=r.cmp(i.segment);if(a>0)i.left||(i.left=new Si,i.left.segment=r.value()),o.push([-1,i]),i=i.left;else if(a<0)i.right||(i.right=new Si,i.right.segment=r.value()),o.push([1,i]),i=i.right;else if(r.hasNext())r.next(),i.mid||(i.mid=new Si,i.mid.segment=r.value()),o.push([0,i]),i=i.mid;else break}let s=i.value;i.value=e,i.key=t;for(let a=o.length-1;a>=0;a--){let l=o[a][1];l.updateHeight();let c=l.balanceFactor();if(c<-1||c>1){let u=o[a][0],f=o[a+1][0];if(u===1&&f===1)o[a][1]=l.rotateLeft();else if(u===-1&&f===-1)o[a][1]=l.rotateRight();else if(u===1&&f===-1)l.right=o[a+1][1]=o[a+1][1].rotateRight(),o[a][1]=l.rotateLeft();else if(u===-1&&f===1)l.left=o[a+1][1]=o[a+1][1].rotateLeft(),o[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(o[a-1][0]){case-1:o[a-1][1].left=o[a][1];break;case 1:o[a-1][1].right=o[a][1];break;case 0:o[a-1][1].mid=o[a][1];break}else this._root=o[0][1]}}return s}get(t){return this._getNode(t)?.value}_getNode(t){let e=this._iter.reset(t),r=this._root;for(;r;){let i=e.cmp(r.segment);if(i>0)r=r.left;else if(i<0)r=r.right;else if(e.hasNext())e.next(),r=r.mid;else break}return r}has(t){let e=this._getNode(t);return!(e?.value===void 0&&e?.mid===void 0)}delete(t){return this._delete(t,!1)}deleteSuperstr(t){return this._delete(t,!0)}_delete(t,e){let r=this._iter.reset(t),i=[],o=this._root;for(;o;){let s=r.cmp(o.segment);if(s>0)i.push([-1,o]),o=o.left;else if(s<0)i.push([1,o]),o=o.right;else if(r.hasNext())r.next(),i.push([0,o]),o=o.mid;else break}if(o){if(e?(o.left=void 0,o.mid=void 0,o.right=void 0,o.height=1):(o.key=void 0,o.value=void 0),!o.mid&&!o.value)if(o.left&&o.right){let s=this._min(o.right);if(s.key){let{key:a,value:l,segment:c}=s;this._delete(s.key,!1),o.key=a,o.value=l,o.segment=c}}else{let s=o.left??o.right;if(i.length>0){let[a,l]=i[i.length-1];switch(a){case-1:l.left=s;break;case 0:l.mid=s;break;case 1:l.right=s;break}}else this._root=s}for(let s=i.length-1;s>=0;s--){let a=i[s][1];a.updateHeight();let l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),i[s][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),i[s][1]=a.rotateRight()),s>0)switch(i[s-1][0]){case-1:i[s-1][1].left=i[s][1];break;case 1:i[s-1][1].right=i[s][1];break;case 0:i[s-1][1].mid=i[s][1];break}else this._root=i[0][1]}}}_min(t){for(;t.left;)t=t.left;return t}findSubstr(t){let e=this._iter.reset(t),r=this._root,i;for(;r;){let o=e.cmp(r.segment);if(o>0)r=r.left;else if(o<0)r=r.right;else if(e.hasNext())e.next(),i=r.value||i,r=r.mid;else break}return r&&r.value||i}findSuperstr(t){return this._findSuperstrOrElement(t,!1)}_findSuperstrOrElement(t,e){let r=this._iter.reset(t),i=this._root;for(;i;){let o=r.cmp(i.segment);if(o>0)i=i.left;else if(o<0)i=i.right;else if(r.hasNext())r.next(),i=i.mid;else return i.mid?this._entries(i.mid):e?i.value:void 0}}hasElementOrSubtree(t){return this._findSuperstrOrElement(t,!0)!==void 0}forEach(t){for(let[e,r]of this)t(r,e)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(t){let e=[];return this._dfsEntries(t,e),e[Symbol.iterator]()}_dfsEntries(t,e){t&&(t.left&&this._dfsEntries(t.left,e),t.value&&e.push([t.key,t.value]),t.mid&&this._dfsEntries(t.mid,e),t.right&&this._dfsEntries(t.right,e))}_isBalanced(){let t=e=>{if(!e)return!0;let r=e.balanceFactor();return r<-1||r>1?!1:t(e.left)&&t(e.right)};return t(this._root)}};var m4=$("contextService");function Fa(n){let t=n;return typeof t?.id=="string"&&P.isUri(t.uri)}function La(n){let t=n;return typeof t?.id=="string"&&P.isUri(t.configPath)}var $p="code-workspace",y4=`.${$p}`,v4=[{name:g("codeWorkspace","Code Workspace"),extensions:[$p]}];var gn=$("configurationService");function Ua(n){return n&&typeof n=="object"&&(!n.overrideIdentifier||typeof n.overrideIdentifier=="string")&&(!n.resource||n.resource instanceof P)}function zp(n){return n&&typeof n=="object"&&(!n.overrideIdentifiers||Array.isArray(n.overrideIdentifiers))&&!n.overrideIdentifier&&(!n.resource||n.resource instanceof P)}function Na(n,t){let e=Object.create(null);for(let r in n)wu(e,r,n[r],t);return e}function wu(n,t,e,r){let i=t.split("."),o=i.pop(),s=n;for(let a=0;a<i.length;a++){let l=i[a],c=s[l];switch(typeof c){case"undefined":c=s[l]=Object.create(null);break;case"object":if(c===null){r(`Ignoring ${t} as ${i.slice(0,a+1).join(".")} is null`);return}break;default:r(`Ignoring ${t} as ${i.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}s=c}if(typeof s=="object"&&s!==null)try{s[o]=e}catch{r(`Ignoring ${t} as ${i.join(".")} is ${JSON.stringify(s)}`)}else r(`Ignoring ${t} as ${i.join(".")} is ${JSON.stringify(s)}`)}function jp(n,t){let e=t.split(".");Gp(n,e)}function Gp(n,t){let e=t.shift();if(t.length===0){delete n[e];return}if(Object.keys(n).indexOf(e)!==-1){let r=n[e];typeof r=="object"&&!Array.isArray(r)&&(Gp(r,t),Object.keys(r).length===0&&delete n[e])}}function Yo(n,t,e){function r(s,a){let l=s;for(let c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}let i=t.split("."),o=r(n,i);return typeof o>"u"?e:o}function Hp(n){return n.replace(/[\[\]]/g,"")}var Tu=class{data=new Map;add(t,e){Vs(be(t)),Vs($e(e)),Vs(!this.data.has(t),"There is already an extension with this id"),this.data.set(t,e)}knows(t){return this.data.has(t)}as(t){return this.data.get(t)||null}},et=new Tu;var _u={JSONContribution:"base.contributions.json"};function rv(n){return n.length>0&&n.charAt(n.length-1)==="#"?n.substring(0,n.length-1):n}var Pu=class{schemasById;_onDidChangeSchema=new C;onDidChangeSchema=this._onDidChangeSchema.event;constructor(){this.schemasById={}}registerSchema(t,e){this.schemasById[rv(t)]=e,this._onDidChangeSchema.fire(t)}notifySchemaChanged(t){this._onDidChangeSchema.fire(t)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(t){let e=this.schemasById[t];return e?Ep(e):void 0}hasSchemaContent(t){return!!this.schemasById[t]}},iv=new Pu;et.add(_u.JSONContribution,iv);var Qp=$("policy");var wi=class{_serviceBrand;onDidChange=Z.None;async updatePolicyDefinitions(){return{}}getPolicyValue(){}serialize(){}};var en={Configuration:"base.contributions.configuration"};var Ma={properties:{},patternProperties:{}},Va={properties:{},patternProperties:{}},Wa={properties:{},patternProperties:{}},Ka={properties:{},patternProperties:{}},Ba={properties:{},patternProperties:{}},Zo={properties:{},patternProperties:{}},Kr="vscode://schemas/settings/resourceLanguage";var qa=et.as(_u.JSONContribution),Ru=class{registeredConfigurationDefaults=[];configurationDefaultsOverrides;defaultLanguageConfigurationOverridesNode;configurationContributors;configurationProperties;policyConfigurations;excludedConfigurationProperties;resourceLanguageSettingsSchema;overrideIdentifiers=new Set;_onDidSchemaChange=new C;onDidSchemaChange=this._onDidSchemaChange.event;_onDidUpdateConfiguration=new C;onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;constructor(){this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:g("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},qa.registerSchema(Kr,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(t,e=!0){this.registerConfigurations([t],e)}registerConfigurations(t,e=!0){let r=new Set;this.doRegisterConfigurations(t,e,r),qa.registerSchema(Kr,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:r})}deregisterConfigurations(t){let e=new Set;this.doDeregisterConfigurations(t,e),qa.registerSchema(Kr,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e})}updateConfigurations({add:t,remove:e}){let r=new Set;this.doDeregisterConfigurations(e,r),this.doRegisterConfigurations(t,!1,r),qa.registerSchema(Kr,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:r})}registerDefaultConfigurations(t){let e=new Set;this.doRegisterDefaultConfigurations(t,e),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e,defaultsOverrides:!0})}doRegisterDefaultConfigurations(t,e){this.registeredConfigurationDefaults.push(...t);let r=[];for(let{overrides:i,source:o}of t)for(let s in i){e.add(s);let a=this.configurationDefaultsOverrides.get(s)??this.configurationDefaultsOverrides.set(s,{configurationDefaultOverrides:[]}).get(s),l=i[s];if(a.configurationDefaultOverrides.push({value:l,source:o}),Cn.test(s)){let c=this.mergeDefaultConfigurationsForOverrideIdentifier(s,l,o,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(s,c,o),r.push(...Ti(s))}else{let c=this.mergeDefaultConfigurationsForConfigurationProperty(s,l,o,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;let u=this.configurationProperties[s];u&&(this.updatePropertyDefaultValue(s,u),this.updateSchema(s,u))}}this.doRegisterOverrideIdentifiers(r)}deregisterDefaultConfigurations(t){let e=new Set;this.doDeregisterDefaultConfigurations(t,e),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(t,e){for(let r of t){let i=this.registeredConfigurationDefaults.indexOf(r);i!==-1&&this.registeredConfigurationDefaults.splice(i,1)}for(let{overrides:r,source:i}of t)for(let o in r){let s=this.configurationDefaultsOverrides.get(o);if(!s)continue;let a=s.configurationDefaultOverrides.findIndex(l=>i?l.source?.id===i.id:l.value===r[o]);if(a!==-1){if(s.configurationDefaultOverrides.splice(a,1),s.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(o),Cn.test(o)){let l;for(let c of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(o,c.value,c.source,l);l&&!di(l.value)?(s.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(o,l,i)):(this.configurationDefaultsOverrides.delete(o),delete this.configurationProperties[o],delete this.defaultLanguageConfigurationOverridesNode.properties[o])}else{let l;for(let u of s.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(o,u.value,u.source,l);s.configurationDefaultOverrideValue=l;let c=this.configurationProperties[o];c&&(this.updatePropertyDefaultValue(o,c),this.updateSchema(o,c))}e.add(o)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(t,e,r){let i={type:"object",default:e.value,description:g("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",Hp(t)),$ref:Kr,defaultDefaultValue:e.value,source:r,defaultValueSource:r};this.configurationProperties[t]=i,this.defaultLanguageConfigurationOverridesNode.properties[t]=i}mergeDefaultConfigurationsForOverrideIdentifier(t,e,r,i){let o=i?.value||{},s=i?.source??new Map;if(!(s instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(let a of Object.keys(e)){let l=e[a];if($e(l)&&(Yt(o[a])||$e(o[a]))){if(o[a]={...o[a]??{},...l},r)for(let u in l)s.set(`${a}.${u}`,r)}else o[a]=l,r?s.set(a,r):s.delete(a)}return{value:o,source:s}}mergeDefaultConfigurationsForConfigurationProperty(t,e,r,i){let o=this.configurationProperties[t],s=i?.value??o?.defaultDefaultValue,a=r;if($e(e)&&(o!==void 0&&o.type==="object"||o===void 0&&(Yt(s)||$e(s)))){if(a=i?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(let c in e)r&&a.set(`${t}.${c}`,r);e={...$e(s)?s:{},...e}}return{value:e,source:a}}deltaConfiguration(t){let e=!1,r=new Set;t.removedDefaults&&(this.doDeregisterDefaultConfigurations(t.removedDefaults,r),e=!0),t.addedDefaults&&(this.doRegisterDefaultConfigurations(t.addedDefaults,r),e=!0),t.removedConfigurations&&this.doDeregisterConfigurations(t.removedConfigurations,r),t.addedConfigurations&&this.doRegisterConfigurations(t.addedConfigurations,!1,r),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:r,defaultsOverrides:e})}notifyConfigurationSchemaUpdated(...t){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(t){this.doRegisterOverrideIdentifiers(t),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(t){for(let e of t)this.overrideIdentifiers.add(e);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(t,e,r){t.forEach(i=>{this.validateAndRegisterProperties(i,e,i.extensionInfo,i.restrictedProperties,void 0,r),this.configurationContributors.push(i),this.registerJSONConfiguration(i)})}doDeregisterConfigurations(t,e){let r=i=>{if(i.properties)for(let o in i.properties){e.add(o);let s=this.configurationProperties[o];s?.policy?.name&&this.policyConfigurations.delete(s.policy.name),delete this.configurationProperties[o],this.removeFromSchema(o,i.properties[o])}i.allOf?.forEach(o=>r(o))};for(let i of t){r(i);let o=this.configurationContributors.indexOf(i);o!==-1&&this.configurationContributors.splice(o,1)}}validateAndRegisterProperties(t,e=!0,r,i,o=3,s){o=Ye(t.scope)?o:t.scope;let a=t.properties;if(a)for(let c in a){let u=a[c];if(e&&sv(c,u)){delete a[c];continue}if(u.source=r,u.defaultDefaultValue=a[c].default,this.updatePropertyDefaultValue(c,u),Cn.test(c)?u.scope=void 0:(u.scope=Ye(u.scope)?o:u.scope,u.restricted=Ye(u.restricted)?!!i?.includes(c):u.restricted),a[c].hasOwnProperty("included")&&!a[c].included){this.excludedConfigurationProperties[c]=a[c],delete a[c];continue}else this.configurationProperties[c]=a[c],a[c].policy?.name&&this.policyConfigurations.set(a[c].policy.name,c);!a[c].deprecationMessage&&a[c].markdownDeprecationMessage&&(a[c].deprecationMessage=a[c].markdownDeprecationMessage),s.add(c)}let l=t.allOf;if(l)for(let c of l)this.validateAndRegisterProperties(c,e,r,i,o,s)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let t=new Map;for(let[e,r]of this.configurationDefaultsOverrides)r.configurationDefaultOverrideValue&&t.set(e,r.configurationDefaultOverrideValue);return t}registerJSONConfiguration(t){let e=r=>{let i=r.properties;if(i)for(let s in i)this.updateSchema(s,i[s]);r.allOf?.forEach(e)};e(t)}updateSchema(t,e){switch(Ma.properties[t]=e,e.scope){case 1:Va.properties[t]=e;break;case 2:Wa.properties[t]=e;break;case 6:Ka.properties[t]=e;break;case 3:Ba.properties[t]=e;break;case 4:Zo.properties[t]=e;break;case 5:Zo.properties[t]=e,this.resourceLanguageSettingsSchema.properties[t]=e;break}}removeFromSchema(t,e){switch(delete Ma.properties[t],e.scope){case 1:delete Va.properties[t];break;case 2:delete Wa.properties[t];break;case 6:delete Ka.properties[t];break;case 3:delete Ba.properties[t];break;case 4:case 5:delete Zo.properties[t],delete this.resourceLanguageSettingsSchema.properties[t];break}}updateOverridePropertyPatternKey(){for(let t of this.overrideIdentifiers.values()){let e=`[${t}]`,r={type:"object",description:g("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:g("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Kr};this.updatePropertyDefaultValue(e,r),Ma.properties[e]=r,Va.properties[e]=r,Wa.properties[e]=r,Ka.properties[e]=r,Ba.properties[e]=r,Zo.properties[e]=r}}registerOverridePropertyPatternKey(){let t={type:"object",description:g("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:g("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:Kr};Ma.patternProperties[Br]=t,Va.patternProperties[Br]=t,Wa.patternProperties[Br]=t,Ka.patternProperties[Br]=t,Ba.patternProperties[Br]=t,Zo.patternProperties[Br]=t,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(t,e){let r=this.configurationDefaultsOverrides.get(t)?.configurationDefaultOverrideValue,i,o;r&&(!e.disallowConfigurationDefault||!r.source)&&(i=r.value,o=r.source),Yt(i)&&(i=e.defaultDefaultValue,o=void 0),Yt(i)&&(i=ov(e.type)),e.default=i,e.defaultValueSource=o}},Xp="\\[([^\\]]+)\\]",Jp=new RegExp(Xp,"g"),Br=`^(${Xp})+$`,Cn=new RegExp(Br);function Ti(n){let t=[];if(Cn.test(n)){let e=Jp.exec(n);for(;e?.length;){let r=e[1].trim();r&&t.push(r),e=Jp.exec(n)}}return Nt(t)}function Yp(n){return n.reduce((t,e)=>`${t}[${e}]`,"")}function ov(n){switch(Array.isArray(n)?n[0]:n){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var $a=new Ru;et.add(en.Configuration,$a);function sv(n,t){return n.trim()?Cn.test(n)?g("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",n):$a.getConfigurationProperties()[n]!==void 0?g("config.property.duplicate","Cannot register '{0}'. This property is already registered.",n):t.policy?.name&&$a.getPolicyConfigurations().get(t.policy?.name)!==void 0?g("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",n,t.policy?.name,$a.getPolicyConfigurations().get(t.policy?.name)):null:g("config.property.empty","Cannot register an empty property")}var Pi="**",Zp="/",za="[/\\\\]",ja="[^/\\\\]",av=/\//g;function eg(n,t){switch(n){case 0:return"";case 1:return`${ja}*?`;default:return`(?:${za}|${ja}+${za}${t?`|${za}${ja}+`:""})*?`}}function tg(n,t){if(!n)return[];let e=[],r=!1,i=!1,o="";for(let s of n){switch(s){case t:if(!r&&!i){e.push(o),o="";continue}break;case"{":r=!0;break;case"}":r=!1;break;case"[":i=!0;break;case"]":i=!1;break}o+=s}return o&&e.push(o),e}function sg(n){if(!n)return"";let t="",e=tg(n,Zp);if(e.every(r=>r===Pi))t=".*";else{let r=!1;e.forEach((i,o)=>{if(i===Pi){if(r)return;t+=eg(2,o===e.length-1)}else{let s=!1,a="",l=!1,c="";for(let u of i){if(u!=="}"&&s){a+=u;continue}if(l&&(u!=="]"||!c)){let f;u==="-"?f=u:(u==="^"||u==="!")&&!c?f="^":u===Zp?f="":f=pi(u),c+=f;continue}switch(u){case"{":s=!0;continue;case"[":l=!0;continue;case"}":{let p=`(?:${tg(a,",").map(h=>sg(h)).join("|")})`;t+=p,s=!1,a="";break}case"]":{t+="["+c+"]",l=!1,c="";break}case"?":t+=ja;continue;case"*":t+=eg(1);continue;default:t+=pi(u)}}o<e.length-1&&(e[o+1]!==Pi||o+2<e.length)&&(t+=za)}r=i===Pi})}return t}var lv=/^\*\*\/\*\.[\w\.-]+$/,cv=/^\*\*\/([\w\.-]+)\/?$/,uv=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,dv=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,fv=/^\*\*((\/[\w\.-]+)+)\/?$/,pv=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,ng=new Wn(1e4),rg=function(){return!1},Dn=function(){return null};function Du(n,t){if(!n)return Dn;let e;typeof n!="string"?e=n.pattern:e=n,e=e.trim();let r=`${e}_${!!t.trimForExclusions}`,i=ng.get(r);if(i)return ig(i,n);let o;return lv.test(e)?i=gv(e.substr(4),e):(o=cv.exec(Cu(e,t)))?i=hv(o[1],e):(t.trimForExclusions?dv:uv).test(e)?i=mv(e,t):(o=fv.exec(Cu(e,t)))?i=og(o[1].substr(1),e,!0):(o=pv.exec(Cu(e,t)))?i=og(o[1],e,!1):i=yv(e),ng.set(r,i),ig(i,n)}function ig(n,t){if(typeof t=="string")return n;let e=function(r,i){return Bn(r,t.base,!Se)?n(Qc(r.substr(t.base.length),Ve),i):null};return e.allBasenames=n.allBasenames,e.allPaths=n.allPaths,e.basenames=n.basenames,e.patterns=n.patterns,e}function Cu(n,t){return t.trimForExclusions&&n.endsWith("/**")?n.substr(0,n.length-2):n}function gv(n,t){return function(e,r){return typeof e=="string"&&e.endsWith(n)?t:null}}function hv(n,t){let e=`/${n}`,r=`\\${n}`,i=function(s,a){return typeof s!="string"?null:a?a===n?t:null:s===n||s.endsWith(e)||s.endsWith(r)?t:null},o=[n];return i.basenames=o,i.patterns=[t],i.allBasenames=o,i}function mv(n,t){let e=lg(n.slice(1,-1).split(",").map(a=>Du(a,t)).filter(a=>a!==Dn),n),r=e.length;if(!r)return Dn;if(r===1)return e[0];let i=function(a,l){for(let c=0,u=e.length;c<u;c++)if(e[c](a,l))return n;return null},o=e.find(a=>!!a.allBasenames);o&&(i.allBasenames=o.allBasenames);let s=e.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function og(n,t,e){let r=Ve===oe.sep,i=r?n:n.replace(av,Ve),o=Ve+i,s=oe.sep+n,a;return e?a=function(l,c){return typeof l=="string"&&(l===i||l.endsWith(o)||!r&&(l===n||l.endsWith(s)))?t:null}:a=function(l,c){return typeof l=="string"&&(l===i||!r&&l===n)?t:null},a.allPaths=[(e?"*/":"./")+n],a}function yv(n){try{let t=new RegExp(`^${sg(n)}$`);return function(e){return t.lastIndex=0,typeof e=="string"&&t.test(e)?n:null}}catch{return Dn}}function ag(n,t={}){if(!n)return rg;if(typeof n=="string"||vv(n)){let e=Du(n,t);if(e===Dn)return rg;let r=function(i,o){return!!e(i,o)};return e.allBasenames&&(r.allBasenames=e.allBasenames),e.allPaths&&(r.allPaths=e.allPaths),r}return bv(n,t)}function vv(n){let t=n;return t?typeof t.base=="string"&&typeof t.pattern=="string":!1}function bv(n,t){let e=lg(Object.getOwnPropertyNames(n).map(a=>Iv(a,n[a],t)).filter(a=>a!==Dn)),r=e.length;if(!r)return Dn;if(!e.some(a=>!!a.requiresSiblings)){if(r===1)return e[0];let a=function(u,f){let p;for(let h=0,v=e.length;h<v;h++){let y=e[h](u,f);if(typeof y=="string")return y;wa(y)&&(p||(p=[]),p.push(y))}return p?(async()=>{for(let h of p){let v=await h;if(typeof v=="string")return v}return null})():null},l=e.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);let c=e.reduce((u,f)=>f.allPaths?u.concat(f.allPaths):u,[]);return c.length&&(a.allPaths=c),a}let i=function(a,l,c){let u,f;for(let p=0,h=e.length;p<h;p++){let v=e[p];v.requiresSiblings&&c&&(l||(l=je(a)),u||(u=l.substr(0,l.length-Bc(a).length)));let y=v(a,l,u,c);if(typeof y=="string")return y;wa(y)&&(f||(f=[]),f.push(y))}return f?(async()=>{for(let p of f){let h=await p;if(typeof h=="string")return h}return null})():null},o=e.find(a=>!!a.allBasenames);o&&(i.allBasenames=o.allBasenames);let s=e.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return s.length&&(i.allPaths=s),i}function Iv(n,t,e){if(t===!1)return Dn;let r=Du(n,e);if(r===Dn)return Dn;if(typeof t=="boolean")return r;if(t){let i=t.when;if(typeof i=="string"){let o=(s,a,l,c)=>{if(!c||!r(s,a))return null;let u=i.replace("$(basename)",()=>l),f=c(u);return wa(f)?f.then(p=>p?n:null):f?n:null};return o.requiresSiblings=!0,o}}return r}function lg(n,t){let e=n.filter(a=>!!a.basenames);if(e.length<2)return n;let r=e.reduce((a,l)=>{let c=l.basenames;return c?a.concat(c):a},[]),i;if(t){i=[];for(let a=0,l=r.length;a<l;a++)i.push(t)}else i=e.reduce((a,l)=>{let c=l.patterns;return c?a.concat(c):a},[]);let o=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){let f=a.charCodeAt(u-1);if(f===47||f===92)break}l=a.substr(u)}let c=r.indexOf(l);return c!==-1?i[c]:null};o.basenames=r,o.patterns=i,o.allBasenames=r;let s=n.filter(a=>!a.basenames);return s.push(o),s}function ku(n,t){return sn(n,t,(e,r)=>typeof e=="string"&&typeof r=="string"?e===r:typeof e!="string"&&typeof r!="string"?e.base===r.base&&e.pattern===r.pattern:!1)}var c_=new Uint32Array(10);var u_=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),d_=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),f_=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),p_=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function cg(...n){return function(t,e){for(let r=0,i=n.length;r<i;r++){let o=n[r](t,e);if(o)return o}return null}}var x_=ug.bind(void 0,!1),Fu=ug.bind(void 0,!0);function ug(n,t,e){if(!e||e.length<t.length)return null;let r;return n?r=Or(e,t):r=e.indexOf(t)===0,r?t.length>0?[{start:0,end:t.length}]:[]:null}function xv(n,t){let e=t.toLowerCase().indexOf(n.toLowerCase());return e===-1?null:[{start:e,end:e+n.length}]}function Ev(n,t){return Ou(n.toLowerCase(),t.toLowerCase(),0,0)}function Ou(n,t,e,r){if(e===n.length)return[];if(r===t.length)return null;if(n[e]===t[r]){let i=null;return(i=Ou(n,t,e+1,r+1))?fg({start:r,end:r+1},i):null}return Ou(n,t,e,r+1)}function Lu(n){return 97<=n&&n<=122}function es(n){return 65<=n&&n<=90}function Uu(n){return 48<=n&&n<=57}function Sv(n){return n===32||n===9||n===10||n===13}var wv=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(n=>wv.add(n.charCodeAt(0)));function dg(n){return Lu(n)||es(n)||Uu(n)}function fg(n,t){return t.length===0?t=[n]:n.end===t[0].start?t[0].start=n.start:t.unshift(n),t}function pg(n,t){for(let e=t;e<n.length;e++){let r=n.charCodeAt(e);if(es(r)||Uu(r)||e>0&&!dg(n.charCodeAt(e-1)))return e}return n.length}function Au(n,t,e,r){if(e===n.length)return[];if(r===t.length)return null;if(n[e]!==t[r].toLowerCase())return null;{let i=null,o=r+1;for(i=Au(n,t,e+1,r+1);!i&&(o=pg(t,o))<t.length;)i=Au(n,t,e+1,o),o++;return i===null?null:fg({start:r,end:r+1},i)}}function Tv(n){let t=0,e=0,r=0,i=0,o=0;for(let u=0;u<n.length;u++)o=n.charCodeAt(u),es(o)&&t++,Lu(o)&&e++,dg(o)&&r++,Uu(o)&&i++;let s=t/n.length,a=e/n.length,l=r/n.length,c=i/n.length;return{upperPercent:s,lowerPercent:a,alphaPercent:l,numericPercent:c}}function Pv(n){let{upperPercent:t,lowerPercent:e}=n;return e===0&&t>.6}function _v(n){let{upperPercent:t,lowerPercent:e,alphaPercent:r,numericPercent:i}=n;return e>.2&&t<.8&&r>.6&&i<.2}function Rv(n){let t=0,e=0,r=0,i=0;for(let o=0;o<n.length;o++)r=n.charCodeAt(o),es(r)&&t++,Lu(r)&&e++,Sv(r)&&i++;return(t===0||e===0)&&i===0?n.length<=30:t<=5}function gg(n,t){if(!t||(t=t.trim(),t.length===0)||!Rv(n))return null;t.length>60&&(t=t.substring(0,60));let e=Tv(t);if(!_v(e)){if(!Pv(e))return null;t=t.toLowerCase()}let r=null,i=0;for(n=n.toLowerCase();i<t.length&&(r=Au(n,t,0,i))===null;)i=pg(t,i+1);return r}var E_=cg(Fu,gg,xv),S_=cg(Fu,gg,Ev),w_=new Wn(1e4);var Ga=128;function Nu(){let n=[],t=[];for(let e=0;e<=Ga;e++)t[e]=0;for(let e=0;e<=Ga;e++)n.push(t.slice(0));return n}function hg(n){let t=[];for(let e=0;e<=n;e++)t[e]=0;return t}var T_=hg(2*Ga),P_=hg(2*Ga),__=Nu(),R_=Nu(),C_=Nu();var Cv;(e=>{e.Default=[-100,0];function t(r){return!r||r.length===2&&r[0]===-100&&r[1]===0}e.isDefault=t})(Cv||={});var Mu=new RegExp(`\\$\\(${zo.iconNameExpression}(?:${zo.iconModifierExpression})?\\)`,"g"),U_=new RegExp(`(\\\\)?${Mu.source}`,"g");var N_=new RegExp(`\\\\${Mu.source}`,"g");var M_=new RegExp(`(\\s)?(\\\\)?${Mu.source}(\\s)?`,"g");var V_=new RegExp(`\\$\\(${zo.iconNameCharacter}+\\)`,"g");var pe=$("fileService");function Di(n){return n.create===!0}function $t(n){return!!(n.capabilities&2)}function Vu(n){return!!(n.capabilities&8)}function mg(n){return!!(n.capabilities&131072)}function jn(n){return!!(n.capabilities&4)}function Ja(n){return!!(n.capabilities&16)}function Xa(n){return $t(n)?!!(n.capabilities&16384):!1}function Wu(n){return $t(n)?!!(n.capabilities&32768):!1}function yg(n){return!!(n.capabilities&65536)}var _i=class n extends Error{constructor(e,r){super(e);this.code=r}static create(e,r){let i=new n(e.toString(),r);return Dv(i,r),i}};function hn(n,t){return _i.create(n,t)}function Gn(n){return n||hn(g("unknownError","Unknown Error"),"Unknown")}function Dv(n,t){return n.name=t?`${t} (FileSystemError)`:"FileSystemError",n}function ts(n){if(!n)return"Unknown";if(n instanceof _i)return n.code;let t=/^(.+) \(FileSystemError\)$/.exec(n.name);if(!t)return"Unknown";switch(t[1]){case"EntryExists":return"EntryExists";case"EntryIsADirectory":return"EntryIsADirectory";case"EntryNotADirectory":return"EntryNotADirectory";case"EntryNotFound":return"EntryNotFound";case"EntryTooLarge":return"EntryTooLarge";case"EntryWriteLocked":return"EntryWriteLocked";case"NoPermissions":return"NoPermissions";case"Unavailable":return"Unavailable"}return"Unknown"}function Ue(n){if(n instanceof tt)return n.fileOperationResult;switch(ts(n)){case"EntryNotFound":return 1;case"EntryIsADirectory":return 0;case"EntryNotADirectory":return 9;case"EntryWriteLocked":return 5;case"NoPermissions":return 6;case"EntryExists":return 4;case"EntryTooLarge":return 7;default:return 10}}var zn=class{constructor(t,e,r){this.resource=t;this.operation=e;this.target=r}isOperation(t){return this.operation===t}};var Ha=class n{constructor(t,e){this.ignorePathCasing=e;for(let r of t){switch(r.type){case 1:this.rawAdded.push(r.resource);break;case 0:this.rawUpdated.push(r.resource);break;case 2:this.rawDeleted.push(r.resource);break}this.correlationId!==n.MIXED_CORRELATION&&(typeof r.cId=="number"?this.correlationId===void 0?this.correlationId=r.cId:this.correlationId!==r.cId&&(this.correlationId=n.MIXED_CORRELATION):this.correlationId!==void 0&&(this.correlationId=n.MIXED_CORRELATION))}}static MIXED_CORRELATION=null;correlationId=void 0;added=new ht(()=>{let t=$n.forUris(()=>this.ignorePathCasing);return t.fill(this.rawAdded.map(e=>[e,!0])),t});updated=new ht(()=>{let t=$n.forUris(()=>this.ignorePathCasing);return t.fill(this.rawUpdated.map(e=>[e,!0])),t});deleted=new ht(()=>{let t=$n.forUris(()=>this.ignorePathCasing);return t.fill(this.rawDeleted.map(e=>[e,!0])),t});contains(t,...e){return this.doContains(t,{includeChildren:!1},...e)}affects(t,...e){return this.doContains(t,{includeChildren:!0},...e)}doContains(t,e,...r){if(!t)return!1;let i=r.length>0;return!!((!i||r.includes(1))&&(this.added.value.get(t)||e.includeChildren&&this.added.value.findSuperstr(t))||(!i||r.includes(0))&&(this.updated.value.get(t)||e.includeChildren&&this.updated.value.findSuperstr(t))||(!i||r.includes(2))&&(this.deleted.value.findSubstr(t)||e.includeChildren&&this.deleted.value.findSuperstr(t)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(t){return this.correlationId===t}hasCorrelation(){return typeof this.correlationId=="number"}rawAdded=[];rawUpdated=[];rawDeleted=[]};function vg(n,t,e){return!n||!t||n===t||t.length>n.length?!1:(t.charAt(t.length-1)!==Ve&&(t+=Ve),e?Or(n,t):n.indexOf(t)===0)}var tt=class extends Error{constructor(e,r,i){super(e);this.fileOperationResult=r;this.options=i}},Ri=class extends tt{constructor(e,r,i,o){super(e,r,o);this.fileOperationResult=r;this.size=i}},Ci=class extends tt{constructor(e,r,i){super(e,2,i);this.stat=r}};var Ya="";function Ku(n){if(!(typeof n.size!="number"||typeof n.mtime!="number"))return n.mtime.toString(29)+n.size.toString(31)}var Qa=class n{static KB=1024;static MB=n.KB*n.KB;static GB=n.MB*n.KB;static TB=n.GB*n.KB;static formatSize(t){return ui(t)||(t=0),t<n.KB?g("sizeB","{0}B",t.toFixed(0)):t<n.MB?g("sizeKB","{0}KB",(t/n.KB).toFixed(2)):t<n.GB?g("sizeMB","{0}MB",(t/n.MB).toFixed(2)):t<n.TB?g("sizeGB","{0}GB",(t/n.GB).toFixed(2)):g("sizeTB","{0}TB",(t/n.TB).toFixed(2))}};function ns(n){return Object.isFrozen(n)?n:Bp(n)}var Ce=class n{constructor(t,e,r,i,o){this._contents=t;this._keys=e;this._overrides=r;this.raw=i;this.logService=o}static createEmptyModel(t){return new n({},[],[],void 0,t)}overrideConfigurations=new Map;_rawConfiguration;get rawConfiguration(){if(!this._rawConfiguration)if(this.raw?.length){let t=this.raw.map(e=>{if(e instanceof n)return e;let r=new Za("",this.logService);return r.parseRaw(e),r.configurationModel});this._rawConfiguration=t.reduce((e,r)=>r===e?r:e.merge(r),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(t){return t?Yo(this.contents,t):this.contents}inspect(t,e){let r=this;return{get value(){return ns(r.rawConfiguration.getValue(t))},get override(){return e?ns(r.rawConfiguration.getOverrideValue(t,e)):void 0},get merged(){return ns(e?r.rawConfiguration.override(e).getValue(t):r.rawConfiguration.getValue(t))},get overrides(){let i=[];for(let{contents:o,identifiers:s,keys:a}of r.rawConfiguration.overrides){let l=new n(o,a,[],void 0,r.logService).getValue(t);l!==void 0&&i.push({identifiers:s,value:l})}return i.length?ns(i):void 0}}}getOverrideValue(t,e){let r=this.getContentsForOverrideIdentifer(e);return r?t?Yo(r,t):r:void 0}getKeysForOverrideIdentifier(t){let e=[];for(let r of this.overrides)r.identifiers.includes(t)&&e.push(...r.keys);return Nt(e)}getAllOverrideIdentifiers(){let t=[];for(let e of this.overrides)t.push(...e.identifiers);return Nt(t)}override(t){let e=this.overrideConfigurations.get(t);return e||(e=this.createOverrideConfigurationModel(t),this.overrideConfigurations.set(t,e)),e}merge(...t){let e=Rn(this.contents),r=Rn(this.overrides),i=[...this.keys],o=this.raw?.length?[...this.raw]:[this];for(let s of t)if(o.push(...s.raw?.length?s.raw:[s]),!s.isEmpty()){this.mergeContents(e,s.contents);for(let a of s.overrides){let[l]=r.filter(c=>sn(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=Nt(l.keys)):r.push(Rn(a))}for(let a of s.keys)i.indexOf(a)===-1&&i.push(a)}return new n(e,i,r,o.every(s=>s instanceof n)?void 0:o,this.logService)}createOverrideConfigurationModel(t){let e=this.getContentsForOverrideIdentifer(t);if(!e||typeof e!="object"||!Object.keys(e).length)return this;let r={};for(let i of Nt([...Object.keys(this.contents),...Object.keys(e)])){let o=this.contents[i],s=e[i];s&&(typeof o=="object"&&typeof s=="object"?(o=Rn(o),this.mergeContents(o,s)):o=s),r[i]=o}return new n(r,this.keys,this.overrides,void 0,this.logService)}mergeContents(t,e){for(let r of Object.keys(e)){if(r in t&&$e(t[r])&&$e(e[r])){this.mergeContents(t[r],e[r]);continue}t[r]=Rn(e[r])}}getContentsForOverrideIdentifer(t){let e=null,r=null,i=o=>{o&&(r?this.mergeContents(r,o):r=Rn(o))};for(let o of this.overrides)o.identifiers.length===1&&o.identifiers[0]===t?e=o.contents:o.identifiers.includes(t)&&i(o.contents);return i(e),r}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(t,e){this.updateValue(t,e,!0)}setValue(t,e){this.updateValue(t,e,!1)}removeValue(t){let e=this.keys.indexOf(t);e!==-1&&(this.keys.splice(e,1),jp(this.contents,t),Cn.test(t)&&this.overrides.splice(this.overrides.findIndex(r=>sn(r.identifiers,Ti(t))),1))}updateValue(t,e,r){if(wu(this.contents,t,e,i=>this.logService.error(i)),r=r||this.keys.indexOf(t)===-1,r&&this.keys.push(t),Cn.test(t)){let i=Ti(t),o={identifiers:i,keys:Object.keys(this.contents[t]),contents:Na(this.contents[t],a=>this.logService.error(a))},s=this.overrides.findIndex(a=>sn(a.identifiers,i));s!==-1?this.overrides[s]=o:this.overrides.push(o)}}},Za=class{constructor(t,e){this._name=t;this.logService=e}_raw=null;_configurationModel=null;_restrictedConfigurations=[];_parseErrors=[];get configurationModel(){return this._configurationModel||Ce.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(t,e){if(!Ye(t)){let r=this.doParseContent(t);this.parseRaw(r,e)}}reparse(t){this._raw&&this.parseRaw(this._raw,t)}parseRaw(t,e){this._raw=t;let{contents:r,keys:i,overrides:o,restricted:s,hasExcludedProperties:a}=this.doParseRaw(t,e);this._configurationModel=new Ce(r,i,o,a?[t]:void 0,this.logService),this._restrictedConfigurations=s||[]}doParseContent(t){let e={},r=null,i=[],o=[],s=[];function a(c){Array.isArray(i)?i.push(c):r!==null&&(i[r]=c)}let l={onObjectBegin:()=>{let c={};a(c),o.push(i),i=c,r=null},onObjectProperty:c=>{r=c},onObjectEnd:()=>{i=o.pop()},onArrayBegin:()=>{let c=[];a(c),o.push(i),i=c,r=null},onArrayEnd:()=>{i=o.pop()},onLiteralValue:a,onError:(c,u,f)=>{s.push({error:c,offset:u,length:f})}};if(t)try{Oa(t,l),e=i[0]||{}}catch(c){this.logService.error(`Error while parsing settings file ${this._name}: ${c}`),this._parseErrors=[c]}return e}doParseRaw(t,e){let r=et.as(en.Configuration).getConfigurationProperties(),i=this.filter(t,r,!0,e);t=i.raw;let o=Na(t,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),s=Object.keys(t),a=this.toOverrides(t,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:o,keys:s,overrides:a,restricted:i.restricted,hasExcludedProperties:i.hasExcludedProperties}}filter(t,e,r,i){let o=!1;if(!i?.scopes&&!i?.skipRestricted&&!i?.exclude?.length)return{raw:t,restricted:[],hasExcludedProperties:o};let s={},a=[];for(let l in t)if(Cn.test(l)&&r){let c=this.filter(t[l],e,!1,i);s[l]=c.raw,o=o||c.hasExcludedProperties,a.push(...c.restricted)}else{let c=e[l],u=c?typeof c.scope<"u"?c.scope:3:void 0;c?.restricted&&a.push(l),!i.exclude?.includes(l)&&(i.include?.includes(l)||(u===void 0||i.scopes===void 0||i.scopes.includes(u))&&!(i.skipRestricted&&c?.restricted))?s[l]=t[l]:o=!0}return{raw:s,restricted:a,hasExcludedProperties:o}}toOverrides(t,e){let r=[];for(let i of Object.keys(t))if(Cn.test(i)){let o={};for(let s in t[i])o[s]=t[i][s];r.push({identifiers:Ti(i),keys:Object.keys(o),contents:Na(o,e)})}return r}},el=class extends U{constructor(e,r,i,o,s){super();this.userSettingsResource=e;this.parseOptions=r;this.fileService=o;this.logService=s;this.parser=new Za(this.userSettingsResource.toString(),s),this._register(this.fileService.watch(i.dirname(this.userSettingsResource))),this._register(this.fileService.watch(this.userSettingsResource)),this._register(Z.any(Z.filter(this.fileService.onDidFilesChange,a=>a.contains(this.userSettingsResource)),Z.filter(this.fileService.onDidRunOperation,a=>(a.isOperation(0)||a.isOperation(3)||a.isOperation(1)||a.isOperation(4))&&i.isEqual(a.resource,e)))(()=>this._onDidChange.fire()))}parser;_onDidChange=this._register(new C);onDidChange=this._onDidChange.event;async loadConfiguration(){try{let e=await this.fileService.readFile(this.userSettingsResource);return this.parser.parse(e.value.toString()||"{}",this.parseOptions),this.parser.configurationModel}catch{return Ce.createEmptyModel(this.logService)}}reparse(e){return e&&(this.parseOptions=e),this.parser.reparse(this.parseOptions),this.parser.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}},Bu=class{constructor(t,e,r,i,o,s,a,l,c,u,f,p,h){this.key=t;this.overrides=e;this._value=r;this.overrideIdentifiers=i;this.defaultConfiguration=o;this.policyConfiguration=s;this.applicationConfiguration=a;this.userConfiguration=l;this.localUserConfiguration=c;this.remoteUserConfiguration=u;this.workspaceConfiguration=f;this.folderConfigurationModel=p;this.memoryConfigurationModel=h}get value(){return ns(this._value)}toInspectValue(t){return t?.value!==void 0||t?.override!==void 0||t?.overrides!==void 0?t:void 0}_defaultInspectValue;get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}_policyInspectValue;get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){return this.policyInspectValue?.merged}get policy(){return this.policyInspectValue?.value!==void 0?{value:this.policyInspectValue.value}:void 0}_applicationInspectValue;get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){return this.applicationInspectValue?.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}_userInspectValue;get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}_userLocalInspectValue;get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}_userRemoteInspectValue;get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}_workspaceInspectValue;get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){return this.workspaceInspectValue?.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}_workspaceFolderInspectValue;get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){return this.workspaceFolderInspectValue?.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}_memoryInspectValue;get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}},ki=class n{constructor(t,e,r,i,o,s,a,l,c,u){this._defaultConfiguration=t;this._policyConfiguration=e;this._applicationConfiguration=r;this._localUserConfiguration=i;this._remoteUserConfiguration=o;this._workspaceConfiguration=s;this._folderConfigurations=a;this._memoryConfiguration=l;this._memoryConfigurationByResource=c;this.logService=u}_workspaceConsolidatedConfiguration=null;_foldersConsolidatedConfigurations=new ve;getValue(t,e,r){return this.getConsolidatedConfigurationModel(t,e,r).getValue(t)}updateValue(t,e,r={}){let i;r.resource?(i=this._memoryConfigurationByResource.get(r.resource),i||(i=Ce.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(r.resource,i))):i=this._memoryConfiguration,e===void 0?i.removeValue(t):i.setValue(t,e),r.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(t,e,r){let i=this.getConsolidatedConfigurationModel(t,e,r),o=this.getFolderConfigurationModelForResource(e.resource,r),s=e.resource?this._memoryConfigurationByResource.get(e.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(let l of i.overrides)for(let c of l.identifiers)i.getOverrideValue(t,c)!==void 0&&a.add(c);return new Bu(t,e,i.getValue(t),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,r?this._workspaceConfiguration:void 0,o||void 0,s)}keys(t){let e=this.getFolderConfigurationModelForResource(void 0,t);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:e?e.keys.slice(0):[]}}updateDefaultConfiguration(t){this._defaultConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(t){this._policyConfiguration=t}updateApplicationConfiguration(t){this._applicationConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(t){this._localUserConfiguration=t,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(t){this._remoteUserConfiguration=t,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(t){this._workspaceConfiguration=t,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(t,e){this._folderConfigurations.set(t,e),this._foldersConsolidatedConfigurations.delete(t)}deleteFolderConfiguration(t){this.folderConfigurations.delete(t),this._foldersConsolidatedConfigurations.delete(t)}compareAndUpdateDefaultConfiguration(t,e){let r=[];if(!e){let{added:i,updated:o,removed:s}=gr(this._defaultConfiguration,t);e=[...i,...o,...s]}for(let i of e)for(let o of Ti(i)){let s=this._defaultConfiguration.getKeysForOverrideIdentifier(o),a=t.getKeysForOverrideIdentifier(o),l=[...a.filter(c=>s.indexOf(c)===-1),...s.filter(c=>a.indexOf(c)===-1),...s.filter(c=>!Ct(this._defaultConfiguration.override(o).getValue(c),t.override(o).getValue(c)))];r.push([o,l])}return this.updateDefaultConfiguration(t),{keys:e,overrides:r}}compareAndUpdatePolicyConfiguration(t){let{added:e,updated:r,removed:i}=gr(this._policyConfiguration,t),o=[...e,...r,...i];return o.length&&this.updatePolicyConfiguration(t),{keys:o,overrides:[]}}compareAndUpdateApplicationConfiguration(t){let{added:e,updated:r,removed:i,overrides:o}=gr(this.applicationConfiguration,t),s=[...e,...r,...i];return s.length&&this.updateApplicationConfiguration(t),{keys:s,overrides:o}}compareAndUpdateLocalUserConfiguration(t){let{added:e,updated:r,removed:i,overrides:o}=gr(this.localUserConfiguration,t),s=[...e,...r,...i];return s.length&&this.updateLocalUserConfiguration(t),{keys:s,overrides:o}}compareAndUpdateRemoteUserConfiguration(t){let{added:e,updated:r,removed:i,overrides:o}=gr(this.remoteUserConfiguration,t),s=[...e,...r,...i];return s.length&&this.updateRemoteUserConfiguration(t),{keys:s,overrides:o}}compareAndUpdateWorkspaceConfiguration(t){let{added:e,updated:r,removed:i,overrides:o}=gr(this.workspaceConfiguration,t),s=[...e,...r,...i];return s.length&&this.updateWorkspaceConfiguration(t),{keys:s,overrides:o}}compareAndUpdateFolderConfiguration(t,e){let r=this.folderConfigurations.get(t),{added:i,updated:o,removed:s,overrides:a}=gr(r,e),l=[...i,...o,...s];return(l.length||!r)&&this.updateFolderConfiguration(t,e),{keys:l,overrides:a}}compareAndDeleteFolderConfiguration(t){let e=this.folderConfigurations.get(t);if(!e)throw new Error("Unknown folder");this.deleteFolderConfiguration(t);let{added:r,updated:i,removed:o,overrides:s}=gr(e,void 0);return{keys:[...r,...i,...o],overrides:s}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}_userConfiguration=null;get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(t,e,r){let i=this.getConsolidatedConfigurationModelForResource(e,r);return e.overrideIdentifier&&(i=i.override(e.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(t)!==void 0&&(i=i.merge(this._policyConfiguration)),i}getConsolidatedConfigurationModelForResource({resource:t},e){let r=this.getWorkspaceConsolidatedConfiguration();if(e&&t){let i=e.getFolder(t);i&&(r=this.getFolderConsolidatedConfiguration(i.uri)||r);let o=this._memoryConfigurationByResource.get(t);o&&(r=r.merge(o))}return r}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(t){let e=this._foldersConsolidatedConfigurations.get(t);if(!e){let r=this.getWorkspaceConsolidatedConfiguration(),i=this._folderConfigurations.get(t);i?(e=r.merge(i),this._foldersConsolidatedConfigurations.set(t,e)):e=r}return e}getFolderConfigurationModelForResource(t,e){if(e&&t){let r=e.getFolder(t);if(r)return this._folderConfigurations.get(r.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((t,e)=>{let{contents:r,overrides:i,keys:o}=this._folderConfigurations.get(e);return t.push([e,{contents:r,overrides:i,keys:o}]),t},[])}}allKeys(){let t=new Set;return this._defaultConfiguration.keys.forEach(e=>t.add(e)),this.userConfiguration.keys.forEach(e=>t.add(e)),this._workspaceConfiguration.keys.forEach(e=>t.add(e)),this._folderConfigurations.forEach(e=>e.keys.forEach(r=>t.add(r))),[...t.values()]}allOverrideIdentifiers(){let t=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(e=>t.add(e)),this.userConfiguration.getAllOverrideIdentifiers().forEach(e=>t.add(e)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(e=>t.add(e)),this._folderConfigurations.forEach(e=>e.getAllOverrideIdentifiers().forEach(r=>t.add(r))),[...t.values()]}getAllKeysForOverrideIdentifier(t){let e=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(t).forEach(r=>e.add(r)),this.userConfiguration.getKeysForOverrideIdentifier(t).forEach(r=>e.add(r)),this._workspaceConfiguration.getKeysForOverrideIdentifier(t).forEach(r=>e.add(r)),this._folderConfigurations.forEach(r=>r.getKeysForOverrideIdentifier(t).forEach(i=>e.add(i))),[...e.values()]}static parse(t,e){let r=this.parseConfigurationModel(t.defaults,e),i=this.parseConfigurationModel(t.policy,e),o=this.parseConfigurationModel(t.application,e),s=this.parseConfigurationModel(t.user,e),a=this.parseConfigurationModel(t.workspace,e),l=t.folders.reduce((c,u)=>(c.set(P.revive(u[0]),this.parseConfigurationModel(u[1],e)),c),new ve);return new n(r,i,o,s,Ce.createEmptyModel(e),a,l,Ce.createEmptyModel(e),new ve,e)}static parseConfigurationModel(t,e){return new Ce(t.contents,t.keys,t.overrides,void 0,e)}};var tl=class{constructor(t,e,r,i,o){this.change=t;this.previous=e;this.currentConfiguraiton=r;this.currentWorkspace=i;this.logService=o;for(let s of t.keys)this.affectedKeys.add(s);for(let[,s]of t.overrides)for(let a of s)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(let s of this.affectedKeys)this._affectsConfigStr+=s+this._marker}_marker=`
`;_markerCode1=this._marker.charCodeAt(0);_markerCode2=46;_affectsConfigStr;affectedKeys=new Set;source;_previousConfiguration=void 0;get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=ki.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(t,e){let r=this._marker+t,i=this._affectsConfigStr.indexOf(r);if(i<0)return!1;let o=i+r.length;if(o>=this._affectsConfigStr.length)return!1;let s=this._affectsConfigStr.charCodeAt(o);if(s!==this._markerCode1&&s!==this._markerCode2)return!1;if(e){let a=this.previousConfiguration?this.previousConfiguration.getValue(t,e,this.previous?.workspace):void 0,l=this.currentConfiguraiton.getValue(t,e,this.currentWorkspace);return!Ct(a,l)}return!0}};function gr(n,t){let{added:e,removed:r,updated:i}=bg(t?.rawConfiguration,n?.rawConfiguration),o=[],s=n?.getAllOverrideIdentifiers()||[],a=t?.getAllOverrideIdentifiers()||[];if(t){let l=a.filter(c=>!s.includes(c));for(let c of l)o.push([c,t.getKeysForOverrideIdentifier(c)])}if(n){let l=s.filter(c=>!a.includes(c));for(let c of l)o.push([c,n.getKeysForOverrideIdentifier(c)])}if(t&&n){for(let l of s)if(a.includes(l)){let c=bg({contents:n.getOverrideValue(void 0,l)||{},keys:n.getKeysForOverrideIdentifier(l)},{contents:t.getOverrideValue(void 0,l)||{},keys:t.getKeysForOverrideIdentifier(l)});o.push([l,[...c.added,...c.removed,...c.updated]])}}return{added:e,removed:r,updated:i,overrides:o}}function bg(n,t){let e=n?t?n.keys.filter(o=>t.keys.indexOf(o)===-1):[...n.keys]:[],r=t?n?t.keys.filter(o=>n.keys.indexOf(o)===-1):[...t.keys]:[],i=[];if(n&&t){for(let o of t.keys)if(n.keys.indexOf(o)!==-1){let s=Yo(t.contents,o),a=Yo(n.contents,o);Ct(s,a)||i.push(o)}}return{added:e,removed:r,updated:i}}var nl=class extends U{constructor(e){super();this.logService=e}_onDidChangeConfiguration=this._register(new C);onDidChangeConfiguration=this._onDidChangeConfiguration.event;_configurationModel=Ce.createEmptyModel(this.logService);get configurationModel(){return this._configurationModel}async initialize(){return this.resetConfigurationModel(),this._register(et.as(en.Configuration).onDidUpdateConfiguration(({properties:e,defaultsOverrides:r})=>this.onDidUpdateConfiguration(Array.from(e),r))),this.configurationModel}reload(){return this.resetConfigurationModel(),this.configurationModel}onDidUpdateConfiguration(e,r){this.updateConfigurationModel(e,et.as(en.Configuration).getConfigurationProperties()),this._onDidChangeConfiguration.fire({defaults:this.configurationModel,properties:e})}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=Ce.createEmptyModel(this.logService);let e=et.as(en.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,r){let i=this.getConfigurationDefaultOverrides();for(let o of e){let s=i[o],a=r[o];s!==void 0?this._configurationModel.setValue(o,s):a?this._configurationModel.setValue(o,a.default):this._configurationModel.removeValue(o)}}},rl=class{onDidChangeConfiguration=Z.None;configurationModel=Ce.createEmptyModel(new va);async initialize(){return this.configurationModel}},Oi=class extends U{constructor(e,r,i){super();this.defaultConfiguration=e;this.policyService=r;this.logService=i}_onDidChangeConfiguration=this._register(new C);onDidChangeConfiguration=this._onDidChangeConfiguration.event;_configurationModel=Ce.createEmptyModel(this.logService);get configurationModel(){return this._configurationModel}async initialize(){return this.logService.trace("PolicyConfiguration#initialize"),this.update(await this.updatePolicyDefinitions(this.defaultConfiguration.configurationModel.keys),!1),this._register(this.policyService.onDidChange(e=>this.onDidChangePolicies(e))),this._register(this.defaultConfiguration.onDidChangeConfiguration(async({properties:e})=>this.update(await this.updatePolicyDefinitions(e),!0))),this._configurationModel}async updatePolicyDefinitions(e){this.logService.trace("PolicyConfiguration#updatePolicyDefinitions",e);let r={},i=[],o=et.as(en.Configuration).getConfigurationProperties();for(let s of e){let a=o[s];if(!a){i.push(s);continue}if(a.policy){if(a.type!=="string"&&a.type!=="number"){this.logService.warn(`Policy ${a.policy.name} has unsupported type ${a.type}`);continue}i.push(s),r[a.policy.name]={type:a.type}}}return di(r)||await this.policyService.updatePolicyDefinitions(r),i}onDidChangePolicies(e){this.logService.trace("PolicyConfiguration#onDidChangePolicies",e);let r=et.as(en.Configuration).getPolicyConfigurations(),i=Jt(e.map(o=>r.get(o)));this.update(i,!0)}update(e,r){this.logService.trace("PolicyConfiguration#update",e);let i=et.as(en.Configuration).getConfigurationProperties(),o=[],s=this._configurationModel.isEmpty();for(let a of e){let l=i[a]?.policy?.name;if(l){let c=this.policyService.getPolicyValue(l);(s?c!==void 0:!Ct(this._configurationModel.getValue(a),c))&&o.push([a,c])}else this._configurationModel.getValue(a)!==void 0&&o.push([a,void 0])}if(o.length){this.logService.trace("PolicyConfiguration#changed",o);let a=this._configurationModel;this._configurationModel=Ce.createEmptyModel(this.logService);for(let l of a.keys)this._configurationModel.setValue(l,a.getValue(l));for(let[l,c]of o)c===void 0?this._configurationModel.removeValue(l):this._configurationModel.setValue(l,c);r&&this._onDidChangeConfiguration.fire(this._configurationModel)}}};Oi=D([b(1,Qp),b(2,J)],Oi);var il=class extends U{constructor(e,r,i,o){super();this.settingsResource=e;this.logService=o;this.defaultConfiguration=this._register(new nl(o)),this.policyConfiguration=i instanceof wi?new rl:this._register(new Oi(this.defaultConfiguration,i,o)),this.userConfiguration=this._register(new el(this.settingsResource,{},Fr,r,o)),this.configuration=new ki(this.defaultConfiguration.configurationModel,this.policyConfiguration.configurationModel,Ce.createEmptyModel(o),Ce.createEmptyModel(o),Ce.createEmptyModel(o),Ce.createEmptyModel(o),new ve,Ce.createEmptyModel(o),new ve,o),this.configurationEditing=new qu(e,r,this),this.reloadConfigurationScheduler=this._register(new fr(()=>this.reloadConfiguration(),50)),this._register(this.defaultConfiguration.onDidChangeConfiguration(({defaults:s,properties:a})=>this.onDidDefaultConfigurationChange(s,a))),this._register(this.policyConfiguration.onDidChangeConfiguration(s=>this.onDidPolicyConfigurationChange(s))),this._register(this.userConfiguration.onDidChange(()=>this.reloadConfigurationScheduler.schedule()))}configuration;defaultConfiguration;policyConfiguration;userConfiguration;reloadConfigurationScheduler;_onDidChangeConfiguration=this._register(new C);onDidChangeConfiguration=this._onDidChangeConfiguration.event;configurationEditing;async initialize(){let[e,r,i]=await Promise.all([this.defaultConfiguration.initialize(),this.policyConfiguration.initialize(),this.userConfiguration.loadConfiguration()]);this.configuration=new ki(e,r,Ce.createEmptyModel(this.logService),i,Ce.createEmptyModel(this.logService),Ce.createEmptyModel(this.logService),new ve,Ce.createEmptyModel(this.logService),new ve,this.logService)}getConfigurationData(){return this.configuration.toData()}getValue(e,r){let i=typeof e=="string"?e:void 0,o=Ua(e)?e:Ua(r)?r:{};return this.configuration.getValue(i,o,void 0)}async updateValue(e,r,i,o,s){let a=zp(i)?i:Ua(i)?{resource:i.resource,overrideIdentifiers:i.overrideIdentifier?[i.overrideIdentifier]:void 0}:void 0,l=a?o:i;if(l!==void 0&&l!==3&&l!==2)throw new Error(`Unable to write ${e} to target ${l}.`);a?.overrideIdentifiers&&(a.overrideIdentifiers=Nt(a.overrideIdentifiers),a.overrideIdentifiers=a.overrideIdentifiers.length?a.overrideIdentifiers:void 0);let c=this.inspect(e,{resource:a?.resource,overrideIdentifier:a?.overrideIdentifiers?a.overrideIdentifiers[0]:void 0});if(c.policyValue!==void 0)throw new Error(`Unable to write ${e} because it is configured in system policy.`);if(Ct(r,c.defaultValue)&&(r=void 0),a?.overrideIdentifiers?.length&&a.overrideIdentifiers.length>1){let f=a.overrideIdentifiers.sort(),p=this.configuration.localUserConfiguration.overrides.find(h=>sn([...h.identifiers].sort(),f));p&&(a.overrideIdentifiers=p.identifiers)}let u=a?.overrideIdentifiers?.length?[Yp(a.overrideIdentifiers),e]:[e];await this.configurationEditing.write(u,r),await this.reloadConfiguration()}inspect(e,r={}){return this.configuration.inspect(e,r,void 0)}keys(){return this.configuration.keys(void 0)}async reloadConfiguration(){let e=await this.userConfiguration.loadConfiguration();this.onDidChangeUserConfiguration(e)}onDidChangeUserConfiguration(e){let r=this.configuration.toData(),i=this.configuration.compareAndUpdateLocalUserConfiguration(e);this.trigger(i,r,2)}onDidDefaultConfigurationChange(e,r){let i=this.configuration.toData(),o=this.configuration.compareAndUpdateDefaultConfiguration(e,r);this.trigger(o,i,7)}onDidPolicyConfigurationChange(e){let r=this.configuration.toData(),i=this.configuration.compareAndUpdatePolicyConfiguration(e);this.trigger(i,r,7)}trigger(e,r,i){let o=new tl(e,{data:r},this.configuration,void 0,this.logService);o.source=i,this._onDidChangeConfiguration.fire(o)}},qu=class{constructor(t,e,r){this.settingsResource=t;this.fileService=e;this.configurationService=r;this.queue=new pn}queue;write(t,e){return this.queue.queue(()=>this.doWriteConfiguration(t,e))}async doWriteConfiguration(t,e){let r;try{r=(await this.fileService.readFile(this.settingsResource)).value.toString()}catch(s){if(s.fileOperationResult===1)r="{}";else throw s}let i=[];if(Wr(r,i,{allowTrailingComma:!0,allowEmptyContent:!0}),i.length>0)throw new Error("Unable to write into the settings file. Please open the file to correct errors/warnings in the file and try again.");let o=this.getEdits(r,t,e);r=Kp(r,o),await this.fileService.writeFile(this.settingsResource,W.fromString(r))}getEdits(t,e,r){let{tabSize:i,insertSpaces:o,eol:s}=this.formattingOptions;if(!e.length){let a=JSON.stringify(r,null,o?" ".repeat(i):"	");return[{content:a,length:a.length,offset:0}]}return Wp(t,e,r,{tabSize:i,insertSpaces:o,eol:s})}_formattingOptions;get formattingOptions(){if(!this._formattingOptions){let t=_o===3||_o===2?`
`:`\r
`,e=this.configurationService.getValue("files.eol",{overrideIdentifier:"jsonc"});e&&typeof e=="string"&&e!=="auto"&&(t=e),this._formattingOptions={eol:t,insertSpaces:!!this.configurationService.getValue("editor.insertSpaces",{overrideIdentifier:"jsonc"}),tabSize:this.configurationService.getValue("editor.tabSize",{overrideIdentifier:"jsonc"})}}return this._formattingOptions}};var $u="Offline";function xg(n){return n instanceof zu?!0:n instanceof Error&&n.name===$u&&n.message===$u}var zu=class extends Error{constructor(){super($u),this.name=this.message}};var hr=$("requestService"),Gu=class{constructor(t){this.original=t}headers;toJSON(){if(!this.headers){let t=Object.create(null);for(let e in this.original)e.toLowerCase()==="authorization"||e.toLowerCase()==="proxy-authorization"?t[e]="*****":t[e]=this.original[e];this.headers=t}return this.headers}},ol=class extends U{constructor(e){super();this.logService=e}counter=0;async logAndRequest(e,r){let i=`[network] #${++this.counter}: ${e.url}`;this.logService.trace(`${i} - begin`,e.type,new Gu(e.headers??{}));try{let o=await r();return this.logService.trace(`${i} - end`,e.type,o.res.statusCode,o.res.headers),o}catch(o){throw this.logService.error(`${i} - error`,e.type,G(o)),o}}};function sl(n){return n.res.statusCode&&n.res.statusCode>=200&&n.res.statusCode<300||n.res.statusCode===1223}function Eg(n){return n.res.statusCode===204}async function Av(n){return Eg(n)?null:(await pr(n.stream)).toString()}async function mr(n){if(!sl(n))throw new Error("Server returned "+n.res.statusCode);return Av(n)}async function al(n){if(!sl(n))throw new Error("Server returned "+n.res.statusCode);if(Eg(n))return null;let e=(await pr(n.stream)).toString();try{return JSON.parse(e)}catch(r){throw r.message+=`:
`+e,r}}var ju;function Fv(n){let t=et.as(en.Configuration),e=ju;ju={id:"http",order:15,title:g("httpConfigurationTitle","HTTP"),type:"object",scope:n,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:g("proxy","The proxy setting to use. If not set, will be inherited from the `http_proxy` and `https_proxy` environment variables."),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,description:g("strictSSL","Controls whether the proxy server certificate should be verified against the list of supplied CAs."),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:g("proxyKerberosServicePrincipal","Overrides the principal service name for Kerberos authentication with the HTTP proxy. A default based on the proxy hostname is used when this is not set."),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:g("noProxy","Specifies domain names for which proxy settings should be ignored for HTTP/HTTPS requests."),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:g("proxyAuthorization","The value to send as the `Proxy-Authorization` header for every network request."),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[g("proxySupportOff","Disable proxy support for extensions."),g("proxySupportOn","Enable proxy support for extensions."),g("proxySupportFallback","Enable proxy support for extensions, fall back to request options, when no proxy found."),g("proxySupportOverride","Enable proxy support for extensions, override request options.")],default:"override",description:g("proxySupport","Use the proxy support for extensions."),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,description:g("systemCertificates","Controls whether CA certificates should be loaded from the OS. (On Windows and macOS, a reload of the window is required after turning this off.)"),restricted:!0},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,description:g("systemCertificatesV2","Controls whether experimental loading of CA certificates from the OS should be enabled. This uses a more general approach than the default implemenation."),restricted:!0}}},t.updateConfigurations({add:[ju],remove:e?[e]:[]})}Fv(1);import{parse as Eh}from"url";import{spawn as yb}from"child_process";var Lv=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Sg(n){return Lv.test(n)}var Ke=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let n;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?n=crypto.getRandomValues.bind(crypto):n=function(r){for(let i=0;i<r.length;i++)r[i]=Math.floor(Math.random()*256);return r};let t=new Uint8Array(16),e=[];for(let r=0;r<256;r++)e.push(r.toString(16).padStart(2,"0"));return function(){n(t),t[6]=t[6]&15|64,t[8]=t[8]&63|128;let i=0,o="";return o+=e[t[i++]],o+=e[t[i++]],o+=e[t[i++]],o+=e[t[i++]],o+="-",o+=e[t[i++]],o+=e[t[i++]],o+="-",o+=e[t[i++]],o+=e[t[i++]],o+="-",o+=e[t[i++]],o+=e[t[i++]],o+="-",o+=e[t[i++]],o+=e[t[i++]],o+=e[t[i++]],o+=e[t[i++]],o+=e[t[i++]],o+=e[t[i++]],o}}();import{userInfo as lb}from"os";import*as Og from"os";import*as ee from"fs";import{tmpdir as Vv}from"os";import{promisify as ll}from"util";var Uv=new Wn(1e4);function rs(n){return Mv(n,"NFC",Uv)}var OC=new Wn(1e4);var Nv=/[^\u0000-\u0080]/;function Mv(n,t,e){if(!n)return n;let r=e.get(n);if(r)return r;let i;return Nv.test(n)?i=n.normalize(t):i=n,e.set(n,i),i}async function Tg(n,t=0,e){if(rp(n))throw new Error("rimraf - will refuse to recursively delete root");return t===0?Hu(n):Wv(n,e)}async function Wv(n,t=ip(Vv())){try{try{await ee.promises.rename(n,t)}catch(e){return e.code==="ENOENT"?void 0:Hu(n)}Hu(t).catch(e=>{})}catch(e){if(e.code!=="ENOENT")throw e}}async function Hu(n){return ee.promises.rm(n,{recursive:!0,force:!0,maxRetries:3})}async function cl(n,t){return Bv(await(t?Kv(n):ee.promises.readdir(n)))}async function Kv(n){try{return await ee.promises.readdir(n,{withFileTypes:!0})}catch(r){console.warn("[node.js fs] readdir with filetypes failed with error: ",r)}let t=[],e=await cl(n);for(let r of e){let i=!1,o=!1,s=!1;try{let a=await ee.promises.lstat(V(n,r));i=a.isFile(),o=a.isDirectory(),s=a.isSymbolicLink()}catch(a){console.warn("[node.js fs] unexpected error from lstat after readdir: ",a)}t.push({name:r,isFile:()=>i,isDirectory:()=>o,isSymbolicLink:()=>s})}return t}function Bv(n){return n.map(t=>typeof t=="string"?Vt?rs(t):t:(t.name=Vt?rs(t.name):t.name,t))}async function qv(n){let t=await cl(n),e=[];for(let r of t)await Et.existsDirectory(V(n,r))&&e.push(r);return e}var Et;(r=>{async function n(i){let o;try{if(o=await ee.promises.lstat(i),!o.isSymbolicLink())return{stat:o}}catch{}try{return{stat:await ee.promises.stat(i),symbolicLink:o?.isSymbolicLink()?{dangling:!1}:void 0}}catch(s){if(s.code==="ENOENT"&&o)return{stat:o,symbolicLink:{dangling:!0}};if(ue&&s.code==="EACCES")try{return{stat:await ee.promises.stat(await ee.promises.readlink(i)),symbolicLink:{dangling:!1}}}catch(a){if(a.code==="ENOENT"&&o)return{stat:o,symbolicLink:{dangling:!0}};throw a}throw s}}r.stat=n;async function t(i){try{let{stat:o,symbolicLink:s}=await r.stat(i);return o.isFile()&&s?.dangling!==!0}catch{}return!1}r.existsFile=t;async function e(i){try{let{stat:o,symbolicLink:s}=await r.stat(i);return o.isDirectory()&&s?.dangling!==!0}catch{}return!1}r.existsDirectory=e})(Et||={});var $v=new vi;function zv(n,t,e){return $v.queueFor(P.file(n),()=>{let r=Hv(e);return new Promise((i,o)=>Gv(n,t,r,s=>s?o(s):i()))},Fr)}var Pg=!0;function jv(n){Pg=n}function Gv(n,t,e,r){if(!Pg)return ee.writeFile(n,t,{mode:e.mode,flag:e.flag},r);ee.open(n,e.flag,e.mode,(i,o)=>{if(i)return r(i);ee.writeFile(o,t,s=>{if(s)return ee.close(o,()=>r(s));ee.fdatasync(o,a=>(a&&(console.warn("[node.js fs] fdatasync is now disabled for this session because it failed: ",a),jv(!1)),ee.close(o,l=>r(l))))})})}function Hv(n){return n?{mode:typeof n.mode=="number"?n.mode:438,flag:typeof n.flag=="string"?n.flag:"w"}:{mode:438,flag:"w"}}async function Qv(n,t,e=6e4){if(n!==t)try{ue&&typeof e=="number"?await _g(n,t,Date.now(),e):await ee.promises.rename(n,t)}catch(r){if(n.toLowerCase()!==t.toLowerCase()&&r.code==="EXDEV"||n.endsWith("."))await Rg(n,t,{preserveSymlinks:!1}),await Tg(n,1);else throw r}}async function _g(n,t,e,r,i=0){try{return await ee.promises.rename(n,t)}catch(o){if(o.code!=="EACCES"&&o.code!=="EPERM"&&o.code!=="EBUSY")throw o;if(Date.now()-e>=r)throw console.error(`[node.js fs] rename failed after ${i} retries with error: ${o}`),o;if(i===0){let s=!1;try{let{stat:a}=await Et.stat(t);a.isFile()||(s=!0)}catch{}if(s)throw o}return await Mr(Math.min(100,i*10)),_g(n,t,e,r,i+1)}}async function Rg(n,t,e){return Cg(n,t,{root:{source:n,target:t},options:e,handledSourcePaths:new Set})}var wg=511;async function Cg(n,t,e){if(e.handledSourcePaths.has(n))return;e.handledSourcePaths.add(n);let{stat:r,symbolicLink:i}=await Et.stat(n);if(i){if(e.options.preserveSymlinks)try{return await Yv(n,t,e)}catch{}if(i.dangling)return}return r.isDirectory()?Jv(n,t,r.mode&wg,e):Xv(n,t,r.mode&wg)}async function Jv(n,t,e,r){await ee.promises.mkdir(t,{recursive:!0,mode:e});let i=await cl(n);for(let o of i)await Cg(V(n,o),V(t,o),r)}async function Xv(n,t,e){await ee.promises.copyFile(n,t),await ee.promises.chmod(t,e)}async function Yv(n,t,e){let r=await ee.promises.readlink(n);Bn(r,e.root.source,!Se)&&(r=V(e.root.target,r.substr(e.root.source.length+1))),await ee.promises.symlink(r,t)}var se=new class{get read(){return(n,t,e,r,i)=>new Promise((o,s)=>{ee.read(n,t,e,r,i,(a,l,c)=>a?s(a):o({bytesRead:l,buffer:c}))})}get write(){return(n,t,e,r,i)=>new Promise((o,s)=>{ee.write(n,t,e,r,i,(a,l,c)=>a?s(a):o({bytesWritten:l,buffer:c}))})}get fdatasync(){return ll(ee.fdatasync)}get open(){return ll(ee.open)}get close(){return ll(ee.close)}get realpath(){return ll(ee.realpath)}async exists(n){try{return await ee.promises.access(n),!0}catch{return!1}}get readdir(){return cl}get readDirsInDir(){return qv}get writeFile(){return zv}get rm(){return Tg}get rename(){return Qv}get copy(){return Rg}};var Dg=/^\d+$/,Zv=/^Microsoft.PowerShell_.*/,eb=/^Microsoft.PowerShellPreview_.*/;var is;switch(process.arch){case"ia32":is=1;break;case"arm":case"arm64":is=2;break;default:is=0;break}var Ai;process.env.PROCESSOR_ARCHITEW6432?Ai=process.env.PROCESSOR_ARCHITEW6432==="ARM64"?2:0:process.env.PROCESSOR_ARCHITECTURE==="ARM64"?Ai=2:process.env.PROCESSOR_ARCHITECTURE==="X86"?Ai=1:Ai=0;var Fi=class{constructor(t,e,r){this.exePath=t;this.displayName=e;this.knownToExist=r}async exists(){return this.knownToExist===void 0&&(this.knownToExist=await Et.existsFile(this.exePath)),this.knownToExist}};function tb({useAlternateBitness:n=!1}={}){return n?is===0?process.env["ProgramFiles(x86)"]||null:Ai===0&&process.env.ProgramW6432||null:process.env.ProgramFiles||null}async function ul({useAlternateBitness:n=!1,findPreview:t=!1}={}){let e=tb({useAlternateBitness:n});if(!e)return null;let r=V(e,"PowerShell");if(!await Et.existsDirectory(r))return null;let i=-1,o=null;for(let l of await se.readdir(r)){let c=-1;if(t){let f=l.indexOf("-");if(f<0)continue;let p=l.substring(0,f);if(!Dg.test(p)||l.substring(f+1)!=="preview")continue;c=parseInt(p,10)}else{if(!Dg.test(l))continue;c=parseInt(l,10)}if(c<=i)continue;let u=V(r,l,"pwsh.exe");await Et.existsFile(u)&&(o=u,i=c)}if(!o)return null;let s=e.includes("x86")?" (x86)":"",a=t?" Preview":"";return new Fi(o,`PowerShell${a}${s}`,!0)}async function kg({findPreview:n}={}){if(!process.env.LOCALAPPDATA)return null;let t=V(process.env.LOCALAPPDATA,"Microsoft","WindowsApps");if(!await Et.existsDirectory(t))return null;let{pwshMsixDirRegex:e,pwshMsixName:r}=n?{pwshMsixDirRegex:eb,pwshMsixName:"PowerShell Preview (Store)"}:{pwshMsixDirRegex:Zv,pwshMsixName:"PowerShell (Store)"};for(let i of await se.readdir(t))if(e.test(i)){let o=V(t,i,"pwsh.exe");return new Fi(o,r)}return null}function nb(){let n=V(Og.homedir(),".dotnet","tools","pwsh.exe");return new Fi(n,".NET Core PowerShell Global Tool")}function rb(){let n=V(process.env.windir,is===1&&Ai!==1?"SysNative":"System32","WindowsPowerShell","v1.0","powershell.exe");return new Fi(n,"Windows PowerShell",!0)}async function*ib(){let n=await ul();n&&(yield n),n=await ul({useAlternateBitness:!0}),n&&(yield n),n=await kg(),n&&(yield n),n=nb(),n&&(yield n),n=await ul({findPreview:!0}),n&&(yield n),n=await kg({findPreview:!0}),n&&(yield n),n=await ul({useAlternateBitness:!0,findPreview:!0}),n&&(yield n),n=rb(),n&&(yield n)}async function*ob(){for await(let n of ib())await n.exists()&&(yield n)}async function Ag(){for await(let n of ob())return n;return null}import{promises as Lg}from"fs";function Fg(n){n&&(delete n.DEBUG,Se&&delete n.LD_PRELOAD)}function Ug(n=It){return n.comspec||"cmd.exe"}function Ng(n){let t=[],e=!1,r=function(i){if(e){t.push(i);return}(!n.send(i,s=>{if(s&&console.error(s),e=!1,t.length>0){let a=t.slice(0);t=[],a.forEach(l=>r(l))}})||ue)&&(e=!0)};return{send:r}}var sb;(t=>{async function n(e,r,i){if(ir(e))return e;if(r===void 0&&(r=Mn()),lt(e)!==".")return V(r,e);if(i===void 0&&be(It.PATH)&&(i=It.PATH.split(Af)),i===void 0||i.length===0)return V(r,e);async function s(a){if(await se.exists(a)){let l;try{l=await Lg.stat(a)}catch(c){c.message.startsWith("EACCES")&&(l=await Lg.lstat(a))}return l?!l.isDirectory():!1}return!1}for(let a of i){let l;if(ir(a)?l=V(a,e):l=V(r,a,e),await s(l))return l;let c=l+".com";if(await s(c)||(c=l+".exe",await s(c)))return c}return V(r,e)}t.findExecutable=n})(sb||={});async function Mg(n,t){return n===1?ue?ub():Ug(t):cb(n,t)}var Ju=null;function cb(n,t){if(Se&&n===2||Vt&&n===3)return"/bin/bash";if(!Ju){let e;if(ue)e="/bin/bash";else{if(e=t.SHELL,!e)try{e=lb().shell}catch{}e||(e="sh"),e==="/bin/false"&&(e="/bin/bash")}Ju=e}return Ju}var Xu=null;async function ub(){return Xu||(Xu=(await Ag()).exePath),Xu}var fb=bc(Bg());var pb={o:g("optionsUpperCase","Options"),e:g("extensionsManagement","Extensions Management"),t:g("troubleshooting","Troubleshooting")};var Te={tunnel:{type:"subcommand",description:"Make the current machine accessible from vscode.dev or other machines through a secure tunnel",options:{"cli-data-dir":{type:"string",args:"dir",description:g("cliDataDir","Directory where CLI metadata should be stored.")},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"},user:{type:"subcommand",options:{login:{type:"subcommand",options:{provider:{type:"string"},"access-token":{type:"string"}}}}}}},"serve-web":{type:"subcommand",description:"Run a server that displays the editor UI in browsers.",options:{"cli-data-dir":{type:"string",args:"dir",description:g("cliDataDir","Directory where CLI metadata should be stored.")},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"}}},diff:{type:"boolean",cat:"o",alias:"d",args:["file","file"],description:g("diff","Compare two files with each other.")},merge:{type:"boolean",cat:"o",alias:"m",args:["path1","path2","base","result"],description:g("merge","Perform a three-way merge by providing paths for two modified versions of a file, the common origin of both modified versions and the output file to save merge results.")},add:{type:"boolean",cat:"o",alias:"a",args:"folder",description:g("add","Add folder(s) to the last active window.")},goto:{type:"boolean",cat:"o",alias:"g",args:"file:line[:character]",description:g("goto","Open a file at the path on the specified line and character position.")},"new-window":{type:"boolean",cat:"o",alias:"n",description:g("newWindow","Force to open a new window.")},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:g("reuseWindow","Force to open a file or folder in an already opened window.")},wait:{type:"boolean",cat:"o",alias:"w",description:g("wait","Wait for the files to be closed before returning.")},waitMarkerFilePath:{type:"string"},locale:{type:"string",cat:"o",args:"locale",description:g("locale","The locale to use (e.g. en-US or zh-TW).")},"user-data-dir":{type:"string",cat:"o",args:"dir",description:g("userDataDir","Specifies the directory that user data is kept in. Can be used to open multiple distinct instances of Code.")},profile:{type:"string",cat:"o",args:"profileName",description:g("profileName","Opens the provided folder or workspace with the given profile and associates the profile with the workspace. If the profile does not exist, a new empty one is created.")},help:{type:"boolean",cat:"o",alias:"h",description:g("help","Print usage.")},"extensions-dir":{type:"string",deprecates:["extensionHomePath"],cat:"e",args:"dir",description:g("extensionHomePath","Set the root path for extensions.")},"extensions-download-dir":{type:"string"},"builtin-extensions-dir":{type:"string"},"list-extensions":{type:"boolean",cat:"e",description:g("listExtensions","List the installed extensions.")},"show-versions":{type:"boolean",cat:"e",description:g("showVersions","Show versions of installed extensions, when using --list-extensions.")},category:{type:"string",allowEmptyValue:!0,cat:"e",description:g("category","Filters installed extensions by provided category, when using --list-extensions."),args:"category"},"install-extension":{type:"string[]",cat:"e",args:"ext-id | path",description:g("installExtension","Installs or updates an extension. The argument is either an extension id or a path to a VSIX. The identifier of an extension is '${publisher}.${name}'. Use '--force' argument to update to latest version. To install a specific version provide '@${version}'. For example: 'vscode.csharp@1.2.3'.")},"pre-release":{type:"boolean",cat:"e",description:g("install prerelease","Installs the pre-release version of the extension, when using --install-extension")},"uninstall-extension":{type:"string[]",cat:"e",args:"ext-id",description:g("uninstallExtension","Uninstalls an extension.")},"update-extensions":{type:"boolean",cat:"e",description:g("updateExtensions","Update the installed extensions.")},"enable-proposed-api":{type:"string[]",allowEmptyValue:!0,cat:"e",args:"ext-id",description:g("experimentalApis","Enables proposed API features for extensions. Can receive one or more extension IDs to enable individually.")},version:{type:"boolean",cat:"t",alias:"v",description:g("version","Print version.")},verbose:{type:"boolean",cat:"t",global:!0,description:g("verbose","Print verbose output (implies --wait).")},log:{type:"string[]",cat:"t",args:"level",global:!0,description:g("log","Log level to use. Default is 'info'. Allowed values are 'critical', 'error', 'warn', 'info', 'debug', 'trace', 'off'. You can also configure the log level of an extension by passing extension id and log level in the following format: '${publisher}.${name}:${logLevel}'. For example: 'vscode.csharp:trace'. Can receive one or more such entries.")},status:{type:"boolean",alias:"s",cat:"t",description:g("status","Print process usage and diagnostics information.")},"prof-startup":{type:"boolean",cat:"t",description:g("prof-startup","Run CPU profiler during startup.")},"prof-append-timers":{type:"string"},"prof-duration-markers":{type:"string[]"},"prof-duration-markers-file":{type:"string"},"no-cached-data":{type:"boolean"},"prof-startup-prefix":{type:"string"},"prof-v8-extensions":{type:"boolean"},"disable-extensions":{type:"boolean",deprecates:["disableExtensions"],cat:"t",description:g("disableExtensions","Disable all installed extensions. This option is not persisted and is effective only when the command opens a new window.")},"disable-extension":{type:"string[]",cat:"t",args:"ext-id",description:g("disableExtension","Disable the provided extension. This option is not persisted and is effective only when the command opens a new window.")},sync:{type:"string",cat:"t",description:g("turn sync","Turn sync on or off."),args:["on | off"]},"inspect-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugPluginHost"],args:"port",cat:"t",description:g("inspect-extensions","Allow debugging and profiling of extensions. Check the developer tools for the connection URI.")},"inspect-brk-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugBrkPluginHost"],args:"port",cat:"t",description:g("inspect-brk-extensions","Allow debugging and profiling of extensions with the extension host being paused after start. Check the developer tools for the connection URI.")},"disable-lcd-text":{type:"boolean",cat:"t",description:g("disableLCDText","Disable LCD font rendering.")},"disable-gpu":{type:"boolean",cat:"t",description:g("disableGPU","Disable GPU hardware acceleration.")},"disable-chromium-sandbox":{type:"boolean",cat:"t",description:g("disableChromiumSandbox","Use this option only when there is requirement to launch the application as sudo user on Linux or when running as an elevated user in an applocker environment on Windows.")},sandbox:{type:"boolean"},telemetry:{type:"boolean",cat:"t",description:g("telemetry","Shows all telemetry events which VS code collects.")},remote:{type:"string",allowEmptyValue:!0},"folder-uri":{type:"string[]",cat:"o",args:"uri"},"file-uri":{type:"string[]",cat:"o",args:"uri"},"locate-extension":{type:"string[]"},extensionDevelopmentPath:{type:"string[]"},extensionDevelopmentKind:{type:"string[]"},extensionTestsPath:{type:"string"},extensionEnvironment:{type:"string"},debugId:{type:"string"},debugRenderer:{type:"boolean"},"inspect-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-brk-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-search":{type:"string",deprecates:["debugSearch"],allowEmptyValue:!0},"inspect-brk-search":{type:"string",deprecates:["debugBrkSearch"],allowEmptyValue:!0},"inspect-sharedprocess":{type:"string",allowEmptyValue:!0},"inspect-brk-sharedprocess":{type:"string",allowEmptyValue:!0},"export-default-configuration":{type:"string"},"install-source":{type:"string"},"enable-smoke-test-driver":{type:"boolean"},logExtensionHostCommunication:{type:"boolean"},"skip-release-notes":{type:"boolean"},"skip-welcome":{type:"boolean"},"disable-telemetry":{type:"boolean"},"disable-updates":{type:"boolean"},"use-inmemory-secretstorage":{type:"boolean",deprecates:["disable-keytar"]},"password-store":{type:"string"},"disable-workspace-trust":{type:"boolean"},"disable-crash-reporter":{type:"boolean"},"crash-reporter-directory":{type:"string"},"crash-reporter-id":{type:"string"},"skip-add-to-recently-opened":{type:"boolean"},"open-url":{type:"boolean"},"file-write":{type:"boolean"},"file-chmod":{type:"boolean"},"install-builtin-extension":{type:"string[]"},force:{type:"boolean"},"do-not-sync":{type:"boolean"},trace:{type:"boolean"},"trace-category-filter":{type:"string"},"trace-options":{type:"string"},"preserve-env":{type:"boolean"},"force-user-env":{type:"boolean"},"force-disable-user-env":{type:"boolean"},"open-devtools":{type:"boolean"},"disable-gpu-sandbox":{type:"boolean"},logsPath:{type:"string"},"__enable-file-policy":{type:"boolean"},editSessionId:{type:"string"},continueOn:{type:"string"},"locate-shell-integration-path":{type:"string",args:["bash","pwsh","zsh","fish"]},"enable-coi":{type:"boolean"},"no-proxy-server":{type:"boolean"},"no-sandbox":{type:"boolean",alias:"sandbox"},"proxy-server":{type:"string"},"proxy-bypass-list":{type:"string"},"proxy-pac-url":{type:"string"},"js-flags":{type:"string"},inspect:{type:"string",allowEmptyValue:!0},"inspect-brk":{type:"string",allowEmptyValue:!0},nolazy:{type:"boolean"},"force-device-scale-factor":{type:"string"},"force-renderer-accessibility":{type:"boolean"},"ignore-certificate-errors":{type:"boolean"},"allow-insecure-localhost":{type:"boolean"},"log-net-log":{type:"string"},vmodule:{type:"string"},_urls:{type:"string[]"},"disable-dev-shm-usage":{type:"boolean"},"profile-temp":{type:"boolean"},"ozone-platform":{type:"string"},"enable-tracing":{type:"string"},"trace-startup-format":{type:"string"},"trace-startup-file":{type:"string"},"trace-startup-duration":{type:"string"},_:{type:"string[]"}};function gb(n,t){let e="";return t.args&&(Array.isArray(t.args)?e=` <${t.args.join("> <")}>`:e=` <${t.args}>`),t.alias?`-${t.alias} --${n}${e}`:`--${n}${e}`}function hb(n,t){let e=[];for(let r in n){let i=n[r],o=gb(r,i);e.push([o,i.description])}return $g(e,t)}function $g(n,t){let r=n.reduce((s,a)=>Math.max(s,a[0].length),12)+2+1;if(t-r<25)return n.reduce((s,a)=>s.concat([`  ${a[0]}`,`      ${a[1]}`]),[]);let i=t-r-1,o=[];for(let s of n){let a=s[0],l=mb(s[1],i),c=qg(r-a.length-2);o.push("  "+a+c+l[0]);for(let u=1;u<l.length;u++)o.push(qg(r)+l[u])}return o}function qg(n){return" ".repeat(n)}function mb(n,t){let e=[];for(;n.length;){let r=n.length<t?n.length:n.lastIndexOf(" ",t),i=n.slice(0,r).trim();n=n.slice(r),e.push(i)}return e}function zg(n,t,e,r,i){let o=process.stdout.isTTY&&process.stdout.columns||80,s=i?.noInputFiles!==!0?`[${g("paths","paths")}...]`:"",a=[`${n} ${e}`];a.push(""),a.push(`${g("usage","Usage")}: ${t} [${g("options","options")}]${s}`),a.push(""),i?.noPipe!==!0&&(ue?a.push(g("stdinWindows","To read output from another program, append '-' (e.g. 'echo Hello World | {0} -')",t)):a.push(g("stdinUnix","To read from stdin, append '-' (e.g. 'ps aux | grep code | {0} -')",t)),a.push(""));let l={},c=[];for(let u in r){let f=r[u];if(f.type==="subcommand")f.description&&c.push({command:u,description:f.description});else if(f.description&&f.cat){let p=l[f.cat];p||(l[f.cat]=p={}),p[u]=f}}for(let u in l){let f=u,p=l[f];p&&(a.push(pb[f]),a.push(...hb(p,o)),a.push(""))}return c.length&&(a.push(g("subcommands","Subcommands")),a.push(...$g(c.map(u=>[u.command,u.description]),o)),a.push("")),a.join(`
`)}function jg(n,t){return`${n||g("unknownVersion","Unknown version")}
${t||g("unknownCommit","Unknown commit")}
${process.arch}`}function Yu(n){return n.VSCODE_CLI==="1"}function Gg(n,t,e){return Math.min(Math.max(n,t),e)}var Zu;async function Hg(n,t,e,r){return e["force-disable-user-env"]?(t.trace("resolveShellEnv(): skipped (--force-disable-user-env)"),{}):ue?(t.trace("resolveShellEnv(): skipped (Windows)"),{}):Yu(r)&&!e["force-user-env"]?(t.trace("resolveShellEnv(): skipped (VSCODE_CLI is set)"),{}):(Yu(r)?t.trace("resolveShellEnv(): running (--force-user-env)"):t.trace("resolveShellEnv(): running (macOS/Linux)"),Zu||(Zu=ze.withAsyncBody(async(i,o)=>{let s=new at,a=1e4,l=n.getValue("application.shellEnvironmentResolutionTimeout");typeof l=="number"&&(a=Gg(l,1,120)*1e3);let c=setTimeout(()=>{s.dispose(!0),o(new Error(g("resolveShellEnvTimeout","Unable to resolve your shell environment in a reasonable time. Please review your shell configuration and restart.")))},a);try{i(await vb(t,s.token))}catch(u){!xn(u)&&!s.token.isCancellationRequested?o(new Error(g("resolveShellEnvError","Unable to resolve your shell environment: {0}",dn(u)))):i({})}finally{clearTimeout(c),s.dispose()}})),Zu)}async function vb(n,t){let e=process.env.ELECTRON_RUN_AS_NODE;n.trace("getUnixShellEnvironment#runAsNode",e);let r=process.env.ELECTRON_NO_ATTACH_CONSOLE;n.trace("getUnixShellEnvironment#noAttach",r);let i=Ke().replace(/-/g,"").substr(0,12),o=new RegExp(i+"({.*})"+i),s={...process.env,ELECTRON_RUN_AS_NODE:"1",ELECTRON_NO_ATTACH_CONSOLE:"1",VSCODE_RESOLVING_ENVIRONMENT:"1"};n.trace("getUnixShellEnvironment#env",s);let a=await Mg(_o,s);return n.trace("getUnixShellEnvironment#shell",a),new Promise((l,c)=>{if(t.isCancellationRequested)return c(new me);let u=je(a),f,p,h="";/^pwsh(-preview)?$/.test(u)?(f=`& '${process.execPath}' ${h} -p '''${i}'' + JSON.stringify(process.env) + ''${i}'''`,p=["-Login","-Command"]):u==="nu"?(f=`^'${process.execPath}' ${h} -p '"${i}" + JSON.stringify(process.env) + "${i}"'`,p=["-i","-l","-c"]):u==="xonsh"?(f=`import os, json; print("${i}", json.dumps(dict(os.environ)), "${i}")`,p=["-i","-l","-c"]):(f=`'${process.execPath}' ${h} -p '"${i}" + JSON.stringify(process.env) + "${i}"'`,u==="tcsh"||u==="csh"?p=["-ic"]:p=["-i","-l","-c"]),n.trace("getUnixShellEnvironment#spawn",JSON.stringify(p),f);let v=yb(a,[...p,f],{detached:!0,stdio:["ignore","pipe","pipe"],env:s});t.onCancellationRequested(()=>(v.kill(),c(new me))),v.on("error",S=>{n.error("getUnixShellEnvironment#errorChildProcess",dn(S)),c(S)});let y=[];v.stdout.on("data",S=>y.push(S));let I=[];v.stderr.on("data",S=>I.push(S)),v.on("close",(S,T)=>{let k=Buffer.concat(y).toString("utf8");n.trace("getUnixShellEnvironment#raw",k);let E=Buffer.concat(I).toString("utf8");if(E.trim()&&n.trace("getUnixShellEnvironment#stderr",E),S||T)return c(new Error(g("resolveShellEnvExitError","Unexpected exit code from spawned shell (code {0}, signal {1})",S,T)));let _=o.exec(k),N=_?_[1]:"{}";try{let A=JSON.parse(N);e?A.ELECTRON_RUN_AS_NODE=e:delete A.ELECTRON_RUN_AS_NODE,r?A.ELECTRON_NO_ATTACH_CONSOLE=r:delete A.ELECTRON_NO_ATTACH_CONSOLE,delete A.VSCODE_RESOLVING_ENVIRONMENT,delete A.XDG_RUNTIME_DIR,n.trace("getUnixShellEnvironment#result",A),l(A)}catch(A){n.error("getUnixShellEnvironment#errorCaught",dn(A)),c(A)}})})}import{parse as Ih}from"url";function vI(n,t){return n.protocol==="http:"?t.HTTP_PROXY||t.http_proxy||null:n.protocol==="https:"&&(t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy)||null}async function xh(n,t,e={}){let r=Ih(n),i=e.proxyUrl||vI(r,t);if(!i)return null;let o=Ih(i);if(!/^https?:$/.test(o.protocol||""))return null;let s={host:o.hostname||"",port:(o.port?+o.port:0)||(o.protocol==="https"?443:80),auth:o.auth,rejectUnauthorized:Kt(e.strictSSL)?e.strictSSL:!0};if(r.protocol==="http:"){let{default:a}=await Promise.resolve().then(()=>bc(ph()));return new a.HttpProxyAgent(i,s)}else{let{default:a}=await Promise.resolve().then(()=>bc(bh()));return new a.HttpsProxyAgent(i,s)}}import{createGunzip as bI}from"zlib";var Ki=class extends ol{constructor(e,r,i){super(i);this.configurationService=e;this.environmentService=r;this.configure(),this._register(e.onDidChangeConfiguration(o=>{o.affectsConfiguration("http")&&this.configure()}))}proxyUrl;strictSSL;authorization;shellEnvErrorLogged;configure(){let e=this.configurationService.getValue("http");this.proxyUrl=e?.proxy,this.strictSSL=!!e?.proxyStrictSSL,this.authorization=e?.proxyAuthorization}async request(e,r){let{proxyUrl:i,strictSSL:o}=this,s;try{s=await Hg(this.configurationService,this.logService,this.environmentService.args,process.env)}catch(c){this.shellEnvErrorLogged||(this.shellEnvErrorLogged=!0,this.logService.error("resolving shell environment failed",G(c)))}let a={...process.env,...s},l=e.agent?e.agent:await xh(e.url||"",a,{proxyUrl:i,strictSSL:o});return e.agent=l,e.strictSSL=o,this.authorization&&(e.headers={...e.headers||{},"Proxy-Authorization":this.authorization}),this.logAndRequest(e,()=>Sh(e,r))}async resolveProxy(e){}async lookupAuthorization(e){}async lookupKerberosAuthorization(e){try{let r=await import("kerberos"),i=new URL(e),o=this.configurationService.getValue("http.proxyKerberosServicePrincipal")||(process.platform==="win32"?`HTTP/${i.hostname}`:`HTTP@${i.hostname}`);return this.logService.debug("RequestService#lookupKerberosAuthorization Kerberos authentication lookup",`proxyURL:${i}`,`spn:${o}`),"Negotiate "+await(await r.initializeClient(o)).step("")}catch(r){this.logService.debug("RequestService#lookupKerberosAuthorization Kerberos authentication failed",r);return}}async loadCertificates(){return(await import("@vscode/proxy-agent")).loadSystemCertificates({log:this.logService})}};Ki=D([b(0,gn),b(1,dt),b(2,J)],Ki);async function II(n){return(Eh(n.url).protocol==="https:"?await import("https"):await import("http")).request}async function Sh(n,t){return ze.withAsyncBody(async(e,r)=>{let i=Eh(n.url),o=n.getRawRequest?n.getRawRequest(n):await II(n),s={hostname:i.hostname,port:i.port?parseInt(i.port):i.protocol==="https:"?443:80,protocol:i.protocol,path:i.path,method:n.type||"GET",headers:n.headers,agent:n.agent,rejectUnauthorized:Kt(n.strictSSL)?n.strictSSL:!0};n.user&&n.password&&(s.auth=n.user+":"+n.password);let a=o(s,l=>{let c=ui(n.followRedirects)?n.followRedirects:3;if(l.statusCode&&l.statusCode>=300&&l.statusCode<400&&c>0&&l.headers.location)Sh({...n,url:l.headers.location,followRedirects:c-1},t).then(e,r);else{let u=l;!n.isChromiumNetwork&&l.headers["content-encoding"]==="gzip"&&(u=l.pipe(bI())),e({res:l,stream:Up(u)})}});a.on("error",r),n.timeout&&a.setTimeout(n.timeout),n.isChromiumNetwork&&a.removeHeader("Content-Length"),n.data&&typeof n.data=="string"&&a.write(n.data),a.end(),t.onCancellationRequested(()=>{a.abort(),r(new me)})})}var vt=$("productService");var He=$("telemetryService"),L9=$("customEndpointTelemetryService");var wh="telemetry.telemetryLevel",Th="telemetry.enableCrashReporter",Ph="telemetry.enableTelemetry";var ss=class{constructor(t){this.value=t}isTrustedTelemetryValue=!0},sd=class{telemetryLevel=0;sessionId="someValue.sessionId";machineId="someValue.machineId";sqmId="someValue.sqmId";devDeviceId="someValue.devDeviceId";firstSessionDate="someValue.firstSessionDate";sendErrorTelemetry=!1;publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},_h=new sd;function Rh(n,t){return!t.isBuilt&&!t.disableTelemetry?!0:!(t.disableTelemetry||!n.enableTelemetry)}function Ch(n){let t=n.getValue(wh),e=n.getValue(Th);if(n.getValue(Ph)===!1||e===!1)return 0;switch(t??"all"){case"all":return 3;case"error":return 2;case"crash":return 1;case"off":return 0}}var bl=(i=>(i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i))(bl||{});(a=>{let n="error",t="warning",e="warn",r="info",i="ignore";function o(l){return l?Bt(n,l)?3:Bt(t,l)||Bt(e,l)?2:Bt(r,l)?1:0:0}a.fromValue=o;function s(l){switch(l){case 3:return n;case 2:return t;case 1:return r;default:return i}}a.toString=s})(bl||={});var Qe=bl;var xl="extensions.user.cache",Dh="extensions.builtin.cache",El="undefined_publisher";var kh=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var yn=class{value;_lower;constructor(t){this.value=t,this._lower=t.toLowerCase()}static equals(t,e){if(typeof t>"u"||t===null)return typeof e>"u"||e===null;if(typeof e>"u"||e===null)return!1;if(typeof t=="string"||typeof e=="string"){let r=typeof t=="string"?t:t.value,i=typeof e=="string"?e:e.value;return Bt(r,i)}return t._lower===e._lower}static toKey(t){return typeof t=="string"?t.toLowerCase():t._lower}};var Il=class{_map=new Map;clear(){this._map.clear()}delete(t){this._map.delete(yn.toKey(t))}get(t){return this._map.get(yn.toKey(t))}has(t){return this._map.has(yn.toKey(t))}set(t,e){this._map.set(yn.toKey(t),e)}values(){return this._map.values()}forEach(t){this._map.forEach(t)}[Symbol.iterator](){return this._map[Symbol.iterator]()}};function ad(n){return wI(n)}function wI(n){return n.contributes&&n.contributes.localizations?n.contributes.localizations.length>0:!1}function Oh(n){return n.map(t=>{let[e,r]=t.split("@");return{proposalName:e,version:r?parseInt(r):void 0}})}function Ah(n){return n.map(t=>t.split("@")[0])}var DD=$("IBuiltinExtensionsScannerService");var TI="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",Fh=new RegExp(TI),Lh="__web_extension";var cd="extensionInstallSource",Uh="dependecyOrPackExtensionInstall",Nh="clientTargetPlatform";function Mh(n){switch(n){case"win32-x64":return"Windows 64 bit";case"win32-arm64":return"Windows ARM";case"linux-x64":return"Linux 64 bit";case"linux-arm64":return"Linux ARM 64";case"linux-armhf":return"Linux ARM";case"alpine-x64":return"Alpine Linux 64 bit";case"alpine-arm64":return"Alpine ARM 64";case"darwin-x64":return"Mac";case"darwin-arm64":return"Mac Silicon";case"web":return"Web";case"universal":return"universal";case"unknown":return"unknown";case"undefined":return"undefined"}}function Vh(n){switch(n){case"win32-x64":return"win32-x64";case"win32-arm64":return"win32-arm64";case"linux-x64":return"linux-x64";case"linux-arm64":return"linux-arm64";case"linux-armhf":return"linux-armhf";case"alpine-x64":return"alpine-x64";case"alpine-arm64":return"alpine-arm64";case"darwin-x64":return"darwin-x64";case"darwin-arm64":return"darwin-arm64";case"web":return"web";case"universal":return"universal";default:return"unknown"}}function Sl(n,t){switch(n){case 3:return t==="x64"?"win32-x64":t==="arm64"?"win32-arm64":"unknown";case 2:return t==="x64"?"linux-x64":t==="arm64"?"linux-arm64":t==="arm"?"linux-armhf":"unknown";case"alpine":return t==="x64"?"alpine-x64":t==="arm64"?"alpine-arm64":"unknown";case 1:return t==="x64"?"darwin-x64":t==="arm64"?"darwin-arm64":"unknown";case 0:return"web"}}function Bi(n,t){return t==="web"&&!n.includes("web")}function as(n,t,e){return Bi(t,e)?!1:n==="undefined"||n==="universal"?!0:n==="unknown"?!1:n===e}function Wh(n){return n&&typeof n=="object"&&typeof n.id=="string"&&(!n.uuid||typeof n.uuid=="string")}var St=$("extensionGalleryService");var yr=class extends Error{constructor(e,r){super(e);this.code=r;this.name=r}};var Pe=class extends Error{constructor(e,r){super(e);this.code=r;this.name=r}},qi=$("extensionManagementService");var QD=$("IGlobalExtensionEnablementService"),JD=$("IExtensionTipsService"),XD=En("extensions","Extensions"),YD=En("preferences","Preferences");function X(n,t){return n.uuid&&t.uuid?n.uuid===t.uuid:n.id===t.id?!0:Oo(n.id,t.id)===0}var PI=/^([^.]+\..+)-(\d+\.\d+\.\d+)(-(.+))?$/,Be=class n{constructor(t,e,r="undefined"){this.identifier=t;this.version=e;this.targetPlatform=r;this.id=t.id}static create(t){let e=t.manifest?t.manifest.version:t.version,r=t.manifest?t.targetPlatform:t.properties.targetPlatform;return new n(t.identifier,e,r)}static parse(t){let e=PI.exec(t);return e&&e[1]&&e[2]?new n({id:e[1]},e[2],e[4]||void 0):null}id;toString(){return`${this.id}-${this.version}${this.targetPlatform!=="undefined"?`-${this.targetPlatform}`:""}`}equals(t){return t instanceof n?X(this,t)&&this.version===t.version&&this.targetPlatform===t.targetPlatform:!1}},_I=/^([^.]+\..+)@((prerelease)|(\d+\.\d+\.\d+(-.*)?))$/;function cs(n){let t=_I.exec(n);return t&&t[1]?[ls(t[1]),t[2]]:[ls(n),void 0]}function wl(n,t){return`${n}.${t}`}function ls(n){return n.toLowerCase()}function kt(n,t){return ls(wl(n??El,t))}function Tl(n,t){let e=[],r=i=>{for(let o of e)if(o.some(s=>X(t(s),t(i))))return o;return null};for(let i of n){let o=r(i);o?o.push(i):e.push([i])}return e}function Kh(n){return{id:n.identifier.id,name:n.manifest.name,galleryId:null,publisherId:n.publisherId,publisherName:n.manifest.publisher,publisherDisplayName:n.publisherDisplayName,dependencies:n.manifest.extensionDependencies&&n.manifest.extensionDependencies.length>0}}function us(n){return{id:new ss(n.identifier.id),name:new ss(n.name),version:n.version,galleryId:n.identifier.uuid,publisherId:n.publisherId,publisherName:n.publisher,publisherDisplayName:n.publisherDisplayName,isPreReleaseVersion:n.properties.isPreReleaseVersion,dependencies:!!(n.properties.dependencies&&n.properties.dependencies.length>0),isSigned:n.isSigned,...n.telemetryData}}var mk=new yn("pprice.better-merge");async function RI(n,t){if(!Se)return!1;let e;try{e=(await n.readFile(P.file("/etc/os-release"))).value.toString()}catch{try{e=(await n.readFile(P.file("/usr/lib/os-release"))).value.toString()}catch(i){t.debug("Error while getting the os-release file.",G(i))}}return!!e&&(e.match(/^ID=([^\u001b\r\n]*)/m)||[])[1]==="alpine"}async function Pl(n,t){let e=await RI(n,t),r=Sl(e?"alpine":Po,ea);return t.debug("ComputeTargetPlatform:",r),r}var _l={},re={exports:_l};(function(n,t){if(typeof _l=="object"&&typeof re=="object")re.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var e=t();for(var r in e)(typeof _l=="object"?_l:n)[r]=e[r]}})(typeof self<"u"?self:void 0,function(){return function(n){var t={};function e(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=n,e.c=t,e.d=function(r,i,o){e.o(r,i)||Object.defineProperty(r,i,{enumerable:!0,get:o})},e.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,i){if(1&i&&(r=e(r)),8&i||4&i&&typeof r=="object"&&r&&r.__esModule)return r;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:r}),2&i&&typeof r!="string")for(var s in r)e.d(o,s,function(a){return r[a]}.bind(null,s));return o},e.n=function(r){var i=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(i,"a",i),i},e.o=function(r,i){return Object.prototype.hasOwnProperty.call(r,i)},e.p="",e(e.s=0)}([function(n,t,e){(function(r){var i;t=n.exports=ge,i=typeof r=="object"&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?function(){var m=Array.prototype.slice.call(arguments,0);m.unshift("SEMVER"),console.log.apply(console,m)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var o=256,s=Number.MAX_SAFE_INTEGER||9007199254740991,a=t.re=[],l=t.src=[],c=0,u=c++;l[u]="0|[1-9]\\d*";var f=c++;l[f]="[0-9]+";var p=c++;l[p]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var h=c++;l[h]="("+l[u]+")\\.("+l[u]+")\\.("+l[u]+")";var v=c++;l[v]="("+l[f]+")\\.("+l[f]+")\\.("+l[f]+")";var y=c++;l[y]="(?:"+l[u]+"|"+l[p]+")";var I=c++;l[I]="(?:"+l[f]+"|"+l[p]+")";var S=c++;l[S]="(?:-("+l[y]+"(?:\\."+l[y]+")*))";var T=c++;l[T]="(?:-?("+l[I]+"(?:\\."+l[I]+")*))";var k=c++;l[k]="[0-9A-Za-z-]+";var E=c++;l[E]="(?:\\+("+l[k]+"(?:\\."+l[k]+")*))";var _=c++,N="v?"+l[h]+l[S]+"?"+l[E]+"?";l[_]="^"+N+"$";var A="[v=\\s]*"+l[v]+l[T]+"?"+l[E]+"?",Ie=c++;l[Ie]="^"+A+"$";var q=c++;l[q]="((?:<|>)?=?)";var ye=c++;l[ye]=l[f]+"|x|X|\\*";var Ht=c++;l[Ht]=l[u]+"|x|X|\\*";var pt=c++;l[pt]="[v=\\s]*("+l[Ht]+")(?:\\.("+l[Ht]+")(?:\\.("+l[Ht]+")(?:"+l[S]+")?"+l[E]+"?)?)?";var vn=c++;l[vn]="[v=\\s]*("+l[ye]+")(?:\\.("+l[ye]+")(?:\\.("+l[ye]+")(?:"+l[T]+")?"+l[E]+"?)?)?";var At=c++;l[At]="^"+l[q]+"\\s*"+l[pt]+"$";var F=c++;l[F]="^"+l[q]+"\\s*"+l[vn]+"$";var R=c++;l[R]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var L=c++;l[L]="(?:~>?)";var O=c++;l[O]="(\\s*)"+l[L]+"\\s+",a[O]=new RegExp(l[O],"g");var K=c++;l[K]="^"+l[L]+l[pt]+"$";var Y=c++;l[Y]="^"+l[L]+l[vn]+"$";var le=c++;l[le]="(?:\\^)";var ke=c++;l[ke]="(\\s*)"+l[le]+"\\s+",a[ke]=new RegExp(l[ke],"g");var qe=c++;l[qe]="^"+l[le]+l[pt]+"$";var z=c++;l[z]="^"+l[le]+l[vn]+"$";var Xn=c++;l[Xn]="^"+l[q]+"\\s*("+A+")$|^$";var An=c++;l[An]="^"+l[q]+"\\s*("+N+")$|^$";var Yn=c++;l[Yn]="(\\s*)"+l[q]+"\\s*("+A+"|"+l[pt]+")",a[Yn]=new RegExp(l[Yn],"g");var Sr=c++;l[Sr]="^\\s*("+l[pt]+")\\s+-\\s+("+l[pt]+")\\s*$";var Rs=c++;l[Rs]="^\\s*("+l[vn]+")\\s+-\\s+("+l[vn]+")\\s*$";var Cs=c++;l[Cs]="(<|>)?=?\\s*\\*";for(var wr=0;wr<35;wr++)i(wr,l[wr]),a[wr]||(a[wr]=new RegExp(l[wr]));function Tr(m,x){if(m instanceof ge)return m;if(typeof m!="string"||m.length>o||!(x?a[Ie]:a[_]).test(m))return null;try{return new ge(m,x)}catch{return null}}function ge(m,x){if(m instanceof ge){if(m.loose===x)return m;m=m.version}else if(typeof m!="string")throw new TypeError("Invalid Version: "+m);if(m.length>o)throw new TypeError("version is longer than "+o+" characters");if(!(this instanceof ge))return new ge(m,x);i("SemVer",m,x),this.loose=x;var w=m.trim().match(x?a[Ie]:a[_]);if(!w)throw new TypeError("Invalid Version: "+m);if(this.raw=m,this.major=+w[1],this.minor=+w[2],this.patch=+w[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");w[4]?this.prerelease=w[4].split(".").map(function(M){if(/^[0-9]+$/.test(M)){var j=+M;if(j>=0&&j<s)return j}return M}):this.prerelease=[],this.build=w[5]?w[5].split("."):[],this.format()}t.parse=Tr,t.valid=function(m,x){var w=Tr(m,x);return w?w.version:null},t.clean=function(m,x){var w=Tr(m.trim().replace(/^[=v]+/,""),x);return w?w.version:null},t.SemVer=ge,ge.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},ge.prototype.toString=function(){return this.version},ge.prototype.compare=function(m){return i("SemVer.compare",this.version,this.loose,m),m instanceof ge||(m=new ge(m,this.loose)),this.compareMain(m)||this.comparePre(m)},ge.prototype.compareMain=function(m){return m instanceof ge||(m=new ge(m,this.loose)),Yr(this.major,m.major)||Yr(this.minor,m.minor)||Yr(this.patch,m.patch)},ge.prototype.comparePre=function(m){if(m instanceof ge||(m=new ge(m,this.loose)),this.prerelease.length&&!m.prerelease.length)return-1;if(!this.prerelease.length&&m.prerelease.length)return 1;if(!this.prerelease.length&&!m.prerelease.length)return 0;var x=0;do{var w=this.prerelease[x],M=m.prerelease[x];if(i("prerelease compare",x,w,M),w===void 0&&M===void 0)return 0;if(M===void 0)return 1;if(w===void 0)return-1;if(w!==M)return Yr(w,M)}while(++x)},ge.prototype.inc=function(m,x){switch(m){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",x);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",x);break;case"prepatch":this.prerelease.length=0,this.inc("patch",x),this.inc("pre",x);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",x),this.inc("pre",x);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var w=this.prerelease.length;--w>=0;)typeof this.prerelease[w]=="number"&&(this.prerelease[w]++,w=-2);w===-1&&this.prerelease.push(0)}x&&(this.prerelease[0]===x?isNaN(this.prerelease[1])&&(this.prerelease=[x,0]):this.prerelease=[x,0]);break;default:throw new Error("invalid increment argument: "+m)}return this.format(),this.raw=this.version,this},t.inc=function(m,x,w,M){typeof w=="string"&&(M=w,w=void 0);try{return new ge(m,w).inc(x,M).version}catch{return null}},t.diff=function(m,x){if(hc(m,x))return null;var w=Tr(m),M=Tr(x);if(w.prerelease.length||M.prerelease.length){for(var j in w)if((j==="major"||j==="minor"||j==="patch")&&w[j]!==M[j])return"pre"+j;return"prerelease"}for(var j in w)if((j==="major"||j==="minor"||j==="patch")&&w[j]!==M[j])return j},t.compareIdentifiers=Yr;var jd=/^[0-9]+$/;function Yr(m,x){var w=jd.test(m),M=jd.test(x);return w&&M&&(m=+m,x=+x),w&&!M?-1:M&&!w?1:m<x?-1:m>x?1:0}function Fn(m,x,w){return new ge(m,w).compare(new ge(x,w))}function Ds(m,x,w){return Fn(m,x,w)>0}function ks(m,x,w){return Fn(m,x,w)<0}function hc(m,x,w){return Fn(m,x,w)===0}function Gd(m,x,w){return Fn(m,x,w)!==0}function mc(m,x,w){return Fn(m,x,w)>=0}function yc(m,x,w){return Fn(m,x,w)<=0}function Os(m,x,w,M){var j;switch(x){case"===":typeof m=="object"&&(m=m.version),typeof w=="object"&&(w=w.version),j=m===w;break;case"!==":typeof m=="object"&&(m=m.version),typeof w=="object"&&(w=w.version),j=m!==w;break;case"":case"=":case"==":j=hc(m,w,M);break;case"!=":j=Gd(m,w,M);break;case">":j=Ds(m,w,M);break;case">=":j=mc(m,w,M);break;case"<":j=ks(m,w,M);break;case"<=":j=yc(m,w,M);break;default:throw new TypeError("Invalid operator: "+x)}return j}function Qt(m,x){if(m instanceof Qt){if(m.loose===x)return m;m=m.value}if(!(this instanceof Qt))return new Qt(m,x);i("comparator",m,x),this.loose=x,this.parse(m),this.semver===ho?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}t.rcompareIdentifiers=function(m,x){return Yr(x,m)},t.major=function(m,x){return new ge(m,x).major},t.minor=function(m,x){return new ge(m,x).minor},t.patch=function(m,x){return new ge(m,x).patch},t.compare=Fn,t.compareLoose=function(m,x){return Fn(m,x,!0)},t.rcompare=function(m,x,w){return Fn(x,m,w)},t.sort=function(m,x){return m.sort(function(w,M){return t.compare(w,M,x)})},t.rsort=function(m,x){return m.sort(function(w,M){return t.rcompare(w,M,x)})},t.gt=Ds,t.lt=ks,t.eq=hc,t.neq=Gd,t.gte=mc,t.lte=yc,t.cmp=Os,t.Comparator=Qt;var ho={};function Ae(m,x){if(m instanceof Ae)return m.loose===x?m:new Ae(m.raw,x);if(m instanceof Qt)return new Ae(m.value,x);if(!(this instanceof Ae))return new Ae(m,x);if(this.loose=x,this.raw=m,this.set=m.split(/\s*\|\|\s*/).map(function(w){return this.parseRange(w.trim())},this).filter(function(w){return w.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+m);this.format()}function bt(m){return!m||m.toLowerCase()==="x"||m==="*"}function ty(m,x,w,M,j,Je,he,wt,Ne,gt,bn,Me,it){return((x=bt(w)?"":bt(M)?">="+w+".0.0":bt(j)?">="+w+"."+M+".0":">="+x)+" "+(wt=bt(Ne)?"":bt(gt)?"<"+(+Ne+1)+".0.0":bt(bn)?"<"+Ne+"."+(+gt+1)+".0":Me?"<="+Ne+"."+gt+"."+bn+"-"+Me:"<="+wt)).trim()}function ny(m,x){for(var w=0;w<m.length;w++)if(!m[w].test(x))return!1;if(x.prerelease.length){for(w=0;w<m.length;w++)if(i(m[w].semver),m[w].semver!==ho&&m[w].semver.prerelease.length>0){var M=m[w].semver;if(M.major===x.major&&M.minor===x.minor&&M.patch===x.patch)return!0}return!1}return!0}function As(m,x,w){try{x=new Ae(x,w)}catch{return!1}return x.test(m)}function vc(m,x,w,M){var j,Je,he,wt,Ne;switch(m=new ge(m,M),x=new Ae(x,M),w){case">":j=Ds,Je=yc,he=ks,wt=">",Ne=">=";break;case"<":j=ks,Je=mc,he=Ds,wt="<",Ne="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(As(m,x,M))return!1;for(var gt=0;gt<x.set.length;++gt){var bn=x.set[gt],Me=null,it=null;if(bn.forEach(function(Tt){Tt.semver===ho&&(Tt=new Qt(">=0.0.0")),Me=Me||Tt,it=it||Tt,j(Tt.semver,Me.semver,M)?Me=Tt:he(Tt.semver,it.semver,M)&&(it=Tt)}),Me.operator===wt||Me.operator===Ne||(!it.operator||it.operator===wt)&&Je(m,it.semver)||it.operator===Ne&&he(m,it.semver))return!1}return!0}Qt.prototype.parse=function(m){var x=this.loose?a[Xn]:a[An],w=m.match(x);if(!w)throw new TypeError("Invalid comparator: "+m);this.operator=w[1],this.operator==="="&&(this.operator=""),w[2]?this.semver=new ge(w[2],this.loose):this.semver=ho},Qt.prototype.toString=function(){return this.value},Qt.prototype.test=function(m){return i("Comparator.test",m,this.loose),this.semver===ho||(typeof m=="string"&&(m=new ge(m,this.loose)),Os(m,this.operator,this.semver,this.loose))},Qt.prototype.intersects=function(m,x){if(!(m instanceof Qt))throw new TypeError("a Comparator is required");var w;if(this.operator==="")return w=new Ae(m.value,x),As(this.value,w,x);if(m.operator==="")return w=new Ae(this.value,x),As(m.semver,w,x);var M=!(this.operator!==">="&&this.operator!==">"||m.operator!==">="&&m.operator!==">"),j=!(this.operator!=="<="&&this.operator!=="<"||m.operator!=="<="&&m.operator!=="<"),Je=this.semver.version===m.semver.version,he=!(this.operator!==">="&&this.operator!=="<="||m.operator!==">="&&m.operator!=="<="),wt=Os(this.semver,"<",m.semver,x)&&(this.operator===">="||this.operator===">")&&(m.operator==="<="||m.operator==="<"),Ne=Os(this.semver,">",m.semver,x)&&(this.operator==="<="||this.operator==="<")&&(m.operator===">="||m.operator===">");return M||j||Je&&he||wt||Ne},t.Range=Ae,Ae.prototype.format=function(){return this.range=this.set.map(function(m){return m.join(" ").trim()}).join("||").trim(),this.range},Ae.prototype.toString=function(){return this.range},Ae.prototype.parseRange=function(m){var x=this.loose;m=m.trim(),i("range",m,x);var w=x?a[Rs]:a[Sr];m=m.replace(w,ty),i("hyphen replace",m),m=m.replace(a[Yn],"$1$2$3"),i("comparator trim",m,a[Yn]),m=(m=(m=m.replace(a[O],"$1~")).replace(a[ke],"$1^")).split(/\s+/).join(" ");var M=x?a[Xn]:a[An],j=m.split(" ").map(function(Je){return function(he,wt){return i("comp",he),he=function(Ne,gt){return Ne.trim().split(/\s+/).map(function(bn){return function(Me,it){i("caret",Me,it);var Tt=it?a[z]:a[qe];return Me.replace(Tt,function(on,H,ie,xe,Oe){var ot;return i("caret",Me,on,H,ie,xe,Oe),bt(H)?ot="":bt(ie)?ot=">="+H+".0.0 <"+(+H+1)+".0.0":bt(xe)?ot=H==="0"?">="+H+"."+ie+".0 <"+H+"."+(+ie+1)+".0":">="+H+"."+ie+".0 <"+(+H+1)+".0.0":Oe?(i("replaceCaret pr",Oe),Oe.charAt(0)!=="-"&&(Oe="-"+Oe),ot=H==="0"?ie==="0"?">="+H+"."+ie+"."+xe+Oe+" <"+H+"."+ie+"."+(+xe+1):">="+H+"."+ie+"."+xe+Oe+" <"+H+"."+(+ie+1)+".0":">="+H+"."+ie+"."+xe+Oe+" <"+(+H+1)+".0.0"):(i("no pr"),ot=H==="0"?ie==="0"?">="+H+"."+ie+"."+xe+" <"+H+"."+ie+"."+(+xe+1):">="+H+"."+ie+"."+xe+" <"+H+"."+(+ie+1)+".0":">="+H+"."+ie+"."+xe+" <"+(+H+1)+".0.0"),i("caret return",ot),ot})}(bn,gt)}).join(" ")}(he,wt),i("caret",he),he=function(Ne,gt){return Ne.trim().split(/\s+/).map(function(bn){return function(Me,it){var Tt=it?a[Y]:a[K];return Me.replace(Tt,function(on,H,ie,xe,Oe){var ot;return i("tilde",Me,on,H,ie,xe,Oe),bt(H)?ot="":bt(ie)?ot=">="+H+".0.0 <"+(+H+1)+".0.0":bt(xe)?ot=">="+H+"."+ie+".0 <"+H+"."+(+ie+1)+".0":Oe?(i("replaceTilde pr",Oe),Oe.charAt(0)!=="-"&&(Oe="-"+Oe),ot=">="+H+"."+ie+"."+xe+Oe+" <"+H+"."+(+ie+1)+".0"):ot=">="+H+"."+ie+"."+xe+" <"+H+"."+(+ie+1)+".0",i("tilde return",ot),ot})}(bn,gt)}).join(" ")}(he,wt),i("tildes",he),he=function(Ne,gt){return i("replaceXRanges",Ne,gt),Ne.split(/\s+/).map(function(bn){return function(Me,it){Me=Me.trim();var Tt=it?a[F]:a[At];return Me.replace(Tt,function(on,H,ie,xe,Oe,ot){i("xRange",Me,on,H,ie,xe,Oe,ot);var Hd=bt(ie),mo=Hd||bt(xe),yo=mo||bt(Oe);return H==="="&&yo&&(H=""),Hd?on=H===">"||H==="<"?"<0.0.0":"*":H&&yo?(mo&&(xe=0),yo&&(Oe=0),H===">"?(H=">=",mo?(ie=+ie+1,xe=0,Oe=0):yo&&(xe=+xe+1,Oe=0)):H==="<="&&(H="<",mo?ie=+ie+1:xe=+xe+1),on=H+ie+"."+xe+"."+Oe):mo?on=">="+ie+".0.0 <"+(+ie+1)+".0.0":yo&&(on=">="+ie+"."+xe+".0 <"+ie+"."+(+xe+1)+".0"),i("xRange return",on),on})}(bn,gt)}).join(" ")}(he,wt),i("xrange",he),he=function(Ne,gt){return i("replaceStars",Ne,gt),Ne.trim().replace(a[Cs],"")}(he,wt),i("stars",he),he}(Je,x)}).join(" ").split(/\s+/);return this.loose&&(j=j.filter(function(Je){return!!Je.match(M)})),j=j.map(function(Je){return new Qt(Je,x)})},Ae.prototype.intersects=function(m,x){if(!(m instanceof Ae))throw new TypeError("a Range is required");return this.set.some(function(w){return w.every(function(M){return m.set.some(function(j){return j.every(function(Je){return M.intersects(Je,x)})})})})},t.toComparators=function(m,x){return new Ae(m,x).set.map(function(w){return w.map(function(M){return M.value}).join(" ").trim().split(" ")})},Ae.prototype.test=function(m){if(!m)return!1;typeof m=="string"&&(m=new ge(m,this.loose));for(var x=0;x<this.set.length;x++)if(ny(this.set[x],m))return!0;return!1},t.satisfies=As,t.maxSatisfying=function(m,x,w){var M=null,j=null;try{var Je=new Ae(x,w)}catch{return null}return m.forEach(function(he){Je.test(he)&&(M&&j.compare(he)!==-1||(j=new ge(M=he,w)))}),M},t.minSatisfying=function(m,x,w){var M=null,j=null;try{var Je=new Ae(x,w)}catch{return null}return m.forEach(function(he){Je.test(he)&&(M&&j.compare(he)!==1||(j=new ge(M=he,w)))}),M},t.validRange=function(m,x){try{return new Ae(m,x).range||"*"}catch{return null}},t.ltr=function(m,x,w){return vc(m,x,"<",w)},t.gtr=function(m,x,w){return vc(m,x,">",w)},t.outside=vc,t.prerelease=function(m,x){var w=Tr(m,x);return w&&w.prerelease.length?w.prerelease:null},t.intersects=function(m,x,w){return m=new Ae(m,w),x=new Ae(x,w),m.intersects(x)},t.coerce=function(m){if(m instanceof ge)return m;if(typeof m!="string")return null;var x=m.match(a[R]);return x==null?null:Tr((x[1]||"0")+"."+(x[2]||"0")+"."+(x[3]||"0"))}}).call(this,e(1))},function(n,t){var e,r,i=n.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(I){if(e===setTimeout)return setTimeout(I,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(I,0);try{return e(I,0)}catch{try{return e.call(null,I,0)}catch{return e.call(this,I,0)}}}(function(){try{e=typeof setTimeout=="function"?setTimeout:o}catch{e=o}try{r=typeof clearTimeout=="function"?clearTimeout:s}catch{r=s}})();var l,c=[],u=!1,f=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):f=-1,c.length&&h())}function h(){if(!u){var I=a(p);u=!0;for(var S=c.length;S;){for(l=c,c=[];++f<S;)l&&l[f].run();f=-1,S=c.length}l=null,u=!1,function(T){if(r===clearTimeout)return clearTimeout(T);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(T);try{r(T)}catch{try{return r.call(null,T)}catch{return r.call(this,T)}}}(I)}}function v(I,S){this.fun=I,this.array=S}function y(){}i.nextTick=function(I){var S=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)S[T-1]=arguments[T];c.push(new v(I,S)),c.length!==1||u||a(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(I){return[]},i.binding=function(I){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(I){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}])});var vk=re.exports.SEMVER_SPEC_VERSION,bk=re.exports.parse,Bh=re.exports.valid,Ik=re.exports.coerce,xk=re.exports.clean,Ek=re.exports.inc,Sk=re.exports.major,wk=re.exports.minor,Tk=re.exports.patch,Pk=re.exports.prerelease,ds=re.exports.gt,_k=re.exports.gte,Rk=re.exports.lt,Ck=re.exports.lte,qh=re.exports.eq,Dk=re.exports.neq,kk=re.exports.cmp,Ok=re.exports.compare,Rl=re.exports.rcompare,Ak=re.exports.compareIdentifiers,Fk=re.exports.rcompareIdentifiers,Lk=re.exports.compareBuild,Uk=re.exports.sort,Nk=re.exports.rsort,Mk=re.exports.diff,Vk=re.exports.validRange,Wk=re.exports.satisfies,Kk=re.exports.maxSatisfying,Bk=re.exports.minSatisfying,qk=re.exports.minVersion,$k=re.exports.gtr,zk=re.exports.ltr,jk=re.exports.outside,Gk=re.exports.intersects,Hk=re.exports.SemVer,Qk=re.exports.Comparator,Jk=re.exports.Range;var CI={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts"},aiTextSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProviderNew.d.ts"},attributableCoverage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.attributableCoverage.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:2},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},chatVariableResolver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribChatParticipantDetection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribChatParticipantDetection.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribIssueReporter:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},createFileSystemWatcher:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},documentPaste:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileComments:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProviderNew.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts"},findFiles2New:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2New.d.ts"},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFilesNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFilesNew.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},lmTools:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.lmTools.d.ts",version:6},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},showLocal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textSearchCompleteNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchCompleteNew.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProviderNew.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},$h=Object.freeze(CI);var jh=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,DI=/^-(\d{4})(\d{2})(\d{2})$/;function kI(n){return n=n.trim(),n==="*"||jh.test(n)}function ud(n){if(!kI(n))return null;if(n=n.trim(),n==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};let t=n.match(jh);return t?{hasCaret:t[1]==="^",hasGreaterEquals:t[1]===">=",majorBase:t[2]==="x"?0:parseInt(t[2],10),majorMustEqual:t[2]!=="x",minorBase:t[4]==="x"?0:parseInt(t[4],10),minorMustEqual:t[4]!=="x",patchBase:t[6]==="x"?0:parseInt(t[6],10),patchMustEqual:t[6]!=="x",preRelease:t[8]||null}:null}function dd(n){if(!n)return null;let t=n.majorBase,e=n.majorMustEqual,r=n.minorBase,i=n.minorMustEqual,o=n.patchBase,s=n.patchMustEqual;n.hasCaret&&(t===0||(i=!1),s=!1);let a=0;if(n.preRelease){let l=DI.exec(n.preRelease);if(l){let[,c,u,f]=l;a=Date.UTC(Number(c),Number(u)-1,Number(f))}}return{majorBase:t,majorMustEqual:e,minorBase:r,minorMustEqual:i,patchBase:o,patchMustEqual:s,isMinimum:n.hasGreaterEquals,notBefore:a}}function OI(n,t,e){let r;typeof n=="string"?r=dd(ud(n)):r=n;let i;t instanceof Date?i=t.getTime():typeof t=="string"&&(i=new Date(t).getTime());let o;if(typeof e=="string"?o=dd(ud(e)):o=e,!r||!o)return!1;let s=r.majorBase,a=r.minorBase,l=r.patchBase,c=o.majorBase,u=o.minorBase,f=o.patchBase,p=o.notBefore,h=o.majorMustEqual,v=o.minorMustEqual,y=o.patchMustEqual;return o.isMinimum?s>c?!0:s<c?!1:a>u?!0:a<u||i&&i<p?!1:l>=f:(s===1&&c===0&&(!h||!v||!y)&&(c=1,u=0,f=0,h=!0,v=!1,y=!1),s<c?!1:s>c?!h:a<u?!1:a>u?!v:l<f?!1:l>f?!y:!(i&&i<p))}function Gh(n,t,e,r,i,o){let s=[];if(typeof r.publisher<"u"&&typeof r.publisher!="string")return s.push([Qe.Error,g("extensionDescription.publisher","property publisher must be of type `string`.")]),s;if(typeof r.name!="string")return s.push([Qe.Error,g("extensionDescription.name","property `{0}` is mandatory and must be of type `string`","name")]),s;if(typeof r.version!="string")return s.push([Qe.Error,g("extensionDescription.version","property `{0}` is mandatory and must be of type `string`","version")]),s;if(!r.engines)return s.push([Qe.Error,g("extensionDescription.engines","property `{0}` is mandatory and must be of type `object`","engines")]),s;if(typeof r.engines.vscode!="string")return s.push([Qe.Error,g("extensionDescription.engines.vscode","property `{0}` is mandatory and must be of type `string`","engines.vscode")]),s;if(typeof r.extensionDependencies<"u"&&!zh(r.extensionDependencies))return s.push([Qe.Error,g("extensionDescription.extensionDependencies","property `{0}` can be omitted or must be of type `string[]`","extensionDependencies")]),s;if(typeof r.activationEvents<"u"){if(!zh(r.activationEvents))return s.push([Qe.Error,g("extensionDescription.activationEvents1","property `{0}` can be omitted or must be of type `string[]`","activationEvents")]),s;if(typeof r.main>"u"&&typeof r.browser>"u")return s.push([Qe.Error,g("extensionDescription.activationEvents2","property `{0}` should be omitted if the extension doesn't have a `{1}` or `{2}` property.","activationEvents","main","browser")]),s}if(typeof r.extensionKind<"u"&&typeof r.main>"u"&&s.push([Qe.Warning,g("extensionDescription.extensionKind","property `{0}` can be defined only if property `main` is also defined.","extensionKind")]),typeof r.main<"u"){if(typeof r.main!="string")return s.push([Qe.Error,g("extensionDescription.main1","property `{0}` can be omitted or must be of type `string`","main")]),s;{let c=B(e,r.main);ou(c,e)||s.push([Qe.Warning,g("extensionDescription.main2","Expected `main` ({0}) to be included inside extension's folder ({1}). This might make the extension non-portable.",c.path,e.path)])}}if(typeof r.browser<"u"){if(typeof r.browser!="string")return s.push([Qe.Error,g("extensionDescription.browser1","property `{0}` can be omitted or must be of type `string`","browser")]),s;{let c=B(e,r.browser);ou(c,e)||s.push([Qe.Warning,g("extensionDescription.browser2","Expected `browser` ({0}) to be included inside extension's folder ({1}). This might make the extension non-portable.",c.path,e.path)])}}if(!Bh(r.version))return s.push([Qe.Error,g("notSemver","Extension version is not semver compatible.")]),s;let a=[];if(!AI(n,t,r,i,a))for(let c of a)s.push([Qe.Error,c]);if(o&&r.enabledApiProposals?.length){let c=[];if(!fs([...r.enabledApiProposals],c))for(let u of c)s.push([Qe.Error,u])}return s}function AI(n,t,e,r,i){return r||typeof e.main>"u"&&typeof e.browser>"u"?!0:Hh(n,t,e.engines.vscode,i)}function $i(n,t,e){return n==="*"||Hh(t,e,n)}function fs(n,t){if(n.length===0)return!0;let e=Array.isArray(t)?t:void 0,r=(e?void 0:t)??$h,i=[],o=Oh(n);for(let{proposalName:s,version:a}of o){let l=r[s];l&&a&&l.version!==a&&i.push(g("apiProposalMismatch","Extension is using an API proposal '{0}' that is not compatible with the current version of VS Code.",s))}return e?.push(...i),i.length===0}function Hh(n,t,e,r=[]){let i=dd(ud(e));if(!i)return r.push(g("versionSyntax","Could not parse `engines.vscode` value {0}. Please use, for example: ^1.22.0, ^1.22.x, etc.",e)),!1;if(i.majorBase===0){if(!i.majorMustEqual||!i.minorMustEqual)return r.push(g("versionSpecificity1","Version specified in `engines.vscode` ({0}) is not specific enough. For vscode versions before 1.0.0, please define at a minimum the major and minor desired version. E.g. ^0.10.0, 0.10.x, 0.11.0, etc.",e)),!1}else if(!i.majorMustEqual)return r.push(g("versionSpecificity2","Version specified in `engines.vscode` ({0}) is not specific enough. For vscode versions after 1.0.0, please define at a minimum the major desired version. E.g. ^1.10.0, 1.10.x, 1.x.x, 2.x.x, etc.",e)),!1;return OI(n,t,i)?!0:(r.push(g("versionMismatch","Extension is not compatible with Code {0}. Extension requires: {1}.",n,e)),!1)}function zh(n){if(!Array.isArray(n))return!1;for(let t=0,e=n.length;t<e;t++)if(typeof n[t]!="string")return!1;return!0}var fd={};ay(fd,{getMarks:()=>FI,mark:()=>zi});var ps={exports:{}};(function(){function t(o){let s=[];typeof o=="number"&&s.push("code/timeOrigin",o);function a(c){s.push(c,Date.now())}function l(){let c=[];for(let u=0;u<s.length;u+=2)c.push({name:s[u],startTime:s[u+1]});return c}return{mark:a,getMarks:l}}function e(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?t():{mark(o){performance.mark(o)},getMarks(){let o=performance.timeOrigin;typeof o!="number"&&(o=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);let s=[{name:"code/timeOrigin",startTime:Math.round(o)}];for(let a of performance.getEntriesByType("mark"))s.push({name:a.name,startTime:Math.round(o+a.startTime)});return s}};if(typeof process=="object"){let o=performance?.timeOrigin;return t(o)}else return console.trace("perf-util loaded in UNKNOWN environment"),t()}function r(o){return o.MonacoPerformanceMarks||(o.MonacoPerformanceMarks=e()),o.MonacoPerformanceMarks}var i;typeof global=="object"?i=global:typeof self=="object"?i=self:i={},typeof ps=="object"&&typeof ps.exports=="object"?ps.exports=r(i):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),i.perf=r(i))})();var zi=ps.exports.mark,FI=ps.exports.getMarks;function zr(n,t=0){if(!n||t>200)return n;if(typeof n=="object"){switch(n.$mid){case 1:return P.revive(n);case 2:return new RegExp(n.source,n.flags);case 17:return new Date(n.source)}if(n instanceof W||n instanceof Uint8Array)return n;if(Array.isArray(n))for(let e=0;e<n.length;++e)n[e]=zr(n[e],t+1);else for(let e in n)Object.hasOwnProperty.call(n,e)&&(n[e]=zr(n[e],t+1))}return n}var _e=$("IUriIdentityService");function Qh(n){let t=n;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&typeof t.isDefault=="boolean"&&typeof t.name=="string"&&P.isUri(t.location)&&P.isUri(t.globalStorageHome)&&P.isUri(t.settingsResource)&&P.isUri(t.keybindingsResource)&&P.isUri(t.tasksResource)&&P.isUri(t.snippetsHome)&&P.isUri(t.extensionsResource))}var rt=$("IUserDataProfilesService");function Dl(n,t,e,r,i,o){return{id:n,name:t,location:e,isDefault:!1,shortName:i?.shortName,icon:i?.icon,globalStorageHome:o&&i?.useDefaultFlags?.globalState?o.globalStorageHome:B(e,"globalStorage"),settingsResource:o&&i?.useDefaultFlags?.settings?o.settingsResource:B(e,"settings.json"),keybindingsResource:o&&i?.useDefaultFlags?.keybindings?o.keybindingsResource:B(e,"keybindings.json"),tasksResource:o&&i?.useDefaultFlags?.tasks?o.tasksResource:B(e,"tasks.json"),snippetsHome:o&&i?.useDefaultFlags?.snippets?o.snippetsHome:B(e,"snippets"),extensionsResource:o&&i?.useDefaultFlags?.extensions?o.extensionsResource:B(e,"extensions.json"),cacheHome:B(r,n),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient}}var ji=class extends U{constructor(e,r,i,o){super();this.environmentService=e;this.fileService=r;this.uriIdentityService=i;this.logService=o;this.profilesHome=B(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=B(this.environmentService.cacheHome,"CachedProfilesData")}static PROFILES_KEY="userDataProfiles";static PROFILE_ASSOCIATIONS_KEY="profileAssociations";_serviceBrand;enabled=!0;profilesHome;profilesCacheHome;get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}_onDidChangeProfiles=this._register(new C);onDidChangeProfiles=this._onDidChangeProfiles.event;_onWillCreateProfile=this._register(new C);onWillCreateProfile=this._onWillCreateProfile.event;_onWillRemoveProfile=this._register(new C);onWillRemoveProfile=this._onWillRemoveProfile.event;_onDidResetWorkspaces=this._register(new C);onDidResetWorkspaces=this._onDidResetWorkspaces.event;profileCreationPromises=new Map;transientProfilesObject={profiles:[],folders:new ve,workspaces:new ve,emptyWindows:new Map};init(){this._profilesObject=void 0}setEnablement(e){this.enabled!==e&&(this._profilesObject=void 0,this.enabled=e)}isEnabled(){return this.enabled}_profilesObject;get profilesObject(){if(!this._profilesObject){let e=this.createDefaultProfile(),r=[e];if(this.enabled)try{for(let s of this.getStoredProfiles()){if(!s.name||!be(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}r.push(Dl(_n(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},e))}}catch(s){this.logService.error(s)}let i=new ve,o=new Map;if(r.length)try{let s=this.getStoredProfileAssociations();if(s.workspaces)for(let[a,l]of Object.entries(s.workspaces)){let c=P.parse(a),u=r.find(f=>f.id===l);u&&i.set(c,u)}if(s.emptyWindows)for(let[a,l]of Object.entries(s.emptyWindows)){let c=r.find(u=>u.id===l);c&&o.set(a,c)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:r,workspaces:i,emptyWindows:o}}return this._profilesObject}createDefaultProfile(){let e=Dl("__default__profile__",g("defaultProfile","Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:!0}}async createTransientProfile(e){let r="Temp",i=new RegExp(`${pi(r)}\\s(\\d+)`),o=0;for(let a of this.profiles){let l=i.exec(a.name),c=l?parseInt(l[1]):0;o=c>o?c:o}let s=`${r} ${o+1}`;return this.createProfile(Pn(Ke()).toString(16),s,{transient:!0},e)}async createNamedProfile(e,r,i){return this.createProfile(Pn(Ke()).toString(16),e,r,i)}async createProfile(e,r,i,o){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let s=await this.doCreateProfile(e,r,i);return o&&await this.setProfileForWorkspace(o,s),s}async doCreateProfile(e,r,i){if(!be(r)||!r)throw new Error("Name of the profile is mandatory and must be of type `string`");let o=this.profileCreationPromises.get(r);return o||(o=(async()=>{try{if(this.profiles.find(c=>c.name===r||c.id===e))throw new Error(`Profile with ${r} name already exists`);let a=Dl(e,r,B(this.profilesHome,e),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(a.location);let l=[];return this._onWillCreateProfile.fire({profile:a,join(c){l.push(c)}}),await ze.settled(l),this.updateProfiles([a],[],[]),a}finally{this.profileCreationPromises.delete(r)}})(),this.profileCreationPromises.set(r,o)),o}async updateProfile(e,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(o=>o.id===e.id);if(!i)throw new Error(`Profile '${e.name}' does not exist`);return i=Dl(i.id,r.name??i.name,i.location,this.profilesCacheHome,{shortName:r.shortName??i.shortName,icon:r.icon===null?void 0:r.icon??i.icon,transient:r.transient??i.isTransient,useDefaultFlags:r.useDefaultFlags??i.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[i]),i}async removeProfile(e){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(e.isDefault)throw new Error("Cannot remove default profile");let r=this.profiles.find(o=>o.id===e.id);if(!r)throw new Error(`Profile '${e.name}' does not exist`);let i=[];this._onWillRemoveProfile.fire({profile:r,join(o){i.push(o)}});try{await Promise.allSettled(i)}catch(o){this.logService.error(o)}for(let o of[...this.profilesObject.emptyWindows.keys()])r.id===this.profilesObject.emptyWindows.get(o)?.id&&this.profilesObject.emptyWindows.delete(o);for(let o of[...this.profilesObject.workspaces.keys()])r.id===this.profilesObject.workspaces.get(o)?.id&&this.profilesObject.workspaces.delete(o);this.updateStoredProfileAssociations(),this.updateProfiles([],[r],[]);try{await this.fileService.del(r.cacheHome,{recursive:!0})}catch(o){Ue(o)!==1&&this.logService.error(o)}}async setProfileForWorkspace(e,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let i=this.profiles.find(o=>o.id===r.id);if(!i)throw new Error(`Profile '${r.name}' does not exist`);this.updateWorkspaceAssociation(e,i)}unsetWorkspace(e,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(e,void 0,r)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){let e=await this.fileService.resolve(this.profilesHome);await Promise.all((e.children||[]).filter(r=>r.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,r.resource))).map(r=>this.fileService.del(r.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;let e=this.transientProfilesObject.profiles.filter(r=>!this.isProfileAssociatedToWorkspace(r));await Promise.allSettled(e.map(r=>this.removeProfile(r)))}getProfileForWorkspace(e){let r=this.getWorkspace(e),i=P.isUri(r)?this.profilesObject.workspaces.get(r):this.profilesObject.emptyWindows.get(r);return i||(Fa(e)?this.transientProfilesObject.folders.get(e.uri):La(e)?this.transientProfilesObject.workspaces.get(e.configPath):this.transientProfilesObject.emptyWindows.get(e.id))}getWorkspace(e){return Fa(e)?e.uri:La(e)?e.configPath:e.id}isProfileAssociatedToWorkspace(e){return!!([...this.profilesObject.emptyWindows.values()].some(r=>this.uriIdentityService.extUri.isEqual(r.location,e.location))||[...this.profilesObject.workspaces.values()].some(r=>this.uriIdentityService.extUri.isEqual(r.location,e.location))||[...this.transientProfilesObject.emptyWindows.values()].some(r=>this.uriIdentityService.extUri.isEqual(r.location,e.location))||[...this.transientProfilesObject.workspaces.values()].some(r=>this.uriIdentityService.extUri.isEqual(r.location,e.location))||[...this.transientProfilesObject.folders.values()].some(r=>this.uriIdentityService.extUri.isEqual(r.location,e.location)))}updateProfiles(e,r,i){let o=[...this.profiles,...e],s=[],a=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let l of o){if(l.isDefault||r.some(u=>l.id===u.id))continue;l=i.find(u=>l.id===u.id)??l;let c=a.find(u=>l.id===u.id);if(l.isTransient)this.transientProfilesObject.profiles.push(l);else{if(c){for(let[u,f]of this.transientProfilesObject.emptyWindows.entries())if(l.id===f.id){this.updateWorkspaceAssociation({id:u},l);break}for(let[u,f]of this.transientProfilesObject.workspaces.entries())if(l.id===f.id){this.updateWorkspaceAssociation({id:"",configPath:u},l);break}for(let[u,f]of this.transientProfilesObject.folders.entries())if(l.id===f.id){this.updateWorkspaceAssociation({id:"",uri:u},l);break}}s.push({location:l.location,name:l.name,shortName:l.shortName,icon:l.icon,useDefaultFlags:l.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(e,r,i)}triggerProfilesChanges(e,r,i){this._onDidChangeProfiles.fire({added:e,removed:r,updated:i,all:this.profiles})}updateWorkspaceAssociation(e,r,i){if(i=r?.isTransient?!0:i,i)Fa(e)?(this.transientProfilesObject.folders.delete(e.uri),r&&this.transientProfilesObject.folders.set(e.uri,r)):La(e)?(this.transientProfilesObject.workspaces.delete(e.configPath),r&&this.transientProfilesObject.workspaces.set(e.configPath,r)):(this.transientProfilesObject.emptyWindows.delete(e.id),r&&this.transientProfilesObject.emptyWindows.set(e.id,r));else{this.updateWorkspaceAssociation(e,void 0,!0);let o=this.getWorkspace(e);P.isUri(o)?(this.profilesObject.workspaces.delete(o),r&&this.profilesObject.workspaces.set(o,r)):(this.profilesObject.emptyWindows.delete(o),r&&this.profilesObject.emptyWindows.set(o,r)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){let e={};for(let[i,o]of this.profilesObject.workspaces.entries())e[i.toString()]=o.id;let r={};for(let[i,o]of this.profilesObject.emptyWindows.entries())r[i.toString()]=o.id;this.saveStoredProfileAssociations({workspaces:e,emptyWindows:r}),this._profilesObject=void 0}migrateStoredProfileAssociations(e){let r={},i=this.createDefaultProfile();if(e.workspaces)for(let[s,a]of Object.entries(e.workspaces)){let l=P.parse(a);r[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}let o={};if(e.emptyWindows)for(let[s,a]of Object.entries(e.emptyWindows)){let l=P.parse(a);o[s]=this.uriIdentityService.extUri.isEqual(l,i.location)?i.id:this.uriIdentityService.extUri.basename(l)}return{workspaces:r,emptyWindows:o}}getStoredProfiles(){return[]}saveStoredProfiles(e){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}};ji=D([b(0,xt),b(1,pe),b(2,_e),b(3,J)],ji);var LI="__$__isNewStorageMarker",kl="__$__targetStorageMarker",Yh=$("storageService");function UI(n){let t=n.get(kl);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}var Jh=class n extends U{constructor(e={flushInterval:n.DEFAULT_FLUSH_INTERVAL}){super();this.options=e}static DEFAULT_FLUSH_INTERVAL=60*1e3;_onDidChangeValue=this._register(new ri);_onDidChangeTarget=this._register(new ri);onDidChangeTarget=this._onDidChangeTarget.event;_onWillSaveState=this._register(new C);onWillSaveState=this._onWillSaveState.event;initializationPromise;flushWhenIdleScheduler=this._register(new fr(()=>this.doFlushWhenIdle(),this.options.flushInterval));runFlushWhenIdle=this._register(new lr);onDidChangeValue(e,r,i){return Z.filter(this._onDidChangeValue.event,o=>o.scope===e&&(r===void 0||o.key===r),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=fu(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){ct([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{zi("code/willInitStorage");try{await this.doInitialize()}finally{zi("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(e,r){let{key:i,external:o}=r;if(i===kl){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:o})}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,r,i){return this.getStorage(r)?.get(e,i)}getBoolean(e,r,i){return this.getStorage(r)?.getBoolean(e,i)}getNumber(e,r,i){return this.getStorage(r)?.getNumber(e,i)}getObject(e,r,i){return this.getStorage(r)?.getObject(e,i)}storeAll(e,r){this.withPausedEmitters(()=>{for(let i of e)this.store(i.key,i.value,i.scope,i.target,r)})}store(e,r,i,o,s=!1){if(Ye(r)){this.remove(e,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,i,o),this.getStorage(i)?.set(e,r,s)})}remove(e,r,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(e,r,void 0),this.getStorage(r)?.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(e,r){let i=[],o=this.getKeyTargets(e);for(let s of Object.keys(o))o[s]===r&&i.push(s);return i}updateKeyTarget(e,r,i,o=!1){let s=this.getKeyTargets(r);typeof i=="number"?s[e]!==i&&(s[e]=i,this.getStorage(r)?.set(kl,JSON.stringify(s),o)):typeof s[e]=="number"&&(delete s[e],this.getStorage(r)?.set(kl,JSON.stringify(s),o))}_workspaceKeyTargets=void 0;get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}_profileKeyTargets=void 0;get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}_applicationKeyTargets=void 0;get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){let r=this.getStorage(e);return r?UI(r):Object.create(null)}isNew(e){return this.getBoolean(LI,e)===!0}async flush(e=0){this._onWillSaveState.fire({reason:e});let r=this.getStorage(-1),i=this.getStorage(0),o=this.getStorage(1);switch(e){case 0:await ze.settled([r?.whenFlushed()??Promise.resolve(),i?.whenFlushed()??Promise.resolve(),o?.whenFlushed()??Promise.resolve()]);break;case 1:await ze.settled([r?.flush(0)??Promise.resolve(),i?.flush(0)??Promise.resolve(),o?.flush(0)??Promise.resolve()]);break}}async log(){let e=this.getStorage(-1)?.items??new Map,r=this.getStorage(0)?.items??new Map,i=this.getStorage(1)?.items??new Map;return NI(e,r,i,this.getLogDetails(-1)??"",this.getLogDetails(0)??"",this.getLogDetails(1)??"")}async optimize(e){return await this.flush(),this.getStorage(e)?.optimize()}async switch(e,r){return this.emitWillSaveState(0),Qh(e)?this.switchToProfile(e,r):this.switchToWorkspace(e,r)}canSwitchProfile(e,r){return!(e.id===r.id||Xh(r)&&Xh(e))}switchData(e,r,i){this.withPausedEmitters(()=>{let o=new Set;for(let[s,a]of e)o.add(s),r.get(s)!==a&&this.emitDidChangeValue(i,{key:s,external:!0});for(let[s]of r.items)o.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};function Xh(n){return n.isDefault||!!n.useDefaultFlags?.globalState}async function NI(n,t,e,r,i,o){let s=y=>{try{return JSON.parse(y)}catch{return y}},a=new Map,l=new Map;n.forEach((y,I)=>{a.set(I,y),l.set(I,s(y))});let c=new Map,u=new Map;t.forEach((y,I)=>{c.set(I,y),u.set(I,s(y))});let f=new Map,p=new Map;e.forEach((y,I)=>{f.set(I,y),p.set(I,s(y))}),console.group(r!==i?`Storage: Application (path: ${r})`:`Storage: Application & Profile (path: ${r}, default profile)`);let h=[];if(a.forEach((y,I)=>{h.push({key:I,value:y})}),console.table(h),console.groupEnd(),console.log(l),r!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let y=[];c.forEach((I,S)=>{y.push({key:S,value:I})}),console.table(y),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${o})`);let v=[];f.forEach((y,I)=>{v.push({key:I,value:y})}),console.table(v),console.groupEnd(),console.log(p)}async function Zh(n,t,e){let r=e&&e.get("storage.serviceMachineId",-1)||null;if(r)return r;try{let o=(await t.readFile(n.serviceMachineIdResource)).value.toString();r=Sg(o)?o:null}catch{r=null}if(!r){r=Ke();try{await t.writeFile(n.serviceMachineIdResource,W.fromString(r))}catch{}}return e?.store("storage.serviceMachineId",r,-1,1),r}async function em(n,t,e,r,i,o,s){let a={"X-Market-Client-Id":`VSCode ${n}`,"User-Agent":`VSCode ${n} (${t.nameShort})`};if(Rh(t,e)&&Ch(r)===3){let l=await Zh(e,i,o);a["X-Market-User-Id"]=l,a["VSCode-SessionId"]=s.machineId||l}return a}var tm=Pt?"web":Sl(Po,ea),gs="X-Market-Search-Activity-Id";function WI(...n){return String(n.reduce((t,e)=>t|e,0))}var ft={Icon:"Microsoft.VisualStudio.Services.Icons.Default",Details:"Microsoft.VisualStudio.Services.Content.Details",Changelog:"Microsoft.VisualStudio.Services.Content.Changelog",Manifest:"Microsoft.VisualStudio.Code.Manifest",VSIX:"Microsoft.VisualStudio.Services.VSIXPackage",License:"Microsoft.VisualStudio.Services.Content.License",Repository:"Microsoft.VisualStudio.Services.Links.Source",Signature:"Microsoft.VisualStudio.Services.VsixSignature"},Qn={Dependency:"Microsoft.VisualStudio.Code.ExtensionDependencies",ExtensionPack:"Microsoft.VisualStudio.Code.ExtensionPack",Engine:"Microsoft.VisualStudio.Code.Engine",PreRelease:"Microsoft.VisualStudio.Code.PreRelease",EnabledApiProposals:"Microsoft.VisualStudio.Code.EnabledApiProposals",LocalizedLanguages:"Microsoft.VisualStudio.Code.LocalizedLanguages",WebExtension:"Microsoft.VisualStudio.Code.WebExtension",SponsorLink:"Microsoft.VisualStudio.Code.SponsorLink",SupportLink:"Microsoft.VisualStudio.Services.Links.Support",ExecutesCode:"Microsoft.VisualStudio.Code.ExecutesCode"},KI=10,BI={pageNumber:1,pageSize:KI,sortBy:0,sortOrder:0,flags:0,criteria:[],assetTypes:[]},jr=class n{constructor(t=BI){this.state=t}get pageNumber(){return this.state.pageNumber}get pageSize(){return this.state.pageSize}get sortBy(){return this.state.sortBy}get sortOrder(){return this.state.sortOrder}get flags(){return this.state.flags}get criteria(){return this.state.criteria}withPage(t,e=this.state.pageSize){return new n({...this.state,pageNumber:t,pageSize:e})}withFilter(t,...e){let r=[...this.state.criteria,...e.length?e.map(i=>({filterType:t,value:i})):[{filterType:t}]];return new n({...this.state,criteria:r})}withSortBy(t){return new n({...this.state,sortBy:t})}withSortOrder(t){return new n({...this.state,sortOrder:t})}withFlags(...t){return new n({...this.state,flags:t.reduce((e,r)=>e|r,0)})}withAssetTypes(...t){return new n({...this.state,assetTypes:t})}withSource(t){return new n({...this.state,source:t})}get raw(){let{criteria:t,pageNumber:e,pageSize:r,sortBy:i,sortOrder:o,flags:s,assetTypes:a}=this.state;return{filters:[{criteria:t,pageNumber:e,pageSize:r,sortBy:i,sortOrder:o}],assetTypes:a,flags:s}}get searchText(){let t=this.state.criteria.filter(e=>e.filterType===10)[0];return t&&t.value?t.value:""}get telemetryData(){return{filterTypes:this.state.criteria.map(t=>String(t.filterType)),flags:this.state.flags,sortBy:String(this.sortBy),sortOrder:String(this.sortOrder),pageNumber:String(this.pageNumber),source:this.state.source,searchTextLength:this.searchText.length}}};function pd(n,t){let e=(n||[]).filter(r=>r.statisticName===t)[0];return e?e.value:0}function qI(n){let t="Microsoft.VisualStudio.Code.Translation.";return n.files.filter(r=>r.assetType.indexOf(t)===0).reduce((r,i)=>{let o=Hn(n,i.assetType);return o&&r.push([i.assetType.substring(t.length),o]),r},[])}function $I(n){if(n.properties){let t=n.properties.filter(i=>i.key===ft.Repository),e=new RegExp("((git|ssh|http(s)?)|(git@[\\w.]+))(:(//)?)([\\w.@:/\\-~]+)(.git)(/)?"),r=t.filter(i=>e.test(i.value))[0];return r?{uri:r.value,fallbackUri:r.value}:null}return Hn(n,ft.Repository)}function zI(n){return{uri:`${n.fallbackAssetUri}/${ft.VSIX}?redirect=true${n.targetPlatform?`&targetPlatform=${n.targetPlatform}`:""}`,fallbackUri:`${n.fallbackAssetUri}/${ft.VSIX}${n.targetPlatform?`?targetPlatform=${n.targetPlatform}`:""}`}}function Hn(n,t){return n.files.filter(r=>r.assetType===t)[0]?{uri:`${n.assetUri}/${t}${n.targetPlatform?`?targetPlatform=${n.targetPlatform}`:""}`,fallbackUri:`${n.fallbackAssetUri}/${t}${n.targetPlatform?`?targetPlatform=${n.targetPlatform}`:""}`}:null}function nm(n,t){let e=n.properties?n.properties.filter(i=>i.key===t):[],r=e.length>0&&e[0].value;return r?r.split(",").map(i=>ls(i)):[]}function sm(n){let t=n.properties?n.properties.filter(e=>e.key===Qn.Engine):[];return t.length>0&&t[0].value||""}function Al(n){let t=n.properties?n.properties.filter(e=>e.key===Qn.PreRelease):[];return t.length>0&&t[0].value==="true"}function jI(n){let t=n.properties?n.properties.filter(e=>e.key===Qn.ExecutesCode):[];return t.length>0?t[0].value==="true":void 0}function hd(n){let t=n.properties?n.properties.filter(r=>r.key===Qn.EnabledApiProposals):[],e=t.length>0&&t[0].value||"";return e?e.split(","):[]}function GI(n){let t=n.properties?n.properties.filter(r=>r.key===Qn.LocalizedLanguages):[],e=t.length>0&&t[0].value||"";return e?e.split(","):[]}function HI(n){return n.properties?.find(t=>t.key===Qn.SponsorLink)?.value}function QI(n){return n.properties?.find(t=>t.key===Qn.SupportLink)?.value}function JI(n){return n.indexOf("preview")!==-1}function Fl(n){return n.targetPlatform?Vh(n.targetPlatform):"undefined"}function gd(n){let t=Nt(n.versions.map(Fl)),e=!!n.tags?.includes(Lh),r=t.indexOf("web");return e?r===-1&&t.push("web"):r!==-1&&t.splice(r,1),t}function rm(n,t){for(let e=0;e<n.length;e++){let r=n[e];if(r.version===n[e-1]?.version){let i=e;if(Fl(r)===t)for(;i>0&&n[i-1].version===r.version;)i--;i!==e&&(n.splice(e,1),n.splice(i,0,r))}}return n}function im(n,t,e){n.telemetryData={index:t,querySource:e,queryActivityId:n.queryContext?.[gs]}}function om(n,t,e,r){let i=n.versions[0],o={manifest:Hn(t,ft.Manifest),readme:Hn(t,ft.Details),changelog:Hn(t,ft.Changelog),license:Hn(t,ft.License),repository:$I(t),download:zI(t),icon:Hn(t,ft.Icon),signature:Hn(t,ft.Signature),coreTranslations:qI(t)};return{type:"gallery",identifier:{id:kt(n.publisher.publisherName,n.extensionName),uuid:n.extensionId},name:n.extensionName,version:t.version,displayName:n.displayName,publisherId:n.publisher.publisherId,publisher:n.publisher.publisherName,publisherDisplayName:n.publisher.displayName,publisherDomain:n.publisher.domain?{link:n.publisher.domain,verified:!!n.publisher.isDomainVerified}:void 0,publisherSponsorLink:HI(i),description:n.shortDescription??"",installCount:pd(n.statistics,"install"),rating:pd(n.statistics,"averagerating"),ratingCount:pd(n.statistics,"ratingcount"),categories:n.categories||[],tags:n.tags||[],releaseDate:Date.parse(n.releaseDate),lastUpdated:Date.parse(n.lastUpdated),allTargetPlatforms:e,assets:o,properties:{dependencies:nm(t,Qn.Dependency),extensionPack:nm(t,Qn.ExtensionPack),engine:sm(t),enabledApiProposals:hd(t),localizedLanguages:GI(t),targetPlatform:Fl(t),isPreReleaseVersion:Al(t),executesCode:jI(t)},hasPreReleaseVersion:Al(i),hasReleaseVersion:!0,preview:JI(n.flags),isSigned:!!o.signature,queryContext:r,supportLink:QI(i)}}var Gi=class{constructor(t,e,r,i,o,s,a,l){this.requestService=e;this.logService=r;this.environmentService=i;this.telemetryService=o;this.fileService=s;this.productService=a;this.configurationService=l;let c=a.extensionsGallery,u=c?.servicePPEUrl&&l.getValue("_extensionsGallery.enablePPE");this.extensionsGalleryUrl=u?c.servicePPEUrl:c?.serviceUrl,this.extensionsGallerySearchUrl=u?void 0:c?.searchUrl,this.extensionsControlUrl=c?.controlUrl,this.extensionsEnabledWithApiProposalVersion=a.extensionsEnabledWithApiProposalVersion?.map(f=>f.toLowerCase())??[],this.commonHeadersPromise=em(a.version,a,this.environmentService,this.configurationService,this.fileService,t,this.telemetryService)}extensionsGalleryUrl;extensionsGallerySearchUrl;extensionsControlUrl;commonHeadersPromise;extensionsEnabledWithApiProposalVersion;api(t=""){return`${this.extensionsGalleryUrl}${t}`}isEnabled(){return!!this.extensionsGalleryUrl}async getExtensions(t,e,r){let i=ce.isCancellationToken(e)?{}:e,o=ce.isCancellationToken(e)?e:r,s=await this.doGetExtensions(t,i,o),a=s.map(c=>c.identifier.uuid),l=[];for(let c of t)c.uuid&&!a.includes(c.uuid)&&l.push({...c,uuid:void 0});if(l.length){this.telemetryService.publicLog2("galleryService:additionalQueryByName",{count:l.length});let c=await this.doGetExtensions(l,i,o);s.push(...c)}return s}async doGetExtensions(t,e,r){let i=[],o=[],s=[],a=[],l=!0;for(let f of t){f.uuid?o.push(f.uuid):i.push(f.id);let p=!!(f.version||f.preRelease);s.push({id:f.id,uuid:f.uuid,includePreRelease:p}),f.version&&a.push({id:f.id,uuid:f.uuid,version:f.version}),l=l&&!!f.hasPreRelease&&!p}if(!o.length&&!i.length)return[];let c=new jr().withPage(1,t.length);o.length&&(c=c.withFilter(4,...o)),i.length&&(c=c.withFilter(7,...i)),(e.queryAllVersions||l)&&(c=c.withFlags(c.flags,1)),e.source&&(c=c.withSource(e.source));let{extensions:u}=await this.queryGalleryExtensions(c,{targetPlatform:e.targetPlatform??tm,includePreRelease:s,versions:a,compatible:!!e.compatible,productVersion:e.productVersion??{version:this.productService.version,date:this.productService.date}},r);return e.source&&u.forEach((f,p)=>im(f,p,e.source)),u}async getCompatibleExtension(t,e,r,i={version:this.productService.version,date:this.productService.date}){if(Bi(t.allTargetPlatforms,r))return null;if(await this.isExtensionCompatible(t,e,r))return t;let o=new jr().withFlags(1).withPage(1,1).withFilter(4,t.identifier.uuid),{extensions:s}=await this.queryGalleryExtensions(o,{targetPlatform:r,compatible:!0,includePreRelease:e,productVersion:i},ce.None);return s[0]||null}async isExtensionCompatible(t,e,r,i={version:this.productService.version,date:this.productService.date}){if(!as(t.properties.targetPlatform,t.allTargetPlatforms,r)||!e&&t.properties.isPreReleaseVersion)return!1;let o=t.properties.engine;if(!o){let s=await this.getManifest(t,ce.None);if(!s)throw new Error("Manifest was not found");o=s.engines.vscode}return!(!$i(o,i.version,i.date)||!this.areApiProposalsCompatible(t.identifier,t.properties.enabledApiProposals))}areApiProposalsCompatible(t,e){return!e||!this.extensionsEnabledWithApiProposalVersion.includes(t.id.toLowerCase())?!0:fs(e)}async isValidVersion(t,e,r,i,o,s,a={version:this.productService.version,date:this.productService.date}){if(!as(Fl(e),o,s)||r!=="any"&&Al(e)!==(r==="prerelease"))return!1;if(i)try{let l=await this.getEngine(t,e);if(!$i(l,a.version,a.date))return!1}catch(l){return this.logService.error(`Error while getting the engine for the version ${e.version}.`,G(l)),!1}return!0}async query(t,e){let r=t.text||"",i=t.pageSize??50,o=new jr().withPage(1,i);r?(r=r.replace(/\bcategory:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(u,f,p)=>(o=o.withFilter(5,p||f),"")),r=r.replace(/\btag:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(u,f,p)=>(o=o.withFilter(1,p||f),"")),r=r.replace(/\bfeatured(\s+|\b|$)/g,()=>(o=o.withFilter(9),"")),r=r.trim(),r&&(r=r.length<200?r:r.substring(0,200),o=o.withFilter(10,r)),o=o.withSortBy(0)):t.ids?o=o.withFilter(4,...t.ids):t.names?o=o.withFilter(7,...t.names):o=o.withSortBy(4),typeof t.sortBy=="number"&&(o=o.withSortBy(t.sortBy)),typeof t.sortOrder=="number"&&(o=o.withSortOrder(t.sortOrder)),t.source&&(o=o.withSource(t.source));let s=async(u,f)=>{let{extensions:p,total:h}=await this.queryGalleryExtensions(u,{targetPlatform:tm,compatible:!1,includePreRelease:!!t.includePreRelease,productVersion:t.productVersion??{version:this.productService.version,date:this.productService.date}},f);return p.forEach((v,y)=>im(v,(u.pageNumber-1)*u.pageSize+y,t.source)),{extensions:p,total:h}},{extensions:a,total:l}=await s(o,e),c=async(u,f)=>{if(f.isCancellationRequested)throw new me;let{extensions:p}=await s(o.withPage(u+1),f);return p};return{firstPage:a,total:l,pageSize:o.pageSize,getPage:c}}async queryGalleryExtensions(t,e,r){let i=t.flags;t.flags&512&&t.flags&1&&(t=t.withFlags(t.flags&-2,512)),!(t.flags&512)&&!(t.flags&1)&&(t=t.withFlags(t.flags,512)),e.versions?.length&&(t=t.withFlags(t.flags&-513,1)),t=t.withFlags(t.flags,128,4,2,256,16);let{galleryExtensions:o,total:s,context:a}=await this.queryRawGalleryExtensions(t,r);if(!(t.flags&512)){let f=[];for(let p of o){let h=await this.toGalleryExtensionWithCriteria(p,e,a);h&&f.push(h)}return{extensions:f,total:s}}let c=[],u=new Map;for(let f=0;f<o.length;f++){let p=o[f],h={id:kt(p.publisher.publisherName,p.extensionName),uuid:p.extensionId},v=Kt(e.includePreRelease)?e.includePreRelease:!!e.includePreRelease.find(I=>X(I,h))?.includePreRelease;if(e.compatible&&Bi(gd(p),e.targetPlatform))continue;let y=await this.toGalleryExtensionWithCriteria(p,e,a);!y||y.properties.isPreReleaseVersion&&(!v||!y.hasReleaseVersion)||!y.properties.isPreReleaseVersion&&y.properties.targetPlatform!==e.targetPlatform&&y.hasPreReleaseVersion?u.set(p.extensionId,f):c.push([f,y])}if(u.size){let f=new Dr,p=new jr().withFlags(i&-513,1).withPage(1,u.size).withFilter(4,...u.keys()),{extensions:h}=await this.queryGalleryExtensions(p,e,r);this.telemetryService.publicLog2("galleryService:additionalQuery",{duration:f.elapsed(),count:u.size});for(let v of h){let y=u.get(v.identifier.uuid);c.push([y,v])}}return{extensions:c.sort((f,p)=>f[0]-p[0]).map(([,f])=>f),total:s}}async toGalleryExtensionWithCriteria(t,e,r){let i={id:kt(t.publisher.publisherName,t.extensionName),uuid:t.extensionId},o=e.versions?.find(c=>X(c,i))?.version,s=Kt(e.includePreRelease)?e.includePreRelease:!!e.includePreRelease.find(c=>X(c,i))?.includePreRelease,a=gd(t),l=rm(t.versions,e.targetPlatform);if(e.compatible&&Bi(a,e.targetPlatform))return null;for(let c=0;c<l.length;c++){let u=l[c];if(!(o&&u.version!==o)){if(await this.isValidVersion(i.id,u,s?"any":"release",e.compatible,a,e.targetPlatform,e.productVersion)){if(e.compatible&&!this.areApiProposalsCompatible(i,hd(u)))continue;return om(t,u,a,r)}if(o&&u.version===o)return null}}return o||e.compatible?null:om(t,t.versions[0],a)}async queryRawGalleryExtensions(t,e){if(!this.isEnabled())throw new Error("No extension gallery service configured.");t=t.withFlags(t.flags,32).withFilter(8,"Microsoft.VisualStudio.Code").withFilter(12,WI(4096));let r=await this.commonHeadersPromise,i=JSON.stringify(t.raw),o={...r,"Content-Type":"application/json",Accept:"application/json;api-version=3.0-preview.1","Accept-Encoding":"gzip","Content-Length":String(i.length)},s=new Dr,a,l,c=0;try{if(a=await this.requestService.request({type:"POST",url:this.extensionsGallerySearchUrl&&t.criteria.some(f=>f.filterType===10)?this.extensionsGallerySearchUrl:this.api("/extensionquery"),data:i,headers:o},e),a.res.statusCode&&a.res.statusCode>=400&&a.res.statusCode<500)return{galleryExtensions:[],total:c};let u=await al(a);if(u){let f=u.results[0],p=f.extensions,h=f.resultMetadata&&f.resultMetadata.filter(v=>v.metadataType==="ResultCount")[0];return c=h&&h.metadataItems.filter(v=>v.name==="TotalCount")[0].count||0,{galleryExtensions:p,total:c,context:a.res.headers.activityid?{[gs]:a.res.headers.activityid}:{}}}return{galleryExtensions:[],total:c}}catch(u){if(xn(u))throw l="Cancelled",u;{let f=G(u);throw l=xg(u)?"Offline":f.startsWith("XHR timeout")?"Timeout":"Failed",new yr(f,l)}}finally{this.telemetryService.publicLog2("galleryService:query",{...t.telemetryData,requestBodySize:String(i.length),duration:s.elapsed(),success:!!a&&sl(a),responseBodySize:a?.res.headers["Content-Length"],statusCode:a?String(a.res.statusCode):void 0,errorCode:l,count:String(c)})}}async reportStatistic(t,e,r,i){if(!this.isEnabled())return;let o=Pt?this.api(`/itemName/${t}.${e}/version/${r}/statType/${i==="install"?"1":"3"}/vscodewebextension`):this.api(`/publishers/${t}/extensions/${e}/${r}/stats?statType=${i}`),s=Pt?"api-version=6.1-preview.1":"*/*;api-version=4.0-preview.1",l={...await this.commonHeadersPromise,Accept:s};try{await this.requestService.request({type:"POST",url:o,headers:l},ce.None)}catch{}}async download(t,e,r){this.logService.trace("ExtensionGalleryService#download",t.identifier.id);let i=us(t),o=new Date().getTime(),s=r===2?"install":r===3?"update":"",a=s?{uri:`${t.assets.download.uri}${P.parse(t.assets.download.uri).query?"&":"?"}${s}=true`,fallbackUri:`${t.assets.download.fallbackUri}${P.parse(t.assets.download.fallbackUri).query?"&":"?"}${s}=true`}:t.assets.download,l=t.queryContext?.[gs]?{[gs]:t.queryContext[gs]}:void 0,c=await this.getAsset(t.identifier.id,a,ft.VSIX,l?{headers:l}:void 0);try{await this.fileService.writeFile(e,c.stream)}catch(u){try{await this.fileService.del(e)}catch(f){this.logService.warn(`Error while deleting the file ${e.toString()}`,G(f))}throw new yr(G(u),"DownloadFailedWriting")}this.telemetryService.publicLog("galleryService:downloadVSIX",{...i,duration:new Date().getTime()-o})}async downloadSignatureArchive(t,e){if(!t.assets.signature)throw new Error("No signature asset found");this.logService.trace("ExtensionGalleryService#downloadSignatureArchive",t.identifier.id);let r=await this.getAsset(t.identifier.id,t.assets.signature,ft.Signature);try{await this.fileService.writeFile(e,r.stream)}catch(i){try{await this.fileService.del(e)}catch(o){this.logService.warn(`Error while deleting the file ${e.toString()}`,G(o))}throw new yr(G(i),"DownloadFailedWriting")}}async getReadme(t,e){if(t.assets.readme){let r=await this.getAsset(t.identifier.id,t.assets.readme,ft.Details,{},e);return await mr(r)||""}return""}async getManifest(t,e){if(t.assets.manifest){let r=await this.getAsset(t.identifier.id,t.assets.manifest,ft.Manifest,{},e),i=await mr(r);return i?JSON.parse(i):null}return null}async getManifestFromRawExtensionVersion(t,e,r){let i=Hn(e,ft.Manifest);if(!i)throw new Error("Manifest was not found");let o={"Accept-Encoding":"gzip"},s=await this.getAsset(t,i,ft.Manifest,{headers:o});return await al(s)}async getCoreTranslation(t,e){let r=t.assets.coreTranslations.filter(i=>i[0]===e.toUpperCase())[0];if(r){let i=await this.getAsset(t.identifier.id,r[1],r[0]),o=await mr(i);return o?JSON.parse(o):null}return null}async getChangelog(t,e){if(t.assets.changelog){let r=await this.getAsset(t.identifier.id,t.assets.changelog,ft.Changelog,{},e);return await mr(r)||""}return""}async getAllCompatibleVersions(t,e,r){let i=new jr().withFlags(1,4,2,16).withPage(1,1);t.uuid?i=i.withFilter(4,t.uuid):i=i.withFilter(7,t.id);let{galleryExtensions:o}=await this.queryRawGalleryExtensions(i,ce.None);if(!o.length)return[];let s=gd(o[0]);if(Bi(s,r))return[];let a=[];await Promise.all(o[0].versions.map(async u=>{try{await this.isValidVersion(t.id,u,e?"any":"release",!0,s,r)&&this.areApiProposalsCompatible(t,hd(u))&&a.push(u)}catch{}}));let l=[],c=new Set;for(let u of rm(a,r))c.has(u.version)||(c.add(u.version),l.push({version:u.version,date:u.lastUpdated,isPreReleaseVersion:Al(u)}));return l}async getAsset(t,e,r,i={},o=ce.None){let s=await this.commonHeadersPromise,a={type:"GET"},l={...s,...i.headers||{}};i={...i,...a,headers:l};let c=e.uri,u=e.fallbackUri,f={...i,url:c};try{let p=await this.requestService.request(f,o);if(p.res.statusCode===200)return p;let h=await mr(p);throw new Error(`Expected 200, got back ${p.res.statusCode} instead.

${h}`)}catch(p){if(xn(p))throw p;let h=G(p);this.telemetryService.publicLog2("galleryService:cdnFallback",{extension:t,assetType:r,message:h});let v={...i,url:u};return this.requestService.request(v,o)}}async getEngine(t,e){let r=sm(e);if(!r){this.telemetryService.publicLog2("galleryService:engineFallback",{extension:t,version:e.version});let i=await this.getManifestFromRawExtensionVersion(t,e,ce.None);if(!i)throw new Error("Manifest was not found");r=i.engines.vscode}return r}async getExtensionsControlManifest(){if(!this.isEnabled())throw new Error("No extension gallery service configured.");if(!this.extensionsControlUrl)return{malicious:[],deprecated:{},search:[]};let t=await this.requestService.request({type:"GET",url:this.extensionsControlUrl},ce.None);if(t.res.statusCode!==200)throw new Error("Could not get extensions report.");let e=await al(t),r=[],i={},o=[],s=[];if(e){for(let a of e.malicious)r.push({id:a});if(e.migrateToPreRelease)for(let[a,l]of Object.entries(e.migrateToPreRelease))(!l.engine||$i(l.engine,this.productService.version,this.productService.date))&&(i[a.toLowerCase()]={disallowInstall:!0,extension:{id:l.id,displayName:l.displayName,autoMigrate:{storage:!!l.migrateStorage},preRelease:!0}});if(e.deprecated)for(let[a,l]of Object.entries(e.deprecated))l&&(i[a.toLowerCase()]=Kt(l)?{}:l);if(e.search)for(let a of e.search)o.push(a);if(Array.isArray(e.extensionsEnabledWithPreRelease))for(let a of e.extensionsEnabledWithPreRelease)s.push(a.toLowerCase())}return{malicious:r,deprecated:i,search:o,extensionsEnabledWithPreRelease:s}}};Gi=D([b(1,hr),b(2,J),b(3,xt),b(4,He),b(5,pe),b(6,vt),b(7,gn)],Gi);var Ol=class extends Gi{constructor(t,e,r,i,o,s,a,l){super(t,e,r,i,o,s,a,l)}};Ol=D([b(0,Yh),b(1,hr),b(2,J),b(3,xt),b(4,He),b(5,pe),b(6,vt),b(7,gn)],Ol);var Hi=class extends Gi{constructor(t,e,r,i,o,s,a){super(void 0,t,e,r,i,o,s,a)}};Hi=D([b(0,hr),b(1,J),b(2,xt),b(3,He),b(4,pe),b(5,vt),b(6,gn)],Hi);import*as xm from"fs";import{createWriteStream as am,promises as lm}from"fs";var yd="end of central directory record signature not found",XI=new RegExp(yd),Gr=class extends Error{type;constructor(t,e){let r=e.message;switch(t){case"CorruptZip":r=`Corrupt ZIP: ${r}`;break}super(r),this.type=t,this.cause=e}};function YI(n){let t=n.externalFileAttributes>>16||33188;return[448,56,7].map(e=>t&e).reduce((e,r)=>e+r,t&61440)}function cm(n){if(n instanceof Gr)return n;let t;return XI.test(n.message)&&(t="CorruptZip"),new Gr(t,n)}function ZI(n,t,e,r,i,o){let s=lt(t),a=V(r,s);if(!a.startsWith(r))return Promise.reject(new Error(g("invalid file","Error extracting {0}. Invalid file.",t)));let l=V(r,t),c;return o.onCancellationRequested(()=>{c?.destroy()}),Promise.resolve(lm.mkdir(a,{recursive:!0})).then(()=>new Promise((u,f)=>{if(!o.isCancellationRequested)try{c=am(l,{mode:e}),c.once("close",()=>u()),c.once("error",f),n.once("error",f),n.pipe(c)}catch(p){f(p)}}))}function ex(n,t,e,r){let i=qt(()=>Promise.resolve()),o=0,s=r.onCancellationRequested(()=>{i.cancel(),n.close()});return new Promise((a,l)=>{let c=new Ia,u=f=>{f.isCancellationRequested||(o++,n.readEntry())};n.once("error",l),n.once("close",()=>i.then(()=>{r.isCancellationRequested||n.entryCount===o?a():l(new Gr("Incomplete",new Error(g("incompleteExtract","Incomplete. Found {0} of {1} entries",o,n.entryCount))))},l)),n.readEntry(),n.on("entry",f=>{if(r.isCancellationRequested)return;if(!e.sourcePathRegex.test(f.fileName)){u(r);return}let p=f.fileName.replace(e.sourcePathRegex,"");if(/\/$/.test(p)){let y=V(t,p);i=qt(I=>lm.mkdir(y,{recursive:!0}).then(()=>u(I)).then(void 0,l));return}let h=dm(n,f),v=YI(f);i=qt(y=>c.queue(()=>h.then(I=>ZI(I,p,v,t,e,y).then(()=>u(y)))).then(null,l))})}).finally(()=>s.dispose())}async function um(n,t=!1){let{open:e}=await import("yauzl");return new Promise((r,i)=>{e(n,t?{lazyEntries:!0}:void 0,(o,s)=>{o?i(cm(o)):r(Gc(s))})})}function dm(n,t){return new Promise((e,r)=>{n.openReadStream(t,(i,o)=>{i?r(cm(i)):e(Gc(o))})})}async function fm(n,t){let{ZipFile:e}=await import("yazl");return new Promise((r,i)=>{let o=new e;t.forEach(a=>{a.contents?o.addBuffer(typeof a.contents=="string"?Buffer.from(a.contents,"utf8"):a.contents,a.path):a.localPath&&o.addFile(a.localPath,a.path)}),o.end();let s=am(n);o.outputStream.pipe(s),o.outputStream.once("error",i),s.once("error",i),s.once("finish",()=>r(n))})}function pm(n,t,e={},r){let i=new RegExp(e.sourcePath?`^${e.sourcePath}`:""),o=um(n,!0);return e.overwrite&&(o=o.then(s=>se.rm(t).then(()=>s))),o.then(s=>ex(s,t,{sourcePathRegex:i},r))}function tx(n,t){return um(n).then(e=>new Promise((r,i)=>{e.on("entry",o=>{o.fileName===t&&dm(e,o).then(s=>r(s),s=>i(s))}),e.once("close",()=>i(new Error(g("notFound","{0} not found inside zip.",t))))}))}function Ll(n,t){return tx(n,t).then(e=>new Promise((r,i)=>{let o=[];e.once("error",i),e.on("data",s=>o.push(s)),e.on("end",()=>r(Buffer.concat(o)))}))}var Ul=$("downloadService");var Qi=class extends U{constructor(e,r,i,o,s,a){super();this.galleryService=e;this.telemetryService=r;this.uriIdentityService=i;this.logService=o;this.productService=s;this.userDataProfilesService=a;this._register(te(()=>{this.installingExtensions.forEach(({task:l})=>l.cancel()),this.uninstallingExtensions.forEach(l=>l.cancel()),this.installingExtensions.clear(),this.uninstallingExtensions.clear()}))}extensionsControlManifest;lastReportTimestamp=0;installingExtensions=new Map;uninstallingExtensions=new Map;_onInstallExtension=this._register(new C);get onInstallExtension(){return this._onInstallExtension.event}_onDidInstallExtensions=this._register(new C);get onDidInstallExtensions(){return this._onDidInstallExtensions.event}_onUninstallExtension=this._register(new C);get onUninstallExtension(){return this._onUninstallExtension.event}_onDidUninstallExtension=this._register(new C);get onDidUninstallExtension(){return this._onDidUninstallExtension.event}_onDidUpdateExtensionMetadata=this._register(new C);get onDidUpdateExtensionMetadata(){return this._onDidUpdateExtensionMetadata.event}participants=[];async canInstall(e){let r=await this.getTargetPlatform();return e.allTargetPlatforms.some(i=>as(i,e.allTargetPlatforms,r))}async installFromGallery(e,r={}){try{let o=(await this.installGalleryExtensions([{extension:e,options:r}])).find(({identifier:s})=>X(s,e.identifier));if(o?.local)return o?.local;throw o?.error?o.error:new Pe(`Unknown error while installing extension ${e.identifier.id}`,"Unknown")}catch(i){throw De(i)}}async installGalleryExtensions(e){if(!this.galleryService.isEnabled())throw new Pe(g("MarketPlaceDisabled","Marketplace is not enabled"),"NotAllowed");let r=[],i=[];return await Promise.allSettled(e.map(async({extension:o,options:s})=>{try{let a=await this.checkAndGetCompatibleVersion(o,!!s?.installGivenVersion,!!s?.installPreReleaseVersion,s.productVersion??{version:this.productService.version,date:this.productService.date});i.push({...a,options:s})}catch(a){r.push({identifier:o.identifier,operation:2,source:o,error:a,profileLocation:s.profileLocation??this.getCurrentExtensionsManifestLocation()})}})),i.length&&r.push(...await this.installExtensions(i)),r}async uninstall(e,r){return this.logService.trace("ExtensionManagementService#uninstall",e.identifier.id),this.uninstallExtensions([{extension:e,options:r}])}async toggleAppliationScope(e,r){if(ad(e.manifest)||e.isBuiltin)return e;if(e.isApplicationScoped){let i=await this.updateMetadata(e,{isApplicationScoped:!1},this.userDataProfilesService.defaultProfile.extensionsResource);this.uriIdentityService.extUri.isEqual(r,this.userDataProfilesService.defaultProfile.extensionsResource)||(i=await this.copyExtension(e,this.userDataProfilesService.defaultProfile.extensionsResource,r));for(let o of this.userDataProfilesService.profiles){let s=(await this.getInstalled(1,o.extensionsResource)).find(a=>X(a.identifier,e.identifier));s?this._onDidUpdateExtensionMetadata.fire({local:s,profileLocation:o.extensionsResource}):this._onDidUninstallExtension.fire({identifier:e.identifier,profileLocation:o.extensionsResource})}return i}else{let i=this.uriIdentityService.extUri.isEqual(r,this.userDataProfilesService.defaultProfile.extensionsResource)?await this.updateMetadata(e,{isApplicationScoped:!0},this.userDataProfilesService.defaultProfile.extensionsResource):await this.copyExtension(e,r,this.userDataProfilesService.defaultProfile.extensionsResource,{isApplicationScoped:!0});return this._onDidInstallExtensions.fire([{identifier:i.identifier,operation:2,local:i,profileLocation:this.userDataProfilesService.defaultProfile.extensionsResource,applicationScoped:!0}]),i}}getExtensionsControlManifest(){let e=new Date().getTime();return(!this.extensionsControlManifest||e-this.lastReportTimestamp>1e3*60*5)&&(this.extensionsControlManifest=this.updateControlCache(),this.lastReportTimestamp=e),this.extensionsControlManifest}registerParticipant(e){this.participants.push(e)}async resetPinnedStateForAllUserExtensions(e){try{await this.joinAllSettled(this.userDataProfilesService.profiles.map(async r=>{let i=await this.getInstalled(1,r.extensionsResource);await this.joinAllSettled(i.map(async o=>{o.pinned!==e&&await this.updateMetadata(o,{pinned:e},r.extensionsResource)}))}))}catch(r){throw this.logService.error("Error while resetting pinned state for all user extensions",G(r)),r}}async installExtensions(e){let r=new Map,i=new Map,o=[],s=(l,c)=>`${Be.create(l).toString()}-${c.toString()}`,a=(l,c,u,f)=>{let p=this.createInstallExtensionTask(l,c,u),h=`${kt(l.publisher,l.name)}-${u.profileLocation.toString()}`;i.set(h,{task:p,root:f}),this._onInstallExtension.fire({identifier:p.identifier,source:c,profileLocation:u.profileLocation}),this.logService.info("Installing extension:",p.identifier.id,u),P.isUri(c)||this.installingExtensions.set(s(c,u.profileLocation),{task:p,waitingTasks:[]})};try{for(let{manifest:l,extension:c,options:u}of e){let f=u.isApplicationScoped||u.isBuiltin||ad(l),p={...u,installOnlyNewlyAddedFromExtensionPack:u.installOnlyNewlyAddedFromExtensionPack??!P.isUri(c),isApplicationScoped:f,profileLocation:f?this.userDataProfilesService.defaultProfile.extensionsResource:u.profileLocation??this.getCurrentExtensionsManifestLocation(),productVersion:u.productVersion??{version:this.productService.version,date:this.productService.date}},h=P.isUri(c)?void 0:this.installingExtensions.get(s(c,p.profileLocation));h?(this.logService.info("Extension is already requested to install",h.task.identifier.id,p.profileLocation.toString()),o.push(h.task.waitUntilTaskIsFinished())):a(l,c,p,void 0)}return await Promise.all([...i.values()].map(async({task:l})=>{if(l.options.donotIncludePackAndDependencies)this.logService.info("Installing the extension without checking dependencies and pack",l.identifier.id);else try{let c=await this.getAllDepsAndPackExtensions(l.identifier,l.manifest,!!l.options.installOnlyNewlyAddedFromExtensionPack,!!l.options.installPreReleaseVersion,l.options.profileLocation,l.options.productVersion),u=await this.getInstalled(void 0,l.options.profileLocation,l.options.productVersion),f={...l.options,context:{...l.options.context,[Uh]:!0}};for(let{gallery:p,manifest:h}of Nt(c,({gallery:v})=>v.identifier.id)){if(i.has(`${p.identifier.id.toLowerCase()}-${f.profileLocation.toString()}`))continue;let v=this.installingExtensions.get(s(p,f.profileLocation));if(v){if(this.canWaitForTask(l,v.task)){let y=v.task.identifier;this.logService.info("Waiting for already requested installing extension",y.id,l.identifier.id,f.profileLocation.toString()),v.waitingTasks.push(l),o.push(Z.toPromise(Z.filter(this.onDidInstallExtensions,I=>I.some(S=>X(S.identifier,y)))).then(I=>{if(this.logService.info("Finished waiting for already requested installing extension",y.id,l.identifier.id,f.profileLocation.toString()),!I.find(T=>X(T.identifier,y))?.local)throw new Error(`Extension ${y.id} is not installed`)}))}}else u.some(({identifier:y})=>X(y,p.identifier))||a(h,p,f,l)}}catch(c){if(P.isUri(l.source))Ac(l.manifest.extensionDependencies)&&this.logService.warn("Cannot install dependencies of extension:",l.identifier.id,c.message),Ac(l.manifest.extensionPack)&&this.logService.warn("Cannot install packed extensions of extension:",l.identifier.id,c.message);else throw this.logService.error("Error while preparing to install dependencies and extension packs of the extension:",l.identifier.id),c}})),await this.joinAllSettled([...i.entries()].map(async([l,{task:c}])=>{let u=new Date().getTime(),f;try{f=await c.run(),await this.joinAllSettled(this.participants.map(p=>p.postInstall(f,c.source,c.options,ce.None)),"PostInstall")}catch(p){let h=De(p);throw P.isUri(c.source)||vd(this.telemetryService,c.operation===3?"extensionGallery:update":"extensionGallery:install",{extensionData:us(c.source),error:h,source:c.options.context?.[cd]}),r.set(l,{error:h,identifier:c.identifier,operation:c.operation,source:c.source,context:c.options.context,profileLocation:c.options.profileLocation,applicationScoped:c.options.isApplicationScoped}),this.logService.error("Error while installing the extension",c.identifier.id,G(h),c.options.profileLocation.toString()),h}if(!P.isUri(c.source)){let p=c.operation===3,h=p?void 0:(new Date().getTime()-c.source.lastUpdated)/1e3;if(vd(this.telemetryService,p?"extensionGallery:update":"extensionGallery:install",{extensionData:us(c.source),verificationStatus:c.verificationStatus,duration:new Date().getTime()-u,durationSinceUpdate:h,source:c.options.context?.[cd]}),Pt&&c.operation!==3)try{await this.galleryService.reportStatistic(f.manifest.publisher,f.manifest.name,f.manifest.version,"install")}catch{}}r.set(l,{local:f,identifier:c.identifier,operation:c.operation,source:c.source,context:c.options.context,profileLocation:c.options.profileLocation,applicationScoped:f.isApplicationScoped})})),o.length&&await this.joinAllSettled(o),[...r.values()]}catch(l){let c=(p,h,v)=>{let y=[];p.manifest.extensionDependencies?.length&&y.push(...p.manifest.extensionDependencies),p.manifest.extensionPack?.length&&y.push(...p.manifest.extensionPack);for(let I of y){if(v.includes(I.toLowerCase()))continue;v.push(I.toLowerCase());let S=r.get(`${I.toLowerCase()}-${h.toString()}`);S?.local&&(v=c(S.local,h,v))}return v},u=p=>({identifier:p.identifier,operation:2,source:p.source,context:p.options.context,profileLocation:p.options.profileLocation,error:l}),f=[];for(let[p,{task:h,root:v}]of i){let y=r.get(p);y?y.local&&v&&!r.get(`${v.identifier.id.toLowerCase()}-${h.options.profileLocation.toString()}`)?.local&&(f.push(this.createUninstallExtensionTask(y.local,{versionOnly:!0,profileLocation:h.options.profileLocation})),r.set(p,u(h))):(h.cancel(),r.set(p,u(h)))}for(let[p,{task:h}]of i){let v=r.get(p);if(!v?.local||h.options.donotIncludePackAndDependencies)continue;c(v.local,h.options.profileLocation,[v.local.identifier.id.toLowerCase()]).slice(1).some(I=>i.has(`${I.toLowerCase()}-${h.options.profileLocation.toString()}`)&&!r.get(`${I.toLowerCase()}-${h.options.profileLocation.toString()}`)?.local)&&(f.push(this.createUninstallExtensionTask(v.local,{versionOnly:!0,profileLocation:h.options.profileLocation})),r.set(p,u(h)))}throw f.length&&await Promise.allSettled(f.map(async p=>{try{await p.run(),this.logService.info("Rollback: Uninstalled extension",p.extension.identifier.id)}catch(h){this.logService.warn("Rollback: Error while uninstalling extension",p.extension.identifier.id,G(h))}})),l}finally{for(let{task:l}of i.values())l.source&&!P.isUri(l.source)&&this.installingExtensions.delete(s(l.source,l.options.profileLocation));if(r.size){let l=[...r.values()];for(let c of l)c.local&&this.logService.info("Extension installed successfully:",c.identifier.id,c.profileLocation.toString());this._onDidInstallExtensions.fire(l)}}}canWaitForTask(e,r){for(let[,{task:i,waitingTasks:o}]of this.installingExtensions.entries())if(i===e&&(o.includes(r)||o.some(s=>this.canWaitForTask(s,r)))||i===r&&o[0]&&!this.canWaitForTask(e,o[0]))return!1;return!0}async joinAllSettled(e,r){let i=[],o=[],s=await Promise.allSettled(e);for(let l of s)l.status==="fulfilled"?i.push(l.value):o.push(De(l.reason,r));if(!o.length)return i;if(o.length===1)throw o[0];let a=new Pe("","Unknown");for(let l of o)a=new Pe(a.message?`${a.message}, ${l.message}`:l.message,l.code!=="Unknown"&&l.code!=="Internal"?l.code:a.code);throw a}async getAllDepsAndPackExtensions(e,r,i,o,s,a){if(!this.galleryService.isEnabled())return[];let l=await this.getInstalled(void 0,s,a),c=[],u=[],f=async(p,h)=>{c.push(p);let v=h.extensionDependencies||[],y=[...v];if(h.extensionPack){let I=i?l.find(S=>X(S.identifier,p)):void 0;for(let S of h.extensionPack)I&&I.manifest.extensionPack&&I.manifest.extensionPack.some(T=>X({id:T},{id:S}))||y.every(T=>!X({id:T},{id:S}))&&y.push(S)}if(y.length){let I=y.filter(S=>c.every(T=>!X(T,{id:S})));if(I.length){let S=await this.galleryService.getExtensions(I.map(T=>({id:T,preRelease:o})),ce.None);for(let T of S){if(c.find(_=>X(_,T.identifier)))continue;let k=v.some(_=>X({id:_},T.identifier)),E;try{E=await this.checkAndGetCompatibleVersion(T,!1,o,a)}catch(_){if(k)throw _;this.logService.info("Skipping the packed extension as it cannot be installed",T.identifier.id,G(_));continue}u.push({gallery:E.extension,manifest:E.manifest}),await f(E.extension.identifier,E.manifest)}}}};return await f(e,r),u}async checkAndGetCompatibleVersion(e,r,i,o){let s,a=await this.getExtensionsControlManifest();if(a.malicious.some(u=>X(e.identifier,u)))throw new Pe(g("malicious extension","Can't install '{0}' extension since it was reported to be problematic.",e.identifier.id),"Malicious");let l=a.deprecated[e.identifier.id.toLowerCase()];if(l?.extension?.autoMigrate){if(this.logService.info(`The '${e.identifier.id}' extension is deprecated, fetching the compatible '${l.extension.id}' extension instead.`),s=(await this.galleryService.getExtensions([{id:l.extension.id,preRelease:l.extension.preRelease}],{targetPlatform:await this.getTargetPlatform(),compatible:!0,productVersion:o},ce.None))[0],!s)throw new Pe(g("notFoundDeprecatedReplacementExtension","Can't install '{0}' extension since it was deprecated and the replacement extension '{1}' can't be found.",e.identifier.id,l.extension.id),"Deprecated")}else{if(!await this.canInstall(e)){let u=await this.getTargetPlatform();throw new Pe(g("incompatible platform","The '{0}' extension is not available in {1} for {2}.",e.identifier.id,this.productService.nameLong,Mh(u)),"IncompatibleTargetPlatform")}if(s=await this.getCompatibleVersion(e,r,i,o),!s){let u=[];throw fs(e.properties.enabledApiProposals??[],u)?!i&&e.properties.isPreReleaseVersion&&(await this.galleryService.getExtensions([e.identifier],ce.None))[0]?new Pe(g("notFoundReleaseExtension","Can't install release version of '{0}' extension because it has no release version.",e.displayName??e.identifier.id),"ReleaseVersionNotFound"):new Pe(g("notFoundCompatibleDependency","Can't install '{0}' extension because it is not compatible with the current version of {1} (version {2}).",e.identifier.id,this.productService.nameLong,this.productService.version),"Incompatible"):new Pe(g("incompatibleAPI","Can't install '{0}' extension. {1}",e.displayName??e.identifier.id,u[0]),"IncompatibleApi")}}this.logService.info("Getting Manifest...",s.identifier.id);let c=await this.galleryService.getManifest(s,ce.None);if(c===null)throw new Pe(`Missing manifest for extension ${s.identifier.id}`,"Invalid");if(c.version!==s.version)throw new Pe(`Cannot install '${s.identifier.id}' extension because of version mismatch in Marketplace`,"Invalid");return{extension:s,manifest:c}}async getCompatibleVersion(e,r,i,o){let s=await this.getTargetPlatform(),a=null;return!r&&e.hasPreReleaseVersion&&e.properties.isPreReleaseVersion!==i&&(a=(await this.galleryService.getExtensions([{...e.identifier,preRelease:i}],{targetPlatform:s,compatible:!0,productVersion:o},ce.None))[0]||null),!a&&await this.galleryService.isExtensionCompatible(e,i,s,o)&&(a=e),a||(r?a=(await this.galleryService.getExtensions([{...e.identifier,version:e.version}],{targetPlatform:s,compatible:!0,productVersion:o},ce.None))[0]||null:a=await this.galleryService.getCompatibleExtension(e,i,s,o)),a}async uninstallExtensions(e){let r=(u,f)=>`${u.identifier.id.toLowerCase()}${f.versionOnly?`-${u.manifest.version}`:""}@${f.profileLocation.toString()}`,i=(u,f)=>{let p=this.createUninstallExtensionTask(u,f);return this.uninstallingExtensions.set(r(p.extension,f),p),this.logService.info("Uninstalling extension from the profile:",`${u.identifier.id}@${u.manifest.version}`,f.profileLocation.toString()),this._onUninstallExtension.fire({identifier:u.identifier,profileLocation:f.profileLocation,applicationScoped:u.isApplicationScoped}),p},o=(u,f,p)=>{p?this.logService.error("Failed to uninstall extension from the profile:",`${u.identifier.id}@${u.manifest.version}`,f.profileLocation.toString(),p.message):this.logService.info("Successfully uninstalled extension from the profile",`${u.identifier.id}@${u.manifest.version}`,f.profileLocation.toString()),vd(this.telemetryService,"extensionGallery:uninstall",{extensionData:Kh(u),error:p}),this._onDidUninstallExtension.fire({identifier:u.identifier,error:p?.code,profileLocation:f.profileLocation,applicationScoped:u.isApplicationScoped})},s=[],a=[],l=[],c=new ve;for(let{extension:u,options:f}of e){let p={...f,profileLocation:u.isApplicationScoped?this.userDataProfilesService.defaultProfile.extensionsResource:f?.profileLocation??this.getCurrentExtensionsManifestLocation()},h=this.uninstallingExtensions.get(r(u,p));h?(this.logService.info("Extensions is already requested to uninstall",u.identifier.id),l.push(h.waitUntilTaskIsFinished())):s.push(i(u,p))}try{for(let u of s.slice(0)){let f=c.get(u.options.profileLocation);if(f||c.set(u.options.profileLocation,f=await this.getInstalled(1,u.options.profileLocation)),u.options.donotIncludePack)this.logService.info("Uninstalling the extension without including packed extension",`${u.extension.identifier.id}@${u.extension.manifest.version}`);else{let p=this.getAllPackExtensionsToUninstall(u.extension,f);for(let h of p)this.uninstallingExtensions.has(r(h,u.options))?this.logService.info("Extensions is already requested to uninstall",h.identifier.id):s.push(i(h,u.options))}u.options.donotCheckDependents?this.logService.info("Uninstalling the extension without checking dependents",`${u.extension.identifier.id}@${u.extension.manifest.version}`):this.checkForDependents(s.map(p=>p.extension),f,u.extension)}await this.joinAllSettled(s.map(async u=>{try{if(await u.run(),await this.joinAllSettled(this.participants.map(f=>f.postUninstall(u.extension,u.options,ce.None))),u.extension.identifier.uuid)try{await this.galleryService.reportStatistic(u.extension.manifest.publisher,u.extension.manifest.name,u.extension.manifest.version,"uninstall")}catch{}}catch(f){let p=De(f);throw o(u.extension,u.options,p),p}finally{a.push(u)}})),l.length&&await this.joinAllSettled(l);for(let u of s)o(u.extension,u.options)}catch(u){let f=De(u);for(let p of s){try{p.cancel()}catch{}a.includes(p)||o(p.extension,p.options,f)}throw f}finally{for(let u of s)this.uninstallingExtensions.delete(r(u.extension,u.options))||this.logService.warn("Uninstallation task is not found in the cache",u.extension.identifier.id)}}checkForDependents(e,r,i){for(let o of e){let s=this.getDependents(o,r);if(s.length){let a=s.filter(l=>!e.some(c=>X(c.identifier,l.identifier)));if(a.length)throw new Error(this.getDependentsErrorMessage(o,a,i))}}}getDependentsErrorMessage(e,r,i){return i===e?r.length===1?g("singleDependentError","Cannot uninstall '{0}' extension. '{1}' extension depends on this.",i.manifest.displayName||i.manifest.name,r[0].manifest.displayName||r[0].manifest.name):r.length===2?g("twoDependentsError","Cannot uninstall '{0}' extension. '{1}' and '{2}' extensions depend on this.",i.manifest.displayName||i.manifest.name,r[0].manifest.displayName||r[0].manifest.name,r[1].manifest.displayName||r[1].manifest.name):g("multipleDependentsError","Cannot uninstall '{0}' extension. '{1}', '{2}' and other extension depend on this.",i.manifest.displayName||i.manifest.name,r[0].manifest.displayName||r[0].manifest.name,r[1].manifest.displayName||r[1].manifest.name):r.length===1?g("singleIndirectDependentError","Cannot uninstall '{0}' extension . It includes uninstalling '{1}' extension and '{2}' extension depends on this.",i.manifest.displayName||i.manifest.name,e.manifest.displayName||e.manifest.name,r[0].manifest.displayName||r[0].manifest.name):r.length===2?g("twoIndirectDependentsError","Cannot uninstall '{0}' extension. It includes uninstalling '{1}' extension and '{2}' and '{3}' extensions depend on this.",i.manifest.displayName||i.manifest.name,e.manifest.displayName||e.manifest.name,r[0].manifest.displayName||r[0].manifest.name,r[1].manifest.displayName||r[1].manifest.name):g("multipleIndirectDependentsError","Cannot uninstall '{0}' extension. It includes uninstalling '{1}' extension and '{2}', '{3}' and other extensions depend on this.",i.manifest.displayName||i.manifest.name,e.manifest.displayName||e.manifest.name,r[0].manifest.displayName||r[0].manifest.name,r[1].manifest.displayName||r[1].manifest.name)}getAllPackExtensionsToUninstall(e,r,i=[]){if(i.indexOf(e)!==-1)return[];i.push(e);let o=e.manifest.extensionPack?e.manifest.extensionPack:[];if(o.length){let s=r.filter(l=>!l.isBuiltin&&o.some(c=>X({id:c},l.identifier))),a=[];for(let l of s)a.push(...this.getAllPackExtensionsToUninstall(l,r,i));return[...s,...a]}return[]}getDependents(e,r){return r.filter(i=>i.manifest.extensionDependencies&&i.manifest.extensionDependencies.some(o=>X({id:o},e.identifier)))}async updateControlCache(){try{return this.logService.trace("ExtensionManagementService.updateControlCache"),await this.galleryService.getExtensionsControlManifest()}catch(e){return this.logService.trace("ExtensionManagementService.refreshControlCache - failed to get extension control manifest",G(e)),{malicious:[],deprecated:{},search:[]}}}};Qi=D([b(0,St),b(1,He),b(2,_e),b(3,J),b(4,vt),b(5,rt)],Qi);function De(n,t){if(n instanceof Pe)return n;let e;return n instanceof yr?e=new Pe(n.message,n.code==="DownloadFailedWriting"?"DownloadFailedWriting":"Gallery"):e=new Pe(n.message,xn(n)?"Cancelled":t??"Internal"),e.stack=n.stack,e}function vd(n,t,{extensionData:e,verificationStatus:r,duration:i,error:o,source:s,durationSinceUpdate:a}){let l,c;Kf(r)&&(r===!0?r="Verified":(r===!1||(l="Signature",c=r),r="Unverified")),o&&(l=o.code,o.code==="Signature"&&(c=o.message)),n.publicLog(t,{...e,verificationStatus:r,success:!o,duration:i,errorcode:l,errorcodeDetail:c,durationSinceUpdate:a,source:s})}var hs=class{barrier=new yi;cancellablePromise;async waitUntilTaskIsFinished(){return await this.barrier.wait(),this.cancellablePromise}run(){return this.cancellablePromise||(this.cancellablePromise=qt(t=>this.doRun(t))),this.barrier.open(),this.cancellablePromise}cancel(){this.cancellablePromise||(this.cancellablePromise=qt(t=>new Promise((e,r)=>{let i=t.onCancellationRequested(()=>{i.dispose(),r(new me)})})),this.barrier.open()),this.cancellablePromise.cancel()}};var Hr=class extends Error{constructor(e,r){super(e);this.code=r}},rn=$("IExtensionsProfileScannerService"),Ji=class extends U{constructor(e,r,i,o,s,a){super();this.extensionsLocation=e;this.fileService=r;this.userDataProfilesService=i;this.uriIdentityService=o;this.telemetryService=s;this.logService=a}_serviceBrand;_onAddExtensions=this._register(new C);onAddExtensions=this._onAddExtensions.event;_onDidAddExtensions=this._register(new C);onDidAddExtensions=this._onDidAddExtensions.event;_onRemoveExtensions=this._register(new C);onRemoveExtensions=this._onRemoveExtensions.event;_onDidRemoveExtensions=this._register(new C);onDidRemoveExtensions=this._onDidRemoveExtensions.event;resourcesAccessQueueMap=new ve;scanProfileExtensions(e,r){return this.withProfileExtensions(e,void 0,r)}async addExtensionsToProfile(e,r,i){let o=[],s=[];try{return await this.withProfileExtensions(r,a=>{let l=[];if(i)l.push(...a);else for(let c of a)e.some(([u])=>X(u.identifier,c.identifier)&&u.manifest.version!==c.version)?o.push(c):l.push(c);for(let[c,u]of e){let f=l.findIndex(h=>X(h.identifier,c.identifier)&&h.version===c.manifest.version),p={identifier:c.identifier,version:c.manifest.version,location:c.location,metadata:u};f===-1?(s.push(p),l.push(p)):l.splice(f,1,p)}return s.length&&this._onAddExtensions.fire({extensions:s,profileLocation:r}),o.length&&this._onRemoveExtensions.fire({extensions:o,profileLocation:r}),l}),s.length&&this._onDidAddExtensions.fire({extensions:s,profileLocation:r}),o.length&&this._onDidRemoveExtensions.fire({extensions:o,profileLocation:r}),s}catch(a){throw s.length&&this._onDidAddExtensions.fire({extensions:s,error:a,profileLocation:r}),o.length&&this._onDidRemoveExtensions.fire({extensions:o,error:a,profileLocation:r}),a}}async updateMetadata(e,r){let i=[];return await this.withProfileExtensions(r,o=>{let s=[];for(let a of o){let l=e.find(([c])=>X(c.identifier,a.identifier)&&c.manifest.version===a.version);l&&(a.metadata={...a.metadata,...l[1]},i.push(a)),s.push(a)}return s}),i}async removeExtensionFromProfile(e,r){let i=[];try{await this.withProfileExtensions(r,o=>{let s=[];for(let a of o)X(a.identifier,e.identifier)?i.push(a):s.push(a);return i.length&&this._onRemoveExtensions.fire({extensions:i,profileLocation:r}),s}),i.length&&this._onDidRemoveExtensions.fire({extensions:i,profileLocation:r})}catch(o){throw i.length&&this._onDidRemoveExtensions.fire({extensions:i,error:o,profileLocation:r}),o}}async withProfileExtensions(e,r,i){return this.getResourceAccessQueue(e).queue(async()=>{let o=[],s;try{let a=await this.fileService.readFile(e);s=JSON.parse(a.value.toString().trim()||"[]")}catch(a){if(Ue(a)!==1)throw a;if(this.uriIdentityService.extUri.isEqual(e,this.userDataProfilesService.defaultProfile.extensionsResource)&&(s=await this.migrateFromOldDefaultProfileExtensionsLocation()),!s&&i?.bailOutWhenFileNotFound)throw new Hr(G(a),"ERROR_PROFILE_NOT_FOUND")}if(s){Array.isArray(s)||this.reportAndThrowInvalidConentError(e);let a=!1;for(let l of s){gm(l)||this.reportAndThrowInvalidConentError(e);let c;if(be(l.relativeLocation)&&l.relativeLocation)c=this.resolveExtensionLocation(l.relativeLocation);else if(be(l.location)){this.logService.warn(`Extensions profile: Ignoring extension with invalid location: ${l.location}`);continue}else{c=P.revive(l.location);let u=this.toRelativePath(c);u&&(a=!0,l.relativeLocation=u)}Yt(l.metadata?.hasPreReleaseVersion)&&l.metadata?.preRelease&&(a=!0,l.metadata.hasPreReleaseVersion=!0),o.push({identifier:l.identifier,location:c,version:l.version,metadata:l.metadata})}a&&await this.fileService.writeFile(e,W.fromString(JSON.stringify(s)))}if(r){o=r(o);let a=o.map(l=>({identifier:l.identifier,version:l.version,location:l.location.toJSON(),relativeLocation:this.toRelativePath(l.location),metadata:l.metadata}));await this.fileService.writeFile(e,W.fromString(JSON.stringify(a)))}return o})}reportAndThrowInvalidConentError(e){let r=new Hr(`Invalid extensions content in ${e.toString()}`,"ERROR_INVALID_CONTENT");throw this.telemetryService.publicLogError2("extensionsProfileScanningError",{code:r.code}),r}toRelativePath(e){return this.uriIdentityService.extUri.isEqual(this.uriIdentityService.extUri.dirname(e),this.extensionsLocation)?this.uriIdentityService.extUri.basename(e):void 0}resolveExtensionLocation(e){return this.uriIdentityService.extUri.joinPath(this.extensionsLocation,e)}_migrationPromise;async migrateFromOldDefaultProfileExtensionsLocation(){return this._migrationPromise||(this._migrationPromise=(async()=>{let e=this.uriIdentityService.extUri.joinPath(this.userDataProfilesService.defaultProfile.location,"extensions.json"),r=this.uriIdentityService.extUri.joinPath(this.extensionsLocation,".init-default-profile-extensions"),i;try{i=(await this.fileService.readFile(e)).value.toString()}catch(s){if(Ue(s)===1)return;throw s}this.logService.info("Migrating extensions from old default profile location",e.toString());let o;try{let s=JSON.parse(i);Array.isArray(s)&&s.every(a=>gm(a))?o=s:this.logService.warn("Skipping migrating from old default profile locaiton: Found invalid data",s)}catch(s){this.logService.error(s)}if(o)try{await this.fileService.createFile(this.userDataProfilesService.defaultProfile.extensionsResource,W.fromString(JSON.stringify(o)),{overwrite:!1}),this.logService.info("Migrated extensions from old default profile location to new location",e.toString(),this.userDataProfilesService.defaultProfile.extensionsResource.toString())}catch(s){if(Ue(s)===3)this.logService.info("Migration from old default profile location to new location is done by another window",e.toString(),this.userDataProfilesService.defaultProfile.extensionsResource.toString());else throw s}try{await this.fileService.del(e)}catch(s){Ue(s)!==1&&this.logService.error(s)}try{await this.fileService.del(r)}catch(s){Ue(s)!==1&&this.logService.error(s)}return o})()),this._migrationPromise}getResourceAccessQueue(e){let r=this.resourcesAccessQueueMap.get(e);return r||(r=new pn,this.resourcesAccessQueueMap.set(e,r)),r}};Ji=D([b(1,pe),b(2,rt),b(3,_e),b(4,He),b(5,J)],Ji);function gm(n){return $e(n)&&Wh(n.identifier)&&(nx(n.location)||be(n.location)&&n.location)&&(Yt(n.relativeLocation)||be(n.relativeLocation))&&n.version&&be(n.version)}function nx(n){return n?be(n.path)&&be(n.scheme):!1}function Nl(n){switch(n){case 1:return g("error.invalidSymbol","Invalid symbol");case 2:return g("error.invalidNumberFormat","Invalid number format");case 3:return g("error.propertyNameExpected","Property name expected");case 4:return g("error.valueExpected","Value expected");case 5:return g("error.colonExpected","Colon expected");case 6:return g("error.commaExpected","Comma expected");case 7:return g("error.closeBraceExpected","Closing brace expected");case 8:return g("error.closeBracketExpected","Closing bracket expected");case 9:return g("error.endOfFileExpected","End of file expected");default:return""}}function hm(n,t,e,r){try{rx(n,t,e,r)}catch(i){n.error(i?.message??i)}return t}function rx(n,t,e,r){let i=(o,s,a)=>{let l=o[s];if(be(l)){let c=l,u=c.length;if(u>1&&c[0]==="%"&&c[u-1]==="%"){let f=c.substr(1,u-2),p=e[f];p===void 0&&r&&(p=r[f]);let h=typeof p=="string"?p:p?.message,v=r?.[f],y=typeof v=="string"?v:v?.message;if(!h){y||n.warn(`[${t.name}]: ${g("missingNLSKey","Couldn't find message for key {0}.",f)}`);return}if(a&&(s==="title"||s==="category")&&y&&y!==h){let I={value:h,original:y};o[s]=I}else o[s]=h}}else if($e(l))for(let c in l)l.hasOwnProperty(c)&&(c==="commands"?i(l,c,!0):i(l,c,a));else if(Array.isArray(l))for(let c=0;c<l.length;c++)i(l,c,a)};for(let o in t)t.hasOwnProperty(o)&&i(t,o)}var mm;(t=>{function n(e,r){if(e===r)return!0;let i=Object.keys(e),o=new Set;for(let s of Object.keys(r))o.add(s);if(i.length!==o.size)return!1;for(let s of i){if(e[s]!==r[s])return!1;o.delete(s)}return o.size===0}t.equals=n})(mm||={});var eo=$("IExtensionsScannerService"),Xi=class extends U{constructor(e,r,i,o,s,a,l,c,u,f,p,h){super();this.systemExtensionsLocation=e;this.userExtensionsLocation=r;this.extensionsControlLocation=i;this.currentProfile=o;this.userDataProfilesService=s;this.extensionsProfileScannerService=a;this.fileService=l;this.logService=c;this.environmentService=u;this.productService=f;this.uriIdentityService=p;this.instantiationService=h;this._register(this.systemExtensionsCachedScanner.onDidChangeCache(()=>this._onDidChangeCache.fire(0))),this._register(this.userExtensionsCachedScanner.onDidChangeCache(()=>this._onDidChangeCache.fire(1)))}_serviceBrand;_onDidChangeCache=this._register(new C);onDidChangeCache=this._onDidChangeCache.event;obsoleteFile=B(this.userExtensionsLocation,".obsolete");systemExtensionsCachedScanner=this._register(this.instantiationService.createInstance(Zi,this.currentProfile,this.obsoleteFile));userExtensionsCachedScanner=this._register(this.instantiationService.createInstance(Zi,this.currentProfile,this.obsoleteFile));extensionsScanner=this._register(this.instantiationService.createInstance(Yi,this.obsoleteFile));_targetPlatformPromise;getTargetPlatform(){return this._targetPlatformPromise||(this._targetPlatformPromise=Pl(this.fileService,this.logService)),this._targetPlatformPromise}async scanAllExtensions(e,r,i){let[o,s]=await Promise.all([this.scanSystemExtensions(e),this.scanUserExtensions(r)]),a=i?await this.scanExtensionsUnderDevelopment(e,[...o,...s]):[];return this.dedupExtensions(o,s,a,await this.getTargetPlatform(),!0)}async scanSystemExtensions(e){let r=[];r.push(this.scanDefaultSystemExtensions(!!e.useCache,e.language)),r.push(this.scanDevSystemExtensions(e.language,!!e.checkControlFile));let[i,o]=await Promise.all(r);return this.applyScanOptions([...i,...o],0,e,!1)}async scanUserExtensions(e){let r=e.profileLocation??this.userExtensionsLocation;this.logService.trace("Started scanning user extensions",r);let i=this.uriIdentityService.extUri.isEqual(e.profileLocation,this.userDataProfilesService.defaultProfile.extensionsResource)?{bailOutWhenFileNotFound:!0}:void 0,o=await this.createExtensionScannerInput(r,!!e.profileLocation,1,!e.includeUninstalled,e.language,!0,i,e.productVersion??this.getProductVersion()),s=e.useCache&&!o.devMode&&o.excludeObsolete?this.userExtensionsCachedScanner:this.extensionsScanner,a;try{a=await s.scanExtensions(o)}catch(l){if(l instanceof Hr&&l.code==="ERROR_PROFILE_NOT_FOUND")await this.doInitializeDefaultProfileExtensions(),a=await s.scanExtensions(o);else throw l}return a=await this.applyScanOptions(a,1,e,!0),this.logService.trace("Scanned user extensions:",a.length),a}async scanExtensionsUnderDevelopment(e,r){if(this.environmentService.isExtensionDevelopment&&this.environmentService.extensionDevelopmentLocationURI){let i=(await Promise.all(this.environmentService.extensionDevelopmentLocationURI.filter(o=>o.scheme===Q.file).map(async o=>{let s=await this.createExtensionScannerInput(o,!1,1,!0,e.language,!1,void 0,e.productVersion??this.getProductVersion());return(await this.extensionsScanner.scanOneOrMultipleExtensions(s)).map(l=>(l.type=r.find(c=>X(c.identifier,l.identifier))?.type??l.type,this.extensionsScanner.validate(l,s)))}))).flat();return this.applyScanOptions(i,"development",e,!0)}return[]}async scanExistingExtension(e,r,i){let o=await this.createExtensionScannerInput(e,!1,r,!0,i.language,!0,void 0,i.productVersion??this.getProductVersion()),s=await this.extensionsScanner.scanExtension(o);return!s||!i.includeInvalid&&!s.isValid?null:s}async scanOneOrMultipleExtensions(e,r,i){let o=await this.createExtensionScannerInput(e,!1,r,!0,i.language,!0,void 0,i.productVersion??this.getProductVersion()),s=await this.extensionsScanner.scanOneOrMultipleExtensions(o);return this.applyScanOptions(s,r,i,!0)}async scanMultipleExtensions(e,r,i){let o=[];return await Promise.all(e.map(async s=>{let a=await this.scanOneOrMultipleExtensions(s,r,i);o.push(...a)})),this.applyScanOptions(o,r,i,!0)}async scanMetadata(e){let r=B(e,"package.json"),i=(await this.fileService.readFile(r)).value.toString();return JSON.parse(i).__metadata}async updateMetadata(e,r){let i=B(e,"package.json"),o=(await this.fileService.readFile(i)).value.toString(),s=JSON.parse(o);r.isMachineScoped===!1&&delete r.isMachineScoped,r.isBuiltin===!1&&delete r.isBuiltin,s.__metadata={...s.__metadata,...r},await this.fileService.writeFile(B(e,"package.json"),W.fromString(JSON.stringify(s,null,"	")))}async initializeDefaultProfileExtensions(){try{await this.extensionsProfileScannerService.scanProfileExtensions(this.userDataProfilesService.defaultProfile.extensionsResource,{bailOutWhenFileNotFound:!0})}catch(e){if(e instanceof Hr&&e.code==="ERROR_PROFILE_NOT_FOUND")await this.doInitializeDefaultProfileExtensions();else throw e}}initializeDefaultProfileExtensionsPromise=void 0;async doInitializeDefaultProfileExtensions(){return this.initializeDefaultProfileExtensionsPromise||(this.initializeDefaultProfileExtensionsPromise=(async()=>{try{this.logService.info("Started initializing default profile extensions in extensions installation folder.",this.userExtensionsLocation.toString());let e=await this.scanUserExtensions({includeInvalid:!0});if(e.length)await this.extensionsProfileScannerService.addExtensionsToProfile(e.map(r=>[r,r.metadata]),this.userDataProfilesService.defaultProfile.extensionsResource);else try{await this.fileService.createFile(this.userDataProfilesService.defaultProfile.extensionsResource,W.fromString(JSON.stringify([])))}catch(r){Ue(r)!==1&&this.logService.warn("Failed to create default profile extensions manifest in extensions installation folder.",this.userExtensionsLocation.toString(),G(r))}this.logService.info("Completed initializing default profile extensions in extensions installation folder.",this.userExtensionsLocation.toString())}catch(e){this.logService.error(e)}finally{this.initializeDefaultProfileExtensionsPromise=void 0}})()),this.initializeDefaultProfileExtensionsPromise}async applyScanOptions(e,r,i,o){return i.includeAllVersions||(e=this.dedupExtensions(r===0?e:void 0,r===1?e:void 0,r==="development"?e:void 0,await this.getTargetPlatform(),o)),i.includeInvalid||(e=e.filter(s=>s.isValid)),e.sort((s,a)=>{let l=je(s.location.fsPath),c=je(a.location.fsPath);return l<c?-1:l>c?1:0})}dedupExtensions(e,r,i,o,s){let a=(c,u,f)=>{if(c.isValid&&!u.isValid)return!1;if(c.isValid===u.isValid){if(s&&ds(c.manifest.version,u.manifest.version))return this.logService.debug(`Skipping extension ${u.location.path} with lower version ${u.manifest.version} in favour of ${c.location.path} with version ${c.manifest.version}`),!1;if(qh(c.manifest.version,u.manifest.version)){if(c.type===0)return this.logService.debug(`Skipping extension ${u.location.path} in favour of system extension ${c.location.path} with same version`),!1;if(c.targetPlatform===o)return this.logService.debug(`Skipping extension ${u.location.path} from different target platform ${u.targetPlatform}`),!1}}return f?this.logService.warn(`Overwriting user extension ${c.location.path} with ${u.location.path}.`):this.logService.debug(`Overwriting user extension ${c.location.path} with ${u.location.path}.`),!0},l=new Il;return e?.forEach(c=>{let u=l.get(c.identifier.id);(!u||a(u,c,!1))&&l.set(c.identifier.id,c)}),r?.forEach(c=>{let u=l.get(c.identifier.id);if(!u&&e&&c.type===0){this.logService.debug(`Skipping obsolete system extension ${c.location.path}.`);return}(!u||a(u,c,!1))&&l.set(c.identifier.id,c)}),i?.forEach(c=>{let u=l.get(c.identifier.id);(!u||a(u,c,!0))&&l.set(c.identifier.id,c),l.set(c.identifier.id,c)}),[...l.values()]}async scanDefaultSystemExtensions(e,r){this.logService.trace("Started scanning system extensions");let i=await this.createExtensionScannerInput(this.systemExtensionsLocation,!1,0,!0,r,!0,void 0,this.getProductVersion()),s=await(e&&!i.devMode?this.systemExtensionsCachedScanner:this.extensionsScanner).scanExtensions(i);return this.logService.trace("Scanned system extensions:",s.length),s}async scanDevSystemExtensions(e,r){let i=this.environmentService.isBuilt?[]:this.productService.builtInExtensions;if(!i?.length)return[];this.logService.trace("Started scanning dev system extensions");let o=r?await this.getBuiltInExtensionControl():{},s=[],a=P.file(Wt(V(fn.asFileUri("").fsPath,"..",".build","builtInExtensions")));for(let c of i){let u=o[c.name]||"marketplace";switch(u){case"disabled":break;case"marketplace":s.push(B(a,c.name));break;default:s.push(P.file(u));break}}let l=await Promise.all(s.map(async c=>this.extensionsScanner.scanExtension(await this.createExtensionScannerInput(c,!1,0,!0,e,!0,void 0,this.getProductVersion()))));return this.logService.trace("Scanned dev system extensions:",l.length),Jt(l)}async getBuiltInExtensionControl(){try{let e=await this.fileService.readFile(this.extensionsControlLocation);return JSON.parse(e.value.toString())}catch{return{}}}async createExtensionScannerInput(e,r,i,o,s,a,l,c){let u=await this.getTranslations(s??Xt),f=await this.getMtime(e),p=r&&!this.uriIdentityService.extUri.isEqual(e,this.userDataProfilesService.defaultProfile.extensionsResource)?this.userDataProfilesService.defaultProfile.extensionsResource:void 0,h=p?await this.getMtime(p):void 0;return new Qr(e,f,p,h,r,l,i,o,a,c.version,c.date,this.productService.commit,!this.environmentService.isBuilt,s,u)}async getMtime(e){try{let r=await this.fileService.stat(e);if(typeof r.mtime=="number")return r.mtime}catch{}}getProductVersion(){return{version:this.productService.version,date:this.productService.date}}};Xi=D([b(4,rt),b(5,rn),b(6,pe),b(7,J),b(8,xt),b(9,vt),b(10,_e),b(11,cr)],Xi);var Qr=class{constructor(t,e,r,i,o,s,a,l,c,u,f,p,h,v,y){this.location=t;this.mtime=e;this.applicationExtensionslocation=r;this.applicationExtensionslocationMtime=i;this.profile=o;this.profileScanOptions=s;this.type=a;this.excludeObsolete=l;this.validate=c;this.productVersion=u;this.productDate=f;this.productCommit=p;this.devMode=h;this.language=v;this.translations=y}static createNlsConfiguration(t){return{language:t.language,pseudo:t.language==="pseudo",devMode:t.devMode,translations:t.translations}}static equals(t,e){return la(t.location,e.location)&&t.mtime===e.mtime&&la(t.applicationExtensionslocation,e.applicationExtensionslocation)&&t.applicationExtensionslocationMtime===e.applicationExtensionslocationMtime&&t.profile===e.profile&&Ct(t.profileScanOptions,e.profileScanOptions)&&t.type===e.type&&t.excludeObsolete===e.excludeObsolete&&t.validate===e.validate&&t.productVersion===e.productVersion&&t.productDate===e.productDate&&t.productCommit===e.productCommit&&t.devMode===e.devMode&&t.language===e.language&&mm.equals(t.translations,e.translations)}},Yi=class extends U{constructor(e,r,i,o,s,a,l){super();this.obsoleteFile=e;this.extensionsProfileScannerService=r;this.uriIdentityService=i;this.fileService=o;this.environmentService=a;this.logService=l;this.extensionsEnabledWithApiProposalVersion=s.extensionsEnabledWithApiProposalVersion?.map(c=>c.toLowerCase())??[]}extensionsEnabledWithApiProposalVersion;async scanExtensions(e){let r=e.profile?await this.scanExtensionsFromProfile(e):await this.scanExtensionsFromLocation(e),i={};if(e.excludeObsolete&&e.type===1)try{let o=(await this.fileService.readFile(this.obsoleteFile)).value.toString();i=JSON.parse(o)}catch{}return di(i)?r:r.filter(o=>!i[Be.create(o).toString()])}async scanExtensionsFromLocation(e){let r=await this.fileService.resolve(e.location);if(!r.children?.length)return[];let i=await Promise.all(r.children.map(async o=>{if(!o.isDirectory||e.type===1&&_n(o.resource).indexOf(".")===0)return null;let s=new Qr(o.resource,e.mtime,e.applicationExtensionslocation,e.applicationExtensionslocationMtime,e.profile,e.profileScanOptions,e.type,e.excludeObsolete,e.validate,e.productVersion,e.productDate,e.productCommit,e.devMode,e.language,e.translations);return this.scanExtension(s)}));return Jt(i).sort((o,s)=>o.location.path<s.location.path?-1:1)}async scanExtensionsFromProfile(e){let r=await this.scanExtensionsFromProfileResource(e.location,()=>!0,e);if(e.applicationExtensionslocation&&!this.uriIdentityService.extUri.isEqual(e.location,e.applicationExtensionslocation)){r=r.filter(o=>!o.metadata?.isApplicationScoped);let i=await this.scanExtensionsFromProfileResource(e.applicationExtensionslocation,o=>!!o.metadata?.isBuiltin||!!o.metadata?.isApplicationScoped,e);r.push(...i)}return r}async scanExtensionsFromProfileResource(e,r,i){let o=await this.extensionsProfileScannerService.scanProfileExtensions(e,i.profileScanOptions);if(!o.length)return[];let s=await Promise.all(o.map(async a=>{if(r(a)){let l=new Qr(a.location,i.mtime,i.applicationExtensionslocation,i.applicationExtensionslocationMtime,i.profile,i.profileScanOptions,i.type,i.excludeObsolete,i.validate,i.productVersion,i.productDate,i.productCommit,i.devMode,i.language,i.translations);return this.scanExtension(l,a.metadata)}return null}));return Jt(s)}async scanOneOrMultipleExtensions(e){try{if(await this.fileService.exists(B(e.location,"package.json"))){let r=await this.scanExtension(e);return r?[r]:[]}else return await this.scanExtensions(e)}catch(r){return this.logService.error(`Error scanning extensions at ${e.location.path}:`,G(r)),[]}}async scanExtension(e,r){try{let i=await this.scanExtensionManifest(e.location);if(i){i.publisher||(i.publisher=El),r=r??i.__metadata,delete i.__metadata;let o=kt(i.publisher,i.name),s=r?.id?{id:o,uuid:r.id}:{id:o},a=r?.isSystem?0:e.type,l=a===0||!!r?.isBuiltin;i=await this.translateManifest(e.location,i,Qr.createNlsConfiguration(e));let c={type:a,identifier:s,manifest:i,location:e.location,isBuiltin:l,targetPlatform:r?.targetPlatform??"undefined",publisherDisplayName:r?.publisherDisplayName,metadata:r,isValid:!0,validations:[]};return e.validate&&(c=this.validate(c,e)),i.enabledApiProposals&&(!this.environmentService.isBuilt||this.extensionsEnabledWithApiProposalVersion.includes(o.toLowerCase()))&&(i.originalEnabledApiProposals=i.enabledApiProposals,i.enabledApiProposals=Ah([...i.enabledApiProposals])),c}}catch(i){e.type!==0&&this.logService.error(i)}return null}validate(e,r){let i=!0,o=this.environmentService.isBuilt&&this.extensionsEnabledWithApiProposalVersion.includes(e.identifier.id.toLowerCase()),s=Gh(r.productVersion,r.productDate,r.location,e.manifest,e.isBuiltin,o);for(let[a,l]of s)a===Qe.Error&&(i=!1,this.logService.error(this.formatMessage(r.location,l)));return e.isValid=i,e.validations=s,e}async scanExtensionManifest(e){let r=B(e,"package.json"),i;try{i=(await this.fileService.readFile(r)).value.toString()}catch(s){return Ue(s)!==1&&this.logService.error(this.formatMessage(e,g("fileReadFail","Cannot read file {0}: {1}.",r.path,s.message))),null}let o;try{o=JSON.parse(i)}catch{let a=[];Wr(i,a);for(let l of a)this.logService.error(this.formatMessage(e,g("jsonParseFail","Failed to parse {0}: [{1}, {2}] {3}.",r.path,l.offset,l.length,Nl(l.error))));return null}return xi(o)!=="object"?(this.logService.error(this.formatMessage(e,g("jsonParseInvalidType","Invalid manifest file {0}: Not a JSON object.",r.path))),null):o}async translateManifest(e,r,i){let o=await this.getLocalizedMessages(e,r,i);if(o)try{let s=[],a=await this.resolveOriginalMessageBundle(o.default,s);if(s.length>0)return s.forEach(c=>{this.logService.error(this.formatMessage(e,g("jsonsParseReportErrors","Failed to parse {0}: {1}.",o.default?.path,Nl(c.error))))}),r;if(xi(o)!=="object")return this.logService.error(this.formatMessage(e,g("jsonInvalidFormat","Invalid format {0}: JSON object expected.",o.default?.path))),r;let l=o.values||Object.create(null);return hm(this.logService,r,l,a)}catch{}return r}async getLocalizedMessages(e,r,i){let o=B(e,"package.nls.json"),s=(u,f)=>{f.forEach(p=>{this.logService.error(this.formatMessage(e,g("jsonsParseReportErrors","Failed to parse {0}: {1}.",u?.path,Nl(p.error))))})},a=u=>{this.logService.error(this.formatMessage(e,g("jsonInvalidFormat","Invalid format {0}: JSON object expected.",u?.path)))},l=`${r.publisher}.${r.name}`,c=i.translations[l];if(c)try{let u=P.file(c),f=(await this.fileService.readFile(u)).value.toString(),p=[],h=Wr(f,p);return p.length>0?(s(u,p),{values:void 0,default:o}):xi(h)!=="object"?(a(u),{values:void 0,default:o}):{values:h.contents?h.contents.package:void 0,default:o}}catch{return{values:void 0,default:o}}else{if(!await this.fileService.exists(o))return;let f;try{f=await this.findMessageBundles(e,i)}catch{return}if(!f.localized)return{values:void 0,default:f.original};try{let p=(await this.fileService.readFile(f.localized)).value.toString(),h=[],v=Wr(p,h);return h.length>0?(s(f.localized,h),{values:void 0,default:f.original}):xi(v)!=="object"?(a(f.localized),{values:void 0,default:f.original}):{values:v,default:f.original}}catch{return{values:void 0,default:f.original}}}}async resolveOriginalMessageBundle(e,r){if(e)try{let i=(await this.fileService.readFile(e)).value.toString();return Wr(i,r)}catch{}}findMessageBundles(e,r){return new Promise((i,o)=>{let s=a=>{let l=B(e,`package.nls.${a}.json`);this.fileService.exists(l).then(c=>{c&&i({localized:l,original:B(e,"package.nls.json")});let u=a.lastIndexOf("-");u===-1?i({localized:B(e,"package.nls.json"),original:null}):(a=a.substring(0,u),s(a))})};if(r.devMode||r.pseudo||!r.language)return i({localized:B(e,"package.nls.json"),original:null});s(r.language)})}formatMessage(e,r){return`[${e.path}]: ${r}`}};Yi=D([b(1,rn),b(2,_e),b(3,pe),b(4,vt),b(5,xt),b(6,J)],Yi);var Zi=class extends Yi{constructor(e,r,i,o,s,a,l,c,u){super(r,o,s,a,l,c,u);this.currentProfile=e;this.userDataProfilesService=i}input;cacheValidatorThrottler=this._register(new Zt(3e3));_onDidChangeCache=this._register(new C);onDidChangeCache=this._onDidChangeCache.event;async scanExtensions(e){let r=this.getCacheFile(e),i=await this.readExtensionCache(r);if(this.input=e,i&&i.input&&Qr.equals(i.input,this.input))return this.logService.debug("Using cached extensions scan result",e.type===0?"system":"user",e.location.toString()),this.cacheValidatorThrottler.trigger(()=>this.validateCache()),i.result.map(s=>(s.location=P.revive(s.location),s));let o=await super.scanExtensions(e);return await this.writeExtensionCache(r,{input:e,result:o}),o}async readExtensionCache(e){try{let r=await this.fileService.readFile(e),i=JSON.parse(r.value.toString());return{result:i.result,input:zr(i.input)}}catch(r){this.logService.debug("Error while reading the extension cache file:",e.path,G(r))}return null}async writeExtensionCache(e,r){try{await this.fileService.writeFile(e,W.fromString(JSON.stringify(r)))}catch(i){this.logService.debug("Error while writing the extension cache file:",e.path,G(i))}}async validateCache(){if(!this.input)return;let e=this.getCacheFile(this.input),r=await this.readExtensionCache(e);if(!r)return;let i=r.result,o=JSON.parse(JSON.stringify(await super.scanExtensions(this.input)));if(!Ct(o,i))try{this.logService.info("Invalidating Cache",i,o),await this.fileService.del(e),this._onDidChangeCache.fire()}catch(s){this.logService.error(s)}}getCacheFile(e){let r=this.getProfile(e);return this.uriIdentityService.extUri.joinPath(r.cacheHome,e.type===0?Dh:xl)}getProfile(e){return e.type===0?this.userDataProfilesService.defaultProfile:e.profile?this.uriIdentityService.extUri.isEqual(e.location,this.currentProfile.extensionsResource)?this.currentProfile:this.userDataProfilesService.profiles.find(r=>this.uriIdentityService.extUri.isEqual(e.location,r.extensionsResource))??this.currentProfile:this.userDataProfilesService.defaultProfile}};Zi=D([b(2,rt),b(3,rn),b(4,_e),b(5,pe),b(6,vt),b(7,xt),b(8,J)],Zi);function ms(n){let t="Extract";return n instanceof Gr&&(n.type==="CorruptZip"?t="CorruptZip":n.type==="Incomplete"&&(t="IncompleteZip")),De(n,t)}async function Ml(n){let t;try{t=await Ll(n,"extension/package.json")}catch(e){throw ms(e)}try{return JSON.parse(t.toString("utf8"))}catch{throw new Pe(g("invalidManifest","VSIX invalid: package.json is not a JSON file."),"Invalid")}}var Ed=class{constructor(t,e,r){this.id=t;this.dependencies=e;this.callback=r}};var Sd=class n{static INSTANCE=new n;_isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope";_isRenderer=typeof document=="object";_defineCalls=[];_state=1;_amdPolicy;constructor(){}_initialize(){if(this._state===1){if(globalThis.define){console.log("[amdX] AMD loader already present externally"),this._state=3;return}}else return;this._state=2,globalThis.define=(t,e,r)=>{typeof t!="string"&&(r=e,e=t,t=null),(typeof e!="object"||!Array.isArray(e))&&(r=e,e=null),this._defineCalls.push(new Ed(t,e,r))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){if(t.startsWith(window.location.origin)||t.startsWith(`${Q.vscodeFileResource}://${iu}`))return t;throw new Error(`[trusted_script_src] Invalid script url: ${t}`)}}):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){return t}}))}async load(t){if(this._initialize(),this._state===3)return new Promise(s=>{let a=Ke();console.log(`[amdX] Using external define("${a}", ["${t}"])`),globalThis.define(a,[t],function(l){console.log(`[amdX] Got a result for ${a}: ${!!l}`),s(l)})});let e=await(this._isWebWorker?this._workerLoadScript(t):this._isRenderer?this._rendererLoadScript(t):this._nodeJSLoadScript(t));if(!e){console.warn(`Did not receive a define call from script ${t}`);return}let r={},i=[],o=[];if(Array.isArray(e.dependencies))for(let s of e.dependencies)s==="exports"?i.push(r):o.push(s);if(o.length>0)throw new Error(`Cannot resolve dependencies for script ${t}. The dependencies are: ${o.join(", ")}`);return typeof e.callback=="function"?e.callback(...i)??r:e.callback}_rendererLoadScript(t){return new Promise((e,r)=>{let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("type","text/javascript");let o=()=>{i.removeEventListener("load",s),i.removeEventListener("error",a)},s=l=>{o(),e(this._defineCalls.pop())},a=l=>{o(),r(l)};i.addEventListener("load",s),i.addEventListener("error",a),this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),i.setAttribute("src",t),window.document.getElementsByTagName("head")[0].appendChild(i)})}async _workerLoadScript(t){return this._amdPolicy&&(t=this._amdPolicy.createScriptURL(t)),await import(t),this._defineCalls.pop()}async _nodeJSLoadScript(t){try{let e=(await import("fs")).default,r=(await import("vm")).default,i=(await import("module")).default,o=P.parse(t).fsPath,s=e.readFileSync(o).toString(),a=i.wrap(s.replace(/^#!.*/,""));return new r.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(e){throw e}}},xd=new Map;async function vm(n,t,e){if(!0){e===void 0&&(e=!!(globalThis._VSCODE_PRODUCT_JSON??globalThis.vscode?.context?.configuration()?.product)?.commit);let r=t?`${n}/${t}`:n;if(xd.has(r))return xd.get(r);let i;if(/^\w[\w\d+.-]*:\/\//.test(r))i=r;else{let l=`${op}/${r}`;i=fn.asBrowserUri(l).toString(!0)}let o=Sd.INSTANCE.load(i);return xd.set(r,o),o}else return await import(n)}var Vl=$("IExtensionSignatureVerificationService");var wd=class extends Error{constructor(e){super(e);this.code=e}},to=class{constructor(t,e){this.logService=t;this.telemetryService=e}moduleLoadingPromise;vsceSign(){return this.moduleLoadingPromise||(this.moduleLoadingPromise=this.resolveVsceSign()),this.moduleLoadingPromise}async resolveVsceSign(){return import("@vscode/vsce-sign")}async verify(t,e,r,i){let o,s=t.identifier.id;try{o=await this.vsceSign()}catch(u){return this.logService.error("Could not load vsce-sign module",G(u)),this.logService.info(`Extension signature verification is not done: ${s}`),!1}let a=new Date().getTime(),l;try{this.logService.trace(`Verifying extension signature for ${s}...`),l=await o.verify(e,r,this.logService.getLevel()===1)}catch(u){l={code:"UnknownError",didExecute:!1,output:G(u)}}let c=new Date().getTime()-a;if(this.logService.info(`Extension signature verification result for ${s}: ${l.code}. Executed: ${l.didExecute}. Duration: ${c}ms.`),this.logService.trace(`Extension signature verification output for ${s}:
${l.output}`),this.telemetryService.publicLog2("extensionsignature:verification",{extensionId:s,extensionVersion:t.version,code:l.code,internalCode:l.internalCode,duration:c,didExecute:l.didExecute,clientTargetPlatform:i}),l.code==="Success")return!0;throw new wd(l.code)}};to=D([b(0,J),b(1,He)],to);var vr=class extends U{constructor(e,r,i,o,s,a,l){super();this.fileService=r;this.extensionGalleryService=i;this.configurationService=o;this.extensionSignatureVerificationService=s;this.telemetryService=a;this.logService=l;this.extensionsDownloadDir=e.extensionsDownloadLocation,this.cache=20,this.cleanUpPromise=this.cleanUp()}static SignatureArchiveExtension=".sigzip";extensionsDownloadDir;cache;cleanUpPromise;async download(e,r,i,o){await this.cleanUpPromise;let s=await this.downloadVSIX(e,r),a=!1;if(i&&this.shouldVerifySignature(e)){let l;try{l=await this.downloadSignatureArchive(e)}catch(c){try{await this.delete(s)}catch(u){this.logService.error(u)}throw c}try{a=await this.extensionSignatureVerificationService.verify(e,s.fsPath,l.fsPath,o)}catch(c){if(a=c.code,a==="PackageIsInvalidZip"||a==="SignatureArchiveIsInvalidZip"){try{await this.delete(s)}catch(u){this.logService.error(u)}throw new Pe(yd,"CorruptZip")}}finally{try{await this.delete(l)}catch(c){this.logService.error(c)}}}return{location:s,verificationStatus:a}}shouldVerifySignature(e){if(!e.isSigned)return this.logService.info(`Extension is not signed: ${e.identifier.id}`),!1;let r=this.configurationService.getValue("extensions.verifySignature");return Kt(r)?r:!0}async downloadVSIX(e,r){try{let i=B(this.extensionsDownloadDir,this.getName(e)),o=await this.doDownload(e,"vsix",async()=>{await this.downloadFile(e,i,s=>this.extensionGalleryService.download(e,s,r));try{await this.validate(i.fsPath,"extension/package.json")}catch(s){try{await this.fileService.del(i)}catch(a){this.logService.warn(`Error while deleting: ${i.path}`,G(a))}throw s}},2);return o>1&&this.telemetryService.publicLog2("extensiongallery:downloadvsix:retry",{extensionId:e.identifier.id,attempts:o}),i}catch(i){throw De(i,"Download")}}async downloadSignatureArchive(e){try{let r=B(this.extensionsDownloadDir,`.${Ke()}`),i=await this.doDownload(e,"sigzip",async()=>{await this.extensionGalleryService.downloadSignatureArchive(e,r);try{await this.validate(r.fsPath,".signature.p7s")}catch(o){try{await this.fileService.del(r)}catch(s){this.logService.warn(`Error while deleting: ${r.path}`,G(s))}throw o}},2);return i>1&&this.telemetryService.publicLog2("extensiongallery:downloadsigzip:retry",{extensionId:e.identifier.id,attempts:i}),r}catch(r){throw De(r,"DownloadSignature")}}async downloadFile(e,r,i){if(await this.fileService.exists(r))return;if(r.scheme!==Q.file){await i(r);return}let o=B(this.extensionsDownloadDir,`.${Ke()}`);try{await i(o)}catch(s){try{await this.fileService.del(o)}catch{}throw s}try{await se.rename(o.fsPath,r.fsPath,2*60*1e3)}catch(s){try{await this.fileService.del(o)}catch{}let a=!1;try{a=await this.fileService.exists(r)}catch{}if(a)this.logService.info("Rename failed because the file was downloaded by another source. So ignoring renaming.",e.identifier.id,r.path);else throw this.logService.info(`Rename failed because of ${G(s)}. Deleted the file from downloaded location`,o.path),s}}async doDownload(e,r,i,o){let s=1;for(;;)try{return await i(),s}catch(a){if(s++>o)throw a;this.logService.warn(`Failed downloading ${r}. ${G(a)}. Retry again...`,e.identifier.id)}}async validate(e,r){try{await Ll(e,r)}catch(i){throw ms(i)}}async delete(e){await this.cleanUpPromise,await this.fileService.del(e)}async cleanUp(){try{if(!await this.fileService.exists(this.extensionsDownloadDir)){this.logService.trace("Extension VSIX downloads cache dir does not exist");return}let e=await this.fileService.resolve(this.extensionsDownloadDir,{resolveMetadata:!0});if(e.children){let r=[],i=[],o=[];for(let l of e.children)if(l.name.endsWith(vr.SignatureArchiveExtension))o.push(l.resource);else{let c=Be.parse(l.name);c&&i.push([c,l])}let s=Tl(i,([l])=>l),a=[];for(let l of s)l.sort((c,u)=>Rl(c[0].version,u[0].version)),r.push(...l.slice(1).map(c=>c[1].resource)),a.push(l[0][1]);a.sort((l,c)=>l.mtime-c.mtime),r.push(...a.slice(0,Math.max(0,a.length-this.cache)).map(l=>l.resource)),r.push(...o),await ze.settled(r.map(l=>(this.logService.trace("Deleting from cache",l.path),this.fileService.del(l))))}}catch(e){this.logService.error(e)}}getName(e){return this.cache?Be.create(e).toString().toLowerCase():Ke()}};vr=D([b(0,dt),b(1,pe),b(2,St),b(3,gn),b(4,Vl),b(5,He),b(6,J)],vr);import{fork as ox}from"child_process";var no=class extends U{constructor(e,r){super();this.userDataProfilesService=e;this.logService=r}processesLimiter=new Qo(5);async postUninstall(e){let r=this.parseScript(e,"uninstall");r&&(this.logService.info(e.identifier.id,e.manifest.version,"Running post uninstall script"),await this.processesLimiter.queue(async()=>{try{await this.runLifecycleHook(r.script,"uninstall",r.args,!0,e),this.logService.info("Finished running post uninstall script",e.identifier.id,e.manifest.version)}catch(i){this.logService.error("Failed to run post uninstall script",e.identifier.id,e.manifest.version),this.logService.error(i)}}));try{await se.rm(this.getExtensionStoragePath(e))}catch(i){this.logService.error("Error while removing extension storage path",e.identifier.id),this.logService.error(i)}}parseScript(e,r){let i=`vscode:${r}`;if(e.location.scheme===Q.file&&e.manifest&&e.manifest.scripts&&typeof e.manifest.scripts[i]=="string"){let o=e.manifest.scripts[i].split(" ");return o.length<2||o[0]!=="node"||!o[1]?(this.logService.warn(e.identifier.id,e.manifest.version,`${i} should be a node script`),null):{script:V(e.location.fsPath,o[1]),args:o.slice(2)||[]}}return null}runLifecycleHook(e,r,i,o,s){return new Promise((a,l)=>{let c=this.start(e,r,i,s),u,f=p=>{u&&(clearTimeout(u),u=null),p?l(p):a(void 0)};c.on("error",p=>{f(dn(p)||"Unknown")}),c.on("exit",(p,h)=>{f(p?`post-${r} process exited with code ${p}`:void 0)}),o&&(u=setTimeout(()=>{u=null,c.kill(),l("timed out")},5e3))})}start(e,r,i,o){let s={silent:!0,execArgv:void 0},a=ox(e,[`--type=extension-post-${r}`,...i],s);a.stdout.setEncoding("utf8"),a.stderr.setEncoding("utf8");let l=Z.fromNodeEventEmitter(a.stdout,"data"),c=Z.fromNodeEventEmitter(a.stderr,"data");this._register(l(p=>this.logService.info(o.identifier.id,o.manifest.version,`post-${r}`,p))),this._register(c(p=>this.logService.error(o.identifier.id,o.manifest.version,`post-${r}`,p)));let u=Z.any(Z.map(l,p=>({data:`%c${p}`,format:[""]}),this._store),Z.map(c,p=>({data:`%c${p}`,format:["color: red"]}),this._store));return Z.debounce(u,(p,h)=>p?{data:p.data+h.data,format:[...p.format,...h.format]}:{data:h.data,format:h.format},100,void 0,void 0,void 0,this._store)(p=>{console.group(o.identifier.id),console.log(p.data,...p.format),console.groupEnd()}),a}getExtensionStoragePath(e){return V(this.userDataProfilesService.defaultProfile.globalStorageHome.fsPath,e.identifier.id.toLowerCase())}};no=D([b(0,rt),b(1,J)],no);var Wl=class extends U{constructor(e,r,i,o,s){super();this.userDataProfilesService=e;this.fileService=r;this.uriIdentityService=i;this.logService=s;this._register(o.onDidInstallExtensions(a=>this.onDidInstallExtensions(a))),this._register(o.onDidUninstallExtension(a=>this.onDidUnInstallExtension(a)))}onDidInstallExtensions(e){for(let r of e)r.local&&this.invalidate(r.profileLocation)}onDidUnInstallExtension(e){e.error||this.invalidate(e.profileLocation)}async invalidate(e){if(e)for(let r of this.userDataProfilesService.profiles)this.uriIdentityService.extUri.isEqual(r.extensionsResource,e)&&await this.deleteUserCacheFile(r);else await this.deleteUserCacheFile(this.userDataProfilesService.defaultProfile)}async deleteUserCacheFile(e){try{await this.fileService.del(this.uriIdentityService.extUri.joinPath(e.cacheHome,xl))}catch(r){Ue(r)!==1&&this.logService.error(r)}}};var Kl=class extends U{constructor(e,r,i,o,s,a,l){super();this.extensionManagementService=e;this.extensionsScannerService=r;this.userDataProfilesService=i;this.extensionsProfileScannerService=o;this.uriIdentityService=s;this.fileService=a;this.logService=l;this.initialize().then(null,c=>l.error("Error while initializing Extensions Watcher",G(c)))}_onDidChangeExtensionsByAnotherSource=this._register(new C);onDidChangeExtensionsByAnotherSource=this._onDidChangeExtensionsByAnotherSource.event;allExtensions=new Map;extensionsProfileWatchDisposables=this._register(new Ln);async initialize(){await this.extensionsScannerService.initializeDefaultProfileExtensions(),await this.onDidChangeProfiles(this.userDataProfilesService.profiles),this.registerListeners(),await this.uninstallExtensionsNotInProfiles()}registerListeners(){this._register(this.userDataProfilesService.onDidChangeProfiles(e=>this.onDidChangeProfiles(e.added))),this._register(this.extensionsProfileScannerService.onAddExtensions(e=>this.onAddExtensions(e))),this._register(this.extensionsProfileScannerService.onDidAddExtensions(e=>this.onDidAddExtensions(e))),this._register(this.extensionsProfileScannerService.onRemoveExtensions(e=>this.onRemoveExtensions(e))),this._register(this.extensionsProfileScannerService.onDidRemoveExtensions(e=>this.onDidRemoveExtensions(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e)))}async onDidChangeProfiles(e){try{e.length&&await Promise.all(e.map(r=>(this.extensionsProfileWatchDisposables.set(r.id,ii(this.fileService.watch(this.uriIdentityService.extUri.dirname(r.extensionsResource)),this.fileService.watch(r.extensionsResource))),this.populateExtensionsFromProfile(r.extensionsResource))))}catch(r){throw this.logService.error(r),r}}async onAddExtensions(e){for(let r of e.extensions)this.addExtensionWithKey(this.getKey(r.identifier,r.version),e.profileLocation)}async onDidAddExtensions(e){for(let r of e.extensions){let i=this.getKey(r.identifier,r.version);e.error?this.removeExtensionWithKey(i,e.profileLocation):this.addExtensionWithKey(i,e.profileLocation)}}async onRemoveExtensions(e){for(let r of e.extensions)this.removeExtensionWithKey(this.getKey(r.identifier,r.version),e.profileLocation)}async onDidRemoveExtensions(e){let r=[],i=[];for(let o of e.extensions){let s=this.getKey(o.identifier,o.version);e.error?this.addExtensionWithKey(s,e.profileLocation):(this.removeExtensionWithKey(s,e.profileLocation),this.allExtensions.has(s)||(this.logService.debug("Extension is removed from all profiles",o.identifier.id,o.version),i.push(this.extensionManagementService.scanInstalledExtensionAtLocation(o.location).then(a=>{a?r.push(a):this.logService.info("Extension not found at the location",o.location.toString())},a=>this.logService.error(a)))))}try{await Promise.all(i),r.length&&await this.uninstallExtensionsNotInProfiles(r)}catch(o){this.logService.error(o)}}onDidFilesChange(e){for(let r of this.userDataProfilesService.profiles)e.contains(r.extensionsResource,0,1)&&this.onDidExtensionsProfileChange(r.extensionsResource)}async onDidExtensionsProfileChange(e){let r=[],i=[],o=await this.extensionsProfileScannerService.scanProfileExtensions(e),s=new Set,a=new Set;for(let[l,c]of this.allExtensions)c.has(e)&&a.add(l);for(let l of o){let c=this.getKey(l.identifier,l.version);s.add(c),a.has(c)||(r.push(l.identifier),this.addExtensionWithKey(c,e))}for(let l of a)if(!s.has(l)){let c=this.fromKey(l);c&&(i.push(c.identifier),this.removeExtensionWithKey(l,e))}(r.length||i.length)&&this._onDidChangeExtensionsByAnotherSource.fire({added:r.length?{extensions:r,profileLocation:e}:void 0,removed:i.length?{extensions:i,profileLocation:e}:void 0})}async populateExtensionsFromProfile(e){let r=await this.extensionsProfileScannerService.scanProfileExtensions(e);for(let i of r)this.addExtensionWithKey(this.getKey(i.identifier,i.version),e)}async uninstallExtensionsNotInProfiles(e){e||(e=(await this.extensionManagementService.scanAllUserInstalledExtensions()).filter(i=>!this.allExtensions.has(this.getKey(i.identifier,i.manifest.version)))),e.length&&await this.extensionManagementService.markAsUninstalled(...e)}addExtensionWithKey(e,r){let i=this.allExtensions.get(e);i||this.allExtensions.set(e,i=new ai(o=>this.uriIdentityService.extUri.getComparisonKey(o))),i.add(r)}removeExtensionWithKey(e,r){let i=this.allExtensions.get(e);i&&i.delete(r),i?.size||this.allExtensions.delete(e)}getKey(e,r){return`${yn.toKey(e.id)}@${r}`}fromKey(e){let[r,i]=cs(e);return i?{identifier:{id:r},version:i}:void 0}};var Em=qi,Im=".vsctmp",ro=class extends Qi{constructor(e,r,i,o,s,a,l,c,u,f,p,h){super(e,r,p,i,f,h);this.extensionsScannerService=s;this.extensionsProfileScannerService=a;this.downloadService=l;this.instantiationService=c;this.fileService=u;let v=this._register(c.createInstance(no));this.extensionsScanner=this._register(c.createInstance(ys,I=>v.postUninstall(I))),this.manifestCache=this._register(new Wl(h,u,p,this,this.logService)),this.extensionsDownloader=this._register(c.createInstance(vr));let y=this._register(new Kl(this,this.extensionsScannerService,h,a,p,u,i));this._register(y.onDidChangeExtensionsByAnotherSource(I=>this.onDidChangeExtensionsFromAnotherSource(I))),this.watchForExtensionsNotInstalledBySystem()}extensionsScanner;manifestCache;extensionsDownloader;extractingGalleryExtensions=new Map;_targetPlatformPromise;getTargetPlatform(){return this._targetPlatformPromise||(this._targetPlatformPromise=Pl(this.fileService,this.logService)),this._targetPlatformPromise}async zip(e){this.logService.trace("ExtensionManagementService#zip",e.identifier.id);let r=await this.collectFiles(e),i=await fm(B(this.extensionsDownloader.extensionsDownloadDir,Ke()).fsPath,r);return P.file(i)}async getManifest(e){let{location:r,cleanup:i}=await this.downloadVsix(e),o=Tn(r.fsPath);try{return await Ml(o)}finally{await i()}}getInstalled(e,r=this.userDataProfilesService.defaultProfile.extensionsResource,i={version:this.productService.version,date:this.productService.date}){return this.extensionsScanner.scanExtensions(e??null,r,i)}scanAllUserInstalledExtensions(){return this.extensionsScanner.scanAllUserExtensions(!1)}scanInstalledExtensionAtLocation(e){return this.extensionsScanner.scanUserExtensionAtLocation(e)}async install(e,r={}){this.logService.trace("ExtensionManagementService#install",e.toString());let{location:i,cleanup:o}=await this.downloadVsix(e);try{let s=await Ml(Tn(i.fsPath)),a=kt(s.publisher,s.name);if(s.engines&&s.engines.vscode&&!$i(s.engines.vscode,this.productService.version,this.productService.date))throw new Error(g("incompatible","Unable to install extension '{0}' as it is not compatible with VS Code '{1}'.",a,this.productService.version));let c=(await this.installExtensions([{manifest:s,extension:i,options:r}])).find(({identifier:u})=>X(u,{id:a}));if(c?.local)return c.local;throw c?.error?c.error:De(new Error(`Unknown error while installing extension ${a}`))}finally{await o()}}async installFromLocation(e,r){this.logService.trace("ExtensionManagementService#installFromLocation",e.toString());let i=await this.extensionsScanner.scanUserExtensionAtLocation(e);if(!i||!i.manifest.name||!i.manifest.version)throw new Error(`Cannot find a valid extension from the location ${e.toString()}`);return await this.addExtensionsToProfile([[i,{source:"resource"}]],r),this.logService.info("Successfully installed extension",i.identifier.id,r.toString()),i}async installExtensionsFromProfile(e,r,i){this.logService.trace("ExtensionManagementService#installExtensionsFromProfile",e,r.toString(),i.toString());let o=(await this.getInstalled(1,r)).filter(s=>e.some(a=>X(a,s.identifier)));if(o.length){let s=await Promise.all(o.map(a=>this.extensionsScanner.scanMetadata(a,r)));await this.addExtensionsToProfile(o.map((a,l)=>[a,s[l]]),i),this.logService.info("Successfully installed extensions",o.map(a=>a.identifier.id),i.toString())}return o}async updateMetadata(e,r,i){return this.logService.trace("ExtensionManagementService#updateMetadata",e.identifier.id),r.isPreReleaseVersion&&(r.preRelease=!0,r.hasPreReleaseVersion=!0),r.isMachineScoped===!1&&(r.isMachineScoped=void 0),r.isBuiltin===!1&&(r.isBuiltin=void 0),r.pinned===!1&&(r.pinned=void 0),e=await this.extensionsScanner.updateMetadata(e,r,i),this.manifestCache.invalidate(i),this._onDidUpdateExtensionMetadata.fire({local:e,profileLocation:i}),e}async reinstallFromGallery(e){if(this.logService.trace("ExtensionManagementService#reinstallFromGallery",e.identifier.id),!this.galleryService.isEnabled())throw new Error(g("MarketPlaceDisabled","Marketplace is not enabled"));let r=await this.getTargetPlatform(),[i]=await this.galleryService.getExtensions([{...e.identifier,preRelease:e.preRelease}],{targetPlatform:r,compatible:!0},ce.None);if(!i)throw new Error(g("Not a Marketplace extension","Only Marketplace Extensions can be reinstalled"));await this.extensionsScanner.setUninstalled(e);try{await this.extensionsScanner.removeUninstalledExtension(e)}catch(o){throw new Error(g("removeError","Error while removing the extension: {0}. Please Quit and Start VS Code before trying again.",dn(o)))}return this.installFromGallery(i)}copyExtension(e,r,i,o){return this.extensionsScanner.copyExtension(e,r,i,o)}copyExtensions(e,r){return this.extensionsScanner.copyExtensions(e,r,{version:this.productService.version,date:this.productService.date})}markAsUninstalled(...e){return this.extensionsScanner.setUninstalled(...e)}async cleanUp(){this.logService.trace("ExtensionManagementService#cleanUp");try{await this.extensionsScanner.cleanUp()}catch(e){this.logService.error(e)}}async download(e,r,i){let{location:o}=await this.extensionsDownloader.download(e,r,!i);return o}async downloadVsix(e){if(e.scheme===Q.file)return{location:e,async cleanup(){}};this.logService.trace("Downloading extension from",e.toString());let r=B(this.extensionsDownloader.extensionsDownloadDir,Ke());return await this.downloadService.download(e,r),this.logService.info("Downloaded extension to",r.toString()),{location:r,cleanup:async()=>{try{await this.fileService.del(r)}catch(o){this.logService.error(o)}}}}getCurrentExtensionsManifestLocation(){return this.userDataProfilesService.defaultProfile.extensionsResource}createInstallExtensionTask(e,r,i){let o=r instanceof P?new Be({id:kt(e.publisher,e.name)},e.version):Be.create(r);return this.instantiationService.createInstance(vs,o,e,r,i,(s,a)=>{if(r instanceof P)return this.extractVSIX(o,r,i,a);let l=this.extractingGalleryExtensions.get(o.toString());return l||(this.extractingGalleryExtensions.set(o.toString(),l=this.downloadAndExtractGalleryExtension(o,r,s,i,a)),l.finally(()=>this.extractingGalleryExtensions.delete(o.toString()))),l},this.extensionsScanner)}createUninstallExtensionTask(e,r){return new Td(e,r,this.extensionsProfileScannerService)}async downloadAndExtractGalleryExtension(e,r,i,o,s){let{verificationStatus:a,location:l}=await this.extensionsDownloader.download(r,i,!o.donotVerifySignature,o.context?.[Nh]);try{if(s.isCancellationRequested)throw new me;let c=await Ml(l.fsPath);if(!new Be(r.identifier,r.version).equals(new Be({id:kt(c.publisher,c.name)},c.version)))throw new Pe(g("invalidManifest","Cannot install '{0}' extension because of manifest mismatch with Marketplace",r.identifier.id),"Invalid");return{local:await this.extensionsScanner.extractUserExtension(e,l.fsPath,{id:r.identifier.uuid,publisherId:r.publisherId,publisherDisplayName:r.publisherDisplayName,targetPlatform:r.properties.targetPlatform,isApplicationScoped:o.isApplicationScoped,isMachineScoped:o.isMachineScoped,isBuiltin:o.isBuiltin,isPreReleaseVersion:r.properties.isPreReleaseVersion,hasPreReleaseVersion:r.properties.isPreReleaseVersion,installedTimestamp:Date.now(),pinned:o.installGivenVersion?!0:!!o.pinned,preRelease:Kt(o.preRelease)?o.preRelease:o.installPreReleaseVersion||r.properties.isPreReleaseVersion,source:"gallery"},!1,s),verificationStatus:a}}catch(c){try{await this.extensionsDownloader.delete(l)}catch(u){this.logService.warn("Error while deleting the downloaded file",l.toString(),G(u))}throw De(c)}}async extractVSIX(e,r,i,o){return{local:await this.extensionsScanner.extractUserExtension(e,Tn(r.fsPath),{isApplicationScoped:i.isApplicationScoped,isMachineScoped:i.isMachineScoped,isBuiltin:i.isBuiltin,installedTimestamp:Date.now(),pinned:i.installGivenVersion?!0:!!i.pinned,source:"vsix"},i.keepExisting??!0,o)}}async collectFiles(e){let r=async o=>{let s=await se.readdir(o);s=s.map(c=>V(o,c));let a=await Promise.all(s.map(c=>xm.promises.stat(c))),l=Promise.resolve([]);return a.forEach((c,u)=>{let f=s[u];c.isFile()&&(l=l.then(p=>[...p,f])),c.isDirectory()&&(l=l.then(p=>r(f).then(h=>[...p,...h])))}),l};return(await r(e.location.fsPath)).map(o=>({path:`extension/${ra(e.location.fsPath,o)}`,localPath:o}))}async onDidChangeExtensionsFromAnotherSource({added:e,removed:r}){if(r){let i=e&&this.uriIdentityService.extUri.isEqual(r.profileLocation,e.profileLocation)?r.extensions.filter(o=>e.extensions.every(s=>!X(s,o))):r.extensions;for(let o of i)this.logService.info("Extensions removed from another source",o.id,r.profileLocation.toString()),this._onDidUninstallExtension.fire({identifier:o,profileLocation:r.profileLocation})}if(e){let o=(await this.getInstalled(1,e.profileLocation)).filter(s=>e.extensions.some(a=>X(a,s.identifier)));this._onDidInstallExtensions.fire(o.map(s=>(this.logService.info("Extensions added from another source",s.identifier.id,e.profileLocation.toString()),{identifier:s.identifier,local:s,profileLocation:e.profileLocation,operation:1})))}}knownDirectories=new ai;async watchForExtensionsNotInstalledBySystem(){this._register(this.extensionsScanner.onExtract(r=>this.knownDirectories.add(r)));let e=await this.fileService.resolve(this.extensionsScannerService.userExtensionsLocation);for(let r of e.children??[])r.isDirectory&&this.knownDirectories.add(r.resource);this._register(this.fileService.watch(this.extensionsScannerService.userExtensionsLocation)),this._register(this.fileService.onDidFilesChange(r=>this.onDidFilesChange(r)))}async onDidFilesChange(e){if(!e.affects(this.extensionsScannerService.userExtensionsLocation,1))return;let r=[];for(let i of e.rawAdded){if(this.knownDirectories.has(i)||!this.uriIdentityService.extUri.isEqual(this.uriIdentityService.extUri.dirname(i),this.extensionsScannerService.userExtensionsLocation)||this.uriIdentityService.extUri.isEqual(i,this.uriIdentityService.extUri.joinPath(this.extensionsScannerService.userExtensionsLocation,".obsolete"))||this.uriIdentityService.extUri.basename(i).startsWith(".")||!(await this.fileService.stat(i)).isDirectory)continue;let o=await this.extensionsScanner.scanUserExtensionAtLocation(i);o&&o.installedTimestamp===void 0&&(this.knownDirectories.add(i),r.push(o))}r.length&&(await this.addExtensionsToProfile(r.map(i=>[i,void 0]),this.userDataProfilesService.defaultProfile.extensionsResource),this.logService.info("Added extensions to default profile from external source",r.map(i=>i.identifier.id)))}async addExtensionsToProfile(e,r){let i=e.map(o=>o[0]);await this.setInstalled(i),await this.extensionsProfileScannerService.addExtensionsToProfile(e,r),this._onDidInstallExtensions.fire(i.map(o=>({local:o,identifier:o.identifier,operation:1,profileLocation:r})))}async setInstalled(e){let r=await this.extensionsScanner.getUninstalledExtensions();for(let i of e){let o=Be.create(i);r[o.toString()]&&(this.logService.trace("Removing the extension from uninstalled list:",o.id),await this.extensionsScanner.setInstalled(o),this.logService.info("Removed the extension from uninstalled list:",o.id))}}};ro=D([b(0,St),b(1,He),b(2,J),b(3,dt),b(4,eo),b(5,rn),b(6,Ul),b(7,cr),b(8,pe),b(9,vt),b(10,_e),b(11,rt)],ro);var ys=class extends U{constructor(e,r,i,o,s,a,l){super();this.beforeRemovingExtension=e;this.fileService=r;this.extensionsScannerService=i;this.extensionsProfileScannerService=o;this.uriIdentityService=s;this.telemetryService=a;this.logService=l;this.uninstalledResource=B(this.extensionsScannerService.userExtensionsLocation,".obsolete"),this.uninstalledFileLimiter=new pn}uninstalledResource;uninstalledFileLimiter;_onExtract=this._register(new C);onExtract=this._onExtract.event;scanAllExtensionPromise=new ve;scanUserExtensionsPromise=new ve;async cleanUp(){await this.removeTemporarilyDeletedFolders(),await this.removeUninstalledExtensions()}async scanExtensions(e,r,i){try{let o={includeInvalid:!0,profileLocation:r,productVersion:i},s=[];if(e===null||e===0){let a=this.scanAllExtensionPromise.get(r);a||(a=this.extensionsScannerService.scanAllExtensions({includeInvalid:!0,useCache:!0},o,!1).finally(()=>this.scanAllExtensionPromise.delete(r)),this.scanAllExtensionPromise.set(r,a)),s.push(...await a)}else if(e===1){let a=this.scanUserExtensionsPromise.get(r);a||(a=this.extensionsScannerService.scanUserExtensions(o).finally(()=>this.scanUserExtensionsPromise.delete(r)),this.scanUserExtensionsPromise.set(r,a)),s.push(...await a)}return s=e!==null?s.filter(a=>a.type===e):s,await Promise.all(s.map(a=>this.toLocalExtension(a)))}catch(o){throw De(o,"Scanning")}}async scanAllUserExtensions(e){try{let r=await this.extensionsScannerService.scanUserExtensions({includeAllVersions:!e,includeInvalid:!0});return await Promise.all(r.map(i=>this.toLocalExtension(i)))}catch(r){throw De(r,"Scanning")}}async scanUserExtensionAtLocation(e){try{let r=await this.extensionsScannerService.scanExistingExtension(e,1,{includeInvalid:!0});if(r)return await this.toLocalExtension(r)}catch(r){this.logService.error(r)}return null}async extractUserExtension(e,r,i,o,s){let a=e.toString(),l=P.file(V(this.extensionsScannerService.userExtensionsLocation.fsPath,`.${Ke()}`)),c=P.file(V(this.extensionsScannerService.userExtensionsLocation.fsPath,a));if(await this.fileService.exists(c)){if(!o)try{return await this.scanLocalExtension(c,1)}catch(u){this.logService.warn(`Error while scanning the existing extension at ${c.path}. Deleting the existing extension and extracting it.`,G(u))}try{await this.deleteExtensionFromLocation(e.id,c,"removeExisting")}catch{throw new Pe(g("errorDeleting","Unable to delete the existing folder '{0}' while installing the extension '{1}'. Please delete the folder manually and try again",c.fsPath,e.id),"Delete")}}try{if(s.isCancellationRequested)throw new me;try{this.logService.trace(`Started extracting the extension from ${r} to ${c.fsPath}`),await pm(r,l.fsPath,{sourcePath:"extension",overwrite:!0},s),this.logService.info(`Extracted extension to ${c}:`,e.id)}catch(u){throw ms(u)}try{await this.extensionsScannerService.updateMetadata(l,i)}catch(u){throw this.telemetryService.publicLog2("extension:extract",{extensionId:e.id,code:`${Ue(u)}`}),De(u,"UpdateMetadata")}if(s.isCancellationRequested)throw new me;try{this.logService.trace(`Started renaming the extension from ${l.fsPath} to ${c.fsPath}`),await this.rename(l.fsPath,c.fsPath),this.logService.info("Renamed to",c.fsPath)}catch(u){if(u.code==="ENOTEMPTY"){this.logService.info("Rename failed because extension was installed by another source. So ignoring renaming.",e.id);try{await this.fileService.del(l,{recursive:!0})}catch{}}else throw this.logService.info(`Rename failed because of ${G(u)}. Deleted from extracted location`,l),u}this._onExtract.fire(c)}catch(u){try{await this.fileService.del(l,{recursive:!0})}catch{}throw u}return this.scanLocalExtension(c,1)}async scanMetadata(e,r){return r?(await this.getScannedExtension(e,r))?.metadata:this.extensionsScannerService.scanMetadata(e.location)}async getScannedExtension(e,r){return(await this.extensionsProfileScannerService.scanProfileExtensions(r)).find(o=>X(o.identifier,e.identifier))}async updateMetadata(e,r,i){try{i?await this.extensionsProfileScannerService.updateMetadata([[e,r]],i):await this.extensionsScannerService.updateMetadata(e.location,r)}catch(o){throw this.telemetryService.publicLog2("extension:extract",{extensionId:e.identifier.id,code:`${Ue(o)}`,isProfile:!!i}),De(o,"UpdateMetadata")}return this.scanLocalExtension(e.location,e.type,i)}async getUninstalledExtensions(){try{return await this.withUninstalledExtensions()}catch(e){throw De(e,"ReadUninstalled")}}async setUninstalled(...e){let r=e.map(i=>Be.create(i));await this.withUninstalledExtensions(i=>r.forEach(o=>{i[o.toString()]=!0,this.logService.info("Marked extension as uninstalled",o.toString())}))}async setInstalled(e){try{await this.withUninstalledExtensions(r=>delete r[e.toString()])}catch(r){throw De(r,"UnsetUninstalled")}}async removeExtension(e,r){if(this.uriIdentityService.extUri.isEqualOrParent(e.location,this.extensionsScannerService.userExtensionsLocation))return this.deleteExtensionFromLocation(e.identifier.id,e.location,r)}async removeUninstalledExtension(e){await this.removeExtension(e,"uninstalled"),await this.withUninstalledExtensions(r=>delete r[Be.create(e).toString()])}async copyExtension(e,r,i,o){let s=await this.getScannedExtension(e,r),a=await this.getScannedExtension(e,i);if(o={...s?.metadata,...o},a)if(this.uriIdentityService.extUri.isEqual(a.location,e.location))await this.extensionsProfileScannerService.updateMetadata([[e,{...a.metadata,...o}]],i);else{let l=await this.scanLocalExtension(a.location,e.type,i);await this.extensionsProfileScannerService.removeExtensionFromProfile(l,i),await this.extensionsProfileScannerService.addExtensionsToProfile([[e,{...a.metadata,...o}]],i)}else await this.extensionsProfileScannerService.addExtensionsToProfile([[e,o]],i);return this.scanLocalExtension(e.location,e.type,i)}async copyExtensions(e,r,i){let o=await this.scanExtensions(1,e,i),s=await Promise.all(o.filter(a=>!a.isApplicationScoped).map(async a=>[a,await this.scanMetadata(a,e)]));await this.extensionsProfileScannerService.addExtensionsToProfile(s,r)}async deleteExtensionFromLocation(e,r,i){this.logService.trace(`Deleting ${i} extension from disk`,e,r.fsPath);let o=this.uriIdentityService.extUri.joinPath(this.uriIdentityService.extUri.dirname(r),`${this.uriIdentityService.extUri.basename(r)}.${Pn(Ke()).toString(16)}${Im}`);await this.rename(r.fsPath,o.fsPath),await this.fileService.del(o,{recursive:!0}),this.logService.info(`Deleted ${i} extension from disk`,e,r.fsPath)}withUninstalledExtensions(e){return this.uninstalledFileLimiter.queue(async()=>{let r;try{r=(await this.fileService.readFile(this.uninstalledResource,"utf8")).value.toString()}catch(o){if(Ue(o)!==1)throw o}let i={};if(r)try{i=JSON.parse(r)}catch{}return e&&(e(i),Object.keys(i).length?await this.fileService.writeFile(this.uninstalledResource,W.fromString(JSON.stringify(i))):await this.fileService.del(this.uninstalledResource)),i})}async rename(e,r){try{await se.rename(e,r,2*60*1e3)}catch(i){throw De(i,"Rename")}}async scanLocalExtension(e,r,i){try{if(i){let s=(await this.extensionsScannerService.scanUserExtensions({profileLocation:i})).find(a=>this.uriIdentityService.extUri.isEqual(a.location,e));if(s)return await this.toLocalExtension(s)}else{let o=await this.extensionsScannerService.scanExistingExtension(e,r,{includeInvalid:!0});if(o)return await this.toLocalExtension(o)}throw new Pe(g("cannot read","Cannot read the extension from {0}",e.path),"ScanningExtension")}catch(o){throw De(o,"ScanningExtension")}}async toLocalExtension(e){let r=await this.fileService.resolve(e.location),i,o;return r.children&&(i=r.children.find(({name:s})=>/^readme(\.txt|\.md|)$/i.test(s))?.resource,o=r.children.find(({name:s})=>/^changelog(\.txt|\.md|)$/i.test(s))?.resource),{identifier:e.identifier,type:e.type,isBuiltin:e.isBuiltin||!!e.metadata?.isBuiltin,location:e.location,manifest:e.manifest,targetPlatform:e.targetPlatform,validations:e.validations,isValid:e.isValid,readmeUrl:i,changelogUrl:o,publisherDisplayName:e.metadata?.publisherDisplayName,publisherId:e.metadata?.publisherId||null,isApplicationScoped:!!e.metadata?.isApplicationScoped,isMachineScoped:!!e.metadata?.isMachineScoped,isPreReleaseVersion:!!e.metadata?.isPreReleaseVersion,hasPreReleaseVersion:!!e.metadata?.hasPreReleaseVersion,preRelease:!!e.metadata?.preRelease,installedTimestamp:e.metadata?.installedTimestamp,updated:!!e.metadata?.updated,pinned:!!e.metadata?.pinned,isWorkspaceScoped:!1,source:e.metadata?.source??(e.identifier.uuid?"gallery":"vsix")}}async removeUninstalledExtensions(){let e=await this.getUninstalledExtensions();if(Object.keys(e).length===0){this.logService.debug("No uninstalled extensions found.");return}this.logService.debug("Removing uninstalled extensions:",Object.keys(e));let r=await this.extensionsScannerService.scanUserExtensions({includeAllVersions:!0,includeUninstalled:!0,includeInvalid:!0}),i=new Set;for(let s of r)e[Be.create(s).toString()]||i.add(s.identifier.id.toLowerCase());try{let s=Tl(r,a=>a.identifier);await ze.settled(s.map(async a=>{let l=a.sort((c,u)=>Rl(c.manifest.version,u.manifest.version))[0];i.has(l.identifier.id.toLowerCase())||await this.beforeRemovingExtension(await this.toLocalExtension(l))}))}catch(s){this.logService.error(s)}let o=r.filter(s=>s.metadata&&e[Be.create(s).toString()]);await Promise.allSettled(o.map(s=>this.removeUninstalledExtension(s)))}async removeTemporarilyDeletedFolders(){this.logService.trace("ExtensionManagementService#removeTempDeleteFolders");let e;try{e=await this.fileService.resolve(this.extensionsScannerService.userExtensionsLocation)}catch(r){Ue(r)!==1&&this.logService.error(r);return}if(e?.children)try{await Promise.allSettled(e.children.map(async r=>{if(!(!r.isDirectory||!r.name.endsWith(Im))){this.logService.trace("Deleting the temporarily deleted folder",r.resource.toString());try{await this.fileService.del(r.resource,{recursive:!0}),this.logService.trace("Deleted the temporarily deleted folder",r.resource.toString())}catch(i){Ue(i)!==1&&this.logService.error(i)}}}))}catch{}}};ys=D([b(1,pe),b(2,eo),b(3,rn),b(4,_e),b(5,He),b(6,J)],ys);var vs=class extends hs{constructor(e,r,i,o,s,a,l,c,u,f,p,h){super();this.extensionKey=e;this.manifest=r;this.source=i;this.options=o;this.extractExtensionFn=s;this.extensionsScanner=a;this.uriIdentityService=l;this.galleryService=c;this.userDataProfilesService=u;this.extensionsScannerService=f;this.extensionsProfileScannerService=p;this.logService=h;this.identifier=this.extensionKey.identifier}_operation=2;get operation(){return this.options.operation??this._operation}_verificationStatus;get verificationStatus(){return this._verificationStatus}identifier;async doRun(e){let i=(await this.extensionsScanner.scanExtensions(1,this.options.profileLocation,this.options.productVersion)).find(l=>X(l.identifier,this.identifier));i&&(this._operation=3);let o={isApplicationScoped:this.options.isApplicationScoped||i?.isApplicationScoped,isMachineScoped:this.options.isMachineScoped||i?.isMachineScoped,isBuiltin:this.options.isBuiltin||i?.isBuiltin,isSystem:i?.type===0?!0:void 0,installedTimestamp:Date.now(),pinned:this.options.installGivenVersion?!0:this.options.pinned??i?.pinned,source:this.source instanceof P?"vsix":"gallery"},s;if(this.source instanceof P){if(i&&this.extensionKey.equals(new Be(i.identifier,i.manifest.version)))try{await this.extensionsScanner.removeExtension(i,"existing")}catch{throw new Error(g("restartCode","Please restart VS Code before reinstalling {0}.",this.manifest.displayName||this.manifest.name))}let l=await this.unsetIfUninstalled(this.extensionKey);if(l)try{await this.extensionsScanner.removeExtension(l,"existing")}catch{throw new Error(g("restartCode","Please restart VS Code before reinstalling {0}.",this.manifest.displayName||this.manifest.name))}}else{if(o.id=this.source.identifier.uuid,o.publisherId=this.source.publisherId,o.publisherDisplayName=this.source.publisherDisplayName,o.targetPlatform=this.source.properties.targetPlatform,o.updated=!!i,o.isPreReleaseVersion=this.source.properties.isPreReleaseVersion,o.hasPreReleaseVersion=i?.hasPreReleaseVersion||this.source.properties.isPreReleaseVersion,o.preRelease=Kt(this.options.preRelease)?this.options.preRelease:this.options.installPreReleaseVersion||this.source.properties.isPreReleaseVersion||i?.preRelease,i&&i.type!==0&&i.manifest.version===this.source.version)return this.extensionsScanner.updateMetadata(i,o,this.options.profileLocation);s=await this.unsetIfUninstalled(this.extensionKey)}if(e.isCancellationRequested)throw De(new me);if(!s){let l=await this.extractExtensionFn(this.operation,e);s=l.local,this._verificationStatus=l.verificationStatus}if(this.uriIdentityService.extUri.isEqual(this.userDataProfilesService.defaultProfile.extensionsResource,this.options.profileLocation))try{await this.extensionsScannerService.initializeDefaultProfileExtensions()}catch(l){throw De(l,"IntializeDefaultProfile")}if(e.isCancellationRequested)throw De(new me);try{await this.extensionsProfileScannerService.addExtensionsToProfile([[s,o]],this.options.profileLocation,!s.isValid)}catch(l){throw De(l,"AddToProfile")}let a=await this.extensionsScanner.scanLocalExtension(s.location,1,this.options.profileLocation);if(!a)throw new Pe("Cannot find the installed extension","InstalledExtensionNotFound");return this.source instanceof P&&this.updateMetadata(s,e),a}async unsetIfUninstalled(e){return(await this.extensionsScanner.getUninstalledExtensions())[e.toString()]?(this.logService.trace("Removing the extension from uninstalled list:",e.id),await this.extensionsScanner.setInstalled(e),this.logService.info("Removed the extension from uninstalled list:",e.id),(await this.extensionsScanner.scanAllUserExtensions(!0)).find(o=>Be.create(o).equals(e))):void 0}async updateMetadata(e,r){try{let[i]=await this.galleryService.getExtensions([{id:e.identifier.id,version:e.manifest.version}],r);if(i||([i]=await this.galleryService.getExtensions([{id:e.identifier.id}],r)),i){let o={id:i.identifier.uuid,publisherDisplayName:i.publisherDisplayName,publisherId:i.publisherId,isPreReleaseVersion:i.properties.isPreReleaseVersion,hasPreReleaseVersion:e.hasPreReleaseVersion||i.properties.isPreReleaseVersion,preRelease:i.properties.isPreReleaseVersion||this.options.installPreReleaseVersion};await this.extensionsScanner.updateMetadata(e,o,this.options.profileLocation)}}catch{}}};vs=D([b(6,_e),b(7,St),b(8,rt),b(9,eo),b(10,rn),b(11,J)],vs);var Td=class extends hs{constructor(e,r,i){super();this.extension=e;this.options=r;this.extensionsProfileScannerService=i}async doRun(e){await this.extensionsProfileScannerService.removeExtensionFromProfile(this.extension,this.options.profileLocation)}};var Pd=class{constructor(t,e){this.key=t;this.data=e}incoming=new Map;outgoing=new Map},bs=class{constructor(t){this._hashFn=t}_nodes=new Map;roots(){let t=[];for(let e of this._nodes.values())e.outgoing.size===0&&t.push(e);return t}insertEdge(t,e){let r=this.lookupOrInsertNode(t),i=this.lookupOrInsertNode(e);r.outgoing.set(i.key,i),i.incoming.set(r.key,r)}removeNode(t){let e=this._hashFn(t);this._nodes.delete(e);for(let r of this._nodes.values())r.outgoing.delete(e),r.incoming.delete(e)}lookupOrInsertNode(t){let e=this._hashFn(t),r=this._nodes.get(e);return r||(r=new Pd(e,t),this._nodes.set(e,r)),r}lookup(t){return this._nodes.get(this._hashFn(t))}isEmpty(){return this._nodes.size===0}toString(){let t=[];for(let[e,r]of this._nodes)t.push(`${e}
	(-> incoming)[${[...r.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...r.outgoing.keys()].join(",")}]
`);return t.join(`
`)}findCycleSlow(){for(let[t,e]of this._nodes){let r=new Set([t]),i=this._findCycle(e,r);if(i)return i}}_findCycle(t,e){for(let[r,i]of t.outgoing){if(e.has(r))return[...e,r].join(" -> ");e.add(r);let o=this._findCycle(i,e);if(o)return o;e.delete(r)}}};var sx=!1,ql=class extends Error{constructor(t){super("cyclic dependency between services"),this.message=t.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${t.toString()}`}},$l=class n{constructor(t=new ci,e=!1,r,i=sx){this._services=t;this._strict=e;this._parent=r;this._enableTracing=i;this._services.set(cr,this),this._globalGraph=i?r?._globalGraph??new bs(o=>o):void 0}_globalGraph;_globalGraphImplicitDependency;_isDisposed=!1;_servicesToMaybeDispose=new Set;_children=new Set;dispose(){if(!this._isDisposed){this._isDisposed=!0,ct(this._children),this._children.clear();for(let t of this._servicesToMaybeDispose)Vf(t)&&t.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(t,e){this._throwIfDisposed();let r=this,i=new class extends n{dispose(){r._children.delete(i),super.dispose()}}(t,this._strict,this,this._enableTracing);return this._children.add(i),e?.add(i),i}invokeFunction(t,...e){this._throwIfDisposed();let r=Is.traceInvocation(this._enableTracing,t),i=!1;try{return t({get:s=>{if(i)throw Ns("service accessor is only valid during the invocation of its target method");let a=this._getOrCreateServiceInstance(s,r);if(!a)throw new Error(`[invokeFunction] unknown service '${s}'`);return a}},...e)}finally{i=!0,r.stop()}}createInstance(t,...e){this._throwIfDisposed();let r,i;return t instanceof We?(r=Is.traceCreation(this._enableTracing,t.ctor),i=this._createInstance(t.ctor,t.staticArguments.concat(e),r)):(r=Is.traceCreation(this._enableTracing,t),i=this._createInstance(t,e,r)),r.stop(),i}_createInstance(t,e=[],r){let i=un.getServiceDependencies(t).sort((a,l)=>a.index-l.index),o=[];for(let a of i){let l=this._getOrCreateServiceInstance(a.id,r);l||this._throwIfStrict(`[createInstance] ${t.name} depends on UNKNOWN service ${a.id}.`,!1),o.push(l)}let s=i.length>0?i[0].index:e.length;if(e.length!==s){console.trace(`[createInstance] First service dependency of ${t.name} at position ${s+1} conflicts with ${e.length} static arguments`);let a=s-e.length;a>0?e=e.concat(new Array(a)):e=e.slice(0,s)}return Reflect.construct(t,e.concat(o))}_setCreatedServiceInstance(t,e){if(this._services.get(t)instanceof We)this._services.set(t,e);else if(this._parent)this._parent._setCreatedServiceInstance(t,e);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(t){let e=this._services.get(t);return!e&&this._parent?this._parent._getServiceInstanceOrDescriptor(t):e}_getOrCreateServiceInstance(t,e){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(t));let r=this._getServiceInstanceOrDescriptor(t);return r instanceof We?this._safeCreateAndCacheServiceInstance(t,r,e.branch(t,!0)):(e.branch(t,!1),r)}_activeInstantiations=new Set;_safeCreateAndCacheServiceInstance(t,e,r){if(this._activeInstantiations.has(t))throw new Error(`illegal state - RECURSIVELY instantiating service '${t}'`);this._activeInstantiations.add(t);try{return this._createAndCacheServiceInstance(t,e,r)}finally{this._activeInstantiations.delete(t)}}_createAndCacheServiceInstance(t,e,r){let i=new bs(l=>l.id.toString()),o=0,s=[{id:t,desc:e,_trace:r}],a=new Set;for(;s.length;){let l=s.pop();if(!a.has(String(l.id))){if(a.add(String(l.id)),i.lookupOrInsertNode(l),o++>1e3)throw new ql(i);for(let c of un.getServiceDependencies(l.desc.ctor)){let u=this._getServiceInstanceOrDescriptor(c.id);if(u||this._throwIfStrict(`[createInstance] ${t} depends on ${c.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(c.id)),u instanceof We){let f={id:c.id,desc:u,_trace:l._trace.branch(c.id,!0)};i.insertEdge(l,f),s.push(f)}}}}for(;;){let l=i.roots();if(l.length===0){if(!i.isEmpty())throw new ql(i);break}for(let{data:c}of l){if(this._getServiceInstanceOrDescriptor(c.id)instanceof We){let f=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setCreatedServiceInstance(c.id,f)}i.removeNode(c)}}return this._getServiceInstanceOrDescriptor(t)}_createServiceInstanceWithOwner(t,e,r=[],i,o){if(this._services.get(t)instanceof We)return this._createServiceInstance(t,e,r,i,o,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(t,e,r,i,o);throw new Error(`illegalState - creating UNKNOWN service instance ${e.name}`)}_createServiceInstance(t,e,r=[],i,o,s){if(i){let a=new n(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(t);let l=new Map,c=new Sa(()=>{let u=a._createInstance(e,r,o);for(let[f,p]of l){let h=u[f];if(typeof h=="function")for(let v of p)v.disposable=h.apply(u,v.listener)}return l.clear(),s.add(u),u});return new Proxy(Object.create(null),{get(u,f){if(!c.isInitialized&&typeof f=="string"&&(f.startsWith("onDid")||f.startsWith("onWill"))){let v=l.get(f);return v||(v=new Zn,l.set(f,v)),(I,S,T)=>{if(c.isInitialized)return c.value[f](I,S,T);{let k={listener:[I,S,T],disposable:void 0},E=v.push(k);return te(()=>{E(),k.disposable?.dispose()})}}}if(f in u)return u[f];let p=c.value,h=p[f];return typeof h!="function"||(h=h.bind(p),u[f]=h),h},set(u,f,p){return c.value[f]=p,!0},getPrototypeOf(u){return e.prototype}})}else{let a=this._createInstance(e,r,o);return s.add(a),a}}_throwIfStrict(t,e){if(e&&console.warn(t),this._strict)throw new Error(t)}};var Is=class n{constructor(t,e){this.type=t;this.name=e}static all=new Set;static _None=new class extends n{constructor(){super(0,null)}stop(){}branch(){return this}};static traceInvocation(t,e){return t?new n(2,e.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):n._None}static traceCreation(t,e){return t?new n(1,e.name):n._None}static _totals=0;_start=Date.now();_dep=[];branch(t,e){let r=new n(3,t.toString());return this._dep.push([t,e,r]),r}stop(){let t=Date.now()-this._start;n._totals+=t;let e=!1;function r(o,s){let a=[],l=new Array(o+1).join("	");for(let[c,u,f]of s._dep)if(u&&f){e=!0,a.push(`${l}CREATES -> ${c}`);let p=r(o+1,f);p&&a.push(p)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}let i=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${r(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${n._totals.toFixed(2)}ms)`];(t>2||e)&&n.all.add(i.join(`
`))}};var Ot,_d=globalThis.vscode;if(typeof _d<"u"&&typeof _d.context<"u"){let n=_d.context.configuration();if(n)Ot=n.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(Ot=globalThis._VSCODE_PRODUCT_JSON,It.VSCODE_DEV&&Object.assign(Ot,{nameShort:`${Ot.nameShort} Dev`,nameLong:`${Ot.nameLong} Dev`,dataFolderName:`${Ot.dataFolderName}-dev`,serverDataFolderName:Ot.serverDataFolderName?`${Ot.serverDataFolderName}-dev`:void 0}),!Ot.version){let n=globalThis._VSCODE_PACKAGE_JSON;Object.assign(Ot,{version:n.version})}}else Ot={},Object.keys(Ot).length===0&&Object.assign(Ot,{version:"1.94.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var On=Ot;async function zl(n,t,e,r,i,o){let s;try{await ax(n,t,e,r,i,o)}catch(a){s=a}finally{s&&i.errorTransformer&&(s=i.errorTransformer(s)),typeof s<"u"&&e.error(s),e.end()}}async function ax(n,t,e,r,i,o){Rd(o);let s=await n.open(t,{create:!1});try{Rd(o);let a=0,l=0,c=i&&typeof i.length=="number"?i.length:void 0,u=W.alloc(Math.min(i.bufferSize,typeof c=="number"?c:i.bufferSize)),f=i&&typeof i.position=="number"?i.position:0,p=0;do l=await n.read(s,f,u.buffer,p,u.byteLength-p),f+=l,p+=l,a+=l,typeof c=="number"&&(c-=l),p===u.byteLength&&(await e.write(r(u)),u=W.alloc(Math.min(i.bufferSize,typeof c=="number"?c:i.bufferSize)),p=0);while(l>0&&(typeof c!="number"||c>0)&&Rd(o)&&lx(a,i));if(p>0){let h=p;typeof c=="number"&&(h=Math.min(p,c)),e.write(r(u.slice(0,h)))}}catch(a){throw Gn(a)}finally{await n.close(s)}}function Rd(n){if(n.isCancellationRequested)throw Us();return!0}function lx(n,t){if(typeof t?.limits?.size=="number"&&n>t.limits.size)throw hn(g("fileTooLargeError","File is too large to open"),"EntryTooLarge");return!0}var br=class extends U{constructor(e){super();this.logService=e}BUFFER_SIZE=256*1024;_onDidChangeFileSystemProviderRegistrations=this._register(new C);onDidChangeFileSystemProviderRegistrations=this._onDidChangeFileSystemProviderRegistrations.event;_onWillActivateFileSystemProvider=this._register(new C);onWillActivateFileSystemProvider=this._onWillActivateFileSystemProvider.event;_onDidChangeFileSystemProviderCapabilities=this._register(new C);onDidChangeFileSystemProviderCapabilities=this._onDidChangeFileSystemProviderCapabilities.event;provider=new Map;registerProvider(e,r){if(this.provider.has(e))throw new Error(`A filesystem provider for the scheme '${e}' is already registered.`);zi(`code/registerFilesystem/${e}`);let i=new Ee;return this.provider.set(e,r),this._onDidChangeFileSystemProviderRegistrations.fire({added:!0,scheme:e,provider:r}),i.add(r.onDidChangeFile(o=>{let s=new Ha(o,!this.isPathCaseSensitive(r));this.internalOnDidFilesChange.fire(s),s.hasCorrelation()||this._onDidUncorrelatedFilesChange.fire(s)})),typeof r.onDidWatchError=="function"&&i.add(r.onDidWatchError(o=>this._onDidWatchError.fire(new Error(o)))),i.add(r.onDidChangeCapabilities(()=>this._onDidChangeFileSystemProviderCapabilities.fire({provider:r,scheme:e}))),te(()=>{this._onDidChangeFileSystemProviderRegistrations.fire({added:!1,scheme:e,provider:r}),this.provider.delete(e),ct(i)})}getProvider(e){return this.provider.get(e)}async activateProvider(e){let r=[];this._onWillActivateFileSystemProvider.fire({scheme:e,join(i){r.push(i)}}),!this.provider.has(e)&&await ze.settled(r)}async canHandleResource(e){return await this.activateProvider(e.scheme),this.hasProvider(e)}hasProvider(e){return this.provider.has(e.scheme)}hasCapability(e,r){let i=this.provider.get(e.scheme);return!!(i&&i.capabilities&r)}listCapabilities(){return ar.map(this.provider,([e,r])=>({scheme:e,capabilities:r.capabilities}))}async withProvider(e){if(!fp(e))throw new tt(g("invalidPath","Unable to resolve filesystem provider with relative file path '{0}'",this.resourceForError(e)),8);await this.activateProvider(e.scheme);let r=this.provider.get(e.scheme);if(!r){let i=new In;throw i.message=g("noProviderFound","ENOPRO: No file system provider found for resource '{0}'",e.toString()),i}return r}async withReadProvider(e){let r=await this.withProvider(e);if(jn(r)||$t(r)||Ja(r))return r;throw new Error(`Filesystem provider for scheme '${e.scheme}' neither has FileReadWrite, FileReadStream nor FileOpenReadWriteClose capability which is needed for the read operation.`)}async withWriteProvider(e){let r=await this.withProvider(e);if(jn(r)||$t(r))return r;throw new Error(`Filesystem provider for scheme '${e.scheme}' neither has FileReadWrite nor FileOpenReadWriteClose capability which is needed for the write operation.`)}_onDidRunOperation=this._register(new C);onDidRunOperation=this._onDidRunOperation.event;async resolve(e,r){try{return await this.doResolveFile(e,r)}catch(i){throw ts(i)==="EntryNotFound"?new tt(g("fileNotFoundError","Unable to resolve nonexistent file '{0}'",this.resourceForError(e)),1):Gn(i)}}async doResolveFile(e,r){let i=await this.withProvider(e),o=this.isPathCaseSensitive(i),s=r?.resolveTo,a=r?.resolveSingleChildDescendants,l=r?.resolveMetadata,c=await i.stat(e),u;return this.toFileStat(i,e,c,void 0,!!l,(f,p)=>(u||(u=$n.forUris(()=>!o),u.set(e,!0),s&&u.fill(!0,s)),u.get(f.resource)||u.findSuperstr(f.resource.with({query:null,fragment:null}))?!0:f.isDirectory&&a?p===1:!1))}async toFileStat(e,r,i,o,s,a){let{providerExtUri:l}=this.getExtUri(e),c={resource:r,name:l.basename(r),isFile:(i.type&1)!==0,isDirectory:(i.type&2)!==0,isSymbolicLink:(i.type&64)!==0,mtime:i.mtime,ctime:i.ctime,size:i.size,readonly:!!((i.permissions??0)&1)||!!(e.capabilities&2048),locked:!!((i.permissions??0)&2),etag:Ku({mtime:i.mtime,size:i.size}),children:void 0};if(c.isDirectory&&a(c,o)){try{let u=await e.readdir(r),f=await ze.settled(u.map(async([p,h])=>{try{let v=l.joinPath(r,p),y=s?await e.stat(v):{type:h};return await this.toFileStat(e,v,y,u.length,s,a)}catch(v){return this.logService.trace(v),null}}));c.children=Jt(f)}catch(u){this.logService.trace(u),c.children=[]}return c}return c}async resolveAll(e){return ze.settled(e.map(async r=>{try{return{stat:await this.doResolveFile(r.resource,r.options),success:!0}}catch(i){return this.logService.trace(i),{stat:void 0,success:!1}}}))}async stat(e){let r=await this.withProvider(e),i=await r.stat(e);return this.toFileStat(r,e,i,void 0,!0,()=>!1)}async exists(e){let r=await this.withProvider(e);try{return!!await r.stat(e)}catch{return!1}}async canCreateFile(e,r){try{await this.doValidateCreateFile(e,r)}catch(i){return i}return!0}async doValidateCreateFile(e,r){if(!r?.overwrite&&await this.exists(e))throw new tt(g("fileExists","Unable to create file '{0}' that already exists when overwrite flag is not set",this.resourceForError(e)),3,r)}async createFile(e,r=W.fromString(""),i){await this.doValidateCreateFile(e,i);let o=await this.writeFile(e,r);return this._onDidRunOperation.fire(new zn(e,0,o)),o}async writeFile(e,r,i){let o=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e),{providerExtUri:s}=this.getExtUri(o),a=i;if(Wu(o)&&!a?.atomic){let l=o.enforceAtomicWriteFile?.(e);l&&(a={...i,atomic:l})}try{await this.validateWriteFile(o,e,a)||await this.mkdirp(o,s.dirname(e));let c;if($t(o)&&!(r instanceof W))if(Jo(r)){let u=await kp(r,3);u.ended?c=W.concat(u.buffer):c=u}else c=Dp(r,u=>W.concat(u),3);else c=r;!jn(o)||$t(o)&&c instanceof W||$t(o)&&Wu(o)&&a?.atomic?await this.doWriteUnbuffered(o,e,a,c):await this.doWriteBuffered(o,e,a,c instanceof W?Fp(c):c),this._onDidRunOperation.fire(new zn(e,4))}catch(l){throw new tt(g("err.write","Unable to write file '{0}' ({1})",this.resourceForError(e),Gn(l).toString()),Ue(l),a)}return this.resolve(e,{resolveMetadata:!0})}async validateWriteFile(e,r,i){let o=!!i?.unlock;if(o&&!(e.capabilities&8192))throw new Error(g("writeFailedUnlockUnsupported","Unable to unlock file '{0}' because provider does not support it.",this.resourceForError(r)));if(!!i?.atomic){if(!(e.capabilities&32768))throw new Error(g("writeFailedAtomicUnsupported1","Unable to atomically write file '{0}' because provider does not support it.",this.resourceForError(r)));if(!(e.capabilities&2))throw new Error(g("writeFailedAtomicUnsupported2","Unable to atomically write file '{0}' because provider does not support unbuffered writes.",this.resourceForError(r)));if(o)throw new Error(g("writeFailedAtomicUnlock","Unable to unlock file '{0}' because atomic write is enabled.",this.resourceForError(r)))}let a;try{a=await e.stat(r)}catch{return}if(a.type&2)throw new tt(g("fileIsDirectoryWriteError","Unable to write file '{0}' that is actually a directory",this.resourceForError(r)),0,i);if(this.throwIfFileIsReadonly(r,a),typeof i?.mtime=="number"&&typeof i.etag=="string"&&i.etag!==Ya&&typeof a.mtime=="number"&&typeof a.size=="number"&&i.mtime<a.mtime&&i.etag!==Ku({mtime:i.mtime,size:a.size}))throw new tt(g("fileModifiedError","File Modified Since"),3,i);return a}async readFile(e,r,i){let o=await this.withReadProvider(e);return r?.atomic?this.doReadFileAtomic(o,e,r,i):this.doReadFile(o,e,r,i)}async doReadFileAtomic(e,r,i,o){return new Promise((s,a)=>{this.writeQueue.queueFor(r,async()=>{try{let l=await this.doReadFile(e,r,i,o);s(l)}catch(l){a(l)}},this.getExtUri(e).providerExtUri)})}async doReadFile(e,r,i,o){let s=await this.doReadFileStream(e,r,{...i,preferUnbuffered:!0},o);return{...s,value:await pr(s.value)}}async readFileStream(e,r,i){let o=await this.withReadProvider(e);return this.doReadFileStream(o,e,r,i)}async doReadFileStream(e,r,i,o){let s=new at(o),a=i;Xa(e)&&e.enforceAtomicReadFile?.(r)&&(a={...i,atomic:!0});let l=this.validateReadFile(r,a).then(u=>u,u=>{throw s.dispose(!0),u}),c;try{return typeof a?.etag=="string"&&a.etag!==Ya&&await l,a?.atomic&&Xa(e)||!(jn(e)||Ja(e))||$t(e)&&a?.preferUnbuffered?c=this.readFileUnbuffered(e,r,a):Ja(e)?c=this.readFileStreamed(e,r,s.token,a):c=this.readFileBuffered(e,r,s.token,a),c.on("end",()=>s.dispose()),c.on("error",()=>s.dispose()),{...await l,value:c}}catch(u){throw c&&await Pa(c),this.restoreReadError(u,r,a)}}restoreReadError(e,r,i){let o=g("err.read","Unable to read file '{0}' ({1})",this.resourceForError(r),Gn(e).toString());return e instanceof Ci?new Ci(o,e.stat,i):e instanceof Ri?new Ri(o,e.fileOperationResult,e.size,e.options):new tt(o,Ue(e),i)}readFileStreamed(e,r,i,o=Object.create(null)){let s=e.readFileStream(r,o,i);return Ra(s,{data:a=>a instanceof W?a:W.wrap(a),error:a=>this.restoreReadError(a,r,o)},a=>W.concat(a))}readFileBuffered(e,r,i,o=Object.create(null)){let s=Np();return zl(e,r,s,a=>a,{...o,bufferSize:this.BUFFER_SIZE,errorTransformer:a=>this.restoreReadError(a,r,o)},i),s}readFileUnbuffered(e,r,i){let o=Vr(s=>W.concat(s));return(async()=>{try{let s;i?.atomic&&Xa(e)?s=await e.readFile(r,{atomic:!0}):s=await e.readFile(r),typeof i?.position=="number"&&(s=s.slice(i.position)),typeof i?.length=="number"&&(s=s.slice(0,i.length)),this.validateReadFileLimits(r,s.byteLength,i),o.end(W.wrap(s))}catch(s){o.error(s),o.end()}})(),o}async validateReadFile(e,r){let i=await this.resolve(e,{resolveMetadata:!0});if(i.isDirectory)throw new tt(g("fileIsDirectoryReadError","Unable to read file '{0}' that is actually a directory",this.resourceForError(e)),0,r);if(typeof r?.etag=="string"&&r.etag!==Ya&&r.etag===i.etag)throw new Ci(g("fileNotModifiedError","File not modified since"),i,r);return this.validateReadFileLimits(e,i.size,r),i}validateReadFileLimits(e,r,i){if(typeof i?.limits?.size=="number"&&r>i.limits.size)throw new Ri(g("fileTooLargeError","Unable to read file '{0}' that is too large to open",this.resourceForError(e)),7,r,i)}async canMove(e,r,i){return this.doCanMoveCopy(e,r,"move",i)}async canCopy(e,r,i){return this.doCanMoveCopy(e,r,"copy",i)}async doCanMoveCopy(e,r,i,o){if(e.toString()!==r.toString())try{let s=i==="move"?this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e):await this.withReadProvider(e),a=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(r),r);await this.doValidateMoveCopy(s,e,a,r,i,o)}catch(s){return s}return!0}async move(e,r,i){let o=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e),s=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(r),r),a=await this.doMoveCopy(o,e,s,r,"move",!!i),l=await this.resolve(r,{resolveMetadata:!0});return this._onDidRunOperation.fire(new zn(e,a==="move"?2:3,l)),l}async copy(e,r,i){let o=await this.withReadProvider(e),s=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(r),r),a=await this.doMoveCopy(o,e,s,r,"copy",!!i),l=await this.resolve(r,{resolveMetadata:!0});return this._onDidRunOperation.fire(new zn(e,a==="copy"?3:2,l)),l}async doMoveCopy(e,r,i,o,s,a){if(r.toString()===o.toString())return s;let{exists:l,isSameResourceWithDifferentPathCase:c}=await this.doValidateMoveCopy(e,r,i,o,s,a);if(l&&!c&&a&&await this.del(o,{recursive:!0}),await this.mkdirp(i,this.getExtUri(i).providerExtUri.dirname(o)),s==="copy"){if(e===i&&Vu(e))await e.copy(r,o,{overwrite:a});else{let u=await this.resolve(r);u.isDirectory?await this.doCopyFolder(e,u,i,o):await this.doCopyFile(e,r,i,o)}return s}else return e===i?(await e.rename(r,o,{overwrite:a}),s):(await this.doMoveCopy(e,r,i,o,"copy",a),await this.del(r,{recursive:!0}),"copy")}async doCopyFile(e,r,i,o){if(jn(e)&&jn(i))return this.doPipeBuffered(e,r,i,o);if(jn(e)&&$t(i))return this.doPipeBufferedToUnbuffered(e,r,i,o);if($t(e)&&jn(i))return this.doPipeUnbufferedToBuffered(e,r,i,o);if($t(e)&&$t(i))return this.doPipeUnbuffered(e,r,i,o)}async doCopyFolder(e,r,i,o){await i.mkdir(o),Array.isArray(r.children)&&await ze.settled(r.children.map(async s=>{let a=this.getExtUri(i).providerExtUri.joinPath(o,s.name);return s.isDirectory?this.doCopyFolder(e,await this.resolve(s.resource),i,a):this.doCopyFile(e,s.resource,i,a)}))}async doValidateMoveCopy(e,r,i,o,s,a){let l=!1;if(e===i){let{providerExtUri:u,isPathCaseSensitive:f}=this.getExtUri(e);if(f||(l=u.isEqual(r,o)),l&&s==="copy")throw new Error(g("unableToMoveCopyError1","Unable to copy when source '{0}' is same as target '{1}' with different path case on a case insensitive file system",this.resourceForError(r),this.resourceForError(o)));if(!l&&u.isEqualOrParent(o,r))throw new Error(g("unableToMoveCopyError2","Unable to move/copy when source '{0}' is parent of target '{1}'.",this.resourceForError(r),this.resourceForError(o)))}let c=await this.exists(o);if(c&&!l){if(!a)throw new tt(g("unableToMoveCopyError3","Unable to move/copy '{0}' because target '{1}' already exists at destination.",this.resourceForError(r),this.resourceForError(o)),4);if(e===i){let{providerExtUri:u}=this.getExtUri(e);if(u.isEqualOrParent(r,o))throw new Error(g("unableToMoveCopyError4","Unable to move/copy '{0}' into '{1}' since a file would replace the folder it is contained in.",this.resourceForError(r),this.resourceForError(o)))}}return{exists:c,isSameResourceWithDifferentPathCase:l}}getExtUri(e){let r=this.isPathCaseSensitive(e);return{providerExtUri:r?ae:cp,isPathCaseSensitive:r}}isPathCaseSensitive(e){return!!(e.capabilities&1024)}async createFolder(e){let r=this.throwIfFileSystemIsReadonly(await this.withProvider(e),e);await this.mkdirp(r,e);let i=await this.resolve(e,{resolveMetadata:!0});return this._onDidRunOperation.fire(new zn(e,0,i)),i}async mkdirp(e,r){let i=[],{providerExtUri:o}=this.getExtUri(e);for(;!o.isEqual(r,o.dirname(r));)try{if(!((await e.stat(r)).type&2))throw new Error(g("mkdirExistsError","Unable to create folder '{0}' that already exists but is not a directory",this.resourceForError(r)));break}catch(s){if(ts(s)!=="EntryNotFound")throw s;i.push(o.basename(r)),r=o.dirname(r)}for(let s=i.length-1;s>=0;s--){r=o.joinPath(r,i[s]);try{await e.mkdir(r)}catch(a){if(ts(a)!=="EntryExists")throw a}}}async canDelete(e,r){try{await this.doValidateDelete(e,r)}catch(i){return i}return!0}async doValidateDelete(e,r){let i=this.throwIfFileSystemIsReadonly(await this.withProvider(e),e),o=!!r?.useTrash;if(o&&!(i.capabilities&4096))throw new Error(g("deleteFailedTrashUnsupported","Unable to delete file '{0}' via trash because provider does not support it.",this.resourceForError(e)));let s=r?.atomic;if(s&&!(i.capabilities&65536))throw new Error(g("deleteFailedAtomicUnsupported","Unable to delete file '{0}' atomically because provider does not support it.",this.resourceForError(e)));if(o&&s)throw new Error(g("deleteFailedTrashAndAtomicUnsupported","Unable to atomically delete file '{0}' because using trash is enabled.",this.resourceForError(e)));let a;try{a=await i.stat(e)}catch{}if(a)this.throwIfFileIsReadonly(e,a);else throw new tt(g("deleteFailedNotFound","Unable to delete nonexistent file '{0}'",this.resourceForError(e)),1);if(!!!r?.recursive){let c=await this.resolve(e);if(c.isDirectory&&Array.isArray(c.children)&&c.children.length>0)throw new Error(g("deleteFailedNonEmptyFolder","Unable to delete non-empty folder '{0}'.",this.resourceForError(e)))}return i}async del(e,r){let i=await this.doValidateDelete(e,r),o=r;if(yg(i)&&!o?.atomic){let c=i.enforceAtomicDelete?.(e);c&&(o={...r,atomic:c})}let s=!!o?.useTrash,a=!!o?.recursive,l=o?.atomic??!1;await i.delete(e,{recursive:a,useTrash:s,atomic:l}),this._onDidRunOperation.fire(new zn(e,1))}async cloneFile(e,r){let i=await this.withProvider(e),o=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(r),r);if(!(i===o&&this.getExtUri(i).providerExtUri.isEqual(e,r)))return i===o&&mg(i)?i.cloneFile(e,r):(await this.mkdirp(o,this.getExtUri(o).providerExtUri.dirname(r)),i===o&&Vu(i)?this.writeQueue.queueFor(e,()=>i.copy(e,r,{overwrite:!0}),this.getExtUri(i).providerExtUri):this.writeQueue.queueFor(e,()=>this.doCopyFile(i,e,o,r),this.getExtUri(i).providerExtUri))}internalOnDidFilesChange=this._register(new C);_onDidUncorrelatedFilesChange=this._register(new C);onDidFilesChange=this._onDidUncorrelatedFilesChange.event;_onDidWatchError=this._register(new C);onDidWatchError=this._onDidWatchError.event;activeWatchers=new Map;static WATCHER_CORRELATION_IDS=0;createWatcher(e,r){return this.watch(e,{...r,correlationId:br.WATCHER_CORRELATION_IDS++})}watch(e,r={recursive:!1,excludes:[]}){let i=new Ee,o=!1,s=()=>{o=!0};i.add(te(()=>s())),(async()=>{try{let l=await this.doWatch(e,r);o?ct(l):s=()=>ct(l)}catch(l){this.logService.error(l)}})();let a=r.correlationId;if(typeof a=="number"){let l=i.add(new C);return i.add(this.internalOnDidFilesChange.event(u=>{u.correlates(a)&&l.fire(u)})),{onDidChange:l.event,dispose:()=>i.dispose()}}return i}async doWatch(e,r){let i=await this.withProvider(e),o=Pn([this.getExtUri(i).providerExtUri.getComparisonKey(e),r]),s=this.activeWatchers.get(o);return s||(s={count:0,disposable:i.watch(e,r)},this.activeWatchers.set(o,s)),s.count+=1,te(()=>{s&&(s.count--,s.count===0&&(ct(s.disposable),this.activeWatchers.delete(o)))})}dispose(){super.dispose();for(let[,e]of this.activeWatchers)ct(e.disposable);this.activeWatchers.clear()}writeQueue=this._register(new vi);async doWriteBuffered(e,r,i,o){return this.writeQueue.queueFor(r,async()=>{let s=await e.open(r,{create:!0,unlock:i?.unlock??!1});try{Jo(o)||Ta(o)?await this.doWriteStreamBufferedQueued(e,s,o):await this.doWriteReadableBufferedQueued(e,s,o)}catch(a){throw Gn(a)}finally{await e.close(s)}},this.getExtUri(e).providerExtUri)}async doWriteStreamBufferedQueued(e,r,i){let o=0,s;if(Ta(i)){if(i.buffer.length>0){let a=W.concat(i.buffer);await this.doWriteBuffer(e,r,a,a.byteLength,o,0),o+=a.byteLength}if(i.ended)return;s=i.stream}else s=i;return new Promise((a,l)=>{_a(s,{onData:async c=>{s.pause();try{await this.doWriteBuffer(e,r,c,c.byteLength,o,0)}catch(u){return l(u)}o+=c.byteLength,setTimeout(()=>s.resume())},onError:c=>l(c),onEnd:()=>a()})})}async doWriteReadableBufferedQueued(e,r,i){let o=0,s;for(;(s=i.read())!==null;)await this.doWriteBuffer(e,r,s,s.byteLength,o,0),o+=s.byteLength}async doWriteBuffer(e,r,i,o,s,a){let l=0;for(;l<o;){let c=await e.write(r,s+l,i.buffer,a+l,o-l);l+=c}}async doWriteUnbuffered(e,r,i,o){return this.writeQueue.queueFor(r,()=>this.doWriteUnbufferedQueued(e,r,i,o),this.getExtUri(e).providerExtUri)}async doWriteUnbufferedQueued(e,r,i,o){let s;o instanceof W?s=o:Jo(o)?s=await pr(o):Ta(o)?s=await Lp(o):s=Ap(o),await e.writeFile(r,s.buffer,{create:!0,overwrite:!0,unlock:i?.unlock??!1,atomic:i?.atomic??!1})}async doPipeBuffered(e,r,i,o){return this.writeQueue.queueFor(o,()=>this.doPipeBufferedQueued(e,r,i,o),this.getExtUri(i).providerExtUri)}async doPipeBufferedQueued(e,r,i,o){let s,a;try{s=await e.open(r,{create:!1}),a=await i.open(o,{create:!0,unlock:!1});let l=W.alloc(this.BUFFER_SIZE),c=0,u=0,f=0;do f=await e.read(s,c,l.buffer,u,l.byteLength-u),await this.doWriteBuffer(i,a,l,f,c,u),c+=f,u+=f,u===l.byteLength&&(u=0);while(f>0)}catch(l){throw Gn(l)}finally{await ze.settled([typeof s=="number"?e.close(s):Promise.resolve(),typeof a=="number"?i.close(a):Promise.resolve()])}}async doPipeUnbuffered(e,r,i,o){return this.writeQueue.queueFor(o,()=>this.doPipeUnbufferedQueued(e,r,i,o),this.getExtUri(i).providerExtUri)}async doPipeUnbufferedQueued(e,r,i,o){return i.writeFile(o,await e.readFile(r),{create:!0,overwrite:!0,unlock:!1,atomic:!1})}async doPipeUnbufferedToBuffered(e,r,i,o){return this.writeQueue.queueFor(o,()=>this.doPipeUnbufferedToBufferedQueued(e,r,i,o),this.getExtUri(i).providerExtUri)}async doPipeUnbufferedToBufferedQueued(e,r,i,o){let s=await i.open(o,{create:!0,unlock:!1});try{let a=await e.readFile(r);await this.doWriteBuffer(i,s,W.wrap(a),a.byteLength,0,0)}catch(a){throw Gn(a)}finally{await i.close(s)}}async doPipeBufferedToUnbuffered(e,r,i,o){let s=await pr(this.readFileBuffered(e,r,ce.None));await this.doWriteUnbuffered(i,o,void 0,s)}throwIfFileSystemIsReadonly(e,r){if(e.capabilities&2048)throw new tt(g("err.readonly","Unable to modify read-only file '{0}'",this.resourceForError(r)),6);return e}throwIfFileIsReadonly(e,r){if((r.permissions??0)&1)throw new tt(g("err.readonly","Unable to modify read-only file '{0}'",this.resourceForError(e)),6)}resourceForError(e){return e.scheme===Q.file?e.fsPath:e.toString(!0)}};br=D([b(0,J)],br);import{promises as xr}from"fs";function Ql(n){return typeof n.correlationId=="number"}function Dd(n){return n.recursive===!0}var jl=class n extends U{constructor(e,r,i,o){super();this.onFileChanges=e;this.onLogMessage=r;this.verboseLogging=i;this.options=o}static MAX_RESTARTS=5;watcher;watcherDisposables=this._register(new lr);requests=void 0;restartCounter=0;init(){let e=new Ee;this.watcherDisposables.value=e,this.watcher=this.createWatcher(e),this.watcher.setVerboseLogging(this.verboseLogging),e.add(this.watcher.onDidChangeFile(r=>this.onFileChanges(r))),e.add(this.watcher.onDidLogMessage(r=>this.onLogMessage(r))),e.add(this.watcher.onDidError(r=>this.onError(r.error,r.request)))}onError(e,r){this.canRestart(e,r)?this.restartCounter<n.MAX_RESTARTS&&this.requests?(this.error(`restarting watcher after unexpected error: ${e}`),this.restart(this.requests)):this.error(`gave up attempting to restart watcher after unexpected error: ${e}`):this.error(e)}canRestart(e,r){return!(!this.options.restartOnError||r||e.indexOf("No space left on device")!==-1||e.indexOf("EMFILE")!==-1)}restart(e){this.restartCounter++,this.init(),this.watch(e)}async watch(e){this.requests=e,await this.watcher?.watch(e)}async setVerboseLogging(e){this.verboseLogging=e,await this.watcher?.setVerboseLogging(e)}error(e){this.onLogMessage({type:"error",message:`[File Watcher (${this.options.type})] ${e}`})}trace(e){this.onLogMessage({type:"trace",message:`[File Watcher (${this.options.type})] ${e}`})}dispose(){return this.watcher=void 0,super.dispose()}},Gl=class extends jl{constructor(t,e,r){super(t,e,r,{type:"node.js",restartOnError:!1})}},Hl=class extends jl{constructor(t,e,r){super(t,e,r,{type:"universal",restartOnError:!0})}};function kd(n){return n.map(t=>({type:t.type,resource:P.revive(t.resource),cId:t.cId}))}function Tm(n){let t=new Cd;for(let e of n)t.processEvent(e);return t.coalesce()}function dx(n,t){return typeof t=="string"&&!t.startsWith(Pi)&&!ir(t)?{base:n,pattern:t}:t}function Od(n,t){let e=[];for(let r of t)e.push(ag(dx(n,r)));return e}var Cd=class{coalesced=new Set;mapPathToChange=new Map;toKey(t){return Se?t.resource.fsPath:t.resource.fsPath.toLowerCase()}processEvent(t){let e=this.mapPathToChange.get(this.toKey(t)),r=!1;if(e){let i=e.type,o=t.type;e.resource.fsPath!==t.resource.fsPath&&(t.type===2||t.type===1)?r=!0:i===1&&o===2?(this.mapPathToChange.delete(this.toKey(t)),this.coalesced.delete(e)):i===2&&o===1?e.type=0:i===1&&o===0||(e.type=o)}else r=!0;r&&(this.coalesced.add(t),this.mapPathToChange.set(this.toKey(t),t))}coalesce(){let t=[],e=[];return Array.from(this.coalesced).filter(r=>r.type!==2?(t.push(r),!1):!0).sort((r,i)=>r.resource.fsPath.length-i.resource.fsPath.length).filter(r=>e.some(i=>vg(r.resource.fsPath,i,!Se))?!1:(e.push(r.resource.fsPath),!0)).concat(t)}};function Pm(n,t){if(typeof t=="number")switch(n.type){case 1:return(t&4)===0;case 2:return(t&8)===0;case 0:return(t&2)===0}return!1}function _m(n){if(typeof n=="number"){let t=[];return n&4&&t.push("Added"),n&8&&t.push("Deleted"),n&2&&t.push("Updated"),t.length===0?"<all>":`[${t.join(", ")}]`}return"<none>"}var Jl=class extends U{constructor(e,r){super();this.logService=e;this.options=r}_onDidChangeFile=this._register(new C);onDidChangeFile=this._onDidChangeFile.event;_onDidWatchError=this._register(new C);onDidWatchError=this._onDidWatchError.event;watch(e,r){return r.recursive||this.options?.watcher?.forceUniversal?this.watchUniversal(e,r):this.watchNonRecursive(e,r)}universalWatcher;universalWatchRequests=[];universalWatchRequestDelayer=this._register(new Zt(0));watchUniversal(e,r){let i={path:this.toWatchPath(e),excludes:r.excludes,includes:r.includes,recursive:r.recursive,filter:r.filter,correlationId:r.correlationId},o=Fc(this.universalWatchRequests,i);return this.refreshUniversalWatchers(),te(()=>{o(),this.refreshUniversalWatchers()})}refreshUniversalWatchers(){this.universalWatchRequestDelayer.trigger(()=>this.doRefreshUniversalWatchers()).catch(e=>Lt(e))}doRefreshUniversalWatchers(){this.universalWatcher||(this.universalWatcher=this._register(this.createUniversalWatcher(r=>this._onDidChangeFile.fire(kd(r)),r=>this.onWatcherLogMessage(r),this.logService.getLevel()===1)),this._register(this.logService.onDidChangeLogLevel(()=>{this.universalWatcher?.setVerboseLogging(this.logService.getLevel()===1)})));let e=this.options?.watcher?.recursive?.usePolling;if(e===!0)for(let r of this.universalWatchRequests)Dd(r)&&(r.pollingInterval=this.options?.watcher?.recursive?.pollingInterval??5e3);else if(Array.isArray(e))for(let r of this.universalWatchRequests)Dd(r)&&e.includes(r.path)&&(r.pollingInterval=this.options?.watcher?.recursive?.pollingInterval??5e3);return this.universalWatcher.watch(this.universalWatchRequests)}nonRecursiveWatcher;nonRecursiveWatchRequests=[];nonRecursiveWatchRequestDelayer=this._register(new Zt(0));watchNonRecursive(e,r){let i={path:this.toWatchPath(e),excludes:r.excludes,includes:r.includes,recursive:!1,filter:r.filter,correlationId:r.correlationId},o=Fc(this.nonRecursiveWatchRequests,i);return this.refreshNonRecursiveWatchers(),te(()=>{o(),this.refreshNonRecursiveWatchers()})}refreshNonRecursiveWatchers(){this.nonRecursiveWatchRequestDelayer.trigger(()=>this.doRefreshNonRecursiveWatchers()).catch(e=>Lt(e))}doRefreshNonRecursiveWatchers(){return this.nonRecursiveWatcher||(this.nonRecursiveWatcher=this._register(this.createNonRecursiveWatcher(e=>this._onDidChangeFile.fire(kd(e)),e=>this.onWatcherLogMessage(e),this.logService.getLevel()===1)),this._register(this.logService.onDidChangeLogLevel(()=>{this.nonRecursiveWatcher?.setVerboseLogging(this.logService.getLevel()===1)}))),this.nonRecursiveWatcher.watch(this.nonRecursiveWatchRequests)}onWatcherLogMessage(e){e.type==="error"&&this._onDidWatchError.fire(e.message),this.logWatcherMessage(e)}logWatcherMessage(e){this.logService[e.type](e.message)}toFilePath(e){return Wt(e.fsPath)}toWatchPath(e){let r=this.toFilePath(e);return np(r)}};function de(n,t,e){let r=null,i=null;if(typeof e.value=="function"?(r="value",i=e.value,i.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof e.get=="function"&&(r="get",i=e.get),!i)throw new Error("not supported");let o=`$memoize$${t}`;e[r]=function(...s){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:i.apply(this,s)}),this[o]}}function Rm(n){switch(n){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function Cm(n){switch(n){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}function io(n){let t=0;for(let e=0;;e+=7){let r=n.read(1);if(t|=(r.buffer[0]&127)<<e,!(r.buffer[0]&128))return t}}var fx=Ir(0);function oo(n,t){if(t===0){n.write(fx);return}let e=0;for(let i=t;i!==0;i=i>>>7)e++;let r=W.alloc(e);for(let i=0;t!==0;i++)r.buffer[i]=t&127,t=t>>>7,t>0&&(r.buffer[i]|=128);n.write(r)}var Ad=class{constructor(t){this.buffer=t}pos=0;read(t){let e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=e.byteLength,e}},Fd=class{buffers=[];get buffer(){return W.concat(this.buffers)}write(t){this.buffers.push(t)}};function Ir(n){let t=W.alloc(1);return t.writeUInt8(n,0),t}var Jr={Undefined:Ir(0),String:Ir(1),Buffer:Ir(2),VSBuffer:Ir(3),Array:Ir(4),Object:Ir(5),Uint:Ir(6)},px=typeof Buffer<"u";function Ld(n,t){if(typeof t>"u")n.write(Jr.Undefined);else if(typeof t=="string"){let e=W.fromString(t);n.write(Jr.String),oo(n,e.byteLength),n.write(e)}else if(px&&Buffer.isBuffer(t)){let e=W.wrap(t);n.write(Jr.Buffer),oo(n,e.byteLength),n.write(e)}else if(t instanceof W)n.write(Jr.VSBuffer),oo(n,t.byteLength),n.write(t);else if(Array.isArray(t)){n.write(Jr.Array),oo(n,t.length);for(let e of t)Ld(n,e)}else if(typeof t=="number"&&(t|0)===t)n.write(Jr.Uint),oo(n,t);else{let e=W.fromString(JSON.stringify(t));n.write(Jr.Object),oo(n,e.byteLength),n.write(e)}}function Ud(n){switch(n.read(1).readUInt8(0)){case 0:return;case 1:return n.read(io(n)).toString();case 2:return n.read(io(n)).buffer;case 3:return n.read(io(n));case 4:{let e=io(n),r=[];for(let i=0;i<e;i++)r.push(Ud(n));return r}case 5:return JSON.parse(n.read(io(n)).toString());case 6:return io(n)}}var xs=class{constructor(t,e=null){this.protocol=t;this.protocolListener=this.protocol.onMessage(r=>this.onBuffer(r)),this.logger=e}isDisposed=!1;state=0;activeRequests=new Set;handlers=new Map;lastRequestId=0;protocolListener;logger;_onDidInitialize=new C;onDidInitialize=this._onDidInitialize.event;getChannel(t){let e=this;return{call(r,i,o){return e.isDisposed?Promise.reject(new me):e.requestPromise(t,r,i,o)},listen(r,i){return e.isDisposed?Z.None:e.requestEvent(t,r,i)}}}requestPromise(t,e,r,i=ce.None){let o=this.lastRequestId++,a={id:o,type:100,channelName:t,name:e,arg:r};if(i.isCancellationRequested)return Promise.reject(new me);let l;return new Promise((u,f)=>{if(i.isCancellationRequested)return f(new me);let p=()=>{let I=S=>{switch(S.type){case 201:this.handlers.delete(o),u(S.data);break;case 202:{this.handlers.delete(o);let T=new Error(S.data.message);T.stack=Array.isArray(S.data.stack)?S.data.stack.join(`
`):S.data.stack,T.name=S.data.name,f(T);break}case 203:this.handlers.delete(o),f(S.data);break}};this.handlers.set(o,I),this.sendRequest(a)},h=null;this.state===1?p():(h=qt(I=>this.whenInitialized()),h.then(()=>{h=null,p()}));let v=()=>{h?(h.cancel(),h=null):this.sendRequest({id:o,type:101}),f(new me)},y=i.onCancellationRequested(v);l=ii(te(v),y),this.activeRequests.add(l)}).finally(()=>{l.dispose(),this.activeRequests.delete(l)})}requestEvent(t,e,r){let i=this.lastRequestId++,s={id:i,type:102,channelName:t,name:e,arg:r},a=null,l=new C({onWillAddFirstListener:()=>{a=qt(u=>this.whenInitialized()),a.then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(s)})},onDidRemoveLastListener:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:i,type:103}))}}),c=u=>l.fire(u.data);return this.handlers.set(i,c),l.event}sendRequest(t){switch(t.type){case 100:case 102:{let e=this.send([t.type,t.id,t.channelName,t.name],t.arg);this.logger?.logOutgoing(e,t.id,0,`${Rm(t.type)}: ${t.channelName}.${t.name}`,t.arg);return}case 101:case 103:{let e=this.send([t.type,t.id]);this.logger?.logOutgoing(e,t.id,0,Rm(t.type));return}}}send(t,e=void 0){let r=new Fd;return Ld(r,t),Ld(r,e),this.sendBuffer(r.buffer)}sendBuffer(t){try{return this.protocol.send(t),t.byteLength}catch{return 0}}onBuffer(t){let e=new Ad(t),r=Ud(e),i=Ud(e),o=r[0];switch(o){case 200:return this.logger?.logIncoming(t.byteLength,0,0,Cm(o)),this.onResponse({type:r[0]});case 201:case 202:case 204:case 203:return this.logger?.logIncoming(t.byteLength,r[1],0,Cm(o),i),this.onResponse({type:r[0],id:r[1],data:i})}}onResponse(t){if(t.type===200){this.state=1,this._onDidInitialize.fire();return}this.handlers.get(t.id)?.(t)}get onDidInitializePromise(){return Z.toPromise(this.onDidInitialize)}whenInitialized(){return this.state===1?Promise.resolve():this.onDidInitializePromise}dispose(){this.isDisposed=!0,this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),ct(this.activeRequests.values()),this.activeRequests.clear()}};D([de],xs.prototype,"onDidInitializePromise",1);function Dm(n){let t=!1;return{call(e,r,i){return t?n.call(e,r,i):Mr(0).then(()=>t=!0).then(()=>n.call(e,r,i))},listen(e,r){if(t)return n.listen(e,r);let i=new Qs;return Mr(0).then(()=>t=!0).then(()=>i.input=n.listen(e,r)),i.event}}}var Nd;(i=>{function n(o,s,a){let l=o,c=a&&a.disableMarshalling,u=new Map;for(let f in l)e(f)&&u.set(f,Z.buffer(l[f],!0,void 0,s));return new class{listen(f,p,h){let v=u.get(p);if(v)return v;let y=l[p];if(typeof y=="function"){if(r(p))return y.call(l,h);if(e(p))return u.set(p,Z.buffer(l[p],!0,void 0,s)),u.get(p)}throw new In(`Event not found: ${p}`)}call(f,p,h){let v=l[p];if(typeof v=="function"){if(!c&&Array.isArray(h))for(let I=0;I<h.length;I++)h[I]=zr(h[I]);let y=v.apply(l,h);return y instanceof Promise||(y=Promise.resolve(y)),y}throw new In(`Method not found: ${p}`)}}}i.fromService=n;function t(o,s){let a=s&&s.disableMarshalling;return new Proxy({},{get(l,c){if(typeof c=="string")return s?.properties?.has(c)?s.properties.get(c):r(c)?function(u){return o.listen(c,u)}:e(c)?o.listen(c):async function(...u){let f;s&&!Ye(s.context)?f=[s.context,...u]:f=u;let p=await o.call(c,f);return a?p:zr(p)};throw new In(`Property not found: ${String(c)}`)}})}i.toService=t;function e(o){return o[0]==="o"&&o[1]==="n"&&Jc(o.charCodeAt(2))}function r(o){return/^onDynamic/.test(o)&&Jc(o.charCodeAt(9))}})(Nd||={});import{fork as mx}from"child_process";function km(n){let t=n;return t&&typeof t.type=="string"&&typeof t.severity=="string"}function gx(n){let t=[],e;try{let r=JSON.parse(n.arguments),i=r[r.length-1];i&&i.__$stack&&(r.pop(),e=i.__$stack),t.push(...r)}catch{t.push("Unable to log remote console arguments",n.arguments)}return{args:t,stack:e}}function hx(n){if(!n)return n;let t=n.indexOf(`
`);return t===-1?n:n.substring(0,t)}function Om(n,t){let{args:e,stack:r}=gx(n),i=typeof e[0]=="string"&&e.length===1,o=hx(r);o&&(o=`(${o.trim()})`);let s=[];if(typeof e[0]=="string"?o&&i?s=[`%c[${t}] %c${e[0]} %c${o}`,so("blue"),so(""),so("grey")]:s=[`%c[${t}] %c${e[0]}`,so("blue"),so(""),...e.slice(1)]:s=[`%c[${t}]%`,so("blue"),...e],o&&!i&&s.push(o),typeof console[n.severity]!="function")throw new Error("Unknown console method");console[n.severity].apply(console,s)}function so(n){return`color: ${n}`}var Xl=class{constructor(t,e){this.modulePath=t;this.options=e;let r=e&&e.timeout?e.timeout:6e4;this.disposeDelayer=new Ho(r),this.child=null,this._client=null}disposeDelayer;activeRequests=new Set;child;_client;channels=new Map;_onDidProcessExit=new C;onDidProcessExit=this._onDidProcessExit.event;getChannel(t){let e=this;return{call(r,i,o){return e.requestPromise(t,r,i,o)},listen(r,i){return e.requestEvent(t,r,i)}}}requestPromise(t,e,r,i=ce.None){if(!this.disposeDelayer)return Promise.reject(new Error("disposed"));if(i.isCancellationRequested)return Promise.reject(Us());this.disposeDelayer.cancel();let o=this.getCachedChannel(t),s=qt(c=>o.call(e,r,c)),a=i.onCancellationRequested(()=>s.cancel()),l=te(()=>s.cancel());return this.activeRequests.add(l),s.finally(()=>{a.dispose(),this.activeRequests.delete(l),this.activeRequests.size===0&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}),s}requestEvent(t,e,r){if(!this.disposeDelayer)return Z.None;this.disposeDelayer.cancel();let i,o=new C({onWillAddFirstListener:()=>{i=this.getCachedChannel(t).listen(e,r)(o.fire,o),this.activeRequests.add(i)},onDidRemoveLastListener:()=>{this.activeRequests.delete(i),i.dispose(),this.activeRequests.size===0&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}});return o.event}get client(){if(!this._client){let t=this.options&&this.options.args?this.options.args:[],e=Object.create(null);e.env={...Rn(process.env),VSCODE_PARENT_PID:String(process.pid)},this.options&&this.options.env&&(e.env={...e.env,...this.options.env}),this.options&&this.options.freshExecArgv&&(e.execArgv=[]),this.options&&typeof this.options.debug=="number"&&(e.execArgv=["--nolazy","--inspect="+this.options.debug]),this.options&&typeof this.options.debugBrk=="number"&&(e.execArgv=["--nolazy","--inspect-brk="+this.options.debugBrk]),e.execArgv===void 0&&(e.execArgv=process.execArgv.filter(f=>!/^--inspect(-brk)?=/.test(f)).filter(f=>!f.startsWith("--vscode-"))),Fg(e.env),this.child=mx(this.modulePath,t,e);let r=new C,o=Z.fromNodeEventEmitter(this.child,"message",f=>f)(f=>{if(km(f)){Om(f,`IPC Library: ${this.options.serverName}`);return}r.fire(W.wrap(Buffer.from(f,"base64")))}),s=this.options.useQueue?Ng(this.child):this.child,a=f=>this.child&&this.child.connected&&s.send(f.buffer.toString("base64")),l=r.event,c={send:a,onMessage:l};this._client=new xs(c);let u=()=>this.disposeClient();process.once("exit",u),this.child.on("error",f=>console.warn('IPC "'+this.options.serverName+'" errored with '+f)),this.child.on("exit",(f,p)=>{process.removeListener("exit",u),o.dispose(),this.activeRequests.forEach(h=>ct(h)),this.activeRequests.clear(),f!==0&&p!=="SIGTERM"&&console.warn('IPC "'+this.options.serverName+'" crashed with exit code '+f+" and signal "+p),this.disposeDelayer?.cancel(),this.disposeClient(),this._onDidProcessExit.fire({code:f,signal:p})})}return this._client}getCachedChannel(t){let e=this.channels.get(t);return e||(e=this.client.getChannel(t),this.channels.set(t,e)),e}disposeClient(){this._client&&(this.child&&(this.child.kill(),this.child=null),this._client=null,this.channels.clear())}dispose(){this._onDidProcessExit.dispose(),this.disposeDelayer?.cancel(),this.disposeDelayer=void 0,this.disposeClient(),this.activeRequests.clear()}};var Yl=class extends Hl{constructor(t,e,r){super(t,e,r),this.init()}createWatcher(t){let e=t.add(new Xl(fn.asFileUri("bootstrap-fork").fsPath,{serverName:"File Watcher",args:["--type=fileWatcher"],env:{VSCODE_AMD_ENTRYPOINT:"vs/platform/files/node/watcher/watcherMain",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));return t.add(e.onDidProcessExit(({code:r,signal:i})=>this.onError(`terminated by itself with code ${r}, signal: ${i} (ETERM)`))),Nd.toService(Dm(e.getChannel("watcher")))}};import{watchFile as yx,unwatchFile as vx}from"fs";var Zl=class extends U{_onDidChangeFile=this._register(new C);onDidChangeFile=this._onDidChangeFile.event;_onDidLogMessage=this._register(new C);onDidLogMessage=this._onDidLogMessage.event;_onDidWatchFail=this._register(new C);onDidWatchFail=this._onDidWatchFail.event;allNonCorrelatedWatchRequests=new Set;allCorrelatedWatchRequests=new Map;suspendedWatchRequests=this._register(new Ln);suspendedWatchRequestsWithPolling=new Set;updateWatchersDelayer=this._register(new Zt(this.getUpdateWatchersDelay()));suspendedWatchRequestPollingInterval=5007;joinWatch=new bi;constructor(){super(),this._register(this.onDidWatchFail(t=>this.handleDidWatchFail(t)))}handleDidWatchFail(t){this.isCorrelated(t)&&this.suspendWatchRequest(t)}isCorrelated(t){return Ql(t)}async watch(t){this.joinWatch.isSettled||this.joinWatch.complete(),this.joinWatch=new bi;try{this.allCorrelatedWatchRequests.clear(),this.allNonCorrelatedWatchRequests.clear();for(let e of t)this.isCorrelated(e)?this.allCorrelatedWatchRequests.set(e.correlationId,e):this.allNonCorrelatedWatchRequests.add(e);for(let[e]of this.suspendedWatchRequests)this.allCorrelatedWatchRequests.has(e)||(this.suspendedWatchRequests.deleteAndDispose(e),this.suspendedWatchRequestsWithPolling.delete(e));return await this.updateWatchers(!1)}finally{this.joinWatch.complete()}}updateWatchers(t){return this.updateWatchersDelayer.trigger(()=>this.doWatch([...this.allNonCorrelatedWatchRequests,...Array.from(this.allCorrelatedWatchRequests.values()).filter(e=>!this.suspendedWatchRequests.has(e.correlationId))]),t?this.getUpdateWatchersDelay():0)}getUpdateWatchersDelay(){return 800}isSuspended(t){return typeof t.correlationId!="number"?!1:this.suspendedWatchRequestsWithPolling.has(t.correlationId)?"polling":this.suspendedWatchRequests.has(t.correlationId)}async suspendWatchRequest(t){if(this.suspendedWatchRequests.has(t.correlationId))return;let e=new Ee;this.suspendedWatchRequests.set(t.correlationId,e),await this.joinWatch.p,!e.isDisposed&&(this.monitorSuspendedWatchRequest(t,e),this.updateWatchers(!0))}resumeWatchRequest(t){this.suspendedWatchRequests.deleteAndDispose(t.correlationId),this.suspendedWatchRequestsWithPolling.delete(t.correlationId),this.updateWatchers(!1)}monitorSuspendedWatchRequest(t,e){this.doMonitorWithExistingWatcher(t,e)?(this.trace(`reusing an existing recursive watcher to monitor ${t.path}`),this.suspendedWatchRequestsWithPolling.delete(t.correlationId)):(this.doMonitorWithNodeJS(t,e),this.suspendedWatchRequestsWithPolling.add(t.correlationId))}doMonitorWithExistingWatcher(t,e){let r=this.recursiveWatcher?.subscribe(t.path,(i,o)=>{e.isDisposed||(i?this.monitorSuspendedWatchRequest(t,e):o?.type===1&&this.onMonitoredPathAdded(t))});return r?(e.add(r),!0):!1}doMonitorWithNodeJS(t,e){let r=!1,i=(o,s)=>{if(e.isDisposed)return;let a=this.isPathNotFound(o),l=this.isPathNotFound(s),c=r;r=a,!a&&(l||c)&&this.onMonitoredPathAdded(t)};this.trace(`starting fs.watchFile() on ${t.path} (correlationId: ${t.correlationId})`);try{yx(t.path,{persistent:!1,interval:this.suspendedWatchRequestPollingInterval},i)}catch(o){this.warn(`fs.watchFile() failed with error ${o} on path ${t.path} (correlationId: ${t.correlationId})`)}e.add(te(()=>{this.trace(`stopping fs.watchFile() on ${t.path} (correlationId: ${t.correlationId})`);try{vx(t.path,i)}catch(o){this.warn(`fs.unwatchFile() failed with error ${o} on path ${t.path} (correlationId: ${t.correlationId})`)}}))}onMonitoredPathAdded(t){this.trace(`detected ${t.path} exists again, resuming watcher (correlationId: ${t.correlationId})`);let e={resource:P.file(t.path),type:1,cId:t.correlationId};this._onDidChangeFile.fire([e]),this.traceEvent(e,t),this.resumeWatchRequest(t)}isPathNotFound(t){return t.ctimeMs===0&&t.ino===0}async stop(){this.suspendedWatchRequests.clearAndDisposeAll(),this.suspendedWatchRequestsWithPolling.clear()}traceEvent(t,e){if(this.verboseLogging){let r=` >> normalized ${t.type===1?"[ADDED]":t.type===2?"[DELETED]":"[CHANGED]"} ${t.resource.fsPath}`;this.traceWithCorrelation(r,e)}}traceWithCorrelation(t,e){this.verboseLogging&&this.trace(`${t}${typeof e.correlationId=="number"?` <${e.correlationId}> `:""}`)}requestToString(t){return`${t.path} (excludes: ${t.excludes.length>0?t.excludes:"<none>"}, includes: ${t.includes&&t.includes.length>0?JSON.stringify(t.includes):"<all>"}, filter: ${_m(t.filter)}, correlationId: ${typeof t.correlationId=="number"?t.correlationId:"<none>"})`}verboseLogging=!1;async setVerboseLogging(t){this.verboseLogging=t}};import{watch as bx,promises as Ix}from"fs";async function ec(n,t){if(Se)return n;let e=lt(n);if(n===e)return n;let r=(je(n)||n).toLowerCase();try{if(t?.isCancellationRequested)return null;let o=(await se.readdir(e)).filter(s=>s.toLowerCase()===r);if(o.length===1){let s=await ec(e,t);if(s)return V(s,o[0])}else if(o.length>1){let s=o.indexOf(r);if(s>=0){let a=await ec(e,t);if(a)return V(a,o[s])}}}catch{}return null}var tc=class n extends U{constructor(e,r,i,o,s,a){super();this.request=e;this.recursiveWatcher=r;this.onDidFilesChange=i;this.onDidWatchFail=o;this.onLogMessage=s;this.verboseLogging=a}static FILE_DELETE_HANDLER_DELAY=100;static FILE_CHANGES_HANDLER_DELAY=75;throttledFileChangesEmitter=this._register(new Ea({maxWorkChunkSize:100,throttleDelay:200,maxBufferedWork:1e4},e=>this.onDidFilesChange(e)));fileChangesAggregator=this._register(new xa(e=>this.handleFileChanges(e),n.FILE_CHANGES_HANDLER_DELAY));excludes=Od(this.request.path,this.request.excludes);includes=this.request.includes?Od(this.request.path,this.request.includes):void 0;filter=Ql(this.request)?this.request.filter:void 0;cts=new at;ready=this.watch();_isReusingRecursiveWatcher=!1;get isReusingRecursiveWatcher(){return this._isReusingRecursiveWatcher}didFail=!1;get failed(){return this.didFail}async watch(){try{let e=await this.normalizePath(this.request);if(this.cts.token.isCancellationRequested)return;let r=await Ix.stat(e);if(this.cts.token.isCancellationRequested)return;this._register(await this.doWatch(e,r.isDirectory()))}catch(e){e.code!=="ENOENT"?this.error(e):this.trace(`ignoring a path for watching who's stat info failed to resolve: ${this.request.path} (error: ${e})`),this.notifyWatchFailed()}}notifyWatchFailed(){this.didFail=!0,this.onDidWatchFail?.()}async normalizePath(e){let r=e.path;try{r=await se.realpath(e.path),e.path===r&&(r=await ec(e.path,this.cts.token)??e.path),e.path!==r&&this.trace(`correcting a path to watch that seems to be a symbolic link or wrong casing (original: ${e.path}, real: ${r})`)}catch{}return r}async doWatch(e,r){let i=new Ee;return this.doWatchWithExistingWatcher(e,r,i)?(this.trace(`reusing an existing recursive watcher for ${this.request.path}`),this._isReusingRecursiveWatcher=!0):(this._isReusingRecursiveWatcher=!1,await this.doWatchWithNodeJS(e,r,i)),i}doWatchWithExistingWatcher(e,r,i){if(r)return!1;let o=P.file(this.request.path),s=this.recursiveWatcher?.subscribe(this.request.path,async(a,l)=>{if(!i.isDisposed)if(a){let c=await this.doWatch(e,r);i.isDisposed?c.dispose():i.add(c)}else l&&(typeof l.cId=="number"||typeof this.request.correlationId=="number")&&this.onFileChange({resource:o,type:l.type,cId:this.request.correlationId},!0)});return s?(i.add(s),!0):!1}async doWatchWithNodeJS(e,r,i){if(Vt&&Bn(e,"/Volumes/",!0)){this.error(`Refusing to watch ${e} for changes using fs.watch() for possibly being a network share where watching is unreliable and unstable.`);return}let o=new at(this.cts.token);i.add(te(()=>o.dispose(!0)));let s=new Ee;i.add(s);try{let a=P.file(this.request.path),l=je(e),c=bx(e);s.add(te(()=>{c.removeAllListeners(),c.close()})),this.trace(`Started watching: '${e}'`);let u=new Set;if(r)try{for(let p of await se.readdir(e))u.add(p)}catch(p){this.error(p)}if(o.token.isCancellationRequested)return;let f=new Map;s.add(te(()=>{for(let[,p]of f)p.dispose();f.clear()})),c.on("error",(p,h)=>{o.token.isCancellationRequested||(this.error(`Failed to watch ${e} for changes using fs.watch() (${p}, ${h})`),this.notifyWatchFailed())}),c.on("change",(p,h)=>{if(o.token.isCancellationRequested)return;this.verboseLogging&&this.traceWithCorrelation(`[raw] ["${p}"] ${h}`);let v="";if(h&&(v=h.toString(),Vt&&(v=rs(v))),!(!v||p!=="change"&&p!=="rename"))if(r)if(p==="rename"){f.get(v)?.dispose();let y=setTimeout(async()=>{if(f.delete(v),v===l&&!await se.exists(e)){this.onWatchedPathDeleted(a);return}if(o.token.isCancellationRequested)return;let I=await this.existsChildStrictCase(V(e,v));if(o.token.isCancellationRequested)return;let S;I?u.has(v)?S=0:(S=1,u.add(v)):(u.delete(v),S=2),this.onFileChange({resource:B(a,v),type:S,cId:this.request.correlationId})},n.FILE_DELETE_HANDLER_DELAY);f.set(v,te(()=>clearTimeout(y)))}else{let y;u.has(v)?y=0:(y=1,u.add(v)),this.onFileChange({resource:B(a,v),type:y,cId:this.request.correlationId})}else if(p==="rename"||v!==l){let y=setTimeout(async()=>{let I=await se.exists(e);o.token.isCancellationRequested||(I?(this.onFileChange({resource:a,type:0,cId:this.request.correlationId},!0),s.add(await this.doWatch(e,!1))):this.onWatchedPathDeleted(a))},n.FILE_DELETE_HANDLER_DELAY);s.clear(),s.add(te(()=>clearTimeout(y)))}else this.onFileChange({resource:a,type:0,cId:this.request.correlationId},!0)})}catch(a){o.token.isCancellationRequested||this.error(`Failed to watch ${e} for changes using fs.watch() (${a.toString()})`),this.notifyWatchFailed()}}onWatchedPathDeleted(e){this.warn("Watcher shutdown because watched path got deleted"),this.onFileChange({resource:e,type:2,cId:this.request.correlationId},!0),this.fileChangesAggregator.flush(),this.notifyWatchFailed()}onFileChange(e,r=!1){this.cts.token.isCancellationRequested||(this.verboseLogging&&this.traceWithCorrelation(`${e.type===1?"[ADDED]":e.type===2?"[DELETED]":"[CHANGED]"} ${e.resource.fsPath}`),!r&&this.excludes.some(i=>i(e.resource.fsPath))?this.verboseLogging&&this.traceWithCorrelation(` >> ignored (excluded) ${e.resource.fsPath}`):!r&&this.includes&&this.includes.length>0&&!this.includes.some(i=>i(e.resource.fsPath))?this.verboseLogging&&this.traceWithCorrelation(` >> ignored (not included) ${e.resource.fsPath}`):this.fileChangesAggregator.work(e))}handleFileChanges(e){let r=Tm(e),i=[];for(let s of r){if(Pm(s,this.filter)){this.verboseLogging&&this.traceWithCorrelation(` >> ignored (filtered) ${s.resource.fsPath}`);continue}i.push(s)}if(i.length===0)return;if(this.verboseLogging)for(let s of i)this.traceWithCorrelation(` >> normalized ${s.type===1?"[ADDED]":s.type===2?"[DELETED]":"[CHANGED]"} ${s.resource.fsPath}`);this.throttledFileChangesEmitter.work(i)?this.throttledFileChangesEmitter.pending>0&&this.trace(`started throttling events due to large amount of file change events at once (pending: ${this.throttledFileChangesEmitter.pending}, most recent change: ${i[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`):this.warn(`started ignoring events due to too many file change events at once (incoming: ${i.length}, most recent change: ${i[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`)}async existsChildStrictCase(e){if(Se)return se.exists(e);try{let r=je(e);return(await se.readdir(lt(e))).some(o=>o===r)}catch(r){return this.trace(r),!1}}setVerboseLogging(e){this.verboseLogging=e}error(e){this.cts.token.isCancellationRequested||this.onLogMessage?.({type:"error",message:`[File Watcher (node.js)] ${e}`})}warn(e){this.cts.token.isCancellationRequested||this.onLogMessage?.({type:"warn",message:`[File Watcher (node.js)] ${e}`})}trace(e){!this.cts.token.isCancellationRequested&&this.verboseLogging&&this.onLogMessage?.({type:"trace",message:`[File Watcher (node.js)] ${e}`})}traceWithCorrelation(e){!this.cts.token.isCancellationRequested&&this.verboseLogging&&this.trace(`${e}${typeof this.request.correlationId=="number"?` <${this.request.correlationId}> `:""}`)}dispose(){this.cts.dispose(!0),super.dispose()}};var nc=class extends Zl{constructor(e){super();this.recursiveWatcher=e}onDidError=Z.None;watchers=new Set;async doWatch(e){e=this.removeDuplicateRequests(e);let r=[],i=new Set(Array.from(this.watchers));for(let o of e){let s=this.findWatcher(o);s&&ku(s.request.excludes,o.excludes)&&ku(s.request.includes,o.includes)?i.delete(s):r.push(o)}r.length&&this.trace(`Request to start watching: ${r.map(o=>this.requestToString(o)).join(",")}`),i.size&&this.trace(`Request to stop watching: ${Array.from(i).map(o=>this.requestToString(o.request)).join(",")}`);for(let o of i)this.stopWatching(o);for(let o of r)this.startWatching(o)}findWatcher(e){for(let r of this.watchers)if(typeof e.correlationId=="number"||typeof r.request.correlationId=="number"){if(r.request.correlationId===e.correlationId)return r}else if(Lo(r.request.path,e.path,!Se))return r}startWatching(e){let r=new tc(e,this.recursiveWatcher,o=>this._onDidChangeFile.fire(o),()=>this._onDidWatchFail.fire(e),o=>this._onDidLogMessage.fire(o),this.verboseLogging),i={request:e,instance:r};this.watchers.add(i)}async stop(){await super.stop();for(let e of this.watchers)this.stopWatching(e)}stopWatching(e){this.trace("stopping file watcher",e),this.watchers.delete(e),e.instance.dispose()}removeDuplicateRequests(e){let r=new Map;for(let i of e){let o=Se?i.path:i.path.toLowerCase(),s=r.get(i.correlationId);s||(s=new Map,r.set(i.correlationId,s)),s.has(o)&&this.trace(`ignoring a request for watching who's path is already watched: ${this.requestToString(i)}`),s.set(o,i)}return Array.from(r.values()).map(i=>Array.from(i.values())).flat()}async setVerboseLogging(e){super.setVerboseLogging(e);for(let r of this.watchers)r.instance.setVerboseLogging(e)}trace(e,r){this.verboseLogging&&this._onDidLogMessage.fire({type:"trace",message:this.toMessage(e,r)})}warn(e){this._onDidLogMessage.fire({type:"warn",message:this.toMessage(e)})}toMessage(e,r){return r?`[File Watcher (node.js)] ${e} (${this.requestToString(r.request)})`:`[File Watcher (node.js)] ${e}`}};var rc=class extends Gl{constructor(t,e,r){super(t,e,r),this.init()}createWatcher(t){return t.add(new nc(void 0))}};var ic=class n extends Jl{static TRACE_LOG_RESOURCE_LOCKS=!1;constructor(t,e){super(t,e)}onDidChangeCapabilities=Z.None;_capabilities;get capabilities(){return this._capabilities||(this._capabilities=253982,Se&&(this._capabilities|=1024)),this._capabilities}async stat(t){try{let{stat:e,symbolicLink:r}=await Et.stat(this.toFilePath(t));return{type:this.toType(e,r),ctime:e.birthtime.getTime(),mtime:e.mtime.getTime(),size:e.size,permissions:e.mode&128?void 0:2}}catch(e){throw this.toFileSystemProviderError(e)}}async statIgnoreError(t){try{return await this.stat(t)}catch{return}}async readdir(t){try{let e=await se.readdir(this.toFilePath(t),{withFileTypes:!0}),r=[];return await Promise.all(e.map(async i=>{try{let o;i.isSymbolicLink()?o=(await this.stat(B(t,i.name))).type:o=this.toType(i),r.push([i.name,o])}catch(o){this.logService.trace(o)}})),r}catch(e){throw this.toFileSystemProviderError(e)}}toType(t,e){let r;return e?.dangling?r=0:t.isFile()?r=1:t.isDirectory()?r=2:r=0,e&&(r|=64),r}resourceLocks=new ve(t=>Fr.getComparisonKey(t));async createResourceLock(t){let e=this.toFilePath(t);this.traceLock(`[Disk FileSystemProvider]: createResourceLock() - request to acquire resource lock (${e})`);let r;for(;r=this.resourceLocks.get(t);)this.traceLock(`[Disk FileSystemProvider]: createResourceLock() - waiting for resource lock to be released (${e})`),await r.wait();let i=new yi;return this.resourceLocks.set(t,i),this.traceLock(`[Disk FileSystemProvider]: createResourceLock() - new resource lock created (${e})`),te(()=>{this.traceLock(`[Disk FileSystemProvider]: createResourceLock() - resource lock dispose() (${e})`),this.resourceLocks.get(t)===i&&(this.traceLock(`[Disk FileSystemProvider]: createResourceLock() - resource lock removed from resource-lock map (${e})`),this.resourceLocks.delete(t)),this.traceLock(`[Disk FileSystemProvider]: createResourceLock() - resource lock barrier open() (${e})`),i.open()})}async readFile(t,e){let r;try{e?.atomic&&(this.traceLock(`[Disk FileSystemProvider]: atomic read operation started (${this.toFilePath(t)})`),r=await this.createResourceLock(t));let i=this.toFilePath(t);return await xr.readFile(i)}catch(i){throw this.toFileSystemProviderError(i)}finally{r?.dispose()}}traceLock(t){n.TRACE_LOG_RESOURCE_LOCKS&&this.logService.trace(t)}readFileStream(t,e,r){let i=Vr(o=>W.concat(o.map(s=>W.wrap(s))).buffer);return zl(this,t,i,o=>o.buffer,{...e,bufferSize:256*1024},r),i}async writeFile(t,e,r){return r?.atomic!==!1&&r?.atomic?.postfix&&await this.canWriteFileAtomic(t)?this.doWriteFileAtomic(t,B(up(t),`${_n(t)}${r.atomic.postfix}`),e,r):this.doWriteFile(t,e,r)}async canWriteFileAtomic(t){try{let e=this.toFilePath(t),{symbolicLink:r}=await Et.stat(e);if(r)return!1}catch{}return!0}async doWriteFileAtomic(t,e,r,i){let o=new Ee;try{o.add(await this.createResourceLock(t)),o.add(await this.createResourceLock(e)),await this.doWriteFile(e,r,i,!0);try{await this.rename(e,t,{overwrite:!0})}catch(s){try{await this.delete(e,{recursive:!1,useTrash:!1,atomic:!1})}catch{}throw s}}finally{o.dispose()}}async doWriteFile(t,e,r,i){let o;try{let s=this.toFilePath(t);if(!r.create||!r.overwrite){if(await se.exists(s)){if(!r.overwrite)throw hn(g("fileExists","File already exists"),"EntryExists")}else if(!r.create)throw hn(g("fileNotExists","File does not exist"),"EntryNotFound")}o=await this.open(t,{create:!0,unlock:r.unlock},i),await this.write(o,0,e,0,e.byteLength)}catch(s){throw await this.toFileSystemProviderWriteError(t,s)}finally{typeof o=="number"&&await this.close(o)}}mapHandleToPos=new Map;mapHandleToLock=new Map;writeHandles=new Map;static canFlush=!0;static configureFlushOnWrite(t){n.canFlush=t}async open(t,e,r){let i=this.toFilePath(t),o;Di(e)&&!r&&(o=await this.createResourceLock(t));let s;try{if(Di(e)&&e.unlock)try{let{stat:l}=await Et.stat(i);l.mode&128||await xr.chmod(i,l.mode|128)}catch(l){l.code!=="ENOENT"&&this.logService.trace(l)}let a;if(Di(e)){if(ue)try{await xr.truncate(i,0),a="r+"}catch(l){l.code!=="ENOENT"&&this.logService.trace(l)}a||(a="w")}else a="r";s=await se.open(i,a)}catch(a){throw o?.dispose(),Di(e)?await this.toFileSystemProviderWriteError(t,a):this.toFileSystemProviderError(a)}if(this.mapHandleToPos.set(s,0),Di(e)&&this.writeHandles.set(s,t),o){let a=this.mapHandleToLock.get(s);this.traceLock(`[Disk FileSystemProvider]: open() - storing lock for handle ${s} (${i})`),this.mapHandleToLock.set(s,o),a&&(this.traceLock(`[Disk FileSystemProvider]: open() - disposing a previous lock that was still stored on same handle ${s} (${i})`),a.dispose())}return s}async close(t){let e=this.mapHandleToLock.get(t);try{if(this.mapHandleToPos.delete(t),this.writeHandles.delete(t)&&n.canFlush)try{await se.fdatasync(t)}catch(r){n.configureFlushOnWrite(!1),this.logService.error(r)}return await se.close(t)}catch(r){throw this.toFileSystemProviderError(r)}finally{e&&(this.mapHandleToLock.get(t)===e&&(this.traceLock(`[Disk FileSystemProvider]: close() - resource lock removed from handle-lock map ${t}`),this.mapHandleToLock.delete(t)),this.traceLock(`[Disk FileSystemProvider]: close() - disposing lock for handle ${t}`),e.dispose())}}async read(t,e,r,i,o){let s=this.normalizePos(t,e),a=null;try{a=(await se.read(t,r,i,o,s)).bytesRead}catch(l){throw this.toFileSystemProviderError(l)}finally{this.updatePos(t,s,a)}return a}normalizePos(t,e){return e===this.mapHandleToPos.get(t)?null:e}updatePos(t,e,r){let i=this.mapHandleToPos.get(t);typeof i=="number"&&(typeof e=="number"||(typeof r=="number"?this.mapHandleToPos.set(t,i+r):this.mapHandleToPos.delete(t)))}async write(t,e,r,i,o){return Rp(()=>this.doWrite(t,e,r,i,o),100,3)}async doWrite(t,e,r,i,o){let s=this.normalizePos(t,e),a=null;try{a=(await se.write(t,r,i,o,s)).bytesWritten}catch(l){throw await this.toFileSystemProviderWriteError(this.writeHandles.get(t),l)}finally{this.updatePos(t,s,a)}return a}async mkdir(t){try{await xr.mkdir(this.toFilePath(t))}catch(e){throw this.toFileSystemProviderError(e)}}async delete(t,e){try{let r=this.toFilePath(t);if(e.recursive){let i;e?.atomic!==!1&&e.atomic.postfix&&(i=V(lt(r),`${je(r)}${e.atomic.postfix}`)),await se.rm(r,1,i)}else try{await xr.unlink(r)}catch(i){if(i.code==="EPERM"||i.code==="EISDIR"){let o=!1;try{let{stat:s,symbolicLink:a}=await Et.stat(r);o=s.isDirectory()&&!a}catch{}if(o)await xr.rmdir(r);else throw i}else throw i}}catch(r){throw this.toFileSystemProviderError(r)}}async rename(t,e,r){let i=this.toFilePath(t),o=this.toFilePath(e);if(i!==o)try{await this.validateMoveCopy(t,e,"move",r.overwrite),await se.rename(i,o)}catch(s){throw(s.code==="EINVAL"||s.code==="EBUSY"||s.code==="ENAMETOOLONG")&&(s=new Error(g("moveError","Unable to move '{0}' into '{1}' ({2}).",je(i),je(lt(o)),s.toString()))),this.toFileSystemProviderError(s)}}async copy(t,e,r){let i=this.toFilePath(t),o=this.toFilePath(e);if(i!==o)try{await this.validateMoveCopy(t,e,"copy",r.overwrite),await se.copy(i,o,{preserveSymlinks:!0})}catch(s){throw(s.code==="EINVAL"||s.code==="EBUSY"||s.code==="ENAMETOOLONG")&&(s=new Error(g("copyError","Unable to copy '{0}' into '{1}' ({2}).",je(i),je(lt(o)),s.toString()))),this.toFileSystemProviderError(s)}}async validateMoveCopy(t,e,r,i){let o=this.toFilePath(t),s=this.toFilePath(e),a=!1;if(!!(this.capabilities&1024)||(a=Lo(o,s,!0)),a){if(r==="copy")throw hn(g("fileCopyErrorPathCase","File cannot be copied to same path with different path case"),"EntryExists");if(r==="move")return}let c=await this.statIgnoreError(t);if(!c)throw hn(g("fileMoveCopyErrorNotFound","File to move/copy does not exist"),"EntryNotFound");let u=await this.statIgnoreError(e);if(u){if(!i)throw hn(g("fileMoveCopyErrorExists","File at target already exists and thus will not be moved/copied to unless overwrite is specified"),"EntryExists");c.type&1&&u.type&1||await this.delete(e,{recursive:!0,useTrash:!1,atomic:!1})}}async cloneFile(t,e){return this.doCloneFile(t,e,!1)}async doCloneFile(t,e,r){let i=this.toFilePath(t),o=this.toFilePath(e),s=!!(this.capabilities&1024);if(Lo(i,o,!s))return;let a=new Ee;try{a.add(await this.createResourceLock(t)),a.add(await this.createResourceLock(e)),r&&await xr.mkdir(lt(o),{recursive:!0}),await xr.copyFile(i,o)}catch(l){if(l.code==="ENOENT"&&!r)return this.doCloneFile(t,e,!0);throw this.toFileSystemProviderError(l)}finally{a.dispose()}}createUniversalWatcher(t,e,r){return new Yl(i=>t(i),i=>e(i),r)}createNonRecursiveWatcher(t,e,r){return new rc(i=>t(i),i=>e(i),r)}toFileSystemProviderError(t){if(t instanceof _i)return t;let e=t,r;switch(t.code){case"ENOENT":r="EntryNotFound";break;case"EISDIR":r="EntryIsADirectory";break;case"ENOTDIR":r="EntryNotADirectory";break;case"EEXIST":r="EntryExists";break;case"EPERM":case"EACCES":r="NoPermissions";break;case"ERR_UNC_HOST_NOT_ALLOWED":e=`${t.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`,r="Unknown";break;default:r="Unknown"}return hn(e,r)}async toFileSystemProviderWriteError(t,e){let r=this.toFileSystemProviderError(e);if(t&&r.code==="NoPermissions")try{let{stat:i}=await Et.stat(this.toFilePath(t));i.mode&128||(r=hn(e,"EntryWriteLocked"))}catch(i){this.logService.trace(i)}return r}};import{homedir as Px,tmpdir as _x}from"os";var xx=60,Ex=xx*60,Md=Ex*24,mq=Md*7,yq=Md*30,vq=Md*365;function Am(n){return n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0")+"T"+String(n.getHours()).padStart(2,"0")+":"+String(n.getMinutes()).padStart(2,"0")+":"+String(n.getSeconds()).padStart(2,"0")+"."+(n.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var Fm=/^([^.]+\..+)[:=](.+)$/,fe=class{constructor(t,e,r){this._args=t;this.paths=e;this.productService=r}get appRoot(){return lt(fn.asFileUri("").fsPath)}get userHome(){return P.file(this.paths.homeDir)}get userDataPath(){return this.paths.userDataDir}get appSettingsHome(){return P.file(V(this.userDataPath,"User"))}get tmpDir(){return P.file(this.paths.tmpDir)}get cacheHome(){return P.file(this.userDataPath)}get stateResource(){return B(this.appSettingsHome,"globalStorage","storage.json")}get userRoamingDataHome(){return this.appSettingsHome.with({scheme:Q.vscodeUserData})}get userDataSyncHome(){return B(this.appSettingsHome,"sync")}get logsHome(){if(!this.args.logsPath){let t=Am(new Date).replace(/-|:|\.\d+Z$/g,"");this.args.logsPath=V(this.userDataPath,"logs",t)}return P.file(this.args.logsPath)}get sync(){return this.args.sync}get machineSettingsResource(){return B(P.file(V(this.userDataPath,"Machine")),"settings.json")}get workspaceStorageHome(){return B(this.appSettingsHome,"workspaceStorage")}get localHistoryHome(){return B(this.appSettingsHome,"History")}get keyboardLayoutResource(){return B(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){let t=It.VSCODE_PORTABLE;return t?P.file(V(t,"argv.json")):B(this.userHome,this.productService.dataFolderName,"argv.json")}get isExtensionDevelopment(){return!!this.args.extensionDevelopmentPath}get untitledWorkspacesHome(){return P.file(V(this.userDataPath,"Workspaces"))}get builtinExtensionsPath(){let t=this.args["builtin-extensions-dir"];return t?Tn(t):Wt(V(fn.asFileUri("").fsPath,"..","extensions"))}get extensionsDownloadLocation(){let t=this.args["extensions-download-dir"];return t?P.file(Tn(t)):P.file(V(this.userDataPath,"CachedExtensionVSIXs"))}get extensionsPath(){let t=this.args["extensions-dir"];if(t)return Tn(t);let e=It.VSCODE_EXTENSIONS;if(e)return e;let r=It.VSCODE_PORTABLE;return r?V(r,"extensions"):B(this.userHome,this.productService.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){let t=this.args.extensionDevelopmentPath;if(Array.isArray(t))return t.map(e=>/^[^:/?#]+?:\/\//.test(e)?P.parse(e):P.file(Wt(e)))}get extensionDevelopmentKind(){return this.args.extensionDevelopmentKind?.map(t=>t==="ui"||t==="workspace"||t==="web"?t:"workspace")}get extensionTestsLocationURI(){let t=this.args.extensionTestsPath;if(t)return/^[^:/?#]+?:\/\//.test(t)?P.parse(t):P.file(Wt(t))}get disableExtensions(){if(this.args["disable-extensions"])return!0;let t=this.args["disable-extension"];if(t){if(typeof t=="string")return[t];if(Array.isArray(t)&&t.length>0)return t}return!1}get debugExtensionHost(){return Sx(this.args,this.isBuilt)}get debugRenderer(){return!!this.args.debugRenderer}get isBuilt(){return!It.VSCODE_DEV}get verbose(){return!!this.args.verbose}get logLevel(){return this.args.log?.find(t=>!Fm.test(t))}get extensionLogLevel(){let t=[];for(let e of this.args.log||[]){let r=Fm.exec(e);r&&r[1]&&r[2]&&t.push([r[1],r[2]])}return t.length?t:void 0}get serviceMachineIdResource(){return B(P.file(this.userDataPath),"machineid")}get crashReporterId(){return this.args["crash-reporter-id"]}get crashReporterDirectory(){return this.args["crash-reporter-directory"]}get disableTelemetry(){return!!this.args["disable-telemetry"]}get disableWorkspaceTrust(){return!!this.args["disable-workspace-trust"]}get useInMemorySecretStorage(){return!!this.args["use-inmemory-secretstorage"]}get policyFile(){if(this.args["__enable-file-policy"]){let t=It.VSCODE_PORTABLE;return t?P.file(V(t,"policy.json")):B(this.userHome,this.productService.dataFolderName,"policy.json")}}editSessionId=this.args.editSessionId;get continueOn(){return this.args.continueOn}set continueOn(t){this.args.continueOn=t}get args(){return this._args}};D([de],fe.prototype,"appRoot",1),D([de],fe.prototype,"userHome",1),D([de],fe.prototype,"userDataPath",1),D([de],fe.prototype,"appSettingsHome",1),D([de],fe.prototype,"tmpDir",1),D([de],fe.prototype,"cacheHome",1),D([de],fe.prototype,"stateResource",1),D([de],fe.prototype,"userRoamingDataHome",1),D([de],fe.prototype,"userDataSyncHome",1),D([de],fe.prototype,"sync",1),D([de],fe.prototype,"machineSettingsResource",1),D([de],fe.prototype,"workspaceStorageHome",1),D([de],fe.prototype,"localHistoryHome",1),D([de],fe.prototype,"keyboardLayoutResource",1),D([de],fe.prototype,"argvResource",1),D([de],fe.prototype,"isExtensionDevelopment",1),D([de],fe.prototype,"untitledWorkspacesHome",1),D([de],fe.prototype,"builtinExtensionsPath",1),D([de],fe.prototype,"extensionsPath",1),D([de],fe.prototype,"extensionDevelopmentLocationURI",1),D([de],fe.prototype,"extensionDevelopmentKind",1),D([de],fe.prototype,"extensionTestsLocationURI",1),D([de],fe.prototype,"debugExtensionHost",1),D([de],fe.prototype,"logLevel",1),D([de],fe.prototype,"extensionLogLevel",1),D([de],fe.prototype,"serviceMachineIdResource",1),D([de],fe.prototype,"disableTelemetry",1),D([de],fe.prototype,"disableWorkspaceTrust",1),D([de],fe.prototype,"useInMemorySecretStorage",1),D([de],fe.prototype,"policyFile",1);function Sx(n,t){return Lm(n["inspect-extensions"],n["inspect-brk-extensions"],5870,t,n.debugId,n.extensionEnvironment)}function Lm(n,t,e,r,i,o){let a=Number(t||n)||(r?null:e),l=a?!!t:!1,c;if(o)try{c=JSON.parse(o)}catch{}return{port:a,break:l,debugId:i,env:c}}import*as wx from"os";import*as Tx from"path";var oc={exports:{}};(function(){function t(e,r,i){function o(a,l){let c=s(a,l),u=[c];return e.isAbsolute(c)||u.unshift(i),e.resolve(...u)}function s(a,l){process.env.VSCODE_DEV&&(l="code-oss-dev");let c=process.env.VSCODE_PORTABLE;if(c)return e.join(c,"user-data");let u=process.env.VSCODE_APPDATA;if(u)return e.join(u,l);let f=a["user-data-dir"];if(f)return f;switch(process.platform){case"win32":if(u=process.env.APPDATA,!u){let p=process.env.USERPROFILE;if(typeof p!="string")throw new Error("Windows: Unexpected undefined %USERPROFILE% environment variable");u=e.join(p,"AppData","Roaming")}break;case"darwin":u=e.join(r.homedir(),"Library","Application Support");break;case"linux":u=process.env.XDG_CONFIG_HOME||e.join(r.homedir(),".config");break;default:throw new Error("Platform not supported")}return e.join(u,l)}return{getUserDataPath:o}}if(typeof oc=="object"&&typeof oc.exports=="object")oc.exports=t(Tx,wx,process.env.VSCODE_CWD||process.cwd());else throw new Error("Unknown context")})();var Um=oc.exports.getUserDataPath;var sc=class extends fe{constructor(t,e){super(t,{homeDir:Px(),tmpDir:_x(),userDataDir:Um(t,e.nameShort)},e)}};var Zq={host:{type:"string",cat:"o",args:"ip-address",description:g("host","The host name or IP address the server should listen to. If not set, defaults to 'localhost'.")},port:{type:"string",cat:"o",args:"port | port range",description:g("port","The port the server should listen to. If 0 is passed a random free port is picked. If a range in the format num-num is passed, a free port from the range (end inclusive) is selected.")},"socket-path":{type:"string",cat:"o",args:"path",description:g("socket-path","The path to a socket file for the server to listen to.")},"server-base-path":{type:"string",cat:"o",args:"path",description:g("server-base-path","The path under which the web UI and the code server is provided. Defaults to '/'.`")},"connection-token":{type:"string",cat:"o",args:"token",deprecates:["connectionToken"],description:g("connection-token","A secret that must be included with all requests.")},"connection-token-file":{type:"string",cat:"o",args:"path",deprecates:["connection-secret","connectionTokenFile"],description:g("connection-token-file","Path to a file that contains the connection token.")},"without-connection-token":{type:"boolean",cat:"o",description:g("without-connection-token","Run without a connection token. Only use this if the connection is secured by other means.")},"disable-websocket-compression":{type:"boolean"},"print-startup-performance":{type:"boolean"},"print-ip-address":{type:"boolean"},"accept-server-license-terms":{type:"boolean",cat:"o",description:g("acceptLicenseTerms","If set, the user accepts the server license terms and the server will be started without a user prompt.")},"server-data-dir":{type:"string",cat:"o",description:g("serverDataDir","Specifies the directory that server data is kept in.")},"telemetry-level":{type:"string",cat:"o",args:"level",description:g("telemetry-level","Sets the initial telemetry level. Valid levels are: 'off', 'crash', 'error' and 'all'. If not specified, the server will send telemetry until a client connects, it will then use the clients telemetry setting. Setting this to 'off' is equivalent to --disable-telemetry")},"user-data-dir":Te["user-data-dir"],"enable-smoke-test-driver":Te["enable-smoke-test-driver"],"disable-telemetry":Te["disable-telemetry"],"disable-workspace-trust":Te["disable-workspace-trust"],"file-watcher-polling":{type:"string",deprecates:["fileWatcherPolling"]},log:Te.log,logsPath:Te.logsPath,"force-disable-user-env":Te["force-disable-user-env"],folder:{type:"string",deprecationMessage:"No longer supported. Folder needs to be provided in the browser URL or with `default-folder`."},workspace:{type:"string",deprecationMessage:"No longer supported. Workspace needs to be provided in the browser URL or with `default-workspace`."},"default-folder":{type:"string",description:g("default-folder","The workspace folder to open when no input is specified in the browser URL. A relative or absolute path resolved against the current working directory.")},"default-workspace":{type:"string",description:g("default-workspace","The workspace to open when no input is specified in the browser URL. A relative or absolute path resolved against the current working directory.")},"enable-sync":{type:"boolean"},"github-auth":{type:"string"},"use-test-resolver":{type:"boolean"},"extensions-dir":Te["extensions-dir"],"extensions-download-dir":Te["extensions-download-dir"],"builtin-extensions-dir":Te["builtin-extensions-dir"],"install-extension":Te["install-extension"],"install-builtin-extension":Te["install-builtin-extension"],"update-extensions":Te["update-extensions"],"uninstall-extension":Te["uninstall-extension"],"list-extensions":Te["list-extensions"],"locate-extension":Te["locate-extension"],"show-versions":Te["show-versions"],category:Te.category,force:Te.force,"do-not-sync":Te["do-not-sync"],"pre-release":Te["pre-release"],"start-server":{type:"boolean",cat:"e",description:g("start-server","Start the server when installing or uninstalling extensions. To be used in combination with 'install-extension', 'install-builtin-extension' and 'uninstall-extension'.")},"enable-remote-auto-shutdown":{type:"boolean"},"remote-auto-shutdown-without-delay":{type:"boolean"},"use-host-proxy":{type:"boolean"},"without-browser-env-var":{type:"boolean"},help:Te.help,version:Te.version,"locate-shell-integration-path":Te["locate-shell-integration-path"],compatibility:{type:"string"},_:Te._},Nm=xt,Es=class extends sc{get userRoamingDataHome(){return this.appSettingsHome}get args(){return super.args}};D([de],Es.prototype,"userRoamingDataHome",1);var Rx=n=>g("notFound","Extension '{0}' not found.",n),Mm=g("useId","Make sure you use the full extension ID, including the publisher, e.g.: {0}","ms-dotnettools.csharp"),ao=class{constructor(t,e,r){this.logger=t;this.extensionManagementService=e;this.extensionGalleryService=r}get location(){}async listExtensions(t,e,r){let i=await this.extensionManagementService.getInstalled(1,r),o=kh.map(a=>a.toLowerCase());if(e&&e!==""){if(o.indexOf(e.toLowerCase())<0){this.logger.info("Invalid category please enter a valid category. To list valid categories run --category without a category specified");return}i=i.filter(a=>a.manifest.categories?a.manifest.categories.map(c=>c.toLowerCase()).indexOf(e.toLowerCase())>-1:!1)}else if(e===""){this.logger.info("Possible Categories: "),o.forEach(a=>{this.logger.info(a)});return}this.location&&this.logger.info(g("listFromLocation","Extensions installed on {0}:",this.location)),i=i.sort((a,l)=>a.identifier.id.localeCompare(l.identifier.id));let s;for(let a of i)s!==a.identifier.id&&(s=a.identifier.id,this.logger.info(t?`${s}@${a.manifest.version}`:s))}async installExtensions(t,e,r,i){let o=[];try{t.length&&this.logger.info(this.location?g("installingExtensionsOnLocation","Installing extensions on {0}...",this.location):g("installingExtensions","Installing extensions..."));let s=[],a=[],l=(u,f,p)=>{a.push({id:u,version:f!=="prerelease"?f:void 0,installOptions:{...r,isBuiltin:p,installPreReleaseVersion:f==="prerelease"||r.installPreReleaseVersion}})};for(let u of t)if(u instanceof P)s.push({vsix:u,installOptions:r});else{let[f,p]=cs(u);l(f,p,!1)}for(let u of e)if(u instanceof P)s.push({vsix:u,installOptions:{...r,isBuiltin:!0,donotIncludePackAndDependencies:!0}});else{let[f,p]=cs(u);l(f,p,!0)}let c=await this.extensionManagementService.getInstalled(void 0,r.profileLocation);if(s.length&&await Promise.all(s.map(async({vsix:u,installOptions:f})=>{try{await this.installVSIX(u,f,i,c)}catch(p){this.logger.error(p),o.push(u.toString())}})),a.length){let u=await this.installGalleryExtensions(a,c,i);o.push(...u)}}catch(s){throw this.logger.error(g("error while installing extensions","Error while installing extensions: {0}",G(s))),s}if(o.length)throw new Error(g("installation failed","Failed Installing Extensions: {0}",o.join(", ")))}async updateExtensions(t){let e=await this.extensionManagementService.getInstalled(1,t),r=[];for(let a of e)a.identifier.uuid&&r.push({...a.identifier,preRelease:a.preRelease});this.logger.trace(g({key:"updateExtensionsQuery",comment:["Placeholder is for the count of extensions"]},"Fetching latest versions for {0} extensions",r.length));let i=await this.extensionGalleryService.getExtensions(r,{compatible:!0},ce.None),o=[];for(let a of i)for(let l of e)X(l.identifier,a.identifier)&&ds(a.version,l.manifest.version)&&o.push({extension:a,options:{operation:3,installPreReleaseVersion:l.preRelease,profileLocation:t,isApplicationScoped:l.isApplicationScoped}});if(!o.length){this.logger.info(g("updateExtensionsNoExtensions","No extension to update"));return}this.logger.info(g("updateExtensionsNewVersionsAvailable","Updating extensions: {0}",o.map(a=>a.extension.identifier.id).join(", ")));let s=await this.extensionManagementService.installGalleryExtensions(o);for(let a of s)a.error?this.logger.error(g("errorUpdatingExtension","Error while updating extension {0}: {1}",a.identifier.id,G(a.error))):this.logger.info(g("successUpdate","Extension '{0}' v{1} was successfully updated.",a.identifier.id,a.local?.manifest.version))}async installGalleryExtensions(t,e,r){if(t=t.filter(({id:a,version:l})=>{let c=e.find(u=>X(u.identifier,{id:a}));if(c){if(!r&&(!l||l==="prerelease"&&c.preRelease))return this.logger.info(g("alreadyInstalled-checkAndUpdate","Extension '{0}' v{1} is already installed. Use '--force' option to update to latest version or provide '@<version>' to install a specific version, for example: '{2}@1.2.3'.",a,c.manifest.version,a)),!1;if(l&&c.manifest.version===l)return this.logger.info(g("alreadyInstalled","Extension '{0}' is already installed.",`${a}@${l}`)),!1}return!0}),!t.length)return[];let i=[],o=[],s=await this.getGalleryExtensions(t);if(await Promise.all(t.map(async({id:a,version:l,installOptions:c})=>{let u=s.get(a.toLowerCase());if(!u){this.logger.error(`${Rx(l?`${a}@${l}`:a)}
${Mm}`),i.push(a);return}try{let p=await this.extensionGalleryService.getManifest(u,ce.None);if(p&&!this.validateExtensionKind(p))return}catch(p){this.logger.error(p.message||p.stack||p),i.push(a);return}let f=e.find(p=>X(p.identifier,u.identifier));if(f){if(u.version===f.manifest.version){this.logger.info(g("alreadyInstalled","Extension '{0}' is already installed.",l?`${a}@${l}`:a));return}this.logger.info(g("updateMessage","Updating the extension '{0}' to the version {1}",a,u.version))}c.isBuiltin?this.logger.info(l?g("installing builtin with version","Installing builtin extension '{0}' v{1}...",a,l):g("installing builtin ","Installing builtin extension '{0}'...",a)):this.logger.info(l?g("installing with version","Installing extension '{0}' v{1}...",a,l):g("installing","Installing extension '{0}'...",a)),o.push({extension:u,options:{...c,installGivenVersion:!!l,isApplicationScoped:c.isApplicationScoped||f?.isApplicationScoped}})})),o.length){let a=await this.extensionManagementService.installGalleryExtensions(o);for(let l of a)l.error?(this.logger.error(g("errorInstallingExtension","Error while installing extension {0}: {1}",l.identifier.id,G(l.error))),i.push(l.identifier.id)):this.logger.info(g("successInstall","Extension '{0}' v{1} was successfully installed.",l.identifier.id,l.local?.manifest.version))}return i}async installVSIX(t,e,r,i){let o=await this.extensionManagementService.getManifest(t);if(!o)throw new Error("Invalid vsix");if(await this.validateVSIX(o,r,e.profileLocation,i))try{await this.extensionManagementService.install(t,{...e,installGivenVersion:!0}),this.logger.info(g("successVsixInstall","Extension '{0}' was successfully installed.",_n(t)))}catch(a){if(xn(a))this.logger.info(g("cancelVsixInstall","Cancelled installing extension '{0}'.",_n(t)));else throw a}}async getGalleryExtensions(t){let e=new Map,r=t.some(s=>s.installOptions.installPreReleaseVersion),i=await this.extensionManagementService.getTargetPlatform(),o=[];for(let s of t)Fh.test(s.id)&&o.push({...s,preRelease:r});if(o.length){let s=await this.extensionGalleryService.getExtensions(o,{targetPlatform:i},ce.None);for(let a of s)e.set(a.identifier.id.toLowerCase(),a)}return e}validateExtensionKind(t){return!0}async validateVSIX(t,e,r,i){if(!e){let o={id:kt(t.publisher,t.name)},s=i.find(a=>X(o,a.identifier)&&ds(a.manifest.version,t.version));if(s)return this.logger.info(g("forceDowngrade","A newer version of extension '{0}' v{1} is already installed. Use '--force' option to downgrade to older version.",s.identifier.id,s.manifest.version,t.version)),!1}return this.validateExtensionKind(t)}async uninstallExtensions(t,e,r){let i=async s=>{if(s instanceof P){let a=await this.extensionManagementService.getManifest(s);return wl(a.publisher,a.name)}return s},o=[];for(let s of t){let a=await i(s),c=(await this.extensionManagementService.getInstalled(void 0,r)).filter(u=>X(u.identifier,{id:a}));if(!c.length)throw new Error(`${this.notInstalled(a)}
${Mm}`);if(c.some(u=>u.type===0)){this.logger.info(g("builtin","Extension '{0}' is a Built-in extension and cannot be uninstalled",a));return}if(!e&&c.some(u=>u.isBuiltin)){this.logger.info(g("forceUninstall","Extension '{0}' is marked as a Built-in extension by user. Please use '--force' option to uninstall it.",a));return}this.logger.info(g("uninstalling","Uninstalling {0}...",a));for(let u of c)await this.extensionManagementService.uninstall(u,{profileLocation:r}),o.push(u);this.location?this.logger.info(g("successUninstallFromLocation","Extension '{0}' was successfully uninstalled from {1}!",a,this.location)):this.logger.info(g("successUninstall","Extension '{0}' was successfully uninstalled!",a))}}async locateExtension(t){let e=await this.extensionManagementService.getInstalled();t.forEach(r=>{e.forEach(i=>{if(i.identifier.id===r&&i.location.scheme===Q.file){this.logger.info(i.location.fsPath);return}})})}notInstalled(t){return this.location?g("notInstalleddOnLocation","Extension '{0}' is not installed on {1}.",t,this.location):g("notInstalled","Extension '{0}' is not installed.",t)}};ao=D([b(1,qi),b(2,St)],ao);var Cx={Quickaccess:"workbench.contributions.quickaccess"},Vd=class{providers=[];defaultProvider=void 0;registerQuickAccessProvider(t){return t.prefix.length===0?this.defaultProvider=t:this.providers.push(t),this.providers.sort((e,r)=>r.prefix.length-e.prefix.length),te(()=>{this.providers.splice(this.providers.indexOf(t),1),this.defaultProvider===t&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return Jt([this.defaultProvider,...this.providers])}getQuickAccessProvider(t){return t&&this.providers.find(r=>t.startsWith(r.prefix))||void 0||this.defaultProvider}clear(){let t=[...this.providers],e=this.defaultProvider;return this.providers=[],this.defaultProvider=void 0,()=>{this.providers=t,this.defaultProvider=e}}};et.add(Cx.Quickaccess,new Vd);var N$=new ht(()=>{let n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:n,collatorIsNumeric:n.resolvedOptions().numeric}}),M$=new ht(()=>({collator:new Intl.Collator(void 0,{numeric:!0})})),V$=new ht(()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})}));var Z$=Object.freeze({score:0}),ez=1<<18,tz=1<<17;var Ss=class{_keyCodeToStr;_strToKeyCode;constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(t,e){this._keyCodeToStr[t]=e,this._strToKeyCode[e.toLowerCase()]=t}keyCodeToStr(t){return this._keyCodeToStr[t]}strToKeyCode(t){return this._strToKeyCode[t.toLowerCase()]||0}},ac=new Ss,Wd=new Ss,Kd=new Ss,Dx=new Array(230),kx={},Ox=[],Ax=Object.create(null),Fx=Object.create(null);var Vm=[],Bd=[];for(let n=0;n<=193;n++)Vm[n]=-1;for(let n=0;n<=132;n++)Bd[n]=-1;(function(){let n="",t=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",n,n],[1,1,"Hyper",0,n,0,n,n,n],[1,2,"Super",0,n,0,n,n,n],[1,3,"Fn",0,n,0,n,n,n],[1,4,"FnLock",0,n,0,n,n,n],[1,5,"Suspend",0,n,0,n,n,n],[1,6,"Resume",0,n,0,n,n,n],[1,7,"Turbo",0,n,0,n,n,n],[1,8,"Sleep",0,n,0,"VK_SLEEP",n,n],[1,9,"WakeUp",0,n,0,n,n,n],[0,10,"KeyA",31,"A",65,"VK_A",n,n],[0,11,"KeyB",32,"B",66,"VK_B",n,n],[0,12,"KeyC",33,"C",67,"VK_C",n,n],[0,13,"KeyD",34,"D",68,"VK_D",n,n],[0,14,"KeyE",35,"E",69,"VK_E",n,n],[0,15,"KeyF",36,"F",70,"VK_F",n,n],[0,16,"KeyG",37,"G",71,"VK_G",n,n],[0,17,"KeyH",38,"H",72,"VK_H",n,n],[0,18,"KeyI",39,"I",73,"VK_I",n,n],[0,19,"KeyJ",40,"J",74,"VK_J",n,n],[0,20,"KeyK",41,"K",75,"VK_K",n,n],[0,21,"KeyL",42,"L",76,"VK_L",n,n],[0,22,"KeyM",43,"M",77,"VK_M",n,n],[0,23,"KeyN",44,"N",78,"VK_N",n,n],[0,24,"KeyO",45,"O",79,"VK_O",n,n],[0,25,"KeyP",46,"P",80,"VK_P",n,n],[0,26,"KeyQ",47,"Q",81,"VK_Q",n,n],[0,27,"KeyR",48,"R",82,"VK_R",n,n],[0,28,"KeyS",49,"S",83,"VK_S",n,n],[0,29,"KeyT",50,"T",84,"VK_T",n,n],[0,30,"KeyU",51,"U",85,"VK_U",n,n],[0,31,"KeyV",52,"V",86,"VK_V",n,n],[0,32,"KeyW",53,"W",87,"VK_W",n,n],[0,33,"KeyX",54,"X",88,"VK_X",n,n],[0,34,"KeyY",55,"Y",89,"VK_Y",n,n],[0,35,"KeyZ",56,"Z",90,"VK_Z",n,n],[0,36,"Digit1",22,"1",49,"VK_1",n,n],[0,37,"Digit2",23,"2",50,"VK_2",n,n],[0,38,"Digit3",24,"3",51,"VK_3",n,n],[0,39,"Digit4",25,"4",52,"VK_4",n,n],[0,40,"Digit5",26,"5",53,"VK_5",n,n],[0,41,"Digit6",27,"6",54,"VK_6",n,n],[0,42,"Digit7",28,"7",55,"VK_7",n,n],[0,43,"Digit8",29,"8",56,"VK_8",n,n],[0,44,"Digit9",30,"9",57,"VK_9",n,n],[0,45,"Digit0",21,"0",48,"VK_0",n,n],[1,46,"Enter",3,"Enter",13,"VK_RETURN",n,n],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",n,n],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",n,n],[1,49,"Tab",2,"Tab",9,"VK_TAB",n,n],[1,50,"Space",10,"Space",32,"VK_SPACE",n,n],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,n,0,n,n,n],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",n,n],[1,64,"F1",59,"F1",112,"VK_F1",n,n],[1,65,"F2",60,"F2",113,"VK_F2",n,n],[1,66,"F3",61,"F3",114,"VK_F3",n,n],[1,67,"F4",62,"F4",115,"VK_F4",n,n],[1,68,"F5",63,"F5",116,"VK_F5",n,n],[1,69,"F6",64,"F6",117,"VK_F6",n,n],[1,70,"F7",65,"F7",118,"VK_F7",n,n],[1,71,"F8",66,"F8",119,"VK_F8",n,n],[1,72,"F9",67,"F9",120,"VK_F9",n,n],[1,73,"F10",68,"F10",121,"VK_F10",n,n],[1,74,"F11",69,"F11",122,"VK_F11",n,n],[1,75,"F12",70,"F12",123,"VK_F12",n,n],[1,76,"PrintScreen",0,n,0,n,n,n],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",n,n],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",n,n],[1,79,"Insert",19,"Insert",45,"VK_INSERT",n,n],[1,80,"Home",14,"Home",36,"VK_HOME",n,n],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",n,n],[1,82,"Delete",20,"Delete",46,"VK_DELETE",n,n],[1,83,"End",13,"End",35,"VK_END",n,n],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",n,n],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",n],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",n],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",n],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",n],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",n,n],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",n,n],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",n,n],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",n,n],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",n,n],[1,94,"NumpadEnter",3,n,0,n,n,n],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",n,n],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",n,n],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",n,n],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",n,n],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",n,n],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",n,n],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",n,n],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",n,n],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",n,n],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",n,n],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",n,n],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",n,n],[1,107,"ContextMenu",58,"ContextMenu",93,n,n,n],[1,108,"Power",0,n,0,n,n,n],[1,109,"NumpadEqual",0,n,0,n,n,n],[1,110,"F13",71,"F13",124,"VK_F13",n,n],[1,111,"F14",72,"F14",125,"VK_F14",n,n],[1,112,"F15",73,"F15",126,"VK_F15",n,n],[1,113,"F16",74,"F16",127,"VK_F16",n,n],[1,114,"F17",75,"F17",128,"VK_F17",n,n],[1,115,"F18",76,"F18",129,"VK_F18",n,n],[1,116,"F19",77,"F19",130,"VK_F19",n,n],[1,117,"F20",78,"F20",131,"VK_F20",n,n],[1,118,"F21",79,"F21",132,"VK_F21",n,n],[1,119,"F22",80,"F22",133,"VK_F22",n,n],[1,120,"F23",81,"F23",134,"VK_F23",n,n],[1,121,"F24",82,"F24",135,"VK_F24",n,n],[1,122,"Open",0,n,0,n,n,n],[1,123,"Help",0,n,0,n,n,n],[1,124,"Select",0,n,0,n,n,n],[1,125,"Again",0,n,0,n,n,n],[1,126,"Undo",0,n,0,n,n,n],[1,127,"Cut",0,n,0,n,n,n],[1,128,"Copy",0,n,0,n,n,n],[1,129,"Paste",0,n,0,n,n,n],[1,130,"Find",0,n,0,n,n,n],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",n,n],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",n,n],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",n,n],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",n,n],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",n,n],[1,136,"KanaMode",0,n,0,n,n,n],[0,137,"IntlYen",0,n,0,n,n,n],[1,138,"Convert",0,n,0,n,n,n],[1,139,"NonConvert",0,n,0,n,n,n],[1,140,"Lang1",0,n,0,n,n,n],[1,141,"Lang2",0,n,0,n,n,n],[1,142,"Lang3",0,n,0,n,n,n],[1,143,"Lang4",0,n,0,n,n,n],[1,144,"Lang5",0,n,0,n,n,n],[1,145,"Abort",0,n,0,n,n,n],[1,146,"Props",0,n,0,n,n,n],[1,147,"NumpadParenLeft",0,n,0,n,n,n],[1,148,"NumpadParenRight",0,n,0,n,n,n],[1,149,"NumpadBackspace",0,n,0,n,n,n],[1,150,"NumpadMemoryStore",0,n,0,n,n,n],[1,151,"NumpadMemoryRecall",0,n,0,n,n,n],[1,152,"NumpadMemoryClear",0,n,0,n,n,n],[1,153,"NumpadMemoryAdd",0,n,0,n,n,n],[1,154,"NumpadMemorySubtract",0,n,0,n,n,n],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",n,n],[1,156,"NumpadClearEntry",0,n,0,n,n,n],[1,0,n,5,"Ctrl",17,"VK_CONTROL",n,n],[1,0,n,4,"Shift",16,"VK_SHIFT",n,n],[1,0,n,6,"Alt",18,"VK_MENU",n,n],[1,0,n,57,"Meta",91,"VK_COMMAND",n,n],[1,157,"ControlLeft",5,n,0,"VK_LCONTROL",n,n],[1,158,"ShiftLeft",4,n,0,"VK_LSHIFT",n,n],[1,159,"AltLeft",6,n,0,"VK_LMENU",n,n],[1,160,"MetaLeft",57,n,0,"VK_LWIN",n,n],[1,161,"ControlRight",5,n,0,"VK_RCONTROL",n,n],[1,162,"ShiftRight",4,n,0,"VK_RSHIFT",n,n],[1,163,"AltRight",6,n,0,"VK_RMENU",n,n],[1,164,"MetaRight",57,n,0,"VK_RWIN",n,n],[1,165,"BrightnessUp",0,n,0,n,n,n],[1,166,"BrightnessDown",0,n,0,n,n,n],[1,167,"MediaPlay",0,n,0,n,n,n],[1,168,"MediaRecord",0,n,0,n,n,n],[1,169,"MediaFastForward",0,n,0,n,n,n],[1,170,"MediaRewind",0,n,0,n,n,n],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",n,n],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",n,n],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",n,n],[1,174,"Eject",0,n,0,n,n,n],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",n,n],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",n,n],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",n,n],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",n,n],[1,179,"LaunchApp1",0,n,0,"VK_MEDIA_LAUNCH_APP1",n,n],[1,180,"SelectTask",0,n,0,n,n,n],[1,181,"LaunchScreenSaver",0,n,0,n,n,n],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",n,n],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",n,n],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",n,n],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",n,n],[1,186,"BrowserStop",0,n,0,"VK_BROWSER_STOP",n,n],[1,187,"BrowserRefresh",0,n,0,"VK_BROWSER_REFRESH",n,n],[1,188,"BrowserFavorites",0,n,0,"VK_BROWSER_FAVORITES",n,n],[1,189,"ZoomToggle",0,n,0,n,n,n],[1,190,"MailReply",0,n,0,n,n,n],[1,191,"MailForward",0,n,0,n,n,n],[1,192,"MailSend",0,n,0,n,n,n],[1,0,n,114,"KeyInComposition",229,n,n,n],[1,0,n,116,"ABNT_C2",194,"VK_ABNT_C2",n,n],[1,0,n,96,"OEM_8",223,"VK_OEM_8",n,n],[1,0,n,0,n,0,"VK_KANA",n,n],[1,0,n,0,n,0,"VK_HANGUL",n,n],[1,0,n,0,n,0,"VK_JUNJA",n,n],[1,0,n,0,n,0,"VK_FINAL",n,n],[1,0,n,0,n,0,"VK_HANJA",n,n],[1,0,n,0,n,0,"VK_KANJI",n,n],[1,0,n,0,n,0,"VK_CONVERT",n,n],[1,0,n,0,n,0,"VK_NONCONVERT",n,n],[1,0,n,0,n,0,"VK_ACCEPT",n,n],[1,0,n,0,n,0,"VK_MODECHANGE",n,n],[1,0,n,0,n,0,"VK_SELECT",n,n],[1,0,n,0,n,0,"VK_PRINT",n,n],[1,0,n,0,n,0,"VK_EXECUTE",n,n],[1,0,n,0,n,0,"VK_SNAPSHOT",n,n],[1,0,n,0,n,0,"VK_HELP",n,n],[1,0,n,0,n,0,"VK_APPS",n,n],[1,0,n,0,n,0,"VK_PROCESSKEY",n,n],[1,0,n,0,n,0,"VK_PACKET",n,n],[1,0,n,0,n,0,"VK_DBE_SBCSCHAR",n,n],[1,0,n,0,n,0,"VK_DBE_DBCSCHAR",n,n],[1,0,n,0,n,0,"VK_ATTN",n,n],[1,0,n,0,n,0,"VK_CRSEL",n,n],[1,0,n,0,n,0,"VK_EXSEL",n,n],[1,0,n,0,n,0,"VK_EREOF",n,n],[1,0,n,0,n,0,"VK_PLAY",n,n],[1,0,n,0,n,0,"VK_ZOOM",n,n],[1,0,n,0,n,0,"VK_NONAME",n,n],[1,0,n,0,n,0,"VK_PA1",n,n],[1,0,n,0,n,0,"VK_OEM_CLEAR",n,n]],e=[],r=[];for(let i of t){let[o,s,a,l,c,u,f,p,h]=i;if(r[s]||(r[s]=!0,Ox[s]=a,Ax[a]=s,Fx[a.toLowerCase()]=s,o&&(Vm[s]=l,l!==0&&l!==3&&l!==5&&l!==4&&l!==6&&l!==57&&(Bd[l]=s))),!e[l]){if(e[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);ac.define(l,c),Wd.define(l,p||c),Kd.define(l,h||p||c)}u&&(Dx[u]=l),f&&(kx[f]=l)}Bd[3]=46})();var Lx;(s=>{function n(a){return ac.keyCodeToStr(a)}s.toString=n;function t(a){return ac.strToKeyCode(a)}s.fromString=t;function e(a){return Wd.keyCodeToStr(a)}s.toUserSettingsUS=e;function r(a){return Kd.keyCodeToStr(a)}s.toUserSettingsGeneral=r;function i(a){return Wd.strToKeyCode(a)||Kd.strToKeyCode(a)}s.fromUserSettings=i;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return ac.keyCodeToStr(a)}s.toElectronAccelerator=o})(Lx||={});var qd=class{constructor(t){this.options=t}getItemLabel(t){return t.label}getItemDescription(t){if(!this.options?.skipDescription)return t.description}getItemPath(t){if(!this.options?.skipPath)return t.resource?.scheme===Q.file?t.resource.fsPath:t.resource?.path}},Oz=new qd,Az=$("quickInputService");function Ux(n){return n.tags.find(t=>t.startsWith("lp-"))?.split("lp-")[1]}var Wm=$("languagePackService"),lo=class extends U{constructor(e){super();this.extensionGalleryService=e}async getAvailableLanguages(){let e=new at;setTimeout(()=>e.cancel(),1e3);let r;try{r=await this.extensionGalleryService.query({text:'category:"language packs"',pageSize:20},e.token)}catch{return[]}let o=r.firstPage.filter(s=>s.properties.localizedLanguages?.length&&s.tags.some(a=>a.startsWith("lp-"))).map(s=>{let a=s.properties.localizedLanguages?.[0],l=Ux(s);return{...this.createQuickPickItem(l,a,s),extensionId:s.identifier.id,galleryExtension:s}});return o.push(this.createQuickPickItem("en","English")),o}createQuickPickItem(e,r,i){let o=r??e,s;if(o!==e&&(s=`(${e})`),e.toLowerCase()===Xt.toLowerCase()&&(s??="",s+=g("currentDisplayLanguage"," (Current)")),i?.installCount){s??="";let a=i.installCount,l;a>1e6?l=`${Math.floor(a/1e5)/10}M`:a>1e3?l=`${Math.floor(a/1e3)}K`:l=String(a),s+=` $(cloud-download) ${l}`}return{id:e,label:o,description:s}}};lo=D([b(0,St)],lo);import*as Km from"fs";import{createHash as Nx}from"crypto";var co=class extends lo{constructor(e,r,i,o){super(i);this.extensionManagementService=e;this.logService=o;this.cache=this._register(new ws(r,o)),this.extensionManagementService.registerParticipant({postInstall:async s=>this.postInstallExtension(s),postUninstall:async s=>this.postUninstallExtension(s)})}cache;async getBuiltInExtensionTranslationsUri(e,r){let o=(await this.cache.getLanguagePacks())[r];if(!o){this.logService.warn(`No language pack found for ${r}`);return}let s=o.translations[e];return s?P.file(s):void 0}async getInstalledLanguages(){let e=await this.cache.getLanguagePacks(),r=Object.keys(e).map(i=>{let o=e[i];return{...this.createQuickPickItem(i,o.label),extensionId:o.extensions[0].extensionIdentifier.id}});return r.push(this.createQuickPickItem("en","English")),r.sort((i,o)=>i.label.localeCompare(o.label)),r}async postInstallExtension(e){e&&e.manifest&&e.manifest.contributes&&e.manifest.contributes.localizations&&e.manifest.contributes.localizations.length&&(this.logService.info("Adding language packs from the extension",e.identifier.id),await this.update())}async postUninstallExtension(e){let r=await this.cache.getLanguagePacks();Object.keys(r).some(i=>r[i]&&r[i].extensions.some(o=>X(o.extensionIdentifier,e.identifier)))&&(this.logService.info("Removing language packs from the extension",e.identifier.id),await this.update())}async update(){let[e,r]=await Promise.all([this.cache.getLanguagePacks(),this.extensionManagementService.getInstalled()]),i=await this.cache.update(r);return!sn(Object.keys(e),Object.keys(i))}};co=D([b(0,qi),b(1,dt),b(2,St),b(3,J)],co);var ws=class extends U{constructor(e,r){super();this.logService=r;this.languagePacksFilePath=V(e.userDataPath,"languagepacks.json"),this.languagePacksFileLimiter=new pn}languagePacks={};languagePacksFilePath;languagePacksFileLimiter;initializedCache;getLanguagePacks(){return this.languagePacksFileLimiter.size||!this.initializedCache?this.withLanguagePacks().then(()=>this.languagePacks):Promise.resolve(this.languagePacks)}update(e){return this.withLanguagePacks(r=>{Object.keys(r).forEach(i=>delete r[i]),this.createLanguagePacksFromExtensions(r,...e)}).then(()=>this.languagePacks)}createLanguagePacksFromExtensions(e,...r){for(let i of r)i&&i.manifest&&i.manifest.contributes&&i.manifest.contributes.localizations&&i.manifest.contributes.localizations.length&&this.createLanguagePacksFromExtension(e,i);Object.keys(e).forEach(i=>this.updateHash(e[i]))}createLanguagePacksFromExtension(e,r){let i=r.identifier,o=r.manifest.contributes&&r.manifest.contributes.localizations?r.manifest.contributes.localizations:[];for(let s of o)if(r.location.scheme===Q.file&&Mx(s)){let a=e[s.languageId];a||(a={hash:"",extensions:[],translations:{},label:s.localizedLanguageName??s.languageName},e[s.languageId]=a);let l=a.extensions.filter(c=>X(c.extensionIdentifier,i))[0];l?l.version=r.manifest.version:a.extensions.push({extensionIdentifier:i,version:r.manifest.version});for(let c of s.translations)a.translations[c.id]=V(r.location.fsPath,c.path)}}updateHash(e){if(e){let r=Nx("md5");for(let i of e.extensions)r.update(i.extensionIdentifier.uuid||i.extensionIdentifier.id).update(i.version);e.hash=r.digest("hex")}}withLanguagePacks(e=()=>null){return this.languagePacksFileLimiter.queue(()=>{let r=null;return Km.promises.readFile(this.languagePacksFilePath,"utf8").then(void 0,i=>i.code==="ENOENT"?Promise.resolve("{}"):Promise.reject(i)).then(i=>{try{return JSON.parse(i)}catch{return{}}}).then(i=>(r=e(i),i)).then(i=>{for(let s of Object.keys(i))i[s]||delete i[s];this.languagePacks=i,this.initializedCache=!0;let o=JSON.stringify(this.languagePacks);return this.logService.debug("Writing language packs",o),se.writeFile(this.languagePacksFilePath,o)}).then(()=>r,i=>this.logService.error(i))})}};ws=D([b(0,dt),b(1,J)],ws);function Mx(n){if(typeof n.languageId!="string"||!Array.isArray(n.translations)||n.translations.length===0)return!1;for(let t of n.translations)if(typeof t.id!="string"||typeof t.path!="string")return!1;return!(n.languageName&&typeof n.languageName!="string"||n.localizedLanguageName&&typeof n.localizedLanguageName!="string")}var uo=class{constructor(t,e){this.requestService=t;this.fileService=e}async download(t,e,r=ce.None){if(t.scheme===Q.file||t.scheme===Q.vscodeRemote){await this.fileService.copy(t,e);return}let i={type:"GET",url:t.toString(!0)},o=await this.requestService.request(i,r);if(o.res.statusCode===200)await this.fileService.writeFile(e,o.stream);else{let s=await mr(o);throw new Error(`Expected 200, got back ${o.res.statusCode} instead.

${s}`)}}};uo=D([b(0,hr),b(1,pe)],uo);var Vx=[];function Bm(n,t,e){t instanceof We||(t=new We(t,[],!!e)),Vx.push([n,t])}var Ps=class{constructor(t,e,r){this.level=t;this.key=e;this.value=r;this.forward=[]}forward},Ts=void 0,lc=class n{constructor(t,e=2**16){this.comparator=t;this._maxLevel=Math.max(1,Math.log2(e)|0),this._header=new Ps(this._maxLevel,Ts,Ts)}[Symbol.toStringTag]="SkipList";_maxLevel;_level=0;_header;_size=0;get size(){return this._size}clear(){this._header=new Ps(this._maxLevel,Ts,Ts),this._size=0}has(t){return!!n._search(this,t,this.comparator)}get(t){return n._search(this,t,this.comparator)?.value}set(t,e){return n._insert(this,t,e,this.comparator)&&(this._size+=1),this}delete(t){let e=n._delete(this,t,this.comparator);return e&&(this._size-=1),e}forEach(t,e){let r=this._header.forward[0];for(;r;)t.call(e,r.value,r.key,this),r=r.forward[0]}[Symbol.iterator](){return this.entries()}*entries(){let t=this._header.forward[0];for(;t;)yield[t.key,t.value],t=t.forward[0]}*keys(){let t=this._header.forward[0];for(;t;)yield t.key,t=t.forward[0]}*values(){let t=this._header.forward[0];for(;t;)yield t.value,t=t.forward[0]}toString(){let t="[SkipList]:",e=this._header.forward[0];for(;e;)t+=`node(${e.key}, ${e.value}, lvl:${e.level})`,e=e.forward[0];return t}static _search(t,e,r){let i=t._header;for(let o=t._level-1;o>=0;o--)for(;i.forward[o]&&r(i.forward[o].key,e)<0;)i=i.forward[o];if(i=i.forward[0],i&&r(i.key,e)===0)return i}static _insert(t,e,r,i){let o=[],s=t._header;for(let a=t._level-1;a>=0;a--){for(;s.forward[a]&&i(s.forward[a].key,e)<0;)s=s.forward[a];o[a]=s}if(s=s.forward[0],s&&i(s.key,e)===0)return s.value=r,!1;{let a=n._randomLevel(t);if(a>t._level){for(let l=t._level;l<a;l++)o[l]=t._header;t._level=a}s=new Ps(a,e,r);for(let l=0;l<a;l++)s.forward[l]=o[l].forward[l],o[l].forward[l]=s;return!0}}static _randomLevel(t,e=.5){let r=1;for(;Math.random()<e&&r<t._maxLevel;)r+=1;return r}static _delete(t,e,r){let i=[],o=t._header;for(let s=t._level-1;s>=0;s--){for(;o.forward[s]&&r(o.forward[s].key,e)<0;)o=o.forward[s];i[s]=o}if(o=o.forward[0],!o||r(o.key,e)!==0)return!1;for(let s=0;s<t._level&&i[s].forward[s]===o;s++)i[s].forward[s]=o.forward[s];for(;t._level>0&&t._header.forward[t._level-1]===Ts;)t._level-=1;return!0}};var cc=class n{constructor(t){this.uri=t}static _clock=0;time=n._clock++;touch(){return this.time=n._clock++,this}},Xr=class{constructor(t){this._fileService=t;let e=new Map,r=i=>{let o=e.get(i.scheme);return o===void 0&&(o=t.hasProvider(i)&&!this._fileService.hasCapability(i,1024),e.set(i.scheme,o)),o};this._dispooables.add(Z.any(t.onDidChangeFileSystemProviderRegistrations,t.onDidChangeFileSystemProviderCapabilities)(i=>{e.delete(i.scheme)})),this.extUri=new Ar(r),this._canonicalUris=new lc((i,o)=>this.extUri.compare(i,o,!0),this._limit)}extUri;_dispooables=new Ee;_canonicalUris;_limit=2**16;dispose(){this._dispooables.dispose(),this._canonicalUris.clear()}asCanonicalUri(t){this._fileService.hasProvider(t)&&(t=dp(t));let e=this._canonicalUris.get(t);return e?e.touch().uri.with({fragment:t.fragment}):(this._canonicalUris.set(t,new cc(t)),this._checkTrim(),t)}_checkTrim(){if(this._canonicalUris.size<this._limit)return;let t=[...this._canonicalUris.entries()].sort((r,i)=>r[1].time<i[1].time?1:r[1].time>i[1].time?-1:0);cc._clock=0,this._canonicalUris.clear();let e=this._limit*.5;for(let r=0;r<e;r++)this._canonicalUris.set(t[r][0],t[r][1].touch())}};Xr=D([b(0,pe)],Xr);Bm(_e,Xr,1);import*as Wx from"path";import*as Kx from"fs";var uc={exports:{}};(function(){function t(e,r,i){async function o(f){try{return await r.promises.access(f),!0}catch{return!1}}function s(f){let p=new Date;return r.promises.utimes(f,p,p)}async function a(f){let p=e.join(f,"languagepacks.json");try{return JSON.parse(await r.promises.readFile(p,"utf-8"))}catch{return}}function l(f,p){try{for(;p;){if(f[p])return p;let h=p.lastIndexOf("-");if(h>0)p=p.substring(0,h);else return}}catch(h){console.error("Resolving language pack configuration failed.",h)}}function c(f,p,h){return i.mark("code/didGenerateNls"),{userLocale:f,osLocale:p,resolvedLanguage:"en",defaultMessagesFile:e.join(h,"nls.messages.json"),locale:f,availableLanguages:{}}}async function u({userLocale:f,osLocale:p,userDataPath:h,commit:v,nlsMetadataPath:y}){if(i.mark("code/willGenerateNls"),process.env.VSCODE_DEV||f==="pseudo"||f.startsWith("en")||!v||!h)return c(f,p,y);try{let I=await a(h);if(!I)return c(f,p,y);let S=l(I,f);if(!S)return c(f,p,y);let T=I[S],k=T?.translations?.vscode;if(!T||typeof T.hash!="string"||!T.translations||typeof k!="string"||!await o(k))return c(f,p,y);let E=`${T.hash}.${S}`,_=e.join(h,"clp",E),N=e.join(_,v),A=e.join(N,"nls.messages.json"),Ie=e.join(_,"tcf.json"),q=e.join(_,"corrupted.info");await o(q)&&await r.promises.rm(_,{recursive:!0,force:!0,maxRetries:3});let ye={userLocale:f,osLocale:p,resolvedLanguage:S,defaultMessagesFile:e.join(y,"nls.messages.json"),languagePack:{translationsConfigFile:Ie,messagesFile:A,corruptMarkerFile:q},locale:f,availableLanguages:{"*":S},_languagePackId:E,_languagePackSupport:!0,_translationsConfigFile:Ie,_cacheRoot:_,_resolvedLanguagePackCoreLocation:N,_corruptedFile:q};if(await o(N))return s(N).catch(()=>{}),i.mark("code/didGenerateNls"),ye;let[,Ht,pt,vn]=await Promise.all([r.promises.mkdir(N,{recursive:!0}),JSON.parse(await r.promises.readFile(e.join(y,"nls.keys.json"),"utf-8")),JSON.parse(await r.promises.readFile(e.join(y,"nls.messages.json"),"utf-8")),JSON.parse(await r.promises.readFile(k,"utf-8"))]),At=[],F=0;for(let[R,L]of Ht){let O=vn.contents[R];for(let K of L)At.push(O?.[K]||pt[F]),F++}return await Promise.all([r.promises.writeFile(A,JSON.stringify(At),"utf-8"),r.promises.writeFile(Ie,JSON.stringify(T.translations),"utf-8")]),i.mark("code/didGenerateNls"),ye}catch(I){console.error("Generating translation files failed.",I)}return c(f,p,y)}return{resolveNLSConfiguration:u}}if(typeof uc=="object"&&typeof uc.exports=="object")uc.exports=t(Wx,Kx,fd);else throw new Error("vs/base/node/nls defined in UNKNOWN context (neither requirejs or commonjs)")})();var qm=uc.exports.resolveNLSConfiguration;var jm=V(fn.asFileUri("").fsPath),$m=V(jm,"nls.messages.json"),zm=new Map;async function Gm(n,t){if(!On.commit||!await se.exists($m))return{userLocale:"en",osLocale:"en",resolvedLanguage:"en",defaultMessagesFile:$m,locale:"en",availableLanguages:{}};let e=`${n}||${t}`,r=zm.get(e);return r||(r=qm({userLocale:n,osLocale:n,commit:On.commit,userDataPath:t,nlsMetadataPath:jm}),zm.set(e,r)),r}var fo=class extends Xi{constructor(e,r,i,o,s,a,l,c){super(P.file(s.builtinExtensionsPath),P.file(s.extensionsPath),B(s.userHome,".vscode-oss-dev","extensions","control.json"),e.defaultProfile,e,r,i,o,s,a,l,c);this.nativeEnvironmentService=s}async getTranslations(e){let r=await Gm(e,this.nativeEnvironmentService.userDataPath);if(r.languagePack)try{let i=await this.fileService.readFile(P.file(r.languagePack.translationsConfigFile));return JSON.parse(i.value.toString())}catch{}return Object.create(null)}};fo=D([b(0,rt),b(1,rn),b(2,pe),b(3,J),b(4,dt),b(5,vt),b(6,_e),b(7,cr)],fo);var Hm=$("stateReadService"),Qm=$("stateService");var $d=class extends U{constructor(e,r,i,o){super();this.storagePath=e;this.saveStrategy=r;this.logService=i;this.fileService=o}storage=Object.create(null);lastSavedStorageContents="";flushDelayer=this._register(new Zt(this.saveStrategy===0?0:100));initializing=void 0;closing=void 0;init(){return this.initializing||(this.initializing=this.doInit()),this.initializing}async doInit(){try{this.lastSavedStorageContents=(await this.fileService.readFile(this.storagePath)).value.toString(),this.storage=JSON.parse(this.lastSavedStorageContents)}catch(e){e.fileOperationResult!==1&&this.logService.error(e)}}getItem(e,r){let i=this.storage[e];return Ye(i)?r:i}setItem(e,r){this.setItems([{key:e,data:r}])}setItems(e){let r=!1;for(let{key:i,data:o}of e)this.storage[i]!==o&&(Ye(o)?Yt(this.storage[i])||(this.storage[i]=void 0,r=!0):(this.storage[i]=o,r=!0));r&&this.save()}removeItem(e){Yt(this.storage[e])||(this.storage[e]=void 0,this.save())}async save(){if(!this.closing)return this.flushDelayer.trigger(()=>this.doSave())}async doSave(){if(!this.initializing)return;await this.initializing;let e=JSON.stringify(this.storage,null,4);if(e!==this.lastSavedStorageContents)try{await this.fileService.writeFile(this.storagePath,W.fromString(e),{atomic:{postfix:".vsctmp"}}),this.lastSavedStorageContents=e}catch(r){this.logService.error(r)}}async close(){return this.closing||(this.closing=this.flushDelayer.trigger(()=>this.doSave(),0)),this.closing}},_s=class extends U{fileStorage;constructor(t,e,r,i){super(),this.fileStorage=this._register(new $d(e.stateResource,t,r,i))}async init(){await this.fileStorage.init()}getItem(t,e){return this.fileStorage.getItem(t,e)}};_s=D([b(1,xt),b(2,J),b(3,pe)],_s);var dc=class extends _s{setItem(t,e){this.fileStorage.setItem(t,e)}setItems(t){this.fileStorage.setItems(t)}removeItem(t){this.fileStorage.removeItem(t)}close(){return this.fileStorage.close()}};var Jn=class extends ji{constructor(e,r,i,o,s){super(i,o,r,s);this.stateReadonlyService=e;this.nativeEnvironmentService=i}static PROFILE_ASSOCIATIONS_MIGRATION_KEY="profileAssociationsMigration";getStoredProfiles(){return this.stateReadonlyService.getItem(Jn.PROFILES_KEY,[]).map(r=>({...r,location:be(r.location)?this.uriIdentityService.extUri.joinPath(this.profilesHome,r.location):P.revive(r.location)}))}getStoredProfileAssociations(){let e=this.stateReadonlyService.getItem(Jn.PROFILE_ASSOCIATIONS_KEY,{});return this.stateReadonlyService.getItem(Jn.PROFILE_ASSOCIATIONS_MIGRATION_KEY,!1)?e:this.migrateStoredProfileAssociations(e)}getDefaultProfileExtensionsLocation(){return this.uriIdentityService.extUri.joinPath(P.file(this.nativeEnvironmentService.extensionsPath).with({scheme:this.profilesHome.scheme}),"extensions.json")}};Jn=D([b(0,Hm),b(1,_e),b(2,dt),b(3,pe),b(4,J)],Jn);var Gt=class extends Jn{constructor(e,r,i,o,s){super(e,r,i,o,s);this.stateService=e}saveStoredProfiles(e){e.length?this.stateService.setItem(Gt.PROFILES_KEY,e.map(r=>({...r,location:this.uriIdentityService.extUri.basename(r.location)}))):this.stateService.removeItem(Gt.PROFILES_KEY)}getStoredProfiles(){let e=super.getStoredProfiles();return this.stateService.getItem("userDataProfilesMigration",!1)||(this.saveStoredProfiles(e),this.stateService.setItem("userDataProfilesMigration",!0)),e}saveStoredProfileAssociations(e){e.emptyWindows||e.workspaces?this.stateService.setItem(Gt.PROFILE_ASSOCIATIONS_KEY,e):this.stateService.removeItem(Gt.PROFILE_ASSOCIATIONS_KEY)}getStoredProfileAssociations(){let e="workspaceAndProfileInfo",r=this.stateService.getItem(e,void 0);if(r){this.stateService.removeItem(e);let o=r.reduce((s,{workspace:a,profile:l})=>(s[P.revive(a).toString()]=P.revive(l).toString(),s),{});this.stateService.setItem(Gt.PROFILE_ASSOCIATIONS_KEY,{workspaces:o})}let i=super.getStoredProfileAssociations();return this.stateService.getItem(Gt.PROFILE_ASSOCIATIONS_MIGRATION_KEY,!1)||(this.saveStoredProfileAssociations(i),this.stateService.setItem(Gt.PROFILE_ASSOCIATIONS_MIGRATION_KEY,!0)),i}};Gt=D([b(0,Qm),b(1,_e),b(2,dt),b(3,pe),b(4,J)],Gt);var po=class extends Gt{constructor(t,e,r,i){super(new dc(0,e,i,r),t,e,r,i)}async init(){return await this.stateService.init(),super.init()}};po=D([b(0,_e),b(1,dt),b(2,pe),b(3,J)],po);var go=class extends Ji{constructor(t,e,r,i,o,s){super(P.file(t.extensionsPath),e,r,i,o,s)}};go=D([b(0,dt),b(1,pe),b(2,rt),b(3,_e),b(4,He),b(5,J)],go);var fc=class extends U{logger;constructor(t,e=[]){super(),this.logger=new ma([t,...e]),this._register(t.onDidChangeLogLevel(r=>this.setLevel(r)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(t){this.logger.setLevel(t)}getLevel(){return this.logger.getLevel()}trace(t,...e){this.logger.trace(t,...e)}debug(t,...e){this.logger.debug(t,...e)}info(t,...e){this.logger.info(t,...e)}warn(t,...e){this.logger.warn(t,...e)}error(t,...e){this.logger.error(t,...e)}flush(){this.logger.flush()}};async function Bx(n,t,e,r,i){try{let o=await import("@vscode/spdlog");o.setFlushOn(0);let s=await o.createAsyncRotatingLogger(n,t,e,r);return i?s.clearFormatters():s.setPattern("%Y-%m-%d %H:%M:%S.%e [%l] %v"),s}catch(o){console.error(o)}return null}function Jm(n,t,e){switch(t){case 1:n.trace(e);break;case 2:n.debug(e);break;case 3:n.info(e);break;case 4:n.warn(e);break;case 5:n.error(e);break;case 0:break;default:throw new Error(`Invalid log level ${t}`)}}function Xm(n,t){switch(t){case 1:n.setLevel(0);break;case 2:n.setLevel(1);break;case 3:n.setLevel(2);break;case 4:n.setLevel(3);break;case 5:n.setLevel(4);break;case 0:n.setLevel(6);break;default:throw new Error(`Invalid log level ${t}`)}}var pc=class extends ga{buffer=[];_loggerCreationPromise;_logger;constructor(t,e,r,i,o){super(),this.setLevel(o),this._loggerCreationPromise=this._createSpdLogLogger(t,e,r,i),this._register(this.onDidChangeLogLevel(s=>{this._logger&&Xm(this._logger,s)}))}async _createSpdLogLogger(t,e,r,i){let o=r?6:1,s=30/o*Qa.MB,a=await Bx(t,e,s,o,i);if(a){this._logger=a,Xm(this._logger,this.getLevel());for(let{level:l,message:c}of this.buffer)Jm(this._logger,l,c);this.buffer=[]}}log(t,e){this._logger?Jm(this._logger,t,e):this.getLevel()<=t&&this.buffer.push({level:t,message:e})}flush(){this._logger?this._logger.flush():this._loggerCreationPromise.then(()=>this.flush())}dispose(){this._logger?this.disposeLogger():this._loggerCreationPromise.then(()=>this.disposeLogger()),super.dispose()}disposeLogger(){this._logger&&(this._logger.drop(),this._logger=void 0)}};var gc=class extends ya{doCreateLogger(t,e,r){return new pc(Ke(),t.fsPath,!r?.donotRotate,!!r?.donotUseFormatters,e)}};var Er={exports:{}};(function(){function t(){function e(){return process.uncHostAllowlist}function r(c){let u=new Set;if(Array.isArray(c))for(let f of c)typeof f=="string"&&u.add(f);return Array.from(u)}function i(){let c=e();return c?Array.from(c):[]}function o(c){if(process.platform!=="win32")return;let u=e();if(u)if(typeof c=="string")u.add(c.toLowerCase());else for(let f of r(c))o(f)}function s(c){if(typeof c!="string")return;let u=["\\\\.\\UNC\\","\\\\?\\UNC\\","\\\\"],f;for(let p of u){if(c.indexOf(p)!==0)continue;let v=c.indexOf("\\",p.length);if(v===-1)continue;let y=c.substring(p.length,v);if(y){f=y;break}}return f}function a(){process.platform==="win32"&&(process.restrictUNCAccess=!1)}function l(){return process.platform!=="win32"?!0:process.restrictUNCAccess===!1}return{getUNCHostAllowlist:i,addUNCHostToAllowlist:o,getUNCHost:s,disableUNCAccessRestrictions:a,isUNCAccessRestrictionsDisabled:l}}typeof Er=="object"&&typeof Er.exports=="object"?Er.exports=t():console.trace("vs/base/node/unc defined in UNKNOWN context (neither requirejs or commonjs)")})();var RH=Er.exports.getUNCHost,CH=Er.exports.getUNCHostAllowlist,Ym=Er.exports.addUNCHostToAllowlist,Zm=Er.exports.disableUNCAccessRestrictions,DH=Er.exports.isUNCAccessRestrictionsDisabled;var zd=class extends U{constructor(e,r){super();this.args=e;this.remoteDataFolder=r;this.registerListeners()}registerListeners(){process.once("exit",()=>this.dispose())}async run(){let e=await this.initServices();await e.invokeFunction(async r=>{let i=r.get(gn),o=r.get(J);ue&&(i.getValue("security.restrictUNCAccess")===!1?Zm():Ym(i.getValue("security.allowedUNCHosts")));try{await this.doRun(e.createInstance(ao,new ha(o.getLevel(),!1)))}catch(s){throw o.error(s),console.error(G(s)),s}})}async initServices(){let e=new ci,r={_serviceBrand:void 0,...On};e.set(vt,r);let i=new Es(this.args,r);e.set(Nm,i);let o=new gc(Pp(i),i.logsHome);e.set(Tp,o);let s=new fc(this._register(o.createLogger("remoteCLI",{name:g("remotecli","Remote CLI")})));e.set(J,s),s.trace(`Remote configuration data at ${this.remoteDataFolder}`),s.trace("process arguments:",this.args);let a=this._register(new br(s));e.set(pe,a),a.registerProvider(Q.file,this._register(new ic(s)));let l=new Xr(a);e.set(_e,l);let c=this._register(new po(l,i,a,s));e.set(rt,c);let u=this._register(new il(c.defaultProfile.settingsResource,a,new wi,s));return e.set(gn,u),await Promise.all([u.initialize(),c.init()]),e.set(hr,new We(Ki,[new Go])),e.set(Ul,new We(uo)),e.set(He,_h),e.set(St,new We(Hi)),e.set(rn,new We(go)),e.set(eo,new We(fo)),e.set(Vl,new We(to)),e.set(Em,new We(ro)),e.set(Wm,new We(co)),new $l(e)}async doRun(e){if(this.args["list-extensions"])return e.listExtensions(!!this.args["show-versions"],this.args.category);if(this.args["install-extension"]||this.args["install-builtin-extension"]){let r={isMachineScoped:!!this.args["do-not-sync"],installPreReleaseVersion:!!this.args["pre-release"]};return e.installExtensions(this.asExtensionIdOrVSIX(this.args["install-extension"]||[]),this.asExtensionIdOrVSIX(this.args["install-builtin-extension"]||[]),r,!!this.args.force)}else{if(this.args["uninstall-extension"])return e.uninstallExtensions(this.asExtensionIdOrVSIX(this.args["uninstall-extension"]),!!this.args.force);if(this.args["update-extensions"])return e.updateExtensions();if(this.args["locate-extension"])return e.locateExtension(this.args["locate-extension"])}}asExtensionIdOrVSIX(e){return e.map(r=>/\.vsix$/i.test(r)?P.file(ir(r)?r:V(Mn(),r)):r)}};function ey(n){setTimeout(()=>process.exit(n),0)}async function CQ(n,t,e){if(n.help){let i=On.serverApplicationName+(ue?".cmd":"");console.log(zg(On.nameLong,i,On.version,e,{noInputFiles:!0,noPipe:!0}));return}if(n.version){console.log(jg(On.version,On.commit));return}let r=new zd(n,t);try{await r.run(),ey(0)}catch{ey(1)}finally{r.dispose()}}export{CQ as run};
