var b=(s=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(s,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):s)(function(s){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+s+'" is not supported')});var A=s=>{if(typeof b.__$__nodeRequire=="function")return b.__$__nodeRequire(s)},h=A("fs"),I=A("path"),x=!1,C=5e3,m={},R={},f={},S=[];function L(s,t,n,i){if(!h)throw new Error("Cannot load files without 'fs'!");i=i||{};let r=i["vs/css"]||{};x=typeof r.inlineResources>"u"?!1:r.inlineResources,C=r.inlineResourcesLimit||5e3;let e=t.toUrl(s+".css"),g=h.readFileSync(e,"utf8");g.charCodeAt(0)===65279&&(g=g.substring(1)),i.isBuild&&(m[s]=g,R[s]=e),n({})}function D(s,t,n){let i=n.getEntryPoint();f[i]=f[i]||[],f[i].push({moduleName:t,contents:m[t],fsPath:R[t]}),n.asModule(s+"!"+t,"define(['vs/css!"+i+"'], {});")}function F(s,t,n,i,r){if(f&&f.hasOwnProperty(t)){let e=n.toUrl(t+".css"),g=["/*---------------------------------------------------------"," * Copyright (c) Microsoft Corporation. All rights reserved."," *--------------------------------------------------------*/"],a=f[t];for(let o=0;o<a.length;o++)x?g.push(v(a[o].fsPath,a[o].moduleName,t,a[o].contents,x==="base64",C)):g.push(w(a[o].moduleName,t,a[o].contents));i(e,g.join(`\r
`))}}function O(){return S||[]}function v(s,t,n,i,r,e){if(!h||!I)throw new Error("Cannot rewrite or inline urls without 'fs' or 'path'!");return u.replaceURL(i,g=>{if(/\.(svg|png)$/.test(g)){let o=I.join(I.dirname(s),g),l=h.readFileSync(o);if(l.length<e){let c=o.replace(/\\/g,"/");S.push(c);let d=/\.svg$/.test(g)?"image/svg+xml":"image/png",p=";base64,"+l.toString("base64");if(!r&&/\.svg$/.test(g)){let P=","+l.toString().replace(/"/g,"'").replace(/%/g,"%25").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/&/g,"%26").replace(/#/g,"%23").replace(/\s+/g," ");P.length<p.length&&(p=P)}return'"data:'+d+p+'"'}}let a=u.joinPaths(u.pathOf(t),g);return u.relativePath(n,a)})}function w(s,t,n){return u.replaceURL(n,i=>{let r=u.joinPaths(u.pathOf(s),i);return u.relativePath(t,r)})}var u=class s{static startsWith(t,n){return t.length>=n.length&&t.substr(0,n.length)===n}static pathOf(t){let n=t.lastIndexOf("/");return n!==-1?t.substr(0,n+1):""}static joinPaths(t,n){function i(o,l){return s.startsWith(o,l)?Math.max(l.length,o.indexOf("/",l.length)):0}let r=0;r=r||i(t,"//"),r=r||i(t,"http://"),r=r||i(t,"https://");function e(o,l){if(l!=="./"){if(l==="../"){let c=o.length>0?o[o.length-1]:null;if(c&&c==="/")return;if(c&&c!=="../"){o.pop();return}}o.push(l)}}function g(o,l){for(;l.length>0;){let c=l.indexOf("/"),d=c>=0?l.substring(0,c+1):l;l=c>=0?l.substring(c+1):"",e(o,d)}}let a=[];return g(a,t.substr(r)),n.length>0&&n.charAt(0)==="/"&&(a=[]),g(a,n),t.substring(0,r)+a.join("")}static commonPrefix(t,n){let i=Math.min(t.length,n.length);for(let r=0;r<i;r++)if(t.charCodeAt(r)!==n.charCodeAt(r))return t.substring(0,r);return t.substring(0,i)}static commonFolderPrefix(t,n){let i=s.commonPrefix(t,n),r=i.lastIndexOf("/");return r===-1?"":i.substring(0,r+1)}static relativePath(t,n){if(s.startsWith(n,"/")||s.startsWith(n,"http://")||s.startsWith(n,"https://"))return n;let i=s.commonFolderPrefix(t,n);t=t.substr(i.length),n=n.substr(i.length);let r=t.split("/").length,e="";for(let g=1;g<r;g++)e+="../";return e+n}static replaceURL(t,n){return t.replace(/url\(\s*([^\)]+)\s*\)?/g,(i,...r)=>{let e=r[0];for((e.charAt(0)==='"'||e.charAt(0)==="'")&&(e=e.substring(1));e.length>0&&(e.charAt(e.length-1)===" "||e.charAt(e.length-1)==="	");)e=e.substring(0,e.length-1);return(e.charAt(e.length-1)==='"'||e.charAt(e.length-1)==="'")&&(e=e.substring(0,e.length-1)),!s.startsWith(e,"data:")&&!s.startsWith(e,"http://")&&!s.startsWith(e,"https://")&&(e=n(e)),"url("+e+")"})}};export{u as CSSPluginUtilities,O as getInlinedResources,L as load,w as rewriteUrls,D as write,F as writeFile};
