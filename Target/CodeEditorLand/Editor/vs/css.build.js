const A=c=>{if(typeof require.__$__nodeRequire=="function")return require.__$__nodeRequire(c)},h=A("fs"),b=A("path");let I=!1,m=5e3;const R={},v={},f={},w=[];function C(c,t,n,s){if(!h)throw new Error("Cannot load files without 'fs'!");s=s||{};const r=s["vs/css"]||{};I=typeof r.inlineResources>"u"?!1:r.inlineResources,m=r.inlineResourcesLimit||5e3;const e=t.toUrl(c+".css");let o=h.readFileSync(e,"utf8");o.charCodeAt(0)===65279&&(o=o.substring(1)),s.isBuild&&(R[c]=o,v[c]=e),n({})}function L(c,t,n){const s=n.getEntryPoint();f[s]=f[s]||[],f[s].push({moduleName:t,contents:R[t],fsPath:v[t]}),n.asModule(c+"!"+t,"define(['vs/css!"+s+"'], {});")}function D(c,t,n,s,r){if(f&&f.hasOwnProperty(t)){const e=n.toUrl(t+".css"),o=["/*---------------------------------------------------------"," * Copyright (c) Microsoft Corporation. All rights reserved."," *--------------------------------------------------------*/"],l=f[t];for(let i=0;i<l.length;i++)I?o.push(y(l[i].fsPath,l[i].moduleName,t,l[i].contents,I==="base64",m)):o.push(M(l[i].moduleName,t,l[i].contents));s(e,o.join(`\r
`))}}function F(){return w||[]}function y(c,t,n,s,r,e){if(!h||!b)throw new Error("Cannot rewrite or inline urls without 'fs' or 'path'!");return a.replaceURL(s,o=>{if(/\.(svg|png)$/.test(o)){const i=b.join(b.dirname(c),o),g=h.readFileSync(i);if(g.length<e){const u=i.replace(/\\/g,"/");w.push(u);const d=/\.svg$/.test(o)?"image/svg+xml":"image/png";let p=";base64,"+g.toString("base64");if(!r&&/\.svg$/.test(o)){const x=","+g.toString().replace(/"/g,"'").replace(/%/g,"%25").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/&/g,"%26").replace(/#/g,"%23").replace(/\s+/g," ");x.length<p.length&&(p=x)}return'"data:'+d+p+'"'}}const l=a.joinPaths(a.pathOf(t),o);return a.relativePath(n,l)})}function M(c,t,n){return a.replaceURL(n,s=>{const r=a.joinPaths(a.pathOf(c),s);return a.relativePath(t,r)})}class a{static startsWith(t,n){return t.length>=n.length&&t.substr(0,n.length)===n}static pathOf(t){const n=t.lastIndexOf("/");return n!==-1?t.substr(0,n+1):""}static joinPaths(t,n){function s(i,g){return a.startsWith(i,g)?Math.max(g.length,i.indexOf("/",g.length)):0}let r=0;r=r||s(t,"//"),r=r||s(t,"http://"),r=r||s(t,"https://");function e(i,g){if(g!=="./"){if(g==="../"){const u=i.length>0?i[i.length-1]:null;if(u&&u==="/")return;if(u&&u!=="../"){i.pop();return}}i.push(g)}}function o(i,g){for(;g.length>0;){const u=g.indexOf("/"),d=u>=0?g.substring(0,u+1):g;g=u>=0?g.substring(u+1):"",e(i,d)}}let l=[];return o(l,t.substr(r)),n.length>0&&n.charAt(0)==="/"&&(l=[]),o(l,n),t.substring(0,r)+l.join("")}static commonPrefix(t,n){const s=Math.min(t.length,n.length);for(let r=0;r<s;r++)if(t.charCodeAt(r)!==n.charCodeAt(r))return t.substring(0,r);return t.substring(0,s)}static commonFolderPrefix(t,n){const s=a.commonPrefix(t,n),r=s.lastIndexOf("/");return r===-1?"":s.substring(0,r+1)}static relativePath(t,n){if(a.startsWith(n,"/")||a.startsWith(n,"http://")||a.startsWith(n,"https://"))return n;const s=a.commonFolderPrefix(t,n);t=t.substr(s.length),n=n.substr(s.length);const r=t.split("/").length;let e="";for(let o=1;o<r;o++)e+="../";return e+n}static replaceURL(t,n){return t.replace(/url\(\s*([^\)]+)\s*\)?/g,(s,...r)=>{let e=r[0];for((e.charAt(0)==='"'||e.charAt(0)==="'")&&(e=e.substring(1));e.length>0&&(e.charAt(e.length-1)===" "||e.charAt(e.length-1)==="	");)e=e.substring(0,e.length-1);return(e.charAt(e.length-1)==='"'||e.charAt(e.length-1)==="'")&&(e=e.substring(0,e.length-1)),!a.startsWith(e,"data:")&&!a.startsWith(e,"http://")&&!a.startsWith(e,"https://")&&(e=n(e)),"url("+e+")"})}}export{a as CSSPluginUtilities,F as getInlinedResources,C as load,M as rewriteUrls,L as write,D as writeFile};
