import e from"assert";import{ensureNoDisposablesAreLeakedInTestSuite as d}from"../../../../base/test/common/utils.js";import{EditorWhitespace as o,LinesLayout as r}from"../../../common/viewLayout/linesLayout.js";suite("Editor ViewLayout - LinesLayout",()=>{d();function c(t,i,a,s,u){let n;return t.changeWhitespace(f=>{n=f.insertWhitespace(i,a,s,u)}),n}function l(t,i,a,s){t.changeWhitespace(u=>{u.changeOneWhitespace(i,a,s)})}function E(t,i){t.changeWhitespace(a=>{a.removeWhitespace(i)})}test("LinesLayout 1",()=>{const t=new r(10,10,0,0);e.strictEqual(t.getLinesTotalHeight(),100),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),10),e.strictEqual(t.getVerticalOffsetForLineNumber(3),20),e.strictEqual(t.getVerticalOffsetForLineNumber(4),30),e.strictEqual(t.getVerticalOffsetForLineNumber(5),40),e.strictEqual(t.getVerticalOffsetForLineNumber(6),50),e.strictEqual(t.getVerticalOffsetForLineNumber(7),60),e.strictEqual(t.getVerticalOffsetForLineNumber(8),70),e.strictEqual(t.getVerticalOffsetForLineNumber(9),80),e.strictEqual(t.getVerticalOffsetForLineNumber(10),90),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(0),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(1),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(5),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(9),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(10),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(11),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(15),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(19),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(20),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(21),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(29),3),c(t,2,0,5,0),e.strictEqual(t.getLinesTotalHeight(),105),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),10),e.strictEqual(t.getVerticalOffsetForLineNumber(3),25),e.strictEqual(t.getVerticalOffsetForLineNumber(4),35),e.strictEqual(t.getVerticalOffsetForLineNumber(5),45),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(0),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(1),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(9),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(10),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(20),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(21),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(24),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(25),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(35),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(45),5),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(104),10),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(105),10),c(t,3,0,5,0),c(t,4,0,5,0),e.strictEqual(t.getLinesTotalHeight(),115),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),10),e.strictEqual(t.getVerticalOffsetForLineNumber(3),25),e.strictEqual(t.getVerticalOffsetForLineNumber(4),40),e.strictEqual(t.getVerticalOffsetForLineNumber(5),55),e.strictEqual(t.getVerticalOffsetForLineNumber(6),65),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(0),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(1),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(9),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(10),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(19),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(20),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(34),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(35),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(49),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(50),5),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(64),5),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(65),6),e.strictEqual(t.getVerticalOffsetForWhitespaceIndex(0),20),e.strictEqual(t.getVerticalOffsetForWhitespaceIndex(1),35),e.strictEqual(t.getVerticalOffsetForWhitespaceIndex(2),50),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(0),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(19),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(20),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(21),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(22),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(23),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(24),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(25),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(26),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(34),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(35),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(36),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(39),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(40),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(41),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(49),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(50),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(51),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(54),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(55),-1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(1e3),-1)}),test("LinesLayout 2",()=>{const t=new r(10,1,0,0),i=c(t,2,0,5,0);e.strictEqual(t.getLinesTotalHeight(),15),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),7),e.strictEqual(t.getVerticalOffsetForLineNumber(4),8),e.strictEqual(t.getVerticalOffsetForLineNumber(5),9),e.strictEqual(t.getVerticalOffsetForLineNumber(6),10),e.strictEqual(t.getVerticalOffsetForLineNumber(7),11),e.strictEqual(t.getVerticalOffsetForLineNumber(8),12),e.strictEqual(t.getVerticalOffsetForLineNumber(9),13),e.strictEqual(t.getVerticalOffsetForLineNumber(10),14),l(t,i,2,10),e.strictEqual(t.getLinesTotalHeight(),20),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),12),e.strictEqual(t.getVerticalOffsetForLineNumber(4),13),e.strictEqual(t.getVerticalOffsetForLineNumber(5),14),e.strictEqual(t.getVerticalOffsetForLineNumber(6),15),e.strictEqual(t.getVerticalOffsetForLineNumber(7),16),e.strictEqual(t.getVerticalOffsetForLineNumber(8),17),e.strictEqual(t.getVerticalOffsetForLineNumber(9),18),e.strictEqual(t.getVerticalOffsetForLineNumber(10),19),l(t,i,5,10),e.strictEqual(t.getLinesTotalHeight(),20),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),2),e.strictEqual(t.getVerticalOffsetForLineNumber(4),3),e.strictEqual(t.getVerticalOffsetForLineNumber(5),4),e.strictEqual(t.getVerticalOffsetForLineNumber(6),15),e.strictEqual(t.getVerticalOffsetForLineNumber(7),16),e.strictEqual(t.getVerticalOffsetForLineNumber(8),17),e.strictEqual(t.getVerticalOffsetForLineNumber(9),18),e.strictEqual(t.getVerticalOffsetForLineNumber(10),19),t.onLinesDeleted(5,6),e.strictEqual(t.getLinesTotalHeight(),18),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),2),e.strictEqual(t.getVerticalOffsetForLineNumber(4),3),e.strictEqual(t.getVerticalOffsetForLineNumber(5),14),e.strictEqual(t.getVerticalOffsetForLineNumber(6),15),e.strictEqual(t.getVerticalOffsetForLineNumber(7),16),e.strictEqual(t.getVerticalOffsetForLineNumber(8),17),t.onLinesInserted(1,2),e.strictEqual(t.getLinesTotalHeight(),20),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),2),e.strictEqual(t.getVerticalOffsetForLineNumber(4),3),e.strictEqual(t.getVerticalOffsetForLineNumber(5),4),e.strictEqual(t.getVerticalOffsetForLineNumber(6),5),e.strictEqual(t.getVerticalOffsetForLineNumber(7),16),e.strictEqual(t.getVerticalOffsetForLineNumber(8),17),e.strictEqual(t.getVerticalOffsetForLineNumber(9),18),e.strictEqual(t.getVerticalOffsetForLineNumber(10),19),E(t,i),e.strictEqual(t.getLinesTotalHeight(),10),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),2),e.strictEqual(t.getVerticalOffsetForLineNumber(4),3),e.strictEqual(t.getVerticalOffsetForLineNumber(5),4),e.strictEqual(t.getVerticalOffsetForLineNumber(6),5),e.strictEqual(t.getVerticalOffsetForLineNumber(7),6),e.strictEqual(t.getVerticalOffsetForLineNumber(8),7),e.strictEqual(t.getVerticalOffsetForLineNumber(9),8),e.strictEqual(t.getVerticalOffsetForLineNumber(10),9)}),test("LinesLayout Padding",()=>{const t=new r(10,10,15,20);e.strictEqual(t.getLinesTotalHeight(),135),e.strictEqual(t.getVerticalOffsetForLineNumber(1),15),e.strictEqual(t.getVerticalOffsetForLineNumber(2),25),e.strictEqual(t.getVerticalOffsetForLineNumber(3),35),e.strictEqual(t.getVerticalOffsetForLineNumber(4),45),e.strictEqual(t.getVerticalOffsetForLineNumber(5),55),e.strictEqual(t.getVerticalOffsetForLineNumber(6),65),e.strictEqual(t.getVerticalOffsetForLineNumber(7),75),e.strictEqual(t.getVerticalOffsetForLineNumber(8),85),e.strictEqual(t.getVerticalOffsetForLineNumber(9),95),e.strictEqual(t.getVerticalOffsetForLineNumber(10),105),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(0),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(10),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(15),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(24),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(25),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(34),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(35),3),c(t,2,0,5,0),e.strictEqual(t.getLinesTotalHeight(),140),e.strictEqual(t.getVerticalOffsetForLineNumber(1),15),e.strictEqual(t.getVerticalOffsetForLineNumber(2),25),e.strictEqual(t.getVerticalOffsetForLineNumber(3),40),e.strictEqual(t.getVerticalOffsetForLineNumber(4),50),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(0),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(10),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(25),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(34),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(35),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(39),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(40),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(41),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(49),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(50),4),c(t,3,0,5,0),c(t,4,0,5,0),e.strictEqual(t.getLinesTotalHeight(),150),e.strictEqual(t.getVerticalOffsetForLineNumber(1),15),e.strictEqual(t.getVerticalOffsetForLineNumber(2),25),e.strictEqual(t.getVerticalOffsetForLineNumber(3),40),e.strictEqual(t.getVerticalOffsetForLineNumber(4),55),e.strictEqual(t.getVerticalOffsetForLineNumber(5),70),e.strictEqual(t.getVerticalOffsetForLineNumber(6),80),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(0),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(15),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(24),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(30),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(35),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(39),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(40),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(49),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(50),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(54),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(55),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(64),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(65),5),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(69),5),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(70),5),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(80),6),e.strictEqual(t.getVerticalOffsetForWhitespaceIndex(0),35),e.strictEqual(t.getVerticalOffsetForWhitespaceIndex(1),50),e.strictEqual(t.getVerticalOffsetForWhitespaceIndex(2),65),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(0),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(34),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(35),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(39),0),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(40),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(49),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(50),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(54),1),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(55),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(64),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(65),2),e.strictEqual(t.getWhitespaceIndexAtOrAfterVerticallOffset(70),-1)}),test("LinesLayout getLineNumberAtOrAfterVerticalOffset",()=>{const t=new r(10,1,0,0);c(t,6,0,10,0),e.strictEqual(t.getLinesTotalHeight(),20),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),2),e.strictEqual(t.getVerticalOffsetForLineNumber(4),3),e.strictEqual(t.getVerticalOffsetForLineNumber(5),4),e.strictEqual(t.getVerticalOffsetForLineNumber(6),5),e.strictEqual(t.getVerticalOffsetForLineNumber(7),16),e.strictEqual(t.getVerticalOffsetForLineNumber(8),17),e.strictEqual(t.getVerticalOffsetForLineNumber(9),18),e.strictEqual(t.getVerticalOffsetForLineNumber(10),19),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(-100),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(-1),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(0),1),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(1),2),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(2),3),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(3),4),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(4),5),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(5),6),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(6),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(7),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(8),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(9),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(10),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(11),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(12),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(13),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(14),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(15),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(16),7),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(17),8),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(18),9),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(19),10),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(20),10),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(21),10),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(22),10),e.strictEqual(t.getLineNumberAtOrAfterVerticalOffset(23),10)}),test("LinesLayout getCenteredLineInViewport",()=>{const t=new r(10,1,0,0);c(t,6,0,10,0),e.strictEqual(t.getLinesTotalHeight(),20),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),1),e.strictEqual(t.getVerticalOffsetForLineNumber(3),2),e.strictEqual(t.getVerticalOffsetForLineNumber(4),3),e.strictEqual(t.getVerticalOffsetForLineNumber(5),4),e.strictEqual(t.getVerticalOffsetForLineNumber(6),5),e.strictEqual(t.getVerticalOffsetForLineNumber(7),16),e.strictEqual(t.getVerticalOffsetForLineNumber(8),17),e.strictEqual(t.getVerticalOffsetForLineNumber(9),18),e.strictEqual(t.getVerticalOffsetForLineNumber(10),19),e.strictEqual(t.getLinesViewportData(0,1).centeredLineNumber,1),e.strictEqual(t.getLinesViewportData(0,2).centeredLineNumber,2),e.strictEqual(t.getLinesViewportData(0,3).centeredLineNumber,2),e.strictEqual(t.getLinesViewportData(0,4).centeredLineNumber,3),e.strictEqual(t.getLinesViewportData(0,5).centeredLineNumber,3),e.strictEqual(t.getLinesViewportData(0,6).centeredLineNumber,4),e.strictEqual(t.getLinesViewportData(0,7).centeredLineNumber,4),e.strictEqual(t.getLinesViewportData(0,8).centeredLineNumber,5),e.strictEqual(t.getLinesViewportData(0,9).centeredLineNumber,5),e.strictEqual(t.getLinesViewportData(0,10).centeredLineNumber,6),e.strictEqual(t.getLinesViewportData(0,11).centeredLineNumber,6),e.strictEqual(t.getLinesViewportData(0,12).centeredLineNumber,6),e.strictEqual(t.getLinesViewportData(0,13).centeredLineNumber,6),e.strictEqual(t.getLinesViewportData(0,14).centeredLineNumber,6),e.strictEqual(t.getLinesViewportData(0,15).centeredLineNumber,6),e.strictEqual(t.getLinesViewportData(0,16).centeredLineNumber,6),e.strictEqual(t.getLinesViewportData(0,17).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,18).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,19).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,21).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,22).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,23).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,24).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,25).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,26).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,27).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,28).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,29).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,30).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,31).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,32).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,33).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(0,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(1,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(2,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(3,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(4,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(5,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(6,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(7,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(8,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(9,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(10,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(11,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(12,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(13,20).centeredLineNumber,7),e.strictEqual(t.getLinesViewportData(14,20).centeredLineNumber,8),e.strictEqual(t.getLinesViewportData(15,20).centeredLineNumber,8),e.strictEqual(t.getLinesViewportData(16,20).centeredLineNumber,9),e.strictEqual(t.getLinesViewportData(17,20).centeredLineNumber,9),e.strictEqual(t.getLinesViewportData(18,20).centeredLineNumber,10),e.strictEqual(t.getLinesViewportData(19,20).centeredLineNumber,10),e.strictEqual(t.getLinesViewportData(20,23).centeredLineNumber,10),e.strictEqual(t.getLinesViewportData(21,23).centeredLineNumber,10),e.strictEqual(t.getLinesViewportData(22,23).centeredLineNumber,10)}),test("LinesLayout getLinesViewportData 1",()=>{const t=new r(10,10,0,0);c(t,6,0,100,0),e.strictEqual(t.getLinesTotalHeight(),200),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),10),e.strictEqual(t.getVerticalOffsetForLineNumber(3),20),e.strictEqual(t.getVerticalOffsetForLineNumber(4),30),e.strictEqual(t.getVerticalOffsetForLineNumber(5),40),e.strictEqual(t.getVerticalOffsetForLineNumber(6),50),e.strictEqual(t.getVerticalOffsetForLineNumber(7),160),e.strictEqual(t.getVerticalOffsetForLineNumber(8),170),e.strictEqual(t.getVerticalOffsetForLineNumber(9),180),e.strictEqual(t.getVerticalOffsetForLineNumber(10),190);let i=t.getLinesViewportData(0,50);e.strictEqual(i.startLineNumber,1),e.strictEqual(i.endLineNumber,5),e.strictEqual(i.completelyVisibleStartLineNumber,1),e.strictEqual(i.completelyVisibleEndLineNumber,5),e.deepStrictEqual(i.relativeVerticalOffset,[0,10,20,30,40]),i=t.getLinesViewportData(1,51),e.strictEqual(i.startLineNumber,1),e.strictEqual(i.endLineNumber,6),e.strictEqual(i.completelyVisibleStartLineNumber,2),e.strictEqual(i.completelyVisibleEndLineNumber,5),e.deepStrictEqual(i.relativeVerticalOffset,[0,10,20,30,40,50]),i=t.getLinesViewportData(5,55),e.strictEqual(i.startLineNumber,1),e.strictEqual(i.endLineNumber,6),e.strictEqual(i.completelyVisibleStartLineNumber,2),e.strictEqual(i.completelyVisibleEndLineNumber,5),e.deepStrictEqual(i.relativeVerticalOffset,[0,10,20,30,40,50]),i=t.getLinesViewportData(10,60),e.strictEqual(i.startLineNumber,2),e.strictEqual(i.endLineNumber,6),e.strictEqual(i.completelyVisibleStartLineNumber,2),e.strictEqual(i.completelyVisibleEndLineNumber,6),e.deepStrictEqual(i.relativeVerticalOffset,[10,20,30,40,50]),i=t.getLinesViewportData(50,100),e.strictEqual(i.startLineNumber,6),e.strictEqual(i.endLineNumber,6),e.strictEqual(i.completelyVisibleStartLineNumber,6),e.strictEqual(i.completelyVisibleEndLineNumber,6),e.deepStrictEqual(i.relativeVerticalOffset,[50]),i=t.getLinesViewportData(60,110),e.strictEqual(i.startLineNumber,7),e.strictEqual(i.endLineNumber,7),e.strictEqual(i.completelyVisibleStartLineNumber,7),e.strictEqual(i.completelyVisibleEndLineNumber,7),e.deepStrictEqual(i.relativeVerticalOffset,[160]),i=t.getLinesViewportData(65,115),e.strictEqual(i.startLineNumber,7),e.strictEqual(i.endLineNumber,7),e.strictEqual(i.completelyVisibleStartLineNumber,7),e.strictEqual(i.completelyVisibleEndLineNumber,7),e.deepStrictEqual(i.relativeVerticalOffset,[160]),i=t.getLinesViewportData(50,159),e.strictEqual(i.startLineNumber,6),e.strictEqual(i.endLineNumber,6),e.strictEqual(i.completelyVisibleStartLineNumber,6),e.strictEqual(i.completelyVisibleEndLineNumber,6),e.deepStrictEqual(i.relativeVerticalOffset,[50]),i=t.getLinesViewportData(50,160),e.strictEqual(i.startLineNumber,6),e.strictEqual(i.endLineNumber,6),e.strictEqual(i.completelyVisibleStartLineNumber,6),e.strictEqual(i.completelyVisibleEndLineNumber,6),e.deepStrictEqual(i.relativeVerticalOffset,[50]),i=t.getLinesViewportData(51,161),e.strictEqual(i.startLineNumber,6),e.strictEqual(i.endLineNumber,7),e.strictEqual(i.completelyVisibleStartLineNumber,7),e.strictEqual(i.completelyVisibleEndLineNumber,7),e.deepStrictEqual(i.relativeVerticalOffset,[50,160]),i=t.getLinesViewportData(150,169),e.strictEqual(i.startLineNumber,7),e.strictEqual(i.endLineNumber,7),e.strictEqual(i.completelyVisibleStartLineNumber,7),e.strictEqual(i.completelyVisibleEndLineNumber,7),e.deepStrictEqual(i.relativeVerticalOffset,[160]),i=t.getLinesViewportData(159,169),e.strictEqual(i.startLineNumber,7),e.strictEqual(i.endLineNumber,7),e.strictEqual(i.completelyVisibleStartLineNumber,7),e.strictEqual(i.completelyVisibleEndLineNumber,7),e.deepStrictEqual(i.relativeVerticalOffset,[160]),i=t.getLinesViewportData(160,169),e.strictEqual(i.startLineNumber,7),e.strictEqual(i.endLineNumber,7),e.strictEqual(i.completelyVisibleStartLineNumber,7),e.strictEqual(i.completelyVisibleEndLineNumber,7),e.deepStrictEqual(i.relativeVerticalOffset,[160]),i=t.getLinesViewportData(160,1e3),e.strictEqual(i.startLineNumber,7),e.strictEqual(i.endLineNumber,10),e.strictEqual(i.completelyVisibleStartLineNumber,7),e.strictEqual(i.completelyVisibleEndLineNumber,10),e.deepStrictEqual(i.relativeVerticalOffset,[160,170,180,190])}),test("LinesLayout getLinesViewportData 2 & getWhitespaceViewportData",()=>{const t=new r(10,10,0,0),i=c(t,6,0,100,0),a=c(t,7,0,50,0);e.strictEqual(t.getLinesTotalHeight(),250),e.strictEqual(t.getVerticalOffsetForLineNumber(1),0),e.strictEqual(t.getVerticalOffsetForLineNumber(2),10),e.strictEqual(t.getVerticalOffsetForLineNumber(3),20),e.strictEqual(t.getVerticalOffsetForLineNumber(4),30),e.strictEqual(t.getVerticalOffsetForLineNumber(5),40),e.strictEqual(t.getVerticalOffsetForLineNumber(6),50),e.strictEqual(t.getVerticalOffsetForLineNumber(7),160),e.strictEqual(t.getVerticalOffsetForLineNumber(8),220),e.strictEqual(t.getVerticalOffsetForLineNumber(9),230),e.strictEqual(t.getVerticalOffsetForLineNumber(10),240);let s=t.getLinesViewportData(50,160);e.strictEqual(s.startLineNumber,6),e.strictEqual(s.endLineNumber,6),e.strictEqual(s.completelyVisibleStartLineNumber,6),e.strictEqual(s.completelyVisibleEndLineNumber,6),e.deepStrictEqual(s.relativeVerticalOffset,[50]);let u=t.getWhitespaceViewportData(50,160);e.deepStrictEqual(u,[{id:i,afterLineNumber:6,verticalOffset:60,height:100}]),s=t.getLinesViewportData(50,219),e.strictEqual(s.startLineNumber,6),e.strictEqual(s.endLineNumber,7),e.strictEqual(s.completelyVisibleStartLineNumber,6),e.strictEqual(s.completelyVisibleEndLineNumber,7),e.deepStrictEqual(s.relativeVerticalOffset,[50,160]),u=t.getWhitespaceViewportData(50,219),e.deepStrictEqual(u,[{id:i,afterLineNumber:6,verticalOffset:60,height:100},{id:a,afterLineNumber:7,verticalOffset:170,height:50}]),s=t.getLinesViewportData(50,220),e.strictEqual(s.startLineNumber,6),e.strictEqual(s.endLineNumber,7),e.strictEqual(s.completelyVisibleStartLineNumber,6),e.strictEqual(s.completelyVisibleEndLineNumber,7),e.deepStrictEqual(s.relativeVerticalOffset,[50,160]),s=t.getLinesViewportData(50,250),e.strictEqual(s.startLineNumber,6),e.strictEqual(s.endLineNumber,10),e.strictEqual(s.completelyVisibleStartLineNumber,6),e.strictEqual(s.completelyVisibleEndLineNumber,10),e.deepStrictEqual(s.relativeVerticalOffset,[50,160,220,230,240])}),test("LinesLayout getWhitespaceAtVerticalOffset",()=>{const t=new r(10,10,0,0),i=c(t,6,0,100,0),a=c(t,7,0,50,0);let s=t.getWhitespaceAtVerticalOffset(0);e.strictEqual(s,null),s=t.getWhitespaceAtVerticalOffset(59),e.strictEqual(s,null),s=t.getWhitespaceAtVerticalOffset(60),e.strictEqual(s.id,i),s=t.getWhitespaceAtVerticalOffset(61),e.strictEqual(s.id,i),s=t.getWhitespaceAtVerticalOffset(159),e.strictEqual(s.id,i),s=t.getWhitespaceAtVerticalOffset(160),e.strictEqual(s,null),s=t.getWhitespaceAtVerticalOffset(161),e.strictEqual(s,null),s=t.getWhitespaceAtVerticalOffset(169),e.strictEqual(s,null),s=t.getWhitespaceAtVerticalOffset(170),e.strictEqual(s.id,a),s=t.getWhitespaceAtVerticalOffset(171),e.strictEqual(s.id,a),s=t.getWhitespaceAtVerticalOffset(219),e.strictEqual(s.id,a),s=t.getWhitespaceAtVerticalOffset(220),e.strictEqual(s,null)}),test("LinesLayout",()=>{const t=new r(100,20,0,0),i=c(t,2,0,10,0);e.strictEqual(t.getWhitespacesCount(),1),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),2),e.strictEqual(t.getHeightForWhitespaceIndex(0),10),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),10),e.strictEqual(t.getWhitespacesTotalHeight(),10),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),10),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),10);let a=c(t,2,0,20,0);e.strictEqual(t.getWhitespacesCount(),2),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),2),e.strictEqual(t.getHeightForWhitespaceIndex(0),10),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),2),e.strictEqual(t.getHeightForWhitespaceIndex(1),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),10),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),30),e.strictEqual(t.getWhitespacesTotalHeight(),30),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),30),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),30),l(t,a,2,30),e.strictEqual(t.getWhitespacesCount(),2),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),2),e.strictEqual(t.getHeightForWhitespaceIndex(0),10),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),2),e.strictEqual(t.getHeightForWhitespaceIndex(1),30),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),10),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),40),e.strictEqual(t.getWhitespacesTotalHeight(),40),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),40),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),40),E(t,a),e.strictEqual(t.getWhitespacesCount(),1),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),2),e.strictEqual(t.getHeightForWhitespaceIndex(0),10),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),10),e.strictEqual(t.getWhitespacesTotalHeight(),10),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),10),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),10),a=c(t,0,0,50,0),e.strictEqual(t.getWhitespacesCount(),2),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),0),e.strictEqual(t.getHeightForWhitespaceIndex(0),50),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),2),e.strictEqual(t.getHeightForWhitespaceIndex(1),10),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),50),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),60),e.strictEqual(t.getWhitespacesTotalHeight(),60),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),60),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),60),c(t,4,0,20,0),e.strictEqual(t.getWhitespacesCount(),3),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),0),e.strictEqual(t.getHeightForWhitespaceIndex(0),50),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),2),e.strictEqual(t.getHeightForWhitespaceIndex(1),10),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),4),e.strictEqual(t.getHeightForWhitespaceIndex(2),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),50),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),60),e.strictEqual(t.getWhitespacesAccumulatedHeight(2),80),e.strictEqual(t.getWhitespacesTotalHeight(),80),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),60),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),60),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),80),c(t,3,0,30,0),e.strictEqual(t.getWhitespacesCount(),4),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),0),e.strictEqual(t.getHeightForWhitespaceIndex(0),50),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),2),e.strictEqual(t.getHeightForWhitespaceIndex(1),10),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),3),e.strictEqual(t.getHeightForWhitespaceIndex(2),30),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(3),4),e.strictEqual(t.getHeightForWhitespaceIndex(3),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),50),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),60),e.strictEqual(t.getWhitespacesAccumulatedHeight(2),90),e.strictEqual(t.getWhitespacesAccumulatedHeight(3),110),e.strictEqual(t.getWhitespacesTotalHeight(),110),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),60),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),90),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),110),l(t,i,2,100),e.strictEqual(t.getWhitespacesCount(),4),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),0),e.strictEqual(t.getHeightForWhitespaceIndex(0),50),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),2),e.strictEqual(t.getHeightForWhitespaceIndex(1),100),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),3),e.strictEqual(t.getHeightForWhitespaceIndex(2),30),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(3),4),e.strictEqual(t.getHeightForWhitespaceIndex(3),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),50),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),150),e.strictEqual(t.getWhitespacesAccumulatedHeight(2),180),e.strictEqual(t.getWhitespacesAccumulatedHeight(3),200),e.strictEqual(t.getWhitespacesTotalHeight(),200),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),150),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),180),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),200),E(t,i),e.strictEqual(t.getWhitespacesCount(),3),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),0),e.strictEqual(t.getHeightForWhitespaceIndex(0),50),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getHeightForWhitespaceIndex(1),30),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),4),e.strictEqual(t.getHeightForWhitespaceIndex(2),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),50),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),80),e.strictEqual(t.getWhitespacesAccumulatedHeight(2),100),e.strictEqual(t.getWhitespacesTotalHeight(),100),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),80),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),100),E(t,a),e.strictEqual(t.getWhitespacesCount(),2),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),3),e.strictEqual(t.getHeightForWhitespaceIndex(0),30),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),4),e.strictEqual(t.getHeightForWhitespaceIndex(1),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),30),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),50),e.strictEqual(t.getWhitespacesTotalHeight(),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),30),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),50),t.onLinesDeleted(1,1),e.strictEqual(t.getWhitespacesCount(),2),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),2),e.strictEqual(t.getHeightForWhitespaceIndex(0),30),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getHeightForWhitespaceIndex(1),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),30),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),50),e.strictEqual(t.getWhitespacesTotalHeight(),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),30),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),50),t.onLinesInserted(1,1),e.strictEqual(t.getWhitespacesCount(),2),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),3),e.strictEqual(t.getHeightForWhitespaceIndex(0),30),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),4),e.strictEqual(t.getHeightForWhitespaceIndex(1),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),30),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),50),e.strictEqual(t.getWhitespacesTotalHeight(),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),30),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),50),t.onLinesDeleted(4,4),e.strictEqual(t.getWhitespacesCount(),2),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),3),e.strictEqual(t.getHeightForWhitespaceIndex(0),30),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getHeightForWhitespaceIndex(1),20),e.strictEqual(t.getWhitespacesAccumulatedHeight(0),30),e.strictEqual(t.getWhitespacesAccumulatedHeight(1),50),e.strictEqual(t.getWhitespacesTotalHeight(),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(1),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(2),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(3),0),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(4),50),e.strictEqual(t.getWhitespaceAccumulatedHeightBeforeLineNumber(5),50)}),test("LinesLayout findInsertionIndex",()=>{const t=(a,s=0)=>a.map(u=>new o("",u,s,0,0));let i;i=t([]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),0),e.strictEqual(r.findInsertionIndex(i,2,0),0),i=t([1]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),i=t([1,3]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),2),e.strictEqual(r.findInsertionIndex(i,4,0),2),i=t([1,3,5]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),2),e.strictEqual(r.findInsertionIndex(i,4,0),2),e.strictEqual(r.findInsertionIndex(i,5,0),3),e.strictEqual(r.findInsertionIndex(i,6,0),3),i=t([1,3,5],3),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),0),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),1),e.strictEqual(r.findInsertionIndex(i,4,0),2),e.strictEqual(r.findInsertionIndex(i,5,0),2),e.strictEqual(r.findInsertionIndex(i,6,0),3),i=t([1,3,5,7]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),2),e.strictEqual(r.findInsertionIndex(i,4,0),2),e.strictEqual(r.findInsertionIndex(i,5,0),3),e.strictEqual(r.findInsertionIndex(i,6,0),3),e.strictEqual(r.findInsertionIndex(i,7,0),4),e.strictEqual(r.findInsertionIndex(i,8,0),4),i=t([1,3,5,7,9]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),2),e.strictEqual(r.findInsertionIndex(i,4,0),2),e.strictEqual(r.findInsertionIndex(i,5,0),3),e.strictEqual(r.findInsertionIndex(i,6,0),3),e.strictEqual(r.findInsertionIndex(i,7,0),4),e.strictEqual(r.findInsertionIndex(i,8,0),4),e.strictEqual(r.findInsertionIndex(i,9,0),5),e.strictEqual(r.findInsertionIndex(i,10,0),5),i=t([1,3,5,7,9,11]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),2),e.strictEqual(r.findInsertionIndex(i,4,0),2),e.strictEqual(r.findInsertionIndex(i,5,0),3),e.strictEqual(r.findInsertionIndex(i,6,0),3),e.strictEqual(r.findInsertionIndex(i,7,0),4),e.strictEqual(r.findInsertionIndex(i,8,0),4),e.strictEqual(r.findInsertionIndex(i,9,0),5),e.strictEqual(r.findInsertionIndex(i,10,0),5),e.strictEqual(r.findInsertionIndex(i,11,0),6),e.strictEqual(r.findInsertionIndex(i,12,0),6),i=t([1,3,5,7,9,11,13]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),2),e.strictEqual(r.findInsertionIndex(i,4,0),2),e.strictEqual(r.findInsertionIndex(i,5,0),3),e.strictEqual(r.findInsertionIndex(i,6,0),3),e.strictEqual(r.findInsertionIndex(i,7,0),4),e.strictEqual(r.findInsertionIndex(i,8,0),4),e.strictEqual(r.findInsertionIndex(i,9,0),5),e.strictEqual(r.findInsertionIndex(i,10,0),5),e.strictEqual(r.findInsertionIndex(i,11,0),6),e.strictEqual(r.findInsertionIndex(i,12,0),6),e.strictEqual(r.findInsertionIndex(i,13,0),7),e.strictEqual(r.findInsertionIndex(i,14,0),7),i=t([1,3,5,7,9,11,13,15]),e.strictEqual(r.findInsertionIndex(i,0,0),0),e.strictEqual(r.findInsertionIndex(i,1,0),1),e.strictEqual(r.findInsertionIndex(i,2,0),1),e.strictEqual(r.findInsertionIndex(i,3,0),2),e.strictEqual(r.findInsertionIndex(i,4,0),2),e.strictEqual(r.findInsertionIndex(i,5,0),3),e.strictEqual(r.findInsertionIndex(i,6,0),3),e.strictEqual(r.findInsertionIndex(i,7,0),4),e.strictEqual(r.findInsertionIndex(i,8,0),4),e.strictEqual(r.findInsertionIndex(i,9,0),5),e.strictEqual(r.findInsertionIndex(i,10,0),5),e.strictEqual(r.findInsertionIndex(i,11,0),6),e.strictEqual(r.findInsertionIndex(i,12,0),6),e.strictEqual(r.findInsertionIndex(i,13,0),7),e.strictEqual(r.findInsertionIndex(i,14,0),7),e.strictEqual(r.findInsertionIndex(i,15,0),8),e.strictEqual(r.findInsertionIndex(i,16,0),8)}),test("LinesLayout changeWhitespaceAfterLineNumber & getFirstWhitespaceIndexAfterLineNumber",()=>{const t=new r(100,20,0,0),i=c(t,0,0,1,0),a=c(t,7,0,1,0),s=c(t,3,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),0),e.strictEqual(t.getIdForWhitespaceIndex(1),s),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getIdForWhitespaceIndex(2),a),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),7),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(1),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(2),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(3),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(4),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(5),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(6),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(7),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(8),-1),l(t,i,1,1),e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),1),e.strictEqual(t.getIdForWhitespaceIndex(1),s),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getIdForWhitespaceIndex(2),a),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),7),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(1),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(2),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(3),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(4),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(5),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(6),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(7),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(8),-1),l(t,i,2,1),e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),2),e.strictEqual(t.getIdForWhitespaceIndex(1),s),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getIdForWhitespaceIndex(2),a),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),7),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(1),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(2),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(3),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(4),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(5),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(6),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(7),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(8),-1),l(t,i,3,1),e.strictEqual(t.getIdForWhitespaceIndex(0),s),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),3),e.strictEqual(t.getIdForWhitespaceIndex(1),i),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getIdForWhitespaceIndex(2),a),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),7),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(1),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(2),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(3),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(4),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(5),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(6),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(7),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(8),-1),l(t,s,3,1),e.strictEqual(t.getIdForWhitespaceIndex(0),s),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),3),e.strictEqual(t.getIdForWhitespaceIndex(1),i),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),3),e.strictEqual(t.getIdForWhitespaceIndex(2),a),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),7),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(1),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(2),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(3),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(4),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(5),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(6),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(7),2),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(8),-1),l(t,s,7,1),e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(0),3),e.strictEqual(t.getIdForWhitespaceIndex(1),a),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(1),7),e.strictEqual(t.getIdForWhitespaceIndex(2),s),e.strictEqual(t.getAfterLineNumberForWhitespaceIndex(2),7),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(1),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(2),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(3),0),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(4),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(5),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(6),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(7),1),e.strictEqual(t.getFirstWhitespaceIndexAfterLineNumber(8),-1)}),test("LinesLayout Bug",()=>{const t=new r(100,20,0,0),i=c(t,0,0,1,0),a=c(t,7,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getIdForWhitespaceIndex(1),a);const s=c(t,3,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getIdForWhitespaceIndex(1),s),e.strictEqual(t.getIdForWhitespaceIndex(2),a);const u=c(t,2,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getIdForWhitespaceIndex(1),u),e.strictEqual(t.getIdForWhitespaceIndex(2),s),e.strictEqual(t.getIdForWhitespaceIndex(3),a);const n=c(t,8,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getIdForWhitespaceIndex(1),u),e.strictEqual(t.getIdForWhitespaceIndex(2),s),e.strictEqual(t.getIdForWhitespaceIndex(3),a),e.strictEqual(t.getIdForWhitespaceIndex(4),n);const f=c(t,11,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getIdForWhitespaceIndex(1),u),e.strictEqual(t.getIdForWhitespaceIndex(2),s),e.strictEqual(t.getIdForWhitespaceIndex(3),a),e.strictEqual(t.getIdForWhitespaceIndex(4),n),e.strictEqual(t.getIdForWhitespaceIndex(5),f);const g=c(t,10,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getIdForWhitespaceIndex(1),u),e.strictEqual(t.getIdForWhitespaceIndex(2),s),e.strictEqual(t.getIdForWhitespaceIndex(3),a),e.strictEqual(t.getIdForWhitespaceIndex(4),n),e.strictEqual(t.getIdForWhitespaceIndex(5),g),e.strictEqual(t.getIdForWhitespaceIndex(6),f);const q=c(t,0,0,1,0);e.strictEqual(t.getIdForWhitespaceIndex(0),i),e.strictEqual(t.getIdForWhitespaceIndex(1),q),e.strictEqual(t.getIdForWhitespaceIndex(2),u),e.strictEqual(t.getIdForWhitespaceIndex(3),s),e.strictEqual(t.getIdForWhitespaceIndex(4),a),e.strictEqual(t.getIdForWhitespaceIndex(5),n),e.strictEqual(t.getIdForWhitespaceIndex(6),g),e.strictEqual(t.getIdForWhitespaceIndex(7),f)})});
