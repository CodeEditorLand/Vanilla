import p from"assert";import{URI as n}from"../../../../base/common/uri.js";import{extractLocalHostUriMetaDataForPortMapping as c,extractQueryLocalHostUriMetaDataForPortMapping as e}from"../../common/tunnel.js";import{ensureNoDisposablesAreLeakedInTestSuite as u}from"../../../../base/test/common/utils.js";suite("Tunnel",()=>{u();function h(r,a,o,i){const l=a(n.parse(r));p.strictEqual(!o,!l),p.strictEqual(l?.address,o),p.strictEqual(l?.port,i)}function t(r,a,o){h(r,c,a,o)}function s(r,a,o){h(r,e,a,o)}test("portMapping",()=>{t("file:///foo.bar/baz"),t("http://foo.bar:1234"),t("http://localhost:8080","localhost",8080),t("https://localhost:443","localhost",443),t("http://127.0.0.1:3456","127.0.0.1",3456),t("http://0.0.0.0:7654","0.0.0.0",7654),t("http://localhost:8080/path?foo=bar","localhost",8080),t("http://localhost:8080/path?foo=http%3A%2F%2Flocalhost%3A8081","localhost",8080),s("http://foo.bar/path?url=http%3A%2F%2Flocalhost%3A8081","localhost",8081),s("http://foo.bar/path?url=http%3A%2F%2Flocalhost%3A8081&url2=http%3A%2F%2Flocalhost%3A8082","localhost",8081),s("http://foo.bar/path?url=http%3A%2F%2Fmicrosoft.com%2Fbad&url2=http%3A%2F%2Flocalhost%3A8081","localhost",8081)})});
