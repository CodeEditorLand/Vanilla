var b=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var o=(n,r,e,i)=>{for(var t=i>1?void 0:i?d(r,e):r,a=n.length-1,s;a>=0;a--)(s=n[a])&&(t=(i?s(r,e,t):s(t))||t);return i&&t&&b(r,e,t),t},w=(n,r)=>(e,i)=>r(e,i,n);import{Emitter as c}from"../../../../base/common/event.js";import{Disposable as W,DisposableStore as h}from"../../../../base/common/lifecycle.js";import{IInstantiationService as p}from"../../../../platform/instantiation/common/instantiation.js";import{WebviewThemeDataProvider as I}from"./themeing.js";import"./webview.js";import{WebviewElement as m}from"./webviewElement.js";import{OverlayWebview as l}from"./overlayWebview.js";let v=class extends W{constructor(e){super();this._instantiationService=e;this._webviewThemeDataProvider=this._instantiationService.createInstance(I)}_webviewThemeDataProvider;_activeWebview;get activeWebview(){return this._activeWebview}_updateActiveWebview(e){e!==this._activeWebview&&(this._activeWebview=e,this._onDidChangeActiveWebview.fire(e))}_webviews=new Set;get webviews(){return this._webviews.values()}_onDidChangeActiveWebview=this._register(new c);onDidChangeActiveWebview=this._onDidChangeActiveWebview.event;createWebviewElement(e){const i=this._instantiationService.createInstance(m,e,this._webviewThemeDataProvider);return this.registerNewWebview(i),i}createWebviewOverlay(e){const i=this._instantiationService.createInstance(l,e);return this.registerNewWebview(i),i}registerNewWebview(e){this._webviews.add(e);const i=new h;i.add(e.onDidFocus(()=>{this._updateActiveWebview(e)}));const t=()=>{this._activeWebview===e&&this._updateActiveWebview(void 0)};i.add(e.onDidBlur(t)),i.add(e.onDidDispose(()=>{t(),i.dispose(),this._webviews.delete(e)}))}};v=o([w(0,p)],v);export{v as WebviewService};
