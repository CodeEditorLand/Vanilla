import*as c from"fs";import{createRequire as f}from"node:module";import*as l from"path";import{fileURLToPath as P}from"url";const u=f(import.meta.url),a={exports:{}},h=l.dirname(P(import.meta.url));if(Error.stackTraceLimit=100,!process.env.VSCODE_HANDLES_SIGPIPE){let e=!1;process.on("SIGPIPE",()=>{e||(e=!0)})}function E(){try{typeof process.env.VSCODE_CWD!="string"&&(process.env.VSCODE_CWD=process.cwd()),process.platform==="win32"&&process.chdir(l.dirname(process.execPath))}catch{}}E(),a.exports.devInjectNodeModuleLookupPath=e=>{if(!process.env.VSCODE_DEV)return;if(!e)throw new Error("Missing injectPath");u("node:module").register("./bootstrap-import.js",{parentURL:import.meta.url,data:e})},a.exports.removeGlobalNodeJsModuleLookupPaths=()=>{if(typeof process?.versions?.electron=="string")return;const e=u("module"),o=e.globalPaths,r=e._resolveLookupPaths;e._resolveLookupPaths=(i,p)=>{const t=r(i,p);if(Array.isArray(t)){let n=0;for(;n<t.length&&t[t.length-1-n]===o[o.length-1-n];)n++;return t.slice(0,t.length-n)}return t}},a.exports.configurePortable=e=>{const o=l.dirname(h);function r(s){return process.env.VSCODE_DEV?o:process.platform==="darwin"?s.dirname(s.dirname(s.dirname(o))):s.dirname(s.dirname(o))}function i(s){if(process.env.VSCODE_PORTABLE)return process.env.VSCODE_PORTABLE;if(process.platform==="win32"||process.platform==="linux")return s.join(r(s),"data");const d=e.portable||`${e.applicationName}-portable-data`;return s.join(s.dirname(r(s)),d)}const p=i(l),t=!("target"in e)&&c.existsSync(p),n=l.join(p,"tmp"),m=t&&c.existsSync(n);return t?process.env.VSCODE_PORTABLE=p:delete process.env.VSCODE_PORTABLE,m&&(process.platform==="win32"?(process.env.TMP=n,process.env.TEMP=n):process.env.TMPDIR=n),{portableDataPath:p,isPortable:t}},a.exports.enableASARSupport=()=>{},a.exports.fileUriFromPath=(e,o)=>{let r=e.replace(/\\/g,"/");r.length>0&&r.charAt(0)!=="/"&&(r=`/${r}`);let i;return o.isWindows&&r.startsWith("//")?i=encodeURI(`${o.scheme||"file"}:${r}`):i=encodeURI(`${o.scheme||"file"}://${o.fallbackAuthority||""}${r}`),i.replace(/#/g,"%23")};const v=a.exports.devInjectNodeModuleLookupPath,x=a.exports.removeGlobalNodeJsModuleLookupPaths,g=a.exports.configurePortable,D=a.exports.enableASARSupport,L=a.exports.fileUriFromPath;export{g as configurePortable,v as devInjectNodeModuleLookupPath,D as enableASARSupport,L as fileUriFromPath,x as removeGlobalNodeJsModuleLookupPaths};
