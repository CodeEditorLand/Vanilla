import*as p from"path";import*as c from"fs";import{fileURLToPath as d}from"url";import{createRequire as P}from"node:module";var u=P(import.meta.url),i={exports:{}},h=p.dirname(d(import.meta.url));Error.stackTraceLimit=100;if(!process.env.VSCODE_HANDLES_SIGPIPE){let e=!1;process.on("SIGPIPE",()=>{e||(e=!0,console.error(new Error("Unexpected SIGPIPE")))})}function E(){try{typeof process.env.VSCODE_CWD!="string"&&(process.env.VSCODE_CWD=process.cwd()),process.platform==="win32"&&process.chdir(p.dirname(process.execPath))}catch(e){console.error(e)}}E();i.exports.devInjectNodeModuleLookupPath=function(e){if(!process.env.VSCODE_DEV)return;if(!e)throw new Error("Missing injectPath");u("node:module").register("./bootstrap-import.js",{parentURL:import.meta.url,data:e})};i.exports.removeGlobalNodeJsModuleLookupPaths=function(){if(typeof process?.versions?.electron=="string")return;let e=u("module"),o=e.globalPaths,r=e._resolveLookupPaths;e._resolveLookupPaths=function(a,l){let t=r(a,l);if(Array.isArray(t)){let n=0;for(;n<t.length&&t[t.length-1-n]===o[o.length-1-n];)n++;return t.slice(0,t.length-n)}return t}};i.exports.configurePortable=function(e){let o=p.dirname(h);function r(s){return process.env.VSCODE_DEV?o:process.platform==="darwin"?s.dirname(s.dirname(s.dirname(o))):s.dirname(s.dirname(o))}function a(s){if(process.env.VSCODE_PORTABLE)return process.env.VSCODE_PORTABLE;if(process.platform==="win32"||process.platform==="linux")return s.join(r(s),"data");let m=e.portable||`${e.applicationName}-portable-data`;return s.join(s.dirname(r(s)),m)}let l=a(p),t=!("target"in e)&&c.existsSync(l),n=p.join(l,"tmp"),f=t&&c.existsSync(n);return t?process.env.VSCODE_PORTABLE=l:delete process.env.VSCODE_PORTABLE,f&&(process.platform==="win32"?(process.env.TMP=n,process.env.TEMP=n):process.env.TMPDIR=n),{portableDataPath:l,isPortable:t}};i.exports.enableASARSupport=function(){};i.exports.fileUriFromPath=function(e,o){let r=e.replace(/\\/g,"/");r.length>0&&r.charAt(0)!=="/"&&(r=`/${r}`);let a;return o.isWindows&&r.startsWith("//")?a=encodeURI(`${o.scheme||"file"}:${r}`):a=encodeURI(`${o.scheme||"file"}://${o.fallbackAuthority||""}${r}`),a.replace(/#/g,"%23")};var v=i.exports.devInjectNodeModuleLookupPath,x=i.exports.removeGlobalNodeJsModuleLookupPaths,g=i.exports.configurePortable,D=i.exports.enableASARSupport,L=i.exports.fileUriFromPath;export{g as configurePortable,v as devInjectNodeModuleLookupPath,D as enableASARSupport,L as fileUriFromPath,x as removeGlobalNodeJsModuleLookupPaths};
